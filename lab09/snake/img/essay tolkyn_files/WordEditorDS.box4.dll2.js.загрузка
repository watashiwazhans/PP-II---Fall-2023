'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1475:function(E,M,c){E=c(0);var m=c(15),e=c(42),a=c(6),l=c(116),y=c(168),z=c(798),n=c(223),v=c(602),A=c(2),w=c(365),G=c(22),F=c(55),I=c(243),K=c(1),J=c(1545);class N{constructor(W,X){this.h1j=W;this.fA=X}J(W){return this.h1j.jz(W,this.fA)}}Object(E.a)(N,"PropertyMergeStrategies",null,[]);var R=c(1617),O=c(1568);class L extends O.a{constructor(){super();this.AZc=this.U3d=this.Mn=null;this.pae=0}get gga(){return"Property"}UDb(){this.detail.Z("Type",
this.gga);this.detail.Z("ComplexMerger",null!=this.Mn?this.Mn:-1);this.detail.Z("Strategy",null!=this.U3d?this.U3d:-1);this.detail.Z("ClassId",null!=this.AZc?this.AZc:-1);this.detail.Z("PropId",this.pae);return this.detail}}Object(E.a)(L,"PropertyMergeFailureDetail",O.a,[]);c.d(M,"a",function(){return U});class U{constructor(W=null){this.ibh=this.Xb=null;this.SWb=W||this.wOc()}get Mn(){return 1}get elb(){return this.SWb}wOc(){return[Object(F.a)(this,this.ZMo,"tryPreProcessFavoredRevision"),Object(F.a)(this,
this.wYk,"cloneObjectAndRemoveNeededProperties"),Object(F.a)(this,this.PMo,"tryMergeNodeInternal")]}get fA(){return 5}get rae(){return this.ibh||(this.ibh=new N(this.vk(),this.fA))}ZB(W,X){const V=W.Ng.value.yf;y.a.instance.Ta(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",V.id,V.Pc);W.hq.logger.Og(Object.assign(new L,{Mn:this.Mn,AZc:V.Pc,pae:X}));return!1}Ikg(W){const X=W.Ng.value;y.a.instance.Ta(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",X.yf.id,X.yf.Pc);for(let V=0;V<this.elb.length;V++)if(!(0,this.elb[V])(W))return y.a.instance.Ta(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",X.yf.id,X.yf.Pc,V),W.hq.logger.y2d("GraphNodeComplexMerge.GetMergeFunctions()",V),this.W0m(W),W.Uk=null,!1;y.a.instance.Ta(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",X.yf.id,X.yf.Pc);
return!0}W0m(W){W.Eog||(W.Eog=!0,R.a(W.Ng.value.Hu,"Base",1),R.a(W.Ng.value.yf,"Favored",1),R.a(W.sn.value.yf,"Conflict",1))}ZMo(W){const X=W.Ng.value,V=this.rae;if(!X.YX)return!0;let Z=!0;X.Fpa.forEach((da,aa)=>{if(!aa.YX||W.rg.contains(da))return!0;aa=V.J(da);if(5===aa){const ea=X.Hu.Pc;y.a.instance.Ta(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",ea,da,aa);W.hq.logger.Og(Object.assign(new L,
{Mn:this.Mn,AZc:ea,pae:da,U3d:aa}));return Z=!1}6===aa&&W.P0f.add(da);return!0});return Z}wYk(W){W.Uk=W.Ng.value.yf.AK();const X=W.P0f,V=W.Uk;X&&X.forEach(Z=>{V.removeProperty(z.a.qX(Z));return!0});return!0}PMo(W){const X=W.sn.value,V=X.Hu.Pc,Z=this.rae;let da=!0;X.Fpa.forEach((aa,ea)=>{const na=Z.J(aa);da=this.QMo(W,ea,aa,na);da||(W.Uk=null,y.a.instance.Ta(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",V,aa,na),W.hq.logger.Og(Object.assign(new L,{Mn:this.Mn,
AZc:V,pae:aa,U3d:na})));return da});return da}QMo(W,X,V,Z){const da=W.Uk;if(!X.YX&&8!==Z||2===Z||7===Z||W.rg.contains(V))return!0;if(5===Z)return!1;if(4===Z||3===Z){let aa;if(({value:aa}=W.Ng.value.Fpa.Dc(V)).returnValue&&aa.YX)return 4!==Z;Z=0}8===Z&&(Z=0);if(0===Z){if(!X.isDeleted)return W=z.a.qX(V),(U.n_o(X,V,W)||U.Zqo())&&da.WSa(W,X.newValue),!0;Z=6}return 6===Z?(da.removeProperty(z.a.qX(V)),!0):1===Z?this.ZB(W,V):!1}Man(W,X,V,Z,da,aa){W=W||new n.a;X=X||new n.a;V=V||new n.a;var ea=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
W.length,X.length,V.length),na=W.length<=X.length&&W.length<=V.length;this.ayi()&&na&&y.a.instance.Ta(541181455,1,1,ea);if(!na&&this.iwi(aa.runtime.Xb))return null;if(this.ayi())for(ea=0;ea<W.length;ea++){na=W.ag(ea);var pa=X.ag(ea);let ja=V.ag(ea);na=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",na,pa,ja,ea,W.length);y.a.instance.Ta(541181457,1,1,na)}if(this.iwi(aa.runtime.Xb))for(aa=
0;aa<W.length;aa++)if(ea=W.ag(aa),na=X.ag(aa),pa=V.ag(aa),!Z(ea,na)||!Z(ea,pa))return null;W=W.f5();Z=new v.a;aa=W.length;for(ea=aa;ea<X.length;ea++)na=X.ag(ea),W.add(na),Z.add(na);for(;aa<V.length;aa++)X=V.ag(aa),Z.contains(X)?y.a.instance.Ta(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",X):(W.add(X),da(X));return W}ayi(){return!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("LogMPALErrors")}iwi(W){if(!W)return!1;
W.gTd(1000008);return W.Zhb(1000008)}HQm(W){if(!W)return!1;W.gTd(1000009);return W.Zhb(1000009)}gNi(W,X,V,Z){return J.a(W,X,V,Z)}ZFa(W,X,V){W=W||new n.a;X=X||new n.a;V=V||new n.a;const Z=W.SG(),da=X.SG(),aa=V.SG();W=U.filter(W,ea=>da.contains(ea)&&aa.contains(ea));W.SG();W.PC(W.length,U.filter(X,ea=>!Z.contains(ea)));W.PC(W.length,U.filter(V,ea=>!Z.contains(ea)&&!da.contains(ea)));return W}Fan(W,X){const V=z.a.qX(X),Z=W.Zd;var da=Z.getPropertyObjectIds(W.Ng.value.Hu,V),aa=Z.getPropertyObjectIds(W.Ng.value.yf,
V);const ea=Z.getPropertyObjectIds(W.sn.value.yf,V);da=this.ZFa(da,aa,ea);aa=W.Uk;0<da.length?Z.setPropertyObjectIds(aa,V,da):aa.removeProperty(V);W.rg.add(X)}Yeb(W,X,V){W.hasProperty(V)?X.WSa(V,W.xX(V)):X.removeProperty(V)}p1n(W,X){var V=X.Jl();for(const Z of V)X.removeProperty(Z);V=W.Jl();for(const Z of V)X.WSa(Z,W.xX(Z))}BHf(W,X,V,Z,da){X=W.getPropertyInt32(X,da);V=W.getPropertyInt32(V,da);V=null!=X&&null!=V?Math.max(X,V):null!=V?V:null!=X?X:null;null!=V?W.setPropertyInt32(Z,da,V):Z.removeProperty(da)}A6e(W,
X,V,Z,da,aa){X=W(X,da);V=W(V,da);W=W(Z,da);Z=X.SG();let ea=!1;aa&&(ea=aa(X,V,W));ea?(aa=!0,Z=!1):(aa=Z.vHh(V),Z=Z.vHh(W));y.a.instance.Ta(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",z.a.yb(da),X.$q(),V.$q(),W.$q(),aa,Z);return{XGc:W,J2a:aa,z2a:Z}}nUk(W,X,V,Z,da){let aa;X=W(X,da);V=W(V,da);W=W(Z,da);Z=this.dBi(X,V);aa=this.dBi(X,W);y.a.instance.Ta(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
z.a.yb(da),X.$q(),V.$q(),W.$q(),Z,aa);return{XGc:W,J2a:Z,z2a:aa}}dBi(W,X){if(!W&&!X)return!0;if(!W||!X)return!1;if(!W.count&&!X.count)return!0;let V=!1;X.forEach((Z,da)=>V=W.nb(Z)&&da==W.J(Z));return V}vk(){let W;W=this.HQm(this.Xb)?U.w9j.value:U.v9j.value;const X=new w.a(0);for(let V=0;V<W.length;V++)X.Z(W[V],7);return X}static G7(){return new U}static get instance(){return U._instance.value}static Zqo(){return G.a.instance.Na("Box4.IFeatureHelper").isFeatureEnabled(78)}static n_o(W,X,V){if(void 0!==
W.newValue&&null!==W.newValue||K.a.Iyi(V.type))return!0;U.m2m(W,X,V);return!1}static m2m(W,X,V){V=V.type===K.a.string;X=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",X);V||(X+=String.format(" [NewValue: {0}] [OldValue: {1}]",W.newValue,W.oldValue));y.a.instance.Ta(19145822,1,2,X)}static MMf(W,X,V){const Z=z.a.yb(V),da=W.Zd;var aa=da.getPropertyObjectIds(W.Ng.value.Hu,V);const ea=da.getPropertyObjectIds(W.Ng.value.yf,V);var na=da.getPropertyObjectIds(W.sn.value.yf,V);na=U.Fgm(na,
W.hq.runtime.Rjc);X=X.ZFa(aa,ea,na);aa=W.Uk;0<X.length?da.setPropertyObjectIds(aa,V,X):aa.removeProperty(V);W.rg.add(Z);return!0}static Fgm(W,X){const V=new n.a;W.forEach(Z=>{X.contains(Z,(da,aa)=>da.equals(aa))||V.add(Z);return!0});return V}static filter(W,X){const V=new n.a;W.forEach(Z=>{X(Z)&&V.add(Z);return!0});return V}static eYl(){return[z.a.yb(m.a.nhf),z.a.yb(m.a.lastModifiedTime),z.a.yb(m.a.jL),z.a.yb(m.a.m5c),z.a.yb(m.a.i8f),z.a.yb(e.a.yZc),z.a.yb(a.a.YEd),z.a.yb(a.a.Ofb),z.a.yb(l.a.ifj)]}static fYl(){return[z.a.yb(m.a.nhf),
z.a.yb(m.a.lastModifiedTime),z.a.yb(m.a.jL),z.a.yb(m.a.m5c),z.a.yb(m.a.i8f),z.a.yb(e.a.yZc),z.a.yb(a.a.YEd),z.a.yb(l.a.ifj)]}}U._instance=new I.a(U.G7);U.v9j=new I.a(U.eYl);U.w9j=new I.a(U.fYl);Object(E.a)(U,"GraphNodeComplexMerge",null,[1797])},1476:function(E,M,c){c.r(M);E=c(0);var m=c(110),e=c(1496),a=c(1482),l=c(1620),y=c(1621);class z{constructor(v,A){this.Cab=!1;this.Dha=null;if(!v)throw Error.argumentNull("annotations");if(!v.Lbc(A))throw Error.argument("structTypeID","Invalid struct type ID");
this.mw=v;this.bdc=this.mw.Mbi(A);this.Xjk=A}get G0b(){return this.mw}get isReadOnly(){return this.Cab}get vTa(){return this.Xjk}shb(v){if(0>v||v>=this.bdc)throw Error.argument("iField","Invalid field index");return this.Dha&&null!=this.Dha[v]?this.Dha[v]:this.mw.sgi(this.vTa,v)}mag(v,A){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>v||v>=this.bdc)throw Error.argument("iField","Invalid field index");if(!this.mw.Fac(this.mw.VEb(this.vTa,
v),A))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Dha||(this.Dha=Array(this.bdc)))[v]=A}wda(){const {Annotations:v}=c(1476);let A="[";if(this.Dha){let w=!0;for(let G=0;G<this.bdc;++G){if(null==this.Dha[G])continue;const F=this.mw.VEb(this.vTa,G);if(v.qqb(F,this.Dha[G],this.mw.sgi(this.vTa,G)))continue;w?w=!1:A+=", ";A+=this.mw.tgi(this.vTa,G);A+="=";const I=this.mw.wda(F,this.Dha[G]);F===v.V9?(A+='"',A+=e.a.hif(I),A+='"'):A+=I}}return A+"]"}isEqual(v){const {Annotations:A}=
c(1476);if(this===v)return!0;if(!v||this.mw!==v.G0b||this.vTa!==v.vTa)return!1;for(let w=0;w<this.bdc;++w)if(!A.qqb(this.mw.VEb(this.vTa,w),this.shb(w),v.shb(w)))return!1;return!0}clone(){const v=new z(this.mw,this.vTa);this.Dha&&(v.Dha=Array.clone(this.Dha));return v}lT(){return this.isReadOnly?this.clone():this}XJf(){const {Annotations:v}=c(1476);if(!this.isReadOnly&&(this.Cab=!0,this.Dha))for(let A=0;A<this.bdc;++A){const w=this.Dha[A];null!=w&&v.SIb(w)}}toString(){return this.wda()}}Object(E.a)(z,
"StructValue",null,[1241,1238]);c.d(M,"Annotations",function(){return n});class n{constructor(v,A){if(!v)throw Error.argumentNull("initData");if(!A)throw Error.argumentNull("objectFetcher");this.f7m=A.Vpl;let w=0;var G=A.chb(v.J(w));++w;this.JLf=new l.a(new y.a(G));this.e1j=v.J(w);++w;this.HKi=Array(this.wKd);this.cYc=Array(this.wKd);this.Wkb=Array(this.wKd);for(G=0;G<this.wKd;++G){this.HKi[G]=A.QD(v.J(w));++w;this.cYc[G]=v.J(w);++w;var F=v.J(w);++w;this.Wkb[G]=Array(F);for(var I=0;I<F;++I)this.Wkb[G][I]=
A.QD(v.J(w)),++w}this.Wjk=v.J(w);++w;this.mLi=Array(this.d9c);this.h3d=Array(this.d9c);this.i3d=Array(this.d9c);this.g3d=Array(this.d9c);for(G=0;G<this.d9c;++G)for(this.mLi[G]=A.QD(v.J(w)),++w,F=v.J(w),++w,this.h3d[G]=Array(F),this.i3d[G]=Array(F),this.g3d[G]=Array(F),I=0;I<F;++I)this.h3d[G][I]=A.QD(v.J(w)),++w,this.i3d[G][I]=v.J(w),++w,this.g3d[G][I]=({Sga:w}=this.RNa(this.i3d[G][I],v,w,null,null,null)).returnValue,n.SIb(this.g3d[G][I]);this.JVj=v.J(w);++w;this.nLf=Array(this.c1b);this.oLf=Array(this.c1b);
this.mLf=Array(this.c1b);for(G=0;G<this.c1b;++G)this.nLf[G]=A.QD(v.J(w)),++w,this.oLf[G]=v.J(w),++w,this.mLf[G]=({Sga:w}=this.RNa(this.oLf[G],v,w,null,null,null)).returnValue,n.SIb(this.mLf[G])}WMc(v){for(let A=0;A<this.c1b;++A)if(this.nLf[A]===v)return A;return-1}N3h(v){if(!this.Jbc(v))throw Error.argument("attrID","Invalid attribute ID");return this.nLf[v]}getAttributeType(v){if(!this.Jbc(v))throw Error.argument("attrID","Invalid attribute ID");return this.oLf[v]}VEb(v,A){if(!this.Lbc(v))throw Error.argument("structTypeID",
"Invalid struct type ID");v=this.i3d[n.e9c(v)];if(0>A||A>=v.length)throw Error.argument("iField","Invalid field index");return v[A]}wda(v,A){if(!this.$Gf(v))throw Error.argument("typeID","Invalid type ID");if(!this.Fac(v,A))throw Error.argument("value","Value is not of the correct type");switch(v){case n.V9:return A;case n.Yya:return A?"True":"False";case n.yIa:case n.Mqa:return A.toString();case n.iV:return A.wda();default:if(!n.cI(v)&&n.nad(v)){v=n.Zhf(v);const F=this.Wkb[v].length;switch(this.cYc[v]){case 0:return this.Wkb[v][A];
case 1:if(A){var w="";for(var G=1;G<F;++G)A&1<<G-1&&(0<w.length&&(w+=" & "),w+=this.Wkb[v][G]);return w}return this.Wkb[v][0];case 2:w="";for(G=0;G<F;++G)A&1<<G&&(0<w.length&&(w+=" & "),w+=this.Wkb[v][G]);return w;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.cYc[v]);}}else return A.wda()}}$Gf(v){switch(v){case n.V9:case n.Yya:case n.yIa:case n.Mqa:case n.iV:return!0;default:return n.cI(v)?this.$Gf(n.e1a(v)):n.nad(v)?this.OSm(v):this.Lbc(v)}}OSm(v){v=n.Zhf(v);return 0<=
v&&v<this.HKi.length}Lbc(v){v=n.e9c(v);return 0<=v&&v<this.mLi.length}Jbc(v){return 0<=v&&v<this.c1b}Fac(v,A){if(null==A)return!1;switch(v){case n.V9:return"string"===typeof A;case n.Yya:return"boolean"===typeof A;case n.yIa:return"number"===typeof A;case n.Mqa:return"number"===typeof A;case n.iV:return Object(m.a)(1237,A);default:if(n.cI(v))return Object(m.a)(1240,A)&&A.t4===n.e1a(v);if(n.nad(v)){if("number"!==typeof A)return!1;v=n.Zhf(v);const w=this.Wkb[v].length;switch(this.cYc[v]){case 0:return 0<=
A&&A<w;case 1:return!(A&-1<<w-1);case 2:return!!A&&!(A&-1<<w);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.cYc[v]);}}else return Object(m.a)(1241,A)&&A.vTa===v}}get c1b(){return this.JVj}get wKd(){return this.e1j}get d9c(){return this.Wjk}DLl(v){if(!this.Jbc(v))throw Error.argument("attrID","Invalid attribute ID");return this.mLf[v]}Mbi(v){if(!this.Lbc(v))throw Error.argument("structTypeID","Invalid struct type ID");return this.h3d[n.e9c(v)].length}tgi(v,A){if(!this.Lbc(v))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.h3d[n.e9c(v)][A]}sgi(v,A){if(!this.Lbc(v))throw Error.argument("structTypeID","Invalid struct type ID");v=this.g3d[n.e9c(v)];if(0>A||A>=v.length)throw Error.argument("iField","Invalid field index");return v[A]}RNa(v,A,w,G,F,I){if(!A)throw Error.argumentNull("initData");if(n.cI(v)){var K=A.J(w);++w;v=n.e1a(v);var J=new a.a(this,v);for(var N=0;N<K;++N)Array.add(J.items,({Sga:w}=this.RNa(v,A,w,G,F,I)).returnValue);return{returnValue:J,Sga:w}}switch(v){case n.V9:return{returnValue:(G||
this.JLf).QD(A.J(w++)),Sga:w};case n.Yya:return{returnValue:1===A.J(w++),Sga:w};case n.yIa:return{returnValue:A.J(w++),Sga:w};case n.Mqa:return{returnValue:(F||this.f7m)[A.J(w++)],Sga:w};case n.iV:v=A.J(w++);K=new e.a(this);for(J=0;J<v;++J)N=A.J(w),++w,I&&(N=I[N]),K.Dy(N,({Sga:w}=this.RNa(this.getAttributeType(N),A,w,G,F,I)).returnValue);return{returnValue:K,Sga:w};default:if(n.nad(v))return{returnValue:A.J(w++),Sga:w};if(n.pCj(v)){K=A.J(w++);J=new z(this,v);for(N=0;N<K;++N){const R=A.J(w);++w;J.mag(R,
({Sga:w}=this.RNa(this.VEb(v,R),A,w,G,F,I)).returnValue)}return{returnValue:J,Sga:w}}throw Error.argument("typeID","Invalid type ID");}}static nad(v){return 16<=(v&16383)&&16384!==(v&16384)&&32768!==(v&32768)}static pCj(v){return 16<=(v&16383)&&16384===(v&16384)&&32768!==(v&32768)}static cI(v){return 32768===(v&32768)}static w0l(v){if(n.cI(v))throw Error.argument("nonListTypeID","Non-list type ID required");return v|32768}static e1a(v){if(!n.cI(v))throw Error.argument("listTypeID","List type ID required");
return v&-32769}static qqb(v,A,w){switch(v){case n.V9:case n.Yya:case n.yIa:case n.Mqa:return A===w;case n.iV:return A.isEqual(w);default:return n.cI(v)?A.isEqual(w):n.nad(v)?A===w:A.isEqual(w)}}static SIb(v){Object(m.a)(1238,v)&&v.XJf()}static lT(v){return Object(m.a)(1238,v)?v.lT():v}static Zhf(v){return v-16}static e9c(v){return(v&-16385)-16}}n.V9=1;n.Yya=2;n.yIa=3;n.Mqa=5;n.iV=9;Object(E.a)(n,"Annotations",null,[1242])},1480:function(E,M,c){E=c(0);var m=c(344);class e{constructor(){this.userId=
this.email=this.displayName=null}}Object(E.a)(e,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(E.a)(a,"InsightsParameters",null,[]);var l=c(1710),y=c(1711),z=c(1712),n=c(1713),v=c(2),A=c(1528),w=c(1541),G=c(35),F=c(20),I=c(19),K=c(25);c.d(M,"a",function(){return J});class J{static get GAf(){return"Insights_16x16x32"}static get oBl(){return"Find_16x16x32"}static get YZi(){return"-Parameterized"}static get Reg(){return"Parameterized"}static get wme(){return"bTryQuery"}static get Pkg(){return"TellMeSuggestion_"}static get RBj(){return"bTryQueryAlternate"}static get kig(){return"MenuTellMe"}static get Xzn(){const N=
{},R=[];Array.add(R,{Term:{PeopleType:"Person"}});N.And=R;return N}static sbf(N){return N+J.YZi}static getParameter(N){let R="",O="";if(N)for(let L=0;L<N.IYh;++L)"Type"===N.Ipf(L)?R=N.getValue(L):"Value"===N.Ipf(L)&&(O=N.getValue(L));return new m.a(R,O)}static kBb(N){N=Object.assign(new a,{neighborhood:N,mentionStart:0,mentionLength:N.length});return G.c(N)}static uMh(N,R,O){N=Object.assign(new e,{displayName:N,email:R,userId:O});return G.c(N)}static LNa(N,R,O=null){return G.c(J.Zfi(N,R,O,null))}static Zfi(N,
R,O=null,L=null){N=Object.assign(new w.a,{neighborhood:N,mentionStart:0,mentionLength:N?N.length:0});return Object.assign(new A.a,{selection:N,userIntent:L,entryPoint:R,launchData:O})}static y5n(N,R){return J.LNa(N,J.odj(R))}static odj(N){switch(N){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static CJm(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static wbc(){const N=
v.AFrameworkApplication.K?v.AFrameworkApplication.K.jb("SovereignEnvironmentName"):null;return!!N&&0<N.length}static isEnterpriseUser(){const N=v.AFrameworkApplication.K?v.AFrameworkApplication.K.jb("HostAuthType"):null;return!!N&&"aad"===N.toLowerCase()||"external"===N&&J.vCf()}static Qcg(N){return N.TFo&&!J.wbc()}static AAi(){const N=v.AFrameworkApplication.K?v.AFrameworkApplication.K.jb("UiHostIntegrationType"):"";return!!v.AFrameworkApplication.K&&"UnifiedUiHostTeams"===N&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static Pcg(N){return N.KTa&&N.pzl&&(N.R9c||N.P9c||N.hkb)&&!J.AAi()&&J.isEnterpriseUser()&&!J.wbc()}static nha(){return v.AFrameworkApplication.K?v.AFrameworkApplication.O6a||v.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):v.AFrameworkApplication.O6a}static YQ(N){return!N||J.ZAi(N.Dg)}static ZAi(N){return!N||!N.trim().length}static gme(N){if(!N)return 0;const R=Math.pow(10,5);return Math.round(N*R)/R}static fIo(){var N=new Date;return N?new Date(N.getUTCFullYear(),N.getUTCMonth(),N.getUTCDate(),
N.getUTCHours(),N.getUTCMinutes(),N.getUTCSeconds(),N.getUTCMilliseconds()):null}static Ouf(N){N=new Date(N);return(J.fIo().getTime()-N.getTime())/1E3}static KBi(N){const {InsightsMenuItemFactory:R}=c(1709);switch(N){case l.a.xxf:case y.a.w_h:case R.Nri:case z.a.bQi:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return N.startsWith(J.wme)||
N.startsWith(J.Pkg)||N.startsWith(J.RBj)||N.startsWith("PeopleSuggestion")||N.startsWith("FileSuggestion")||N.startsWith("FindInDocumentSuggestion")||N.startsWith("NotesSuggestion")||N.startsWith("OnenoteNotesSuggestion")||N.startsWith("SmartLookupFromTellMe")||N.startsWith("GetHelpFromTellMe")||N.startsWith("GetHelpWithDescriptionFromTellMe")||N.startsWith("AddinSuggestion")||N.startsWith("OfficeScripts")?!0:!1}static bqf(N,R){const O=[];Array.add(O,new n.a(400,N));Array.add(O,new n.a(200,R));N=
{};N.parts=O;return JSON.stringify(N)}static bhb(N){const R=N.indexOf("<b0>"),O=N.lastIndexOf("</b0>"),L=[];Array.add(L,new n.a(400,N.substring(0,R)));Array.add(L,new n.a(600,N.substring(R+4,O)));Array.add(L,new n.a(400,N.substring(O+5,N.length)));N={};N.parts=L;return JSON.stringify(N)}static Qhi(N){const R=J.Ouf(N);return 60>R?CommonUIStrings.l_TimeSince_SecsAgo:3600>R?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(R/60).toString()):86400>R?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(R/3600).toString()):172800>R?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(N)).localeFormat("MMMM dd, yyyy"))}static ZOl(N){const R=Array(N.length);for(let O=0;O<N.length;O++)R[O]=N[O].commandId;return R}static vCf(){if("Dev Box"===v.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse"))return!0;let N=v.AFrameworkApplication.K.jb("UserPrincipalName");N=K.c(N)?"":I.a.Tg(N);const R=v.AFrameworkApplication.K.Nw("TellMeIntEnabledForFeatureCrew")?
v.AFrameworkApplication.K.GC("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(R,N)&&"inner"===v.AFrameworkApplication.K.jb("Microsoft365Ring")}static aYl(N){switch(J.cPd(N)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static jbm(N){N=J.cPd(N);switch(N){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return N}}static cPd(N){switch(N.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static moa(){return F.a.f4&&!F.a.zq}}J.p7a=9E5;Object(E.a)(J,"TellMeUtils",null,[])},1481:function(E,M,c){c.r(M);E=c(0);var m=c(497),e=c(355),a=c(55),l=c(110),y=c(73),z=c(1637),n=c(215);class v{constructor(Ra,yb,Bb,cb,Xa,hb){this.groupType=Ra;this.resultType=yb;this.Cgg=Bb;this.k8=cb;this.$ef=Xa;this.resultIndex=
hb}}Object(E.a)(v,"ClickLoggingInfo",null,[]);const A=Ra=>{const yb=[];for(;Ra;)Array.add(yb,"{ContextId:"+Ra.contextId+", IsGraphNodeContext:"+Ra.al+"}"),Ra=Ra.$j;yb.reverse();return"{"+yb.join(", ")+"}"};class w{constructor(){this.eoa=this.sessionId=null}}Object(E.a)(w,"CorrelationRecord",null,[1126]);var G=c(1501);class F{constructor(Ra,yb){this.provider=Ra;this.D7a=yb}}Object(E.a)(F,"ExternalResultProvider",null,[]);class I{constructor(Ra,yb){this.Id=null;this.TimeStamp=0;this.Id=Ra;this.TimeStamp=
yb}}Object(E.a)(I,"MRUControl",null,[]);var K=c(1622),J=c(1480),N=c(2),R=c(1362);class O{constructor(Ra,yb){this.L$j=10;this.H6=[];this.TAa=[];this.d1g=this.c1g=!1;this.fxc=this.exc="";this.QWb=yb;this.fc=Ra}xNc(){!this.c1g&&this.fc&&(this.exc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.fc.application,this.H6=this.C4h(),this.c1g=!0);return this.H6}p8l(){!this.d1g&&this.fc&&(this.fxc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.fc.application,this.TAa=this.C4h(!0),this.d1g=!0);return this.TAa}SRm(Ra){return Ra.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===Ra||"TryOfficeUpsell"===Ra}bCf(Ra){return this.dEm(Ra)||this.SRm(Ra)||J.a.KBi(Ra)?!1:!0}OYa(Ra){Ra=Ra.ControlId;this.bCf(Ra)&&(Ra=this.A5f(Ra),this.DYn(Ra),this.Z7m(),Array.insert(this.H6,0,new I(Ra,Date.now())),this.exc.length&&(Ra=JSON.stringify(this.H6),R.a.instance.setItem(this.exc,Ra)))}JE(Ra){this.Y7m();Array.insert(this.TAa,0,new I(K.a[Ra],Date.now()));this.fxc.length&&(Ra=JSON.stringify(this.TAa),R.a.instance.setItem(this.fxc,Ra))}C4h(Ra=!1){if(!this.H6.length){var yb=
Ra?R.a.instance.getItem(this.fxc):R.a.instance.getItem(this.exc);if(!yb||""===yb)return Ra?this.TAa:this.H6;let Bb=null;try{Bb=JSON.parse(yb)}catch(cb){this.AWk(Ra),Bb=null}if(!Bb||!Bb.length||10<Bb.length)return Ra?this.TAa:this.H6;yb=0;for(const cb of Bb)if(Ra||this.fc.M_d(cb.Id)&&this.bCf(cb.Id))if(Ra?Array.insert(this.TAa,yb++,cb):Array.insert(this.H6,yb++,cb),yb===this.QWb)break}return Ra?this.TAa:this.H6}g9e(Ra){Ra=this.A5f(Ra);for(const yb of this.H6)if(yb.Id===Ra)return!0;return!1}AWk(Ra=
!1){R.a.instance.setItem(Ra?this.fxc:this.exc,"")}tGm(Ra){Ra=this.A5f(Ra.ControlId);return this.bCf(Ra)?this.g9e(Ra):!1}DYn(Ra){if(0<this.H6.length){let yb=0;for(const Bb of this.H6){if(Bb.Id===Ra){Array.removeAt(this.H6,yb);break}yb++}}}A5f(Ra){return"Excel"===this.fc.application&&Ra.startsWith("m_excelWebRenderer_ewaCtl_")?Ra.substr(26,Ra.length):Ra}Z7m(){this.H6.length===this.QWb&&Array.removeAt(this.H6,this.H6.length-1)}Y7m(){this.TAa.length===this.L$j&&Array.removeAt(this.TAa,this.TAa.length-
1)}dEm(Ra){Ra=Ra.split("|");let yb="";if(6<=Ra.length)yb=Ra[0];else if(3<=Ra.length){if("3"===Ra[0])return!0;yb=Ra[1]}return yb.startsWith("WA")}static createInstance(Ra){let yb=3;N.AFrameworkApplication.K&&(yb=N.AFrameworkApplication.K.mc("TellMeMaxRecommendedResultsToReturn",3));return new O(Ra,yb)}}Object(E.a)(O,"MruControlsManager",null,[1125]);class L{constructor(Ra){this.cwb=Ra}Ifa(Ra,yb){let Bb;return Ra.$C&&(Bb=this.cwb[Ra.value])?Bb.Ifa(Ra,yb):(Bb=this.C5h(Ra.value))?Bb.Ifa(Bb.Dcn,yb):null}X5l(Ra,
yb){if(Ra=this.cwb[Ra])for(const Bb of yb)if(yb=J.a.getParameter(Bb),yb.key===Ra.$Xf)return yb.value;return null}ogn(Ra){(Ra=this.C5h(Ra))&&Ra.lgn()}C5h(Ra){const yb=Ra.indexOf(J.a.YZi);return 0<yb?this.cwb[Ra.substring(0,yb)]:null}}Object(E.a)(L,"ParameterizedCommandManager",null,[1124]);var U=c(1511);class W{constructor(Ra,yb){this.Dg=Ra;this.dnb=yb}}Object(E.a)(W,"TellMeQuery",null,[]);var X=c(1619);class V{constructor(Ra,yb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=Ra;this.TimeElapsedSinceClick=
yb}}Object(E.a)(V,"CommandClickedEvent",null,[]);var Z=c(25);class da{constructor(Ra,yb){this.eck=Ra;this.Psa=yb}resultsUpdated(Ra){this.eck(Z.c(Ra.query)?"":Ra.query.Dg,Ra.lo,Ra.attributes,this.Psa,Ra.cbc)}}Object(E.a)(da,"ResultsUpdatedCallback",null,[1123]);class aa{constructor(Ra,yb,Bb,cb,Xa){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=Ra;this.TimeElapsedSinceClick=Bb;this.CommandSurface=cb;this.CommandId=
yb;this.TerminalParentControlId=Xa}}Object(E.a)(aa,"UserActionEvent",null,[]);var ea=c(74);class na{constructor(Ra,yb){this.menuModel=Ra;this.resultCount=yb}}Object(E.a)(na,"GeneratedMenuModel",null,[]);class pa{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(E.a)(pa,"MenuModel",null,[]);class ja{constructor(Ra,yb,Bb){this.fc=Ra;this.cwb=yb;this.Nea=Bb}GIl(Ra,yb,Bb){const {TellMeActor:cb}=c(1481);let Xa=0;const hb=new pa,Cb=[];
let ob="";hb.sections=[];let ab=new ea.a;const Ib=!!this.fc&&this.fc.m3a;var Yb=!!this.fc&&this.fc.Fob||N.AFrameworkApplication.ta.Nb.Fob;for(const Ac of Ra){Ra=0;Ib||(ab=new ea.a);const Pc=new ea.a;let Mc=Ac.displayName;for(const Ed of Ac.results){if(0<=Ed.value.indexOf(J.a.Reg)){if(Ed.$C){var ub=this.cwb[Ed.value];if(ub&&Ed.value.endsWith(J.a.Reg)){if("FindParameterized"!==Ed.value&&!Yb){const ne=[];ne.push(appChrome.actions.setControlLabel(Ed.value,ub.ZPd(Ed)));ne.push(appChrome.actions.setButtonCommandValueId(Ed.value,
ub.cof(Ed)));appChrome.api.dispatch(ne)}ub=Ed.value.replace(J.a.Reg,"");ab.remove(ub)?Ra--:Pc.add(ub);ab.add(Ed.value);Ra++}}}else switch(Ed.type){case 5:Pc.contains(Ed.value)||(ab.add(Ed.value),Ra++);break;case 7:ab.add(Ed.$C);Ra++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:ab.add(Ed.value),Ra++}13===Ac.groupType&&(Mc=J.a.nha()?0<yb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,
yb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,yb));21===Ac.groupType&&(Mc=CommonUIStrings.l_LearningUILiveText)}Xa+=Ra;""!==Mc&&0<Ra&&(ob+=" , "+Ra.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Mc+" , ");0<ab.count&&!Ib&&(Ra=appChrome.api.menuSection(ab.toArray(),Ac.displayName,null,U.a[Ac.groupType]),Cb.push(Ra))}Yb=null;0<Xa&&(Yb=0<yb.length?1!==Xa?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,
Xa,yb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,yb):1!==Xa?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Xa):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,Ib?(yb=appChrome.api.menuSection(ab.toArray(),"",null,null),Cb.push(yb)):Yb+=ob);Bb&&(this.fc.Vva?cb.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Yb)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Yb)));hb.sections=
Cb;return new na(hb,Xa,[])}static get Xgf(){return ja.jTg||(ja.jTg=new na(Object.assign(new pa,{sections:[]}),0,[]))}}ja.jTg=null;Object(E.a)(ja,"TellMeMenuDefintionGenerator",null,[]);var ma;(function(Ra){Ra[Ra.TellMeControlActivated=0]="TellMeControlActivated";Ra[Ra.TellMeQueryExecuted=1]="TellMeQueryExecuted";Ra[Ra.TellMeResultsRendered=2]="TellMeResultsRendered";Ra[Ra.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(ma||(ma={}));Object(E.b)("PerformanceMarker",ma);var Ia;(function(Ra){Ra[Ra.TellMeTimeToRender=
0]="TellMeTimeToRender";Ra[Ra.TellMeSessionLength=1]="TellMeSessionLength";Ra[Ra.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(Ia||(Ia={}));Object(E.b)("PerformanceMeasure",Ia);class Ja{mark(Ra){window.performance.mark(ma[Ra])}measure(Ra,yb,Bb){const {TellMeActor:cb}=c(1481);try{window.performance.measure(Ia[Ra],ma[yb],ma[Bb])}catch(Xa){cb.instance.Oe.onError("TellMePerformance:Measure","error measuring "+Ia[Ra])}}wKf(Ra,yb,Bb){const {TellMeActor:cb}=c(1481);cb.instance.Oe.HKf(yb,Bb,Ra,this.f1l(Ra))}cXk(){var Ra=
[0,1,2,3];for(const yb of Ra)window.performance.clearMarks(ma[yb])}clearMeasures(Ra){for(const yb of Ra)window.performance.clearMeasures(Ia[yb])}f1l(Ra){let yb=0;(Ra=this.qKl(Ra))&&0<Ra.length&&(yb=Ra[Ra.length-1].duration);return yb}qKl(Ra){return window.performance.getEntriesByName(Ia[Ra],"measure")}}Object(E.a)(Ja,"TellMePerformance",null,[]);var Ka=c(1548),Ma=c(1547),sa=c(35);class xa{constructor(Ra){this.Xkk=Ra}EKb(Ra,yb,Bb){const {TellMeActor:cb}=c(1481);cb.instance.Oe.u0(yb,Ma.a.ogc,Ra.data.Qe.toString(),
Math.round(window.performance.now()-Bb),Ma.a.ogc,!0,Ka.a.yPa);Ra=sa.b(Ra.data.xe);yb=-1;Ra.Index&&(yb=Ra.Index);cb.instance.Oe.B4m(yb,this.Xkk)}lKb(Ra,yb,Bb){const {TellMeActor:cb}=c(1481);cb.instance.Oe.u0(yb,Ma.a.ogc,Ra.data.Qe.toString(),Math.round(window.performance.now()-Bb),Ma.a.ogc,!1,Ka.a.yPa)}v8l(Ra){if(Ra&&""!==Ra.trim()){const Bb=window.performance.now(),cb=N.AFrameworkApplication.mxj;var yb={};yb.Text=Ra;yb.IsFileHash="false";yb=sa.c(yb);N.AFrameworkApplication.Ne.sj(cb,2,yb,{"Content-Type":"application/json",
Accept:"application/json"},!1,0,Xa=>{this.EKb(Xa,Ra.length,Bb)},Xa=>{this.lKb(Xa,Ra.length,Bb)},null,null,!1,4E3,6E3)}}}Object(E.a)(xa,"TellMeQueryIndexCallback",null,[]);var ia=c(1483);class ha{constructor(Ra,yb,Bb){this.xml=Ra;this.resultCount=yb;this.Dnl=Bb}}Object(E.a)(ha,"GeneratedMenuXml",null,[]);var ua=c(1710),ya=c(19);class ra{constructor(Ra,yb){this.bgd=Ra||{};this.gXa=yb}get ZMb(){return 5}Ifa(Ra,yb=null){return this.gXa.Ifa(Ra,yb)||this.HLk(Ra.value)}HLk(Ra){return ra.q4e(Ra,this.bgd[Ra]||
null)}static q4e(Ra,yb=null){Ra=String.format('<ClonedControl Id="{0}" ',Ra);for(let Xa in yb){var Bb=Xa,cb=yb[Xa];cb=cb?ya.a.Af(cb.toString()):"";Ra+=String.format('{0}="{1}" ',Bb,cb)}return Ra+"/>"}}Object(E.a)(ra,"CommandMenuItemFactory",null,[1120]);var La=c(160);class oa{constructor(){this.W1j=CommonUIStrings.l_FindInDocumentText}get ZMb(){return 8}Ifa(Ra){var yb=Ra.$C;Ra=ya.a.Af(Ra.value);const Bb=ya.a.Af(yb);yb=ya.a.Af(String.format(this.W1j,yb));return this.THl(Ra,Bb,yb)}THl(Ra,yb,Bb){return La.a(Ra,
"1540292897",Bb,J.a.oBl,null,yb,Bb,null,null)}}Object(E.a)(oa,"FindInDocumentMenuItemFactory",null,[1120]);var Ca=c(1711),Aa=c(1709),db=c(1712);class eb{get ZMb(){return 7}Ifa(Ra){const yb=Object(y.a)(X.a,Ra);return this.PIl(ya.a.Af(Ra.value),yb.id)}PIl(Ra,yb){return La.a(yb,"1404166600",Ra,null,null,Ra,Ra,null,null)}}Object(E.a)(eb,"TryQueryMenuItemFactory",null,[1120]);class ib{constructor(Ra){this.i6=[];this.fc=Ra}vUl(Ra){for(const yb of this.i6)if(yb.ZMb===Ra)return yb;return null}ha(Ra){this.i6.push(Ra)}MSn(Ra){this.ha(new ra(this.fc.P4k,
Ra));this.ha(new db.a(this.fc.dfn));this.ha(new ua.a(this.fc.v$n,this.fc.u$n,this.fc.cGo,this.fc.wqm,this.fc.Zpo));this.ha(new Aa.InsightsMenuItemFactory);this.ha(new oa);this.ha(new Ca.a);this.ha(new eb)}}Object(E.a)(ib,"MenuItemFactoryRegistry",null,[]);var lb=c(1484);class Ya{constructor(Ra,yb){this.fc=Ra;this.e6g=new ib(this.fc);this.e6g.MSn(yb)}HIl(Ra,yb){let Bb=0;const cb=[],Xa=[];for(const Cb of Ra){Ra=J.a.kig;var hb=[];for(const ob of Cb.results){const ab=this.e6g.vUl(ob.type).Ifa(ob,yb);
Ra=J.a.kig;hb.push(ab);if(13===ob.type||14===ob.type)Ra="Menu32";17===ob.type&&(Ra="MenuTellMeExtended");ob.groupType=Cb.groupType;Xa.push(Object(y.a)(lb.a,ob))}Bb=Bb?Bb:hb.length;hb=La.d("TellMeDropdownControls",hb);Ra=La.g("TellMeDropdownMenuSection",hb,Ra,Cb.displayName);cb.push(Ra)}yb=La.h(cb,"LookupDropdownMenu");return new ha(yb,Bb,Xa)}static get MJd(){return Ya.kTg||(Ya.kTg=new ha(La.h([],"LookupDropdownMenu"),0,[]))}}Ya.kTg=null;Object(E.a)(Ya,"TellMeXmlGenerator",null,[]);class Fa{}Fa.vdn=
"MRU";Fa.test="Test";Object(E.a)(Fa,"ActionType",null,[]);var $a=c(1531),Db;(function(Ra){Ra[Ra.Service=0]="Service";Ra[Ra.Local=1]="Local";Ra[Ra.MRU=2]="MRU";Ra[Ra.TestResult=3]="TestResult";Ra[Ra.Unknown=4]="Unknown"})(Db||(Db={}));Object(E.b)("SubResultType",Db);var gc=c(82);class Eb{constructor(Ra,yb,Bb,cb,Xa=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=Ra;this.IsEnabled=yb;this.ResultType=K.a[Bb];this.SubResultType=Db[cb];
this.OptionalData=Xa?gc.a.toJSON(Xa):null}}Object(E.a)(Eb,"ResultInfo",null,[]);var kb=c(111),bb=c(185),Gb=c(288);class Sa{constructor(Ra,yb=null){this.mld="TellMeWAC.";this.Hdk=Ra;this.Zlk=yb}sHa(Ra,yb,Bb){yb=kb.a.wC(yb);Ra=kb.a.obf(Ra,this.Hdk,this.Zlk,Bb,yb);bb.a.sHa(Ra,this.mld)}rHa(Ra,yb,Bb=0){yb=kb.a.wC(yb);bb.a.rHa(Object.assign(new Gb.a,{name:Ra,dataFields:yb,durationMs:Bb}),this.mld)}}Object(E.a)(Sa,"TellMeOtelLogger",null,[1142]);var Pa=c(136);class Ab{constructor(Ra,yb,Bb,cb,Xa,hb,Cb){this.J6=
this.gaa=this.ROg=null;this.Dza=Ra;this.hTb=yb;this.ULa=Bb;this.Bab=cb;this.uWa=Xa;this.A8j=hb;this.J6=Cb?Cb:new Sa(this.Bab?n.CuiHelper.Qeg:n.CuiHelper.Vke)}get Yq(){return this.Bab}get Kpa(){return this.ULa}Qge(Ra){this.ROg=Ra;switch(Ra){case ia.a.contextMenu:this.gaa=ia.a.contextMenu;break;default:this.gaa=ia.a.tellMe}}CIk(Ra,yb){this.ULa.eoa||(this.ULa.eoa=Pa.a.create().toString(),this.jIi(Ra,!0,yb))}lVh(Ra,yb=!0){this.ULa.eoa&&this.I0m(Ra,yb);this.Bab&&appChrome.api.updateTellMeCorrelationId("");
this.ULa.eoa=null}jIi(Ra,yb,Bb){const {TellMeActor:cb}=c(1481),Xa=this.J7(G.a.r2a);Xa[$a.a.culture]=this.hTb;Xa[$a.a.appName]=this.Dza;Xa[$a.a.context]=Ra;Xa[$a.a.$Zd]=this.uWa;Xa[$a.a.QRm]=this.A8j;Xa[$a.a.BQm]=Bb;Xa[$a.a.MKm]=yb;Xa[$a.a.contentType]=cb.instance.qHd;this.J6.sHa(G.a.r2a,Xa,this.ROg);this.Bab&&appChrome.api.updateTellMeCorrelationId(this.ULa.eoa)}I0m(Ra,yb){const Bb=this.J7(G.a.BGb);Bb[$a.a.Cql]=Ra;Bb[$a.a.LKm]=yb;this.J6.rHa(G.a.BGb,Bb)}A4m(Ra,yb,Bb){let cb=0;!Bb&&0<Ra.length&&(cb=
Ra.trim().split(" ").length);const Xa=this.J7(G.a.query);Xa[$a.a.query]="!";Xa[$a.a.TLb]=yb;Xa[$a.a.t4i]=Ra.length;Xa[$a.a.aDi]=Bb;Xa[$a.a.N4o]=cb;this.J6.sHa(G.a.query,Xa,this.gaa)}u2m(Ra,yb,Bb,cb,Xa,hb,Cb,ob=null){const ab=this.J7(G.a.latency);ab[$a.a.culture]=this.hTb;ab[$a.a.t4i]=Ra;ab[$a.a.tCj]=yb;ab[$a.a.statusCode]=Bb;ab[$a.a.service]=Xa;ab[$a.a.isSuccess]=hb;ab[$a.a.YVm]=Cb;ob&&(ab[$a.a.FIo]=ob);this.J6.rHa(G.a.latency,ab,cb)}HKf(Ra,yb,Bb,cb){const Xa=this.J7(G.a.performance);Xa[$a.a.culture]=
this.hTb;Xa[$a.a.GIk]=ma[Ra];Xa[$a.a.Vsl]=ma[yb];Xa[$a.a.nAn]=Ia[Bb];this.J6.rHa(G.a.performance,Xa,cb)}L4m(Ra,yb){var {TellMeActor:Bb}=c(1481);const {CommandResultsUtility:cb}=c(1520);if(Ra.results.length){var Xa=this.J7(G.a.ebj);Xa[$a.a.k8]=yb.toString();Xa[$a.a.groupType]=U.a[Ra.groupType];16===Ra.groupType&&(Xa[$a.a.aQm]=Bb.instance.obd);yb=[];Bb=[];var hb=[];for(const Cb of Ra.results)Xa[$a.a.resultType]||(Xa[$a.a.resultType]=K.a[Cb.type]),Ra={},27===Cb.type&&(Ra.AssetId=Cb.GI),Bb.push(cb.tTc(Cb.value)),
yb.push(Cb.value),hb.push(new Eb(Cb.value,cb.tTc(Cb.value),Cb.type,Cb.uvj,Ra));0<yb.length&&(Xa[$a.a.A5n]="{"+yb.join(", ")+"}",Xa[$a.a.xsl]="{"+Bb.join(", ")+"}",Xa[$a.a.w5n]=sa.c(hb));this.J6.sHa(G.a.ebj,Xa,this.gaa)}}uJl(Ra,yb){if(4===Ra)return Fa.vdn;switch(yb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return K.a[yb]}d0m(Ra,yb,Bb,cb,Xa){const hb=this.J7(G.a.click);hb[$a.a.tCj]=Ra;hb[$a.a.lyn]=yb;hb[$a.a.commandId]=
Bb;hb[$a.a.l3]=cb;hb[$a.a.actionType]=this.uJl(Xa.groupType,Xa.resultType);hb[$a.a.resultType]=K.a[Xa.resultType];hb[$a.a.Cgg]=Db[Xa.Cgg];hb[$a.a.groupType]=U.a[Xa.groupType];hb[$a.a.k8]=Xa.k8.toString();hb[$a.a.$ef]=Xa.$ef.toString();hb[$a.a.resultIndex]=Xa.resultIndex.toString();this.J6.sHa(G.a.click,hb,this.gaa)}j0m(Ra,yb){this.ULa.eoa||(this.ULa.eoa=Pa.a.create().toString(),this.jIi("",!1,yb));yb=this.J7(G.a.lIh);yb[$a.a.TLb]=Ra;this.J6.rHa(G.a.lIh,yb)}FIi(Ra,yb,Bb){if(Ra){if(Bb)for(let cb in Bb)Ra[cb]=
Bb[cb];this.J6.rHa(G.a.events,Ra,yb)}}DG(Ra,yb,Bb=null){const cb=this.J7(G.a.events);cb[$a.a.event]=Ra;this.FIi(cb,Math.round(yb),Bb)}PFa(Ra,yb,Bb=null){const cb=this.J7(G.a.events);cb[$a.a.event]=G.a.error;cb[$a.a.module]=Ra;cb[$a.a.errorMessage]=yb;cb[$a.a.message]=yb;this.FIi(cb,Math.round(window.performance.now()),Bb)}b0m(Ra){const yb=this.J7(G.a.mFh);yb[$a.a.value]=Ra;yb[$a.a.dce]=this.Bab;this.J6.sHa(G.a.mFh,yb,this.gaa)}u_m(Ra){const yb=this.J7(G.a.kmh);yb[$a.a.value]=Ra;yb[$a.a.dce]=this.Bab;
this.J6.sHa(G.a.kmh,yb,this.gaa)}i1m(Ra){const yb=this.J7(G.a.fZh);yb[$a.a.value]=Ra;yb[$a.a.dce]=this.Bab;this.J6.sHa(G.a.fZh,yb,this.gaa)}y4m(Ra){const yb=this.J7(G.a.M3i);yb[$a.a.value]=Ra;yb[$a.a.dce]=this.Bab;this.J6.sHa(G.a.M3i,yb,this.gaa)}J_m(Ra){const yb=this.J7(G.a.zij);yb[$a.a.value]=Ra;this.J6.sHa(G.a.zij,yb,this.gaa)}C4m(Ra,yb){const Bb=this.J7(G.a.o4i);Bb[$a.a.ogc]=Ra;yb&&(Bb[$a.a.eoa]=yb);this.J6.rHa(G.a.o4i,Bb)}J7(Ra){return{["SessionID"]:this.ULa.sessionId,["CorrelationID"]:this.ULa.eoa,
["Time"]:(new Date).getTime(),["Event"]:Ra,["Scenario"]:this.gaa}}}Object(E.a)(Ab,"UsageLogger",null,[1122]);var nb=c(65),Rb=c(1660),Mb=c(1197),oc=c(1517),xb=c(92),cc=c(26),Ob=c(220),Ub=c(527),pb=c(20),Zb=c(741),Wa=c(67),Lb=c(13);c.d(M,"TellMeActor",function(){return qc});class qc{constructor(){this.gXa=this.A2=this.Ub=this.Ma=this.EP=this.Gz=this.Hb=this.ga=this.Oe=this.pK=this.GJe=this.Blh=this.Zka=this.fc=null;this.gWb=!1;this.sve=[];this.NOg=[];this.jkh=[];this.T6g=[];this.U6g=[];this.P1g=!1;
this.$Sb=this.Nea=null;this.dvc=this.uWa=!1;this.Pod=!0;this.OZ=this.buc=this.$Wg=this.WJe=this.F6g=null;this.VY=[];this.R9a=this.CTb=this.dAa=this.Srd=this.Xfh=null;this.wVb=!1;this.PJe=0;this.zSb=null;this.Psa=-1;this.g6g=0;this.lvc=!1;this.t$a=null;this.ekh=!1;this.BSb=this.Hp=null}get qHd(){return this.EP?this.EP.contentType:qc.unknown}get actions(){return this.VY}set actions(Ra){this.VY=Ra}rSd(){return this.Oe?this.Oe.Kpa.eoa:null}yO(){return this.fc}get hcn(){return this.Pod}get H0o(){return this.F6g}performance(){return this.pK}get Ieg(){return this.Xfh}set Ieg(Ra){this.Xfh=
Ra}get obd(){return this.ekh}set obd(Ra){this.ekh=Ra}VG(Ra){const yb=window.performance.now();this.Nea&&!Z.c(Ra)&&(this.Nea(Ra),this.Oe.DA(G.a.VG,window.performance.now()-yb))}initialize(Ra,yb=null,Bb=null,cb=null,Xa=null,hb=null,Cb=null,ob=null,ab=null,Ib=null,Yb=null){const {InteractionLogger:ub}=c(1938),{GroupsPlacementInfo:Ac}=c(1934),{AggregatorResultsProvider:Pc}=c(1738);this.fc=Ra;this.uWa=!!N.AFrameworkApplication.ta&&N.AFrameworkApplication.ta.Nb.rbc;this.Oe=cb;if(!cb){cb=new w;cb.sessionId=
N.AFrameworkApplication.userSessionId;const Mc=Zb.a.og(N.AFrameworkApplication.lcid)||Zb.a.WSc;this.Oe=new ub(new Ab(this.fc.application,Mc.name,cb,this.fc.Yq,this.uWa,Ra.KTa,null),this.fc.W4k,this.fc)}this.gXa=new L(this.fc.parameterData);this.Blh=Bb||new Ya(this.fc,this.gXa);this.Nea=Cb;this.GJe=this.GJe||new ja(this.fc,this.fc.parameterData,Cb);this.Ub=nb.FocusManager.instance();this.A2=O.createInstance(this.fc);this.$Wg=new Ac(Ra);this.ga=Xa||N.AFrameworkApplication.va;this.Hb=hb||N.AFrameworkApplication.nc;
this.Gz=ab;this.Zka=yb;this.Hp=Yb;this.pK=new Ja;this.BSb=new m.a(e.a.ei());this.Srd=[];ab?ab.execute(Mc=>{Mc.isFeatureEnabled(qc.SFo,!0).then(Ed=>{const {AggregatorResultsProvider:ne}=c(1738);this.lvc=Ed;this.Zka=this.Zka||ne.createInstance(this.A2,this.fc,this.gXa,this.lvc);for(const Ie of this.Srd)this.Zka.JE(Ie.provider,Ie.D7a);this.Srd=[];return null})}):(this.lvc=!0,this.Zka=this.Zka||Pc.createInstance(this.A2,this.fc,this.gXa,this.lvc));this.Ma=ob;this.dAa=Ya.MJd;this.F6g=new Promise(Mc=>{this.WJe=
Mc});Ib&&Ib.execute(Mc=>{this.EP=Mc});this.fc.Yq&&J.a.AAi()&&(Ra=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.fc.application),appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(Ra,Ra)))}Tb(){this.muk()}hUn(Ra){this.buc=Ra}muk(){this.ga.fb(Lb.a.tellMe,Wa.a.frame,Object(a.a)(this,this.tellMe,"tellMe"),96);this.ga.fb(Lb.a.jig,Wa.a.frame,Object(a.a)(this,this.Xyh,"cacheAsyncMenuRefreshFunction"),96);this.ga.fb(Lb.a.oig,Wa.a.frame,Object(a.a)(this,this.XIi,"logItemExecuted"),
96);this.ga.fb(Lb.a.sig,Wa.a.frame,Object(a.a)(this,this.tIi,"logControlDeactivation"),96);this.ga.fb(Lb.a.qig,Wa.a.frame,Object(a.a)(this,this.TIi,"logInputFocus"),96);this.ga.fb(Lb.a.mig,Wa.a.frame,Object(a.a)(this,this.r2a,"interactionBegin"),96);this.ga.fb(Lb.a.uig,Wa.a.frame,Object(a.a)(this,this.r2a,"interactionBegin"),96);this.ga.fb(Lb.a.pig,Wa.a.frame,Object(a.a)(this,this.SIi,"logInputBlur"),96);this.ga.fb(Lb.a.tig,Wa.a.frame,Object(a.a)(this,this.sIi,"logControlActivated"),96);this.ga.fb(Lb.a.Q9c,
Wa.a.frame,Object(a.a)(this,this.n0h,"focusSearchBox"),96);this.ga.fb(Lb.a.iig,Wa.a.frame,Object(a.a)(this,this.gHh,"constructLiveNotificationForMenu"),96);this.ga.fb(Lb.a.vig,Wa.a.frame,Object(a.a)(this,this.DAf,"insertTryQuery"),96);this.ga.fb(Lb.a.aJf,Wa.a.frame,Object(a.a)(this,this.DAf,"insertTryQuery"),96);this.ga.fb(Lb.a.wjf,Wa.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Lb.a.xjf,Wa.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Lb.a.yjf,Wa.a.frame,
Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Lb.a.zjf,Wa.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Lb.a.Ajf,Wa.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Lb.a.yWf,Wa.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Lb.a.zWf,Wa.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Lb.a.AWf,Wa.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Lb.a.GYf,Wa.a.frame,Object(a.a)(this,this.n2a,
"insertMention"),96);this.ga.fb(Lb.a.HYf,Wa.a.frame,Object(a.a)(this,this.n2a,"insertMention"),96);this.ga.fb(Lb.a.IYf,Wa.a.frame,Object(a.a)(this,this.n2a,"insertMention"),96);this.ga.fb(Lb.a.lig,Wa.a.frame,Object(a.a)(this,this.TXi,"openFeedback"),96);this.ga.fb(Lb.a.wig,Wa.a.frame,Object(a.a)(this,this.DRa,"openOrInsertUrl"),96);this.ga.fb(Lb.a.B_e,Wa.a.frame,Object(a.a)(this,this.u0d,"launchAddin"),96);this.ga.fb(Lb.a.C_e,Wa.a.frame,Object(a.a)(this,this.u0d,"launchAddin"),96);this.ga.fb(Lb.a.D_e,
Wa.a.frame,Object(a.a)(this,this.u0d,"launchAddin"),96);this.ga.fb(Lb.a.TOb,Wa.a.frame,Object(a.a)(this,this.TOb,"showTellMeCoachmark"),96);this.ga.fb(Lb.a.vIf,Wa.a.frame,Object(a.a)(this,this.mEi,"launchAddinStore"),96);this.ga.fb(Lb.a.n2f,Wa.a.frame,Object(a.a)(this,this.Q4i,"quickActionOnFileHandler"),96);this.ga.fb(Lb.a.smf,Wa.a.frame,Object(a.a)(this,this.E2h,"generateSlidesFromFiles"),96)}eSn(Ra){this.Pod=!1;const yb=window.performance.now();Ra.J3a.isCompleted?(this.Pod=!0,this.WJe(!0)):Ra.UZ(()=>
{this.Pod=!0;this.WJe(!0);this.Oe.DA(G.a.jjl,window.performance.now()-yb)});this.QSn(Ra)}QSn(Ra){Ub.a.u3c(Object(a.a)(this,this.MId,"dispatcher"));Ub.a.CKc([new Ob.a(Lb.a.tellMe,Wa.a.frame,96),new Ob.a(Lb.a.jig,Wa.a.frame,96),new Ob.a(Lb.a.oig,Wa.a.frame,96),new Ob.a(Lb.a.sig,Wa.a.frame,96),new Ob.a(Lb.a.qig,Wa.a.frame,96),new Ob.a(Lb.a.mig,Wa.a.frame,96),new Ob.a(Lb.a.uig,Wa.a.frame,96),new Ob.a(Lb.a.pig,Wa.a.frame,96),new Ob.a(Lb.a.tig,Wa.a.frame,96),new Ob.a(Lb.a.Q9c,Wa.a.frame,96),new Ob.a(Lb.a.iig,
Wa.a.frame,96),new Ob.a(Lb.a.vig,Wa.a.frame,96),new Ob.a(Lb.a.aJf,Wa.a.frame,96),new Ob.a(Lb.a.wjf,Wa.a.frame,96),new Ob.a(Lb.a.xjf,Wa.a.frame,96),new Ob.a(Lb.a.yjf,Wa.a.frame,96),new Ob.a(Lb.a.zjf,Wa.a.frame,96),new Ob.a(Lb.a.Ajf,Wa.a.frame,96),new Ob.a(Lb.a.yWf,Wa.a.frame,96),new Ob.a(Lb.a.zWf,Wa.a.frame,96),new Ob.a(Lb.a.AWf,Wa.a.frame,96),new Ob.a(Lb.a.GYf,Wa.a.frame,96),new Ob.a(Lb.a.HYf,Wa.a.frame,96),new Ob.a(Lb.a.IYf,Wa.a.frame,96),new Ob.a(Lb.a.lig,Wa.a.frame,96),new Ob.a(Lb.a.wig,Wa.a.frame,
96),new Ob.a(Lb.a.B_e,Wa.a.frame,96),new Ob.a(Lb.a.C_e,Wa.a.frame,96),new Ob.a(Lb.a.D_e,Wa.a.frame,96),new Ob.a(Lb.a.TOb,Wa.a.frame,96),new Ob.a(Lb.a.vIf,Wa.a.frame,96),new Ob.a(Lb.a.n2f,Wa.a.frame,96),new Ob.a(Lb.a.smf,Wa.a.frame,96)],Ra)}MId(Ra,yb,Bb,cb,Xa){if(yb.contextId===Wa.a.frame)switch(Ra){case Lb.a.tellMe:return this.tellMe(Ra,yb,Bb,cb,Xa);case Lb.a.jig:return this.Xyh(Ra,yb,Bb,cb,Xa);case Lb.a.oig:return this.XIi(Ra,yb,Bb,cb,Xa);case Lb.a.sig:return this.tIi(Ra,yb,Bb,cb,Xa);case Lb.a.qig:return this.TIi(Ra,
yb,Bb,cb,Xa);case Lb.a.mig:return this.r2a(Ra,yb,Bb,cb,Xa);case Lb.a.uig:return this.i5n(Bb);case Lb.a.pig:return this.SIi(Ra,yb,Bb,cb,Xa);case Lb.a.tig:return this.sIi(Ra,yb,Bb,cb,Xa);case Lb.a.Q9c:return this.n0h(Ra,yb,Bb,cb,Xa);case Lb.a.iig:return this.gHh(Ra,yb,Bb,cb,Xa);case Lb.a.vig:case Lb.a.aJf:return this.DAf(Ra,yb,Bb,cb,Xa);case Lb.a.wjf:case Lb.a.xjf:case Lb.a.yjf:case Lb.a.zjf:case Lb.a.Ajf:case Lb.a.yWf:case Lb.a.zWf:case Lb.a.AWf:case Lb.a.wig:return this.DRa(Ra,yb,Bb,cb,Xa);case Lb.a.GYf:case Lb.a.HYf:case Lb.a.IYf:return this.n2a(Ra,
yb,Bb,cb,Xa);case Lb.a.lig:return this.TXi(Ra,yb,Bb,cb,Xa);case Lb.a.B_e:case Lb.a.C_e:case Lb.a.D_e:return this.u0d(Ra,yb,Bb,cb,Xa);case Lb.a.TOb:return this.TOb(Ra,yb,Bb,cb,Xa);case Lb.a.vIf:return this.mEi(Ra,yb,Bb,cb,Xa);case Lb.a.n2f:return this.Q4i(Ra,yb,Bb,cb,Xa);case Lb.a.smf:return this.E2h(Ra,yb,Bb,cb,Xa)}return 2}n0h(Ra,yb,Bb){if(1===Bb)return 32;this.nmj();Ra=!1;(this.fc.KTa||this.uWa)&&(yb=document.getElementById("SearchButton"))&&yb.click();if(!this.fc.KTa&&this.uWa)for(yb=document.getElementsByClassName("ms-suiteux-search-box"),
Bb=0;Bb<yb.length;Bb++){const cb=yb[Bb].querySelector("input[type=search]");cb&&(Ra=nb.FocusManager.OJ(cb))}else Ra=nb.FocusManager.OJ($get(this.fc.Yq?n.CuiHelper.Qeg:n.CuiHelper.Vke));this.dvc=!0;return Ra?32:8}DAf(Ra,yb,Bb,cb,Xa){if(1===Bb)return 32;if(Z.c(Xa))return this.Oe.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.nmj();Ra=Xa.CommandValueId;yb=this.fc.Yq?n.CuiHelper.Qeg:n.CuiHelper.Vke;this.fc.Yq&&!Z.c(Xa[Mb.a.fTa])&&(Xa[Mb.a.fTa]=!1);if(Ra){if(this.fc.Yq)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Ra)),
this.t$a=[19],32;if(Xa=$get(yb))Xa.value=Ra}return nb.FocusManager.OJ($get(yb))?32:8}nmj(){this.Ub.kL(this.fc.KTa||this.uWa?this.fc.CFb:this.fc.T5a,!1)}lJl(Ra,yb){switch(Ra){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,yb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,yb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,yb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
yb)}return yb}gHh(Ra,yb,Bb,cb,Xa){if(1===Bb)return 32;if(Z.c(Xa))return this.Oe.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;Ra=this.dAa?this.dAa.resultCount:0;Xa.Value=1!==Ra?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Ra):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.dAa)for(const hb of this.dAa.Dnl)Xa=Object(l.a)(X.a,hb)?hb.id:ya.a.replaceAll(hb.value,'"',""),(Xa=$get(Xa+"-"+J.a.kig))&&cc.a.gr(Xa,cc.a.dfa,
ya.a.Af(this.lJl(hb.groupType,Xa.innerText)));return 32}Xyh(Ra,yb,Bb,cb,Xa){if(1===Bb)return 32;if(Z.c(Xa))return this.Oe.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.zSb=new xb.a(2,1,0,()=>{Xa[Rb.a.Callback]()},97);this.dAa&&this.Hb.Vb(this.zSb);return 32}XIi(Ra,yb,Bb,cb,Xa){if(1===Bb)return 32;if(Z.c(Xa))return this.Oe.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;Xa.CloseAllMenus&&(Ra=void 0===Xa.ParentControlId||null===Xa.ParentControlId?
"<NA>":Xa.ParentControlId,yb=this.$Sb?this.$Sb[Xa.ControlId]:null,!yb&&this.$Sb&&"<NA>"!==Ra&&(yb=this.$Sb[Ra]),yb||(yb=this.gWb&&this.A2.tGm(Xa),yb=this.Bkl(yb,Xa.ControlId),yb=new v(yb,32,4,-1,-1,-1),this.Oe.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+Xa.ControlId+" determined group:"+U.a[yb.groupType])),this.Oe.nkn(Xa.ControlId,Ra,Xa.CommandId,Xa.CloseAllMenus,yb),this.gXa.ogn(Xa.ControlId),Xa.Location!==ia.a.contextMenu&&(this.A2.OYa(Xa),this.A2.JE(yb.resultType),this.fc.Ohe&&
this.Zka.csk(Xa.CommandId)));return 32}tIi(Ra,yb,Bb,cb,Xa){if(1===Bb)return 32;(new xa(this.rSd())).v8l(this.CTb);Ra=this.CTb;yb=this.Psa;Bb=this.Oe.Cgd;if(Z.c(Xa))return this.Oe.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;Xa=Xa.UILocation;Ra&&0<Ra.length&&this.lvc&&J.a.Qcg(this.fc)&&this.fc.w_d&&19!==Xa&&yb>Bb&&!this.fc.pP&&(this.Oe.KKf(Ra),this.Oe.cag(yb));this.Oe.X3n();this.fc.aoe&&19!==Xa&&(this.pK.mark(3),this.pK.measure(1,0,3),this.pK.measure(2,2,3),this.pK.wKf(0,
1,2),this.pK.wKf(2,2,3),this.pK.wKf(1,0,3),this.pK.cXk(),this.pK.clearMeasures([0,2,1]));this.Oe.Ukn(window.performance.now()-this.PJe);this.fc.Yq&&(this.R9a=null,this.Oe.rxa());this.dvc=this.wVb=!1;this.CTb="";return 32}TIi(Ra,yb,Bb){if(1===Bb)return 32;this.Oe.Xlb(A(yb),this.dvc);return 32}SIi(Ra,yb,Bb){if(1===Bb)return 32;this.Oe.rxa();this.wVb=!1;return 32}sIi(Ra,yb,Bb,cb,Xa){if(1===Bb)return 32;this.OZ=null;Xa&&(this.OZ=Xa);this.fc.aoe&&(Z.c(this.OZ)||this.OZ.Location!==ia.a.contextMenu)&&this.pK.mark(0);
this.Oe.Qge(Z.c(this.OZ)||Z.c(this.OZ.Location)?ia.a.unknown:this.OZ.Location);this.Oe.Tkn(this.g6g,this.dvc);this.wVb||this.A4a();return 32}KKh(Ra,yb){const Bb=[],cb=Date.now();for(let Xa of Ra)Ra=(cb-Xa.timeStamp)/1E3,Ra=J.a.gme(Ra),Array.add(Bb,new V(yb?Xa.commandId:Xa.controlId,Ra));return Bb}Zdl(Ra){const yb=[],Bb=Date.now();for(let cb of Ra)if(cb.controlId||"keyboardShortcut"===cb.commandSurface)Ra=(Bb-cb.timeStamp)/1E3,Ra=J.a.gme(Ra),Array.add(yb,new aa(cb.controlId,cb.commandId,Ra,cb.commandSurface,
cb.$ke));return yb}tLh(Ra=!1){var yb=Ra?this.A2.p8l():this.A2.xNc();Ra=[];const Bb=Date.now();for(const cb of yb)yb=(Bb-cb.TimeStamp)/1E3,yb=J.a.gme(yb),Array.add(Ra,new V(cb.Id,yb));return Ra}A4a(){if(!this.wVb){this.gWb=this.wVb=!0;""!==this.fc.s9f&&N.AFrameworkApplication.Cn(this.fc.s9f);if(!this.P1g){this.P1g=!0;const Ra={};Ra.IsMLREnabled=this.fc.nMm;Ra.IsReactRibbonEnabled=this.fc.Yq;Ra.IsSharedHeaderEnabled=!!N.AFrameworkApplication.ta&&N.AFrameworkApplication.ta.Nb.oJ;Ra.IsSearchUxEnabled=
this.uWa;Ra.IsTellMeInHeaderEnabled=this.fc.KTa;Ra.IsGoLocalEnv=J.a.CJm();Ra.IsSovereignEnvironment=J.a.wbc();Ra.IsTellMeServiceResultsEnabled=J.a.Qcg(this.fc);Ra.IsSubstrateProviderEnabled=J.a.Pcg(this.fc);Ra.ShouldFetchTokens=!!N.AFrameworkApplication.ta&&N.AFrameworkApplication.ta.Nb.zOb;Ra.IsSerpletEnabled=J.a.nha();Ra.FirstOnClickTimeInMS=Math.round(window.performance.now());Ra.IsHeaderHidden=N.AFrameworkApplication.hideHeader||N.AFrameworkApplication.IX;Ra.IsSearchInHeaderHidden=N.AFrameworkApplication.UQc;
void 0!==window.performance.timing&&null!==window.performance.timing&&(Ra.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));Ra.IsFindWithMatchesEnabled=this.fc.RLd;Ra.HelpShowsTopSearchResult=this.fc.K7c;Ra.HelpShowsNumberOfMatches=this.fc.J7c;N.AFrameworkApplication.K&&(Ra.UiHost=N.AFrameworkApplication.K.jb("UiHostIntegrationType"));this.Oe.f5m(JSON.stringify(Ra))}this.sve=this.KKh(z.a.instance.oNc(),!1);this.NOg=this.KKh(z.a.instance.Vgb(),!0);this.jkh=this.Zdl(z.a.instance.Vgb());
this.T6g=this.tLh();this.U6g=this.tLh(!0);this.Oe.A4a()}}r2a(Ra,yb,Bb,cb,Xa){if(1===Bb)return 32;if(Z.c(Xa))return this.Oe.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(pb.a.qUc)return 32;this.PJe=window.performance.now();this.A4a();Ra=new da(Object(a.a)(this,this.xxa,"onRequestCompleted"),0);this.Psa++;this.Oe.beginQuery("",this.Psa,this.gWb);this.$lg(!0,null);this.dAa=Ya.MJd;this.R9a=ja.Xgf;if(this.Zka)qc.instance.actions=[],this.Zka.MH(new W("",this.Psa),Ra,this.fc.Yq);
else this.Oe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.zSb&&this.Hb.Vb(this.zSb);return 32}i5n(Ra){if(1===Ra)return 32;this.Ub.yR(this.fc.KTa||this.uWa?this.fc.CFb:this.fc.T5a,!1);return 32}tellMe(Ra,yb,Bb,cb,Xa){if(1===Bb)return 32;if(Z.c(Xa))return this.Oe.onError("TellMeActor:TellMe","actiondata comes null"),16;this.OZ=Xa;this.Oe.Qge(Z.c(this.OZ.Location)?ia.a.unknown:this.OZ.Location);Ra=this.OZ.Value;this.fc.Yq||Ra&&""!==Ra.trim()?(!this.R9a&&this.fc.Yq&&
(this.Oe.Xlb(A(yb),this.dvc),this.A4a()),this.Bwl(Ra,this.OZ.Location),this.OZ.PopulationXML=this.dAa.xml):this.gWb?this.OZ.PopulationXML=this.dAa.xml:(this.OZ.PopulationXML=Ya.MJd.xml,this.R9a=ja.Xgf,this.CTb="");return 32}Bwl(Ra,yb){this.PJe=window.performance.now();this.fc.aoe&&yb!==ia.a.contextMenu&&this.pK.mark(1);this.fc.Yq&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Ra));Ra&&0<Ra.trim().length&&(this.gWb=!1);this.fc.Xul();yb=Z.c(yb)?ia.a.tellMe:yb;if(Ra!==this.CTb||this.fc.Yq){this.Psa++;
this.Oe.beginQuery(Ra,this.Psa,this.gWb);this.$lg(!0,null);const Bb=new W(Ra,this.Psa),cb=new da(Object(a.a)(this,this.xxa,"onRequestCompleted"),this.Psa);this.dAa=Ya.MJd;this.R9a=ja.Xgf;if(this.Zka)qc.instance.actions=[],this.Zka.MH(Bb,cb,this.fc.Yq,yb,this.t$a),this.t$a=null;else this.Oe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.g6g=this.Psa;this.CTb=Ra}}aUo(Ra){if(this.fc.Yq){var yb=appChrome.selectors.getActiveControlStates();if(yb=Object(y.a)(Object,
yb[Ra.value])){Ra.label=yb.label;let Bb=null;"description"in yb&&(Bb=yb.description);Bb&&Object.getType(Bb)===String?Ra.description=Bb:"secondaryText"in yb?Ra.description=yb.secondaryText:"fullDescriptionLabel"in yb&&(Ra.description=yb.fullDescriptionLabel)}}}WBn(Ra){this.$Sb={};let yb=0,Bb=0;for(const cb of Ra){Ra=0;for(const Xa of cb.results)this.$Sb[Xa.value]=new v(Xa.groupType,Xa.type,Xa.uvj,yb,Ra,Bb),Ra++,Bb++,Xa.label||5!==Xa.type||this.aUo(Xa);0<Ra&&yb++}}Yec(Ra,yb,Bb,cb,Xa){if(1===Bb)return 32;
if(Z.c(Xa))return this.Oe.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(Ra=Xa.CommandValueId)&&window.open(Ra,"_blank");return 32}AEi(Ra){const yb={};yb.token=this.Ieg;yb.files=sa.c(Ra);yb.type="MultiFilesDeckGeneration";if(N.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.ga.Qb(Lb.a.sWm,2,yb),!0;Ra=J.a.Zfi("",J.a.odj("GenerateDeckFromFile"),Object.assign(new oc.a,{landingTab:"All",data:yb}));Ra=this.ga.Qb(Lb.a.s8,
2,Ra);return 32!==Ra?(this.Oe.onError("LaunchSmartLookupWithFilesData","CommonCommands.InvokeSerplet failed. Response: "+Ra+"."),!1):!0}Q4i(Ra,yb,Bb,cb,Xa){if(1===Bb)return 32;if(Z.c(Xa))return this.Oe.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Ub.Wkf();if(Ra=Xa.TerminalParentControlId){Ra=this.BSb.J(Ra);if(!Ra)return 16;yb=[];Array.add(yb,Ra);if(!this.AEi(yb))return 8}return 32}E2h(){if(!this.BSb.count)return 16;const Ra=[];for(let yb of this.BSb.values)Array.add(Ra,
yb);return this.AEi(Ra)?32:8}n2a(Ra,yb,Bb,cb,Xa){if(1===Bb)return 32;if(Z.c(Xa))return this.Oe.onError("TellMeActor:InsertMention","actiondata comes null"),16;Ra=Xa.UILocation;let hb;Xa=Xa.CommandValueId;try{hb=sa.a(Xa)}catch(Cb){return this.Oe.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return Z.c(hb)?(this.Oe.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):Z.c(this.buc)?(this.Oe.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),
16):19!==Ra?(this.Oe.onError("TellMeActor:InsertMention","location "+Ra+" is unexpected"),16):this.buc.n2a(hb.displayName,hb.email,hb.userId)?32:(this.Oe.onError("TellMeActor:InsertMention","mention is not inserted"),16)}DRa(Ra,yb,Bb,cb,Xa){return 1===Bb?32:Z.c(Xa)?(this.Oe.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===Xa.UILocation?this.pBm(Bb,Xa):this.Yec(Ra,yb,Bb,cb,Xa)}TXi(Ra,yb,Bb,cb,Xa){if(1===Bb)return 32;if(Z.c(Xa))return this.Oe.onError("TellMeActor:OpenFeedback",
"actiondata comes null"),16;this.Hp&&window.setTimeout(()=>{this.Hp.execute(hb=>{hb.lTa("TellMeSurvey",null)})},qc.Gyl);return 32}pBm(Ra,yb){if(1===Ra)return 32;if(Z.c(yb))return this.Oe.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(Z.c(this.buc))return this.Oe.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;Ra=yb.CommandValueId;return Z.c(Ra)?(this.Oe.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.buc.insertHtmlText(Ra)?32:(this.Oe.onError("TellMeActor:InsertUrl",
"url is not inserted"),16)}xxa(Ra,yb,Bb,cb,Xa){Bb=window.performance.now();this.WBn(yb);this.Oe.Jho(yb);this.fc.Yq?(this.R9a=this.GJe.GIl(yb,Ra,Xa),this.fc.Vva?(this.VY.push(appChrome.actions.updateTellMeSearchResults(this.R9a.menuModel,Ra,Xa)),appChrome.api.dispatch(this.VY)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.R9a.menuModel,Ra,Xa)),this.fc.aoe&&this.wVb&&(Z.c(this.OZ)||this.OZ.Location!==ia.a.contextMenu)&&(this.pK.mark(2),this.pK.measure(0,1,2))):this.dAa=this.Blh.HIl(yb,
this.Oe.Kpa);this.zSb&&this.Hb.Vb(this.zSb);Xa={};Xa.GroupsCount=yb.length;Xa.QueryID=cb;Xa.QueryLength=Ra.length;this.Oe.DA(G.a.Vbl,window.performance.now()-Bb,Xa)}Bkl(Ra,yb){return yb.startsWith(this.fc.Yq?J.a.Pkg:J.a.wme)?5:Ra?4:"bSearchHelp"===yb||yb.startsWith("GetHelpFromTellMe")?8:"bInsights"===yb||yb.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===yb?24:yb===this.fc.Pjf?2:0}JE(Ra,yb){this.Zka?this.Zka.JE(Ra,yb):Array.add(this.Srd,new F(Ra,yb))}mEi(Ra,yb,Bb,cb,Xa){if(1===Bb)return 32;
if(Z.c(Xa))return this.Oe.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){Ra={};Ra.SourceControlId=Xa.SourceControlId;Ra.Query=Xa.CommandValueId;Xa=this.ga.Qb(Lb.a.SWc,2,Ra);if(32!==Xa)this.Oe.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+Xa+".");return Xa}return this.ga.Qb(Lb.a.SWc,2,Xa)}u0d(Ra,yb,Bb,cb,Xa){({AddinResultsProvider:Ra}=
c(1635));if(1===Bb)return 32;if(Z.c(Xa))return this.Oe.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;Bb=Xa.CommandValueId;if(Z.b(Bb))return this.Oe.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!Ra.gzb[Bb])return this.Oe.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Bb+" doesn't not exist in entitlements"),16;Xa=c(1635).AddinResultsProvider.gzb[Bb];Ra={};Ra.solutionId=Xa.id;Ra.version=Xa.appVersion;Ra.storeType=Xa.storeType;Ra.storeId=Xa.storeId;Ra.assetId=
Xa.assetId;Ra.assetStoreId=Xa.assetStoreId;Ra.displayName=Xa.displayName;Ra.targetType=Xa.targetType;Ra.height=Xa.height;Ra.width=Xa.width;Xa=this.ga.Qb(Lb.a.qAf,2,Ra);if(32!==Xa)this.Oe.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+Xa+". AssetId: "+Bb);return Xa}TOb(){if(!Z.c(this.Hp))for(let Ra of z.a.instance.Vgb()){if("ShowContextMenuWithFloatie"===Ra.commandId)return this.Hp.execute(yb=>{yb.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(Ra.commandId&&
-1===Ra.commandId.indexOf("Tab"))break}return 8}$lg(Ra,yb="",Bb=null){Ra?this.BSb=new m.a(e.a.ei()):yb&&Bb&&this.BSb.add(yb,Bb)}static get instance(){return qc._instance||(qc._instance=new qc)}}qc._instance=null;qc.SFo="mso_tellMeService";qc.unknown="Unknown";qc.Gyl=500;Object(E.a)(qc,"TellMeActor",null,[])},1482:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);var m=c(1496);class e{constructor(a,l){this.Cab=!1;const {Annotations:y}=c(1476);if(!a)throw Error.argumentNull("annotations");if(!a.$Gf(l))throw Error.argument("memberTypeID",
"Invalid type ID");if(y.cI(l))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.mw=a;this.U$j=l;this.fp=[]}get G0b(){return this.mw}get isReadOnly(){return this.Cab}get t4(){return this.U$j}get items(){return this.fp}wda(){const {Annotations:a}=c(1476);let l="[";for(let y=0,z=this.items.length;y<z;++y){0<y&&(l+=", ");const n=this.mw.wda(this.t4,this.items[y]);this.t4===a.V9?(l+='"',l+=m.a.hif(n),l+='"'):l+=n}return l+"]"}isEqual(a){const {Annotations:l}=c(1476);if(this===
a)return!0;if(!a||a.G0b!==this.mw||a.t4!==this.t4||a.items.length!==this.items.length)return!1;for(let y=0;y<this.items.length;++y)if(!l.qqb(this.t4,this.items[y],a.items[y]))return!1;return!0}clone(){const a=new e(this.mw,this.t4);Array.addRange(a.items,this.items);return a}lT(){return this.isReadOnly?this.clone():this}XJf(){const {Annotations:a}=c(1476);if(!this.isReadOnly){this.Cab=!0;for(const l of this.items)a.SIb(l)}}toString(){return this.wda()}}Object(E.a)(e,"ListValue",null,[1240,1238])},
1483:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}m.tellMe="TellMe";m.contextMenu="ContextMenu";m.unknown="Unknown";Object(E.a)(m,"TellMeScenario",null,[])},1484:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a,l=null,y=null,z=4,n=-99999,v=0){this.GI="";this.Wzd=-1;this.value=e;this.type=a;this.uvj=z;this.label=this.$C=l;this.groupType=30;this.description=y;this.score=n;this.count=v}}Object(E.a)(m,"ResultBinding",null,[])},1487:function(E,M,c){c.d(M,
"a",function(){return m});E=c(0);class m{constructor(e){this.attributes=null;this.query=e;this.lo=[]}Tu(e){this.lo.push(e)}n$i(e){const a=[];for(const l of this.lo)l.groupType!==e&&a.push(l);this.lo.length!==a.length&&(this.lo=a)}get cbc(){return!1}}Object(E.a)(m,"SimpleResultsUpdatedEventArgs",null,[1100])},1488:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e=30,a=""){this.UL=[];this.groupType=e;this.displayName=a}get results(){return this.UL}Jw(e){e.groupType=this.groupType;
Array.add(this.results,e)}o5f(e=1){if(this.results.length>=e)for(let a=0;a<e;a++)Array.removeAt(this.results,this.results.length-1)}}Object(E.a)(m,"SimpleResultGroup",null,[1101])},1496:function(E,M,c){E=c(0);class m{constructor(a,l){this.Jdb=a;this.value=l}}Object(E.a)(m,"AttrValuePair",null,[]);c.d(M,"a",function(){return e});class e{constructor(a){this.Cab=!1;if(!a)throw Error.argumentNull("annotations");this.mw=a;this.lY=[]}get G0b(){return this.mw}get isReadOnly(){return this.Cab}get Kwf(){return 0<
this.lY.length}Gq(a){if(!this.mw.Jbc(a))throw Error.argument("attributeID","Invalid attribute ID");for(const l of this.lY)if(a===l.Jdb)return a=l.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}Dy(a,l){var {Annotations:y}=c(1476);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.mw.Jbc(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.mw.Fac(this.mw.getAttributeType(a),l))throw Error.argument("value",
"Value is not of the correct type for the specified attribute");y.SIb(l);for(y=0;y<this.lY.length;++y){const z=this.lY[y];if(a===z.Jdb){z.value=l;return}}Array.add(this.lY,new m(a,l))}oSa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.mw.Jbc(a))throw Error.argument("attributeID","Invalid attribute ID");for(let l=0;l<this.lY.length;++l)if(a===this.lY[l].Jdb){Array.removeAt(this.lY,l);break}}QMd(a){if(!a)throw Error.argumentNull("action");
for(const l of this.lY)a(l.Jdb,l.value)}clone(){const a=new e(this.mw);a.e_a(this);return a}e_a(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.G0b!==this.mw)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.lY);a.QMd((l,y)=>{this.Dy(l,y)})}wda(){const {Annotations:a}=c(1476);let l="[",y=!0;for(const z of this.lY){y?y=!1:l+=", ";l+=this.mw.N3h(z.Jdb);l+="=";const n=
this.mw.getAttributeType(z.Jdb),v=this.mw.wda(n,z.value);n===a.V9?(l+='"',l+=e.hif(v),l+='"'):l+=v}return l+"]"}isEqual(a){const {Annotations:l}=c(1476);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.mw!==a.G0b||this.Kwf!==a.Kwf)return!1;let y=0,z=null,n=!1;a.QMd((v,A)=>{++y;if(!n){var w=-1;for(let G=0,F=this.lY.length;G<F;++G)if(this.lY[G].Jdb===v){w=G;break}0>w?n=!0:(z||(z=Array(this.lY.length)),z[w]=A)}});if(this.lY.length!==y||n)return!1;for(let v=0,A=this.lY.length;v<
A;++v)if(!l.qqb(this.mw.getAttributeType(this.lY[v].Jdb),this.lY[v].value,z[v]))return!1;return!0}lT(){return this.isReadOnly?this.clone():this}XJf(){const {Annotations:a}=c(1476);if(!this.isReadOnly){this.Cab=!0;for(const l of this.lY)a.SIb(l.value)}}toString(){return this.wda()}static hif(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(E.a)(e,"FeatureBundle",null,[1237,1238])},1501:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}
m.click="Click";m.r2a="InteractionBegin";m.BGb="InteractionEnd";m.lIh="ControlActivated";m.query="Query";m.o4i="QueryIndexRecorded";m.mFh="Clicks";m.kmh="ActionEvents";m.fZh="FilteredActionEvents";m.zij="SessionContext";m.latency="Latency";m.performance="Performance";m.ebj="RenderedResults";m.events="Events";m.Vbl="CreateResultsMenu";m.VG="UpdateRibbonControls";m.z5n="ResultsAggregation";m.MH="IssueQuery";m.C_k="CommandSuggestions";m.error="Error";m.KJf="LoadModelData";m.jjl="DepsResolveTime";m.icn=
"ModelDataWaitTime";m.timedOut="TimedOut";m.zyk="AddinQueryCommandReady";m.NJl="GetAddinEntitlements";m.M3i="ProviderMRUEvents";m.osl="EnableAddinSearchCommands";Object(E.a)(m,"EventNames",null,[])},1503:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.GLf=null;this.ica=this.ILf=0}Rlf(e,a,l){if(!e)throw Error.argumentNull("referenceList");if(0>a||a>e.length)throw Error.argumentOutOfRange("startIndex");if(0>l||l>e.length)throw Error.argumentOutOfRange("length");if(a+
l>e.length)throw Error.argument("Invalid start-length range");this.GLf=e;this.ILf=a;this.ica=l}Qgb(e,a,l){this.Rlf(e.GLf,e.ILf+a,l)}J(e){if(0>e||e>=this.ica)throw Error.argumentOutOfRange("index");return this.GLf[this.ILf+e]}get count(){return this.ica}static Saf(e){const a=new m;a.Rlf(e,0,e.length);return a}}Object(E.a)(m,"ReadOnlyList",null,[1263])},1511:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);var m;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";
e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]="Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]=
"ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.ActionAI=24]="ActionAI";e[e.ActionAICommand=25]="ActionAICommand";e[e.SummarizeDeck=26]="SummarizeDeck";e[e.Addin=27]="Addin";e[e.OfficeScript=28]="OfficeScript";e[e.AddinStoreEntry=29]="AddinStoreEntry";e[e.None=30]="None";e[e.MergedActions=31]="MergedActions";e[e.MergedScopedSearches=32]="MergedScopedSearches";
e[e.MergedSuggestedSearches=33]="MergedSuggestedSearches"})(m||(m={}));Object(E.b)("ResultGroupType",m)},1518:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(1568);class m extends c.a{constructor(){super();this.info=this.oj=this.eventId=null}get gga(){return"Misc"}UDb(){this.detail.Z("Type",this.gga);this.detail.Z("EventId",this.eventId);this.detail.Z("Func",this.oj);this.detail.Z("Info",this.info);return this.detail}}Object(E.a)(m,"BasicMergeFailureDetail",c.a,[])},1519:function(E,M,c){c.d(M,
"a",function(){return l});E=c(0);var m=c(602),e=c(798),a=c(1535);class l{constructor(y,z=!0){this.vm=z&&y?y.AK():y;this.WZb=new m.a}pC(y){this.WZb.add(e.a.yb(y))}cmo(y){this.WZb=y}kNi(y){this.vm&&(new a.a(this.vm,y)).Fpa.forEach((z,n)=>{n.YX&&!this.WZb.contains(z)&&(this.WZb.add(z),n.isDeleted?(n=this.vm,n.hasProperty(e.a.qX(z))&&n.removeProperty(e.a.qX(z))):this.vm.WSa(e.a.qX(z),n.newValue));return!0})}}Object(E.a)(l,"PartialMergeResult",null,[])},1520:function(E,M,c){c.r(M);c.d(M,"CommandResultsUtility",
function(){return A});E=c(0);var m=c(1531),e=c(1501),a=c(1532),l=c(1484),y=c(1488),z=c(1481),n=c(1480),v=c(2);class A{static xad(w,G){if(G&&G.Yq){const F={};for(const I of w)G.M_d(I)&&(F[I]=appChrome.selectors.getModelType(I));z.TellMeActor.instance.VG(F)}}static dGo(w){return w.startsWith("btnTellMeOfficeAddIn")}static tTc(w){const G=z.TellMeActor.instance.yO();return!!G&&G.Yq&&!appChrome.selectors.isControlDisabled(w)}static p2d(w,G,F,I){if(z.TellMeActor.instance.Oe&&w){const K=[];for(const J of w)K.push(String.format('{{"Id":"{0}","Score":{1}}}',
J.commandId,J.score));w={};w[m.a.suggestions]="[{"+K.join(",")+"}]";w[m.a.aDi]=G;w[m.a.groupType]=F;w[m.a.provider]=I;z.TellMeActor.instance.Oe.DA(e.a.C_k,window.performance.now(),w)}}static HQl(w,G){const F=[],I=[];for(const K of G){G=K.commandId;let J=K;K.commandId in w&&(G=w[K.commandId],J=new a.a(G,K.score));Array.contains(I,G)||(F.push(J),I.push(G))}return F}static gPc(w,G,F,I,K,J,N,R){F.Eof&&(G=A.HQl(F.Eof,G));var O=n.a.ZOl(G);A.xad(O,F);var L=[],U=[];O=[];const W=new y.a(N);N=16===N||18===
N||7===N||4===N?v.AFrameworkApplication.K?v.AFrameworkApplication.K.mc("TellMeMaxRecommendedResultsToReturn",3):3:0===N||17===N||25===N?5:0;for(const X of G)if(!A.rGm(X.commandId)){G=A.dGo(X.commandId);if(F.M_d(X.commandId)&&!G){if(n.a.KBi(X.commandId))continue;G=null;K&&J&&(G=K.X5l(X.commandId,J));A.tTc(X.commandId)?Array.add(L,new l.a(X.commandId,5,G,null,R,X.score)):Array.add(U,new l.a(X.commandId,5,G,null,R,X.score))}else F.nzb&&G&&I&&Array.add(O,X.commandId.substr(21));if(L.length+O.length>=
N)break}F=0;for(K=0;K<L.length&&F<N;K++,F++)W.Jw(L[K]);for(L=0;L<U.length&&F<N;L++,F++)W.Jw(U[L]);for(U=0;U<O.length&&F<N;U++,F++)I.qmp(w,O[U],W);return W}static rGm(w){A.jwh||(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.Nw("TellMeControlPredictionBlockList")&&v.AFrameworkApplication.K.GC("TellMeControlPredictionBlockList").forEach(G=>{Array.add(A.iwh,G.toLowerCase())}),A.jwh=!0);return Array.contains(A.iwh,w.toLowerCase())}static QBf(w){return 2<w.length&&";"===w.charAt(0)&&";"===w.charAt(w.length-
1)&&!!v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static E5h(w){const G=new y.a(0);var F=w.split(";");w=z.TellMeActor.instance.yO();for(const I of F)if(0<I.length){F=I.split(":");const K=2===F.length?F[0]:I;if(!w.M_d(K))break;if(1===F.length)F=new l.a(K,5,null,null,1),G.Jw(F);else if(2===F.length)F=new l.a(K,5,F[1],null,1),G.Jw(F);else break}return G}static Frk(w,
G,F){if(!(G&&G.results&&w&&w.results&&w.results.length))return{returnValue:!1,EYe:w,vZe:G};const I=[];for(var K of G.results)Array.add(I,K.value);K=0;const J=0<G.results.length?G.results[0].score:0;for(const N of w.results)if(N.score>F&&!Array.contains(I,N.value)&&A.tTc(N.value)&&(0<J&&(N.score=J),Array.insert(G.results,K,N),K++),2===K)break;return 0<K?(F=G.results.length-5,0<F&&G.o5f(F),{returnValue:!0,EYe:w,vZe:G}):{returnValue:!1,EYe:w,vZe:G}}}A.jwh=!1;A.iwh=[];Object(E.a)(A,"CommandResultsUtility",
null,[])},1530:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{static VHo(e){return e.toString().charCodeAt(0)}static qRm(e){return 55296<=e&&57343>=e}static charAt(e,a){return e.charAt(a)}static luh(e,a){if(e===a)return!0;"\u00a0"===e&&(e=" ");"\u00a0"===a&&(a=" ");return e===a}static kuh(e,a){if(e===a)return!0;if(!e||!a||e.length!==a.length)return!1;e=m.nbj(e);a=m.nbj(a);return e===a}static nbj(e){return e.replace(m.rYc," ")}static epb(e,a,l){return e.substring(a,a+l)}}m.rYc=RegExp("\u00a0",
"g");Object(E.a)(m,"CharUtils",null,[])},1531:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}m.appName="AppName";m.l3="CloseAllMenus";m.commandId="CommandId";m.context="Context";m.culture="Culture";m.message="Message";m.errorMessage="ErrorMessage";m.event="Event";m.eoa="CorrelationID";m.lyn="ParentUiElement";m.query="Input";m.TLb="QueryID";m.t4i="QueryLength";m.ogc="QueryIndex";m.A5n="ResultsList";m.suggestions="Suggestions";m.scenario="Scenario";m.sessionId="SessionID";m.source=
"Source";m.timeStamp="Time";m.tCj="UiElement";m.dce="ReactUx";m.value="Val";m.statusCode="StatusCode";m.service="Service";m.isSuccess="IsSuccess";m.FIo="TokenAcquired";m.YVm="LatencyType";m.groupName="GroupName";m.k8="GroupIndex";m.groupType="GroupType";m.w5n="ResultInfoList";m.resultType="ResultType";m.Cgg="SubResultType";m.LKm="IsInputBlur";m.MKm="IsInputFocus";m.BQm="IsShortCutUsed";m.actionType="ActionType";m.count="Count";m.Cql="DwellTime";m.aDi="IsZeroTerm";m.N4o="WordsCount";m.$Zd="IsSearchUxEnabled";
m.QRm="IsTellMeInHeaderEnabled";m.module="Module";m.resultIndex="ResultIndex";m.$ef="DisplayIndex";m.xsl="EnableList";m.provider="Provider";m.contentType="ContentType";m.aQm="IsSelectionBased";m.GIk="BeginPerformanceMarker";m.Vsl="EndPerformanceMarker";m.nAn="PerformanceMeasure";Object(E.a)(m,"Columns",null,[])},1532:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a){this.commandId=e;this.score=a}}Object(E.a)(m,"CommandSuggestion",null,[])},1535:function(E,M,c){E=c(0);
var m=c(365),e=c(798),a=c(243),l=c(55);class y{constructor(n,v,A){this.Vek=n;this.nbk=v;this.Fak=A;this.JEe=new a.a(Object(l.a)(this,this.BUk,"checkIfDifferent"))}get anb(){return this.Vek}get oldValue(){return this.nbk}get newValue(){return this.Fak}get gjb(){return!(void 0===this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get YX(){return this.gjb||
this.isDeleted||this.JEe.value}BUk(){return this.gjb||this.isDeleted?!0:!e.a.ruh(this.anb,this.oldValue,this.newValue)}}Object(E.a)(y,"PropertyDiff",null,[]);c.d(M,"a",function(){return z});class z{constructor(n,v){this.kbk=n;this.Cak=v;this.JEe=new a.a(()=>this.DTc());this.Xek=new a.a(Object(l.a)(this,this.Kvl,"evaluatePropertyDiffs"))}get Hu(){return this.kbk}get yf(){return this.Cak}get gjb(){return!!this.yf&&!this.Hu}get isDeleted(){return!this.yf&&!!this.Hu}get YX(){return this.gjb||this.isDeleted||
this.JEe.value}get Fpa(){return this.Xek.value}DTc(n=null){let v=!1;this.Fpa.forEach((A,w)=>{v=w.YX&&(!n||7!==n.J(A));return!v});return v}Kvl(){const n=new m.a;var v=this.yf,A=this.Hu;if(this.gjb){A=v.Jl();for(var w=0;w<A.length;w++){var G=A[w];n.Z(e.a.yb(G),new y(G,null,v.xX(G)))}}else if(this.isDeleted)for(v=A.Jl(),w=0;w<v.length;w++)G=v[w],n.Z(e.a.yb(G),new y(G,A.xX(G),null));else{w=A.Jl();for(G=0;G<w.length;G++){var F=w[G],I=e.a.yb(F),K=A.xX(F);const J=v.hasProperty(F)?v.xX(F):null;n.Z(I,new y(F,
K,J))}w=v.Jl();for(G=0;G<w.length;G++)F=w[G],A.hasProperty(F)||(I=e.a.yb(F),K=v.xX(F),n.Z(I,new y(F,null,K)))}return n}}Object(E.a)(z,"MergeableObjectDiff",null,[])},1545:function(E,M,c){c.d(M,"b",function(){return y});c.d(M,"a",function(){return n});var m=c(223),e=c(365),a=c(602),l=c(1701);const y=(A,w,G)=>{const F=z(A,w,G);let I=0,K=0,J=0,N=new l.a;const R=new m.a;for(let O=0;O<F.length;O++){const L=F.ag(O+1);N.qAd(A.ag(I));N.sAd(w.ag(K));N.wAd(G.ag(J));I++;K++;for(J++;I<A.length&&(!L||!L.equals(A.ag(I)));)N.qAd(A.ag(I)),
I++;for(;K<w.length&&(!L||!L.equals(w.ag(K)));)N.sAd(w.ag(K)),K++;for(;J<G.length&&(!L||!L.equals(G.ag(J)));)N.wAd(G.ag(J)),J++;R.add(N);N=new l.a}for(;I<A.length;)N.qAd(A.ag(I)),I++;for(;K<w.length;)N.sAd(w.ag(K)),K++;for(;J<G.length;)N.wAd(G.ag(J)),J++;N.isEmpty||R.add(N);return R},z=(A,w,G)=>{const F=new m.a,I=w.SG(),K=G.SG();A.forEach(J=>{I.contains(J)&&K.contains(J)&&F.add(J);return!0});return F},n=(A,w,G)=>{A=A||new m.a;w=w||new m.a;G=G||new m.a;const F=new m.a,I=new e.a(0),K=new a.a;for(var J=
0;J<A.length;J++){var N=A.ag(J);I.Z(N,J)}for(A=J=0;J<w.length&&A<G.length;){N=w.ag(J);let R=G.ag(A),O=I.jz(N,-1),L=I.jz(R,-1);-1===O?(v(K,F,N),J++):-1===L?(v(K,F,R),A++):O===L?(v(K,F,N),J++,A++):O<L?J++:A++}for(;J<w.length;J++)N=w.ag(J),-1===I.jz(N,-1)&&v(K,F,N);for(;A<G.length;A++)w=G.ag(A),-1===I.jz(w,-1)&&v(K,F,w);return F},v=(A,w,G)=>{A.contains(G)||(w.add(G),A.add(G))}},1546:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);var m=c(58);class e{constructor(){this.cp=0;this.id=m.a.create()}}
Object(E.a)(e,"LcsUpdateHint",null,[1324,135])},1547:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}m.tellMe="TellMe";m.loki="Loki";m.substrate="Substrate";m.ogc="QueryIndex";m.nxj="TellMeRanker";m.oxj="TellMeRankerLogging";Object(E.a)(m,"Services",null,[])},1548:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}m.yPa="HttpRequest";m.provider="Provider";Object(E.a)(m,"LatencyTypes",null,[])},1551:function(E,M,c){E=c(0);var m=c(15),e=c(6),a=c(223),l=c(168),y=c(238),z=
c(58),n=c(602),v=c(55),A=c(235),w=c(1568);class G extends w.a{constructor(){super();this.ISa=null}get gga(){return"CreateMergeBlock"}UDb(){this.detail.Z("Type",this.gga);this.detail.Z("Revision",this.ISa);return this.detail}}Object(E.a)(G,"CreateMergeBlockFailureDetail",w.a,[]);var F=c(1615),I=c(1617),K=c(1700),J=c(1569),N=c(1519),R=c(1758);c.d(M,"a",function(){return O});class O{static HGd(L,U,W,X,V,Z,da){let aa;aa="";const ea=new a.a;for(let pa=0;pa<W.length;pa++){var na=void 0;let ja;na=F.a.$Ql(U,
W.J(pa),X,V,Z,da,L);if(!na)return{returnValue:null,c4a:aa};({LMf:ja,c4a:na}=na.Uai());if(!ja)return{returnValue:null,c4a:aa};aa+=na;ea.PC(ea.length,ja)}return{returnValue:ea,c4a:aa}}static wLh(L,U,W,X,V,Z,da,aa){let ea,na,pa,ja,ma,Ia;Ia=ma=ja=pa=na=ea=null;({c4a:ja,returnValue:ea}=O.HGd(U,Ja=>L.runtime.tk.J(Ja),W,1,Z,da,aa));if(!ea)return l.a.instance.Ta(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),
L.logger.Og(Object.assign(new G,{ISa:"Base"})),{returnValue:!1,wK:ea,pLc:na,qad:pa,oBd:ja,tLd:ma,Sme:Ia};({c4a:ma,returnValue:na}=O.HGd(U,Ja=>L.runtime.xu.J(Ja)||L.runtime.tk.J(Ja),X,2,Z,da,aa));if(!na)return l.a.instance.Ta(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),L.logger.Og(Object.assign(new G,{ISa:"Favored"})),{returnValue:!1,wK:ea,pLc:na,qad:pa,oBd:ja,tLd:ma,Sme:Ia};({c4a:Ia,returnValue:pa}=
O.HGd(U,Ja=>L.runtime.Hq.J(Ja)||L.runtime.tk.J(Ja),V,4,Z,da,aa));return pa?{returnValue:!0,wK:ea,pLc:na,qad:pa,oBd:ja,tLd:ma,Sme:Ia}:(l.a.instance.Ta(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),L.logger.Og(Object.assign(new G,{ISa:"Unfavored"})),{returnValue:!1,wK:ea,pLc:na,qad:pa,oBd:ja,tLd:ma,Sme:Ia})}static kFh(L,U=!1){const W=new a.a;let X=0;for(;X<L.length;){var V=L.J(X);if(1===V.type||
4===V.type||2===V.type)W.add(V),X++;else if(3===V.type){let da="";da+=V.character;X++;let aa=V.lQa,ea=!1;for(;X<L.length;X++){var Z=L.J(X);3===Z.type?V.runId===Z.runId&&V.bJ.equals(Z.bJ)&&(V.Aba===Z.Aba||V.EEa===Z.EEa)&&V.AF.uA(Z.AF)&&(!U||V.Rt&&V.Rt.equals(Z.Rt))?(da+=Z.character,Z.lQa&&(aa=!0)):ea=!0:ea=!0;if(ea){V=new R.a(null,V.source,V.Gj,V.zg,V.runId,V.bJ,da,V.wlb,!0,aa,V.Aba,V.EEa,V.XRa,V.AF,V.Rt);W.add(V);break}}}}l.a.instance.Ta(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
W.$q());return W}static t_k(L,U=!1){const W=new a.a;let X=0;for(;X<L.length;){var V=L.J(X);if(1===V.type||4===V.type||2===V.type)W.add(V),X++;else if(3===V.type){let da=V.character.toString();X++;let aa=V.lQa;for(;X<L.length;X++){var Z=L.J(X);if(3===Z.type&&O.eqo(V,Z,U))da+=Z.character,Z.lQa&&(aa=!0);else break}V=new R.a(null,V.source,V.Gj,V.zg,V.runId,V.bJ,da,V.wlb,!0,aa,V.Aba,V.EEa,V.XRa,V.AF,V.Rt);W.add(V)}}l.a.instance.Ta(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
W.$q());return W}static eqo(L,U,W){return L.runId===U.runId&&L.bJ.equals(U.bJ)&&(L.Aba===U.Aba||L.EEa===U.EEa)&&L.AF.uA(U.AF)&&(!W||!!L.Rt&&L.Rt.equals(U.Rt))}static Qjo(L,U,W,X,V,Z,da,aa,ea,na,pa,ja,ma,Ia,Ja,Ka){L.setPropertyString(W.vm,m.a.mo,V);L.setPropertyUint32(W.vm,e.a.Lc,X);L.setPropertyUint32s(W.vm,e.a.iq,Z);L.setPropertyUint32s(W.vm,e.a.Vs,da);L.setPropertyObjectIds(W.vm,m.a.Gn,ea);L.hasProperty(W.vm,e.a.qj)&&L.setPropertyUint32(W.vm,e.a.qj,O.kIl());U&&U(10)&&L.setPropertyObjectIds(W.vm,
e.a.zv,Ka);X=!1;for(V=0;V<na.length;V++)if(na.J(V)){X=!0;break}X&&L.setPropertyBools(W.vm,e.a.LQf,na);O.fPk(U,L,W,pa,ja,ma,Ia);O.gPk(L,W,Ja);W.pC(m.a.mo);W.pC(e.a.Lc);W.pC(e.a.iq);W.pC(e.a.Vs);W.pC(m.a.Gn);W.pC(e.a.LQf);W.pC(m.a.zm);W.pC(m.a.Wob);W.pC(e.a.iPa);W.pC(e.a.LGa);W.pC(m.a.jxa);W.pC(e.a.zv);L.hasProperty(W.vm,e.a.qj)&&W.pC(e.a.qj);0<aa.length?L.setPropertyUint32s(W.vm,m.a.zm,aa):W.vm.removeProperty(m.a.zm)}static fPk(L,U,W,X,V,Z,da){if(L(100)){L=X.contains(!0,(aa,ea)=>ea);O.kbg(U,W,m.a.jxa,
L?X:null);O.kbg(U,W,m.a.Wob,O.Pcj(X,V));O.kbg(U,W,e.a.iPa,O.Pcj(X,Z));X=!1;for(V=0;V<da.length;V++)0!==da.J(V)&&(X=!0);X?U.setPropertyUint32s(W.vm,e.a.LGa,da):W.vm.removeProperty(e.a.LGa)}}static gPk(L,U,W){const X=da=>da;var V=Object(v.a)(L,L.setPropertyBools,"setPropertyBools");O.eNa(U,W.Zib,X,V,e.a.aFa);O.eNa(U,W.yfb,X,V,e.a.Ofa);O.eNa(U,W.a5a,X,V,e.a.KGa);V=da=>0<da.length;var Z=Object(v.a)(L,L.setPropertyStrings,"setPropertyStrings");O.eNa(U,W.Yib,V,Z,e.a.bFa);O.eNa(U,W.xfb,V,Z,e.a.yDa);O.eNa(U,
W.Wmb,V,Z,e.a.oIa);V=da=>!!da;Z=Object(v.a)(L,L.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");O.eNa(U,W.$ib,V,Z,e.a.cFa);O.eNa(U,W.E_a,V,Z,e.a.zDa);O.eNa(U,W.Ymb,V,Z,e.a.pIa);W.a5a.any(X)?O.eNa(U,W.Xmb,()=>!0,Object(v.a)(L,L.setPropertyObjectIds,"setPropertyObjectIds"),e.a.Xya):U.vm.removeProperty(e.a.Xya)}static Pcj(L,U){const W=new a.a;let X=!1;for(let V=0;V<L.length;V++){const Z=U.J(V)&&!L.J(V);W.add(Z);X=Z||X}return X?W:null}static kbg(L,U,W,X){X?L.setPropertyBools(U.vm,W,X):
U.vm.removeProperty(W)}static kIl(){return y.a.vF()}static Sbi(L,U){return L.runtime.xu.jz(U,L.runtime.tk.J(U)||L.runtime.Hq.get(U))}static xOc(L,U,W,X,V){let Z;Z=new a.a;const da=!!W&&W(10);if(L.runtime.Xb.isFeatureEnabled(77)){var aa=O.t_k(X,da);var ea=O.kFh(X,da);aa.length!==ea.length&&L.runtime.Xb.pz(77)}else aa=O.kFh(X,da);ea=0;let na="",pa=new a.a,ja=new a.a,ma=new a.a,Ia=new a.a,Ja=new a.a,Ka=new a.a,Ma=new a.a,sa=new a.a,xa=new a.a;const ia=new K.a;let ha=new a.a;var ua=aa.J(aa.length-1);
if(2!==ua.type&&4!==ua.type)return l.a.instance.Ta(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",ua.type),L.logger.Og(Object.assign(new J.a,{oj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",ua.type)})),{returnValue:!1,z9d:Z};var ya=0;for(ua=0;ua<aa.length;ua++){var ra=aa.J(ua),La=null;if(1===ra.type||3===ra.type)La=ra,na+=La.text;else if(4===ra.type){ra=O.Sbi(L,
ra.Gj);ra=new N.a(ra);Z.add(ra);continue}La?(pa.add(La.runId),ja.add(La.zg),ya+=La.text.length,ma.add(ya),Ia.add(La.bJ),Ja.add(La.wlb),Ka.add(La.lQa),Ma.add(La.Aba),sa.add(La.EEa),xa.add(La.XRa),ia.Zib.add(La.AF.Hom),ia.yfb.add(La.AF.jom),ia.a5a.add(La.AF.kpm),ia.Yib.add(La.AF.insertion.author),ia.xfb.add(La.AF.deletion.author),ia.Wmb.add(La.AF.JGa.author),ia.$ib.add(La.AF.insertion.RYc),ia.E_a.add(La.AF.deletion.RYc),ia.Ymb.add(La.AF.JGa.RYc),ia.Xmb.add(La.AF.JGa.y_f),da&&ha.add(La.Rt)):pa.length||
(pa.add(0),ja.add(0),ma.add(0),Ia.add(z.a.nil),Ja.add(!1),Ka.add(!1),Ma.add(!1),sa.add(!1),xa.add(0),ia.Zib.add(!1),ia.yfb.add(!1),ia.a5a.add(!1),ia.Yib.add(""),ia.xfb.add(""),ia.Wmb.add(""),ia.$ib.add(0),ia.E_a.add(0),ia.Ymb.add(0),ia.Xmb.add(z.a.nil));if(2===ra.type){ya=ra;ra=ya.Lc;ma.lG(ma.length-1);La=V.J(ea);if(!La)return l.a.instance.Ta(17044307,1,2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",
ea,V.length,X.length,ua,aa.length),L.logger.Og(Object.assign(new J.a,{oj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),l.a.instance.nja(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",V.$q()),l.a.instance.nja(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",X.$q()),l.a.instance.nja(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",aa.$q()),{returnValue:!1,z9d:Z};if(La=O.Sbi(L,La))La=new N.a(La.AK()),O.Qjo(U,W,La,ya.Lc,
na,pa,ja,ma,Ia,Ja,Ka,Ma,sa,xa,ia,ha),Z.add(La);l.a.instance.Ta(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",ya.Gj,ra,pa.$q(),ja.$q(),ma.$q(),Ka.$q(),Ma.$q(),sa.$q(),Ia.$q(),"",xa.$q());ea++;na="";pa=new a.a;ja=new a.a;ma=new a.a;Ia=new a.a;Ja=new a.a;Ka=new a.a;Ma=new a.a;sa=new a.a;xa=new a.a;ia.reset();ya=0;ha=
new a.a}}return{returnValue:!0,z9d:Z}}static p4n(L,U){const W=L.runtime.an.J(A.a.uL),X=U.getPropertyObjectIds(W.vm,e.a.p1);for(let V=0;V<X.length;V++)L.runtime.an.remove(X.J(V));U.setPropertyObjectIds(W.vm,e.a.p1,new a.a);U.setPropertyString(W.vm,e.a.bUa,z.a.nil.toString());W.pC(e.a.p1);W.pC(e.a.bUa)}static Bym(L,U){if(L.runtime.an.nb(A.a.uL))return null;const W=new N.a(L.runtime.tk.J(A.a.uL).AK());U.setPropertyString(W.vm,e.a.bUa,L.output.GM.last().id.toString());U.setPropertyObjectIds(W.vm,e.a.p1,
new a.a);W.pC(e.a.p1);W.pC(e.a.bUa);L.runtime.an.Z(A.a.uL,W);return W}static Erf(L){const U=new a.a;L.forEach(W=>{U.add(W.id);return!0});return U}static Tcc(L,U,W,X){let V=0;W.forEach(Z=>{I.a(Z,U+V++,1);393230===Z.Pc&&L.getPropertyObjectIds(Z,m.a.Gn).forEach(da=>{X.add(da);return!0});return!0})}static V0m(L,U){const W=new n.a;let X=0;U.forEach(V=>{if(W.contains(V))return!0;W.add(V);if(({index:X}=O.pKf("BaseFormatting_",X,V,Z=>L.runtime.tk.J(Z))).returnValue||({index:X}=O.pKf("FavoredFormatting_",
X,V,Z=>L.runtime.xu.J(Z))).returnValue||({index:X}=O.pKf("ConflictingFormatting_",X,V,Z=>L.runtime.Hq.J(Z))).returnValue)return!0;X++;return!0})}static pKf(L,U,W,X){if(W=X(W))if(I.a(W,L+U,1),1179649===W.Pc)return U++,{returnValue:!0,index:U};return{returnValue:!1,index:U}}static Hff(L){return!!L.runtime.tk.J(A.a.uL)}static eNa(L,U,W,X,V){U.any(W)?(X(L.vm,V,U),L.pC(V)):L.vm.removeProperty(V)}static Rlj(L,U){const W=new a.a;W.add(0);const X=L?L.length:0;for(let V=0;V<X;V++)W.insert(V+1,L.ag(V));W.insert(W.length,
U);return W}}Object(E.a)(O,"ParagraphMergeUtils",null,[])},1566:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);var m=c(223);class e{constructor(a,l,y){this.Bm=null;this.Ak=a;this.source=l;this.Gj=y}get type(){return this.Ak}get b7a(){return!1}get tJm(){return 1===(this.source&1)}get uJm(){return 2===(this.source&2)}get vJm(){return 4===(this.source&4)}p4(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",this.nMl(),this.T6b())}nMl(){let a="";this.tJm&&(a+="Base");this.uJm&&
(a+="FavoredUpdate");this.vJm&&(a+="UnfavoredUpdate");return a}T6b(){return""}uA(a){return this.type===a.type}O8c(){const a=new m.a;a.add(this);return a}get length(){return 0}}Object(E.a)(e,"AMergeBlock",null,[97,98])},1567:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(1566);class m extends c.a{constructor(e,a,l){super(2,e,a);this.Lc=l}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),this.Lc,this.Gj)}T6b(){return"Eop"}clone(){return new m(this.source,
this.Gj,this.Lc)}uA(e,a,l,y=!1,z=!0){return super.uA(e,a,l,y)?z?e.Lc===this.Lc:e.Gj===this.Gj&&e.Lc===this.Lc:!1}get length(){return 1}}Object(E.a)(m,"EopMergeBlock",c.a,[])},1568:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);var m=c(365);class e{constructor(){this.detail=new m.a}}Object(E.a)(e,"AMergeFailureDetail",null,[1835])},1569:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(1518);class m extends c.a{constructor(){super()}get gga(){return"ParagraphMerge"}}Object(E.a)(m,
"ParagraphMergeFailureDetail",c.a,[])},1570:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(1518);class m extends c.a{constructor(){super()}get gga(){return"RdOpLcs"}}Object(E.a)(m,"ReducedOpsLcsFailureDetail",c.a,[])},1571:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(1518);class m extends c.a{constructor(){super()}get gga(){return"TableMerge"}}Object(E.a)(m,"TableMergeFailureDetail",c.a,[])},1578:function(E,M,c){E=c(0);class m{constructor(){this.p$c=this.qSc=null;this.sMf=
this.score=this.tYc=0}fYf(F,I,K){this.score=F.J(I);++I;this.qSc=F.J(I)?K.pna(F.J(I)):null;++I;this.p$c=F.J(I)?K.pna(F.J(I)):null;++I;this.tYc=F.J(I);++I;this.sMf=F.J(I);++I;return I}}Object(E.a)(m,"TokenStringGeneratorInit",null,[]);class e{constructor(F,I,K,J,N){this.Fgb=F;this.count=I;this.kMd=K;this.qO=J;this.depth=N}}Object(E.a)(e,"ErrorTolerantTrieMatch",null,[]);var a=c(1633),l=c(1718);class y{constructor(F=null,I=0,K=0,J=0){this.Ylk=F||new l.a;this.nva=I;this.qO=K;this.depth=J}get z5(){return this.Ylk}getKey(){return this.z5.Fx.toString()+
":"+this.nva.toString()}}Object(E.a)(y,"TrieBookmark",null,[]);class z{constructor(F,I){this.UQa=F;this.ALf=I}M6m(F){if(null==F)throw Error.argumentNull("prefix");let I={};var K=I[""]=new y;this.sVd(K,I);for(K=0;K<F.length;++K){const J=F.charCodeAt(K),N={};for(let R in I)this.uzk(J,I[R],N);I=N}return this.yKo(I)}sVd(F,I){if(!(F.qO>=this.ALf)&&(F=new y(a.a.z7e(F.z5),F.nva,F.qO+1,F.depth),F.z5.GF&a.a.B8a&&(F.nva+=1),this.UQa.dQb(F.z5))){F.depth+=1;let K=!0;for(;K;)z.yne(F,I),this.sVd(F,I),F.nva+=this.UQa.f7b(F.z5,
!0)+(F.z5.GF&a.a.B8a?1:0),K=this.UQa.O$c(F.z5)}}uzk(F,I,K){I.qO+1<=this.ALf&&(I.qO+=1,z.yne(I,K),--I.qO);I.z5.GF&a.a.B8a&&(I.nva+=1);if(this.UQa.dQb(I.z5)){I.depth+=1;let J=!0;for(;J;)I.z5.dRb===F?(z.yne(I,K),this.sVd(I,K)):I.qO+1<=this.ALf&&(I.qO+=1,z.yne(I,K),this.sVd(I,K),--I.qO),I.nva+=this.UQa.f7b(I.z5,!0)+(I.z5.GF&a.a.B8a?1:0),J=this.UQa.O$c(I.z5)}}yKo(F){const I=[];for(var K in F){const J=F[K];if(!J.z5.Fx)continue;const N=!!(J.z5.GF&a.a.B8a),R=this.UQa.f7b(J.z5,!1)+(N?1:0);Array.add(I,new e(J.nva,
R,N,J.qO,J.depth))}I.sort((J,N)=>{let R=J.Fgb-N.Fgb;return R||(R=-(J.count-N.count))?R:R=J.depth-N.depth});if(2>I.length)return I;F=[];for(K=0;K<I.length;)K+=z.bAj(K,I,F);return F}static yne(F,I){const K=F.getKey();K in I?(I=I[K],I.qO=Math.min(I.qO,F.qO)):I[K]=new y(a.a.z7e(F.z5),F.nva,F.qO,F.depth)}static bAj(F,I,K){const J=I[F];let N=J.Fgb;const R=N+J.count;let O=1,L=J.kMd;for(;F+O<I.length&&I[F+O].Fgb<R;){const U=I[F+O];U.Fgb>N&&(Array.add(K,new e(N,U.Fgb-N,L,J.qO,J.depth)),L=!1);O+=z.bAj(F+O,
I,K);N=U.Fgb+U.count}N<R&&Array.add(K,new e(N,R-N,L,J.qO,J.depth));return O}}Object(E.a)(z,"ErrorTolerantTrieLookupEngine",null,[1303]);class n extends m{constructor(F,I,K){super();this.jpi=this.KXi=!1;this.IWh=null;if(F){var J=0;try{J=this.fYf(F,J,I);this.KXi=1===F.J(J);++J;this.jpi=1===F.J(J);++J;const N=F.J(J);this.IWh=this.Fyn(K,N)}catch(N){throw Error.argument("initData");}}}Fyn(F,I){return new z(F,I)}}Object(E.a)(n,"FuzzyMatchTokenStringGeneratorInit",m,[]);class v extends m{constructor(F,I){super();
this.query=this.name=null;if(F){this.annotations=I.annotations;var K=0;try{K=this.fYf(F,K,I),this.name=I.QD(F.J(K)),++K,this.query=I.PK(F.J(K))}catch(J){throw Error.argument("initData");}}}}Object(E.a)(v,"QueryTokenStringGeneratorInit",m,[]);class A extends m{constructor(F,I){super();if(F)try{this.fYf(F,0,I)}catch(K){throw Error.argument("initData");}}}Object(E.a)(A,"SurfaceStringTokenStringGeneratorInit",m,[]);var w=c(1503);c.d(M,"a",function(){return G});class G{constructor(F){this.qLf=F}get qSc(){return this.qLf.qSc}get p$c(){return this.qLf.p$c}get tYc(){return this.qLf.tYc}static create(F,
I,K){const {SurfaceStringTokenStringGenerator:J}=c(1861),{QueryTokenStringGenerator:N}=c(1862),{FuzzyMatchTokenStringGenerator:R}=c(1863);let O=0;try{if(F.J(O)!==G.Qzb)throw Error.argument("initData","Input does not represent a token string generator");++O;const L=F.J(O);++O;const U=new w.a;U.Qgb(F,O,F.count-O);switch(L){case J.kFc:return new J(new A(U,I));case N.kFc:return new N(new v(U,I));case R.kFc:return new R(new n(U,I,K));default:throw Error.argument("initData");}}catch(L){throw Error.argument("initData");
}}static $oh(F,I,K,J,N,R){F=F.KIo.getId(I,null);if(0>F)return++R,R;G.aph(F,K,J,N);return R}static aph(F,I,K,J){Array.add(J.qgg,F);Array.add(J.gvj,I);++J.slc[K]}}G.Qzb=1099767983;Object(E.a)(G,"TokenStringGenerator",null,[1282])},1614:function(E,M,c){c.d(M,"a",function(){return a});E=c(0);var m=c(223);M=c(1566);var e=c(1530);class a extends M.a{constructor(l,y,z){super(l,y,z)}Cyo(l){let y;y=null;if(!this.text||!this.b7a||0>=l||l>=this.length)return{returnValue:!1,Btj:y};y=new m.a;const z=this.clone();
z.u7c(e.a.epb(this.text,0,l));const n=this.clone();n.u7c(e.a.epb(this.text,l,this.length-l));y.add(z);y.add(n);return{returnValue:!0,Btj:y}}p4(){return!0}get length(){return this.text.length}}Object(E.a)(a,"ATextMergeBlock",M.a,[])},1615:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);var m=c(168);class e{K0e(a,l){return a+("[Block: "+l+"] ")}static $Ql(a,l,y,z,n,v,A){const {ParagraphMergeBlockCreator:w}=c(1940),{TableMergeBlockCreator:G}=c(1943);if(393230===l.Pc)return new w(a,l,y,n,v,z(10),
A);if(393250===l.Pc)return new G(l,y);m.a.instance.Ta(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",l.Pc);return null}}Object(E.a)(e,"MergeBlockCreator",null,[])},1616:function(E,M,c){c.d(M,"a",function(){return l});E=c(0);var m=c(6),e=c(58);M=c(1614);var a=c(1535);class l extends M.a{constructor(y,z,n,v,A,w,G,F,I,K,J,N,R,O){super(z,n,v);this.zg=A;this.runId=w;this.wlb=F;this.H2j=G;this.jse=y;this.lQa=I;this.Aba=K;this.EEa=J;this.XRa=N;this.AF=R;this.Rt=O}get ODc(){return this.jse}get bJ(){return this.H2j}get iDb(){return this.ODc(this.bJ)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",
super.toString(),this.zg,this.runId,this.wlb,this.Gj,this.bJ.toString(),this.Rt?this.Rt.toString():"NULL")}uA(y,z,n,v=!1){if(!super.uA(y,z,n,v))return!1;if(v)return!0;if(!this.AF.uA(y.AF)||this.Rt&&!this.Rt.equals(y.Rt))return!1;if(this.bJ.equals(y.bJ)||this.bJ.equals(e.a.nil)||y.bJ.equals(e.a.nil))return!0;y=new a.a(this.iDb,y.iDb);z=z.ZKh(this.iDb,n);return y.DTc(z.rae)?!1:!0}get nEm(){return this.p4()&&"\ufffc"===this.text&&this.iDb?this.iDb.hasProperty(m.a.Ys)||1179725!==this.iDb.Pc?!0:!1:!1}}
Object(E.a)(l,"AUserRunMergeBlock",M.a,[])},1617:function(E,M,c){c.d(M,"a",function(){return e});var m=c(168);const e=(a,l,y=4)=>{a?m.a.instance.nja(4273285,y,4,l,a.i$c()):m.a.instance.Ta(4293845,y,1,l,"{0}: Node was null.",l)}},1618:function(E,M,c){c.d(M,"e",function(){return z});c.d(M,"a",function(){return n});c.d(M,"d",function(){return v});c.d(M,"b",function(){return A});c.d(M,"c",function(){return w});var m=c(6),e=c(15),a=c(58),l=c(1032),y=c(1545);const z=(I,K,J)=>{const N=new l.a;let R=a.a.nil;
K=N.getPropertyObjectId(K,m.a.npb);K.equals(a.a.nil)||(I=I.runtime.tk.J(K),J&&(I=J.jz(K,I)),I&&(R=N.getPropertyObjectId(I,m.a.npb)));return R},n=(I,K,J,N,R)=>{const O=new l.a;let L=null;var U=O.getPropertyObjectId(J,m.a.npb);U!==a.a.nil&&(L=I.runtime.tk.J(U),K&&(L=K.jz(U,L)));if(L){U=O.getPropertyObjectIds(L,e.a.ff);for(R=0;R<U.length&&!U.J(R).equals(J.id);R++);R===U.length&&(R=-1)}J=z(I,J,K);if(!J.equals(a.a.nil)&&(I=I.runtime.tk.J(J),K&&(I=K.jz(J,I)),I)){K=O.getPropertyObjectIds(I,e.a.ff);for(N=
0;N<K.length&&!K.J(N).equals(L.id);N++);N===K.length&&(N=-1)}return{rowIndex:N,E2b:R}},v=(I,K,J,N,R)=>{var O=new l.a;let L=null;var U=I.runtime.tk.J(J);K&&(U=K.jz(J,U));if(!U)return null;U=O.getPropertyObjectIds(U,e.a.ff);J=null;N<U.length&&(N=U.J(N),J=I.runtime.tk.J(N),K&&(J=K.jz(N,J)));J&&(O=O.getPropertyObjectIds(J,e.a.ff),R<O.length&&(R=O.J(R),L=I.runtime.tk.J(R),K&&(L=K.jz(R,L))));return L},A=(I,K,J)=>{let N,R;R=N=-1;const O=(new l.a).getPropertyObjectId(J,m.a.npb);var L=z(I,J,K);if(L.equals(a.a.nil)||
O.equals(a.a.nil))return{rowIndex:N,E2b:R};K=I.runtime.Chg;var U=K.J(L);if(!U){U=G(I,L);if(!U)return{rowIndex:N,E2b:R};K.Z(L,U)}for(L=0;L<U.length;L++)if(U.J(L).equals(O)){N=L;break}U=K.J(O);if(!U){U=F(I,O);if(!U)return{rowIndex:N,E2b:R};K.Z(O,U)}for(I=0;I<U.length;I++)if(U.J(I).equals(J.id)){R=I;break}return{rowIndex:N,E2b:R}},w=(I,K,J,N)=>{if(0>J||0>N)return a.a.nil;new l.a;const R=I.runtime.Chg;let O=R.J(K);if(!O){O=G(I,K);if(!O)return a.a.nil;R.Z(K,O)}if(J<O.length)K=O.J(J);else return a.a.nil;
J=R.J(K);if(!J){J=F(I,K);if(!J)return a.a.nil;R.Z(K,J)}if(N<J.length)I=J.J(N);else return a.a.nil;return I},G=(I,K)=>{var J=new l.a;const N=I.runtime.tk.J(K);if(N){var R=I.runtime.xu.jz(K,N);I=I.runtime.Hq.jz(K,N);K=J.getPropertyObjectIds(N,e.a.ff);R=J.getPropertyObjectIds(R,e.a.ff);J=J.getPropertyObjectIds(I,e.a.ff);return K.Zp(R,(O,L)=>O.equals(L))?J:K.Zp(J,(O,L)=>O.equals(L))?R:y.a(K,R,J,(O,L)=>O.equals(L))}return(R=I.runtime.xu.J(K))?J.getPropertyObjectIds(R,e.a.ff):(R=I.runtime.Hq.J(K))?J.getPropertyObjectIds(R,
e.a.ff):null},F=(I,K)=>{var J=new l.a;const N=I.runtime.tk.J(K);if(N){var R=I.runtime.xu.jz(K,N);I=I.runtime.Hq.jz(K,N);K=J.getPropertyObjectIds(N,e.a.ff);R=J.getPropertyObjectIds(R,e.a.ff);J=J.getPropertyObjectIds(I,e.a.ff);return K.Zp(R,(O,L)=>O.equals(L))?J:K.Zp(J,(O,L)=>O.equals(L))?R:null}return(R=I.runtime.xu.J(K))?J.getPropertyObjectIds(R,e.a.ff):(R=I.runtime.Hq.J(K))?J.getPropertyObjectIds(R,e.a.ff):null}},1619:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(1484);class m extends c.a{constructor(e,
a,l,y,z=null){super(e,a,z,null,l);this.id=y}}Object(E.a)(m,"TryQueryResultBinding",c.a,[])},1620:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e){this.Ab=e}get q4a(){return this.Ab.q4a}get QCo(){return 4!==this.Ab.style}get SCo(){return!0}get trie(){return this.Ab.trie}getId(e,a){if(!this.QCo)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ab.style){case 0:return this.cYl(e,a);default:throw Error.notImplemented();}}QD(e){if(!this.SCo)throw Error.invalidOperation("String lookup not supported on this string table");
if(0>e||e>=this.q4a)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ab.style){case 0:return this.Sbm(e);case 4:return this.Rbm(e);default:throw Error.notImplemented();}}cYl(e,a){e=this.Ab.trie.gKi(e,0,e.length,a);if(!e.succeeded)return-1;if(0>e.Glc||e.Glc>=this.Ab.q4a)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ab.P$c?this.Ab.c3c.By(this.Ab.P$c+4*e.Glc,4):e.Glc}Sbm(e){if(this.Ab.P$c){let a=0;for(;a<this.Ab.q4a&&this.Ab.c3c.By(this.Ab.P$c+
4*a,4)!==e;++a);if(a>=this.Ab.q4a)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ab.trie.rgi(a)}return this.Ab.trie.rgi(e)}Rbm(e){const a=this.Ab.c3c.By(this.Ab.dvj+4*e,4);e=this.Ab.c3c.By(this.Ab.evj+4*e,4);if(0>e||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const l=Array(a);for(let y=0;y<a;++y)l[y]=({Ism:e}=this.HNn(e)).returnValue;return String.fromCharCode.apply(null,l)}HNn(e){let a=0;for(let l=0;3>l;++l){const y=
this.Ab.c3c.J(this.Ab.SBh+e)^182;++e;a|=(y&127)<<7*l;if(!(y&128))break}return{returnValue:a,Ism:e}}}Object(E.a)(m,"StringTable",null,[1262])},1621:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);var m=c(1633);class e{constructor(a){this.trie=null;this.SBh=this.dvj=this.evj=this.P$c=0;if(a){this.c3c=a;var l=0;if(a.By(l,4)!==e.Qzb)throw Error.argument("bytes","Input does not represent a string table");l+=4;this.q4a=a.By(l,4);l+=4;this.style=a.By(l,4);l+=4;switch(this.style){case 0:const y=1===
a.By(l,4);l+=4;y||(this.P$c=l,l+=4*this.q4a);a.By(l,4);this.trie=this.fzn(a,l+4);break;case 4:this.evj=l;this.dvj=l+=4*this.q4a;l+=4*this.q4a;a.By(l,4);this.SBh=l+4;break;default:throw Error.argument("bytes");}}}fzn(a,l){return new m.a(a,l)}}e.Qzb=1025118440;Object(E.a)(e,"StringTableInit",null,[])},1622:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);var m;(function(e){e[e.Answer=0]="Answer";e[e.Definition=1]="Definition";e[e.Entity=2]="Entity";e[e.WolframAnswer=3]="WolframAnswer";e[e.Assistance=
4]="Assistance";e[e.Command=5]="Command";e[e.Document=6]="Document";e[e.TryQuery=7]="TryQuery";e[e.FindInDocument=8]="FindInDocument";e[e.HelpAction=9]="HelpAction";e[e.Insights=10]="Insights";e[e.People=11]="People";e[e.Image=12]="Image";e[e.FirstRunResult=13]="FirstRunResult";e[e.NoCommandsFoundResult=14]="NoCommandsFoundResult";e[e.TestResult=15]="TestResult";e[e.AppsForOffice_Installed=16]="AppsForOffice_Installed";e[e.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";e[e.AppsForOffice_Query=
18]="AppsForOffice_Query";e[e.Notes_Onenote=19]="Notes_Onenote";e[e.Notes_Samsung=20]="Notes_Samsung";e[e.Notes_Sticky=21]="Notes_Sticky";e[e.Learning=22]="Learning";e[e.Feedback=23]="Feedback";e[e.Template=24]="Template";e[e.ActionAI=25]="ActionAI";e[e.ActionAICommand=26]="ActionAICommand";e[e.Addin=27]="Addin";e[e.OfficeScript=28]="OfficeScript";e[e.AddinStoreEntry=29]="AddinStoreEntry";e[e.GenerateSlides=30]="GenerateSlides";e[e.SummarizeDeck=31]="SummarizeDeck";e[e.Unknown=32]="Unknown"})(m||
(m={}));Object(E.b)("ResultType",m)},1630:function(E,M,c){E=c(0);var m=c(6),e=c(602),a=c(168),l=c(223),y=c(58),z=c(365),n=c(73),v;(function(bb){bb[bb.none=0]="none";bb[bb.mergeConflict=1]="mergeConflict";bb[bb.containerBaseIdValidationFailure=2]="containerBaseIdValidationFailure";bb[bb.failedToApplyHints=3]="failedToApplyHints";bb[bb.validateUpdateHintsAreComplete=4]="validateUpdateHintsAreComplete";bb[bb.other=5]="other"})(v||(v={}));Object(E.b)("ParagraphMergeUsingHintsFailureReason",v);var A=c(1032),
w=c(235),G=c(894);const F=bb=>{const Gb=new l.a;bb.forEach(Sa=>{Gb.add(Sa);return!0});return Gb};var I=c(1567),K=c(1545),J=c(1570);const N=(bb,Gb)=>{if(bb.length!==Gb.length)return!1;for(let Sa=0;Sa<bb.length;Sa++)bb.J(Sa).Bm=Gb.J(Sa),Gb.J(Sa).Bm=bb.J(Sa);return!0},R=(bb,Gb,Sa)=>{let Pa,Ab,nb;Pa=0;Ab=!1;nb=0;var Rb;if(!({idx:Rb}=X(bb,Gb)).returnValue)return a.a.instance.Ta(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",Gb,bb.$q()),{returnValue:!1,
XPc:Pa,rlb:Ab,mZc:nb};if(!Sa&&2===bb.J(Rb).type)return{returnValue:!0,XPc:Rb,rlb:Ab,mZc:nb};if(!bb.J(Rb).p4())return a.a.instance.Ta(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",Rb,Sa,bb.$q()),{returnValue:!1,XPc:Pa,rlb:Ab,mZc:nb};let Mb=!1,oc=0;for(;Rb<bb.length&&bb.J(Rb).Gj.equals(Gb);Rb++){if(Sa===oc){Mb=!0;break}if(Sa>oc&&Sa<oc+bb.J(Rb).length){Ab=Mb=!0;nb=Sa-oc;break}oc+=bb.J(Rb).length}Mb||Sa!==oc||(Mb=!0);Mb&&(Pa=
Rb);return{returnValue:Mb,XPc:Pa,rlb:Ab,mZc:nb}},O=(bb,Gb,Sa)=>{let Pa,Ab,nb;nb=Ab=0;Pa=!1;let Rb=0,Mb=!1;for(;Ab<bb.length;Ab++){if(Gb===Rb){Mb=!0;break}if(Gb>Rb&&Gb<Rb+bb.J(Ab).length){Pa=Mb=!0;nb=Gb-Rb;break}Rb+=bb.J(Ab).length}Mb||Gb!==Rb||(Mb=!0);Mb||(bb=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",bb.length,Rb,Gb),a.a.instance.Ta(573178201,1,2,bb),Sa.Og(Object.assign(new J.a,{eventId:"8k6fz",info:bb})));return{returnValue:Mb,rlb:Pa,hwh:Ab,gwh:nb}},
L=(bb,Gb,Sa)=>{let Pa;if(bb.J(Gb).p4()&&({Btj:Pa}=bb.J(Gb).Cyo(Sa)).returnValue)return bb.PC(Gb+1,Pa),bb.lG(Gb),!0;a.a.instance.Ta(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",Gb,Sa,bb.$q());return!1},U=(bb,Gb,Sa)=>{let Pa,Ab;if(!({XPc:Sa,rlb:Ab,mZc:Pa}=R(bb,Gb,Sa)).returnValue)return{returnValue:!1,index:0};if(!Ab)return{returnValue:!0,index:Sa};if(L(bb,Sa,Pa))return{returnValue:!0,index:Sa+1};a.a.instance.Ta(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",
Gb,Pa,bb.$q());return{returnValue:!1,index:0}},W=(bb,Gb,Sa)=>{let Pa;if(!({rlb:Pa,hwh:Gb,gwh:Sa}=O(bb,Gb,Sa)).returnValue)return{returnValue:!1,index:0};if(!Pa)return{returnValue:!0,index:Gb};if(L(bb,Gb,Sa))return{returnValue:!0,index:Gb+1};a.a.instance.Ta(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",Sa,bb.$q());return{returnValue:!1,index:0}},X=(bb,Gb)=>{let Sa;Sa=0;for(let Pa=0;Pa<bb.length;Pa++)if(bb.J(Pa).Gj.equals(Gb))return Sa=Pa,{returnValue:!0,
idx:Sa};a.a.instance.Ta(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",Gb,bb.$q());return{returnValue:!1,idx:Sa}},V=(bb,Gb)=>{let Sa;Sa=-1;for(let Pa=Gb;Pa<bb.length;Pa++)if(2===bb.J(Pa).type)return Sa=Pa,{returnValue:!0,dga:Sa};a.a.instance.Ta(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",Gb,bb.$q());return{returnValue:!1,dga:Sa}},Z=(bb,Gb,Sa)=>{let Pa;Pa=-1;for(let Ab=Sa;Ab<bb.length;Ab++)if(2===
bb.J(Ab).type&&bb.J(Ab).Gj.equals(Gb))return Pa=Ab,{returnValue:!0,dga:Pa};a.a.instance.Ta(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",Gb,Sa,bb.$q());return{returnValue:!1,dga:Pa}},da=(bb,Gb)=>{let Sa;Sa=0;var Pa;if(!({idx:Pa}=X(bb,Gb)).returnValue)return a.a.instance.Ta(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Gb,bb),{returnValue:!1,length:Sa};for(;Pa<bb.length;Pa++)if(6!==bb.J(Pa).type){if(2===bb.J(Pa).type)return{returnValue:!0,
length:Sa};a.a.instance.shipAssertTag(17342617,1,bb.J(Pa).p4(),"We found something other than text with type "+bb.J(Pa).type);a.a.instance.shipAssertTag(17877021,1,bb.J(Pa).Gj.equals(Gb),"Unexpected GraphNodeId {0} for ParaId {1}",bb.J(Pa).Gj,Gb);Sa+=bb.J(Pa).length}a.a.instance.Ta(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Gb,bb);return{returnValue:!1,length:Sa}},aa=bb=>{const Gb=new l.a;for(let Sa=0;Sa<bb.length;Sa++)Gb.add(bb.J(Sa).clone());return Gb};var ea=c(1569),na=
c(1530);class pa{constructor(bb,Gb,Sa=null,Pa=null){this.Gj=bb;this.type=Gb;this.text=Sa;this.Lc=Pa}isEqual(bb){return bb.Gj.equals(this.Gj)&&this.type===bb.type&&this.Lc===bb.Lc&&na.a.kuh(this.text,bb.text)}toString(){let bb=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.Gj,this.Lc,this.type);this.text&&(bb+=String.format(" [TextLength: {0}]",this.text.length));return bb}}Object(E.a)(pa,"MergeBlockValidationState",null,[]);var ja=c(110),ma=c(938),Ia=c(857),Ja=c(532),
Ka=c(463),Ma=c(937),sa=c(856),xa=c(1518),ia=c(1708),ha;(function(bb){bb[bb.base=1]="base";bb[bb.favoredUpdate=2]="favoredUpdate";bb[bb.unfavoredUpdate=4]="unfavoredUpdate";bb[bb.min=1]="min";bb[bb.max=7]="max"})(ha||(ha={}));Object(E.b)("MergeBlockSource",ha);class ua{constructor(bb,Gb,Sa,Pa){this.zg=bb;this.cp=Gb;this.nBd=Sa;this.Xad=Pa}}Object(E.a)(ua,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var ya=c(1566);class ra extends ya.a{constructor(bb,Gb){super(6,bb,Gb);this.Lc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",
super.toString(),this.Gj)}T6b(){return"Selection"}clone(){return new ra(this.source,this.Gj)}uA(){return!1}get length(){return 0}}Object(E.a)(ra,"SelectionMergeBlock",ya.a,[]);var La;(function(bb){bb[bb.success=0]="success";bb[bb.selfSplit=1]="selfSplit";bb[bb.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";bb[bb.unexpected=3]="unexpected"})(La||(La={}));Object(E.b)("SplitTwinListResult",La);var oa=c(1614);class Ca extends oa.a{constructor(bb,Gb,Sa,Pa){super(5,bb,Gb);this._text=null;this.u7c(Sa);
this.Bmk=Pa}get text(){return this._text}u7c(bb){this._text=bb}get Fad(){return this.Bmk}clone(){return new Ca(this.source,this.Gj,this.text,this.Fad)}get b7a(){return this.text&&this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(E.a)(Ca,"UpdateHintTextMergeBlock",oa.a,[]);class Aa{constructor(bb,Gb,Sa,Pa){this.z2=!1;this.Wbb=new z.a;this.Yd=bb;this.Ijh=Pa;this.uNg=Sa;this._base=Gb;this.wxe=aa(Gb);if(!N(this.base,this.Pe))throw a.a.instance.Ta(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),
bb.logger.Og(Object.assign(new xa.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Pe(){return this.wxe}get mergeConflict(){return this.z2}x1e(bb,Gb){switch(bb.type){case 1:return this.sDk(bb,Gb);case 2:return this.X0e(bb,Gb);case 3:return this.qEk(bb,Gb);case 4:return this.MDk(bb);case 5:return this.JCk(bb,Gb);case 6:return this.V0e(bb);default:return!1}}w1e(bb,Gb){switch(bb.type){case 1:return this.a1e(bb,Gb);case 2:return this.W0e(bb,
Gb);case 3:return this.pEk(bb,Gb);case 4:return this.LDk(bb);case 5:return this.ICk(bb,Gb);case 6:return this.U0e(bb);default:return{returnValue:!1,lu:null}}}sDk(bb,Gb){let Sa;const Pa=({Tga:Sa}=this.PHa(bb.zg,Gb,!1,bb.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==Pa&&1!==Pa)return 3!==Pa&&(a.a.instance.Ta(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",ha[Gb],La[Pa]),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",
eventId:"9l2vv"}))),!1;this.z2=!1;Gb=new Ca(Gb,bb.zg,bb.text,bb.id);this.dAf(bb,Sa,Gb);return!0}X0e(bb,Gb){let Sa,Pa=({Tga:Sa}=this.PHa(bb.zg,Gb,!1,bb.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;if(0!==Pa&&1!==Pa)return 3!==Pa&&(a.a.instance.Ta(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",ha[Gb],La[Pa]),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;
let Ab;({Tga:Ab,returnValue:Pa}=this.PHa(bb.zg,Gb,!1,bb.cp+bb.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==Pa&&1!==Pa)return 3!==Pa&&(a.a.instance.Ta(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",ha[Gb],La[Pa]),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.z2=!1;this.fdf(bb,Sa,Ab);return!0}qEk(bb,Gb){let Sa;const Pa=({wyf:Sa}=this.f$h(bb,Gb,!1)).returnValue;
if(0!==Pa&&1!==Pa)return 3!==Pa&&(a.a.instance.Ta(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",ha[Gb],La[Pa]),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),!1;this.z2=!1;Gb=new I.a(Gb,bb.Nt,bb.tta);this.dAf(bb,Sa,Gb);return!0}MDk(bb){let Gb;if(!({yVd:Gb}=this.g$h(bb,this.Pe,"Derived")).returnValue)return!1;this.fdf(bb,Gb,Gb+1);return!0}JCk(bb,Gb){let Sa;if(!({KMf:Gb,vyf:Sa}=
this.Tai(bb,!1,Gb)).returnValue)return!1;this.dAf(bb,Sa,Gb);return!0}V0e(bb){let Gb;if(!({xVd:Gb}=this.Y9h(bb,this.Pe,"Derived")).returnValue)return!1;this.fdf(bb,Gb,Gb+1);return!0}sth(bb,Gb,Sa){const Pa=({Tga:Gb}=this.PHa(bb,Sa,!1,Gb,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;if(0!==Pa&&1!==Pa)return 3!==Pa&&(a.a.instance.Ta(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",ha[Sa],La[Pa]),this.Yd.logger.Og(Object.assign(new ia.a,
{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.z2=!1;bb=new ra(Sa,bb);this.Pe.insert(Gb,bb);return!0}a1e(bb,Gb){var Sa=null;if(Aa.Wvi(bb.text.length))return{returnValue:!1,lu:Sa};let Pa,Ab,nb;var Rb=({Tga:Pa,iwa:Ab,Ffa:nb}=this.PHa(bb.zg,Gb,!0,bb.cp,!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==Rb&&2!==Rb)return 3!==Rb&&(a.a.instance.Ta(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",ha[Gb],
La[Rb]),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,lu:Sa};this.z2=!1;({dga:Rb}=V(this.Pe,Ab));Rb=this.Pe.J(Rb).Gj;Sa=new Ca(Gb,bb.zg,bb.text,bb.id);Gb=new Ca(Gb,Rb,bb.text,bb.id);Sa.Bm=Gb;Gb.Bm=Sa;this.base.insert(Pa,Sa);this.Pe.insert(Ab,Gb);Sa=new l.a;Sa.add(new Ka.a(Rb,nb,bb.text,bb.id,bb.Bu));return{returnValue:!0,lu:Sa}}W0e(bb,Gb){let Sa;Sa=null;if(Aa.Wvi(bb.text.length))return{returnValue:!1,lu:Sa};let Pa;var Ab,nb=({Tga:Pa,
iwa:Rb,Ffa:Ab}=this.PHa(bb.zg,Gb,!0,bb.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==nb){if(2!==nb)return 3!==nb&&(a.a.instance.Ta(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",ha[Gb],La[nb]),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,lu:Sa};var Rb=0;for({idx:Ab}=X(this.base,bb.zg);Ab<this.base.length&&Rb<bb.cp;Ab++)Rb+=
this.base.J(Ab).length;Rb-=this.base.J(Ab-1).length;({iwa:Rb,Ffa:Ab,returnValue:nb}=this.PHa(bb.zg,Gb,!0,Rb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==nb)return 3!==nb&&(a.a.instance.Ta(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",ha[Gb],La[nb]),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,lu:Sa};this.z2=!1}var Mb,oc;({Tga:Mb,
iwa:oc,Ffa:xb,returnValue:nb}=this.PHa(bb.zg,Gb,!0,bb.cp+bb.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==nb){if(2!==nb)return 3!==nb&&(a.a.instance.Ta(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",ha[Gb],La[nb]),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,lu:Sa};var xb=0;for({idx:oc}=X(this.base,bb.zg);oc<this.base.length&&
xb<bb.cp+bb.text.length;oc++)xb+=this.base.J(oc).length;({iwa:oc,Ffa:xb,returnValue:nb}=this.PHa(bb.zg,Gb,!0,xb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==nb)return 3!==nb&&(a.a.instance.Ta(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",ha[Gb],La[nb]),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,lu:Sa};this.z2=!1}Gb="";Sa=new l.a;
for(--oc;oc>=Rb;oc--)if(6!==this.Pe.J(oc).type)if(this.Pe.J(oc).Bm)Gb=this.Pe.J(oc).text+Gb,this.Pe.lG(oc);else{if(5===this.Pe.J(oc).type)nb=xb-Gb.length;else if(2===this.Pe.J(oc).type){if(nb=0,!({length:xb}=da(this.Pe,this.Pe.J(oc).Gj)).returnValue)return a.a.instance.Ta(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,lu:Sa}}else return a.a.instance.Ta(589898051,
1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,lu:Sa};if(!({dga:cc}=V(this.Pe,oc+1)).returnValue)return a.a.instance.Ta(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,lu:Sa};var cc=this.Pe.J(cc).Gj;Sa.add(new Ja.DeleteTextUpdateHint(cc,
nb,Gb));Gb=""}for(--Mb;Mb>=Pa;Mb--)this.base.lG(Mb);if(!({dga:cc}=V(this.Pe,Rb)).returnValue)return a.a.instance.Ta(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,lu:Sa};cc=this.Pe.J(cc).Gj;Gb&&Gb.length&&Sa.add(new Ja.DeleteTextUpdateHint(cc,Ab,Gb,bb.id,bb.Bu));return{returnValue:!0,lu:Sa}}pEk(bb,Gb){var Sa=null;let Pa,Ab,nb;var Rb=({wyf:Pa,noi:Ab,Ffa:nb}=
this.f$h(bb,Gb,!0)).returnValue;if(0!==Rb)return 3!==Rb&&(a.a.instance.Ta(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",ha[Gb],La[Rb]),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,lu:Sa};var Mb;if(!({dga:Mb}=V(this.Pe,Ab)).returnValue)return a.a.instance.Ta(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),
{returnValue:!1,lu:Sa};Rb=this.Pe.J(Mb).Gj;const oc=this.Pe.J(Mb).Lc;let xb,cc,Ob;({Nt:Mb,o7:xb,tta:cc,Caa:Ob}=this.D2l(bb,Mb));this.NBh(this.Pe,Mb,xb,Ob,Ab);Sa=new I.a(Gb,bb.Nt,bb.tta);Gb=new I.a(Gb,Mb,cc);Sa.Bm=Gb;Gb.Bm=Sa;this.base.insert(Pa,Sa);this.Pe.insert(Ab,Gb);Sa=new l.a;Sa.add(new sa.a(Rb,oc,nb,Mb,cc,xb,Ob,bb.id,bb.Bu));return{returnValue:!0,lu:Sa}}LDk(bb){let Gb;Gb=null;let Sa,Pa;var Ab;if(!({yVd:Sa}=this.g$h(bb,this.base,"Base")).returnValue)return{returnValue:!1,lu:Gb};if(!this.base.J(Sa).Bm||
!({dga:Pa}=Z(this.Pe,this.base.J(Sa).Bm.Gj,0)).returnValue)return a.a.instance.Ta(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.z2=!0,{returnValue:!1,lu:Gb};if(!({dga:Ab}=V(this.Pe,Pa+1)).returnValue)return a.a.instance.Ta(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),
this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.z2=!0,{returnValue:!1,lu:Gb};let nb,Rb,Mb,oc,xb,cc;({d4a:Ab,e4a:Mb,DQf:nb,Len:oc,uen:Rb,ven:xb}=this.wRl(bb,Pa,Ab));if(!({length:cc}=da(this.Pe,Ab)).returnValue)return{returnValue:!1,lu:Gb};this.MBh(this.Pe,Ab,Mb,Pa);this.Pe.lG(Pa);this.base.lG(Sa);Gb=new l.a;Gb.add(new Ma.MergeParagraphUpdateHint(nb,oc,cc,Rb,xb,Ab,Mb,bb.id,bb.Bu));return{returnValue:!0,lu:Gb}}ICk(bb,Gb){var Sa=null;let Pa,Ab,nb;
if(!({KMf:nb,vyf:Pa}=this.Tai(bb,!0,Gb)).returnValue)return{returnValue:!1,lu:Sa};if(!({Bib:Ab}=this.lOc(this.base,this.Pe,Pa,!0)).returnValue)return a.a.instance.Ta(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,lu:Sa};if(0<Ab&&2!==this.Pe.J(Ab-1).type)return a.a.instance.Ta(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.Yd.logger.Og(Object.assign(new ia.a,
{oj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.z2=!0,{returnValue:!1,lu:Sa};let Rb;if(!({Nt:Rb}=this.T2h(Ab)).returnValue)return{returnValue:!1,lu:Sa};Gb=new I.a(Gb,bb.zg,bb.Lc);Sa=nb;Sa.Bm=Gb;Gb.Bm=Sa;this.base.insert(Pa,nb);this.Pe.insert(Ab,Gb);Sa=new l.a;Sa.add(new ma.AddParagraphUpdateHint(bb.zg,bb.Lc,Rb,bb.id,bb.Bu));return{returnValue:!0,lu:Sa}}U0e(bb){let Gb;Gb=null;let Sa;var Pa;if(!({xVd:Pa}=this.Y9h(bb,this.base,"Base")).returnValue)return{returnValue:!1,lu:Gb};if(!this.base.J(Pa).Bm||
!this.base.J(Pa).Bm.Gj.equals(bb.zg))return a.a.instance.Ta(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.z2=!0,{returnValue:!1,lu:Gb};if(!({Bib:Sa}=this.lOc(this.base,this.Pe,Pa,!0)).returnValue)return a.a.instance.Ta(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),
{returnValue:!1,lu:Gb};if(0<Sa&&2!==this.Pe.J(Sa).type)return a.a.instance.Ta(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.z2=!0,{returnValue:!1,lu:Gb};const Ab=this.Pe.J(Sa).Gj,nb=this.Pe.J(Sa).Lc;this.Pe.lG(Sa);this.base.lG(Pa);({Nt:Pa}=this.T2h(Sa));0<Sa&&6===this.Pe.J(Sa-1).type&&this.PCn(Sa-1,Pa);Gb=new l.a;Gb.add(new Ia.a(Ab,nb,Pa,bb.id,
bb.Bu));return{returnValue:!0,lu:Gb}}rth(bb,Gb,Sa){let Pa;var Ab=({Tga:Gb,iwa:Pa}=this.PHa(bb,Sa,!0,Gb,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==Ab)return 3!==Ab&&(a.a.instance.Ta(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",ha[Sa],La[Ab]),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({dga:Ab}=V(this.Pe,Pa));Ab=this.Pe.J(Ab).Gj;
bb=new ra(Sa,bb);Sa=new ra(Sa,Ab);bb.Bm=Sa;Sa.Bm=bb;this.base.insert(Gb,bb);this.Pe.insert(Pa,Sa);return!0}wRl(bb,Gb,Sa){let Pa,Ab,nb;Pa=bb.d4a.equals(bb.zg)?this.Pe.J(Gb).Gj:this.Pe.J(Sa).Gj;bb=bb.e4a===bb.Lc?this.Pe.J(Gb).Lc:this.Pe.J(Sa).Lc;Ab=this.Pe.J(Gb).Gj;Gb=this.Pe.J(Gb).Lc;nb=this.Pe.J(Sa).Gj;Sa=this.Pe.J(Sa).Lc;return{d4a:Pa,e4a:bb,DQf:Ab,Len:Gb,uen:nb,ven:Sa}}D2l(bb,Gb){let Sa;var Pa=bb.zg.equals(bb.Nt)?bb.o7:bb.Nt;const Ab=bb.Lc===bb.tta?bb.Caa:bb.tta;bb.zg.equals(bb.Nt)?Sa=this.Pe.J(Gb).Gj:
(Sa=Pa,Pa=this.Pe.J(Gb).Gj);bb.Lc===bb.tta?(bb=this.Pe.J(Gb).Lc,Gb=Ab):(bb=Ab,Gb=this.Pe.J(Gb).Lc);return{Nt:Sa,o7:Pa,tta:bb,Caa:Gb}}OBh(bb,Gb,Sa,Pa){for(;Pa<bb.length;Pa++){if(!bb.J(Pa).p4()&&6!==bb.J(Pa).type&&2!==bb.J(Pa).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+bb.J(Pa).type);break}bb.J(Pa).Gj=Gb;if(2===bb.J(Pa).type){bb.J(Pa).Lc=Sa;break}}}NBh(bb,Gb,Sa,Pa,Ab){this.OBh(bb,Sa,Pa,Ab);Aa.PBh(bb,Gb,Ab)}MBh(bb,Gb,Sa,Pa){this.OBh(bb,Gb,Sa,Pa+1);Aa.PBh(bb,Gb,Pa)}g$h(bb,
Gb,Sa){let Pa,Ab=-1;if(!({dga:Pa}=Z(Gb,bb.zg,0)).returnValue)return a.a.instance.Ta(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+Sa+"for GraphNodeId "+bb.zg),{returnValue:!1,yVd:Pa};if(!({dga:Ab}=V(Gb,Pa+1)).returnValue||!Gb.J(Ab).Gj.equals(bb.o7))return a.a.instance.Ta(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+Pa+1+" in "+Sa+" of length "+Gb.length),{returnValue:!1,yVd:Pa};this.MBh(Gb,bb.d4a,bb.e4a,Pa);return{returnValue:!0,yVd:Pa}}f$h(bb,Gb,Sa){let Pa;
const Ab=Sa?this.base:this.Pe,nb=Sa?"Base":"Derived",Rb=({Tga:Gb,iwa:Sa,Ffa:Pa}=this.PHa(bb.zg,Gb,Sa,bb.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===Rb||2===Rb)return a.a.instance.Ta(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+nb),{returnValue:Rb,wyf:Gb,noi:Sa,Ffa:Pa};this.NBh(Ab,bb.Nt,bb.o7,bb.Caa,Gb);return{returnValue:Rb,wyf:Gb,noi:Sa,Ffa:Pa}}Y9h(bb,Gb,Sa){return({idx:bb}=X(Gb,bb.zg)).returnValue?2!==Gb.J(bb).type?(a.a.instance.Ta(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+
Sa),{returnValue:!1,xVd:-1}):{returnValue:!0,xVd:bb}:(a.a.instance.Ta(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+Sa),{returnValue:!1,xVd:-1})}PCn(bb,Gb){var Sa=this.Pe.J(bb);if(Gb){let Pa;({dga:Pa}=Z(this.Pe,Gb,0));Sa=Sa.clone();Sa.Gj=Gb;this.Pe.lG(bb);this.Pe.insert(Pa,Sa)}else this.Pe.length>bb&&(this.Pe.J(bb+1).p4()||2===this.Pe.J(bb+1).type)&&(Sa.Gj=this.Pe.J(bb+1).Gj)}Tai(bb,Gb,Sa){var Pa=Gb?this.base:this.Pe;Gb=Gb?"Base":"Derived";Sa=new I.a(Sa,bb.zg,bb.Lc);if(bb.Nt){if(!({dga:Pa}=
Z(Pa,bb.Nt,0)).returnValue)return a.a.instance.Ta(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",bb.Nt,Gb),{returnValue:!1,KMf:Sa,vyf:Pa};Pa+=1}else Pa=0;return{returnValue:!0,KMf:Sa,vyf:Pa}}T2h(bb){let Gb;Gb=null;let Sa=bb-1;if(-1===Sa)return{returnValue:!0,Nt:Gb};6===this.Pe.J(Sa).type&&Sa--;if(2===this.Pe.J(Sa).type||4===this.Pe.J(Sa).type)return Gb=this.Pe.J(Sa).Gj,{returnValue:!0,Nt:Gb};a.a.instance.Ta(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",
this.Pe.J(bb-1).type);return{returnValue:!1,Nt:Gb}}lOc(bb,Gb,Sa,Pa){let Ab,nb=!0;Ab=-1;if(Sa>bb.length)return a.a.instance.Ta(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,Bib:Ab};if(Sa<bb.length){if(-1<Sa&&Sa<bb.length&&!bb.J(Sa).Bm){nb=!1;for(var Rb=Sa+1;Rb<bb.length;Rb++)if(bb.J(Rb).Bm){Sa=Rb;nb=!0;break}}if(!nb)return{returnValue:!1,Bib:Ab};nb=!1;for(Rb=0;bb.J(Sa)&&Rb<Gb.length;Rb++)if(Gb.J(Rb).Bm===bb.J(Sa)){Ab=Rb;nb=!0;break}if(!nb)return{returnValue:!1,
Bib:Ab}}else Ab=Gb.length;if(0<Ab&&Pa&&!Gb.J(Ab-1).Bm){for(bb=Ab-1;0<=bb&&!Gb.J(bb).Bm;bb--);Ab=bb+1;6===Gb.J(Ab).type&&5!==this.Yd.input.source&&Ab++}return{returnValue:!0,Bib:Ab}}PHa(bb,Gb,Sa,Pa,Ab,nb){let Rb;var Mb;let oc;var xb=this.base;let cc=this.Pe,Ob=!1;Sa||(xb=this.Pe,cc=this.base);oc=Mb=Rb=0;let Ub,pb,Zb=0;if(!({XPc:Pa,rlb:Ub,mZc:pb}=R(xb,bb,Pa)).returnValue)return a.a.instance.Ta(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),
{returnValue:3,Tga:Rb,iwa:Mb,Ffa:oc};0<=Pa&&Pa<xb.length&&!xb.J(Pa).Bm&&Ub&&!Ab&&(a.a.instance.Ta(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",nb),this.z2=!0,Zb=Gb===xb.J(Pa).source?1:2,Ob=!0);Ab&&!xb.J(Pa)&&Pa--;Ab&&Ub&&!xb.J(Pa).Bm&&(Ub=!1,pb=0);if(!Sa&&!({idx:bb}=X(cc,bb)).returnValue&&!Ub)return{returnValue:0,Tga:Pa,iwa:Mb,Ffa:oc};if(!({Bib:bb}=this.lOc(xb,cc,Pa,Sa&&!Ub)).returnValue&&!Ob&&(Gb=
!1,1===this.Ijh&&0<Pa&&!pb&&(Pa--,{Bib:bb,returnValue:Gb}=this.lOc(xb,cc,Pa,Sa&&!Ub),Gb&&(Pa++,bb<cc.length-1?bb++:Gb=!1)),!Gb))return a.a.instance.Ta(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),this.Yd.logger.Og(Object.assign(new ia.a,{oj:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.z2=!0,{returnValue:3,Tga:Rb,iwa:Mb,Ffa:oc};if(Ub&&(!L(xb,Pa,pb)||!Ob&&!L(cc,bb,pb)))return a.a.instance.shipAssertTag(17044297,
1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,Tga:Rb,iwa:Mb,Ffa:oc};Rb=Pa;Mb=bb;Ub&&(Rb=Pa+1,Ob||(Mb=xb.J(Pa),Sa=cc.J(bb),Mb.Bm=Sa,Sa.Bm=Mb,xb=xb.J(Pa+1),Mb=cc.J(bb+1),xb.Bm=Mb,Mb.Bm=xb,Mb=bb+1));if(Mb>=cc.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+Mb+" secondaryList length was "+cc.length),{returnValue:3,Tga:Rb,iwa:Mb,Ffa:oc};
for(xb=0;xb<Mb;xb++)cc.J(xb).Gj.equals(cc.J(Mb).Gj)&&(oc+=cc.J(xb).length);return{returnValue:Zb,Tga:Rb,iwa:Mb,Ffa:oc}}fdf(bb,Gb,Sa){this.uNg.contains(bb.id)&&this.Wbb.Z(bb.id,new l.a);for(--Sa;Sa>=Gb;Sa--)this.uNg.contains(bb.id)?this.Wbb.J(bb.id).insert(this.Wbb.J(bb.id).length,this.Pe.J(Sa)):this.Pe.J(Sa).Bm&&(this.Pe.J(Sa).Bm.Bm=null),this.Pe.lG(Sa)}dAf(bb,Gb,Sa){if(this.Wbb.nb(bb.Bu)){const Pa=this.Wbb.J(bb.Bu);for(let Ab=0;Ab<Pa.length;Ab++)Pa.J(Ab).Gj=Sa.Gj,Object(ja.a)(I.a,Sa)&&Object(ja.a)(I.a,
Pa.J(Ab))&&(Pa.J(Ab).Lc=Sa.Lc);this.Pe.PC(Gb,this.Wbb.J(bb.Bu));this.Wbb.remove(bb.Bu)}else this.Pe.insert(Gb,Sa)}Cfm(bb){let Gb,Sa;Sa=Gb=-1;if(!bb.Bm)return{returnValue:!1,t4b:Gb,Cdf:Sa};var Pa;let Ab=0,nb=!1;if(!({idx:Pa}=X(this.Pe,bb.Bm.Gj)).returnValue)return{returnValue:!1,t4b:Gb,Cdf:Sa};for(;Pa<this.Pe.length;Pa++){if(bb.Bm===this.Pe.J(Pa)){Gb=Pa;Sa=Ab;nb=!0;break}Ab+=this.Pe.J(Pa).length}return{returnValue:nb,t4b:Gb,Cdf:Sa}}Tjf(bb){let Gb;Gb=new l.a;let Sa=0,Pa=0;for(;Sa<bb.length;){if(Pa>=
this.base.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,amc:Gb};if(bb.J(Sa).length>this.base.J(Pa).length){if(!L(bb,Sa,this.base.J(Pa).length))return a.a.instance.Ta(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",Sa,this.base.J(Pa).length),{returnValue:!1,amc:Gb}}else if(bb.J(Sa).length<this.base.J(Pa).length){var Ab=
!!this.base.J(Pa).Bm,nb=0;if(Ab&&!({Bib:nb}=this.lOc(this.base,this.Pe,Pa,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",Pa),{returnValue:!1,amc:Gb};if(!L(this.base,Pa,bb.J(Sa).length)||Ab&&!L(this.Pe,nb,bb.J(Sa).length))return a.a.instance.Ta(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),
{returnValue:!1,amc:Gb};if(Ab){Ab=this.base.J(Pa);var Rb=this.Pe.J(nb);Ab.Bm=Rb;Rb.Bm=Ab;Ab=this.base.J(Pa+1);nb=this.Pe.J(nb+1);Ab.Bm=nb;nb.Bm=Ab}}if(this.base.J(Pa).Bm&&5!==this.base.J(Pa).type&&this.base.J(Pa).p4()&&(nb=this.base.J(Pa),Ab=bb.J(Sa),!nb.bJ.equals(Ab.bJ)||!nb.AF.uA(Ab.AF))){let Mb;if(!({t4b:Rb,Cdf:Mb}=this.Cfm(this.base.J(Pa))).returnValue)return{returnValue:!1,amc:Gb};Gb.add(new ua(this.Pe.J(Rb).Gj,Mb,nb,Ab))}Sa++;Pa++}return{returnValue:!0,amc:Gb}}static PBh(bb,Gb,Sa){for(--Sa;0<=
Sa;Sa--){if(!bb.J(Sa).p4()&&6!==bb.J(Sa).type){a.a.instance.shipAssertTag(17311187,1,2===bb.J(Sa).type||4===bb.J(Sa).type,"Found merge block of type "+bb.J(Sa).type);break}bb.J(Sa).Gj=Gb}}static Wvi(bb){return bb?!1:(a.a.instance.Ta(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(E.a)(Aa,"ParagraphMergeUsingHintsTwinList",null,[1836]);var db=c(1706),eb=c(1707),ib=c(1703),lb=c(1705),Ya=c(1704);class Fa{constructor(bb,Gb,
Sa,Pa){this.cp=bb;this.length=Gb;this.nBd=Sa;this.Xad=Pa}}Object(E.a)(Fa,"UpdateFormattingIdsPosInfo",null,[]);class $a{constructor(bb,Gb,Sa){this.z2=!1;this.Wbb=new z.a;this.l6g=!1;this.Yd=bb;this.Ijh=Sa;this._base=Gb;this.wxe=aa(Gb);if(!N(this.base,this.Pe))throw a.a.instance.Ta(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),bb.logger.Og(Object.assign(new J.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");this.Yd.runtime.Xb.Zhb(1000010)&&(this.l6g=!0)}get base(){return this._base}get Pe(){return this.wxe}get mergeConflict(){return this.z2}x1e(bb,
Gb){switch(bb.type){case 11:return this.qDk(bb,Gb);case 8:return this.X0e(bb,Gb);case 10:return this.V0e(bb);default:return!1}}w1e(bb,Gb){switch(bb.type){case 11:return this.pDk(bb,Gb);case 8:return this.W0e(bb,Gb);case 10:return this.U0e(bb);default:return{returnValue:!1,lu:null}}}sth(){a.a.instance.Ta(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.Yd.logger.Og(Object.assign(new J.a,{oj:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}rth(){a.a.instance.Ta(574433296,
1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.Yd.logger.Og(Object.assign(new J.a,{oj:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}Tjf(bb){let Gb;Gb=new l.a;let Sa=0,Pa=0,Ab=0;for(;Sa<bb.length;){if(Pa>=this.base.length)return a.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),
{returnValue:!1,Wad:Gb};if(bb.J(Sa).length>this.base.J(Pa).length){if(!L(bb,Sa,this.base.J(Pa).length))return a.a.instance.Ta(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,Wad:Gb}}else if(bb.J(Sa).length<this.base.J(Pa).length&&!this.S6a(Ab+bb.J(Sa).length,!0).returnValue)return a.a.instance.Ta(574433299,1,2,
"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,Wad:Gb};if(this.base.J(Pa).Bm&&5!==this.base.J(Pa).type&&this.base.J(Pa).p4()){const nb=this.base.J(Pa),Rb=bb.J(Sa);if(!nb.bJ.equals(Rb.bJ)||!nb.AF.uA(Rb.AF)){let Mb,oc;if(({t4b:Mb,lQh:oc}=this.Dfm(this.base.J(Pa))).returnValue)Gb.add(new Fa(oc,this.Pe.J(Mb).length,nb,Rb));else return a.a.instance.Ta(571757956,
1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,Wad:Gb}}}Ab+=this.base.J(Pa).length;Sa++;Pa++}return{returnValue:!0,Wad:Gb}}qDk(bb,Gb){let Sa;if(!({ADa:Sa}=this.S6a(bb.cp,!0)).returnValue)return a.a.instance.Ta(574433300,1,2,"ApplyInsertTextHintToDerived"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"ApplyInsertTextHintToDerived",
eventId:"8ps6u"})),!1;for(let Ab=0;Ab<bb.K_.length;Ab++)switch(bb.K_.J(Ab).type){case 7:var Pa=bb.K_.J(Ab);this.Pe.insert(Sa,new Ca(Gb,null,Pa.text,Pa.id));break;case 9:Pa=bb.K_.J(Ab);this.Pe.insert(Sa,new I.a(Gb,Pa.zg,Pa.Lc));break;default:return a.a.instance.Ta(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}X0e(bb,Gb){let Sa,Pa;if(!({ADa:Sa}=this.S6a(bb.cp,!0)).returnValue||!({ADa:Pa}=this.S6a(bb.cp+
bb.text.length,!1)).returnValue)return a.a.instance.Ta(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(bb=Pa;bb>=Sa;bb--)this.Pe.J(bb).source!==Gb&&this.$Hd(this.Pe,bb);return!0}V0e(bb){let Gb;if(!({ADa:Gb}=this.S6a(bb.cp,!0)).returnValue)return a.a.instance.Ta(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),
!1;this.jdf(this.Pe,bb,Gb);return!0}pDk(bb,Gb){let Sa;Sa=null;let Pa,Ab;if(!({xzb:Pa,ADa:Ab}=this.S6a(bb.cp,!0)).returnValue)return a.a.instance.Ta(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,lu:Sa};var nb=this.Gof(this.Pe,Ab-1);nb=new Ya.a(nb);for(let Rb=0;Rb<bb.K_.length;Rb++)switch(bb.K_.J(Rb).type){case 7:nb.K_.add(this.a1e(bb.K_.J(Rb),Gb,Pa,Ab));break;
case 9:nb.K_.add(this.rDk(bb.K_.J(Rb),Gb,Pa,Ab));break;default:return a.a.instance.Ta(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,lu:Sa}}Sa=new l.a;Sa.add(nb);return{returnValue:!0,lu:Sa}}a1e(bb,Gb,Sa,Pa){const Ab=new Ca(Gb,bb.zg,bb.text,bb.id);Gb=new Ca(Gb,bb.zg,bb.text,bb.id);Ab.Bm=Gb;Gb.Bm=Ab;this.base.insert(Sa,Ab);this.Pe.insert(Pa,Gb);Sa=new lb.a(bb.zg,bb.text);Sa.id=bb.id;return Sa}rDk(bb,
Gb,Sa,Pa){const Ab=new I.a(Gb,bb.zg,bb.Lc);Gb=new I.a(Gb,bb.zg,bb.Lc);Ab.Bm=Gb;Gb.Bm=Ab;this.base.insert(Sa,Ab);this.Pe.insert(Pa,Gb);return new ib.a(bb.zg,bb.Lc)}W0e(bb){let Gb;Gb=new l.a;let Sa;var Pa;let Ab;if(!({xzb:Sa,ADa:Pa}=this.S6a(bb.cp,!0)).returnValue||!({xzb:Ab,ADa:nb}=this.S6a(bb.cp+bb.text.length,!1)).returnValue)return a.a.instance.Ta(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),
{returnValue:!1,lu:Gb};this.Yd.runtime.Xb.gTd(1000010);for(bb=nb;bb>=Pa;bb--)if(this.Pe.J(bb).Bm){var nb=bb;const Rb=({yQf:bb}=this.SAl(bb,Pa)).returnValue;Rb&&(Gb.add(Rb),this.$Hd(this.Pe,bb,nb))}for(Pa=Ab;Pa>=Sa;Pa--)this.$Hd(this.base,Pa);return{returnValue:!0,lu:Gb}}U0e(bb){let Gb;Gb=null;let Sa,Pa;if(!({xzb:Sa,ADa:Pa}=this.S6a(bb.cp,!0)).returnValue)return a.a.instance.Ta(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"ApplyDeleteParaHintToBaseAndDerived",
eventId:"8ps6z"})),{returnValue:!1,lu:Gb};if(!this.jdf(this.base,bb,Sa))return a.a.instance.Ta(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,lu:Gb};this.jdf(this.Pe,bb,Pa)&&(Gb=new l.a,Gb.add(new db.a(this.Gof(this.Pe,Pa-1),bb.zg,bb.Lc)));return{returnValue:!0,lu:Gb}}S6a(bb,Gb){var Sa;var Pa=Sa=-1;let Ab,nb;if(!({rlb:nb,hwh:bb,gwh:Ab}=O(this.base,bb,this.Yd.logger)).returnValue)return{returnValue:!1,
xzb:Sa,ADa:Pa};const Rb=bb>=this.base.length;Rb&&bb--;if(this.base.J(bb).Bm){const Mb=this.pCl(this.Pe,this.base.J(bb));if(nb){if(0>Mb||!L(this.base,bb,Ab)||!L(this.Pe,Mb,Ab))return a.a.instance.Ta(575706444,1,2,"SplitTwinListAndFindIdx"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,xzb:Sa,ADa:Pa};Sa=this.base.J(bb);Pa=this.Pe.J(Mb);Sa.Bm=Pa;Pa.Bm=Sa;Sa=this.base.J(bb+1);Pa=this.Pe.J(Mb+1);Sa.Bm=Pa;Pa.Bm=Sa;Sa=Gb?bb+1:bb;Pa=Gb?Mb+1:Mb}else Gb?
(Sa=Rb?bb+1:bb,Pa=Rb?Mb+1:Mb):(Sa=Rb?bb:bb-1,Pa=Rb?Mb:Mb-1)}else if(nb){if(L(this.base,bb,Ab))Sa=Gb?bb+1:bb;else return a.a.instance.Ta(575706445,1,2,"SplitTwinListAndFindIdx"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,xzb:Sa,ADa:Pa};Gb?(Pa=({TFb:Pa}=this.b6b(this.base,this.Pe,bb,!1)).returnValue?Pa+1:0,Pa=Pa>=this.Pe.length?this.Pe.length-1:Pa):(Pa=({TFb:Pa}=this.b6b(this.base,this.Pe,bb,!0)).returnValue?Pa-1:this.Pe.length-1,Pa=0>Pa?
0:Pa)}else Gb?(({TFb:Pa}=this.b6b(this.base,this.Pe,bb,!0)).returnValue||(({TFb:Pa}=this.b6b(this.base,this.Pe,bb,!1)).returnValue?Pa+=1:(Pa=Rb?this.Pe.length-1:0,Pa=0>Pa?0:Pa)),Sa=Rb?bb+1:bb):(({TFb:Pa}=this.b6b(this.base,this.Pe,bb,!1)).returnValue||(({TFb:Pa}=this.b6b(this.base,this.Pe,bb,!0)).returnValue?--Pa:(Pa=bb?this.Pe.length-1:0,Pa=0>Pa?0:Pa)),Sa=Rb?bb:bb-1);return{returnValue:!0,xzb:Sa,ADa:Pa}}b6b(bb,Gb,Sa,Pa){let Ab=null;if(Pa)for(;Sa<bb.length;Sa++){if(bb.J(Sa).Bm){Ab=bb.J(Sa).Bm;break}}else for(;0<=
Sa;Sa--)if(bb.J(Sa).Bm){Ab=bb.J(Sa).Bm;break}if(Ab)for(bb=0;bb<Gb.length;bb++)if(Gb.J(bb)===Ab)return Gb=bb,{returnValue:!0,TFb:Gb};return{returnValue:!1,TFb:-1}}pCl(bb,Gb){for(let Sa=0;Sa<bb.length;Sa++)if(bb.J(Sa).Bm===Gb)return Sa;return-1}$Hd(bb,Gb,Sa=-1){for(Sa=0>Sa?Gb:Sa;Sa>=Gb;Sa--)bb.J(Sa).Bm&&(bb.J(Sa).Bm.Bm=null),bb.lG(Sa)}Gof(bb,Gb){let Sa=0;for(;0<=Gb;Gb--)Sa+=bb.J(Gb).length;return Sa}Vdm(bb){bb=Object(n.a)(oa.a,bb);bb||(a.a.instance.Ta(575706448,1,2,"GetTextBlock"),this.Yd.logger.Og(Object.assign(new J.a,
{oj:"GetTextBlock",eventId:"8ujvq"})));return bb}SAl(bb,Gb){let Sa="",Pa=bb;for(;Pa>=Gb&&this.Pe.J(Pa).Bm&&2!==this.Pe.J(Pa).type;)Sa=this.Vdm(this.Pe.J(Pa)).text+Sa,Pa--;Gb=0>Pa?0:this.Gof(this.Pe,Pa);return!this.l6g||Pa<bb?(bb=Pa+1,{returnValue:new eb.a(Gb,Sa),yQf:bb}):{returnValue:null,yQf:Pa}}Dfm(bb){let Gb,Sa,Pa=!1;Sa=Gb=0;if(!bb.Bm)return{returnValue:!1,t4b:Gb,lQh:Sa};for(Gb=0;Gb<this.Pe.length;Gb++){if(this.Pe.J(Gb).Bm===bb){Pa=!0;break}Sa+=this.Pe.J(Gb).length}return{returnValue:Pa,t4b:Gb,
lQh:Sa}}jdf(bb,Gb,Sa){Sa=Sa===bb.length?--Sa:Sa;Sa>bb.length-1&&(a.a.instance.Ta(571757957,1,2,"DeleteEopInList: Idx out of range"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"DeleteEopInList",eventId:"8ffwf"})));if(2===bb.J(Sa).type){const Pa=bb.J(Sa);if(Pa.Gj!==Gb.zg||Pa.Lc!==Gb.Lc)return!1;this.$Hd(bb,Sa);return!0}return!1}}Object(E.a)($a,"ParagraphMergeUsingHintsTwinListLcs",null,[1836]);var Db=c(1551),gc=c(1519),Eb=c(1702);c.d(M,"a",function(){return kb});class kb{constructor(bb,Gb,Sa,Pa,Ab,
nb,Rb=null,Mb=null,oc=null){this.aQ=this.mta=this.jKa=this.pra=null;this._initialized=!1;this.Yd=bb;this.HF=Gb;this.LBa=Pa;this.sAa=Sa;this.Sra=Ab;this.rte=new e.a;for(bb=0;bb<this.HF.length;bb++)this.rte.add(this.HF.J(bb).id);this.mUg=new e.a;for(bb=0;bb<this.sAa.length;bb++)this.mUg.add(this.sAa.J(bb).id);this.vjh=new e.a;for(bb=0;bb<this.LBa.length;bb++)this.vjh.add(this.LBa.J(bb).id);this.Mg=nb;this.dWe=Rb||G.a.instance;this.pI=Mb;this.vW=oc;this.xub=1===(this.pI&&this.vW&&1===this.pI.GIa&&1===
this.vW.GIa?1:0);this.Rra=0}get T7f(){return 1!==this.Rra}Aym(){var bb=!0;if(this.pI&&this.vW)return bb;if(this.pI||this.vW)return a.a.instance.Ta(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),!1;this.Yd.runtime.xu.nb(w.a.uL)&&(bb=this.Yd.runtime.xu.J(w.a.uL),bb=this.Yng(bb,this.Yd.runtime.WCa.id,"favored")&&({updateHints:this.pI}=this.uqi(bb,
this.rte,this.mUg,this.Yd.runtime.xu,"favored")).returnValue);bb&&this.Yd.runtime.Hq.nb(w.a.uL)&&(bb=this.Yd.runtime.Hq.J(w.a.uL),bb=this.Yng(bb,this.Yd.runtime.WCa.id,"unfavored")&&({updateHints:this.vW}=this.uqi(bb,this.rte,this.vjh,this.Yd.runtime.Hq,"unfavored")).returnValue);this.pI=this.pI?this.pI:new Eb.a(new l.a,0);this.vW=this.vW?this.vW:new Eb.a(new l.a,0);bb&&this.Yd.input.VFb&&(bb=this.Yd.input.U9.last().f1a(w.a.uL),bb=this.Yng(bb,this.Yd.input.U9.last().OW.id,"alreadyMerged"));return bb}Hwm(){const bb=
new e.a;if(this.xub)return bb;const Gb=this.pI?this.pI.updateHints.f5():new l.a;let Sa=0;for(;Sa<Gb.length-1;){const Pa=Gb.J(Sa);let Ab,nb=!1;for(Ab=Sa+1;Ab<Gb.length;Ab++){const Rb=Gb.J(Ab);if(Pa.wxi(Rb)){bb.add(Pa.id);Gb.lG(Ab);Gb.lG(Sa);nb=!0;break}}nb||Sa++}return bb}Yng(bb,Gb,Sa){bb=this.Mg.getPropertyString(bb,m.a.bUa);bb=y.a.If(bb);return Gb.equals(bb)?!0:(this.Q6c(2),a.a.instance.Ta(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",
this.Yd.runtime.WCa.id,bb,Sa),!1)}uqi(bb,Gb,Sa,Pa,Ab){let nb;nb=new Eb.a(new l.a,0);bb=this.Mg.getPropertyObjectIds(bb,m.a.p1).f5();for(let Mb=0;Mb<bb.length;Mb++){if(!Pa.nb(bb.J(Mb)))return a.a.instance.Ta(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",bb.J(Mb),Ab),{returnValue:!1,updateHints:nb};const oc=Pa.J(bb.J(Mb));var Rb=y.a.If(this.Mg.getPropertyString(oc,m.a.vja));if(Gb.contains(Rb)||Sa.contains(Rb)){Rb=
this.dWe.GPc(oc);if(!Rb)return a.a.instance.Ta(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",oc.id,Ab),{returnValue:!1,updateHints:nb};nb.updateHints.add(Rb)}}0<bb.length&&a.a.instance.Ta(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",Ab,bb.$q(),nb.updateHints.$q());return{returnValue:!0,
updateHints:nb}}Kxm(){return({wK:this.pra,pLc:this.jKa,qad:this.mta}=Db.a.wLh(this.Yd,this.Mg,this.HF,this.sAa,this.LBa,this.Sra,!0,!0)).returnValue?!0:!1}yym(bb){const Gb=Db.a.HGd(this.Mg,Sa=>this.Yd.runtime.tk.J(Sa),this.HF,1,this.Sra,!0,!0).returnValue;if(!Gb)return a.a.instance.Ta(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.aQ=this.xub?new $a(this.Yd,Gb,1):new Aa(this.Yd,Gb,bb,this.pI?this.pI.GIa:0);return!0}initialize(){if(this._initialized)return!1;
this._initialized=!0;if(!this.Aym()||!this.Kxm())return!1;const bb=this.Hwm();return this.yym(bb)?!0:!1}Vai(bb){const Gb=new l.a;let Sa="";for(let Pa=0;Pa<bb.length;Pa++){const Ab=bb.J(Pa);Ab.p4()?Sa+=bb.J(Pa).text:2===Ab.type?(Gb.add(new pa(Ab.Gj,Ab.type,Sa,Ab.Lc)),Sa=""):4===Ab.type&&(Gb.add(new pa(Ab.Gj,Ab.type)),Sa="")}return Gb}validateUpdateHintsAreComplete(bb,Gb,Sa){Gb=this.Vai(Gb);bb=this.Vai(bb);let Pa=Gb.length===bb.length;if(Pa)for(let Ab=0;Ab<Gb.length;Ab++)if(!Gb.J(Ab).isEqual(bb.J(Ab))){Pa=
!1;break}Pa||(this.Q6c(4),a.a.instance.Ta(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",Sa,bb.$q(),Gb.$q()));return Pa}$th(bb,Gb,Sa){(Gb=({O7a:bb}=this.ZEk(bb,Gb,Sa)).returnValue)||this.Q6c(this.aQ.mergeConflict?1:3);return{returnValue:Gb,O7a:bb}}ZEk(bb,Gb,Sa){let Pa;Pa=new l.a;let Ab=!0;var nb=0;let Rb=null,Mb=this.pI?this.pI.updateHints.length:0;for(var oc=0;oc<Mb&&Ab;oc++)Rb=
this.pI.updateHints.J(oc),nb<this.vW.updateHints.length&&Rb.id.equals(this.vW.updateHints.J(nb).id)&&5!==this.Yd.input.source?({returnValue:Ab}=this.aQ.w1e(Rb,2),nb++):Ab=this.aQ.x1e(Rb,2);if(!Ab)return a.a.instance.Ta(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",Rb.toString()),{returnValue:!1,O7a:Pa};if(!this.validateUpdateHintsAreComplete(this.aQ.Pe,this.jKa,"Favored"))return{returnValue:!1,O7a:Pa};if(bb&&1===this.Yd.input.Jha&&!this.aQ.sth(Gb,Sa,2))return a.a.instance.Ta(17409920,
1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",Gb,Sa),{returnValue:!1,O7a:Pa};Ab=!0;oc=new l.a;for(Mb=this.vW?this.vW.updateHints.length:0;nb<Mb&&Ab;nb++){Rb=this.vW.updateHints.J(nb);let xb;({lu:xb,returnValue:Ab}=this.aQ.w1e(Rb,4));Ab&&xb&&oc.PC(oc.length,xb)}return Ab?this.validateUpdateHintsAreComplete(this.aQ.base,this.mta,"Unfavored")?bb&&2===this.Yd.input.Jha&&!this.aQ.rth(Gb,Sa,4)?(a.a.instance.Ta(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
Gb,Sa),{returnValue:!1,O7a:Pa}):{returnValue:!0,O7a:oc}:{returnValue:!1,O7a:Pa}:(a.a.instance.Ta(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",Rb.id,Rb.type),{returnValue:!1,O7a:Pa})}j1l(){let bb,Gb=0;let Sa=0,Pa=y.a.nil;for(bb=new z.a;Sa<this.aQ.base.length;){const Rb=this.aQ.base.J(Sa);Pa.equals(Rb.Gj)||(Gb=0,Pa=Rb.Gj);if(5===Rb.type){var Ab=Gb+Rb.length;var nb=void 0;let Mb;const oc=aa(this.mta);if(!({index:nb}=U(oc,Rb.Gj,Gb)).returnValue||!({index:Mb}=
U(oc,Rb.Gj,Ab)).returnValue)return a.a.instance.Ta(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",Rb.Fad),{returnValue:!1,ZMi:bb};for(Ab=new l.a;nb<Mb;nb++)Ab.add(oc.J(nb));bb.Z(Rb.Fad,Ab)}Gb+=Rb.length;Sa++}return{returnValue:!0,ZMi:bb}}k1l(){let bb;bb=new z.a;let Gb=0;for(let Pa=0;Pa<this.aQ.base.length;Pa++){const Ab=this.aQ.base.J(Pa);if(5===Ab.type){var Sa=void 0;let nb;const Rb=aa(this.mta);
if(!({index:Sa}=W(Rb,Gb,this.Yd.logger)).returnValue||!({index:nb}=W(Rb,Gb+Ab.length,this.Yd.logger)).returnValue)return a.a.instance.Ta(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,$Mi:bb};const Mb=new l.a;for(;Sa<nb;Sa++)Mb.add(Rb.J(Sa));bb.Z(Ab.Fad,Mb)}Gb+=Ab.length}return{returnValue:!0,$Mi:bb}}NDk(bb){let Gb;Gb=new l.a;let Sa;if(this.xub){if(!({$Mi:Sa}=this.k1l()).returnValue)return{returnValue:!1,PYc:Gb}}else if(!({ZMi:Sa}=this.j1l()).returnValue)return{returnValue:!1,
PYc:Gb};let Pa;Pa=this.xub?new $a(this.Yd,aa(this.jKa),1):new Aa(this.Yd,aa(this.jKa),new e.a,this.pI?this.pI.GIa:0);for(var Ab=0;Ab<bb.length;Ab++)if(!Pa.x1e(bb.J(Ab),4))return{returnValue:!1,PYc:Gb};for(bb=Pa.Pe.length-1;0<=bb;bb--)5===Pa.Pe.J(bb).type&&(Ab=Pa.Pe.J(bb).Fad,Pa.Pe.lG(bb),Pa.Pe.PC(bb,Sa.J(Ab)));this.xub&&(this.zOh(Pa.Pe),this.zOh(this.aQ.Pe));if(!this.validateUpdateHintsAreComplete(this.aQ.Pe,Pa.Pe,"Merged"))return{returnValue:!1,PYc:Gb};Gb=Pa.Pe;return{returnValue:!0,PYc:Gb}}zOh(bb){const Gb=
new z.a;for(let Sa=bb.length-1;0<=Sa;Sa--){const Pa=Object(n.a)(I.a,bb.J(Sa));Pa&&(Gb.nb(Pa.Lc)?Gb.J(Pa.Lc).source!==Pa.source&&bb.lG(Sa):Gb.add(Pa.Lc,Pa))}}YEk(bb){let Gb;if(!({Wad:Gb}=this.aQ.Tjf(aa(this.mta))).returnValue)return!1;for(let Pa=0;Pa<Gb.length;Pa++){const Ab=Gb.J(Pa);let nb,Rb;if(!({index:nb}=W(bb,Ab.cp,this.Yd.logger)).returnValue||!({index:Rb}=W(bb,Ab.cp+Ab.length,this.Yd.logger)).returnValue)return a.a.instance.Ta(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),
this.Yd.logger.Og(Object.assign(new J.a,{oj:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var Sa=!1;for(let Mb=nb;Mb<Rb&&!Sa;Mb++)Sa=!Ab.nBd.bJ.equals(bb.J(Mb).bJ);if(!Sa){for(Sa=nb;Sa<Rb;Sa++)bb.lG(nb);bb.insert(nb,Ab.Xad)}}return!0}XEk(bb){let Gb;if(!({amc:Gb}=this.aQ.Tjf(aa(this.mta))).returnValue)return!1;for(let Ab=0;Ab<Gb.length;Ab++){var Sa=Gb.J(Ab);let nb,Rb;if(({index:nb}=U(bb,Sa.zg,Sa.cp)).returnValue&&({index:Rb}=U(bb,Sa.zg,Sa.cp+Sa.Xad.length)).returnValue){var Pa=!1;for(let Mb=
nb;Mb<Rb&&!Pa;Mb++)Pa=!Sa.nBd.bJ.equals(bb.J(Mb).bJ)||!Sa.nBd.AF.uA(bb.J(Mb).AF);if(Pa){if(this.pI&&1===this.pI.GIa||this.vW&&1===this.vW.GIa)return!1}else{for(Pa=nb;Pa<Rb;Pa++)bb.lG(nb);bb.insert(nb,Sa.Xad)}}else if(Sa=Sa.Xad.nEm,a.a.instance.Ta(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",Sa),Sa||this.pI&&1===this.pI.GIa||this.vW&&1===this.vW.GIa)return!1}return!0}l6l(bb){let Gb,Sa;Sa=new l.a;
Gb=this.Yd.runtime.an.J(w.a.uL);let Pa;({SMf:Pa}=kb.q3h(this.Yd,this.Mg));const Ab=new l.a;for(let Rb=0;Rb<bb.length;Rb++){if(Pa.contains(bb.J(Rb).id,(oc,xb)=>oc.equals(xb)))continue;if(this.Yd.runtime.an.nb(bb.J(Rb).id))return a.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",bb.J(Rb).id),{returnValue:!1,B9d:Gb,A9d:Sa};Ab.add(bb.J(Rb).id);var nb=bb.J(Rb).k1a();const Mb=new gc.a(nb);nb=nb.Jl();for(const oc of nb)Mb.pC(oc);Sa.add(Mb)}bb=this.Mg.getPropertyObjectIds(Gb.vm,
m.a.p1);bb.PC(bb.length,Ab);this.Mg.setPropertyObjectIds(Gb.vm,m.a.p1,bb);return{returnValue:!0,B9d:Gb,A9d:Sa}}VOd(bb){return String.format("Name: {0}, Message: {1}, Stack: {2}",bb.name,bb.message,bb.stack)}Q6c(bb){0===this.Rra&&(this.Rra=bb)}Nlc(){let bb;bb=null;let Gb,Sa;var Pa;try{if({an:bb,B9d:Gb,A9d:Sa,returnValue:Pa}=this.OLo(),Pa){if(Gb&&Sa){this.Yd.runtime.an.Z(Gb.vm.id,Gb);for(Pa=0;Pa<Sa.length;Pa++){const Mb=Sa.J(Pa);this.Yd.runtime.an.Z(Mb.vm.id,Mb)}const Ab=Gb.vm,nb=this.Mg.getPropertyObjectIds(Ab,
m.a.p1),Rb=this.Mg.getPropertyString(Ab,m.a.bUa);a.a.instance.Ta(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",nb.$q(),Rb)}else a.a.instance.Ta(593826831,1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,an:bb}}}catch(Ab){a.a.instance.Ta(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.VOd(Ab))}this.Q6c(5);a.a.instance.Ta(17409922,
1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Rra,this.T7f);this.N3a();this.pI&&1===this.pI.GIa&&this.Yd.logger.Og(Object.assign(new ea.a,{eventId:"bc04c",oj:"ParagraphMergeUsingHints.TryDoMerge",info:v[this.Rra]+"/LCS"}));return{returnValue:!1,an:bb}}OLo(){let bb,Gb,Sa;Sa=Gb=bb=null;let Pa;Pa=this.initialize();this.Yd.logger.zU("PMUH Initialize");let Ab=null;Pa=Pa&&({O7a:Ab}=this.$th(!1,y.a.nil,0)).returnValue;this.Yd.logger.zU("PMUH ApplyUpdateHints");
let nb=new l.a;Pa=Pa&&({PYc:nb}=this.NDk(Ab)).returnValue;this.Yd.logger.zU("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");Pa=this.xub?Pa&&this.YEk(nb):Pa&&this.XEk(nb);this.Yd.logger.zU("PMUH ApplyUnfavoredFormattingChanges");this.xub&&!this.p6n(nb)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.Yd.logger.Og(Object.assign(new J.a,{oj:"ReuseParaIdsIfPossible",eventId:"8ettb"})),Pa=!1);const Rb=this.RQd(nb);Pa=Pa&&({z9d:bb}=Db.a.xOc(this.Yd,this.Mg,
this.Sra,nb,Rb)).returnValue;this.Yd.logger.zU("PMUH GetMergeableObjectsFromMergeBlocks");this.pI&&1===this.pI.GIa&&this.vW&&1===this.vW.GIa||(Pa=Pa&&({B9d:Gb,A9d:Sa}=this.l6l(F(Ab))).returnValue,this.Yd.logger.zU("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:Pa,mergeConflict:!!this.aQ&&this.aQ.mergeConflict,an:bb,B9d:Gb,A9d:Sa}}RQd(bb){const Gb=new l.a;for(let Sa=0;Sa<bb.length;Sa++)2===bb.J(Sa).type&&Gb.add(bb.J(Sa).Gj);return Gb}ypf(bb){const Gb=new l.a;for(let Sa=0;Sa<bb.length;Sa++)2===
bb.J(Sa).type&&Gb.add(bb.J(Sa));return Gb}p6n(bb){var Gb=this.ypf(this.pra),Sa=this.ypf(this.jKa),Pa=this.ypf(this.mta),Ab=this.RQd(Gb),nb=this.RQd(Sa),Rb=this.RQd(Pa);nb=K.b(Ab,nb,Rb);Ab=new l.a;for(Rb=0;Rb<nb.length;Rb++)Ab.PC(Ab.length,nb.J(Rb).rCl());nb=this.wCl(bb);Gb=this.sCl(nb,Ab,Gb,Sa,Pa);Sa=0;Pa=new e.a;for(Ab=0;Ab<bb.length;Ab++)if(nb=bb.J(Ab),2===nb.type)if(Pa.contains(nb.Gj))if(Sa<Gb.length)bb.lG(Ab),bb.insert(Ab,Gb.J(Sa)),Sa++;else return!1;else Pa.add(nb.Gj);0<bb.length&&2!==bb.J(bb.length-
1).type&&Sa<Gb.length&&bb.insert(bb.length,Gb.J(Sa));return!0}wCl(bb){const Gb=new e.a;for(let Sa=0;Sa<bb.length;Sa++)2===bb.J(Sa).type&&Gb.add(bb.J(Sa).Gj);return Gb}sCl(bb,Gb,Sa,Pa,Ab){const nb=new l.a;for(let Rb=0;Rb<Gb.length;Rb++){const Mb=Gb.J(Rb);if(!bb.contains(Mb)){let oc;(({block:oc}=this.Ljf(Pa,Mb)).returnValue||({block:oc}=this.Ljf(Ab,Mb)).returnValue||({block:oc}=this.Ljf(Sa,Mb)).returnValue)&&oc&&nb.add(oc)}}return nb}Ljf(bb,Gb){for(let Sa=0;Sa<bb.length;Sa++)if(2===bb.J(Sa).type&&bb.J(Sa).Gj===
Gb)return bb=bb.J(Sa),{returnValue:!0,block:bb};return{returnValue:!1,block:null}}N3a(){const bb=new l.a;Db.a.Tcc(this.Mg,"BaseObjects_",this.HF,bb);Db.a.Tcc(this.Mg,"FavoredObjects_",this.sAa,bb);Db.a.Tcc(this.Mg,"ConflictObjects_",this.LBa,bb)}gQk(){let bb,Gb;bb=y.a.nil;Gb=-1;let Sa=0;for(let Pa=0;Pa<this.aQ.Pe.length;Pa++){const Ab=this.aQ.Pe.J(Pa);if(Ab.p4())Sa+=Ab.length;else if(6!==Ab.type)Sa=0;else return bb=Ab.Gj,Gb=Sa,{returnValue:!0,objectId:bb,cp:Gb}}a.a.instance.Ta(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");
return{returnValue:!1,objectId:bb,cp:Gb}}Bad(bb,Gb){let Sa,Pa;Pa=Gb;Sa=bb;try{let Ab=this.initialize();if(Ab=(Ab=Ab&&this.$th(!0,bb,Gb).returnValue)&&({objectId:Sa,cp:Pa}=this.gQk()).returnValue)return a.a.instance.Ta(17409924,1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",Sa,Pa),{returnValue:!0,O5a:Sa,Rpa:Pa}}catch(Ab){a.a.instance.Ta(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.VOd(Ab))}this.Q6c(5);
a.a.instance.Ta(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Rra,this.T7f);this.N3a();return{returnValue:!1,O5a:Sa,Rpa:Pa}}static q3h(bb,Gb){let Sa;Sa=new l.a;if(!bb.input.VFb)return{returnValue:!0,SMf:Sa};bb=bb.input.U9.last().f1a(w.a.uL);Sa=Gb.getPropertyObjectIds(bb,m.a.p1);return{returnValue:!0,SMf:Sa}}static wDn(bb){if(!Db.a.Hff(bb))return!0;const Gb=new A.a;bb.runtime.an.Z(w.a.uL,Db.a.Bym(bb,
Gb));return!0}static bDn(bb){if(!bb.runtime.an.nb(w.a.uL)||!bb.runtime.Hq.nb(w.a.uL))return!0;const Gb=new A.a,Sa=bb.runtime.an.J(w.a.uL);var Pa=Gb.getPropertyString(Sa.vm,m.a.bUa);if(y.a.If(Pa).equals(y.a.nil))return!0;Pa=Gb.getPropertyObjectIds(Sa.vm,m.a.p1);const Ab=Gb.getPropertyObjectIds(bb.runtime.Hq.J(w.a.uL),m.a.p1);let nb;({SMf:nb}=kb.q3h(bb,Gb));for(let Rb=0;Rb<Ab.length;Rb++)Pa.contains(Ab.J(Rb),(Mb,oc)=>Mb.equals(oc))||nb.contains(Ab.J(Rb),(Mb,oc)=>Mb.equals(oc))||(Pa.add(Ab.J(Rb)),bb.runtime.an.Z(Ab.J(Rb),
new gc.a(bb.runtime.Hq.J(Ab.J(Rb)).AK())));Gb.setPropertyObjectIds(Sa.vm,m.a.p1,Pa);return!0}}Object(E.a)(kb,"ParagraphMergeUsingHints",null,[1771])},1633:function(E,M,c){E=c(0);class m{constructor(n){this.OPi=n;this.succeeded=!1;this.Glc=n?n.Glc:0;this.LRm=!1;this.length=this.dFo=0}}Object(E.a)(m,"TrieResult",null,[]);class e{constructor(n,v,A){this.Ykb=new m(null);this.n7m=n;this.eYc=v;this.GKi=v+A-1}get result(){return this.Ykb}mbi(){let n;return this.eYc<=this.GKi?(n=this.n7m.charAt(this.eYc),
++this.eYc,{returnValue:!0,ch:n}):{returnValue:!1,ch:"\x00"}}t4f(n,v,A){n&&(this.Ykb.LRm=!0,this.Ykb.dFo=v);this.Ykb.length=this.eYc;this.Ykb.succeeded=!0;this.Ykb.Glc=A;this.eYc!==this.GKi+1&&(this.Ykb=new m(this.Ykb))}}Object(E.a)(e,"LookUpStringVisitor",null,[1281]);var a=c(1718);class l{constructor(){this.tBh=this.Syh=this.Uyh=this.Ryh=this.Tyh=this.O4e=this.M4e=this.Q4e=this.L4e=0}}Object(E.a)(l,"TRIESTATS",null,[]);class y{constructor(){this.symbol=this.JZc=0}}Object(E.a)(y,"TrieSymbol",null,
[]);c.d(M,"a",function(){return z});class z{constructor(n,v){this.r4=null;this.b3d=this.VKi=this.TKi=this.XKi=this.PKi=this.WKi=this.UKi=this.YKi=this.QKi=0;this.vJ=n;if(n.By(v,4)!==z.Qzb)throw Error.argument("Input does not represent a trie");v+=4;this.IKi=1===n.By(v,4);v+=4;this.k7m=1===n.By(v,4);v+=4;this.g7m=n.By(v,4);v+=4;if(n.By(v,4)){n=v+4;this.r4=this.QNn(n);this.QKi=v=n+z.COk;this.YKi=v+=z.eCd*(this.r4.L4e+(this.r4.L4e%2?1:0));this.UKi=v+=z.eCd*(this.r4.Q4e+(this.r4.Q4e%2?1:0));this.WKi=
v+=z.eCd*(this.r4.M4e+(this.r4.M4e%2?1:0));this.PKi=v+=z.eCd*(this.r4.O4e+(this.r4.O4e%2?1:0));this.XKi=v+=z.S4e*this.r4.Ryh;this.TKi=v+=z.T4e*this.r4.Uyh;this.VKi=v+=z.T4e*this.r4.Syh;v+=z.T4e*this.r4.Tyh;if(v!==n+this.r4.tBh)throw Error.argument("Corrupted trie binary");this.b3d=v}else this.r4=null}gKi(n,v,A,w){n=new e(n,v,A);this.cJj(n,w);return n.result}rgi(n){if(this.IKi)if(n)--n;else return"";if(!this.r4)throw Error.argument("Invalid trieID");const v=new a.a;v.GF=0;this.dQb(v);const A=[];for(;;){if(v.GF&
z.B8a)if(n)--n;else return Array.add(A,v.dRb),String.fromCharCode.apply(null,A);const w=!!(v.GF&z.Eqe),G=this.f7b(v,!0);if(w||n<G){if(Array.add(A,v.dRb),!this.dQb(v))throw Error.argument("Invalid trieID");}else if(n-=G,!this.O$c(v))throw Error.argument("Invalid trieID");}}cJj(n,v){let A=0;this.IKi&&(n.t4f(this.k7m,this.g7m,0),++A);if(this.r4){var w=new a.a;w.GF=0;if(this.dQb(w))for(;;){var G=void 0;if(!({ch:G}=n.mbi()).returnValue)break;v&&(G=v(G));G=G.toString().charCodeAt(0);let F=!1;for(;!F;){const I=
!!(w.GF&z.B8a);if(w.dRb===G){if(F=!0,I&&n.t4f(!!(w.GF&z.sug),w.Jke,A),!this.dQb(w))return}else if(A+=this.f7b(w,!0),!this.O$c(w))return;I&&++A}}}}dQb(n){if(!n.GF)return this.kkg(n),!0;if(!(n.GF&z.Dqe))return!1;n.BPa=0;n.Fx=n.Aib;this.kkg(n);return!0}O$c(n){if(n.GF&z.Eqe)return!1;this.kkg(n);return!0}f7b(n,v){return n.GF&z.rug?n.dCd:n.GF&z.Dqe?!v&&n.GF&z.Eqe?this.MQl(n):1:0}MQl(n){n=z.z7e(n);if(!this.dQb(n))return 0;let v=0;do n.GF&z.B8a&&++v,v+=this.f7b(n,!1);while(this.O$c(n));return v}kkg(n){n.GF||
(n.BPa=0,n.Fx=this.b3d);var v=this.HHd(this.QKi,n.Fx),A=v.symbol;n.Fx+=v.JZc;v=this.vJ.By(this.PKi+z.S4e*A,z.S4e);n.dRb=v&65535;n.GF=v>>16;n.GF&z.rug&&(n.dCd=this.Vfl(n));n.GF&z.sug&&(v=this.HHd(this.YKi,n.Fx),A=v.symbol,n.Fx+=v.JZc,n.Jke=this.vJ.By(this.XKi+4*A,4));n.GF&z.wRj?(n.Aib=this.b3d+((this.vJ.J(n.Fx)<<8|this.vJ.J(n.Fx+1))<<8|this.vJ.J(n.Fx+2)),n.Fx+=3):n.GF&z.xRj?(n.Aib=n.Fx,n.BPa=n.Aib):n.GF&z.yRj?(v=this.HHd(this.UKi,n.Fx),A=v.symbol,n.Fx+=v.JZc,n.Aib=this.b3d+this.vJ.By(this.TKi+4*A,
4)):n.GF&z.Dqe&&(v=this.HHd(this.WKi,n.Fx),A=v.symbol,n.Fx+=v.JZc,n.BPa||(n.BPa=n.Fx),n.BPa+=this.vJ.By(this.VKi+4*A,4),n.Aib=n.BPa)}HHd(n,v){const A=new y;let w=0;for(;;){w+=this.vJ.J(v);++v;++A.JZc;const G=this.vJ.By(n,2);if(w<G)break;A.symbol+=G;w-=G;n+=2;w<<=8}A.symbol+=w;return A}Vfl(n){let v=this.vJ.J(n.Fx);192<=v?(v=(v&63)<<15|(this.vJ.J(n.Fx+1)&127)<<8,v|=this.vJ.J(n.Fx+2),n.Fx+=3):128<=v?(v=(v&127)<<8|this.vJ.J(n.Fx+1),n.Fx+=2):n.Fx+=1;return v}QNn(n){const v=new l;v.L4e=this.vJ.By(n+12,
2);v.Q4e=this.vJ.By(n+14,2);v.M4e=this.vJ.By(n+16,2);v.O4e=this.vJ.By(n+18,2);v.Tyh=this.vJ.By(n+24,4);v.Ryh=this.vJ.By(n+28,4);v.Uyh=this.vJ.By(n+32,4);v.Syh=this.vJ.By(n+36,4);v.tBh=this.vJ.By(n+40,4);return v}static z7e(n){const v=new a.a;v.dRb=n.dRb;v.GF=n.GF;v.dCd=n.dCd;v.Fx=n.Fx;v.Aib=n.Aib;v.BPa=n.BPa;v.Jke=n.Jke;return v}}z.Qzb=1654263084;z.COk=48;z.eCd=2;z.T4e=4;z.S4e=4;z.B8a=1;z.Eqe=2;z.rug=4;z.sug=8;z.Dqe=16;z.xRj=64;z.yRj=128;z.wRj=256;Object(E.a)(z,"Trie",null,[1278])},1635:function(E,
M,c){c.r(M);E=c(0);c(1483);var m=c(1501);class e{}e.marketPlace=0;e.catalog=1;e.privateCatalog=10;Object(E.a)(e,"AppsForOfficeStoreType",null,[]);var a=c(1481),l=c(2),y=c(92),z=c(13);class n{constructor(){this.QSe=0}r1f(J,N){this.QSe=window.performance.now();this.sUa(()=>{const R=window.performance.now(),O={},L=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",!0);N.Ayk&&(O.callback=U=>{J(U,e.marketPlace,R)},L&&(O.storeType=e.marketPlace),
l.AFrameworkApplication.va.Qb(z.a.RLb,2,O));N.Byk&&(O.callback=U=>{J(U,e.privateCatalog,R)},L?O.storeType=e.privateCatalog:l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?O.storeType=10:O.storeType=e.privateCatalog,l.AFrameworkApplication.va.Qb(z.a.RLb,2,O))},0,()=>{if(a.TellMeActor.instance.Oe)a.TellMeActor.instance.Oe.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.QSe)+
" ms")})}sUa(J,N=0,R=null){2!==l.AFrameworkApplication.va.processAction(z.a.RLb,1)?(a.TellMeActor.instance.Oe&&a.TellMeActor.instance.Oe.DA(m.a.zyk,window.performance.now()-this.QSe),J()):N<n.w$m?l.AFrameworkApplication.nc.Vb(new y.a(2,1,n.K0o,()=>{this.sUa(J,N+1,R)})):R&&R()}static get instance(){n._instance||(n._instance=new n);return n._instance}}n._instance=null;n.w$m=20;n.K0o=500;Object(E.a)(n,"AddinEntitlementsQuery",null,[]);class v{constructor(){this.description=this.id=this.displayName=null;
this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.JHf=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(E.a)(v,"AddinInfo",null,[]);var A=c(1484),w=c(1488),G=c(1487),F=c(1480),I=c(127);c.d(M,"AddinResultsProvider",function(){return K});class K{constructor(J){this.WOe=[];this.fc=J;this.Gmn=(N,R,O)=>{if(N){const L=N.errorCode;if(a.TellMeActor.instance.Oe){const U={};U.StoreType=R;U.ErrorCode=L;U.AddinCount=N.value?N.value.length:
0;a.TellMeActor.instance.Oe.DA(m.a.NJl,window.performance.now()-O,U)}if(0===L&&N.value){K.gzb=K.gzb||{};N=N.value;for(const U of N)N=new v,N.displayName=U[0],N.id=U[1],N.description=U[2],N.targetType=U[3],N.appVersion=4<U.length?U[4]:"",N.assetId=5<U.length?U[5]:"",N.assetStoreId=6<U.length?U[6]:"",N.width=7<U.length?U[7]:0,N.height=8<U.length?U[8]:0,N.iconUrl=9<U.length?U[9]:"",N.providerName=10<U.length?U[10]:"",N.storeId=11<U.length?U[11]:"",N.storeType=12<U.length?U[12]:"",N.JHf=this.OZl(N),K.gzb[N.id]=
N,0<N.iconUrl.length&&(R="AddinIcon_"+N.id,l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.h8i(R,N.iconUrl):appChrome.addInApi.registerAddinIcon(R,N.iconUrl))}}};n.instance.r1f(this.Gmn,this.fc)}XK(){return"Add-ins"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:2}MH(J,N,R,O,L=null){R=new G.a(J);L&&!Array.contains(L,27)||F.a.YQ(J)||(L=new w.a(27),L.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.oZl(J.Dg,L),R.Tu(L));
N.resultsUpdated(R)}oZl(J,N){if((J=this.t$n(J))&&0<J.length){let R=0;J.forEach(O=>{if(!(3<++R)){var L="AddinSuggestion"+R,U={};if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var W="AddinIcon_"+O.id;0>Array.indexOf(this.WOe,W)&&0<O.iconUrl.length&&this.h8i(W,O.iconUrl);U["default"]=0<=Array.indexOf(this.WOe,W)?W:"AppForOfficeLogo_20"}else U["default"]=0<O.iconUrl.length?"AddinIcon_"+O.id:"AppForOfficeLogo_20";W=[];W.push(appChrome.actions.setControlLabel(L,
O.displayName));W.push(appChrome.actions.setControlIconSet(L,U));W.push(appChrome.actions.setCompoundButtonCommandValueId(L,O.id));W.push(appChrome.actions.updateCompoundButtonDescription(L,O.description));l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(U=window.performance.now(),W.push(appChrome.actions.updateControlEnabledDisabledState(L,!1)),a.TellMeActor.instance.Oe&&a.TellMeActor.instance.Oe.DA(m.a.osl,window.performance.now()-
U));appChrome.api.dispatch(W);L=new A.a(L,27,void 0,void 0,1);L.GI=Telemetry.PrivacyRules.GetPrivacyCompliantId(O.id,O.storeType,O.assetId,null,null,O.storeId);N.Jw(L)}})}}h8i(J,N){I.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(J,N),Array.add(this.WOe,J))}t$n(J){if(!K.gzb)return null;const N=[],R=K.gzb;for(let L in R){var O=R[L];O&&K.x9m(J,O)&&Array.add(N,O)}return N}OZl(J){return K.dzo(J.displayName)}static x9m(J,N){if(!N.JHf)return!1;for(const R of J.split(" ")){J=
!1;for(const O of N.JHf)if(O.toLowerCase().startsWith(R.toLowerCase())){J=!0;break}if(!J)return!1}return!0}static dzo(J){const N=[];for(const R of J.split(" ")){J=0;for(let O=0;O<R.length;O++){const L=R.charAt(O);L.toString().toUpperCase()===L.toString()&&O>J&&(Array.add(N,R.substring(J,O)),J=O)}Array.add(N,R.substring(J,R.length));J&&Array.add(N,R.substring(0,R.length))}return N}}K.gzb=null;Object(E.a)(K,"AddinResultsProvider",null,[1121])},1700:function(E,M,c){c.d(M,"a",function(){return e});E=
c(0);var m=c(223);class e{constructor(){this.Xmb=this.Ymb=this.E_a=this.$ib=this.Wmb=this.xfb=this.Yib=this.a5a=this.yfb=this.Zib=null;this.reset()}reset(){this.Zib=new m.a;this.yfb=new m.a;this.a5a=new m.a;this.Yib=new m.a;this.xfb=new m.a;this.Wmb=new m.a;this.$ib=new m.a;this.E_a=new m.a;this.E_a=new m.a;this.Ymb=new m.a;this.Xmb=new m.a}o_o(a){return this.qPa(this.Zib,a)&&this.qPa(this.yfb,a)&&this.qPa(this.a5a,a)&&this.qPa(this.Yib,a)&&this.qPa(this.xfb,a)&&this.qPa(this.Wmb,a)&&this.qPa(this.$ib,
a)&&this.qPa(this.E_a,a)&&this.qPa(this.Ymb,a)&&this.qPa(this.Xmb,a)}qPa(a,l){return!a||!a.length||a.length===l}}Object(E.a)(e,"MergeableTrackedChangesProperties",null,[])},1701:function(E,M,c){c.d(M,"a",function(){return a});E=c(0);var m=c(223),e=c(602);class a{constructor(){this.iJa=new m.a;this.iKa=new m.a;this.BMa=new m.a}get vzb(){return this.iJa}get gjf(){return this.iKa}get Zpb(){return this.BMa}get isEmpty(){return!this.iJa.length&&!this.iKa.length&&!this.BMa.length}get clb(){return Math.max(Math.max(this.iJa.length,
this.iKa.length),this.BMa.length)}get Vbn(){return Math.min(Math.min(this.iJa.length,this.iKa.length),this.BMa.length)}qAd(l){this.iJa.add(l)}sAd(l){this.iKa.add(l)}wAd(l){this.BMa.add(l)}rCl(){const l=new e.a,y=new m.a;let z=0;for(;z<this.iJa.length||z<this.iKa.length||z<this.BMa.length;)z<this.iJa.length&&!l.contains(this.iJa.J(z))&&(y.add(this.iJa.J(z)),l.add(this.iJa.J(z))),z<this.iKa.length&&!l.contains(this.iKa.J(z))&&(y.add(this.iKa.J(z)),l.add(this.iKa.J(z))),z<this.BMa.length&&!l.contains(this.BMa.J(z))&&
(y.add(this.BMa.J(z)),l.add(this.BMa.J(z))),z++;return y}}Object(E.a)(a,"ObjectCollection",null,[])},1702:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a){this.GIa=a;this.updateHints=e}}Object(E.a)(m,"UpdateHintCollection",null,[])},1703:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(1546);class m extends c.a{constructor(e,a){super();this.zg=e;this.Lc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,
this.type,this.zg,this.Lc)}}Object(E.a)(m,"LcsInsertParaUpdateHint",c.a,[])},1704:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);var m=c(223);c=c(1546);class e extends c.a{constructor(a){super();this.K_=new m.a;this.cp=a}get type(){return 11}toString(){let a="";for(let l=0;l<this.K_.length;l++)a+=String.format("({0}), ",this.K_.J(l).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(E.a)(e,"LcsInsertUpdateHint",c.a,[])},1705:function(E,M,c){c.d(M,"a",function(){return m});
E=c(0);c=c(1546);class m extends c.a{constructor(e,a){super();this.text=a;this.zg=e}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",this.cp,this.type,this.zg,this.text)}}Object(E.a)(m,"LcsInsertTextUpdateHint",c.a,[])},1706:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(1546);class m extends c.a{constructor(e,a,l){super();this.cp=e;this.zg=a;this.Lc=l}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",
this.cp,this.type,this.zg,this.Lc)}}Object(E.a)(m,"LcsDeleteParaUpdateHint",c.a,[])},1707:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(1546);class m extends c.a{constructor(e,a){super();this.cp=e;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(E.a)(m,"LcsDeleteTextUpdateHint",c.a,[])},1708:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(1518);class m extends c.a{constructor(){super()}get gga(){return"Conflict"}}
Object(E.a)(m,"ConflictMergeFailureDetail",c.a,[])},1709:function(E,M,c){c.r(M);c.d(M,"InsightsMenuItemFactory",function(){return l});E=c(0);var m=c(1480),e=c(160),a=c(19);class l{constructor(y=null){this.g6j=y||CommonUIStrings.l_InsightsButtonText}get ZMb(){return 10}Ifa(y){var z=y.$C;y=m.a.nha()?m.a.LNa(z,1):m.a.kBb(z);z=String.format(this.g6j,z);return this.cIl(y,z)}cIl(y,z){return e.a(l.Nri,m.a.nha()?"1914896509":"3317204163",a.a.Af(z),m.a.GAf,null,a.a.Af(y),a.a.Af(z),null,null)}}l.Nri="bInsights";
Object(E.a)(l,"InsightsMenuItemFactory",null,[1120])},1710:function(E,M,c){c.d(M,"a",function(){return a});E=c(0);var m=c(160),e=c(19);class a{constructor(l,y,z,n,v){this.HQe=l;this.GQe=y;this.alk=z;this.H4j=n;this.OYg=v}get ZMb(){return 4}Ifa(l,y=null){y=y.sessionId+"|"+y.eoa+"|"+l.$C;if(this.OYg||this.H4j){let z=this.OYg||e.a.QA(CommonUIStrings.l_HelpTooltip)===e.a.QA(l.$C.trim());if(this.alk&&2<l.$C.length){const n=l.$C;";"===n.charAt(0)&&";"===n.charAt(n.length-1)&&n.substring(1,n.length-1)===
a.xxf&&(z=!0)}l=z?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,l.$C);return this.D2h(y,e.a.Af(l),z)}return this.D2h(y,e.a.Af(String.format(CommonUIStrings.l_TextWithQuotation,l.$C)),!1)}D2h(l,y,z){return m.a(a.xxf,z?this.GQe:this.HQe,y,"OfficeAssistant_16x16x32","A0",e.a.Af(l),y,null,null)}}a.xxf="bSearchHelp";Object(E.a)(a,"AssistanceMenuItemFactory",null,[1120])},1711:function(E,M,c){c.d(M,"a",function(){return y});E=c(0);var m=c(2),e=c(160),a=
c(89),l=c(19);class y{get ZMb(){return 13}Ifa(){return y.$Lk()}static $Lk(){return e.b(y.w_h,"798637440",l.a.Af(CommonUIStrings.l_LookupFirstRunExperienceTitle),m.AFrameworkApplication.Rs,a.getImageClass("Info_32x32x32"),null,null,l.a.Af(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,l.a.Af(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}y.w_h="bTellMeFirstRun";Object(E.a)(y,"FirstRunMenuItemFactory",null,[1120])},1712:function(E,M,c){c.d(M,"a",function(){return l});
E=c(0);var m=c(2),e=c(160),a=c(19);class l{constructor(y=null,z=null){this.w7g=y;this.Oak=z||CommonUIStrings.l_LookupNoResultsDescription}get ZMb(){return 14}Ifa(y){y=String.format(this.Oak,y.$C);return this.OMk(y)}OMk(y){return e.b(l.bQi,"798637440",a.a.Af(CommonUIStrings.l_LookupNoResultsTitle),this.w7g?m.AFrameworkApplication.Rs:null,this.w7g,null,null,a.a.Af(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.Af(y),null,null)}}l.bQi="lookupNoResults";Object(E.a)(l,"NoCommandsFoundMenuItemFactory",
null,[1120])},1713:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=a}}Object(E.a)(m,"LabelFormatted",null,[])},1714:function(E,M,c){c.d(M,"a",function(){return z});E=c(0);c(1483);var m=c(1484),e=c(1488),a=c(1487),l=c(1480),y=c(19);class z{constructor(n){this.fc=n}XK(){return"Assistance"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:this.fc.V_c?3:2}MH(n,v,A=!1,w,G=null){w=new a.a(n);if((!G||Array.contains(G,
8))&&!l.a.YQ(n)){G=new e.a(8);if(A){A=y.a.QA(CommonUIStrings.l_HelpTooltip)===y.a.QA(n.Dg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,n.Dg);const F=[];this.fc.m3a&&(this.fc.Vhe||F.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),A=this.Fbi(n.Dg));const I="||"+n.Dg;F.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",A));F.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",I));
appChrome.api.dispatch(F);n=new m.a("GetHelpFromTellMe",4,n.Dg,null,1)}else n=new m.a("bSearchHelp",4,n.Dg,null,1);G.Jw(n);G.displayName=CommonUIStrings.l_HelpButtonTitle;w.Tu(G)}v.resultsUpdated(w)}fib(n,v=null){const A=new e.a(8),w=y.a.QA(CommonUIStrings.l_HelpTooltip)===y.a.QA(n.Dg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,n.Dg);for(let F=0;F<v.length&&2>F;F++){var G=void 0;G=[];let I="GetHelpWithDescriptionFromTellMe"+(F+1).toString(),
K=4;if(this.fc.J7c)G.push(appChrome.actions.setControlLabel(I,w)),G.push(appChrome.actions.setCompoundButtonCommandValueId(I,n.Dg)),G.push(appChrome.actions.updateCompoundButtonDescription(I,this.Wuf(v.length)));else if(this.fc.K7c){let J=this.$hi(v[F]);I="GetHelpFromTellMe"+(F+1).toString();this.fc.m3a&&(J=this.Fbi(J));K=9;G.push(appChrome.actions.setControlLabel(I,J));G.push(appChrome.actions.setButtonCommandValueId(I,this.Sem(v[F])))}appChrome.api.dispatch(G);G=new m.a(I,K,null,null,0);G.label=
this.$hi(v[F]);G.description=this.Rem(v[F]);A.Jw(G);if(this.fc.K7c)break}A.displayName=CommonUIStrings.l_HelpButtonTitle;return A}Wuf(n){return 1===n?String.format(CommonUIStrings.l_SearchResultText,n):String.format(CommonUIStrings.l_SearchResultsText,n)}Fbi(n){return this.fc.iGf?l.a.bqf(n,CommonUIStrings.l_HelpScopedButtonText):n+CommonUIStrings.l_HelpScopedButtonText}$hi(n){return n.name?n.name:""}Rem(n){return n.description?n.description:""}Sem(n){return n.id?"AssetID="+n.id:""}}Object(E.a)(z,
"AssistanceResultsProvider",null,[1121])},1715:function(E,M,c){c.d(M,"a",function(){return n});E=c(0);c(1483);var m=c(1484),e=c(1488),a=c(1487),l=c(1481),y=c(1480),z=c(1517);class n{constructor(v){this.fc=v}XK(){return"Image"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:3===this.fc.$u?3:2}MH(v,A,w,G,F=null){w=new a.a(v);(!F||Array.contains(F,19))&&y.a.YQ(v)&&this.fc.pP&&this.fib(v,w,1);A.resultsUpdated(w)}fib(v,A,w,G=null){var F=[];let I;l.TellMeActor.instance.yO()&&l.TellMeActor.instance.yO().m3a?
(I=this.fc.iGf?y.a.bqf(v.Dg,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):v.Dg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.fc.Vhe||F.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):I=this.fc.pP?y.a.YQ(v)?this.fc.Fdb?y.a.bhb(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.fc.Fdb?y.a.bhb(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
v.Dg)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,v.Dg):this.fc.ljc?CommonUIStrings.l_TellMeImageSuggestionButtonText:v.Dg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.fc.Vva?(l.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",I)),F=y.a.LNa(v.Dg,9,Object.assign(new z.a,{landingTab:"Image"})),l.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",F))):(F.push(appChrome.actions.setControlLabel("ImageForSearch",
I)),v=y.a.LNa(v.Dg,9,Object.assign(new z.a,{landingTab:"Image"})),F.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",v)),appChrome.api.dispatch(F));w=new m.a("ImageForSearch",12,null,null,w);G&&(w.score=G.ConfidenceScore);G=new e.a(19,this.fc.ljc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);G.Jw(w);A.Tu(G)}}Object(E.a)(n,"ImageResultsProvider",null,[1121])},1716:function(E,M,c){c.d(M,"a",function(){return z});E=c(0);c(1483);var m=c(1484),e=c(1488),a=c(1487),
l=c(1480),y=c(2);class z{constructor(n){this.fc=n}XK(){return"Template"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:3}MH(n,v){n=new a.a(n);v.resultsUpdated(n)}fib(n,v,A){var w=[];let G;G=this.fc.pP?this.fc.Fdb?l.a.bhb(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,n.Dg)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,n.Dg):String.format(CommonUIStrings.l_TellMeTemplateButtonText,n.Dg);w.push(appChrome.actions.setControlLabel("TemplateForSearch",G));w.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(y.AFrameworkApplication.K.jb("TellMeTemplateProviderURL"),y.AFrameworkApplication.uiCulture,n.Dg)));appChrome.api.dispatch(w);n=new e.a(23);n.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;w=new m.a("TemplateForSearch",24,null,null,0);w.label=A[0].Title?A[0].Title:"";w.description=A[0].Description?A[0].Description:"";n.Jw(w);v.Tu(n)}}Object(E.a)(z,"TemplateResultsProvider",null,[1121])},1717:function(E,M,c){c.d(M,"a",function(){return A});E=c(0);c(1483);var m=c(1520),e=c(1484),
a=c(1488),l=c(1487),y=c(1619),z=c(1481),n=c(1480),v=c(19);class A{constructor(w,G,F,I){this.A2=w;this.Rcb=G;this.fjh=I;this.f2j=F;this.fc=z.TellMeActor.instance.yO()}XK(){return"EmptyQuery"}cU(){return 1===this.fc.$u?1:0}MH(w,G,F=!1,I,K=null){I=new l.a(w);if((!K||Array.contains(K,5)||Array.contains(K,6)||Array.contains(K,4))&&n.a.YQ(w)){this.A2.xNc().length||!this.f2j||this.fjh||(w=new a.a(6),K=new e.a(null,13,void 0,void 0,1),w.Jw(K),I.Tu(w));w=new a.a(4);if(0<this.A2.xNc().length){w.displayName=
CommonUIStrings.l_TellMeRecentlyUsedTitle;K=this.A2.xNc();var J=[];for(var N of K)J.push(N.Id);m.CommandResultsUtility.xad(J,this.fc);for(var R of K)m.CommandResultsUtility.tTc(R.Id)&&w.Jw(new e.a(R.Id,5,null,null,2));I.Tu(w)}if(this.fjh&&0<this.Rcb.length&&this.A2.xNc().length<A.maxResults){N=new a.a(5);N.displayName=CommonUIStrings.l_TellMeTryQueryTitle;R=A.maxResults-w.results.length;w=[];for(K=0;K<this.Rcb.length&&K<R;++K){if(F){J=n.a.Pkg+(K+1);const O=this.Rcb[K].key,L=v.a.replaceAll(O,'"',"");
w.push(appChrome.actions.setControlLabel(J,O));w.push(appChrome.actions.setButtonCommandValueId(J,L));J=new y.a(O,7,0,L,J)}else J=new y.a(this.Rcb[K].key,7,0,this.Rcb[K].value);N.Jw(J)}0<w.length&&appChrome.api.dispatch(w);I.Tu(N)}}G.resultsUpdated(I)}}A.maxResults=5;Object(E.a)(A,"EmptyQueryResultsProvider",null,[1121])},1718:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.Jke=this.BPa=this.Aib=this.Fx=this.dCd=this.GF=this.dRb=0}}Object(E.a)(m,"TRIESCAN",null,[])},
1720:function(E,M,c){c.d(M,"a",function(){return F});E=c(0);var m=c(2),e=c(402),a=c(936),l=c(397),y=c(718);c.n(y);var z=c(735);c.n(z);var n=c(88),v=c(1083),A=c(369),w=c(368),G=c(7);c=c(255);class F extends c.a{constructor(I,K){super("SummaryGenerationCondition");this.hij=()=>{if(!F.Qgg&&this.Poe.iy>F.Ybn){const J=a.a.getAugLoopRuntimeManager(),N=this.pNd();J.submitOperation(Object.assign(new w.a,{operation:N}))}};this.iij=()=>{this.hij();this.Poe.hde(this.iij)};this.hmb=J=>{J=J.items[0];y.TextSummaryAnnotation.typeGuard(J.body)||
y.GptSummaryAnnotation.typeGuard(J.body)||z.TextAbstractiveSummaryAnnotation.typeGuard(J.body)?(F.Qgg=J.body,"Success"!==F.Qgg.status?this.Rg(!1):this.Rg(!0)):(G.ULS.sendTraceTag(508944770,3047,10,`unexpected annotation: ${n.a.getTypeNameFor(J.body)}`),this.Rg(!1))};this.Poe=K.getInstance(0);this.Hn=I.Hn}static get summary(){return F.Qgg}initialize(){super.initialize();l.a.kl().then(()=>{const I=a.a.getAugLoopRuntimeManager();let K;K=this.Hxi()?y.GptSummaryAnnotation.getTypeName():this.hTc()?z.TextAbstractiveSummaryAnnotation.getTypeName():
y.TextSummaryAnnotation.getTypeName();I.activateAnnotation(Object.assign(new e.a,{annotationType:K,handler:this.hmb}))});-1===this.Poe.iy?this.Poe.bzb(this.iij):this.hij()}Md(){super.Md()}hTc(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AzureTextSummarizationIsEnabled",!1)}Hxi(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.KeypointsSummaryEnabled",!1)}pNd(){return this.Hxi()?Object.assign(new v.l,{parentPath:["Signal",
y.GptSummarySignal.getTypeName()],items:[Object.assign(new A.a,{body:new y.GptSummarySignal})]}):this.hTc()?Object.assign(new v.l,{parentPath:["Signal",z.GenerateTextAbstractiveSummarySignal.getTypeName()],items:[Object.assign(new A.a,{body:new z.GenerateTextAbstractiveSummarySignal({clientApplication:"Editor"})})]}):Object.assign(new v.l,{parentPath:["Signal",y.GenerateTextSummarySignal.getTypeName()],items:[Object.assign(new A.a,{body:new y.GenerateTextSummarySignal})]})}Rg(I){super.Rg(I);G.ULS.sendTraceTag(508944769,
3028,50,this.tT(this.Hn,I))}}F.Ybn=300;Object(E.a)(F,"SummaryGenerationCondition",c.a,[])},1738:function(E,M,c){c.r(M);var m=c(0),e=c(1483),a=c(1531),l=c(1501),y=c(1484),z=c(1488),n=c(1487),v=c(1481),A=c(1480),w=c(1517);class G{constructor(Za){this.fc=Za}XK(){return"ActionAI"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:2}MH(Za,Hb,$b=!1,zc,Jc=null){zc=new n.a(Za);if(!Jc||Array.contains(Jc,24))if(this.nro()||!A.a.YQ(Za)){Jc=new z.a(24);var pd=A.a.YQ(Za);$b&&($b=null,A.a.nha()&&($b=A.a.LNa(pd?"":Za.Dg,
1,Object.assign(new w.a,{landingTab:"ActionAI"}))),this.fc.Vva?$b&&v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",$b)):(Za=[],$b&&Za.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",$b)),appChrome.api.dispatch(Za)));Jc.Jw(new y.a("ActionAIFromTellMe",25,null,null,1));zc.Tu(Jc)}Hb.resultsUpdated(zc)}nro(){return A.a.nha()&&this.fc.hXd}}Object(m.a)(G,"ActionAIResultsProvider",null,[1121]);var F=c(1635);class I{constructor(Za,Hb){this.Aza=
Za;this.Ok=Hb}resultsUpdated(Za){this.Aza.jko(this.Ok,Za)}}Object(m.a)(I,"AggregatorResultsProviderCallback",null,[1123]);class K{constructor(Za){this.ira=null;this.fc=Za;this.fc.nzb&&(this.ira=null)}XK(){return"AppsForOffice"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:2}MH(Za,Hb,$b,zc,Jc=null){$b=new n.a(Za);if(!Jc||Array.contains(Jc,1))Jc=new z.a(1),this.ira.dap(Jc,Za.Dg),$b.Tu(Jc);Hb.resultsUpdated($b)}}Object(m.a)(K,"AppsForOfficeRecommendationResultsProvider",null,[1121]);var J=c(1714),N=
c(1476),R=c(1496),O=c(110);class L{constructor(Za,Hb){this.Ab=Za;this.j7m=Hb}isMatch(Za,Hb){if(!Object(O.a)(1237,Za))throw Error.argument("objToTest","Expected feature bundle");let $b;return({value:$b}=Za.Gq(this.Ab.Nta)).returnValue?this.Ab.$ng.isMatch($b,Hb):this.j7m}}Object(m.a)(L,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1266]);class U{constructor(Za,Hb){this.Ab=Za;this.wLf=Hb}isMatch(Za){if(!Object(O.a)(1237,Za))throw Error.argument("objToTest","Expected feature bundle");return!!(this.wLf^
Za.Gq(this.Ab.Nta).returnValue)}}Object(m.a)(U,"AnnotatedWithAnnotationFilter",null,[1266]);class W{constructor(Za){this.Ab=Za}isMatch(Za,Hb){if(!Object(O.a)(1241,Za))throw Error.argument("objToTest","Expected struct value");return this.Ab.$ng.isMatch(Za.shb(this.Ab.sOa),Hb)}}Object(m.a)(W,"FieldValueMatchesStructFilter",null,[1266]);class X{constructor(Za,Hb){Za&&(this.sOa=Za.J(0),this.$ng=Hb.pna(Za.J(1)))}}Object(m.a)(X,"FieldValueMatchesStructFilterInit",null,[]);class V{constructor(Za){this.wLf=
Za}isMatch(Za){if(!Object(O.a)(1237,Za))throw Error.argument("objToTest","Expected feature bundle");return!!(this.wLf^Za.Kwf)}}Object(m.a)(V,"HasAnnotationsAnnotationFilter",null,[1266]);class Z{constructor(Za,Hb){this.Ab=Za;this.S8=Hb}isMatch(Za,Hb){if(!Object(O.a)(1240,Za))throw Error.argument("objToTest","Expected list value");switch(this.S8){case 0:for(const $b of Za.items)if(this.Ab.filter.isMatch($b,Hb))return!0;return!1;case 1:for(const $b of Za.items)if(!this.Ab.filter.isMatch($b,Hb))return!1;
return!0;default:throw Error.notImplemented();}}}Object(m.a)(Z,"ItemTestListFilter",null,[1266]);class da{constructor(Za){this.Ab=Za}isMatch(Za,Hb){if(!Object(O.a)(1240,Za))throw Error.argument("objToTest","Expected list value");return this.Ab.filter.isMatch(Za.items.length,Hb)}}Object(m.a)(da,"LengthMatchesListFilter",null,[1266]);class aa{constructor(Za,Hb){this.Ab=Za;this.S8=Hb}isMatch(Za,Hb,$b=null){let zc=0===this.S8;for(const Jc of this.Ab.$Ch)if((zc=Jc.isMatch(Za,Hb,$b))?1===this.S8:0===this.S8)return zc;
2===this.S8&&(zc=!zc);return zc}}Object(m.a)(aa,"NonterminalFilter",null,[1266]);class ea{constructor(Za,Hb){if(Za){var $b=Za.J(0);this.$Ch=Array($b);for(let zc=0;zc<$b;++zc)this.$Ch[zc]=Hb.pna(Za.J(1+zc))}}}Object(m.a)(ea,"NonterminalFilterInit",null,[]);class na{constructor(Za,Hb){this.Ab=Za;this.S8=Hb}isMatch(Za,Hb){if("number"!==typeof Za)throw Error.argument("objToTest","Expected number value");let $b=this.Ab.number;if(this.Ab.query){Hb=this.Ab.query.xt(null,Hb);if("number"!==typeof Hb)throw Error.invalidOperation("Query did not return number");
$b+=Hb}switch(this.S8){case 0:return Za===$b;case 1:return Za<$b;case 2:return Za<=$b;case 3:return Za>$b;case 4:return Za>=$b;default:throw Error.notImplemented();}}}Object(m.a)(na,"NumberFilter",null,[1266]);class pa{constructor(Za,Hb){Za&&(this.number=Za.J(0),this.query=Za.J(1)?Hb.PK(Za.J(1)):null)}}Object(m.a)(pa,"NumberFilterInit",null,[]);class ja{constructor(Za,Hb,$b){this.ZOd=this.BUl;this.p7m=Za;this.MKi=Hb;this.LKi=$b}g6e(Za){this.MKi=Za}BUl(Za){if(!Za)throw Error.argument("name","Invalid named feature bundle reference");
const Hb=Za.substr(1);return 1===Za.charCodeAt(0)&&Hb===this.p7m?this.MKi:this.LKi?this.LKi.ZOd(Za):null}}Object(m.a)(ja,"SimpleNamedFeatureBundleResolver",null,[1286]);class ma{constructor(Za){this.Ab=Za}isMatch(Za,Hb){if(!Object(O.a)(1237,Za))throw Error.argument("objToTest","Expected feature bundle");Za=this.Ab.query.xt(null,new ja(this.Ab.poe,Za,Hb));if("boolean"!==typeof Za)throw Error.invalidOperation("Query did not return bool");return Za}}Object(m.a)(ma,"PredicateAnnotationFilter",null,[1266]);
class Ia{constructor(Za,Hb){Za&&(this.poe=Hb.QD(Za.J(0)),this.query=Hb.PK(Za.J(1)))}}Object(m.a)(Ia,"PredicateAnnotationFilterInit",null,[]);class Ja{constructor(Za){this.Ab=Za}isMatch(Za,Hb){if("boolean"!==typeof Za)throw Error.argument("objToTest","Expected bool value");Hb=this.Ab.query.xt(null,Hb);if("boolean"!==typeof Hb)throw Error.invalidOperation("Query did not return bool");return Za===Hb}}Object(m.a)(Ja,"QueryBooleanFilter",null,[1266]);class Ka{constructor(Za,Hb){this.Ab=Za;this.S8=Hb}isMatch(Za,
Hb){if("number"!==typeof Za)throw Error.argument("objToTest","Expected integer");Hb=this.Ab.query.xt(null,Hb);if("number"!==typeof Hb)throw Error.invalidOperation("Query did not return an enum value");switch(this.S8){case 0:return Za===Hb;case 1:return 0!==(Za&Hb);case 2:return Za===(Za&Hb);case 3:return Hb===(Za&Hb);default:throw Error.notImplemented();}}}Object(m.a)(Ka,"QueryEnumFilter",null,[1266]);class Ma{constructor(Za,Hb){Za&&(this.pZd=1===Za.J(0),this.query=Hb.PK(Za.J(1)))}}Object(m.a)(Ma,
"QueryEnumFilterInit",null,[]);class sa{constructor(Za,Hb){this.Ab=Za;this.S8=Hb}isMatch(Za,Hb){if(!Object(O.a)(1240,Za))throw Error.argument("objToTest","Expected list value");Hb=this.Ab.query.xt(null,Hb);if(!Object(O.a)(1240,Hb))throw Error.invalidOperation("Query did not return list value");if(Za.t4!==Hb.t4)return!1;switch(this.S8){case 0:return N.Annotations.qqb(N.Annotations.w0l(Za.t4),Za,Hb);case 1:for(const $b of Za.items)for(const zc of Hb.items)if(N.Annotations.qqb(Za.t4,$b,zc))return!0;
return!1;case 2:for(const $b of Za.items)for(const zc of Hb.items)if(!N.Annotations.qqb(Za.t4,$b,zc))return!1;return!0;case 3:for(const $b of Hb.items)for(const zc of Za.items)if(!N.Annotations.qqb(Za.t4,$b,zc))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(sa,"QueryListFilter",null,[1266]);class xa{constructor(Za,Hb){this.Ab=Za;this.S8=Hb}isMatch(Za,Hb){if("string"!==typeof Za)throw Error.argument("objToTest","Expected string");Hb=this.Ab.query.xt(null,Hb);if("string"!==typeof Hb)throw Error.invalidOperation("Query did not return string");
this.Ab.IBf&&(Za=Za.toUpperCase(),Hb=Hb.toUpperCase());switch(this.S8){case 0:return Za===Hb;case 1:return 0<=Za.indexOf(Hb);case 2:return Za.startsWith(Hb);case 3:return Za.endsWith(Hb);case 4:return 0<=Hb.indexOf(Za);case 5:return Hb.startsWith(Za);case 6:return Hb.endsWith(Za);default:throw Error.notImplemented();}}}Object(m.a)(xa,"QueryStringFilter",null,[1266]);class ia{constructor(Za,Hb){Za&&(this.query=Hb.PK(Za.J(0)),this.IBf=1===Za.J(1))}}Object(m.a)(ia,"QueryStringFilterInit",null,[]);class ha{constructor(Za){this.Ab=
Za}isMatch(Za,Hb){if(!Object(O.a)(1241,Za))throw Error.argument("objToTest","Expected struct value");Hb=this.Ab.query.xt(null,Hb);if(!Object(O.a)(1241,Hb))throw Error.invalidOperation("Query did not return struct value");return Za.isEqual(Za)}}Object(m.a)(ha,"QueryStructFilter",null,[1266]);class ua{constructor(Za){this.Ab=Za}isMatch(Za,Hb){Za=this.Ab.query.xt(null,Hb);if("boolean"!==typeof Za)throw Error.invalidOperation("Query did not return bool");return Za}}Object(m.a)(ua,"QueryWhereConstraintFilter",
null,[1266]);class ya{constructor(Za){this.Ab=Za}isMatch(Za){if("string"!==typeof Za)throw Error.argument("objToTest","Expected string");return this.Ab.K3f.test(Za)}}Object(m.a)(ya,"RegexStringFilter",null,[1266]);class ra{constructor(Za,Hb){Za&&(this.K3f=Hb.LEb(Za.J(0)))}}Object(m.a)(ra,"RegexStringFilterInit",null,[]);class La{constructor(Za,Hb){Za&&(this.filter=Hb.pna(Za.J(0)))}}Object(m.a)(La,"SingleFilterFilterInit",null,[]);class oa{constructor(Za,Hb){Za&&(this.query=Hb.PK(Za.J(0)))}}Object(m.a)(oa,
"SingleQueryFilterInit",null,[]);class Ca{constructor(Za){this.Ab=Za}isMatch(Za){if("boolean"!==typeof Za)throw Error.argument("objToTest","Expected bool value");return Za===this.Ab.value}}Object(m.a)(Ca,"StoredValueBooleanFilter",null,[1266]);class Aa{constructor(Za){Za&&(this.value=1===Za.J(0))}}Object(m.a)(Aa,"StoredValueBooleanFilterInit",null,[]);class db{constructor(Za,Hb){this.Ab=Za;this.S8=Hb}isMatch(Za){if("number"!==typeof Za)throw Error.argument("objToTest","Expected integer");switch(this.S8){case 0:return this.Ab.pZd?
this.Ab.value?!!(Za&this.Ab.value):!Za:Za===this.Ab.value;case 1:return this.Ab.pZd?(Za&this.Ab.value)===this.Ab.value:32>Za&&(1<<Za&this.Ab.value)===this.Ab.value;case 2:return this.Ab.pZd?!!(Za&this.Ab.value):32>Za&&!!(1<<Za&this.Ab.value);default:throw Error.notImplemented();}}}Object(m.a)(db,"StoredValueEnumFilter",null,[1266]);class eb{constructor(Za){Za&&(this.pZd=1===Za.J(0),this.value=Za.J(1))}}Object(m.a)(eb,"StoredValueEnumFilterInit",null,[]);class ib{constructor(){this.kyn=null;this.R4e=
this.SFb=0}}Object(m.a)(ib,"WHEREConstraintData",null,[]);class lb{constructor(Za){this.Ab=Za}isMatch(Za,Hb){if(!Object(O.a)(ib,Za))throw Error.argument("objToTest","Expected WHERE constraint data");let $b=-1,zc=-1;const Jc=Za.kyn;switch(this.Ab.P5e){case 4:$b=Jc.YLc;zc=Jc.ffg;break;case 5:$b=Za.SFb;zc=Jc.YLc-Za.SFb;break;case 6:$b=Jc.YLc+Jc.ffg;zc=Za.SFb+Za.R4e-$b;break;case 1:case 2:case 3:let pd=!1;for(let Qd=Jc.Yap;Qd;Qd=Qd.next)if(this.Ab.WYo===Qd.name){pd=!0;1===this.Ab.P5e?($b=Qd.YLc,zc=Qd.ffg):
2===this.Ab.P5e?($b=Za.SFb,zc=Qd.YLc-Za.SFb):($b=Qd.YLc+Qd.ffg,zc=Za.SFb+Za.R4e-$b);break}if(!pd)return!1;break;case 7:$b=Za.SFb;zc=Za.R4e;break;default:throw Error.notImplemented();}return null!==this.Ab.fzo.nep(Jc.elp,$b,zc,$b,!0,2,Hb)}}Object(m.a)(lb,"SubSreWhereConstraintFilter",null,[1266]);class Ya{constructor(Za,Hb){if(Za){var $b=Hb.QD(Za.J(0));this.P5e=$b.charCodeAt(0);this.WYo=$b.substr(1);this.fzo=Hb.o$l(Za.J(1))}}}Object(m.a)(Ya,"SubSreWhereConstraintFilterInit",null,[]);class Fa{constructor(Za){this.Ab=
Za}isMatch(Za,Hb,$b=null){if(!Object(O.a)(1237,Za))throw Error.argument("objToTest","Expected feature bundle");if(null==$b)throw Error.argumentNull("parentTextForSpan");if(this.Ab.Lrh&&!this.Ab.Lrh.isMatch(Za,Hb))return!1;if(this.Ab.Fig){let zc;if(({value:zc}=Za.Gq(this.Ab.Yxo)).returnValue){if(!this.Ab.Fig.isMatch(zc,Hb))return!1}else{let Jc,pd;if(!({value:Jc}=Za.Gq(this.Ab.ctj)).returnValue||!({value:pd}=Za.Gq(this.Ab.btj)).returnValue||0>Jc||0>pd||Jc+pd>$b.length||!this.Ab.Fig.isMatch($b.substr(Jc,
pd),Hb))return!1}}if(this.Ab.Wtj){let zc;if(!({value:zc}=Za.Gq(this.Ab.ctj)).returnValue||!this.Ab.Wtj.isMatch(zc,Hb))return!1}if(this.Ab.WEi){let zc;if(!({value:zc}=Za.Gq(this.Ab.btj)).returnValue||!this.Ab.WEi.isMatch(zc,Hb))return!1}return!0}}Object(m.a)(Fa,"TextSpanFilter",null,[1266]);class $a{constructor(Za,Hb){Za&&(this.annotations=Hb.annotations,this.ctj=Za.J(0),this.btj=Za.J(1),this.Yxo=Za.J(2),this.Fig=Za.J(3)?Hb.pna(Za.J(3)):null,this.Lrh=Za.J(4)?Hb.pna(Za.J(4)):null,this.Wtj=Za.J(5)?Hb.pna(Za.J(5)):
null,this.WEi=Za.J(6)?Hb.pna(Za.J(6)):null)}}Object(m.a)($a,"TextSpanFilterInit",null,[]);class Db{constructor(Za,Hb){Za&&(this.annotations=Hb.annotations,this.Nta=Za.J(0),this.$ng=Za.J(1)?Hb.pna(Za.J(1)):null)}}Object(m.a)(Db,"ValueFilterAnnotationFilterInit",null,[]);var gc=c(1503);class Eb{pna(Za,Hb){const $b=Za.J(0),zc=new gc.a;zc.Qgb(Za,1,Za.count-1);switch($b){case 1:return new aa(new ea(zc,Hb),0);case 2:return new aa(new ea(zc,Hb),1);case 3:return new aa(new ea(zc,Hb),2);case 101:return new ya(new ra(zc,
Hb));case 103:return new xa(new ia(zc,Hb),0);case 104:return new xa(new ia(zc,Hb),1);case 105:return new xa(new ia(zc,Hb),2);case 106:return new xa(new ia(zc,Hb),3);case 107:return new xa(new ia(zc,Hb),4);case 108:return new xa(new ia(zc,Hb),5);case 109:return new xa(new ia(zc,Hb),6);case 201:return new Ca(new Aa(zc));case 202:return new Ja(new oa(zc,Hb));case 301:return new na(new pa(zc,Hb),0);case 302:return new na(new pa(zc,Hb),1);case 303:return new na(new pa(zc,Hb),2);case 304:return new na(new pa(zc,
Hb),3);case 305:return new na(new pa(zc,Hb),4);case 401:return new db(new eb(zc),0);case 402:return new db(new eb(zc),1);case 403:return new db(new eb(zc),2);case 404:return new Ka(new Ma(zc,Hb),0);case 405:return new Ka(new Ma(zc,Hb),1);case 406:return new Ka(new Ma(zc,Hb),2);case 407:return new Ka(new Ma(zc,Hb),3);case 501:return new W(new X(zc,Hb));case 502:return new ha(new oa(zc,Hb));case 601:return new Z(new La(zc,Hb),0);case 602:return new Z(new La(zc,Hb),1);case 603:return new da(new La(zc,
Hb));case 604:return new sa(new oa(zc,Hb),0);case 605:return new sa(new oa(zc,Hb),1);case 606:return new sa(new oa(zc,Hb),2);case 607:return new sa(new oa(zc,Hb),3);case 701:return new V(!1);case 702:return new V(!0);case 703:return new U(new Db(zc,Hb),!1);case 704:return new U(new Db(zc,Hb),!0);case 705:return new L(new Db(zc,Hb),!1);case 706:return new L(new Db(zc,Hb),!0);case 707:return new ma(new Ia(zc,Hb));case 901:return new Fa(new $a(zc,Hb));case 1002:return new ua(new oa(zc,Hb));case 1001:return new lb(new Ya(zc,
Hb));default:throw Error.argument("initData");}}}Object(m.a)(Eb,"FilterFactory",null,[1239]);var kb=c(1482);class bb{constructor(Za){this.Ab=Za}get VD(){return this.Ab.VD}get U4(){return this.Ab.U4}get hke(){return this.Ab.hke}get TXd(){return this.Ab.TXd}load(Za,Hb){return this.xt(Za,Za?new ja("root",Za,Hb):Hb)}store(Za,Hb,$b){this.gkc(Za,Hb,Za?new ja("root",Za,$b):$b,null)}xt(Za,Hb){if(!this.TXd&&!this.Ab.annotations.Fac(this.VD,Za))throw Error.argument("input","Input value not of expected type");
let $b=this.Ab.C_h;for(;$b;)Za=$b.load(Za,Hb),$b=$b.next;return Za}gkc(Za,Hb,$b,zc){if(!this.hke)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.TXd&&!this.Ab.annotations.Fac(this.VD,Za))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ab.annotations.Fac(this.U4,Hb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ab.C_h.store(Za,Hb,$b,zc)}static $Eh(Za,Hb,$b,zc){if($b===zc)return Hb;if(N.Annotations.cI($b)&&
N.Annotations.cI(zc)){$b=N.Annotations.e1a($b);zc=N.Annotations.e1a(zc);const Jc=new kb.a(Za,zc);for(const pd of Hb.items)Array.add(Jc.items,bb.$Eh(Za,pd,$b,zc));return Jc}if($b===N.Annotations.yIa){if(zc===N.Annotations.Mqa)return Hb;if(zc===N.Annotations.V9)return Hb.toString()}else if($b===N.Annotations.Mqa){if(zc===N.Annotations.yIa)return Math.floor(Hb);if(zc===N.Annotations.V9)return Hb.toString()}else if($b===N.Annotations.V9){if(zc===N.Annotations.yIa)return parseInt(Hb);if(zc===N.Annotations.Mqa)return parseFloat(Hb)}throw Error.invalidOperation("Type conversion failure in query step");
}}Object(m.a)(bb,"AnnotationQuery",null,[1271]);class Gb{constructor(){this.U4=this.VD=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}j1a(Za){if(this.next)return{returnValue:this.next,SHa:Za};if(Za){const Hb=Za.jIh;Za=Za.i2i;return{returnValue:Hb,SHa:Za}}return{returnValue:null,SHa:Za}}}Object(m.a)(Gb,"AnnotationQueryStep",null,[1291]);class Sa extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){Hb=this.Ab.query.xt(Za,Hb);if(N.Annotations.cI(this.VD)){var $b=N.Annotations.e1a(this.VD);
let Jc=new kb.a(this.Ab.annotations,$b);if(N.Annotations.cI(this.Ab.query.U4)){if(Za.items.length!==Hb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let pd=0,Qd=Za.items.length;pd<Qd;++pd)Array.add(Jc.items,this.kCd(Za.items[pd],Hb.items[pd],$b===N.Annotations.Mqa))}else for(var zc of Za.items)Array.add(Jc.items,this.kCd(zc,Hb,$b===N.Annotations.Mqa));return Jc}if(N.Annotations.cI(this.Ab.query.U4)){zc=new kb.a(this.Ab.annotations,this.VD);for($b of Hb.items)Array.add(zc.items,
this.kCd(Za,$b,this.VD===N.Annotations.Mqa));return zc}return this.kCd(Za,Hb,this.VD===N.Annotations.Mqa)}kCd(Za,Hb,$b){Za=this.P1b(Za,Hb);return $b?Za:Math.floor(Za)}}Object(m.a)(Sa,"NumericAnnotationQueryStep",Gb,[]);class Pa extends Sa{constructor(Za){super(Za)}P1b(Za,Hb){return Za+Hb}}Object(m.a)(Pa,"AddAnnotationQueryStep",Sa,[]);class Ab extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){if(this.VD===N.Annotations.Yya&&this.Ab.query.U4===N.Annotations.Yya){let Jc;if(({result:Jc}=this.BAh(Za)).returnValue)return Jc}if(N.Annotations.cI(this.VD)){var $b=
new kb.a(this.Ab.annotations,N.Annotations.Yya);Hb=this.Ab.query.xt(Za,Hb);if(N.Annotations.cI(this.Ab.query.U4)){if(Za.items.length!==Hb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Jc=0,pd=Za.items.length;Jc<pd;++Jc)Array.add($b.items,this.UGc(Hb.items[Jc],Za.items[Jc]))}else for(var zc of Za.items)Array.add($b.items,this.UGc(Hb,zc));return $b}zc=this.Ab.query.xt(Za,Hb);if(N.Annotations.cI(this.Ab.query.U4)){Hb=new kb.a(this.Ab.annotations,
N.Annotations.Yya);for($b of zc.items)Array.add(Hb.items,this.UGc($b,Za));return Hb}return this.UGc(zc,Za)}}Object(m.a)(Ab,"BinaryBooleanAnnotationQueryStep",Gb,[]);class nb extends Ab{constructor(Za){super(Za)}BAh(Za){return{returnValue:!Za,result:!1}}UGc(Za,Hb){return Za&&Hb}}Object(m.a)(nb,"AndAnnotationQueryStep",Ab,[]);class Rb{constructor(Za){Za&&(this.annotations=Za)}}Object(m.a)(Rb,"AnnotationsOnlyQueryStepInit",null,[]);class Mb extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){Hb=
this.Ab.query.xt(Za,Hb);Za=Za.clone();N.Annotations.cI(this.Ab.query.U4)?Array.addRange(Za.items,Hb.items):Array.add(Za.items,Hb);return Za}}Object(m.a)(Mb,"AppendAnnotationQueryStep",Gb,[]);class oc extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){if(this.VD===N.Annotations.iV)return this.aLc(Za,Hb);const $b=new kb.a(this.Ab.annotations,N.Annotations.iV);for(const zc of Za.items)Array.add($b.items,this.aLc(zc,Hb));return $b}aLc(Za,Hb){const $b=new R.a(this.Ab.annotations);$b.e_a(Za);Za=
new R.a(this.Ab.annotations);this.Ab.script.iOa(null,new ja("Input",$b,new ja("Output",Za,Hb)));return Za}}Object(m.a)(oc,"ApplyAnnotationQueryStep",Gb,[]);class xb extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){if(this.VD===N.Annotations.iV)return Hb=this.aLc(Za,Hb),Hb.Gq(this.Ab.Jrh).returnValue||new kb.a(this.Ab.annotations,N.Annotations.iV),Hb;const $b=new kb.a(this.Ab.annotations,N.Annotations.iV);for(const zc of Za.items)if(Za=this.aLc(zc,Hb),({value:Za}=Za.Gq(this.Ab.Jrh)).returnValue)for(const Jc of Za.items)Array.add($b.items,
Jc);return $b}aLc(Za,Hb){const $b=new R.a(this.Ab.annotations);$b.e_a(Za);Za=new R.a(this.Ab.annotations);this.Ab.script.iOa(null,new ja("Input",$b,new ja("Output",Za,Hb)));return Za}}Object(m.a)(xb,"ApplyExpandAnnotationQueryStep",Gb,[]);class cc{constructor(Za,Hb){Za&&(this.annotations=Hb.annotations,this.script=Hb.sDb(Za.J(0)),this.Jrh=Za.J(1))}}Object(m.a)(cc,"ApplyExpandQueryStepInit",null,[]);class Ob{constructor(Za,Hb){Za&&(this.annotations=Hb.annotations,this.script=Hb.sDb(Za.J(0)))}}Object(m.a)(Ob,
"ApplyQueryStepInit",null,[]);class Ub extends Gb{constructor(Za){super();this.Ab=Za}load(Za){if(this.VD===N.Annotations.iV)return this.$1d(Za);const Hb=new kb.a(this.Ab.annotations,this.Ab.annotations.getAttributeType(this.Ab.Nta));for(const $b of Za.items)Array.add(Hb.items,this.$1d($b));return Hb}store(Za,Hb,$b,zc){if(this.VD===N.Annotations.iV){var Jc=Hb,pd=({SHa:zc}=this.j1a(zc)).returnValue;pd&&(Jc=pd.store(N.Annotations.lT(this.$1d(Za)),Hb,$b,zc));Za.Dy(this.Ab.Nta,Jc)}else{var Qd=Hb;if(Jc=
({SHa:zc}=this.j1a(zc)).returnValue){Qd=new kb.a(this.Ab.annotations,this.Ab.annotations.getAttributeType(this.Ab.Nta));for(pd of Za.items)Array.add(Qd.items,this.$1d(pd));Qd=Jc.store(Qd,Hb,$b,zc)}Hb=Qd;if(Hb.items.length!==Za.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let ye=0,Le=Za.items.length;ye<Le;++ye)$b=Za.items[ye],$b.isReadOnly&&($b=$b.clone(),Za.items[ye]=$b),$b.Dy(this.Ab.Nta,Hb.items[ye])}return Za}$1d(Za){({value:Za}=Za.Gq(this.Ab.Nta)).returnValue||
(Za=this.Ab.annotations.DLl(this.Ab.Nta));return Za}}Object(m.a)(Ub,"AttrAnnotationQueryStep",Gb,[]);class pb{constructor(Za,Hb){Za&&(this.annotations=Hb,this.Nta=Za.J(0))}}Object(m.a)(pb,"AttrQueryStepInit",null,[]);class Zb extends Gb{constructor(Za){super();this.Ab=Za}load(Za){const Hb=new R.a(this.Ab.annotations);Hb.e_a(Za);return this.Ab.module.execute(Hb)}}Object(m.a)(Zb,"CallModuleAnnotationQueryStep",Gb,[]);class Wa{constructor(Za,Hb){Za&&(this.annotations=Hb.annotations,this.module=Hb.Jrf(Za.J(0)))}}
Object(m.a)(Wa,"CallModuleQueryStepInit",null,[]);class Lb extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){if(N.Annotations.cI(this.VD)){var $b=this.Ab.query.xt(Za,Hb);Hb=new kb.a(this.Ab.annotations,N.Annotations.V9);let pd="string"===typeof $b;for(var zc of Za.items)if(pd)Array.add(Hb.items,zc+$b);else for(var Jc of $b.items)Array.add(Hb.items,zc+Jc);return Hb}zc=this.Ab.query.xt(Za,Hb);if("string"===typeof zc)return Za+zc;Jc=new kb.a(this.Ab.annotations,N.Annotations.V9);for($b of zc.items)Array.add(Jc.items,
Za+$b);return Jc}}Object(m.a)(Lb,"ConcatAnnotationQueryStep",Gb,[]);class qc extends Gb{constructor(Za){super();this.Ab=Za}load(Za){return bb.$Eh(this.Ab.annotations,Za,this.VD,this.U4)}}Object(m.a)(qc,"ConvertAnnotationQueryStep",Gb,[]);class Ra extends Gb{constructor(){super()}load(Za){return Za.items.length}}Object(m.a)(Ra,"CountAnnotationQueryStep",Gb,[]);class yb extends Sa{constructor(Za){super(Za)}P1b(Za,Hb){return Za/Hb}}Object(m.a)(yb,"DivideAnnotationQueryStep",Sa,[]);class Bb extends Gb{constructor(Za){super();
this.Ab=Za}load(Za,Hb){Hb=new ja(this.Ab.poe,null,Hb);for(const $b of Za.items)if(Hb.g6e($b),this.Ab.query.xt($b,Hb))return!0;return!1}}Object(m.a)(Bb,"ExistsAnnotationQueryStep",Gb,[]);class cb extends Sa{constructor(Za){super(Za)}P1b(Za,Hb){return Math.pow(Za,Hb)}}Object(m.a)(cb,"ExpAnnotationQueryStep",Sa,[]);class Xa{constructor(Za,Hb){Za&&(this.qOa=Hb.QD(Za.J(0)))}}Object(m.a)(Xa,"FeatureBundleNameQueryStepInit",null,[]);class hb extends Gb{constructor(Za){super();this.Ab=Za}load(Za){if(N.Annotations.cI(this.VD)){const Hb=
new kb.a(this.Ab.annotations,this.Ab.annotations.VEb(N.Annotations.e1a(this.VD),this.Ab.sOa));for(const $b of Za.items)Array.add(Hb.items,$b.shb(this.Ab.sOa));return Hb}return Za.shb(this.Ab.sOa)}store(Za,Hb,$b,zc){if(N.Annotations.cI(this.VD)){var Jc=Hb,pd=({SHa:zc}=this.j1a(zc)).returnValue;if(pd){Jc=new kb.a(this.Ab.annotations,this.Ab.annotations.VEb(N.Annotations.e1a(this.VD),this.Ab.sOa));for(var Qd of Za.items)Array.add(Jc.items,Qd.shb(this.Ab.sOa));Jc=pd.store(Jc,Hb,$b,zc)}Hb=Jc;if(Hb.items.length!==
Za.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let ye=0,Le=Za.items.length;ye<Le;++ye)$b=Za.items[ye],$b.isReadOnly&&($b=$b.clone(),Za.items[ye]=$b),$b.mag(this.Ab.sOa,Hb.items[ye])}else pd=Hb,(Qd=({SHa:zc}=this.j1a(zc)).returnValue)&&(pd=Qd.store(N.Annotations.lT(Za.shb(this.Ab.sOa)),Hb,$b,zc)),Za.mag(this.Ab.sOa,pd);return Za}}Object(m.a)(hb,"FieldAnnotationQueryStep",Gb,[]);class Cb{constructor(Za,Hb){Za&&(this.annotations=Hb,this.sOa=
Za.J(0))}}Object(m.a)(Cb,"FieldQueryStepInit",null,[]);class ob extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){for(const $b of Za.items)if(this.Ab.filter.isMatch($b,Hb))return $b;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(Za,Hb,$b,zc){let Jc=Hb,pd=-1;for(let ye=0,Le=Za.items.length;ye<Le;ye++)if(this.Ab.filter.isMatch(Za.items[ye],$b)){pd=ye;break}if(0>pd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");
const Qd=({SHa:zc}=this.j1a(zc)).returnValue;Qd&&(Jc=Qd.store(N.Annotations.lT(Za.items[pd]),Hb,$b,zc));Za.items[pd]=Jc;return Za}}Object(m.a)(ob,"FirstItemMatchingAnnotationQueryStep",Gb,[]);class ab extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){Hb=new ja(this.Ab.poe,null,Hb);for(const $b of Za.items)if(Hb.g6e($b),!this.Ab.query.xt($b,Hb))return!1;return!0}}Object(m.a)(ab,"ForAllAnnotationQueryStep",Gb,[]);class Ib extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){Za=Hb?Hb.ZOd(this.Ab.qOa):
null;if(!Za)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ab.qOa+'"');return Za}store(Za,Hb,$b,zc){Za=$b?$b.ZOd(this.Ab.qOa):null;if(!Za)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ab.qOa+'"');let Jc=Hb;const pd=({SHa:zc}=this.j1a(zc)).returnValue;pd&&(Jc=pd.store(Za,Hb,$b,zc));Za!==Jc&&Za.e_a(Jc);return Za}}Object(m.a)(Ib,"GetAnnotationQueryStep",Gb,[]);class Yb{constructor(Za,Hb){this.EZj=Za;this.Bek=Hb}get jIh(){return this.EZj}get i2i(){return this.Bek}}
Object(m.a)(Yb,"AnnotationQueryStoreContinuation",null,[1295]);class ub extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){return this.Ab.ble.xt(Za,Hb)?this.Ab.SAj.xt(Za,Hb):this.Ab.pLd?this.Ab.pLd.xt(Za,Hb):Za}store(Za,Hb,$b,zc){var Jc=this.Ab.ble.xt(Za,$b);this.next&&(zc=new Yb(this.next,zc));if(Jc)return this.Ab.SAj.gkc(Za,Hb,$b,zc);if(this.Ab.pLd)return this.Ab.pLd.gkc(Za,Hb,$b,zc);Jc=Hb;let pd=null;zc&&(pd=zc.jIh,zc=zc.i2i);pd&&(Jc=pd.store(N.Annotations.lT(Za),Hb,$b,zc));return Jc}}Object(m.a)(ub,
"IfAnnotationQueryStep",Gb,[]);class Ac{constructor(Za,Hb){Za&&(this.ble=Hb.PK(Za.J(0)),this.SAj=Hb.PK(Za.J(1)),this.pLd=Za.J(2)?Hb.PK(Za.J(2)):null)}}Object(m.a)(Ac,"IfQueryStepInit",null,[]);class Pc{constructor(Za,Hb){Za&&(this.$um=Hb.PK(Za.J(0)),this.dDi=Hb.PK(Za.J(1)))}}Object(m.a)(Pc,"IndexAndItemQueryStepInit",null,[]);class Mc extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){const $b=this.Ab.$um.xt(Za,Hb);Hb=this.Ab.dDi.xt(Za,Hb);Za=Za.clone();if(0>$b||$b>Za.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");
if(N.Annotations.cI(this.Ab.dDi.U4))for(let zc=0;zc<Hb.items.length;++zc)Array.insert(Za.items,$b+zc,Hb.items[zc]);else Array.insert(Za.items,$b,Hb);return Za}}Object(m.a)(Mc,"InsertAtAnnotationQueryStep",Gb,[]);class Ed extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){return!(!Hb||!Hb.ZOd(this.Ab.qOa))}}Object(m.a)(Ed,"IsDefinedAnnotationQueryStep",Gb,[]);class ne extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){Hb=this.eJ(Za,Hb);return Za.items[Hb]}store(Za,Hb,$b,zc){const Jc=
this.eJ(Za,$b);let pd=Hb;const Qd=({SHa:zc}=this.j1a(zc)).returnValue;Qd&&(pd=Qd.store(N.Annotations.lT(Za.items[Jc]),Hb,$b,zc));Za.items[Jc]=pd;return Za}eJ(Za,Hb){Hb=this.Ab.query.xt(Za,Hb);if(0>Hb||Hb>=Za.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Hb}}Object(m.a)(ne,"ItemAnnotationQueryStep",Gb,[]);class Ie extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){const $b=new kb.a(this.Ab.annotations,N.Annotations.e1a(this.VD));for(const zc of Za.items)this.Ab.filter.isMatch(zc,
Hb)&&Array.add($b.items,zc);return $b}}Object(m.a)(Ie,"ItemsMatchingAnnotationQueryStep",Gb,[]);class cd extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){Hb=this.eJ(Za,Hb);return Za.items[Za.items.length-Hb-1]}store(Za,Hb,$b,zc){const Jc=this.eJ(Za,$b);let pd=Hb;const Qd=({SHa:zc}=this.j1a(zc)).returnValue;Qd&&(pd=Qd.store(N.Annotations.lT(Za.items[Za.items.length-Jc-1]),Hb,$b,zc));Za.items[Za.items.length-Jc-1]=pd;return Za}eJ(Za,Hb){Hb=this.Ab.query?this.Ab.query.xt(Za,Hb):0;if(0>Hb||Hb>=
Za.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return Hb}}Object(m.a)(cd,"LastItemAnnotationQueryStep",Gb,[]);class Ic extends Gb{constructor(Za){super();this.Ab=Za}load(Za){if(N.Annotations.cI(this.VD)){const Hb=new kb.a(this.Ab.annotations,N.Annotations.yIa);for(const $b of Za.items)Array.add(Hb.items,$b.length);return Hb}return Za.length}}Object(m.a)(Ic,"LengthAnnotationQueryStep",Gb,[]);class Rc extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){if(N.Annotations.cI(this.VD)){const $b=
new kb.a(this.Ab.annotations,N.Annotations.Yya);for(const zc of Za.items)Array.add($b.items,this.Ab.filter.isMatch(zc,Hb));return $b}return this.Ab.filter.isMatch(Za,Hb)}}Object(m.a)(Rc,"MatchesAnnotationQueryStep",Gb,[]);class xc extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){return this.Ab.filter.isMatch(Za,Hb)}}Object(m.a)(xc,"MatchesAsListAnnotationQueryStep",Gb,[]);class Ae extends Sa{constructor(Za){super(Za)}P1b(Za,Hb){return Za%Hb}}Object(m.a)(Ae,"ModuloAnnotationQueryStep",Sa,
[]);class Ue extends Sa{constructor(Za){super(Za)}P1b(Za,Hb){return Za*Hb}}Object(m.a)(Ue,"MultiplyAnnotationQueryStep",Sa,[]);class Xe extends Gb{constructor(Za){super();this.Ab=Za}load(Za){if(N.Annotations.cI(this.VD)){const Hb=new kb.a(this.Ab.annotations,N.Annotations.Yya);for(const $b of Za.items)Array.add(Hb.items,!$b);return Hb}return!Za}}Object(m.a)(Xe,"NotAnnotationQueryStep",Gb,[]);class ef extends Ab{constructor(Za){super(Za)}BAh(Za){return{returnValue:Za,result:!0}}UGc(Za,Hb){return Za||
Hb}}Object(m.a)(ef,"OrAnnotationQueryStep",Ab,[]);class Se extends Gb{constructor(Za){super();this.Ab=Za}load(Za,Hb){const $b=this.Ab.Xfg.xt(Za,Hb);Za=this.Ab.FHc.xt(Za,Hb);Hb=new kb.a(this.Ab.annotations,N.Annotations.yIa);for(let zc=0;zc<Za;++zc)Array.add(Hb.items,$b+zc);return Hb}}Object(m.a)(Se,"RangeAnnotationQueryStep",Gb,[]);class pc{constructor(Za,Hb){Za&&(this.annotations=Hb.annotations,this.filter=Hb.pna(Za.J(0)))}}Object(m.a)(pc,"SingleFilterQueryStepInit",null,[]);class id{constructor(Za,
Hb){Za&&(this.annotations=Hb.annotations,this.query=Za.J(0)?Hb.PK(Za.J(0)):null)}}Object(m.a)(id,"SingleOptionalQueryQueryStepInit",null,[]);class Xc{constructor(Za,Hb){Za&&(this.annotations=Hb.annotations,this.query=Hb.PK(Za.J(0)))}}Object(m.a)(Xc,"SingleQueryQueryStepInit",null,[]);class he{constructor(Za,Hb){Za&&(this.annotations=Hb.annotations,this.Xfg=Hb.PK(Za.J(0)),this.FHc=Za.J(1)?Hb.PK(Za.J(1)):null)}}Object(m.a)(he,"StartAndCountOrLengthQueryStepInit",null,[]);class $d extends Gb{constructor(Za){super();
this.Ab=Za}load(Za,Hb){let $b;({startIndex:Hb,length:$b}=this.WRd(Za,Hb));const zc=new kb.a(this.Ab.annotations,Za.t4);for(let Jc=0;Jc<$b;++Jc)Array.add(zc.items,Za.items[Hb+Jc]);return zc}store(Za,Hb,$b,zc){let Jc,pd;({startIndex:Jc,length:pd}=this.WRd(Za,$b));var Qd=Hb;const ye=({SHa:zc}=this.j1a(zc)).returnValue;if(ye){Qd=new kb.a(this.Ab.annotations,Za.t4);for(let Le=0;Le<pd;++Le)Array.add(Qd.items,Za.items[Jc+Le]);Qd=ye.store(Qd,Hb,$b,zc)}Hb=Qd;for($b=0;$b<pd;++$b)Array.removeAt(Za.items,Jc);
for(let Le=0,Af=Hb.items.length;Le<Af;++Le)Array.insert(Za.items,Jc+Le,Hb.items[Le]);return Za}WRd(Za,Hb){let $b;$b=this.Ab.Xfg.xt(Za,Hb);if(0>$b)throw Error.invalidOperation("Invalid start index in Sublist() query step");Hb=this.Ab.FHc?this.Ab.FHc.xt(Za,Hb):Za.items.length-$b;if(0>Hb||$b+Hb>Za.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:$b,length:Hb}}}Object(m.a)($d,"SublistAnnotationQueryStep",Gb,[]);class Ud extends Gb{constructor(Za){super();
this.Ab=Za}load(Za,Hb){if(N.Annotations.cI(this.VD)){const $b=new kb.a(this.Ab.annotations,N.Annotations.V9);for(let zc=0,Jc=Za.items.length;zc<Jc;++zc)Array.add($b.items,this.Cgi(Za.items[zc],Hb));return $b}return this.Cgi(Za,Hb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}Cgi(Za,Hb){let $b;({startIndex:Hb,length:$b}=this.WRd(Za,Hb));return Za.substr(Hb,$b)}WRd(Za,Hb){let $b;$b=this.Ab.Xfg.xt(Za,Hb);if(0>$b)throw Error.invalidOperation("Invalid start index in Substring() query step");
Hb=this.Ab.FHc?this.Ab.FHc.xt(Za,Hb):Za.length-$b;if(0>Hb||$b+Hb>Za.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:$b,length:Hb}}}Object(m.a)(Ud,"SubstringAnnotationQueryStep",Gb,[]);class Jf extends Sa{constructor(Za){super(Za)}P1b(Za,Hb){return Za-Hb}}Object(m.a)(Jf,"SubtractAnnotationQueryStep",Sa,[]);class hh extends Gb{constructor(Za){super();this.Ab=Za}load(Za){const Hb=new kb.a(this.Ab.annotations,N.Annotations.V9);for(let $b=
0;$b<Za.length;++$b)Array.add(Hb.items,Za.charAt($b).toString());return Hb}}Object(m.a)(hh,"ToCharListAnnotationQueryStep",Gb,[]);class Qi extends Gb{constructor(Za){super();this.Ab=Za}load(Za){const Hb=new kb.a(this.Ab.annotations,this.VD);Array.add(Hb.items,Za);return Hb}}Object(m.a)(Qi,"ToListAnnotationQueryStep",Gb,[]);class Lg extends Gb{constructor(Za){super();this.Ab=Za}load(){return this.Ab.value}}Object(m.a)(Lg,"ValueAnnotationQueryStep",Gb,[]);class bc{constructor(Za,Hb){if(Za){var $b=Za.J(0),
zc=1;this.value=({Sga:zc}=Hb.RNa($b,Za,zc,null,null,null)).returnValue;N.Annotations.SIb(this.value)}}}Object(m.a)(bc,"ValueQueryStepInit",null,[]);class vc{constructor(Za,Hb){Za&&(this.poe=Hb.QD(Za.J(0)),this.query=Hb.PK(Za.J(1)))}}Object(m.a)(vc,"VarNameAndQueryQueryStepInit",null,[]);class Vc{constructor(Za,Hb){this.dVg=null;if(Za){this.annotations=Hb.annotations;var $b=0;this.VD=Za.J($b);++$b;this.U4=Za.J($b);++$b;this.hke=1===Za.J($b);++$b;this.TXd=1===Za.J($b);++$b;var zc=Za.J($b);++$b;if(zc){var Jc=
$b,pd=$b+zc,Qd=$b+2*zc;$b+=3*zc;var ye=Za.count-$b,Le=null;for(let dc=0;dc<zc;++dc){var Af=$b+Za.J(Qd+dc);const of=(dc===zc-1?ye:Za.J(Qd+dc+1))-Za.J(Qd+dc),Mj=new gc.a;Mj.Qgb(Za,Af,of);Af=Vc.F2l(Za.J(pd+dc),Mj,Hb);Af.VD=Za.J(Jc+dc);Af.U4=dc===zc-1?this.U4:Za.J(Jc+dc+1);Le?Le.next=Af:this.dVg=Af;Le=Af}}}}get C_h(){return this.dVg}static F2l(Za,Hb,$b){switch(Za){case 1:return new Ib(new Xa(Hb,$b));case 2:return new Ed(new Xa(Hb,$b));case 3:return new Ub(new pb(Hb,$b.annotations));case 4:return new hb(new Cb(Hb,
$b.annotations));case 5:return new ub(new Ac(Hb,$b));case 6:return new Rc(new pc(Hb,$b));case 43:return new xc(new pc(Hb,$b));case 45:return new oc(new Ob(Hb,$b));case 49:return new xb(new cc(Hb,$b));case 46:return new Lg(new bc(Hb,$b.annotations));case 51:return new Zb(new Wa(Hb,$b));case 52:return new Se(new he(Hb,$b));case 53:return new qc(new Rb($b.annotations));case 13:return new ne(new Xc(Hb,$b));case 14:return new cd(new id(Hb,$b));case 15:return new Ra;case 18:return new ob(new pc(Hb,$b));
case 16:return new ab(new vc(Hb,$b));case 17:return new Bb(new vc(Hb,$b));case 22:return new Mc(new Pc(Hb,$b));case 24:return new Mb(new Xc(Hb,$b));case 26:return new $d(new he(Hb,$b));case 27:return new Ie(new pc(Hb,$b));case 30:return new Qi(new Rb($b.annotations));case 31:return new Ud(new he(Hb,$b));case 32:return new Lb(new Xc(Hb,$b));case 47:return new Ic(new Rb($b.annotations));case 48:return new hh(new Rb($b.annotations));case 34:return new Pa(new Xc(Hb,$b));case 35:return new Jf(new Xc(Hb,
$b));case 36:return new Ue(new Xc(Hb,$b));case 37:return new yb(new Xc(Hb,$b));case 38:return new Ae(new Xc(Hb,$b));case 39:return new cb(new Xc(Hb,$b));case 40:return new nb(new Xc(Hb,$b));case 41:return new ef(new Xc(Hb,$b));case 42:return new Xe(new Rb($b.annotations));default:throw Error.argument("currStepInitData");}}}Object(m.a)(Vc,"AnnotationQueryInit",null,[]);class yd{constructor(Za){this.Ab=Za}execute(Za,Hb){this.iOa(Za,Za?new ja("root",Za,Hb):Hb)}iOa(Za,Hb){for(const $b of this.Ab.commands)Hb=
$b.execute(Za,Hb)}}Object(m.a)(yd,"AnnotationScript",null,[1270]);class ee{constructor(Za){this.Ab=Za}execute(Za,Hb){const $b=this.Ab.dzm.xt(Za,Hb),zc=this.Ab.fwn.xt(Za,Hb);this.Ab.script.iOa(Za,new ja("Input",$b,new ja("Output",zc,Hb)));return Hb}}Object(m.a)(ee,"ApplyAnnotationScriptCommand",null,[1287]);class Qe{constructor(Za,Hb){Za&&(this.dzm=Hb.PK(Za.J(0)),this.fwn=Hb.PK(Za.J(1)),this.script=Hb.sDb(Za.J(2)))}}Object(m.a)(Qe,"ApplyScriptCommandInit",null,[]);class ue{constructor(Za){this.Ab=
Za}execute(Za,Hb){const $b=this.Ab.J8f.xt(Za,Hb);this.Ab.T2d.gkc(Za,$b,Hb,null);return Hb}}Object(m.a)(ue,"AssignAnnotationScriptCommand",null,[1287]);class ve{constructor(Za){this.Ab=Za}execute(Za,Hb){const $b=this.Ab.T2d.xt(Za,Hb);Za=this.Ab.J8f.xt(Za,Hb);$b!==Za&&$b.e_a(Za);return Hb}}Object(m.a)(ve,"CopyAnnotationScriptCommand",null,[1287]);class xf{constructor(Za){this.Ab=Za}execute(Za,Hb){let $b=this.Ab.AJf.xt(Za,Hb);if(this.Ab.AJf.hke){$b=N.Annotations.lT($b);var zc=new ja(this.Ab.qOa,null,
Hb);for(let pd=0,Qd=$b.items.length;pd<Qd;++pd){var Jc=this.eXh(Za,$b.items[pd],zc);if(0>this.Ab.Vde)$b.items[pd]=Jc;else if(({value:Jc}=Jc.Gq(this.Ab.Vde)).returnValue)$b.items[pd]=Jc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Ab.AJf.gkc(Za,$b,Hb,null)}else{zc=new ja(this.Ab.qOa,null,Hb);for(let pd=0,Qd=$b.items.length;pd<Qd;++pd)this.eXh(Za,$b.items[pd],zc)}return Hb}eXh(Za,Hb,$b){let zc;0>this.Ab.Vde?zc=N.Annotations.lT(Hb):(zc=new R.a(this.Ab.annotations),
zc.Dy(this.Ab.Vde,Hb));$b.g6e(zc);this.Ab.FJk.iOa(Za,$b);return zc}}Object(m.a)(xf,"EnumerateAnnotationScriptCommand",null,[1287]);class bf{constructor(Za,Hb){Za&&(this.annotations=Hb.annotations,this.qOa=Hb.QD(Za.J(0)),this.AJf=Hb.PK(Za.J(1)),this.FJk=Hb.sDb(Za.J(2)),this.Vde=Za.J(3))}}Object(m.a)(bf,"EnumerateScriptCommandInit",null,[]);class Df{constructor(Za){this.Ab=Za}execute(Za,Hb){this.Ab.ble.xt(Za,Hb)?this.Ab.vLo.iOa(Za,Hb):this.Ab.iYh&&this.Ab.iYh.iOa(Za,Hb);return Hb}}Object(m.a)(Df,"IfAnnotationScriptCommand",
null,[1287]);class nf{constructor(Za,Hb){Za&&(this.ble=Hb.PK(Za.J(0)),this.vLo=Hb.sDb(Za.J(1)),this.iYh=Za.J(2)?Hb.sDb(Za.J(2)):null)}}Object(m.a)(nf,"IfScriptCommandInit",null,[]);class Yf{constructor(Za,Hb){Za&&(this.annotations=Hb.annotations,this.T2d=Hb.PK(Za.J(0)),this.J8f=Hb.PK(Za.J(1)))}}Object(m.a)(Yf,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Kf{constructor(Za){this.Ab=Za}execute(Za,Hb){const $b=this.Ab.J8f.xt(this.Ab.T2d.xt(Za,Hb),Hb);this.Ab.T2d.gkc(Za,$b,Hb,null);return Hb}}
Object(m.a)(Kf,"ModifyAnnotationScriptCommand",null,[1287]);class wb{constructor(Za){this.Ab=Za}execute(Za,Hb){const $b=new R.a(this.Ab.annotations);this.Ab.query&&$b.e_a(this.Ab.query.xt(Za,Hb));return Hb=new ja(this.Ab.qOa,$b,Hb)}}Object(m.a)(wb,"NewAnnotationScriptCommand",null,[1287]);class Tb{constructor(Za,Hb){Za&&(this.annotations=Hb.annotations,this.qOa=Hb.QD(Za.J(0)),this.query=Za.J(1)?Hb.PK(Za.J(1)):null)}}Object(m.a)(Tb,"NewScriptCommandInit",null,[]);class Wc{constructor(Za){this.Ab=Za}execute(Za,
Hb){Za=this.Ab.query.xt(Za,Hb);if(this.Ab.query.U4===N.Annotations.iV)Za.oSa(this.Ab.Nta);else for(const $b of Za.items)$b.oSa(this.Ab.Nta);return Hb}}Object(m.a)(Wc,"RemoveAnnotationScriptCommand",null,[1287]);class Gd{constructor(Za,Hb){Za&&(this.annotations=Hb.annotations,this.query=Hb.PK(Za.J(0)),this.Nta=Za.J(1))}}Object(m.a)(Gd,"RemoveScriptCommandInit",null,[]);class Ye{constructor(Za,Hb){if(Za){var $b=0,zc=Za.J($b);++$b;if(zc){var Jc=$b,pd=$b+zc;$b+=2*zc;var Qd=Za.count-$b;this.commands=Array(zc);
for(let ye=0;ye<zc;++ye){const Le=$b+Za.J(pd+ye),Af=(ye===zc-1?Qd:Za.J(pd+ye+1))-Za.J(pd+ye),dc=new gc.a;dc.Qgb(Za,Le,Af);this.commands[ye]=Ye.v2l(Za.J(Jc+ye),dc,Hb)}}}}static v2l(Za,Hb,$b){switch(Za){case 1:return new ue(new Yf(Hb,$b));case 2:return new Kf(new Yf(Hb,$b));case 3:return new Wc(new Gd(Hb,$b));case 6:return new wb(new Tb(Hb,$b));case 7:return new xf(new bf(Hb,$b));case 8:return new Df(new nf(Hb,$b));case 9:return new ve(new Yf(Hb,$b));case 10:return new ee(new Qe(Hb,$b));default:throw Error.argument("initData");
}}}Object(m.a)(Ye,"AnnotationScriptInit",null,[]);var od=c(1633);class vf{constructor(Za){this.G1=Za;this.Ux=0}t9(){const Za=this.G1.By(this.Ux,4);this.Ux+=4;return Za}get ffa(){return this.G1}get offset(){return this.Ux}set offset(Za){this.Ux=Za}}Object(m.a)(vf,"ByteArrayReader",null,[]);class df{constructor(){this.vJ=null;this.RKi=this.ica=0}J(Za){if(0>Za||Za>=this.ica)throw Error.argumentOutOfRange("index");return this.vJ.By(this.RKi+4*Za,4)}get count(){return this.ica}static A9k(Za,Hb,$b){const zc=
new df;zc.vJ=Za;zc.RKi=Hb;zc.ica=$b;return zc}}Object(m.a)(df,"ReadOnlyListOverByteArray",null,[1263]);class dh{constructor(Za,Hb){this.KKi=this.JKi=!1;this.mw=this.UQa=this.lLf=this.NKi=null;try{this.mw=Hb.annotations;const $b=Hb.chb(Za.J(0)),zc=new vf($b);if(-914743053!==zc.t9())throw Error.argument("Input does not represent a flat lexicon");this.JKi=1===zc.t9();this.KKi=1===zc.t9();const Jc=zc.t9();zc.offset+=Jc;const pd=zc.t9();this.lLf=dh.pyn(zc,pd,this.mw);const Qd=zc.t9();this.NKi=dh.Hyn(zc,
Qd);const ye=zc.t9();this.UQa=new od.a(zc.ffa,zc.offset);zc.offset+=ye}catch($b){throw Error.argument("initData");}}get trie(){return this.UQa}xNl(Za){return"i"===Za&&this.KKi?"\u0130":Za.toUpperCase()}IBf(){return this.JKi}RKl(Za){let Hb;Hb=new kb.a(this.mw,N.Annotations.iV);if(1!==Za)if(0===Za)Za=new R.a(this.mw),Array.add(Hb.items,Za);else if(Za&1073741824){Za=this.NKi[Za&-1073741825];for(let zc=0;zc<Za.length;++zc){var $b=Za[zc];$b=0===$b?new R.a(this.mw):this.lLf[$b-2];Array.add(Hb.items,$b)}}else Array.add(Hb.items,
this.lLf[Za-2]);return{returnValue:!0,DXm:Hb}}static pyn(Za,Hb,$b){if(Hb%4)throw Error.argument("reader");const zc=df.A9k(Za.ffa,Za.offset,Hb/4);Za.offset+=Hb;Za=[];for(Hb=0;Hb<zc.count;){const Jc=({Sga:Hb}=$b.RNa(N.Annotations.iV,zc,Hb,null,null,null)).returnValue;Array.add(Za,Jc)}return Za}static Hyn(Za,Hb){Hb=Za.offset+Hb;const $b=[];for(;Za.offset<Hb;){const zc=Za.t9(),Jc=Array(zc);for(let pd=0;pd<zc;++pd){const Qd=Za.t9();Jc[pd]=Qd}Array.add($b,Jc)}return $b}}Object(m.a)(dh,"RawFlatLexicon",
null,[1269]);var Ki=c(1620),Zh=c(1621);class rh{constructor(Za){if(null==Za)throw Error.argumentNull("base64String");const Hb=Za.length;if(Hb%4)throw Error.argument("base64String's length must be a multiple of 4");this.ica=.75*Hb;this.cJb=Array(Math.ceil(this.ica/4));Za.endsWith("==")?this.ica-=2:Za.endsWith("=")&&--this.ica;let $b=0;for(let zc=0;zc<Hb;zc+=4){const Jc=rh.Lee[Za.charCodeAt(zc)-43]<<18|rh.Lee[Za.charCodeAt(zc+1)-43]<<12|rh.Lee[Za.charCodeAt(zc+2)-43]<<6|rh.Lee[Za.charCodeAt(zc+3)-43];
let pd=Jc>>16&255;this.cJb[Math.floor($b/4)]|=pd<<$b%4*8;++$b;pd=Jc>>8&255;this.cJb[Math.floor($b/4)]|=pd<<$b%4*8;++$b;pd=Jc&255;this.cJb[Math.floor($b/4)]|=pd<<$b%4*8;++$b}}get length(){return this.ica}J(Za){if(0>Za||Za>=this.ica)throw Error.argumentOutOfRange("i");return this.w4h(Za)}By(Za,Hb){if(0>Za||0>Hb||Za+Hb>this.ica)throw Error.argument("Bad range");let $b=0;for(let zc=0;zc<Hb;++zc)$b|=this.w4h(Za+zc)<<8*zc;return $b}TNn(Za,Hb){let $b=0,zc=0,Jc=Math.floor(Za/8);for(Za%=8;zc<Hb;){const pd=
8-Za>Hb-zc?Hb-zc:8-Za,Qd=this.J(Jc);$b|=(Qd>>Za&~(255<<pd))<<zc;zc+=pd;++Jc;Za=0}return $b}w4h(Za){return this.cJb[Math.floor(Za/4)]>>Za%4*8&255}}rh.Lee=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(m.a)(rh,"ByteArray",null,[]);class bm{constructor(Za,Hb,$b){this.XD=Za;this.l7m=Hb;this.o7m=$b;this.ZKi=Array(Za.b?Za.b.length:
0);this.JLf=new Ki.a(new Zh.a(this.chb(this.XD.s)));this.P8=Array(Za.t.length);this.lD=new N.Annotations(this.ahb(0),this)}get annotations(){return this.lD}get Vpl(){return this.XD.d}Q1l(){if(!(""in this.XD.m))throw Error.argument("name","Unrecognized module");return this.Jrf(this.XD.m[""])}chb(Za){if(0>Za||!this.XD.b||Za>=this.XD.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.ZKi[Za]||(this.ZKi[Za]=new rh(this.XD.b[Za]))}QD(Za){if(1>Za||Za>=this.XD.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.XD.t[Za])throw Error.argument("blobID","Requested blob is not a string");if(null==this.P8[Za]){const Hb=this.ahb(Za).J(0);this.P8[Za]=this.JLf.QD(Hb)}return this.P8[Za]}LEb(Za){if(1>Za||Za>=this.XD.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.XD.t[Za])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.P8[Za]){var Hb=this.ahb(Za);const $b=this.QD(Hb.J(0));Hb=1===Hb.J(1);this.P8[Za]=new RegExp($b,Hb?"i":"")}return this.P8[Za]}o$l(Za){if(1>Za||Za>=this.XD.t.length)throw Error.argumentOutOfRange("blobID");
if(3!==this.XD.t[Za])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}Jrf(Za){if(1>Za||Za>=this.XD.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.XD.t[Za])throw Error.argument("blobID","Requested blob is not an NL module");return this.P8[Za]||(this.P8[Za]=this.o7m.k2l(this.ahb(Za),this))}PK(Za){if(1>Za||Za>=this.XD.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.XD.t[Za])throw Error.argument("blobID","Requested blob is not an annotation query");
return this.P8[Za]||(this.P8[Za]=new bb(new Vc(this.ahb(Za),this)))}sDb(Za){if(1>Za||Za>=this.XD.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.XD.t[Za])throw Error.argument("blobID","Requested blob is not an annotation script");return this.P8[Za]||(this.P8[Za]=new yd(new Ye(this.ahb(Za),this)))}pna(Za){if(1>Za||Za>=this.XD.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.XD.t[Za])throw Error.argument("blobID","Requested blob is not a filter");return this.P8[Za]||(this.P8[Za]=
this.l7m.pna(this.ahb(Za),this))}B8l(Za){if(1>Za||Za>=this.XD.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.XD.t[Za])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.P8[Za]||(this.P8[Za]=new dh(this.ahb(Za),this))}ahb(Za){const Hb=this.XD.n[Za];Za=(Za<this.XD.t.length-1?this.XD.n[Za+1]:this.XD.n.length)-Hb;if(0>Hb||0>Za||Hb+Za>this.XD.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Hb+","+Za+")");const $b=new gc.a;
$b.Rlf(this.XD.n,Hb,Za);return $b}}Object(m.a)(bm,"ObjectFetcher",null,[1236]);class Bf{constructor(Za,Hb,$b){if(!Za)throw Error.argumentNull("prediction");if(!Hb)throw Error.argumentNull("fieldNames");if(!$b)throw Error.argumentNull("values");if(Hb.length!==$b.length)throw Error.argument("values","fieldNames and values do not have same length");this.qek=Za;this.dJb=Hb;this.iYc=$b}get prediction(){return this.qek}get IYh(){return this.dJb.length}Ipf(Za){return 0<=Za&&Za<this.dJb.length?this.dJb[Za]:
null}getValue(Za){return 0<=Za&&Za<this.iYc.length?this.iYc[Za]:null}}Object(m.a)(Bf,"PredictionData",null,[]);class ig{constructor(Za,Hb){if(!Za)throw Error.argumentNull("predictions");if(!Hb)throw Error.argumentNull("tokenAttributes");this.r7m=Za;this.v7m=Hb}Psf(){return this.r7m}o3h(){return this.v7m}}Object(m.a)(ig,"PredictionDataWithTokenAttributes",null,[]);class md{constructor(Za,Hb){this.prediction=null;this.score=0;this.prediction=Za;this.score=Hb}}Object(m.a)(md,"PredictionWithScore",null,
[]);class td{constructor(Za,Hb){if(!Za)throw Error.argumentNull("predictions");if(!Hb)throw Error.argumentNull("attributes");this.rek=Za;this.LVj=Hb}Psf(){return this.rek}o3h(){return this.LVj}}Object(m.a)(td,"PredictionsWithTokenAttributes",null,[]);class wd{constructor(Za,Hb,$b){if(!Za)throw Error.argumentNull("attributeName");if(!Hb)throw Error.argumentNull("fieldNames");if(!$b)throw Error.argumentNull("values");if(Hb.length!==$b.length)throw Error.argument("values","fieldNames and values do not have same length");
this.KVj=Za;this.dJb=Hb;this.iYc=$b}get attributeName(){return this.KVj}get IYh(){return this.dJb.length}Ipf(Za){return 0<=Za&&Za<this.dJb.length?this.dJb[Za]:null}getValue(Za){return 0<=Za&&Za<this.iYc.length?this.iYc[Za]:null}}Object(m.a)(wd,"TokenAttributes",null,[]);var pm=c(55),ai=c(129);class Zg{constructor(Za,Hb,$b,zc,Jc){this.ncd=0;this.Npg=null;this.ocd=this.hnc=0;this.qpe=this.kRb=this.cra=this.inc=null;this.Opg=0;this.zKe=this.fC=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=
this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.bS=Za;this.$Kj=this.dLj=Hb;this.ZKj=this.bLj=$b;this.lcd=this.aLj=zc;this.mcd=this.cLj=Jc}eLj(){this.ocd=0;return this.Lpg}Lpg(){if(!(this.ocd<this.lcd))return this.Mpg;this.inc=this.$Kj.items[this.ocd+this.ZKj];this.cra=new R.a(this.bS.Ab.annotations);1!==this.lcd&&this.bS.Ab.pTc||this.cra.e_a(this.inc);if(0<=this.bS.Ab.J4d){({value:this.kRb}=this.cra.Gq(this.bS.Ab.J4d)).returnValue?this.kRb=this.kRb.lT():this.kRb=new kb.a(this.bS.Ab.annotations,
N.Annotations.iV);this.qpe=this.mcd.items;this.Opg=this.qpe.length;for(this.ncd=0;this.ncd<this.Opg;++this.ncd)this.Npg=this.qpe[this.ncd],Array.add(this.kRb.items,this.Npg);this.cra.Dy(this.bS.Ab.J4d,this.kRb)}else 0<=this.bS.Ab.Seg?this.cra.Dy(this.bS.Ab.Seg,this.mcd.items[0]):0<=this.bS.Ab.v3e?this.cra.Dy(this.bS.Ab.v3e,!0):this.bS.Ab.Vyi?this.mcd.items[0].QMd((Za,Hb)=>this.cra.Dy(Za,Hb)):(this.cra.e_a(this.mcd.items[0]),1!==this.lcd&&this.bS.Ab.pTc||(({value:this.hnc}=this.inc.Gq(this.bS.Ab.g3)).returnValue&&
this.cra.Dy(this.bS.Ab.g3,this.hnc),({value:this.hnc}=this.inc.Gq(this.bS.Ab.l7)).returnValue&&this.cra.Dy(this.bS.Ab.l7,this.hnc),this.inc.Gq(this.bS.Ab.Kdb).returnValue&&this.cra.Dy(this.bS.Ab.Kdb,this.hnc)));this.fC=this.cra;this._state=2;return this.gLj}Mpg(){this._state=3}fLj(){this.ocd++;return this.Lpg}gLj(){return 1<this.lcd&&this.bS.Ab.pTc?this.Mpg:this.fLj}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Zg(this.bS,this.dLj,this.bLj,this.aLj,this.cLj)).getEnumerator()}[Symbol.iterator](){return Object(ai.a)(this.getEnumerator())}moveNext(){if(3===
this._state)return!1;this._state?this._state=1:(this._state=1,this.zKe=this.eLj());for(;1===this._state;)this.zKe=this.zKe();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.fC}}Object(m.a)(Zg,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[9,72,86]);class Tk{constructor(Za,Hb,$b){this.fYc=this.SKi=0;this.cdc=null;this.KLf=this.rLf=this.adc=this.$2d=this.uLf=
0;this.a3d=!1;this.ELf=Za;this.MLf=Hb;this.q7m=$b}mbi(){null===this.cdc&&({Exj:this.cdc,foi:this.uLf,length:this.$2d,ayl:Za}=this.ELf.Xhi(this.MLf.items[this.fYc],this.q7m),this.a3d=Za||this.a3d);if(this.adc<this.$2d){var Za=this.cdc.charAt(this.uLf+this.adc);++this.adc;return{returnValue:!0,ch:Za}}if(this.fYc===this.MLf.items.length-1)return{returnValue:!1,ch:"\x00"};++this.fYc;this.adc=0;this.cdc=null;return{returnValue:!0,ch:" "}}t4f(Za,Hb){this.adc===this.$2d&&this.cdc&&(this.KLf=Hb,this.rLf=
this.fYc-this.SKi+1)}j4n(Za){if(0>Za||Za>=this.MLf.items.length)throw Error.argumentOutOfRange("iToken");this.fYc=this.SKi=Za;this.cdc=null;this.rLf=this.adc=this.$2d=this.uLf=0;this.KLf=-1;this.a3d=!1}O0l(){return{AOk:this.rLf,TUm:this.KLf,$xl:this.a3d}}}Object(m.a)(Tk,"TriePrefixVisitor",null,[1281]);class el{constructor(Za){this.Ab=Za}execute(Za){if(!({value:$b}=Za.Gq(this.Ab.ZMa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Hb;({value:Hb}=Za.Gq(this.Ab.iZa)).returnValue||
(Hb=null);var $b=this.XJl($b,Hb);Za=N.Annotations.lT(Za);Za.Dy(this.Ab.ZMa,$b);return Za}XJl(Za,Hb){let $b=null;const zc=this.Ab.flatLexicon.trie,Jc=new Tk(this,Za,Hb);let pd=null;this.Ab.flatLexicon.IBf()&&(pd=Object(pm.a)(this.Ab.flatLexicon,this.Ab.flatLexicon.xNl,"getCaseInsensitiveForm"));let Qd=0,ye;var Le;let Af;for(;Qd<Za.items.length;){const dc=Za.items[Qd];Jc.j4n(Qd);zc.cJj(Jc,pd);({AOk:ye,TUm:Le,$xl:Af}=Jc.O0l());if(0<ye){({DXm:Le}=this.Ab.flatLexicon.RKl(Le));for(let of of this.Aal(Za,
Qd,ye,Le)){1<ye&&this.Ab.pTc&&this.rbl(Za,Hb,Qd,dc,ye,Af,of);if(!$b)for($b=new kb.a(this.Ab.annotations,N.Annotations.iV),Le=0;Le<Qd;++Le)Array.add($b.items,Za.items[Le]);Array.add($b.items,of)}Qd+=ye}else $b&&Array.add($b.items,dc),++Qd}return $b||Za}rbl(Za,Hb,$b,zc,Jc,pd,Qd){if(pd)pd=!0;else if(this.Ab.Gyi){pd=!1;var ye=-1;for(var Le=0;Le<Jc;Le++){var Af=Za.items[$b+Le];let bi;var dc=void 0;if(!({value:bi}=Af.Gq(this.Ab.g3)).returnValue||!({value:dc}=Af.Gq(this.Ab.l7)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Le){if(bi>ye+1){pd=!0;break}if(0>ye||null===Hb||ye>=Hb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Hb.charAt(ye)){pd=!0;break}}ye=bi+dc}}else pd=!1;if(pd){dc=new Sys.StringBuilder;for(pd=0;pd<Jc;++pd)({Exj:ye,foi:Le,length:Af}=this.Xhi(Za.items[$b+pd],Hb)),0<pd&&dc.append(" "),dc.append(ye.substr(Le,Af));Qd.Dy(this.Ab.Kdb,dc.toString())}Za=Za.items[$b+Jc-1];let of,Mj;({value:zc}=zc.Gq(this.Ab.g3)).returnValue&&
({value:of}=Za.Gq(this.Ab.g3)).returnValue&&({value:Mj}=Za.Gq(this.Ab.l7)).returnValue?(Qd.Dy(this.Ab.g3,zc),Qd.Dy(this.Ab.l7,of+Mj-zc)):(Qd.oSa(this.Ab.g3),Qd.oSa(this.Ab.l7))}Aal(Za,Hb,$b,zc){return new Zg(this,Za,Hb,$b,zc)}Xhi(Za,Hb){let $b,zc;if(({value:$b}=Za.Gq(this.Ab.Kdb)).returnValue)zc=!0,Hb=0,Za=$b.length;else{zc=!1;if(null===Hb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");$b=Hb;if(!({value:Hb}=Za.Gq(this.Ab.g3)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:Za}=Za.Gq(this.Ab.l7)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Hb||0>Za||Hb+Za>$b.length)throw Error.argument("Token start/length values out of range","token");}return{Exj:$b,foi:Hb,length:Za,ayl:zc}}}Object(m.a)(el,"FlatLexiconNLModule",null,[1264]);class zl{constructor(Za,Hb){this.v3e=this.J4d=this.Seg=this.Kdb=this.l7=this.g3=this.iZa=this.ZMa=0;this.Vyi=this.Gyi=this.pTc=!1;this.flatLexicon=null;this.annotations=Hb.annotations;
let $b=0;try{this.ZMa=Za.J($b),++$b,this.iZa=Za.J($b),++$b,this.g3=Za.J($b),++$b,this.l7=Za.J($b),++$b,this.Kdb=Za.J($b),++$b,this.Seg=Za.J($b),++$b,this.J4d=Za.J($b),++$b,this.v3e=Za.J($b),++$b,this.pTc=1===Za.J($b),++$b,this.Gyi=1===Za.J($b),++$b,this.Vyi=1===Za.J($b),++$b,this.flatLexicon=Hb.B8l(Za.J($b))}catch(zc){throw Error.argument("initData");}}}Object(m.a)(zl,"FlatLexiconNLModuleInit",null,[]);class ei{constructor(){this.oRc=0;this.Hjf=null;this.M5c=0}}Object(m.a)(ei,"FeatureGenStackRec",
null,[]);class fi{constructor(Za){this.Cjg=Array(Za);this.slc=Array(Za);this.qgg=[];this.gvj=[]}}Object(m.a)(fi,"TokenStringLattice",null,[]);const Lj=(Za,Hb,$b)=>{for(let zc=0;zc<Za.length;zc++)$b=Hb($b,Za[zc]);return $b},cm=(Za,Hb)=>{const $b=Array(Za.length);for(let zc=0;zc<Za.length;zc++)$b[zc]=Hb(Za[zc]);return $b},Rg=(Za,Hb)=>{Hb=Array(Math.min(Hb,Za.length));for(let $b=0;$b<Hb.length;$b++)Hb[$b]=Za[$b];return Hb},Xf=(Za,Hb)=>{const $b=[];for(const zc of Za)Hb(zc)&&Array.add($b,zc);return $b};
class Si{constructor(Za,Hb){this.key=Za;this.value=Hb}}Object(m.a)(Si,"KeyValuePair",null,[]);const Sl=(Za,Hb)=>({returnValue:Hb in Za,value:Za[Hb]}),Om=Za=>{const Hb=[];for(let $b in Za){const zc=new Si($b,Za[$b]);Array.add(Hb,zc)}return Hb};class sg{constructor(Za){this.Whi=this.Hem;this.Ab=Za;this.d3d=this.BLf=this.CLf=0;for(const Hb of this.Ab.wLd)this.CLf=Math.max(this.CLf,Hb.XZf),this.BLf=Math.max(this.BLf,Hb.SZf),this.d3d=Math.max(this.d3d,Hb.Sob.length)}get pAl(){return this.Ab.Lle.trie}execute(Za){if(!Za)throw Error.argumentNull("input");
let Hb,$b;({tokens:Hb,aWm:$b}=this.Iem(Za));let zc=null,Jc=null,pd={};if(this.Ab.WTc){Hb=N.Annotations.lT(Hb);for(var Qd=0;Qd<Hb.items.length;++Qd)Hb.items[Qd]=N.Annotations.lT(Hb.items[Qd])}else({qYh:Jc,returnValue:zc}=this.hci(Za,pd));Qd=Array(this.d3d);const ye=Array(this.d3d);for(var Le=0;Le<ye.length;++Le)ye[Le]=new ei;for(Le=-this.CLf;Le<Hb.items.length+this.BLf;++Le){let Af=null;this.Ab.WTc&&(Af=Hb.items[Le],pd={},{qYh:Jc,returnValue:zc}=this.hci(Af,pd));for(const dc of this.Ab.wLd){if(0>Le&&
-Le>dc.XZf||Le>=Hb.items.length&&Le-Hb.items.length+1>dc.SZf)continue;let of=!0;for(let Mj=0;Mj<dc.Sob.length;++Mj){const bi=Le+dc.Sob[Mj];Qd[Mj]=bi;if(0>bi?0>this.Ab.YZf:bi>=Hb.items.length?0>this.Ab.TZf:!$b.slc[bi]){of=!1;break}}of&&({Kel:zc,Lel:Jc}=this.BBm(dc,$b,zc,Jc,pd,ye,Qd))}this.Ab.WTc&&(Af.Dy(this.Ab.O2a?this.Ab.b1b:this.Ab.$0b,zc),this.Ab.O2a&&Af.Dy(this.Ab.a1b,Jc))}Za=N.Annotations.lT(Za);this.Ab.WTc?Za.Dy(this.Ab.ZMa,Hb):(Za.Dy(this.Ab.O2a?this.Ab.b1b:this.Ab.$0b,zc),this.Ab.O2a&&Za.Dy(this.Ab.a1b,
Jc));return Za}Iem(Za){let Hb,$b;if(!Za||!({value:Hb}=Za.Gq(this.Ab.ZMa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let zc;({value:zc}=Za.Gq(this.Ab.iZa)).returnValue||(zc="");$b=new fi(Hb.items.length);const Jc=Xf(this.Ab.Fjg,pd=>!pd.qSc||pd.qSc.isMatch(Za,null));for(let pd=0;pd<Hb.items.length;++pd){const Qd=Hb.items[pd];let ye=null;$b.Cjg[pd]=$b.qgg.length;let Le=$b.slc[pd]=0;for(const Af of Jc)0<Af.tYc&&$b.slc[pd]+Le>=Af.tYc||Af.p$c&&!Af.p$c.isMatch(Qd,
null)||({r$c:ye,jFc:Le}=Af.apply(this,Qd,pd,$b,zc,ye,Le))}return{tokens:Hb,aWm:$b}}BBm(Za,Hb,$b,zc,Jc,pd,Qd){let ye=0;pd[0].oRc=-1;for(pd[0].Hjf=Za.uej;;){var Le=Qd[ye],Af=0>Le||Le>=Hb.slc.length?1:Hb.slc[Le];let Mj=!1;for(;pd[ye].oRc<Af-1;){++pd[ye].oRc;var dc=void 0,of=void 0;0>Le?(dc=this.Ab.YZf,of=1):Le>=Hb.Cjg.length?(dc=this.Ab.TZf,of=1):(of=Hb.Cjg[Le]+pd[ye].oRc,dc=Hb.qgg[of],of=Hb.gvj[of]);pd[ye].M5c=of*(ye?pd[ye-1].M5c:Za.score);if(({value:dc}=Sl(pd[ye].Hjf,dc.toString())).returnValue){ye===
Za.Sob.length-1?(Le=dc,pd[ye].M5c&&(({value:Af}=Sl(Jc,Le.toString())).returnValue||(Af=-1),0>Af&&($b=N.Annotations.lT($b),Array.add($b.items,Le)),this.Ab.O2a&&(zc=N.Annotations.lT(zc),0>Af?Array.add(zc.items,pd[ye].M5c):zc.items[Af]+=pd[ye].M5c),0>Af&&(this.Ab.rCi||this.Ab.O2a)&&(Jc[Le.toString()]=$b.items.length-1))):(++ye,pd[ye].oRc=-1,pd[ye].Hjf=dc);Mj=!0;break}}if(!Mj&&(--ye,0>ye))break}return{Kel:$b,Lel:zc}}hci(Za,Hb){let $b;if(({value:$b}=Za.Gq(this.Ab.O2a?this.Ab.b1b:this.Ab.$0b)).returnValue)for(let zc=
0;zc<$b.items.length;++zc)Hb[$b.items[zc].toString()]=zc;else $b=new kb.a(this.Ab.annotations,N.Annotations.yIa);if(this.Ab.O2a){if(({value:Hb}=Za.Gq(this.Ab.a1b)).returnValue||(Hb=new kb.a(this.Ab.annotations,N.Annotations.Mqa)),Hb.items.length!==$b.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ab.annotations.wda(N.Annotations.iV,Za));}else Hb=null;return{returnValue:$b,qYh:Hb}}get KIo(){return this.Ab.Lle}Hem(Za,
Hb){var $b;if(({value:$b}=Hb.Gq(this.Ab.Kdb)).returnValue)Za=$b;else{if(!({value:$b}=Hb.Gq(this.Ab.g3)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Hb}=Hb.Gq(this.Ab.l7)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>$b||0>Hb||$b+Hb>Za.length)throw Error.argument("Token indices are out of range");Za=Za.substr($b,Hb)}return Za}}Object(m.a)(sg,"NGramNLModule",null,[1264,1265]);class Dk{constructor(Za){this.Sob=null;this.score=this.SZf=this.XZf=
0;this.uej=null;if(Za){var Hb=0;try{if(Za.J(Hb)!==Dk.Qzb)throw Error.argument("initData","Input does not represent a feature template");++Hb;const $b=Za.J(Hb);++Hb;this.Sob=Array($b);for(let zc=0;zc<$b;++zc)this.Sob[zc]=Za.J(Hb),++Hb;this.XZf=Za.J(Hb);++Hb;this.SZf=Za.J(Hb);++Hb;this.score=Za.J(Hb);++Hb;this.uej=({$ni:Hb}=Dk.c6i(Za,Hb)).returnValue}catch($b){throw Error.argument("initData");}}}static c6i(Za,Hb){const $b=Za.J(Hb);++Hb;const zc={};for(let Jc=0;Jc<$b;++Jc){const pd=Za.J(Hb);++Hb;Za.J(Hb)?
zc[pd.toString()]=({$ni:Hb}=Dk.c6i(Za,Hb)).returnValue:(++Hb,zc[pd.toString()]=Za.J(Hb),++Hb)}return{returnValue:zc,$ni:Hb}}}Dk.Qzb=240803228;Object(m.a)(Dk,"FeatureTemplate",null,[1283]);var yj=c(1578);class Qj{constructor(Za,Hb){this.O2a=this.rCi=this.WTc=!1;this.Kdb=this.l7=this.g3=this.ZMa=this.iZa=this.a1b=this.b1b=this.$0b=0;this.Lle=null;this.TZf=this.YZf=0;this.wLd=this.Fjg=null;if(Za){this.annotations=Hb.annotations;var $b=0;try{this.WTc=1===Za.J($b);++$b;this.rCi=1===Za.J($b);++$b;this.O2a=
1===Za.J($b);++$b;this.$0b=Za.J($b);++$b;this.b1b=Za.J($b);++$b;this.a1b=Za.J($b);++$b;this.iZa=Za.J($b);++$b;this.ZMa=Za.J($b);++$b;this.g3=Za.J($b);++$b;this.l7=Za.J($b);++$b;this.Kdb=Za.J($b);++$b;this.Lle=this.azn(Hb.chb(Za.J($b)));++$b;this.YZf=Za.J($b);++$b;this.TZf=Za.J($b);++$b;const zc=Za.J($b);++$b;this.Fjg=Array(zc);for(let pd=0;pd<zc;++pd){const Qd=Za.J($b);++$b;const ye=this.Lle.trie,Le=new gc.a;Le.Qgb(Za,$b,Qd);this.Fjg[pd]=this.ezn(Le,Hb,ye);$b+=Qd}const Jc=Za.J($b);++$b;this.wLd=Array(Jc);
for(Hb=0;Hb<Jc;++Hb){const pd=Za.J($b);++$b;const Qd=new gc.a;Qd.Qgb(Za,$b,pd);this.wLd[Hb]=this.Iyn(Qd);$b+=pd}}catch(zc){throw Error.argument("initData");}}}azn(Za){return new Ki.a(new Zh.a(Za))}ezn(Za,Hb,$b){return yj.a.create(Za,Hb,$b)}Iyn(Za){return new Dk(Za)}}Object(m.a)(Qj,"NGramNLModuleInit",null,[]);class tg{constructor(Za){this.Ab=Za}execute(Za){if(!Za)throw Error.argumentNull("input");Za=Za.clone();this.Ab.script.execute(Za,null);return Za}}Object(m.a)(tg,"ScriptNLModule",null,[1264]);
class Gh{constructor(Za,Hb){Za&&(this.script=Hb.sDb(Za.J(0)))}}Object(m.a)(Gh,"ScriptNLModuleInit",null,[]);const zj=Za=>{Za=cm(Za,Hb=>Hb*Hb);return Math.sqrt(Lj(Za,(Hb,$b)=>Hb+$b,0))},pj=Za=>Lj(Za,(Hb,$b)=>Hb>$b?Hb:$b,Za[0]);class Il{constructor(Za){this.Ab=Za}execute(Za){if(!Za)throw Error.argumentNull("input");var Hb=[],$b=[];this.QZk(Za,Hb,$b);this.Pyk(Hb,$b);const zc={};for(let pd=0;pd<Hb.length;++pd){var Jc=Hb[pd];const Qd=this.Ab.psi.J(Jc);Jc=this.Ab.qsi.J(Jc);for(let ye=0;ye<Jc;++ye){const Le=
this.Ab.y7.J(this.Ab.iDh.J(Qd+ye)),Af=this.Ab.jDh.J(Qd+ye);let dc;({value:dc}=Sl(zc,Le)).returnValue||(dc=0);zc[Le]=dc+$b[pd]*Af}}$b=Om(zc);$b.sort((pd,Qd)=>{var ye=pd.value,Le=Qd.value;(ye=-(ye>Le?1:ye<Le?-1:0))||(ye=pd.key.localeCompare(Qd.key));return ye});Hb=new kb.a(this.Ab.annotations,N.Annotations.iV);for(const pd of Rg($b,this.Ab.L9m))$b=new R.a(this.Ab.annotations),$b.Dy(this.Ab.KGk,pd.key),$b.Dy(this.Ab.MGk,pd.value),Array.add(Hb.items,$b);Za.Dy(this.Ab.LGk,Hb);return Za}QZk(Za,Hb,$b){if(({value:Za}=
Za.Gq(this.Ab.JGk)).returnValue){let zc;if(({value:zc}=Za.Gq(this.Ab.b1b)).returnValue){let Jc;if(!({value:Jc}=Za.Gq(this.Ab.a1b)).returnValue||zc.items.length!==Jc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.lEd(zc,Jc,Hb,$b)}if(({value:zc}=Za.Gq(this.Ab.OGk)).returnValue){let Jc;if(!({value:Jc}=Za.Gq(this.Ab.PGk)).returnValue||zc.items.length!==Jc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.lEd(zc,Jc,Hb,$b)}({value:zc}=Za.Gq(this.Ab.$0b)).returnValue&&this.lEd(zc,null,Hb,$b);({value:zc}=Za.Gq(this.Ab.NGk)).returnValue&&this.lEd(zc,null,Hb,$b)}}lEd(Za,Hb,$b,zc){for(let pd=0;pd<Za.items.length;++pd){var Jc=void 0;Za.t4===N.Annotations.V9?({value:Jc}=Sl(this.Ab.UTh,Za.items[pd])).returnValue||(Jc=-1):(Jc=Za.items[pd],Jc=Jc>=this.Ab.iNf&&Jc<=this.Ab.q$m?this.Ab.$Qf?this.Ab.$Qf.J(Jc-this.Ab.iNf)-1:Jc-this.Ab.iNf:-1);if(0<=Jc){let Qd;Qd=Hb?Hb.items[pd]:1;0<Qd&&(Array.add($b,Jc),Array.add(zc,
Qd))}}}Pyk(Za,Hb){if(Za.length){switch(this.Ab.hJn){case 0:break;case 1:for(var $b=0;$b<Hb.length;++$b)Hb[$b]=1+Math.log(Hb[$b]);break;case 2:$b=pj(Hb);for(let zc=0;zc<Hb.length;++zc)Hb[zc]=.5+Hb[zc]/$b*.5;break;case 3:for($b=0;$b<Hb.length;++$b)Hb[$b]=1;break;default:throw Error.notImplemented();}if(this.Ab.PWd)for($b=0;$b<Hb.length;++$b)Hb[$b]*=this.Ab.PWd.J(Za[$b]);Za=zj(Hb);for($b=0;$b<Hb.length;++$b)Hb[$b]/=Za}}}Object(m.a)(Il,"TfIdfRankerNLModule",null,[1264]);class Tl{constructor(Za,Hb=0){if(!Za)throw Error.argumentNull("byteArray");
this.e3d=Hb;if(604662927!==Za.By(this.e3d+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.aj=Za.By(this.e3d+4,4);this.BKi=Za.By(this.e3d+8,4);this.e7m=Za}J(Za){if(0>Za||Za>=this.count)throw Error.argumentOutOfRange("index");return this.e7m.TNn(8*this.e3d+96+Za*this.BKi,this.BKi)}get count(){return this.aj}}Object(m.a)(Tl,"CompactIntArray",null,[1263]);const Qg=(Za,Hb)=>{Hb=Array(Hb);for(let pd=0;pd<Hb.length;pd++){var $b=pd,zc=Za.t9(),Jc=1===(zc>>31&1)?-1:
1;const Qd=zc&8388607;zc=zc>>23&255;256===zc+1?Jc=Qd?Number.NaN:1===Jc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:zc?(zc-=127,Jc=Jc*An(Qd,1)*Math.pow(2,zc)):Jc=Jc*An(Qd,0)*Math.pow(2,-126);Hb[$b]=Jc}return Hb},An=(Za,Hb)=>{let $b=0;for(let zc=0;23>zc;zc++)$b+=(Za>>22-zc&1)/Math.pow(2,zc+1);return Hb+$b};class Xj{constructor(Za,Hb){this.$Qf=null;this.TQi=0;this.qsi=this.psi=this.PWd=null;this.SQi=0;this.jDh=this.iDh=null;this.annotations=Hb.annotations;let $b=0;this.NGk=Za.J($b);++$b;this.$0b=
Za.J($b);++$b;this.OGk=Za.J($b);++$b;this.PGk=Za.J($b);++$b;this.b1b=Za.J($b);++$b;this.a1b=Za.J($b);++$b;this.JGk=Za.J($b);++$b;this.LGk=Za.J($b);++$b;this.KGk=Za.J($b);++$b;this.MGk=Za.J($b);++$b;var zc=Za.J($b);++$b;var Jc=Array(zc);for(var pd=0;pd<zc;++pd)Jc[pd]=Hb.QD(Za.J($b)),++$b;this.y7=gc.a.Saf(Jc);this.L9m=Za.J($b);++$b;this.hJn=Za.J($b);++$b;zc=Za.J($b);++$b;this.UTh={};for(Jc=0;Jc<zc;++Jc){pd=Hb.QD(Za.J($b));++$b;const Qd=Za.J($b);++$b;this.UTh[pd]=Qd}this.iNf=Za.J($b);++$b;this.q$m=Za.J($b);
++$b;zc=Za.J($b);++$b;0<zc&&(zc=Hb.chb(Za.J($b)),++$b,this.$Qf=this.r9d(new vf(zc)));++$b;Za=Hb.chb(Za.J($b));this.Pyn(Za)}r9d(Za){return new Tl(Za.ffa,Za.offset)}Pyn(Za){try{const Hb=new vf(Za);this.TQi=Hb.t9();1===Hb.t9()?this.PWd=gc.a.Saf(Qg(Hb,this.TQi)):this.PWd=null;const $b=Hb.t9();this.psi=this.r9d(Hb);Hb.offset+=$b;const zc=Hb.t9();this.qsi=this.r9d(Hb);Hb.offset+=zc;this.SQi=Hb.t9();const Jc=Hb.t9();this.iDh=this.r9d(Hb);Hb.offset+=Jc;this.jDh=gc.a.Saf(Qg(Hb,this.SQi))}catch(Hb){throw Error.argument("byteReader");
}}}Object(m.a)(Xj,"TfIdfRankerNLModuleInit",null,[]);class Gk{constructor(Za,Hb,$b,zc){this.dYf=Za;this.n_h=$b;this.tokens=zc;this.wma=Hb;this.mic=-1;this.zfe=0}}Object(m.a)(Gk,"TokenizerData",null,[]);class dm{constructor(Za){this.Ab=Za}execute(Za){if(!Za)throw Error.argumentNull("input");if(!({value:zc}=Za.Gq(this.Ab.iZa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Hb;({value:Hb}=Za.Gq(this.Ab.g3)).returnValue||(Hb=0);let $b;({value:$b}=
Za.Gq(this.Ab.l7)).returnValue||($b=zc.length-Hb);if(0>Hb||Hb>zc.length)throw Error.argument("input","Start index out of range");if(0>$b||$b>zc.length)throw Error.argument("input","Length out of range");if(Hb+$b>zc.length)throw Error.argument("input","Bad start-length range");var zc=new Gk(zc,Hb,Hb+$b,new kb.a(this.Ab.annotations,N.Annotations.iV));this.LIo(zc);Za=Za.isReadOnly?Za.clone():Za;Za.Dy(this.Ab.ZMa,zc.tokens);return Za}LIo(Za){for(;Za.wma<Za.n_h;){if(this.Ab.Yvf){var Hb=this.Ab.Yvf.gKi(Za.dYf,
Za.wma,Za.n_h-Za.wma,null);!Hb.succeeded&&Hb.OPi&&(Hb=Hb.OPi);if(Hb.succeeded){this.LUi(Za,Hb.length,this.Ab.hki);Za.wma+=Hb.length;continue}}Hb=Za.dYf.substr(Za.wma);let $b=-1,zc=-1,Jc=-1;for(let pd=0;pd<this.Ab.Aee.length;++pd){const Qd=this.Ab.Aee[pd].exec(Hb);Qd&&0<Qd[1].length&&(0>$b||Qd[0].length>zc)&&($b=pd,zc=Qd[0].length,Jc=Qd[1].length)}0<=$b?(this.LUi(Za,Jc,this.Ab.F8f[$b]),Za.wma+=Jc):Za.wma+=1}}LUi(Za,Hb,$b){if(this.Ab.IAi)$b!==dm.JOk&&(0>Za.mic&&(Za.mic=Za.wma),Za.zfe=Za.wma+Hb-Za.mic,
$b===dm.IOk&&(0<=Za.mic&&0<Za.zfe&&(Hb=new R.a(this.Ab.annotations),Hb.Dy(this.Ab.g3,Za.mic),Hb.Dy(this.Ab.l7,Za.zfe),Hb.Dy(this.Ab.k2e,dm.KOk),Hb.Dy(this.Ab.iZa,Za.dYf),Array.add(Za.tokens.items,Hb)),Za.mic=-1,Za.zfe=0));else{let zc=new R.a(this.Ab.annotations);zc.Dy(this.Ab.g3,Za.wma);zc.Dy(this.Ab.l7,Hb);zc.Dy(this.Ab.k2e,$b);Array.add(Za.tokens.items,zc)}}}dm.JOk="GAP";dm.IOk="EOS_CHUNK";dm.KOk="SENTENCE";Object(m.a)(dm,"TokenizerNLModule",null,[1264]);class Pm{constructor(Za,Hb){this.l7=this.g3=
this.k2e=this.ZMa=this.iZa=0;this.IAi=!1;this.F8f=this.Aee=this.hki=this.Yvf=null;if(Za){this.annotations=Hb.annotations;var $b=0;try{this.iZa=Za.J($b);++$b;this.ZMa=Za.J($b);++$b;this.k2e=Za.J($b);++$b;this.g3=Za.J($b);++$b;this.l7=Za.J($b);++$b;this.IAi=1===Za.J($b);++$b;var zc=Za.J($b);++$b;0<zc&&(this.Yvf=Hb.Jrf(zc).pAl);this.hki=Za.J($b)?Hb.QD(Za.J($b)):"";++$b;const Jc=Za.J($b);++$b;this.Aee=Array(Jc);this.F8f=Array(Jc);for(zc=0;zc<Jc;++zc)this.Aee[zc]=new RegExp(Hb.QD(Za.J($b))),++$b,this.F8f[zc]=
Hb.QD(Za.J($b)),++$b}catch(Jc){throw Error.argument("initData");}}}}Object(m.a)(Pm,"TokenizerNLModuleInit",null,[]);class qm{constructor(Za){this.Ab=Za}execute(Za){if(!Za)throw Error.argumentNull("input");let Hb;if(!({value:Hb}=Za.Gq(this.Ab.jvh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const $b of this.Ab.Jfg)Hb=$b.apply(Hb);Za=N.Annotations.lT(Za);Za.Dy(this.Ab.kvh,Hb);return Za}static v1e(Za,Hb){const $b=new Sys.StringBuilder;for(let zc=
0;zc<Za.length;++zc)$b.append(Hb(Za.substr(zc,1)));return $b.toString()}}Object(m.a)(qm,"TransliteratorNLModule",null,[1264]);class eg{constructor(Za){Za&&(this.style=Za.J(0))}apply(Za){return qm.v1e(Za,Hb=>eg.eTk(Hb,this.style))}static eTk(Za,Hb){switch(Hb){case 0:return Za.toLowerCase();case 1:return"I"===Za?"\u0131":Za.toLowerCase();case 2:return Za.toUpperCase();case 3:return"i"===Za?"\u0130":Za.toUpperCase();default:throw Error.invalidOperation();}}}eg.Rzb=0;Object(m.a)(eg,"ChangeCaseTransliterationStage",
null,[1280]);class Hk{apply(Za){return qm.v1e(Za,Hk.hKo)}static hKo(Za){const Hb=Za.charCodeAt(0);return 65281<=Hb&&65374>=Hb?String.fromCharCode(Hb-65248):Za}}Hk.Rzb=4;Object(m.a)(Hk,"LatinFullWidthToHalfWidthTransliterationStage",null,[1280]);class Qm{constructor(Za,Hb){Za&&(this.K3f=Hb.LEb(Za.J(0)),this.T1n=Hb.QD(Za.J(1)))}apply(Za){return Za.replace(this.K3f,this.T1n)}}Qm.Rzb=1;Object(m.a)(Qm,"RegexReplaceTransliterationStage",null,[1280]);class Uf{constructor(Za,Hb){if(Za){var $b=Za.J(0),zc=
Hb.QD(Za.J(1)),Jc=new Tl(Hb.chb(Za.J(2)));Za=0>Za.J(3)?null:new Tl(Hb.chb(Za.J(3)));this.Igg={};for(Hb=0;Hb<$b;++Hb)this.Igg[zc.charAt(Hb).toString()]=zc.substr(Jc.J(Hb),Za?Za.J(Hb):1)}}apply(Za){return qm.v1e(Za,Hb=>Hb in this.Igg?this.Igg[Hb]:Hb)}}Uf.Rzb=2;Object(m.a)(Uf,"SingleCharSubstitutionsTransliterationStage",null,[1280]);class Jd{constructor(Za,Hb){this.kvh=this.jvh=0;this.Jfg=null;if(Za){this.annotations=Hb.annotations;var $b=0;try{this.jvh=Za.J($b);++$b;this.kvh=Za.J($b);++$b;const zc=
Za.J($b);++$b;this.Jfg=Array(zc);for(let Jc=0;Jc<zc;++Jc){const pd=Za.J($b);++$b;const Qd=Za.J($b);++$b;const ye=new gc.a;ye.Qgb(Za,$b,Qd);$b+=Qd;this.Jfg[Jc]=this.$yn(pd,ye,Hb)}}catch(zc){throw Error.argument("initData");}}}$yn(Za,Hb,$b){switch(Za){case eg.Rzb:return new eg(Hb);case Qm.Rzb:return new Qm(Hb,$b);case Uf.Rzb:return new Uf(Hb,$b);case Hk.Rzb:return new Hk;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(m.a)(Jd,"TransliteratorNLModuleInit",
null,[]);class kl{k2l(Za,Hb){const $b=Za.J(0),zc=new gc.a;zc.Qgb(Za,1,Za.count-1);switch($b){case 0:return new tg(new Gh(zc,Hb));case 2:return new dm(new Pm(zc,Hb));case 3:return new sg(new Qj(zc,Hb));case 5:return new el(new zl(zc,Hb));case 9:return new qm(new Jd(zc,Hb));case 10:return new Il(new Xj(zc,Hb));default:throw Error.notImplemented();}}}Object(m.a)(kl,"NLModuleFactory",null,[1244]);class Ik{constructor(Za){this.GOk=";";if(!Za)throw Error.argumentNull("resource");this.Eha=new bm(Za,new Eb,
new kl);this.ELf=this.Eha.Q1l();this.AKi=this.Eha.annotations.WMc("Text.Text");this.yKi=this.Eha.annotations.WMc("Classification.Predictions");this.pLf=this.Eha.annotations.WMc("Classification.PredictionString");this.zKi=this.Eha.annotations.WMc("Classification.Probability");this.d7m=this.Eha.annotations.WMc("NLMod.Tokens");if(0>this.AKi||0>this.yKi||0>this.pLf||0>this.zKi)throw Error.argument("resourceObj","Resource does not represent a ranker");}ZLl(){const Za=[];this.uif(void 0,this.$3h(Za),null);
return Za}aMl(Za,Hb){const $b=[],zc=[];this.uif(Za,this.$3h($b),(Jc,pd)=>{const Qd=this.Eha.annotations.N3h(Jc),ye=[],Le=[];Hb&&Hb.length&&-1===Array.indexOf(Hb,Qd)||(Jc=this.Eha.annotations.getAttributeType(Jc),this.b1i(Jc,pd,ye,Le),pd=new wd(Qd,ye,Le),Array.add(zc,pd))});return new td($b,zc)}$Ll(Za){const Hb=[];this.uif(Za,$b=>{let zc;if(({value:zc}=$b.Gq(this.pLf)).returnValue){let Jc;({value:Jc}=$b.Gq(this.zKi)).returnValue&&Array.add(Hb,new md(zc,Jc))}},null);return Hb}uif(Za,Hb,$b){var zc=new R.a(this.Eha.annotations);
zc.Dy(this.AKi,Za);Za=this.ELf.execute(zc);if(({value:zc}=Za.Gq(this.yKi)).returnValue)for(const Jc of zc.items)Hb(Jc);if($b&&({value:Hb}=Za.Gq(this.d7m)).returnValue)for(const Jc of Hb.items)Jc.QMd($b)}b1i(Za,Hb,$b,zc){if(N.Annotations.cI(Za))for(var Jc of Hb.items)this.b1i(Hb.t4,Jc,$b,zc);else if(N.Annotations.pCj(Za)){Jc=this.Eha.annotations.Mbi(Za);for(let pd=0;pd<Jc;pd++)Array.add($b,this.Eha.annotations.tgi(Za,pd)),Array.add(zc,this.Eha.annotations.wda(this.Eha.annotations.VEb(Za,pd),Hb.shb(pd)))}else Array.add($b,
"VALUE"),Array.add(zc,this.Eha.annotations.wda(Za,Hb))}$3h(Za){return Hb=>{let $b;({value:$b}=Hb.Gq(this.pLf)).returnValue&&Array.add(Za,this.b7l($b))}}b7l(Za){const Hb=Za.indexOf(this.GOk);return 0>Hb?Za:Za.substring(0,Hb)}}Object(m.a)(Ik,"Ranker",null,[]);var tf=c(1520),hd=c(1532),lg=c(2);class Bn{constructor(Za,Hb){this.D3g="";this.yOe=null;this.zOe=!1;this.ira=null;this.NVj=["TellMe.TellMeParamCollection"];this.fc=Za;this.gXa=Hb;this.fc.nzb&&(this.ira=null)}get fbe(){if(!this.yOe&&!this.zOe){let Za=
null;try{Za=window.TellMeModel}catch(Hb){if(v.TellMeActor.instance.Oe)v.TellMeActor.instance.Oe.onError("QueryRanker","TellMeModel not found. Exception: "+Hb)}if(Za){try{this.yOe=new Ik(Za)}catch(Hb){if(v.TellMeActor.instance.Oe)v.TellMeActor.instance.Oe.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Hb)}this.zOe=!0}else if(v.TellMeActor.instance.Oe)v.TellMeActor.instance.Oe.onError("QueryRanker","Classifier model not found")}return this.yOe}XK(){return"Command"}cU(){return 0===
this.fc.$u?0:1===this.fc.$u?1:2}MH(Za,Hb,$b=!1,zc=e.a.tellMe,Jc=null){const pd=new n.a(Za);if((!Jc||Array.contains(Jc,0))&&!A.a.YQ(Za)){if(!this.fbe&&this.zOe){if(v.TellMeActor.instance.Oe)v.TellMeActor.instance.Oe.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.fc.nzb&&this.ira&&this.ira.initialize();if(tf.CommandResultsUtility.QBf(Za.Dg)&&(Jc=tf.CommandResultsUtility.E5h(Za.Dg),0<Jc.results.length)){Jc.displayName=
"Classifier Debug";pd.Tu(Jc);Hb.resultsUpdated(pd);return}Jc=Za?this.D3g=Za.Dg:this.D3g;if(lg.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Jc=this.d7l(Jc);var Qd=this.eOd(Jc.Psf());Jc=Jc.o3h()}else Jc=this.c7l(Jc),Qd=this.bPl(Jc),Jc=[];tf.CommandResultsUtility.p2d(Qd,!1,"Classifier","TFIDF");Qd=tf.CommandResultsUtility.gPc(Za,Qd,this.fc,this.ira,this.gXa,Jc,0,1);0<Qd.results.length&&zc!==e.a.contextMenu&&(Qd.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);$b||Qd.results.length||
this.fc.Q_||this.fc.O6a||(Za=new y.a("lookupNoResults",14,Za.Dg,null,1),Qd.Jw(Za));0<Qd.results.length&&pd.Tu(Qd);pd.attributes=Jc}Hb.resultsUpdated(pd)}Psf(){let Za=[];try{Za=this.fbe.ZLl()}catch(Hb){if(v.TellMeActor.instance.Oe)v.TellMeActor.instance.Oe.onError("GetPredictions","Exception: "+Hb)}return Za}c7l(Za){let Hb=[];try{Hb=this.fbe.$Ll(Za)}catch($b){if(v.TellMeActor.instance.Oe)v.TellMeActor.instance.Oe.onError("GetPredictionsWithScore","Exception: "+$b)}return Hb}d7l(Za){try{return this.fbe.aMl(Za,
this.NVj)}catch(Hb){if(v.TellMeActor.instance.Oe)v.TellMeActor.instance.Oe.onError("GetPredictionsWithTokenAttributes","Exception: "+Hb)}return new td([],[])}eOd(Za){const Hb=[];if(Za)for(const $b of Za)Hb.push(new hd.a($b,-99999));return Hb}bPl(Za){const Hb=[];if(Za)for(const $b of Za)Hb.push(new hd.a($b.prediction,$b.score));return Hb}}Object(m.a)(Bn,"CommandResultsProvider",null,[1121]);var Rj=c(1717);class ge{constructor(Za){this.fc=Za}XK(){return"Feedback"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?
1:2}MH(Za,Hb,$b,zc,Jc=null){Za=new n.a(Za);if(!Jc||Array.contains(Jc,21))Jc=[],Jc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Jc),Jc=new z.a(22),Jc.displayName="",Jc.Jw(new y.a("TellMeFeedback",23,null,null,1)),Za.Tu(Jc);Hb.resultsUpdated(Za)}}Object(m.a)(ge,"FeedbackResultsProvider",null,[1121]);class Uc{constructor(Za,Hb,$b,zc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=Za;this.CommandId=
Hb;this.CommandValueId=$b;this.InputText=zc}}Object(m.a)(Uc,"FindInDocumentProp",null,[]);var ql=c(19);class Cg{constructor(Za){this.sJe=2;this.pvb=[];this.ibb=[];this.fc=Za;Cg.TDa=Za.Pjf;Cg.GZh="FindInDocumentSuggestion";Cg.q0i="FindInDocumentSuggestion3";this.hIe=Object.assign(new w.a,{landingTab:"Indoc",data:null});this.Uhk=this.fc.Fob||!!lg.AFrameworkApplication.ta&&lg.AFrameworkApplication.ta.Nb.Fob}XK(){return"FindInDocument"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:3===this.fc.$u?this.fc.zsj?
2:3:2}MH(Za,Hb,$b=!1,zc,Jc=null){const pd=new n.a(Za);if(Jc&&!Array.contains(Jc,2))Hb.resultsUpdated(pd);else if(Array.clear(this.pvb),A.a.YQ(Za)){if($b&&this.Npj()){$b=new z.a(2);$b.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Jc=1;zc="";if(0<this.ibb.length&&!this.fc.ljc)for(var Qd of this.ibb)if(""!==Qd.Label.toLowerCase()){if(Jc>=this.sJe)break;this.jGj($b,Qd.Label,Qd.CommandValueId,Cg.GZh+Jc,Qd.InputText);Jc++}Qd="";this.fc.pP?(pd.Tu($b),$b=new z.a(3),Qd=this.fc.Fdb?A.a.bhb(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):Qd=CommonUIStrings.l_TellMeOpenFindPaneText;zc=this.D5h("");this.jGj($b,Qd,zc,Cg.q0i,"");pd.Tu($b)}Hb.resultsUpdated(pd)}else Qd="",$b&&($b=this.D5h(Za.Dg),zc=[],this.fc.m3a?(this.fc.Vhe&&zc.push(appChrome.actions.setControlIconSet(Cg.TDa,{"default":"FindInDocument_20"})),Qd=this.fc.iGf?A.a.bqf(Za.Dg,CommonUIStrings.l_FindInDocumentScopedButtonText):Za.Dg+CommonUIStrings.l_FindInDocumentScopedButtonText):this.fc.pP?(Qd=this.fc.Fdb?A.a.bhb(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
Za.Dg)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,Za.Dg),zc.push(appChrome.actions.setControlIconSet(Cg.TDa,{"default":"FindInDocument_20"}))):Qd=this.fc.ljc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,Za.Dg),this.fc.Vva?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Cg.TDa,Qd)),v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Cg.TDa,$b))):(zc.push(appChrome.actions.setControlLabel(Cg.TDa,
Qd)),zc.push(appChrome.actions.setButtonCommandValueId(Cg.TDa,$b)),appChrome.api.dispatch(zc)),this.dlj(Qd,Cg.TDa,$b,Za.Dg)),this.fc.zsj?(Qd=new y.a(Cg.TDa,8,Za.Dg),$b=new z.a(2),$b.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,$b.Jw(Qd),pd.Tu($b),Hb.resultsUpdated(pd)):this.fc.dPd(Za.Dg).then(ye=>{const Le=new y.a(Cg.TDa,8,Za.Dg,null,1);Le.count=ye;ye=new z.a(2);ye.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;ye.Jw(Le);pd.Tu(ye);Hb.resultsUpdated(pd)},ye=>{v.TellMeActor.instance.Oe.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+ye);ye=new y.a(Cg.TDa,8,Za.Dg,null,1);const Le=new z.a(2);Le.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Le.Jw(ye);pd.Tu(Le);Hb.resultsUpdated(pd)})}Npj(){return!!this.fc&&this.fc.Ohe}jGj(Za,Hb,$b,zc,Jc=null){const pd=[];Hb&&pd.push(appChrome.actions.setControlLabel(zc,Hb));this.fc.pP&&pd.push(appChrome.actions.setControlIconSet(zc,{"default":"FindInDocument_20"}));pd.push(appChrome.actions.setButtonCommandValueId(zc,$b));appChrome.api.dispatch(pd);
this.dlj(Hb,zc,$b,"");Za.Jw(new y.a(zc,8,Jc,null,1,-99999))}D5h(Za){return this.Uhk?A.a.LNa(Za,15,this.hIe):ql.a.Af(Za)}dlj(Za,Hb,$b,zc){this.Npj()&&this.pvb.length<this.sJe&&(Za=new Uc(Za,Hb,$b,zc),Array.add(this.pvb,Za))}tio(Za){for(let Hb=0;Hb<this.pvb.length;Hb++)if(this.pvb[Hb].CommandId===Za){const $b=this.pvb[Hb].Label;let zc=!1;if(0<this.ibb.length){let Jc=0;for(const pd of this.ibb){if(pd.Label===$b){Array.removeAt(this.ibb,Jc);zc=!0;break}Jc++}}!zc&&this.ibb.length>=this.sJe-1&&Array.removeAt(this.ibb,
1);Array.insert(this.ibb,0,this.pvb[Hb])}}}Cg.TDa=null;Cg.GZh=null;Cg.q0i=null;Object(m.a)(Cg,"FindInDocumentResultsProvider",null,[1121]);var yg=c(1715);class Bh{constructor(Za){this.fc=Za}XK(){return"Insights"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:2}MH(Za,Hb,$b=!1,zc,Jc=null){zc=new n.a(Za);if(!Jc||Array.contains(Jc,13))if(this.Cro()||!A.a.YQ(Za)){Jc=new z.a(13);var pd=""===Za.Dg.trim(),Qd=pd?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",ye=new y.a(Qd,10,Za.Dg,null,1);$b&&($b=
null,A.a.nha()?pd?pd=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(pd=this.fc.ljc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Za.Dg),$b=A.a.LNa(Za.Dg,1)):(pd=String.format(CommonUIStrings.l_InsightsButtonText,Za.Dg),$b=A.a.kBb(Za.Dg)),this.fc.Vva?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Qd,pd)),$b&&v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
$b))):(Za=[],Za.push(appChrome.actions.setControlLabel(Qd,pd)),$b&&Za.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",$b)),appChrome.api.dispatch(Za)),ye.label=pd);Jc.Jw(ye);zc.Tu(Jc)}Hb.resultsUpdated(zc)}Cro(){return A.a.nha()&&this.fc.RFo&&!this.fc.Yfa}}Object(m.a)(Bh,"InsightsResultsProvider",null,[1121]);var ug=c(1713);class Ee{constructor(Za){this.fc=Za}XK(){return"Learning"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:2}MH(Za,Hb,$b,zc,Jc=null){$b=new n.a(Za);Jc&&!Array.contains(Jc,
21)||!A.a.YQ(Za)||(Jc=[],zc=this.fc.lXm,Jc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",zc)),zc=Ee.oWl(zc),Jc.push(appChrome.actions.setControlLabel("LearningForSearch",zc)),appChrome.api.dispatch(Jc),Za=new y.a("LearningForSearch",22,Za.Dg,null,1),Jc=new z.a(21),Jc.Jw(Za),$b.Tu(Jc));Hb.resultsUpdated($b)}static oWl(Za){const Hb=[];Array.add(Hb,new ug.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Hb,new ug.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Hb,new ug.a(600,Za));Array.add(Hb,new ug.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));Za={};Za.parts=Hb;return JSON.stringify(Za)}}Object(m.a)(Ee,"LearningProvider",null,[1121]);var pf=c(603);class sj{constructor(Za,Hb){this.jWb=this.g_b=this.Ibb=this.Ood=null;this.px=!1;this.UWb=Za;this.c_j=Hb;Za&&this.RXh(Za)}sme(){this.UWb.sme()&&this.RXh(this.UWb)}getSuggestions(Za){let Hb=[];var $b=[];Za=sj.Jfn(Za);var zc="";Array.clear($b);for(let Jc=0;Jc<Za.length;Jc++){const pd=Za.charAt(Jc);
-1!==" ".indexOf(pd)?(zc.length&&Array.add($b,zc),zc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(pd)?(zc.length&&Array.add($b,zc),zc=pd,Array.add($b,zc),zc=""):zc+=pd}zc.length&&Array.add($b,zc);for(Za=0;Za<$b.length;Za++)zc=this.aPl($b[Za]),zc=this.F5k(zc),Hb=sj.qan(Hb,zc);return Hb=this.atk(Hb)}sEf(){this.px||this.sme();return this.px}GHd(Za){return this.Ood[Za.toString()]}atk(Za){for(let Hb=0;Hb<Za.length;Hb++){const $b=this.Ibb[Hb];if(Za[Hb].commandId!==this.GHd($b[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let zc;(zc=Za[Hb]).score=zc.score+$b[1]}return Za}F5k(Za){const Hb=[];for(var $b=0;$b<this.Ibb.length;$b++)Hb.push(new hd.a(this.GHd(this.Ibb[$b][0]),-5));$b=new pf.a;for(var zc=0;zc<Za.length;zc++)$b.add(this.GHd(Za[zc][0]));for(zc=0;zc<Hb.length;zc++){const pd=Hb[zc];for(let Qd=0;Qd<Za.length;Qd++){var Jc=Za[Qd];const ye=this.GHd(Jc[0]);Jc=Jc[1];if(ye===pd.commandId){pd.score=Jc;$b.remove(ye);break}}if(!$b.count)break}return Hb}aPl(Za){const Hb=1>Za.length;for(let Qd=0;2>=Qd;Qd++){const ye=this.jWb;
for(let Le in ye){var $b=ye[Le],zc=Za,Jc=Le;const Af=Jc.length+1,dc=Array((zc.length+1)*Af);for(var pd=0;pd<=zc.length;pd++)dc[pd*Af]=pd;for(pd=0;pd<=Jc.length;pd++)dc[pd]=pd;for(pd=0;pd<Jc.length;pd++)for(let of=0;of<zc.length;of++)dc[(of+1)*Af+(pd+1)]=zc.charAt(of)===Jc.charAt(pd)?dc[of*Af+pd]:Math.min(Math.min(dc[of*Af+(pd+1)]+1,dc[(of+1)*Af+pd]+1),dc[of*Af+pd]+1);zc=dc[zc.length*Af+Jc.length];if((!zc||!Hb)&&zc<=Qd)return $b}}return this.g_b}RXh(Za){this.Ood=Za.Irf();this.Ibb=Za.N7l();this.g_b=
Za.Pfm();this.jWb=Za.QZl();if(this.px=!!this.Ood&&!!this.Ibb&&!!this.jWb&&!!this.g_b)this.px=0<this.Ibb.length&&sj.vBf(this.Ibb);this.px&&(this.px=0<this.g_b.length&&sj.vBf(this.g_b));this.px&&(this.jWb=sj.Egm(this.jWb));this.px||(this.jWb=this.g_b=this.Ibb=this.Ood=null)}Tem(Za){Za=this.getSuggestions(Za);return this.$zl(Za,this.c_j)}$zl(Za,Hb){let $b=[];for(let zc=0;zc<Za.length;zc++)Za[zc].score>=Hb&&$b.push(Za[zc]);$b.sort((zc,Jc)=>zc.score<Jc.score?1:zc.score>Jc.score?-1:0);0<$b.length-10&&($b=
$b.slice(0,10));return $b}static qan(Za,Hb){if(!Za.length)return Hb;if(Za.length!==Hb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let $b=0;$b<Za.length;$b++){if(Za[$b].commandId!==Hb[$b].commandId)throw Error.create("Incorrect CommandId");let zc;(zc=Za[$b]).score=zc.score+Hb[$b].score}return Za}static Jfn(Za){return ql.a.Tg(Za)}static vBf(Za){for(let Hb=0;Hb<Za.length;Hb++)if(2!==Za[Hb].length)return!1;return!0}static Egm(Za){const Hb=
{};for(let Jc in Za){var $b=Jc,zc=Za[Jc];const pd=zc;pd.length&&sj.vBf(pd)&&(Hb[$b]=zc)}return Hb}}Object(m.a)(sj,"NaiveBayesClassifierModel",null,[]);class Nn{constructor(Za,Hb){this.ira=null;this.fc=Za;this.$wc=new sj(Hb,Za.l2l);this.fc.nzb&&(this.ira=null)}XK(){return"NBCommand"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:2}MH(Za,Hb,$b=!1,zc=e.a.tellMe,Jc=null){const pd=new n.a(Za);if((!Jc||Array.contains(Jc,0))&&!A.a.YQ(Za)){if(tf.CommandResultsUtility.QBf(Za.Dg)&&(Jc=tf.CommandResultsUtility.E5h(Za.Dg),
0<Jc.results.length)){Jc.displayName="Classifier Debug";pd.Tu(Jc);Hb.resultsUpdated(pd);return}if(!this.$wc.sEf()){if(v.TellMeActor.instance.Oe)v.TellMeActor.instance.Oe.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.fc.nzb&&this.ira&&this.ira.initialize();Jc=this.$wc.Tem(Za.Dg);tf.CommandResultsUtility.p2d(Jc,!1,"Classifier","NaiveBayesian");Jc=tf.CommandResultsUtility.gPc(Za,Jc,this.fc,this.ira,
null,null,0,1);0<Jc.results.length&&zc!==e.a.contextMenu&&(Jc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);$b||Jc.results.length||this.fc.Q_||this.fc.O6a||(Za=new y.a("lookupNoResults",14,Za.Dg,null,1),Jc.Jw(Za));0<Jc.results.length&&pd.Tu(Jc)}Hb.resultsUpdated(pd)}}Object(m.a)(Nn,"NaiveBayesCommandProvider",null,[1121]);class Sg{constructor(){this.mvb=null;this.px=!1;this.sme()}sme(){this.px||(this.mvb=window.NBCRM)&&4===this.mvb.length&&(this.px=!0);return this.px}N7l(){return this.px?
this.mvb[1]:null}Pfm(){return this.px?this.mvb[2]:null}QZl(){return this.px?this.mvb[3][0]:null}Irf(){return this.px?this.mvb[0][0]:null}}Object(m.a)(Sg,"NaiveBayesModelAdapter",null,[1144]);var Rf=c(191);class $k{constructor(Za){this.fc=Za}XK(){return"OfficeScript"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:2}MH(Za,Hb){const $b=new n.a(Za);if(!A.a.YQ(Za)){Za=Rf.d(Za.Dg);var zc=new z.a(28);zc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;zc=this.Coh(Za,$k.IOo,"OfficeScriptsUnhideAllRowsCols",
"samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,zc);zc=this.Coh(Za,$k.eHl,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,zc);$b.Tu(zc)}Hb.resultsUpdated($b)}Coh(Za,Hb,$b,zc,Jc,pd){const Qd=[];for(const ye of Hb)if(Rf.a(Za,ye)){this.fc.Vva?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel($b,Jc)),v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId($b,zc))):(Qd.push(appChrome.actions.setControlLabel($b,
Jc)),Qd.push(appChrome.actions.setButtonCommandValueId($b,zc)),appChrome.api.dispatch(Qd));pd.Jw(new y.a($b,28,null,null,1));break}return pd}}$k.IOo="unhide row rows col cols column columns".split(" ");$k.eHl=["freeze","selection","pane","panes"];Object(m.a)($k,"OfficeScriptsSamplesProvider",null,[1121]);var gi=c(74),ym=c(344),jn=c(1548),ii=c(1511),Hh=c(1547),qk=c(35),Vf=c(136),Sj=c(25);class fe{constructor(Za){this.bQ=null;this.U1=-1;this.tMf=14;this.vMf=12;this.attributes=this.QVe=this.query=null;
this.cbc=!1;this.fYb=[];this.Wf=lg.AFrameworkApplication.Ne;lg.AFrameworkApplication.K&&(this.tMf=lg.AFrameworkApplication.K.mc("TellMeMaxTermedResults",this.tMf),this.vMf=lg.AFrameworkApplication.K.mc("TellMeMaxZeroTermResults",this.vMf));this.kR=Za}get lo(){return this.fYb}get Wme(){return this.QVe}Tu(Za){let Hb=!1;for(let $b=0;$b<this.lo.length;$b++)if(30!==this.lo[$b].groupType&&this.lo[$b].groupType===Za.groupType){this.hZe(this.lo[$b],Za);Hb=!0;break}Hb||this.lo.push(Za)}hZe(Za,Hb){for(let $b=
0;$b<Hb.results.length;$b++)Za.Jw(Hb.results[$b])}n$i(Za){const Hb=[];for(const $b of this.lo)$b.groupType!==Za&&Hb.push($b);this.lo.length!==Hb.length&&(this.fYb=Hb)}tYn(Za){let Hb=null,$b=null,zc=null;for(let Jc=0;Jc<Za.length;Jc++){const pd=Za[Jc];if(pd&&pd.lo&&pd.lo.length)for(const Qd of pd.lo)if(17===Qd.groupType||18===Qd.groupType)Hb=Qd;else if(0===Qd.groupType||16===Qd.groupType)$b=Qd,zc=pd}Hb&&$b&&0<$b.results.length&&(17===Hb.groupType&&({EYe:$b,vZe:Hb}=tf.CommandResultsUtility.Frk($b,Hb,
this.kR.yO()?this.kR.yO().vOl:-.6)),zc.n$i($b.groupType))}zxo(){this.kR&&(new gi.a,this.G8c(this.kR.fLi))}KVc(Za,Hb){return this.query.Dg.length>this.kR.yO().w8l&&this.oOm(Za,Hb)||this.query.Dg.length>this.kR.yO().x8l&&this.bRm(Za,Hb)?!0:!1}bRm(Za,Hb){return Za&&Za.length&&Hb&&Hb.length?-1===Hb.toLowerCase().indexOf(Za.toLowerCase())?!1:!0:!1}oOm(Za,Hb){return Za&&Za.length&&Hb&&Hb.length?Hb.toLowerCase().startsWith(Za.toLowerCase()):!1}mAl(Za){const Hb=[];for(const $b of this.kR.yO().pP?this.Wme:
this.lo)Za.contains($b.groupType)||Hb.push($b);this.kR.yO().pP?this.QVe=Hb:this.fYb=Hb}VVo(Za,Hb){const $b=[];for(const zc of this.lo){const Jc=zc;if(13!==Jc.groupType||24!==Jc.groupType){const pd=Za[ii.a[Jc.groupType].toLowerCase()];let Qd="False";pd<Hb&&(Qd="True");Jc.displayName=Jc.displayName+" ("+Qd+": "+pd+")"}$b.push(Jc)}this.fYb=$b}G8c(Za,Hb=!1,$b=null){if(this.kR.yO().pP){if(!Hb)for(this.QVe=Array(this.lo.length),Hb=0;Hb<this.lo.length;Hb++)this.Wme[Hb]=this.lo[Hb];this.kR.kLi.G8c(this.lo,
this.Wme,this.query,Za,$b)}else{for($b=new gi.a;this.lo.length;){Hb=this.lo.pop();const zc=ii.a[Hb.groupType].toLowerCase(),Jc=Za[zc];if(Sj.c(Jc))throw Error.create("GroupId "+zc+" missed from group SortingOrder");$b.add(new ym.a(Jc,Hb))}$b.Sc((zc,Jc)=>zc.key<Jc.key?-1:1);for(Za=0;Za<$b.count;Za++)Hb=$b.J(Za).value,this.lo.push(Hb)}}Axo(){var Za=!1;let Hb=!1,$b=!1;for(let Jc=0;Jc<this.lo.length;Jc++){var zc=this.lo[Jc];const pd=zc.groupType;if(8===pd||15===pd||14===pd){zc=zc.results;for(let Qd=0;Qd<
zc.length;Qd++){if(8===pd&&this.KVc(this.query.Dg,zc[Qd].label)){Za=!0;break}if(15===pd&&this.KVc(this.query.Dg,zc[Qd].label)){Hb=!0;break}if(14===pd){if(this.KVc(this.query.Dg,zc[Qd].label)||this.KVc(this.query.Dg,zc[Qd].description)){$b=!0;break}const ye=zc[Qd].label.split(" ");for(const Le of ye)if(this.KVc(this.query.Dg,Le)){$b=!0;break}}}}}Za=this.kR.j$l(Za,Hb,$b);this.G8c(Za)}DKb(Za,Hb,$b,zc,Jc,pd){if(Jc===this.bQ){var Qd=Za.data.xe;Jc=null;try{Jc=qk.b(Qd)}catch(jj){v.TellMeActor.instance.Oe.onError("OnSuccessCallBack",
"Exception occured while deserializing ranker inference response:"+jj);return}if("RankerResults"in Jc&&Jc.RankerResults){this.NCa();var ye=Jc.RankerResults,Le=new gi.a,Af=new gi.a;Qd=0;for(var dc of ye){ye=dc.ProviderId;var of=dc.Score;Qd+=of;Le.add(new ym.a(ye,of))}Le.Sc((be,fh)=>be.value>fh.value?-1:1);of=pd?pd.Hfi:1E-6;dc={};ye={};let jj=0;for(var Mj=0;Mj<Le.count;Mj++){let be=parseInt(Le.J(Mj).key),fh=Le.J(Mj).value/Qd;1===be&&(ye.answer=jj++,ye.entity=jj++,ye.definition=jj++,ye.wolframanswer=
jj++,fh<of&&(Af.add(9),Af.add(11),Af.add(10),Af.add(12)),dc.answer=fh,dc.entity=fh,dc.definition=fh,dc.wolframanswer=fh);2===be&&(ye.assistance=jj++,fh<of&&Af.add(8),dc.assistance=fh);3===be&&(ye.classifier=jj++,ye.serviceclassifier=jj++,fh<of&&(Af.add(0),Af.add(17)),dc.classifier=fh,dc.serviceclassifier=fh);4===be&&(ye.people=jj++,fh<of&&Af.add(14),dc.people=fh);5===be&&(ye.document=jj++,fh<of&&Af.add(15),dc.document=fh);6===be&&(ye.findindocument=jj++,fh<of&&Af.add(2),dc.findindocument=fh);7===
be&&(ye.notes=jj++,fh<of&&Af.add(20),dc.notes=fh);8===be&&(ye.image=jj++,fh<of&&Af.add(19),dc.image=fh)}Le=new gi.a;Le.add("classifier");Le.add("serviceclassifier");Le.add("appsforoffice");Le.add("addin");Le.add("findindocument");Le.add("assistance");Le.add("document");Le.add("people");Le.add("answer");Le.add("wolframanswer");Le.add("definition");Le.add("entity");Le.add("image");Le.add("template");Le.add("officescript");for(Mj=0;Mj<Le.count;Mj++)Le.J(Mj)in ye||(ye[Le.J(Mj)]=jj++);ye.learning=jj++;
ye.insights=jj++;ye.actionai=jj++;ye.actionaicommand=jj++;ye.feedback=jj++;pd&&pd.pyi&&this.VVo(dc,of);pd&&pd.qyi&&this.mAl(Af);Af={};for(var bi in dc)Af[bi]=dc[bi]*Qd;this.G8c(ye,!0,Af)}if(pd.g_d&&"Intents"in Jc&&Jc.Intents){bi=Jc.Intents;for(var rl of bi)if(this.VGf(rl)&&"Serplet"===rl.GroupType&&rl.ConfidenceScore>rl.ConfidenceThreshold){bi=!1;Jc=0;if(pd.h_d){Qd=new y.a("",32);for(Af=0;Af<this.lo.length;Af++)if((Le=this.lo[Af].results)&&0<Le.length){Jc=Af;Qd=Le[0];break}2===Qd.groupType&&(bi=!0)}Qd=
new z.a(13);bi&&pd.h_d&&(Qd=new z.a(13,CommonUIStrings.l_TellMeWebTitle));Af=new y.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Dg,null,0);Le=[];dc=null;dc=A.a.nha()?A.a.LNa(this.query.Dg,1):A.a.kBb(this.query.Dg);Le.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",dc));dc=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Dg);Le.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",dc));appChrome.api.dispatch(Le);
Qd.Jw(Af);Af=[];if(bi&&pd.h_d)for(Af.push(this.lo[Jc]),Af.push(Qd),bi=Jc+1;bi<this.lo.length;bi++)(Jc=this.lo[bi].results)&&0<Jc.length&&Af.push(this.lo[bi]);else for(Af.push(Qd),bi=0;bi<this.lo.length;bi++)(Jc=this.lo[bi].results)&&0<Jc.length&&Af.push(this.lo[bi]);this.fYb=Af}}if(pd.VVc&&!pd.pP){rl=bi=-1;for(Jc=0;Jc<this.lo.length;Jc++)switch(this.lo[Jc].groupType){case 23:bi=Jc;break;case 0:case 17:case 2:-1===rl&&(rl=Jc)}if(-1!==bi){rl=-1===rl?0:bi>rl?rl+1:rl;bi=this.lo[bi];Jc=Array(this.lo.length);
Qd=0;for(Af=0;Af<Jc.length;Af++)Af===rl?Jc[Af]=bi:(23===this.lo[Qd].groupType&&Qd++,Jc[Af]=this.lo[Qd],Qd++);this.fYb=Jc}}zc.resultsUpdated(this);zc=v.TellMeActor.instance.Oe;zc.u0(Hb.length,"RankerInference",Za.data.Qe.toString(),Math.round(window.performance.now()-$b),Hh.a.nxj,!0,jn.a.yPa);this.cbc&&zc&&(Za=this.query.dnb,Hb=zc.Cgd,pd.w_d&&Za>Hb&&!pd.pP&&(zc.KKf(this.query.Dg),zc.cag(Za)))}}VGf(Za){if("GroupType"in Za&&Za.GroupType&&"ConfidenceScore"in Za&&"ConfidenceThreshold"in Za)return!0;v.TellMeActor.instance.Oe.onError("IsValidIntentGroup",
"Invalid intents found");return!1}kKb(Za,Hb,$b,zc,Jc){zc===this.bQ&&(this.NCa(),v.TellMeActor.instance.Oe.u0(Hb.length,"RankerInference",Za.data.Qe.toString(),Math.round(window.performance.now()-$b),Hh.a.nxj,!1,jn.a.yPa));Jc.resultsUpdated(this)}NCa(){-1!==this.U1&&(window.clearTimeout(this.U1),this.U1=-1)}Bxo(Za){let Hb;Hb=this.kR.yO().pP?v.TellMeActor.instance.Oe.guf(this.Wme,this.query.Dg):v.TellMeActor.instance.Oe.guf(this.lo,this.query.Dg);var $b=this.kR.yO().Gfi;""!==$b&&($b="_"+$b);let zc=
"";this.kR.yO().mZd&&(zc="RankerInference"+$b+",");this.kR.yO().g_d&&(zc+="SerpletClassifier");","===zc.charAt(zc.length-1)&&(zc=zc.substring(0,zc.length-1));$b=v.TellMeActor.instance.Oe.shi(zc);const Jc=this.bQ=Vf.a.create().toString();$b["Client-Request-Id"]=Jc;const pd=window.performance.now(),Qd=this.kR.yO()?this.kR.yO().Ifi:600;this.NCa();this.U1=window.setTimeout(()=>{if(Jc===this.bQ){this.bQ="";this.U1=-1;Za.resultsUpdated(this);const ye={};ye[a.a.provider]="Ranker";ye[a.a.TLb]=this.query.dnb;
v.TellMeActor.instance.Oe.DA(l.a.timedOut,Qd,ye)}},Qd);this.Wf.sj(v.TellMeActor.instance.Oe.thi(),2,Hb,$b,!1,0,ye=>{this.DKb(ye,this.query.Dg,pd,Za,Jc,this.kR.yO())},ye=>{this.kKb(ye,this.query.Dg,pd,Jc,Za)},null,null,!1,4E3,6E3)}jLo(){var Za=0,Hb=new gi.a,$b=this.kR.dLi,zc=this.kR.eLi;for(var Jc=0;Jc<this.lo.length;Jc++){var pd=this.lo[Jc],Qd=ii.a[pd.groupType].toLowerCase(),ye=$b[Qd];Za+=pd.results.length;pd.results.length>ye&&(Qd=zc[Qd],Sj.c(Qd)||Hb.add(new ym.a(Qd,pd)))}zc=!this.query||""===this.query.Dg.trim();
Jc=Za-(zc?this.vMf:this.tMf);if(!(0>=Jc)){zc=window.performance.now();Za=Za.toString()+" total,"+Jc.toString()+" to remove.";if(0<Hb.count)for(Hb.Sc((Le,Af)=>Le.key>Af.key?-1:1),pd=0;pd<Hb.count&&0<Jc;pd++){Qd=Hb.J(pd).value;ye=ii.a[Qd.groupType].toLowerCase();let Le=Qd.results.length-$b[ye];Le>Jc&&(Le=Jc);0<Le&&(Qd.o5f(Le),Za+=ye+": "+Le.toString()+" results removed.",Jc-=Le)}if(0<Jc){Za+=Jc.toString()+" results left after trimming.";Hb=new gi.a;$b=this.kR.iLi;for(pd=0;pd<this.lo.length;pd++)Qd=
this.lo[pd],ye=$b[ii.a[Qd.groupType].toLowerCase()],Sj.c(ye)||Hb.add(new ym.a(ye,Qd));Hb.Sc((Le,Af)=>Le.key<Af.key?-1:1);for($b=0;0<Jc;)pd=Hb.J($b++).value,Jc>=pd.results.length?(Array.remove(this.lo,pd),Za+=ii.a[pd.groupType]+": "+pd.results.length.toString()+" results force removed.",Jc-=pd.results.length):(pd.o5f(Jc),Za+=ii.a[pd.groupType]+": "+Jc.toString()+" results force removed.",Jc=0)}v.TellMeActor.instance.Oe&&(Hb={},Hb[a.a.message]=Za,v.TellMeActor.instance.Oe.DA("ShowOptimal",window.performance.now()-
zc,Hb))}}}Object(m.a)(fe,"CombineResultsUpdatedEventArgs",null,[1100]);class cj{constructor(Za,Hb,$b,zc=!1,Jc=""){this.bNe=this.DPe=!1;this.nv=Za;this.Uwb=[];this.mbh=Hb.length;this.fc=v.TellMeActor.instance.yO();this.Omd=zc;this.Mea=Jc;this.zZb={};for(Za=0;Za<Hb.length;++Za)this.zZb[Za.toString()]=$b?0:Hb[Za].cU()}jko(Za,Hb){Hb&&Hb.query&&Hb.query.dnb<v.TellMeActor.instance.Psa||(this.Uwb[Za]=Hb,this.bNe?this.DPe=!0:(!this.fc||3!==this.fc.$u||3!==this.zZb[Za.toString()]||this.mRh())&&this.YWd())}Kzn(){this.bNe=
!0}bPo(){this.bNe=!1;this.DPe&&(this.DPe=!1,this.YWd())}mRh(){if(this.Uwb.length<this.mbh)return!1;for(let Za=0;Za<this.mbh;++Za)if(!this.Uwb[Za])return!1;return!0}YWd(){var Za=this.mRh();const Hb=window.performance.now(),$b=new fe(v.TellMeActor.instance.$Wg);$b.tYn(this.Uwb);for(var zc=0;zc<this.Uwb.length;++zc){var Jc=this.Uwb[zc];if(Jc&&Jc.lo&&Jc.lo.length&&($b.query=Jc.query,Jc.attributes&&0<Jc.attributes.length&&($b.attributes=Jc.attributes),Jc&&Jc.lo&&(Za||this.sVk(zc,this.Uwb))))for(const pd of Jc.lo)$b.Tu(pd)}$b.lo&&
$b.lo.length&&($b.cbc=Za,this.fc&&this.fc.bme&&$b.jLo(),this.fc&&this.fc.FPm&&$b.query.Dg&&0<$b.query.Dg.length?$b.Axo():$b.zxo(),this.fc&&(this.fc.mZd||this.fc.g_d)&&this.Omd&&$b.query.Dg&&0<$b.query.Dg.length&&$b.cbc&&this.Mea!==e.a.contextMenu?(3===this.fc.$u&&Za||this.nv.resultsUpdated($b),$b.Bxo(this.nv)):this.nv.resultsUpdated($b),Za=v.TellMeActor.instance.Oe,$b.cbc&&Za&&(zc=$b.query.dnb,Jc=Za.Cgd,$b.query.Dg&&0<$b.query.Dg.length&&this.Omd&&this.fc.w_d&&this.Mea!==e.a.contextMenu&&zc>Jc&&!this.fc.mZd&&
!this.fc.pP&&(Za.KKf($b.query.Dg),Za.cag(zc)),Za.DA(l.a.z5n,window.performance.now()-Hb)))}sVk(Za,Hb){if(!(this.zZb&&Za.toString()in this.zZb)||Hb.length<=Za||!Hb[Za])return!1;if(!Hb[Za].lo.length)return!0;const $b=this.zZb[Za.toString()];if(0===$b)return!0;const zc=this.zZb;for(let pd in zc){var Jc=zc[pd];const Qd=Number.parseInvariant(pd);if(Qd!==Za&&Jc===$b&&!(Hb.length>Qd&&Hb[Qd]))return!1}return!0}}Object(m.a)(cj,"ResultsAggregator",null,[]);var im=c(1748);class vg{constructor(){this.mlc=this.nlc=
this.llc=this.logCount=this.logRank=this.invertedRank=0}nrk(Za,Hb){switch(Za){case 1:this.invertedRank=Hb;break;case 3:this.logRank=Hb;break;case 2:this.logCount=Hb;break;case 5:this.llc=Hb;break;case 4:this.nlc=Hb;break;case 6:this.mlc=Hb}}}Object(m.a)(vg,"CommandFeatures",null,[]);class Wf{constructor(Za){this.rUg=0;this.RAa=Za;this.sYj={}}get modelId(){return this.RAa}get featureIntercept(){return this.rUg}get tGc(){return this.sYj}lqk(Za,Hb,$b){0===Hb?this.rUg=$b:(this.tGc[Za]||(this.tGc[Za]=
new vg),this.tGc[Za].nrk(Hb,$b))}}Object(m.a)(Wf,"CoefficientsModel",null,[]);const $g=(Za,Hb)=>Math.pow(10,-Hb/(60*Math.LN10/Math.LN2*Za));class Ti{constructor(Za,Hb){this.aj=1;this.zid=new vg;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=Za?1/Za:0;this.features.logRank=2/Math.pow(2,Za);this.features.llc=$g(10,Hb);this.features.nlc=$g(2,Hb);this.features.mlc=$g(1,Hb)}get count(){return this.aj}get features(){return this.zid}npi(){this.aj=this.count+1;this.features.logCount=
1+Math.log(this.count)/Math.LN2}JVo(Za){const Hb=2/Math.pow(2,Za);this.features.invertedRank=Math.max(this.features.invertedRank,Za?1/Za:0);this.features.logRank=Math.max(this.features.logRank,Hb)}fXo(Za){const Hb=$g(10,Za),$b=$g(2,Za);Za=$g(1,Za);this.features.llc=Math.max(this.features.llc,Hb);this.features.nlc=Math.max(this.features.nlc,$b);this.features.mlc=Math.max(this.features.mlc,Za)}}Object(m.a)(Ti,"CommandModel",null,[]);class Rm{constructor(Za){this.Opc=null;if(!Za&&v.TellMeActor.instance.Oe)v.TellMeActor.instance.Oe.onError("PredictionEngine",
"IModelAdapter can't be null");this.UWb=Za;this.Nod=this.KJf()}KJf(){const Za=this.UWb.I1l(),Hb=this.UWb.Irf();if(void 0===Za||null===Za||void 0===Hb||null===Hb)return!1;try{window.performance.now();this.Opc={};for(let $b=0;$b<Za.length;$b++){const zc=Za[$b],Jc=Hb[zc[0].toString()].trim(),pd=zc[1],Qd=0!==pd?Hb[zc[2].toString()].trim():"",ye=zc[3];Jc in this.Opc||(this.Opc[Jc]=new Wf(Jc));this.Opc[Jc].lqk(Qd,pd,ye)}}catch($b){if(v.TellMeActor.instance.Oe)v.TellMeActor.instance.Oe.onError("LoadModelData",
"Error Loading Suggestions Model: "+$b);return!1}return!0}bIl(){const Za=this.UWb.gZl(),Hb={};if(!Za)return Hb;let $b=1;for(let zc=0;zc<Za.length;zc++){const Jc=Za[zc];Jc.Id in Hb?(Hb[Jc.Id].npi(),Hb[Jc.Id].JVo($b),Hb[Jc.Id].fXo(Jc.TimeElapsedSinceClick)):Hb[Jc.Id]=new Ti($b,Jc.TimeElapsedSinceClick);$b++}return Hb}sEf(){this.Nod||(this.Nod=this.KJf());return this.Nod}a7l(){let Za=[];if(!this.Nod){if(v.TellMeActor.instance.Oe)v.TellMeActor.instance.Oe.onError("GetPredictedCommands","IModelAdapter returned no data");
return Za}const Hb=this.bIl(),$b=this.Opc;for(let Jc in $b){const pd=$b[Jc],Qd=pd.modelId;let ye=0;for(let Le in Hb){var zc=Le;const Af=Hb[Le].features;(zc=zc in pd.tGc?pd.tGc[zc]:null)&&(ye+=Af.invertedRank*zc.invertedRank+Af.logRank*zc.logRank+Af.logCount*zc.logCount+Af.llc*zc.llc+Af.nlc*zc.nlc+Af.mlc*zc.mlc)}ye+=pd.featureIntercept;Za.push(new hd.a(Qd,ye))}Za.sort((Jc,pd)=>Jc.score<pd.score?1:Jc.score>pd.score?-1:0);0<Za.length-10&&(Za=Za.slice(0,10));return Za}}Object(m.a)(Rm,"PredictionEngine",
null,[]);class Rd{constructor(){this.qeh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}eOd(Za,
Hb){return Hb&&"word"===Hb.application.toLowerCase()&&Za in this.qeh?this.qeh[Za]:[]}}Object(m.a)(Rd,"SuggestionResultsUtility",null,[]);class Mo{constructor(Za,Hb,$b){this.fc=Hb;this.$wc=new Rm(Za);this.A2=$b;this.hhh=new Rd}XK(){return"Suggestion"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:2}MH(Za,Hb,$b,zc=e.a.tellMe,Jc=null){$b=new n.a(Za);v.TellMeActor.instance.obd=!1;if((!Jc||Array.contains(Jc,16))&&A.a.YQ(Za)){if(!this.$wc.sEf()){if(v.TellMeActor.instance.Oe)v.TellMeActor.instance.Oe.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.a_d()&&0<this.hhh.eOd(v.TellMeActor.instance.qHd,this.fc).length){const Qd=this.hhh.eOd(v.TellMeActor.instance.qHd,this.fc);Jc=[];for(var pd of Qd)this.fc.Ohe&&"Find"===pd||Jc.push(new hd.a(pd,0));v.TellMeActor.instance.obd=!0}else Jc=this.$wc.a7l();tf.CommandResultsUtility.p2d(Jc,!0,"Recommended","LRE");pd=[];for(const Qd of Jc)this.A2&&this.A2.g9e(Qd.commandId)||
pd.push(Qd);Za=tf.CommandResultsUtility.gPc(Za,pd,this.fc,null,null,null,16,1);0<Za.results.length&&zc!==e.a.contextMenu&&(Za.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<Za.results.length&&$b.Tu(Za)}Hb.resultsUpdated($b)}a_d(){return!!this.fc&&(this.fc.a_d||this.fc.PTm)}}Object(m.a)(Mo,"SuggestionResultsProvider",null,[1121]);class Bd{gZl(){return v.TellMeActor.instance.sve}I1l(){return window.TellMeSuggestionModel}Irf(){return window.CoefficientModelIdMap}}Object(m.a)(Bd,"SuggestionsModelAdapter",
null,[1143]);var ll=c(1761),$f=c(1716);c.d(M,"AggregatorResultsProvider",function(){return mg});class mg{constructor(Za=!1){this.UXb={};this.UXb[e.a.tellMe]=[];this.UXb[e.a.contextMenu]=[];this.Omd=Za}cDi(Za,Hb,$b,zc,Jc=null){let pd;var Qd=!1;switch(zc){case e.a.contextMenu:pd=this.UXb[e.a.contextMenu];Qd=!0;break;default:pd=this.UXb[e.a.tellMe]}Hb=new cj(Hb,pd,Qd,this.Omd,zc);Hb.Kzn();for(let ye=0;ye<pd.length;++ye){const Le=window.performance.now(),Af=new I(Hb,ye);(Qd=v.TellMeActor.instance.yO())&&
Qd.NKk?window.setTimeout(()=>{pd[ye].MH(Za,Af,$b,zc,Jc);if(v.TellMeActor.instance.Oe){const dc={};dc[a.a.provider]=pd[ye].XK();dc[a.a.TLb]=Za.dnb;v.TellMeActor.instance.Oe.DA(l.a.MH,window.performance.now()-Le,dc)}},0):(pd[ye].MH(Za,Af,$b,zc,Jc),v.TellMeActor.instance.Oe&&(Qd={},Qd[a.a.provider]=pd[ye].XK(),Qd[a.a.TLb]=Za.dnb,v.TellMeActor.instance.Oe.DA(l.a.MH,window.performance.now()-Le,Qd)))}Hb.bPo()}XK(){return"Aggregator"}cU(){return 0}MH(Za,Hb,$b=!1,zc=e.a.tellMe,Jc=null){if(v.TellMeActor.instance.hcn)this.cDi(Za,
Hb,$b,zc,Jc);else{const pd=window.performance.now();v.TellMeActor.instance.H0o.then(()=>{v.TellMeActor.instance.Oe&&v.TellMeActor.instance.Oe.DA(l.a.icn,window.performance.now()-pd);this.cDi(Za,Hb,$b,zc,Jc);return!0})}}JE(Za,Hb){this.UXb[Hb].push(Za)}csk(Za){switch(Za){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Hb=this.UXb[e.a.tellMe];for(const $b of Hb)if("FindInDocument"===$b.XK()){$b.tio(Za);break}}}static createInstance(Za,Hb,$b,zc){const Jc=
Hb.Yfa;var pd=zc&&A.a.Qcg(Hb),Qd=pd&&Hb.BWf&&!Jc;const ye=Hb.CGf&&!A.a.wbc()&&!Jc,Le=Hb.GEf&&!Jc,Af=new mg(pd);if(Hb.Dro&&!Jc){var dc=new Ee(Hb);Af.JE(dc,e.a.tellMe)}dc=Hb.Yq?lg.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):lg.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const of=!dc&&lg.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");Af.JE(new Rj.a(Za,Hb.cNo,of,!1),e.a.tellMe);dc&&!Jc&&Af.JE(new Mo(new Bd,Hb,Za),e.a.tellMe);Za=lg.AFrameworkApplication.ta.Nb.LBi?
new Nn(Hb,new Sg):new Bn(Hb,$b);Af.JE(Za,e.a.contextMenu);(pd&&Hb.CWf||Qd)&&Af.JE(ll.a.NMh(Hb,!0),e.a.tellMe);Af.JE(Za,e.a.tellMe);!Hb.CZh||Jc||"Word"===Hb.application&&Hb.RLd||Af.JE(new Cg(Hb),e.a.tellMe);Hb.nzb&&!Jc&&(Qd=new K(Hb),Af.JE(Qd,e.a.tellMe),Af.JE(Qd,e.a.contextMenu));!Hb.rzb||Hb.K7c||Hb.J7c||Jc||Af.JE(new J.a(Hb),e.a.tellMe);zc&&(Hb.Q_||A.a.nha())&&(Qd=new Bh(Hb),Af.JE(Qd,e.a.tellMe),Af.JE(Qd,e.a.contextMenu));pd&&Af.JE(ll.a.NMh(Hb,!1),e.a.tellMe);zc&&!Hb.Kgg&&A.a.Pcg(Hb)&&!Jc&&(Af.JE(new im.a(Hb),
e.a.tellMe),Hb.Dvj&&Af.JE(new im.a(Hb),e.a.contextMenu));ye&&Af.JE(new ge(Hb),e.a.tellMe);!Hb.qjc&&!Hb.pP||Jc||Af.JE(new yg.a(Hb),e.a.tellMe);Hb.VVc&&!Jc&&Af.JE(new $f.a(Hb),e.a.tellMe);Hb.hXd&&(pd=new G(Hb),Af.JE(pd,e.a.tellMe),Af.JE(pd,e.a.contextMenu));zc&&Hb.lXd&&!Jc&&Af.JE(new F.AddinResultsProvider(Hb),e.a.tellMe);Le&&"Excel"===Hb.application&&!Jc&&Af.JE(new $k(Hb),e.a.tellMe);return Af}}Object(m.a)(mg,"AggregatorResultsProvider",null,[1121])},1741:function(E,M,c){E=c(0);var m=c(15),e=c(6),
a=c(168),l=c(223),y=c(365),z=c(58),n=c(73),v=c(938),A=c(857),w=c(532);c(463);var G=c(1706),F=c(1707),I=c(1703),K=c(1705),J=c(1704),N=c(937),R=c(856);class O{constructor(ma,Ia,Ja){this.uHl=ma;this.gIk=Ia;this.wTk=Ja}}Object(E.a)(O,"BacktraceAndMakeUpdateHintsInput",null,[]);var L=c(1530),U;(function(ma){ma[ma.EOP=0]="EOP";ma[ma.character=1]="character";ma[ma.embeddedMarker=2]="embeddedMarker"})(U||(U={}));Object(E.b)("LCSBlockType",U);class W{toString(){return String.format("[Type: {0}]",U[this.type])}}
Object(E.a)(W,"ALCSBlock",null,[]);class X extends W{constructor(ma,Ia){super();this.Cue=Ia;this.MMe=ma}get type(){return 1}get character(){return this.Cue}get Kv(){return this.MMe}uA(ma){return 1===ma.type&&L.a.luh(ma.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(E.a)(X,"CharacterLCSBlock",W,[]);class V extends W{constructor(ma,Ia,Ja){super();this.MMe=ma;this.jXe=Ia;this.cwc=Ja}get type(){return 0}get Lc(){return this.jXe}get length(){return this.cwc}get Kv(){return this.MMe}uA(ma){return 0!==
ma.type?!1:ma.Kv===this.Kv&&ma.Lc===this.Lc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),this.Kv.toString(),this.Lc,this.length)}}Object(E.a)(V,"EOPLCSBlock",W,[]);class Z extends X{constructor(ma,Ia,Ja){super(ma,"\ufffc");this.x$j=Ia;this.ljd=Ja}get type(){return 2}get yg(){return this.x$j}get Fj(){return this.ljd}uA(ma){return 2!==ma.type?!1:ma.yg===this.yg&&this.Fj.equals(ma.Fj)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),
this.yg,this.Fj)}}Object(E.a)(Z,"EmbeddedMarkerLCSBlock",X,[]);class da{constructor(ma,Ia){this.x=ma;this.y=Ia}equals(ma){return ma.x===this.x&&ma.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(E.a)(da,"IntPair",null,[908]);var aa=c(1569),ea=c(1551),na=c(1570),pa=c(1702);c.d(M,"a",function(){return ja});class ja{constructor(ma,Ia){this.Mg=ma;this.Yd=Ia}YMh(ma,Ia,Ja,Ka,Ma,sa,xa){return this.zdl(ma,Ia,Ja,Ka,Ma,sa,xa)}zdl(ma,Ia,Ja,Ka,Ma,sa,xa){let ia;ia=null;({returnValue:ma}=this.YPd(ma,
Ia));if(!ma)return a.a.instance.Ta(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.Yd.logger.zU("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ia};({returnValue:Ja}=this.YPd(Ja,Ka));if(!Ja)return a.a.instance.Ta(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.Yd.logger.zU("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ia};this.Yd.logger.zU("GetLCSBlocksFromObject");ia=this.ydl(ma,Ja,Ma,sa,xa);return ia?{returnValue:!0,updateHints:ia}:(a.a.instance.Ta(575706451,
1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:ia})}rZh(ma,Ia,Ja,Ka){({returnValue:ma}=this.YPd(ma,Ia));if(!ma)return-1;({returnValue:Ja}=this.YPd(Ja,Ka));if(!Ja)return-1;({qcf:Ja}=this.vZh(ma,Ja));return Ja}YPd(ma,Ia){let Ja;const Ka=new l.a;Ja=new l.a;if(!ma.length)return a.a.instance.Ta(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.Yd.logger.Og(Object.assign(new aa.a,{oj:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,$hf:Ja};for(let xa=0;xa<
ma.length;xa++)if(this.Yd.runtime.QG("GetLCSBlocksFromObject: paraObjs#"+xa),393230===ma.J(xa).Pc){const ia=this.Mg.getPropertyString(ma.J(xa),m.a.mo),ha=this.Mg.getPropertyUint32(ma.J(xa),e.a.Lc);if(null==ha)return a.a.instance.Ta(594124835,1,2,"Abandoning LCS due to missing WordId"),this.Yd.logger.Og(Object.assign(new aa.a,{oj:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,$hf:Ja};let ua=this.Mg.getPropertyUint32s(ma.J(xa),m.a.zm);ua=ea.a.Rlj(ua,ia.length);const ya=this.Mg.getPropertyObjectIds(ma.J(xa),
m.a.Gn);let ra;for(ra=0;ra<ua.length-1;ra++){var Ma=Ia(ya.ag(ra)),sa=void 0;sa=Ma?(sa=this.Mg.getPropertyBool(Ma,m.a.T9))?sa:!1:!1;if(sa)Ka.add(this.Z8k(ma.J(xa).id,Ma));else for(Ma=ua.ag(ra);Ma<ua.ag(ra+1);Ma++)Ka.add(new X(ma.J(xa).id,L.a.charAt(ia,Ma)))}Ka.add(new V(ma.J(xa).id,ha,ua.J(ra)));Ja.add(Ka.length-1)}else return a.a.instance.Ta(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",ma.J(xa).Pc),this.Yd.logger.Og(Object.assign(new aa.a,{oj:"GetLCSBlocksFromObject",
eventId:"900ba"})),{returnValue:null,$hf:Ja};this.Yd.runtime.QG("LCS: GetLCSBlocks for base");return{returnValue:Ka,$hf:Ja}}Z8k(ma,Ia){const Ja=null==this.Mg.getPropertyInt32(Ia,e.a.Ys)?0:this.Mg.getPropertyInt32(Ia,e.a.Ys);return new Z(ma,Ja,Ia.id)}ydl(ma,Ia,Ja,Ka,Ma){Ka=({qcf:Ja}=this.vZh(ma,Ia,Ja,Ka,Ma)).returnValue;this.Yd.logger.zU("FindFurthestPaths");ma=new O(Ka,ma,Ia);ma=new pa.a(this.WHk(ma,Ja),1);this.Yd.logger.zU("BacktraceAndMakeUpdateHints");return ma}vZh(ma,Ia,Ja=-1,Ka=-1,Ma=-1){let sa;
if(-1===Ja||-1===Ka||-1===Ma)Ma=Ka=Ja=-1;sa=-1;const xa=new y.a;xa.Z(new da(-1,1),new da(0,-1));if(-1!==Ja){xa.Z(new da(0,0),new da(Ja,Ja));var ia=1}else ia=0,Ka=ma.length,Ma=Ia.length;for(Ja=0;ia<=ma.length+Ia.length;ia++){let ha=!1;for(let ua=-ia;ua<=ia;ua+=2){let ya,ra;ua===-ia?(ya=xa.J(new da(ia-1,ua+1)).x,ra=xa.J(new da(ia-1,ua+1)).y+1):ua===ia?(ya=xa.J(new da(ia-1,ua-1)).x+1,ra=xa.J(new da(ia-1,ua-1)).y):xa.J(new da(ia-1,ua-1)).x>=xa.J(new da(ia-1,ua+1)).x?(ya=xa.J(new da(ia-1,ua-1)).x+1,ra=
xa.J(new da(ia-1,ua-1)).y):(ya=xa.J(new da(ia-1,ua+1)).x,ra=xa.J(new da(ia-1,ua+1)).y+1);for(;ya<Ka&&ra<Ma&&ma.J(ya).uA(Ia.J(ra));)ya++,ra++;xa.Z(new da(ia,ua),new da(ya,ra));if(ya===Ka&&ra===Ma){ha=!0;sa=ia;Ja=ua;break}}if(ha)break;this.Yd.runtime.QG("LCS FindFurthestPaths")}if(Ja!==Ka-Ma)return{returnValue:null,qcf:sa};xa.Z(new da(sa,Ja),new da(Ka+1,Ma+1));a.a.instance.Ta(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",ma.length,Ia.length,
sa);return{returnValue:xa,qcf:sa}}WHk(ma,Ia){const Ja=ma.uHl,Ka=ma.gIk;ma=ma.wTk;const Ma=new l.a;let sa=Ka.length,xa=ma.length;for(;0<sa||0<xa;){var ia=sa-1,ha=xa-1;if(this.Jzn(Ja,Ia,sa,xa)){ia=ma.J(ha);if(1===ia.type||2===ia.type)this.lBm(Ma,sa,ia);else if(0===ia.type)this.KAm(Ma,sa,ia);else return a.a.instance.Ta(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",ia.type),this.Yd.logger.Og(Object.assign(new na.a,{oj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;xa--;
Ia--}else if(this.Izn(Ja,Ia,sa,xa)){ha=Ka.J(ia);if(1===ha.type||2===ha.type)this.$il(Ma,ia,ha);else if(0===ha.type)this.Fil(Ma,ia,ha);else return a.a.instance.Ta(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",ha.type),this.Yd.logger.Og(Object.assign(new na.a,{oj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;sa--;Ia--}else if(sa&&xa&&Ka.J(ia).uA(ma.J(ha)))sa--,xa--;else return a.a.instance.Ta(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.Yd.logger.Og(Object.assign(new na.a,
{oj:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.Yd.runtime.QG("LCS: CreateUpdateHintsFromLCSBlocks");return Ma}Izn(ma,Ia,Ja,Ka){Ia=new da(Ia-1,Ja-Ka-1);return ma.nb(Ia)&&ma.J(Ia).x===Ja-1&&ma.J(Ia).y===Ka}Jzn(ma,Ia,Ja,Ka){Ia=new da(Ia-1,Ja-Ka+1);return ma.nb(Ia)&&ma.J(Ia).x===Ja&&ma.J(Ia).y===Ka-1}addPara(ma,Ia,Ja,Ka,Ma,sa){var xa=null;Ja.block?xa=Ja.block.Kv:0<=Ma&&0===ma.J(Ma).type&&(xa=ma.J(Ma).Kv);Ja=ma=sa.Kv;if(Ka.y0b.contains(ma))for(Ma=0,ma=z.a.If("{00000000-0000-0000-0000-000000000000}{"+
Ma+"}");Ka.y0b.contains(ma);)Ma++,ma=z.a.If("{00000000-0000-0000-0000-000000000000}{"+Ma+"}");xa=new v.AddParagraphUpdateHint(ma,sa.Lc,xa);xa.zvn=Ja;Ia.updateHints.add(xa);Ka.Kv=ma;Ka.Lc=sa.Lc;Ka.y0b.add(ma);Ka.IRa=0}KAm(ma,Ia,Ja){Ja=new I.a(Ja.Kv,Ja.Lc);let Ka=!1;if(0<ma.length&&11===ma.ag(ma.length-1).type){const Ma=ma.ag(ma.length-1);Ma.cp===Ia&&(Ka=!0,Ma.K_.add(Ja))}Ka||(Ia=new J.a(Ia),Ia.K_.add(Ja),ma.add(Ia))}splitPara(ma,Ia,Ja,Ka,Ma,sa,xa,ia){ma=this.FBl(sa.Kv,ma,Ia,Ka);if(!ma)return!1;Ia=
new R.a(sa.Kv,sa.Lc,sa.IRa,ma.Kv,ma.Lc,xa.Kv,xa.Lc);Ja.updateHints.add(Ia);sa.Lc=ma.Lc;ma!==ia?(Ma.block=ma,Ma.Cbp=sa.IRa,Ma=new v.AddParagraphUpdateHint(ia.Kv,ia.Lc,ma.Kv),Ja.updateHints.add(Ma),sa.Kv=ia.Kv,sa.Lc=ia.Lc,sa.y0b.add(ia.Kv),sa.IRa=0):sa.y0b.add(xa.Kv);return!0}lBm(ma,Ia,Ja){var Ka=!1;if(0<ma.length&&11===ma.ag(ma.length-1).type){const Ma=ma.ag(ma.length-1);Ma.cp===Ia&&((Ka=Object(n.a)(K.a,Ma.K_.J(Ma.K_.length-1)))?Ka.text=Ja.character.toString()+Ka.text:Ma.K_.add(new K.a(Ja.Kv,Ja.character.toString())),
Ka=!0)}Ka||(Ia=new J.a(Ia),Ia.K_.add(new K.a(Ja.Kv,Ja.character.toString())),ma.add(Ia))}deletePara(ma,Ia,Ja,Ka,Ma,sa){let xa=-1;for(let ia=0;ia<Ma.length;ia++)if(Ma.J(ia)===sa){0<ia&&(xa=ia-1);break}sa=null;0<=xa&&(sa=Ka.J(Ma.J(xa)));Ka=new A.a(Ja.Kv,Ja.Lc,sa?sa.Kv:null);ma.updateHints.add(Ka);sa&&Ia.Kv.equals(Ja.Kv)&&(Ia.IRa=sa.length,Ia.Kv=sa.Kv,Ia.Lc=sa.Lc);Ia.y0b.remove(Ja.Kv)}Fil(ma,Ia,Ja){Ia=new G.a(Ia,Ja.Kv,Ja.Lc);ma.add(Ia)}mergePara(ma,Ia,Ja){ma.updateHints.add(new N.MergeParagraphUpdateHint(Ja.Kv,
Ja.Lc,Ja.length,Ia.Kv,Ia.Lc,Ja.Kv,Ia.Lc));Ia.IRa=Ja.length;Ia.y0b.remove(Ia.Kv);Ia.Kv=Ja.Kv}deleteText(ma,Ia,Ja){let Ka=!1;if(0<ma.updateHints.length&&2===ma.updateHints.ag(ma.updateHints.length-1).type){const Ma=ma.updateHints.ag(ma.updateHints.length-1);Ma.zg.equals(Ia.Kv)&&Ma.cp===Ia.IRa&&(Ma.cp=Ia.IRa-1,Ma.text=Ja.character.toString()+Ma.text,Ka=!0)}Ka||ma.updateHints.add(new w.DeleteTextUpdateHint(Ia.Kv,Ia.IRa-1,Ja.character.toString()));--Ia.IRa}$il(ma,Ia,Ja){let Ka=!1;if(0<ma.length&&8===ma.ag(ma.length-
1).type){const Ma=ma.ag(ma.length-1);Ma.cp===Ia+1&&(Ma.text=Ja.character.toString()+Ma.text,--Ma.cp,Ka=!0)}Ka||ma.add(new F.a(Ia,Ja.character.toString()))}FBl(ma,Ia,Ja,Ka){for(;0<=Ka;){var Ma=Ia.J(Ja.J(Ka));if(0!==Ma.type)break;if(Ma.Kv.equals(ma))return Ma;Ka--}return null}}Object(E.a)(ja,"LCSUpdateHintGenerator",null,[])},1747:function(E,M,c){c.r(M);E=c(0);var m=c(15),e=c(6),a=c(168),l=c(365),y=c(602),z=c(223),n=c(58),v=c(55),A=c(1518);class w extends A.a{constructor(){super()}get gga(){return"ChildNodeListMerge"}}
Object(E.a)(w,"ChildNodeListMergeFailureDetail",A.a,[]);class G{Wpb(da,aa,ea){return aa.jz(da,ea.J(da))}nBj(da,aa,ea,na){let pa;return({value:pa}=aa.Dc(da)).returnValue||({value:pa}=ea.Dc(da)).returnValue?pa:na.J(da)}}Object(E.a)(G,"ChildNodeListMergeUtils",null,[1863]);var F=c(1545),I=c(1760),K=c(1617);class J{constructor(da,aa){this.classId=da;this.ENo=aa}}Object(E.a)(J,"NodeChildrenTransformation",null,[]);var N=c(798),R=c(1535);class O{constructor(da,aa,ea){this.ME=da;this.Pqa=ea;this.V7=aa}qae(da){let aa,
ea;return({H3i:aa}=this.sBj(this.Pqa,da)).returnValue&&aa.YX||({H3i:ea}=this.sBj(this.V7,da)).returnValue&&ea.YX}sBj(da,aa){let ea;return{returnValue:({value:ea}=(new R.a(this.ME,da)).Fpa.Dc(N.a.yb(aa))).returnValue,H3i:ea}}}Object(E.a)(O,"NodeTriplet",null,[]);var L=c(1701);class U{constructor(da,aa,ea){this.Yd=da;this.Mg=aa;this.V6=ea;this.chh=!0}get hq(){return this.Yd}get Zd(){return this.Mg}get lza(){return this.V6}get success(){return this.chh}k6l(){a.a.instance.Ta(4220310,1,5,"Evaluating ParentObjects");
const da=new l.a;this.w4e(da,aa=>this.hq.runtime.tk.J(aa));this.w4e(da,aa=>this.lza.Wpb(aa,this.hq.runtime.xu,this.hq.runtime.tk));this.w4e(da,aa=>this.lza.Wpb(aa,this.hq.runtime.Hq,this.hq.runtime.tk));return da}w4e(da,aa){const ea=aa(c(1747).ChildNodeListMerge.U8d);this.Zd.getPropertyObjectIds(ea,m.a.ff).forEach(na=>{this.Zd.getPropertyObjectIds(aa(na),m.a.ff).forEach(pa=>{da.nb(pa)&&!na.equals(da.J(pa))&&(this.chh=!1,a.a.instance.Ta(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",
pa,na,da.J(pa)));da.Z(pa,na);return!0});return!0})}}Object(E.a)(U,"OutlineGroupParentFinder",null,[]);var W=c(1519),X=c(1571),V=c(1618);c.d(M,"ChildNodeListMerge",function(){return Z});class Z{constructor(da,aa=null,ea=null,na=null,pa=null){this.Mg=da;this.Xxn=aa||I.a.NBj;this.i5d=ea||this.n3l();this.lza=na||new G;this.cNi=pa||this.l1l()}get Zd(){return this.Mg}n3l(){return[new J(393227,Object(v.a)(this,this.Hwn,"pageContentNodeThreewayChildMerge")),new J(1073872968,Object(v.a)(this,this.H4o,"wordSectionNodeThreewayChildMerge")),
new J(393241,Object(v.a)(this,this.L8d,"outlineElementContainerThreewayChildMerge")),new J(393252,Object(v.a)(this,this.fEo,"tableCellThreewayChildMergev2")),new J(1074135125,Object(v.a)(this,this.L8d,"outlineElementContainerThreewayChildMerge")),new J(1074135123,Object(v.a)(this,this.L8d,"outlineElementContainerThreewayChildMerge")),new J(1074135127,Object(v.a)(this,this.L8d,"outlineElementContainerThreewayChildMerge"))]}l1l(){return[Object(v.a)(this,this.jEn,"prepareObjectGroupings"),Object(v.a)(this,
this.Ilm,"handleInterOutlineGroupMerge"),Object(v.a)(this,this.mAn,"performThreewayChildMerge")]}oan(da){let aa=0;for(;aa<this.cNi.length;aa++)if(!(0,this.cNi[aa])(da))return a.a.instance.Ta(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",aa),da.logger.y2d("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",aa),!1;return!0}jEn(da){const aa=new l.a,ea=new l.a,na=new y.a;da.runtime.xu.forEach((pa,ja)=>Z.s_i(ja,aa));da.runtime.Hq.forEach((pa,ja)=>Z.s_i(ja,ea));for(let pa=0;pa<this.i5d.length;pa++){const ja=
this.i5d[pa].classId;da.runtime.zlb.Z(ja,new l.a);aa.nb(ja)&&aa.J(ja).forEach(ma=>{var Ia=da.runtime.tk.J(ma.id);Ia&&(Ia=new O(Ia,ma,da.runtime.Hq.jz(ma.id,Ia)),da.runtime.zlb.J(ja).add(ma.id,Ia),na.add(ma.id));return!0});ea.nb(ja)&&ea.J(ja).forEach(ma=>{if(na.contains(ma.id))return!0;const Ia=da.runtime.tk.J(ma.id);Ia&&da.runtime.zlb.J(ja).add(ma.id,new O(Ia,Ia,ma));return!0})}da.runtime.QG("PrepareObjectGroupings");da.logger.Bha("PrepareObjectGroupings");return!0}mAn(da){let aa=!0;for(let ea=0;aa&&
ea<this.i5d.length;ea++){const na=this.i5d[ea];da.runtime.QG("Before function#"+ea);const pa=na.classId;da.runtime.zlb.J(pa).forEach((ja,ma)=>{da.runtime.mNa.contains(ma.ME.id)||(aa=na.ENo(da,ma)&&aa);aa||(a.a.instance.Ta(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",pa,ma.ME.id),da.logger.Og(Object.assign(new w,{oj:"PerformThreewayChildMerge",eventId:"aqtsr"})));return aa});da.runtime.QG("PerformThreewayChildMerge"+ea)}da.logger.Bha("PerformThreewayChildMerge");
return aa}Hwn(da,aa){if(aa.qae(m.a.ff)){var ea=this.Zd.getPropertyObjectIds(aa.ME,m.a.ff);const na=this.Zd.getPropertyObjectIds(aa.V7,m.a.ff);aa=this.Zd.getPropertyObjectIds(aa.Pqa,m.a.ff);ea=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",ea.length,na.length,aa.length,da.input.source);a.a.instance.Ta(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",ea);da.logger.Og(Object.assign(new w,{oj:"PageContentNodeThreewayChildMerge",
eventId:"apybx",info:ea}));return!1}return!0}H4o(da,aa){if(aa.qae(m.a.ff)){const Ja=new y.a,Ka=new y.a,Ma=new y.a,sa=new y.a;var ea=this.Zd.getPropertyObjectIds(aa.ME,m.a.ff),na=ea.SG(),pa,ja=({xJh:pa}=this.MIj(aa.V7,na,Ja,"Favored")).returnValue,ma=({xJh:Ia}=this.MIj(aa.Pqa,na,Ka,"Unfavored")).returnValue;if(!ja||!ma)return ea=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",
na.count,Ja.count,Ka.count,pa,Ia),da.logger.Og(Object.assign(new w,{oj:"WordSectionNodeThreewayChildMerge",info:ea})),!1;ea.forEach(xa=>{Ja.contains(xa)||Ma.add(xa);Ka.contains(xa)||sa.add(xa);return!0});aa=aa.ME.AK();na=new z.a;for(pa=0;pa<ea.length;pa++){var Ia=ea.ag(pa);if(Ma.contains(Ia)||sa.contains(Ia)){if(da.runtime.mNa.add(Ia),na.length&&(ja=na.ag(na.length-1),ja=da.runtime.zlb.J(393241).J(ja),ma=da.runtime.zlb.J(393241).J(Ia),ja&&ma))Ma.contains(Ia)?sa.contains(Ia)||(ja.ME=ja.ME.AK(),ja.Pqa=
ja.Pqa.AK(),this.rAd(ja.ME,ma.ME),this.rAd(ja.Pqa,ma.Pqa)):(ja.ME=ja.ME.AK(),ja.V7=ja.V7.AK(),this.rAd(ja.ME,ma.ME),this.rAd(ja.V7,ma.V7))}else na.add(Ia)}this.Zd.setPropertyObjectIds(aa,m.a.ff,na);ea=new W.a(aa);ea.pC(m.a.ff);da.runtime.an.Z(aa.id,ea)}return!0}rAd(da,aa){const ea=this.Zd.getPropertyObjectIds(da,m.a.ff);aa=this.Zd.getPropertyObjectIds(aa,m.a.ff);const na=ea.f5();aa.forEach(pa=>{na.add(pa);return!0});this.Zd.setPropertyObjectIds(da,m.a.ff,na)}MIj(da,aa,ea,na){let pa=0,ja=!0;this.Zd.getPropertyObjectIds(da,
m.a.ff).forEach(ma=>{aa.contains(ma)?ea.add(ma):(ja=!1,a.a.instance.Ta(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",na,ma),pa++);return!0});return{returnValue:ja,xJh:pa}}Ilm(da){let aa=!0;da.runtime.zlb.J(393241).forEach((ea,na)=>{if(this.XKm(na)){a.a.instance.Ta(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",na.ME.id);let pa;const ja=new U(da,this.Zd,this.lza);if(({EYi:ea,xKj:pa}=this.ZLo(da,ja.k6l(),na)).returnValue)return a.a.instance.Ta(4220303,1,
4,"Merging WordSection {0} as a unit.",pa),aa=ja.success&&this.hbn(da,pa,ea)&&aa,aa||(a.a.instance.Ta(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",na.ME.id,ja.success),da.logger.Og(Object.assign(new w,{oj:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",ja.success)}))),aa}return!0});return aa}XKm(da){if(!da.qae(m.a.ff))return!1;const aa=this.Zd.getPropertyObjectIds(da.ME,m.a.ff).J(0),
ea=this.Zd.getPropertyObjectIds(da.V7,m.a.ff);da=this.Zd.getPropertyObjectIds(da.Pqa,m.a.ff);return!ea.contains(aa,(na,pa)=>na.equals(pa))||!da.contains(aa,(na,pa)=>na.equals(pa))}ZLo(da,aa,ea){aa=aa.J(ea.ME.id);a.a.instance.Ta(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",ea.ME.id,aa);if(da.runtime.mNa.contains(aa))return a.a.instance.Ta(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",
aa),{returnValue:!1,EYi:null,xKj:aa};const na=new L.a;ea=da.runtime.tk.J(aa);this.Zd.getPropertyObjectIds(ea,m.a.ff).forEach(pa=>{na.qAd(pa);return!0});ea=this.lza.Wpb(aa,da.runtime.xu,da.runtime.tk);this.Zd.getPropertyObjectIds(ea,m.a.ff).forEach(pa=>{na.sAd(pa);return!0});da=this.lza.Wpb(aa,da.runtime.Hq,da.runtime.tk);this.Zd.getPropertyObjectIds(da,m.a.ff).forEach(pa=>{na.wAd(pa);return!0});return{returnValue:!0,EYi:na,xKj:aa}}n_f(da,aa,ea,na,pa){let ja=!0;da.forEach(ma=>{const Ia=aa(ma);this.Zd.getPropertyObjectIds(Ia,
m.a.ff).forEach(Ja=>{ea.add(Ja);if(na.nb(Ja))return(ja=na.J(Ja).equals(ma)&&ja)||a.a.instance.Ta(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",pa,Ja,ma,na.J(Ja)),ja;na.Z(Ja,ma);return!0});return!0});return ja}B4l(da,aa){let ea,na,pa,ja;ea=new z.a;na=new z.a;pa=new z.a;ja=new l.a;const ma=da.runtime.tk;return this.n_f(aa.vzb,Ia=>ma.J(Ia),ea,ja,"Base")&&this.n_f(aa.gjf,Ia=>this.lza.Wpb(Ia,da.runtime.xu,ma),na,ja,"Favored")&&
this.n_f(aa.Zpb,Ia=>this.lza.Wpb(Ia,da.runtime.Hq,ma),pa,ja,"Unfavored")?{returnValue:!0,Ovh:ea,kYh:na,ICj:pa,gRi:ja}:{returnValue:!1,Ovh:ea,kYh:na,ICj:pa,gRi:ja}}CCl(da,aa,ea,na){let pa=!0;const ja=da.runtime.tk,ma=da.runtime.xu,Ia=da.runtime.Hq,Ja=da.runtime.an,Ka=new z.a,Ma=new l.a;ea.forEach(sa=>{const xa=na.J(sa);if(!xa)return a.a.instance.Ta(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",sa),da.logger.Og(Object.assign(new w,{oj:"FinishInterOutlineGroupMerge",
eventId:"aqgws"})),pa=!1;xa.equals(Ka.last())||(Ka.add(xa),Ma.add(xa,new z.a));Ma.J(xa).add(sa);da.runtime.mNa.add(sa);return!0});if(!pa)return!1;Ma.forEach((sa,xa)=>{const ia=this.lza.nBj(sa,ma,Ia,ja).AK();this.Zd.setPropertyObjectIds(ia,m.a.ff,xa);Ja.Z(sa,new W.a(ia));Ja.J(sa).pC(m.a.ff);da.runtime.mNa.add(sa);return pa});ea=this.lza.nBj(aa,ma,Ia,ja).AK();this.Zd.setPropertyObjectIds(ea,m.a.ff,Ka);Ja.Z(aa,new W.a(ea));Ja.J(aa).pC(m.a.ff);da.runtime.mNa.add(aa);return pa}hbn(da,aa,ea){let na,pa;
if(!({Ovh:ja,kYh:na,ICj:pa,gRi:ea}=this.B4l(da,ea)).returnValue)return!1;var ja=F.b(ja,na,pa);ja=this.WWf(da,ja);return!!ja&&this.CCl(da,aa,ja,ea)}L8d(da,aa){return this.AYi(da,aa)}AYi(da,aa){if(aa.qae(m.a.ff)){var ea=this.x4l(aa);ea=this.WWf(da,ea);if(!ea)return a.a.instance.Ta(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",aa.ME.id),da.logger.Og(Object.assign(new w,
{oj:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),K.a(aa.ME,"OutlineElementContainerThreewayChildMerge_Base",1),K.a(aa.V7,"OutlineElementContainerThreewayChildMerge_Favored",1),K.a(aa.Pqa,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var na=this.Zd.getPropertyObjectIds(aa.ME,m.a.ff);const pa=ea.SG();na.forEach(ja=>{pa.contains(ja)||(ja=this.Zd.getPropertyObjectIds(aa.ME,m.a.FK),0<ja.length&&da.runtime.HXf.add(ja.J(0)));return!0});na=aa.V7.AK();this.Zd.setPropertyObjectIds(na,
m.a.ff,ea);da.runtime.an.Z(na.id,new W.a(na));da.runtime.an.J(na.id).pC(m.a.ff)}return!0}RHb(da){if(!da)return a.a.instance.Ta(573957964,1,2,"Feature helper is null"),!1;da.pz(106);return da.isFeatureEnabled(106)}fEo(da,aa){if(!this.RHb(da.runtime.Xb))return this.zhg(da,aa);var ea=aa.ME.id,na=V.e(da,aa.ME,null);if(na.equals(n.a.nil))return a.a.instance.Ta(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",ea),da.logger.Og(Object.assign(new X.a,{info:"Table node ID could not be found for table cell"})),
!1;var pa=da.runtime.EAb.J(na);if(pa&&(pa=pa.J(ea)))if(pa.gg)aa=aa.V7.AK(),aa.removeProperty(m.a.ff),this.Zd.setPropertyBool(aa,e.a.ghostCell,!0),null!=pa.colSpan?this.Zd.setPropertyUint32(aa,e.a.colSpan,pa.colSpan):aa.removeProperty(e.a.colSpan),da.runtime.an.Z(aa.id,new W.a(aa)),da.runtime.an.J(aa.id).pC(m.a.ff),da.runtime.an.J(aa.id).pC(e.a.ghostCell),da.runtime.an.J(aa.id).pC(e.a.colSpan);else{let ja,ma;({lBd:na,rLd:ja,Qme:ma}=this.l0l(da,aa,pa,na));if(!ja.length&&!ma.length)return a.a.instance.Ta(573957966,
1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",ea),da.logger.Og(Object.assign(new X.a,{info:"A non-ghost cell does not have OE nodes on either side"})),!1;ja.length?ma.length?(ea=F.b(na,ja,ma),ea=this.WWf(da,ea)):ea=ja:ea=ma;if(!ea)return a.a.instance.Ta(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",aa.ME.id),da.logger.Og(Object.assign(new w,
{oj:"TableCellThreewayChildMergev2",eventId:"8n426"})),K.a(aa.ME,"TableCellThreewayChildMergev2_Base",1),K.a(aa.V7,"TableCellThreewayChildMergev2_Favored",1),K.a(aa.Pqa,"TableCellThreewayChildMergev2_Unfavored",1),!1;aa=aa.V7.AK();this.Zd.setPropertyObjectIds(aa,m.a.ff,ea);aa.removeProperty(e.a.ghostCell);ea=pa.rowSpan;pa=pa.colSpan;null!=ea&&null!=pa&&(1<ea||1<pa)?(this.Zd.setPropertyUint32(aa,e.a.rowSpan,ea),this.Zd.setPropertyUint32(aa,e.a.colSpan,pa)):(aa.removeProperty(e.a.rowSpan),aa.removeProperty(e.a.colSpan));
da.runtime.an.Z(aa.id,new W.a(aa));da.runtime.an.J(aa.id).pC(m.a.ff);da.runtime.an.J(aa.id).pC(e.a.ghostCell);da.runtime.an.J(aa.id).pC(e.a.rowSpan);da.runtime.an.J(aa.id).pC(e.a.colSpan)}else return this.zhg(da,aa);da.logger.Bha("TableCellThreewayChildMergev2");return!0}l0l(da,aa,ea,na){let pa,ja;({lBd:aa,rLd:pa,Qme:ja}=this.C7h(aa));aa||(aa=new z.a);pa||(pa=new z.a);ja||(ja=new z.a);var ma=aa.SG(),Ia=pa.SG(),Ja=ja.SG(),Ka=ea.J5d;if(Ka)for(var Ma=0;Ma<Ka.length;Ma++){var sa=Ka.J(Ma),xa=da.runtime.tk.J(sa);
!ma.contains(sa)&&xa&&(ma.add(sa),aa.add(sa));!Ia.contains(sa)&&da.runtime.xu.jz(sa,xa)&&(Ia.add(sa),pa.add(sa));!Ja.contains(sa)&&da.runtime.Hq.jz(sa,xa)&&(Ja.add(sa),ja.add(sa))}da.logger.Bha("OENodesAddedToChildrenList");if(Ka=ea.Fvf)for(Ma=0;Ma<Ka.length;Ma++)if(sa=Ka.J(Ma),xa=da.runtime.tk.J(sa)){var ia=this.Zd.getPropertyObjectIds(xa,m.a.ff);if(ia)for(var ha=0;ha<ia.length;ha++){var ua=ia.J(ha);ma.contains(ua)||(ma.add(ua),aa.add(ua))}ia=da.runtime.xu.jz(sa,xa);if(ia=this.Zd.getPropertyObjectIds(ia,
m.a.ff))for(ha=0;ha<ia.length;ha++)ua=ia.J(ha),Ia.contains(ua)||(Ia.add(ua),pa.add(ua));sa=da.runtime.Hq.jz(sa,xa);if(sa=this.Zd.getPropertyObjectIds(sa,m.a.ff))for(xa=0;xa<sa.length;xa++)ia=sa.J(xa),Ja.contains(ia)||(Ja.add(ia),ja.add(ia))}da.logger.Bha("GhostCellOENodesAddedToChildrenList");if(ea=ea.aRf)for(ma=0;ma<ea.length;ma++)if(Ia=ea.J(ma),Ia=da.runtime.EAb.J(na).J(Ia))if(Ia=Ia.J5d){Ia=Ia.SG();Ja=new z.a;for(Ka=0;Ka<aa.length;Ka++)Ia.contains(aa.J(Ka))||Ja.add(aa.J(Ka));aa=Ja;Ja=new z.a;for(Ka=
0;Ka<pa.length;Ka++)Ia.contains(pa.J(Ka))||Ja.add(pa.J(Ka));pa=Ja;Ja=new z.a;for(Ka=0;Ka<ja.length;Ka++)Ia.contains(ja.J(Ka))||Ja.add(ja.J(Ka));ja=Ja}da.logger.Bha("NonGhostCellsOENodesRemovedFromChildrenList");return{lBd:aa,rLd:pa,Qme:ja}}zhg(da,aa){let ea=aa.V7.hasProperty(m.a.ff),na=aa.Pqa.hasProperty(m.a.ff);ea&&(ea=!!this.Zd.getPropertyObjectIds(aa.V7,m.a.ff).length);na&&(na=!!this.Zd.getPropertyObjectIds(aa.Pqa,m.a.ff).length);if(ea!==na)if(this.ARm(da.runtime.Xb))da.logger.hIi(Object.assign(new X.a,
{info:"TableCell OE missing children, ghost cell likely touched"}));else return da.logger.Og(Object.assign(new X.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.AYi(da,aa)}x4l(da){let aa,ea;({lBd:da,rLd:aa,Qme:ea}=this.C7h(da));return F.b(da,aa,ea)}WWf(da,aa){a.a.instance.Ta(4220309,1,5,"Considering {0} OutlineElement collections for merge.",aa.length);const ea=new z.a;let na=!0;aa.forEach(pa=>{if(!pa)return a.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),
da.logger.Og(Object.assign(new w,{oj:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),na=!1;if(1===pa.Vbn&&1===pa.clb){const ia=pa.vzb.J(0),ha=pa.gjf.J(0),ua=pa.Zpb.J(0);if(ia&&ia.equals(ha)&&ia.equals(ua))return ea.add(ia),!0;if(1!==aa.length)return a.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",ia,ha,ua,aa.length),
da.logger.Og(Object.assign(new w,{oj:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),na=!1}const ja=new l.a,ma=new z.a,Ia=new z.a,Ja=new z.a,Ka=new z.a,Ma=new z.a,sa=new z.a,xa=da.runtime.tk;pa.vzb.forEach(ia=>na=this.j0f(da,ia,ha=>xa.J(ha),ma,Ka,ja,"Base"));if(!na)return a.a.instance.Ta(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),da.logger.Og(Object.assign(new w,{oj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),
!1;pa.gjf.forEach(ia=>na=this.j0f(da,ia,ha=>this.lza.Wpb(ha,da.runtime.xu,xa),Ia,Ma,ja,"Favored"));if(!na)return a.a.instance.Ta(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),da.logger.Og(Object.assign(new w,{oj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;pa.Zpb.forEach(ia=>na=this.j0f(da,ia,ha=>this.lza.Wpb(ha,da.runtime.Hq,xa),Ja,sa,ja,"Unfavored"));if(!na)return a.a.instance.Ta(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),
da.logger.Og(Object.assign(new w,{oj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;da.runtime.Xb&&da.runtime.Xb.Zhb(1000005)&&(Ma.length&&this.wyl(Ma,da.runtime.xu)?(this.Zoh(Ma,da,ea,ja),this.rzd(da,ja,sa)):this.Zoh(sa,da,ea,ja));if(ma.length){pa=null;if(!({an:pa}=this.Xxn(da,ma,Ia,Ja,pa)).returnValue||!pa)return na=!1;pa.forEach(ia=>{0<ia.WZb.count&&da.runtime.an.Z(ia.vm.id,ia);ea.add(ja.J(ia.vm.id));return!0})}return!0});return na?ea:null}wyl(da,aa){for(let ea=0;ea<da.length;ea++)if(aa.get(da.ag(ea).id))return!0;
return!1}rzd(da,aa,ea){ea.length&&(ea.forEach(na=>{da.runtime.Rjc.add(na.id);da.runtime.Rjc.add(aa.J(na.id));return!0}),I.a.rzd(da,this.Zd,ea.J(0)))}Zoh(da,aa,ea,na){da.forEach(pa=>{const ja=new W.a(pa.AK());aa.runtime.an.Z(pa.id,ja);ea.add(na.J(pa.id));return!0})}j0f(da,aa,ea,na,pa,ja,ma){var Ia=ea(aa);if(!Ia)return a.a.instance.Ta(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",ma,aa),da.logger.Og(Object.assign(new w,{oj:"ProcessOutlineElement",eventId:"aqwkb",
info:String.format("[Revision: {0}] Failed to find OutlineElement",ma)})),!1;const Ja=this.Zd.getPropertyObjectIds(Ia,m.a.FK);if(!Ja||!Ja.length)return a.a.instance.Ta(4285058,1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",ma,aa),da.logger.Og(Object.assign(new w,{oj:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",ma)})),K.a(Ia,"ProcessOutlineElement_"+ma,1),!1;Ia=Ja.ag(0);ea=ea(Ia);if(!ea)return a.a.instance.Ta(4285059,
1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",ma,Ia,aa),da.logger.Og(Object.assign(new w,{oj:"ProcessOutlineElement",eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",ma)})),!1;if((ma=this.Zd.getPropertyString(ea,e.a.gN))&&""!==ma&&da.runtime.Xb&&(da.runtime.Xb.gTd(1000005),da.runtime.Xb.Zhb(1000005)))return pa.add(ea),ja.add(Ia,aa),da.runtime.mNa.add(Ia),!0;na.add(ea);
ja.add(Ia,aa);da.runtime.mNa.add(Ia);return!0}C7h(da){let aa,ea;aa=this.Zd.getPropertyObjectIds(da.ME,m.a.ff);ea=this.Zd.getPropertyObjectIds(da.V7,m.a.ff);da=this.Zd.getPropertyObjectIds(da.Pqa,m.a.ff);return{lBd:aa,rLd:ea,Qme:da}}ARm(da){if(!da)return a.a.instance.Ta(51422868,1,2,"Feature Helper is null"),!1;da.pz(105);return da.isFeatureEnabled(105)}static s_i(da,aa){aa.nb(da.Pc)||aa.Z(da.Pc,new z.a);aa.J(da.Pc).add(da);return!0}}Z.U8d=n.a.If("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(E.a)(Z,
"ChildNodeListMerge",null,[1772])},1748:function(E,M,c){E=c(0);var m=c(1483),e=c(1611),a=c(1531),l=c(1501),y=c(1692),z=c(1548);class n{constructor(aa,ea){this.DimensionValue=this.DimensionName=null;this.DimensionName=aa;this.DimensionValue=ea}}Object(E.a)(n,"Dimension",null,[]);class v{constructor(aa,ea,na,pa,ja){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=aa;this.Query=ea;this.From=na;this.Size=pa;ja&&(this.Filter=ja)}}Object(E.a)(v,"EntityRequest",null,
[]);class A{constructor(aa){this.QueryString=null;this.QueryString=aa}}Object(E.a)(A,"Query",null,[]);var w=c(1484);class G{constructor(aa,ea){this.Dimensions=this.Name=null;this.Name=aa;this.Dimensions=ea}}Object(E.a)(G,"Scenario",null,[]);var F=c(1488),I=c(1487);class K{constructor(aa,ea,na,pa){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=aa;this.TimeZone=ea;this.Cvid=na;this.Scenario=pa}}Object(E.a)(K,"SubstrateBody",null,[]);var J=c(1547),N=c(1481),R=c(1480),
O=c(2),L=c(1685),U=c(1684),W=c(1517),X=c(35),V=c(19),Z=c(136);c.d(M,"a",function(){return da});class da{constructor(aa){this.Wxc=this.gcb=this.mpd=this.Nsc=this.Iyc=0;this.C7g=this.dah=this.bQ=null;this.ZHe=0;this.U1=-1;this.sBc="";this.kBe=!1;this.Wf=O.AFrameworkApplication.Ne;this.fc=aa;this.lvd=this.huf();this.cxb=new e.a;this.T5g=this.fc.bme?3:2;this.hUe=this.fc.bme&&this.fc.prj?5:3;this.yXe=this.fc.Ohe?2:3;this.Clh=1;this.qod=this.fc.Pbi;this.lgh=this.fc.KQm;this.Hzc=aa.Xfi;O.AFrameworkApplication.K&&
(this.dah=O.AFrameworkApplication.K.jb("AppCatalogUrl")+O.AFrameworkApplication.K.jb("SearchPersonaPhotoBaseUrl"),this.kBe=this.fc.Yfa||this.fc.PJd);this.fc.Yfa&&(this.yXe=this.hUe=5)}XK(){return"Substrate"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:3}MH(aa,ea,na,pa=m.a.tellMe,ja=null){const ma=new I.a(aa);if(!ja||Array.contains(ja,14)||Array.contains(ja,15)||Array.contains(ja,20))if(!this.ZHe||window.performance.now()-this.ZHe>=R.a.p7a)if(na=this.cxb.Agi())this.ZHe=window.performance.now(),na.then(Ia=>
{Ia&&""!==Ia?(this.sBc=Ia,""!==this.bQ&&this.zgi(aa,pa,this.sBc,ea,ja)):(N.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),ea.resultsUpdated(ma))},Ia=>{N.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+Ia);ea.resultsUpdated(ma)});else{if(N.TellMeActor.instance.Oe)N.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");ea.resultsUpdated(ma)}else this.sBc&&
""!==this.sBc?this.zgi(aa,pa,this.sBc,ea,ja):(ea.resultsUpdated(ma),N.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else ea.resultsUpdated(ma)}L5a(){this.gcb=this.Wxc=this.mpd=this.Nsc=this.Iyc=0}zgi(aa,ea,na,pa,ja){this.L5a();const ma=new I.a(aa),Ia=this.bQ=Z.a.create().toString();this.NCa();this.U1=window.setTimeout(()=>{if(Ia===this.bQ){this.bQ="";this.U1=-1;pa.resultsUpdated(ma);const Ma={};Ma[a.a.provider]=this.XK();Ma[a.a.TLb]=aa.dnb;N.TellMeActor.instance.Oe.DA(l.a.timedOut,
this.Hzc,Ma)}},this.Hzc);const Ja={"Content-Type":"application/json",Accept:"application/json"};Ja.Authorization="Bearer "+na;Ja["X-Office-Version"]=O.AFrameworkApplication.buildVersion;Ja["X-Office-Application"]=O.AFrameworkApplication.K.jb("Application");Ja["X-Office-Platform"]="WAC";Ja["X-TellMe-SessionId"]=N.TellMeActor.instance.rSd();Ja["X-TellMe-Culture"]=O.AFrameworkApplication.uiCulture;Ja["X-TellMe-ProcessSessionId"]=O.AFrameworkApplication.userSessionId;Ja["Client-Request-Id"]=Ia;const Ka=
window.performance.now();this.Wf.sj(this.lcm(),2,this.mcm(aa.Dg,this.fc.application,N.TellMeActor.instance.rSd(),R.a.YQ(aa)),Ja,!1,0,Ma=>{this.DKb(Ma,aa,pa,Ia,Ka,ea,ja)},Ma=>{this.kKb(Ma,aa,pa,Ia,Ka)},null,null,!1,4E3,6E3)}NCa(){-1!==this.U1&&(window.clearTimeout(this.U1),this.U1=-1)}DKb(aa,ea,na,pa,ja,ma,Ia){N.TellMeActor.instance.Oe.u0(ea.Dg.length,this.lvd.join(","),aa.data.Qe.toString(),Math.round(window.performance.now()-ja),J.a.substrate,!0,z.a.yPa);const Ja=R.a.YQ(ea),Ka=new I.a(ea);if(pa===
this.bQ){this.NCa();aa=X.b(aa.data.xe);if(aa.Groups){aa=aa.Groups;for(const Ma of aa)"People"===Ma.Type&&this.fc.R9c&&(Ia?Array.contains(Ia,14):1)?(aa=this.edi(Ma.Suggestions,Ja,ma),0<aa.results.length&&Ka.Tu(aa)):"File"===Ma.Type&&this.fc.P9c&&(Ia?Array.contains(Ia,15):1)?(aa=this.Lpf(Ma.Suggestions,Ja,ma),0<aa.results.length&&(this.CYd()&&(pa=new w.a("GenerateSlidesFromTellMe",30,"",null,1),aa.Jw(pa)),Ka.Tu(aa))):"Notes"===Ma.Type&&this.fc.hkb&&ma!==m.a.contextMenu&&(Ia?Array.contains(Ia,20):1)&&
(aa=this.Lbi(Ma.Suggestions,Ja,ea),0<aa.results.length&&Ka.Tu(aa))}na.resultsUpdated(Ka);N.TellMeActor.instance.Oe.u0(ea.Dg.length,this.lvd.join(","),"",Math.round(window.performance.now()-ja),"",!0,z.a.provider)}else na.resultsUpdated(Ka)}Lbi(aa,ea,na){const pa=new F.a(20);pa.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const ja of aa)this.$Sm(ja)&&(aa=ja.NotesType,aa=V.a.Tg(aa),aa=this.B3l(aa,ja.LastModifiedTime,ja.BodyPreview,ja.Subject,ea,na,ja))&&(aa.groupType=20,pa.Jw(aa));return pa}edi(aa,
ea,na){const pa=new F.a(14);pa.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const ma of aa)if(this.aTm(ma)){var ja=ma.Id.split("@")[0];aa=ma.EmailAddresses[0];let Ia=ma.Type;if(void 0===Ia||null===Ia)Ia="User";if(ja=this.y6l(Ia,ma.DisplayName,ma.JobTitle,aa,ja,na,ea))ja.description=aa,aa=ma.JobTitle,"Department"in ma&&"CompanyName"in ma&&(aa+="@"+ma.Department+"@"+ma.CompanyName),ja.GI=aa,pa.Jw(ja)}return pa}Lpf(aa,ea,na){const pa=new F.a(15);pa.displayName=CommonUIStrings.l_TellMeFileProviderTitle;
for(const Ma of aa)if(this.QSm(Ma)){var ja=Ma.FileName;aa=Ma.FileExtension;var ma=ja;ja.length>aa.length&&ma.endsWith(aa)&&(ma=ja.substr(0,ja.length-aa.length-1));var Ia=void 0,Ja=0;"DateCreated"in Ma&&Ma.DateCreated?(Ja=R.a.Ouf(Ma.DateCreated),Ia=R.a.Qhi(Ma.DateCreated),Ia=String.format(CommonUIStrings.l_CreatedTimeFormatString,Ma.Author,Ia)):Ia=Ma.Author;var Ka=Ma.AccessUrl+"?web=1";const sa=V.a.y9b(Ka);ja=String.format('<a href="{0}">{1}</a>',sa,V.a.MX(ja));if(na!==m.a.contextMenu||V.a.uU(Ka))if(ma=
this.PUl(ma,na===m.a.contextMenu?ja:Ka,Ia,Ma.FileExtension,Ma.Text,ea))ma.description=Ma.Author,ma.Wzd=Ja,pa.Jw(ma),this.kBe&&(Ja=Ma.AccessUrl,ja=R.a.cPd(aa),Ia=Ma.DateModified?Ma.DateModified:Ma.DateCreated,Ka=Ma.Size?Ma.Size:Ma.FileSize,this.xqo()&&(Ja=Ja.replace(RegExp("%20","g")," "),ja=R.a.jbm(aa)),aa=new y.a(ja,Ja,Ma.SPWebUrl,Ma.Id,Ka,Ia),N.TellMeActor.instance.$lg(!1,ma.value,aa))}return pa}kKb(aa,ea,na,pa,ja){pa===this.bQ&&(this.NCa(),N.TellMeActor.instance.Oe.u0(ea.Dg.length,this.lvd.join(","),
aa.data.Qe.toString(),Math.round(window.performance.now()-ja),J.a.substrate,!1,z.a.yPa));aa=new I.a(ea);na.resultsUpdated(aa)}y6l(aa,ea,na,pa,ja,ma,Ia){Ia=Ia?this.Clh:this.T5g;if(!window.LPC&&!R.a.vCf()||this.Iyc===Ia)return null;this.Iyc+=1;Ia="PeopleSuggestion"+this.Iyc.toString();var Ja=this.dah+"?size=1&accountName="+pa;aa=Object.assign(new L.a,{PersonaType:aa,Smtp:pa,ProfilePictureUrl:Ja,AadObjectId:ja});const Ka=Object.assign(new U.a,{identifiers:aa,displayName:ea});aa=ma===m.a.contextMenu;
this.fc.Vva?(N.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(Ia,Ka,ea,na)),ma===m.a.contextMenu&&(na=R.a.uMh(ea,pa,ja),N.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ia,na))),N.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ia,aa))):(Ja=[],Ja.push(appChrome.actions.setPersonaButtonCoauthor(Ia,Ka,ea,na)),ma===m.a.contextMenu&&(na=R.a.uMh(ea,pa,ja),Ja.push(appChrome.actions.setButtonCommandValueId(Ia,
na))),Ja.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ia,aa)),appChrome.api.dispatch(Ja));return new w.a(Ia,11,ea,pa,0)}B3l(aa,ea,na,pa,ja,ma,Ia){if(ja&&!this.fc.PBi||this.mpd===this.qod||this.Wxc===this.qod||this.gcb===this.qod)return null;var Ja=null;this.mpd+=1;ja="";const Ka=[],Ma={};Ia.type="Notes";this.C7g=Object.assign(new W.a,{landingTab:"Notes",data:Ia});ma=R.a.LNa(ma.Dg,33,this.C7g);if("onenotepagepreviews"===aa){if(!("ClickthroughUrl"in Ia&&Ia.ClickthroughUrl)||""===
Ia.ClickthroughUrl)return null;this.Wxc+=1;ja="OnenoteNotesSuggestion"+this.Wxc.toString();Ma["default"]="SaveAsonetoc2_20";Ja=Ia.ClickthroughUrl;Ka.push(appChrome.actions.setControlIconSet(ja,Ma));Ka.push(appChrome.actions.setCompoundButtonCommandValueId(ja,Ja));Ja=new w.a(ja,19,null,null,0)}else if("stickynote"===aa){if(!this.lgh)return null;this.gcb+=1;ja="NotesSuggestion"+this.gcb.toString();Ma["default"]="ShowAllNotes_20";Ka.push(appChrome.actions.setControlIconSet(ja,Ma));Ka.push(appChrome.actions.setCompoundButtonCommandValueId(ja,
ma));Ja=new w.a(ja,21,null,null,0)}else if("samsung"===aa){if(!this.lgh)return null;this.gcb+=1;ja="NotesSuggestion"+this.gcb.toString();Ma["default"]="CategoryCollapsed_20";Ka.push(appChrome.actions.setControlIconSet(ja,Ma));Ka.push(appChrome.actions.setCompoundButtonCommandValueId(ja,ma));Ja=new w.a(ja,20,null,null,0)}""!==ja&&(aa=R.a.Qhi(ea),aa=String.format(CommonUIStrings.l_LastModifiedString,aa),Ja.label=pa,Ja.Wzd=R.a.Ouf(ea),Ka.push(appChrome.actions.setControlLabel(ja,pa)),Ka.push(appChrome.actions.updateCompoundButtonDescription(ja,
aa)),Ka.push(appChrome.actions.setControlCustomTooltip(ja,na)),appChrome.api.dispatch(Ka));return Ja}PUl(aa,ea,na,pa,ja,ma){if(this.Nsc===(ma?this.yXe:this.hUe)||this.kBe&&"Word"!==R.a.cPd(pa))return null;this.Nsc+=1;ma="FileSuggestion"+this.Nsc.toString();const Ia=[],Ja={};Ja["default"]=R.a.aYl(pa);this.fc.Vva?(N.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ma,aa)),N.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(ma,Ja)),N.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ma,
na)),N.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ma,ea)),N.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(ma,ja))):(Ia.push(appChrome.actions.setControlLabel(ma,aa)),Ia.push(appChrome.actions.setControlIconSet(ma,Ja)),Ia.push(appChrome.actions.updateCompoundButtonDescription(ma,na)),Ia.push(appChrome.actions.setCompoundButtonCommandValueId(ma,ea)),Ia.push(appChrome.actions.setControlCustomTooltip(ma,ja)),appChrome.api.dispatch(Ia));
return new w.a(ma,6,aa,na,0)}huf(){const aa=[];this.fc.R9c&&Array.add(aa,"People");this.fc.P9c&&Array.add(aa,"File");this.fc.hkb&&Array.add(aa,"Notes");return aa}mcm(aa,ea,na,pa){var ja=new A(aa);aa=new v("File",ja,0,pa?this.yXe:this.hUe,null);pa=new v("People",ja,0,pa?this.Clh:this.T5g,R.a.Xzn);ja=new v("Notes",ja,0,this.qod,null);this.fc.PJd&&"powerpoint"===ea.toLowerCase()&&(ea="word");ea=new n("app",ea.toLowerCase());var ma=[];Array.add(ma,ea);ea=new G("tellmesearch",ma);ma=[];this.fc.P9c&&Array.add(ma,
aa);this.fc.R9c&&Array.add(ma,pa);this.fc.hkb&&Array.add(ma,ja);na=new K(ma,"UTC",na,ea);return X.c(na)}lcm(){let aa=this.fc.nCo;this.fc.hkb&&(aa+="?&setflight=NotesFrom3S");""!==this.fc.Bgi&&(aa=aa+"&"+this.fc.Bgi);return aa}aTm(aa){return"DisplayName"in aa&&"Id"in aa&&"EmailAddresses"in aa&&!!aa.Id&&!!aa.EmailAddresses}QSm(aa){return"FileExtension"in aa&&!!aa.FileExtension&&"FileName"in aa&&!!aa.FileName&&""!==aa.FileName&&"AccessUrl"in aa&&!!aa.AccessUrl&&""!==aa.AccessUrl}$Sm(aa){return"Id"in
aa&&!!aa.Id&&"NotesType"in aa&&!!aa.NotesType&&"Subject"in aa&&!!aa.Subject&&""!==aa.Subject}CYd(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}xqo(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(E.a)(da,"SubstrateResultsProvider",null,[1121])},1749:function(E,M,c){E=c(0);var m=c(41),
e=c(6),a=c(15),l=c(168),y=c(83),z=c(182),n=c(223),v=c(602),A=c(58),w=c(365),G=c(2),F=c(1438),I=c(954);class K{constructor(ma,Ia=0){this.iaf=null;this.mYf=0;this.GM=ma;this.Nan=Ia}}Object(E.a)(K,"GraphMergerResponse",null,[]);var J=c(55),N=c(1),R=c(119),O=c(869),L=c(1518),U=c(1568);class W extends U.a{constructor(){super();this.Ktj=null;this.IJj=!1}get gga(){return"Crash"}UDb(){this.detail.Z("Type",this.gga);this.detail.Z("Trace",this.wLo(this.Ktj));this.detail.Z("Continue",this.IJj);return this.detail}wLo(ma){ma=
ma.split("\n");const Ia=4<ma.length?4:ma.length,Ja=new Sys.StringBuilder;for(let Ka=0;Ka<Ia;Ka++)Ka===Ia-1?Ja.append(String.format("{0}...",ma[Ka])):Ja.append(String.format("{0}\n",ma[Ka]));return Ja.toString()}}Object(E.a)(W,"CrashMergeFailureDetail",U.a,[]);var X=c(1936),V=c(1535),Z=c(1630),da=c(1519);class aa{constructor(){this.TJk=new w.a;this.A0k=new w.a;this.U3k=new w.a}}Object(E.a)(aa,"RangeMarkers",null,[]);class ea{constructor(){this.colSpan=this.rowSpan=null;this.gg=!1;this.HBe=new n.a;
this.GKe=new n.a;this.$Ke=new n.a}get Fvf(){return this.HBe.f5()}set Fvf(ma){ma||(this.HBe=new n.a);this.HBe=ma.f5()}get aRf(){return this.GKe.f5()}set aRf(ma){ma||(this.GKe=new n.a);this.GKe=ma.f5()}get J5d(){return this.$Ke.f5()}set J5d(ma){ma||(this.$Ke=new n.a);this.$Ke=ma.f5()}}Object(E.a)(ea,"TableCellStructureInfo",null,[]);var na=c(1571),pa=c(1618);c.d(M,"a",function(){return ja});class ja{constructor(){this.fTd=0;this.TWg=this.Q$a=this.SWb=this.Mg=this.bdh=this.hYb=null;this.R5g=0;this.z2g=
50;this.qUg=this.cOg=null}get hee(){return this.hYb}get A6n(){return this.bdh}get Zd(){return this.Mg}get elb(){return this.SWb}get bki(){return this.Q$a}get ijm(){return this.TWg}get ndc(){return this.R5g}get aDh(){return this.cOg}get qLc(){return this.qUg}udc(ma,Ia,Ja,Ka,Ma,sa,xa){Ja=this.fal(ma,Ia,Ka,Ma,sa,xa,this.qLc);Ka=0;const ia=Ja.runtime.She;let ha=null;try{this.U2m(ia,Ja,xa,ma,Ia,Ma,sa);for(ma=1;Ka<this.elb.length;Ka++)if(!(0,this.elb[Ka])(Ja)){ma=2;Ja.logger.y2d("GraphMerger.GetMergeFunctions()",
Ka);break}return ha=new K(Ja.output.GM,ma)}catch(ua){const ya=!Ja.output.timeout;Ja.output.crash=ya;const ra=this.VOd(ua),La=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",ya?"Crashed":"Timed Out",Ja.input.rJb,!!Ja.output.GM,ra);ya?(l.a.instance.Ta(4051608,1,1,"MergeChanges Crash. [Error: {0}]",La),Ja.logger.Og(Object.assign(new W,{Ktj:ra,IJj:!!Ja.output.GM}))):l.a.instance.Ta(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",La);if(Ja.output.GM)return ha=new K(Ja.output.GM,
2);throw ua;}finally{Ja.output.succeeded?this.R2m(ia,Ja,Ka):Ja.output.timeout?this.T2m(Ja,Ka):Ja.output.crash?Ja.output.GM?this.S2m(Ja,Ka):this.Q2m(Ja,Ka):this.P2m(Ja,Ka);Ja.logger.O2m();l.a.instance.nja(42350232,1,Ja.output.succeeded?4:2,"MergeLogger",Ja.logger.o1l());Ja.logger.qYc.Xli()&&l.a.instance.nja(559015903,1,2,"MarkerInfo",Ja.logger.qYc.toString());if(Ja.runtime.Xb&&Ja.runtime.Xb.isFeatureEnabled(74))try{this.y_m(Ja)}catch(ua){l.a.instance.Ta(571619421,1,4,"Error logging references: {0}",
ua.toString())}this.z4m(Ja);ha.mYf|=(Ja.output.succeeded?2:1)<<2*(xa-1);if(ha)try{ha.iaf=this.QDn(Ja)}catch(ua){l.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",ua)}}}z4m(ma){if(!ma.output.succeeded){ma=ma.output.timeout?"Timeout":ma.logger.R3i?ma.logger.R3i.gga:"Unknown";const Ia=new R.a;y.Health.instance.recordQosError(ma,["MergeFailure"],!0,!0,!1,!1,Ia)}}y_m(ma){const Ia=Ma=>{const sa=this.eEa()-ma.input.sTa>this.ndc;if(0<this.ndc&&sa)throw l.a.instance.Ta(571619422,
1,2,"Timed out while calculating added and deleted nodes: {0}",Ma),z.a.invalidOperation(Ma);};let Ja=ma.runtime.xu.keys,Ka=Ma=>ma.runtime.xu.J(Ma);this.aKf(ma,Ia,Ja,Ka,"Favored");Ja=ma.runtime.Hq.keys;Ka=Ma=>ma.runtime.Hq.J(Ma);this.aKf(ma,Ia,Ja,Ka,"Unfavored");Ja=ma.runtime.an.keys;Ka=Ma=>{const sa=ma.runtime.an.J(Ma);return sa?sa.vm:ma.runtime.xu.J(Ma)};this.aKf(ma,Ia,Ja,Ka,"Merged")}aKf(ma,Ia,Ja,Ka,Ma){var sa=new n.a;const xa=new n.a;for(let ia=0;ia<Ja.length;ia++){Ia("LogAddedAndDeletedNodes");
const ha=Ka(Ja.J(ia));if(4325465===ha.Pc)continue;const ua=ma.runtime.tk.J(ha.id);ua&&this.z_m(sa,xa,ha,ua)}this.fJi(xa,ia=>ma.runtime.tk.J(ia),Ia);this.fJi(sa,Ka,Ia);Ia=new Sys.StringBuilder;for(Ja=0;Ja<sa.length;Ja++)Ia.append(sa.J(Ja).toString()+",");sa=new Sys.StringBuilder;for(Ja=0;Ja<xa.length;Ja++)sa.append(xa.J(Ja).toString()+",");l.a.instance.nja(571619423,1,4,Ma+" revision: Added references",Ia.toString());l.a.instance.nja(571619424,1,4,Ma+" revision: Deleted references",sa.toString())}z_m(ma,
Ia,Ja,Ka){const Ma=Ja.Jl();for(let xa=0;xa<Ma.length;xa++){const ia=Ma[xa];if(this.Dti(ia)){var sa=this.Zd.getPropertyObjectIds(Ja,ia);this.I1m(ma,Ia,Ka,ia,sa)}else this.Myi(ia)&&(sa=this.Zd.getPropertyObjectId(Ja,ia),this.H1m(ma,Ia,Ka,ia,sa))}}fJi(ma,Ia,Ja){Ja("LogNestedReferences");Ja=new n.a;const Ka=new v.a;for(let Ma=0;Ma<ma.length;Ma++){const sa=ma.J(Ma);this.EKf(sa,Ja,Ka,Ia)}for(Ia=0;Ia<Ja.length;Ia++)ma.add(Ja.J(Ia))}EKf(ma,Ia,Ja,Ka){const Ma=Ka(ma);if(Ma){const xa=Ma.Jl();for(let ia=0;ia<
xa.length;ia++){var sa=xa[ia];if(this.Dti(sa)){sa=this.Zd.getPropertyObjectIds(Ma,sa);for(let ha=0;ha<sa.length;ha++)Ja.contains(sa.J(ha))||(Ia.add(sa.J(ha)),Ja.add(sa.J(ha)),this.EKf(sa.J(ha),Ia,Ja,Ka))}else this.Myi(sa)&&(sa=this.Zd.getPropertyObjectId(Ma,sa),Ja.contains(sa)||(Ia.add(sa),Ja.add(sa),this.EKf(ma,Ia,Ja,Ka)))}}}I1m(ma,Ia,Ja,Ka,Ma){if(this.Zd.hasProperty(Ja,Ka)){Ja=this.Zd.getPropertyObjectIds(Ja,Ka);const sa=Ja.SG();Ka=Ma.SG();for(let xa=0;xa<Ma.length;xa++)sa.contains(Ma.J(xa))||ma.add(Ma.J(xa));
for(ma=0;ma<Ja.length;ma++)Ka.contains(Ja.J(ma))||Ia.add(Ja.J(ma))}else for(Ia=0;Ia<Ma.length;Ia++)ma.add(Ma.J(Ia))}H1m(ma,Ia,Ja,Ka,Ma){Ma&&(this.Zd.hasProperty(Ja,Ka)?(Ja=this.Zd.getPropertyObjectId(Ja,Ka),Ma.equals(Ja)||(ma.add(Ma),Ia.add(Ja))):ma.add(Ma))}N2m(ma){l.a.instance.Ta(4535064,1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",ma.input.rJb,ma.output.crash,ma.output.timeout)}U2m(ma,Ia,Ja,Ka,Ma,sa,xa){if(ma){ma=Ka.length?Ka.ag(Ka.length-1):null;var ia=Ma.length?Ma.ag(Ma.length-
1):null;Ja=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",Ia.input.rJb,Ka.length,ma?ma.id:A.a.nil,ma?ma.OW?ma.OW.id:A.a.nil:A.a.nil,Ma.length,ia?ia.id:A.a.nil,ia?ia.OW?ia.OW.id:A.a.nil:A.a.nil,sa,xa,this.ndc,Ja);switch(Ia.input.source){case 5:l.a.instance.Ta(51663493,1,4,Ja);break;default:l.a.instance.Ta(4051606,
1,4,Ja)}}}R2m(ma,Ia,Ja){if(ma)switch(ma=this.MNc(Ia,Ja,"Succeeded"),Ia.input.source){case 5:l.a.instance.Ta(51663494,1,4,ma);break;default:l.a.instance.Ta(4059162,1,4,ma)}}T2m(ma,Ia){Ia=this.MNc(ma,Ia,"Timeout");switch(ma.input.source){case 5:l.a.instance.Ta(51663495,1,4,Ia);break;default:l.a.instance.Ta(4059163,1,2,Ia)}}P2m(ma,Ia){Ia=this.MNc(ma,Ia,"Rejection");switch(ma.input.source){case 5:l.a.instance.Ta(51663496,1,4,Ia);break;default:l.a.instance.Ta(4059164,1,2,Ia)}}S2m(ma,Ia){Ia=this.MNc(ma,
Ia,"Crash - Rejection");switch(ma.input.source){case 5:l.a.instance.Ta(51663497,1,4,Ia);break;default:l.a.instance.Ta(4059165,1,2,Ia)}}Q2m(ma,Ia){Ia=this.MNc(ma,Ia,"Crash - Failed");switch(ma.input.source){case 5:l.a.instance.Ta(51663498,1,4,Ia);break;default:l.a.instance.Ta(4059166,1,2,Ia)}}MNc(ma,Ia,Ja){const Ka=ma.output.GM,Ma=Ka&&Ka.length?Ka.ag(Ka.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",
ma.input.rJb,Ja,this.eEa()-ma.input.sTa,Ia,Ka?Ka.length:0,Ma?Ma.id:A.a.nil,Ma?Ma.OW?Ma.OW.id:A.a.nil:A.a.nil,ma.input.source)}fal(ma,Ia,Ja,Ka,Ma,sa,xa){const ia=new X.a,ha=ia.input;ha.U9=ma;ha.zUa=Ia;ha.wm=Ja;ha.Jha=Ka;ha.VFb=Ma;ha.source=sa;ha.qLc=xa;ha.sTa=this.eEa();ia.logger.mlo(ha.sTa);ma=ia.runtime;ma.S7c=l.a.instance.M9(1,5);ma.She=l.a.instance.M9(1,4);let ua="";ma.QG=ya=>{if(this.ndc){var ra=this.eEa()-ha.sTa,La=ra>this.ndc;ua+=String.format(" ({0}: {1})",ya,ra);La&&(ia.output.timeout=!0,
ya=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",ha.rJb,this.ndc,ya,ra,ua),l.a.instance.Ta(528061012,1,2,ya),this.iHo(ya))}};return ia}wOc(){return[Object(J.a)(this,this.Evn,"otherAuthorsHaveChangesToMerge"),Object(J.a)(this,this.NKm,"isInputValid"),Object(J.a)(this,this.Qxm,"initializeOutputMergeState"),Object(J.a)(this,this.jWd,"initializeRuntimeMergeState"),Z.a.wDn,Object(J.a)(this,this.vDn,"preProcessTableStructure"),
Object(J.a)(this.aDh,this.aDh.oan,"mergeChildNodeLists"),Object(J.a)(this,this.UMo,"tryObjectMerge"),Z.a.bDn,Object(J.a)(this,this.uAl,"finalizeObjectMerge"),Object(J.a)(this,this.d_o,"validateMarkers"),Object(J.a)(this,this.fsk,"addMergeResultsToOutput")]}Evn(ma){const Ia=ma.input.U9;ma=ma.output;return Ia?Ia.length?!0:(l.a.instance.Ta(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),ma.GM=Ia,ma.succeeded=!0,!1):(l.a.instance.Ta(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),
ma.GM=Ia,ma.succeeded=!0,!1)}NKm(ma){var Ia=ma.input;const Ja=Ia.U9,Ka=Ia.zUa,Ma=Ia.wm,sa=Ia.Jha;Ia=Ia.VFb;ma=ma.output;if(!Ka||!Ka.length)return l.a.instance.Ta(42350233,1,5,"IsInputValid: No local changes to merge."),ma.GM=Ja,ma.succeeded=!0,!1;let xa=!0;if(2!==sa&&1!==sa)return ma.GM=Ja,!1;Ma&&Ma!==A.a.nil||(xa=!1);Ja.length<(Ia?2:1)&&(l.a.instance.Ta(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",
Ia),xa=!1);xa||(ma.GM=2===sa?Ja:Ka);return xa}jWd(ma){var Ia=ma.input,Ja=Ia.U9,Ka=Ia.zUa,Ma=Ia.Jha,sa;let xa;({Uig:sa,Jpg:xa,WCa:Ia}=this.arf(ma,Ja,Ka,Ia.VFb));if(!Ia)return l.a.instance.Ta(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",sa.id,xa.id),ma.logger.Og(Object.assign(new L.a,{oj:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.DJi(sa,Ja.length,"TheirChanges"),this.DJi(xa,Ka.length,
"YourChanges"),ma.output.GM=2===Ma?Ja:Ka,!1;ma.runtime.WCa=Ia;({DOo:Ja,xyl:Ka}=this.Skl(Ma,sa,xa));({EOo:Ia,yyl:Ma,jIk:sa}=this.M1l(ma,Ja,Ka,Ia));ma.runtime.tk=sa;ma.runtime.Hq=Ia;ma.runtime.xu=Ma;ma.runtime.an=new w.a;ma.runtime.sLd=Ka.id;ma.runtime.Rme=Ja.id;ma.runtime.zlb=new w.a;ma.runtime.mNa=new v.a;ma.runtime.adf=new w.a;ma.runtime.EAb=new w.a;ma.runtime.Chg=new w.a;ma.runtime.cce=new aa;ma.runtime.W3d=new n.a;ma.runtime.HXf=new v.a;ma.runtime.Rjc=new n.a;ma.runtime.Xb=ma.input.qLc(ma);ma.runtime.Xb.wDc(1000001,
"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",m.a.eGo);ma.runtime.Xb.wDc(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",m.a.jIo);ma.runtime.Xb.wDc(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",m.a.gyl);ma.runtime.Xb.wDc(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",m.a.KXn);ma.runtime.Xb.wDc(1000010,"Microsoft.Office.WordOnline.MergeLcsInfLoopFix",
"79ee6190;i588c310",m.a.Ean);ma.runtime.xqi=!0;G.AFrameworkApplication.K&&(this.z2g=G.AFrameworkApplication.K.mc("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}DJi(ma,Ia,Ja){const Ka=new n.a;for(;ma;)Ka.add(ma),ma=ma.OW;const Ma=new Sys.StringBuilder;Ma.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",Ja,Ia,Ka.length));let sa=Ka.length,xa=0;Ka.forEach(ia=>({eoi:sa,cKi:xa}=this.Stk(Ma,ia,Ka,sa,xa)).returnValue);l.a.instance.Ta(4273302,1,4,Ma.toString())}Stk(ma,
Ia,Ja,Ka,Ma){ma.append(String.format(" [{0} {1} {2}]",Ka,Ia.Kwa?"S":"B",Ia.id));Ka--;Ma++;return 50<Ma&&Ja.length!==Ma?(ma.append(" ...Truncated."),{returnValue:!1,eoi:Ka,cKi:Ma}):{returnValue:!0,eoi:Ka,cKi:Ma}}arf(ma,Ia,Ja,Ka){Ia=Ia.ag(Ia.length-1-(Ka?1:0));Ja=Ja.ag(Ja.length-1);Ka=Ia.J0a(Ja);ma.runtime.QG("GetCommonBase");ma.logger.Bha("GetCommonBase");return{Uig:Ia,Jpg:Ja,WCa:Ka}}M1l(ma,Ia,Ja,Ka){let Ma,sa;({result:Ma}=Ia.vdc(Ka));ma.runtime.QG("GetUnfavoredChanges");ma.logger.Bha("GetUnfavoredChanges");
({result:sa}=Ja.vdc(Ka));5===ma.input.source&&(ma.runtime.Byl=O.a.Cei(Ja),ma.runtime.GOo=O.a.Cei(Ia));ma.runtime.QG("GetFavoredChanges");ma.logger.Bha("GetFavoredChanges");Ia=new F.a(Object(J.a)(Ka,Ka.f1a,"getMergeableObject"));ma.runtime.QG("GetModifiedObjects");ma.logger.Bha("GetModifiedObjects");return{EOo:Ma,yyl:sa,jIk:Ia}}Skl(ma,Ia,Ja){2===ma?(ma=Ia,Ia=Ja):ma=Ja;return{DOo:Ia,xyl:ma}}Qxm(ma){const Ia=ma.input,Ja=Ia.U9,Ka=Ia.zUa;ma.output.GM=(2===Ia.Jha?Ja:Ka).f5();ma.runtime.QG("InitializeOutputMergeState");
ma.logger.Bha("InitializeOutputMergeState");return!0}fsk(ma){var Ia=ma.input.wm;const Ja=ma.runtime.an,Ka=ma.output.GM;Ia=this.gal(ma,Ka.ag(Ka.length-1),Ia,A.a.create());this.Qzl(ma,Ia,Ja);Ka.add(Ia);return ma.output.succeeded=!0}gal(ma,Ia,Ja,Ka){ma.runtime.She&&l.a.instance.Ta(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",Ja,Ka);ma=this.A6n(Ka);ma.IIk(Ia,Ja);return ma}Qzl(ma,Ia,Ja){ma.runtime.She&&l.a.instance.Ta(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",
Ja.count);Ja.forEach((Ka,Ma)=>{Ia.wtk(Ma.vm);return!0})}RHb(ma){if(!ma)return l.a.instance.Ta(573957952,1,2,"Feature helper is null"),!1;ma.pz(106);return ma.isFeatureEnabled(106)}vDn(ma){if(!this.RHb(ma.runtime.Xb))return!0;const Ia=ma.runtime.xu,Ja=ma.runtime.Hq,Ka=ma.runtime.tk;let Ma=!0;Ia.forEach((sa,xa)=>{393252===xa.Pc&&(Ma=this.y1i(ma,sa,xa,Ka,Ia));return Ma});if(!Ma)return!1;Ja.forEach((sa,xa)=>{393252===xa.Pc&&(Ma=this.y1i(ma,sa,xa,Ka,Ja));return Ma});ma.logger.Bha("PreProcessTableStructure");
return Ma}y1i(ma,Ia,Ja,Ka,Ma){const sa=null==this.Zd.getPropertyBool(Ja,e.a.ghostCell)?!1:this.Zd.getPropertyBool(Ja,e.a.ghostCell),xa=null==this.Zd.getPropertyUint32(Ja,e.a.rowSpan)?1:this.Zd.getPropertyUint32(Ja,e.a.rowSpan),ia=null==this.Zd.getPropertyUint32(Ja,e.a.colSpan)?1:this.Zd.getPropertyUint32(Ja,e.a.colSpan);if(sa)return!0;var ha=Ka.J(Ia);if(ha){Ka=null==this.Zd.getPropertyBool(ha,e.a.ghostCell)?!1:this.Zd.getPropertyBool(ha,e.a.ghostCell);var ua=null==this.Zd.getPropertyUint32(ha,e.a.rowSpan)?
1:this.Zd.getPropertyUint32(ha,e.a.rowSpan);var ya=null==this.Zd.getPropertyUint32(ha,e.a.colSpan)?1:this.Zd.getPropertyUint32(ha,e.a.colSpan);Ka=Ka!==sa;ua=ua!==xa;ya=ya!==ia}else ya=ua=Ka=!0;const ra=pa.e(ma,Ja,Ma);if(ra.equals(A.a.nil))return l.a.instance.Ta(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",Ia),ma.logger.Og(Object.assign(new na.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let La=ma.runtime.EAb.J(ra);La||(ma.runtime.EAb.Z(ra,
new w.a),La=ma.runtime.EAb.J(ra));let oa=La.J(Ia),Ca=new n.a;const Aa=new n.a,db=new n.a;Ka&&(oa||(Ca=this.Zd.getPropertyObjectIds(Ja,a.a.ff)));if(ua||ya)if(oa){if(oa.gg)return l.a.instance.Ta(573957961,1,4,"Table cell has conflicting ghostcell properties we are not handling"),ma.logger.Og(Object.assign(new na.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),!1;if(null!=oa.rowSpan&&xa!==oa.rowSpan||null!=oa.colSpan&&ia!==oa.colSpan)return l.a.instance.Ta(573957962,1,
4,"Same table cell has different rowSpan/colSpan in conflicting revisions"),ma.logger.Og(Object.assign(new na.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),!1}else{var eb;({rowIndex:Ja,E2b:eb}=pa.b(ma,Ma,Ja));if(-1===Ja||-1===eb)return l.a.instance.Ta(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",Ia),ma.logger.Og(Object.assign(new na.a,{info:"Table cell location could not be found"})),!1;for(var ib=Ja;ib<Ja+xa;ib++)for(var lb=eb;lb<
eb+ia;lb++){var Ya=pa.c(ma,ra,ib,lb);if(Ya.equals(A.a.nil))return l.a.instance.Ta(573957955,1,4,"Other revision deleted the table cells this revision is trying to merge"),ma.logger.Og(Object.assign(new na.a,{info:"Ghost cell not found in the table bounds"})),!1;var Fa=Ma.jz(Ya,ma.runtime.tk.J(Ya));if(!Fa)return l.a.instance.Ta(573957956,1,4,"Other revision has inserted cells in between the cells this revision is trying to merge"),ma.logger.Og(Object.assign(new na.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),
!1;if(!Ya.equals(Ia)){if(null==this.Zd.getPropertyBool(Fa,e.a.ghostCell)||!this.Zd.getPropertyBool(Fa,e.a.ghostCell))return l.a.instance.Ta(573957957,1,4,"Other revision deleted some of the cells this revision is trying to merge"),ma.logger.Og(Object.assign(new na.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var $a=La.J(Ya);if($a)return l.a.instance.Ta(573957958,1,4,"The ghost cell is already merged with some other cells in the other revision"),ma.logger.Og(Object.assign(new na.a,
{info:"Ghost cell is already merged with some other cell"})),!1;Aa.add(Ya);$a=new ea;$a.gg=!0;Fa=this.Zd.getPropertyUint32(Fa,e.a.colSpan);null!=Fa&&($a.colSpan=Fa);La.Z(Ya,$a)}}if(ha&&(null==this.Zd.getPropertyBool(ha,e.a.ghostCell)||!this.Zd.getPropertyBool(ha,e.a.ghostCell))&&(Ma=null==this.Zd.getPropertyUint32(ha,e.a.rowSpan)?1:this.Zd.getPropertyUint32(ha,e.a.rowSpan),Ja=null==this.Zd.getPropertyUint32(ha,e.a.colSpan)?1:this.Zd.getPropertyUint32(ha,e.a.colSpan),Ma>xa||Ja>ia)){ib=eb=-1;({rowIndex:eb,
E2b:ib}=pa.a(ma,null,ha,eb,ib));if(-1===eb||-1===ib)return l.a.instance.Ta(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",Ia),ma.logger.Og(Object.assign(new na.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;ha=Aa.SG();for(lb=eb;lb<eb+Ma;lb++)for(Ya=ib;Ya<ib+Ja;Ya++){$a=pa.d(ma,null,ra,lb,Ya);if(!$a)return l.a.instance.Ta(573957960,1,2,"Table cell could not be found within table bounds"),ma.logger.Og(Object.assign(new na.a,
{info:"Ghost cell not found in the table bounds"})),!1;$a.id.equals(Ia)||ha.contains($a.id)||db.add($a.id)}}}!oa&&(Ka||ua||ya)&&(l.a.instance.Ta(573957963,1,4,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",Ia),oa=new ea,oa.rowSpan=xa,oa.colSpan=ia,oa.gg=sa,oa.J5d=Ca,oa.Fvf=Aa,oa.aRf=db,La.add(Ia,oa));return!0}UMo(ma){return this.JBj(ma,!1)}uAl(ma){return this.JBj(ma,!0)}JBj(ma,Ia){const Ja=ma.runtime,Ka=Ja.tk,Ma=Ja.xu,sa=Ia?Ja.adf:Ja.Hq,xa=Ja.an;let ia=
!0;const ha=ma.runtime.S7c;let ua=0,ya=0,ra=0;sa.forEach((La,oa)=>{ha&&l.a.instance.Ta(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",La,oa.Pc,Ia);ya++;this.z2g===ya&&(ua++,ma.runtime.QG(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",ua,ra,Ia)),ya=0);if(ma.runtime.Xb&&ma.runtime.Xb.Zhb(1000005)&&ma.runtime.Rjc.contains(oa.id,(db,eb)=>db.equals(eb))||this.Kwo(oa.Pc))return!0;if(!Ia&&this.zhl(oa.Pc,ma.runtime.Xb))return Ja.adf.Z(La,oa),!0;var Ca=
Ma.get(La);if(!Ca)return xa.nb(La)?xa.J(La).kNi(oa):xa.Z(La,new da.a(oa,!1)),!0;if(!Ka.J(La)&&!this.gbn(Ca.Pc)){var Aa=!!ma.input.U9&&!!ma.input.U9.last()&&ma.input.U9.last().j4(La);const db=!!ma.input.zUa&&!!ma.input.zUa.last()&&ma.input.zUa.last().j4(La),eb=new V.a(Ca,oa);if(!eb.YX)return xa.Z(La,new da.a(Ca,!1)),!0;l.a.instance.Ta(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",
La,oa.Pc,Ia,Aa,db,!eb.YX,ma.input.source);ma.logger.Og(Object.assign(new L.a,{oj:"GraphMerger.TryObjectMerge",eventId:"ap3k8"}));return ia=!1}Aa=xa.jz(La,new da.a(Ka.J(La)));({Uk:Ca,returnValue:ia}=this.ijm.merge(ma,this.bki,this.Zd,Aa,Ca,oa));ra++;ia&&(ma.runtime.QG(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",La,oa.Pc,ra,ua,Ia)),Ca&&(xa.nb(Ca.vm.id)?xa.J(Ca.vm.id).kNi(Ca.vm):xa.Z(Ca.vm.id,Ca)));return ia});ma.logger.Bha("ObjectMerge");ha&&
l.a.instance.Ta(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",sa.count,ra,Ia);return ia}d_o(ma){try{for(let Ia=0;Ia<ma.runtime.W3d.length;Ia++){const Ja=ma.runtime.W3d.J(Ia);if(ma.runtime.an.J(Ja)){if(!this.XLm(ma,Ja))return!1}else l.a.instance.Ta(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");ma.runtime.QG("Validate markers taking too long")}}catch(Ia){l.a.instance.Ta(559535579,1,2,"ValidateMerge threw an exception: {0}",Ia)}return ma.logger.qYc.Xli()?
!1:!0}Sro(ma){return 38===ma||39===ma||40===ma||41===ma||44===ma||45===ma||33===ma||34===ma?!1:!0}$0l(ma){switch(ma){case 38:case 39:case 40:case 41:return e.a.le;case 44:case 45:return e.a.DBd;case 33:case 34:return e.a.Wj}return I.CommonProperties.nil}c_o(ma,Ia){const Ja=this.Zd.getPropertyUint32(ma,e.a.Ys);if(!Ja||this.Sro(Ja))return!0;ma=this.Zd.getPropertyObjectId(ma,this.$0l(Ja));return ja.t7b(Ia,ma)?!0:(Ia.logger.qYc.RWd=Ja,!1)}XLm(ma,Ia){if(ma.runtime.HXf.contains(Ia))return!1;if(Ia=ja.t7b(ma,
Ia)){Ia=this.Zd.getPropertyObjectIds(Ia,a.a.Gn);for(let Ja=0;Ja<Ia.length;Ja++){const Ka=ja.t7b(ma,Ia.ag(Ja));if(Ka&&!this.c_o(Ka,ma))return!1}}return!0}Kwo(ma){switch(ma){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}zhl(ma,Ia){let Ja=!1;if(1074135145===ma)return!0;Ia&&Ia.pz(124);Ia&&Ia.isFeatureEnabled(124)&&1074135153===ma&&(Ja=!0);return Ja}gbn(ma){switch(ma){case 1074135162:return!0}return!1}tcl(ma,Ia){const Ja=new n.a,Ka=new n.a,Ma=
new n.a;var sa=ma.runtime.WCa;const xa=sa?sa.id:A.a.nil;this.BJf(sa).forEach(ia=>{Ja.add(Ia(ia));return!0});sa=ma.input.U9.ag(ma.input.U9.length-1);this.BJf(sa,xa).forEach(ia=>{Ka.add(Ia(ia));return!0});ma=ma.input.zUa.ag(ma.input.zUa.length-1);this.BJf(ma,xa).forEach(ia=>{Ma.add(Ia(ia));return!0});return{iIk:Ja,LGo:Ka,p5o:Ma}}BJf(ma,Ia=null){const Ja=new n.a;Ia||(Ia=A.a.nil);for(;ma&&!Ia.equals(ma.id);)Ja.add(ma),ma=ma.OW;Ja.reverse();return Ja}RCo(ma){const Ia=3===this.fTd;let Ja=!1;!ma.output.succeeded&&
(2===this.fTd||ma.output.crash&&1===this.fTd)&&(Ja=!0);let Ka=!1;ma.input.U9&&0<ma.input.U9.length&&(Ia||Ja)&&ma.runtime.xu&&ma.runtime.tk&&ma.runtime.Xb&&(Ka=ma.runtime.Xb.isFeatureEnabled(51));return Ka}Dti(ma){return 9===N.a.Rhb(N.a.Ulf(ma))}Myi(ma){return 8===N.a.Rhb(N.a.Ulf(ma))}static GWl(ma){return ma.output.crash?2:ma.output.succeeded?3:1}static t7b(ma,Ia){if(!Ia||Ia===A.a.nil)return null;const Ja=ma.runtime.an.J(Ia);return Ja?Ja.vm:ma.runtime.tk.J(Ia)}}ja.dTd=A.a.If("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");
Object(E.a)(ja,"GraphMergerBase",null,[1381])},1758:function(E,M,c){E=c(0);var m=c(223),e=c(1616),a=c(182),l=c(1530);class y extends e.a{constructor(n,v,A,w,G,F,I,K,J,N,R,O,L,U){super(n,3,v,A,w,G,F,K,J,N,R,O,L,U);this.Cue=I}get character(){return this.Cue}get text(){return this.character.toString()}u7c(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}T6b(){return"CharRun"}clone(){return new y(this.ODc,this.source,this.Gj,this.zg,this.runId,this.bJ,this.character,
this.wlb,this.lQa,this.Aba,this.EEa,this.XRa,this.AF,this.Rt)}uA(n,v,A,w=!1){return super.uA(n,v,A,w)?n.character===this.character?!0:l.a.luh(n.character,this.character):!1}}Object(E.a)(y,"CharRunMergeBlock",e.a,[]);c.d(M,"a",function(){return z});class z extends e.a{constructor(n,v,A,w,G,F,I,K,J,N,R,O,L,U,W){super(n,1,v,A,w,G,F,K,N,R,O,L,U,W);this._text=I;this.yTe=J}get text(){return this._text}u7c(n){this._text=n}get b7a(){return this.yTe&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",
super.toString(),this.yTe)}T6b(){return"TextRun"}clone(){return new z(this.ODc,this.source,this.Gj,this.zg,this.runId,this.bJ,this._text,this.wlb,this.yTe,this.lQa,this.Aba,this.EEa,this.XRa,this.AF,this.Rt)}uA(n,v,A,w=!1){return super.uA(n,v,A,w)?l.a.kuh(this._text,n._text):!1}O8c(){const n=new m.a;for(let A=0;A<this.text.length;A++){var v=l.a.charAt(this._text,A);if(l.a.qRm(l.a.VHo(v))){let w="";w+=v;v=l.a.charAt(this._text,++A);w+=v;v=new z(this.ODc,this.source,this.Gj,this.zg,this.runId,this.bJ,
w,this.wlb,!1,this.lQa,this.Aba,this.EEa,this.XRa,this.AF,this.Rt);n.add(v)}else v=new y(this.ODc,this.source,this.Gj,this.zg,this.runId,this.bJ,v,this.wlb,this.lQa,this.Aba,this.EEa,this.XRa,this.AF,this.Rt),n.add(v)}return n}}Object(E.a)(z,"TextRunMergeBlock",e.a,[])},1759:function(E,M,c){E=c(0);var m=c(1010),e=c(15),a=c(365),l=c(223);c(58);c(798);var y=c(602),z=c(168),n=c(182),v=c(1032),A;(function(K){K[K.none=0]="none";K[K.browser=1]="browser";K[K.serverPutChanges=2]="serverPutChanges";K[K.syncDiff=
3]="syncDiff";K[K.docxMerge=4]="docxMerge";K[K.undo=5]="undo"})(A||(A={}));Object(E.b)("GraphMergeSource",A);var w=c(1747),G=c(1545),F=c(1741);c.d(M,"a",function(){return I});class I{constructor(K){this.aB=new v.a;this.XV=new a.a;this.Bih=new a.a(0);this.Odd=new l.a;this.cYg=new l.a;this.a7g=new l.a;this.q4g=new l.a;this.k6g="";this.RVa=null;this.Xr=this.JHe=0;this.Gqd=new a.a(0);this.aAe=this.x$g=this.rnd=0;const {MarkerValidation:J}=c(1859);this._state=K;this.y$j=new J}get qYc(){return this.y$j}get R3i(){return this.RVa}mlo(K){this.JHe=
K}y2d(K,J){this.k6g=String.format("{0}-{1}",K,J)}Hge(K){this.OWk();this.aAe=K}Wag(){this.aAe=0}OWk(){this.RVa&&this.Odd.add(this.RVa);this.RVa=null}Og(K){this.RVa||(this.RVa=K);switch(this.aAe){case 1:this.cYg.add(K);break;case 2:this.a7g.add(K);break;case 3:this.q4g.add(K);break;default:this.RVa&&this.Odd.add(K)}}hIi(K){this.Odd.add(K)}O2m(){this.Xr=this.eEa();this.Bha("MergeEnd")}Bha(K){const J=this.eEa();this.Bih.Z(K,J-this.JHe);this.JHe=J}mjo(){this.rnd=this.eEa();this.x$g++}zU(K){const J=this.eEa();
let N;({value:N}=this.Gqd.Dc(K)).returnValue?(N+=J-this.rnd,this.Gqd.Z(K,N)):this.Gqd.Z(K,J-this.rnd);this.rnd=J}o1l(){this.XV.Z("Id",this._state.input.rJb.toString());this.XV.Z("Source",A[this._state.input.source]);this.XV.Z("RevSummary",I.xUa(this.C9l()));this.XV.Z("NodesRolledBackIfFailed",I.xUa(this.t3l()));if(!this._state.output.succeeded){let K,J,N,R,O;({kIk:K,zyl:J,FOo:N,pIk:R,HOo:O}=this.zAl(this._state.runtime));this.XV.Z("CharactersLost",this.cOl(K,J,N));this.XV.Z("CharactersLostInComments",
this.gPl());this.XV.Z("CharactersLostInTables",this.JKl(O,R))}this.XV.Z("FuncStep",this.k6g);this.XV.Z("FailureDetail",I.xUa(this.UDb()));this.XV.Z("FailDetailHints",this.XOd(this.cYg));this.XV.Z("FailDetailNaiveMerge",this.XOd(this.a7g));this.XV.Z("FailDetailLcs",this.XOd(this.q4g));this.XV.Z("ExtraDetails",this.XOd(this.Odd));this.XV.Z("Timeline",I.xUa(this.Bih));this.XV.Z("ParagraphMergesCount",this.x$g);this.XV.Z("ParagraphMergeDurations",I.xUa(this.Gqd));this.XV.Z("MarkerInfo",I.xUa(this.qYc.f7h()));
this.XV.Z("Result",I.xUa(this.q1l()));return JSON.stringify(I.xUa(this.XV))}eEa(){return(new Date).getTime()}C9l(){const K=new a.a;let J,N,R;({Uig:J,Jpg:N,WCa:R}=this.arf(this._state,this._state.input.U9,this._state.input.zUa,this._state.input.VFb));K.Z("hasBase",R?"true":"false");if(R){let O=0,L=0;for(;J&&!J.id.equals(R.id);)O++,J=J.OW;for(;N&&!N.id.equals(R.id);)L++,N=N.OW;K.Z("lenToBaseTheirs",J?O:-1);K.Z("lenToBaseYours",N?L:-1)}return K}arf(K,J,N,R){K=J.ag(J.length-1-(R?1:0));J=(N=N.ag(N.length-
1))&&K?K.J0a(N):null;return{Uig:K,Jpg:N,WCa:J}}t3l(){if(!this._state.runtime.xqi)return null;const K=this._state.runtime.Hq,J=new a.a(0);K.forEach((N,R)=>{({value:N}=J.Dc(R.Pc.toString()));J.Z(R.Pc.toString(),N+1);return!0});return J}cOl(K,J,N){let R=null,O=null,L=null;const U=this._state.runtime.Hq;let W=0;try{L=new F.a(this.aB,this._state);R=G.b(K,J,N);O=new y.a;for(K=0;K<R.length;K++)if(!R.J(K).vzb.Zp(R.J(K).Zpb,(X,V)=>X.equals(V))){const X=this.pRh(R.J(K),L);W+=X;O.add(R.J(K))}R&&U.forEach((X,
V)=>{if(393230===V.Pc){V=null;for(let Z=0;Z<R.length;Z++)if(!O.contains(R.J(Z))&&R.J(Z).Zpb.contains(X,(da,aa)=>da===aa)){V=R.J(Z);break}V&&(X=this.pRh(V,L),O.add(V),W+=X)}return!0});return W}catch(X){return z.a.instance.Ta(579190992,1,2,"Exception in GetCharactersLost: "+X.toString()),-1}}zAl(K){let J,N,R,O,L;K.QG=W=>{if(750<this.eEa()-this._state.input.sTa)throw z.a.instance.Ta(579190991,1,2,"Timed out while calculating characters lost: {0}",W),n.a.invalidOperation(W);};J=new l.a;N=new l.a;R=new l.a;
O=new l.a;const U=new l.a;L=new l.a;try{if(K.tk){const W=K.tk.J(w.ChildNodeListMerge.U8d);let X,V;X=K.xu.J(w.ChildNodeListMerge.U8d)||W;V=K.Hq.J(w.ChildNodeListMerge.U8d)||W;this.Jjf(W,Z=>K.tk.J(Z),J,O);this.Jjf(X,Z=>K.xu.J(Z)||K.tk.J(Z),N,U);this.Jjf(V,Z=>K.Hq.J(Z)||K.tk.J(Z),R,L)}}catch(W){z.a.instance.Ta(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+W.toString())}return{kIk:J,zyl:N,FOo:R,pIk:O,HOo:L}}JKl(K,J){try{let R=0;const O=this._state.runtime;var N=W=>O.Hq.J(W)||O.tk.J(W);const L=
new y.a,U=this.lCl(K,O,N,L);for(K=0;K<U.count;K++){let W=U.keys.J(K);const X=U.J(W);if(!L.contains(W)){let V=this.Ngi(O,N,L,W,X);if(-1!==V)R+=V;else return z.a.instance.Ta(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(N=0;N<J.length;N++){let W=J.J(0);if(!L.contains(W)){let X=this.uSd(O.tk.J(W));if(-1===X)return z.a.instance.Ta(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;R+=X}}return R}catch(R){return z.a.instance.Ta(573089735,
1,2,"Exception in GetAllTablesCharactersLost: "+R.toString()),-1}}Ngi(K,J,N,R,O){K.QG("GetTableCharactersLost");let L=0;O=this.aB.getPropertyObjectIds(O,e.a.ff);for(let Z=0;Z<O.length;Z++){var U=J(O.J(Z));U=this.aB.getPropertyObjectIds(U,e.a.ff);for(let da=0;da<U.length;da++){var W=J(U.J(da));if(K.tk.J(O.J(Z))&&K.tk.J(U.J(da))){var X=K.tk.J(U.J(da));if(!X)return z.a.instance.Ta(573089737,1,2,"Base cell unexpectedly null"),-1;W=this.aB.getPropertyObjectIds(X,e.a.ff);var V=K.xu.J(U.J(da))||K.tk.J(U.J(da));
V=this.aB.getPropertyObjectIds(V,e.a.ff);X=this.aB.getPropertyObjectIds(X,e.a.ff);W=G.b(W,V,X);for(X=0;X<W.length;X++){V=W.J(X);const aa=this.odm(K,J,N,V);if(-1===aa)return z.a.instance.Ta(573089738,1,2,"Error getting characters lost for parition {0}",V.toString()),-1;L+=aa}}else{X=this.Zdm(J,W,N);if(-1===X)return z.a.instance.Ta(573089736,1,2,"Error getting text length of cell {0}",W.id.toString()),-1;L+=X}}}N.add(R);return L}odm(K,J,N,R){let O=0;var L=new l.a,U=new l.a;const W=new a.a;new a.a;for(var X=
0;X<R.vzb.length;X++){var V=K.tk.J(R.vzb.J(X));V=this.aB.getPropertyObjectIds(V,e.a.FK);if(1!==V.length)return z.a.instance.Ta(573089739,1,2,"Unexpected number of ContentNodes: {0}",V.length),-1;var Z=K.tk.J(V.J(0));393230===Z.Pc?L.add(Z):393250===Z.Pc&&W.add(V.J(0),Z)}for(X=0;X<R.Zpb.length;X++){V=J(R.Zpb.J(X));V=this.aB.getPropertyObjectIds(V,e.a.FK);if(1!==V.length)return z.a.instance.Ta(573089740,1,2,"Unexpected number of ContentNodes: {0}",V.length),-1;Z=J(V.J(0));if(393230===Z.Pc)U.add(Z);else if(393250===
Z.Pc){Z=this.Ngi(K,J,N,V.J(0),Z);if(-1===Z)return z.a.instance.Ta(573089741,1,2,"Error diffing table {0}",V.J(0).toString()),-1;O+=Z}}X=new F.a(this.aB,this._state);if(0<L.length&&0<U.length){L=X.rZh(L,da=>K.tk.J(da),U,da=>J(da));if(-1===L)return z.a.instance.Ta(573089742,1,2,"Problem diffing parition {0} with LCS",R.toString()),-1;O+=L}else if(0<L.length)for(R=0;R<L.length;R++)O+=this.aB.getPropertyString(L.J(R),e.a.mo).length+1;else if(0<U.length)for(R=0;R<U.length;R++)O+=this.aB.getPropertyString(U.J(R),
e.a.mo).length+1;for(R=0;R<W.count;R++)if(L=W.keys.J(R),!N.contains(L)){U=this.uSd(W.J(L));if(-1===U)return z.a.instance.Ta(573089743,1,2,"Error getting length of table {0}",L.toString()),-1;O+=U}return O}Zdm(K,J,N){let R=0;J=this.aB.getPropertyObjectIds(J,e.a.ff);for(let U=0;U<J.length;U++){var O=K(J.J(U));O=this.aB.getPropertyObjectIds(O,e.a.FK);if(1!==O.length)return z.a.instance.Ta(573089744,1,2,"Unexpected number of ContentNodes: {0}",O.length),-1;var L=K(O.J(0));if(393230===L.Pc)R+=this.aB.getPropertyString(L,
e.a.mo).length+1;else if(393250===L.Pc){L=this.uSd(L);if(-1===L)return z.a.instance.Ta(573089745,1,2,"Problem finding text length of table {0}",O.J(0).toString()),-1;R+=L;N.add(O.J(0))}}return R}uSd(K){this._state.runtime.QG("GetTextLengthOfTable");let J=0;const N=W=>this._state.runtime.Hq.J(W)||this._state.runtime.tk.J(W);K=this.aB.getPropertyObjectIds(K,e.a.ff);for(let W=0;W<K.length;W++){var R=N(K.J(W));R=this.aB.getPropertyObjectIds(R,e.a.ff);for(let X=0;X<R.length;X++){var O=N(R.J(X));O=this.aB.getPropertyObjectIds(O,
e.a.ff);for(let V=0;V<O.length;V++){var L=N(O.J(V));L=this.aB.getPropertyObjectIds(L,e.a.FK);if(1!==L.length)return z.a.instance.Ta(573089746,1,2,"Unexpected number of ContentNodes: {0}",L.length),-1;var U=N(L.J(0));if(393230===U.Pc)J+=this.aB.getPropertyString(U,e.a.mo).length+1;else if(393250===U.Pc){U=this.uSd(U);if(-1===U)return z.a.instance.Ta(573089747,1,2,"Error finding the text length of table {0}",L.J(0)),-1;J+=U}}}}return J}lCl(K,J,N,R){const O=new a.a;for(let L=0;L<K.length;L++){let U=
!1;J.Hq.J(K.J(L))&&(U=!0);const W=N(K.J(L)),X=this.aB.getPropertyObjectIds(W,e.a.ff);if(!U)for(let V=0;V<X.length;V++)if(J.Hq.J(X.J(V))){U=!0;break}U?O.add(K.J(L),W):R.add(K.J(L))}return O}pRh(K,J){return this.oRh(K.vzb,K.Zpb,J)}oRh(K,J,N){const R=new l.a;for(var O=0;O<K.length;O++)R.add(this._state.runtime.tk.J(K.J(O)));K=new l.a;for(O=0;O<J.length;O++)K.add(this._state.runtime.Hq.J(J.J(O))||this._state.runtime.tk.J(J.J(O)));return N.rZh(R,L=>this._state.runtime.tk.J(L),K,L=>this._state.runtime.Hq.J(L)||
this._state.runtime.tk.J(L))}Jjf(K,J,N,R){if(393227===K.Pc){K=this.aB.getPropertyObjectIds(K,e.a.ff);for(let O=0;O<K.length;O++){const L=this.aB.getPropertyObjectIds(J(K.J(O)),e.a.ff);for(let U=0;U<L.length;U++){const W=this.aB.getPropertyObjectIds(J(L.J(U)),e.a.ff);for(let X=0;X<W.length;X++){const V=this.aB.getPropertyObjectIds(J(W.J(X)),e.a.FK);if(1!==V.length)return;const Z=J(V.J(0));393230===Z.Pc?N.add(V.J(0)):393250===Z.Pc?R.add(V.J(0)):z.a.instance.Ta(573089748,1,2,"Unsupported class id in GetCharactersLost: "+
m.a[Z.Pc])}}}}}Kjf(K,J){K=this.aB.getPropertyObjectIds(K,e.a.ff);const N=new l.a;for(let R=0;R<K.length;R++){const O=this.aB.getPropertyObjectIds(J(K.J(R)),e.a.FK);if(1!==O.length)return null;N.add(O.J(0))}return N}gPl(){let K=0;const J=this._state.runtime,N=J.Hq,R=L=>J.Hq.J(L)||J.tk.J(L);let O=null;J.QG=L=>{if(750<this.eEa()-this._state.input.sTa)throw z.a.instance.Ta(573089749,1,2,"Timed out while calculating comment characters lost: {0}",L),n.a.invalidOperation(L);};try{N.forEach((L,U)=>{if(1074135127===
U.Pc){L=this.Kjf(U,R);var W=J.tk.J(U.id);if(W)W=this.Kjf(W,V=>J.tk.J(V)),O||(O=new F.a(this.aB,this._state)),K+=this.oRh(W,L,O);else for(W=0;W<L.length;W++)K+=this.aB.getPropertyString(J.Hq.J(L.J(W)),e.a.mo).length+1}if(1074135126===U.Pc&&(L=this.aB.getPropertyObjectIds(U,e.a.ff).SG(),U=J.tk.J(U.id)))for(U=this.aB.getPropertyObjectIds(U,e.a.ff),W=0;W<U.length;W++)if(!L.contains(U.J(W))){var X=J.tk.J(U.J(W));X=this.Kjf(X,V=>J.tk.J(V));for(let V=0;V<X.length;V++)K+=this.aB.getPropertyString(J.tk.J(X.J(V)),
e.a.mo).length+1}return!0})}catch(L){return z.a.instance.Ta(573089750,1,2,"Exception in GetCommentCharactersLost: "+L.toString()),-1}return K}UDb(){return this.RVa?this.RVa.UDb():null}XOd(K){const J=new l.a;K.forEach(N=>{J.add(I.xUa(N.UDb()));return!0});return J.toArray()}q1l(){const K=new a.a;K.Z("Succeeded",this._state.output.succeeded);K.Z("Timeout",this._state.output.timeout);K.Z("Crash",this._state.output.crash);K.Z("MergedRevisions",this._state.output.GM?this._state.output.GM.length:-1);K.Z("Duration",
this.Xr-this._state.input.sTa);return K}static xUa(K){if(!K)return null;const J={};K.forEach((N,R)=>{J[N.toString()]=R;return!0});return J}}Object(E.a)(I,"MergeLogger",null,[])},1760:function(E,M,c){E=c(0);var m=c(243),e=c(15),a=c(6),l=c(116),y=c(798),z=c(168),n=c(223),v=c(365),A=c(1475);class w{constructor(I,K,J){this.position=I;this.leader=K;this.val=J}equals(I){return this.position===I.position&&this.leader===I.leader&&this.val===I.val}toString(){return this.position.toString()}}Object(E.a)(w,
"TabStop",null,[]);var G=c(1860);c.d(M,"a",function(){return F});class F extends A.a{constructor(){super()}get Mn(){return 20}get fA(){return 0}vk(){const I=super.vk();I.Z(y.a.yb(e.a.mo),1);I.Z(y.a.yb(e.a.Gn),1);I.Z(y.a.yb(e.a.zm),1);I.Z(y.a.yb(a.a.Vs),1);I.Z(y.a.yb(a.a.iq),1);I.Z(y.a.yb(a.a.Lc),1);I.Z(y.a.yb(e.a.Wob),1);I.Z(y.a.yb(a.a.iPa),1);I.Z(y.a.yb(a.a.LGa),1);I.Z(y.a.yb(e.a.jxa),1);I.Z(y.a.yb(a.a.aFa),1);I.Z(y.a.yb(a.a.Ofa),1);I.Z(y.a.yb(a.a.bFa),1);I.Z(y.a.yb(a.a.yDa),1);I.Z(y.a.yb(a.a.cFa),
1);I.Z(y.a.yb(a.a.zDa),1);I.Z(y.a.yb(a.a.KGa),1);I.Z(y.a.yb(a.a.oIa),1);I.Z(y.a.yb(a.a.pIa),1);I.Z(y.a.yb(a.a.Xya),1);I.Z(y.a.yb(a.a.zv),1);I.Z(y.a.yb(a.a.rz),1);I.Z(y.a.yb(a.a.uz),1);I.Z(y.a.yb(a.a.ow),1);I.Z(y.a.yb(l.a.uJ),6);I.Z(y.a.yb(l.a.tUa),6);I.Z(y.a.yb(a.a.sAb),7);I.Z(y.a.yb(l.a.uJ),6);I.Z(y.a.yb(a.a.Fsj),2);I.Z(y.a.yb(l.a.x3k),2);I.Z(y.a.yb(l.a.Ixn),2);I.Z(y.a.yb(a.a.Dlc),2);I.Z(y.a.yb(a.a.J$c),2);I.Z(y.a.yb(a.a.cQb),2);I.Z(y.a.yb(a.a.u7a),2);I.Z(y.a.yb(a.a.K$c),2);I.Z(y.a.yb(a.a.L$c),2);
I.Z(y.a.yb(a.a.lockNotFullySupportedParagraphInBlockContentControl),2);I.Z(y.a.yb(a.a.listID),3);I.Z(y.a.yb(a.a.listLevel),3);return I}ZB(I,K){if(K===y.a.yb(e.a.mo)||K===y.a.yb(e.a.Gn)||K===y.a.yb(e.a.zm)||K===y.a.yb(a.a.Vs)||K===y.a.yb(a.a.iq)||K===y.a.yb(a.a.Lc)||K===y.a.yb(e.a.Wob)||K===y.a.yb(a.a.iPa)||K===y.a.yb(a.a.LGa)||K===y.a.yb(e.a.jxa)||K===y.a.yb(a.a.aFa)||K===y.a.yb(a.a.Ofa)||K===y.a.yb(a.a.bFa)||K===y.a.yb(a.a.yDa)||K===y.a.yb(a.a.cFa)||K===y.a.yb(a.a.zDa)||K===y.a.yb(a.a.KGa)||K===
y.a.yb(a.a.oIa)||K===y.a.yb(a.a.pIa)||K===y.a.yb(a.a.Xya)||K===y.a.yb(a.a.zv)||K===y.a.yb(a.a.gN)){var J=I.sn.value.Hu,N=I.sn.value.yf;K=I.Ng.value.yf;if(I.hq.runtime.mNa.contains(J.id))return z.a.instance.Ta(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",J.id),!0;if(I.hq.runtime.Xb.Zhb(1000005)&&this.Swo(I,K,N))return I.Uk=K.AK(),F.Unh(I),F.rzd(I.hq,I.Zd,N),!0;const R=new n.a;R.add(J);J=new n.a;J.add(N);N=new n.a;
N.add(K);if(!({an:K}=F.NBj(I.hq,R,N,J)).returnValue)return I.Eog=!0,I.Uk=null,!1;F.Unh(I);I.Uk=K.ag(0).vm;return!0}return K===y.a.yb(a.a.rz)||K===y.a.yb(a.a.uz)||K===y.a.yb(a.a.ow)?(this.JLo(I),I.rg.add(y.a.yb(a.a.rz)),I.rg.add(y.a.yb(a.a.uz)),I.rg.add(y.a.yb(a.a.ow)),!0):!1}Swo(I,K,J){K=I.Zd.getPropertyString(K,a.a.gN);I=I.Zd.getPropertyString(J,a.a.gN);return K||I?!0:!1}JLo(I){const K=I.Zd,J=I.Uk;var N=I.sn.value.yf,R=I.Ng.value.yf;I=this.Vof(I.sn.value.Hu,K);R=this.Vof(R,K);N=this.Vof(N,K);({jbn:N,
kbn:I,lbn:R}=this.s1l(I,R,N));N.length?(K.setPropertyUint32s(J,a.a.ow,N),K.setPropertyUint32s(J,a.a.rz,I),K.setPropertyUint32s(J,a.a.uz,R)):this.wXn(J)}Vof(I,K){const J=K.getPropertyUint32s(I,a.a.ow),N=K.getPropertyUint32s(I,a.a.rz);I=K.getPropertyUint32s(I,a.a.uz);K=new n.a;if(!J)return K;for(let R=0;R<J.length;++R)K.add(new w(J.J(R),N.J(R),I.J(R)));return K}s1l(I,K,J){({vYi:K,wYi:L,xYi:O}=this.Q6h(I,K));let N,R;({vYi:J,wYi:N,xYi:R}=this.Q6h(I,J));I=this.Kkm(I,L,O,N,R);var O=this.Jkm(I,K,J);I=new n.a;
K=new n.a;var L=new n.a;for(J=0;J<O.length;++J)I.add(O.J(J).position),K.add(O.J(J).leader),L.add(O.J(J).val);return{jbn:I,kbn:K,lbn:L}}Q6h(I,K){let J,N,R;J=new n.a;N=new v.a;R=new v.a;let O,L;for(O=L=0;O<I.length&&L<K.length;)I.J(O).position===K.J(L).position?(I.J(O).equals(K.J(L))||R.Z(I.J(O).position,K.J(L)),++O,++L):I.J(O).position<K.J(L).position?(N.Z(I.J(O).position,I.J(O)),++O):(J.add(K.J(L)),++L);for(;O<I.length;)N.Z(I.J(O).position,I.J(O)),++O;for(;L<K.length;)J.add(K.J(L)),++L;return{vYi:J,
wYi:N,xYi:R}}Kkm(I,K,J,N,R){const O=new n.a;for(let L=0;L<I.length;++L){const U=I.J(L).position;K.nb(U)||(J.nb(U)?O.add(J.J(U)):N.nb(U)||(R.nb(U)?O.add(R.J(U)):O.add(I.J(L))))}return O}Jkm(I,K,J){K=this.iNi(K,J);return this.iNi(I,K)}iNi(I,K){const J=new n.a;let N,R;for(N=R=0;N<I.length&&R<K.length;)I.J(N).position<=K.J(R).position?(J.add(I.J(N)),I.J(N).position===K.J(R).position&&++R,++N):J.add(K.J(R++));for(;N<I.length;)J.add(I.J(N++));for(;R<K.length;)J.add(K.J(R++));return J}wXn(I){I.removeProperty(a.a.ow);
I.removeProperty(a.a.rz);I.removeProperty(a.a.uz)}static jh(){return new F}static get instance(){return F.Lg.value}static Unh(I){I.rg.add(y.a.yb(e.a.mo));I.rg.add(y.a.yb(e.a.Gn));I.rg.add(y.a.yb(e.a.zm));I.rg.add(y.a.yb(a.a.Vs));I.rg.add(y.a.yb(a.a.iq));I.rg.add(y.a.yb(a.a.Lc));I.rg.add(y.a.yb(e.a.Wob));I.rg.add(y.a.yb(a.a.iPa));I.rg.add(y.a.yb(a.a.LGa));I.rg.add(y.a.yb(e.a.jxa));I.rg.add(y.a.yb(a.a.aFa));I.rg.add(y.a.yb(a.a.Ofa));I.rg.add(y.a.yb(a.a.bFa));I.rg.add(y.a.yb(a.a.yDa));I.rg.add(y.a.yb(a.a.cFa));
I.rg.add(y.a.yb(a.a.zDa));I.rg.add(y.a.yb(a.a.KGa));I.rg.add(y.a.yb(a.a.oIa));I.rg.add(y.a.yb(a.a.pIa));I.rg.add(y.a.yb(a.a.Xya));I.rg.add(y.a.yb(a.a.zv));I.rg.add(y.a.yb(a.a.gN))}static NBj(I,K,J,N){return(new G.a(I,K,J,N)).Nlc()}static rzd(I,K,J){J=K.getPropertyObjectIds(J,e.a.Gn);for(let R=0;R<J.length;R++){var N=I.runtime.Hq.J(J.ag(R));if(N&&(N=K.getPropertyObjectId(N,a.a.le))){I.runtime.Rjc.add(N);break}}}}F.Lg=new m.a(F.jh);Object(E.a)(F,"ParagraphNodeComplexMerge",A.a,[])},1761:function(E,
M,c){E=c(0);var m=c(74),e=c(1483),a=c(1611),l=c(1531),y=c(1501),z=c(1548),n=c(1484),v=c(1488),A=c(1487),w=c(1481),G=c(1480);class F{constructor(Z){this.fc=Z;this.lvd=this.huf()}XK(){return"Add-ins"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:3}MH(Z,da){Z=new A.a(Z);da.resultsUpdated(Z)}fib(Z,da,aa){let ea;ea=this.fc.pP?new v.a(29):new v.a(27);ea.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;aa&&this.xvo(Z.Dg,da,ea)}xvo(Z,da,aa){const ea=[];let na;na=this.fc.GDm?this.fc.pP&&this.fc.Fdb?
G.a.bhb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,Z)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,Z):this.fc.HDm?this.fc.pP&&this.fc.Fdb?G.a.bhb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,Z)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,Z):this.fc.pP&&this.fc.Fdb?G.a.bhb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,Z)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,
Z);this.fc.Vva?(w.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",na)),w.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Z))):(ea.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",na)),ea.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Z)),appChrome.api.dispatch(ea));aa.Jw(new n.a("LaunchAddinDialogFromTellMe",29));da.Tu(aa)}huf(){const Z=[];this.fc.lXd&&
Array.add(Z,"Addin");return Z}}Object(E.a)(F,"AddinStoreResultsProvider",null,[1121]);var I=c(1714),K=c(1520),J=c(1532),N=c(1715),R=c(1748),O=c(1716),L=c(1547),U=c(2),W=c(35),X=c(136);c.d(M,"a",function(){return V});class V{constructor(Z,da,aa){this.vcb=this.OAc=this.PAc=this.tud=!1;this.bQ=null;this.U1=-1;this.dYa=this.GBc=this.Mea=this.Exb=null;this.P3g=this.Y3g=0;this.fc=Z;const ea=G.a.nha();this.t$a=da||[];this.Wf=U.AFrameworkApplication.Ne;this.Hfh=Z.CWf;this.QAc=Z.BWf;this.rud=ea&&this.FOb();
this.sud=ea&&this.GOb();this.Jfh=ea&&this.HOb();this.vud=this.JOb();this.MRe=this.qjc();if((da=Z.Kgg&&G.a.Pcg(Z))||Z.Yfa)this.Exb=new R.a(Z),this.tud=Z.P9c;da&&(this.PAc=Z.R9c,this.OAc=Z.hkb,this.vcb=this.tud&&this.$w("File")||this.PAc&&this.$w("People")||this.OAc&&this.$w("Notes"));this.qud=this.pro();this.SAc=Z.V_c;this.uud=this.Jro();this.LRe=this.oro();this.YYb=this.Nhe();this.h$=this.Rdm();this.ALg=new I.a(Z);this.A5j=new N.a(Z);this.Zkk=new O.a(Z);this.uUj=new F(Z);this.Hzc=aa;this.cxb=new a.a;
this.SAc&&(this.ALg=new I.a(Z));Z.Yfa&&(this.LRe=this.uud=this.SAc=this.vcb=this.OAc=this.PAc=this.MRe=this.vud=this.Jfh=this.sud=this.rud=this.QAc=!1,U.AFrameworkApplication.K&&this.$w("File")&&this.dqj()||this.YYb)&&(Z=this.cxb.Suf("Search",U.AFrameworkApplication.K.jb("TellMeServiceAuthEndpointForSearch"),!0),this.sLc(Z,"TellMeService",!0),Z=this.cxb.Suf("SmartLookup",U.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint"),!1),this.sLc(Z,"Shredder",!1));U.AFrameworkApplication.K&&this.vcb&&
this.$w("File")&&this.dqj()&&(Z=this.cxb.Suf("Search",U.AFrameworkApplication.K.jb("TellMeServiceAuthEndpointForSearch"),!0),this.sLc(Z,"TellMeService",!0))}$w(Z){return Array.contains(this.t$a,Z)?!0:!1}XK(){return"TellMeService"}cU(){return 0===this.fc.$u?0:1===this.fc.$u?1:this.$w("Command")||this.$w("Recommended")?2:3}Odm(Z){let da="";if(!Z&&this.$w("Command")&&this.fc.uEf){da+="CommandSearch_DLIS,";var aa=this.fc.rxj;0<aa.length&&(da+=aa+",")}Z&&this.$w("Recommended")&&this.QAc&&(aa=this.Xhm(),
0<aa.length&&(da+=aa+","));!Z&&this.$w("Help")&&(Z=this.fc.qxj,0<Z.length&&(da+=Z+","));this.fc.Yfa&&this.dYa&&0<this.dYa.length&&(da+="IsRecallEnabled_true,");(this.fc.PJd||this.fc.Yfa)&&this.vcb&&(da+="IsGenerateSlidesEnabled_true,");0<da.length&&(da=da.substr(0,da.length-1));return da}sLc(Z,da,aa){const ea=aa?this.Y3g:this.P3g;if(!ea||window.performance.now()-ea>=G.a.p7a)if(Z)aa?this.Y3g=window.performance.now():this.P3g=window.performance.now(),Z.then(na=>{aa?this.GBc=na:(this.dYa=na,w.TellMeActor.instance.Ieg=
na)},na=>{w.TellMeActor.instance.Oe.onError("TellMeServiceProvider:FetchTokenForService_"+da,"tellMeServiceToken promise rejected: "+na)});else if(w.TellMeActor.instance.Oe)w.TellMeActor.instance.Oe.onError("TellMeServiceProvider:FetchTokenForService_"+da,"undefined token promise")}MH(Z,da,aa,ea=e.a.tellMe,na=null){const pa=new A.a(Z);aa=G.a.YQ(Z);this.$w("File")&&(this.vcb||this.fc.Yfa)&&this.sLc(this.cxb.Sdm(),"TellMeService",!0);(this.$w("File")&&this.fc.Yfa||this.$w("ActionAI")&&this.YYb)&&this.sLc(this.cxb.Xam(),
"Shredder",!1);var ja=this.vcb&&!!this.GBc;const ma=this.fc.Yfa&&!!this.dYa;var Ia=ja||ma||aa&&this.$w("Recommended")&&this.QAc;ja=ja||ma||!aa&&(this.Hfh&&this.$w("Command")||this.rud&&this.$w("Answer")||this.sud&&this.$w("Definition")||this.MRe&&this.$w("Image")||this.SAc&&this.$w("Help")||this.vud&&this.$w("WolframAnswer")||this.uud&&this.$w("Template")||this.LRe&&this.$w("Addin"));if(Ia||ja)if(this.Mea=ea,ea={"Content-Type":"application/json",Accept:"application/json"},ea["X-Office-Version"]=U.AFrameworkApplication.buildVersion,
ea["X-Office-Application"]=U.AFrameworkApplication.K.jb("Application"),ea["X-Office-Platform"]="WAC",ea["X-TellMe-SqmUserId"]=U.AFrameworkApplication.K.jb("LoggableUserId")||"",ea["X-TellMe-SessionId"]=w.TellMeActor.instance.rSd(),this.GBc&&(ea.Authorization="Bearer "+this.GBc),this.dYa&&0<this.dYa.length&&(ea["X-TellMe-ShredderToken"]="Bearer "+this.dYa),Ia=this.Odm(aa),0<Ia.length&&(ea["X-TellMe-Flights"]=Ia),Ia=[],!aa&&this.$w("Answer")&&this.rud&&(na?Array.contains(na,9):1)&&Array.add(Ia,"Answer"),
!aa&&this.$w("Command")&&this.Hfh&&!K.CommandResultsUtility.QBf(Z.Dg)&&(na?Array.contains(na,17):1)&&Array.add(Ia,"Command"),!aa&&this.$w("Definition")&&this.sud&&(na?Array.contains(na,10):1)&&Array.add(Ia,"Definition"),!aa&&this.$w("Help")&&this.SAc&&(na?Array.contains(na,8):1)&&Array.add(Ia,"Help"),!aa&&this.$w("WolframAnswer")&&this.vud&&(na?Array.contains(na,12):1)&&Array.add(Ia,"WolframAnswer"),aa&&this.$w("Recommended")&&this.QAc&&!w.TellMeActor.instance.obd&&(na?Array.contains(na,18):1)&&Array.add(Ia,
"Recommended"),!aa&&this.$w("Image")&&this.MRe&&(na?Array.contains(na,19):1)&&Array.add(Ia,"Image"),this.GBc&&this.vcb&&(na?Array.contains(na,14)||Array.contains(na,15)||Array.contains(na,20):1)&&(this.Exb.L5a(),this.tud&&this.$w("File")&&Array.add(Ia,"File"),this.PAc&&this.$w("People")&&Array.add(Ia,"People"),this.OAc&&this.$w("Notes")&&Array.add(Ia,"Notes")),this.dYa&&0<this.dYa.length&&this.fc.Yfa&&(na?Array.contains(na,15):1)&&(this.Exb.L5a(),this.$w("File")&&Array.add(Ia,"File")),!aa&&this.$w("Template")&&
this.uud&&(na?Array.contains(na,23):1)&&Array.add(Ia,"Template"),!aa&&this.$w("Addin")&&this.LRe&&(na?Array.contains(na,27):1)&&Array.add(Ia,"Addin"),!aa&&this.$w("ActionAI")&&this.YYb&&(na?Array.contains(na,25):1)&&Array.add(Ia,"ActionAI"),Ia.length){ea["X-TellMe-SuggestionTypes"]=Ia.join(",");ea["X-TellMe-Culture"]=U.AFrameworkApplication.uiCulture;ea["X-TellMe-ProcessSessionId"]=U.AFrameworkApplication.userSessionId;var Ja=this.bQ=X.a.create().toString();ea["Client-Request-Id"]=Ja;var Ka=window.performance.now();
this.NCa();this.U1=window.setTimeout(()=>{if(Ja===this.bQ){this.bQ="";this.U1=-1;da.resultsUpdated(pa);const Ma={};Ma[l.a.provider]=this.XK();Ma[l.a.TLb]=Z.dnb;w.TellMeActor.instance.Oe.DA(y.a.timedOut,this.Hzc,Ma)}},this.Hzc);this.Wf.sj(this.h$,2,this.Qdm(Z.Dg),ea,!1,0,Ma=>{this.DKb(Ma,Z,da,Ja,Ka,na)},Ma=>{this.kKb(Ma,Z,da,Ja,Ka)},null,null,!1,4E3,this.YYb?3E4:6E3)}else w.TellMeActor.instance.Oe.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),da.resultsUpdated(pa);
else da.resultsUpdated(pa)}NCa(){-1!==this.U1&&(window.clearTimeout(this.U1),this.U1=-1)}DKb(Z,da,aa,ea,na,pa){const ja=new A.a(da);if(ea===this.bQ){this.NCa();w.TellMeActor.instance.Oe.u0(da.Dg.length,this.t$a.join(","),Z.data.Qe.toString(),Math.round(window.performance.now()-na),L.a.tellMe,!0,z.a.yPa);ea=Z.data.xe;Z=null;try{Z=W.b(ea)}catch(sa){w.TellMeActor.instance.Oe.onError("OnSuccessCallBack","Exception occured while deserializing response:"+sa);return}ea=G.a.YQ(da);if("Groups"in Z&&Z.Groups){var ma=
Z.Groups;for(var Ia of ma)if("GroupType"in Ia&&"Suggestions"in Ia&&Ia.Suggestions)if("Commands"===Ia.GroupType&&(pa?Array.contains(pa,17):1)||"Recommended"===Ia.GroupType&&(pa?Array.contains(pa,18):1)){var Ja=(ma="Recommended"===Ia.GroupType)?"DLIS":"NaiveBayes";"Source"in Ia&&Ia.Source&&(Ja=Ia.Source);var Ka=Ia.Suggestions;new m.a;var Ma=[];for(const sa of Ka)this.JSm(sa)&&(Ka=sa.Type,("Command"===Ka||ma&&"Recommended"===Ka)&&Ma.push(new J.a(sa.CommandId,sa.Score)));K.CommandResultsUtility.p2d(Ma,
!da.Dg.trim().length,Ia.GroupType,Ja);Ja=w.TellMeActor.instance.A2;Ka=[];for(const sa of Ma)ma&&Ja&&Ja.g9e(sa.commandId)||Ka.push(sa);Ma=K.CommandResultsUtility.gPc(da,Ka,this.fc,null,null,null,ma?18:17,0);0<Ma.results.length&&(this.Mea!==e.a.contextMenu&&(Ma.displayName=ma?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ja.Tu(Ma))}else if("Answer"===Ia.GroupType){Ka=Ia.Suggestions;ma=null;Ma=2147483647;Ja="";for(const sa of Ka)if(this.ISm(sa))if(Ja=sa.Type,Ka=
this.uRd(Ja),"Answer"===Ja&&this.rud){ma=this.kMh(Ja,sa,da.Dg);break}else Ka&&Ka<Ma&&(Ma=Ka,ma=this.kMh(Ja,sa,da.Dg));Ma=G.a.y5n(da.Dg,Ja);ma&&(pa?Array.contains(pa,ma.type):1)&&(Ja=[],this.qud?this.fc.Vva?(w.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ma.value,ma.$C)),w.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ma.value,ma.description)),w.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ma.value,
Ma))):(Ja.push(appChrome.actions.setControlLabel(ma.value,ma.$C)),Ja.push(appChrome.actions.updateCompoundButtonDescription(ma.value,ma.description)),Ja.push(appChrome.actions.setCompoundButtonCommandValueId(ma.value,Ma)),appChrome.api.dispatch(Ja)):this.fc.Vva?(w.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ma.value,ma.$C+" - "+ma.description)),w.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ma.value,Ma))):(Ja.push(appChrome.actions.setControlLabel(ma.value,
ma.$C+" - "+ma.description)),Ja.push(appChrome.actions.setButtonCommandValueId(ma.value,Ma)),appChrome.api.dispatch(Ja)),Ma=this.zcl(ma.type),Ma.Jw(ma),ja.Tu(Ma))}else"Help"===Ia.GroupType&&Ia.Suggestions.length&&(pa?Array.contains(pa,8):1)?this.SAc&&(ma=this.ALg.fib(da,Ia.Suggestions))&&0<ma.results.length&&ja.Tu(ma):"Template"===Ia.GroupType&&(pa?Array.contains(pa,23):1)?(ma=Ia.Suggestions)&&0<ma.length&&this.Zkk.fib(da,ja,ma):"Addin"===Ia.GroupType&&(pa?Array.contains(pa,27):1)?(ma=Ia.Suggestions)&&
0<ma.length&&this.uUj.fib(da,ja,ma):"ActionAI"===Ia.GroupType&&(pa?Array.contains(pa,25):1)?(Ma=Ia.Suggestions,ma=[],new v.a(25),Ma&&1===Ma.length&&(Ja=Ma[0])&&Ja.CommandId&&(Ma=Ja.CommandId,ma.push(new J.a(Ma,"Score"in Ja?Ja.Score:0)),ma=K.CommandResultsUtility.gPc(da,ma,this.fc,null,null,null,25,0),ma.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,ja.Tu(ma))):"Substrate"===Ia.GroupType&&this.vcb&&"Type"in Ia?"File"===Ia.Type&&this.tud&&(pa?Array.contains(pa,15):1)?(ma=this.Exb.Lpf(Ia.Suggestions,
ea,this.Mea))&&0<ma.results.length&&(this.CYd()&&(Ma=new n.a("GenerateSlidesFromTellMe",30,"",null,1),ma.Jw(Ma)),ja.Tu(ma)):"People"===Ia.Type&&this.PAc&&(pa?Array.contains(pa,14):1)?(ma=this.Exb.edi(Ia.Suggestions,ea,this.Mea))&&0<ma.results.length&&ja.Tu(ma):"Notes"===Ia.Type&&this.OAc&&(pa?Array.contains(pa,14):1)&&(ma=this.Exb.Lbi(Ia.Suggestions,ea,da))&&0<ma.results.length&&ja.Tu(ma):"Recall"===Ia.GroupType&&this.fc.Yfa&&"Type"in Ia&&"IntentService"===Ia.Type&&(pa?Array.contains(pa,15):1)&&(ma=
this.Exb.Lpf(Ia.Suggestions,ea,this.Mea))&&0<ma.results.length&&(this.CYd()&&(Ma=new n.a("GenerateSlidesFromTellMe",30,"",null,1),ma.Jw(Ma)),ja.Tu(ma));else w.TellMeActor.instance.Oe.onError("OnSuccessCallBack","GroupType"in Ia?"Invalid group suggestions found for "+Ia.GroupType:"Invalid group found")}if(Z.Intents){Ia=Z.Intents;for(const sa of Ia)this.VGf(sa)&&("Image"===sa.GroupType&&sa.ConfidenceScore>sa.ConfidenceThreshold&&(pa?Array.contains(pa,19):1)?this.A5j.fib(da,ja,0,sa):"Commands"===sa.GroupType&&
sa.ConfidenceScore<sa.ConfidenceThreshold&&(pa?Array.contains(pa,17):1)&&(Ia=new v.a(17),ja.Tu(Ia)))}aa.resultsUpdated(ja);w.TellMeActor.instance.Oe.u0(da.Dg.length,this.t$a.join(","),"",Math.round(window.performance.now()-na),"",!0,z.a.provider)}}kKb(Z,da,aa,ea,na){const pa=new A.a(da);ea===this.bQ&&(this.NCa(),w.TellMeActor.instance.Oe.u0(da.Dg.length,this.t$a.join(","),Z.data.Qe.toString(),Math.round(window.performance.now()-na),L.a.tellMe,!1,z.a.yPa));aa.resultsUpdated(pa)}uRd(Z){switch(Z){case "Entity":return this.Jfh?
3:0;case "Definition":return this.sud?5:0;case "WolframAnswer":return this.vud?2:0;default:return 0}}kMh(Z,da,aa){switch(Z){case "Answer":return new n.a(this.qud?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===da.Title?aa:da.Title,da.Description,0);case "Entity":return new n.a(this.qud?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===da.Title?aa:da.Title,da.Description,0);case "Definition":return new n.a(this.qud?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===da.Title?aa:da.Title,da.Description,
0);case "WolframAnswer":return new n.a("WolframForSearch",3,""===da.Title?aa:da.Title,da.Description,0);default:return null}}zcl(Z){switch(Z){case 0:return new v.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new v.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new v.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new v.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new v.a(19,this.fc.ljc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);
default:return null}}ISm(Z){return"Type"in Z&&!!Z.Type&&""!==Z.Type&&"Description"in Z&&!!Z.Description&&""!==Z.Description}JSm(Z){return"Type"in Z&&!!Z.Type&&""!==Z.Type&&"CommandId"in Z&&!!Z.CommandId&&""!==Z.CommandId&&"Score"in Z&&!!Z.Score}VGf(Z){if("GroupType"in Z&&Z.GroupType&&"ConfidenceScore"in Z&&"ConfidenceThreshold"in Z)return!0;w.TellMeActor.instance.Oe.onError("IsValidIntentGroup","Invalid intents found");return!1}Qdm(Z){const da=G.a.ZAi(Z),aa={};aa.Query=Z;da&&this.QAc&&(this.EMm()?
aa.UserActionEvents=w.TellMeActor.instance.jkh:(aa.CommandClickedEvents=w.TellMeActor.instance.sve,aa.CommandActionEvents=w.TellMeActor.instance.NOg),aa.TellMeCommandClickMruEvents=w.TellMeActor.instance.T6g,aa.ContentType=w.TellMeActor.instance.qHd);this.uud&&(Z={},Z.Application=this.fc.application,aa.TemplateInfo=Z);return W.c(aa)}FOb(){return!!this.fc&&this.fc.FOb||!!U.AFrameworkApplication.ta&&U.AFrameworkApplication.ta.Nb.FOb}GOb(){return!!this.fc&&this.fc.GOb||!!U.AFrameworkApplication.ta&&
U.AFrameworkApplication.ta.Nb.GOb}HOb(){return!!this.fc&&this.fc.HOb||!!U.AFrameworkApplication.ta&&U.AFrameworkApplication.ta.Nb.HOb}JOb(){return!!this.fc&&this.fc.JOb||!!U.AFrameworkApplication.ta&&U.AFrameworkApplication.ta.Nb.JOb}qjc(){return!!this.fc&&(this.fc.qjc||this.fc.pP)}pro(){return!!this.fc&&!this.fc.m3a}Jro(){return!!this.fc&&this.fc.VVc}oro(){return!!this.fc&&this.fc.IDm&&this.fc.FDm}Nhe(){return!!this.fc&&this.fc.Nhe}MBi(){return!!U.AFrameworkApplication.K&&U.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",
!1)}NBi(){return!!U.AFrameworkApplication.K&&U.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}EMm(){return!!U.AFrameworkApplication.K&&U.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}CYd(){return!!U.AFrameworkApplication.K&&U.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}dqj(){return!!U.AFrameworkApplication.K&&
U.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}Xhm(){return U.AFrameworkApplication.K?U.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}Rdm(){if(!U.AFrameworkApplication.K)return"";if(this.NBi())return U.AFrameworkApplication.K.jb("TellMeServiceProdEndpointForSearch");if(this.MBi())return U.AFrameworkApplication.K.jb("TellMeServiceEdogEndpointForSearch");if(G.a.vCf())return U.AFrameworkApplication.K.jb("TellMeServiceIntEndpointForSearch");
let Z=U.AFrameworkApplication.K.jb("TellMeServiceSearchEndpoint");Z&&""!==Z||(Z=U.AFrameworkApplication.pxj);return Z}static NMh(Z,da){if(da)return new V(Z,["Command","Recommended"],Z.yUl);da=G.a.nha()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new V(Z,da,Z.Xfi)}}Object(E.a)(V,"TellMeServiceProvider",null,[1121])},1859:function(E,M,c){c.r(M);c.d(M,"MarkerValidation",
function(){return a});E=c(0);var m=c(365),e=c(1759);class a{constructor(){this.RWd=this.Csi=this.Bsi=this.Asi=0}f7h(){const l=new m.a(0);l.Z("InvalidBookmarks",this.Asi);l.Z("InvalidComments",this.Bsi);l.Z("InvalidContentControls",this.Csi);0!==this.RWd&&l.Z("InvalidMarkerType",this.RWd);return l}Xli(){return 0<this.Asi||0<this.Bsi||0<this.Csi||0!==this.RWd?!0:!1}toString(){return JSON.stringify(e.a.xUa(this.f7h()))}}Object(E.a)(a,"MarkerValidation",null,[])},1860:function(E,M,c){c.d(M,"a",function(){return z});
E=c(0);var m=c(168),e=c(1032),a=c(235),l=c(1630),y=c(1551);class z{constructor(n,v,A,w,G=null,F=null,I=null,K=null){this.Yd=n;this.HF=v;this.sAa=A;this.LBa=w;this.Y$j=G;this.E1j=F;this.qmk=I;this.Sra=K||this.S$e()}S$e(){return n=>!!this.Yd.runtime.Xb&&this.Yd.runtime.Xb.isFeatureEnabled(n)}m9k(){return()=>this.Yd.runtime.Xb}Hff(){return!!this.Yd.runtime.tk.J(a.a.uL)}Ysj(){let n;if(1===this.Yd.input.source||2===this.Yd.input.source)n=81;else if(4===this.Yd.input.source||3===this.Yd.input.source)n=
39;else if(5===this.Yd.input.source)n=119;else return!1;return this.Hff()&&this.Sra(n)}cvj(n,...v){return String.format.apply(null,[n].concat(v))}TQd(n){const {ParagraphMerge:v}=c(1937);let A=this.Yd,w=this.sAa,G=this.LBa;n||(A=this.Y$j||this.Yd,w=this.E1j||w,G=this.qmk||G);var F=y.a.Erf(this.HF);const I=y.a.Erf(w),K=y.a.Erf(G);F=this.cvj("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",
A.input.source,A.runtime.WCa.id,A.runtime.sLd,A.runtime.Rme,F.$q(),I.$q(),K.$q());return n?{returnValue:new l.a(A,this.HF,w,G,this.S$e(),new e.a),$q:F}:{returnValue:new v(A,this.HF,w,G,this.S$e(),this.m9k(),new e.a),$q:F}}Nlc(){this.Yd.logger.mjo();var n=this.Ysj();var v=({$q:w}=this.TQd(n)).returnValue;m.a.instance.Ta(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",n,w);this.Yd.logger.zU("ParagraphMergeSelector initialization");n?this.Yd.logger.Hge(1):this.Yd.logger.Hge(2);
let A=({an:v}=v.Nlc()).returnValue;this.Yd.logger.Wag();var w=!A;n=!!this.Yd.runtime.tk.J(a.a.uL)&&(n&&!A||!n);w&&({$q:w,returnValue:v}=this.TQd(!1),{an:v,returnValue:A}=v.Nlc(),m.a.instance.Ta(18994390,1,A?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",A,w));n&&(w=new e.a,y.a.p4n(this.Yd,w));this.Yd.logger.zU("ParagraphMergeSelector finalization");return{returnValue:A,an:v}}Bad(n,v){let A,w,G;const F=this.Ysj()&&this.Sra(120);let I=({$q:G}=this.TQd(F)).returnValue,K=({O5a:A,
Rpa:w}=I.Bad(n,v)).returnValue;m.a.instance.Ta(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",F,G);F&&!K&&I.T7f&&({$q:G,returnValue:I}=this.TQd(!1),{O5a:A,Rpa:w,returnValue:K}=I.Bad(n,v),m.a.instance.Ta(18994392,1,K?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",K,G));return{returnValue:K,O5a:A,Rpa:w}}}Object(E.a)(z,"ParagraphMergeSelector",null,[1771])},1861:function(E,M,c){c.r(M);c.d(M,"SurfaceStringTokenStringGenerator",
function(){return e});E=c(0);var m=c(1578);class e extends m.a{constructor(a){super(a);this.Ab=a}apply(a,l,y,z,n,v,A){null==v&&(v=a.Whi(n,l));A=m.a.$oh(a,v,this.Ab.score,y,z,A);return{r$c:v,jFc:A}}}e.kFc=0;Object(E.a)(e,"SurfaceStringTokenStringGenerator",m.a,[])},1862:function(E,M,c){c.r(M);c.d(M,"QueryTokenStringGenerator",function(){return a});E=c(0);var m=c(1578),e=c(1476);class a extends m.a{constructor(l){super(l);this.Ab=l}apply(l,y,z,n,v,A,w){y=this.Ab.query.load(y,null);v=0;let G=null;this.Ab.query.U4===
e.Annotations.Yya?y&&(G=this.Ab.name):((G=this.Ab.name)&&(G+="_"),G+=this.Ab.annotations.wda(this.Ab.query.U4,y));null!=G&&(v=m.a.$oh(l,G,this.Ab.score,z,n,v));return{r$c:A,jFc:w+v}}}a.kFc=1;Object(E.a)(a,"QueryTokenStringGenerator",m.a,[])},1863:function(E,M,c){c.r(M);c.d(M,"FuzzyMatchTokenStringGenerator",function(){return e});E=c(0);var m=c(1578);class e extends m.a{constructor(a){super(a);this.Ab=a}apply(a,l,y,z,n,v,A){null==v&&(v=a.Whi(n,l));a=this.Ab.IWh.M6m(v);if(this.Ab.KXi)for(var w of a)if(!w.qO&&
w.kMd)return{r$c:v,jFc:A};w=0;for(const G of a)if(G.qO&&!({P4e:w}=this.buh(G,!0,y,z,w)).returnValue)return{r$c:v,jFc:A};if(this.Ab.jpi)for(const G of a)if(!({P4e:w}=this.buh(G,!1,y,z,w)).returnValue)break;return{r$c:v,jFc:A}}buh(a,l,y,z,n){let v;l?(l=0,v=a.kMd?1:0):(l=a.kMd?1:0,v=a.count-l);for(let A=0;A<v;++A)if(m.a.aph(a.Fgb+l+A,this.Ab.score,y,z),++n,0<this.Ab.sMf&&n>=this.Ab.sMf)return{returnValue:!1,P4e:n};return{returnValue:!0,P4e:n}}}e.kFc=2;Object(E.a)(e,"FuzzyMatchTokenStringGenerator",m.a,
[])},1927:function(E,M,c){E=c(0);var m=c(6),e=c(42),a=c(243),l=c(1475);class y extends l.a{constructor(){super()}get Mn(){return 2}get fA(){return 7}static jh(){return new y}static get instance(){return y.Lg.value}}y.Lg=new a.a(y.jh);Object(E.a)(y,"AppBindingNodeComplexMerge",l.a,[]);var z=c(15),n=c(798),v=c(168),A=c(1519);class w extends l.a{constructor(){super()}get Mn(){return 3}get fA(){return 7}vk(){const cb=super.vk();cb.Z(n.a.yb(z.a.dR),1);return cb}ZB(cb,Xa){if(Xa===n.a.yb(z.a.dR)){const Cb=
cb.Uk;var hb=cb.Zd;v.a.instance.Ta(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Cb.id,Cb.Pc,Xa);Xa=hb.getPropertyMilliseconds(cb.Ng.value.yf,z.a.dR);hb=hb.getPropertyMilliseconds(cb.sn.value.yf,z.a.dR);Xa<hb&&this.HPl(cb);cb.rg.add(n.a.yb(z.a.dR));return!0}v.a.instance.Ta(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Ng.value.yf.id,Xa);return!1}HPl(cb){this.p1n(cb.sn.value.yf,
cb.Uk);this.kof(cb,m.a.E0e);this.kof(cb,m.a.bsh);this.kof(cb,m.a.Rrh)}kof(cb,Xa){var hb=cb.Zd,Cb=cb.Uk;if(hb.hasProperty(Cb,Xa)&&(Xa=hb.getPropertyObjectIds(Cb,Xa))&&Xa.length)for(hb=cb.hq.runtime.Hq,cb=cb.hq.runtime.an,Cb=0;Cb<Xa.length;Cb++){const ob=Xa.J(Cb);if(!hb.nb(ob))continue;const ab=hb.J(ob).AK();cb.add(ob,new A.a(ab,!1))}}static jh(){return new w}static get instance(){return w.Lg.value}}w.Lg=new a.a(w.jh);Object(E.a)(w,"AppNodeComplexMerge",l.a,[]);class G extends l.a{constructor(){super()}get Mn(){return 4}get fA(){return 7}static jh(){return new G}static get instance(){return G.Lg.value}}
G.Lg=new a.a(G.jh);Object(E.a)(G,"AppPropNodeComplexMerge",l.a,[]);class F extends l.a{constructor(){super()}get Mn(){return 5}get fA(){return 7}static jh(){return new F}static get instance(){return F.Lg.value}}F.Lg=new a.a(F.jh);Object(E.a)(F,"AppRefNodeComplexMerge",l.a,[]);var I=c(365),K=c(602),J=c(223),N=c(19);class R{constructor(cb,Xa){this.id=cb;this.uzo=Xa}}Object(E.a)(R,"IdAndTime",null,[]);class O extends l.a{constructor(){super()}get Mn(){return 6}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.cZa),
1);return cb}ZB(cb,Xa){if(Xa===n.a.yb(m.a.cZa)){const hb=cb.Uk,Cb=cb.Zd;v.a.instance.Ta(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",hb.id,hb.Pc,Xa);Xa=Cb.getPropertyObjectIds(cb.Ng.value.Hu,m.a.cZa);const ob=Cb.getPropertyObjectIds(cb.Ng.value.yf,m.a.cZa),ab=Cb.getPropertyObjectIds(cb.sn.value.yf,m.a.cZa);Xa=this.dan(cb,Xa,ob,ab);0<Xa.length?Cb.setPropertyObjectIds(hb,m.a.cZa,Xa):hb.removeProperty(m.a.cZa);cb.rg.add(n.a.yb(m.a.cZa));
return!0}v.a.instance.Ta(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Ng.value.yf.id,Xa);return!1}dan(cb,Xa,hb,Cb){const ob=this.ZFa(Xa,hb,Cb),ab=Xa.SG(),Ib=hb.SG(),Yb=Cb.SG();Xa=l.a.filter(ob,Pc=>!ab.contains(Pc)&&Ib.contains(Pc));hb=l.a.filter(ob,Pc=>!ab.contains(Pc)&&Yb.contains(Pc));if(!Xa.length||!hb.length)return ob;const ub=new I.a;Xa.forEach(Pc=>{const Mc=new R(Pc,this.K3h(cb,Pc,!1));this.G3h(cb,Pc,!1).forEach(Ed=>
{ub.add(Ed,Mc);return!0});return!0});const Ac=new K.a;hb.forEach(Pc=>{const Mc=this.K3h(cb,Pc,!0);this.G3h(cb,Pc,!0).forEach(Ed=>ub.nb(Ed)?(Ac.add(ub.J(Ed).uzo>=Mc?Pc:ub.J(Ed).id),!1):!0);return!0});return l.a.filter(ob,Pc=>!Ac.contains(Pc))}K3h(cb,Xa,hb){return(Xa=this.xna(cb,Xa,hb))?cb.Zd.getPropertyMilliseconds(Xa,z.a.dR):0}xna(cb,Xa,hb){cb=hb?cb.hq.runtime.Hq:cb.hq.runtime.xu;return cb.nb(Xa)?cb.J(Xa):null}G3h(cb,Xa,hb){const Cb=new J.a,ob=new K.a,ab=cb.Zd;Xa=this.xna(cb,Xa,hb);var Ib=this.tei(ab,
Xa);if(Ib)for(Cb.add(Ib),ob.add(Ib),Xa=ab.getPropertyObjectIds(Xa,m.a.E0e),Ib=0;Xa&&Ib<Xa.length;Ib++){const Yb=this.tei(ab,this.xna(cb,Xa.J(Ib),hb));if(!Yb)break;ob.contains(Yb)||(Cb.add(Yb),ob.add(Yb))}return Cb}tei(cb,Xa){if(!cb.hasProperty(Xa,m.a.zdb)||!cb.hasProperty(Xa,m.a.J0b)||!cb.hasProperty(Xa,m.a.K0b))return null;const hb=cb.getPropertyString(Xa,m.a.zdb),Cb=cb.getPropertyString(Xa,m.a.J0b);cb=cb.getPropertyString(Xa,m.a.K0b);return N.a.QA(hb+";"+Cb+";"+cb)}static jh(){return new O}static get instance(){return O.Lg.value}}
O.Lg=new a.a(O.jh);Object(E.a)(O,"AppsNodeComplexMerge",l.a,[]);class L extends l.a{constructor(){super()}get Mn(){return 36}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.Zlg),1);cb.Z(n.a.yb(m.a.hbg),1);return cb}ZB(cb,Xa){v.a.instance.Ta(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",Xa);if(Xa===n.a.yb(m.a.Zlg)||Xa===n.a.yb(m.a.hbg)){const ab=n.a.qX(Xa);var hb=cb.Ng.value.yf,Cb=cb.sn.value.yf;const Ib=cb.Uk;var ob=cb.Zd.getPropertyStrings(cb.Ng.value.Hu,ab);hb=cb.Zd.getPropertyStrings(hb,
ab);Cb=cb.Zd.getPropertyStrings(Cb,ab);ob=this.ZFa(ob,hb,Cb);cb.Zd.setPropertyStrings(Ib,ab,ob);cb.rg.add(Xa);return!0}return!1}static jh(){return new L}static get instance(){return L.Lg.value}}L.Lg=new a.a(L.jh);Object(E.a)(L,"AutoSaveParametersNodeComplexMerge",l.a,[]);class U extends l.a{constructor(){super()}get Mn(){return 44}vk(){const cb=super.vk();cb.Z(n.a.yb(z.a.ff),1);return cb}ZB(cb,Xa){const hb=cb.hq.runtime.Xb;if(Xa===n.a.yb(z.a.ff))return v.a.instance.Ta(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
cb.Uk.id,cb.Uk.Pc,Xa),hb.pz(124),hb.isFeatureEnabled(124)?this.gan(cb,Xa):this.Fan(cb,Xa),!0;v.a.instance.Ta(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",cb.Ng.value.yf.id,Xa);return!1}gan(cb,Xa){const hb=n.a.qX(Xa),Cb=cb.Zd;var ob=Cb.getPropertyObjectIds(cb.Ng.value.Hu,hb),ab=Cb.getPropertyObjectIds(cb.Ng.value.yf,hb),Ib=Cb.getPropertyObjectIds(cb.sn.value.yf,hb);Ib=U.Nfm(cb,ab,Ib);ob=this.ZFa(ob,ab,
Ib);ab=cb.Uk;0<ob.length?Cb.setPropertyObjectIds(ab,hb,ob):ab.removeProperty(hb);cb.rg.add(Xa)}static jh(){return new U}static get instance(){return U.Lg.value}static Nfm(cb,Xa,hb){const Cb=new J.a,ob=new I.a;Xa.forEach(ab=>{const Ib=cb.hq.runtime.xu.J(ab);Ib&&ob.add(Ib.xX(m.a.jt).toString(),ab);return!0});hb.forEach(ab=>{var Ib=cb.hq.runtime.Hq.J(ab);Ib?(Ib=Ib.xX(m.a.jt).toString(),ob.nb(Ib)&&ob.get(Ib)!==ab?v.a.instance.Ta(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
Cb.add(ab)):Cb.add(ab);return!0});return Cb}}U.Lg=new a.a(U.jh);Object(E.a)(U,"BookmarkContainerNodeComplexMerge",l.a,[]);class W extends l.a{constructor(){super()}get Mn(){return 41}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.Gzb),1);cb.Z(n.a.yb(m.a.jt),1);return cb}ZB(cb,Xa){return Xa===n.a.yb(m.a.Gzb)?(cb.rg.add(n.a.yb(m.a.Gzb)),!0):Xa===n.a.yb(m.a.jt)?(cb.rg.add(n.a.yb(m.a.jt)),!0):!1}jf(cb){return cb&&cb.length?!1:!0}static jh(){return new W}static get instance(){return W.Lg.value}}W.Lg=new a.a(W.jh);
Object(E.a)(W,"BookmarkNodeComplexMerge",l.a,[]);class X extends l.a{constructor(){super();this.JXd=!1}get Mn(){return 7}vk(){const cb=super.vk();cb.Z(n.a.yb(z.a.ff),1);return cb}ZB(cb,Xa){if(Xa===n.a.yb(z.a.ff)){const ob=cb.Uk,ab=cb.Zd;var hb=cb.hq.runtime.Xb;hb&&(this.JXd=hb.isFeatureEnabled(75));v.a.instance.Ta(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",ob.id,ob.Pc,Xa);Xa=ab.getPropertyObjectIds(cb.Ng.value.Hu,z.a.ff);
hb=ab.getPropertyObjectIds(cb.Ng.value.yf,z.a.ff);var Cb=ab.getPropertyObjectIds(cb.sn.value.yf,z.a.ff);Xa=this.ran(Xa,hb,Cb);if(this.JXd&&0<Xa.length){hb=new Sys.StringBuilder;for(Cb=0;Cb<Xa.length;Cb++)hb.append(Xa.J(Cb).toString()+",");v.a.instance.Ta(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",ob.id,hb.toString())}0<Xa.length?ab.setPropertyObjectIds(ob,z.a.ff,Xa):ob.removeProperty(z.a.ff);cb.rg.add(n.a.yb(z.a.ff));return!0}v.a.instance.Ta(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
cb.Ng.value.yf.id,Xa);return!1}ran(cb,Xa,hb){const Cb=new J.a,ob=new I.a(0);this.Ozl(cb,hb,Cb,ob);return this.Hkl(Xa,ob,Cb)}Ozl(cb,Xa,hb,Cb){cb=cb||new J.a;Xa=Xa||new J.a;cb.forEach(ob=>{Cb.Z(ob,1);return!0});Xa.forEach(ob=>{Cb.Dc(ob).returnValue?Cb.Z(ob,2):(Cb.Z(ob,0),hb.add(ob));return!0})}Hkl(cb,Xa,hb){cb=cb||new J.a;const Cb=new J.a,ob=new J.a,ab=new J.a;cb.forEach(Ib=>{let Yb=!0,ub;({value:ub}=Xa.Dc(Ib)).returnValue&&(0===ub?Xa.Z(Ib,2):1===ub&&(Yb=!1));Yb?Cb.add(Ib):this.JXd&&ob.add(Ib);return!0});
hb.forEach(Ib=>{let Yb=!1,ub;({value:ub}=Xa.Dc(Ib)).returnValue?0===ub&&(Yb=!0,Xa.Z(Ib,2)):v.a.instance.Ta(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",Ib);Yb?Cb.add(Ib):this.JXd&&ab.add(Ib);return!0});this.zJi(ob,"Favored");this.zJi(ab,"Unfavored");return Cb}zJi(cb,Xa){if(cb.length){var hb=new Sys.StringBuilder;for(let Cb=0;Cb<cb.length;Cb++)hb.append(cb.J(Cb).toString()+",");v.a.instance.Ta(561637572,
1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",Xa,hb.toString())}}static jh(){return new X}static get instance(){return X.Lg.value}}X.Lg=new a.a(X.jh);Object(E.a)(X,"CommentContentNodeComplexMerge",l.a,[]);var V=c(1829);class Z extends l.a{constructor(){super()}get Mn(){return 8}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.Maa),3);cb.Z(n.a.yb(m.a.ZE),3);cb.Z(n.a.yb(m.a.HGc),2);cb.Z(n.a.yb(m.a.commentId),2);cb.Z(n.a.yb(m.a.YFh),2);cb.Z(n.a.yb(m.a.TCa),2);cb.Z(n.a.yb(m.a.yNa),1);cb.Z(n.a.yb(m.a.nib),
1);cb.Z(n.a.yb(m.a.njb),1);cb.Z(n.a.yb(m.a.z7),1);cb.Z(n.a.yb(m.a.CG),1);cb.Z(n.a.yb(m.a.GGc),2);cb.Z(n.a.yb(m.a.tEd),2);cb.Z(n.a.yb(m.a.H2b),2);cb.Z(n.a.yb(m.a.n8e),2);cb.Z(n.a.yb(m.a.gM),1);cb.Z(n.a.yb(z.a.ff),0);cb.Z(n.a.yb(m.a.wH),0);return cb}ZB(cb,Xa){if(Xa===n.a.yb(m.a.gM)){var hb=cb.Zd.getPropertyString(cb.sn.value.yf,m.a.gM);this.jf(hb)?cb.Uk.removeProperty(m.a.gM):cb.Uk.WSa(m.a.gM,hb);return!0}if(Xa!==n.a.yb(m.a.yNa)&&Xa!==n.a.yb(m.a.nib)&&Xa!==n.a.yb(m.a.njb)&&Xa!==n.a.yb(m.a.CG)&&Xa!==
n.a.yb(m.a.z7))return!1;var Cb=cb.Ng.value.yf,ob=cb.sn.value.yf;hb=cb.Uk;if(Xa===n.a.yb(m.a.yNa)){Cb=cb.Zd.getPropertyString(Cb,m.a.yNa);ob=cb.Zd.getPropertyString(ob,m.a.yNa);ob=this.jf(Cb)?ob:this.jf(ob)?Cb:null;if(this.jf(ob))return!0;cb.Zd.setPropertyString(hb,m.a.yNa,ob);cb.rg.add(n.a.yb(m.a.yNa));return!0}if(Xa===n.a.yb(m.a.njb))return Cb=cb.Zd.getPropertyBool(Cb,m.a.njb),ob=cb.Zd.getPropertyBool(ob,m.a.njb),Cb=null!=Cb?Cb:!1,Cb=(null!=ob?ob:!1)||Cb,cb.Zd.setPropertyBool(hb,m.a.njb,Cb),cb.rg.add(n.a.yb(m.a.njb)),
!0;if(Xa===n.a.yb(m.a.nib)){Cb=cb.Zd.getPropertyBool(Cb,m.a.nib);ob=cb.Zd.getPropertyBool(ob,m.a.nib);if(Cb===ob)return!0;Cb=null!=Cb?Cb:!1;Cb=(null!=ob?ob:!1)||Cb;cb.Zd.setPropertyBool(hb,m.a.nib,Cb);return!0}if(Xa===n.a.yb(m.a.CG)){Cb=cb.Zd.getPropertyBool(Cb,m.a.CG);ob=cb.Zd.getPropertyBool(ob,m.a.CG);if(Cb===ob)return!0;Cb=null!=Cb?Cb:!1;Cb=(null!=ob?ob:!1)||Cb;cb.Zd.setPropertyBool(hb,m.a.CG,Cb);cb.rg.add(n.a.yb(m.a.CG));return!0}if(Xa===n.a.yb(m.a.z7)){Xa=cb.hq.runtime.Xb;Xa.pz(V.a.G0k);if(!Xa.isFeatureEnabled(V.a.G0k))return!1;
Cb=cb.Zd.getPropertyString(Cb,m.a.z7);ob=cb.Zd.getPropertyString(ob,m.a.z7);if(Cb===ob)return!0;cb.Zd.setPropertyString(hb,m.a.z7,ob||Cb);cb.rg.add(n.a.yb(m.a.z7));return!0}return!1}jf(cb){return cb&&cb.length?!1:!0}static jh(){return new Z}static get instance(){return Z.Lg.value}}Z.Lg=new a.a(Z.jh);Object(E.a)(Z,"CommentNodeComplexMerge",l.a,[]);class da extends l.a{constructor(){super()}get Mn(){return 46}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.contentControlNode),1);cb.Z(n.a.yb(z.a.lastModifiedTime),
0);cb.Z(n.a.yb(m.a.hHc),2);return cb}ZB(cb,Xa){if(Xa===n.a.yb(m.a.contentControlNode))return v.a.instance.Ta(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",cb.Uk.id,cb.Uk.Pc,Xa),l.a.MMf(cb,this,m.a.contentControlNode);v.a.instance.Ta(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",cb.Ng.value.yf.id,Xa);return!1}static jh(){return new da}static get instance(){return da.Lg.value}}
da.Lg=new a.a(da.jh);Object(E.a)(da,"ContentControlContainerNodeComplexMerge",l.a,[]);var aa=c(58),ea=c(1749);class na extends l.a{constructor(){super()}get Mn(){return 37}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.C7),1);cb.Z(n.a.yb(m.a.Lpb),1);cb.Z(n.a.yb(m.a.tFd),2);cb.Z(n.a.yb(m.a.b3b),2);cb.Z(n.a.yb(m.a.contentControlNode),1);cb.Z(n.a.yb(m.a.v8),1);cb.Z(n.a.yb(m.a.Afa),1);cb.Z(n.a.yb(m.a.e3b),1);cb.Z(n.a.yb(m.a.Seb),1);cb.Z(n.a.yb(m.a.Qeb),1);cb.Z(n.a.yb(m.a.Peb),1);cb.Z(n.a.yb(m.a.YZa),2);cb.Z(n.a.yb(m.a.MAb),
1);cb.Z(n.a.yb(m.a.uFd),1);cb.Z(n.a.yb(m.a.B7),1);this.Xb.isFeatureEnabled(28)&&(cb.Z(n.a.yb(m.a.oU),2),cb.Z(n.a.yb(m.a.Lua),2),cb.Z(n.a.yb(m.a.Cma),2),cb.Z(n.a.yb(m.a.e4),1),cb.Z(n.a.yb(m.a.coa),1),cb.Z(n.a.yb(m.a.doa),1));return cb}ZB(cb,Xa){var hb=cb.Ng.value.yf,Cb=cb.sn.value.yf;const ob=cb.Uk;if(Xa===n.a.yb(m.a.contentControlNode))return l.a.MMf(cb,this,m.a.contentControlNode);if(Xa===n.a.yb(m.a.v8)){Xa=cb.Zd.getPropertyBool(hb,m.a.v8);Cb=cb.Zd.getPropertyBool(Cb,m.a.v8);if(null!=Xa&&Xa||null!=
Cb&&Cb)cb.Zd.setPropertyBool(ob,m.a.v8,!0),cb.rg.add(n.a.yb(m.a.v8));return!0}if(Xa===n.a.yb(m.a.Afa))return Xa=cb.Zd.getPropertyBool(hb,m.a.Afa),Cb=cb.Zd.getPropertyBool(Cb,m.a.Afa),cb.Zd.setPropertyBool(ob,m.a.Afa,null!=Xa&&!!Xa&&null!=Cb&&!!Cb),cb.rg.add(n.a.yb(m.a.Afa)),!0;if(Xa===n.a.yb(m.a.e3b))return Xa=cb.Zd.getPropertyUint32(Cb,m.a.e3b),null!=Xa&&(cb.Zd.setPropertyUint32(ob,m.a.e3b,Xa),cb.rg.add(n.a.yb(m.a.e3b))),!0;if(Xa===n.a.yb(m.a.Seb)||Xa===n.a.yb(m.a.Qeb)||Xa===n.a.yb(m.a.Peb))return(Cb=
cb.Zd.getPropertyString(Cb,n.a.qX(Xa)))&&0<Cb.length&&(cb.Zd.setPropertyString(ob,n.a.qX(Xa),Cb),cb.rg.add(Xa)),!0;if(Xa===n.a.yb(m.a.MAb)||Xa===n.a.yb(m.a.uFd)){hb=cb.Zd.getPropertyObjectId(hb,n.a.qX(Xa));if(ea.a.t7b(cb.hq,hb))return!0;if((Cb=cb.Zd.getPropertyObjectId(Cb,n.a.qX(Xa)))&&Cb!==aa.a.nil)return cb.Zd.setPropertyObjectId(ob,n.a.qX(Xa),Cb),cb.rg.add(Xa),!0;ob.removeProperty(n.a.qX(Xa));cb.rg.add(Xa);return!0}if(Xa===n.a.yb(m.a.B7)){hb=cb.Zd.getPropertyObjectId(hb,m.a.B7);if((hb=ea.a.t7b(cb.hq,
hb))&&cb.Zd.getPropertyObjectIds(hb,m.a.contentControlNode).SG().contains(cb.Uk.id))return!0;Cb=cb.Zd.getPropertyObjectId(Cb,m.a.B7);return(hb=ea.a.t7b(cb.hq,Cb))&&cb.Zd.getPropertyObjectIds(hb,m.a.contentControlNode).SG().contains(cb.Uk.id)?(cb.Zd.setPropertyObjectId(ob,m.a.B7,Cb),cb.rg.add(Xa),!0):!1}if(Xa===n.a.yb(m.a.C7))return Xa=cb.Zd.getPropertyBool(Cb,m.a.C7),null==Xa||Xa||(cb.Zd.setPropertyBool(ob,m.a.C7,!1),cb.rg.add(n.a.yb(m.a.C7))),!0;if(Xa===n.a.yb(m.a.Lpb)){Xa=cb.Zd.getPropertyObjectId(hb,
m.a.Lpb);Cb=cb.Zd.getPropertyObjectId(Cb,m.a.Lpb);if(Xa&&!Xa.equals(Cb))return!1;if(Xa=Xa||Cb)cb.Zd.setPropertyObjectId(ob,m.a.Lpb,Xa),cb.rg.add(n.a.yb(m.a.Lpb));return!0}!this.Xb.isFeatureEnabled(28)||Xa!==n.a.yb(m.a.e4)&&Xa!==n.a.yb(m.a.coa)&&Xa!==n.a.yb(m.a.doa)||v.a.instance.Ta(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",Xa);return!1}static jh(){return new na}static get instance(){return na.Lg.value}}na.Lg=new a.a(na.jh);
Object(E.a)(na,"ContentControlNodeComplexMerge",l.a,[]);class pa extends l.a{constructor(){super()}get Mn(){return 10}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.customXmlPartNode),1);return cb}ZB(cb,Xa){if(Xa===n.a.yb(m.a.customXmlPartNode)){Xa=cb.Uk;const Cb=cb.Zd;var hb=Cb.getPropertyObjectIds(cb.Ng.value.Hu,m.a.customXmlPartNode);const ob=Cb.getPropertyObjectIds(cb.Ng.value.yf,m.a.customXmlPartNode),ab=Cb.getPropertyObjectIds(cb.sn.value.yf,m.a.customXmlPartNode);hb=this.xan(hb,ob,ab);0<hb.length?
Cb.setPropertyObjectIds(Xa,m.a.customXmlPartNode,hb):Xa.removeProperty(m.a.customXmlPartNode);cb.rg.add(n.a.yb(m.a.customXmlPartNode));return!0}return!1}xan(cb,Xa,hb){return this.ZFa(cb,Xa,hb)}static jh(){return new pa}static get instance(){return pa.Lg.value}}pa.Lg=new a.a(pa.jh);Object(E.a)(pa,"CustomXmlPartContainerNodeComplexMerge",l.a,[]);class ja extends l.a{constructor(){super()}get Mn(){return 9}get fA(){return 0}static jh(){return new ja}static get instance(){return ja.Lg.value}}ja.Lg=new a.a(ja.jh);
Object(E.a)(ja,"CustomXmlPartNodeComplexMerge",l.a,[]);class ma extends l.a{constructor(){super()}get Mn(){return 29}get fA(){return 3}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.embeddedFontNode),1);return cb}ZB(cb,Xa){if(Xa===n.a.yb(m.a.embeddedFontNode)){Xa=cb.Zd;var hb=Xa.getPropertyObjectIds(cb.Ng.value.Hu,m.a.embeddedFontNode),Cb=Xa.getPropertyObjectIds(cb.Ng.value.yf,m.a.embeddedFontNode);const ob=Xa.getPropertyObjectIds(cb.sn.value.yf,m.a.embeddedFontNode);hb=this.ZFa(hb,Cb,ob);Cb=cb.Uk;0<hb.length?
Xa.setPropertyObjectIds(Cb,m.a.embeddedFontNode,hb):Cb.removeProperty(m.a.embeddedFontNode);cb.rg.add(n.a.yb(m.a.embeddedFontNode));return!0}return!1}static jh(){return new ma}static get instance(){return ma.Lg.value}}ma.Lg=new a.a(ma.jh);Object(E.a)(ma,"EmbeddedFontContainerNodeComplexMerge",l.a,[]);class Ia extends l.a{constructor(){super()}get Mn(){return 30}get fA(){return 3}static jh(){return new Ia}static get instance(){return Ia.Lg.value}}Ia.Lg=new a.a(Ia.jh);Object(E.a)(Ia,"EmbeddedFontNodeComplexMerge",
l.a,[]);class Ja extends l.a{constructor(){super()}get Mn(){return 11}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.G3),4);cb.Z(n.a.yb(m.a.v0a),1);return cb}ZB(cb,Xa){if(Xa===n.a.yb(m.a.v0a)){const hb=cb.Uk,Cb=cb.Zd;v.a.instance.Ta(4063307,1,4,"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",hb.id,hb.Pc,Xa);Xa=Cb.getPropertyObjectIds(cb.Ng.value.Hu,m.a.v0a);const ob=Cb.getPropertyObjectIds(cb.Ng.value.yf,m.a.v0a),ab=Cb.getPropertyObjectIds(cb.sn.value.yf,
m.a.v0a);Xa=this.gNi(Xa,ob,ab,(Ib,Yb)=>Ib.equals(Yb));0<Xa.length?Cb.setPropertyObjectIds(hb,m.a.v0a,Xa):hb.removeProperty(m.a.v0a);cb.rg.add(n.a.yb(m.a.v0a));return!0}v.a.instance.Ta(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Ng.value.yf.id,Xa);return!1}static jh(){return new Ja}static get instance(){return Ja.Lg.value}}Ja.Lg=new a.a(Ja.jh);Object(E.a)(Ja,"FootnoteEndnoteContainerNodeComplexMerge",
l.a,[]);class Ka extends l.a{constructor(){super()}get Mn(){return 12}get fA(){return 3}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.dna),1);return cb}ZB(cb,Xa){const hb=cb.Uk,Cb=cb.Zd;if(Xa===n.a.yb(m.a.dna)){let ob=-1;v.a.instance.Ta(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",hb.id,hb.Pc,Xa);const ab=Cb.getPropertyInt32(cb.Ng.value.yf,m.a.dna),Ib=Cb.getPropertyInt32(cb.sn.value.yf,m.a.dna);null!=ab&&-1!==ab?ob=ab:null!=Ib&&
(ob=Ib);Cb.setPropertyInt32(hb,m.a.dna,ob);cb.rg.add(Xa);return!0}v.a.instance.Ta(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Ng.value.Hu.id,Xa);return!1}static jh(){return new Ka}static get instance(){v.a.instance.Ta(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");return Ka.Lg.value}}Ka.Lg=new a.a(Ka.jh);Object(E.a)(Ka,"FootnoteEndnoteNodeComplexMerge",l.a,[]);class Ma extends l.a{constructor(){super()}get Mn(){return 47}vk(){const cb=
super.vk();cb.Z(n.a.yb(m.a.glossaryPageContentNode),1);return cb}ZB(cb,Xa){return Xa===n.a.yb(m.a.glossaryPageContentNode)?(v.a.instance.Ta(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",cb.Uk.id,cb.Uk.Pc,Xa),l.a.MMf(cb,this,m.a.glossaryPageContentNode)):!1}static jh(){return new Ma}static get instance(){return Ma.Lg.value}}Ma.Lg=new a.a(Ma.jh);Object(E.a)(Ma,"GlossaryPageManifestNodeComplexMerge",l.a,[]);class sa extends l.a{constructor(){super()}get Mn(){return 13}get fA(){return 3}vk(){const cb=
super.vk();cb.Z(n.a.yb(m.a.Hia),4);return cb}static jh(){return new sa}static get instance(){return sa.Lg.value}}sa.Lg=new a.a(sa.jh);Object(E.a)(sa,"HeaderFooterContainerNodeComplexMerge",l.a,[]);class xa extends l.a{constructor(){super()}get Mn(){return 14}get fA(){return 3}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.runId),3);cb.Z(n.a.yb(m.a.Lc),3);cb.Z(n.a.yb(m.a.sti),3);cb.Z(n.a.yb(m.a.kU),1);cb.Z(n.a.yb(e.a.O_),1);cb.Z(n.a.yb(z.a.imageAltText),1);cb.Z(n.a.yb(m.a.NX),1);cb.Z(n.a.yb(z.a.Bca),1);
cb.Z(n.a.yb(e.a.g8a),1);cb.Z(n.a.yb(m.a.$Ya),1);return cb}ZB(cb,Xa){if(Xa===n.a.yb(z.a.imageAltText)||Xa===n.a.yb(m.a.NX)||Xa===n.a.yb(m.a.kU)||Xa===n.a.yb(m.a.OX)||Xa===n.a.yb(z.a.zib)||Xa===n.a.yb(z.a.Bca)||Xa===n.a.yb(e.a.O_)||Xa===n.a.yb(e.a.g8a)||Xa===n.a.yb(m.a.$Ya)){const Cb=cb.Uk;var hb=cb.Zd;v.a.instance.Ta(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Cb.id,Cb.Pc,Xa);const ob=hb.getPropertyInt32(cb.Ng.value.yf,e.a.O_);hb=hb.getPropertyInt32(cb.sn.value.yf,
e.a.O_);if(null!=ob&&(0===ob||2===ob))return!0;if(null!=hb&&(0===hb||2===hb))return Xa=cb.sn.value.yf,this.Yeb(Xa,Cb,z.a.imageAltText),this.Yeb(Xa,Cb,m.a.NX),this.Yeb(Xa,Cb,m.a.OX),Xa.hasProperty(m.a.kU)&&this.Yeb(Xa,Cb,m.a.kU),this.Yeb(Xa,Cb,z.a.zib),this.Yeb(Xa,Cb,z.a.Bca),this.Yeb(Xa,Cb,e.a.O_),this.Yeb(Xa,Cb,e.a.g8a),cb.rg.add(n.a.yb(z.a.imageAltText)),cb.rg.add(n.a.yb(m.a.NX)),cb.rg.add(n.a.yb(m.a.OX)),cb.rg.add(n.a.yb(m.a.kU)),cb.rg.add(n.a.yb(z.a.zib)),cb.rg.add(n.a.yb(z.a.Bca)),cb.rg.add(n.a.yb(e.a.O_)),
cb.rg.add(n.a.yb(e.a.g8a)),cb.rg.add(n.a.yb(m.a.$Ya)),!0}v.a.instance.Ta(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Ng.value.Hu.id,Xa);return!1}static jh(){return new xa}static get instance(){return xa.Lg.value}}xa.Lg=new a.a(xa.jh);Object(E.a)(xa,"ImageNodeComplexMerge",l.a,[]);class ia extends l.a{constructor(){super()}get Mn(){return 40}get fA(){return 0}static jh(){return new ia}static get instance(){return ia.Lg.value}}
ia.Lg=new a.a(ia.jh);Object(E.a)(ia,"IntelligenceAnnotationNodeComplexMerge",l.a,[]);class ha extends l.a{constructor(){super()}get Mn(){return 32}get fA(){return 0}static jh(){return new ha}static get instance(){return ha.Lg.value}}ha.Lg=new a.a(ha.jh);Object(E.a)(ha,"IntelligenceContentLocatorNodeComplexMerge",l.a,[]);class ua extends l.a{constructor(){super()}get Mn(){return 34}get fA(){return 0}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.bjb),1);return cb}ZB(cb,Xa){const hb=cb.Uk,Cb=cb.Zd;if(Xa===
n.a.yb(m.a.bjb)){Xa=Cb.getPropertyObjectIds(cb.Ng.value.Hu,m.a.bjb);const ob=Cb.getPropertyObjectIds(cb.Ng.value.yf,m.a.bjb),ab=Cb.getPropertyObjectIds(cb.sn.value.yf,m.a.bjb);Xa=this.ZFa(Xa,ob,ab);Cb.setPropertyObjectIds(hb,m.a.bjb,Xa);cb.rg.add(n.a.yb(m.a.bjb));return!0}return!1}static jh(){return new ua}static get instance(){return ua.Lg.value}}ua.Lg=new a.a(ua.jh);Object(E.a)(ua,"IntelligenceRegionNodeComplexMerge",l.a,[]);class ya extends l.a{constructor(){super()}get Mn(){return 35}get fA(){return 0}static jh(){return new ya}static get instance(){return ya.Lg.value}}
ya.Lg=new a.a(ya.jh);Object(E.a)(ya,"IntelligenceRejectionNodeComplexMerge",l.a,[]);class ra extends l.a{constructor(){super()}get Mn(){return 39}get fA(){return 0}static jh(){return new ra}static get instance(){return ra.Lg.value}}ra.Lg=new a.a(ra.jh);Object(E.a)(ra,"IntelligenceReviewedNodeComplexMerge",l.a,[]);class La extends l.a{constructor(){super()}get Mn(){return 33}get fA(){return 0}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.NSc),1);cb.Z(n.a.yb(m.a.HWd),1);cb.Z(n.a.yb(m.a.JAf),1);cb.Z(n.a.yb(m.a.LAf),
1);return cb}ZB(cb,Xa){const hb=cb.Uk,Cb=cb.Zd;if(Xa===n.a.yb(m.a.NSc)||Xa===n.a.yb(m.a.HWd)||Xa===n.a.yb(m.a.JAf)||Xa===n.a.yb(m.a.LAf)){Xa=Xa===n.a.yb(m.a.NSc)?m.a.NSc:m.a.HWd;var ob=Cb.getPropertyObjectIds(cb.Ng.value.Hu,Xa);const ab=Cb.getPropertyObjectIds(cb.Ng.value.yf,Xa),Ib=Cb.getPropertyObjectIds(cb.sn.value.yf,Xa);ob=this.ZFa(ob,ab,Ib);Cb.setPropertyObjectIds(hb,Xa,ob);cb.rg.add(n.a.yb(Xa));return!0}return!1}static jh(){return new La}static get instance(){return La.Lg.value}}La.Lg=new a.a(La.jh);
Object(E.a)(La,"IntelligenceRootNodeComplexMerge",l.a,[]);class oa extends l.a{constructor(){super()}get Mn(){return 42}get fA(){return 0}static jh(){return new oa}static get instance(){return oa.Lg.value}}oa.Lg=new a.a(oa.jh);Object(E.a)(oa,"IntelligenceSettingNodeComplexMerge",l.a,[]);class Ca extends l.a{constructor(){super()}get Mn(){return 45}get fA(){return 0}static jh(){return new Ca}static get instance(){return Ca.Lg.value}}Ca.Lg=new a.a(Ca.jh);Object(E.a)(Ca,"IntelligenceWorkflowNodeComplexMerge",
l.a,[]);class Aa extends l.a{constructor(){super()}get Mn(){return 15}get fA(){return 3}static jh(){return new Aa}static get instance(){return Aa.Lg.value}}Aa.Lg=new a.a(Aa.jh);Object(E.a)(Aa,"NumberListNodeComplexMerge",l.a,[]);var db=c(116);class eb extends l.a{constructor(){super()}get Mn(){return 16}get fA(){return 0}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.mzb),1);cb.Z(n.a.yb(db.a.v8e),7);cb.Z(n.a.yb(db.a.t8e),7);return cb}ZB(cb,Xa){const hb=cb.Uk,Cb=cb.Zd;if(Xa===n.a.yb(m.a.mzb))return this.BHf(Cb,
cb.Ng.value.yf,cb.sn.value.yf,hb,m.a.mzb),cb.rg.add(Xa),!0;v.a.instance.Ta(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Ng.value.Hu.id,Xa);return!1}static jh(){return new eb}static get instance(){return eb.Lg.value}}eb.Lg=new a.a(eb.jh);Object(E.a)(eb,"OutlineElementNodeComplexMerge",l.a,[]);class ib extends l.a{constructor(){super()}get Mn(){return 17}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.mzb),1);
cb.Z(n.a.yb(m.a.Jma),1);cb.Z(n.a.yb(db.a.aJ),1);cb.Z(n.a.yb(db.a.ncc),1);cb.Z(n.a.yb(db.a.Zha),8);return cb}ZB(cb,Xa){const hb=cb.Uk,Cb=cb.Zd;if(Xa===n.a.yb(m.a.mzb))return this.BHf(Cb,cb.Ng.value.yf,cb.sn.value.yf,hb,m.a.mzb),cb.rg.add(Xa),!0;if(Xa===n.a.yb(m.a.Jma)){var ob=Cb.getPropertyBool(cb.Ng.value.yf,m.a.Jma),ab=Cb.getPropertyBool(cb.sn.value.yf,m.a.Jma);Cb.setPropertyBool(hb,m.a.Jma,null==ob?!1:ob&&null==ab?!1:ab);cb.rg.add(Xa);return!0}if(Xa===n.a.yb(db.a.ncc))return this.BHf(Cb,cb.Ng.value.yf,
cb.sn.value.yf,hb,db.a.ncc),cb.rg.add(Xa),!0;if(Xa===n.a.yb(db.a.aJ))return ob=Cb.getPropertyBool(cb.Ng.value.yf,db.a.aJ),ab=Cb.getPropertyBool(cb.sn.value.yf,db.a.aJ),Cb.setPropertyBool(hb,db.a.aJ,null==ob?!0:ob||null==ab?!0:ab),cb.rg.add(Xa),!0;v.a.instance.Ta(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Ng.value.Hu.id,Xa);return!1}static jh(){return new ib}static get instance(){return ib.Lg.value}}ib.Lg=
new a.a(ib.jh);Object(E.a)(ib,"OutlineGroupNodeComplexMerge",l.a,[]);var lb=c(41),Ya=c(55);class Fa extends l.a{constructor(){super()}get Mn(){return 18}get fA(){return 2}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.FUd),3);cb.Z(n.a.yb(z.a.uY),this.fA);cb.Z(n.a.yb(m.a.$t),1);cb.Z(n.a.yb(m.a.e9),1);cb.Z(n.a.yb(m.a.Bq),1);cb.Z(n.a.yb(lb.a.qJ),1);cb.Z(n.a.yb(lb.a.p4a),1);return cb}ZB(cb,Xa){const hb=cb.Zd;if(cb.hq.runtime.Xb.isFeatureEnabled(72)){if(Xa===n.a.yb(m.a.$t)||Xa===n.a.yb(m.a.e9)||Xa===n.a.yb(lb.a.p4a)||
Xa===n.a.yb(m.a.Bq)||Xa===n.a.yb(lb.a.qJ))return this.xNo(hb,cb)}else if(Xa===n.a.yb(m.a.$t)||Xa===n.a.yb(m.a.Bq)){let Cb,ob;({XGc:Xa,J2a:Cb,z2a:ob}=this.A6e(Object(Ya.a)(hb,hb.getPropertyUint32s,"getPropertyUint32s"),cb.Ng.value.Hu,cb.Ng.value.yf,cb.sn.value.yf,m.a.$t,null));if(!ob&&!Cb)return v.a.instance.Ta(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",cb.Ng.value.yf.id,n.a.yb(m.a.$t)),!0;let ab,Ib,Yb;({XGc:ab,
J2a:Ib,z2a:Yb}=this.A6e(Object(Ya.a)(hb,hb.getPropertyObjectIds,"getPropertyObjectIds"),cb.Ng.value.Hu,cb.Ng.value.yf,cb.sn.value.yf,m.a.Bq,null));if(!Ib&&!Yb)return v.a.instance.Ta(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",cb.Ng.value.yf.id,n.a.yb(m.a.Bq)),!0;const ub=Ib&&!Yb;if((Cb&&!ob)!==ub)return v.a.instance.Ta(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
cb.Ng.value.yf.id,n.a.yb(m.a.$t),n.a.yb(m.a.Bq)),!1;ub&&(hb.setPropertyObjectIds(cb.Uk,m.a.Bq,ab),hb.setPropertyUint32s(cb.Uk,m.a.$t,Xa));v.a.instance.Ta(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",cb.Ng.value.yf.id,n.a.yb(m.a.$t),Cb,ob,n.a.yb(m.a.Bq),Ib,Yb);cb.rg.add(n.a.yb(m.a.Bq));cb.rg.add(n.a.yb(m.a.$t));
return!0}v.a.instance.Ta(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Ng.value.yf.id,Xa);return!1}ymi(cb,Xa,hb,Cb){let ob;({XGc:Xa,J2a:Cb,z2a:ob}=this.A6e(Xa,hb.Ng.value.Hu,hb.Ng.value.yf,hb.sn.value.yf,cb,Cb));return ob||Cb?{returnValue:!0,R8e:Xa,J2a:Cb,z2a:ob}:(v.a.instance.Ta(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
hb.Ng.value.yf.id.toString(),n.a.yb(cb)),{returnValue:!1,R8e:Xa,J2a:Cb,z2a:ob})}Bli(cb,Xa,hb,Cb,ob){let ab;let Ib,Yb,ub,Ac;({R8e:ab,J2a:Pc,z2a:Ib,returnValue:ub}=this.ymi(cb,Object(Ya.a)(hb,hb.getPropertyUint32s,"getPropertyUint32s"),Cb,null));({R8e:hb,J2a:ob,z2a:Yb,returnValue:Ac}=this.ymi(Xa,Object(Ya.a)(hb,hb.getPropertyObjectIds,"getPropertyObjectIds"),Cb,ob));var Pc=Pc&&!Ib;return ub&&Ac?Pc!==(ob&&!Yb)?(v.a.instance.Ta(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Cb.Ng.value.yf.id.toString(),n.a.yb(cb),n.a.yb(Xa)),{returnValue:2,$Ed:ab,ZEd:hb,Kke:Pc}):{returnValue:0,$Ed:ab,ZEd:hb,Kke:Pc}:{returnValue:1,$Ed:ab,ZEd:hb,Kke:Pc}}OCf(cb){let Xa=!0;cb.forEach(hb=>hb!==aa.a.nil?Xa=!1:!0);return Xa}pUl(cb,Xa,hb){return this.OCf(cb)&&this.OCf(Xa)&&this.OCf(hb)?!0:!1}xNo(cb,Xa){let hb,Cb,ob,ab,Ib,Yb;var ub=({$Ed:ab,ZEd:Ib,Kke:Cb}=this.Bli(lb.a.p4a,m.a.Bq,cb,Xa,null)).returnValue;if(2===ub||1===ub)return!0;({$Ed:ob,ZEd:Yb,Kke:hb,returnValue:ub}=this.Bli(m.a.$t,m.a.e9,
cb,Xa,Object(Ya.a)(this,this.pUl,"getExtendedGuidEquivalence")));if(2===ub||1===ub)return!0;let Ac;({XGc:ub,J2a:Pc,z2a:Ac}=this.nUk(Object(Ya.a)(cb,cb.getPropertyDictionary,"getPropertyDictionary"),Xa.Ng.value.Hu,Xa.Ng.value.yf,Xa.sn.value.yf,lb.a.qJ));if(!Ac&&!Pc)return v.a.instance.Ta(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Xa.Ng.value.yf.id.toString(),n.a.yb(lb.a.qJ)),!0;var Pc=Pc&&!Ac;if(hb!==Cb||hb!==
Pc)return v.a.instance.Ta(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",Xa.Ng.value.yf.id.toString(),n.a.yb(m.a.$t),n.a.yb(lb.a.p4a),n.a.yb(lb.a.qJ),Cb,hb,Pc),!0;hb&&(cb.setPropertyObjectIds(Xa.Uk,m.a.Bq,Ib),cb.setPropertyUint32s(Xa.Uk,lb.a.p4a,ab),cb.setPropertyObjectIds(Xa.Uk,
m.a.e9,Yb),cb.setPropertyUint32s(Xa.Uk,m.a.$t,ob),cb.setPropertyDictionary(Xa.Uk,lb.a.qJ,ub));v.a.instance.Ta(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingNSID: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",Xa.Ng.value.yf.id.toString(),Cb,hb,Pc);Xa.rg.add(n.a.yb(lb.a.p4a));Xa.rg.add(n.a.yb(m.a.Bq));Xa.rg.add(n.a.yb(m.a.$t));Xa.rg.add(n.a.yb(m.a.e9));Xa.rg.add(n.a.yb(lb.a.qJ));return!0}static jh(){return new Fa}static get instance(){return Fa.Lg.value}}
Fa.Lg=new a.a(Fa.jh);Object(E.a)(Fa,"PageContentNodeComplexMerge",l.a,[]);class $a extends l.a{constructor(){super()}get Mn(){return 19}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.CHa),1);cb.Z(n.a.yb(m.a.appsNode),2);cb.Z(n.a.yb(m.a.customXmlPartContainerNode),2);cb.Z(n.a.yb(m.a.intelligenceRootNode),1);return cb}ZB(cb,Xa){const hb=cb.Zd;if(Xa===n.a.yb(m.a.CHa)){var Cb=hb.getPropertyObjectIds(cb.Ng.value.Hu,m.a.CHa),ob=hb.getPropertyObjectIds(cb.Ng.value.yf,m.a.CHa),ab=hb.getPropertyObjectIds(cb.sn.value.yf,
m.a.CHa);if((Cb=this.Man(Cb,ob,ab,(Ib,Yb)=>Ib.equals(Yb),Ib=>{let Yb;({value:Yb}=cb.hq.runtime.Hq.Dc(Ib)).returnValue?cb.hq.runtime.an.Z(Ib,new A.a(Yb,!1)):v.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},cb.hq))&&0<Cb.length)return hb.setPropertyObjectIds(cb.Uk,m.a.CHa,Cb),cb.rg.add(n.a.yb(m.a.CHa)),!0}if(Xa===n.a.yb(m.a.intelligenceRootNode))return Cb=hb.getPropertyObjectIds(cb.Ng.value.Hu,m.a.intelligenceRootNode),
ob=hb.getPropertyObjectIds(cb.Ng.value.yf,m.a.intelligenceRootNode),ab=hb.getPropertyObjectIds(cb.sn.value.yf,m.a.intelligenceRootNode),Cb=this.ZFa(Cb,ob,ab),hb.setPropertyObjectIds(cb.Uk,m.a.intelligenceRootNode,Cb),cb.rg.add(Xa),!0;v.a.instance.Ta(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Ng.value.yf.id,Xa);return!1}static jh(){return new $a}static get instance(){return $a.Lg.value}}$a.Lg=new a.a($a.jh);
Object(E.a)($a,"PageManifestNodeComplexMerge",l.a,[]);class Db extends l.a{constructor(){super()}get Mn(){return 43}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.Nla),0);cb.Z(n.a.yb(m.a.hLb),0);cb.Z(n.a.yb(m.a.JHb),0);cb.Z(n.a.yb(m.a.Hna),1);cb.Z(n.a.yb(m.a.sessionId),3);cb.Z(n.a.yb(m.a.buildVersion),3);cb.Z(n.a.yb(m.a.$Q),1);cb.Z(n.a.yb(m.a.Hwi),1);cb.Z(n.a.yb(m.a.jv),1);return cb}ZB(cb,Xa){if(Xa===n.a.yb(m.a.$Q)||Xa===n.a.yb(m.a.Hwi)||Xa===n.a.yb(m.a.jv)){var hb=cb.sn.value.yf,Cb=cb.Ng.value.yf,ob=n.a.qX(Xa);
Cb=cb.Zd.getPropertyBool(Cb,ob);hb=cb.Zd.getPropertyBool(hb,ob);cb.Zd.setPropertyBool(cb.Uk,ob,null==Cb?!1:Cb&&null==hb?!1:hb);cb.rg.add(Xa);return!0}if(Xa===n.a.yb(m.a.Hna)){Xa=cb.Zd;hb=cb.Ng.value.Hu;Cb=cb.sn.value.yf;ob=cb.Ng.value.yf;hb=hb?Xa.getPropertyObjectId(hb,m.a.Hna):null;Cb=Cb?Xa.getPropertyObjectId(Cb,m.a.Hna):null;ob=ob?Xa.getPropertyObjectId(ob,m.a.Hna):null;v.a.instance.Ta(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",hb?hb.toString():
"NULL",Cb?Cb.toString():"NULL",ob?ob.toString():"NULL");if(Cb){if(ob&&Cb.equals(ob))return cb.rg.add(n.a.yb(m.a.Hna)),Xa.setPropertyObjectId(cb.Uk,m.a.Hna,Cb),!0;if(ea.a.dTd.equals(Cb))return cb.rg.add(n.a.yb(m.a.Hna)),Xa.setPropertyObjectId(cb.Uk,m.a.Hna,ea.a.dTd),!0}if(ob&&ea.a.dTd.equals(ob))return cb.rg.add(n.a.yb(m.a.Hna)),Xa.setPropertyObjectId(cb.Uk,m.a.Hna,ea.a.dTd),!0;v.a.instance.Ta(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",hb?hb.toString():
"NULL",Cb?Cb.toString():"NULL",ob?ob.toString():"NULL")}return!1}static jh(){return new Db}static get instance(){return Db.Lg.value}}Db.Lg=new a.a(Db.jh);Object(E.a)(Db,"PageMetadataNodeComplexMerge",l.a,[]);var gc=c(1760),Eb=c(145);class kb extends l.a{constructor(){super()}get Mn(){return 31}vk(){const cb=super.vk();cb.Z(n.a.yb(Eb.a.yA),1);cb.Z(n.a.yb(m.a.listID),3);cb.Z(n.a.yb(m.a.listLevel),1);cb.Z(n.a.yb(m.a.He),3);cb.Z(n.a.yb(m.a.m1b),3);cb.Z(n.a.yb(m.a.runId),3);cb.Z(n.a.yb(m.a.zKd),3);cb.Z(n.a.yb(z.a.fontColor),
3);cb.Z(n.a.yb(m.a.UGh),3);cb.Z(n.a.yb(m.a.Lc),1);cb.Z(n.a.yb(Eb.a.EXd),3);cb.Z(n.a.yb(Eb.a.pHf),3);cb.Z(n.a.yb(Eb.a.tUc),3);cb.Z(n.a.yb(m.a.qFl),3);cb.Z(n.a.yb(db.a.lDj),3);for(let Xa=0;Xa<kb.G3a.length;Xa++)cb.Z(kb.G3a[Xa],1);return cb}ZB(cb,Xa){var hb=cb.Zd;const Cb=cb.Uk;n.a.qX(Xa);if(Xa===n.a.yb(m.a.Lc)){hb=cb.Zd.getPropertyInt32(cb.sn.value.yf,m.a.Lc);if(null==hb||!hb)return!0;cb.Zd.setPropertyInt32(Cb,m.a.Lc,hb);cb.rg.add(Xa);return!0}if(Xa===n.a.yb(Eb.a.yA)){const ob=hb.getPropertyUint32(cb.Ng.value.yf,
Eb.a.yA),ab=hb.getPropertyUint32(cb.sn.value.yf,Eb.a.yA);if(null!=ob&&null!=ab&&ob===ab)return hb.setPropertyUint32(Cb,Eb.a.yA,ob),cb.rg.add(Xa),!0;if(null==ob&&null==ab)return Cb.removeProperty(Eb.a.yA),cb.rg.add(n.a.yb(Eb.a.yA)),!0;if(null!=ob&&null==ab)return hb.setPropertyUint32(Cb,Eb.a.yA,ob),cb.rg.add(Xa),!0;if(null==ob&&null!=ab)return hb.setPropertyUint32(Cb,Eb.a.yA,ab),cb.rg.add(Xa),!0}else{if(Xa===n.a.yb(m.a.listLevel))return this.OMo(hb,cb);if(Array.contains(kb.G3a,Xa))return this.NMo(cb)}return!1}NMo(cb){let Xa=
!0,hb=!0,Cb,ob;({wIm:Xa,RFm:hb,Ayl:Cb,w2k:ob}=this.oUk(cb));v.a.instance.Ta(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",cb.Ng.value.yf.id.toString(),Xa,hb);return Xa&&!hb?(this.XNi(ob,cb),!0):Xa?!1:(this.XNi(Cb,cb),!0)}oUk(cb){let Xa,hb,Cb,ob;const ab=cb.sn.value;let Ib;const Yb=cb.Ng.value;let ub;hb=Xa=!0;Cb=new I.a;ob=new I.a;for(let Ac=0;Ac<kb.G3a.length;Ac++){const Pc=kb.G3a[Ac],Mc=({value:Ib}=
ab.Fpa.Dc(Pc)).returnValue;({value:ub}=Yb.Fpa.Dc(Pc)).returnValue&&(Xa=this.rBj(cb.Ng,Cb,ub,Pc)&&Xa);Mc&&(hb=this.rBj(cb.sn,ob,Ib,Pc)&&hb)}return{wIm:Xa,RFm:hb,Ayl:Cb,w2k:ob}}rBj(cb,Xa,hb,Cb){const ob=n.a.qX(Cb);cb=cb.value.yf;Xa.Z(Cb,cb.hasProperty(ob)?cb.xX(ob):null);return!hb.YX}XNi(cb,Xa){const hb=Xa.Uk;for(let ob=0;ob<kb.G3a.length;ob++){var Cb=kb.G3a[ob];const ab=n.a.qX(Cb);(Cb=cb.J(Cb))?hb.WSa(ab,Cb):hb.removeProperty(ab)}for(cb=0;cb<kb.G3a.length;cb++)Xa.rg.add(kb.G3a[cb]);v.a.instance.Ta(578932994,
1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",Xa.Ng.value.yf.id.toString())}OMo(cb,Xa){const hb=Xa.Uk,Cb=cb.getPropertyInt32(Xa.Ng.value.yf,m.a.listLevel),ob=cb.getPropertyInt32(Xa.sn.value.yf,m.a.listLevel);return null!=Cb&&null!=ob&&Cb===ob?(cb.setPropertyInt32(hb,m.a.listLevel,Cb),Xa.rg.add(n.a.yb(m.a.listLevel)),!0):null==Cb&&null==ob?(hb.removeProperty(m.a.listLevel),Xa.rg.add(n.a.yb(m.a.listLevel)),!0):null!=Cb&&null==ob?(cb.setPropertyInt32(hb,m.a.listLevel,
Cb),Xa.rg.add(n.a.yb(m.a.listLevel)),!0):null==Cb&&null!=ob?(cb.setPropertyInt32(hb,m.a.listLevel,ob),Xa.rg.add(n.a.yb(m.a.listLevel)),!0):!1}static jh(){return new kb}static get instance(){return kb.Lg.value}}kb.Lg=new a.a(kb.jh);kb.G3a=[n.a.yb(m.a.$d),n.a.yb(m.a.Ws),n.a.yb(z.a.x4),n.a.yb(m.a.fca),n.a.yb(m.a.au),n.a.yb(m.a.Sr),n.a.yb(z.a.g0),n.a.yb(m.a.J2e),n.a.yb(z.a.font),n.a.yb(db.a.Qkb),n.a.yb(e.a.paragraphStyle)];Object(E.a)(kb,"PersistablePropertySetComplexMerge",l.a,[]);class bb extends l.a{constructor(){super()}get Mn(){return 21}get fA(){return 0}static jh(){return new bb}static get instance(){return bb.Lg.value}}
bb.Lg=new a.a(bb.jh);Object(E.a)(bb,"RevisionMetadataNodeComplexMerge",l.a,[]);class Gb extends l.a{constructor(){super()}get Mn(){return 48}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.p2i),3);return cb}static jh(){return new Gb}static get instance(){return Gb.Lg.value}}Gb.Lg=new a.a(Gb.jh);Object(E.a)(Gb,"ShadowNumberListNodeComplexMerge",l.a,[]);class Sa extends l.a{constructor(){super()}get Mn(){return 22}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.x3a),7);cb.Z(n.a.yb(m.a.$Uc),2);return cb}static jh(){return new Sa}static get instance(){return Sa.Lg.value}}
Sa.Lg=new a.a(Sa.jh);Object(E.a)(Sa,"SharedPersistablePropertySetComplexMerge",l.a,[]);class Pa extends l.a{constructor(){super()}get Mn(){return 38}get fA(){return 3}static jh(){return new Pa}static get instance(){return Pa.Lg.value}}Pa.Lg=new a.a(Pa.jh);Object(E.a)(Pa,"StylePropertySetComplexMerge",l.a,[]);var Ab=c(1571),nb=c(1618);class Rb extends l.a{constructor(){super()}get Mn(){return 23}get fA(){return 0}vk(){const cb=super.vk();cb.Z(n.a.yb(z.a.ff),4);cb.Z(n.a.yb(m.a.rowSpan),1);cb.Z(n.a.yb(m.a.colSpan),
1);cb.Z(n.a.yb(m.a.ghostCell),1);cb.Z(n.a.yb(lb.a.vMerge),1);cb.Z(n.a.yb(lb.a.gridSpan),1);cb.Z(n.a.yb(m.a.v7a),2);cb.Z(n.a.yb(m.a.Rpb),2);cb.Z(n.a.yb(m.a.YHa),2);cb.Z(n.a.yb(m.a.npb),5);return cb}RHb(cb){if(!cb)return v.a.instance.Ta(573957923,1,2,"Feature helper is null"),!1;cb.pz(106);return cb.isFeatureEnabled(106)}Pwa(cb){if(!cb)return v.a.instance.Ta(540120285,1,2,"Feature helper is null"),!1;cb.pz(107);return cb.isFeatureEnabled(107)}ZB(cb,Xa){cb.hq.runtime.QG("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+
Xa);var hb=Xa===n.a.yb(m.a.rowSpan)||Xa===n.a.yb(m.a.colSpan)||Xa===n.a.yb(m.a.ghostCell);this.Pwa(cb.hq.runtime.Xb)&&(hb=hb||Xa===n.a.yb(lb.a.vMerge)||Xa===n.a.yb(lb.a.gridSpan));if(!this.RHb(cb.hq.runtime.Xb))return!hb;var Cb=cb.sn.value.Hu,ob=nb.e(cb.hq,Cb,null);if(ob.equals(aa.a.nil))return v.a.instance.Ta(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",Cb.id),cb.hq.logger.Og(Object.assign(new Ab.a,{info:"Table node ID could not be found for table cell"})),
!1;var ab=cb.hq.runtime.EAb.J(ob).J(Cb.id);if(!ab)return!hb;Cb=cb.Uk;ob=cb.Zd;if(Xa===n.a.yb(m.a.ghostCell))return ob.setPropertyBool(Cb,m.a.ghostCell,ab.gg),cb.rg.add(n.a.yb(m.a.ghostCell)),!0;if(Xa===n.a.yb(m.a.rowSpan))return Xa=ab.rowSpan,ab=ab.colSpan,null!=Xa&&null!=ab&&(1<Xa||1<ab)?ob.setPropertyUint32(Cb,m.a.rowSpan,Xa):Cb.removeProperty(m.a.rowSpan),cb.rg.add(n.a.yb(m.a.rowSpan)),!0;if(Xa===n.a.yb(m.a.colSpan))return Xa=ab.rowSpan,hb=ab.colSpan,ab=ab.gg,null!=Xa&&null!=hb&&(1<Xa||1<hb)?ob.setPropertyUint32(Cb,
m.a.colSpan,hb):ab&&null!=hb?ob.setPropertyUint32(Cb,m.a.colSpan,hb):Cb.removeProperty(m.a.colSpan),cb.rg.add(n.a.yb(m.a.colSpan)),!0;v.a.instance.Ta(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",Xa);cb.hq.logger.Og(Object.assign(new Ab.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!hb}static jh(){return new Rb}static get instance(){return Rb.Lg.value}}
Rb.Lg=new a.a(Rb.jh);Object(E.a)(Rb,"TableCellNodeComplexMerge",l.a,[]);class Mb extends l.a{constructor(){super()}get Mn(){return 24}RHb(cb){if(!cb)return v.a.instance.Ta(573845782,1,2,"Feature helper is null"),!1;cb.pz(106);return cb.isFeatureEnabled(106)}get fA(){return 0}vk(){const cb=super.vk();cb.Z(n.a.yb(z.a.ff),1);cb.Z(n.a.yb(z.a.$0),1);cb.Z(n.a.yb(z.a.Oya),1);cb.Z(n.a.yb(m.a.Akc),1);cb.Z(n.a.yb(m.a.S9),1);cb.Z(n.a.yb(m.a.v7a),2);cb.Z(n.a.yb(m.a.Rpb),2);cb.Z(n.a.yb(m.a.YHa),2);return cb}ZB(cb,
Xa){cb.hq.runtime.QG("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+Xa);if(Xa===n.a.yb(z.a.ff)||Xa===n.a.yb(z.a.$0)||Xa===n.a.yb(m.a.Akc)||Xa===n.a.yb(m.a.S9)||Xa===n.a.yb(z.a.Oya)){const ob=cb.Uk;var hb=cb.Zd;v.a.instance.Ta(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",ob.id,ob.Pc,Xa);if(this.$nl(cb))return!1;var Cb=hb.getPropertyObjectIds(cb.Ng.value.Hu,z.a.ff);const ab=hb.getPropertyObjectIds(cb.Ng.value.yf,z.a.ff),
Ib=hb.getPropertyObjectIds(cb.sn.value.yf,z.a.ff);Cb=this.gNi(Cb,ab,Ib,(Yb,ub)=>Yb.equals(ub));if(0<Cb.length)return hb.setPropertyObjectIds(ob,z.a.ff,Cb),hb.setPropertyInt32(ob,z.a.Oya,Cb.length),this.RHb(cb.hq.runtime.Xb)&&({value:Xa}=cb.sn.value.Fpa.Dc(n.a.yb(z.a.$0)),{value:hb}=cb.Ng.value.Fpa.Dc(n.a.yb(z.a.$0)),Xa.YX?ob.WSa(z.a.$0,Xa.newValue):ob.WSa(z.a.$0,hb.newValue)),cb.rg.add(n.a.yb(z.a.ff)),cb.rg.add(n.a.yb(z.a.$0)),cb.rg.add(n.a.yb(z.a.Oya)),cb.rg.add(n.a.yb(m.a.Akc)),cb.rg.add(n.a.yb(m.a.S9)),
!0}v.a.instance.Ta(4018189,1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Ng.value.yf.id,Xa);return!1}$nl(cb){const Xa=cb.sn.value,hb=cb.Ng.value;let Cb,ob;({value:Cb}=Xa.Fpa.Dc(n.a.yb(z.a.$0)));({value:ob}=hb.Fpa.Dc(n.a.yb(z.a.$0)));return Cb.YX||ob.YX?Cb.YX&&ob.YX?(v.a.instance.Ta(4273304,1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",
Cb.oldValue,ob.newValue,Cb.newValue),cb.hq.logger.Og(Object.assign(new Ab.a,{oj:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):Mb.pSh(cb.hq,Cb,hb,"BaseConflict")||Mb.pSh(cb.hq,ob,Xa,"BaseFavored")?!0:!1:!1}static jh(){return new Mb}static get instance(){return Mb.Lg.value}static pSh(cb,Xa,hb,Cb){return Xa.YX&&({value:Xa}=hb.Fpa.Dc(n.a.yb(z.a.ff)),Xa.YX)?(v.a.instance.Ta(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",
Cb),cb.logger.Og(Object.assign(new Ab.a,{oj:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}Mb.Lg=new a.a(Mb.jh);Object(E.a)(Mb,"TableNodeComplexMerge",l.a,[]);class oc extends l.a{constructor(){super()}get Mn(){return 25}get fA(){return 0}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.Lc),3);cb.Z(n.a.yb(z.a.ff),4);cb.Z(n.a.yb(m.a.v7a),2);cb.Z(n.a.yb(m.a.Rpb),2);cb.Z(n.a.yb(m.a.YHa),2);cb.Z(n.a.yb(lb.a.Jhg),2);cb.Z(n.a.yb(lb.a.Ihg),2);cb.Z(n.a.yb(m.a.npb),5);return cb}static jh(){return new oc}static get instance(){return oc.Lg.value}}
oc.Lg=new a.a(oc.jh);Object(E.a)(oc,"TableRowNodeComplexMerge",l.a,[]);class xb extends l.a{constructor(){super()}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.vFo),2);cb.Z(n.a.yb(z.a.ff),1);return cb}ZB(cb,Xa){if(Xa===n.a.yb(z.a.ff)){const Cb=cb.Uk,ob=cb.Zd;v.a.instance.Ta(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Cb.id,Cb.Pc,Xa);var hb=ob.getPropertyObjectIds(cb.Ng.value.Hu,z.a.ff);const ab=ob.getPropertyObjectIds(cb.Ng.value.yf,
z.a.ff),Ib=ob.getPropertyObjectIds(cb.sn.value.yf,z.a.ff);if(hb=this.Yan(hb,ab,Ib))return 0<hb.length?ob.setPropertyObjectIds(Cb,z.a.ff,hb):Cb.removeProperty(z.a.ff),cb.rg.add(n.a.yb(z.a.ff)),!0}v.a.instance.Ta(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Ng.value.yf.id,Xa);return!1}Yan(cb,Xa,hb){const Cb=new I.a(0);cb.forEach(ab=>{Cb.Z(ab,0);return!0});Xa.forEach(ab=>{Cb.nb(ab)?Cb.Z(ab,1):Cb.Z(ab,3);return!0});
hb.forEach(ab=>{let Ib;({value:Ib}=Cb.Dc(ab)).returnValue?1===Ib?Cb.Z(ab,5):3===Ib?(v.a.instance.Ta(42754253,1,2,"TaskNode was found added by both sides of merge"),Cb.Z(ab,3)):Cb.Z(ab,2):Cb.Z(ab,4);return!0});const ob=new J.a;Cb.forEach((ab,Ib)=>{0!==Ib&&2!==Ib&&1!==Ib&&ob.add(ab);return!0});return ob}static jh(){return new xb}static get instance(){return xb.Lg.value}}xb.Lg=new a.a(xb.jh);Object(E.a)(xb,"TaskContentNodeComplexMerge",l.a,[]);class cc{equals(cb,Xa){return cb&&Xa?cb.UserId===Xa.UserId&&
cb.Provider===Xa.Provider&&cb.DisplayName===Xa.DisplayName&&cb.Email===Xa.Email:!cb&&!Xa}rM(){return 0}}Object(E.a)(cc,"CommentTaskPersonComparer",null,[202]);class Ob{equals(cb,Xa){return cb&&Xa?cb.startDate?cb.endDate?cb.startDate.getTime()===Xa.startDate.getTime()&&cb.endDate.getTime()===Xa.endDate.getTime():!Xa.endDate:!Xa.startDate:!cb&&!Xa}rM(){return 0}}Object(E.a)(Ob,"CommentTaskScheduleEqualityComparer",null,[202]);class Ub{equals(cb,Xa){if(!cb||!Xa)return!cb&&!Xa;if(!cb.extensions&&!Xa.extensions)return!0;
if(!cb.extensions||!Xa.extensions||cb.extensions.count!==Xa.extensions.count)return!1;let hb=!0;cb.extensions.forEach((Cb,ob)=>{let ab;return({value:ab}=Xa.extensions.Dc(Cb)).returnValue&&ob===ab?!0:hb=!1});return hb}rM(){return 0}}Object(E.a)(Ub,"ExtensionListEqualityComparer",null,[202]);class pb{ovl(cb,Xa){return cb&&Xa?cb.recordId===Xa.recordId&&pb.ZOg.equals(cb.user,Xa.user)&&pb.ZOg.equals(cb.assignee,Xa.assignee)&&cb.type===Xa.type&&cb.title===Xa.title&&cb.priority===Xa.priority&&cb.isLossy===
Xa.isLossy&&cb.completion===Xa.completion&&cb.commentId===Xa.commentId&&cb.time===Xa.time&&pb.GYj.equals(cb.schedule,Xa.schedule):!cb&&!Xa}equals(cb,Xa){return this.ovl(cb,Xa)}rM(){return 0}}pb.ZOg=new cc;pb.GYj=new Ob;new Ub;Object(E.a)(pb,"HistoryRecordEqualityComparer",null,[202]);var Zb=c(2040),Wa=c(1535);class Lb extends l.a{constructor(cb){super();this.tMa=cb}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.DPb),5);cb.Z(n.a.yb(m.a.taskId),2);cb.Z(n.a.yb(m.a.iFo),2);cb.Z(n.a.yb(m.a.mFo),2);cb.Z(n.a.yb(m.a.Qya),
1);return cb}Ikg(cb){if(!cb.sn.value.Hu&&!cb.Ng.value.Hu){const Xa=cb.Ng.value.yf.AK();Xa.removeProperty(m.a.Qya);const hb=cb.Ng.value.yf,Cb=cb.sn.value.yf;cb.Ng=new a.a(()=>new Wa.a(Xa,hb));cb.sn=new a.a(()=>new Wa.a(Xa,Cb))}return super.Ikg(cb)}ZB(cb,Xa){if(Xa!==n.a.yb(m.a.Qya))return v.a.instance.Ta(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Ng.value.yf.id,Xa),!1;const hb=cb.Uk,Cb=cb.Zd;v.a.instance.Ta(42754255,
1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",hb.id,hb.Pc,Xa);Xa=Cb.getPropertyString(cb.Ng.value.Hu,m.a.Qya);const ob=Cb.getPropertyString(cb.Ng.value.yf,m.a.Qya),ab=Cb.getPropertyString(cb.sn.value.yf,m.a.Qya);Xa=this.Xan(Xa,ob,ab);if(!Xa)return!1;0<Xa.length?Cb.setPropertyString(hb,m.a.Qya,Xa):hb.removeProperty(m.a.Qya);cb.rg.add(n.a.yb(m.a.Qya));return!0}Xan(cb,Xa,hb){cb=this.tMa.u4b(cb);Xa=this.tMa.u4b(Xa);hb=this.tMa.u4b(hb);if(!Lb.yzi(cb,
Xa))return v.a.instance.Ta(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!Lb.yzi(cb,hb))return v.a.instance.Ta(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;hb=Lb.u_k(cb.length,Xa,hb);return this.tMa.r$f(hb)}static jh(){const cb=new Zb.a;return new Lb(cb)}static get instance(){return Lb.Lg.value}static u_k(cb,Xa,hb){const Cb=new J.a;for(let ob=0;ob<Xa.length;ob++)Cb.add(Xa.J(ob));for(;cb<hb.length;cb++)Cb.add(hb.J(cb));
return Cb}static yzi(cb,Xa){const hb=cb.length;if(hb>Xa.length)return!1;for(let Cb=0;Cb<hb;Cb++)if(!Lb.N4j.equals(Xa.J(Cb),cb.J(Cb)))return Xa.J(Cb).recordId===cb.J(Cb).recordId&&v.a.instance.Ta(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}Lb.Lg=new a.a(Lb.jh);Lb.N4j=new pb;Object(E.a)(Lb,"TaskSingleNodeComplexMerge",l.a,[]);class qc extends l.a{constructor(){super()}get Mn(){return 26}vk(){const cb=super.vk();cb.Z(n.a.yb(z.a.ff),
1);return cb}ZB(cb,Xa){const hb=z.a.ff;if(Xa===n.a.yb(hb)){Xa=cb.Uk;const ob=cb.Zd;var Cb=ob.getPropertyObjectIds(cb.Ng.value.Hu,hb);const ab=ob.getPropertyObjectIds(cb.Ng.value.yf,hb),Ib=ob.getPropertyObjectIds(cb.sn.value.yf,hb);Cb=this.dbn(Cb,ab,Ib);ob.setPropertyObjectIds(Xa,hb,Cb);cb.rg.add(n.a.yb(hb));return!0}return!1}dbn(cb,Xa,hb){return this.ZFa(cb,Xa,hb)}static jh(){return new qc}static get instance(){return qc.Lg.value}}qc.Lg=new a.a(qc.jh);Object(E.a)(qc,"VectorClockContainerNodeComplexMerge",
l.a,[]);class Ra extends l.a{constructor(){super()}get Mn(){return 27}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.ZR),1);return cb}ZB(cb,Xa){const hb=m.a.ZR;if(Xa===n.a.yb(hb)){Xa=cb.Uk;const Cb=cb.Zd,ob=Cb.getPropertyUint32(cb.Ng.value.yf,hb)||0,ab=Cb.getPropertyUint32(cb.sn.value.yf,hb)||0;Cb.setPropertyUint32(Xa,hb,this.e1l(ob,ab));cb.rg.add(n.a.yb(hb));return!0}return!1}e1l(cb,Xa){return cb>Xa?cb:Xa}static jh(){return new Ra}static get instance(){return Ra.Lg.value}}Ra.Lg=new a.a(Ra.jh);Object(E.a)(Ra,
"VectorClockNodeComplexMerge",l.a,[]);class yb extends l.a{constructor(){super()}get Mn(){return 28}get fA(){return 0}vk(){const cb=super.vk();cb.Z(n.a.yb(m.a.KSh),3);cb.Z(n.a.yb(m.a.Lc),3);cb.Z(n.a.yb(m.a.LSh),5);cb.Z(n.a.yb(m.a.pNi),5);cb.Z(n.a.yb(m.a.Hia),5);return cb}static jh(){return new yb}static get instance(){return yb.Lg.value}}yb.Lg=new a.a(yb.jh);Object(E.a)(yb,"WordSectionNodeComplexMerge",l.a,[]);c.d(M,"a",function(){return Bb});class Bb{ZKh(cb,Xa){switch(cb.Pc){case 131073:return cb.hasProperty(m.a.imageType)||
cb.hasProperty(e.a.O_)?this.Zo(xa.instance,Xa):this.Zo(kb.instance,Xa);case 1074135140:return this.Zo(y.instance,Xa);case 1074135137:return this.Zo(w.instance,Xa);case 1074135139:return this.Zo(G.instance,Xa);case 1074135138:return this.Zo(F.instance,Xa);case 1074135136:return this.Zo(O.instance,Xa);case 1074135157:return this.Zo(L.instance,Xa);case 1074135152:return this.Zo(U.instance,Xa);case 1074135153:return this.Zo(W.instance,Xa);case 1074135126:return this.Zo(X.instance,Xa);case 1074135127:return this.Zo(Z.instance,
Xa);case 1074135145:return this.Zo(na.instance,Xa);case 1074135144:return this.Zo(da.instance,Xa);case 1074135142:return this.Zo(pa.instance,Xa);case 1074135143:return this.Zo(ja.instance,Xa);case 1074135163:return this.Zo(ma.instance,Xa);case 1074135164:return this.Zo(Ia.instance,Xa);case 1074135124:return this.Zo(Ja.instance,Xa);case 1074135125:return this.Zo(Ka.instance,Xa);case 1074135122:return this.Zo(sa.instance,Xa);case 393233:return this.Zo(xa.instance,Xa);case 1073872970:return this.Zo(xa.instance,
Xa);case 1074135170:return this.Zo(ia.instance,Xa);case 1074135168:return this.Zo(ha.instance,Xa);case 1074135166:return this.Zo(ua.instance,Xa);case 1074135167:return this.Zo(ya.instance,Xa);case 1074135169:return this.Zo(ra.instance,Xa);case 1074135165:return this.Zo(La.instance,Xa);case 393234:return this.Zo(Aa.instance,Xa);case 393229:return this.Zo(eb.instance,Xa);case 393241:return this.Zo(ib.instance,Xa);case 393227:return this.Zo(Fa.instance,Xa);case 131120:return this.Zo(Db.instance,Xa);
case 393271:return this.Zo($a.instance,Xa);case 393230:return this.Zo(gc.a.instance,Xa);case 131140:return this.Zo(bb.instance,Xa);case 1179649:return this.Zo(Sa.instance,Xa);case 1073872969:return this.Zo(Pa.instance,Xa);case 393252:return this.Zo(Rb.instance,Xa);case 393250:return this.Zo(Mb.instance,Xa);case 393251:return this.Zo(oc.instance,Xa);case 1074135154:return this.Zo(qc.instance,Xa);case 1074135161:return this.Zo(xb.instance,Xa);case 1074135162:return this.Zo(Lb.instance,Xa);case 1074135155:return this.Zo(Ra.instance,
Xa);case 1073872968:return this.Zo(yb.instance,Xa);case 1074135172:return this.Zo(Ca.instance,Xa);case 1074135171:return this.Zo(oa.instance,Xa);case 1074135149:return this.Zo(Ma.instance,Xa);case 1074135151:return this.Zo(Gb.instance,Xa)}return this.Zo(l.a.instance,Xa)}Zo(cb,Xa){cb.Xb=Xa?Xa():null;return cb}}Object(E.a)(Bb,"GraphNodeComplexMergeFactory",null,[1774])},1934:function(E,M,c){c.r(M);E=c(0);var m=c(1511),e=c(74),a=c(344),l=c(73),y=c(1488);class z{constructor(J,N,R,O=0){this.pki=J;this.groupType=
N;this.awf=O;this.b5c=R}}Object(E.a)(z,"SortingGroup",null,[]);class n{constructor(J,N,R,O){this.order=J;this.k8=N;this.Fjm=R;this.groupType=O}}Object(E.a)(n,"SortingProp",null,[]);var v=c(1481),A=c(1483),w=c(1480),G=c(25);class F{constructor(J,N){this.hLi={};this.gLi={};this.cLi=this.nLi=1;this.qyh(J,N)}Cxo(J,N,R){var O=w.a.YQ(R)?this.hLi:this.gLi;R=new e.a;for(var L of N)N=Object(l.a)(n,O[m.a[L.groupType].toLowerCase()]),G.c(N)||R.add(new a.a(N,L));R.Sc((W,X)=>W.key.order<X.key.order?-1:1);Array.clear(J);
L=v.TellMeActor.instance.OZ;for(N=0;N<R.count;){O=R.J(N).key.k8;var U=R.J(N).value;const W=new y.a(R.J(N).key.groupType);G.c(L)||L.Location===A.a.contextMenu||(W.displayName=R.J(N).key.Fjm);for(const X of U.results)W.Jw(X);for(U=++N;U<R.count&&R.J(U).key.k8===O;)this.hZe(W,R.J(U).value),U=++N;J.push(W)}}tWo(J,N){this.cLi=this.nLi=1;this.qyh(J,N)}qyh(J,N){this.Usj(J);for(var R=0;R<J.length;R++){let O=J[R];for(const L of O.b5c)this.Drk(L,R,O.pki,O.groupType)}this.Usj(N);for(J=0;J<N.length;J++){R=N[J];
for(const O of R.b5c)this.Crk(O,J,R.pki,R.groupType)}}Usj(J){J.sort((N,R)=>Object(l.a)(z,N).awf>Object(l.a)(z,R).awf?-1:1)}Drk(J,N,R,O){this.hLi[m.a[J].toLowerCase()]=new n(this.nLi++,N,R,O)}Crk(J,N,R,O){this.gLi[m.a[J].toLowerCase()]=new n(this.cLi++,N,R,O)}hZe(J,N){for(let R=0;R<N.results.length;R++)J.Jw(N.results[R])}}Object(E.a)(F,"BaseGroupingSorter",null,[]);class I{constructor(){this.k3d=[new z("",26,[26]),new z("",24,[24]),new z(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new z(CommonUIStrings.l_TellMeCommandProviderTitle,
7,[18,16,7]),new z(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new z("",13,[13]),new z("",22,[22])];this.f3d=[new z("",25,[25]),new z(CommonUIStrings.l_TellMeCommandProviderTitle,31,[17,0,1,8,28]),new z(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new z(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new z("",13,[13,24]),new z("",22,[22])];this.OKi=new F(this.k3d,this.f3d)}G8c(J,N,R,O=null,L=null){let U=!1;if(O){for(const W of w.a.YQ(R)?
this.k3d:this.f3d)this.VMn(W,O);U=!0}if(L){for(const W of w.a.YQ(R)?this.k3d:this.f3d)this.uWo(N,W,L);U=!0}U&&this.OKi.tWo(this.k3d,this.f3d);this.OKi.Cxo(J,N,R)}VMn(J,N){const R=new e.a;for(var O of J.b5c){const L=N[m.a[O].toLowerCase()];R.add(new a.a(G.c(L)?Number.MAX_VALUE:L,O))}if(R.count){R.Sc((L,U)=>L.key<U.key?-1:1);N=Array(R.count);for(O=0;O<R.count;O++)N[O]=R.J(O).value;J.b5c=N}}uWo(J,N,R){let O=0;for(const L of N.b5c)if(m.a[L].toLowerCase()in R&&R[m.a[L].toLowerCase()])for(const U of J)if(U.groupType===
L){O+=R[m.a[L].toLowerCase()];break}N.awf=O}}Object(E.a)(I,"SimplifiedGroupingSorter",null,[]);c.d(M,"GroupsPlacementInfo",function(){return K});class K{constructor(J){this.fLi={};this.dLi={};this.eLi={};this.iLi={};this.HLf={};this.jLi=this.x7m=this.s7m=this.u7m=1;this.kLi=null;this.Jv=J;this.ANk();this.vCn();this.mNk();this.oMk();J.pP&&(this.kLi=new I)}GE(J){this.fLi[m.a[J].toLowerCase()]=this.u7m++}sH(J,N){this.dLi[m.a[J].toLowerCase()]=N}IMa(J){this.eLi[m.a[J].toLowerCase()]=this.s7m++}Y2(J){this.iLi[m.a[J].toLowerCase()]=
this.x7m++}oC(J){this.HLf[m.a[J].toLowerCase()]=this.jLi++}ANk(){const J=!!this.Jv&&this.Jv.m3a,N=!!this.Jv&&this.Jv.V_c,R=!!this.Jv&&this.Jv.hkb,O=!!this.Jv&&this.Jv.CGf&&!w.a.wbc(),L=!!this.Jv&&this.Jv.VVc,U=!!this.Jv&&this.Jv.lXd,W=!!this.Jv&&this.Jv.GEf,X=!!this.Jv&&this.Jv.hXd;this.Jv&&(this.Jv.Yfa||this.Jv.PJd)&&this.GE(26);X&&this.GE(24);this.GE(4);this.GE(18);this.GE(16);this.GE(7);this.GE(17);this.GE(0);this.GE(1);W&&this.GE(28);L&&this.GE(23);J||this.GE(2);J&&!N||this.GE(8);this.GE(15);
R&&this.GE(20);this.GE(14);this.GE(9);this.GE(12);this.GE(10);this.GE(11);J&&this.GE(2);J&&!N&&this.GE(8);this.GE(19);U&&this.GE(27);this.GE(21);this.GE(13);O&&this.GE(22);this.GE(30)}vCn(){this.sH(21,1);this.sH(4,3);this.sH(18,3);this.sH(16,3);this.sH(7,3);this.sH(17,5);this.sH(0,5);this.sH(1,1);this.sH(28,2);this.sH(2,1);this.sH(8,2);this.sH(15,3);this.sH(14,2);this.sH(27,3);this.sH(9,1);this.sH(12,1);this.sH(10,1);this.sH(11,1);this.sH(19,1);this.sH(23,1);this.sH(13,1);this.sH(24,1);this.sH(25,
1);this.sH(20,2);this.sH(22,1);this.sH(26,1)}mNk(){this.IMa(4);this.IMa(0);this.IMa(17);this.IMa(7);this.IMa(16);this.IMa(18);this.IMa(15);this.IMa(20);this.IMa(8);this.IMa(14)}oMk(){this.Y2(14);this.Y2(10);this.Y2(12);this.Y2(9);this.Y2(11);this.Y2(20);this.Y2(15);this.Y2(8);this.Y2(2);this.Y2(1);this.Y2(27);this.Y2(7);this.Y2(18);this.Y2(16);this.Y2(17);this.Y2(0);this.Y2(4)}g4n(){this.HLf={};this.jLi=1}j$l(J,N,R){this.g4n();const O=!!this.Jv&&this.Jv.m3a,L=!!this.Jv&&this.Jv.V_c,U=!!this.Jv&&this.Jv.hkb,
W=!!this.Jv&&this.Jv.CGf&&!w.a.wbc(),X=!!this.Jv&&this.Jv.VVc,V=!!this.Jv&&this.Jv.lXd,Z=!!this.Jv&&this.Jv.GEf,da=!!this.Jv&&this.Jv.hXd,aa=!!this.Jv&&this.Jv.Nhe;J=J&&L;aa&&this.oC(25);this.oC(4);this.oC(18);this.oC(16);this.oC(7);this.oC(17);this.oC(0);this.oC(1);Z&&this.oC(28);X&&this.oC(23);O&&!L||!J||this.oC(8);N&&this.oC(15);O||this.oC(2);V&&this.oC(27);R&&this.oC(14);O&&!L||J||this.oC(8);N||this.oC(15);U&&this.oC(20);R||this.oC(14);this.oC(9);this.oC(12);this.oC(10);this.oC(11);O&&this.oC(2);
O&&!L&&this.oC(8);this.oC(19);this.oC(21);da&&this.oC(24);this.oC(13);W&&this.oC(22);return this.HLf}yO(){return this.Jv}}Object(E.a)(K,"GroupsPlacementInfo",null,[])},1936:function(E,M,c){E=c(0);var m=c(1759),e=c(58);class a{constructor(){this.source=0;this.wm=this.zUa=this.U9=null;this.Jha=0;this.VFb=!1;this.mode=this.sTa=0;this.qLc=null;this.rJb=e.a.create()}}Object(E.a)(a,"InputState",null,[]);class l{constructor(){this.timeout=this.succeeded=this.crash=!1;this.GM=null}}Object(E.a)(l,"OutputState",
null,[]);class y{constructor(){this.xqi=this.She=this.S7c=!1;this.Xb=this.W3d=this.HXf=this.cce=this.Chg=this.EAb=this.mNa=this.QG=this.zlb=this.Rjc=this.GOo=this.Byl=this.an=this.adf=this.Hq=this.xu=this.tk=this.Rme=this.sLd=this.WCa=null}}Object(E.a)(y,"RuntimeState",null,[]);c.d(M,"a",function(){return z});class z{constructor(){this.input=new a;this.runtime=new y;this.output=new l;this.logger=new m.a(this)}}Object(E.a)(z,"MergeState",null,[])},1937:function(E,M,c){c.r(M);E=c(0);var m=c(602),e=
c(223),a=c(168),l=c(110),y=c(1616),z=c(1708),n=c(1741),v=c(6),A=c(1927);class w{constructor(R,O){this.start=R;this.end=O}}Object(E.a)(w,"MergeDiffIdx",null,[]);class G{constructor(R,O,L,U=!1,W=null,X=null,V=!0){this.khd=this.jhd=this.TRg=this.Vwc=0;this.i_b=this.qte=null;this.Q$a=W||new A.a;this.Mg=L;this.pra=R.f5();this.Imk=O.f5();this.IP=new w(0,0);this.aT=new w(0,0);this.kDe=U;this.guc=V;this.Tra=X;this.xPk();this.yio()}get wK(){return this.pra}get RJ(){return this.Imk}get qz(){return this.Vwc}get gA(){return this.TRg}get Oua(){return this.jhd}get Ema(){return this.khd}get Ill(){const R=
new e.a;for(let O=this.qte.start;O<this.qte.end;O++)R.add(this.wK.ag(O));return R}get xef(){const R=new e.a;for(let O=this.i_b.start;O<this.i_b.end;O++)R.add(this.RJ.ag(O));return R}Gff(R){if(this.gA<R.gA){if(this.gA+this.Oua>R.gA)return!0}else if(this.gA>R.gA){if(R.gA+R.Oua>this.gA)return!0}else if(2===this.qz&&3===R.qz||3===this.qz&&2===R.qz||2===this.qz&&2===R.qz||3===this.qz&&3===R.qz)return!0;return!1}lbj(R,O,L,U){R.lG(O);R.PC(O,L);return U+=L.length-1}ptj(R,O,L,U,W){let X=this.wK.ag(R),V=this.RJ.ag(O);
if(!X||!V||!X.b7a&&!V.b7a)return{returnValue:!1,sCa:U,FIa:W};let Z=new e.a,da=new e.a;X.b7a&&(Z=X.O8c(),X=Z.ag(L?0:Z.length-1));V.b7a&&(da=V.O8c(),V=da.ag(L?0:da.length-1));if(!X.uA(V,this.Q$a,this.Tra,this.kDe,this.guc))return{returnValue:!1,sCa:U,FIa:W};Z.length&&(U=this.lbj(this.wK,R,Z,U));da.length&&(W=this.lbj(this.RJ,O,da,W));return{returnValue:!0,sCa:U,FIa:W}}gBl(R,O,L,U,W,X){for(;W<=L&&X<=U;){const V=R.ag(W),Z=O.ag(X);if(!V.uA(Z,this.Q$a,this.Tra,this.kDe,this.guc))break;this.IP.start+=V.length;
this.aT.start+=Z.length;W++;X++}return{I2e:W,Rlg:X}}eBl(R,O,L,U,W,X){for(;W>=L&&X>=U;){const V=R.ag(W),Z=O.ag(X);if(!V.uA(Z,this.Q$a,this.Tra,this.kDe,this.guc))return{returnValue:!0,sCa:W,FIa:X};W--;X--}return{returnValue:!1,sCa:W,FIa:X}}fBl(R,O,L,U){let W=!1;do({I2e:R,Rlg:O}=this.gBl(this.wK,this.RJ,L,U,R,O)),{sCa:L,FIa:U,returnValue:W}=this.ptj(R,O,!0,L,U);while(W);return{I2e:R,Rlg:O,sCa:L,FIa:U}}dBl(R,O,L,U){let W=!1;do{if(!({sCa:L,FIa:U}=this.eBl(this.wK,this.RJ,R,O,L,U)).returnValue)break;({sCa:L,
FIa:U,returnValue:W}=this.ptj(L,U,!1,L,U))}while(W);return{sCa:L,FIa:U}}xPk(){var R=0,O=0,L=this.wK.length-1,U=this.RJ.length-1;0<=L&&this.wK.ag(L);0<=U&&this.RJ.ag(U);({I2e:R,Rlg:O,sCa:L,FIa:U}=this.fBl(R,O,L,U));if(R<L||O<U)({sCa:L,FIa:U}=this.dBl(R,O,L,U));L++;U++;this.qte=new w(R,L);this.i_b=new w(O,U);this.IP.end=this.IP.start;this.aT.end=this.aT.start;for(var W=R;W<L;W++){var X=this.wK.ag(W);this.IP.end+=X.length}for(W=O;W<U;W++)X=this.RJ.ag(W),this.aT.end+=X.length;a.a.instance.Ta(3993809,
1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",R,L,O,U);a.a.instance.Ta(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.IP.start,this.IP.end,this.aT.start,this.aT.end);this.IP.start<=this.IP.end&&this.aT.start<=this.aT.end&&(R=this.wK.ag(R),O=this.RJ.ag(O),W=this.wK.ag(L),X=this.RJ.ag(U),L=this.wK.ag(L-1),U=this.RJ.ag(U-1),a.a.instance.Ta(3993811,
1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",R,W,O,X,L,U))}yio(){this.TRg=this.IP.start;this.jhd=this.khd=0;this.IP.start===this.IP.end&&this.aT.start===this.aT.end?this.Vwc=0:this.IP.start===this.IP.end&&this.aT.start<this.aT.end?(this.Vwc=1,this.khd=this.aT.end-this.aT.start):this.aT.start===this.aT.end&&this.IP.start<this.IP.end?(this.Vwc=2,this.jhd=this.IP.end-this.IP.start):(this.Vwc=
3,this.jhd=this.IP.end-this.IP.start,this.khd=this.aT.end-this.aT.start);a.a.instance.Ta(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.qz,this.gA,this.Oua,this.Ema)}cMm(R,O){return R.p4()&&O.p4()?R.runId===O.runId&&R.zg===O.zg:!1}iRm(R){if(!R.p4()||"\ufffc"!==R.text)return!1;R=R.iDb;return R?R.hasProperty(v.a.Wj)||R.hasProperty(v.a.DBd)||R.hasProperty(v.a.igf)||R.hasProperty(v.a.G3)||R.hasProperty(v.a.imageType)||R.hasProperty(v.a.tQa)||
R.hasProperty(v.a.NHb)||R.hasProperty(v.a.Ys)&&(R=this.Mg.getPropertyInt32(R,v.a.Ys))&&(36===R||35===R||24===R||23===R||33===R||34===R||44===R||45===R||42===R||43===R)?!0:!1:!1}BUc(R){return R.p4()&&!this.iRm(R)}cRk(){if(2===this.qz)return!1;var R=this.i_b.start;if(!R)return!1;let O=null;for(var L=this.i_b.start;L<this.i_b.end;L++){const U=this.RJ.ag(L);if(this.BUc(U)){O=U;break}}if(!O)return!1;--R;for(L=this.RJ.ag(R);L&&!this.BUc(L);)R--,L=this.RJ.ag(R);return L&&this.cMm(L,O)?!0:!1}Z8h(R){const O=
new e.a;for(let L=0;L<R.length;L++)R.J(L).b7a?O.PC(O.length,R.J(L).O8c()):O.insert(O.length,R.J(L));return O}eMm(){if(3!==this.qz||this.Oua!==this.Ema)return!1;const R=this.Z8h(this.Ill),O=this.Z8h(this.xef);if(R.length!==O.length)return!1;for(let L=0;L<R.length;L++)if(!R.J(L).uA(O.J(L),this.Q$a,this.Tra,!0,this.guc))return!1;return!0}dMm(){if(0!==this.qz&&3!==this.qz||this.wK.length!==this.RJ.length)return!1;let R=!1;for(let O=0;O<this.wK.length;O++){if(!this.wK.J(O).uA(this.RJ.J(O),this.Q$a,this.Tra,
!0,this.guc))return!1;if(3===this.wK.J(O).type||1===this.wK.J(O).type){const L=this.wK.J(O),U=this.RJ.J(O);R=L.runId!==U.runId||L.zg!==U.zg||R}}return R}}Object(E.a)(G,"MergeBlockDiff",null,[]);var F=c(1569);class I{constructor(R,O){this.id=R;this.index=O}}Object(E.a)(I,"ParagraphStartIndex",null,[]);var K=c(1630),J=c(1551);c.d(M,"ParagraphMerge",function(){return N});class N{constructor(R,O,L,U,W,X,V){this.gYb=this.Zvb=this.Qo=this.mx=null;this.Ah=!1;this.wjh=this.nUg=this.bMg=this.mta=this.jKa=
this.pra=null;this.Yd=R;this.HF=O;this.LBa=U;this.sAa=L;this.Sra=W;this.Tra=X;this.Mg=V}Bei(R){const O=new m.a;R.wK.forEach(L=>{2===L.type&&O.add(L.Gj);return!0});R.RJ.forEach(L=>{2===L.type&&O.remove(L.Gj);return!0});return O}Wai(R){const O=new e.a;R.RJ.forEach(L=>{2===L.type&&O.add(L.Gj);return!0});return O}HGh(R){const O=new e.a;let L=0,U=0;R.RJ.forEach(W=>{2===W.type&&(O.add(new I(W.Gj,L<R.gA?L:L<R.gA+R.Ema?R.gA:L-R.Ema+R.Oua)),L=U);U+=W.length;return!0});return O}W1k(R,O){var L=this.HGh(R);const U=
this.HGh(O);R=this.Bei(R);const W=this.Bei(O);O=new e.a;const X=new m.a;let V=0;for(let Z=0;Z<L.length;Z++){const da=L.J(Z);if(V<U.length){let aa=U.J(V);for(;V<U.length&&aa.index<=da.index;){if(aa.id.equals(da.id)){V++;break}R.contains(aa.id)||X.contains(aa.id)||(O.add(aa.id),X.add(aa.id));V++;aa=U.J(V)}}W.contains(da.id)||(O.add(da.id),X.add(da.id))}for(;V<U.length;)L=U.J(V),R.contains(L.id)||X.contains(L.id)||(O.add(L.id),X.add(L.id)),V++;return O}initialize(){if(this.Ah){const R=!!this.mx&&!!this.Qo;
this.Yd.logger.Og(Object.assign(new F.a,{oj:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return R}this.Ah=!0;if(!({wK:this.pra,pLc:this.jKa,qad:this.mta,oBd:this.bMg,tLd:this.nUg,Sme:this.wjh}=J.a.wLh(this.Yd,this.Mg,this.HF,this.sAa,this.LBa,this.Sra,!1,!1)).returnValue)return!1;this.mx=new G(this.pra,this.jKa,this.Mg,void 0,void 0,this.Tra);this.Qo=new G(this.pra,this.mta,this.Mg,void 0,void 0,this.Tra);a.a.instance.Ta(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",
this.mx.Oua,this.mx.Ema,this.Qo.Oua,this.Qo.Ema));return!0}sIa(){a.a.instance.Ta(593826836,1,4,"Attempting to merge with LCS");let R=!1;const O=new n.a(this.Mg,this.Yd);let L=null,U=null;var W=null;const X=Z=>this.Yd.runtime.tk.J(Z),V=Z=>this.Yd.runtime.Hq.J(Z)||this.Yd.runtime.tk.J(Z);this.mx=new G(this.pra,this.jKa,this.Mg,void 0,void 0,this.Tra,!1);this.Qo=new G(this.pra,this.mta,this.Mg,void 0,void 0,this.Tra,!1);({updateHints:L}=O.YMh(this.HF,X,this.sAa,Z=>this.Yd.runtime.xu.J(Z)||this.Yd.runtime.tk.J(Z),
this.mx.gA,this.mx.gA+this.mx.Oua,this.mx.gA+this.mx.Ema)).returnValue&&({updateHints:U}=O.YMh(this.HF,X,this.LBa,V,this.Qo.gA,this.Qo.gA+this.Qo.Oua,this.Qo.gA+this.Qo.Ema)).returnValue&&(R=!0);R||(a.a.instance.Ta(593826835,1,2,"Failed to create update hints with LCS"),R=!1);R&&(W=new K.a(this.Yd,this.HF,this.sAa,this.LBa,Z=>this.Yd.runtime.Xb?this.Yd.runtime.Xb.isFeatureEnabled(Z):!1,this.Mg,null,L,U),({an:W}=W.Nlc()).returnValue||(a.a.instance.Ta(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),
this.Yd.logger.Og(Object.assign(new F.a,{oj:"TryLCSMerge",eventId:"9zrqs"})),R=!1));a.a.instance.Ta(593826833,1,R?4:2,"TryLCSMerge: [Success: {0}]",R);return{returnValue:R,an:W}}Nlc(){let R;R=null;if(!this.initialize())return this.Yd.logger.zU("ParagraphMerge Initialize"),this.N3a(),{returnValue:!1,an:R};this.Yd.logger.zU("ParagraphMerge Initialize");let O;this.Yd.logger.Hge(2);let L=({sIa:O}=this.pol()).returnValue;L=L&&({an:R,sIa:O}=this.xOc(this.Yd,this.Mg,this.Sra,this.gYb,this.Zvb)).returnValue;
this.Yd.logger.Wag();if(!L){this.Yd.logger.zU("ParagraphMerge DoMergeInteral");if(O){this.Yd.logger.Hge(3);({an:R,returnValue:L}=this.sIa());this.Yd.logger.Wag();if(L)return{returnValue:!0,an:R};this.N3a();return{returnValue:!1,an:R}}this.N3a();return{returnValue:!1,an:R}}if(!({an:R,sIa:O}=this.xOc(this.Yd,this.Mg,this.Sra,this.gYb,this.Zvb)).returnValue)return this.Yd.logger.zU("ParagraphMerge DoMergeInteral"),this.N3a(),{returnValue:!1,an:R};this.Yd.logger.zU("ParagraphMerge DoMergeInteral");return{returnValue:!0,
an:R}}xOc(){let R;if(!({z9d:R}=J.a.xOc(this.Yd,this.Mg,this.Sra,this.gYb,this.Zvb)).returnValue)return this.Yd.logger.zU("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),this.N3a(),{returnValue:!1,an:R,sIa:!0};this.Yd.logger.zU("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,an:R,sIa:!1}}N3a(R=!1){a.a.instance.nja(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+R+"] BaseRevisionMergeBlocksList: {0}",this.bMg);a.a.instance.nja(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",
this.nUg);a.a.instance.nja(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.wjh);R=new e.a;J.a.Tcc(this.Mg,"BaseObjects_",this.HF,R);J.a.Tcc(this.Mg,"FavoredObjects_",this.sAa,R);J.a.Tcc(this.Mg,"ConflictObjects_",this.LBa,R);J.a.V0m(this.Yd,R)}Kzh(R){let O,L;L=O=0;if(0===this.mx.qz)O=this.Qo.gA;else if(1===this.mx.qz)O=this.Qo.gA<this.mx.gA?this.Qo.gA:this.Qo.gA===this.mx.gA?R||1!==this.Qo.qz?this.Qo.gA+this.mx.Ema:this.Qo.gA:this.Qo.gA+this.mx.Ema;else if(2===this.mx.qz||3===this.mx.qz)O=
this.Qo.gA<=this.mx.gA?this.Qo.gA:this.Qo.gA+(this.mx.Ema-this.mx.Oua);if(2===this.Qo.qz||3===this.Qo.qz)L=O+this.Qo.Oua;return{$ji:O,Yim:L}}JZh(R,O){let L;L=0;if(!O)return{returnValue:!0,EZc:L};let U=0,W=0;for(;U<R.length;){let X;for(let V=U;V<R.length;V++){U=V;X=R.J(V);const Z=X.length;W+=Z;if(!(W<O)){if(W>O)if(X.b7a)R.lG(U),R.PC(U,X.O8c()),W-=Z;else return a.a.instance.Ta(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",
O),this.Yd.logger.Og(Object.assign(new F.a,{oj:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,EZc:L};break}}if(W===O)return U++,L=U,{returnValue:!0,EZc:L}}a.a.instance.Ta(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",O);this.Yd.logger.Og(Object.assign(new F.a,{oj:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,EZc:L}}yEk(R,O,L){let U=0;var W=0,X=!1;const V=this.Qo.xef.f5();
if(this.Qo.cRk())for(--O;0<=O;O--){let Z=R.J(O);if(this.Qo.BUc(Z)){W=R.J(O);U=W.runId;W=W.zg;X=!0;break}}X||((W=R.J(L))&&this.Qo.BUc(W)?(U=W.runId,W=W.zg):W=U=0);for(R=0;R<V.length;R++)L=V.J(R),L.p4()&&(X=L,this.Qo.BUc(L)?(X.runId=U,X.zg=W):(X.runId=0,X.zg=0));return V}Pyi(R){if(2===R.length){const O=1===R.J(0).type?R.J(0):null;R=2===R.J(1).type;if(O&&R&&""===O.text)return!0}return!1}pol(){const R=this.mx.dMm();if(!R&&0===this.mx.qz)return this.gYb=this.Qo.RJ.f5(),this.Zvb=this.Wai(this.Qo),{returnValue:!0,
sIa:!1};if(0===this.Qo.qz)return this.gYb=this.mx.RJ.f5(),this.Zvb=this.Wai(this.mx),{returnValue:!0,sIa:!1};(this.Pyi(this.mx.RJ)||this.Pyi(this.Qo.RJ))&&this.Yd.logger.hIi(Object.assign(new F.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!R){var O=this.mx.Gff(this.Qo);O&&this.Sra(55)&&(a.a.instance.Ta(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.mx=new G(this.pra,this.jKa,this.Mg,!0,void 0,this.Tra),this.Qo=
new G(this.pra,this.mta,this.Mg,!0,void 0,this.Tra),O=this.mx.Gff(this.Qo));if(O)return a.a.instance.Ta(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),this.Yd.logger.Og(Object.assign(new z.a,{oj:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,sIa:!0}}var L;O=0;this.Zvb=this.W1k(this.mx,this.Qo);({$ji:L,Yim:W}=this.Kzh(!1));const U=this.mx.RJ.f5();if(!({EZc:L}=this.JZh(U,L)).returnValue||(2===this.Qo.qz||3===this.Qo.qz)&&!({EZc:O}=
this.JZh(U,W)).returnValue)return{returnValue:!1,sIa:!1};if(2===this.Qo.qz||3===this.Qo.qz){this.uic(U,O);this.uic(U,L-1);var W=null;for(var X=O-1;X>=L;X--)2===U.J(X).type&&(W=U.J(X)),U.lG(X);0<U.length&&(X=U.J(U.length-1),2!==X.type&&4!==X.type&&W&&(this.Yd.runtime.Xb.pz(77),this.Yd.runtime.Xb.isFeatureEnabled(77)&&(U.add(W),this.Zvb.add(W.Gj))));a.a.instance.Ta(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",O-L-1,L)}if(1===this.Qo.qz||3===this.Qo.qz)W=this.Qo.xef,
R&&(W=this.yEk(U,L,O)),this.uic(U,L-1),this.uic(U,L),this.uic(W,0),this.uic(W,W.length-1),U.PC(L,W),a.a.instance.Ta(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",L,R,W.$q());this.gYb=U;return{returnValue:!0,sIa:!1}}uic(R,O){0>O||O>=R.length||(R=R.J(O),Object(l.a)(y.a,R)&&(R.lQa=!0))}Bad(R,O){let L;L=O;if(!this.initialize())return{returnValue:!1,O5a:R,Rpa:L};if(this.Qo.Gff(this.mx))return this.N3a(!0),this.Yd.logger.Og(Object.assign(new z.a,
{oj:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,O5a:R,Rpa:L};if(0===this.Qo.qz||3===this.Qo.qz&&this.Qo.eMm())return{returnValue:!0,O5a:R,Rpa:O};let U;({$ji:U}=this.Kzh(!0));O<U||O===U&&(1!==this.Qo.qz||1===this.Qo.qz&&1===this.mx.qz&&O===this.mx.gA+this.mx.Ema)?L=O:(L=O+this.Qo.Ema-this.Qo.Oua,L<U&&(L=U));return{returnValue:!0,O5a:R,Rpa:L}}}Object(E.a)(N,"ParagraphMerge",null,[1771])},1938:function(E,M,c){c.r(M);E=c(0);var m=c(1637),e=c(1548),a=c(1511),l=c(1761),y=c(1547);class z{constructor(K=
"",J="",N="",R=-99999,O=-1,L=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=K?K:"";this.Description=J?J:"";this.Type=N?N:"";this.Score=R;this.Age=O;this.Count=L}}Object(E.a)(z,"Suggestion",null,[]);class n{constructor(K,J){this.GroupType=this.Suggestions=null;this.Suggestions=K;this.GroupType=J}}Object(E.a)(n,"SuggestionGroup",null,[]);class v{}v.help="help";v.answer="answer";v.commands="commands";v.gdo="servicecommands";v.template="template";Object(E.a)(v,
"SuggestionGroupType",null,[]);var A=c(1481),w=c(1480),G=c(2),F=c(35);c.d(M,"InteractionLogger",function(){return I});class I{constructor(K,J,N){this.Rye=0;this.eUe=this.Yvc=null;this.ye=K;this.iSe=this.ewe=this.KDe=!1;this.IZj=J;this.Wf=G.AFrameworkApplication.Ne;this.fc=N;this.Cgd=this.SMe=0}get Kpa(){return this.ye.Kpa}Qge(K){this.ye.Qge(K)}AJi(){if(this.Yvc){var K=0;for(const J of this.Yvc)this.ye.L4m(J,K++);this.Yvc=null}}beginQuery(K,J,N){this.ye.A4m(K,J,N)}Xlb(K,J){this.ye.CIk(K,J);this.KDe=
!0;this.iSe=!1}rxa(){this.KDe=!1;this.ewe||(this.AJi(),this.ye.lVh(this.Rye))}B4m(K,J){this.ye.C4m(K,J)}nkn(K,J,N,R,O){for(const L of this.IZj)if(K.startsWith(L)){this.iSe=!0;break}this.ye.d0m(K,J,N,R,O)}Ukn(K){this.ewe=!1;this.Rye=K;this.KDe||this.iSe||(this.AJi(),this.ye.lVh(this.Rye,!1))}Tkn(K,J){this.ye.j0m(K,J);this.ewe=!0}jmf(K,J){if(!K.count)return"";let N="";const R=Date.now();for(let O of K)K=(R-O.timeStamp)/1E3,K=w.a.gme(K),0<N.length&&(N+=";"),N+=J?O.commandId:O.controlId,N+=":",N+=K.toString();
return N}A4a(){var K=this.jmf(m.a.instance.oNc(),!1);0<K.length&&this.ye.b0m(K);K=this.jmf(m.a.instance.Vgb(),!0);0<K.length&&this.ye.u_m(K);K=this.jmf(m.a.instance.Osc,!0);0<K.length&&this.ye.i1m(K);K=A.TellMeActor.instance.U6g;0<K.length&&this.ye.y4m(F.c(K))}f5m(K){this.ye.J_m(K)}u0(K,J,N,R,O,L,U,W=null){this.ye.u2m(K,J,N,R,O,L,U,W)}HKf(K,J,N,R){this.ye.HKf(K,J,N,R)}DA(K,J,N=null){this.ye.DG(K,J,N)}onError(K,J,N=null){this.ye.PFa(K,J,N)}Jho(K){this.Yvc=K}qcm(K){const J=[];if(!K)return J;for(let N=
0;N<K.length;N++){const R=a.a[K[N].groupType].toLowerCase(),O=[],L=K[N].results;if(L){for(let U=0;U<L.length;U++)"findindocument"===R?Array.add(O,new z("","",R,L[U].score,L[U].Wzd,L[U].count)):Array.add(O,new z(L[U].label,L[U].description,R,L[U].score,L[U].Wzd,L[U].count));"answer"===R||"definition"===R||"wolframanswer"===R||"entity"===R?Array.add(J,new n(O,v.answer)):"classifier"===R||"appsforoffice"===R?Array.add(J,new n(O,v.commands)):"serviceclassifier"===R?Array.add(J,new n(O,v.gdo)):"assistance"===
R?Array.add(J,new n(O,v.help)):("document"===R||"people"===R||"findindocument"===R||"notes"===R||"image"===R||"template"===R)&&Array.add(J,new n(O,R))}}return J}guf(K,J){const N={};N.Query=J;N.SuggestionGroups=F.c(this.qcm(K));return F.c(N)}shi(K){const J={"Content-Type":"application/json",Accept:"application/json"};J["X-Office-Version"]=G.AFrameworkApplication.buildVersion;J["X-Office-Application"]=G.AFrameworkApplication.K.jb("Application");J["X-Office-Platform"]="WAC";J["X-TellMe-SqmUserId"]=G.AFrameworkApplication.K.jb("LoggableUserId")||
"";J["X-TellMe-SessionId"]=this.ye.Kpa.eoa;J["X-TellMe-SuggestionTypes"]="Ranker";J["X-TellMe-Culture"]=G.AFrameworkApplication.uiCulture;J["X-TellMe-ProcessSessionId"]=G.AFrameworkApplication.userSessionId;J["X-TellMe-Flights"]=K;J["X-TellMe-PartialQueryIndex"]=this.SMe;return J}DKb(K,J,N){this.u0(J.length,"RankerLogging",K.data.Qe.toString(),Math.round(window.performance.now()-N),y.a.oxj,!0,e.a.yPa)}kKb(K,J,N){this.u0(J.length,"RankerLogging",K.data.Qe.toString(),Math.round(window.performance.now()-
N),y.a.oxj,!1,e.a.yPa)}thi(){this.eUe||(this.eUe=new l.a(this.fc,null,6E3));return this.eUe.h$}KKf(K){const J=this.guf(this.Yvc,K),N=this.shi("RankerLogging"),R=window.performance.now();this.Wf.sj(this.thi(),2,J,N,!1,0,O=>{this.DKb(O,K,R)},O=>{this.kKb(O,K,R)},null,null,!1,4E3,6E3);this.SMe++}X3n(){this.SMe=0}cag(K){this.Cgd=K}}Object(E.a)(I,"InteractionLogger",null,[])},1940:function(E,M,c){c.r(M);E=c(0);var m=c(15),e=c(6),a=c(168),l=c(223),y=c(58),z=c(1700),n=c(1615),v=c(1567),A=c(1551);class w{constructor(K,
J,N=null){this.author=K;this.RYc=J;this.y_f=N||y.a.nil}uA(K){return K?this.author===K.author&&this.RYc===K.RYc&&this.y_f===K.y_f:!1}}Object(E.a)(w,"RunMergeBlockTrackedChangeAttribute",null,[]);class G{constructor(K,J,N){this.insertion=K||G.Ugf;this.deletion=J||G.Ugf;this.JGa=N||G.Ugf}get Hom(){return 0<this.insertion.author.length}get jom(){return 0<this.deletion.author.length}get kpm(){return 0<this.JGa.author.length}uA(K){return K?this.insertion.uA(K.insertion)&&this.deletion.uA(K.deletion)&&this.JGa.uA(K.JGa):
!1}}G.Ugf=new w("",0);Object(E.a)(G,"RunMergeBlockTrackedChangeInfo",null,[]);var F=c(1758);c.d(M,"ParagraphMergeBlockCreator",function(){return I});class I extends n.a{constructor(K,J,N,R,O,L,U){super();this.maxValue=Number.MAX_VALUE;this.bB=new z.a;this.JSb=null;this.LN=0;this.j0g=!1;this.Uwc="";this.jse=K;this.Hs=J;this.ou=N;this.jjk=R;this.gjd=O;this.s_g=L;this.Mg=U;if(this.Mg.hasProperty(this.Hs,m.a.mo))if(this.Mg.hasProperty(this.Hs,e.a.Lc))if(this.Mg.hasProperty(this.Hs,e.a.iq))if(this.Mg.hasProperty(this.Hs,
e.a.Vs))if(this.Mg.hasProperty(this.Hs,m.a.Gn))if(this.B2=this.Mg.getPropertyString(this.Hs,m.a.mo),this.jXe=this.Mg.getPropertyUint32(this.Hs,e.a.Lc),this.Zr=this.Mg.getPropertyUint32s(this.Hs,e.a.iq),this.Aqd=this.Mg.getPropertyUint32s(this.Hs,e.a.Vs),this.UAe=this.Mg.getPropertyObjectIds(this.Hs,m.a.Gn),this.B2||""===this.B2)if(this.B2.length||1!==this.UAe.length||(this.Zr.length||(this.Zr.add(0),a.a.instance.Ta(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),
this.Aqd.length||(this.Aqd.add(0),a.a.instance.Ta(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),this.Gak=this.KNd(this.Hs,e.a.LQf,this.Zr.length),this.Eyc=this.KNd(this.Hs,m.a.jxa,this.Zr.length),this.hla=this.KNd(this.Hs,m.a.Wob,this.Zr.length),this.uka=this.KNd(this.Hs,e.a.iPa,this.Zr.length),this.Rka=this.Hfm(this.Hs,e.a.LGa,this.Zr.length),this.iwm(),K=this.Mg.hasProperty(this.Hs,m.a.zm)?this.Mg.getPropertyUint32s(this.Hs,m.a.zm):new l.a,this.ptd=
A.a.Rlj(K,this.B2.length),this.Zr.length!==this.Aqd.length)a.a.instance.Ta(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",J.id);else if(this.Zr.length!==this.UAe.length)a.a.instance.Ta(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",J.id);else{this.s_g&&(this.Mg.hasProperty(this.Hs,e.a.zv)?this.JSb=this.Mg.getPropertyObjectIds(this.Hs,e.a.zv):(a.a.instance.Ta(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",
J.id),this.JSb=this.k_(this.Zr.length,y.a.nil)),this.Zr.length!==this.JSb.length&&(a.a.instance.Ta(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",J.id,this.Zr.length,this.JSb.length),this.JSb=this.k_(this.Zr.length,y.a.nil)));if(this.Zr.length!==this.Eyc.length||this.Zr.length!==this.hla.length||this.Zr.length!==this.uka.length||this.Zr.length!==this.Rka.length)this.Zr.length===this.Eyc.length||this.gjd||a.a.instance.Ta(8266445,
1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",J.id,this.Zr.length,this.Eyc.length),this.Zr.length===this.hla.length||this.gjd||a.a.instance.Ta(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",J.id,this.Zr.length,this.hla.length),this.Zr.length===this.uka.length||this.gjd||a.a.instance.Ta(20742792,
1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",J.id,this.Zr.length,this.uka.length),this.Zr.length===this.Rka.length||this.gjd||a.a.instance.Ta(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",J.id,this.Zr.length,this.Rka.length),K=this.Mg.getPropertyBool(this.Hs,m.a.m9e),a.a.instance.Ta(17877020,
1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",J.id,O,null==K?!1:K),this.Eyc=this.k_(this.Zr.length,!0),this.hla=this.k_(this.Zr.length,!1),this.uka=this.k_(this.Zr.length,!1),this.Rka=this.k_(this.Zr.length,0),this.Mg.setPropertyBool(this.Hs,m.a.m9e,!1);this.bB.o_o(this.Zr.length)?(this.ptd.length!==this.Zr.length+1&&a.a.instance.Ta(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",
J.id,this.Zr.length,this.ptd.length),this.L8j=!0):a.a.instance.Ta(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",J.id)}else a.a.instance.Ta(4322133,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",J.id);else a.a.instance.Ta(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",J.id);else a.a.instance.Ta(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",J.id);else a.a.instance.Ta(3993796,
1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",J.id);else a.a.instance.Ta(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",J.id);else a.a.instance.Ta(3993794,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",J.id)}iwm(){this.Mg.hasProperty(this.Hs,e.a.aFa)?this.bB.Zib=this.Mg.getPropertyBools(this.Hs,e.a.aFa):this.bB.Zib=this.k_(this.Zr.length,!1);this.Mg.hasProperty(this.Hs,e.a.Ofa)?this.bB.yfb=this.Mg.getPropertyBools(this.Hs,e.a.Ofa):
this.bB.yfb=this.k_(this.Zr.length,!1);this.Mg.hasProperty(this.Hs,e.a.bFa)?this.bB.Yib=this.Mg.getPropertyStrings(this.Hs,e.a.bFa):this.bB.Yib=this.k_(this.Zr.length,"");this.Mg.hasProperty(this.Hs,e.a.yDa)?this.bB.xfb=this.Mg.getPropertyStrings(this.Hs,e.a.yDa):this.bB.xfb=this.k_(this.Zr.length,"");this.Mg.hasProperty(this.Hs,e.a.cFa)?this.bB.$ib=this.Mg.getPropertyListOfMilliseconds(this.Hs,e.a.cFa):this.bB.$ib=this.k_(this.Zr.length,0);this.Mg.hasProperty(this.Hs,e.a.zDa)?this.bB.E_a=this.Mg.getPropertyListOfMilliseconds(this.Hs,
e.a.zDa):this.bB.E_a=this.k_(this.Zr.length,0);this.Mg.hasProperty(this.Hs,e.a.KGa)?this.bB.a5a=this.Mg.getPropertyBools(this.Hs,e.a.KGa):this.bB.a5a=this.k_(this.Zr.length,!1);this.Mg.hasProperty(this.Hs,e.a.oIa)?this.bB.Wmb=this.Mg.getPropertyStrings(this.Hs,e.a.oIa):this.bB.Wmb=this.k_(this.Zr.length,"");this.Mg.hasProperty(this.Hs,e.a.pIa)?this.bB.Ymb=this.Mg.getPropertyListOfMilliseconds(this.Hs,e.a.pIa):this.bB.Ymb=this.k_(this.Zr.length,0);this.Mg.hasProperty(this.Hs,e.a.Xya)?this.bB.Xmb=this.Mg.getPropertyObjectIds(this.Hs,
e.a.Xya):this.bB.Xmb=this.k_(this.Zr.length,y.a.nil)}KNd(K,J,N){return this.Mg.hasProperty(K,J)?this.Mg.getPropertyBools(K,J):this.k_(N,!1)}Hfm(K,J,N){return this.Mg.hasProperty(K,J)?this.Mg.getPropertyUint32s(K,J):this.k_(N,0)}k_(K,J){const N=new l.a;for(let R=0;R<K;R++)N.add(J);return N}Ydm(K){const J=this.ptd.ag(K);K=this.ptd.ag(K+1);return this.B2.substring(J,K)}kbi(){if(this.j0g)return null;var K=this.LN<this.Zr.length?this.Zr.ag(this.LN):this.maxValue;if(K===this.maxValue||this.jjk&&!this.B2.length)return this.j0g=
!0,K=new v.a(this.ou,this.Hs.id,this.jXe),this.Uwc=this.K0e(this.Uwc,K.toString()),K;const J=this.Aqd.ag(this.LN),N=this.UAe.ag(this.LN),R=this.Gak.ag(this.LN),O=this.Eyc.ag(this.LN),L=this.hla.ag(this.LN),U=this.uka.ag(this.LN),W=this.Rka.ag(this.LN),X=this.s_g?this.JSb.ag(this.LN):null;var V=null;this.bB.Zib.ag(this.LN)&&(V=new w(this.bB.Yib.ag(this.LN)||"",this.bB.$ib.ag(this.LN)));var Z=null;this.bB.yfb.ag(this.LN)&&(Z=new w(this.bB.xfb.ag(this.LN)||"",this.bB.E_a.ag(this.LN)));var da=null;this.bB.a5a.ag(this.LN)&&
(da=new w(this.bB.Wmb.ag(this.LN)||"",this.bB.Ymb.ag(this.LN),this.bB.Xmb.ag(this.LN)));V=new G(V,Z,da);Z=this.Ydm(this.LN);this.LN++;da=Z.startsWith("\ufddfHYPERLINK ");K=new F.a(this.jse,this.ou,this.Hs.id,J,K,N,Z,R,!da,O,L,U,W,V,X);this.Uwc=this.K0e(this.Uwc,K.toString());return K}Uai(){let K;K=null;var J="";if(!this.L8j)return{LMf:K,c4a:J};if(J=this.kbi())K=new l.a,K.add(J);for(;J=this.kbi();)K.add(J);J=this.Uwc;return{LMf:K,c4a:J}}}Object(E.a)(I,"ParagraphMergeBlockCreator",n.a,[])},1943:function(E,
M,c){c.r(M);E=c(0);var m=c(223),e=c(1615),a=c(1566);class l extends a.a{constructor(z,n){super(4,z,n)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Gj)}T6b(){return"Table"}clone(){return new l(this.source,this.Gj)}uA(z,n,v,A=!1){return super.uA(z,n,v,A)?this.Gj.equals(z.Gj):!1}get length(){return 1}}Object(E.a)(l,"TableMergeBlock",a.a,[]);c.d(M,"TableMergeBlockCreator",function(){return y});class y extends e.a{constructor(z,n){super();this.lMg=new l(n,z.id)}Uai(){let z;
z=new m.a;z.add(this.lMg);return{LMf:z,c4a:this.K0e("",this.lMg.toString())}}}Object(E.a)(y,"TableMergeBlockCreator",e.a,[])},2025:function(E,M,c){c.r(M);var m=c(2),e=c(0),a=c(55),l=c(174);class y extends l.a{constructor(Q){super(!1,!1,!0);this.udd=Q}start(){const Q={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.udd.iyf}};this.Wh("",Object(a.a)(this,this.H7f,"resultHandler"),Q)}H7f(Q,za){1===Q&&(this.udd.iyf=za.tooltipPersistenceEnabled)}}Object(e.a)(y,
"AccessibilitySettingsDialog",l.a,[]);var z=c(67),n=c(13);class v{constructor(Q,za){this.ga=Q;this.udd=za}Tb(){this.ga.qa(n.a.Qso,z.a.frame,Object(a.a)(this,this.Rso,"showAccessibilitySettingsDialogHandler"))}Rso(){(new y(this.udd)).start();return 32}}Object(e.a)(v,"AccessibilitySettingsDialogActor",null,[2009]);var A=c(457);const w=Q=>{const za=new A.a;m.AFrameworkApplication.Ne.sj(G(Q),1,null,null,!0,2,fb=>{200===fb.data.Qe?za.Ag("true"===fb.data.xe.toLowerCase()):za.Ag(!1)},()=>{za.Ag(!1)},null,
void 0,void 0,void 0,void 0,"7");return za.task},G=Q=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",m.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",Q,m.AFrameworkApplication.hm);var F=c(127);class I{constructor(){this.iVb=null}get iyf(){return!!this.iVb}set iyf(Q){Q!==this.iVb&&(this.iVb=Q,F.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Q),this.lAi()&&m.AFrameworkApplication.Ne.sj(G("saveHoverableRibbonTooltipIsEnabled"),
2,Q.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}qZm(){const Q=new A.a;if(this.iVb)Q.Ag(this.iVb);else if(this.lAi()){const za=w("getHoverableRibbonTooltipIsEnabled");za.continueWith(()=>{this.iVb=za.result;F.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(za.result);Q.Ag(za.result)},8)}else Q.Ag(!1)}lAi(){const Q=m.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),za=m.AFrameworkApplication.K.$("IsAnonymousUser");return Q&&
!za}}Object(e.a)(I,"AccessibilitySettingsInfo",null,[2008]);var K=c(179),J=c(34);class N{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}xc(Q){this.W=Q;this.W.register(I,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Rd(()=>new I).singleInstance();this.W.register(v,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Rd(()=>
new v(m.AFrameworkApplication.va,this.W.Na("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).singleInstance()}init(){const Q=this.W.Na("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),za=this.W.Na("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");Q&&za?(za.Tb(),Q.qZm()):J.b(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){K.a.instance.Fc(new N)}}
Object(e.a)(N,"AccessibilitySettingsPackage",null,[1,2]);var R=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},O=c(80);class L extends Sys.EventArgs{constructor(Q,za){super();this.ple=Q;this.actualValue=za}}Object(e.a)(L,"CpuMeterMonitorThresholdExceededEventArgs",
Sys.EventArgs,[]);class U{constructor(){this.gTb=[];this.XPg=this.twe=0;this.ri=null;this.ra=new O.a}init(Q,za,fb){this.ri=Q;this.twe=za;this.XPg=fb;this.ri.UZe(Object(a.a)(this,this.i6d,"onCpuMeterFrameAvailable"));this.qwk(Object(a.a)(this,this.Y6k,"cpuPercentThresholdExceeded"))}i6d(Q,za){za.yPi&&(Array.enqueue(this.gTb,za.yPi.CP),this.gTb.length>this.XPg&&(Array.dequeue(this.gTb),this.VTk()))}VTk(){var Q=this.gTb.length;let za=0;for(let fb=0;fb<Q;fb++){const Nb=Array.dequeue(this.gTb);za+=Nb;
Array.enqueue(this.gTb,Nb)}Q=za/Q;Q>this.twe&&this.ra.raiseEvent("CPTTE",new L(this.twe,Q))}Y6k(Q,za){J.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.vGd(za.ple,za.actualValue))}qwk(Q){this.ra.addHandler("CPTTE",Q)}vGd(Q,za){const fb={};fb.ThresholdValue=Q;fb.ActualValue=za;return fb}}Object(e.a)(U,"CpuMeterMonitor",null,[2011]);class W{constructor(){this.S=this.T=this.M=this.C=0}}Object(e.a)(W,"ProfileInformation",null,[]);var X=c(11),V=c(38),Z=c(238),da=c(82);class aa{constructor(Q=
0,za=0){this.Utb=!1;this.ptb={};this.fod=Q;this.xod=za;this.LVe=0;V.a.addHandler(window.self,X.a.erh,()=>{this.Utb=!0});V.a.addHandler(window.self,X.a.frh,()=>{this.Utb=!1})}hrh(Q,za,fb){const Nb=aa.generateKey(za,fb);Nb in this.ptb?za=this.ptb[Nb]:(za=new W,za.S=fb?1:0,this.ptb[Nb]=za,this.LVe++);za.C++;za.M=Q>za.M?Q:za.M;za.T+=Q}fCa(Q,za){this.hrh(Q,za,!1);this.Utb&&this.hrh(Q,za,!0)}getData(){if(0<this.xod&&this.LVe>this.xod)return this.kRl();const Q=0<this.fod,za={},fb=this.ptb;for(let tc in fb){var Nb=
tc;const bd=fb[tc];this.Dej(bd);Q&&bd.T>=this.fod&&(za[Nb]=bd)}return Q?da.a.jf(za)?null:za:this.ptb}kRl(){var Q=0<this.fod,za=[];const fb=this.ptb;for(let Nb in fb){const tc={key:Nb,value:fb[Nb]};let bd=tc.value;(!Q||bd.T>=this.fod)&&Array.add(za,tc)}if(za.length>this.xod)za.sort((Nb,tc)=>tc.value.T-Nb.value.T),za=za.slice(0,this.xod);else if(!za.length)return null;Q={};for(const Nb of za)za=Nb.value,this.Dej(za),Q[Nb.key]=za;return Q}Dej(Q){Q.M=Z.a.SU(Q.M,0);Q.T=Z.a.SU(Q.T,0)}reset(){this.ptb={};
this.LVe=0}static generateKey(Q,za){return za?Q+" [it]":Q}}Object(e.a)(aa,"FunctionCallAggregator",null,[868]);var ea=c(1076);class na{}Object(e.a)(na,"CpuMeterFrame",null,[]);class pa extends Sys.EventArgs{constructor(Q){super();this.yPi=Q}}Object(e.a)(pa,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class ja{}Object(e.a)(ja,"MiniTaskItemInfo",null,[]);class ma{}Object(e.a)(ma,"TaskItemInfo",null,[]);var Ia=c(1036),Ja=c(1389),Ka=c(189);class Ma{constructor(Q,za,fb,Nb,tc){this.Axb=0;this.DZ=
null;this.std=this.Ggh=0;this.Kdh=!1;this.yUb=0;this.$uc=!1;this.Csa=null;this.lld=0;this.oLe=new O.a;this.Pvd=[];this.Jz=Q;this.gJe=za;this.$Ae=fb;this.z5g=Nb;m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&this.Zbc();this.p1j=tc;this.aBe=new aa(100);this.s$j=Ia.a.eF(1,5,new Ja.a)}UZe(Q){this.oLe.addHandler("OnCpuMeterFrameAvailable",Q)}caj(Q){this.oLe.removeHandler("OnCpuMeterFrameAvailable",Q)}Zmb(Q,za,fb,Nb=null){fb=Nb?Nb.priority:7;const tc=this.Jz();
this.start(za,fb);try{Q()}finally{this.stop(za,Nb),Q=this.Jz()-tc,this.z5g.track(Q,za)}}ie(Q,za){const fb=this.Jz();try{Q()}finally{Q=this.Jz()-fb,this.$Ae.fCa(Q,za),0<this.Axb&&this.aBe.fCa(Q,za),this.z5g.track(Q,za)}}SVf(Q){const za=new ma;za.TN=Q.bLf;za.TP=Q.priority;this.x5i(1,za)}hdc(Q){this.lld|=Q}start(Q,za){if(!this.Axb){this.aBe.reset();const fb=this.ACi(Q);fb&&this.v3d(1);this.DZ=new ma;this.DZ.TN=Q;this.DZ.TP=za;this.DZ.ST=(new Date).toISOString();this.DZ.STS=Z.a.SU(this.Jz(),2);fb?this.DZ.UI=
1:this.kMm(Q)?this.DZ.UI=2:this.DZ.UI=0}this.Axb++}v3d(Q){this.yUb|=Q}BDd(Q=!0,za=0){this.yUb=Q?0:this.yUb&~za}stop(Q,za=null){let fb;this.Axb--;0>=this.Axb&&this.DZ&&(fb=this.Jz()-this.DZ.STS,this.std+=fb,this.gJe.fCa(fb,Q),this.ACi(Q)&&this.BDd(!1,1),this.DZ.TRT=Z.a.SU(fb,2),za&&(this.DZ.TQT=Z.a.SU(za.$Kn,2),this.DZ.TDT=Z.a.SU(za.LDi,2)),this.p1j&&(this.x5i(0,this.DZ),this.v2n()),this.Axb=0);0<=Q.indexOf(ea.a.NNo)&&this.hdc(2);0<=Q.indexOf(ea.a.rbj)&&this.hdc(4);1===(this.yUb&1)&&this.hdc(1);2===
(this.yUb&2)&&this.hdc(8)}v2n(){var Q=this.DZ.TRT;if(750<Q){let fb=this.aBe.getData();if(fb){const Nb={};for(let tc in fb){var za=fb[tc];const bd=tc;bd.startsWith("SiOp_")||bd.endsWith("[it]")||(Nb[bd]=Math.round(100*za.T/Q))}fb=Nb}Q=Object.assign(new ja,{B:this.DZ.STS,T:Q,S:fb});this.s$j.track(Q,this.DZ.TN)}}qxo(){var Q=this.Jz()-this.Ggh,za=Z.a.SU(this.std/Q*100,2);Q=new na;Q.CP=za;Q.II=this.lld;za=this.gJe.getData();da.a.count(za)&&(Q.LRT=za);za=this.$Ae.getData();da.a.count(za)&&(Q.FP=za);this.oLe.raiseEvent("OnCpuMeterFrameAvailable",
new pa(Q));this.Vtj()}Vtj(){this.gJe.reset();this.$Ae.reset();this.std=this.Axb=0;this.Ggh=this.Jz();this.lld=0;this.DZ=null}run(){this.Kdh?this.qxo():(this.Vtj(),this.Kdh=!0);this.Csa?this.Csa(Object(a.a)(this,this.run,"run"),1E3):window.setTimeout(Object(a.a)(this,this.run,"run"),1E3)}Pyd(Q,za,fb){const Nb=Array(2);Nb[0]=za;Nb[1]=fb;this.Pvd[Q]||(this.Pvd[Q]=[]);this.Pvd[Q].push(Nb)}x5i(Q,za){Q=this.Pvd[Q];if(!Ka.a.jf(Q))for(let Nb=0;Nb<Q.length;Nb++){var fb=Q[Nb];const tc=fb[0];fb=fb[1];tc&&!tc(za)||
fb(za)}}Zbc(){if(!this.$uc){const Q=window.setTimeout;this.Csa=(za,fb)=>Q(za,fb);this.$uc=!0}}ACi(Q){return Q.startsWith("key")||Q.startsWith("input")}kMm(Q){return Q.startsWith("click")||Q.startsWith("mouse")||Q.startsWith("pointer")}}Object(e.a)(Ma,"CpuMeter",null,[188]);class sa{constructor(Q){this.tqc=null;this.Xp=new A.a;this.Jz=Q}initialize(Q,za,fb,Nb=!1){this.tqc||(this.tqc=new Ma(this.Jz,Q,za,fb,Nb),this.Xp.Ag(this.tqc));return this.tqc}}Object(e.a)(sa,"CpuMeterProvider",null,[2010]);var xa=
c(167);class ia{constructor(Q=1){this.yD=[];this.dhd=[];this.aj=Q}qBl(){let Q=0;for(let za=0;za<this.yD.length;za++)this.yD[za]<this.yD[Q]&&(Q=za);return Q}fCa(Q,za){Q=Z.a.SU(Q,2);if(this.yD.length<this.aj)Array.add(this.yD,Q),Array.add(this.dhd,za);else{var fb=this.qBl();Q>this.yD[fb]&&(this.yD[fb]=Q,this.dhd[fb]=za)}}getData(){return this.yD.length?{["Vals"]:this.yD,["Desc"]:this.dhd}:null}reset(){this.yD=[];this.dhd=[]}}Object(e.a)(ia,"MaxDataAggregator",null,[868]);var ha=c(39),ua=c(22);class ya{get name(){return"Common.App.CpuMeter"}xc(Q){Q.register(sa,
"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").singleInstance().Rd(()=>new sa(ha.a.$e));Q.register(U,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").singleInstance().Rd(()=>new U)}init(){const Q=m.AFrameworkApplication.K;if(Q.$("CpuMeterIsEnabled")){const za=ua.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");xa.a.instance.mAd.continueWith(()=>{ya.Uwm(Q,za)})}}dispose(){}static Uwm(Q,za){const fb=Ia.a.eF(10,5,new aa(Q.mc("TaskManagerLoggingThreshold",
0),Q.mc("CpuMeterMaximumEntriesToLog",0)));za=za.initialize(new ia(5),new aa,fb,Q.$("CPUMeterExposeTaskDetailsIsEnabled"));Q.$("WordEditorInteractivePerfDisableCpuMeterFrames")||(za.run(),Q.$("CpuMeterMonitorIsEnabled")&&ua.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(za,Q.XT("CpuMeterAverageCpuPercentThreshold",80),Q.mc("CpuMeterRollingAverageFramesCount",15)));J.b(16827671,306,50,"Initializing CpuMeter")}static main(){K.a.instance.Fc(new ya)}}Object(e.a)(ya,"CpuMeterPackage",
null,[1,2]);var ra=c(7),La=c(83),oa=c(1064),Ca=c(1042),Aa=c(20),db=c(1390);class eb{constructor(){this.Hsa=this.qoc=null;this.x_b=!0;this.kvc=!1}xc(Q){m.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&Q.register(1875,"Common.IEventTimingMeter").singleInstance().Rd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var Q=new Ca.a(m.AFrameworkApplication.K.mc("EventTimingMeterEventSamplingPercent",0)/100);Q=new oa.a(Object(a.a)(Q,Q.tOb,"shouldBeInSample"));
const za=Ia.a.eF(16,1,Q);this.Hsa=new db.a("TypingDuration-SlowPercentileAtValue","Percentile",m.AFrameworkApplication.K.XT("AshaVetoForTypingThresholdInMS",150),m.AFrameworkApplication.K.XT("AshaVetoForTypingThresholdPercentile",95),this.x_b);(this.kvc=!Aa.a.g3a)&&m.AFrameworkApplication.$H(()=>{this.F6e()});this.qoc=fb=>{fb=fb.rawEvent.detail;for(const Nb of fb)za.track(Nb,"EventTimingData"),"false"!==Nb.metadata.altPressed.toString()||"false"!==Nb.metadata.ctrlPressed.toString()||"false"!==Nb.metadata.repeat.toString()||
"CharacterKey"!==Nb.metadata.key.toString()&&"Space"!==Nb.metadata.key.toString()||!this.kvc||this.Hsa.Xxa(Nb.timeToRequestAnimationFrameMs)};V.a.addHandler(window.self,X.a.drh,this.qoc)}dispose(){this.qoc&&(V.a.removeHandler(window.self,X.a.drh,this.qoc),this.qoc=null)}F6e(){this.Hsa.fSa();this.Hsa.HYi&&(ra.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),La.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){K.a.instance.Fc(new eb)}}
Object(e.a)(eb,"EventTimingMeterPackage",null,[1,2]);var ib=c(74),lb=c(73),Ya=c(35);class Fa{constructor(Q,za,fb,Nb=null,tc=null){this.OL=Q;this.ytb=za;this.ntc=fb;this.sah=Nb;this.Tyc=tc}VKd(Q){const za=new Sys.StringBuilder(this.OL.q5c);za.append("RoamingServiceHandler.ashx?action=");za.append("getFirstRunExperienceSettings");za.append("&");za.append(this.Xsf(Q));za.append("&");za.append(m.AFrameworkApplication.hm);m.AFrameworkApplication.Ne.sj(za.toString(),1,null,null,!0,2,Object(a.a)(this,this.yEa,
"getRequestSuccessCallback"),Object(a.a)(this,this.uba,"getRequestFailureCallback"),null)}I5b(Q){var za=new Sys.StringBuilder(this.OL.q5c);za.append("RoamingServiceHandler.ashx?action=");za.append("saveFirstRunExperienceSettings");za.append("&");za.append(m.AFrameworkApplication.hm);za=za.toString();Q=Ya.c(Q);m.AFrameworkApplication.Ne.sj(za,2,Q,null,!0,4,Object(a.a)(this,this.eDn,"postRequestSuccessCallback"),Object(a.a)(this,this.Dca,"postRequestFailureCallback"),null)}yEa(Q){let za=!1,fb=null;
try{if(0<Q.data.xe.length){const Nb=Object(lb.a)(Object,Ya.a(Q.data.xe)),tc=Nb?Nb[this.OL.B0e]:null;tc&&(fb=Object(lb.a)(Object,Ya.a(tc.toString())))}za=!0}catch(Nb){this.uba(null)}za&&this.ytb&&this.ytb(Q.data,fb)}uba(Q){this.ntc&&this.ntc(Q?Q.data:null)}eDn(Q){this.sah&&this.sah(Q?Q.data:null)}Dca(Q){this.Tyc&&this.Tyc(Q?Q.data:null)}Xsf(Q){const za=new Sys.StringBuilder("requestedsettings=");for(let fb=0;fb<Q.count;fb++)za.append(Q.J(fb)),fb<Q.count-1&&za.append(";");return za.toString()}}Object(e.a)(Fa,
"FirstRunExperienceRequestHandler",null,[]);var $a=c(262);class Db{constructor(){this.Xsc=this.Tid=this.OL=null}Vto(Q){Q?(this.OL=Q,this.hMm()&&(ra.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Q=new ib.a,Q.add(this.OL.B0e),this.Tid=new Fa(this.OL,Object(a.a)(this,this.yEa,"getRequestSuccessCallback"),Object(a.a)(this,this.uba,"getRequestFailureCallback"),null,Object(a.a)(this,this.Dca,"postRequestFailureCallback")),this.Tid.VKd(Q)),
(this.OL.RBi||m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.Zdg()):ra.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}hMm(){try{if(this.OL.RBi)return!0;if(!m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||m.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;if(this.OL.VGm||this.OL.Fbc||m.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const Q=
m.AFrameworkApplication.K.jb("FlightId");return-1!==(Q?Q.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Q){ra.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Q?Q.toString():null)}return!1}xfj(Q){const za={},fb={};fb.FREDisplayedDate=(new Date).toUTCString();fb.VersionDisplayed=Q;fb.RemindMeLater=!1;za[this.OL.B0e]=Ya.c(fb);ra.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.Tid&&this.Tid.I5b(za)}yEa(Q,
za){Q=Q?+Q.oT-+Q.IH:-1;Q>this.OL.nej?ra.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",Q,this.OL.nej):za?this.Nso(za)?(ra.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.OL.FNi),this.Zdg()):(this.Wef(!1),ra.ULS.sendTraceTag(51675537,
306,100,"Current user has already seen this version of the FRE. No further action required.")):(ra.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.Zdg())}uba(Q){this.Wef(!1);ra.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Q?Q.Qe:-1)}Dca(Q){ra.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",Q?Q.Qe:
-1)}Zdg(){this.Wef(!0);var Q=ua.a.instance.Na("Common.ISystemInitiatedFeedback");Q?this.Lqj(Q):(ra.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Q=ua.a.instance.Sa("Common.ISystemInitiatedFeedback"))?Q.execute(za=>{this.Lqj(za)}):ra.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}Lqj(Q){if(Q){var za=this.OL.YDl;
za&&(m.AFrameworkApplication.Cn(za),m.AFrameworkApplication.Aha(za));ra.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",za);Q.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.Xsc=Object(a.a)(this,this.imn,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.Xsc,!0),window.addEventListener("FRELaunchedEvent",this.Xsc,!0)):(ra.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.xfj(this.OL.currentVersion))}else ra.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}imn(Q){if(Q){var za=Q.detail;Q=Q.type;var fb=this.OL&&this.OL.jAh?this.OL.jAh.split("-")[0]:null;if("FRELaunchedEvent"===Q||fb&&za&&za.id&&-1!==za.id.indexOf(fb))za.success&&(ra.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.xfj(this.OL.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.Xsc,
!0),window.removeEventListener("FRELaunchedEvent",this.Xsc,!0))}}Nso(Q){if("RemindMeLater"in Q&&"FREDisplayedDate"in Q){if("true"===Q.RemindMeLater.toString()&&(+new Date-+new Date(Q.FREDisplayedDate.toString()))/36E5>this.OL.FNi)return!0}else if(m.AFrameworkApplication.K.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in Q&&Q.VersionDisplayed<this.OL.currentVersion)return ra.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}Wef(Q){m.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
$a.a.dispatch("FREDecisionEvent",{["show"]:Q})}}Object(e.a)(Db,"FirstRunExperienceLauncher",null,[1870]);class gc{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}xc(Q){this.W=Q;this.W.register(1870,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").singleInstance().Rd(()=>new Db)}init(){}dispose(){}static main(){K.a.instance.Fc(new gc)}}Object(e.a)(gc,"FirstRunExperienceLauncherPackage",null,[1,2]);class Eb{constructor(){this.y=this.x=0}}Object(e.a)(Eb,
"HammerPoint",null,[]);class kb{constructor(Q,za,fb,Nb,tc){this.E3g=this.jWa=this.Ykd=1;this.bxd=this.lCc=this.yYa=0;this.BKe=this.CJa=null;this.brb=this.lAe=this.Nrd=!1;this.mj=Q;this.gMa=za;this.bxb=fb;this.ga=Nb;tc&&(this.Nrd=tc.$("PromoteLayerPinchToZoomIsEnabled"),this.lAe=tc.$("FinalizeWithInitialPinchScaleIsEnabled"),this.brb=tc.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get mL(){return this.gMa}yJm(){return!!this.mj.instance}Fmn(Q){this.ga&&this.ga.processAction(n.a.guj,2);const za=this.mj.instance;
this.Nrd&&za.m5i();this.jWa=za.ij;this.Ykd=Q.EMc.scale;this.E3g=1;this.BKe=this.Ozh();this.CJa=this.gMa.getBounds();if(!this.CJa)return ra.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;Q=this.pdi(Q);this.brb?this.nlj(this.gMa.scrollWidth,this.CJa.width,Q,this.jWa,za):this.yYa=this.gMa.scrollWidth>this.CJa.width?this.pFc(this.bxb.scrollLeft,Q.x,this.jWa):null;this.bxd=this.gMa.scrollHeight>this.CJa.height?this.pFc(this.bxb.scrollTop,Q.y,this.jWa):null;return!0}l7f(){this.yYa=null;this.lCc=
0}nlj(Q,za,fb,Nb,tc){Q>za?this.yYa?(Q=tc.eJf,Q!==this.lCc&&(this.yYa-=this.lCc-Q,this.lCc=Q)):(this.yYa=this.pFc(this.bxb.scrollLeft,fb.x,Nb),this.lCc=tc.eJf):this.l7f()}Emn(Q){const za=this.pdi(Q);if(!za)return ra.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;Q=this.ago(Q.EMc.scale/this.Ykd)*this.jWa;this.hWo(za,Q);this.iWo(za,Q);return!0}hWo(Q,za){const fb=this.gMa.scrollWidth,Nb=this.CJa.width;this.brb?this.nlj(fb,Nb,Q,za,this.mj.instance):!this.yYa&&fb>Nb&&(this.yYa=this.pFc(this.bxb.scrollLeft,
Q.x,za));if(Q=this.Wzh(Q.x,this.yYa,fb,Nb,za))this.bxb.scrollLeft=Q}iWo(Q,za){const fb=this.gMa.scrollHeight,Nb=this.CJa.height;!this.bxd&&fb>Nb&&(this.bxd=this.pFc(this.bxb.scrollTop,Q.y,za));if(Q=this.Wzh(Q.y,this.bxd,fb,Nb,za))this.bxb.scrollTop=Q}Wzh(Q,za,fb,Nb,tc){return fb<=Nb||!za||!Nb?null:Math.max(0,Math.min(za*tc-Q,fb-Nb))}pFc(Q,za,fb){return(Q+za)/fb}Dmn(Q){Q=Q.EMc.scale;this.lAe&&(Q/=this.Ykd);this.hZh(Q);this.Nrd&&this.mj.instance.B2f();this.ga&&this.ga.processAction(n.a.khf,2);this.brb&&
this.l7f()}Cmn(Q){Q=Q.EMc.scale;this.lAe&&(Q/=this.Ykd);this.hZh(Q,!0);this.Nrd&&this.mj.instance.B2f();this.ga&&this.ga.processAction(n.a.khf,2);this.brb&&this.l7f()}ago(Q){const za=this.mj.instance,fb=new Date>=this.BKe;fb&&(this.BKe=this.Ozh());Math.abs(Q-this.E3g)>=.01*Q&&za.Qmo(Q*this.jWa,fb);return za.ij/this.jWa}hZh(Q,za=!1){Q*=this.jWa;this.mj.instance.acg(Q,!1);const fb={};fb.initialScale=this.jWa;fb.finalScale=Q;fb.cancelled=za;ra.ULS.sendTraceTag(42821150,353,50,"Pinch zoom ended: {0}",
fb)}pdi(Q){return(Q=Q.EMc.center)&&this.CJa?Object.assign(new Eb,{x:Q.x-this.CJa.x,y:Q.y-this.CJa.y}):null}Ozh(){const Q=(new Date).getTime();return new Date(Q+1E3)}}Object(e.a)(kb,"PinchZoomAdapter",null,[1922]);class bb{constructor(Q){this._element=Q}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(e.a)(bb,"ScrollContainerElement",null,[1921]);var Gb=c(130);class Sa{constructor(Q,
za,fb,Nb,tc,bd){this.cTe=this.N$a=null;this.W=Q;this.he=za;this.mmd=fb;this.x1g=Nb;this.Z7j=tc;this.bVb=bd;this.Mfd=new ib.a}register(Q,za){this.mmd&&(4===m.AFrameworkApplication.ta.Nb.Sl&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?Gb.a.get_instance().Dk(8,()=>{this.Ycj(Q,za)}):this.Ycj(Q,za))}Ycj(Q,za){this.W.Sa("Common.IGestureInputManager").execute(fb=>{this.jAo();this.N$a=fb;this.Mfd.add(Q);if(this.x1g){if(this.Z7j&&0!==fb.CWl()){this.Nuj();
return}var Nb=this.W.Sa("Common.IZoomManager");this.W.resolve("Common.IAppSettingsManager");const tc=new bb(Q);Nb=new kb(Nb,tc,za,m.AFrameworkApplication.va,m.AFrameworkApplication.K);fb.KTn(Q,Nb)}this.Nuj()})}unregister(){if(this.N$a&&this.Mfd){if(this.x1g){for(let Q of this.Mfd)this.N$a.sPo(Q);this.Mfd.clear()}this.N$a=null}}jAo(){this.bVb&&(this.he?this.cTe=this.he.Zf("Task","Register"):ra.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}Nuj(){this.bVb&&(this.cTe?this.cTe.stop():
ra.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(e.a)(Sa,"GestureInputRegistrar",null,[1869]);class Pa{constructor(){this.W=null;this.Ah=!1}get name(){return"Common.App.GestureInput"}init(){this.Ah||(this.W.resolve("Common.IGestureInputRegistrar"),this.Ah=!0)}dispose(){}xc(Q){this.W=Q;Q.register(1869,"Common.IGestureInputRegistrar").singleInstance().Rd(()=>new Sa(Q,m.AFrameworkApplication.ta.Fq,m.AFrameworkApplication.GUc(),m.AFrameworkApplication.uzi(),!!m.AFrameworkApplication.K&&
m.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){K.a.instance.Fc(new Pa)}}Object(e.a)(Pa,"GestureInputPackage",null,[1,2]);var Ab=c(403),nb=c(77);class Rb{constructor(){this.hnb=this.Q2h=null}}Object(e.a)(Rb,"GestureAdapterInfo",null,[]);var Mb=c(527),oc=c(289);class xb{constructor(){this.qsb=null}EJf(){if(!this.qsb){var Q="hammer.min.js";m.AFrameworkApplication.K.Nw("IsServerFlavorDebug")&&
(Q=m.AFrameworkApplication.K.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");Q=m.AFrameworkApplication.yz(String.format("{0}",Q),5);Q=oc.a.create(Q,null,null);Mb.a.lX(Q);this.qsb=Q.J3a}return this.qsb}static get instance(){xb._instance||(xb._instance=new xb);return xb._instance}}xb._instance=null;Object(e.a)(xb,"HammerJsDependencyLoader",null,[1857]);const cc=(Q,za,fb=null)=>{if(void 0===za||null===za)throw ra.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");
let Nb=null;switch(Q){case X.a.pinch:Nb=new Hammer.Pinch(fb);break;case X.a.pan:Nb=new Hammer.Pan(fb)}Nb&&(Nb.manager=za);return Nb};var Ob;(function(Q){Q[Q.none=-1]="none";Q[Q.pinch=0]="pinch";Q[Q.pan=1]="pan";Q[Q.swipe=2]="swipe"})(Ob||(Ob={}));Object(e.b)("GestureEvent",Ob);var Ub=c(69);class pb extends Ub.a{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd){super(Q,fb,Nb,bd);this.Jpc=za;this.bYa=Yd;this.Cra=Fd;this.R2j=tc}get shiftKey(){return this.bYa}get ctrlKey(){return this.Cra}get clientPoint(){return this.Jpc}get EMc(){return this.R2j}static create(Q,
za,fb,Nb,tc,bd){if(fb.rawEvent)if(bd){var Yd=fb.rawEvent;Yd=new Sys.UI.Point(Yd.clientX,Yd.clientY)}else Yd=Ub.a.UNd(fb);else Yd=new Sys.UI.Point(fb.clientX,fb.clientY);return new pb(Q,Yd,za,fb,Nb,tc,fb.shiftKey,fb.ctrlKey,bd)}}Object(e.a)(pb,"GestureEventArgs",Ub.a,[]);class Zb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(e.a)(Zb,"GestureManagerData",null,[]);class Wa{}Wa.LQj=2;Wa.MQj=4;Wa.NQj=8;Wa.OQj=8;Object(e.a)(Wa,"HammerConstants",null,[]);var Lb=c(94),qc=c(112),Ra=c(19),yb=c(102);class Bb extends V.a{constructor(Q,za){super();this.PKa=Ab.a.ZIl;this.vNe=!!window.PointerEvent;this.Oih=window.hasOwnProperty("ontouchstart");this.stb=this.Lxc=null;this.CKa=
!1;this.Qka=new nb.a;this.Qyc=new nb.a;this.jWg=new ib.a;this.T9a=null;this.ASb=this.bVb=this.SNg=this.Gue=this.UIe=this.Ech=this.iOg=this.tCc=!1;this.Nwc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.dTe=null;this.ng=Lb.EventHandlerManager.instance;this.vNe?(ra.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.Lxc=Object(a.a)(this,this.v7d,"onPointerEvent"),this.stb=X.a.aJl):this.Oih?(ra.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.Lxc=Object(a.a)(this,
this.kmb,"onTouchEvent"),this.stb=X.a.touchEvents):(ra.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.Lxc=Object(a.a)(this,this.h7d,"onMouseEvent"),this.stb=X.a.$Il);this.he=za;this.b2=Q;m.AFrameworkApplication.K&&(this.tCc=m.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.iOg=m.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.Ech=m.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.UIe=m.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),
this.Gue=m.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.SNg=m.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.bVb=m.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.ASb=this.tCc&&m.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&m.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}CWl(){return this.vNe?0:this.Oih?1:2}ev(Q){super.ev(Q);this.ng.UEa(this.stb,Q,0,this.Lxc)}Vu(Q){super.Vu(Q);
this.ng.C_a(Q,this.stb)}KTn(Q,za){m.AFrameworkApplication.GUc()?xb.instance.EJf().continueWith(fb=>{this.iAo();if(fb.Ci||fb.zo)ra.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",fb.status);else{ra.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",fb.status);if(this.SNg){fb=window.Hammer;if("undefined"===typeof fb){ra.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.Hje();return}if("undefined"===typeof fb.inputHandler){ra.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.Hje();return}}if(!Q)throw this.Hje(),Error.argumentNull("source element can not be null");fb=qc.a.Db(Q,this.PKa);if(void 0===fb||null===fb)fb=new nb.a,qc.a.ql(Q,this.PKa,fb),this.LTn(Q);if(!fb.nb(Ob[0])){var Nb=Object.assign(new Rb,{hnb:cc(Ob[0],this,null),Q2h:za});fb.add(Ob[0],Nb)}}this.Hje()}):ra.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}iAo(){this.bVb&&(this.he?this.dTe=this.he.Zf("Task",
"RegisterGestureAdapterAfterLoad"):ra.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}Hje(){this.bVb&&(this.dTe?this.dTe.stop():ra.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}sPo(Q){ra.ULS.sendTraceTag(42256223,310,Q?100:10,"source element {0} ",Q.id);const za=qc.a.Db(Q,this.PKa);void 0!==za&&null!==za&&(za.remove(Ob[0]),za.count||(qc.a.NU(Q,this.PKa),this.curRecognizer=null,this.tPo(Q)))}LTn(Q){this.jWg.add(Q);this.ng.UEa(this.stb,Q,
0,this.Lxc)}tPo(Q){this.jWg.remove(Q);this.ng.C_a(Q,this.stb)}recognize(Q){var za=Array(Q.pointers.length);for(var fb=0;fb<Q.pointers.length;fb++)za[fb]=Q.pointers[fb].target;fb=null;for(this.T9a=this.Q0l(za);void 0!==this.T9a&&null!==this.T9a&&(fb=qc.a.Db(this.T9a,this.PKa),void 0===fb||null===fb);this.T9a=this.T9a.parentNode);if(void 0!==fb&&null!==fb){this.curRecognizer&&this.curRecognizer.state===Wa.OQj&&(this.curRecognizer=null);za=fb.keys;for(let Nb of za){za=fb.J(Nb);void 0!==za&&null!==za&&
void 0!==za.hnb&&null!==za.hnb&&(void 0===this.curRecognizer||null===this.curRecognizer||za.hnb===this.curRecognizer||za.hnb.canRecognizeWith(this.curRecognizer))&&za.hnb.recognize(Q);const tc=za.hnb.state;this.curRecognizer||Wa.LQj!==tc&&Wa.MQj!==tc&&Wa.NQj!==tc||(this.curRecognizer=za.hnb)}}}emit(Q,za){if("hammer.input"!==Q){this.CKa=!1;za=pb.create(Q,this.T9a,za.srcEvent,za,3,this.vNe);var fb=qc.a.Db(this.T9a,this.PKa);if(this.bOm(Q))var Nb=0;else if(this.BNm(Q))Nb=1;else if(this.tRm(Q))Nb=2;else{ra.ULS.sendTraceTag(42256256,
310,15,"Event can not be recognized by current manager");return}({value:fb}=fb.Dc(Ob[Nb]));void 0!==fb&&null!==fb&&((fb=fb.Q2h,fb.yJm())?Q.endsWith("start")?this.CKa=fb.Fmn(za):Q.endsWith("end")?(fb.Dmn(za),this.CKa=!0):Q.endsWith("cancel")?(fb.Cmn(za),this.CKa=!0):Q.endsWith("move")&&(this.CKa=fb.Emn(za)):ra.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",Q))}}get(Q){return Object(lb.a)(Hammer.Recognizer,Q)}Q0l(Q){if(1>Q.length)return null;if(1===Q.length)return Q[0];
var za=Q[0],fb=!0;for(let Nb=1;Nb<Q.length;Nb++){if(!Q[Nb])return null;if(za!==Q[Nb]){fb=!1;break}}if(fb)return za;za=this.s3h(Q[0]);fb=0;for(const Nb of Q){Q=this.s3h(Nb);if(za.J(za.count-1)!==Q.J(Q.count-1))return null;for(let tc=za.count-2,bd=Q.count-2;tc>=fb&&0<=bd;tc--,bd--)if(za.J(tc)!==Q.J(bd)){fb=tc+1;break}}return za.J(fb)}s3h(Q){const za=new ib.a;for(;void 0!==Q&&null!==Q;Q=Q.parentNode)za.add(Q);return za}n$h(Q){switch(Q){case X.a.vP:case X.a.Kzb:return 1;case X.a.uP:case X.a.j4e:return 2;
case X.a.NJ:case X.a.Lzb:return 4;case X.a.Qle:case X.a.i4e:return 8}return 0}kmb(Q,za,fb){Q=this.n$h(Q);za=this.fZl(fb);Hammer.inputHandler(this,Q,za);this.CKa&&fb.preventDefault();return this.CKa}wli(){return 1<this.Qka.count}BCd(){ra.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.tCc)for(let Q of this.Qka)this.j$i(Q.key);else this.Qka=new nb.a;this.session=null}Esk(Q,za,fb){ra.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",Q);if(!this.Qyc.nb(Q)){try{za.setPointerCapture(Q)}catch(Nb){ra.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",Nb)}this.Qyc.add(Q,za)}this.Qka.Z(Q,fb);this.ASb&&1<this.Qka.count&&this.b2&&!this.b2.AFc&&(this.b2.AFc=!0)}j$i(Q){ra.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",Q);if(this.Qyc.nb(Q)){try{this.Qyc.J(Q).releasePointerCapture(Q)}catch(za){ra.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",za)}this.Qyc.remove(Q)}else ra.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",Q);this.Qka.remove(Q);this.ASb&&
1>=this.Qka.count&&this.b2&&this.b2.AFc&&(this.b2.AFc=!1)}v7d(Q,za,fb){var Nb=fb.rawEvent.pointerType.toString();const tc=fb.rawEvent.pointerId.toString();if("touch"!==Nb)return!1;Q=this.n$h(Q);if(1!==Q&&!this.Qka.nb(tc))return!1;this.iOg&&1===Q&&fb.rawEvent.isPrimary&&this.Qka.count&&(ra.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.BCd());this.tCc?this.Esk(tc,za,fb):this.Qka.Z(tc,fb);this.UIe&&2===Q&&(!this.Gue||this.Gue&&"function"===typeof fb.rawEvent.getCoalescedEvents)&&
(za=fb.rawEvent.getCoalescedEvents())&&this.wli()&&(this.Nwc=Math.max(this.Nwc,za.length));this.Ech&&(this.CKa=!1);Nb=this.eZl(this.Qka,fb,Nb);Hammer.inputHandler(this,Q,Nb);if(4===Q||8===Q)this.tCc?this.j$i(tc):this.Qka.remove(tc),this.Qka.count||(this.session=null,this.UIe&&-1!==this.Nwc&&(ra.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Nwc),this.Nwc=-1));this.CKa&&fb.preventDefault();return this.CKa}h7d(){return!1}fZl(Q){const za=new Zb;var fb=Q.rawEvent;const Nb=
fb.touches;fb=fb.changedTouches;za.pointers=Array.clone(Nb);za.pointers=Array.clone(0<Nb.length?Nb:fb);za.changedPointers=Array.clone(fb);za.srcEvent=Q;za.pointerType="touch";return za}eZl(Q,za,fb){const Nb=new Zb;Nb.pointers=yb.toArray(Q.values);Nb.changedPointers=[za];Nb.pointerType=fb;Nb.srcEvent=za;return Nb}bOm(Q){return Ra.a.startsWith(Q,X.a.pinch)}BNm(Q){return Ra.a.startsWith(Q,X.a.pan)}tRm(Q){return Ra.a.startsWith(Q,X.a.swipe)}}Object(e.a)(Bb,"GestureInputManager",V.a,[1815,1816]);var cb=
c(296);class Xa{constructor(){this.W=null;this.Ah=!1}get name(){return"Common.App.GestureInputManager"}xc(Q){Q.register(Bb,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").singleInstance().Rd(()=>new Bb(cb.a.instance,m.AFrameworkApplication.ta.Fq));this.W=Q}init(){this.Ah||(this.W.resolve("Common.App.GestureManager.GestureInputManager"),this.Ah=!0)}dispose(){}static main(){K.a.instance.Fc(new Xa)}}Object(e.a)(Xa,"GestureInputManagerPackage",null,[1,2]);var hb=c(243),
Cb=c(57),ob=c(1539);class ab{constructor(Q,za,fb){this.wRe=this.vRe=null;this.VYb=new A.a;this.Wf=Q;this.Dxc=fb;this.Ala=za.appSettings[ab.a1o]||""}get noo(){return this.VYb.task}get nQ(){return this.Wf.value}X2n(){const Q={};Q[ab.Onm]=m.AFrameworkApplication.hm;Q["Content-Type"]="application/json; charset=utf-8";ra.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const za=Cb.a.hp(this.Ala+ab.ooo,ab.Ehn,m.AFrameworkApplication.ta.Nb.Sl.toString());
this.nQ.sj(za,1,"",Q,!0,2,Object(a.a)(this,this.EKb,"onSuccessCallback"),Object(a.a)(this,this.lKb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}e3m(Q){try{const za={};za.FlightName=Q.FlightName;za.SessionID=Q.SessionID;ra.ULS.sendTraceTag(594883776,215,50,Ya.c(za))}catch(za){ra.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}EKb(Q){if((Q=Q.data.xe)&&Q.length)try{const za=Ya.a(Q);this.vRe=za.NavBarDataJson;ra.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");
this.vRe?({Wu:this.wRe}=Ya.d(za.NavBarDataJson)).returnValue?(this.e3m(this.wRe),this.VYb.Ag(this.wRe)):(ra.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:ob.a.T$c(this.vRe)}),this.VYb.Rca()):(ra.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.VYb.Rca())}catch(za){ra.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.VYb.Rca()}else ra.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}lKb(){this.VYb.Rca();
ra.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return ab._instance||(ab._instance=ab.rDb())}static rDb(){return new ab(new hb.a(()=>m.AFrameworkApplication.Ne),m.AFrameworkApplication.K,m.AFrameworkApplication.ta.Nb.Sl)}}ab.Onm="X-qs";ab.Ehn="at";ab.ooo="O365ShellServiceProxy.ashx";ab._instance=null;ab.a1o="ShellWebServiceBase";Object(e.a)(ab,"O365ShellActor",null,[1817]);class Ib{constructor(){this.W=null}get name(){return"Common.App.O365Shell"}xc(Q){this.W=
Q;this.W.register(ab,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").singleInstance().Rd(()=>new ab(new hb.a(()=>m.AFrameworkApplication.Ne),m.AFrameworkApplication.K,m.AFrameworkApplication.ta.Nb.Sl))}init(){m.AFrameworkApplication.K.No(Object(a.a)(this,this.Lx,"onFullAppSettingsReady"))}Lx(){m.AFrameworkApplication.ung&&m.AFrameworkApplication.ta.Nb.oJ&&this.W.resolve("Common.App.O365Shell.O365ShellActor").X2n()}dispose(){}static main(){K.a.instance.Fc(new Ib)}}
Object(e.a)(Ib,"PackageManager",null,[1,2]);class Yb{LQa(){}init(){}dispose(){}}Object(e.a)(Yb,"NoOpOfflineLogger",null,[1866,9]);var ub=c(779);class Ac{}Ac.lAd=0;Object(e.a)(Ac,"OfflineLoggerConstants",null,[]);var Pc=c(92),Mc=c(244),Ed=c(304);class ne{constructor(Q,za,fb,Nb,tc,bd,Yd){this.XIe=this.Dwc=null;this.sWa=!1;this.C6=null;this.Gqc=this.oWb=this.esb=0;this.jK=this.Xab=this.bfd=this.Pqd=this.KS=null;this.$l=!1;this.WAa=fb;this.JBa=Nb;this.xBa=tc;this.Wf=za;this.Hb=Q;this.uVa=bd;Yd?(this.bfd=
new ne(Q,za,fb,Nb,tc,bd,!1),this.bfd.Pqd=this,this.Dwc="OfflineLoggerManifest|"+this.uVa,this.XIe="OfflineLog|"+this.uVa+"|"):(this.Dwc="OfflineLoggerManifest",this.XIe="OfflineLog|")}init(){this.mcg();this.vZm();this.sWa=!1;this.Wf.Z_b(this);this.KS=new Pc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Hb.Vb(this.KS);this.bfd&&this.bfd.init()}dFc(Q){return this.XIe+Q}vZm(){const Q=this.WAa.getItem(this.Dwc);void 0!==Q&&null!==Q&&0<Q.length&&(this.C6=ne.bad(Q));this.C6||
(this.C6={});if(void 0===this.C6.end||null===this.C6.end)this.C6.end=0;if(void 0===this.C6.offset||null===this.C6.offset)this.C6.offset=0;this.esb=this.C6.offset;isFinite(this.esb)||(this.esb=0);this.oWb=this.C6.end;isFinite(this.oWb)||(this.oWb=0);this.Gqc=this.oWb}mcg(){this.Xab=new Ed.a;this.jK=new Mc.a;this.Pqd||(this.JBa.Kph(Object(a.a)(this,this.hWf,"onUlsReadyToBeSent")),this.JBa.mqh(Object(a.a)(this,this.jWf,"onUlsSentSuccessfully")),this.JBa.lqh(Object(a.a)(this,this.iWf,"onUlsSentFailed")));
this.JBa.Bph(Object(a.a)(this,this.kSf,"onAfterUlsHostDisposed"))}hWf(Q,za){if(void 0!==za&&null!==za&&void 0!==za.args&&null!==za.args){Q=!1;if(!this.Xab.nb(za.args.tag)){if(!this.Xab.nb(Ac.lAd))return;Q=!0}this.Xab.remove(Q?Ac.lAd:za.args.tag);this.jK.nb(za.uploadId)||this.jK.Z(za.uploadId,new ib.a);this.jK.J(za.uploadId).add(za.args)}}jWf(Q,za){this.jK.remove(za.uploadId)}iWf(Q,za){if(void 0!==za&&null!==za&&this.jK.nb(za.uploadId)){Q=this.jK.J(za.uploadId);for(let fb=0,Nb=Q.count;fb<Nb;++fb)za=
ne.serialize(Q.J(fb),this.xBa),this.cad(this.dFc(this.Gqc++),za)}}kSf(){this.dispose()}cad(Q,za){try{return this.WAa.setItem(Q,za),!0}catch(fb){return ra.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",fb.message),!1}}sendOfflineLogs(){if(!this.sWa){for(var Q=this.esb,za=new ib.a,fb=null;Q<this.oWb&&5>=za.count;++Q){var Nb=this.dFc(Q);const tc=this.WAa.getItem(Nb);this.WAa.removeItem(Nb);if(void 0===tc||null===tc)continue;const bd=({sessionId:Nb}=ne.deserialize(tc)).returnValue;
if(bd){if(!fb)fb=Nb;else if(Nb!==fb)break;za.add(bd)}else ra.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",tc)}0<za.count&&this.JBa.ycj(this,yb.toArray(za),fb);this.esb=Q;Q>=this.oWb&&(this.Hb.Ve(this.KS),this.KS=null)}}LQa(Q,za,fb){!this.$l&&ra.ULS.M9(za,fb)&&(this.Pqd?this.Pqd.LQa(Q,za,fb):this.Xab.Z(Q,!0))}dispose(){if(!this.$l){this.KS&&this.Hb.Ve(this.KS);var Q=yb.toArray(this.jK.keys);Q.sort();for(const za of Q){Q=this.jK.J(za);for(let fb=0,Nb=Q.count;fb<Nb;++fb){const tc=
ne.serialize(Q.J(fb),this.xBa);this.cad(this.dFc(this.Gqc++),tc)}}this.esb<this.Gqc?(this.C6.end=this.Gqc,this.C6.offset=this.esb,this.cad(this.Dwc,JSON.stringify(this.C6))):this.WAa.removeItem(this.Dwc)}this.$l=!0}kRa(){this.sWa=!0}slb(){this.sWa=!1}static serialize(Q,za){const fb={};fb.t=Q.tag;fb.c=Q.category;fb.l=Q.level;fb.m=Q.message;fb.lt=Q.logType;fb.s=za;fb.ts=Q.timestamp;fb.o=Q.isMinified;fb.a=Q.args;return JSON.stringify(fb)}static deserialize(Q){return(Q=ne.bad(Q))?{returnValue:new ub.a(Q.ts,
Q.c,Q.t,Q.l,Q.m,Q.lt,Q.o,Q.a),sessionId:Q.s}:{returnValue:null,sessionId:null}}static bad(Q){try{return JSON.parse(Q)}catch(za){ra.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",za.message)}return null}}Object(e.a)(ne,"OfflineLoggerImpl",null,[1866,9,232]);class Ie{constructor(Q,za,fb,Nb){this.sessionId=Q;this.version=za;this.dBd=fb;this.SWf=Nb;this.$wa=new ib.a}}Object(e.a)(Ie,"CachedLogUpload",null,[]);class cd{constructor(Q){Q.name&&(this.n=Q.name);Q.stack&&
(this.s=Q.stack);Q.message&&(this.m=Q.message);Q.file&&(this.f=Q.file);null!=Q.line&&(this.l=Q.line);null!=Q.column&&(this.c=Q.column)}}Object(e.a)(cd,"LoggingExceptionArgsLocalStorage",null,[]);class Ic{constructor(Q){this.t=Q.tag;this.c=Q.category;this.l=Q.level;this.m=Q.message;this.lt=Q.logType;this.ts=Q.timestamp;this.o=Q.isMinified;this.a=Q.args;Q.exceptionArgs&&(this.e=new cd(Q.exceptionArgs))}}Object(e.a)(Ic,"LoggingArgsLocalStorage",null,[]);var Rc=c(474);class xc{constructor(Q,za,fb,Nb,
tc,bd,Yd){this.t=Q;this.m=za;this.s=fb;this.v=Nb;this.i=tc;this.a=bd;this.d=Yd;this.op="Log"}}Object(e.a)(xc,"LoggingKeyLocalStorage",null,[]);var Ae=c(136);const Ue=(Q,za,fb,Nb,tc)=>!(void 0===Q||null===Q)&&!(void 0===Q.i||null===Q.i)&&!(void 0===Q.t||null===Q.t)&&!(void 0===Q.s||null===Q.s)&&"Log"===Q.op&&Q.t===za&&isFinite(Q.t)&&Ae.a.isValid(Q.s)&&(void 0===Q.m||null===Q.m||Q.m===fb)&&(!tc||void 0===Q.d||null===Q.d||Q.d===Nb);class Xe{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd,De,Nf,Je,va,Oa){this.sWa=
this.k5g=this.Z4g=this.$4g=!1;this.jK=this.Xab=this.C6=this.KS=null;this.$l=!1;this.Aub=[];this.iWb=[];this.WAa=fb;this.JBa=Nb;this.xBa=tc;this.Wf=za;this.Hb=Q;this.Dxc=bd;this.aLe=Yd;this.Och=Fd;this.LWa=De;this.Z9j=Nf;this.sGe=Je;this.uVa=va;this.N_g=Oa}get manifest(){return this.C6}get CXc(){return this.Xab}get NQa(){return this.jK}init(){this.mcg();this.sWa=!1;this.Wf.Z_b(this);this.KS=new Pc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Hb.Vb(this.KS)}determineLogsToSendAtBoot(){this.KQh(!0)}determineLogsToSendOnReconnect(){this.KQh(!1)}KQh(Q){this.tKd();
this.Aub=[];Q&&(this.iWb=[]);for(var za=0;za<this.WAa.length;za++){const fb=this.WAa.key(za),Nb=Xe.OBj(fb,!1);Ue(Nb,this.Dxc,this.aLe,this.uVa,this.N_g)&&(Nb.s===this.xBa?Array.add(this.Aub,fb):Q&&Array.add(this.iWb,fb))}if(this.Aub.length||Q&&this.iWb.length)if(za=this.sGe?Object(a.a)(this,this.uxo,"sortDescendKeysToUpload"):Object(a.a)(this,this.xxo,"sortKeysToUpload"),this.Aub.sort(za),Q&&this.iWb.sort(za),0<this.Aub.length||0<this.iWb.length)this.KS=new Pc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,
"sendOfflineLogs"),105),this.Hb.Vb(this.KS)}xxo(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}uxo(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}dFc(Q,za,fb,Nb){Q=new xc(this.Dxc,this.aLe,za,fb,Q,Nb,this.uVa);return JSON.stringify(Q)}mcg(){this.Xab=new Ed.a;this.jK=new Mc.a;this.JBa.Kph(Object(a.a)(this,this.hWf,"onUlsReadyToBeSent"));this.JBa.mqh(Object(a.a)(this,this.jWf,"onUlsSentSuccessfully"));this.JBa.lqh(Object(a.a)(this,this.iWf,"onUlsSentFailed"));this.JBa.Bph(Object(a.a)(this,this.kSf,
"onAfterUlsHostDisposed"))}hWf(Q,za){if(void 0!==za&&null!==za&&void 0!==za.args&&null!==za.args){if(this.CXc.nb(za.args.tag))this.CXc.remove(za.args.tag);else if(this.CXc.nb(Ac.lAd))this.CXc.remove(Ac.lAd);else if(!(this.Z9j&&50>za.args.level))return;({value:Q}=this.NQa.Dc(za.uploadId)).returnValue||(Q=new Ie(za.sessionId,za.version,za.dBd,za.SWf),this.NQa.Z(za.uploadId,Q));this.NQa.J(za.uploadId).$wa.add(za.args)}}jWf(Q,za){this.NQa.remove(za.uploadId)}iWf(Q,za){void 0!==za&&null!==za&&this.NQa.nb(za.uploadId)&&
this.dOi(za.uploadId)&&!this.k5g&&(this.k5g=!0,ra.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}dOi(Q){let za=!1;if(({value:Nb}=this.NQa.Dc(Q)).returnValue&&Nb&&0<Nb.$wa.count){if(Nb.dBd>=this.LWa)return!1;var fb=Nb.$wa;const tc=Array(fb.count);for(let bd=0,Yd=fb.count;bd<Yd;++bd)tc[bd]=new Ic(fb.J(bd));fb=Xe.serialize(tc);var Nb=this.dFc(Nb.SWf,Nb.sessionId,Nb.version,Nb.dBd);this.cad(Nb,fb)&&(this.NQa.remove(Q),za=!0)}return za}kSf(){this.dispose()}cad(Q,za){try{return this.WAa.setItem(Q,
za),!0}catch(fb){return ra.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",fb.message),!1}}sendOfflineLogs(){if(!this.sWa){var Q=0<this.Aub.length?this.Aub:this.iWb,za=Q.length;if(za)for(;0<za;){m.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");za--;var fb=this.sGe?Q.pop():Q[0];this.sGe||Array.removeAt(Q,0);const bd=Xe.OBj(fb,!0);if(Ue(bd,this.Dxc,this.aLe,this.uVa,this.N_g)){var Nb=this.WAa.getItem(fb);
this.WAa.removeItem(fb);if(void 0!==Nb&&null!==Nb)if(bd.a>this.LWa)ra.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",bd.a,this.LWa);else if(fb=Xe.bad(Nb,!0),void 0!==fb&&null!==fb&&isFinite(fb.length))if(fb.length){Nb=fb[fb.length-1];var tc=(new Date).getTime()-Nb.ts;if(tc<-Xe.gyj)ra.ULS.sendTraceTag(37290078,222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",Nb.ts);else if(tc>this.Och*Xe.gyj)ra.ULS.sendTraceTag(37290079,
222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.Och,Nb.ts);else{bd.s===this.xBa?this.$4g||(this.$4g=!0,ra.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.Z4g||(this.Z4g=!0,ra.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",bd.s));za=Array(fb.length);for(Nb=0;Nb<fb.length;Nb++){Q=Nb;a:{tc=fb[Nb];if(void 0===tc||null===tc){tc=null;break a}let Yd=null;tc.e&&(Yd=new Rc.a(null),Yd.name=
tc.e.n,Yd.stack=tc.e.s,Yd.message=tc.e.m,Yd.file=tc.e.f,Yd.line=tc.e.l,Yd.column=tc.e.c);tc=new ub.a(tc.ts,tc.c,tc.t,tc.l,tc.m,tc.lt,tc.o,tc.a,Yd)}za[Q]=tc}this.JBa.ycj(this,za,bd.s,bd.v,bd.a+1,bd.i);break}}else ra.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Nb);else ra.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",Nb)}}else this.tKd()}}LQa(Q,za,fb){!this.$l&&ra.ULS.M9(za,fb)&&this.CXc.Z(Q,!0)}dispose(){if(!this.$l){this.KS&&
this.Hb.Ve(this.KS);var Q=yb.toArray(this.NQa.keys);for(const za of Q)this.dOi(za)}this.$l=!0}kRa(){this.sWa=!0;this.tKd()}slb(){this.sWa=!1;this.tKd();this.KS&&this.Hb.Ve(this.KS);this.KS=new Pc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendOnReconnect,"determineLogsToSendOnReconnect"),102);this.Hb.Vb(this.KS)}tKd(){this.KS&&(this.Hb.Ve(this.KS),this.KS=null)}static serialize(Q){return JSON.stringify(Q)}static OBj(Q,za){(Q=Xe.bad(Q,za))&&void 0===Q.d&&(Q=new xc(Q.t,Q.m,Q.s,Q.v,Q.i,Q.a,0));
return Q}static bad(Q,za){try{return JSON.parse(Q)}catch(fb){za&&ra.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",fb.message)}return null}}Xe.gyj=864E5;Object(e.a)(Xe,"OfflineLoggerImplV2",null,[1866,9,232]);class ef{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(Q){return this.handleError("Length",Q),-1}}key(Q){try{return localStorage.key(Q)}catch(za){return this.handleError("Key",
za),null}}getItem(Q){try{return localStorage.getItem(Q)}catch(za){return this.handleError("GetItem",za),null}}setItem(Q,za){try{return localStorage.setItem(Q,za)}catch(fb){return this.handleError("SetItem",fb),null}}removeItem(Q){try{localStorage.removeItem(Q)}catch(za){this.handleError("RemoveItem",za)}}clear(){try{localStorage.clear()}catch(Q){this.handleError("Clear",Q)}}handleError(Q,za){ra.ULS.sendTraceTag(19170128,222,10,"Invoking localStorage function[{0}] failed, message: {1}",Q,za.message)}}
Object(e.a)(ef,"OfflineStorage",null,[1865]);class Se{create(Q){var za=null;try{void 0!==localStorage&&null!==localStorage&&(za=new ef)}catch(Nb){ra.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",Nb.message)}Object.getType(ra.ULS.host).implementsInterface(962)&&za||(ra.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",za?"supported":"not supported",Object.getType(ra.ULS.host).implementsInterface(962)?"supported":
"not supported"),Q=0);const fb=m.AFrameworkApplication.K;1===Q?za=new ne(m.AFrameworkApplication.nc,m.AFrameworkApplication.Ne,za,ra.ULS.host,m.AFrameworkApplication.userSessionId,m.AFrameworkApplication.kOh,fb.$("OfflineLoggerDataBoundarySupportIsEnabled")):2===Q?(Q=m.AFrameworkApplication.ta.Nb,za=new Xe(m.AFrameworkApplication.nc,m.AFrameworkApplication.Ne,za,ra.ULS.host,m.AFrameworkApplication.userSessionId,Q.Sl,Q.Nha,fb.mc("OfflineLoggerRetentionInDays",30),fb.mc("OfflineLoggerMaxAttempts",5),
fb.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),fb.$("SendOfflineLogsV2ImprovementIsEnabled"),m.AFrameworkApplication.kOh,fb.$("OfflineLoggerDataBoundarySupportIsEnabled"))):za=new Yb;za.init();return za}}Object(e.a)(Se,"OfflineLoggerFactory",null,[]);class pc{xc(){}get name(){return"Common.App.OfflineLogger"}init(){const Q=m.AFrameworkApplication.K;let za=0;Q.$("OneNoteOfflineLoggerIsEnabled")?za=1:Q.$("OfflineLoggerV2IsEnabled")&&(za=2);0!==za&&(m.AFrameworkApplication.Tig=(new Se).create(za))}dispose(){}}
Object(e.a)(pc,"OfflineLoggerPackage",null,[1,2]);var id=c(44),Xc=c(1362);class he{constructor(Q){this.aLi=null;ra.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.hYc=m.AFrameworkApplication.K.jb("PhoneLinkServiceEndpoint");(this.Q8=Q)||ra.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.hYc&&this.hYc.length||ra.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}dzl(Q){Q&&(this.hYc="https://dcg-df.microsoft.com/",
ra.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.czl()}czl(){ra.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.aLi)ra.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.aLi=new Date;var Q=new Date;this.Q8.PY("BayBridge",this.hYc).then(za=>{const fb=+new Date-+Q;za.IsSuccess?(ra.ULS.sendTraceTag(527574723,306,
50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",fb),this.Uyl(za.Token,this.lLl())):ra.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",fb,za.ErrorCode,za.ErrorMessage)}).catch(za=>{ra.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",za,+new Date-+Q)})}}Uyl(Q,za){const fb={};fb.Authorization=
"Bearer "+Q;fb["Authorization-Type"]="AAD";fb.Accept="application/json";fb["DCG-SessionId"]=m.AFrameworkApplication.userSessionId;m.AFrameworkApplication.Ne.sj(za,1,null,fb,!1,2,Object(a.a)(this,this.Obm,"getStatusSucceeded"),Object(a.a)(this,this.Mbm,"getStatusFailed"),null,void 0,void 0,void 0,void 0,"39");id.a("FetchAccountLinkedStatus")}mNl(){const Q=Xc.a.instance.getItem("AccountLinkedStatusCache");return Q&&Q.length?"true"===Q.toLowerCase()?!0:!1:!1}lLl(){return this.hYc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}Mbm(){ra.ULS.sendTraceTag(527214156,
306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}Obm(Q){ra.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");Q=Ya.a(Q.data.xe).state+"";Xc.a.instance.setItem("AccountLinkedStatusCache",Q)}}Object(e.a)(he,"PhoneLinkManager",null,[1796]);class $d{constructor(){this.W=null}get name(){return"Common.App.PhoneLink"}xc(Q){this.W=Q;this.W.register(1796,"Common.App.PhoneLink.IPhoneLinkManager").singleInstance().Rd(()=>new he(this.W.resolve("Common.App.OAuth.IOAuthManager")))}init(){m.AFrameworkApplication.K.No(()=>
{this.f2a()})}f2a(){this.W.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){K.a.instance.Fc(new $d)}}Object(e.a)($d,"PhoneLinkPackage",null,[1,2]);const Ud=Q=>{try{return Ya.a(Q)}catch(za){}return null};class Jf{constructor(Q,za,fb,Nb,tc,bd){this.tZ=!1;this.Fl=null;this.jNe=!1;this.ga=Q;this.Wf=za;this.Nk=fb;this.l4g=Nb;this.Ma=tc;this.E9j=bd}init(Q,za){za&&Q.Sa("Common.Interface.IRtcBasicProvider").execute(Object(a.a)(this,this.y2e,"awaitRtc"))}y2e(Q){const za=Q.mOc();za.continueWith(()=>
{this.Fl=za.result;this.jNe&&(this.Fl.XM(2,null,!0),this.jNe=!1);this.Fl.b3((fb,Nb)=>{2===Nb.type&&this.pc.processAction(n.a.fileNameUpdate,2)});this.Fl.Ata((fb,Nb)=>{2===Nb.newState&&this.pc.processAction(n.a.fileNameUpdate,2)});2===this.Fl.connectionState&&this.pc.processAction(n.a.fileNameUpdate,2)})}jOa(Q){this.qXh(Q,!0)}qXh(Q,za){const fb=this.eNk(Q.wsj),Nb={};Nb[Jf.bIh]=Jf.cIh;this.mcj.sj(fb,2,"",Nb,!1,2,Object(a.a)(this,this.Eec,"onRefreshFilenameSuccess"),za?Object(a.a)(this,this.Dqn,"onRefreshFilenameFailureRetry"):
Object(a.a)(this,this.MVi,"onRefreshFilenameFailureNoRetry"),Q)}Eec(Q){this.tZ=!1;const za=Ud(Q.data.xe);Q.data.state.onSuccess(za,this.l4g.value)}Dqn(Q){5!==Q.data.status||this.tZ?this.MVi(Q):(this.tZ=!0,this.qXh(Q.data.state,!1))}MVi(Q){Q.data.state.onFailure(-1)}CCb(Q){this.rXh(Q,!0)}rXh(Q,za){const fb=this.fNk(),Nb={};Nb[Jf.bIh]=Jf.cIh;Nb[Jf.Mnm]=Ra.a.Nj(Q.tcj);Nb[Jf.Knm]=this.E9j.value.mZk;this.mcj.sj(fb,2,"",Nb,!1,2,Object(a.a)(this,this.L_c,"onRenameFileSuccess"),za?Object(a.a)(this,this.Jqn,
"onRenameFileFailureRetry"):Object(a.a)(this,this.OVi,"onRenameFileFailureNoRetry"),Q)}fNk(){return this.pyh()}eNk(Q){let za=this.pyh();return za=Cb.a.hp(za,Jf.Qnm,Q?"2":"1")}pyh(){let Q=(this.Ma.value.appSettings.RenameWebServiceBase||"")+Jf.Lnm;Q=Cb.a.hp(Q,Jf.Nnm,Ra.a.Nj(m.AFrameworkApplication.hm));this.un&&this.un.aDf&&(Q=Cb.a.hp(Q,Jf.Pnm,"1"));return Q}L_c(Q){this.tZ=!1;const za=Ud(Q.data.xe);Q.data.state.onSuccess(za,this.l4g.value);this.DQi()}DQi(){this.Fl?this.Fl.XM(2,null,!0):this.jNe=!0}Jqn(Q){5!==
Q.data.status||this.tZ?this.OVi(Q):(this.tZ=!0,this.rXh(Q.data.state,!1))}OVi(Q){Q.data.state.onFailure(-1)}get pc(){return this.ga.value}get mcj(){return this.Wf.value}get un(){return this.Nk.value}static get instance(){return Jf._instance||(Jf._instance=Jf.rDb())}static rDb(){return new Jf(new hb.a(()=>m.AFrameworkApplication.va),new hb.a(()=>m.AFrameworkApplication.Ne),new hb.a(()=>m.AFrameworkApplication.un),new hb.a(()=>ua.a.instance.resolve("Postmessage.IHostPostmessenger")),new hb.a(()=>m.AFrameworkApplication.K),
new hb.a(()=>ua.a.instance.resolve("Common.IRenameProps")))}}Jf.bIh="Content-Type";Jf.cIh="application/json; charset=utf-8";Jf.Lnm="renamehandler.ashx";Jf.Nnm="qs";Jf.Mnm="n";Jf.Pnm="sl";Jf.Knm="X-CoauthLockId";Jf.Qnm="u";Jf._instance=null;Object(e.a)(Jf,"ExecuteRenameFileHandler",null,[]);class hh{constructor(){this.onFailure=this.onSuccess=null;this.wsj=!1}}Object(e.a)(hh,"ExecuteRefreshFilenameData",null,[]);class Qi{constructor(){this.onFailure=this.onSuccess=this.tcj=null}}Object(e.a)(Qi,"ExecuteRenameFileData",
null,[]);class Lg{constructor(){this.W=null;this.Oze=Jf.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}xc(Q){this.W=Q}init(){m.AFrameworkApplication.K.No(Object(a.a)(this,this.Lx,"onFullAppSettingsReady"))}Lx(){m.AFrameworkApplication.pVc()&&(Jf.instance.init(this.W,m.AFrameworkApplication.k4c),m.AFrameworkApplication.CCb=Object(a.a)(this,this.CCb,"executeRenameFile"),m.AFrameworkApplication.jOa=Object(a.a)(this,this.jOa,"executeRefreshFilename"),m.AFrameworkApplication.h6c=Object(a.a)(this,
this.h6c,"sendFileNameAndLocationUpdateNotification"))}CCb(Q,za,fb){const Nb=new Qi;Nb.tcj=Q;Nb.onSuccess=za;Nb.onFailure=fb;this.Oze.CCb(Nb)}jOa(Q,za,fb){const Nb=new hh;Nb.onSuccess=Q;Nb.onFailure=za;Nb.wsj=fb;this.Oze.jOa(Nb)}h6c(){this.Oze.DQi()}dispose(){}}Object(e.a)(Lg,"PackageManager",null,[1,2]);var bc=c(175);class vc{constructor(Q,za,fb){this.keg=this.leg=this.meg=!1;this.Ceg=!Q&&!za;this.Deg=!Q&&!fb;this.Ceg||this.Deg||(this.meg=!Q,this.leg=!za,this.keg=!fb)}}Object(e.a)(vc,"RenameDisabledDialogInfo",
null,[]);class Vc extends bc.StandardDialog{constructor(Q,za,fb,Nb,tc){super();this.Aig=[];this.eea=new vc(Q,za,fb);this.adb=Nb;this.Dab=tc;this.vg="RenameDisabledDialog";this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose);this.Rlo();this.F0n()}Rlo(){this.eea.Ceg?this.m8c(this.adb?this.Dab?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.eea.Deg?this.m8c(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):
this.bsk();this.hDc(this.Aig)}m8c(Q){Array.add(this.Aig,Q)}bsk(){const Q=[];this.eea.meg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.eea.leg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.eea.keg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Q.length&&Array.add(this.Aig,Q)}}Object(e.a)(Vc,"ReactRenameDisabledDialogBase",bc.StandardDialog,[]);class yd extends Vc{constructor(Q,za,fb,Nb,tc){super(Q,za,fb,Nb,tc)}F0n(){this.glb(CommonUIStrings.l_RenameFileRenameDisabledTitle,
null,null,null,null,null)}}Object(e.a)(yd,"ReactRenameDisabledDialog",Vc,[]);class ee{static get Xg(){return l.a.lA(ee.Lm,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}ee.Lm="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(e.a)(ee,"RenameDisabledDialogHtml",null,[]);class Qe extends l.a{constructor(Q,za,fb,Nb,tc){super();this.eea=new vc(Q,za,fb);this.adb=Nb;this.Dab=tc;this.vg="RenameDisabledDialog";this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose);this.Xg=ee.Xg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.Z4("RenameRow")}W8(){if(this.eea.Ceg){let Q;Q=this.adb?this.Dab?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Qe.m8c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Q)}else this.eea.Deg?Qe.m8c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.$qm()}$qm(){this.eea.meg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.eea.leg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.eea.keg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static m8c(Q,za,fb){Q.style.display="none";za.innerText=fb}}Object(e.a)(Qe,"RenameDisabledDialog",l.a,[]);class ue{constructor(Q,za){this.ivb=0;this.ga=Q;this.VJa=za}initialize(Q){if(!this.ga||!this.VJa)return!1;this.ivb=Q;this.Tb();return!0}Tb(){this.ga.qa(n.a.w8e,z.a.frame,Object(a.a)(this,this.w8e,"commitNewDocumentTitle"))}w8e(Q,za,fb,Nb,tc){if(1===fb)return this.ga.processAction(n.a.renameFile,
1);Q=Ra.a.cJ(this.VJa.Zy);tc=(0,tc.getNewDocumentTitle)();tc.length>this.ivb&&(tc=tc.substr(0,this.ivb));if(32!==this.ga.Qb(n.a.renameFile,2,tc))return this.qmc(Q),8;this.qmc(tc);return 32}qmc(Q){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Q))}static Rl(){return new ue(m.AFrameworkApplication.va,m.AFrameworkApplication.ps)}}Object(e.a)(ue,"ReactRenameUIHandler",null,[1864]);var ve=c(215),xf=c(1057),bf=c(525),Df=c(97),nf=c(161),Yf=c(26);class Kf{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd,
De,Nf,Je,va){this._initialized=!1;this._element=null;this.ivb=0;this.VQe=this.mDe=!1;this.ga=Q;this.Mja=za;this.ae=fb;this.Yr=Nb;this.VJa=tc;this.Qdh=bd;this.Itd=Yd;this.$ue=Fd;this.W$a=De;this.o1g=Nf;this.vi=Je;this.TEe=va}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Q,za,fb){if(!(this.ga&&this.VJa&&this.Qdh&&this.Itd&&this.$ue&&za)||0>=Q)return!1;this._element=za;this._element.title=fb;this._element.setAttribute(Yf.a.qh,Yf.a.e3);this._element.setAttribute("Unselectable",
"on");this.ivb=Q;this.wF();return this._initialized=!0}wF(){this.Mja&&(this.Mja.lb(X.a.blur,this._element,Object(a.a)(this,this.onBlur,"onBlur")),this.Mja.lb(X.a.paste,this._element,Object(a.a)(this,this.D_c,"onPaste")));this.ae.lb(X.a.hi,this._element,Object(a.a)(this,this.onKeyDown,"onKeyDown"));this.Yr.lb(X.a.pointerDown,this._element,Object(a.a)(this,this.ZC,"onPointerDown"));this.Yr.lb(X.a.QM,this._element,Object(a.a)(this,this.vxa,"onPointerUp"))}onBlur(){this.isActive&&!this.mDe&&(this.o1g||
this.$ue(this._element),this.hGh(),this.Dcf(!1));return this.mDe=!1}D_c(){ra.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Q){return this.isActive?this.Qnn(Q):this.Rnn(Q)}Qnn(Q){let za=!1;switch(Q.Gb.keyCode){case Sys.UI.Key.enter:this.hGh();this.Dcf(this.vi||this.TEe);za=!0;break;case Sys.UI.Key.tab:this.o1g&&this.$ue(this._element);break;case Sys.UI.Key.esc:this.C7f(),this.Dcf(this.vi||this.TEe),za=!0}return za}Rnn(Q){let za=!1;switch(Q.Gb.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.TAj(this.TEe),
this.isActive&&this.Itd(this._element),za=!0}return za}ZC(){this.isActive||(this.TAj(!1),this.isActive&&(this._element.focus(),this.Itd(this._element),this.VQe=!0));return!1}vxa(){return this.VQe?(this.Itd(this._element),this.VQe=!1,!0):!1}hbc(){return 32===this.ga.processAction(n.a.renameFile,1)}hGh(){const Q=Ra.a.cJ(this.VJa.Zy);let za=this._element.innerText.trim();za.length>this.ivb&&(za=za.substr(0,this.ivb));za!==Q&&""!==za?32!==this.ga.Qb(n.a.renameFile,2,za)?this.C7f():this.qmc(za):this.C7f()}C7f(){this.qmc(Ra.a.cJ(this.VJa.Zy))}qmc(Q){this._initialized&&
(this._element.innerText=Q,this.Qdh())}TAj(Q){this.hbc()?this.isActive||(Q&&(this.mDe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Yf.a.qh,Yf.a.Luh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,ve.CuiHelper.bUh),this.W$a&&this.W$a.execute(za=>{za.p5i(!0)}),Q&&this._element.focus(),ra.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.processAction(n.a.Ijc,
2)}Dcf(Q){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Yf.a.qh,Yf.a.e3);Sys.UI.DomElement.removeCssClass(this._element,ve.CuiHelper.bUh);this.W$a&&this.W$a.execute(za=>{za.p5i(!1)});Q&&(this._element.blur(),this._element.focus())}static rya(){xf.a.rya(m.AFrameworkApplication.isRtl)}static Rl(){return new Kf(m.AFrameworkApplication.va,bf.a.instance,Df.KeyInputManager.instance,nf.a.instance,m.AFrameworkApplication.ps,Kf.rya,
ha.a.T$n,ha.a.$Dh,ua.a.instance.Sa("Common.App.Header.HeaderEventSource"),Aa.a.i4,Aa.a.ti,Aa.a.jj)}}Object(e.a)(Kf,"RenameUIHandler",null,[1864]);class wb{static get instance(){return m.AFrameworkApplication.ta.Nb.oJ?wb._instance||(wb._instance=ue.Rl()):wb._instance||(wb._instance=Kf.Rl())}}wb._instance=null;Object(e.a)(wb,"RenameUIHandlerFactory",null,[]);var Tb=c(151);class Wc{constructor(){this.uQf=this.zen=this.Nel=null}}Object(e.a)(Wc,"RenameMruEntryProperties",null,[]);var Gd=c(162),Ye=c(85),
od=c(1538),vf;(function(Q){Q[Q.unknown=-1]="unknown";Q[Q.success=0]="success";Q[Q.renameInvalidFileName=1]="renameInvalidFileName";Q[Q.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Q[Q.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Q[Q.permissionDenied=4]="permissionDenied";Q[Q.serverCommunicationFailure=5]="serverCommunicationFailure";Q[Q.fileNameTooLong=6]="fileNameTooLong"})(vf||(vf={}));Object(e.b)("CommonOperationResult",vf);class df{constructor(Q,za,fb,Nb,tc,bd,
Yd,Fd,De,Nf,Je,va){this.H1g=Q;this.ga=za;this.Nk=fb;this.HL=Nb;this.Qub=tc;this.Wmk=bd;this.adb=Yd;this.Njh=Fd;this.Mfk=De;this.Dab=Nf;this.Ma=Je;this.Lfk=va}Tb(){m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb.oJ||this.pc.qa(n.a.$9b,z.a.frame,Object(a.a)(this,this.$9b,"initializeRenameUIHandler"));this.pc.qa(n.a.Ijc,z.a.frame,Object(a.a)(this,this.Ijc,"showRenameDisabledDialog"));this.pc.qa(n.a.renameFile,z.a.frame,Object(a.a)(this,this.renameFile,"renameFile"));this.pc.fb(n.a.fileNameUpdate,
z.a.frame,Object(a.a)(this,this.PRn,"refreshFilename"),64);this.pc.fb(n.a.B4d,z.a.frame,Object(a.a)(this,this.B4d,"moveToFolderCompleteByHost"),64);this.pc.qa(n.a.yJb,z.a.frame,Object(a.a)(this,this.yJb,"moveToFolder"));(m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||m.AFrameworkApplication.ta&&(m.AFrameworkApplication.K.$("PostMessageEmbedded")||m.AFrameworkApplication.K.$("IsJsApi"))&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&m.AFrameworkApplication.MO().execute(Q=>{Q.yv(Ye.a.AOi);Q.NB(Ye.a.AOi,df.hOn);Q.yv(Ye.a.tjf);Q.NB(Ye.a.tjf,df.fOn)})}hbc(){return 0===this.Lfk.Dei()?32:8}UYo(){return this.un?this.adb?this.un.gTh:this.un.Zgb:!0}$9b(){return wb.instance.initialize(m.AFrameworkApplication.FLd,m.AFrameworkApplication.YSh,m.AFrameworkApplication.Aaj||CommonUIStrings.l_RenameFileTooltip)?32:8}Ijc(){const Q=this.UYo(),za=this.Wmk();ra.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.Qub,za,Q,this.adb);m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb.nF&&m.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new yd(this.Qub,!za,!Q,this.adb,this.Dab()):new Qe(this.Qub,!za,!Q,this.adb,this.Dab());return 32}renameFile(Q,za,fb,Nb,tc){if(1===fb)return this.hbc();if(!m.AFrameworkApplication.CCb)return 8;if(8===this.hbc())return this.pc.processAction(n.a.Ijc,2),8;ra.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");m.AFrameworkApplication.CCb(tc,Object(a.a)(this,
this.L_c,"onRenameFileSuccess"),Object(a.a)(this,this.Iqn,"onRenameFileFailure"));m.AFrameworkApplication.zaj=!0;return 32}L_c(Q,za){Q?0!==Q.OperationResult?this.Iki(Q.OperationResult):(this.Kbo(za,Q.NewName),this.QQo(Q,Object(a.a)(m.AFrameworkApplication.ta.Nb,m.AFrameworkApplication.ta.Nb.CFj,"updateOpenInClientDocumentUrl")),m.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&m.AFrameworkApplication.ta.updateCommandUI(),this.Mfk.qDj()):this.Iki(5)}Kbo(Q,za){const fb={};fb[Gd.a.Gzl]=
za;Q.sendMessage(Ye.a.tjf,fb)}QQo(Q,za){this.dRo(Q);m.AFrameworkApplication.CId=Q.DirectInvokeDavUrl;za=za(Q.EditDocInClientUrl);const fb=new Wc;fb.uQf=this.HL.Zy;fb.Nel=za;fb.zen=Q.EditDocInClientUrl;this.pc.Qb(n.a.Baj,2,fb)}Iki(Q){switch(Q){case 1:Q=new bc.StandardDialog,Q.Ad=0,Q.$U(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.jdj()}}dRo(Q){this.HL.Zy=df.cCk(this.HL.Zy,Q.NewName);Q.BreadcrumbFolderName&&(this.HL.breadcrumbFolderName=Q.BreadcrumbFolderName);
Q.BreadcrumbFolderUrl&&(this.HL.breadcrumbFolderUrl=Q.BreadcrumbFolderUrl);this.Njh(Q.NewName)}Iqn(Q){const za=new bc.StandardDialog;za.Ad=0;switch(Q){case 1:ra.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");za.Yia(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:ra.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");za.Yia(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:ra.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:Q}),za.Yia(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}m.AFrameworkApplication.MO().execute(fb=>{fb.sendMessage(Ye.a.Fzl,{["FailureMessage"]:vf[Q]})});this.jdj()}PRn(Q,za,fb){if(1===fb)return this.hbc();if(!m.AFrameworkApplication.jOa)return 8;m.AFrameworkApplication.jOa(Object(a.a)(this,this.Eec,"onRefreshFilenameSuccess"),Object(a.a)(this,this.y7d,"onRefreshFilenameFailure"),
!1);return 32}yJb(Q,za,fb,Nb,tc){if(1===fb)return m.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===fb){const bd={};Q=m.AFrameworkApplication.jkb;za=m.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");Q=(!Q||Q&&za)&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);bd[Gd.a.ACo]=Q;tc&&tc.MoveButtonClickedTime&&(bd[Gd.a.Lcn]=tc.MoveButtonClickedTime.getTime());m.AFrameworkApplication.MO().execute(Yd=>{Yd.sendMessage(Ye.a.yJb,
bd)});if(tc&&tc.MoveButtonClickedTime){if(Q=Tb.a.fG())tc=(new Date).getTime()-tc.MoveButtonClickedTime.getTime(),Q.set("MovePostDuration",tc.toString());La.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Q)}return 32}return 8}B4d(Q,za,fb,Nb,tc){if(1===fb)return m.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.hbc():8;if(2===fb){if(!m.AFrameworkApplication.h6c)return La.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!tc)return La.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(tc[Gd.a.DGm])if(tc[Gd.a.jHj])if(Q=tc[Gd.a.jHj].toLowerCase(),za=m.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),fb=m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),za&&m.AFrameworkApplication.jkb&&fb){const bd={};bd[Gd.a.Kgc]="1";bd[Gd.a.documentUrl]=Q;bd[Gd.a.reason]=od.a.P8f;La.Health.instance.recordKpiSuccess("MoveToFolder",null);
m.AFrameworkApplication.MO().execute(Yd=>{Yd.sendMessage(Ye.a.$Bb,bd)})}else if(!m.AFrameworkApplication.jkb&&fb)La.Health.instance.recordKpiSuccess("MoveToFolder",null),ha.a.nm(Q,ha.a.Zqa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return La.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else La.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else m.AFrameworkApplication.jOa(Object(a.a)(this,this.Eec,"onRefreshFilenameSuccess"),
Object(a.a)(this,this.y7d,"onRefreshFilenameFailure"),!1),m.AFrameworkApplication.h6c(),La.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}pso(Q,za){return Q&&za?Q!==this.HL.breadcrumbFolderName||za!==this.HL.breadcrumbFolderUrl:!1}Eec(Q,za){Q&&(Q.NewName!==Ra.a.cJ(this.HL.Zy)||this.pso(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl))&&this.L_c(Q,za)}y7d(){}jdj(){this.Njh(Ra.a.cJ(this.HL.Zy))}get pc(){return this.ga.value}get un(){return this.Nk.value}static get instance(){return df._instance||
(df._instance=df.rDb())}static rDb(){return new df(m.AFrameworkApplication.pVc,new hb.a(()=>m.AFrameworkApplication.va),new hb.a(()=>m.AFrameworkApplication.un),m.AFrameworkApplication.ps,m.AFrameworkApplication.Noa,()=>m.AFrameworkApplication.Eng,m.AFrameworkApplication.k4c,Object(a.a)(wb.instance,wb.instance.qmc,"updateTitle"),ua.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>m.AFrameworkApplication.jv,m.AFrameworkApplication.K,ua.a.instance.resolve("Common.IRenameProps"))}static cCk(Q,
za){Q=Ra.a.zga(Q);return za+Q}static hOn(Q){const za=Q.Values[Gd.a.mMm];ra.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",za);za?m.AFrameworkApplication.va.Qb(n.a.B4d,2,Q.Values):La.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static fOn(Q){m.AFrameworkApplication.va.Qb(n.a.renameFile,2,Q.Values.NewName)}}df._instance=null;Object(e.a)(df,"RenameActor",null,[]);var dh=c(177),Ki=c(1368),Zh=c(566),rh=c(396);class bm{constructor(Q,
za){this.ga=Q;this.qrc=za}Tb(){this.ga.qa(n.a.xeg,z.a.frame,Object(a.a)(this,this.hvo,"showRenameDialogAction"))}hvo(Q,za,fb){Q=32;if(1===fb)return rh.SessionStatusManager.instance.wj||m.AFrameworkApplication.poa?8:32;2===fb&&(32!==this.ga.processAction(n.a.renameFile,1)?(this.ga.processAction(n.a.Ijc,2),dh.a.instance.Yb(Ki.a.Xma,{["Reason"]:Zh.a.V_n}),Q=8):32===this.ga.processAction(n.a.Jjc,1)?this.ga.processAction(n.a.Jjc,2):this.qrc.value.create().iTa());return Q}}Object(e.a)(bm,"RenameDialogActor",
null,[1861]);class Bf{constructor(Q,za,fb){this.dialog=null;this.ga=Q;this.HL=za;this.E$a=fb}$8l(){const Q={};Q.nameInputProps={["type"]:"AppInputProps",["id"]:Bf.N4b,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Ra.a.cJ(this.HL.Zy),["maxLength"]:this.E$a};return Q}iTa(){const Q={["id"]:"RenameDialog",["bodyControls"]:this.$8l()};this.dialog=new l.a(!1,!1,!0);this.dialog.Ad=1;this.dialog.vg="RenameDialog";this.dialog.Wh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.W5f,"renameDialogHandler"),
Q)}W5f(Q,za){if(za&&1===Q){if(za[Bf.N4b]&&(Q=Ra.a.cJ(this.HL.Zy),za=(za[Bf.N4b]||"").trim(),za!==Q&&""!==za)){this.ga.Qb(n.a.renameFile,2,za);return}dh.a.instance.Yb(Ki.a.K4b,{["Reason"]:Zh.a.TYh})}}}Bf.N4b="txtDocumentName";Object(e.a)(Bf,"ReactRenameDialog",null,[1867]);class ig{static get Xg(){return l.a.lA(ig.Lm,CommonUIStrings.l_RenameDialogLabel)}}ig.Lm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(e.a)(ig,"RenameDialogHtml",null,[]);class md extends l.a{constructor(Q,za,fb){super();this.ga=Q;this.HL=za;this.E$a=fb;this.vg="RenameDialog";this.Xg=ig.Xg}iTa(){var Q={["txtDocumentName"]:Ra.a.cJ(this.HL.Zy)};this.Wh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.W5f,"renameDialogHandler"),Q);Q=document.getElementById(md.N4b);0<this.E$a&&(Q.maxLength=this.E$a);Q.focus()}W5f(Q,za){if(1===Q&&(Q=Ra.a.cJ(this.HL.Zy),za=(za[md.N4b]||"").trim(),za!==Q&&""!==za)){this.ga.Qb(n.a.renameFile,
2,za);return}dh.a.instance.Yb(Ki.a.K4b,{["Reason"]:Zh.a.TYh})}}md.N4b="txtDocumentName";Object(e.a)(md,"RenameDialog",l.a,[1867]);class td{constructor(Q){this.VJa=null;this.E$a=0;this.ga=Q;this._initialized=!1}initialize(Q,za){this.VJa=Q;this.E$a=za;this._initialized=!0}create(){return this._initialized?m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb.nF&&m.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new Bf(this.ga,this.VJa,this.E$a):new md(this.ga,this.VJa,this.E$a):null}}Object(e.a)(td,
"RenameDialogFactory",null,[1860]);var wd=c(166),pm=c(106);class ai{constructor(Q,za){this.ga=Q;this.Ub=za}Tb(){this.ga.qa(n.a.Jjc,z.a.frame,Object(a.a)(this,this.ivo,"showRenameFlyoutAction"))}CRk(){return F.d("setDocumentTitleFlyoutOpened")&&m.AFrameworkApplication.ta.Nb.oJ}ivo(Q,za,fb){if(1===fb)return this.CRk()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}Qtk(){ai.CQm&&m.AFrameworkApplication.CM&&pm.a.instance.Vb(new Pc.a(5,1,5E3,()=>{32===this.ga.processAction(n.a.Jjc,
1)&&this.Ub&&this.Ub.currentScope.name===wd.AFrame.Pn&&(id.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.processAction(n.a.Jjc,2))}))}static get CQm(){ai.Hmd&&null!=ai.Hmd||(m.AFrameworkApplication.ue("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),ai.Hmd=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return ai.Hmd}}ai.Hmd=null;Object(e.a)(ai,"RenameFlyoutActor",
null,[1859]);class Zg{constructor(Q,za,fb,Nb,tc){this.mZk=null;this.Nk=tc;this.I1g=fb;this.H1g=Nb;this.Ymk=Q;this.Dab=za}get un(){return this.Nk.value}Dei(){if(!this.H1g())return 5;if(this.Dab())return 1;if(this.un){if(this.I1g&&!this.un.gTh)return 3;if(!this.I1g&&!this.un.Zgb)return 4}return this.Ymk()?0:2}}Object(e.a)(Zg,"RenameProps",null,[1858]);class Tk{constructor(Q,za,fb,Nb,tc,bd){this.Fs=!1;this.QHe=new nb.a;this.YTb=za;this.Jz=fb;this.WSb=Nb;this.Ma=tc;this.lla=bd}enable(){this.Fs||(this.qDj(),
this.Yfg(),this.Fs=!0)}generateKey(Q,za,fb){return String.format("{0}/{1}/{2}",fb,Q,za)}LZl(){const Q=Ra.a.cJ(this.YTb().Zy);return this.generateKey(this.YTb().breadcrumbFolderName,this.YTb().breadcrumbFolderUrl,Q)}MZl(Q,za,fb){return Q&&za?this.generateKey(Q,za,fb):fb}Hll(Q,za,fb){return Q&&Q!==this.YTb().breadcrumbFolderName||za&&za!==this.YTb().breadcrumbFolderUrl?!0:fb!==Ra.a.cJ(this.YTb().Zy)}qDj(){const Q=this.LZl();this.QHe.Z(Q,new Date)}UYf(Q){this.yqo(Q)&&this.fmh(Q)}yqo(Q){const za=this.WSb();
return za?this.lla&&this.lla.jo||!za.aDf||!m.AFrameworkApplication.jOa?(this.Quj(Q),this.Fs=!1):!0:!1}LWi(Q,za,fb,Nb){const tc=this.Hll(Q,za,fb);Q=this.MZl(Q,za,fb);za=this.QHe.Dc(Q).returnValue;tc&&!za&&(this.Kki(Nb),ra.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.CKf));tc||this.QHe.Z(Q,this.Jz())}}Object(e.a)(Tk,"ARenamedFileChecker",null,[1806]);class el extends Tk{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd){super(Q,za,fb,Nb,tc,bd);this.qK=tc;this.Kfk=Yd;this.PCe=Fd}get CKf(){return"RenamedFileCheckerUsingSettingsRefresh"}Yfg(){this.qK.CDc(Object(a.a)(this,
this.hli,"handleSettingsRefresh"))}hli(Q,za){za&&za.HJb&&za.ARi&&(za.rQa("BreadcrumbDocName")||za.rQa("BreadcrumbFolderName")||za.rQa("BreadcrumbFolderUrl")||za.rQa("DirectInvokeDAVUrl")||za.rQa("EditDocInClientUrl"))&&(ra.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.CKf),this.UYf(za))}Quj(){this.qK.M5f(Object(a.a)(this,this.hli,"handleSettingsRefresh"))}fmh(Q){if(Q&&Q.HJb){const za=Q.HJb;this.LWi(za.jb("BreadcrumbFolderName"),za.jb("BreadcrumbFolderUrl"),za.jb("BreadcrumbDocName"),
Q)}}Kki(Q){const za={OperationResult:0,classId:1};Q=Q.HJb;za.BreadcrumbFolderName=Q.jb("BreadcrumbFolderName");za.BreadcrumbFolderUrl=Q.jb("BreadcrumbFolderUrl");za.DirectInvokeDavUrl=Q.jb("DirectInvokeDAVUrl");za.EditDocInClientUrl=Q.jb("EditDocInClientUrl");Q=Q.jb("BreadcrumbDocName");za.NewName=m.AFrameworkApplication.ZId?Q:Ra.a.cJ(Q);this.PCe.execute(fb=>{this.bDm(za,fb)})}bDm(Q,za){this.Kfk().L_c(Q,za)}}Object(e.a)(el,"RenamedFileCheckerUsingSettingsRefresh",Tk,[]);class zl extends Tk{constructor(Q,
za,fb,Nb,tc,bd,Yd,Fd,De,Nf){super(Q,fb,Nb,tc,bd,De);this.yzc=this.il=null;this.$dk=za;this.ga=Yd;this.Hb=Fd;Nf&&Nf.execute(Je=>{this.hWn(Je)})}get CKf(){return"RenamedFileCheckerUsingTask"}hWn(Q){this.il=Q;this.il.RMa(Object(a.a)(this,this.DX,"handleVisibilityChange"))}DX(Q,za){!this.Fs||0!==za.newState&&1!==za.newState||this.yzc||(this.Yfg(),this.UYf(this.yzc))}Yfg(){this.yzc=new Pc.a(3,2,this.$dk(),Object(a.a)(this,this.UYf,"performRenameFileCheckTick"),89);this.Hb.Vb(this.yzc)}Quj(Q){this.Hb.Ve(Q)}fmh(Q){this.il&&
2===this.il.gB?this.WXn(Q):m.AFrameworkApplication.jOa(Object(a.a)(this,this.Eec,"onRefreshFilenameSuccess"),Object(a.a)(this,this.y7d,"onRefreshFilenameFailure"),!0)}WXn(Q){this.Hb.Ve(Q);this.yzc=null}Eec(Q){Q&&this.LWi(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl,Q.NewName,null)}Kki(){this.ga.processAction(n.a.fileNameUpdate,2)}y7d(){}}Object(e.a)(zl,"RenamedFileCheckerUsingTask",Tk,[]);var ei=c(65);class fi{constructor(){this.Ma=this.W=null}get name(){return"Common.App.RenameFile"}xc(Q){this.W=
Q;this.Ma=m.AFrameworkApplication.K;this.W.register(bm,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Rd(()=>new bm(m.AFrameworkApplication.va,this.W.Ue("Common.App.Rename.IRenameDialogFactory"))).singleInstance();this.W.register(td,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Rd(()=>new td(m.AFrameworkApplication.va)).singleInstance();this.W.register(1806,"Common.App.Rename.IRenamedFileChecker").Rd(()=>this.Mbl()).singleInstance();
this.W.register(ai,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Rd(()=>new ai(m.AFrameworkApplication.va,ei.FocusManager.instance())).singleInstance()}Mbl(){if(this.Ma.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Q=this.W.Na("Common.IRefreshableAppSettings");if(Q&&Q.$zi)return new el(()=>Q.mc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>m.AFrameworkApplication.ps,()=>new Date,()=>m.AFrameworkApplication.un,Q,this.W.Na("Common.ISessionStatus"),()=>
df.instance,this.W.Sa("Postmessage.IHostPostmessenger"))}return new zl(()=>this.Ma.mc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Ma.mc("RenamedFileCheckerPingIntervalInMs",12E4),()=>m.AFrameworkApplication.ps,()=>new Date,()=>m.AFrameworkApplication.un,m.AFrameworkApplication.K,m.AFrameworkApplication.va,m.AFrameworkApplication.nc,this.W.Na("Common.ISessionStatus"),this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Ma.No(Object(a.a)(this,this.Lx,"onFullAppSettingsReady"))}Lx(){const Q=
m.AFrameworkApplication.ta.Nb.oJ;m.AFrameworkApplication.pVc()&&wb.instance.initialize(m.AFrameworkApplication.FLd,Q?null:m.AFrameworkApplication.YSh,Q?null:m.AFrameworkApplication.Aaj||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(Zg,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Rd(()=>new Zg(()=>m.AFrameworkApplication.Eng,()=>m.AFrameworkApplication.jv,m.AFrameworkApplication.k4c,m.AFrameworkApplication.pVc,new hb.a(()=>m.AFrameworkApplication.un))).singleInstance(),df.instance.Tb(),
this.Ma.$("RenameDialogIsEnabled")&&(this.W.resolve("Common.App.Rename.RenameDialogFactory").initialize(m.AFrameworkApplication.ps,m.AFrameworkApplication.FLd),this.W.resolve("Common.App.Rename.IRenameDialogActor").Tb()),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Tb(),m.AFrameworkApplication.k4c&&this.W.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Qtk())}dispose(){}}Object(e.a)(fi,"PackageManager",null,[1,2]);class Lj{static get Xg(){return l.a.lA(Lj.Lm,
CommonUIStrings.l_SaveACopyFileName)}}Lj.Lm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(e.a)(Lj,"FileNameDialogHtml",null,[]);class cm extends l.a{constructor(Q,za,fb,Nb){super();this.ajd=this.rKa=null;
this.ga=Q;this.jra=za;this.qCc=fb;this.Ee(1,CommonUIStrings.l_SaveButtonLabel);this.Xg=Lj.Xg;this.vg="FileNameDialog-SaveACopy";this.Tm=Nb}FDa(Q,za,fb){this.ajd=Q;this.rKa=fb;Q={["txtFileName"]:Ra.a.cJ(m.AFrameworkApplication.ps.Zy),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,za)};this.Wh(CommonUIStrings.l_SaveToOneDrive,Object(a.a)(this,this.ELd,"fileNameDialogHandler"),Q);ra.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}ELd(Q,
za){1!==Q?ra.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(Q=za.txtFileName.trim(),ra.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),za=Ra.a.zga(m.AFrameworkApplication.fileName),Q&&""!==Q&&""!==za&&(Q+=za),this.qCc.QHa(this.ajd,this.rKa,Q,this.Tm))}}Object(e.a)(cm,"FileNameDialog",l.a,[1845]);class Rg{constructor(Q,za,fb){this.ga=Q;this.jra=za;this.qCc=fb}create(Q){return new cm(this.ga,this.jra,this.qCc,Q)}}Object(e.a)(Rg,
"FileNameDialogFactory",null,[1808]);class Xf extends bc.StandardDialog{constructor(Q){super();this.Ad=1;this.Ee(1,CommonUIStrings.l_RetryButtonLabel);this.Ee(0,CommonUIStrings.l_DialogClose);this.ga=Q}oO(Q){ra.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",Q);this.ix(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(a.a)(this,this.R7f,"retryDialogHandler"))}R7f(Q){1===Q?(ra.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.processAction(n.a.Ohc,
2)):ra.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(e.a)(Xf,"RetryDialog",bc.StandardDialog,[1807]);var Si=c(220);class Sl{constructor(Q,za,fb,Nb){this.Ssd=null;this.ahk=Q;this.Ma=fb;this.s9g=za;this.E4g=new A.a;this.he=Nb}Fbc(){return this.Ma.$("SaveToCloudStorageUIIsEnabled")}Wgb(){return n.a.Y8f}lCd(){Mb.a.u3c(Object(a.a)(this,this.Jfj,"saveToCloudActionDispatcher"));Mb.a.CKc([new Si.a(n.a.Y8f,z.a.frame,0)],this.s9g.Q7b())}Tb(){const Q=this.s9g.Q7b();Q?(Q.UZ(()=>{this.E4g.Ag(!0)}),
this.lCd()):ra.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}K6i(){ra.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}Jfj(Q,za,fb,Nb,tc){return za.contextId!==z.a.frame||Q!==this.Wgb()?2:this.Fbc()?1===fb?rh.SessionStatusManager.instance.wj||m.AFrameworkApplication.poa?8:32:2===fb?(this.K6i(),tc&&tc.FileDownloadUrl&&ra.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.he&&
(this.Ssd=this.he.Zf("DialogShown","SaveToOneDriveReponseTime")),this.E4g.task.continueWith(()=>{this.Ssd&&(this.Ssd.stop(),this.Ssd=null);this.ahk.start(tc)}),32):8:8}}Object(e.a)(Sl,"SaveToCloudStorageActor",null,[1812]);class Om extends Sl{constructor(Q,za,fb,Nb){super(Q,za,fb,Nb);this.Cck=za}Fbc(){return this.Ma.$("SaveACopyBrsIsEnabled")}Wgb(){return n.a.Ohc}lCd(){Mb.a.u3c(Object(a.a)(this,this.Jfj,"saveToCloudActionDispatcher"));Mb.a.CKc([new Si.a(n.a.Ohc,z.a.frame,0)],this.Cck.Q7b())}K6i(){m.AFrameworkApplication.ue("CreateCopy_cf;CreateCopy_tf");
ra.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(e.a)(Om,"SaveACopyActor",Sl,[]);class sg{}sg.default=0;Object(e.a)(sg,"SaveToCloudErrorCodes",null,[]);class Dk{constructor(Q,za,fb,Nb,tc,bd){this.Tm=null;this.Tik=Q;this.Wsa=za;this.qCc=fb;this.Ma=Nb;this.hSb=tc;this.dH=bd}start(Q){this.Tm=Q;if("SharePointOnlineConsumer"===this.Ma.jb("FileSource")){const za=ua.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(za){za.start(null,
Q);return}}this.Wsa.eTc?(ra.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.AQk()):(ra.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.rvo())}rvo(){this.Tik.create().FDa()}yp(){this.dH().oO(sg.default)}AQk(){try{ra.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let Q={["client_id"]:this.Ma.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.hSb||2===this.hSb)Q={["client_id"]:this.Ma.appSettings.UploadToSkyDriveClientId};
WL.init(Q);ra.ULS.sendTraceTag(6590562,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb&&1===m.AFrameworkApplication.ta.Nb.Sl?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"))}catch(Q){ra.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Q,Q.stack),this.yp()}}onSuccess(Q){ra.ULS.sendTraceTag(6590592,
216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");Q&&Q.data&&Q.data.folders&&this.qCc.QHa(Q.data.folders[0].id,Q.data.folders[0].urls.viewInBrowser,null,this.Tm)}onFailure(Q){if(Q&&Q.error){if("user_canceled"===Q.error.code){ra.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}ra.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",Q.error.code,Q.error.message)}else ra.ULS.sendTraceTag(6590595,
216,50,"File Dialog returned with no response");this.yp()}}Object(e.a)(Dk,"SaveToCloudManager",null,[1813]);class yj extends Dk{constructor(Q,za,fb,Nb,tc,bd,Yd){super(za,fb,Nb,tc,bd,Yd);this.M1j=Q}onSuccess(Q){Q&&Q.data&&Q.data.folders?(ra.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.M1j.create(this.Tm).FDa(Q.data.folders[0].id,Q.data.folders[0].name,Q.data.folders[0].urls.viewInBrowser)):(ra.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),
this.yp())}onFailure(Q){Q&&Q.error&&"user_canceled"===Q.error.code&&ra.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(Q)}yp(){ra.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.yp()}}Object(e.a)(yj,"SaveACopyManager",Dk,[]);var Qj=c(197);class tg{constructor(Q,za,fb,Nb,tc){this.rKa=this.zk=this.qpc=null;this.tZ=!1;this.Tm=this.BYa=null;this.kWe=Q;this.tXa=za;this.dH=fb;this.Ui=Nb;this.he=tc}L6a(){this.Ui&&1===
this.Ui.state||(this.zk=this.tXa(),this.zk.message=CommonUIStrings.l_CommentProgressTooltip,this.zk.Ad=5,this.zk.rt=!1,this.zk.oL(CommonUIStrings.l_DefaultDialogTitle,null,null))}Gma(){this.zk&&(this.zk.close(),this.zk=null)}h5(){1!==m.AFrameworkApplication.ta.state&&this.dH().oO(sg.default)}rMb(){ra.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");ha.a.nm(this.rKa,ha.a.Zqa(3),void 0,"UploadToCloudManager.RedirectToFolder")}qMb(Q){let za=!1,fb=!1;m.AFrameworkApplication.K&&(za=m.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),
fb=m.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ra.ULS.sendTraceTag(6654163,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb&&1===m.AFrameworkApplication.ta.Nb.Sl?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,za);if(za&&fb){ra.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Nb={};Nb[Gd.a.Kgc]="1";Nb[Gd.a.documentUrl]=Q;m.AFrameworkApplication.MO().execute(tc=>{tc.sendMessage(Ye.a.$Bb,
Nb)})}else ha.a.nm(Q,ha.a.Zqa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}QHa(Q,za,fb=null,Nb=null){ra.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.he&&(this.BYa=this.he.Zf("DialogShown","SaveToOneDriveUploadTime"));this.L6a();this.rKa=za;this.qpc=this.kWe.create(Q,fb,Nb);this.Tm=Nb;this.fga()}fga(){ra.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.qpc.execute(Object(a.a)(this,this.xrn,"onSaveToCloudUploadFinished"),Object(a.a)(this,this.wrn,"onSaveToCloudUploadFailed"))}xrn(Q){this.Gma();
this.tZ=!1;if(Q&&Q.data&&Q.data.xe){var za;if(({Wu:za}=Ya.d(Q.data.xe)).returnValue)if(Q=za,Q.StatusCode!==Qj.a.Hy&&Q.StatusCode!==Qj.a.pIc)ra.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.h5();else{ra.ULS.sendTraceTag(6590603,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb&&1===m.AFrameworkApplication.ta.Nb.Sl?15:50,"UploadToCloudManager upload success.");try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.qMb(Q.NewDocumentUrl):
this.rMb()}catch(fb){ra.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",fb.toString())}this.d1c()}else ra.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:ob.a.T$c(Q.data.xe)}),this.h5()}else ra.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.h5()}wrn(Q){5!==Q.data.status&&12!==Q.data.status||this.tZ?(ra.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",Q.data.status),
this.Gma(),this.h5(),this.d1c()):(ra.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.tZ=!0,this.fga())}d1c(){this.BYa&&(this.BYa.stop(),this.BYa=null)}}Object(e.a)(tg,"UploadToCloudManager",null,[1809]);class Gh extends tg{constructor(Q,za,fb,Nb,tc,bd){super(za,fb,Nb,tc,bd);this.ga=Q}KFf(){return!!this.Tm&&!!this.Tm.SaveEntryPoint&&"VersionHistory"===this.Tm.SaveEntryPoint.toString()}h5(){ra.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.KFf()&&
this.ga.Qb(n.a.Ede,2,{["FailureReason"]:"Unknown"});super.h5()}rMb(){ra.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.KFf()&&this.ga.processAction(n.a.F4c,2);super.rMb()}qMb(Q){ra.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",Q);this.KFf()&&this.ga.processAction(n.a.F4c,2);super.qMb(Q)}fga(){this.Tm&&"true"===this.Tm.SkipSaveToHost?super.fga():32!==this.ga.processAction(n.a.tNb,1)?(ra.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),
super.fga()):this.ga.Qb(n.a.tNb,2,[()=>{ra.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");tg.prototype.fga.call(this)},()=>{ra.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.h5()}])}}Object(e.a)(Gh,"SaveACopyUploadToCloudManager",tg,[]);var zj=c(744),pj=c(1194);class Il{constructor(){this.W=null}get name(){return"Common.App.SaveACopy"}init(){m.AFrameworkApplication.K.No(Object(a.a)(this,this.Lx,
"onFullAppSettingsReady"))}Lx(){m.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&this.W.resolve("Common.App.SaveACopy.SaveACopyActor").Tb()}dispose(){}xc(Q){this.W=Q;this.W.register(Gh,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Rd(()=>new Gh(m.AFrameworkApplication.va,Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new pj.a).create(),()=>new Xf(m.AFrameworkApplication.va),m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.Fq)).singleInstance();this.W.register(Rg,
"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Rd(()=>new Rg(m.AFrameworkApplication.va,m.AFrameworkApplication.ta.Nb,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).singleInstance();this.W.register(Om,"Common.App.SaveACopy.SaveACopyActor").Rd(()=>new Om(Q.resolve("Common.App.SaveACopy.SaveACopyManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),m.AFrameworkApplication.K,m.AFrameworkApplication.ta.Fq)).singleInstance();
this.W.register(yj,"Common.App.SaveACopy.SaveACopyManager").Rd(()=>new yj(Q.resolve("Common.App.SaveACopy.FileNameDialogFactory"),Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),zj.a.instance,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),m.AFrameworkApplication.K,m.AFrameworkApplication.R7,()=>new Xf(m.AFrameworkApplication.va))).singleInstance()}static main(){K.a.instance.Fc(new Il)}}Object(e.a)(Il,"PackageManager",null,[1,2]);var Tl=c(50);class Qg extends bc.StandardDialog{constructor(Q,
za){super();this.nXb=!1;this.xN=null;this.ga=Q;this.Csc=za;this.HHa=!1}oO(Q,za,fb){this.xN=za;this.nXb=fb;ra.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",Q,fb);Q=this.x6e(Q);0===Q?(this.Ad=6,this.Ee(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.Ee(1,CommonUIStrings.l_DialogClose));0===Q&&ra.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.ix(Tl.a.G8n,this.FSl(Q),this.ESl(Q,za),Object(a.a)(this,this.R7f,"retryDialogHandler"),!0)}R7f(Q){1===
Q?(ra.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.xN?this.ga.Qb(n.a.H5c,2,[this.xN,this.nXb]):this.ga.processAction(n.a.H5c,2)):ra.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}x6e(Q){return 0>Q||6<Q?(ra.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",Q),0):Q}ESl(Q,za){Q=this.x6e(Q);return this.Csc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,za),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][Q]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,za),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][Q]}FSl(Q){Q=this.x6e(Q);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,
CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][Q]}}Object(e.a)(Qg,"ErrorRetryDialog",bc.StandardDialog,[1855]);class An{constructor(Q,za){this.Ma=Q;this.ga=za;this.Csc=this.Ma.$("SaveToHostWithExtraCharsInFileName")}create(){return new Qg(this.ga,this.Csc)}}Object(e.a)(An,"ErrorRetryDialogFactory",null,[1831]);class Xj extends l.a{constructor(Q,za,fb,Nb,tc,bd,Yd=null){super();
this.j6=null;this.ga=za;this.jra=Nb;this.CYa=bd;this.Ma=Q;this.dH=tc;this.Ui=fb;this.Csc=this.Ma.$("SaveToHostWithExtraCharsInFileName");this.Tm=Yd;this.Ee(1,CommonUIStrings.l_SaveButtonLabel)}get ta(){return this.Ui}FRh(Q,za){this.bqa(1,!!Q&&Q!==za);this.j6=document.getElementById(Xj.SYh);V.a.addHandler(this.j6,"change",Object(a.a)(this,this.A6d,"onFileNameChange"));V.a.addHandler(this.j6,"input",Object(a.a)(this,this.A6d,"onFileNameChange"));this.j6.focus()}RYh(Q){return this.Csc?(new RegExp("["+
this.JWh('\\/:*?"<>|')+"]")).test(Q):(new RegExp("["+this.JWh('\\/:*?"<>|#{}%~&')+"]")).test(Q)}JWh(Q){return Q.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}mwf(){const Q=Ra.a.cJ(m.AFrameworkApplication.ps.Zy);this.bqa(1,!!this.j6&&""!==this.j6.value&&this.j6.value!==Q)}A6d(){this.j6&&window.setTimeout(()=>{this.mwf()},0)}ELd(Q,za){if(1!==Q)ra.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{Q=za[Xj.SYh];za=Xj.OYi in za?za[Xj.OYi]:!1;ra.ULS.sendTraceTag(23881883,
216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Ra.a.j7i(Q),za);const fb=Ra.a.zga(m.AFrameworkApplication.fileName);(Q=Q?Q.trim():null)&&""!==Q&&""!==fb||1===this.ta.state?this.RYh(Q)?this.dH.create().oO(1,Q,za):this.CYa.QHa(Q+fb,za,this.Tm):this.dH.create().oO(2,Q,za)}}dispose(){this.j6&&(V.a.removeHandler(this.j6,"change",Object(a.a)(this,this.A6d,"onFileNameChange")),V.a.removeHandler(this.j6,"input",Object(a.a)(this,this.A6d,"onFileNameChange")),this.j6=
null);super.dispose()}}Xj.SYh="txtFileName";Xj.OYi="chkOverwrite";Object(e.a)(Xj,"FileNameDialogBase",l.a,[]);class Gk{static get Xg(){return l.a.lA(Gk.Lm,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}Gk.Lm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(e.a)(Gk,"FileNameDialogHtml",null,[]);class dm extends Xj{constructor(Q,za,fb,Nb,tc,bd){super(Q,za,fb,Nb,tc,bd);this.Xg=Gk.Xg;this.vg="FileNameDialog-SaveAsToHost"}FDa(Q,za){const fb=Ra.a.cJ(m.AFrameworkApplication.ps.Zy);za={["txtFileName"]:Q||fb,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:za};this.Wh(CommonUIStrings.L_SaveAs,Object(a.a)(this,this.ELd,"fileNameDialogHandler"),za);this.FRh(Q,fb)}}Object(e.a)(dm,"FileNameDialog",Xj,[1852]);class Pm{constructor(Q,za,
fb,Nb,tc,bd){this.ga=za;this.Ma=Q;this.jra=Nb;this.CYa=bd;this.dH=tc;this.Ui=fb}create(){return new dm(this.Ma,this.ga,this.Ui,this.jra,this.dH,this.CYa)}}Object(e.a)(Pm,"FileNameDialogFactory",null,[1828]);class qm{constructor(Q,za,fb){this.CYa=fb;this.jAe=za;this.Ma=Q}Tb(){2===m.AFrameworkApplication.ta.Nb.Sl?m.AFrameworkApplication.va.fb(n.a.H5c,z.a.frame,Object(a.a)(this,this.rfj,"saveAsToHostActionDispatcher"),4):m.AFrameworkApplication.va.qa(n.a.H5c,z.a.frame,Object(a.a)(this,this.rfj,"saveAsToHostActionDispatcher"))}rfj(Q,
za,fb,Nb,tc){return za.contextId!==z.a.frame||Q!==n.a.H5c?2:this.Ma.$("SaveAsToHostBrsIsEnabled")?1===fb?rh.SessionStatusManager.instance.wj||m.AFrameworkApplication.poa?8:32:2===fb?(ra.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),Q=this.jAe.create(),tc&&Object.getType(tc)===Array&&2===tc.length?Q.FDa(tc[0],!!tc[1]):Q.FDa(null,!1),32):8:8}}Object(e.a)(qm,"SaveAsToHostActor",null,[]);class eg{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd){this.zk=null;this.nXb=this.tZ=
!1;this.BYa=this.Tm=this.xN=null;this.Ma=za;this.Ala=this.Ma.appSettings.SaveAsToHostWebServiceBase;this.l_g=Nb;this.tXa=tc;this.Wf=fb;this.dH=bd;this.he=Fd;this.Ui=Yd;this.ga=Q;this.cWa=za.jb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}L6a(){1!==this.Ui.state&&(this.zk=this.tXa(),this.zk.message=CommonUIStrings.l_CommentProgressTooltip,this.zk.Ad=5,this.zk.rt=!1,this.zk.oL(CommonUIStrings.l_DefaultDialogTitle,null,null))}h5(Q=0){1!==this.Ui.state&&this.dH.create().oO(Q,Ra.a.cJ(this.xN),
this.nXb)}rMb(){const Q=this.Ma.appSettings.BreadcrumbFolderUrl;ra.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");ha.a.nm(Q,ha.a.Zqa(3),void 0,"UploadToHostManager.RedirectToFolder")}qMb(Q){let za=!1,fb=!1;this.Ma&&(za=this.Ma.$("SaveACopyIsEnabledForUiHost"),fb=this.Ma.$("UiHostSupportsDocRebootFeatures"));ra.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",Q,za,fb);if(za&&fb){ra.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Nb={};Nb[Gd.a.Kgc]="1";Nb[Gd.a.documentUrl]=Q;Nb[Gd.a.reason]=od.a.P8f;m.AFrameworkApplication.MO().execute(tc=>{tc.sendMessage(Ye.a.$Bb,Nb)})}else za&&!fb&&m.AFrameworkApplication.vU?ha.a.nm(Q,ha.a.Zqa(4),void 0,"UploadToHostManager.RedirectToEditUrl"):ha.a.nm(Q,ha.a.Zqa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}QHa(Q,za,fb=null){ra.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.l_g&&
!this.l_g()&&this.Wf&&(this.he&&(this.BYa=this.he.Zf("DialogShown","SaveAsToHostUploadTime")),this.L6a(),this.nXb=za,this.xN=Q,(this.Tm=fb)&&"true"===this.Tm.SkipSaveToHost?this.QKd():this.fga())}fga(){32!==this.ga.processAction(n.a.tNb,1)?(ra.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.QKd()):this.ga.Qb(n.a.tNb,2,[()=>{ra.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.QKd()},(Q,za)=>
{ra.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.h5(za)}])}Ftn(Q){this.Gma();this.tZ=!1;if(Q&&Q.data&&Q.data.xe)if(({Wu:za}=Ya.d(Q.data.xe)).returnValue)if(Q=za,Q.StatusCode!==Qj.a.Hy&&Q.StatusCode!==Qj.a.pIc){ra.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var za={};za.FailureReason=Q.StatusCode.toString();za.ExtraInfo=Q.ExtraInfo;this.vSa(za);this.h5(parseInt(Q.ExtraInfo))}else{ra.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.Q6f();try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.qMb(Q.NewDocumentUrl):this.rMb()}catch(fb){ra.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",fb.toString())}this.d1c()}else ra.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:ob.a.T$c(Q.data.xe)}),this.vSa({["FailureReason"]:"Failed to deserialize response"}),this.h5();else ra.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.vSa({["FailureReason"]:"null response"}),this.h5()}Etn(Q){5!==Q.data.status&&12!==Q.data.status||this.tZ?(ra.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:Q.data.status,["HttpStatus"]:Q.data.Qe}),this.vSa({["FailureReason"]:Q.data.Qe.toString()}),this.Gma(),this.h5(),this.d1c()):(ra.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.tZ=!0,this.Tm&&"true"===this.Tm.SkipSaveToHost?this.QKd():this.fga())}Gma(){this.zk&&
(this.zk.close(),this.zk=null)}d1c(){this.BYa&&(this.BYa.stop(),this.BYa=null)}Q6f(){this.Tm&&"VersionHistory"===this.Tm.SaveEntryPoint&&this.ga.processAction(n.a.F4c,2)}vSa(Q){this.Tm&&"VersionHistory"===this.Tm.SaveEntryPoint&&this.ga.Qb(n.a.Ede,2,Q)}QKd(){let Q=this.Ala+this.cWa;Q=Cb.a.hp(Q,"qs",Ra.a.Nj(m.AFrameworkApplication.hm));Q=Cb.a.hp(Q,"n",Ra.a.Nj((new Date).getTime().toString()));Q=Cb.a.hp(Q,"ov",Ra.a.Nj(this.nXb.toString()));Q=Cb.a.hp(Q,"fn",Ra.a.Nj(this.xN));this.Tm&&this.Tm.FileDownloadUrl&&
(Q=Cb.a.hp(Q,"furl",Ra.a.Nj(this.Tm.FileDownloadUrl)));this.Wf.sj(Q,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(a.a)(this,this.Ftn,"onUploadFinished"),Object(a.a)(this,this.Etn,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(e.a)(eg,"UploadToHostManager",null,[1827]);class Hk{constructor(){this.W=null}get name(){return"Common.App.SaveAsToHost"}init(){m.AFrameworkApplication.K.No(Object(a.a)(this,this.Lx,"onFullAppSettingsReady"))}Lx(){m.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&
this.W.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Tb()}xc(Q){this.W=Q;this.W.register(An,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Rd(()=>new An(m.AFrameworkApplication.K,m.AFrameworkApplication.va)).singleInstance();this.W.register(eg,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Rd(()=>new eg(m.AFrameworkApplication.va,m.AFrameworkApplication.K,m.AFrameworkApplication.Ne,
()=>m.AFrameworkApplication.Lk,()=>(new pj.a).create(),Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.Fq)).singleInstance();this.W.register(Pm,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Rd(()=>new Pm(m.AFrameworkApplication.K,m.AFrameworkApplication.va,m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.Nb,Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance();
this.W.register(qm,"Common.App.SaveAsToHost.SaveAsToHostActor").Rd(()=>new qm(m.AFrameworkApplication.K,Q.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance()}dispose(){}static main(){K.a.instance.Fc(new Hk)}}Object(e.a)(Hk,"SaveAsToHostPackage",null,[1,2]);class Qm extends bc.StandardDialog{constructor(){super();this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose)}oO(Q){this.ix(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(e.a)(Qm,"ErrorDialog",bc.StandardDialog,[1807]);var Uf=c(201);class Jd extends bc.StandardDialog{constructor(Q,za,fb){super();this.ga=Q;this.Wsa=za;this.jra=fb;this.A$=!1;this.Ad=1;this.XU(1);this.Ee(1,CommonUIStrings.l_SignIn);this.Ee(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}FDa(){this.Wsa.lph(Object(a.a)(this,this.IWi,"onSignIn"));this.Gu(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(a.a)(this,this.$ym,"inputHandler"))}$ym(Q){0===
Q?(ra.ULS.sendTraceTag(6590598,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb&&1===m.AFrameworkApplication.ta.Nb.Sl?15:50,"User dismissed SignIn Dialog."),this.hide()):this.Q9d()}OTk(){let Q="2";if(this.jra)switch(this.jra.Sl){case 3:Q="0";break;case 2:Q="3";break;case 1:Q="1"}return Q}hide(){this.Wsa.HZn(Object(a.a)(this,this.IWi,"onSignIn"));super.hide()}Q9d(){var Q=m.AFrameworkApplication.K.$("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";Q=new Uf.QueryStringBuilder(Q);
Q.Ce("prompt","1");Q.Ce("cbcxt",this.OTk());m.AFrameworkApplication.Sea(Q);ha.a.nm(Q.toString(),"LoginWindow",void 0,"SignInDialog")}IWi(){this.oha&&this.hide();ra.ULS.sendTraceTag(7143885,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb&&1===m.AFrameworkApplication.ta.Nb.Sl?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.processAction(n.a.Y8f,2)}}Object(e.a)(Jd,"SignInDialog",bc.StandardDialog,[1847]);class kl{constructor(Q,za,fb){this.ga=Q;this.Wsa=
za;this.jra=fb}create(){return new Jd(this.ga,this.Wsa,this.jra)}}Object(e.a)(kl,"SignInDialogFactory",null,[1811]);class Ik{constructor(Q,za,fb,Nb,tc,bd,Yd){this.Ala=Q;this.xN=za;this.EUb=fb;this.ajd=Nb;this.sOe=tc;this.cWa=bd;this.Tm=Yd}execute(Q,za){if(!m.AFrameworkApplication.Lk&&m.AFrameworkApplication.Ne){var fb=this.Ala+this.cWa;fb=Cb.a.hp(fb,"fo",Ra.a.Nj(this.ajd));fb=Cb.a.hp(fb,"fn",Ra.a.Nj(this.xN));fb=Cb.a.hp(fb,"qs",Ra.a.Nj(this.sOe));fb=Cb.a.hp(fb,"n",Ra.a.Nj((new Date).getTime().toString()));
this.Tm&&this.Tm.FileDownloadUrl&&(fb=Cb.a.hp(fb,"furl",Ra.a.Nj(this.Tm.FileDownloadUrl)));this.EUb&&(fb=Cb.a.hp(fb,"fnn",Ra.a.Nj(this.EUb)));m.AFrameworkApplication.Ne.sj(fb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Q,za,null)}}}Object(e.a)(Ik,"SkyDriveUploadCaller",null,[1846]);class tf{constructor(Q){this.Ma=Q;this.xyb=Q.appSettings.SkyDriveUploadWebServiceBase;this.xN=Q.appSettings.FileName;this.cWa=Q.jb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(Q,za,fb){return new Ik(this.xyb,
this.xN,za,Q,m.AFrameworkApplication.hm,this.cWa,fb)}}Object(e.a)(tf,"SkydriveUploadCallerFactory",null,[1810]);class hd{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){m.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&this.W.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Tb()}dispose(){}xc(Q){this.W=Q;this.W.register(kl,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Rd(()=>
new kl(m.AFrameworkApplication.va,zj.a.instance,m.AFrameworkApplication.ta.Nb)).singleInstance();this.W.register(tf,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Rd(()=>new tf(m.AFrameworkApplication.K)).singleInstance();this.W.register(Sl,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Rd(()=>new Sl(Q.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
m.AFrameworkApplication.K,m.AFrameworkApplication.ta.Fq)).singleInstance();this.W.register(tg,"Common.App.SaveToCloudStorage.UploadToCloudManager").Rd(()=>new tg(Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new pj.a).create(),()=>new Qm,m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.Fq)).singleInstance();this.W.register(Dk,"Common.App.SaveToCloudStorage.SaveToCloudManager").Rd(()=>new Dk(Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),zj.a.instance,
Q.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),m.AFrameworkApplication.K,m.AFrameworkApplication.R7,()=>new Qm)).singleInstance()}static main(){K.a.instance.Fc(new hd)}}Object(e.a)(hd,"PackageManager",null,[1,2]);class lg extends bc.StandardDialog{constructor(){super();this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose)}oO(Q,za){this.aSh(Q,za,Tl.a.I8n)}aSh(Q,za,fb){ra.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",fb);this.ix(fb,Q,za,null)}dff(Q,za){ra.ULS.sendTraceTag(25235986,
216,15,"Show warning dialog of Picker related issue.");this.ix(Tl.a.K8n,Q,za,null,!0)}}Object(e.a)(lg,"ErrorDialog",bc.StandardDialog,[954]);class Bn{static get Xg(){return l.a.lA(Bn.Lm,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}Bn.Lm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(e.a)(Bn,"FileNameDialogHtml",null,[]);var Rj=c(79);class ge extends Xj{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd){super(Q,za,fb,Nb,tc,bd,Fd);this.iab=this.zQe=this.eQ=null;this.uOk=CommonUIStrings.l_SaveToAnotherFolder;this.Xg=Bn.Xg;this.vg="FileNameDialog-SaveToSharePoint";this.hAc=Yd;this.Pck=Fd}FDa(Q){const za=Ra.a.cJ(m.AFrameworkApplication.ps.Zy),fb=m.AFrameworkApplication.breadcrumbFolderName,Nb=m.AFrameworkApplication.breadcrumbBrandName,tc={["txtFileName"]:Q||za};let bd=CommonUIStrings.L_SaveAs;
2===m.AFrameworkApplication.ta.Nb.Sl&&(bd=CommonUIStrings.L_SaveACopy);this.Wh(bd,Object(a.a)(this,this.ELd,"fileNameDialogHandler"),tc);this.FRh(Q,za);this.Vdf.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");m.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.eQ=document.getElementById("anotherFolder"),Q=document.getElementById("folderLocation"),this.zQe=Yf.a.psh(Q,this.eQ,"anotherFolderDescribedBy"),this.eQ.className=
"WACButton WACDialogButtonNormal",Q=!1,fb&&fb.length?(this.cnh(this.eQ,this.zQe,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Nb,fb)),Q=this.Tpk(Nb,fb)):this.cnh(this.eQ,this.zQe,CommonUIStrings.l_CurrentOnlineFolder),this.Krk(this.eQ),this.Vpk(this.eQ),Q?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.eQ,"SaveToAnotherLocationTwo"),ra.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.eQ,
"SaveToAnotherLocationOne"),V.a.addHandler(this.eQ,X.a.click,Object(a.a)(this,this.EVf,"onSaveToAnotherLocationClick")),V.a.addHandler(this.eQ,X.a.hi,Object(a.a)(this,this.oWi,"onSaveToAnotherLocationKeyDown")))}Tpk(Q,za){let fb;fb=!1;const Nb=document.getElementById("currentLocation");Nb.innerText="";const tc=this.fbi(Nb,Q),bd=this.fbi(Nb,za);let Yd=255,Fd=255;255<tc+bd&&(Yd=Math.max(238,408-tc),Fd=Math.max(170,408-bd),fb=!0);this.Ttk(Nb,Q,Fd,za,Yd);return fb}fbi(Q,za){const fb=document.createElement("div");
fb.innerText=za;fb.style.visibility="hidden";Q.appendChild(fb);za=fb.clientWidth;Q.removeChild(fb);return za}Ttk(Q,za,fb,Nb,tc){za&&(this.bnh(Q,za,fb),this.Mtk(Q));Nb&&this.bnh(Q,Nb,tc)}bnh(Q,za,fb){const Nb=document.createElement("div");Nb.innerText=za;Nb.title=za;Nb.className="SaveToAnotherFolderBreadcrumb";Nb.style.maxWidth=fb.toString()+"px";Q.appendChild(Nb)}Mtk(Q){const za=document.createElement("span");za.id="FolderSeparator";const fb=document.createElementNS("http://www.w3.org/2000/svg","svg");
fb.setAttribute("class","SeparatorCaret");const Nb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Nb.setAttribute("points","1 4 1 11 5 7.5");fb.appendChild(Nb);za.appendChild(fb);Q.appendChild(za)}cnh(Q,za,fb){fb=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,fb);za&&(za.innerText=fb);Q.tabIndex=0;Q.setAttribute(Yf.a.qh,Yf.a.e3)}Vpk(Q){const za=document.createElement("span");za.id="anotherFolderText";za.innerText=this.uOk;za.className="AnotherFolderTextSpan";
Q.appendChild(za)}Krk(Q){const za=document.createElement("span");za.className="cui-img-cont-float cui-img-16by16 ";this.iab=document.createElementNS("http://www.w3.org/2000/svg","svg");this.iab.setAttribute("class","FolderIconSVG");const fb=document.createElementNS("http://www.w3.org/2000/svg","path");fb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.iab.appendChild(fb);za.appendChild(this.iab);Q.appendChild(za)}oWi(Q){!Q||
Q.keyCode!==Rj.a.zs&&Q.keyCode!==Rj.a.koe||this.EVf(Q)}EVf(){if(this.j6){const Q=Ra.a.zga(m.AFrameworkApplication.fileName);let za=this.j6.value;this.hide();za&&""!==za&&""!==Q||1===this.ta.state?(""!==Q&&(za+=Q),this.RYh(za)?this.dH.create().oO(1,za,!1):this.hAc.start(za,this.Pck)):this.dH.create().oO(2,za,!1)}}tTk(Q){this.eQ&&this.iab&&(Q?(this.eQ.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.eQ,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.iab,"DisabledFolderIconSVG")):(this.eQ.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.eQ,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.iab,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.eQ,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.iab,"DisabledFolderIconSVG"))))}mwf(){super.mwf();this.tTk(!!this.j6&&""!==this.j6.value)}dispose(){this.eQ&&(V.a.removeHandler(this.eQ,X.a.click,Object(a.a)(this,this.EVf,"onSaveToAnotherLocationClick")),V.a.removeHandler(this.eQ,X.a.hi,Object(a.a)(this,this.oWi,
"onSaveToAnotherLocationKeyDown")),this.eQ=null);super.dispose()}}Object(e.a)(ge,"FileNameDialog",Xj,[1119]);var Uc=c(497),ql=c(355),Cg=c(1534),yg=c(1659);class Bh{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(e.a)(Bh,"SaveAsDialogInput",null,[]);class ug{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(e.a)(ug,"SaveLocation",null,[]);var Ee=c(119);class pf{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd,De){this.lIe=
null;this.xN="";this.hAc=Q;this.dH=za;this.Tm=De;this.CYa=fb;this.Ui=tc;this.HL=Nb;this.jyb=Yd;this.TYb=Fd;bd&&(this.lIe=new hb.a(()=>new Cg.a(bd.value,null)))}vRl(){const Q=new Uc.a(ql.a.ei());Q.Z("type","currentHost");return Object.assign(new ug,{folderName:this.HL.breadcrumbFolderName,friendlyPath:this.HL.breadcrumbBrandName,properties:Q})}zQm(Q){return!!Q&&"ClassicMru"===Q.type&&!!Q.service_info&&!!Q.service_info.service_id&&-1!==Q.service_info.service_id.indexOf("SHAREPOINT")}Qam(){if(!this.lIe||
!this.jyb)return null;var Q=this.lIe.value.Yj("SaveAsToSharePointDialog",!1);if(!Q||3!==Q.state||!Q.IOi)return null;Q=Q.IOi;const za=new ib.a;let fb=0,Nb=0;for(var tc=0;tc<Q.length;tc++){var bd=Q[tc];if(!this.zQm(bd))continue;fb++;if(!bd.sharepoint_info)continue;const Yd=bd.url,Fd=bd.sharepoint_info.site_url,De=bd.title;bd=yg.b(bd,m.AFrameworkApplication.isRtl);if(!(Yd&&Fd&&De&&bd))continue;Nb++;const Nf=new Uc.a(ql.a.ei());Nf.Z("type","SharePoint");Nf.Z("siteUrl",Fd);Nf.Z("folderUrl",Yd);Nb++;za.add(Object.assign(new ug,
{folderName:De,friendlyPath:bd,properties:Nf}))}tc=new Map;tc.set("NumPlaces",Q.length.toString());tc.set("NumSharepointPlaces",fb.toString());tc.set("placesWithMetadata",Nb.toString());La.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",tc);0<fb&&(Nb?.5>1*Nb/fb&&La.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):La.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return za}DSl(){const Q=
new ib.a;Q.add(this.vRl());const za=this.Qam();za&&Q.addRange(za);return Object.assign(new Bh,{enableMoreLocations:!m.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.xN,extension:Ra.a.zga(this.HL.Zy),saveLocations:Q.toArray(),scenario:"SaveToSharePoint"})}epf(){const Q=Object(a.a)(this,this.DSl,"getDialogInput"),za={};za.inputPropsCallback=Q;return za}FDa(Q){this.xN=Q;this.xN||(this.xN=String.format(CommonUIStrings.l_SaveACopy_Filename,Ra.a.cJ(this.HL.Zy)));Q={["id"]:"SaveAsDialog",
["bodyControls"]:this.epf()};let za=CommonUIStrings.L_SaveAs;2===this.Ui.Nb.Sl&&(za=CommonUIStrings.L_SaveACopy);const fb=new l.a(!1,!1,!0);fb.Ad=1;fb.vg="SaveAsDialog";fb.Ee(1,CommonUIStrings.l_SaveButtonLabel);fb.Wh(za,Object(a.a)(this,this.E8n,"saveAsDialogHandler"),Q)}Euo(Q,za){Q&&""!==Q&&""!==za||1===this.Ui.state?this.yQm()?this.HZm(Q,za):(""!==za&&(Q+=za),this.hAc.start(Q,this.Tm)):(ra.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.dH.create().oO(2,
Q,!1))}HZm(Q,za){La.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const fb=this.TYb.haf(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.TYb.bPd(fb).then(Nb=>{if(Nb&&0<Nb.length){const tc=Nb[0][Gd.a.LAn];Nb=Nb[0][Gd.a.MAn];if(""!==tc&&""!==Nb)this.jyb.QHa(Nb,Q+za,tc,this.Tm),La.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.dH.create().oO(0,Q,!1);const bd=Tb.a.fG();bd&&(bd.set("SiteUrlAvailable",
""===tc?"false":"true"),bd.set("FolderUrlAvailable",""===Nb?"false":"true"));La.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Ee.a,{extendedProperties:bd}))}}else this.dH.create().oO(0,Q,!1),La.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Nb=>{"Canceled"===Nb?((Nb=Tb.a.fG())&&Nb.set("IsCanceled","true"),La.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Ee.a,{extendedProperties:Nb}))):
La.Health.instance.recordKpiFailure("SaveACopySFP",Nb,!1,!1,null)})}yQm(){return this.TYb?this.TYb.UFf():(ra.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}E8n(Q,za){if(za&&1===Q){Q=za.fileName;var fb=Ra.a.zga(this.HL.Zy);za.moreLocationsSelected&&this.Euo(Q,fb);if(za.locationCallback){var Nb=za.locationCallback();Nb?Nb.properties&&"currentHost"===Nb.properties.J("type")?this.CYa.QHa(Q+fb,!1,this.Tm):Nb.properties&&"SharePoint"===Nb.properties.J("type")?(za=Nb.properties.J("siteUrl"),
Nb=Nb.properties.J("folderUrl"),this.jyb.QHa(Nb,Q+fb,za,this.Tm)):ra.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):ra.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else ra.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(e.a)(pf,"ReactSaveAsDialog",null,[1119]);class sj{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd=null,De=null,Nf=null){this.ga=za;this.Ma=Q;this.jra=Nb;this.CYa=bd;this.dH=tc;this.Ui=fb;this.Odh=Yd;this.x9j=Fd;this.jyb=De;this.TYb=
Nf}create(Q){return this.Ui&&this.Ui.Nb.nF?new pf(this.Odh,this.dH,this.CYa,m.AFrameworkApplication.ps,this.Ui,this.x9j,this.jyb,this.TYb,Q):new ge(this.Ma,this.ga,this.Ui,this.jra,this.dH,this.CYa,this.Odh,Q)}}Object(e.a)(sj,"FileNameDialogFactory",null,[1095]);class Nn{constructor(Q,za,fb,Nb){this.Aw=this.Uxc=null;this.ctb=Q;this.Ui=fb;this.Zdk=Nb;this.aWa=new hb.a(()=>new Cg.a(za.value,Object(a.a)(this,this.tEb,"getMoreInfoEventReceived")))}get GXi(){this.Uxc||(this.aWa.value.Yj("Save As",!0),
this.Aw&&this.Aw.Aca&&this.Aw.Aca.length&&(this.Uxc=this.X3l(this.Aw.Aca)));return this.Uxc}start(Q){if(!this.GXi)if(m.AFrameworkApplication.breadcrumbFolderUrl&&m.AFrameworkApplication.breadcrumbFolderUrl.length)this.Uxc=m.AFrameworkApplication.breadcrumbFolderUrl;else return ra.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Aw),!1;const za=this.Zdk();za.Suo();const fb=
za.F6l();if(!fb)return ra.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.ctb.start((Nb,tc)=>{za.hide();Q(Nb,tc)},()=>{this.$Jb(za)},fb,this.Uxc);return!0}$Jb(Q){Q.hide();ra.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}X3l(Q){Q=Q.toLowerCase();Q.endsWith("/")||(Q+="/");const za=Q.indexOf("/documents/");return-1!==za?Q.substring(0,za+1)+"_layouts/15/onedrive.aspx":""}tEb(Q){this.Aw||3!==Q.state||(this.Aw=Q)}}Object(e.a)(Nn,"OneDriveFilePickerHelper",
null,[1096]);class Sg extends l.a{constructor(){super()}Suo(){this.Pqc="FilePickerDialog";this.Xg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.vg="PickerDialog-MsoSp";this.showDialog("",null)}F6l(){return document.getElementById("FilePickerDiv")}qL(){}Fca(){}}Object(e.a)(Sg,"PickerDialog",l.a,[956]);class Rf{constructor(Q,za,fb,Nb,tc,bd,Yd){this.Ma=Q;this.jAe=fb;this.ga=za;this.hAc=Nb;this.ctb=tc;this.Txc=bd;this.BXj=Yd}Tb(){const Q=this.ctb.Q7b();Q?Aa.a.moa||this.Ma.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.fb(n.a.Qhc,z.a.frame,Object(a.a)(this,this.Mfj,"saveToSharePointActionDispatcher"),64):(Q.J3a.continueWith(za=>{za.Ci&&this.ctb.sUf(za)}),this.lCd()):ra.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}lCd(){Mb.a.u3c(Object(a.a)(this,this.Mfj,"saveToSharePointActionDispatcher"));Mb.a.CKc([new Si.a(n.a.Qhc,z.a.frame,0)],this.ctb.Q7b())}get Fbc(){return this.Ma.$("SaveToAnotherFolderBrsIsEnabled")}get FAh(){return this.Ma.$("UserCanWriteRelative")}Mfj(Q,
za,fb,Nb,tc){return za.contextId!==z.a.frame||Q!==n.a.Qhc?2:this.Fbc&&(this.Txc.GXi||this.FAh)?1===fb?rh.SessionStatusManager.instance.wj||m.AFrameworkApplication.poa?8:this.BXj()?32:8:2===fb?(ra.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(tc&&tc.SaveEntryPoint&&"VersionHistory"===tc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.FAh?(ra.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.jAe.create(tc).FDa(null)):(ra.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.hAc.start(null,tc)),32):8:8}}Object(e.a)(Rf,"SaveToSharePointActor",null,[]);class $k{constructor(Q,za,fb,Nb){this.Tm=this.k7g=null;this.jyb=Q;this.dH=za;this.Txc=fb;this.Ui=Nb}start(Q,za){ra.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.k7g=Q;this.Tm=za;this.Txc.start((fb,Nb)=>{this.processResponse(fb,Nb)})||this.reg()}processResponse(Q,za){if(Q)this.onSuccess(za);else this.onFailure(za)}reg(){1!==
this.Ui.state&&this.dH().dff(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(Q){ra.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(Q&&Q.data&&Q.data.value&&Q.data.value.length&&Q.data.value[0].sharePoint){const za=Q.data.value[0].sharePoint.url;Q=Q.data.value[0].sharePoint.listUrl;let fb=null;if(za&&(fb=Q?this.cbm(Q):this.bbm(za))){this.jyb.QHa(za,this.k7g,fb,this.Tm);return}ra.ULS.sendTraceTag(25180164,
216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!za,!fb)}ra.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.reg()}bbm(Q){Q.endsWith("/")||(Q+="/");let za=0;for(let fb=0;fb<Q.length;fb++)if("/"===Q.charAt(fb)&&5===++za)return Q.substr(0,fb);return null}cbm(Q){Q.endsWith("/")&&(Q=Q.substring(0,Q.length-1));const za=Q.lastIndexOf("/");return-1!==za?Q.substring(0,za):null}onFailure(Q){ra.ULS.sendTraceTag(23881888,216,
10,"Picker failure Callback called.");Q&&Q.error?ra.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",Q.error.errorCode,Q.error.message):ra.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.reg()}}Object(e.a)($k,"SaveToSharePointManager",null,[1834]);class gi{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd){this.Ala=Q;this.xN=za;this.EUb=Nb;this.sOe=bd;this.rKa=fb;this.gjk=tc;this.cWa=Yd;this.Tm=Fd}execute(Q,za){if(!m.AFrameworkApplication.Lk&&
m.AFrameworkApplication.Ne){var fb=this.Ala+this.cWa;fb=Cb.a.hp(fb,"fu",Ra.a.Nj(this.rKa));fb=Cb.a.hp(fb,"su",Ra.a.Nj(this.gjk));fb=Cb.a.hp(fb,"fn",Ra.a.Nj(this.xN));fb=Cb.a.hp(fb,"n",Ra.a.Nj((new Date).getTime().toString()));this.Tm&&this.Tm.FileDownloadUrl&&(fb=Cb.a.hp(fb,"furl",Ra.a.Nj(this.Tm.FileDownloadUrl)));fb=fb+"&"+this.sOe;this.EUb&&this.EUb.length?fb=Cb.a.hp(fb,"fnn",Ra.a.Nj(this.EUb)):ra.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");ra.ULS.sendTraceTag(23881920,216,
50,"Trying send SharePointSaveAsHandler.ashx request.");m.AFrameworkApplication.Ne.sj(fb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Q,za,null,void 0,void 0,void 0,void 0,"9")}}}Object(e.a)(gi,"SharePointSaveAsCaller",null,[1856]);class ym{constructor(Q){this.xyb=Q.appSettings.SaveAsToHostWebServiceBase;this.xN=Q.appSettings.FileName;this.cWa=Q.jb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(Q,za,fb,Nb){return new gi(this.xyb,this.xN,Q,za,fb,m.AFrameworkApplication.hm,
this.cWa,Nb)}}Object(e.a)(ym,"SharePointUploadCallerFactory",null,[1833]);var jn=c(1364);class ii{constructor(Q,za,fb,Nb,tc){this.zk=this.qpc=null;this.ose=!1;this.tQe=this.rKa=null;this.kWe=za;this.tXa=fb;this.dH=Nb;this.Ui=tc;this.ga=Q}QHa(Q,za,fb,Nb){this.ose=!1;ra.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.L6a();this.rKa=Q;Nb&&Nb.SaveEntryPoint&&(this.tQe=Nb.SaveEntryPoint);this.qpc=this.kWe.create(Q,za,fb,Nb);Nb&&"true"===Nb.SkipSaveToHost?
this.fga():this.VFl()}VFl(){const Q=()=>{ra.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.fga()};32!==this.ga.Qb(n.a.tNb,2,[()=>{ra.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.fga()},Q])&&Q()}fga(){ra.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.qpc.execute(Object(a.a)(this,this.zrn,"onSaveToSharePointUploadFinished"),Object(a.a)(this,this.yrn,
"onSaveToSharePointUploadFailed"))}zrn(Q){if(Q&&Q.data&&Q.data.xe){var za;if(({Wu:za}=Ya.d(Q.data.xe)).returnValue)if(za.StatusCode!==Qj.a.Hy&&za.StatusCode!==Qj.a.pIc)ra.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",Q.data.status,za.StatusCode),za.StatusCode!==Qj.a.V6f&&this.HSh(Q.data.status)||(this.vSa(za.StatusCode.toString()),this.Nto(za.StatusCode));else{ra.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.Q6f();try{za.NewDocumentUrl?this.qMb(za.NewDocumentUrl):this.rMb()}catch(fb){ra.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",fb.toString())}}else ra.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:ob.a.T$c(Q.data.xe)}),this.UId()||(this.vSa("Failed to deserialize response"),this.t8c())}else ra.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.UId()||(this.vSa("Unknown"),this.t8c())}yrn(Q){Q&&Q.data?this.HSh(Q.data.status)||
(ra.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.vSa(jn.a[Q.data.status]),this.t8c()):(ra.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.UId()||(this.vSa("Unknown"),this.t8c()))}UId(){if(!this.ose)return ra.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.ose=!0,this.fga(),!0;ra.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}HSh(Q){ra.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",
Q);return this.UId()}rMb(){ra.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");ha.a.nm(this.rKa,ha.a.Zqa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}qMb(Q){let za=!1,fb=!1;m.AFrameworkApplication.K&&(za=m.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),fb=m.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ra.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,za);if(za&&fb){ra.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const Nb={};Nb[Gd.a.Kgc]="1";Nb[Gd.a.documentUrl]=Q;Nb[Gd.a.reason]=od.a.P8f;m.AFrameworkApplication.MO().execute(tc=>{tc.sendMessage(Ye.a.$Bb,Nb)})}else ha.a.nm(Q,ha.a.Zqa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}L6a(){this.Ui&&1===this.Ui.state||(this.zk=this.tXa(),this.zk.message=CommonUIStrings.l_CommentProgressTooltip,this.zk.Ad=5,this.zk.rt=!1,this.zk.oL(CommonUIStrings.l_DefaultDialogTitle,null,null))}Gma(){this.zk&&(this.zk.close(),this.zk=null)}t8c(){this.yp(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)}Fuo(){this.yp(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}Tto(){const Q=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.yp(CommonUIStrings.l_SaveAsFileTooLargeTitle,Q,Tl.a.F8n)}yp(Q,za,fb=Tl.a.J8n){ra.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",Q,za);this.Gma();1!==this.Ui.state&&this.dH().aSh(Q,za,fb)}Nto(Q){ra.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",
Q);switch(Q){case Qj.a.Kme:this.Fuo();break;case Qj.a.V6f:this.Tto();break;default:this.t8c()}}Q6f(){"VersionHistory"===this.tQe&&this.ga.processAction(n.a.F4c,2)}vSa(Q){"VersionHistory"===this.tQe&&this.ga.Qb(n.a.Ede,2,{["FailureReason"]:Q})}}Object(e.a)(ii,"UploadToSharePointManager",null,[1832]);var Hh=c(627),qk=c(128);class Vf{constructor(){this.scb=this.hKe=this.ZJe=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}xc(Q){this.W=Q;this.ZJe=Hh.a.Ap(Q.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));
this.hKe=Hh.a.Ap(Q.Sa("Common.IEventEmitter<Common.IMruResult>"));this.scb=Hh.a.Ap(Q.Sa("Common.App.SharedFilePicker.ISharedFilePicker"));qk.Task.WAA.call(null,this.ZJe,this.hKe,this.scb).continueWith(()=>{this.jSn()})}jSn(){this.W.register(ym,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Rd(()=>new ym(m.AFrameworkApplication.K)).singleInstance();this.W.register(ii,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Rd(()=>
new ii(m.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new pj.a).create(),()=>new lg,m.AFrameworkApplication.ta)).singleInstance();this.W.register($k,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Rd(()=>new $k(this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new lg,this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),m.AFrameworkApplication.ta)).singleInstance();
this.W.register(Nn,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Rd(()=>new Nn(this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new hb.a(()=>this.ZJe.result),m.AFrameworkApplication.ta,()=>new Sg)).singleInstance();this.W.register(sj,"Common.App.SaveToSharePoint.FileNameDialogFactory").Rd(()=>new sj(m.AFrameworkApplication.K,m.AFrameworkApplication.va,m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.Nb,
this.W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.W.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new hb.a(()=>this.hKe.result),this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.scb?this.scb.result:null)).singleInstance();this.W.register(Rf,"Common.App.SaveToSharePoint.SaveToSharePointActor").Rd(()=>new Rf(m.AFrameworkApplication.K,m.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>m.AFrameworkApplication.ta.NRk)).singleInstance();m.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Tb()}static main(){K.a.instance.Fc(new Vf)}}Object(e.a)(Vf,"PackageManager",null,[1,2]);class Sj{}
Object(e.a)(Sj,"StringDifference",null,[1805]);class fe{constructor(Q,za){this.charCode=Q;this.description=za}}Object(e.a)(fe,"UBTableEntry",null,[]);class cj{}new fe(8,"C0 Controls 1");new fe(9,"Horizontal tab (HT)");new fe(10,"Line feed (LF)");new fe(12,"C0 Controls 2");new fe(13,"Carriage return (CR)");new fe(31,"C0 Controls 3");new fe(32,"Space");new fe(47,"ASCII Punctuation and Symbols 1");new fe(57,"ASCII Digits");new fe(64,"ASCII Punctuation and Symbols 2");new fe(90,"Uppercase Latin Alphabet");
new fe(96,"ASCII Punctuation and Symbols 3");new fe(122,"Lowercase Latin Alphabet");new fe(127,"U+0000..U+007F Basic Latin");new fe(159,"C1 Controls");new fe(160,"NB Space");new fe(191,"Latin-1 Punctuation and Symbols");new fe(255,"U+0080..U+00FF Latin-1 Supplement");new fe(383,"U+0100..U+017F Latin Extended-A");new fe(591,"U+0180..U+024F Latin Extended-B");new fe(687,"U+0250..U+02AF IPA Extensions");new fe(767,"U+02B0..U+02FF Spacing Modifier Letters");new fe(879,"U+0300..U+036F Combining Diacritical Marks");
new fe(1023,"U+0370..U+03FF Greek and Coptic");new fe(1279,"U+0400..U+04FF Cyrillic");new fe(1327,"U+0500..U+052F Cyrillic Supplement");new fe(1423,"U+0530..U+058F Armenian");new fe(1535,"U+0590..U+05FF Hebrew");new fe(1791,"U+0600..U+06FF Arabic");new fe(1871,"U+0700..U+074F Syriac");new fe(1919,"U+0750..U+077F Arabic Supplement");new fe(1983,"U+0780..U+07BF Thaana");new fe(2047,"U+07C0..U+07FF NKo");new fe(2111,"U+0800..U+083F Samaritan");new fe(2143,"U+0840..U+085F Mandaic");new fe(2303,"U+08A0..U+08FF Arabic Extended-A");
new fe(2431,"U+0900..U+097F Devanagari");new fe(2559,"U+0980..U+09FF Bengali");new fe(2687,"U+0A00..U+0A7F Gurmukhi");new fe(2815,"U+0A80..U+0AFF Gujarati");new fe(2943,"U+0B00..U+0B7F Oriya");new fe(3071,"U+0B80..U+0BFF Tamil");new fe(3199,"U+0C00..U+0C7F Telugu");new fe(3327,"U+0C80..U+0CFF Kannada");new fe(3455,"U+0D00..U+0D7F Malayalam");new fe(3583,"U+0D80..U+0DFF Sinhala");new fe(3711,"U+0E00..U+0E7F Thai");new fe(3839,"U+0E80..U+0EFF Lao");new fe(4095,"U+0F00..U+0FFF Tibetan");new fe(4255,
"U+1000..U+109F Myanmar");new fe(4351,"U+10A0..U+10FF Georgian");new fe(4607,"U+1100..U+11FF Hangul Jamo");new fe(4991,"U+1200..U+137F Ethiopic");new fe(5023,"U+1380..U+139F Ethiopic Supplement");new fe(5119,"U+13A0..U+13FF Cherokee");new fe(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new fe(5791,"U+1680..U+169F Ogham");new fe(5887,"U+16A0..U+16FF Runic");new fe(5919,"U+1700..U+171F Tagalog");new fe(5951,"U+1720..U+173F Hanunoo");new fe(5983,"U+1740..U+175F Buhid");new fe(6015,"U+1760..U+177F Tagbanwa");
new fe(6143,"U+1780..U+17FF Khmer");new fe(6319,"U+1800..U+18AF Mongolian");new fe(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new fe(6479,"U+1900..U+194F Limbu");new fe(6527,"U+1950..U+197F Tai Le");new fe(6623,"U+1980..U+19DF New Tai Lue");new fe(6655,"U+19E0..U+19FF Khmer Symbols");new fe(6687,"U+1A00..U+1A1F Buginese");new fe(6831,"U+1A20..U+1AAF Tai Tham");new fe(7039,"U+1B00..U+1B7F Balinese");new fe(7103,"U+1B80..U+1BBF Sundanese");new fe(7167,"U+1BC0..U+1BFF Batak");
new fe(7247,"U+1C00..U+1C4F Lepcha");new fe(7295,"U+1C50..U+1C7F Ol Chiki");new fe(7375,"U+1CC0..U+1CCF Sundanese Supplement");new fe(7423,"U+1CD0..U+1CFF Vedic Extensions");new fe(7551,"U+1D00..U+1D7F Phonetic Extensions");new fe(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new fe(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new fe(7935,"U+1E00..U+1EFF Latin Extended Additional");new fe(8191,"U+1F00..U+1FFF Greek Extended");new fe(8303,"U+2000..U+206F General Punctuation");
new fe(8351,"U+2070..U+209F Superscripts and Subscripts");new fe(8399,"U+20A0..U+20CF Currency Symbols");new fe(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new fe(8527,"U+2100..U+214F Letterlike Symbols");new fe(8591,"U+2150..U+218F Number Forms");new fe(8703,"U+2190..U+21FF Arrows");new fe(8959,"U+2200..U+22FF Mathematical Operators");new fe(9215,"U+2300..U+23FF Miscellaneous Technical");new fe(9279,"U+2400..U+243F Control Pictures");new fe(9311,"U+2440..U+245F Optical Character Recognition");
new fe(9471,"U+2460..U+24FF Enclosed Alphanumerics");new fe(9599,"U+2500..U+257F Box Drawing");new fe(9631,"U+2580..U+259F Block Elements");new fe(9727,"U+25A0..U+25FF Geometric Shapes");new fe(9983,"U+2600..U+26FF Miscellaneous Symbols");new fe(10175,"U+2700..U+27BF Dingbats");new fe(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new fe(10239,"U+27F0..U+27FF Supplemental Arrows-A");new fe(10495,"U+2800..U+28FF Braille Patterns");new fe(10623,"U+2900..U+297F Supplemental Arrows-B");
new fe(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new fe(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new fe(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new fe(11359,"U+2C00..U+2C5F Glagolitic");new fe(11391,"U+2C60..U+2C7F Latin Extended-C");new fe(11519,"U+2C80..U+2CFF Coptic");new fe(11567,"U+2D00..U+2D2F Georgian Supplement");new fe(11647,"U+2D30..U+2D7F Tifinagh");new fe(11743,"U+2D80..U+2DDF Ethiopic Extended");new fe(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new fe(11903,"U+2E00..U+2E7F Supplemental Punctuation");new fe(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new fe(12255,"U+2F00..U+2FDF Kangxi Radicals");new fe(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new fe(12351,"U+3000..U+303F CJK Symbols and Punctuation");new fe(12447,"U+3040..U+309F Hiragana");new fe(12543,"U+30A0..U+30FF Katakana");new fe(12591,"U+3100..U+312F Bopomofo");new fe(12687,"U+3130..U+318F Hangul Compatibility Jamo");new fe(12703,"U+3190..U+319F Kanbun");new fe(12735,
"U+31A0..U+31BF Bopomofo Extended");new fe(12783,"U+31C0..U+31EF CJK Strokes");new fe(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new fe(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new fe(13311,"U+3300..U+33FF CJK Compatibility");new fe(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new fe(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new fe(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new fe(42127,"U+A000..U+A48F Yi Syllables");new fe(42191,"U+A490..U+A4CF Yi Radicals");
new fe(42239,"U+A4D0..U+A4FF Lisu");new fe(42559,"U+A500..U+A63F Vai");new fe(42655,"U+A640..U+A69F Cyrillic Extended-B");new fe(42751,"U+A6A0..U+A6FF Bamum");new fe(42783,"U+A700..U+A71F Modifier Tone Letters");new fe(43007,"U+A720..U+A7FF Latin Extended-D");new fe(43055,"U+A800..U+A82F Syloti Nagri");new fe(43071,"U+A830..U+A83F Common Indic Number Forms");new fe(43135,"U+A840..U+A87F Phags-pa");new fe(43231,"U+A880..U+A8DF Saurashtra");new fe(43263,"U+A8E0..U+A8FF Devanagari Extended");new fe(43311,
"U+A900..U+A92F Kayah Li");new fe(43359,"U+A930..U+A95F Rejang");new fe(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new fe(43487,"U+A980..U+A9DF Javanese");new fe(43615,"U+AA00..U+AA5F Cham");new fe(43647,"U+AA60..U+AA7F Myanmar Extended-A");new fe(43743,"U+AA80..U+AADF Tai Viet");new fe(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new fe(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new fe(44031,"U+ABC0..U+ABFF Meetei Mayek");new fe(55215,"U+AC00..U+D7AF Hangul Syllables");new fe(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new fe(56191,"U+D800..U+DB7F High Surrogates");new fe(56319,"U+DB80..U+DBFF High Private Use Surrogates");new fe(57343,"U+DC00..U+DFFF Low Surrogates");new fe(63743,"U+E000..U+F8FF Private Use Area");new fe(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new fe(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new fe(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new fe(65039,"U+FE00..U+FE0F Variation Selectors");new fe(65055,"U+FE10..U+FE1F Vertical Forms");new fe(65071,"U+FE20..U+FE2F Combining Half Marks");
new fe(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new fe(65135,"U+FE50..U+FE6F Small Form Variants");new fe(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new fe(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new fe(65535,"U+FFF0..U+FFFF Specials");new fe(65663,"U+10000..U+1007F Linear B Syllabary");new fe(65791,"U+10080..U+100FF Linear B Ideograms");new fe(65855,"U+10100..U+1013F Aegean Numbers");new fe(65935,"U+10140..U+1018F Ancient Greek Numbers");new fe(65999,"U+10190..U+101CF Ancient Symbols");
new fe(66047,"U+101D0..U+101FF Phaistos Disc");new fe(66207,"U+10280..U+1029F Lycian");new fe(66271,"U+102A0..U+102DF Carian");new fe(66351,"U+10300..U+1032F Old Italic");new fe(66383,"U+10330..U+1034F Gothic");new fe(66463,"U+10380..U+1039F Ugaritic");new fe(66527,"U+103A0..U+103DF Old Persian");new fe(66639,"U+10400..U+1044F Deseret");new fe(66687,"U+10450..U+1047F Shavian");new fe(66735,"U+10480..U+104AF Osmanya");new fe(67647,"U+10800..U+1083F Cypriot Syllabary");new fe(67679,"U+10840..U+1085F Imperial Aramaic");
new fe(67871,"U+10900..U+1091F Phoenician");new fe(67903,"U+10920..U+1093F Lydian");new fe(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new fe(68095,"U+109A0..U+109FF Meoritic Cursive");new fe(68191,"U+10A00..U+10A5F Kharoshthi");new fe(68223,"U+10A60..U+10A7F Old South Arabian");new fe(68415,"U+10B00..U+10B3F Avestan");new fe(68447,"U+10B40..U+10B5F Inscriptional Parthian");new fe(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new fe(68687,"U+10C00..U+10C4F Old Turkic");new fe(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new fe(69759,"U+11000..U+1107F Brahmi");new fe(69839,"U+11080..U+110CF Kaithi");new fe(69887,"U+110D0..U+110FF Sora Sompeng");new fe(69967,"U+11100..U+1114F Chakma");new fe(70111,"U+11180..U+111DF Sharada");new fe(71375,"U+11680..U+116CF Takri");new fe(74751,"U+12000..U+123FF Cuneiform");new fe(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new fe(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new fe(92735,"U+16800..U+16A3F Bamum Supplement");new fe(94111,"U+16F00..U+16F9F Miao");new fe(110847,
"U+1B000..U+1B0FF Kana Supplement");new fe(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new fe(119295,"U+1D100..U+1D1FF Musical Symbols");new fe(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new fe(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new fe(119679,"U+1D360..U+1D37F Counting Rod Numerals");new fe(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new fe(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new fe(127023,"U+1F000..U+1F02F Mahjong Tiles");
new fe(127135,"U+1F030..U+1F09F Domino Tiles");new fe(127231,"U+1F0A0..U+1F0FF Playing Cards");new fe(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new fe(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new fe(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new fe(128591,"U+1F600..U+1F64F Emoticons");new fe(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new fe(128895,"U+1F700..U+1F77F Alchemical Symbols");new fe(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new fe(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new fe(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new fe(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new fe(917631,"U+E0000..U+E007F Tags");new fe(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new fe(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new fe(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(e.a)(cj,"UnicodeBlocks",null,[1804]);class im{constructor(){this.W=
null}xc(Q){this.W=Q;this.W.register(Sj,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").singleInstance();this.W.register(cj,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").singleInstance()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve("Common.App.SensitiveLogging.IStringDifference");this.W.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){K.a.instance.Fc(new im)}}
Object(e.a)(im,"SensitiveLoggingPackage",null,[1,2]);var vg;(function(Q){Q[Q.myFiles=0]="myFiles";Q[Q.recent=1]="recent";Q[Q.currentFolder=2]="currentFolder";Q[Q.yourPhone=3]="yourPhone"})(vg||(vg={}));Object(e.b)("SharedFilePickerLandingLocation",vg);class Wf{constructor(Q){this.NFb=this.ggc=null;this._initialized=!1;this.cyf=Q}uCb(Q){this._initialized||(Q.yv(Ye.a.j6i),Q.NB(Ye.a.j6i,Object(a.a)(this,this.xqn,"onReceivedPickerResponse")),this._initialized=!0)}bPd(Q){return this.NFb=new Promise((za,
fb)=>{const Nb={};Nb[Gd.a.KAn]=Q;this.ggc=(tc,bd)=>{""===bd?(ra.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),za(tc)):("Canceled"===bd?ra.ULS.sendTraceTag(572548164,306,50,bd):ra.ULS.sendTraceTag(556901065,306,10,bd),fb(bd))};this.cyf.execute(tc=>{this.uCb(tc);tc.sendMessage(Ye.a.gvn,Nb)})})}xqn(Q){this.ggc(Q.Values[Gd.a.vao],void 0===Q.Values[Gd.a.YYf]||null===Q.Values[Gd.a.YYf]?"":Q.Values[Gd.a.YYf])}UFf(){return m.AFrameworkApplication.K.$("UiHostCommonFilePicker")}haf(Q,
za,fb,Nb,tc,bd,Yd,Fd,De=null){const Nf={};Nf[Gd.a.V$n]=Q;Nf[Gd.a.titleText]=za;Nf[Gd.a.qAk]=fb;Nf[Gd.a.rAk]=Nb;Nf[Gd.a.tAk]=tc;Nf[Gd.a.tnl]=!0;Nf[Gd.a.Kzl]=bd;Nf[Gd.a.OAn]=Yd;Nf[Gd.a.NAn]=vg[Fd];F.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Nf[Gd.a.PAn]="Dark");De&&(null!=De.A0b&&(Nf[Gd.a.A0b]=De.A0b),null!=De.P9b&&(Nf[Gd.a.P9b]=De.P9b));return Nf}}Object(e.a)(Wf,"SharedFilePickerManager",null,[1814]);class $g{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}xc(Q){this.W=
Q;Q.register(Wf,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").singleInstance().Rd(()=>new Wf(Q.Sa("Postmessage.IHostPostmessenger")))}init(){m.AFrameworkApplication.K.No(()=>{this.f2a()})}f2a(){this.W.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){K.a.instance.Fc(new $g)}}Object(e.a)($g,"SharedFilePickerPackage",null,[1,2]);class Ti extends Sys.EventArgs{constructor(){super()}}Object(e.a)(Ti,"TypingSpeedMeterChangedEventArgs",
Sys.EventArgs,[]);class Rm{}Object(e.a)(Rm,"TypingSpeedMeterWindow",null,[]);class Rd{constructor(Q,za){new O.a;this.Jz=Q;this.ri=za;this.ri.UZe(Object(a.a)(this,this.i6d,"onCpuMeterFrameAvailable"))}i6d(){}dispose(){this.ri.caj(Object(a.a)(this,this.i6d,"onCpuMeterFrameAvailable"))}}Object(e.a)(Rd,"TypingSpeedMeter",null,[1848]);class Mo{constructor(Q){this.Twd=null;this.Xp=new A.a;this.Jz=Q}initialize(Q,za,fb,Nb){this.Twd||(this.Twd=new Rd(this.Jz,Q,za,fb,Nb),this.Xp.Ag(this.Twd));return this.Twd}}
Object(e.a)(Mo,"TypingSpeedMeterProvider",null,[1818]);class Bd{constructor(){this.FVe=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(m.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const Q=ua.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),za=Hh.a.Ap(ua.a.instance.Sa("Common.ICpuMeterProvider"));za.continueWith(()=>{const fb=za.result.Xp.task;var Nb=new Ca.a(m.AFrameworkApplication.K.mc("TypingSpeedMeterWindowSamplingPercent",0)/100);Nb=new oa.a(Object(a.a)(Nb,
Nb.tOb,"shouldBeInSample"));const tc=Ia.a.eF(12,1,Nb),bd=m.AFrameworkApplication.K.mc("TypingSpeedMeterWindowTimeoutMs",5E3),Yd=m.AFrameworkApplication.K.mc("TypingSpeedMeterMaxKeystrokesPerWindow",5);fb.CWR(()=>this.FVe=Q.initialize(fb.result,tc,bd,Yd))})}}dispose(){this.FVe&&this.FVe.dispose()}xc(Q){Q.register(Mo,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").singleInstance().Rd(()=>new Mo(ha.a.$e))}static main(){K.a.instance.Fc(new Bd)}}Object(e.a)(Bd,
"TypingSpeedMeterPackage",null,[1,2]);class ll{constructor(){this.events=[];this.S6f=!1}static IHf(Q){return Q.ctrlKey&&"Control"!==Q.key||Q.altKey&&"Alt"!==Q.key||!!ll.PUm[Q.key]}static FMk(Q,za){let fb;fb=ll.IHf(Q)?Q.key:" "===Q.key?"Space":"CharacterKey";return null!=za?(za.altPressed=(!!Q.altKey).toString(),za.ctrlPressed=(!!Q.ctrlKey).toString(),za.key=fb,za.repeat=(!!Q.repeat).toString(),za.shiftPressed=(!!Q.shiftKey).toString(),za):{["altPressed"]:(!!Q.altKey).toString(),["ctrlPressed"]:(!!Q.ctrlKey).toString(),
["key"]:fb,["repeat"]:(!!Q.repeat).toString(),["shiftPressed"]:(!!Q.shiftKey).toString()}}static rzi(Q){return window.performance&&window.performance.now&&Q.timeStamp<performance.now()}static VWh(Q){return!!Q&&ll.rzi(Q)&&ll.IHf(Q)}static WWh(Q){return!!Q&&ll.rzi(Q)&&!ll.IHf(Q)}keyPressedEventHandlerStart(Q,za){ll.WWh(Q)&&this.ouj(Q,za)}keyPressedEventHandlerEnd(Q){ll.WWh(Q)&&this.Uuj(Q)}keyDownEventHandlerStart(Q,za){ll.VWh(Q)&&this.ouj(Q,za)}keyDownEventHandlerEnd(Q){ll.VWh(Q)&&this.Uuj(Q)}ouj(Q,
za){Q={["metadata"]:ll.FMk(Q,za),["timeStamp"]:this.Mlc(Q.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.Mlc(performance.now()-Q.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(Q);this.rVn()}Uuj(Q){if(0!==this.events.length){var za=this.Mlc(Q.timeStamp);for(let fb=this.events.length-1;0<=fb;--fb){const Nb=this.events[fb];if(Nb.timeStamp===za){Nb.timeToHandlerFinishMs=this.Mlc(performance.now()-Q.timeStamp);Nb.eventDurationMs=this.Mlc(Nb.timeToHandlerFinishMs-
Nb.timeToHandlerStartMs);break}}}}Mlc(Q){return Number(Q.toFixed(2))}rVn(){if(!this.S6f){const Q=document.createEvent("CustomEvent");Q.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(Q);requestAnimationFrame(()=>{this.S6f=!1;const za=performance.now();this.events.forEach(Nb=>{Nb.timeToRequestAnimationFrameMs=this.Mlc(za-Nb.timeStamp)});var fb=document.createEvent("CustomEvent");fb.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(fb);this.events=
[];fb=document.createEvent("CustomEvent");fb.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(fb)});this.S6f=!0}}}ll.PUm={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class $f{constructor(){this.Fde=this.b4a=this.FQa=this.mdc=null;this.ybc=!1;this.dhc=null;this.rMc=[];this.Iad=()=>{$f.ANm()&&null==this.b4a?(this.FQa=null,this.b4a=requestAnimationFrame(this.zYc)):
null!=this.b4a&&(cancelAnimationFrame(this.b4a),this.b4a=null)};this.zYc=Q=>{if(null!=this.FQa){const za=Q-this.FQa;if(null==this.mdc||this.mdc<za)this.mdc=za;for(let fb=0;fb<$f.ranges.length;++fb)if(za<$f.ranges[fb]){++this.rMc[fb];break}}this.FQa=Q;this.b4a=requestAnimationFrame(this.zYc)};this.Jbj=()=>{if(null!=this.mdc){var Q={};for(var za=0;za<$f.ranges.length;++za)Q[$f.ranges[za]]=this.rMc[za],this.rMc[za]=0;za=performance.now();Q={["intervalStart"]:this.dhc,["intervalEnd"]:za,["maxFrameLengthMs"]:this.mdc,
["frameData"]:Q};var fb=document.createEvent("CustomEvent");fb.initCustomEvent("reportframetiming",!1,!1,Q);dispatchEvent(fb);this.mdc=null;this.dhc=za}}}static ZEf(){return!!window.performance&&!!window.performance.now}start(Q){!this.ybc&&$f.ZEf()&&(this.lno(),this.Fde=setInterval(this.Jbj,1E3*Q),this.dhc=performance.now(),this.Iad(),document.addEventListener("visibilitychange",this.Iad),this.ybc=!0)}stop(){this.ybc&&(document.removeEventListener("visibilitychange",this.Iad),null!=this.Fde&&(clearInterval(this.Fde),
this.Fde=null),null!=this.b4a&&(cancelAnimationFrame(this.b4a),this.b4a=null),this.Jbj(),this.ybc=!1)}get uVc(){return this.ybc}lno(){this.rMc=[];for(let Q=0;Q<$f.ranges.length;++Q)this.rMc.push(0)}}$f.ANm=()=>"visible"===document.visibilityState;$f.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];class mg{create(Q){return new Ca.a(Q)}}Object(e.a)(mg,"RandomSamplerFactory",null,[880]);var Za=c(9),Hb=c(1397);class $b{constructor(Q,za,fb,Nb,tc){Q.cqh(()=>{Nb.y4c()});Q.jqh((bd,
Yd)=>{Nb.w4c(Yd.revisionId,Yd.w4a)});Q.Bzd((bd,Yd)=>{Nb.qum(Yd.Sdj,Yd.w4a,Yd.qyj)});Q.Owk(()=>{Nb.H6f()});za.mxk((bd,Yd)=>{Nb.xHo(Yd.wbj,Yd.ple,Yd.actualValue)});za.awk((bd,Yd)=>{Nb.wHo(Yd.wbj,Yd.ple,Yd.actualValue)});tc.BDc(()=>{Nb.oad()});fb.b3((bd,Yd)=>{6===Yd.type&&Nb.Hhc(Yd.tL)})}}Object(e.a)($b,"EventForwarder",null,[]);class zc{constructor(Q,za,fb){this.bbk=Q;this.rN=fb;this.LZb=za}create(Q,za){return new $b(this.bbk,this.LZb,Q,za,this.rN)}}Object(e.a)(zc,"EventForwarderFactory",null,[]);var Jc=
c(438);class pd{}pd.PNo="TypingToOutboundReplicationStart";pd.Nvn="OutboundReplicationStartToOutboundReplicationEnd";pd.Nej="RtcNotificationToInboundReplicationEnd";pd.sCj="TypingToInboundReplicationEnd";Object(e.a)(pd,"PerfTrackerPhases",null,[]);class Qd{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd,De=null){this.Y4g=!1;this.VKe=5;this.w6g=50;this.vJe=20;this.UHe=this.fJe=this.Aza=null;this.Cqc=this.sqc=0;this.PSe=this.YTe=!1;this.Ovd=Array(7);this.Snc=null;this.pXg=!1;this.Iue=null;this.gia={};this.Rkd=Q;
this.rVa=za;this.D$j=fb;this.kZg=Nb.create(pd.Nej,tc,bd,20,!1);this.Uwd=Nb.create(pd.sCj,Yd,Fd,20,!0);if(this.Ma=m.AFrameworkApplication.K)this.Y4g=this.Ma.$("LogSteppedInboundFrameIsEnabled"),this.vJe=this.Ma.mc("InboundFrameMaxNumberOfLongRunningTasks",20),this.w6g=this.Ma.mc("InboundFrameMinLengthForLongRunningTasksInMs",50),this.VKe=this.Ma.mc("InboundFrameNumberOfLastShortTasks",5);this.Lrb=De}get RUk(){null==this.Iue&&(this.Iue=!!this.Ma&&this.Ma.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));
return this.Iue}initialize(Q){this.Aza=Q}$1n(Q,za,fb=null){this.qDh();ra.ULS.shipAssertTag(8229761,324,0<Q.length);let Nb=!1;for(const bd of Q){const Yd=bd.toString();if(Yd in this.gia){var tc=this.gia[Yd];if(!tc.qic){tc.xij(Q,za,fb);if(Nb)this.IJi(bd.toString(),tc,null,null,this.Ovd,null);else{const Fd=this.Uxl(),De=this.RIl(this.Snc);Nb=!0;this.IJi(bd.toString(),tc,Fd,this.UHe,this.Ovd,De)}delete this.gia[Yd]}}else tc=this.Rkd.create(this.kZg,this.Uwd),tc.xij(Q,za),this.gia[Yd]=tc}this.PSe=!1}Hhc(Q){ra.ULS.shipAssertTag(8257930,
304,Q.KCi,"Expected data not sent on the wire");if(Q.KCi){if(Q.iee in this.gia){var za=this.gia[Q.iee];za.xee||(za.Hhc(Q.revisionId,Q.yYi,Q.Gpj,Q.w4a),delete this.gia[Q.iee])}else za=this.Rkd.create(this.kZg,this.Uwd),za.Hhc(Q.revisionId,Q.yYi,Q.Gpj,Q.w4a),this.gia[Q.iee]=za;this.qDh()}}ewm(){this.YTe||(this.fJe=Array(this.vJe),this.UHe=Array(this.VKe),this.Cqc=this.sqc=0,this.Ovd=[0,0,0,0,0,0,0,0],this.Snc=Array(3),this.Snc[1]=[0,0],this.Snc[2]=[0,0],this.YTe=!0)}ero(Q){return!Q.TP&&Q.TN===ea.a.rbj&&
(Q=Jc.a(this.gia))&&Q[0]?!0:!1}$kn(Q){this.YTe=!1;const za=Jc.a(this.gia);za&&za[0]&&(Q.TRT>=this.w6g&&this.sqc<this.vJe?this.fJe[this.sqc++]=Q:(this.UHe[this.Cqc]=Q,this.Cqc=this.Cqc<this.VKe-1?this.Cqc+1:0),this.s5m(Q),this.M5m(Q))}Zkn(){this.ewm();this.PSe=!0}s5m(Q){this.Ovd[Q.TP]++}M5m(Q){if(Q&&Q.UI){const za=this.Snc[Q.UI];za[0]+=1;za[1]+=Q.TRT}}RIl(Q){const za={};Q&&(Q[1]&&(za.Typing=Q[1]),Q[2]&&(za.Clicking=Q[2]));return za}Uxl(){return this.sqc?this.fJe.slice(0,this.sqc-1):null}qDh(){var Q=
Jc.a(this.gia);if(Q&&(this.pXg||this.y6m(Q),Q.length>this.D$j))for(const za of Q){Q=this.gia[za];const fb=Q.createdTime,Nb=this.rVa();6E4<Nb-fb&&(J.b(8438528,304,50,"{0}",{["Not Received"]:Q.qic?"RtcNotification":"ServerRevision",["Duration"]:Nb-fb}),Q.qic||J.b(42075798,304,15,"{0}",{["RevisionId"]:za,["Duration"]:Nb-fb}),delete this.gia[za])}}y6m(Q){if(this.RUk&&this.Lrb)for(const za of Q)if(Q=this.gia[za],Q.xee&&!Q.qic&&(Q=Q.createdTime,2E3<this.rVa()-Q)){let fb=null;Za.App.ya&&Za.App.ya.gb&&Za.App.ya.gb.Uc&&
(fb=Za.App.ya.gb.Uc.contentReplicator);this.Lrb.execute(Nb=>{Nb.flush(fb,1)});this.pXg=!0}}IJi(Q,za,fb,Nb,tc,bd){this.Y4g&&(za=za.zIl())&&(za.RevisionId=Q,za.LRTWR=fb,za.LSTWR=Nb,za.TSD=tc,za.UIWR=bd,this.Aza&&this.Aza.track(za))}}Object(e.a)(Qd,"InboundMonitor",null,[1853]);class ye{constructor(Q,za,fb,Nb){this.pD=za;this.Rkd=fb;this.zlk=Nb}create(Q,za,fb,Nb,tc=null){return new Qd(this.Rkd,this.pD,50,this.zlk,Q,za,fb,Nb,tc)}}Object(e.a)(ye,"InboundMonitorFactory",null,[1829]);var Le=c(372);class Af{}
Af.eoe="UserCount";Af.y6n="RevisionChainLength";Object(e.a)(Af,"PerfTrackerPivotNames",null,[]);class dc{}Object(e.a)(dc,"PerfTrackingContext",null,[]);const of=Q=>5>=Q?"5AndFewer":10>=Q?"6To10":15>=Q?"11To15":20>=Q?"15To20":25>=Q?"21To25":30>=Q?"26To30":"31AndAbove";class Mj{}Object(e.a)(Mj,"SteppedInboundFrame",null,[]);class bi{constructor(Q,za,fb,Nb,tc){this.Bbb=this.Tkd=null;this.fZg=500;this.Skd=this.jsa=this.Vtb=this.pVb=this.mdd=-1;this.Bvg=null;this.Heh=this.Adh=!1;this.ddh=null;this.X9g=
this.vLa=0;this.DXb=Q;this.createdTime=za();this.oud=!1;this.hMe=0;this.Avb=fb;this.M5j=Nb;this.Uwd=tc;m.AFrameworkApplication.K&&(this.fZg=m.AFrameworkApplication.K.mc("InboundFrameSamplingMinimalTotalTimeMs",500))}get xee(){return this.Adh}get qic(){return this.Heh}get Tdj(){return this.ddh}get w4a(){return this.vLa}get Mvn(){return this.X9g}get kCb(){return this.Avb()}Hhc(Q,za,fb,Nb){this.xee||(this.oud=fb,this.hMe=za,this.mdd=Z.a.SU(ha.a.$e(),2),this.Bvg=(new Date).toISOString(),this.Bbb=Q,this.X9g=
Nb,this.Adh=!0,this.qic?this.xVh():(this.puj(),xa.a.instance.Xy(Q.toString()+"Start"),Le.a.instance.v3d(2)))}xij(Q,za,fb=null){this.qic||(this.vLa=za,this.Heh=!0,this.ddh=Q,this.Skd=Z.a.SU(ha.a.$e(),2),this.xee&&(xa.a.instance.Xy(this.Bbb.toString()+"End"),fb&&(this.pVb=fb.f3n,this.Vtb=fb.I5a,this.jsa=fb.a2n),Le.a.instance.BDd(),this.xVh()))}zIl(){if(!(0<this.mdd&&0<this.pVb&&0<this.Vtb&&0<this.jsa&&0<this.Skd))return null;const Q=new Mj;Q.TT=Z.a.SU(this.Skd-this.mdd,2);if(Q.TT<this.fZg)return null;
Q.ST=this.Bvg;Q.UC=this.kCb;Q.RS=Z.a.SU(this.pVb-this.mdd,2);Q.SR=Z.a.SU(this.Vtb-this.pVb,2);Q.RRS=Z.a.SU(this.jsa-this.Vtb,2);Q.RP=Z.a.SU(this.Skd-this.jsa,2);Q.ResponseLanded=Z.a.SU(this.Vtb,2);0<Q.RS?(xa.a.instance.nY("RTCToRequestSent",this.Bbb.toString()+"Start","RequestInvoked"+this.pVb),xa.a.instance.nY("RequestSentToResponseReceived","RequestInvoked"+this.pVb,"RequestCompleted"+this.Vtb),xa.a.instance.nY("ResponseReceivedToReplicationStart","RequestCompleted"+this.Vtb,"ReplicationStart"+
this.jsa)):xa.a.instance.nY("RTCToReplicationStart",this.Bbb.toString()+"Start","ReplicationStart"+this.jsa);xa.a.instance.nY("Replication","ReplicationStart"+this.jsa,this.Bbb.toString()+"End");return Q}puj(){this.Tkd=this.DXb.create();this.Tkd.start(pd.Nej,pd.sCj)}xVh(){this.Tkd||this.puj();const Q=this.Tkd.end(this.oud,this.obl());this.M5j.Dde(Q);this.Uwd.Dde(Q+this.hMe)}obl(){const Q={};Q[Af.eoe]=of(this.kCb);var za=this.Tdj.length;Q[Af.y6n]=9>=za?za.toString():"10AndAbove";return Object.assign(new dc,
{P:Q,FC:this.w4a,CFC:this.Mvn+this.w4a,ID:this.Bbb.toString(),CD:this.hMe,UC:this.kCb,RCL:this.Tdj.length})}}Object(e.a)(bi,"InboundOperation",null,[1854]);class rl{constructor(Q,za,fb){this.hKa=Q;this.rVa=za;this.Avb=fb}create(Q,za){return new bi(this.hKa,this.rVa,this.Avb,Q,za)}}Object(e.a)(rl,"InboundOperationFactory",null,[1830]);class jj{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd,De){this.pud=!0;this.V$g=this.$qd=null;this.XM=Nf=>{this.fj.XM(6,Nf)};this.gMe=Q;this.Z0j=za;this.Ydk=fb;this.fj=Nb;this.GVe=
tc.create("TypingToOutboundReplicationStart",bd,Yd,20,!1);this.hPe=tc.create("OutboundReplicationStartToOutboundReplicationEnd",Fd,De,20,!1)}get EYf(){return this.$qd}get I9d(){return this.V$g}oad(){!this.EYf&&this.pud&&(this.pud=this.Z0j())&&(this.$qd=this.gMe.create(this.XM,this.Ydk(),this.GVe,this.hPe),this.EYf.oad())}y4c(){this.pud=!0;this.V$g=this.EYf;this.I9d&&(this.$qd=null,this.I9d.y4c())}H6f(){this.$qd=null}w4c(Q,za){this.I9d&&this.I9d.w4c(Q,za)}}Object(e.a)(jj,"OutboundMonitor",null,[]);
class be{constructor(Q,za){this.gMe=Q;this.Tck=za}create(Q,za,fb,Nb,tc,bd,Yd){return new jj(this.gMe,Q,za,fb,this.Tck,Nb,tc,bd,Yd)}}Object(e.a)(be,"OutboundMonitorFactory",null,[]);var fh=c(58);class zg{constructor(Q){this.Pbb=Q}get $Mn(){return this.Pbb}nb(Q){return!!this.Pbb&&Q in this.Pbb}get KCi(){return this.nb(zg.vJd)&&this.nb(zg.eNb)&&this.nb(zg.pdg)}get revisionId(){if(this.nb(zg.eNb))return fh.a.If(this.Pbb[zg.eNb]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");
}get iee(){if(this.nb(zg.eNb))return this.Pbb[zg.eNb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get yYi(){if(this.nb(zg.vJd))return Number.parseInvariant(this.Pbb[zg.vJd]);throw Error.create("Unable to parse DurationKey key from dictionary into int");}get Gpj(){if(this.nb(zg.eNb))return Boolean.parse(this.Pbb[zg.pdg]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get w4a(){if(this.nb(zg.yRf))return Number.parseInvariant(this.Pbb[zg.yRf]);
throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static C9k(Q){return new zg(Q)}static H9k(Q,za,fb,Nb){const tc={};tc[zg.vJd]=Q.toString();tc[zg.eNb]=za.toString();tc[zg.pdg]=fb.toString();tc[zg.yRf]=Nb.toString();return new zg(tc)}}zg.eNb="RevisionID";zg.vJd="Duration";zg.pdg="ShouldSample";zg.yRf="NumSequentialFailures";Object(e.a)(zg,"ReplicationNotificationMessage",null,[1849]);class em{constructor(Q,za,fb,Nb,tc,bd,Yd){this.Xr=this.ji=0;this.Ovb=this.iCc=
null;this.Mre=[];this.Wah=null;this.jid={};this.vLa=0;this.DXb=Q;this.vhk=za;this.rVa=fb;this.Avb=Nb;this.Efh=tc;this.Bbb=null;this.jid.TypingStartStage=null;this.jid.ReplicationStartStage="TypingStartStage";this.jid.ReplicationEndStage="ReplicationStartStage";this.ckh=1<this.kCb;this.GVe=bd;this.hPe=Yd}get kCb(){return this.Avb()}oad(){this.v6e("TypingStartStage")&&(this.x3f("TypingStartStage"),ra.ULS.shipAssertTag(8257931,324,!this.Ovb&&!this.Xr,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),
this.ji=this.rVa(),this.iCc=this.DXb.create(),this.fuj(this.iCc,pd.PNo))}y4c(){if(this.v6e("ReplicationStartStage")){this.x3f("ReplicationStartStage");ra.ULS.shipAssertTag(8257932,324,!!this.iCc,"TypingStart not called");if(this.iCc){const Q=this.sVh(this.iCc,this.Bbb);this.GVe.Dde(Q)}this.Ovb=this.DXb.create();this.fuj(this.Ovb,pd.Nvn)}}w4c(Q,za){this.v6e("ReplicationEndStage")&&(this.x3f("ReplicationEndStage"),this.Xr=this.rVa(),this.vLa=za,ra.ULS.shipAssertTag(8257933,324,!!this.Ovb,"ReplicationStart not called"),
this.Ovb&&(ra.ULS.shipAssertTag(8193425,324,!!this.Ovb,"ReplicationStart not called"),za=this.sVh(this.Ovb,Q),this.hPe.Dde(za)),ra.ULS.shipAssertTag(8257934,324,!!this.ji,"StartTime not set. No message sent to other editors."),this.ji&&(Q=zg.H9k(this.Xr-this.ji,Q,this.Efh,this.vLa),this.vhk(Q.$Mn)))}v6e(Q){if(this.jid[Q]===this.Wah)return!0;ra.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.opk()});return!1}opk(){const Q=new Sys.StringBuilder;Q.append("Actual Phase:");for(let za=
0;za<this.Mre.length;za++)Q.append(" "+this.Mre[za]);return Q.toString()}x3f(Q){this.Mre.push(Q);this.Wah=Q}fuj(Q,za){this.ckh&&Q.start(za)}sVh(Q,za){if(!this.ckh)return-1;const fb={};fb[Af.eoe]=of(this.kCb);za=Object.assign(new dc,{P:fb,FC:this.vLa,CFC:0,ID:za?za.toString():"",CD:0,UC:this.kCb,RCL:0});return Q.end(this.Efh,za)}}Object(e.a)(em,"OutboundOperation",null,[1851]);class fo{constructor(Q,za,fb){this.DXb=Q;this.rVa=za;this.Avb=fb}create(Q,za,fb,Nb){return new em(this.DXb,Q,this.rVa,this.Avb,
za,fb,Nb)}}Object(e.a)(fo,"OutboundOperationFactory",null,[1826]);class Da{constructor(Q,za){this.iPg=this._name=this.M2=null;this.he=Q;this.Aza=za}start(Q,za=null){this.M2=this.he.Zf("UserAction",Q);this._name=Q;this.iPg=za}end(Q,za){let fb=-1;Q&&(fb=this.M2.si,za.D=fb,za.CN=this.iPg,za.CD+=fb,this.Aza.track(za,this._name));return fb}}Object(e.a)(Da,"PerfTracker",null,[1850]);class jb{constructor(Q,za){this.he=Q;this.Aza=za}create(){return new Da(this.he,this.Aza)}}Object(e.a)(jb,"PerfTrackerFactory",
null,[1825]);class ic{constructor(Q,za,fb){this.cyc=null;this.Sck=Q;this.jZg=za;this.tbh=fb}init(Q,za,fb,Nb,tc,bd,Yd){za=this.tbh.create(za/100);fb=this.tbh.create(fb/100);this.cyc=this.Sck.create(Object(a.a)(za,za.tOb,"shouldBeInSample"),Object(a.a)(fb,fb.tOb,"shouldBeInSample"),Q,Nb,tc,bd,Yd)}oad(){this.cyc.oad()}y4c(){this.cyc.y4c()}H6f(){this.cyc.H6f()}w4c(Q,za){this.cyc.w4c(Q,za)}qum(Q,za,fb=null){this.jZg.$1n(Q,za,fb)}Hhc(Q){Q=zg.C9k(Q);this.jZg.Hhc(Q);xa.a.instance.Xy(Q.revisionId+"Start")}xHo(Q,
za,fb){J.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.vGd(Q,za,fb))}wHo(Q,za,fb){J.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.vGd(Q,za,fb))}vGd(Q,za,fb){const Nb={};Nb.PhaseName=Q;Nb.ThresholdValue=za;Nb.ActualValue=fb;return Nb}}Object(e.a)(ic,"ReplicationTelemetryManager",null,[]);var Lc=c(940);class ad extends Lc.a{constructor(Q,za){super(Q,za);this.aj=this.mvd=0}Xxa(Q){this.mvd+=Q;this.aj++}getValue(){return this.aj?this.mvd/
this.aj:0}zSa(){this.aj=this.mvd=0}}Object(e.a)(ad,"AverageMetric",Lc.a,[]);class ce extends Lc.a{constructor(Q,za){super(Q,za);this.F6=0}Xxa(Q){Q>this.F6&&(this.F6=Q)}getValue(){return this.F6}zSa(){this.F6=0}}Object(e.a)(ce,"MaxMetric",Lc.a,[]);var fc=c(1864);class kf extends Lc.a{constructor(Q,za,fb=100){super(Q,za);this.sod=this.bXb=this.xZb=0;this.dtd=fb;this.YPe=new fc.a(this.dtd)}Xxa(Q){if(this.bXb===this.dtd){const za=this.YPe.dequeue();this.xZb-=za;this.bXb--}this.YPe.enqueue(Q);this.xZb+=
Q;this.bXb++;Q=this.xZb/this.bXb;Q>this.sod&&this.bXb===this.dtd&&(this.sod=Q)}getValue(){return this.sod}zSa(){this.sod=0;this.YPe=new fc.a(this.dtd);this.bXb=this.xZb=0}}Object(e.a)(kf,"MaxRollingAverageMetric",Lc.a,[]);class Tc extends Lc.a{constructor(Q,za){super(Q,za);this.aj=0}Xxa(){this.aj++}getValue(){return this.aj}zSa(){this.aj=0}}Object(e.a)(Tc,"CounterMetric",Lc.a,[]);class Mg{constructor(Q,za){this.x_b=za;this.gte=new ad(Q+"-AverageValue","Milliseconds");this.tJe=new ce(Q+"-MaxValue",
"Milliseconds");this.AJe=new kf(Q+"-MaxRollingAverageValue","Milliseconds");this.rwe=new Tc(Q+"-NumberOfEvents","Count");this.Hsa=new db.a(Q+"-SlowPercentileAtValue","Percentile",m.AFrameworkApplication.K.XT("CoAuthLatencySlowTargetValue",3E3),m.AFrameworkApplication.K.XT("CoAuthLatencySlowThresholdPercentile",95),this.x_b);this.nNe=new db.a(Q+"-BrokenSlowPercentileAtValue","Percentile",m.AFrameworkApplication.K.XT("CoAuthLatencyBrokenSlowTargetValue",5E3),m.AFrameworkApplication.K.XT("CoAuthLatencyBrokenSlowThresholdPercentile",
95),this.x_b)}H0(Q){this.gte.Xxa(Q);this.tJe.Xxa(Q);this.AJe.Xxa(Q);this.rwe.Xxa(Q);this.Hsa.Xxa(Q);this.nNe.Xxa(Q)}hce(){this.gte.fSa();this.tJe.fSa();this.AJe.fSa();this.rwe.fSa();this.Hsa.fSa();this.nNe.fSa();this.gte.zSa();this.tJe.zSa();this.AJe.zSa();this.rwe.zSa();this.Hsa.zSa();this.nNe.zSa()}}Object(e.a)(Mg,"ReplicationLatencyMetrics",null,[]);class yf{constructor(){this.gIe=new nb.a}Y6i(Q,za,fb){if(!(0>za)){if(!({value:Nb}=this.gIe.Dc(Q,Nb)).returnValue){var Nb=new Mg(Q,fb);this.gIe.Z(Q,
Nb)}Nb.H0(za)}}hce(){for(const Q of this.gIe.values)Q.hce()}}Object(e.a)(yf,"ReplicationTelemetryMetricsManager",null,[1822]);class ng{Y6i(){}hce(){}}Object(e.a)(ng,"ReplicationTelemetryMetricsManagerStub",null,[1822]);class ji{constructor(Q,za,fb,Nb,tc,bd,Yd){this.qYa=this.Dwd=0;this.cak=Q;this.qNe=fb;this.lih=Nb;this.YLg=tc;this.LZb=za;this.dak=bd;this.x_b=Yd}Dde(Q){this.cak.Y6i(this.qNe,Q,this.x_b);Q>this.lih&&this.LZb.fHo(this.qNe,this.lih,Q);this.Dwd+=Q;this.qYa++;this.Dwd/this.qYa>this.YLg&&
this.qYa>this.dak&&this.LZb.LHk(this.qNe,this.YLg,this.Dwd/this.qYa)}}Object(e.a)(ji,"TimeSpanVerifier",null,[1841]);class kj{constructor(Q,za){this.bgk=Q;this.LZb=za}create(Q,za,fb,Nb,tc){return new ji(this.bgk,this.LZb,Q,za,fb,Nb,tc)}}Object(e.a)(kj,"TimeSpanVerifierFactory",null,[1801]);class fl extends Sys.EventArgs{constructor(Q,za,fb){super();this.wbj=Q;this.ple=za;this.actualValue=fb}}Object(e.a)(fl,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class dj{constructor(){this.ra=new O.a}fHo(Q,
za,fb){this.ra.raiseEvent("TSVTE",new fl(Q,za,fb))}LHk(Q,za,fb){this.ra.raiseEvent("TSVATE",new fl(Q,za,fb))}mxk(Q){this.ra.addHandler("TSVTE",Q)}awk(Q){this.ra.addHandler("TSVATE",Q)}}Object(e.a)(dj,"TimeSpanVerifierNotifier",null,[1800]);class yk{constructor(){this.W=this.Ma=null}get name(){return"Box4.ReplicationTelemetry"}xc(Q){this.Ma=Q.resolve("Common.IAppSettingsManager");this.W=Q;if(this.Ma.$("Box4ReplicationTelemetryIsEnabled")){Q.ha("ReplicationTelemetry.IPerfTrackerFactory",()=>new jb(Za.App.ya.Fq,
Ia.a.eF(20,1,new Ja.a))).singleInstance();Q.ha("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new dj).singleInstance();this.Ma.$("Box4ReplicationTelemetryMetricsIsEnabled")?Q.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new yf).singleInstance():Q.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new ng).singleInstance();Q.ha("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new kj(Q.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).singleInstance();
Q.ha("ReplicationTelemetry.OutboundOperationFactory",()=>new fo(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),yk.z7h)).singleInstance();Q.ha("ReplicationTelemetry.OutboundMonitorFactory",()=>new be(Q.resolve("ReplicationTelemetry.OutboundOperationFactory"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).singleInstance();Q.ha("ReplicationTelemetry.InboundOperationFactory",()=>new rl(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),
yk.z7h)).singleInstance();var za=new ye(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Q.resolve("ReplicationTelemetry.InboundOperationFactory"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),fb=this.Ma.$("ComponentStateLoggingPackageIsEnabled")?this.W.Sa("Common.IComponentStateLogManager"):null;Q.ha("ReplicationTelemetry.IInboundMonitor",()=>za.create(this.Ma.mc("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Ma.mc("Box4ReplicationTelemetryInboundOperationAverageThreshold",
0),this.Ma.mc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Ma.mc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),fb)).singleInstance();Q.ha("Common.IRandomSamplerFactory",()=>new mg).singleInstance();Q.ha("ReplicationTelemetry.ReplicationTelemetryManager",()=>new ic(Q.resolve("ReplicationTelemetry.OutboundMonitorFactory"),Q.resolve("ReplicationTelemetry.IInboundMonitor"),Q.resolve("Common.IRandomSamplerFactory"))).singleInstance();Q.ha("ReplicationTelemetry.EventForwarderFactory",
()=>new zc(Hb.a.instance,Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),Q.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.Ma.$("Box4ReplicationTelemetryIsEnabled")){var Q=this.Ma.mc("Box4ReplicationTelemetrySamplePercent",0),za=this.Ma.mc("Box4ReplicationTelemetryPhaseSamplePercent",0),fb=this.Ma.mc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Nb=this.Ma.mc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),tc=this.Ma.mc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",
0),bd=this.Ma.mc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),Yd=this;this.W.Sa("Box4.Presence.IRtcProxyProvider").execute(De=>{De.OD().continueWith(()=>{const Nf=De.OD().result,Je=Yd.W.resolve("ReplicationTelemetry.ReplicationTelemetryManager");Je.init(Nf,Q,za,fb,Nb,tc,bd);Yd.W.resolve("ReplicationTelemetry.EventForwarderFactory").create(Nf,Je);if(Yd.Ma.$("LogSteppedInboundFrameIsEnabled")){const va=Hh.a.Ap(Yd.W.Sa("Common.ICpuMeterProvider"));va.continueWith(()=>
{const Oa=Yd.W.resolve("ReplicationTelemetry.IInboundMonitor");var Ba=new oa.a(()=>!0);Ba=Ia.a.eF(19,1,Ba);Oa.initialize(Ba);const wa=va.result.Xp.task;wa.continueWith(()=>{wa.result.Pyd(0,()=>Oa.PSe,Ua=>{Oa.$kn(Ua)});wa.result.Pyd(1,Ua=>Oa.ero(Ua),()=>{Oa.Zkn()})})})}ra.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var Fd=this;m.AFrameworkApplication.$H(()=>{Fd.W.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").hce()})}}dispose(){}static z7h(){const Q=Za.App.rd;
return Q?Q.jUh:0}}Object(e.a)(yk,"ReplicationTelemetryPackage",null,[1,2]);var kn=c(943),Ei=c(12),al=c(133),ph=c(3),qf=c(84),lj=c(60),Ph=c(224),ze=c(17),Be=c(23),hf=c(8),pe=c(2011);class jm{static get Xg(){return l.a.lA(jm.Lm,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}jm.Lm="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(e.a)(jm,"InsertSymbolsDialogHtml",null,[]);class rk extends pe.a{constructor(Q,za,fb){super();this.mWb=this.sMa=this.Gcb=null;this.cEe=0;this.ZAm=Nb=>{1===Nb?(this.hUf("symbol_d_"+rk.Rvc),this.Ub.kL(this.NK,!0),this.Ub.Ps().Zj.Gy(this.ZG),this.ZG.focus()):this.hide()};this.iwj=Nb=>{if(Nb.target!==this.mWb){const tc=this.Ub.Ps();tc&&tc.Zj&&(tc.Zj.Gy(Nb.target),this.mWb=Nb.target)}this.Qrn(Nb.target.id)};this.xDo=Nb=>{const tc=Nb.zf;if("a"!==tc.tagName.toLowerCase())return!1;Nb.eventName===X.a.mB&&
this.hUf(tc.id);this.Ub.kL(this.NK,!0);this.Ub.Ps().Zj.Gy(tc);tc.focus();return!0};this.zDo=Nb=>{var tc=Nb.zf;if("a"!==tc.tagName.toLowerCase())return!1;const bd=parseInt(tc.id.substr(tc.id.lastIndexOf("_")+1));if(Nb.Gb.ctrlKey||Nb.Gb.altKey||Nb.Gb.keyCode>=Rj.a.DRb&&Nb.Gb.keyCode<=Rj.a.ERb)return!1;if(Nb.eventName===X.a.hi){Nb=Nb.Gb.keyCode;let Yd=-1;Nb===Sys.UI.Key.enter?(this.hUf(tc.id),this.Ub.kL(this.NK,!0),this.Ub.Ps().Zj.Gy(tc),tc.focus()):Nb===Sys.UI.Key.up?Yd=bd-15:Nb===Sys.UI.Key.down?Yd=
bd+15:Nb===Sys.UI.Key.left?Yd=m.AFrameworkApplication.isRtl?bd+1:bd-1:Nb===Sys.UI.Key.right&&(Yd=m.AFrameworkApplication.isRtl?bd-1:bd+1);0<=Yd&&(tc=this.kuf("symbol_d_"+Yd))&&tc.focus()}return!0};this.ga=Q;this.Ub=za;this.Hcb=fb;this.Ee(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ee(0,CommonUIStrings.l_DialogClose);this.A$=!1;this.Xg=jm.Xg;this.vg="InsertSymbolsDialog"}dispose(){0<rk.dVe&&ra.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.cEe,rk.dVe);rk.ARg++;ra.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",rk.ARg);this.ga=this.Hcb=null;super.dispose()}iTa(){this.Wh(Box4Intl.Box4Strings.L_SymbolSingle,this.ZAm,null);this.cEe=0;rk.GRg++;ra.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",rk.GRg);const Q=this.kuf("symbol_d_"+rk.Rvc);Q&&Q.focus()}hide(){var Q=document.getElementById("symbolsContainer");if(Q&&(Q=Q.getElementsByTagName("a")))for(let za=0;za<Q.length;za++)V.a.removeHandler(Q[za],
X.a.focus,this.iwj);super.hide()}get Akb(){return rk.Xvc}set Akb(Q){rk.Xvc=Q}get wkb(){return rk.Kvc}set wkb(Q){rk.Kvc=Q}W8(){super.W8();var Q=document.getElementById("symbolsContainer");if(Q&&(Q.innerHTML=this.Hcb.kMk(),Q=Q.getElementsByTagName("a")))for(let za=0;za<Q.length;za++)V.a.addHandler(Q[za],X.a.focus,this.iwj)}Tla(){const Q=document.getElementById("symbolsContainer");Q&&(this.Gcb||(this.Gcb=this.xDo,this.Jq.lb(X.a.click,Q,this.Gcb),this.Jq.lb(X.a.mB,Q,this.Gcb)),this.sMa||(this.sMa=this.zDo,
this.ae.lb(X.a.hi,Q,this.sMa),this.ae.lb(X.a.Zt,Q,this.sMa),this.ae.lb(X.a.vh,Q,this.sMa)));super.Tla()}Cfb(){const Q=document.getElementById("symbolsContainer");Q&&(this.Gcb&&(this.Jq.rc(X.a.click,Q,this.Gcb),this.Jq.rc(X.a.mB,Q,this.Gcb),this.Gcb=null),this.sMa&&(this.ae.rc(X.a.hi,Q,this.sMa),this.ae.rc(X.a.Zt,Q,this.sMa),this.ae.rc(X.a.vh,Q,this.sMa),this.sMa=null));super.Cfb()}get ixf(){return!0}Qrn(Q){this.omj("symbol_d_"+rk.Rvc,!1);rk.Rvc=parseInt(Q.substr(Q.lastIndexOf("_")+1));this.omj(Q,
!0);if(Q=document.getElementById("SymbolNameValueLabel")){const za=this.fSd(rk.Rvc);Q.innerText=za.altText}}fSd(Q){const za=this.Hcb.rke.lhg.value,fb=Jc.a(za);return za[fb[Q]]}hUf(Q){this.cEe++;rk.dVe++;Q=parseInt(Q.substr(Q.lastIndexOf("_")+1));const za=this.fSd(Q),fb={};fb.SourceControlId="symbol_"+Q+"_"+za.pke;this.ga.Qb(ph.a.Xib,2,fb);ra.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Q)}kuf(Q){const za=document.getElementById("symbolsContainer");return za?za.querySelector("#"+
Q):null}omj(Q,za){if(Q=this.kuf(Q))za?(Q.setAttribute("selected","true"),Q.setAttribute("aria-selected","true"),Q.tabIndex=0):(Q.removeAttribute("selected"),Q.setAttribute("aria-selected","false"),Q.tabIndex=-1)}}rk.Rvc=0;rk.Xvc=null;rk.Kvc=null;rk.GRg=0;rk.ARg=0;rk.dVe=0;Object(e.a)(rk,"InsertSymbolsDialog",pe.a,[]);class af{constructor(Q,za,fb,Nb,tc,bd,Yd){this.Dcm=()=>this.Hcb.bNk();this.z4i=(Fd,De,Nf,Je,va)=>{if(1===Nf)return 32;Fd=this.Hcb.n_i(va);Fd=String.format(this.Hcb.yDo,Fd.character);
va[kn.a.InnerHTML]=Fd;va[kn.a.On]=!1;return 32};this.KPa=(Fd,De,Nf,Je,va)=>{if(({je:Fd,selected:Nf,KPa:wa}=this.KIc(De,Nf)).returnValue)return wa;var Oa=ze.SelectionEditor.gf(Nf);let Ba=!0;Nf=8;var wa=this.Hc.Mc(15);wa.Cb(Fd.ed);Oa||(Nf=this.ga.Nf(De,ph.a.Bma,2,!0,Je,null),De=32===Nf,ra.ULS.shipAssertTag(6407387,348,De,"DeleteForReplace did not succeed. Response is {0}",Nf),Ba=De);Ba&&(De=Fd.mb.sg,Oa=ze.SelectionEditor.gf(De),ra.ULS.shipAssertTag(6407388,348,Oa,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
De.contextId),Nf=8,Oa&&(Nf=this.ga.Nf(De,ph.a.Xib,2,!1,Je,va),ra.ULS.shipAssertTag(6407389,348,32===Nf,"Insertion at IP context did not succeed. Response is {0}",Nf),32===Nf&&ei.FocusManager.instance().mg(Fd.$I)));wa.dispose();return Nf};this.YAm=(Fd,De,Nf,Je,va)=>{if(1===Nf)return 32;if(ze.SelectionEditor.x2a(De))return 2;Fd=this.Hcb.n_i(va);Je.ks=Fd.index;Je=this.Wc.Uf(De.node);Nf=Je.zb(11);ra.ULS.shipAssertTag(6379466,324,Nf,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",
al.a[De.node.type]);Nf=this.Hc.Mc(15);Nf.hu(Je);af.characterPropertiesEditor.replaceTextRange(De,Fd.character,!0,!1);De=Be.SelectionFactory.te(Je.currentNode,De.cpBegin+1);this.ib.setSelection(De);Nf.dispose();return 32};this.qLb=(Fd,De,Nf,Je,va)=>{if(1===Nf)return 32;va.MenuItems=this.jkk.value;return 32};this.jwj=(Fd,De,Nf)=>{({KPa:Fd}=this.KIc(De,Nf));return Fd};this.crj=(Fd,De,Nf)=>{2===Nf&&(new rk(this.ga,ei.FocusManager.instance(),ua.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).iTa();
return 32};this.F1f=()=>32;this.ga=Q;this.Wc=za;this.jkk=new hb.a(this.Dcm);this.Hc=fb;this.Hcb=Nb;this.Ik=tc;this.ib=bd;this.Sm=Yd}Tb(){this.ga.fb(ph.a.F1f,Ei.a.application,this.F1f,96);this.ga.qa(ph.a.qLb,Ei.a.view,this.qLb);this.ga.qa(ph.a.qke,Ei.a.view,this.jwj);this.ga.qa(ph.a.pbe,Ei.a.view,this.z4i);this.ga.qa(ph.a.Xib,Ei.a.view,this.KPa);this.ga.qa(ph.a.qLb,Ei.a.Tc,this.qLb);this.ga.qa(ph.a.qke,Ei.a.Tc,this.jwj);this.ga.qa(ph.a.pbe,Ei.a.Tc,this.z4i);this.ga.qa(ph.a.Xib,Ei.a.Tc,this.YAm);this.ga.Vc(ph.a.qLb,
1124);this.ga.Vc(ph.a.qke,1036);this.ga.Vc(ph.a.pbe,1124);this.ga.Vc(ph.a.Xib,1036);m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&(this.ga.qa(ph.a.BSc,Ei.a.view,this.crj),this.ga.qa(ph.a.BSc,Ei.a.Tc,this.crj),this.ga.Vc(ph.a.BSc,1124))}KIc(Q,za){let fb,Nb=null;Q.view.qe&&(Nb=Q.view);fb=null;if(!Nb||!Nb.mb)return J.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",Q.toString()),
{returnValue:!0,je:Nb,selected:fb,KPa:8};fb=Nb.mb.sg;if(!fb)return{returnValue:!0,je:Nb,selected:fb,KPa:2};if(this.Ik.i_(fb)||this.Ik.iha(fb))return{returnValue:!0,je:Nb,selected:fb,KPa:8};if(Nb.mb.hb.nJ||this.Sm&&this.Sm.instance&&this.Sm.instance.qU(fb)||ze.SelectionEditor.x2a(Q.$j))return{returnValue:!0,je:Nb,selected:fb,KPa:2};if(af.Wg.pza(hf.ParagraphReader.mU,fb))return Q=8,af.Ic.Yb(qf.a.kf,{["Reason"]:lj.a.dO}),{returnValue:!0,je:Nb,selected:fb,KPa:Q};Q=32;return 1===za?{returnValue:!0,je:Nb,
selected:fb,KPa:Q}:{returnValue:!1,je:Nb,selected:fb,KPa:Q}}static get characterPropertiesEditor(){return af.Kd||(af.Kd=ua.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(Q){af.Kd=Q}static get Wg(){return Ph.ContextSetEditor.instance}static get Ic(){return dh.a.instance}}af.Kd=null;Object(e.a)(af,"SymbolsActor",null,[1795]);class Cf{constructor(Q,za){this.pke=Q;this.altText=za}}Object(e.a)(Cf,"Symbol",null,[]);class Hi{constructor(){this.GTe=null;this.xhh=
new hb.a(Hi.hbf)}get lhg(){return this.xhh}N$h(Q){this.GTe||(this.GTe=Jc.a(this.xhh.value));return Array.indexOf(this.GTe,Q)}static hbf(){const Q={};Q["\u2022"]=new Cf("\u2022",Box4Intl.Box4Strings.L_Bullet);Q["\u20ac"]=new Cf("\u20ac",Box4Intl.Box4Strings.L_EuroSign);Q["\u00a3"]=new Cf("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Q["\u00a5"]=new Cf("\u00a5",Box4Intl.Box4Strings.L_YenSign);Q["\u00a9"]=new Cf("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);Q["\u00ae"]=new Cf("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);
Q["\u2122"]=new Cf("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Q["\u00b1"]=new Cf("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);Q["\u2260"]=new Cf("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Q["\u2264"]=new Cf("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);Q["\u2265"]=new Cf("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Q["\u00f7"]=new Cf("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Q["\u00d7"]=new Cf("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);Q["\u221e"]=new Cf("\u221e",
Box4Intl.Box4Strings.L_Infinity);Q["\u00b5"]=new Cf("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Q["\u03b1"]=new Cf("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);Q["\u03b2"]=new Cf("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);Q["\u03c0"]=new Cf("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Q["\u03a9"]=new Cf("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Q["\u03a3"]=new Cf("\u03a3",Box4Intl.Box4Strings.L_NArySummation);Q["\u00b0"]=new Cf("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);
Q["\u0394"]=new Cf("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Q["\u263a"]=new Cf("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Q["\u2665"]=new Cf("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);Q["\u20b9"]=new Cf("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);Q["\u00bf"]=new Cf("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Q["\u00a1"]=new Cf("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Q["\u2014"]=new Cf("\u2014",Box4Intl.Box4Strings.L_EmDash);Q["\u2026"]=new Cf("\u2026",
Box4Intl.Box4Strings.L_HorizontalEllipsis);Q["\u00c0"]=new Cf("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Q["\u00c1"]=new Cf("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);Q["\u00c2"]=new Cf("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);Q["\u00c3"]=new Cf("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Q["\u00c4"]=new Cf("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);Q["\u00c5"]=new Cf("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);
Q["\u00c6"]=new Cf("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Q["\u00c7"]=new Cf("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Q["\u00c8"]=new Cf("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Q["\u00c9"]=new Cf("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Q["\u00ca"]=new Cf("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Q["\u00cb"]=new Cf("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Q["\u00cc"]=
new Cf("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Q["\u00cd"]=new Cf("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Q["\u00ce"]=new Cf("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Q["\u00cf"]=new Cf("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);Q["\u00d1"]=new Cf("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Q["\u00d2"]=new Cf("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Q["\u00d3"]=new Cf("\u00d3",
Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Q["\u00d4"]=new Cf("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Q["\u00d5"]=new Cf("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);Q["\u00d6"]=new Cf("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Q["\u00d9"]=new Cf("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Q["\u00da"]=new Cf("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Q["\u00db"]=new Cf("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);
Q["\u00dc"]=new Cf("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Q["\u00df"]=new Cf("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Q["\u00e0"]=new Cf("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Q["\u00e1"]=new Cf("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Q["\u00e2"]=new Cf("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Q["\u00e3"]=new Cf("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Q["\u00e4"]=new Cf("\u00e4",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Q["\u00e5"]=new Cf("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Q["\u00e6"]=new Cf("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);Q["\u00e7"]=new Cf("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);Q["\u00e8"]=new Cf("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);Q["\u00e9"]=new Cf("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Q["\u00ea"]=new Cf("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);
Q["\u00eb"]=new Cf("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Q["\u00ec"]=new Cf("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);Q["\u00ed"]=new Cf("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Q["\u00ee"]=new Cf("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Q["\u00ef"]=new Cf("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Q["\u00f1"]=new Cf("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Q["\u00f2"]=new Cf("\u00f2",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Q["\u00f3"]=new Cf("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Q["\u00f4"]=new Cf("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Q["\u00f5"]=new Cf("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);Q["\u00f6"]=new Cf("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Q["\u00f9"]=new Cf("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Q["\u00fa"]=new Cf("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);
Q["\u00fb"]=new Cf("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Q["\u00fc"]=new Cf("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);Q["\u00ff"]=new Cf("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Q["\u011e"]=new Cf("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);Q["\u011f"]=new Cf("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Q["\u0130"]=new Cf("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Q["\u0131"]=
new Cf("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Q["\u0152"]=new Cf("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Q["\u0153"]=new Cf("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Q["\u015e"]=new Cf("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);Q["\u015f"]=new Cf("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Q["\u0178"]=new Cf("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Q}}Object(e.a)(Hi,"SymbolsLoader",
null,[1794]);var Cn=c(398),zh=c(336),zr=c(205),Hj=c(641),yo=c(1457),Xd=c(160),Gf=c(89);class re{constructor(Q){this.rke=Q}get yDo(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}n_i(Q){Q=Q.SourceControlId.split("_");const za={};2===Q.length?(za.character=Q[1],za.index=this.rke.N$h(za.character)):(za.character=Q[2],za.index=parseInt(Q[1]));return za}bNk(){return this.Jgi()}build(){return this.Ecm()}kMk(){const Q=new Sys.StringBuilder;Q.append('<table class="moreSymbolsTable">');
const za=this.rke.lhg.value,fb=Jc.a(za);let Nb=0;for(;Nb<fb.length;){Nb%15||Q.append('<tr role="presentation">');const tc=za[fb[Nb]];Q.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="-1" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',"symbol_d_"+Nb,Ra.a.MX(tc.pke),Ra.a.MX(tc.altText)));Nb++;Nb%15&&Nb!==fb.length||Q.append("</tr>")}Q.append("</table>");return Q.toString()}Ecm(){const Q=
this.Jgi();return Xd.o(Q)}Jgi(){const Q=Object.assign(new Cn.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Q.MenuSectionList.push(this.euk());m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&Q.MenuSectionList.push(this.nsk());return Q}nsk(){const Q=Object.assign(new zh.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),za=Object.assign(new zr.a,{Id:"btnMoreSymbols",Command:ph.a.BSc.toString(),LabelText:Ra.a.Af(Box4Intl.Box4Strings.L_InsertMoreSymbols),
Alt:Ra.a.Af(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:m.AFrameworkApplication.Rs,Image16by16Class:Gf.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Q.ControlList.push(za);return Q}euk(){const Q=Object.assign(new zh.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),za=Object.assign(new Hj.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",
GalleryItems:[]}),fb=this.rke.lhg.value,Nb=Jc.a(fb),tc=Math.min(25,Nb.length);for(let Yd=0;Yd<tc;Yd++){var bd=fb[Nb[Yd]];bd=Object.assign(new yo.a,{Id:String.format("{0}{1}_{2}","symbol_",Yd,bd.pke),Character:bd.pke,Command:ph.a.Xib.toString(),QueryCommand:ph.a.pbe.toString(),Alt:Ra.a.Af(bd.altText)});za.GalleryItems.push(bd)}Q.ControlList.push(za);return Q}}Object(e.a)(re,"SymbolsUiBuilder",null,[1792]);var Of=c(46),Pb=c(234),gk=c(538),Al=c(332);class Yj{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){m.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&
this.W.resolve("Box4.Symbols.ISymbolsActor").Tb()}dispose(){}xc(Q){this.W=Q;this.W.register(Hi,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").singleInstance();this.W.ha("Box4.Symbols.SymbolsUiBuilder",()=>new re(this.W.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").singleInstance();this.W.ha("Box4.Symbols.SymbolsActor",()=>new af(m.AFrameworkApplication.va,new gk.a,new Al.a,this.W.resolve("Box4.Symbols.ISymbolsUIBuilder"),Pb.a.instance,Of.a.instance,
this.W.Sa("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").singleInstance()}static main(){K.a.instance.Fc(new Yj)}}Object(e.a)(Yj,"Box4SymbolsPackage",null,[1,2]);var No=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},
Xo=c(1614),op=c(1566),Gp=c(1551),go=c(1927),zo=c(230),tb=c(399);class Bc{constructor(){this.$Ia=null}xc(Q){this.container=Q}init(){this.$Ia=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.$Ia&&this.$Ia.dispose()}}Object(e.a)(Bc,"ALiveBooksAccessibilityCheckPackageManager",null,[1,2]);class qd{get j4k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get k4k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get l4k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get Jvn(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get lfc(){return CommonUIStrings.l_AccCheckerPaneTitle}get jzn(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(e.a)(qd,"AccessibilityCheckStringsProvider",null,[57]);class xe{constructor(){this.Tej=this.contentId=null}}Object(e.a)(xe,"ResultIds",null,[]);class Ge{constructor(Q,za){this._element=null;this.hg=za;this.ae=Q}get element(){this._element||(this._element=this.T8k(),this.wz());return this._element}ccg(Q){this._element=Q}dispose(){this.element&&(this.X9(),this.ccg(null))}wz(){this.hg&&this.ae?(this.hg.lb(X.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ae.lb(X.a.hi,this.element,
Object(a.a)(this,this.FG,"onKeyPress"))):ra.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}X9(){this.hg&&this.ae&&(this.hg.rc(X.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ae.rc(X.a.hi,this.element,Object(a.a)(this,this.FG,"onKeyPress")))}onClick(){this.bUi();return!0}FG(Q){return this.nLm(Q.Gb.keyCode)?(this.bUi(),!0):!1}nLm(Q){return Q===Rj.a.koe||Q===Rj.a.zs}}
Object(e.a)(Ge,"AInteractivePaneElement",null,[723,9]);var gf=c(443),uf=c(54);class ff extends Ge{constructor(Q,za,fb){super(Q,za);this.qLe=fb}hide(){this.element.removeAttribute(Yf.a.qh);Yf.a.gr(this.element,Yf.a.bA,Yf.a.jp);this.element.style.display="none"}show(){Yf.a.gr(this.element,Yf.a.bA,Yf.a.dM);Yf.a.gr(this.element,Yf.a.qh,Yf.a.K1e);this.element.style.display="block"}T8k(){const Q=gf.b("div",this.vQi,"AccCheckerNotification");Yf.a.gr(Q,Yf.a.uuh,Yf.a.jp);Yf.a.gr(Q,Yf.a.efa,this.hRf);Q.tabIndex=
0;const za=gf.b("span",this.uQi,"AccCheckerNotificationIcon");var fb=Gf.createClusteredImage(16,16,"Info_16x16x32","",!0,"");za.appendChild(fb);fb=gf.b("span",this.hRf,"AccCheckerNotificationText");uf.a.Ey(fb,this.wQi);Q.appendChild(za);Q.appendChild(fb);return Q}bUi(){this.qLe()}}Object(e.a)(ff,"APopupNotification",Ge,[722,723,9]);class qj extends ff{constructor(Q,za,fb,Nb){super(Q,za,fb);this.$sa=Nb}get vQi(){return"AccCheckerOutOfSyncNotificationId"}get uQi(){return"AccCheckerOutOfSyncNotificationIconId"}get hRf(){return"AccCheckerOutOfSyncNotificationTextId"}get wQi(){return this.$sa.Jvn}}
Object(e.a)(qj,"OutOfSyncNotification",ff,[]);class wg extends ff{constructor(Q,za,fb,Nb){super(Q,za,fb);this.$sa=Nb}get vQi(){return"AccCheckerPartialResultNotificationId"}get uQi(){return"AccCheckerPartialResultNotificationIconId"}get hRf(){return"AccCheckerPartialResultNotificationTextId"}get wQi(){return this.$sa.jzn}}Object(e.a)(wg,"PartialResultNotification",ff,[]);var sh=c(185),lc=c(31),Li=c(173);class ld{constructor(Q,za,fb,Nb=null,tc=null,bd=null,Yd=null){this.Lch=this.VL=this.ae=this.$Ia=
null;this.a0=Nb;this.hg=Q;this.Ub=za;this.$o=fb;this.$sa=Yd||new qd;this.eMe=tc||new qj(this.a0,this.hg,Object(a.a)(this,this.Tll,"dimissOutOfSyncNotification"),this.$sa);this.UMe=bd||new wg(this.a0,this.hg,Object(a.a)(this,this.Ull,"dimissPartialResultNotification"),this.$sa)}show(){}hide(){}get a0(){return this.ae||(this.ae=m.AFrameworkApplication.ta.gD)}set a0(Q){this.ae=Q}qKh(){}Nna(){}dispose(){}H7a(){}XCm(Q){var za=this.Lch[Q];Q=za.contentId;if((za=za.Tej+"")&&za.length){const fb=[];Array.add(fb,
Object.assign(new lc.a,{name:"RuleID",string:za}));sh.a.sendTelemetryEvent(Object.assign(new Li.a,{name:String.format("{0}.{1}",ld.hig,"ViolationSelected"),dataFields:fb}))}this.Ydn(Q)}Ydn(Q){Q&&this.$Ia.ggo(Q)||(this.Ub.kL(wd.AFrame.Mlh,!1),this.oto())}Tll(){this.e8c(!1)}Ull(){this.Vqj(!1)}oto(){const Q=Object.assign(new bc.StandardDialog(!0),{rt:m.AFrameworkApplication.Oba,Ad:1,HHa:!1});Q.XU(1);Q.Ee(1,this.$sa.j4k);Q.Ee(0,CommonUIStrings.l_DialogCancel);Q.$U(this.$sa.l4k,this.$sa.k4k,za=>{1===za&&
this.hBf()})}iNk(Q){let za=null;if(Q.Results&&0<Q.Results.length){za={};let fb=0;for(const Nb of Q.Results)Nb.ResultId=ld.rok+ ++fb,Q=new xe,Q.contentId=Nb.ContentId,Q.Tej=Nb.RuleId,za[Nb.ResultId]=Q}return za}j5m(){sh.a.addNamespaceMapping(ld.hig,ld.OFo);sh.a.sendTelemetryEvent(Object.assign(new Li.a,{name:String.format("{0}.{1}",ld.hig,"ShowTaskpane")}))}}ld.rok="AccCheckResult";ld.hig="Office.UX.AccChecker";ld.OFo="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(e.a)(ld,
"BaseAccessibilityCheckPane",null,[657,9]);class ej{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(e.a)(ej,"AccCheckerTaskPaneProps",null,[]);var bl=c(1378),jd=c(1393),th=c(1046),vd=c(176);class rj extends ld{constructor(Q,za,fb,Nb,tc=null,bd=null,Yd,Fd=null,De=null){super(za,
fb,Nb,bd,void 0,void 0,Fd);this.eKg=null;this.ybh=this.TMe=this.iqd=this.xtd=this.Tsd=!1;this.eWe=null;this.aUe=!!m.AFrameworkApplication.ta&&!!m.AFrameworkApplication.ta.Nb&&m.AFrameworkApplication.ta.Nb.AGf;this.Wsc=this.I5=null;this.Htc=0;this.akd=null;this.XY=tc;De&&(this.I5=De.uyd,this.Wsc=De.Edp,this.Htc=De.Qep);this.cB=new jd.a}get isVisible(){return this.ybh}eTa(Q){this.ybh=Q}bff(Q){Q&&(this.eKg=Q,Q.IsSuccess&&(this.Lch=this.iNk(Q),Q.IsPartialResult&&this.Vqj(!0)),this.Tsd=!0,this.xtd=!1,
this.Cm())}e8c(Q){this.isVisible&&Q!==this.iqd&&(this.iqd=Q,this.Cm())}Vqj(Q){this.TMe=Q;this.Cm()}nP(){this.xtd||vd.UISurfaces.zu().then(Q=>{xa.a.instance.Xy(rj.Sqb+":PaneOpen:Start");Q.showTaskPane(rj.Sqb,this.eA());this.hBf();return null});this.isVisible?vd.UISurfaces.zu().then(Q=>{Q.setSelectedTaskPane(rj.Sqb);return null}):this.j5m()}Cm(){vd.UISurfaces.zu().then(Q=>{Q.updateTaskPane(rj.Sqb,this.eA());return null})}eA(){var Q=new ej;this.cB.mob(Q);Q=Object.assign(new th.a,{title:this.$sa.lfc,
hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:()=>{this.E9();this.eTa(!0);m.AFrameworkApplication.ta.updateCommandUI()},onClose:()=>{this.Uca();this.eTa(!1);this.xtd=this.Tsd=!1;this.Cm();m.AFrameworkApplication.ta.updateCommandUI()},isModernPane:!0});this.aUe&&(Q.enableResize=!0,Q.minResizeWidth=268,Q.maxResizeWidth=920);return Q}initialize(Q){const za=this.Ub.ge(rj.Sqb);za.parent=wd.AFrame.rp;za.OH=!0;this.$Ia=Q;this.spk()}dispose(){this.H7a();this.eMe&&(this.eMe.dispose(),this.eMe=null);
this.UMe&&(this.UMe.dispose(),this.UMe=null);super.dispose()}spk(){this.cB.lL(this.onRecheckExecute());this.cB.lL(this.jJl());this.cB.lL(this.r9l());this.cB.lL(this.onInvokeNavigateExecute());this.cB.lL(this.CXl());this.cB.lL(this.v4l());this.cB.lL(this.m6l());this.cB.lL(this.updateLastScanTime());this.cB.lL(this.showHelpPane())}onRecheckExecute(){return Q=>{Q.onRecheckExecute=()=>{this.hBf()}}}jJl(){return Q=>{Q.accessibilityCheckResultCollection=this.eKg}}r9l(){return Q=>{Q.resultsReady=this.Tsd}}onInvokeNavigateExecute(){return Q=>
{Q.onInvokeNavigateExecute=za=>{this.XCm(za)}}}CXl(){return Q=>{Q.helpLink=this.txl}}v4l(){return Q=>{Q.outOfSync=this.iqd}}m6l(){return Q=>{Q.partialResult=this.TMe}}updateLastScanTime(){return Q=>{Q.updateLastScanTime=za=>{this.eWe=za}}}showHelpPane(){return Q=>{Q.showHelpPane=()=>{m.AFrameworkApplication.K&&m.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?m.AFrameworkApplication.JK||this.fuh()?this.akd?this.akd():this.I5.value&&this.Wsc&&
this.Htc&&this.I5.value.Qb(this.Htc,2,this.Wsc):this.Urj():this.fuh()?this.akd?this.akd():this.I5.value&&this.Wsc&&this.Htc&&this.I5.value.Qb(this.Htc,2,this.Wsc):this.Urj()}}}fuh(){return!this.XY||!this.XY.value}Urj(){const Q=this.XY.value;if(Q){var za={};za.query=rj.gfk+rj.G4j;za=Object.assign(new bl.a,{rR:za});Q.i5(rj.yCe,za)}}hBf(){this.TMe=this.iqd=this.Tsd=!1;this.eWe&&this.eWe();this.Cm();this.xtd=!0;this.$Ia.akn()}E9(){this.Ub.mg(rj.Sqb)}Uca(){this.l3a()&&this.Ub.mg(this.Ub.wT)}l3a(){return!!this.Ub.currentScope&&
this.Ub.currentScope.name===rj.Sqb}}rj.Sqb="AccessibilityCheckerPane";rj.G4j="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";rj.yCe="FA000000012";rj.gfk="AssetID=";Object(e.a)(rj,"ReactAccessibilityCheckPane",ld,[]);class fj extends rj{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd,De=null){super(Q,za,fb,Nb,tc,bd,void 0,De);this.s1j=Fd;this.R2=Yd}get txl(){return this.s1j}nP(){this.R2.KNa();super.nP()}}Object(e.a)(fj,"ReactLiveBooksAccessibilityCheckPane",rj,[]);var Mh=c(1137),Ef=c(134),hk=c(147),$h=c(61),km=c(157),de=
c(499),ke;(function(Q){Q[Q.error=0]="error";Q[Q.warning=1]="warning";Q[Q.tip=2]="tip";Q[Q.intelligentService=3]="intelligentService"})(ke||(ke={}));Object(e.b)("AccessibilityRuleCategory",ke);class Cc{constructor(Q,za,fb=null){this.nre=null;this.R0g=this.z_g=!1;this.HMa=Q;this.tdd=za;this.ga=fb;this.pc.qa(n.a.KYk,z.a.frame,Object(a.a)(this,this.G7e,"closePane"))}get pc(){return this.ga||(this.ga=m.AFrameworkApplication.va)}set pc(Q){this.ga=Q}ytl(){this.z_g||(this.HMa.initialize(this),this.tdd.initialize(this),
this.z_g=!0)}akn(){J.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.tdd.K7n()}nP(Q,za,fb){if(1===fb)return rh.SessionStatusManager.instance.wj?8:32;this.HMa.isVisible||this.ytl();this.Ruo();return 32}G7e(Q,za,fb){1!==fb&&this.HMa.Nna();return 32}arn(){this.HMa.e8c(!0)}bff(Q){if(Q){if(Q.AccessibilityRules&&Object.keys(Q.AccessibilityRules).length){const fb=Q.AccessibilityRules;for(let Nb in fb){var za=Nb;const tc=fb[Nb].RuleId+"";za!==tc&&J.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
za,tc)}this.nre=fb}else!this.nre&&Q.Results&&0<Q.Results.length?(J.b(18993251,200,15,"No accessibility rule definitions available"),Q.IsSuccess=!1):Q.AccessibilityRules=this.nre;Q.IsSuccess||J.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.nYn(Q);this.V4m(Q);this.HMa.bff(Q)}}nYn(Q){const za=Q.AccessibilityRules;if(Q=Q.Results)for(let fb=Q.length-1;0<=fb;fb--){const Nb=Q[fb];let tc="";const bd=Nb.RuleId;Nb.ContentName||(tc+="Result does not have content name. ");bd in za||(tc+=String.format("No accessibility check rule exists for ID {0}.",
bd));0<tc.length&&(J.b(36214999,200,15,"Omitting invalid accessibility check result: "+tc),Array.removeAt(Q,fb))}}y$l(){return m.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):ua.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Kz.loadScript("accessibility-checker-pane-strings")}Ruo(){this.R0g?this.HMa.nP():this.y$l().then(()=>{this.R0g=!0;this.HMa.nP()}).catch(Q=>ra.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
Q))}V4m(Q){var za={};const fb={};var Nb=Q.Results,tc=[];Array.add(tc,Object.assign(new lc.a,{name:"FinalViolationCount",int64:0}));Array.add(tc,Object.assign(new lc.a,{name:"FinalErrorCount",string:"0"}));Array.add(tc,Object.assign(new lc.a,{name:"FinalWarningCount",string:"0"}));Array.add(tc,Object.assign(new lc.a,{name:"FinalTipCount",string:"0"}));Array.add(tc,Object.assign(new lc.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Nb){for(const Fd of Nb)if(Q.AccessibilityRules){var bd=Q.AccessibilityRules[Fd.RuleId];
if(bd){if(za[ke[bd.Category]]){let De=za[ke[bd.Category]];za[ke[bd.Category]]=++De}else za[ke[bd.Category]]=1;fb[Fd.RuleId]?(bd=fb[Fd.RuleId],fb[Fd.RuleId]=++bd):fb[Fd.RuleId]=1}}tc[0].int64=Nb.length;for(var Yd in za)switch(Q=za[Yd],Nb=Yd,Nb="Final"+Nb.charAt(0).toUpperCase()+Nb.substring(1,Nb.length)+"Count",Nb){case "FinalErrorCount":tc[1].string=Q.toString();break;case "FinalWarningCount":tc[2].string=Q.toString();break;case "FinalTipCount":tc[3].string=Q.toString();break;case "FinalIntelligentServiceCount":tc[4].string=
Q.toString()}}sh.a.sendTelemetryEvent(Object.assign(new Li.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:tc}));for(let Fd in fb)za=Fd,tc=fb[Fd],Yd=[],Array.add(Yd,Object.assign(new lc.a,{name:"RuleID",string:za})),Array.add(Yd,Object.assign(new lc.a,{name:"FinalViolationCount",string:tc.toString()})),sh.a.sendTelemetryEvent(Object.assign(new Li.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Yd}))}dispose(){this.HMa&&
this.HMa.dispose();this.tdd&&this.tdd.dispose()}}Object(e.a)(Cc,"AAccessibilityCheckManager",null,[56,9]);var Rh=c(307);const Bi=[12,14,22,19,30,43,44];class sn extends Cc{constructor(Q,za,fb,Nb,tc,bd){super(za,fb,Q);this.pc.qa(n.a.Kdg,z.a.frame,this.nP.bind(this));this.pc.fb(n.a.IKn,z.a.frame,this.B4i.bind(this),96);this.graph=tc;this.sak=Nb;this.Q7j=bd;this.Lec=()=>{this.arn()};this.PUn()}B4i(Q,za,fb,Nb,tc){if(1===fb)return 32;tc[Rh.a.On]=this.HMa.isVisible;return 32}ggo(Q){if(this.Q7j)return ra.ULS.sendTraceTag(20713608,
334,15,"ODT file. Disable content navigation."),!0;ra.ULS.shipAssertTag(20272215,334,!!Q);return this.sak.Sdn(Q)}PUn(){for(const Q of Bi){const za=this.graph.Ze(Q);za.Fo(this.Lec);za.Ot(this.Lec);za.Kw(this.Lec)}}DPo(){for(const Q of Bi){const za=this.graph.Ze(Q);za.QU(this.Lec);za.PU(this.Lec);za.yia(this.Lec)}}dispose(){super.dispose();this.DPo()}}Object(e.a)(sn,"WordAccessibilityCheckManager",Cc,[]);var uh=c(76),Wh=c(28),Dn=c(121),Lk=c(18),pp=c(165),fm=c(6),Ag=c(16),We=c(467);class Re{constructor(Q,
za,fb,Nb,tc,bd,Yd){this.rm=null;this.uBb=0;this.Wc=za;this.Tz=fb;this.ib=Nb;this.ga=tc;this.fd=bd;this.Mt=Q;this.ud=Yd}get TR(){if(!this.rm){const Q=this.Wc.Uf(this.Mt.Uc);this.Tz.Kkg(Q);if(Q.zb(7)||Q.hd(7))this.rm=uh.a.mt(Q,Q.origin)}return this.rm}Sdn(Q){if(!Q||!Q.zg||0>=Q.zg.length)return ra.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var za=Array(Q.zg.length);let fb=7,Nb=null;for(let bd=0;bd<Q.zg.length;bd++)if(Nb=this.CBl(Q.zg[bd])){if(7===fb)fb=this.uBb;else if(fb!==
this.uBb)return ra.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var tc=this.ud.LRa(Nb.characterData,Nb.pa);const Yd=Q.cpBegin?this.ud.XAb(tc,Q.cpBegin):-1;tc=Q.cpEnd?this.ud.XAb(tc,Q.cpEnd):-1;if(-1>Yd||-1>tc)return ra.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;za[bd]=Wh.a.jO(Yd,tc,!1,Nb);switch(Q.contentType){case 5:if(!Dn.HyperlinkReader.Vli(za[bd],!1))return!1;break;case 6:if(!Lk.ImageReader.d4(za[bd]))return!1;
break;case 7:za[bd]=Wh.a.jO(-1,-1,!1,Nb)}}else return!1;za=new pp.Selection(za,!1);return this.Xko(Nb,za,Q.contentType)}CBl(Q){if(this.TR)for(this.TR.reset(),this.uBb=7;this.TR.moveNext();){var za=this.TR.currentNode.type;if(38===za||36===za||23===za)this.uBb=za;else if(12===za){za=this.TR.currentNode;const fb=za.ia(fm.a.Lc,0);if(Q===fb)return za}}return null}ihg(Q){this.ga.processAction(Ag.a.zT,2);this.ga.processAction(Ag.a.y3,2);let za=2;switch(this.uBb){case 23:za=32;break;case 38:za=this.ga.Qb(Ag.a.E4a,
2,new We.a(Q));break;case 36:za=this.ga.Qb(Ag.a.Bkb,2,new We.a(Q));break;default:ra.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.uBb)}if(32===za)return!0;ra.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.uBb);return!1}Xko(Q,za,fb){if(this.ihg(Q)){Q=this.Mt.ru;const Nb=this.ib.hb.kb;Nb&&Nb.equals(za)&&this.fd.Yca(Q,null);this.fd.Yca(Q,za);switch(fb){case 0:case 1:this.ga.processAction(ph.a.CNb,2);break;case 2:this.ga.processAction(ph.a.V5c,
2);break;case 3:this.ga.processAction(ph.a.vya,2)}return!0}return!1}}Object(e.a)(Re,"WordAccessibilityCheckNavigateManager",null,[1799]);class sf{constructor(Q){this.$Ia=null;this.pWg=Q}get fileId(){return this.pWg?this.pWg():null}initialize(Q){this.$Ia=Q}rSi(Q){this.$Ia.bff(Q)}}Object(e.a)(sf,"AAccessibilityCheckService",null,[58,9]);class zi{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(Q){Q=Sys.Serialization.JavaScriptSerializer.deserialize(Q);
const za=Q.AccessibilityRules,fb={};if(za)for(let Nb=0;Nb<za.length;++Nb){const tc=za[Nb];fb[tc.Key]=tc.Value}Q.AccessibilityRules=fb;return Q}}Object(e.a)(zi,"AccessibilityCheckResultCollection",null,[]);class En extends sf{constructor(Q){super(Q);this.onFailure=(za,fb)=>{ra.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",fb);za=Object.assign(new zi,{IsSuccess:!1});this.rSi(za)};this.onSuccess=za=>{za=En.p9l(za);let fb=null;if(za)try{fb=this.sjl(za)}catch(Nb){ra.ULS.shipAssertTag(20730843,
334,!1,"AccChecker response data is invalid. [{0}]",Nb.message),fb=Object.assign(new zi,{IsSuccess:!1})}else ra.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),fb=Object.assign(new zi,{IsSuccess:!1});this.rSi(fb)}}dispose(){}static p9l(Q){let za=null;Q&&Q.zj&&(za=Q.zj[0]);return za?za.Body:null}}Object(e.a)(En,"ALiveBooksAccessibilityCheckService",sf,[]);var zk=c(988),Ao=c(231);class $n extends Ao.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}$k(){return 56}static construct(Q,
za){const fb=new $n;fb.FileId=Q;fb.IsCoauthorable=za;return fb}}Object(e.a)($n,"WordAccessibilityCheckRequest",Ao.a,[]);class mj{}Object(e.a)(mj,"AccessibilityCheckRule",null,[]);var kc=c(182);class zm{static parse(Q){switch(Ra.a.Tg(Q)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw Q=String.format("Invalid Accessibility result category: {0}",Q),kc.a.argument(Q);}}}Object(e.a)(zm,"AccessibilityRuleCategoryParser",null,[]);class Oc{constructor(){this.Category=
this.Text=this.Id=null}static THo(Q){const za=new mj;za.RuleId=Q.Id;za.RuleName=Q.Text;za.Category=zm.parse(Q.Category);return za}}Object(e.a)(Oc,"WordAccessibilityCheckRule",null,[]);class Fn{}Object(e.a)(Fn,"AccessibilityCheckResult",null,[]);class Zj{constructor(){this.cpEnd=this.cpBegin=this.zg=null;this.contentType=0}}Object(e.a)(Zj,"WordAccessibilityCheckContentId",null,[]);const Ul=Q=>{switch(Ra.a.Tg(Q)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;
case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var no=c(1581);class ml{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static RHo(Q){const za=new Fn;za.RuleId=Q.RuleId;za.ContentName=Q.Label;const fb=new Zj;fb.zg=Q.ParaId;fb.cpBegin=no.b(Q.OS);fb.cpEnd=no.b(Q.OE);fb.contentType=Ul(Q.ContentType);za.ContentId=fb;return za}}Object(e.a)(ml,"WordAccessibilityViolation",null,
[]);class Xp{constructor(){this.Violations=this.Rules=null}static SHo(Q){const za=new zi;try{var fb={};if(Q.Rules){for(let Nb=0;Nb<Q.Rules.length;++Nb){const tc=Oc.THo(Q.Rules[Nb]);fb[tc.RuleId]=tc}za.AccessibilityRules=fb}if(Q.Violations){const Nb=Array(Q.Violations.length);for(fb=0;fb<Q.Violations.length;++fb)Nb[fb]=ml.RHo(Q.Violations[fb]);za.Results=Nb}za.IsPartialResult=!1;za.IsSuccess=!0}catch(Nb){ra.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",
Nb.message),za.IsSuccess=!1}return za}}Object(e.a)(Xp,"WordAccessibilityCheckResult",null,[]);class Nh extends En{constructor(Q,za,fb){super(Q);this.ltb=za;this.sab=fb}K7n(){const Q=Object.assign(new zk.a,{Cq:$n.construct(this.fileId,this.sab),status:1,GG:"AccessibilityCheck"});this.ltb(12,!1,this.onSuccess,this.onFailure,Q,null,Q)}sjl(Q){Q=Ya.b(Q);return Xp.SHo(Q)}}Object(e.a)(Nh,"WordAccessibilityCheckService",En,[]);class Og extends Bc{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}xc(Q){super.xc(Q);
Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new fj(m.AFrameworkApplication.va,zo.a.instance,ei.FocusManager.instance(),tb.a.instance,Q.Ue("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Df.KeyInputManager.instance,Mh.a.instance,m.AFrameworkApplication.K.jb("AccessibilityCheckerHelpUrl"))).singleInstance();Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new Nh(()=>m.AFrameworkApplication.rootQuerySignature,de.a.FQ,Ef.PageReader.instance.SPd(Za.App.ya.gb.Uc))).singleInstance();
Q.ha("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new Re(Za.App.ya.gb,Q.resolve("Box4.Graph.IGraphIteratorFactory"),hk.PageNavigator.instance,Q.resolve("Box4.ISelectionManager"),m.AFrameworkApplication.va,$h.InteractiveViewManager.instance,Q.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).singleInstance();Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new sn(m.AFrameworkApplication.va,Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),
Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),Q.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),Za.App.Lj.Bl,km.App.LUc)).singleInstance()}init(){this.container.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>{Bc.prototype.init.call(this)})}}Object(e.a)(Og,"WordAccCheckerPackageManager",Bc,[]);class Bo{constructor(Q,za){this.shh=!1;this.fLo=()=>{this.eLo()};this.Nk=Q;this.BI=za}z4a(Q){Q.PO.ayk(this.fLo)}eLo(){!this.shh&&this.Nk&&(this.Nk.IFa?
this.BI?this.BI.execute(Q=>{Q.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):ra.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.shh=!0)}}Object(e.a)(Bo,"CoauthSurveyManager",null,[1789]);class Ek{constructor(){this.Mt=this.W=null}get name(){return"WordEditor.CoauthSurveys"}init(){Za.App.ya&&(this.Mt=Za.App.ya.gb)&&(this.Mt.swa?this.$ia():this.Mt.Xea(()=>{this.$ia()}))}$ia(){var Q=this.Mt.Uc;Q&&(Q=Q.contentReplicator)&&
this.W.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").z4a(Q)}dispose(){}xc(Q){this.W=Q;Q.ha("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new Bo(Q.resolve("WordEditor.IWordEditorCoauthManager"),Q.Sa("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").singleInstance()}static main(){m.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&K.a.instance.Fc(new Ek)}}Object(e.a)(Ek,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var nd;(function(Q){Q[Q.graphSpaceReplicatorNotSendingContent=
0]="graphSpaceReplicatorNotSendingContent";Q[Q.inboundRequestTakesTooLongToSendAfterRTC=1]="inboundRequestTakesTooLongToSendAfterRTC";Q[Q.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(nd||(nd={}));Object(e.b)("ComponentLoggingScenario",nd);var Sm=c(1439);class oo{flush(Q,za){const fb=this.BSl(Q);fb.LoggingScenario=nd[za];Jc.a(fb).length?ra.ULS.sendTraceTag(594571986,3013,15,"{0}",fb):ra.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",
Sm.a[Q.TZa])}BSl(Q){const za={};if(!Q)return za;const fb=new fc.a;for(fb.enqueue(Q);!fb.isEmpty;){Q=fb.dequeue();const Nb=Sm.a[Q.TZa];try{za[Nb]=Q.nA()}catch(tc){ra.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Nb.toString(),{["Kind"]:"Exception",["Stack"]:tc.stack,["Message"]:tc.message,["FileName"]:tc.fileName,["LineNumber"]:tc.lineNumber})}if((Q=Q.TEd)&&Q.length)for(const tc of Q)!tc||Sm.a[tc.TZa]in za||fb.enqueue(tc)}return za}}
Object(e.a)(oo,"ComponentStateLogManager",null,[1788]);class qp{flush(){}}Object(e.a)(qp,"NoOpComponentStateLogManager",null,[1788]);class Jl{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve("Common.IComponentStateLogManager")}dispose(){}xc(Q){this.W=Q;m.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?Q.ha("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new oo).as("Common.IComponentStateLogManager").singleInstance():
Q.ha("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new qp).as("Common.IComponentStateLogManager").singleInstance()}static main(){K.a.instance.Fc(new Jl)}}Object(e.a)(Jl,"WordEditorComponentStateLoggingPackage",null,[1,2]);var ln=c(2012);class Co{constructor(Q,za,fb){this.Wf=Q;this.Gud=za;this.wbh=fb}sj(Q,za,fb,Nb,tc,bd,Yd,Fd,De,Nf=null,Je=!1,va=null,Oa=null,Ba=null,wa=null,Ua=!1){return this.wbh?this.Gud.sj(Q,za,fb,Nb,tc,bd,Yd,Fd,De,Nf,Je,Oa,Ba):this.Wf.sj(Q,za,fb,Nb,tc,bd,Yd,
Fd,De,Nf,Je,va,Oa,Ba,wa,Ua)}k8b(Q){return this.wbh?this.Gud.k8b():this.Wf.k8b(Q)}}Object(e.a)(Co,"ClientRequestAdapter",null,[929]);var bn=c(229),gm=c(251),Do=c(219),Km=c(1388),Aj=c(311),Tj=c(1399),Sh=c(2013),Ui=c(51),tn=c(724),kg=c(590),tj=c(109),Kl=c(568),Hf=c(603),ka;(function(Q){Q[Q.none=0]="none";Q[Q.getCells=1]="getCells";Q[Q.hotStoreStatus=2]="hotStoreStatus";Q[Q.saveMonitor=3]="saveMonitor";Q[Q.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";Q[Q.kickoutExecutor=5]="kickoutExecutor"})(ka||
(ka={}));Object(e.b)("MostRecentRevisionIdOrigin",ka);class Va extends Sys.EventArgs{constructor(Q,za,fb,Nb){super();this.KWc=Q;this.httpStatusCode=fb;this.QH=Nb}}Object(e.a)(Va,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class vb{constructor(){this.N6=0}get isEmpty(){return!this.N6}vDc(Q){this.N6|=Q}qVc(Q){return!!(this.N6&Q)}clear(){this.N6=0}zFc(){return!1}}Object(e.a)(vb,"DocxSaveMonitorRetryAttemptOnce",null,[]);class Wb{constructor(Q,za=3){this.N6=0;this.Wsd=new Map;this.J$j=Q;this.wgk=
za}get isEmpty(){return!this.N6}vDc(Q){this.N6|=Q;let za=this.Wsd.get(Q)||0;this.Wsd.set(Q,++za)}qVc(Q){return!!(this.N6&Q)}clear(){this.N6=0;this.Wsd.clear()}zFc(Q){return this.wgk&Q?(this.Wsd.get(Q)||0)<this.J$j:!1}}Object(e.a)(Wb,"DocxSaveMonitorRetryAttemptMany",null,[]);class nc{static create(Q=!1,za=3,fb=0){return Q?new Wb(za,fb):new vb}}Object(e.a)(nc,"DocxSaveMonitorRetryAttemptFactory",null,[]);var Qc=c(1699),Hd;(function(Q){Q[Q.khp=-1]="noResultYet";Q[Q.pmp=0]="upToDate";Q[Q.Wjp=1]="sessionLost";
Q[Q.vmp=2]="userSignedOut";Q[Q.Jip=3]="previousRequestPending";Q[Q.Gde=4]="requestFailed";Q[Q.qkp=5]="shuttingDown";Q[Q.php=6]="nullResponseData";Q[Q.xfp=7]="invalidResponseData";Q[Q.ydp=8]="failedRevisionLookup";Q[Q.Bjp=9]="savedWithinThreshold";Q[Q.mhp=10]="notSavedWarning";Q[Q.Qfp=11]="kickoutThreshold";Q[Q.$lp=12]="unknownRevision";Q[Q.ybp=13]="contentNotYetLoaded";Q[Q.sessionExpired=14]="sessionExpired";Q[Q.canaryError=15]="canaryError";Q[Q.timeout=16]="timeout";Q[Q.Rfp=17]="kickoutThreshold_Offline";
Q[Q.Bcp=18]="dssSessionDeleted";Q[Q.Ccp=19]="dssSessionExpired";Q[Q.Bmp=20]="waitingForSessionTokenRefresh";Q[Q.Dcp=21]="dssSessionNotFound"})(Hd||(Hd={}));Object(e.b)("SaveMonitorResult",Hd);class xd{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd,De,Nf,Je,va,Oa,Ba,wa,Ua,zb,Qb,Xb,Dc,Fc,Zc,kd,rd,Cd,we=null,se){this.axc=0;this.UVb=!1;this.Gzc=null;this.Jvc=this.IN=-1;this.QNe=null;this.vrd=0;this.wrd=!1;this.Evb=null;this.Ixc=0;this.AQe=this.xih=null;this.kS=this.M3g=this.Nrc=0;this.cIe=null;this.U0g=!1;this.il=
null;this.Hud=0;this.lwd=void 0;this.wfh=!1;this.Wch=0;this.zfh=this.Bfh=!1;this.JCl=()=>{var Dd;ra.ULS.sendTraceTag(524871194,xd.Pm,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.aR,["AppVisibilityState"]:Km.a[null===(Dd=this.il)||void 0===Dd?void 0:Dd.gB]});try{if(this.wfh&&this.ltc){var le=this.ltc();ra.ULS.sendTraceTag(509367249,xd.Pm,50,"Additional Details: {0}",le)}}catch(Ne){Dd=Ya.c({["Kind"]:"Exception",["Stack"]:Ne.stack,["Message"]:Ne.message,["FileName"]:Ne.fileName,["LineNumber"]:Ne.lineNumber}),
ra.ULS.sendTraceTag(509367062,xd.Pm,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Dd)}Dd=this.Lub;this.Lub=this.Jz();if(this.I$())this.Rz.event(5),this.stop("session has shut down");else if(this.rab===xd.Edj&&this.dza(this.$sb),le=this.ttc())if(this.tGe()&&m.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),this.aR)this.Rz.event(0);else if(this.YVb())this.Rz.event(1),this.stop("session is lost"),
m.AFrameworkApplication.ue("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.U0g&&!this.oLm()&&(ra.ULS.sendTraceTag(554726995,xd.Pm,10,"DocxSaveMonitor: Session lost but not kicked out"),this.VC(Ui.a.dTh));else if(this.tGe())20!==this.Rz.currentState?(this.Rz.event(20),this.xih=this.Jz(),ra.ULS.sendTraceTag(593510691,xd.Pm,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.yih)):this.Jz().getTime()-this.xih.getTime()>this.yih&&
(this.Rz.event(14),this.h0d(20,Ui.a.hJd,"TokenExpired"));else if(this.J8j())if(this.Lub=Dd,this.UVb)this.Rz.event(3),this.Jz().getTime()-this.Gzc.getTime()>this.nHe&&(Dd=this.eve.k8b(this.IN),ra.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.IN,jn.a[Dd]),this.Isd&&this.Isd.log(),this.stop("stuck on previousRequestPending"),this.VC());else if(Dd=kg.b(Qc.a.construct(le)),this.UVb=!0,this.Gzc=this.ggk(),this.IN=this.eve.sj(xd.serviceUrl,
2,Dd,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.hVk,this.gVk,null,void 0,void 0,this.jfk,this.fRe,void 0,void 0,!0),0>=this.IN)this.UVb=!1,ra.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.IN.toString());else{Dd=this.eve.k8b(this.IN);le=100;if(Dd&&1!==Dd||this.qZg)le=50;ra.ULS.sendTraceTag(19161612,xd.Pm,le,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.IN,["Status"]:jn.a[Dd]});this.Isd&&this.Isd.start(this.IN)}else this.Rz.event(2);
else this.Rz.event(13)};this.gVk=Dd=>{this.kS=this.bFd+1;let le=this.UVb=!1,Ne=!1;Dd=Dd.data;Aa.a.el&&m.AFrameworkApplication.Aha("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");Dd?(ra.ULS.sendTraceTag(22552773,xd.Pm,15,"Request failed {0}",{["Status"]:Dd.status,["HttpStatus"]:Dd.Qe,["Correlation"]:Dd.vj?Dd.vj[Aj.a.F7]:"",["Id"]:Dd.id,["ConsecutiveErrors"]:this.bFd,["Request.InvokedTime"]:Dd.IH,["Request.EnqueueTime"]:Dd.dOa,["Request.CompletedTime"]:Dd.oT}),Ne=7===Dd.status||
13===Dd.status,this.zFc(2)&&Ne?(this.lVa.vDc(2),le=!0,this.Jvc=Dd.Qe,this.Rz.event(16)):this.zFc(1)&&5===Dd.status?(this.lVa.vDc(1),le=!0,this.Jvc=Dd.Qe,this.Rz.event(15)):(this.Rz.event(4),this.Jvc=Dd.Qe)):(this.Rz.event(4),ra.ULS.sendTraceTag(23425240,xd.Pm,15,"RequestFailed and event data is null"));if(!le&&(this.lVa.clear(),Ne?this.h0d(17,Ui.a.Cpl,"while offline"):this.h0d(11,Ui.a.Fff,"while online")))return;this.dza(le?this.MLl(Ne):this.$sb)};this.hVk=Dd=>{this.kS=this.bFd+1;this.UVb=!1;var le=
{};this.lVa.clear();if(Dd=Dd.data){var Ne=Dd.vj?Dd.vj[Aj.a.F7]:"";le.HttpStatus=Dd.Qe;le.Correlation=Ne;le.Id=Dd.id;ra.ULS.sendTraceTag(23425242,xd.Pm,this.qZg?50:100,"Request succeeded at the HTTP level {0}",le);this.Jvc=Dd.Qe}else ra.ULS.sendTraceTag(23425241,xd.Pm,15,"Request succeeded with null response data");if(this.I$()||!this.iJd)this.Rz.event(5),this.stop("session has shut down");else if(!this.qQm())if(Dd&&Dd.xe)if(Dd=this.Mua(Dd.xe))if(this.w2.dUa(Dd),Dd.StatusCode)this.hVm(Dd,le)||this.Rz.event(8,
le);else{this.kS=0;this.Lub=this.Jz();this.GPe.clear();le={["LastSavedRevisionId"]:Dd.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:Dd.RevisionSequenceNumber};Dd=tj.b(Dd.LastSavedRevisionId);this.WNb(Dd,3);var qe=this.Bof().store.getRevision(Dd);if(qe){Dd=null;Ne=this.ohb();qe=(qe=qe.J0a(Ne))?qe.id:fh.a.nil;let Pf=Ne;for(;Pf&&!Pf.id.equals(qe);)Dd=Pf,Pf=Pf.im;this.zmm(Dd,le,Ne)||this.Rz.event(9)}else this.ilm()||this.Rz.event(12,le);this.dza(this.wZb)&&ra.ULS.sendTraceTag(22552774,xd.Pm,
50,"Received response from server -- going back to normal interval")}else this.Rz.event(7),this.NHf("invalid response",le);else this.Rz.event(6),this.NHf("null response",le)};this.x5n=(Dd,le)=>{Dd={};Dd.DocxSaveMonitorState=Hd[le.newState];Dd.PreviousState=Hd[le.A_f];Dd.PreviousStateHits=le.B_f;Dd.PreviousStateTransitionTime=le.C_f.toISOString();Dd.LastHttpStatus=this.Jvc;Dd.LastSuccessTime=this.Lub.toISOString();this.Gzc&&(Dd.LastRequestStartTime=this.Gzc.toISOString());Dd.LastSavedRevisionID=this.l4d.toString();
Dd.LastSavedRevisionIdOrigin=this.axc;Dd.LastSavedRevisionIdSetTime=this.AQe?this.AQe.toISOString():null;Dd.IsViable=this.af.Swa;Dd.IsNetworkConnected=this.af.KH;Dd.IsExpired=this.af.Rba;Dd.HasEmergencyViewModeBeenDeployed=this.af.wj;Dd["Navigator.Online"]=window.navigator.onLine;const Ne=le.zAo;Ne&&xd.eNi(Dd,Ne);le=le.newState;switch(le){case 13:ra.ULS.sendTraceTag(5830086,xd.Pm,50,"{0}",Dd);break;case 1:ra.ULS.sendTraceTag(5884125,xd.Pm,50,"{0}",Dd);break;case 0:ra.ULS.sendTraceTag(5830087,xd.Pm,
50,"{0}",Dd);break;case 2:ra.ULS.sendTraceTag(5830088,xd.Pm,50,"{0}",Dd);break;case 3:ra.ULS.sendTraceTag(5830089,xd.Pm,50,"{0}",Dd);break;case 4:ra.ULS.sendTraceTag(5884126,xd.Pm,50,"{0}",Dd);break;case 5:ra.ULS.sendTraceTag(5884127,xd.Pm,50,"{0}",Dd);break;case 6:ra.ULS.shipAssertTag(5830090,xd.Pm,!1,"{0}",Dd);break;case 7:ra.ULS.shipAssertTag(5830091,xd.Pm,!1,"{0}",Dd);break;case 8:ra.ULS.sendTraceTag(5830092,xd.Pm,15,"{0}",Dd);break;case 10:ra.ULS.sendTraceTag(5830094,xd.Pm,15,"{0}",Dd);break;
case 9:ra.ULS.sendTraceTag(5884128,xd.Pm,50,"{0}",Dd);break;case 11:ra.ULS.sendTraceTag(5830096,xd.Pm,15,"{0}",Dd);break;case 17:ra.ULS.sendTraceTag(37835678,xd.Pm,15,"{0}",Dd);break;case 12:ra.ULS.sendTraceTag(5830095,xd.Pm,15,"{0}",Dd);break;case 18:ra.ULS.sendTraceTag(38122832,xd.Pm,15,"{0}",Dd);break;case 19:ra.ULS.sendTraceTag(38122833,xd.Pm,15,"{0}",Dd);break;case 21:ra.ULS.sendTraceTag(0,xd.Pm,15,"{0}",Dd);break;case 14:ra.ULS.sendTraceTag(6575508,xd.Pm,15,"{0}",Dd);break;case 15:ra.ULS.sendTraceTag(36739287,
xd.Pm,50,"{0}",Dd);break;case 16:ra.ULS.sendTraceTag(36767649,xd.Pm,15,"{0}",Dd);break;case 20:ra.ULS.sendTraceTag(593510690,xd.Pm,15,"{0}",Dd);break;default:ra.ULS.shipAssertTag(5884129,xd.Pm,!1,"Bad state:{0} logInfo:{1}",le,Dd)}};this.wZb=Q;this.$sb=za;this.rab=Q;this.Skh=fb;this.rik=Nb;this.jfk=bd;this.fRe=Yd;this.dXb=Fd;this.pSg=De;this.eve=Nf;this.y6=Je;this.w2=va;this.ttc=Oa;this.J8j=Ba;this.YVb=wa;this.tGe=Ua;this.I$=zb;this.Jz=Qb;this.ggk=Xb;this.U0g=Cd;this.lVa=nc.create(se.isEnabled,se.maxRetries,
Zc.N6);this.GPe=new Hf.a;this.ltc=kd;this.Rz=new Tj.a(-1);this.af=we;this.Rz.q_e(this.x5n);this.Isd=Dc;this.Lub=Qb();this.qZg=Fc;this.LUj=se.isEnabled?null:Zc;this.Lrb=rd;this.yih=this.Skh;this.aKe=fh.a.nil;this.ra=new O.a;ua.a.instance.Sa("Common.App.VisibilityManagement.IVisibilityManager").execute(Dd=>{this.il=Dd;this.il.RMa((le,Ne)=>{this.DX(le,Ne)});this.aOe=Dd.gB});this.af&&this.af.TZe((Dd,le)=>{this.WJb(Dd,le)});this.nHe=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",
tc):tc;this.Wch=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",this.$sb):this.$sb;this.wfh=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldLogAdditionalInfoEachTick",!0):!0;this.Bfh=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldOnlyKickoutWhenVisible",!1):!1;this.zfh=m.AFrameworkApplication.K?
m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotKickoutFromDocxSaveMonitor",!1):!1;this.xgk=se}WJb(Q,za){ra.ULS.sendTraceTag(528577692,xd.Pm,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",Sh.a[za.XRf],Sh.a[za.tZc]);1!==za.tZc&&3!==za.tZc&&(ra.ULS.sendTraceTag(528566343,xd.Pm,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.lVa.qVc(1),this.lVa.qVc(2)),this.lVa.clear())}get iJd(){return this.Nrc}get l4d(){return this.aKe}get aR(){const Q=
!this.ohb()||this.l4d.equals(this.ohb().id);Q||ra.ULS.sendTraceTag(521413851,xd.Pm,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.ohb().id.toString(),this.l4d.toString());return Q}get Ixi(){return this.Jz().getTime()-this.Lub.getTime()>this.nHe}get bFd(){return this.kS}get TZa(){return 3}get TEd(){let Q=null;Za.App.ya&&Za.App.ya.gb&&Za.App.ya.gb.Uc&&(Q=Za.App.ya.gb.Uc.contentReplicator);return[Q,km.App.e1]}DX(Q,za){var fb,Nb,tc;Q={["VisibilityState"]:Km.a[this.il.gB],
["IsVisible"]:this.il.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.UVb,["KickoutIntervalElapsed"]:this.Ixi,["LastSuccessfulIterationTime"]:null!==(fb=this.Lub)&&void 0!==fb?fb:"null",["RequestStartTime"]:null!==(Nb=this.Gzc)&&void 0!==Nb?Nb:"null",["SkippedKickouts"]:this.Hud,["LastSkippedKickoutAt"]:null!==(tc=this.R3g)&&void 0!==tc?tc:"null"},["IsViable"]:this.af.Swa,["IsNetworkConnected"]:this.af.KH,["IsExpired"]:this.af.Rba,["HasEmergencyViewModeBeenDeployed"]:this.af.wj,["Navigator.Online"]:window.navigator.onLine};
ra.ULS.sendTraceTag(539874775,xd.Pm,50,Ya.c(Q));this.aOe!=this.il.gB&&(0==za.oldState||1==za.oldState||0!==za.newState&&1!==za.newState||this.dza(this.Wch),0===this.il.gB?(id.c(Ag.a.ZKk,void 0,void 0,void 0,void 0,void 0,Q),this.lwd&&id.b("AvgTimeSpentOutsideOfWord",Date.now()-this.lwd,1),this.lwd=void 0):0===this.aOe&&(id.c(Ag.a.$Kk,void 0,void 0,void 0,void 0,void 0,Q),this.lwd=Date.now()),this.aOe=this.il.gB)}start(){this.Nrc=this.pSg.ifb(this.JCl,this.rab)}dza(Q){if(!this.iJd||this.rab===Q)return!1;
const za=this.rab;this.rab=Q;this.stop("changing save monitor interval from "+za+"ms to "+Q+"ms");this.start();return!0}WNb(Q,za){if(za>=this.axc&&Q&&!fh.a.nil.equals(Q)){var fb=!this.aKe.equals(Q);this.axc=za;this.aKe=Q;const Nb=this.Jz();this.AQe=Nb;const tc=this.aR;fb&&(za={["Id"]:Q.toString(),["IsUpToDate"]:tc,["Origin"]:ka[za]},this.cIe&&(za.LastUpToDateTime=this.cIe.toISOString()),(fb=this.Bof())&&fb.store&&(Q=fb.store.getRevision(Q))&&(za.LastSavedCreationTime=Q.creationTime.toISOString()),
ra.ULS.sendTraceTag(557320151,xd.Pm,50,"Updating Last Saved Revision: {0}",za));tc&&(this.cIe=Nb)}else za<this.axc?ra.ULS.sendTraceTag(572051800,xd.Pm,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.axc,za):ra.ULS.sendTraceTag(572051801,xd.Pm,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',za)}stop(Q){this.Ve(Q)}Ve(Q){this.iJd&&(ra.ULS.sendTraceTag(5830084,xd.Pm,50,"Stopping DocxSaveMonitor because {0}!",Q),this.pSg.Ve(this.iJd),this.Nrc=0)}ilm(){if(0>=this.dXb)return!1;
var Q=this.P3l();if(!Q)return this.QNe=null,this.vrd=0,this.wrd=!1;this.Evb=Q.gMd;this.Evb===this.QNe?this.vrd++:(this.QNe=this.Evb,this.vrd=1,this.wrd=!1);if(this.vrd<xd.Qbn)return!1;this.Ixc=+this.Jz()-+this.Evb;if(this.Ixc<=this.dXb)return!1;if(!this.wrd)return this.wrd=!0,this.q5i(),!1;if(this.Lrb)this.Lrb.execute(za=>{za.flush(this,0)});else{Q="";try{this.ltc&&(Q=this.ltc())}catch(za){Q=Ya.c({["Kind"]:"Exception",["Stack"]:za.stack,["Message"]:za.message,["FileName"]:za.fileName,["LineNumber"]:za.lineNumber}),
ra.ULS.sendTraceTag(50426817,xd.Pm,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Q)}ra.ULS.sendTraceTag(50426818,xd.Pm,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.Evb.toISOString(),this.Ixc,this.dXb,Q)}this.dXb=-1;this.stop("Exceeded oldest allowed local revision");this.VC(Ui.a.Dpl);return!0}P3l(){let Q=null,za=this.ohb();for(;za&&!za.Kwa;)Q=za,za=za.im;return Q}qQm(){return this.YVb()?
(this.Rz.event(1),this.stop("session is lost"),!0):this.tGe()?(this.Rz.event(14),ra.ULS.sendTraceTag(20029718,xd.Pm,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.VC(Ui.a.hJd),!0):!1}Bof(){const Q=this.ttc();return Q?Q.Kc:null}ohb(){const Q=this.Bof();return Q?Q.jm:null}zFc(Q){return this.xgk.isEnabled?this.lVa.zFc(Q):this.LUj.qVc(Q)&&!this.lVa.qVc(Q)}MLl(Q){return Q?xd.KHo:xd.Edj}h0d(Q,za,fb){if(this.Ixi)if(this.il&&!this.il.isVisible)ra.ULS.sendTraceTag(540669727,xd.Pm,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),
this.Hud+=1,this.R3g=this.Jz();else return this.Rz.event(Q,{}),this.stop("request failed after kickout interval "+fb),this.Lrb&&this.Lrb.execute(Nb=>{Nb.flush(this,2)}),this.VC(za),!0;return!1}hVm(Q,za){const fb=Q.StatusCode;return 88===fb||89===fb||236===fb?(za.KickoutDiagnostics=this.ltc(),88===fb?(za.Result="deleted DSS session",this.Rz.event(18,za),this.stop("deleted DSS session"),this.VC(Ui.a.localCobaltDeletedSessionFault)):89===fb?(za.Result="expired DSS session",this.Rz.event(19,za),this.stop("expired DSS session"),
this.VC(Ui.a.localCobaltExpiredSessionFault)):(m.AFrameworkApplication.Cn("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(Q=tj.b(Q.LastSavedRevisionId),this.WNb(Q,4)),za.Result="DSS session not found",this.Rz.event(21,za),this.stop("DSS session not found"),this.VC(Ui.a.localCobaltSessionNotFound)),!0):14===fb?(this.stop("DSS returned an unspecified failure"),
this.VC(Ui.a.ZZm),!0):104===fb?(this.stop("this operation is disabled on the server"),!0):this.NHf("unrecognized OperationResult: "+fb,za)}NHf(Q,za){if(!this.GPe.contains(Q))this.GPe.add(Q);else if(this.h0d(11,Ui.a.Fff,Q))return za.ConsecutiveErrors=this.bFd,za.Reason=Q,ra.ULS.sendTraceTag(41997899,xd.Pm,15,"DocxSaveMonitor kickout. {0}",za),!0;this.dza(this.$sb);return!1}zmm(Q,za,fb){let Nb=!1;if(Q){const tc=this.Jz().getTime()-Q.creationTime.getTime();tc>=this.Skh&&(Nb=!0,xd.eNi(za,this.A9l(Q,tc,
fb)),tc>=this.nHe&&10===this.Rz.currentState?(this.Rz.event(11,za),this.stop("didn't save in time"),this.VC()):(this.Rz.event(10,za),this.q5i(),this.vlf()))}return Nb}Uwk(Q){this.ra.addHandler(xd.v1i,Q)}vwk(Q){this.ra.addHandler(xd.Clf,Q)}iaj(Q){this.ra.removeHandler(xd.Clf,Q)}q5i(){this.ra.raiseEvent(xd.v1i)}Mua(Q){let za;return({group:za}=Kl.a.l1(Q)).returnValue?za.Responses[0]:null}A9l(Q,za,fb){const Nb={};Nb.FirstUnsavedRevisionId=Q.id.toString();Nb.FirstUnsavedRevisionLengthToRoot=Q.gR;Nb.UnsavedTimeInMs=
za;Nb.CurrentRevisionId=fb.id.toString();Nb.CurrentRevisionLengthToRoot=fb.gR;return Nb}vlf(){de.a.wlf(8)}VC(Q=Ui.a.Fff){this.rik?this.zfh?(ra.ULS.sendTraceTag(509146274,xd.Pm,15,"DocxSaveMonitor would have kicked out due to: {0}. Diagnostic Log: {1}.",Q,this.h7h()),0==this.Nrc&&this.start()):this.Bfh&&this.il&&!this.il.isVisible?(ra.ULS.sendTraceTag(509146273,xd.Pm,15,"DocxSaveMonitor did not kick out because the session is not visible. Error code: {0}. Diagnostic Log: {1}",Q,this.h7h()),0==this.Nrc&&
this.start()):(this.stop(xd.iVm),Q===Ui.a.hJd?this.y6.value.VC(Q,Object.assign(new tn.a,{nfa:4,RW:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,k3:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.y6.value.VC(Q,new tn.a)):ra.ULS.sendTraceTag(19247383,xd.Pm,50,"Kickout disabled")}h7h(){const Q={};var za=ua.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager");Q.HasDataloss=!za.aR;Q.UnSavedRevisionsCount=za.E7a;Q.OldestUnsavedRevisionCreationTime=za.aR?
"":za.NDb().toString();Q.RevisionsWithOutServerRevisionSequenceNumbers=za.n3b();Q.RevisionsWithServerRevisionSequenceNumbers=za.fGd();Q.RSNManager_Diagnostics=za.nA();if(za=ua.a.instance?ua.a.instance.Na("WordEditor.RunawayDataLossMonitor"):null)Q.RunawayDataLossMonitor_Diagnostics=za.hfj;Q.DocxSaveMonitor_Diagnostics=this.nA();(za=ua.a.instance?ua.a.instance.Na("WordEditor.ILastSavedToHostDetailsManager"):null)&&(Q.LastSavedToHostDetailsManager_Diagnostics=za.nA());this.il&&(Q.VisibilityState=Km.a[this.il.gB]);
return Q}nA(){const Q={};this.Evb&&(Q.ORT=this.Evb.toISOString());0<this.Ixc&&(Q.AA=this.Ixc);0<this.dXb&&(Q.MAA=this.dXb);0<this.Hud&&(Q.LSKO=this.R3g.toISOString());this.Rz&&0<=this.Rz.currentState&&(Q.SMS=Hd[this.Rz.currentState]);const za={};m.AFrameworkApplication.Aoa&&(za.S=1);Za.App.lostSession&&(za.LS=1);this.af&&(this.af.jo&&(za.KO=1),this.af.Rba&&(za.TE=1));this.il&&(za.VS=Km.a[this.il.gB]);window.navigator&&(za.NW=!window.navigator.onLine);Q.AMD=za;return Q}kXl(){const Q={"Content-Type":"application/json; charset=utf-8",
"X-Requested-With":"Fetch"};m.AFrameworkApplication.buildVersion&&(Q["X-OfficeVersion"]=Ra.a.TQ(m.AFrameworkApplication.buildVersion));m.AFrameworkApplication.accessToken&&(Q["X-AccessToken"]=Ra.a.TQ(m.AFrameworkApplication.accessToken),Q["X-AccessTokenTtl"]=m.AFrameworkApplication.GMa.toString());m.AFrameworkApplication.canary&&(Q["X-Key"]=Ra.a.TQ(m.AFrameworkApplication.canary));m.AFrameworkApplication.userType&&(Q["X-UserType"]=Ra.a.TQ(m.AFrameworkApplication.userType));const za=m.AFrameworkApplication.Ne.SY;
za&&(Q["X-WacCluster"]=Ra.a.TQ(za));m.AFrameworkApplication.userSessionId&&(Q["X-UserSessionId"]=Ra.a.TQ(m.AFrameworkApplication.userSessionId));return Q}cGl(){var Q=this.af?this.af.networkState:null;if(1===Q||3===Q)ra.ULS.sendTraceTag(558158790,xd.Pm,15,"Not sending request because we dont have network.");else if(Q=this.ttc()){var za=new Sys.Net.WebRequest;za.set_httpVerb("POST");za.set_url(xd.serviceUrl);var fb={};fb.body=kg.b(Qc.a.construct(Q));fb.headers=this.kXl();fb.method=za.get_httpVerb();
try{"function"===typeof window.fetch?window.fetch(za.getResolvedUrl(),fb).then(Nb=>{ra.ULS.sendTraceTag(561551382,xd.Pm,50,"Request succeeded at the HTTP level {0}",Nb.statusText);this.M3g=Nb.status;return Nb.json()},Nb=>{ra.ULS.sendTraceTag(561551383,xd.Pm,15,"Request failed at the HTTP level {0}",Nb);return null}).then(Nb=>{Nb=JSON.stringify(Nb);this.YUk(Nb,this.M3g);return Nb},()=>{ra.ULS.sendTraceTag(561551385,xd.Pm,15,"Request succeeded with null response data");return""}):ra.ULS.sendTraceTag(561002076,
xd.Pm,15,"Browser does not support Fetch.")}catch(Nb){ra.ULS.sendTraceTag(561551386,xd.Pm,15,String.format("Exception when attempting to get last revision save id : {0}",Nb))}}else ra.ULS.sendTraceTag(540079457,xd.Pm,15,"Target node is null, not sending last saved revision request.")}YUk(Q,za){let fb=fh.a.nil,Nb=!1,tc=-1;za===Qj.a.Hy&&((Q=this.Mua(Q))?(fb=tj.b(Q.LastSavedRevisionId),Q.StatusCode||(Nb=!0,tc=Q.StatusCode)):ra.ULS.sendTraceTag(561002077,xd.Pm,50,"Response is null when attempting to get last revision save id"));
this.ra.raiseEvent(xd.Clf,new Va(fb,Nb,za,tc))}static eNi(Q,za){for(const fb in za)Q[fb]=za[fb]}oLm(){return rh.SessionStatusManager.instance.jo}}xd.Edj=0;xd.serviceUrl=Za.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";xd.iVm="kickout";xd.v1i="PS";xd.Clf="FLSR";xd.Pm=343;xd.Qbn=5;xd.KHo=5E4;Object(e.a)(xd,"DocxSaveMonitor",null,[1791,144]);class Id{ifb(Q,za){return window.setInterval(Q,za)}Ve(Q){window.clearInterval(Q)}}Id.instance=new Id;Object(e.a)(Id,"DocxSaveMonitorTaskManager",
null,[1790]);class Ve{constructor(Q){this.IN=0;this.Zsa=Q}start(Q){this.Zsa&&(this.IN=Q,this.Zsa.reset())}log(){if(this.Zsa){var Q={};Q.RequstId=this.IN;Q.InvokeCount=this.Zsa.XSc;Q.InvokeFailedCount=this.Zsa.YSc;Q.NoOpenConnectionCount=this.Zsa.xZc;Q.SynchronousNotificationCount=this.Zsa.A9c;Q.ResponseNotAvailable=this.Zsa.V4c;ra.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",Q)}}}Object(e.a)(Ve,"RequestLifeCycleTelemetryManager",null,[1787]);class mf{constructor(){this.W=
this.wQe=null;this.kcl=()=>{var Q=m.AFrameworkApplication.K;if(!Q.$("DocxSaveMonitorEnabled"))return null;var za=Q.$("DocxSaveMonitorKickoutEnabled");const fb=Q.mc("DocxSaveMonitorIntervalMs",6E4),Nb=Q.mc("DocxSaveMonitorFailureIntervalMs",5E3),tc=Q.mc("DocxSaveMonitorWarningTimeMs",12E4),bd=Q.mc("DocxSaveMonitorKickoutTimeMs",36E4),Yd=Q.mc("DocxSaveMonitorQueueTimeoutMs",6E4),Fd=Q.mc("DocxSaveMonitorSentTimeoutMs",12E4),De=Q.mc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var Nf=Q.$("DocxSaveMonitorTelemetryInfoEnabled");
const Je=Q.$("DocxSaveMonitorInfoRequestLoggingEnabled");var va=m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),Oa=Q.$("DocxSaveMonitorRawWebRequestsEnabled")||va;va=Q.$("ComponentStateLoggingPackageIsEnabled");Q=Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);var Ba=m.AFrameworkApplication.Ne,wa=Oa?new ln.a(m.AFrameworkApplication.userSessionId,Ba.SY,Ba.iPh):
null;wa=new Co(Ba,wa,Oa);Nf=Nf&&Ba&&!Oa?new Ve(Ba.lda):null;Oa=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;Ba=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const Ua=nc.create(Oa,Ba);Ua.vDc(1);Ua.vDc(2);va=va?this.W.Sa("Common.IComponentStateLogManager"):null;za=new xd(fb,Nb,tc,za,bd,Yd,Fd,
De,Id.instance,wa,ua.a.instance.Ue("Box4.IKickoutExecutor"),gm.a.instance,this.D8b,()=>!m.AFrameworkApplication.U4d||zj.a.instance.eTc,()=>Za.App.lostSession,Object(a.a)(bn.a.instance,bn.a.instance.KCa,"checkAndTriggerSessionHasExpired"),()=>m.AFrameworkApplication.Lk,()=>new Date,()=>new Date,Nf,Je,Ua,this.RJl,va,Q,ua.a.instance.Na("Common.ISessionStatus")||rh.SessionStatusManager.instance,{isEnabled:Oa,maxRetries:Ba});za.start();ra.ULS.sendTraceTag(5884131,xd.Pm,50,"SaveMonitor initialized");return za};
this.D8b=()=>{const Q=Za.App.ya.gb.wc;return Q?Q.ed:null};this.RJl=()=>{const Q={};m.AFrameworkApplication.nc&&(Q.TM=m.AFrameworkApplication.nc.nA());Do.WoncaApp.EF&&(Q.RS=Do.WoncaApp.EF.nA());km.App.e1&&(Q.CRS=km.App.e1.nA());Za.App.ya&&Za.App.ya.gb&&Za.App.ya.gb.Uc&&Za.App.ya.gb.Uc.contentReplicator&&(Q.GSR=Za.App.ya.gb.Uc.contentReplicator.nA());m.AFrameworkApplication.Aoa&&(Q.S=1);Za.App.lostSession&&(Q.LS=1);Za.App.rd&&Za.App.rd.OA.jo&&(Q.KO=1);Q.RVS=window.document.visibilityState;return Sys.Serialization.JavaScriptSerializer.serialize(Q)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(Za.App.es||
Za.App.um)this.wQe=this.W.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.wQe&&this.wQe.stop("WordEditorDocxSaveMonitorPackage is being disposed")}xc(Q){this.W=Q;(Za.App.es||Za.App.um)&&Q.ha("WordEditor.DocxSaveMonitor.DocxSaveMonitor",this.kcl).as("Wonca.IDocxSaveMonitor").singleInstance()}static main(){K.a.instance.Fc(new mf)}}Object(e.a)(mf,"WordEditorDocxSaveMonitorPackage",null,[1,2]);var fg=c(849);class Dg{constructor(Q,za){this.jn=Q;this.b$n=Object(fg.c)(za)}async loadChunk(Q){return this.jn.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk(Q):(await this.b$n).Kz.loadScript(Q)}}Object(e.a)(Dg,"WordOnlineChunksLoader",null,[]);class Zf{constructor(){this.name="WordEditor.EditorAi.Entry"}xc(Q){Q.ha("WordEditor.EditorAi.WordOnlineChunksLoader",()=>new Dg(m.AFrameworkApplication.K,Q.Sa("Common.IDynamicScriptLoaderProvider")))}init(){}dispose(){}static main(){K.a.instance.Fc(new Zf)}}Object(e.a)(Zf,"EditorAiEntryPackage",null,[1,2]);var Ci=c(979);class og{constructor(Q,za,fb,Nb,tc,bd,Yd){this.gJd=Q;this.Ioi=za;
this.Itm=fb;this.eXf=Nb;this.NJc=tc;this.pc=bd;this.vK=Yd;this.fsn=(Fd,De,Nf)=>{switch(Nf){case 1:if(!Object(fg.d)(De)||!this.pJ)return 8;this.NJc.huj();break;case 2:this.NJc.y5e?this.Cqj():this.Mob()}return 32};this.ion=(Fd,De,Nf)=>{2===Nf&&this.eXf.Ctl().catch(Je=>{ra.ULS.fE(508965832,3041,10,Je,"Failed to initialize Copilot integration package")});return 32};this.pXi=(Fd,De)=>{De.JY&&(Object(id.a)("AiMakerInitializationTriggered"),this.gJd.Kca(this.pXi),this.gJd.Md(),this.NJc.huj(),this.vK.Dk(19,
()=>{this.NJc.y5e&&this.Cqj()}))};this.ltn=async(Fd,De)=>{De.JY&&this.Itm.execute(Nf=>{Nf.findImageAndRegisterHandler()})};this.pJ=km.App.Toe.pJ}initialize(){this.gJd.a3(this.pXi);this.gJd.initialize();this.Ioi.a3(this.ltn);this.Ioi.initialize();this.pc.fb(Ag.a.PFd,Ei.a.view,this.fsn,4);this.pc.fb(Ag.a.FFi,Ei.a.application,this.ion,1028)}Cqj(){this.NJc.show().catch(Q=>{ra.ULS.fE(508965831,3041,10,Q,"Failed to show document wizard")})}Mob(){(new Ci.a).p8d(0)}}Object(e.a)(og,"AiMakerInitializer",null,
[]);var cl=c(1719),ik=c(931);class uj extends ik.a{constructor(Q){var za;super("BooleanFeatureGateConditionId");this.Hn=Q.Hn;this.k0a=Q.k0a;this.defaultValue=null!==(za=Q.defaultValue)&&void 0!==za?za:!1}initialize(){super.initialize();const Q=m.AFrameworkApplication.K;Q.No(()=>{const za=Q.getBooleanFeatureGate(this.k0a,this.defaultValue);this.Rg(za)})}Rg(Q){super.Rg(Q);ra.ULS.sendTraceTag(512369937,3028,50,this.tT(this.Hn,Q,`featureGate=${this.k0a}`))}}Object(e.a)(uj,"BooleanFeatureGateCondition",
ik.a,[]);var ti=c(696);class Yo extends ik.a{constructor(Q){super(Q.MGh);this.b7f=Q}initialize(){super.initialize();m.AFrameworkApplication.K.No(()=>{var Q,za,fb,Nb,tc;const bd=null!==(za=null===(Q=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===Q?void 0:Q.WACDatacenter)&&void 0!==za?za:"unknown";Q=null!==(Nb=null===(fb=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===fb?void 0:fb.Ring)&&void 0!==Nb?Nb:"unknown";fb=null===(tc=m.AFrameworkApplication.sessionStartInfoSettings)||
void 0===tc?void 0:tc.Host;tc=this.sBf(bd,Q,fb);this.Rg(tc);ra.ULS.sendTraceTag(509747520,3028,50,this.tT(this.b7f.Hn,tc,`datacenter=${bd}`))})}sBf(Q,za,fb){if("1"===za||"unknown"===Q||this.b7f.aXh.includes(fb))return!0;const Nb=Q.toUpperCase();return!this.b7f.JRh.some(tc=>Nb.includes(tc))}}Object(e.a)(Yo,"EditorAiDatacenterCondition",ik.a,[]);class wh extends ik.a{constructor(Q,za,fb){super("AiMakerConsentGroupConditionId");this.Hn=Q;this.bfa=za;this.defaultValue=fb}initialize(){super.initialize();
this.bfa.execute(Q=>{var za;Q.isFeatureEnabled("AiMaker",null!==(za=this.defaultValue)&&void 0!==za?za:!1).then(fb=>{this.Rg(fb);return null})})}Rg(Q){super.Rg(Q);ra.ULS.sendTraceTag(509752010,3028,50,this.tT(this.Hn,Q))}}Object(e.a)(wh,"AiMakerConsentGroupCondition",ik.a,[]);class cn extends ik.a{constructor(Q){super("RegionComposerEnabledConditionId");this.Hn=Q.Hn}initialize(){super.initialize();this.Rg(km.App.Toe.pJ)}Rg(Q){super.Rg(Q);ra.ULS.sendTraceTag(508965830,3028,50,this.tT(this.Hn,Q))}}
Object(e.a)(cn,"RegionComposerEnabledCondition",ik.a,[]);const Tm="CH DE FR EU UK NO SE NL PIE".split(" ");class nl extends ti.a{constructor(Q,za,fb){const Nb=new uj({Hn:16,k0a:"Microsoft.Office.WordOnline.IsAiMakerEnabled"});Q=new cl.a(16,Q,za,{sNb:!0,TO:!1,R9b:!1,Q9b:!1,QO:!1});za=new Yo({MGh:"AiMakerDocumentWizardDatacenterConditionId",Hn:16,JRh:Tm,aXh:["Exchange Online Consumer","OneDriveWOPI"]});fb=new wh(16,fb);const tc=new cn({Hn:16});super(16,new ib.a([Nb,Q,za,fb,tc]),null,3028,"AiMakerDocumentWizardTriggered")}}
Object(e.a)(nl,"AiMakerDocumentWizardTriggerModel",ti.a,[]);var Um=c(932);class ak extends ik.a{constructor(Q){super("AiImageInsertedConditionId");this.M5e=Q;this.isInitialized=!1;this.QRi=()=>{this.Rg(!0)}}initialize(){this.isInitialized||(super.initialize(),this.isInitialized=!0,this.M5e.execute(Q=>{var za;null===(za=Q.add_onImageWasInsertedHandler)||void 0===za?void 0:za.call(Q,this.QRi)}))}Md(){this.isInitialized&&(this.M5e.execute(Q=>{var za;null===(za=Q.remove_onImageWasInsertedHandler)||void 0===
za?void 0:za.call(Q,this.QRi)}),this.isInitialized=!1,super.Md())}}Object(e.a)(ak,"AiImageInsertedCondition",ik.a,[]);class Vl extends ti.a{constructor(Q){const za=new uj({Hn:19,k0a:"Microsoft.Office.WordOnline.IsAiImageRemakeEnabled"}),fb=new ak(Q);super(19,new ib.a([za,fb]),null,3028,"OnTriggerAiImageRemakeEventKey");this.M5e=Q;this.Zpi=!1;this.Urk()}G1a(Q){super.G1a(Q);super.$zd()&&super.dib("AiImageInsertedConditionId");"AiImageInsertedConditionId"!==Q||this.Zpi||(this.jYn(),this.Zpi=!0)}Urk(){m.AFrameworkApplication.va.fb(Ag.a.QFd,
Ei.a.view,()=>8,1028)}jYn(){m.AFrameworkApplication.va.Lv(Ag.a.QFd,Ei.a.view,()=>8)}}Object(e.a)(Vl,"AiImageRemakeTriggerModel",ti.a,[]);class sk{constructor(Q){this.mon=Q;this.wnn=async()=>{const za=await this.mon();await this.gSc(za);return za};this.vwn=K.a.instance;this.Fxm=new hb.a(this.wnn)}async uCb(){return await this.Fxm.value}async gSc(Q){K.a.instance.Fc(Q);return new Promise(za=>{this.vwn.registerOnPackageInit(Q.name,za)})}}Object(e.a)(sk,"LazyLoadedPackage",null,[]);class po{constructor(){this.bTh=
new sk(()=>Promise.all([c.e(2),c.e(5),c.e(11)]).then(c.bind(null,2032)).then(Q=>Q.instance));this.a6k=new sk(()=>Promise.all([c.e(2),c.e(5),c.e(27)]).then(c.bind(null,2039)).then(Q=>Q.instance))}async Etl(){await this.bTh.uCb()}async Ctl(){await this.bTh.uCb();await this.a6k.uCb()}}Object(e.a)(po,"AiMakerPackageManager",null,[]);var Hp=c(290),Bm={get ypl(){var Q=null===aiMakerDocumentWizardUx||void 0===aiMakerDocumentWizardUx?void 0:aiMakerDocumentWizardUx.interop;if(!Q)throw Error("aiMakerDocumentWizardUx chunk is accessed before loading");
return Q}};class jk{constructor(Q){this.container=Q}getDocumentContentGenerator(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentContentGenerator")}getCanvasService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService")}getFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardFocusManager")}getDocumentLayoutHtmlHelper(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentLayoutHtmlHelper")}getTelemetryLogger(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerTelemetryLogger")}getSurveysManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardSurveysManager")}getStylesService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerStylesService")}getImageRemakeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService")}getImageRemakeSizeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeSizeService")}getImageRemakeFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeFocusManager")}getPromptSuggestionProvider(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerPromptSuggestionProvider")}getController(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController")}getResumeBioInfoEnricher(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerResumeBioInfoEnricher")}}
Object(e.a)(jk,"AiMakerDocumentWizardDependenciesImpl",null,[]);class dp{constructor(Q,za,fb,Nb,tc){this.t2o=Q;this.eXf=za;this.Gk=fb;this.wc=Nb;this.u1o=tc;this.Wxi=!1;this.xnn=async()=>{this.Wxi=!0;await Promise.all([this.eXf.Etl(),this.t2o.loadChunk("aiMakerDocumentWizardUx")]);return Bm.ypl};this.WHj=new hb.a(this.xnn)}get y5e(){return this.Gk.Jta(this.wc.ed,{TO:!1,Hba:!1,Vna:!1,QO:!1})}huj(){this.Wxi||this.WHj.value.catch(Q=>{ra.ULS.fE(508965829,3041,10,Q,"Failed to load document wizard UX interop")})}async show(){const Q=
await this.WHj.value;this.y5e?(this.csh||(this.csh=this.Fcn(Q)),this.csh.open()):ra.ULS.sendTraceTag(508965828,3041,50,"Document wizard show attempt prevented")}Fcn(Q){const za=this.mountApp(Q);return za?za:new Mi(this.u1o,()=>this.mountApp(Q))}mountApp(Q){const za=Object(Hp.a)("EditorContainer");return Q.mountApp(za,new jk(ua.a.instance))}}Object(e.a)(dp,"AiMakerDocumentWizardUx",null,[]);class Mi{constructor(Q,za){this.controller=Q;this.Mon=za;this.isOpen=!0}get isOpen(){return this.controller.isOpen}set isOpen(Q){this.controller.isOpen=
Q}open(){this.isOpen||(this.isOpen=!0,this.Mon())}close(){this.isOpen=!1}}Object(e.a)(Mi,"AiMakerDocumentWizardCompatAppRef",null,[]);class Cq{constructor(){this.isOpen=!1}}Object(e.a)(Cq,"AiMakerDocumentWizardControllerImpl",null,[]);class un extends Um.a{get name(){return"WordEditor.AiMaker.Entry"}Qfa(Q){this.container=Q;Q.ha("WordEditor.AiMaker.AiMakerPackageManager",()=>new po).singleInstance();Q.ha("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController",()=>new Cq).singleInstance();
Q.ha("WordEditor.AiMaker.AiMakerDocumentWizardUx",()=>new dp(Q.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"),Q.resolve("WordEditor.AiMaker.AiMakerPackageManager"),Q.resolve("Box4.IParagraphReader"),Za.App.ya.gb.wc,Q.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController"))).singleInstance()}Sfa(){(new og(new nl(this.container.resolve("Box4.IParagraphReader"),Za.App.ya.gb.wc,this.container.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),new Vl(this.container.Sa("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService")),
this.container.Sa("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService"),this.container.resolve("WordEditor.AiMaker.AiMakerPackageManager"),this.container.resolve("WordEditor.AiMaker.AiMakerDocumentWizardUx"),m.AFrameworkApplication.va,Gb.a.get_instance())).initialize()}Rfa(){}static main(){K.a.instance.Fc(new un)}}Object(e.a)(un,"AiMakerEntryPackage",Um.a,[]);var Bl={get interop(){var Q=aiInserterUx.interop;if(!Q)throw Error("aiInserterUx chunk is accessed before loading");return Q}};class nt{constructor(Q,
za){this.S8d=Q;this.N5c=za;this.zGa=async(fb,Nb)=>{Nb.JY&&(Object(id.a)("AiInserterInitializationTriggered"),this.S8d.Kca(this.zGa),this.S8d.Md(),[,fb]=await Promise.all([this.TZm(),Promise.all([c.e(2),c.e(5),c.e(17)]).then(c.bind(null,2033))]),fb.main(Bl.interop))}}initialize(){this.S8d.a3(this.zGa);this.S8d.initialize()}async TZm(){return m.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiInserterUx"):(await Object(fg.c)(this.N5c)).Kz.loadScript("aiInserterUx")}}
Object(e.a)(nt,"AiInserterInitializer",null,[]);class ws extends ik.a{constructor(Q,za){super("AiInserterConsentGroupConditionId");this.bfa=Q;this.defaultValue=za}initialize(){super.initialize();this.bfa.execute(Q=>{Q.isFeatureEnabled("AiInserter",!!this.defaultValue).then(za=>{this.Rg(za);return null})})}Rg(Q){super.Rg(Q)}}Object(e.a)(ws,"AiInserterConsentGroupCondition",ik.a,[]);const Mr="CH DE FR EU UK NO SE NL PIE".split(" ");class Zp extends ik.a{constructor(){super("AiInserterDatacenterConditionId")}initialize(){super.initialize();
m.AFrameworkApplication.K.No(()=>{var Q,za,fb,Nb;const tc=null!==(za=null===(Q=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===Q?void 0:Q.WACDatacenter)&&void 0!==za?za:"unknown";Q=null!==(Nb=null===(fb=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===fb?void 0:fb.Ring)&&void 0!==Nb?Nb:"unknown";fb=this.sBf(tc,Q);this.Rg(fb)})}sBf(Q,za){if("1"===za||"unknown"===Q)return!0;const fb=Q.toUpperCase();return!Mr.some(Nb=>fb.includes(Nb))}}Object(e.a)(Zp,"AiInserterDatacenterCondition",
ik.a,[]);class kq extends ti.a{constructor(Q){const za=new uj({Hn:17,k0a:"Microsoft.Office.WordOnline.IsAiInserterEnabled"});Q=new ws(Q);const fb=new Zp;super(17,new ib.a([za,Q,fb]),null,3028,"AiInserterAppTriggered")}}Object(e.a)(kq,"AiInserterTriggerModel",ti.a,[]);class xs extends Um.a{get name(){return"WordEditor.AiInserter.Entry"}Qfa(Q){this.container=Q}Sfa(){(new nt(new kq(this.container.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),this.container.Sa("Common.IDynamicScriptLoaderProvider"))).initialize()}Rfa(){}static main(){K.a.instance.Fc(new xs)}}
Object(e.a)(xs,"AiInserterEntryPackage",Um.a,[]);const lm="CH DE FR EU UK NO SE NL PIE".split(" ");class Ak extends ti.a{constructor(){const Q=new uj({Hn:18,k0a:"Microsoft.Office.WordOnline.IsAiRewriteEnabled"}),za=new Yo({MGh:"AiRewriteDatacenterConditionId",Hn:18,JRh:lm,aXh:["Exchange Online Consumer","OneDriveWOPI"]});super(18,new ib.a([Q,za]),null,3028,"AiRewriteTriggered")}}Object(e.a)(Ak,"AiRewriteTriggerModel",ti.a,[]);var Xi={get interop(){var Q=null===aiRewriteUx||void 0===aiRewriteUx?void 0:
aiRewriteUx.interop;if(!Q)throw Error("aiRewriteUx chunk is accessed before loading");return Q}};class Nj{constructor(Q,za){this.Yzd=Q;this.N5c=za;this.zGa=async(fb,Nb)=>{Nb.JY&&(Object(id.a)("AiRewriteInitializationTriggered"),this.Yzd.Kca(this.zGa),this.Yzd.Md(),[,fb]=await Promise.all([this.NYm(),Promise.all([c.e(2),c.e(5),c.e(12)]).then(c.bind(null,2035))]),fb.main(Xi.interop))}}initialize(){this.Yzd.a3(this.zGa);this.Yzd.initialize()}async NYm(){return m.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("aiRewriteUx"):(await Object(fg.c)(this.N5c)).Kz.loadScript("aiRewriteUx")}}Object(e.a)(Nj,"AiRewriteInitializer",null,[]);class Ii extends Um.a{get name(){return"WordEditor.AiRewrite.Entry"}Qfa(Q){this.container=Q}Sfa(){(new Nj(new Ak,this.container.Sa("Common.IDynamicScriptLoaderProvider"))).initialize()}Rfa(){}static main(){K.a.instance.Fc(new Ii)}}Object(e.a)(Ii,"AiRewriteEntryPackage",Um.a,[]);var Dh;(function(Q){Q[Q.version0=0]="version0";Q[Q.version1=1]="version1"})(Dh||
(Dh={}));Object(e.b)("FirstRunExperienceVersion",Dh);class rm{get B0e(){return"Word"}get jAh(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return Dh.version0}get currentVersion(){return Dh.version1}get VGm(){return rm.isEnabled()&&m.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get Fbc(){return rm.isEnabled()&&m.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get RBi(){return m.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get YDl(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get FNi(){return 24}get nej(){return 4E3}get q5c(){return""}static isEnabled(){const Q=
m.AFrameworkApplication.sessionStartInfoSettings?m.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==Q&&"Automation"!==Q}}Object(e.a)(rm,"FirstRunExperienceLauncherSettings",null,[1687]);class rp{constructor(Q){this.bVg=Q}Uto(Q){this.bVg&&this.bVg.Vto(Q)}}Object(e.a)(rp,"FirstRunExperienceManager",null,[1685]);class Gn{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}xc(Q){this.W=Q;this.W.ha("WordEditor.FirstRunExperience.IFirstRunExperienceManager",
()=>new rp(this.W.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).singleInstance()}init(){const Q=this.W.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");Q&&Q.Uto(new rm)}dispose(){}}Object(e.a)(Gn,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class Ll{constructor(Q,za){this.GHa=(fb,Nb,tc,bd,Yd)=>{var Fd,De;if(1===tc)return Yd=null===(De=null===(Fd=Nb.view.mb)||void 0===Fd?void 0:Fd.hb)||void 0===De?void 0:De.kb,(null===Yd||void 0===Yd?
0:Yd.JH)||fb===Ag.a.d8c&&(null===Yd||void 0===Yd?0:Yd.F2a)?32:8;if(2===tc){Fd=this.gab.gj.isVisible;this.gab.VB(!0,1===Yd);De=0;switch(fb){case Ag.a.Qqj:Yd=1;break;case Ag.a.Rqj:Yd=2;break;case Ag.a.iie:Yd=2;De=1;break;case Ag.a.jie:Yd=1;De=2;break;case Ag.a.d8c:Yd=1;De=3;break;case Ag.a.Cle:Yd=this.gab.b4b;break;default:De=Yd=0}Fd&&fb===Ag.a.GHa||this.gab.Bgo(Yd,De);return 32}return 8};this.ZUd=(fb,Nb,tc,bd,Yd)=>{this.toggleButton(Yd,!1);return this.VYk(tc)};this.Cle=(fb,Nb,tc,bd,Yd)=>this.gab.gj.isVisible?
this.ZUd(fb,Nb,tc,bd,Yd):this.GHa(fb,Nb,tc,bd,Yd);this.ga=Q;this.gab=za}dispose(){this.gab&&this.gab.dispose()}Tb(){this.ga.qa(Ag.a.Cle,Ei.a.view,this.Cle);this.ga.fb(Ag.a.GHa,Ei.a.view,this.GHa,4);this.ga.qa(Ag.a.ZUd,Ei.a.view,this.ZUd);this.ga.fb(Ag.a.iie,Ei.a.view,this.GHa,4);this.ga.qa(Ag.a.jie,Ei.a.view,this.GHa);this.ga.qa(Ag.a.d8c,Ei.a.view,this.GHa)}VYk(Q){if(1===Q)return 32;this.gab.VB(!1);return 32}toggleButton(Q,za){Q&&(Q[Rh.a.On]=za)}}Object(e.a)(Ll,"FormatPictureActor",null,[9]);class Mk{constructor(Q){this.Qxb=
!1;this.gj=Q}get b4b(){return this.gj.Qel}Bgo(Q,za){switch(Q){case 0:case 1:this.gj.Tuo(za);break;case 2:this.gj.evo(za)}}VB(Q,za=!1){this.Qxb||this.Rzf();Q?this.gj.nP(za):this.gj.Nna()}dispose(){this.gj.dispose()}Rzf(){this.Qxb||(this.gj.initialize(),this.Qxb=!0)}}Object(e.a)(Mk,"FormatPictureManager",null,[1657,9]);var jg=c(354),Wl=c(145),ui=c(272);class $i{}$i.rP=ui.a.dNd;$i.kfc=1;$i.lfc=WordEditorIntl.WordEditorStrings.L_FormatPicture;$i.Hua="FormatPictureTaskPaneData";Object(e.a)($i,"FormatPicturePaneConstants",
null,[]);class Hn{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(e.a)(Hn,"FormatPictureTaskPaneProps",null,[]);class ao{constructor(Q,za,fb,Nb){this.KQe=0;this.mrc=this.wla=null;this.itd=this.$sd=this.Ond=this.Fed=
this.Bwd=0;this.Gs=this.STb=!1;this.Gwe=0;this.Yrn=()=>{this.ekj()};this.xm=()=>{let tc=!1;tc=this.zJn()||tc;tc=this.i5a()||tc;tc=this.h5a()||tc;tc=this.mgc()||tc;(tc=this.vJn()||tc)&&this.Cm()};this.R2=Q;this.s9j=za;this.jIe=fb;this.hg=Nb}initialize(){this.c_();this.Wia()}get isVisible(){return this.Gs}nP(Q){this.l8c(Q)}Nna(){this.Uca();this.Sqm()}Tuo(Q){this.pmj(Q,1)}evo(Q){this.pmj(Q,2)}pmj(Q,za){this.Gwe=za;this.KQe=Q}get Qel(){return this.Gwe}dispose(){}c_(){this.R2.KNa();this.KQe=this.Gwe=0}get xg(){return this.s9j.value}get pc(){return this.jIe.value}l3a(){return!!this.xg.currentScope&&
this.xg.currentScope.name===$i.rP}ekj(){this.xg.mg($i.rP)}Wia(){const Q=this.xg.ge($i.rP);Q.parent=wd.AFrame.rp;Q.Uea(this.Yrn)}Uca(){this.l3a()&&this.xg.mg(this.xg.wT)}l8c(Q){vd.UISurfaces.zu().then(za=>{za.showTaskPane($i.rP,this.eA(Q));this.isVisible&&Q&&this.xg.mg($i.rP);return null})}Cm(){vd.UISurfaces.zu().then(Q=>{Q.updateTaskPane($i.rP,this.eA(!1));return null})}Sqm(){vd.UISurfaces.zu().then(Q=>{Q.hideTaskPane($i.rP,2);return null})}eA(){const Q=new Hn;this.Eno(Q);return Object.assign(new th.a,
{title:$i.lfc,hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:za=>{this.Gs=!0;Za.App.ya.UYa(this.xm);Za.App.ya.updateCommandUI();this.ekj();this.hg.S_b($i.rP,za)},onClose:()=>{this.Uca();this.Gs=!1;Za.App.ya.Zgc(this.xm);Za.App.ya.updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}Eno(Q){const za=F.e().numberFormatInfo;Q.section=this.KQe;Q.numberFormatInfo="object"===typeof za?za:null;Q.title=this.wla;Q.description=this.mrc;Q.topCrop=this.Bwd;Q.bottomCrop=
this.Fed;Q.leftCrop=this.Ond;Q.rightCrop=this.$sd;Q.rotationAngle=this.itd;Q.onTitleChange=this.onTitleChange();Q.onDescriptionChange=this.onDescriptionChange();Q.onCropSpinButtonChange=this.onCropSpinButtonChange();Q.onRotationSpinButtonChange=this.onRotationSpinButtonChange();Q.disabled=this.STb}onTitleChange(){return Q=>{if(Q!==this.wla){this.wla=Q;var za=new jg.DictionaryPropertySet;za.setValue(Wl.a.Cib,Q);this.pc.Qb(ph.a.K6c,2,za);this.Cm()}}}onDescriptionChange(){return Q=>{if(Q!==this.mrc){var za=
new jg.DictionaryPropertySet;za.setValue(Wl.a.NX,Q);this.mrc=Q;this.pc.Qb(ph.a.SNb,2,za);this.Cm()}}}onCropSpinButtonChange(){return(Q,za)=>{const fb=new jg.DictionaryPropertySet;switch(za){case 0:this.Bwd=Q;fb.setValue(Wl.a.Hib,Q);this.pc.Qb(Ag.a.ERc,2,fb);break;case 1:this.Fed=Q;fb.setValue(Wl.a.Eib,Q);this.pc.Qb(Ag.a.xRc,2,fb);break;case 2:this.Ond=Q;fb.setValue(Wl.a.Fib,Q);this.pc.Qb(Ag.a.yRc,2,fb);break;case 3:this.$sd=Q,fb.setValue(Wl.a.Gib,Q),this.pc.Qb(Ag.a.zRc,2,fb)}this.Cm()}}onRotationSpinButtonChange(){return Q=>
{this.itd=Q;const za=new jg.DictionaryPropertySet;za.setValue(Wl.a.LRc,0);za.setValue(Wl.a.jJ,Q);this.pc.Qb(ph.a.imageRotate,2,za);this.Cm()}}zJn(){const Q=2===this.pc.Qb(ph.a.K6c,1,null),za=Q!==this.STb;this.STb=Q;return za}i5a(){var Q=new jg.DictionaryPropertySet;this.pc.Qb(ph.a.i5a,2,Q);Q=Q.ia(Wl.a.Cib,"");const za=Q!==this.wla;this.wla=Q;return za}h5a(){var Q=new jg.DictionaryPropertySet;this.pc.Qb(ph.a.h5a,2,Q);Q=Q.ia(Wl.a.NX,"");const za=Q!==this.mrc;this.mrc=Q;return za}mgc(){var Q=new jg.DictionaryPropertySet;
this.pc.Qb(Ag.a.p2c,2,Q);const za=Q.ia(Wl.a.Hib,0),fb=Q.ia(Wl.a.Eib,0),Nb=Q.ia(Wl.a.Fib,0);Q=Q.ia(Wl.a.Gib,0);const tc=za!==this.Bwd||fb!==this.Fed||Nb!==this.Ond||Q!==this.$sd;this.Bwd=za;this.Fed=fb;this.Ond=Nb;this.$sd=Q;return tc}vJn(){var Q=new jg.DictionaryPropertySet;this.pc.Qb(ph.a.WLb,2,Q);Q=Q.ia(Wl.a.jJ,0);const za=Q!==this.itd;this.itd=Q;return za}}Object(e.a)(ao,"ReactFormatPicturePane",null,[1656,9]);class qo{constructor(){this.ijd=this.W=null}get name(){return"WordEditor.FormatPicture"}xc(Q){this.W=
Q;this.W.ha("WordEditor.FormatPicture.IFormatPictureManager",()=>new Mk(this.W.resolve("WordEditor.FormatPicture.IFormatPicturePane"))).singleInstance();this.W.ha("WordEditor.FormatPicture.IFormatPicturePane",()=>new ao(Mh.a.instance,new hb.a(()=>ei.FocusManager.instance()),new hb.a(()=>m.AFrameworkApplication.va),zo.a.instance)).singleInstance();this.W.ha("WordEditor.FormatPicture.FormatPictureActor",()=>new Ll(m.AFrameworkApplication.va,this.W.resolve("WordEditor.FormatPicture.IFormatPictureManager"))).singleInstance()}init(){if(km.App.apg||
km.App.kKj)this.ijd=this.W.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.ijd.Tb(),Za.App.ya.updateCommandUI()}dispose(){this.ijd&&this.ijd.dispose()}static main(){K.a.instance.Fc(new qo)}}Object(e.a)(qo,"WordEditorFormatPicturePackage",null,[1,2]);var fs=c(1463),Cm=c(509);class Ig extends Ao.a{constructor(){super();this.Prompt=0;this.FileId=null}$k(){return 100}static construct(Q,za){const fb=new Ig;fb.FileId=Q;fb.Prompt=za;return fb}}Object(e.a)(Ig,"GraphMergeConsentChangedRequest",
Ao.a,[]);var kh=c(582);class ho extends kh.a{constructor(){super();this.Location=this.FileId=null}$k(){return 34}static construct(Q,za){const fb=new ho;fb.FileId=Q;fb.Location=za;return fb}}Object(e.a)(ho,"PlayGraphMergeReplayRequest",kh.a,[]);class Sn{constructor(Q,za,fb,Nb,tc,bd=null,Yd=null){this.$l=!1;this.BN=null;this.zeh=this.RGe=!1;this.X8e=()=>{if(this.Jza.LUd)this.RGe=!0;else if(this.RGe=!1,!this.Lco){this.zeh=!0;var Fd=this.AJa.Rxa;ra.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",
400===Fd);if(100===Fd||400===Fd)Fd=Ig.construct(this.VP(),Fd),this.tw(Fd)}};this.Zki=(Fd,De)=>{De&&De.PMf&&De.PMf.iaf&&!this.Jza.VBi&&(this.Jza.pDj(),this.Jza.LUd=!0,this.tw(De.PMf.iaf))};this.Xki=(Fd,De)=>{De&&De.Pbd&&this.Jza.pDj()};this.Yki=(Fd,De)=>{De&&(De.ShowMergePrompt&&this.AJa.icj(this.X8e),m.AFrameworkApplication.Kg&&(m.AFrameworkApplication.Kg.SessionMergeInfo|=De.PartMergeInfo))};this.VP=Q;this.Yxd=fb;this.Jza=Nb;this.AJa=tc;this.Yxd&&this.Yxd.Awk(this.Zki);this.w2=bd||gm.a.instance;
if(!Yd){const Fd=new Cm.a;Yd=De=>Fd.rga(0,De)}this.rWj=Yd}get sTm(){return this.RGe}get Lco(){return this.zeh}tw(Q){const za=new zk.a;za.Cq=Q;za.status=1;za.GG="GraphMerge";const fb=this.rWj(()=>{this.U4c(za,33===Q.$k())});fb.EI(za);fb.BT()}U4c(Q,za){this.$l||(za&&(this.Jza.LUd=!1),2===Q.statusCode&&!Ka.a.kHb(Q.zj)&&1===Q.zj.length&&Q.zj[0]?(Q=Q.zj[0],Q.StatusCode?this.Jza.gbg():za&&this.AJa.icj(this.X8e),this.w2.dUa(Q),this.sTm&&this.X8e()):this.Jza.gbg())}z4a(Q){this.BN=Q;this.BN.m0b(this.Xki);
this.BN.n0b(this.Yki)}dispose(){this.$l||(this.Yxd&&this.Yxd.h_n(this.Zki),this.BN&&(this.BN.HMb(this.Xki),this.BN.f4c(this.Yki)),this.$l=!0)}}Object(e.a)(Sn,"GraphMergeBackupManager",null,[1689,9]);class sl{constructor(Q,za=null,fb=null,Nb=null){this.mte=0;this.MFe=!1;this.W2g=new Date(0);this.LUd=!1;this.AJa=Q;this.Jz=za||(()=>new Date);fb||(fb=m.AFrameworkApplication.K?m.AFrameworkApplication.K.mc("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.eak=fb;Nb||(Nb=m.AFrameworkApplication.K?m.AFrameworkApplication.K.mc("WordEditorGraphMergeMaxBackups",
1):1);this.K5g=Nb}get bSm(){return+this.Jz()-+this.W2g<this.eak}get VBi(){return 500===this.AJa.Rxa?!1:100===this.AJa.Rxa?!0:this.MFe||this.LUd||this.bSm}pDj(){this.W2g=this.Jz();this.mte++;this.mte>=this.K5g&&this.gbg()}gbg(){this.MFe||(this.MFe=!0,ra.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.mte,this.K5g))}}Object(e.a)(sl,"GraphMergeBackupThrottler",null,[1690]);class gr{constructor(Q,za,fb=null){this.kXg=!1;
this.wV=Q;this.H1j=za;null==fb&&(fb=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.gOe=fb?500:300}get Rxa(){return this.gOe}icj(Q){if(!this.kXg&&300===this.Rxa){var za=this.H1j.value;za&&za.isFeatureEnabled(51)&&(this.kXg=!0,this.wV.execute(fb=>{fb.euo(()=>{this.J2k(Q)},()=>{this.consentDenied(Q)})}))}}consentDenied(Q){300===this.Rxa&&(ra.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.gOe=100,Q());
this.D9i()}J2k(Q){300===this.Rxa&&(ra.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.gOe=400,Q());this.D9i()}D9i(){this.wV.execute(Q=>{Q.Lqm()})}}Object(e.a)(gr,"GraphMergeCollectionConsentManager",null,[1688]);class ro extends Sys.EventArgs{constructor(Q){super();this.PMf=Q}}Object(e.a)(ro,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var Nr=c(820),hr=c(869),gs=c(1032),gl=c(615),Uq=c(1749),Fo=c(1747),vn=c(223),Go=c(168);class Vd{constructor(Q,za,fb,
Nb,tc,bd){this.P0f=this.rg=null;this.LVc=this.Eog=!1;this.Uk=null;this.S7c=Q.runtime.S7c;this.hq=Q;this.Zd=za;this.Ng=fb;this.sn=Nb;this.u2k=tc;this.graphNodeComplexMerge=bd}}Object(e.a)(Vd,"GraphNodeComplexMergeState",null,[]);var sp=c(1535),Cl=c(1519);class mm{constructor(Q,za=null){this.Mg=Q;this.SWb=za||this.wOc()}get elb(){return this.SWb}get Zd(){return this.Mg}wOc(){return[Object(a.a)(this,this.Awo,"simpleMerge"),Object(a.a)(this,this.G1k,"complexMerge")]}Jno(Q,za,fb,Nb,tc,bd){za=new Vd(Q,
fb,new hb.a(()=>new sp.a(Nb?Nb.vm:null,tc)),new hb.a(()=>new sp.a(Nb?Nb.vm:null,bd)),new hb.a(()=>new sp.a(bd,tc)),za.ZKh(tc,()=>Q.runtime.Xb));za.rg=Nb.WZb;za.P0f=new vn.a;return za}merge(Q,za,fb,Nb,tc,bd){za=this.Jno(Q,za,fb,Nb,tc,bd);fb=!0;for(Nb=0;Nb<this.elb.length&&fb;Nb++)(fb=(0,this.elb[Nb])(za))||Q.logger.y2d("GraphNodeMerge.GetMergeFunctions()",Nb);if(Q=za.LVc&&za.Uk?new Cl.a(za.Uk,!1):null)switch(Q.cmo(za.rg),(Q?Q.vm:tc).Pc){case 1074135145:za.hq.runtime.cce.U3k.Z(Q.vm.id,Q.vm);break;case 1074135153:za.hq.runtime.cce.TJk.Z(Q.vm.id,
Q.vm);break;case 1074135127:za.hq.runtime.cce.A0k.Z(Q.vm.id,Q.vm);break;case 393230:za.hq.runtime.W3d.add(Q.vm.id)}return{returnValue:za.LVc,Uk:Q}}Awo(Q){if(Q.hq.runtime.Xb&&Q.hq.runtime.Xb.Zhb(1000005)&&0<Q.rg.count)return!0;var za=Q.graphNodeComplexMerge.rae;return Q.sn.value.DTc(za)&&Q.u2k.value.DTc(za)?Q.Ng.value.DTc(za)?!0:(za=Q.sn.value.yf,Q.LVc=!0,Q.Uk=za.AK(),!1):(Q.LVc=!0,!1)}G1k(Q){const za=Q.sn.value.yf;Q.S7c&&Go.a.instance.Ta(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",
za.id,za.Pc);const fb=Q.graphNodeComplexMerge.Ikg(Q);Q.LVc=fb;Go.a.instance.Ta(4018184,1,fb?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",fb?"Succeeded":"Failed",za.id,za.Pc,!!Q.Uk);return fb}}Object(e.a)(mm,"GraphNodeMerge",null,[1773]);class In extends Ao.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=
null;this.Prompt=this.Reason=this.Source=0}$k(){return 33}static construct(Q,za,fb,Nb,tc,bd,Yd,Fd,De,Nf,Je){const va=new In;va.FileId=Q;va.BaseRevisions=za;va.TheirRevisions=fb;va.YourRevisions=Nb;va.IgnoreConflictsInLastServerRevision=tc;va.MergeHint=bd;va.ObjectSpaceId=Yd?tj.a(Yd):null;va.RequestId=Fd?tj.a(Fd):null;va.Source=De;va.Reason=Nf;va.Prompt=Je;return va}}Object(e.a)(In,"CreateGraphMergeReplayRequest",Ao.a,[]);var mn=c(808),Ih=c(235),Vm=c(15),Tn=c(1860),Or=c(1936);class Ip{constructor(Q,
za=null,fb=null){this.Aol=(Nb,tc)=>{let bd=Nb;var Yd=tc,Fd=this.gbb.get(Nb);if(!Fd)return{fHa:bd,$Mb:Yd};Yd=new vn.a;Yd.add(Fd);var De=this.nvb.get(Nb)||this.HF.J(Nb);Fd=new vn.a;Fd.add(De);De=new vn.a;De.add(this.HF.J(Nb));ra.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.jH.Tvf,this.jH.Jha,this.Fai(Fd),this.Fai(Yd));var Nf=this.Xai(this.jH.Jha);this.rDl(Nf,Nb,Yd);Fd=new Tn.a(Nf,De,1===Nf.input.Jha?
Fd:Yd,1===Nf.input.Jha?Yd:Fd,this.Xai(1),Fd,Yd);Yd=new vn.a;for(De=0;De<tc.length;De++){this.jH.QG("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const Je=({O5a:bd,Rpa:Nf}=Fd.Bad(Nb,tc.J(De))).returnValue;Yd.add(Nf);Je?ra.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",Nb,tc.J(De),bd,Nf):ra.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",
Nb)}return{fHa:bd,$Mb:Yd}};this.jH=Q;this.HF=Q.tk;this.gbb=Q.MGo;this.nvb=Q.q5o;this.b$j=Q.YZm;this.Mg=za||new gs.a;this.Edk=fb||this.Aol}FJc(Q){const za=new vn.a;for(let fb=0;fb<Q.length;fb++){const Nb=this.qol(Q.J(fb));za.add(Nb)}return za}EJc(Q,za,fb){const Nb=Q.iu===Q.iz&&Q.startCp===Q.endCp;za&&({fHa:Q.iu,Rpa:Q.startCp}=this.gUa(Q.iu,Q.startCp,Q.iu),Nb&&(Q.iz=Q.iu,Q.endCp=Q.startCp));fb&&!Nb&&({fHa:Q.iz,Rpa:Q.endCp}=this.gUa(Q.iz,Q.endCp,Q.iz));return Q}qol(Q){if(Q.iu===Q.iz){var za=new vn.a;
za.add(Q.startCp);za.add(Q.endCp);({fHa:Q,$Mb:za}=this.Qmg(Q.iu,za));return new mn.a(Q,za.J(0),Q,za.J(1))}za=new vn.a;var fb=new vn.a;let Nb;za.add(Q.startCp);({fHa:za,$Mb:Nb}=this.Qmg(Q.iu,za));fb.add(Q.endCp);({fHa:Q,$Mb:fb}=this.Qmg(Q.iz,fb));return new mn.a(za,Nb.J(0),Q,fb.J(0))}Qmg(Q,za){let fb=Q,Nb=za;if(!this.HF.J(Q))return ra.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",Q),{fHa:fb,
$Mb:Nb};if(this.gbb.get(Q))({fHa:fb,$Mb:Nb}=this.Edk(Q,za,fb,Nb));else if(this.jH.fzf&&!this.jH.fzf.J(this.jH.fzf.length-1).j4(Q)){Nb=new vn.a;for(let tc=0;tc<za.length;tc++){let bd;({fHa:fb,Rpa:bd}=this.gUa(Q,za.J(tc),fb));Nb.add(bd)}}return{fHa:fb,$Mb:Nb}}Fai(Q){let za="";Q.forEach(fb=>{za+=fb.i$c();za+=" ";return!0});return za}Xai(Q){const za=ua.a.instance.Na("Box4.IFeatureHelper"),fb=new Or.a;fb.input.source=this.jH.Tvf;fb.input.Jha=this.jH.Jha;fb.input.qLc=()=>za;fb.runtime.tk=this.HF;fb.runtime.WCa=
this.jH.c1k;1===Q?(fb.runtime.xu=this.nvb,fb.runtime.Hq=this.gbb,fb.runtime.sLd=this.jH.PDi,fb.runtime.Rme=this.jH.eEi):2===Q&&(fb.runtime.xu=this.gbb,fb.runtime.Hq=this.nvb,fb.runtime.sLd=this.jH.eEi,fb.runtime.Rme=this.jH.PDi);fb.runtime.Xb=za;return fb}rDl(Q,za,fb){if(Q.runtime.xu.nb(Ih.a.uL)){var Nb=Q.runtime.xu.J(Ih.a.uL);Nb=this.Mg.getPropertyObjectIds(Nb,fm.a.p1);if(1===Nb.length&&(Nb=Nb.J(0),Q.runtime.xu.nb(Nb)&&(Nb=Q.runtime.xu.J(Nb),3===this.Mg.getPropertyInt32(Nb,fm.a.fqb)))){const tc=
this.Mg.getPropertyString(Nb,fm.a.vja),bd=this.Mg.getPropertyString(Nb,fm.a.wQb);za.toString()===tc&&tc===bd&&(za=this.Mg.getPropertyObjectId(Nb,fm.a.Ead),Q.runtime.xu.nb(za)&&fb.add(Q.runtime.xu.J(za)))}}}B5l(Q,za){let fb=0;for(let Nb=0;Nb<Q.length;Nb++)if(za.equals(Q.J(Nb)))return fb=Nb,{returnValue:!0,idx:fb};return{returnValue:!1,idx:fb}}gUa(Q,za){const fb=this.b$j&&!!this.nvb.J(Q)&&!this.HF.J(Q);let Nb=Q,tc=za,bd=!1,Yd=!1;(fb?this.nvb:this.gbb).forEach((Fd,De)=>{this.jH.QG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
if(this.NEf(De.Pc)&&this.HF.J(Fd)){De=null;if(fb){De=this.QOc(Je=>this.nvb.J(Je)||this.HF.J(Je),Fd);var Nf=this.rZd(De,Q)}else Nf=this.QOc(Je=>this.HF.J(Je),Fd),Nf=this.rZd(Nf,Q);if(Nf&&(Yd=!0,De||(De=this.QOc(Je=>this.nvb.J(Je)||this.HF.J(Je),Fd)),Fd=this.QOc(Je=>this.gbb.J(Je)||this.HF.J(Je),Fd),Nf=0,({idx:Nf}=this.B5l(De,Q)).returnValue)){for(let Je=Nf+1;Je<De.length;Je++)if(this.rZd(Fd,De.J(Je)))return tc=0,Nb=De.J(Je),bd=!0,!1;for(--Nf;0<=Nf;Nf--)if(this.rZd(Fd,De.J(Nf)))return tc=Number.MAX_VALUE,
Nb=De.J(Nf),bd=!0,!1}}return!0});bd||(ra.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",Q,za,fb,Yd),5===this.jH.Tvf&&(ra.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",Nb),({r_h:za}=this.vVl()).returnValue?(Nb=za,tc=0,ra.ULS.sendTraceTag(17340241,
318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Nb)):ra.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Nb)));return{fHa:Nb,Rpa:tc}}vVl(){let Q=fh.a.nil,za=new vn.a;this.gbb.forEach((fb,Nb)=>{this.jH.QG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
return this.NEf(Nb.Pc)?(za=this.QOc(tc=>this.gbb.J(tc)||this.HF.J(tc),fb),!1):!0});return 0<za.length?(Q=za.J(0),{returnValue:!0,r_h:Q}):{returnValue:!1,r_h:Q}}NEf(Q){return 393241===Q||393250===Q||393251===Q||393252===Q}QOc(Q,za){var fb=Q(za);za=new vn.a;if(!this.NEf(fb.Pc))return za;fb=this.Mg.getPropertyObjectIds(fb,Vm.a.ff);for(let Nb=0;Nb<fb.length;Nb++){const tc=new vn.a;this.ysf(Q,fb.J(Nb),tc);za.PC(za.length,tc)}return za}ysf(Q,za,fb){var Nb=Q(za);if(Nb)if(393230===Nb.Pc)fb.add(za);else if(393229===
Nb.Pc)za=this.Mg.getPropertyObjectIds(Nb,Vm.a.FK).ag(0),this.ysf(Q,za,fb);else if(393250===Nb.Pc||393251===Nb.Pc||393252===Nb.Pc)for(za=this.Mg.getPropertyObjectIds(Nb,Vm.a.ff),Nb=0;Nb<za.length;Nb++)this.ysf(Q,za.J(Nb),fb)}rZd(Q,za){for(let fb=0;fb<Q.length;fb++)if(za.equals(Q.J(fb)))return!0;return!1}}Object(e.a)(Ip,"GraphMergeSelectionRecordUpdater",null,[]);class io extends Uq.a{constructor(Q=null,za=null,fb=null,Nb=null,tc=null,bd=null,Yd=null,Fd=null,De=null,Nf=null,Je=null){var va;super();
this.vMh=Oa=>{const Ba=Oa.OW,wa=Za.App.ya.gb.Uc;return new Nr.a(Oa,Ba,wa.od,wa.fileId,wa.pnb,wa.contextId,Ba?Ba.id:fh.a.nil,this.hee,!1,!0)};this.VP=Q||(()=>m.AFrameworkApplication.rootQuerySignature);za||(za=Oa=>new hr.a(Oa));this.bdh=za;this.Mg=fb||new gs.a;this.cOg=Yd||new Fo.ChildNodeListMerge(this.Zd);this.hYb=Fd;this.hee||(this.hYb=(Oa,Ba,wa)=>new gl.a(Oa,Ba,wa));this.SWb=Nb||this.wOc();this.Q$a=tc||new go.a;this.TWg=bd||new mm(this.Zd);this.R5g=(null===(va=m.AFrameworkApplication.K)||void 0===
va?void 0:va.mc("WordEditorGraphMergeMaxBrowserTimeInMs",750))||750;this.Jza=De;this.AJa=Nf;this.fTd=this.Akl(Je);this.qUg=()=>ua.a.instance.Na("Box4.IFeatureHelper")}Akl(Q){Q||(Q=m.AFrameworkApplication.K?m.AFrameworkApplication.K.mc("WordEditorGraphMergeBackupCasesBrowser",0):0);return Q}eEa(){return(new Date).getTime()}cvj(Q,...za){return String.format.apply(null,[Q].concat(za))}iHo(Q){throw kc.a.invalidOperation(Q);}VOd(Q){return String.format("Name: {0}, Message: {1}, Stack: {2}",Q.name,Q.message,
Q.stack)}QDn(Q){if(this.Jza&&this.Jza.VBi||!this.RCo(Q))return null;this.N2m(Q);let za;({iIk:Nb,LGo:tc,p5o:za}=this.tcl(Q,this.vMh));const fb=Uq.a.GWl(Q);var Nb=In.construct(this.VP(),Nb.Uya(),tc.Uya(),za.Uya(),Q.input.VFb,Q.input.Jha,Q.input.wm,Q.input.rJb,Q.input.source,fb,this.AJa.Rxa);var tc=Q.output.GM;3===fb&&0<tc.length&&(Nb.MergedRevision=this.vMh(Q.output.GM.last()));return Nb}FJc(Q,za){return(new Ip(Q)).FJc(za)}EJc(Q,za,fb,Nb){return(new Ip(Q)).EJc(za,fb,Nb)}}Object(e.a)(io,"GraphMerger",
Uq.a,[]);class Zo extends io{constructor(Q,za=null,fb=null){super(Q,void 0,void 0,void 0,void 0,void 0,void 0,void 0,za,fb);this.ra=new O.a}get Rxa(){return this.AJa?this.AJa.Rxa:0}get delayedMergeOperation(){return null}set delayedMergeOperation(Q){}Awk(Q){this.ra.addHandler(Zo.Svf,Q)}h_n(Q){this.ra.removeHandler(Zo.Svf,Q)}ddg(){return!1}udc(Q,za,fb,Nb,tc,bd,Yd){(Q=super.udc(Q,za,fb,Nb,tc,bd,Yd))&&this.ra.raiseEvent(Zo.Svf,new ro(Q));return Q}}Zo.Svf="GMC";Object(e.a)(Zo,"WordEditorGraphMerger",
io,[1684,1380,1381]);class so{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}xc(Q){this.W=Q;this.W.ha("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new gr(this.W.Sa("WordEditor.IBusinessBarController"),new hb.a(()=>Q.Na("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new sl(this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").singleInstance();
this.W.ha("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new Zo(()=>m.AFrameworkApplication.rootQuerySignature,this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Sn(()=>m.AFrameworkApplication.rootQuerySignature,m.AFrameworkApplication.va,this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),
this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").singleInstance()}init(){Za.App.NR||(Za.App.NR=fs.a.G7());const Q=this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");Za.App.NR.aJk(Q);this.W.resolve("Box4.IGraphMergeBackupManager")}dispose(){let Q=this.W.Na("Box4.IGraphMergeBackupManager");Q&&Q.dispose()}}Object(e.a)(so,"GraphMergePackage",null,[1,2]);var On=c(283);class Us{constructor(Q){this.uve=
"FontPicker";this.pFe=null;this.S8a=Q;this.xid=this.S8a.cya(On.a.BIb,Object(a.a)(this,this.MCb,"featureStateChangeCallback"));this.S8a.isFeatureEnabled(On.a.BIb,!1).then(za=>{this.pFe=za})}get isLicensed(){return this.pFe}MCb(Q){this.pFe=Q.isEnabled;Q=appChrome.actions.updateFontPickerLicenseState(this.uve,Q.isEnabled);appChrome.api.dispatch(Q)}dispose(){this.S8a.Tgc(On.a.BIb,this.xid)}}Object(e.a)(Us,"ModernFontPickerFeatureHelper",null,[958,9]);var tp=c(473),dl=c(643),kk=c(1653);class nn{constructor(){this.type=
"FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(e.a)(nn,"FontInfoTaskPaneProps",null,[]);class Oo{constructor(Q,za,fb,Nb=null){this.xVe=this.NV=this.xid=null;this._state=this.nWb=0;this.jIe=Q;this.S8a=za;this.pWj=fb;this.Ub=Nb}get pc(){return this.jIe.value}initialize(){this.pc.qa(n.a.W6f,z.a.frame,Object(a.a)(this,this.W6f,"requestFontInfo"));this.xid=this.S8a.cya(On.a.BIb,Object(a.a)(this,this.MCb,
"featureStateChangeCallback"));this.Wia()}nP(Q=!1){const za=vd.UISurfaces.zu(),fb=this.S8a.isFeatureEnabled(On.a.BIb,!1),Nb=[];Nb.push(za);Nb.push(fb);Promise.all(Nb).then(tc=>{tc[0].showTaskPane(kk.a.eDb,this.eA(tc[1]));Q&&this.OJ()})}lVo(Q){vd.UISurfaces.zu().then(za=>{za.updateTaskPane(kk.a.eDb,this.eA(Q));return null})}MCb(Q){this.lVo(Q.isEnabled)}W6f(Q,za,fb,Nb,tc){this.NV=tc.CommandValueId;this.xVe=tc.Trigger;this.nWb=tc.InputMethod;this.nP(2===this._state&&1===this.nWb);return 32}eA(Q){const za=
new nn;za.onUpsellButtonClicked=Object(a.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");za.fontName=this.NV;za.isLicensed=Q;za.trigger=this.xVe;za.helpArticleUrl=this.W2k();za.paneId=kk.a.eDb;Q=this.fwm();Q.contentProps=za;return Q}fwm(){return Object.assign(new th.a,{title:kk.a.lfc,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(a.a)(this,this.onOpen,"onOpen"),onClose:Object(a.a)(this,this.onClose,"onClose"),onShow:Object(a.a)(this,
this.onShow,"onShow"),onHide:Object(a.a)(this,this.onHide,"onHide")})}Wia(){if(this.Ub){var Q=this.Ub.ge(kk.a.eDb);Q.parent=wd.AFrame.rp;Q.OH=!0}}onOpen(){this._state=2;this.OJ()}onShow(Q){0!==this._state&&(this._state=2,1===Q&&(this.nWb=Q),this.OJ())}onClose(){this.nWb=this._state=0;this.blur()}onHide(){this._state=1;this.nWb=0}OJ(){this.Ub&&1===this.nWb&&this.Ub.mg(kk.a.eDb)}blur(){this.Ub&&this.Ub.currentScope&&this.Ub.currentScope.name===kk.a.eDb&&this.Ub.mg(this.Ub.wT)}onUpsellButtonClicked(){this.S8a.launchUpsellExperience(kk.a.experienceId)}dispose(){this.S8a.Tgc(On.a.BIb,
this.xid)}W2k(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.pWj,this.BXl(),"WDWAENDUSER",m.AFrameworkApplication.lcid)}BXl(){switch(this.xVe){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Oo.wLk(this.NV)}static wLk(Q){let za="hlpFontInfo";for(let fb=0;fb<Q.length;++fb){const Nb=Ra.a.charAt(Q,
fb);if(255<Q.charCodeAt(fb)||Ra.a.pXd(Nb))za+=Nb}return za}}Object(e.a)(Oo,"FontInfoPane",null,[957,9]);class Ij extends Oo{constructor(Q,za,fb,Nb,tc){super(Q,za,Nb.jb("FontInfoHelpBaseUrl"),tc);this.R2=fb}nP(Q){this.c_();super.nP(Q)}MCb(Q){super.MCb(Q);Za.App.ya.updateCommandUI()}c_(){this.R2.KNa()}}Object(e.a)(Ij,"WordEditorFontInfoPane",Oo,[]);class up{constructor(){this.OUb=this.Hod=this.$sc=this.W=null}get name(){return"WordEditor.ModernFontPicker"}xc(Q){this.W=Q;Q.ha("Common.ModernFontPicker.IModernFontPickerFeatureHelper",
()=>new Us(this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).singleInstance();Q.ha("Common.ModernFontPicker.IFontInfoPane",()=>new Ij(new hb.a(()=>m.AFrameworkApplication.va),this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Mh.a.instance,m.AFrameworkApplication.K,ei.FocusManager.instance())).singleInstance()}init(){this.Hod=this.W.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.$sc=this.W.resolve("Common.ModernFontPicker.IFontInfoPane");
this.$sc.initialize();m.AFrameworkApplication.K.$("IsAnonymousUser")||((this.OUb=this.W.Na(dl.a))?this.OUb.initialize():ra.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));Za.App.ya.updateCommandUI()}dispose(){this.$sc&&(this.$sc.dispose(),this.$sc=null);this.Hod&&(this.Hod.dispose(),this.Hod=null);this.OUb&&(this.OUb.LCa(),this.OUb=null)}static main(){Object(tp.a)()&&K.a.instance.Fc(new up)}}Object(e.a)(up,"ModernFontPickerPackage",null,[1,2]);var Xl=c(131),Pn=c(5),
ep=c(246),$p=c(36),li=c(1096);class lh{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd,De,Nf,Je,va=null){this.YY=fb;this.Wc=Q;this.Hc=za;this.nh=tc;this.jJa=bd;this.xV=Yd;this.INg=Fd;this.HNg=De;this.Rx=Nf;this.MZj=va||lh.fw}get kh(){return this.Rx?this.Rx.kh:!1}Tqi(Q){return this.ZEa(Q,0)}lzm(Q){return this.ZEa(Q,1)}ZEa(Q,za){let fb=null;if(this.kh&&this.xV&&(this.HNg.instance&&this.HNg.instance.uIa(Q),za?1===za&&(fb=this.xV.Jai(Q.node)):fb=this.xV.xof(Q.node,Q.cpBegin,Q.Eb),fb&&!fb.ia(fm.a.v8,!1)))return ra.ULS.shipAssertTag(24749379,
368,!1,"Try to insert page break to inconvertible inline content control"),2;const Nb=Pn.GraphIterator.pX(this.Wc.xk());Nb.set(Q.node);Nb.zb(10);const tc=this.Hc.Mc(15);tc.hu(Nb);za?$p.OutlineElementNavigator.Vd(Nb):(this.splitParagraph(Nb,Q),this.YY.Xlc(Q.node,Rj.a.zs));Q=hf.ParagraphReader.xl(Nb.currentNode);this.CAm(Nb);this.kh&&fb&&this.INg&&(za=new ib.a,za.add(Nb.currentNode),this.INg.Ymh(za,fb.id));this.xho(Q);tc.dispose();return 32}xho(Q){Q=Be.SelectionFactory.te(Q,0);Of.a.instance.setSelection(Q)}CAm(Q){this.nh.yB(Q,
!0,!0,null,!1,!1);Q=$p.OutlineElementNavigator.Ge(Q);this.mzm(Q)}splitParagraph(Q,za){const fb=$p.OutlineElementNavigator.Vd(Q);if(za.cpBegin||this.kh&&(!this.kh||-1!==za.Eb)){Za.App.rd.Yo&&za.cpBegin!==hf.ParagraphReader.textLength(za.node)&&Za.App.rd.kq.rH(za.node);this.nh.yB(Q,!1,!0,null,!1,!0);var Nb=Pn.GraphIterator.pX(this.Wc.xk());Nb.set(fb);this.nh.N9(Nb,Q,za,!0,!0,!0)}}mzm(Q){Q=this.MZj(Q);this.jJa.qri(Q)}static YE(){return new lh(new gk.a,new Al.a,ua.a.instance.resolve("Box4.IAutoCorrectScheduler"),
li.a.instance,ua.a.instance.resolve("Box4.IOutlineElementEditor"),ua.a.instance.resolve("Box4.IBlobEditor"),ua.a.instance.Na("Box4.IContentControlReader"),ua.a.instance.Na("Box4.IContentControlEditor"),ua.a.instance.Sa("Box4.IContentControlConverter"),ua.a.instance.Na("Box4.ContentControlConfigSettings"),ua.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=lh.cCg?lh.cCg:lh.cCg=lh.YE()}static fw(Q){return Wh.a.fw(Q)}}Object(e.a)(lh,"PageBreakInserter",null,[1695]);class bk{constructor(Q,
za,fb,Nb,tc,bd,Yd,Fd){this.FAm=(De,Nf,Je,va)=>{var Oa=Nf.view,Ba=Oa.mb.sg;if(!Ba)return 2;if(!this.t6e(Nf))return 8;if(1===Je)return 32;let wa=!0;Je=8;const Ua=this.qGe(Ba);Ba=this.Hc.Mc(15);Ba.Cb(Oa.ed);Ba.fk=De;Ua||(Je=this.ga.Nf(Nf,ph.a.Bma,2,!0,va,null),De=32===Je,ra.ULS.shipAssertTag(4208012,314,De),wa=De);wa&&(Oa=Oa.mb.sg,De=this.qGe(Oa),ra.ULS.shipAssertTag(4208013,314,De,"{0}",{["ContextId"]:Nf.contextId}),Je=8,De&&(Je=this.dEe.Tqi(Oa),ra.ULS.shipAssertTag(4208014,314,32===Je)));Ba.dispose();
32===Je&&this.Ud.Js(10);return Je};this.EAm=(De,Nf,Je)=>{if(!Nf||Nf.contextId!==Ei.a.Tc)return 8;if(1===Je)return Nf.contextId===Ei.a.Tc?32:8;if(2===Je){if(!this.t6e(Nf))return 8;De=this.dEe.Tqi(Nf);32===De&&this.Ud.Js(10);return De}return 32};this.DAm=(De,Nf,Je)=>{if(!Nf||Nf.contextId!==Ei.a.table)return 8;if(1===Je)return 32;if(2===Je){if(!this.t6e(Nf))return 8;De=this.dEe.lzm(Nf);32===De&&this.Ud.Js(10);return De}return 32};this.ga=Q;this.dEe=za;this.Hc=fb;this.Sm=Nb;this.qGe=tc;this.Ik=bd;this.H7j=
Yd;this.Ud=Fd}Tb(){this.ga.qa(Ag.a.ZEa,Ei.a.view,this.FAm);this.ga.qa(Ag.a.ZEa,Ei.a.Tc,this.EAm);this.ga.qa(Ag.a.ZEa,Ei.a.table,this.DAm);this.ga.Vc(Ag.a.ZEa,4)}R4(){const Q=ei.FocusManager.instance().ge(Xl.AppFrame.$E);wd.AFrame.Ai(Q,Df.KeyInputManager.kc(Rj.a.zs,Df.KeyInputManager.Rh),Ag.a.ZEa)}iLm(Q){return this.Yw(Q.iterator)}NOm(Q){Q=Q.J(0);const za=ze.SelectionEditor.Cj(Q,!0,!1);if(this.Yw(za.Qa.iterator))return!0;Q=ze.SelectionEditor.Cj(Q,!1,!1);return this.Yw(Q.Qa.iterator)}Yw(Q){return Q.zb(14)}t6e(Q){let za=
null,fb=Q;if(fb.contextId===Ei.a.view){za=fb.view;if(!za.features.$gg)return!1;fb=za.mb.sg;if(!fb)return!1}else{const Nb=Pn.GraphIterator.$a(fb.node);if(Nb.zb(36)||Nb.zb(38)||Nb.zb(40)||Nb.zb(14))return!1}return ep.a.fha(Q)?!1:fb.contextId===Ei.a.table?this.Ik.TKm(fb.node):!this.Ik.RKm(fb)||this.Sm&&this.Sm.instance&&this.Sm.instance.qU(fb)?!1:((Q=this.qGe(fb))?this.iLm(fb):this.NOm(za.mb.hb))||Q&&this.H7j(fb,!0)?!1:!0}static YE(){return new bk(m.AFrameworkApplication.va,lh.instance,new Al.a,ua.a.instance.Sa("Box4.IExternalSelectionManager"),
ze.SelectionEditor.gf,Pb.a.instance,Dn.HyperlinkReader.Bwa,ua.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=bk.XAg?bk.XAg:bk.XAg=bk.YE()}}Object(e.a)(bk,"PageBreakActor",null,[1676]);class ir{constructor(){this.sMe=this.W=null}get name(){return"WordEditor.PageBreak"}xc(Q){this.W=Q}init(){this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>{this.fn()})}fn(){this.sMe=bk.instance;this.sMe.Tb();this.sMe.R4();Za.App.ya.updateCommandUI()}dispose(){}}
Object(e.a)(ir,"PackageManager",null,[1,2]);var lq=c(1465),vp=c(1466),ah=c(273),Jp=c(188),Yi=c(245),bo=c(276),Po=c(440);class dn{constructor(Q,za,fb,Nb,tc,bd,Yd){this.hwb=null;this.ra=new O.a;this.Lwe=1;this.qnd=-1;this.eXa=null;this.gpa=()=>{this.Y4e()};this.ib=za;this.Hb=fb;this.uhd=Nb;this.wI=tc;this.Jy=bd;this.Gea=Yd;this.enable()}get nHd(){return this.Lwe}hnj(Q){this.Lwe!==Q&&(this.Lwe=Q,this.ra.raiseEvent("X"),this.SEf&&this.ymg())}get SEf(){const Q=ua.a.instance.Na("WordEditor.Pagination.IPageEndMarkers");
return Q?Q.SEf:!0}get mf(){return this.wI.value}get Jk(){return Le.a.instance}Dvk(Q){this.ra.addHandler("X",Q)}ymg(){this.Jk.ie(()=>{this.Gea.KU(Po.a.ZYi)},"CPC:UPN")}enable(){this.ib.Lw(this.gpa);this.Y4e()}Y4e(){if(!this.eXa||1>=this.eXa.count)this.hnj(1);else{var Q=this.ib.hb.kb;if(Q){var za=Q.Pf?Q.Qc:Q.Qa;!za||0>za.cpBegin||(Q=za.node)&&hf.ParagraphReader.Wb(Q)&&this.AKm(Q)&&(this.hwb&&(this.Hb.Ve(this.hwb),this.hwb=null),this.hwb=new Pc.a(2,1,400,fb=>{this.findCurrentPageFromIp(fb,za)},62),this.Hb.Vb(this.hwb))}}}AKm(Q){Q=
Pn.GraphIterator.$a(Q);return Q.zb(35)||Q.zb(37)||Q.zb(39)?!1:!0}NFj(Q){this.eXa=Q;this.kEj()}kEj(){if(-1!==this.qnd){var Q=this.NAl(this.qnd);-1!==Q&&this.hnj(Q)}}findCurrentPageFromIp(Q,za){this.hwb===Q&&(this.hwb=null,this.qnd=this.dJl(za),-1!==this.qnd&&this.kEj())}NAl(Q){if(!this.eXa)return-1;for(let za=0;za<this.eXa.count;za++){const fb=this.eXa.J(za);if(Q>fb.Llh&&Q<fb.Llh+fb.height)return fb.Ph}return-1}dJl(Q){var za=this.S5l(Q);if(!za||!za.htmlElement)return-1;const fb=za.getBounds();Q=this.NQl(Q,
za);if(!Q)return-1;za=ha.a.p1a(this.uhd.M4a,za.htmlElement).y;return Q.y+Math.floor(Q.height/2)-fb.y+za}S5l(Q){return Q.node.De(this.mf.ic)}NQl(Q,za){Q=this.Jy?this.Jy.Taa(Q,!0):Q.cpBegin;return bo.a.Pq(za,Q)}disable(){this.ib.CY(this.gpa)}}Object(e.a)(dn,"CurrentPageCalculator",null,[1698,1692]);class to{constructor(Q){to.kZ=Q}get Vbf(){return to.kZ}get nHd(){return this.Vbf.nHd}usl(){this.Vbf.enable()}$ll(){this.Vbf.disable()}}to.kZ=null;Object(e.a)(to,"CurrentPageManager",null,[1696]);var Ml=c(116);
class mq extends Sys.EventArgs{constructor(Q,za){super();this.vPi=za}}Object(e.a)(mq,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class Dq extends Sys.EventArgs{constructor(Q,za,fb){super();this.delta=Q;this.vPi=fb}}Object(e.a)(Dq,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class nh{static get wZa(){if(null!=nh.bwg)var Q=nh.bwg;else{var za;Q=!(null===(za=m.AFrameworkApplication.K)||void 0===za||!za.getBooleanFeatureGate("Microsoft.Office.WordOnline.CallAfterValidateDirectlyIsEnabled",
!1));Q=nh.bwg=Q}return Q}constructor(Q,za,fb){this.Oah=this.Frd=-1;this.gyc=null;this.ra=new O.a;this.vKe=!1;this.vXf=(Nb,tc)=>{this.vKe=this.pUk();tc.rmb||this.Gsc.value.measure(this.kUk)};this.kUk=()=>{const Nb=this.M4a.clientHeight;this.jUk(Nb);this.sUk(Nb)};this.YWf=(Nb,tc)=>{tc.property===Ml.a.aJ&&(Nb=tc.node)&&Nb.ia(Ml.a.aJ,!1)&&(Nb=Nb.De(this.mf.ic))&&(Nb=Nb.htmlElement)&&this.bXa.add(Nb)};this.wI=Q;this.Gsc=za;this.bXa=new ib.a;nh.wZa||this.mf.RZe(this.vXf);this.Rxf();this.pca=this.pca.bind(this);
fb.$yb(this.pca);nh.wZa&&0===fb.Uu&&this.SM()}SM(){this.mf.RZe(this.vXf)}aza(){this.mf.Y$i(this.vXf)}get mf(){return this.wI.value}pca(Q,za){this.gyc=null;nh.wZa&&(1===za.vlb?this.aza():0===za.vlb&&this.SM())}get M4a(){this.gyc||(this.gyc=this.mf.ed.De(this.mf.ic).M4a,ra.ULS.shipAssertTag(34136386,336,!!this.gyc));return this.gyc}Pwk(Q){this.ra.addHandler("OnPageContentSizeChangeKey",Q)}jUk(Q){Q!==this.Oah&&(this.ra.raiseEvent("OnDocumentBottomChangeKey",new mq(Q,this.vKe)),this.Oah=Q)}sUk(Q){Q!==
this.Frd&&(-1!==this.Frd&&this.ra.raiseEvent("OnPageContentSizeChangeKey",new Dq(Q-this.Frd,Q,this.vKe)),this.Frd=this.M4a.clientHeight)}pUk(){let Q=!1;for(let za=this.bXa.count-1;0<=za;za--)this.bXa.J(za).hasChildNodes()&&(this.bXa.removeAt(za),Q=!0);return Q}Rxf(){Za.App.Lj.Bl.Ze(23).Fo(this.YWf)}}Object(e.a)(nh,"DocumentSizeManager",null,[]);var Th=c(53),nm=c(247);class wn{constructor(Q){this.wI=Q}get mf(){const Q=this.wI.value;ra.ULS.shipAssertTag(37820298,336,Q.Vi,"OutlineManager.PageView is not a PageView.");
return Q}Lge(Q,za){const fb=Th.a.Ni(wn.Sf.uB(Q),1);za+=fb;Q.De(this.mf.ic).htmlElement.firstChild.style.minHeight=za+"px"}z8h(){const Q=Pn.GraphIterator.$a(this.mf.ed);Q.Dp();Q.Qd();ra.ULS.shipAssertTag(37820299,336,10===Q.Nn.type);return Q.Nn}aai(){const Q=Pn.GraphIterator.$a(this.mf.ed);Q.Dp();Q.E_();ra.ULS.shipAssertTag(37820300,336,10===Q.Nn.type);return Q.Nn}J7l(Q){const za=Pn.GraphIterator.$a(this.mf.ed);za.Dp();za.Qd();let fb=za.Nn,Nb=null;for(;Q!==fb&&za.Rj();)Nb=fb,fb=za.Nn;ra.ULS.shipAssertTag(37820301,
336,10===za.Nn.type);return Nb}static get Sf(){return nm.a.instance}}Object(e.a)(wn,"OutlineManager",null,[1697]);class tk{constructor(Q){this.PAa=0;this.J1=null;this.Mdg=za=>{for(const fb of za.customData)this.showAdornmentText(fb)};this.Hb=Q}o8d(){this.J1||(this.J1=this.bIc())}XDd(){this.J1&&0<tk.YMc(this.J1).length&&this.Hb.Vb(this.J1);this.J1=null}bIc(){return Object.assign(new Pc.a(3,1,250,this.Mdg,166),{customData:[]})}Vag(Q){this.PAa=Q}$7c(Q){if(Q){Q.style.width=this.PAa+"px";if(this.J1)var za=
this.J1;else za=this.bIc(),this.Hb.Vb(za);tk.YMc(za).push(Q)}}SQc(Q){Q&&(Q.style.width="0px",this.Axf(Q))}vad(Q,za){za?this.$7c(Q):this.SQc(Q)}showAdornmentText(Q){Q.style.width===this.PAa+"px"&&(this.kNc(Q).style.visibility="visible")}Axf(Q){Q&&(this.kNc(Q).style.visibility="hidden")}kNc(Q){Q=Q.childNodes;ra.ULS.shipAssertTag(24958351,336,1===Q.length,"Expected 1 child div in the page adornment, found "+Q.length);return Q[0]}static YMc(Q){return Q.customData}}Object(e.a)(tk,"PageAdornmentAnimationManager",
null,[1694]);class sm{constructor(Q){this.am=Q;this.Q$=new Mc.a;this.R$=new Mc.a}XCa(Q){Q=Pn.GraphIterator.$a(Q);if(Q.Dp()&&Q.xq()){Q.Qd();do 10===Q.We&&this.DZf(Q.currentNode),Q.qt();while(8!==Q.We)}}yOb(Q){const za=Q.Ph;var fb=this.SEb(Q.VPb);if(!this.Q$.nb(fb))return ra.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+fb),!1;Q=this.Q$.J(fb);ra.ULS.shipAssertTag(24958353,336,this.R$.nb(fb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");
fb=this.R$.J(fb);return this.uxf(Q,za,fb)}xOb(Q){const za=Q.Ph;var fb=this.SEb(Q.VPb);if(!this.Q$.nb(fb))return ra.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+fb),!1;Q=this.Q$.J(fb);ra.ULS.shipAssertTag(24958355,336,this.R$.nb(fb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");fb=this.R$.J(fb);return this.glf(Q,za,fb)}zuf(Q){if(!Q)return ra.ULS.sendTraceTag(24979136,
336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var za=Q.KBd;if(!za)return ra.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",Q.Ph)),0;za=this.am.XDb(za);if(!za)return ra.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;za=this.am.Lga(za);const fb=1===Q.Ph;Q=!(Q.Ph%2);return 1===za?1:2===za?fb?2:1:3===za?Q?3:4:fb?2:Q?3:4}DZf(Q){if(10===Q.type){var za=new Mc.a,fb=this.am.XDb(Q);
ra.ULS.shipAssertTag(24958356,336,!!fb,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Nb=this.am.Lga(fb);Q=this.SEb(Q);this.Nmg(Q,Nb);this.Mmg(Q,za);fb=Pn.GraphIterator.$a(fb);if(fb.xq()){fb.Qd();do Q=fb.currentNode,Nb=this.am.fOc(Q),Q=this.am.Mmi(Q),za.add(Nb,Q),fb.qt();while(36===fb.We)}}}Nmg(Q,za){this.R$.nb(Q)?this.R$.Z(Q,za):this.R$.add(Q,za)}Mmg(Q,za){this.Q$.nb(Q)?this.Q$.Z(Q,za):this.Q$.add(Q,za)}SEb(Q){ra.ULS.shipAssertTag(24958358,
336,10===Q.type,"Expected node of type Outline but received node of type "+Q.type);return Q.ia(fm.a.Hia,0)}uxf(Q,za,fb){const Nb=1===za;za=!(za%2);switch(fb){case 2:if(Nb){if(Q.nb(2))return Q.J(2)}else if(Q.nb(0))return Q.J(0);break;case 3:if(za){if(Q.nb(1))return Q.J(1)}else if(Q.nb(0))return Q.J(0);break;case 4:if(Nb){if(Q.nb(2))return Q.J(2)}else if(za){if(Q.nb(1))return Q.J(1)}else if(Q.nb(0))return Q.J(0);break;case 1:if(Q.nb(0))return Q.J(0)}return!1}glf(Q,za,fb){const Nb=1===za;za=!(za%2);
switch(fb){case 2:if(Nb){if(Q.nb(5))return Q.J(5)}else if(Q.nb(3))return Q.J(3);break;case 3:if(za){if(Q.nb(4))return Q.J(4)}else if(Q.nb(3))return Q.J(3);break;case 4:if(Nb){if(Q.nb(5))return Q.J(5)}else if(za){if(Q.nb(4))return Q.J(4)}else if(Q.nb(3))return Q.J(3);break;case 1:if(Q.nb(3))return Q.J(3)}return!1}}Object(e.a)(sm,"PageAdornmentContentManager",null,[1693]);var Dl=c(1151);class fp{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd,De){this.Sng(Q,za,fb,bd,Yd,Fd,De);this.Ph=Q;this.Oq=za;this.Es=fb;this.VPb=
Nb;this.KBd=tc;this.Neb=bd;this.k9b=Yd;this.q6b=Fd;this.lZi=De}get top(){return this.Oq}get height(){return this.Es}l7c(Q){this.Oq!==Q&&(this.Neb.style.top=Q+"px",this.Oq=Q)}xag(Q){this.height!==Q&&(this.Neb.style.height=Q+"px",this.Es=Q)}Sng(Q,za,fb,Nb,tc,bd,Yd){ra.ULS.shipAssertTag(37244961,336,0<Q,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",Q);ra.ULS.shipAssertTag(37244962,336,0<=za,"PageAdornmentContainer: top parameter value {0} is unexpected value.",za);ra.ULS.shipAssertTag(37244963,
336,0<=fb,"PageAdornmentContainer: height parameter value {0} is unexpected value.",fb,za);ra.ULS.shipAssertTag(37244992,336,!!Nb,"PageAdornmentContainer: containerDomElement parameter is null.");ra.ULS.shipAssertTag(37244993,336,!!tc,"PageAdornmentContainer: headerLabelDomElement parameter is null.");ra.ULS.shipAssertTag(37244994,336,!!bd,"PageAdornmentContainer: footerLabelDomElement parameter is null.");ra.ULS.shipAssertTag(37244995,336,!!Yd,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}
Object(e.a)(fp,"PageAdornmentContainer",null,[1720]);class Uj{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd,De,Nf,Je,va,Oa){this.JXg="headerFooterTab";this.Uvd=null;this.Gs=!0;this.sCe=0;this.BHe=null;this.O1a=!1;this.oKb=Ba=>{this.jin(Ba.Mw);return!0};this.KB=()=>!0;this.DFb=()=>{this.r$e()&&(this.O1a=!1,this.HQo(),this.BHe=new Date)};this.sKb=Ba=>{this.O1a||this.sV.$7c(Ba.Mw);return!0};this.rKb=Ba=>{this.O1a||(Ba=Ba.Mw,this.tdg(Ba)||this.sV.SQc(Ba));return!0};this.aTn=()=>{let Ba=Array.dequeue(this.TOe);for(;Ba;)this.SM(Ba),
Ba=Array.dequeue(this.TOe);this.Uvd=null};this.wI=Q;this.hg=za;this.pE=fb;this.Mja=Nb;this.ga=tc;this.rk=bd;this.sV=Yd;this.$za=Fd;this.GKa=De;this.Hb=Nf;this.Ma=Je;this.TOe=[];this.F1=new Map;this.tI=va;this.ox=Oa;this.GKa.zzd(this.DFb);this.Fw=!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb.pJ;if(this.Kld=(this.pEe=!!this.Ma&&this.Ma.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&!!this.Ma&&this.Ma.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===Za.App.ya.DI.getLayoutBreakpoint()&&
(this.Gs=!1),Za.App.ya.DI.registerLayoutBreakpointChanged(this.JXg,Ba=>{switch(Ba){case "Small":this.ini();break;default:this.trj()}})}get mf(){return this.wI.value}trj(){try{this.Muo()}catch(Q){ra.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}ini(){try{this.Oqm()}catch(Q){ra.ULS.shipAssertTag(37244998,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}IYn(){for(const Q of this.F1.keys())this.Ice(Q)}XCa(){try{this.R1k()}catch(Q){ra.ULS.shipAssertTag(37244999,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}NFj(Q){try{this.fVo(Q)}catch(za){ra.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",za.message)}}dispose(){try{this.fPo(),this.MPo(),this.GKa&&this.GKa.faj(this.DFb)}catch(Q){ra.ULS.shipAssertTag(37245001,336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",Q.message,Q.stack)}}jin(Q){const za=this.bUc(Q),fb=this.R5h(Q);fb?(id.b("OpenHeaderFooterFromWebViewAdornment"),
Q=this.$za.zuf(fb),this.ga.Qb(za?Ag.a.xoe:Ag.a.Fbd,2,Q),this.O1a=!0):(ra.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+Q.id),this.ga.processAction(Ag.a.rWd,2))}fPo(){this.F1.forEach(Q=>{this.aza(Q)})}MPo(){this.Fw&&(this.Kld&&(Za.App.ya.DI.unregisterLayoutBreakpointChanged(this.JXg),this.Kld=!1),this.Fw=!1)}aza(Q){if(Q){var za=Q.k9b;Q=Q.q6b;uf.a.HFa(za)&&uf.a.HFa(Q)?(this.rk.rc(X.a.mR,za,this.sKb),this.rk.rc(X.a.mR,Q,this.sKb),this.rk.rc(X.a.eL,
za,this.rKb),this.rk.rc(X.a.eL,Q,this.rKb),this.hg.rc(X.a.click,za,this.oKb),this.hg.rc(X.a.click,Q,this.oKb),this.pE.rc(za,Uj.eKb),this.pE.rc(Q,Uj.eKb),this.Mja.rc(X.a.Kx,za,this.KB),this.Mja.rc(X.a.Kx,Q,this.KB)):ra.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}RKn(Q){this.TOe.push(Q);this.Uvd||(this.Uvd=new Pc.a(2,1,50,this.aTn),this.Hb.Vb(this.Uvd))}SM(Q){if(Q){var za=Q.k9b;Q=Q.q6b;uf.a.HFa(za)&&uf.a.HFa(Q)?(this.rk.lb(X.a.mR,
za,this.sKb),this.rk.lb(X.a.mR,Q,this.sKb),this.rk.lb(X.a.eL,za,this.rKb),this.rk.lb(X.a.eL,Q,this.rKb),this.hg.lb(X.a.click,za,this.oKb),this.hg.lb(X.a.click,Q,this.oKb),this.pE.lb(za,Uj.eKb),this.pE.lb(Q,Uj.eKb),this.Mja.lb(X.a.Kx,za,this.KB),this.Mja.lb(X.a.Kx,Q,this.KB)):ra.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}Muo(){if(!this.Gs){for(const Q of this.F1.values())Q.Neb.style.display="block";this.Gs=!0}}Oqm(){this.Gs&&
(this.F1.forEach(Q=>{Q.Neb.style.display="none"}),this.Gs=!1)}R1k(){this.$za.XCa(this.mf.ed)}fVo(Q){this.sV.o8d();var za=0;const fb=new ib.a;this.XCa();const Nb=this.$Zl();for(var tc of Q)Q=tc.Ph,this.Dwn(tc)||this.Ice(tc.Ph),this.F1.has(Q)?this.VRo(tc):this.o8k(tc),za=Q,fb.add(Q);for(tc=1;tc<=za;tc++)fb.contains(tc)||this.Ice(tc);for(za+=1;za<=Nb;za++)this.Ice(za);this.sV.XDd()}Dwn(Q){return this.F1.has(Q.Ph)?this.F1.get(Q.Ph).VPb.id===Q.VPb.id:!1}$Zl(){let Q=0;this.F1.forEach((za,fb)=>{fb>Q&&(Q=
fb)});return Q}o8k(Q){const za=Q.VPb.De(this.mf.ic);if(za){var fb=Q.Ph;Q=this.NHc(fb,Q.top,Q.height,za.$aa,Q.VPb,Q.KBd);this.RKn(Q);this.Elg(Q);this.dng(Q);this.Kld&&!this.Gs&&(Q.Neb.style.display="none");this.F1.set(fb,Q)}}NHc(Q,za,fb,Nb,tc,bd){const Yd=gf.b("div","","PageAdornmentContainer");Yd.style.top=za+"px";Yd.style.height=fb+"px";Nb.appendChild(Yd);this.Z4e(Yd,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Nb=this.Maf(Q);Yd.appendChild(Nb);const Fd=this.laf(Q);
Yd.appendChild(Fd);const De=this.baf(Q);Yd.appendChild(De);m.AFrameworkApplication.isRtl&&(Yd.classList.add("Rtl"),Fd.classList.add("Rtl"),De.classList.add("Rtl"));return new fp(Q,za,fb,tc,bd,Yd,Fd,De,Nb)}laf(Q){Q=gf.b("div","h"+Q,this.ox?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.tI&&(this.ox?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=Dl.a.Moe);const za=gf.b("span","","");za.innerText=WordEditorIntl.WordEditorStrings.l_Header;za.style.whiteSpace=
"nowrap";Q.appendChild(za);return Q}baf(Q){Q=gf.b("div","f"+Q,this.ox?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.tI&&(this.ox?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=Dl.a.Moe);const za=gf.b("span","","");za.innerText=WordEditorIntl.WordEditorStrings.l_Footer;za.style.whiteSpace="nowrap";Q.appendChild(za);return Q}Maf(Q){const za=gf.b("div","","PageAdornmentNumberLabel");za.innerText=Q.toString();return za}Z4e(Q,za,fb){if(!this.sCe){const Nb=
gf.b("p","","");Nb.innerText=za;Nb.style.whiteSpace="nowrap";Nb.style.visibility="hidden";Q.appendChild(Nb);za=gf.b("p","","");za.innerText=fb;za.style.whiteSpace="nowrap";za.style.visibility="hidden";Q.appendChild(za);this.sCe=Q.clientWidth;this.sV.Vag(this.sCe);Q.removeChild(Nb);Q.removeChild(za)}}Ice(Q){if(this.F1.has(Q)){var za=this.F1.get(Q);this.aza(za);uf.a.gx(za.Neb);this.F1.delete(Q)}}VRo(Q){if(this.F1.has(Q.Ph)){var za=this.F1.get(Q.Ph);za.l7c(Q.top);za.xag(Q.height);this.Elg(za);this.dng(za)}else ra.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}HQo(){this.sV.o8d();this.XCa();this.F1.forEach(Q=>{this.Elg(Q);this.dng(Q)});this.sV.XDd()}Elg(Q){const za=Q.k9b,fb=Q.q6b,Nb=this.$za.yOb(Q),tc=this.$za.xOb(Q);this.nXo(Q,Nb,tc);this.sV.vad(za,Nb);this.sV.vad(fb,tc)}nXo(Q,za=!0,fb=!0){const Nb=Q.k9b;Q=Q.q6b;3!==m.AFrameworkApplication.va.mode?(Nb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,Q.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Nb.title=
za?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,Q.title=fb?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}tdg(Q){const za=this.R5h(Q);return za?this.bUc(Q)?this.$za.yOb(za):this.$za.xOb(za):(ra.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}R5h(Q){Q=Q.id;Q=Q.substring(1,Q.length);Q=Number.parseInvariant(Q);return this.F1.has(Q)?this.F1.get(Q):(ra.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+Q),null)}bUc(Q){return Q.id.length?"h"===Q.id.substring(0,1):(ra.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}dng(Q){const za=Q.height;za<Uj.$bn?(Q.k9b.classList.add(Uj.rib),Q.q6b.classList.add(Uj.rib)):(Q.k9b.classList.remove(Uj.rib),Q.q6b.classList.remove(Uj.rib));za<Uj.acn?(Q.lZi.classList.add(Uj.rib),Q.Neb.classList.add(Uj.rib)):(Q.lZi.classList.remove(Uj.rib),Q.Neb.classList.remove(Uj.rib))}r$e(){return!this.BHe||
Z.a.nxf(this.BHe,500)}static eKb(){return!0}}Uj.rib="Hidden";Uj.$bn=120;Uj.acn=50;Object(e.a)(Uj,"PageAdornmentManager",null,[1691,9,1692]);class uk{constructor(Q,za){this.W8d=new ib.a;this.W8d.add(Q);this.W8d.add(za)}}Object(e.a)(uk,"PageElementManagerList",null,[]);var tl=c(59);class vk{constructor(Q,za,fb){this.Vm=Q;this.pXb=[];this.mK=za;this.tI=fb}W8i(){for(let Q=0,za=this.pXb.length;Q<za;Q++)uf.a.gx(this.pXb[Q]);Array.clear(this.pXb)}t7h(Q,za,fb,Nb,tc,bd){let Yd=Math.min(Nb.x-bd.x,tc.x-bd.x);
Nb=Math.min(bd.x+bd.width-(Nb.x+Nb.width),bd.x+bd.width-(tc.x+tc.width));za+=tc.y-bd.y;({aia:za,leftMargin:Yd,rightMargin:Nb}=this.gzk(za,Yd,Nb));Q=this.U4l(Q,Yd,Nb,Yd,Nb,fb);Q.style.top=za+"px";Q.style.zIndex="0";this.pXb.push(Q);tl.d(Q,!0);return Q}MQd(Q){return Q?Q.querySelector(".PageBreakBorderSpan"):null}U4l(Q,za,fb,Nb,tc,bd){return Q?this.ndm(za,fb,Nb,tc,bd):this.n5l(Nb,tc,bd)}gzk(Q,za,fb){za/=this.Vm.instance.ij;fb/=this.Vm.instance.ij;Q/=this.Vm.instance.ij;return{aia:Q,leftMargin:za,rightMargin:fb}}LJm(Q){return this.ECi(Q)&&
this.eZi(Q)?(Q=this.FEb(Q))&&Q.offsetParent?!1:!0:!1}KJm(Q){return!this.ECi(Q)||this.eZi(Q)?!1:!0}iR(){}FEb(Q){if(!Q.cYf)return null;let za=null;Q.yjb&&!Q.Yba?(Q=this.MQd(Q.cYf))&&(za=Q):za=Q.cYf;return za}ECi(Q){return Q.yjb&&!Q.Yba&&Q.paragraphNode?!0:!1}eZi(Q){Q=Q.paragraphNode;return!!Q&&!!Q.anchor}Uzh(Q,za){Q=ha.a.aEa(Q);za=ha.a.aEa(za);return(Q-za)/this.Vm.instance.ij}d5e(Q,za){Q=ha.a.aEa(Q);za=ha.a.aEa(za);return(Q-za)/this.Vm.instance.ij}o3d(){this.PFj(!1)}n3d(){this.PFj(!0)}PFj(Q){for(let za=
0,fb=this.pXb.length;za<fb;za++){const Nb=this.pXb[za];"PageEndMarker.Para"===Nb.id?vk.TFj(Nb,Q):"PageEndMarker.Table"===Nb.id&&vk.MGj(Nb,Q)}}n5l(Q,za,fb){if(!vk.n_b){vk.n_b=gf.b("div","PageEndMarker.Para","PageEndMarker");var Nb=gf.b("div","","Current FullWidth");this.tI&&(Nb.style.borderTopColor=this.mK.Jva());vk.n_b.appendChild(Nb);Nb=gf.b("div","","Stale LeftWing");const tc=gf.b("div","","Stale RightWing");this.tI&&(Nb.style.borderTopColor=this.mK.Jva(),tc.style.borderTopColor=this.mK.Jva());
vk.n_b.appendChild(Nb);vk.n_b.appendChild(tc)}Nb=vk.n_b.cloneNode(!0);Nb.childNodes[1].style.width=Q-10+"px";Nb.childNodes[2].style.width=za-10+"px";vk.TFj(Nb,fb);return Nb}ndm(Q,za,fb,Nb,tc){if(!vk.iyb){vk.iyb=gf.b("div","PageEndMarker.Table","PageEndMarker");var bd=gf.b("div","","Current LeftWing"),Yd=gf.b("div","","Current RightWing");this.tI&&(bd.style.borderTopColor=this.mK.Jva(),Yd.style.borderTopColor=this.mK.Jva());vk.iyb.appendChild(bd);vk.iyb.appendChild(Yd);bd=gf.b("div","","Stale LeftWing");
Yd=gf.b("div","","Stale RightWing");this.tI&&(bd.style.borderTopColor=this.mK.Jva(),Yd.style.borderTopColor=this.mK.Jva());vk.iyb.appendChild(bd);vk.iyb.appendChild(Yd)}bd=vk.iyb.cloneNode(!0);bd.childNodes[0].style.width=Q+"px";bd.childNodes[1].style.width=za+"px";bd.childNodes[2].style.width=fb-10+"px";bd.childNodes[3].style.width=Nb-10+"px";vk.MGj(bd,tc);return bd}static TFj(Q,za){za?vk.W7m(Q):vk.X7m(Q)}static X7m(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display=
"block"}static W7m(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="none"}static MGj(Q,za){za?vk.b8m(Q):vk.c8m(Q)}static c8m(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="block";Q.childNodes[3].style.display="block"}static b8m(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display="none";Q.childNodes[3].style.display="none"}}
vk.n_b=null;vk.iyb=null;Object(e.a)(vk,"PageEndDOMHelper",null,[]);class jo{constructor(Q,za){this.rwb=this.Vah=null;this.Vm=Q;this.ri=za}ngg(Q,za){try{this.zBo(Q,za)}catch(fb){ra.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",fb.message)}}o1k(Q,za,fb,Nb,tc,bd){this.ri.ie(()=>{try{this.p1k(Q,za,fb,Nb,tc,bd)}catch(Yd){ra.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",
Yd.message)}},"PEMPC:CP")}zBo(Q,za){this.Vah=Q;this.rwb=za}p1k(Q,za,fb,Nb,tc,bd){var Yd=this.Vah;if(Yd&&Q){var Fd=Yd.count,De=Q.count;if(Fd&&De){var Nf=this.pBl(Yd,Q);if(Nf.count){var Je=this.Vm.ij,va=this.T2b(Nf)/Je,Oa=this.IGh(Nf)/Je;Q=this.bMd(Yd,Q);if(Q.count){Yd=this.T2b(Q)/Je;Je=this.IGh(Q)/Je;var Ba=!0;for(var wa=0;wa<Nf.count;wa++)if(Nf.J(wa)){Ba=!1;break}var Ua=wa=0;this.rwb&&za&&(wa=this.jPk(this.rwb,za),Ua=za.count-this.rwb.count);ra.ULS.sendTraceTag(35005343,336,50,"{0}",{["HardPageBreakExists"]:Nb,
["EstimatedPageCount"]:Fd,["CalculatedPageCount"]:De,["InOrderAverageDelta"]:va,["InOrderStandardDeviation"]:Oa,["ShortestAverageDelta"]:Yd,["ShortestStandardDeviation"]:Je,["PositionsShouldBeUpdated"]:fb,["DocumentHeightChanged"]:tc,["DeltasAllZero"]:Ba,["HeaderFooterOpenSinceLastResponse"]:bd,["DeltaInViewport"]:wa,["ChangeInViewportMarkerCount"]:Ua});tc||bd||Ba||(ra.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),
za=Nf.toArray().toString(),fb=Q.toArray().toString(),ra.ULS.sendTraceTag(35726603,336,50,"{0} {1}",za,fb))}}}}else ra.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}jPk(Q,za){const fb=new ib.a;for(const Nb of Q)fb.add(Nb.top);if(!fb.count)return-1;Q=new ib.a;for(const Nb of za)Q.add(Nb.top);if(!Q.count)return-1;za=this.bMd(fb,Q);return this.T2b(za)/this.Vm.ij}T2b(Q){if(!Q.count)return 0;let za=0;for(let fb=
0;fb<Q.count;fb++)za+=Q.J(fb);return za/Q.count}IGh(Q){if(!Q.count)return 0;const za=this.T2b(Q);let fb=0;for(let Nb=0;Nb<Q.count;Nb++){const tc=Q.J(Nb)-za;fb+=tc*tc}return Math.sqrt(fb/Q.count)}pBl(Q,za){const fb=new ib.a;if(!Q.count||!za.count)return fb;Q.Sc((tc,bd)=>tc-bd);za.Sc((tc,bd)=>tc-bd);const Nb=Math.min(Q.count,za.count);for(let tc=0;tc<Nb;tc++){const bd=Math.abs(Q.J(tc)-za.J(tc));fb.add(bd)}return fb}bMd(Q,za){const fb=new ib.a;if(!Q.count||!za.count)return fb;var Nb=Q.count<=za.count;
const tc=Nb?Q:za;Q=Nb?za:Q;for(za=0;za<tc.count;za++){Nb=tc.J(za);let Yd=Math.abs(Nb-Q.J(0)),Fd=0;for(let De=1;De<Q.count;De++){var bd=Q.J(De);bd=Math.abs(Nb-bd);bd<Yd&&(Yd=bd,Fd=De)}fb.add(Yd);Q.removeAt(Fd)}return fb}}Object(e.a)(jo,"PageEndMarkerPositionComparer",null,[1682]);var aq=c(391),bq=c(585);class Wm{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd,De,Nf){this.Oq=Q;this._pageNumber=za;this.yjb=fb;this.Yba=Nb;this.cYf=tc;this.outlineNode=bd;this.outlineGroupNode=Yd;this.$9g=Fd;this.paragraphNode=De;this.IU=
Nf}get top(){return this.Oq}get Ph(){return this._pageNumber}get $vn(){return this.$9g}l7c(Q){this.Oq=Q}Mge(Q){this._pageNumber=Q}plj(Q){this.$9g=Q}}Object(e.a)(Wm,"PageEndMarker",null,[]);class wp{constructor(){this.qf=null;this.DPi=0}}Object(e.a)(wp,"PageEndMarkerToRestore",null,[]);class Yl{constructor(Q,za,fb,Nb,tc,bd,Yd){this.YWf=(Fd,De)=>{De.property===Ml.a.aJ&&(Fd=De.node)&&Fd.ia(Ml.a.aJ,!1)&&this.Kxd.contains(Fd.id)&&(De=Fd.De(this.mf.ic))&&(De=De.htmlElement)&&(this.Kxd.remove(Fd.id),this.bXa.add(De))};
this.wI=Q;this.Vm=za;this.DLa=fb;this.Wx=Nb;this.wMe=tc;this.BZ=bd;this.Vp=Yd;this.Lt=new ib.a;this.qXb=new ib.a;this.hyb=new Mc.a;this.Kxd=new bq.a(new aq.a);this.bXa=new ib.a;this.tXb=!!tc;this.Rxf()}get mf(){const Q=this.wI.value;ra.ULS.shipAssertTag(37052750,336,Q.Vi,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return Q}Had(Q){try{this.HUo(Q)}catch(za){this.Wx.iR(za.message+" "+za.stack),ra.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",
za.message)}}ltk(Q){try{this.mtk(Q)}catch(za){this.Wx.iR(za.message+" "+za.stack),ra.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",za.message)}}hQk(Q){try{return this.iQk(Q)}catch(za){this.Wx.iR(za.message+" "+za.stack),ra.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",za.message)}return!1}r5n(){try{this.s5n()}catch(Q){this.Wx.iR(Q.message+" "+Q.stack),ra.ULS.sendTraceTag(37052753,
336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",Q.message)}}dPc(){try{return this.c9l()}catch(Q){return this.Wx.iR(Q.message+" "+Q.stack),ra.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",Q.message),null}}Lmg(){try{this.jWo()}catch(Q){this.Wx.iR(Q.message+" "+Q.stack),ra.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",
Q.message)}}I6e(){try{return this.MVk()}catch(Q){return this.Wx.iR(Q.message+" "+Q.stack),ra.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",Q.message),!1}}uAm(Q){try{this.vAm(Q)}catch(za){this.Wx.iR(za.message+" "+za.stack),ra.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",za.message)}}HUo(Q){if(Q){this.sXk();for(let za=0;za<Q.length;za++){const fb=
za+1,Nb=this.f3k(Q[za],fb);this.Lt.add(Nb);this.hyb.add(fb,Nb)}}}vAm(Q){let za=!1;for(const fb of Q)if(fb)if(0<fb.FA)for(const Nb of fb.EAf)za=this.hzd(Nb,fb.outlineGroupNode)||za;else if(0>fb.FA){za=!0;for(const Nb of fb.lId)this.Eil(Nb.Ph)}za&&this.r6f()}mtk(Q){const za=this.V5h(Q.paragraphNode);this.hzd(Q,za)&&this.r6f()}Eil(Q){const za=Q-1;0>za||this.Lt.count<=za||(this.Lt.removeAt(za),this.hyb.nb(Q)&&this.hyb.remove(Q))}c9l(){const Q=new ib.a;for(const za of this.Lt)this.Vac(za)&&Q.add(za);return Q}hzd(Q,
za){if(!Q)return ra.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;za=this.c3k(Q,za);Q=Q.rFm?-1:Q.Ph;let fb=!1,Nb;this.hyb.nb(Q)?(Nb=this.hyb.J(Q).Ph,za.Mge(Nb),this.Lt.Z(Nb-1,za),this.hyb.remove(Q)):(Nb=za.Ph,this.Lt.insert(Nb-1,za),fb=!0);return fb}f3k(Q,za){return new Wm(0,za,Q.HardBreak,!1,null,null,null,0,null,null)}c3k(Q,za){const fb=Q.wmb,Nb=Q.Ph,tc=Q.IU,bd=!!tc&&tc.HardBreak,Yd=Q.Yba,Fd=Q.paragraphNode,De=this.nci(za),
Nf=Q.outlineNode;var Je=this.qsf(Nf);if(!Je)return ra.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let va=null;bd&&(va=this.Wx.MQd(Q.wmb));Q=this.Wx.Uzh(va||fb,De);Je=this.Wx.d5e(va||fb,Je);return new Wm(Je,Nb,bd,Yd,fb,Nf,za,Q,Fd,tc)}iQk(Q){this.qXb=new ib.a;this.tXb&&this.wMe.reset();this.DXn();this.yxo();this.hzk();this.XPk(Q);return 0<this.qXb.count}DXn(){for(let Q=0;Q<this.Lt.count;Q++){const za=this.Lt.J(Q);this.Wx.LJm(za)?
this.o6m(za):(this.Wx.KJm(za)||this.Vac(za)&&!this.qsf(za.outlineNode))&&this.e$i(za)}}hzk(){let Q=0,za=null;var fb=0;let Nb=0;for(let tc=0;tc<this.Lt.count;tc++){const bd=this.Lt.J(tc);this.Vac(bd)&&(bd.yjb&&(Nb+=this.Rzh(bd,fb,Nb)),za&&za.id===bd.outlineNode.id||(za=bd.outlineNode,Nb=Q=0),bd.yjb&&!bd.Yba&&(Q=this.VPk(bd)),fb=bd.top+Q+Nb,bd.l7c(fb))}this.Rzh(null,fb,Nb);this.vXn()}Rzh(Q,za,fb){let Nb=null;this.tXb&&(Nb=this.wMe.YPk(Q,za,fb));return Nb?Nb.delta:0}s5n(){if(this.qXb){for(let Q=0;Q<
this.qXb.count;Q++){const za=this.qXb.J(Q);uf.a.Ffo(za.qf,za.DPi)}this.tXb&&this.wMe.o5n()}}jWo(){if(!this.tXb){var Q=this.DLa.aai();if(this.Lt.count){var za=this.DLa.z8h();for(let tc=0;tc<this.Lt.count;tc++){var fb=this.Lt.J(tc);if(this.Vac(fb)&&fb.Yba){fb=this.DLa.J7l(fb.outlineNode);var Nb=0<tc?this.Lt.J(tc-1).outlineNode:za;Nb=tc&&fb.id===Nb.id?this.Lt.J(tc-1).top:0;this.DLa.Lge(fb,Nb)}}za=this.Lt.J(this.Lt.count-1);za.Yba?this.DLa.Lge(Q,0):this.DLa.Lge(Q,za.top)}else this.DLa.Lge(Q,0)}}yxo(){this.Lt.Sc((Q,
za)=>Q.Ph-za.Ph)}r6f(){for(let Q=0;Q<this.Lt.count;Q++)this.Lt.J(Q).Mge(Q+1)}VPk(Q){return Q?this.Tzh(Q)-Q.top:(ra.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}fQk(Q){if(!Q)return 0;const za=this.nci(Q.outlineGroupNode);return za?this.Wx.Uzh(this.Wx.FEb(Q),za):0}Tzh(Q){if(!Q)return 0;const za=this.Wx.FEb(Q);Q=this.qsf(Q.outlineNode);return Q?this.Wx.d5e(za,Q):(ra.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),
0)}vXn(){let Q=0,za=!1,fb=null,Nb=!1;for(let tc=this.Lt.count-1;0<=tc;tc--){const bd=this.Lt.J(tc);this.Vac(bd)&&(fb&&fb.id===bd.outlineNode.id||(za=!fb,fb=bd.outlineNode,Q=this.E4l(fb)),bd.yjb?(za=!1,Q=bd.top):this.tXb&&za||!(bd.top>Q)||(this.e$i(bd),uf.a.gx(this.Wx.FEb(bd)),Nb=!0))}Nb&&this.r6f()}e$i(Q){this.Lt.contains(Q)&&(this.tXb&&this.BZ.JYn(Q),this.Lt.remove(Q))}Vac(Q){return Q?(Q=this.Wx.FEb(Q))&&Q.offsetParent?!0:!1:(ra.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),
!1)}MVk(){let Q=!1;for(let za=this.bXa.count-1;0<=za;za--)this.bXa.J(za).hasChildNodes()&&(this.bXa.removeAt(za),Q=!0);return Q}o6m(Q){(Q=this.V5h(Q.paragraphNode))&&(this.Kxd.contains(Q.id)||this.Kxd.add(Q.id))}Rxf(){this.Vp&&this.Vp.Ze(23).Fo(this.YWf)}XPk(Q){for(let za=this.Lt.count-1;0<=za;za--){const fb=this.Lt.J(za);this.Vac(fb)&&this.WPk(fb,Q)}}WPk(Q,za){const fb=this.Tzh(Q),Nb=this.fQk(Q);Q.yjb?(Q.l7c(fb),Q.plj(Nb)):(za=za?fb-Q.top:Nb-Q.$vn,Q.l7c(fb-za),Q.plj(Nb-za),1<Math.abs(za)&&this.iko(this.Wx.FEb(Q),
za))}qsf(Q){if(!Q)return null;Q=Q.De(this.mf.ic);return Q?Q.htmlElement:(ra.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}nci(Q){return Q?(Q=Q.De(this.mf.ic))?Q.htmlElement:null:null}V5h(Q){Q=Pn.GraphIterator.$a(Q);return Q.zb(23)?Q.hd(23):null}D4l(Q){if(!Q)return null;Q=Q.De(this.mf.ic);return Q?ha.a.getElementBounds(Q.htmlElement):(ra.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}E4l(Q){return(Q=
this.D4l(Q))?Q.height/this.Vm.ij:0}iko(Q,za){za=(uf.a.ITl(Q)-za)*this.Vm.ij;this.qXb.add(Object.assign(new wp,{qf:Q,DPi:za}))}sXk(){this.Lt=new ib.a;this.hyb=new Mc.a}}Object(e.a)(Yl,"PageEndMarkerPositionUpdater",null,[1681]);var Nc=c(365),co=c(32),Nk=c(350),en=c(21);class Dm{constructor(Q,za,fb,Nb,tc,bd,Yd=!1,Fd=!1,De=!1,Nf=!1,Je=!1){this.Sng(za,fb,Nb,tc,bd,De,Je);this.position=Q;this.Ph=za;this.paragraphNode=fb;this.IU=Nb;this.wmb=tc;this.outlineNode=bd;this.Y2a=Yd;this.aCi=Fd;this.rFm=De;this.Yba=
Nf;this.GZd=Je}Mge(Q){this.Ph=Q}Sng(Q,za,fb,Nb,tc,bd,Yd){Yd||(ra.ULS.shipAssertTag(38326881,336,!!tc,"PageEndDetails: outlineNode parameter value is null."),ra.ULS.shipAssertTag(24126528,336,0<=Q,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",Q),ra.ULS.shipAssertTag(24126529,336,!!za||bd,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),ra.ULS.shipAssertTag(24126530,336,!!fb||bd,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),
ra.ULS.shipAssertTag(24126531,336,!!Nb||bd,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static n$k(Q,za){return Dm.J$e(0,Q,null,za,!0,!1)}static o$k(Q){return Dm.J$e(0,0,null,Q,!1,!0)}static J$e(Q,za,fb,Nb,tc,bd){return new Dm(Q,za,null,null,fb,Nb,tc,bd,!0)}static F3b(Q,za){return new Dm(0,Q,null,za,null,null,void 0,void 0,void 0,void 0,!0)}}Object(e.a)(Dm,"PageEndDetails",null,[]);class Ji{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd,De,Nf,Je,va,Oa,Ba,wa,Ua,zb,
Qb,Xb,Dc){this.Esa=!0;this.owe=0;this.xqd=this.tCe=this.uCe=this.qye=this.uMe=this.dCe=!1;this.xsd=this.Owb=null;this.HFe=!0;this.dKb=()=>{this.o3d()};this.UTf=()=>{this.uCe=!1};this.VTf=()=>{this.tCe=this.uCe=!0};this.kpn=(Fc,Zc)=>{1>=Math.abs(Zc.delta)||(this.qye=!0,this.OFj(!Zc.vPi))};this.uRn=Fc=>{Fc===this.Owb&&(this.Owb=null);if(this.Esa){var Zc=Fc.customData;if(Fc=this.cXa.get(Zc.id))for(this.cXa.Z(Zc.id,new ib.a),ra.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",
Fc.count,Zc.id),this.S$&&this.S$.XCa(),Zc=0;Zc<Fc.count;Zc++){const kd=Fc.J(Zc),rd=kd.IU;rd.HardBreak||(uf.a.gx(kd.wmb),this.d6f(rd))}}};this.tRn=()=>{this.xsd=null;this.Esa&&this.bia&&0<this.bia.count&&(ra.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.Had(this.bia.toArray(),this.Esa))};this.wI=Q;this.ni=za;this.S$=fb;this.GN=Nb;this.h$g=tc;this.xbb=bd;Ji.Wx=Fd;this.BWg=De;this.zI=Nf;this.Hb=Je;this.p3j=va;this.he=Ba;this.BZ=Ua;this.yMe=zb;this.vXb=Qb;
this.kZ=Xb;this.ZWb=new Nc.a;this.rXb=new ib.a;this.bia=new ib.a;this.cXa=new Nc.a;this.rN=Oa;this.FS=Dc;this.b9d=this.b9d.bind(this);this.d9d=this.d9d.bind(this);this.qce=this.qce.bind(this);this.pca=this.pca.bind(this);this.rN.BDc(this.dKb);this.vMe=!1;wa&&(wa.gqh(this.VTf),wa.zzd(this.UTf));Yd&&Yd.Pwk(this.kpn);this.FS.$yb(this.pca)}get SEf(){return this.HFe}get mf(){return this.wI.value}get uj(){return this.ni.value}Had(Q,za){const fb=this.he.Zf("Task","UpdateMarkers");this.xBo();this.Esa=za;
Ji.Wx.W8i();this.ZWb=new Nc.a;this.rXb.clear();this.bia.clear();this.cXa=new Nc.a;this.HFe=this.dCe=!1;this.GN&&this.GN.Had(Q);this.uul();this.owe=Q.length;this.BZ&&this.BZ.reset(Q);this.S$&&this.S$.XCa();for(const Nb of Q)this.bia.add(Nb),this.d6f(Nb);za&&this.GN&&this.yMe&&this.yMe.isEnabled&&(Q=this.GN.dPc(),this.yMe.BCa(Q));this.n1k();this.qye=this.uMe=!1;this.tCe=this.uCe;Do.WoncaApp.instance.Iib&&Ji.Kyf&&this.GN.Lmg();this.xbb.eVo(this.GN.dPc(),this.bia.count);this.HFe=!0;this.kZ.ymg();fb.stop();
ra.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:fb.si,["RenderedLineCount"]:this.owe,["AvgDurationPerPageInMs"]:fb.si/this.vci()})}xci(){const Q=this.GN.dPc();if(!Q)return null;const za=uf.a.CX(),fb=new ib.a;for(const Nb of Q)this.yNm(Nb,za)&&fb.add(Nb);return fb}yNm(Q,za){if(!Q)return!1;Q=Ji.Wx.FEb(Q);if(!Q)return!1;Q=ha.a.aEa(Q);return 0<=Q&&Q<=za}U2h(){const Q=new ib.a;if(!this.cXa)return ra.ULS.sendTraceTag(35005382,336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),
Q;const za=this.cXa.keys;for(let tc=0;tc<za.length;tc++){var fb=za.J(tc);if(fb=this.cXa.J(fb))for(let bd=0;bd<fb.count;bd++){var Nb=fb.J(bd);Nb.IU.HardBreak||Nb.wmb.classList.contains("Hidden")||(Nb=ha.a.aEa(Nb.wmb),Q.add(Nb))}}return Q}xBo(){const Q=this.U2h(),za=this.xci();this.h$g.ngg(Q,za);this.vXb&&this.vXb.isEnabled&&this.vXb.ngg(za)}n1k(){if(!(25<this.vci())){var Q=this.U2h(),za=this.xci();this.h$g.o1k(Q,za,this.uMe,this.dCe,this.qye,this.tCe);this.vXb&&this.vXb.isEnabled&&this.vXb.BCa(za)}}pca(){this.S$.IYn();
this.FQh()}FQh(){this.xqd&&(this.mf.Y$i(this.b9d),this.mf.C_n(this.d9d),this.mf.i_n(this.qce),this.xqd=!1)}uul(){this.xqd||(this.mf.RZe(this.b9d),this.mf.uxk(this.d9d),this.mf.aqh(this.qce),this.xqd=!0)}d6f(Q){if(this.vMe)return!0;Q=this.A0n(Q);if(!Q)return!1;this.BZ&&this.BZ.imm(Q);this.GN&&(this.GN.ltk(Q),this.xbb.KFj(this.GN.dPc()),Do.WoncaApp.instance.Iib&&Ji.Kyf&&this.GN.Lmg());return!0}A0n(Q){let za=this.JO(Q.ParaId);if(!za)return null;if(!za.anchor||!za.hj)return this.Yoh(Q,za),null;let fb,
Nb;if(Q.HardBreak){var tc=hf.ParagraphReader.ig(za,!0,!0,!0);this.Jxn(tc)&&(za=tc);if(!({aia:tc,outlineGroupNode:fb,umb:Nb}=this.lMo(Q,za)).returnValue)return null;this.dCe=!0}else if(!({X8d:tc,outlineGroupNode:fb,umb:Nb}=this.B0n(Q,za)).returnValue)return null;return this.hzd(za,Q,tc,fb,Nb)}Jxn(Q){return Q?(Q=Q.De(this.mf.ic))?!!Ji.Wx.MQd(Q.htmlElement):!1:!1}B0n(Q,za){var fb=Q.PageEndType;let Nb,tc=0,bd=null;if(!fb){if(!({aia:Q,MXf:Nb}=this.yci(Q,za)).returnValue)return{returnValue:!1,X8d:tc,outlineGroupNode:bd,
umb:null}}else if(!({aia:Q,Eke:Nb}=this.V4l(Q,za)).returnValue)return{returnValue:!1,X8d:tc,outlineGroupNode:bd,umb:null};var Yd=Pn.GraphIterator.$a(za);Yd.yd();bd=Yd.hd(23);za=bd.De(this.mf.ic).getBounds();Yd=Yd.GSa().De(this.mf.ic);if(!Yd)return ra.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.mf.ic),{returnValue:!1,X8d:tc,outlineGroupNode:bd,umb:null};const Fd=Yd.getBounds();tc=Q-za.y;fb=Ji.Wx.t7h(fb,tc,this.Esa,Nb,za,Fd);Yd.$aa.appendChild(fb);return{returnValue:!0,
X8d:tc,outlineGroupNode:bd,umb:fb}}lMo(Q,za){let fb=null;const Nb=za.De(this.mf.ic);var tc=0;let bd=null;if(this.V_d(Q,Nb,za))return{returnValue:!1,aia:tc,outlineGroupNode:fb,umb:bd};fb=Ji.cPi(za);const Yd=fb.De(this.mf.ic);if(!Yd)return ra.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.mf.ic),{returnValue:!1,aia:tc,outlineGroupNode:fb,umb:bd};tc=Yd.getBounds();tc=bo.a.Pq(Nb,Q.CP).y-tc.y;bd=this.bXl(za);return{returnValue:!0,aia:tc,outlineGroupNode:fb,umb:bd}}bXl(Q){return Q.De(this.mf.ic).htmlElement}JO(Q){const za=
this.zI.Ihb(Q);if(za!==fh.a.nil){const fb=this.uj.Db(za);if(fb)return fb}ra.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",Q,za);return null}yci(Q,za){const fb=Q.CP;let Nb=0,tc=null;const bd=za.De(this.mf.ic);if(this.V_d(Q,bd,za))return{returnValue:!1,aia:Nb,MXf:tc};tc=bd.getBounds();Nb=fb?this.BWg(Object(lb.a)(100,bd),fb):tc.y-this.p3j(bd);return{returnValue:!0,aia:Nb,MXf:tc}}V4l(Q,za){let fb=null,Nb=0;var tc=Q.PageEndType;let bd=Pn.GraphIterator.$a(za);
bd.yd();if(!co.TableReader.Yw(bd))return ra.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",Q.ParaId),{returnValue:({aia:Nb,MXf:fb}=this.yci(Q,za)).returnValue,aia:Nb,Eke:fb};if(1===tc){en.returnToContainingRow(bd);tc=bd.currentNode.De(this.mf.ic);if(this.V_d(Q,tc,za))return{returnValue:!1,aia:Nb,Eke:fb};Nb=tc.getBounds().y}else{tc=za.De(this.mf.ic);if(this.V_d(Q,tc,za))return{returnValue:!1,aia:Nb,Eke:fb};Nb=this.BWg(Object(lb.a)(100,
tc),Q.CP)}--Nb;za=null;do Q=za,za=bd.hd(14);while(za);bd=Pn.GraphIterator.$a(Q);bd.yd();en.moveToFirstRow(bd);fb=bd.currentNode.De(this.mf.ic).getBounds();return{returnValue:!0,aia:Nb,Eke:fb}}V_d(Q,za,fb){if(!za||za.dxa(16))return this.Yoh(Q,fb),!0;za=za.getBounds();return za.width||za.height?!1:(this.joh(Q),!0)}joh(Q){this.rXb.contains(Q)||this.rXb.add(Q)}Yoh(Q,za){za=za.id;let fb;({value:fb}=this.ZWb.Dc(za)).returnValue||(fb=new ib.a,this.ZWb.Z(za,fb));fb.add(Q)}b9d(){const Q=new ib.a;for(let za=
this.rXb.count-1;0<=za;za--){const fb=this.rXb.J(za);this.d6f(fb)||Q.add(fb)}this.rXb=Q;this.I6e()}I6e(){this.GN&&this.GN.I6e()&&this.OFj(!1)}OFj(Q){this.GN&&(this.GN.hQk(Q)&&(this.uMe=!0),this.GN.r5n(),this.xbb.KFj(this.GN.dPc()),Do.WoncaApp.instance.Iib&&Ji.Kyf&&this.GN.Lmg())}d9d(Q,za){try{const fb=za.id;if(this.ZWb.nb(fb)){const Nb=this.ZWb.J(fb);for(Q=0;Q<Nb.count;Q++)this.joh(Nb.J(Q));this.ZWb.remove(fb)}}catch(fb){}}o3d(){this.Esa&&(this.Esa=!1,Ji.Wx.o3d())}n3d(){this.Esa||(this.Esa=!0,Ji.Wx.n3d())}Nuo(){this.vMe=
!1;this.bia&&this.Had(this.bia.toArray(),this.Esa);this.S$&&this.S$.trj()}Pqm(){this.vMe=!0;Ji.Wx.W8i();this.S$&&this.S$.ini();this.BZ&&this.BZ.Qqm()}hzd(Q,za,fb,Nb,tc){const bd=this.bia.indexOf(za)+1;if(0>bd)return null;const Yd=Yi.WordSectionNavigator.instance.wJ(Q),Fd=this.Yba(za,Q);Q=new Dm(fb,bd,Q,za,tc,Yd,!Q||!za||!tc,!1,!1,Fd);this.cXa.nb(Nb.id)||this.cXa.Z(Nb.id,new ib.a);this.cXa.J(Nb.id).add(Q);return Q}Yba(Q,za){if(!Q||!Q.HardBreak)return!1;Q=Pn.GraphIterator.$a(za);Q.zb(7);if(Q.hJ())return!1;
Q.hd(23);return Q.hJ()?!1:!0}o7i(Q){this.Esa&&(Q.anchor&&Q.hj?!(Q=Ji.cPi(Q))||this.Owb&&this.Owb.customData&&this.Owb.customData.id===Q.id||(this.Owb=Object.assign(new Pc.a(3,1,500,this.uRn),{customData:Q}),this.Hb.Vb(this.Owb)):ra.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}qce(){this.Esa&&!this.xsd&&this.bia&&0<this.bia.count&&(this.xsd=new Pc.a(3,1,500,this.tRn),this.Hb.Vb(this.xsd))}dispose(){this.mf&&this.FQh();this.FS.J5f(this.pca);
this.rN.dde(this.dKb)}static get Kyf(){null==Ji.uDe&&(Ji.uDe=m.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return Ji.uDe}static YWl(Q){let za=0;try{const fb=Q.htmlElement,Nb=uf.a.OM(fb.firstChild.style.marginTop);Q=0;const tc=Ji.Usf(fb.parentNode);if(tc){const bd=tc.firstChild;bd&&bd.classList.contains("ParaWrappingDiv")&&(Q=uf.a.OM(bd.firstChild.style.marginBottom))}za=Math.max(Nb,Q)/2}catch(fb){}return za}static Usf(Q){let za=Q.previousSibling;if(!za){var fb=Q.parentNode;uf.a.gEf(fb)&&
(fb=fb.parentNode)&&(za=fb.previousSibling)}if(!za&&(Q=Q.parentNode,Q.classList.contains("OutlineGroup")||ra.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",Q.tagName,Q.className),(Q=Q.previousSibling)&&Q.hasChildNodes())){za=Q.lastChild;do{if(za.classList.contains("OutlineElement")||uf.a.gEf(za)&&za.classList.contains(Nk.a.Hcc))break;za=za.previousSibling}while(za)}if(za){if(za.classList.contains(Nk.a.Hcc))return za.lastChild.lastChild;if(uf.a.gEf(za))return za.lastChild}return za}static cPi(Q){Q=
Pn.GraphIterator.$a(Q);return Q.zb(23)?Q.hd(23):null}vci(){return this.owe+1}}Ji.Wx=null;Ji.uDe=null;Object(e.a)(Ji,"PageEndMarkers",null,[1679,1680,9]);var Y=c(141);class la{constructor(Q,za,fb){this.Xvn=".Outline";this.wI=Q;this.Vm=za;this.Wx=fb}get mf(){const Q=this.wI.value;ra.ULS.shipAssertTag(38416594,336,Q.Vi,"Invalid PageView.");return Q}c7b(Q){return(Q=Q.outlineNode)?this.lci(Q):(ra.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),null)}lci(Q){let za,fb;return(za=Q.De(this.mf.ic))&&
(fb=za.htmlElement)?fb.querySelector(this.Xvn):(ra.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}U5h(Q){Q=$p.OutlineElementNavigator.Il(Q.paragraphNode);let za;return Q&&(za=Q.De(this.mf.ic))?za.htmlElement:(ra.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}Izh(Q,za){const fb=this.thm(Q);return this.bQk(Q,za)-fb}o7h(Q){return this.rci(Q.outlineNode,Q.Ph)}rci(Q,za){if(!Q)return-1;var fb=Q.ia(fm.a.lv,-1);fb=Th.a.Ni(fb,1);var Nb=Q.ia(fm.a.marginTop,
-1);Nb=Th.a.Ni(Nb,1);Q=Q.ia(fm.a.marginBottom,-1);Q=Th.a.Ni(Q,1);return 1===za?fb-Q:fb-(Nb+Q)}Cil(Q){Q&&uf.a.gx(Q.wmb)}Osf(Q){if(Q.aCi||Q.Yba)return 0;if(Q.Y2a)return Q=this.c7b(Q),ha.a.getElementBounds(Q).height/this.Vm.ij;const za=this.c7b(Q);return this.Wx.d5e(this.wci(Q),za)}a8k(Q,za,fb){fb=fb.De(this.mf.ic).getBounds();Q=Q.De(this.mf.ic);const Nb=Q.getBounds();fb.y=Nb.y;za=this.Wx.t7h(0,za*this.Vm.ij,!1,fb,fb,Nb);Q.$aa.appendChild(za);return za}Kri(Q,za){if(Q&&!Q.GZd)if(Q.Y2a){if(Q=this.c7b(Q))Q.style.paddingBottom=
za+"px"}else if(Q.IU&&Q.IU.HardBreak)if(Q.Yba){if(Q=this.Odi(Q))Q.style.paddingBottom=za+"px"}else{if(Q=this.U5h(Q))Q.style.paddingTop=za+"px"}else ra.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}Wqh(Q,za){za=this.c7b(za);Q=this.c7b(Q);return ha.a.aEa(za)-ha.a.aEa(Q)}Pdi(Q){Q=Pn.GraphIterator.$a(Q.outlineNode);Q.zb(7);return Q.hJ()}Xyi(Q){if(!Q||Q.GZd)return!1;if(Q.Y2a||Q.aCi)return!0;Q=this.wci(Q);return!!Q&&uf.a.P7(Q)}iR(Q){this.Wx.iR(Q)}Odi(Q){return(Q=
this.Pdi(Q))?(Q=Q.Qj(this.mf.ic).htmlElement,Q?Q:(ra.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}wci(Q){return Q.IU&&Q.IU.HardBreak&&!Q.Yba?this.Wx.MQd(Q.wmb):Q.wmb}thm(Q){if(Q.Y2a){Q=this.c7b(Q);if(!Q)return ra.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),-1;Q=Y.a.sB(Q);return uf.a.Jga(Q.paddingBottom)}if(Q.IU&&Q.IU.HardBreak){if(Q.Yba)return(Q=this.Odi(Q))?uf.a.Jga(Q.style.paddingBottom):-1;Q=this.U5h(Q);return Q?uf.a.Jga(Q.style.paddingTop):(ra.ULS.shipAssertTag(38336529,
336,!0,"Containing outline element Dom is null."),-1)}return 0}bQk(Q,za){return this.Osf(Q)-za}}Object(e.a)(la,"PageFullHeightDOMHelper",null,[]);class mb{constructor(){this.delta=this.DJj=this.FA=0;this.$ha=null;this.lOa=this.c2i=0;this.outlineGroupNode=null;this.$Ca=0;this.EAf=new ib.a;this.lId=new ib.a;this.Ien=new ib.a}}Object(e.a)(mb,"PageFullHeightInfo",null,[]);class ec{constructor(Q,za){this.cBa=Q;this.Xx=za}Szh(Q,za){try{return this.ZPk(Q,za)}catch(fb){return this.Xx.iR(fb.message+" "+fb.stack),
ra.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",fb.message),null}}ZPk(Q,za){ra.ULS.shipAssertTag(38416596,336,Q.Y2a||Q.IU.HardBreak);const fb=this.Xx.Osf(Q),Nb=this.Xx.Izh(Q,za),tc=this.cBa.Fzh(Q,Nb);Q=Object.assign(new mb,{$Ca:Nb,lOa:tc,$ha:Q});this.STo(Q);Q.DJj=Q.lOa-Q.$Ca;Q.delta=za+tc+Q.delta-fb;return Q}STo(Q){Q.$Ca>Q.lOa?this.TTo(Q):0>Q.$Ca&&this.nmg(Q)}nmg(Q){let za=Q.$ha.Ph;for(;0>Q.$Ca;)Q.FA--,Q.delta-=this.cBa.PNc(za),Q.$Ca+=this.cBa.PNc(za-
1),za--;Q.lOa=this.cBa.PNc(za)}TTo(Q){const za=this.Xx.o7h(Q.$ha);Q.FA=Math.floor((Q.$Ca-Q.lOa)/za)+1;Q.delta=Q.FA*za;Q.$Ca-=Q.lOa+(Q.FA-1)*za;Q.lOa=za}}Object(e.a)(ec,"PageFullHeightInfoCalculator",null,[]);class rc{constructor(Q,za,fb,Nb){this.rYa=0;this.DMa=null;this.cBa=Q;this.Uvb=za;this.AW=fb;this.Xx=Nb;this.gch=new ib.a}get DY(){return this.gch}imm(Q){try{this.vwf(Q)}catch(za){this.Xx.iR(za.message+" "+za.stack),ra.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",
za.message)}}reset(Q){try{this.K3n(Q)}catch(za){this.Xx.iR(za.message+" "+za.stack),ra.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",za.message)}}Qqm(){try{this.Rqm()}catch(Q){this.Xx.iR(Q.message+" "+Q.stack),ra.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",Q.message)}}wAm(Q){try{this.xAm(Q)}catch(za){this.Xx.iR(za.message+" "+za.stack),ra.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",
za.message)}}JYn(Q){try{this.KYn(Q)}catch(za){this.Xx.iR("Pagination: "+za.message+" "+za.stack),ra.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",za.message)}}ixm(){var Q=this.AW.Qpf(),za=this.AW.T$h();Q=Dm.o$k(Q);za=Dm.n$k(this.rYa,za);this.DY.Z(0,Q);this.vwf(za)}O3n(){var Q=Yi.WordSectionNavigator.instance.T$h();(Q=this.Xx.lci(Q).parentNode)&&""!==Q.style.minHeight&&(Q.style.minHeight="")}fym(Q){this.gch=new ib.a;this.DY.add(null);
for(let za=0;za<Q.length;za++){const fb=Dm.F3b(za+1,Q[za]);this.DY.add(fb)}this.DY.add(Dm.F3b(Q.length+1,null))}Rxm(Q){this.cBa.V3n(Q)}s4n(){if(this.DY)for(const Q of this.DY)Q&&this.Twi(Q)&&this.Xx.Kri(Q,0)}vwf(Q){const za=this.D7l(Q);if(this.Xx.Xyi(za)){let fb=this.Xx.Osf(za);Q.outlineNode!==za.outlineNode&&(fb+=this.Xx.Wqh(Q,za));this.hPk(Q,fb);this.Twi(Q)&&this.e6f(Q,fb)}else this.DMa.add(Q),20<this.DMa.count&&ra.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.DMa.count);
this.DY.Z(Q.Ph,Q);this.$lm(Q)}Rqm(){this.s4n()}K3n(Q){this.rYa=Q.length+1;this.DMa=new ib.a;this.fym(Q);this.Rxm(this.rYa);this.ixm();this.O3n()}xAm(Q){this.cBa.hVo(Q);for(const za of Q){if(!za){ra.ULS.sendTraceTag(38916955,336,10,"info is null.");return}if(0<za.FA){Q=za.$ha.Ph;for(const fb of za.EAf)this.DY.insert(Q,fb),Q++}else if(0>za.FA)for(const fb of za.lId)this.DY.remove(fb),this.DMa.contains(fb)&&this.DMa.remove(fb)}this.hbj()}KYn(Q){Q=Q.Ph;this.cBa.LYn(Q);this.DY.removeAt(Q);for(const za of this.DMa)za.Ph===
Q&&this.DMa.remove(za);this.hbj()}hPk(Q,za){za=this.Xx.Izh(Q,za);this.cBa.Fzh(Q,za)}e6f(Q,za){Q.IU&&Q.IU.HardBreak||this.Uvb.e6f(Q,za)}$lm(Q){Q=Q.Ph+1;for(const za of this.DMa)if(za&&za.Ph===Q){this.vwf(za);this.DMa.remove(za);break}}hbj(){for(let Q=0;Q<this.DY.count;Q++){const za=this.DY.J(Q);za&&za.Mge(Q)}}Twi(Q){Q=this.O4l(Q);return 2===Q||1===Q}D7l(Q){return this.DY.J(Q.Ph-1)}O4l(Q){return Q.Y2a?2:Q.IU&&Q.IU.HardBreak?1:0}}Object(e.a)(rc,"PageFullHeightManager",null,[1710]);class Sc{constructor(Q,
za,fb,Nb){this.Uvb=Q;this.cBa=za;this.AW=fb;this.Xx=Nb}create(){return new rc(this.cBa,this.Uvb,this.AW,this.Xx)}}Object(e.a)(Sc,"PageFullHeightManagerFactory",null,[]);var gd=c(1089),Pd=c(592);class me{constructor(Q,za,fb,Nb,tc){this.sXb=null;this.BZ=Q;this.GN=za;this.iyc=fb;this.Uvb=Nb;this.Xx=tc}reset(){this.sXb=new ib.a}YPk(Q,za,fb){try{return this.$Pk(Q,za,fb)}catch(Nb){return ra.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",
Nb.message),null}}o5n(){try{this.p5n()}catch(Q){ra.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",Q.message)}}$Pk(Q,za,fb){if(!this.BZ.DY.count)return null;const Nb=this.T4l(Q,!Q);if(!Nb||Nb.GZd)return ra.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(Nb.IU&&Nb.IU.HardBreak)return null;var tc=this.BZ.DY.J(Nb.Ph-1);return this.Xx.Xyi(tc)&&(za-=fb,Nb.outlineNode!==tc.outlineNode&&
(za+=this.Xx.Wqh(Nb,tc)),(tc=this.iyc.Szh(Nb,za))&&1<Math.abs(tc.delta))?(tc.c2i=za,tc.outlineGroupNode=this.C4l(Q,Nb),this.sXb.add(tc),this.nmg(tc),tc):null}C4l(Q,za){return za&&za.Y2a?(Q=Object(lb.a)(Pd.a,hf.ParagraphReader.PD(za.outlineNode)),Q=Pn.GraphIterator.$a(Q),Q.Dp(),Object(lb.a)(gd.a,Q.hd(23))):Q&&Q.yjb?Q.outlineGroupNode:null}p5n(){this.sXb.Sc((Q,za)=>za.$ha.Ph-Q.$ha.Ph);for(const Q of this.sXb)this.Uvb.Uaj(Q);this.kVo()}kVo(){this.GN.value.uAm(this.sXb);this.BZ.wAm(this.sXb)}T4l(Q,za){return za?
this.BZ.DY.J(this.BZ.DY.count-1):this.BZ.DY.J(Q.Ph)}nmg(Q){let za=Q.$ha.Ph;const fb=-Q.FA;for(let Nb=0;Nb<fb;Nb++)za--,Q.lId.add(this.BZ.DY.J(za))}}Object(e.a)(me,"PageFullHeightPositionUpdater",null,[1709]);class zf{constructor(Q,za,fb,Nb,tc){this.BZ=Q;this.GN=za;this.iyc=fb;this.Uvb=Nb;this.Xx=tc}create(){return new me(this.BZ,this.GN,this.iyc,this.Uvb,this.Xx)}}Object(e.a)(zf,"PageFullHeightPositionUpdaterFactory",null,[]);class qg{constructor(Q,za){this.Xx=Q;this.iyc=za}e6f(Q,za){try{this.E0n(Q,
za)}catch(fb){this.Xx.iR(fb.message+" "+fb.stack),ra.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",fb.message)}}Uaj(Q){try{this.D0n(Q)}catch(za){this.Xx.iR(za.message+" "+za.stack),ra.ULS.sendTraceTag(38855577,336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",za.message)}}E0n(Q,za){ra.ULS.shipAssertTag(38285913,336,Q.Y2a||Q.IU.HardBreak);Q=this.iyc.Szh(Q,za);this.Uaj(Q)}D0n(Q){this.C0n(Q);this.v0n(Q)}v0n(Q){0<Q.FA?this.GAm(Q):0>Q.FA&&
this.Dil(Q)}C0n(Q){this.Xx.Kri(Q.$ha,Q.DJj)}GAm(Q){let za=Q.c2i+Q.lOa;for(let Nb=0;Nb<Q.FA;Nb++){var fb=Q.$ha.Ph+Nb;const tc=Q.$ha.Yba?this.Xx.Pdi(Q.$ha):Q.$ha.outlineNode;fb=this.$7k(tc,Q.outlineGroupNode,za,fb);Q.EAf.add(fb);Q.Ien.add(za);za+=Q.lOa}}Dil(Q){for(const za of Q.lId)this.Xx.Cil(za)}$7k(Q,za,fb,Nb){za=this.Xx.a8k(Q,fb,za);return Dm.J$e(fb,Nb,za,Q,!1,!1)}}Object(e.a)(qg,"PageFullHeightRenderer",null,[]);class Eg{constructor(Q){this.G2f=Q}}Object(e.a)(Eg,"PageHeightDeltaResult",null,[1703]);
class rg{constructor(Q,za,fb){this.pq=null;this.Xx=Q;this.ri=za;fb.execute(Nb=>{Nb.register(this)})}get QYc(){return"PageHeightDelta"}get result(){return this.pq}get bRf(){return 1}get j9f(){return 500}get isEnabled(){return!0}kRf(){this.pq=null}BCa(Q){this.ri.ie(()=>{try{this.qFc(Q)}catch(za){ra.ULS.sendTraceTag(39188045,324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",za.message)}},"PHDM:C")}qFc(Q){this.pq=null;Q=this.rFc(Q);-1!==Q&&(this.pq=new Eg(Q))}rFc(Q){if(!Q.count)return-1;
let za=0,fb=0;for(const Nb of Q)Q=this.aQk(Nb),-1!==Q&&(za+=Q,fb++);return fb?za/fb:-1}aQk(Q){if(!Q.qIm)return-1;const za=this.Xx.rci(Q.KBd,Q.Ph);return-1===za?-1:Math.abs(Q.height-za)}}Object(e.a)(rg,"PageHeightDeltaMetric",null,[1677]);class eh{constructor(Q){this.QVa=null;this.Xx=Q}PNc(Q){return this.QVa.J(Q-1)}V3n(Q){this.QVa=new ib.a;for(let za=0;za<Q;za++)this.QVa.add(-1)}Fzh(Q,za){if(this.zNm(Q))return this.QVa.J(Q.Ph-1);za=this.APk(Q,za);this.yBo(Q,za);return za}hVo(Q){for(const za of Q)this.gVo(za)}yBo(Q,
za){this.QVa.Z(Q.Ph-1,za)}LYn(Q){this.QVa.removeAt(Q-1)}gVo(Q){if(Q)if(0<Q.FA){var za=Q.$ha.Ph;for(var fb=0;fb<Q.FA;fb++)this.QVa.insert(za,Q.lOa)}else if(0>Q.FA)for(za=-Q.FA,Q=Q.$ha.Ph-za,fb=0;fb<za;fb++)this.QVa.removeAt(Q)}zNm(Q){return-1!==this.QVa.J(Q.Ph-1)}APk(Q,za){if(Q.Y2a||Q.IU.HardBreak)Q=this.Xx.o7h(Q),za=za<Q?Q:za;return za}}Object(e.a)(eh,"PageHeightStorage",null,[]);var Eh=c(110);class bh{constructor(Q){this.G2f=Q}}Object(e.a)(bh,"PageLevelDeltaResult",null,[1703]);class Uh{constructor(Q,
za,fb,Nb){this.pq=null;this.wI=Q;this.eta=za;this.ri=fb;Nb.execute(tc=>{tc.register(this)})}get mf(){const Q=this.wI.value;ra.ULS.shipAssertTag(39081438,336,Q.Vi,"PageLevelDeltaMetric.PageView is not a PageView.");return Q}get QYc(){return"PageLevelDelta"}get result(){return this.pq}get bRf(){return 0}get j9f(){return 60}get isEnabled(){return!0}kRf(){this.pq=null}BCa(Q){this.ri.ie(()=>{try{this.qFc(Q)}catch(za){ra.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",
za.message)}},"PLDM:C")}qFc(Q){this.pq=null;Q=this.rFc(Q);-1!==Q&&(this.pq=new bh(Q))}rFc(Q){if(!Q.count)return-1;let za=0,fb=0;for(const Nb of Q)Q=this.cQk(Nb),-1!==Q&&(za+=Q,fb++);return fb?za/fb:-1}cQk(Q){if(Q.yjb)return-1;var za=Q.IU.CP;Q=Q.paragraphNode;ra.ULS.shipAssertTag(39081441,336,!!Q);Q=Q.De(this.mf.ic);ra.ULS.shipAssertTag(39081442,324,Object(Eh.a)(100,Q));let fb;({zJh:za,REi:Q,gej:fb}=this.QPk(Q,uf.a.oA(Q.htmlElement).length,za));return Q&&fb?Math.min(za.x-Q.x,fb.x-za.x):(ra.ULS.sendTraceTag(39081443,
336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}QPk(Q,za,fb){let Nb,tc,bd,Yd=tc=fb,Fd=bd=Nb=null;if(fb>za)return ra.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{zJh:Fd,mXm:Yd,REi:bd,Y6n:tc,gej:Nb};Fd=this.eta.Pq(Q,fb);for(var De=0,Nf=fb;De<=Nf;){const Je=Math.floor((De+Nf)/2),va=this.eta.Pq(Q,Je);if(De===Nf){Yd=Je;bd=va;break}va.y+va.height<=Fd.y?De=Je+1:Nf=Je}for(;fb<=
za;){De=Math.ceil((fb+za)/2);Nf=this.eta.Pq(Q,De);if(fb===za){tc=De;Nb=Nf;break}Nf.y>=Fd.y+Fd.height?za=De-1:fb=De}return{zJh:Fd,mXm:Yd,REi:bd,Y6n:tc,gej:Nb}}}Object(e.a)(Uh,"PageLevelDeltaMetric",null,[1677]);class Zl{constructor(Q,za,fb,Nb,tc,bd,Yd){this.Ph=Q;this.top=za;this.Llh=fb;this.height=Nb;this.VPb=tc;this.KBd=bd;this.qIm=Yd}}Object(e.a)(Zl,"Page",null,[]);class Nl{constructor(Q,za,fb,Nb,tc){this.mXb=null;this.whh=0;this.wI=Q;this.uhd=za;this.g$g=fb;this.DLa=Nb;this.i$g=tc;this.eXa=new ib.a}get mf(){const Q=
this.wI.value;ra.ULS.shipAssertTag(37007393,336,Q.Vi,"PageManager.PageView is not a PageView.");return Q}get Vk(){return this.eXa}KFj(Q){Q=this.o6i(Q);this.MFj(Q)}eVo(Q,za){this.whh=za;Q=this.o6i(Q);this.MFj(Q);this.i$g.isEnabled&&this.i$g.BCa(Q)}o6i(Q){this.eXa=new ib.a;this.mXb=new Nc.a(0);const za=new ib.a;if(!Q)return this.Vk;var fb=0,Nb=null;for(let tc=0;tc<Q.count;tc++){const bd=Q.J(tc);fb=bd.Ph;Nb=this.LGd(fb,Nb,bd);this.Vk.add(Nb);!Nl.uKe&&0>Nb.height&&za.add(Nb);Nb=bd}Q=this.LGd(fb+1,Nb,
null);this.Vk.add(Q);!Nl.uKe&&0>Q.height&&za.add(Q);for(const tc of za)Nl.uKe=!0,ra.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+tc.Ph);return this.Vk}LGd(Q,za,fb){const Nb=za?za.outlineNode:this.DLa.z8h(),tc=fb?fb.outlineNode:this.DLa.aai();var bd=this.sci(Nb);const Yd=this.sci(tc),Fd=za?this.Pzh(za):0;bd=Fd+bd;const De=fb?this.Pzh(fb):this.uhd.M4a.clientHeight-Yd;return new Zl(Q,Fd,bd,Nb.id===tc.id?De-Fd:De+Yd-bd,Nb,tc,(fb?fb.Ph:this.whh+1)===(za?za.Ph:
0)+1)}Pzh(Q){return Q.Yba?0:Q.top}MFj(Q){if(this.g$g.W8d)for(const za of this.g$g.W8d)za&&za.NFj(Q)}sci(Q){this.mXb||(this.mXb=new Nc.a(0));if(this.mXb.nb(Q.id))return this.mXb.J(Q.id);var za=Q.De(this.mf.ic);if(!za)return ra.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;za=ha.a.p1a(this.uhd.M4a,za.htmlElement).y;this.mXb.Z(Q.id,za);return za}}Nl.uKe=!1;Object(e.a)(Nl,"PageManager",null,[1678]);var Ck=c(620);class Tg{constructor(Q,za,fb,Nb,tc,bd,Yd){this.Ing=
this.N4a=!1;this.ga=Q;this.Gea=za;this.tTb=fb;this.Lt=Nb;this.Ui=tc;this.k$g=bd;this.FN=Yd;this.N4a=0===this.FN.Uu?!0:!1;this.nSf=this.nSf.bind(this);this.FN.Eph(this.nSf)}Tb(){this.ga.fb(Ag.a.O2c,Ei.a.application,this.O2c.bind(this),96);this.ga.fb(Ag.a.wbe,Ei.a.application,this.wbe.bind(this),96);this.ga.fb(Ag.a.Hle,Ei.a.application,this.Hle.bind(this),96);this.ga.fb(Ag.a.Ele,Ei.a.application,this.Ele.bind(this),8)}Hle(Q,za,fb){return 1===fb?32:this.ga.processAction(Ag.a.n7a,2)}Ele(Q,za,fb,Nb){if(1===
fb)return 0===this.FN.Uu?32:8;this.N4a?(this.BRh(),this.Ing=!0):(this.bVh(),this.Ing=!1);this.Ui.updateCommandUI();Nb.ks=this.N4a?1:0;return 32}O2c(Q,za,fb,Nb,tc){if(1===fb)return 32;Q=this.k$g.DPc();-1===Q?Q="":this.N4a||1===this.FN.Uu?(za=this.k$g.zRl(),za>Q&&(Q=za),Q=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,za,Q)):Q=1===Q?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,Q):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,Q);tc[Ck.a.Visible]=
!0;tc[Ck.a.LabelText]=Q;return 32}wbe(Q,za,fb,Nb,tc){if(1===fb)return 32;tc[Rh.a.On]=this.N4a;return 32}nSf(Q,za){0!==za.vlb||this.Ing?this.BRh():this.bVh()}bVh(){this.N4a||(this.tTb.usl(),this.Lt.Nuo(),this.N4a=!0)}BRh(){this.N4a&&(this.tTb.$ll(),this.Lt.Pqm(),this.N4a=!1)}}Object(e.a)(Tg,"PaginationActor",null,[]);class Em{constructor(Q){this.G2f=Q}}Object(e.a)(Em,"PaginationDeltaResult",null,[1703]);class Kp{constructor(Q,za){this.rwb=this.Bid=null;this.ri=Q;za.execute(fb=>{fb.register(this)})}get QYc(){return"PaginationDelta"}get result(){return this.Bid}get bRf(){return 1}get j9f(){return 200}get isEnabled(){return!0}kRf(){this.Bid=
null}BCa(Q){this.ri.ie(()=>{try{this.qFc(Q)}catch(za){ra.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",za.message)}},"PDM:C")}ngg(Q){this.rwb=Q}qFc(Q){this.Bid=null;Q=this.rFc(this.rwb,Q);-1!==Q&&(this.Bid=new Em(Q))}rFc(Q,za){if(!(Q&&za&&Q.count&&za.count))return-1;const fb=new ib.a;for(const Nb of Q)fb.add(Nb.top);Q=new ib.a;for(const Nb of za)Q.add(Nb.top);za=this.bMd(fb,Q);return this.T2b(za)}T2b(Q){if(!Q.count)return 0;let za=0;for(let fb=
0;fb<Q.count;fb++)za+=Q.J(fb);return za/Q.count}bMd(Q,za){const fb=new ib.a;if(!Q.count||!za.count)return fb;var Nb=Q.count<=za.count;const tc=Nb?Q:za;Q=Nb?za:Q;for(za=0;za<tc.count;za++){Nb=tc.J(za);let Yd=Math.abs(Nb-Q.J(0)),Fd=0;for(let De=1;De<Q.count;De++){var bd=Q.J(De);bd=Math.abs(Nb-bd);bd<Yd&&(Yd=bd,Fd=De)}fb.add(Yd);Q.removeAt(Fd)}return fb}}Object(e.a)(Kp,"PaginationDeltaMetric",null,[1677]);var Jn=c(382),ag=c(1387),Lp=c(2005);class Pr extends Jn.a{constructor(Q,za,fb,Nb,tc,bd,Yd,Fd=null){super();
this.BN=null;this.nwe=0;this.rYa=-1;this.Dtb=!1;this.rY=()=>{ra.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.DRh()};this.QTf=()=>{if(0==this.FS.Uu){var De=this.BN.wt;fh.a.Zp(De,this.vWb)||(this.vWb=De,this.Wnn(this.cLa,this.vWb))}};this.FS=Q;this.pca=this.pca.bind(this);this.FS.$yb(this.pca);this.ga=za;this.Lt=fb;this.kZ=Nb;this.Wka=tc;this.qIe=Fd||gm.a.instance;this.vWb=this.cLa=fh.a.nil;this.q9j=Yd;bd.CWR(()=>bd.result.OA.QMa(this.rY));this.A4b();
this.ek=new ag.a(1E3);this.ek.A_a();this.Wka.register(this)}get Kha(){return"Pagination"}get zff(){return this.q9j.value}get $Vm(){return this.cLa}get jIa(){return this.rYa}eno(Q){this.rYa!==Q&&(this.rYa=Q,this.kZ.ymg())}pca(){this.cLa=this.vWb=fh.a.nil;this.A4b()}z4a(Q){this.BN=Q;this.BN.m0b(this.QTf);this.W_b(this.BN.node)}Wnn(Q,za){fh.a.Zp(Q,za)?(this.Lt.n3d(),this.A4b()):(this.Lt.o3d(),this.lAo())}Csl(){this.enabled=2}A4b(){this.enabled=0}lAo(){this.nwe=0;this.Csl();this.cF(null,null,null)}Jna(){return Za.App.lostSession||
Za.App.rd.OA.jo?!1:!!(this.enabled&2)&&this.ek.FX()}cF(){this.ek.Mgb();this.Wka.TU()}forceOutbound(){}S3(){return 0===this.enabled?!1:this.ee&&2===this.ee.status?!0:this.Jna()}uSa(){if(1===this._state)this.ee.Cq=Lp.a.Paa(m.AFrameworkApplication.rootQuerySignature,this.cLa),this.ee.GG="Pagination",this.ee.status=1,this._state=3;else if(3===this._state&&this.ee&&2===this.ee.status)if(m.AFrameworkApplication.Lk)this._state=4;else if(this.ek.q1(),this.ek.o8(),this._state=1,this.nwe++,2!==this.ee.statusCode)this.B4b();
else if(1!==(this.ee.zj?this.ee.zj.length:0))this.B4b();else{var Q=this.ee.zj[0];this.qIe.dUa(Q);104===Q.StatusCode?this.DRh():101===Q.StatusCode?this.B4b():3===Q.StatusCode?this.B4b():Q.StatusCode?this.B4b():Q.PageEnds?(this.eno(Q.PageEnds.length+1),this.cLa=tj.b(Q.LastKnownPaginationRevision),ra.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.rYa,this.cLa),this.Lt.Had(Q.PageEnds,
fh.a.Zp(this.cLa,this.vWb)),this.zff.bia=Q.PageEnds,this.kZ.Y4e(),ra.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.rYa,this.cLa),this.iml()):this.B4b()}}DRh(){this.BN&&this.BN.HMb(this.QTf);this.A4b()}B4b(){60<this.nwe&&this.A4b()}iml(){fh.a.Zp(this.cLa,this.vWb)&&this.A4b()}dispose(){this.BN&&(this.BN.HMb(this.QTf),this.BN.node&&this.R3c(this.BN.node),this.BN=null);this.FS.J5f(this.pca)}W_b(Q){Q&&
(Q.addListener(this),this.Dtb=!0)}R3c(Q){this.Dtb&&Q&&(Q.removeListener(this),this.Dtb=!1)}nKb(Q){this.R3c(Q)}onBeforeLoadContent(){}onAfterLoadContent(Q){(Q=Q.od.jm)&&this.Pkn(this.cLa,Q.id)}onAfterFirstSaveContent(){}Pkn(Q,za){fh.a.Zp(Q,za)&&this.Lt.n3d()}}Object(e.a)(Pr,"PaginationReplicator",Jn.a,[1675,9,108]);class Vq{constructor(){this.S$=this.Lt=this.kZ=this.tTb=this.vv=null;this.tsa=!1;this.JBk=()=>{this.Xrh()}}get name(){return"WordEditor.Pagination"}xc(Q){this.W=Q;this.ld=this.W.resolve("Box4.IFeatureHelper");
this.W.ha("WordEditor.Pagination.PageElementManagerList",()=>new uk(this.W.resolve("WordEditor.Pagination.PageAdornmentManager"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.OutlineManager",()=>new wn(new hb.a(()=>Za.App.ya.gb.wc))).as("WordEditor.Pagination.IOutlineManager").singleInstance();this.W.ha("WordEditor.Pagination.PageManager",()=>new Nl(new hb.a(()=>Za.App.ya.gb.wc),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),
this.W.resolve("WordEditor.Pagination.PageElementManagerList"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").singleInstance();this.W.ha("WordEditor.IPaginationReplicator",()=>new Pr(this.W.resolve("WordEditor.IMainViewModeManager"),m.AFrameworkApplication.va,this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"),km.App.e1,
Za.App.Gna(),new hb.a(()=>this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).singleInstance();this.W.ha("WordEditor.ICurrentPageManager",()=>new to(this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.PageLevelDeltaMetric",()=>new Uh(new hb.a(()=>Za.App.ya.gb.wc),this.W.resolve("Box4.ITextMetricsAdapter"),Le.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightDeltaMetric",
()=>new rg(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),Le.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PaginationDeltaMetric",()=>new Kp(Le.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightStorage",()=>new eh(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightDOMHelper",
()=>new la(new hb.a(()=>Za.App.ya.gb.wc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightInfoCalculator",()=>new ec(this.W.resolve("WordEditor.Pagination.PageHeightStorage"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightRenderer",()=>new qg(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),
this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new zf(this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),this.W.Ue("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();
this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkerPositionUpdater",()=>new Yl(new hb.a(()=>Za.App.ya.gb.wc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),
Za.App.Lj.Bl)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManagerFactory",()=>new Sc(this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageHeightStorage"),Yi.WordSectionNavigator.instance,this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManager",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).singleInstance();
this.W.ha("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new jo(this.W.resolve("Common.IZoomManager"),Le.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").singleInstance();this.W.ha("WordEditor.Pagination.PaginationActor",()=>new Tg(m.AFrameworkApplication.va,this.W.resolve("WordEditor.IStatusBarUser"),this.W.resolve("WordEditor.ICurrentPageManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),m.AFrameworkApplication.ta,this.W.resolve("WordEditor.IPageNumberFinder"),
this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();this.W.ha("WordEditor.Pagination.DocumentSizeManager",()=>new nh(new hb.a(()=>Za.App.ya.gb.wc),lq.a.get_instance(),this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();this.W.ha("WordEditor.Pagination.CurrentPageCalculator",()=>new dn(m.AFrameworkApplication.va,Of.a.instance,pm.a.instance,this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),new hb.a(()=>Za.App.ya.gb.wc),this.W.Na("Box4.CpConversionManagerImpl"),
this.W.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkers",()=>this.Lt=new Ji(new hb.a(()=>Za.App.ya.gb.wc),new hb.a(()=>Za.App.ya.gb.Uc.od),this.W.resolve("WordEditor.Pagination.IPageAdornmentManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.W.resolve("WordEditor.Pagination.IPageManager"),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),
this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),bo.a.LOc,this.W.resolve("WordEditor.ParagraphWordIdMapping"),pm.a.instance,Ji.YWl,this.W.resolve("Box4.ContentEditableViewEventSource"),new vp.a,this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.W.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.W.resolve("Common.ICurrentPageCalculator"),this.W.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.Pagination.IPageEndMarkers").as("Box4.IPaginationRefreshHelper").singleInstance();
this.W.ha("WordEditor.Pagination.PageEndDOMHelper",()=>new vk(this.W.Sa("Common.IZoomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Za.App.instance&&Za.App.instance.RC)).singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new tk(m.AFrameworkApplication.nc)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentContentManager",()=>new sm(this.W.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").singleInstance();
this.W.ha("WordEditor.Pagination.PageAdornmentManager",()=>this.S$=new Uj(new hb.a(()=>Za.App.ya.gb.wc),zo.a.instance,ah.a.instance,bf.a.instance,m.AFrameworkApplication.va,Jp.a.instance,this.W.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.W.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),pm.a.instance,m.AFrameworkApplication.K,!!Za.App.instance&&Za.App.instance.RC,!!Za.App.instance&&Za.App.instance.uoa)).as("WordEditor.Pagination.IPageAdornmentManager").singleInstance()}init(){this.ld.Mp.continueWith(()=>
{this.fn()})}fn(){const Q=Za.App.ya.gb;Q.swa?this.Xrh():Q.Xea(this.JBk)}Xrh(){this.tsa||(this.tsa=!0,this.tTb=ua.a.instance.resolve("WordEditor.ICurrentPageManager"),this.kZ=ua.a.instance.resolve("Common.ICurrentPageCalculator"),this.vv=ua.a.instance.resolve("WordEditor.IPaginationReplicator"),ua.a.instance.resolve("WordEditor.Pagination.PaginationActor").Tb())}dispose(){this.S$&&(this.S$.dispose(),this.S$=null);this.Lt&&(this.Lt.dispose(),this.Lt=null);this.vv&&(this.vv.dispose(),this.vv=null);this.kZ&&
(this.kZ.disable(),this.kZ=null);this.tTb&&(this.tTb=null)}}Object(e.a)(Vq,"PackageManager",null,[1,2]);class Qr{constructor(){this.W=null}xc(Q){this.W=Q||ua.a.instance}dispose(){}}Object(e.a)(Qr,"TellMePackage",null,[1,2]);var Mp=c(1481),xp=c(1483),Ar=c(344),ul=c(1480),Np=c(1374);class $o{constructor(Q=null,za=null,fb=null,Nb,tc=null){this.Vre=null;this.CKg=!1;this.OUg=this.kSb=null;this.Jik=this.ufh=this.qVj=this.PUg=!1;this.bgd=null;this.EVj=null==za?m.AFrameworkApplication.rzb:za;this.h6j=null==
fb?m.AFrameworkApplication.Q_:fb;this.rjk=null==tc?m.AFrameworkApplication.O6a:tc;this.I4j=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.blk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.cno(!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.Tkk=!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb.UVc;this.Ukk=!ul.a.moa()&&!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");
this.Skk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.J1j=!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb.zOb;this.Vkk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.oik=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.Gck=this.K7c||this.J7c;this.Eck=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");
this.Fck=this.uEf;this.s8j=!!m.AFrameworkApplication.K&&this.KTa&&m.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.g3j=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.M3j=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.V2j=m.AFrameworkApplication.K?parseFloat(m.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold",
"-0.6")):-.6;this.p8j=!!m.AFrameworkApplication.K&&(m.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.E6j=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenSerpletActionAIFromTellMe",!1)&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableActionAITab",!1)&&ul.a.nha();
this.YYb=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.$jk=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.Q3j=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",
""):"";this.pik=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.cjk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.Fik=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("ShowFindInDocumentInZeroTermSearchBox")||this.pP;this.C8j=!!m.AFrameworkApplication.K&&(m.AFrameworkApplication.K.$("TellMeTemplateProviderIsEnabled")||
m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.R7j=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.i8j=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===m.AFrameworkApplication.uiCulture;this.z8j=!!m.AFrameworkApplication.K&&(m.AFrameworkApplication.K.$("TellMeFeedbackProviderIsEnabled")||
m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.N8j=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.rVj=this.KTa&&!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.o4j=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",
!1);this.ijk=!!m.AFrameworkApplication.K&&(m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==m.AFrameworkApplication.K.jb("Application"));this.WWj=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.Qmk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMePerformanceMarkerEnabled");this.H6j=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",
!1);this.L6j=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.L3j=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.B8j=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeNotesSuggestionIsEnabled")||this.RRm;this.J6j=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",
!1);this.K6j=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.I6j=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.U0j=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.V0j=
!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.Wkk=this.OBi&&(this.BWf||this.CWf||this.V_c||this.KTa&&ul.a.nha()&&!!m.AFrameworkApplication.K&&(this.qjc||this.FOb||this.GOb||this.HOb||this.JOb||m.AFrameworkApplication.K.$("ShowAnswerSearchResults")||m.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||m.AFrameworkApplication.K.$("ShowEntitySearchResults")||m.AFrameworkApplication.K.$("ShowWolframSearchResults")));
this.sUj=!!m.AFrameworkApplication.K&&!m.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&m.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&m.AFrameworkApplication.qCa;this.tUj=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled");this.Twm(Q||{});this.HQe="2918242107";this.GQe="1454393937";this.cwb={};this.Rcb=[];this.W4k=[ul.a.wme]}get application(){return this.kSb}get rzb(){return this.EVj}get v$n(){return this.HQe}get u$n(){return this.GQe}get Pjf(){return this.OUg}get CZh(){return this.PUg}get Q_(){return this.h6j}get O6a(){return this.rjk}get nzb(){return this.qVj}get wqm(){return this.I4j}get cGo(){return this.blk}get OBi(){return!0}get TFo(){return this.Wkk}get Zpo(){return this.ufh}cno(Q){this.ufh=
Q}get KTa(){return this.Tkk}get R9c(){return this.Ukk}get P9c(){return this.Skk}get pzl(){return this.J1j}get RFo(){return this.Vkk}get bme(){return!1}get V_c(){return this.Gck}get BWf(){return this.Eck}get CWf(){return this.Fck}get m3a(){return!1}get w_d(){return!1}get iGf(){return this.s8j}get Vhe(){return this.Jik}get qjc(){return!1}get Dro(){return!1}get lXm(){return""}get Crf(){return 2}get w8l(){return 4}get x8l(){return 5}get Gfi(){return""}get yUl(){return this.g3j}get Xfi(){return this.M3j}get Ifi(){return 1E3}get Hfi(){return 1E-6}get nCo(){return this.$jk}get Kgg(){return!1}get Dvj(){return!1}get FPm(){return this.i8j}get g_d(){return!1}get h_d(){return!1}get qyi(){return!1}get pyi(){return!1}get RRm(){return!1}get PBi(){return!1}get RLd(){return!1}get Fob(){return!1}get FOb(){return!1}get GOb(){return!1}get HOb(){return!1}get JOb(){return!1}get K7c(){return this.oik}get ljc(){return this.pik}get J7c(){return!1}get Eof(){return null}get a_d(){return!1}get Ohe(){return this.Fik}get Pbi(){return 0}get vOl(){return this.V2j}get Bgi(){return this.Q3j}get KQm(){return this.p8j}get hXd(){return this.E6j}get Nhe(){return this.YYb}get l2l(){return-3.9}get pP(){return this.cjk}get VVc(){return this.C8j}get GEf(){return this.R7j}get CGf(){return this.z8j}get Fdb(){return this.rVj}get PTm(){return this.N8j}get Vva(){return this.o4j}get zsj(){return this.ijk}get NKk(){return this.WWj}get aoe(){return this.Qmk}get lXd(){return this.H6j}get IDm(){return this.L6j}get $u(){return this.L3j}get hkb(){return this.B8j}get GDm(){return this.J6j}get HDm(){return this.K6j}get FDm(){return this.I6j}get Ayk(){return this.sUj}get Byk(){return this.tUj}get Yfa(){return this.U0j}get PJd(){return this.V0j}get HHb(){return!!m.AFrameworkApplication.ta&&
m.AFrameworkApplication.ta.Nb.Yq}get Yq(){return!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb.Yq}get nMm(){return!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb.ojc}get dfn(){return Gf.getImageClass("OfficeAssistant_32x32x32")}dPd(){return Promise.reject("GetFindMatchCount method is not overridden")}M_d(Q){return Array.contains(appChrome.selectors.getVisibleControlIds(),Q)}VXd(){return!1}get mZd(){return!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeModelRankerEnabled")}get qxj(){return m.AFrameworkApplication.K?
m.AFrameworkApplication.K.jb("TellMeServiceHelpClassifierModelName"):""}get uEf(){return!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeMultiLingualCommandModelEnabled")}get CFb(){return"NoOpHeaderUi"}get P4k(){return this.bgd}get parameterData(){return this.cwb}get cNo(){return this.Rcb}Xul(){if(this.Vre&&!this.CKg&&(this.CKg=!0,this.wob(this.Vre),this.Yq)){var Q=ua.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Q=(new Np.a(Q)).vNd(this.Vre.TG);appChrome.api.dispatch(Q)}}get s9f(){return""}wob(){}Qkl(Q){const za=
[];for(let fb=0;fb<Q.length;++fb)Q[fb].zso?za.push(new Ar.a(Q[fb].alternate,ul.a.RBj+fb.toString())):za.push(new Ar.a(Q[fb].standard,ul.a.wme+fb.toString()));return za}Twm(Q){const za={};for(let fb in Q){const Nb=fb,tc=Q[fb];for(let bd in tc){const Yd=bd,Fd=tc[bd];(za[Yd]||(za[Yd]={}))[Nb]=Fd}}this.bgd=za}get rxj(){return""}get prj(){return!1}}Object(e.a)($o,"TellMeApplicationData",null,[1099]);class Ga{constructor(Q,za=null,fb=!1){this.standard=Q;this.alternate=za;this.zso=fb}}Object(e.a)(Ga,"TryQuerySet",
null,[]);class Fb{constructor(){this.J6g=this.K6g=null}get Dcn(){return this.J6g}Ifa(Q){this.K6g=Q;return this.Daf(Q)}lgn(){this.J6g=this.K6g}ZPd(Q){return 8===Q.type?String.format(CommonUIStrings.l_FindInDocumentText,Q.$C):Q.$C}cof(Q){return Q.$C}}Object(e.a)(Fb,"ParameterizedCommand",null,[]);class hc extends Fb{constructor(Q){super();this.FVc=Q}get commandId(){return this.FVc?"DefinitionsParameterized":"DefinitionButton"}get $Xf(){return"Definition"}Daf(Q){const za=Ra.a.Af(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,
Q.$C));return Xd.a(ul.a.sbf(Q.value),n.a.Vcf.toString(),za,ul.a.GAf,null,Ra.a.Af(ul.a.kBb(Q.$C)),za,null,null)}ZPd(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.$C)}cof(Q){return ul.a.kBb(Q.$C)}}Object(e.a)(hc,"DefinitionsParameterizedCommand",Fb,[]);class Ec extends Fb{constructor(Q){super();this.FVc=Q}get commandId(){return this.FVc?m.AFrameworkApplication.ta.Nb.FIm?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get $Xf(){return"Find"}Daf(Q){const za=
Ra.a.Af(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,Q.$C));return Xd.a(ul.a.sbf(Q.value),n.a.findInDocument.toString(),za,"Find_16x16x32",null,Ra.a.Af(Q.$C),za,null,null)}ZPd(Q){return String.format(CommonUIStrings.l_TextWithQuotation,Q.$C)}}Object(e.a)(Ec,"FindParameterizedCommand",Fb,[]);class fd extends Fb{constructor(Q){super();this.FVc=Q}get commandId(){return this.FVc?"SynonymsParameterized":"SynonymButton"}get $Xf(){return"Synonym"}Daf(Q){const za=Ra.a.Af(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,
Q.$C));return Xd.a(ul.a.sbf(Q.value),n.a.Vcf.toString(),za,ul.a.GAf,null,Ra.a.Af(ul.a.kBb(Q.$C)),za,null,null)}ZPd(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.$C)}cof(Q){return ul.a.kBb(Q.$C)}}Object(e.a)(fd,"SynonymsParameterizedCommand",Fb,[]);var Md=c(2014),Ze=c(1930),te=c(2042),Ff=c(2009),gg=c(2010),qh=c(1565);class Ha extends Md.a{constructor(){super(...arguments);this.JN=null;this.oYa=Ze.FindManager.createInstance(this,te.a.instance,qh.a.instance,
!0,!0)}static get instance(){return Ha._instance}a6b(){this.JN(this.oYa.Jj.lja);this.oYa.yZa(!0)}dPd(Q){const za=new Promise((fb,Nb)=>{this.JN=fb;setTimeout(()=>{Nb("Find manager execution timed out");this.oYa.yZa(!0)},500)});Q=Ff.a.createQuery(Q,gg.a.none);this.oYa.find(Q);return za}}Ha._instance=new Ha;Object(e.a)(Ha,"TellMeFindStatusSpy",Md.a,[]);class Ta extends $o{constructor(Q){super({});this.kSb="Word";this.t3j=Q;m.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.PUg=!0,this.OUg=
this.RLd?"FindWithMatchesParameterized":"FindParameterized");Q=new hc(this.HHb);const za=new fd(this.HHb);this.parameterData[Q.commandId]=Q;this.parameterData[za.commandId]=za;Q=new Ec(this.HHb);this.parameterData[Q.commandId]=Q;m.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&(Q=[new Ga(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new Ga(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new Ga(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new Ga(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,
"",!1),new Ga(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.Rcb=this.Qkl(Q))}dPd(Q){return Ha.instance.dPd(Q)}get T5a(){return Xl.AppFrame.Upa}get CFb(){return Xl.AppFrame.uPa}get s9f(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}wob(Q){var za=m.AFrameworkApplication.K;Q=Q.TG;Q.WordCountFlyout=!this.t3j();Q.SelectAllButton=!za.$("TellMeSelectAllResultIsEnabled");const fb=za.$("TellMeDesktopUpSellIsEnabled");let Nb=m.AFrameworkApplication.x_d;
appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!Nb));Nb=!1;Q.TextBoxUpSellButton=!fb||Nb;Q.TableOfContentsUpSellButton=!fb||Nb;Q.SmartArtUpSellButton=!fb||Nb;Q.WordArtUpSellButton=!fb||Nb;Q.MultiColumnLayoutUpSellButton=!fb||Nb;Q.InsertEquationUpSellButton=!fb||Nb;Q.TrackChangesUpSellButton=!fb||Nb;Q.ShapesUpSellButton=!fb||Nb;Q.LabelsUpSellButton=!fb||Nb;Q.InsertCitationUpSellButton=!fb||Nb;Q.TextBoxUpSellButtonEnterprise=!fb||!Nb;Q.TableOfContentsUpSellButtonEnterprise=
!fb||!Nb;Q.SmartArtUpSellButtonEnterprise=!fb||!Nb;Q.WordArtUpSellButtonEnterprise=!fb||!Nb;Q.MultiColumnLayoutUpSellButtonEnterprise=!fb||!Nb;Q.InsertEquationUpSellButtonEnterprise=!fb||!Nb;Q.TrackChangesUpSellButtonEnterprise=!fb||!Nb;Q.ShapesUpSellButtonEnterprise=!fb||!Nb;Q.LabelsUpSellButtonEnterprise=!fb||!Nb;Q.InsertCitationUpSellButtonEnterprise=!fb||!Nb;za=!za.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!m.AFrameworkApplication.Q_;Q.SynonymButton=za;Q.DefinitionButton=za}get rxj(){return m.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName",
"")}get Kgg(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get qxj(){return m.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get qjc(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get uEf(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",
!1)}get Crf(){return m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get prj(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get w_d(){return m.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get mZd(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",
!1)}get g_d(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get h_d(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",!1)}get Ifi(){return m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get Hfi(){return 1E-6*m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",
1)}get qyi(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get pyi(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get Gfi(){return m.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get PBi(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",
!1)}get Pbi(){return m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get OBi(){return m.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get bme(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",!1)}get m3a(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get Vhe(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",
!1)}get Dvj(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get a_d(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",!1)}get FOb(){return m.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get GOb(){return m.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get HOb(){return m.AFrameworkApplication.K.$("ShowEntitySearchResults")}get JOb(){return m.AFrameworkApplication.K.$("ShowWolframSearchResults")}get Eof(){return m.AFrameworkApplication.K.$("ModernFontPickerIsEnabled")?
{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(e.a)(Ta,"WordEditorTellMeApplicationData",$o,[]);var rb=c(1517),jc;(function(Q){Q[Q.none=0]="none";Q[Q.waitAll=1]="waitAll";Q[Q.synchronizeFast=2]="synchronizeFast";Q[Q.synchronizeSlow=3]="synchronizeSlow"})(jc||(jc={}));Object(e.b)("ProviderSynchronizationType",jc);var wc;(function(Q){Q[Q.immediate=0]="immediate";Q[Q.waitAll=1]="waitAll";Q[Q.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";Q[Q.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})(wc||
(wc={}));Object(e.b)("MenuUpdatePolicy",wc);var $c=c(1487),Ad=c(1484),Td=c(1622),Me=c(1488),If=c(1511),Jh=c(111),Cj=c(288);class Fg extends Md.a{constructor(Q){super();this.Snk=Q}a6b(){this.Snk.update()}}Object(e.a)(Fg,"TellMeFindStatusManager",Md.a,[]);class mi{constructor(Q){this.Kcb=this.eNg=null;this.ji=0;this.mld="TellMeWAC.";const za=Q.Pjf;this.fc=Q;this.Jid=za;this.hIe=Object.assign(new rb.a,{landingTab:"Indoc",data:null});Q=new Fg(this);this.oYa=Ze.FindManager.createInstance(Q,te.a.instance,
qh.a.instance,!0,!0)}XK(){return"WordFindInDocument"}cU(){return this.fc.Crf?this.fc.Crf===wc.waitAll?jc.waitAll:jc.synchronizeSlow:jc.none}MH(Q,za){this.bTm(Q)?(this.Kcb=Q,this.eNg=za,Q=Ff.a.createQuery(Q.Dg,gg.a.none),this.ji=window.performance.now(),this.oYa.find(Q)):za.resultsUpdated(new $c.a(Q))}update(){this.qco(Math.round(window.performance.now()-this.ji));var Q=String.format(CommonUIStrings.l_TextWithQuotation,this.Kcb.Dg);var za=m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb.Fob?
ul.a.LNa(this.Kcb.Dg,15,this.hIe):Ra.a.Af(this.Kcb.Dg);const fb=[];fb.push(appChrome.actions.setControlLabel(this.Jid,Q));fb.push(appChrome.actions.setCompoundButtonCommandValueId(this.Jid,za));fb.push(appChrome.actions.updateCompoundButtonDescription(this.Jid,this.Wuf()));appChrome.api.dispatch(fb);Q=new Ad.a(this.Jid,Td.a.FindInDocument,this.Kcb.Dg,this.oYa.Jj.lja.toString());za=new Me.a(If.a.FindInDocument);za.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;za.Jw(Q);const Nb=new $c.a(this.Kcb);
Nb.Tu(za);window.requestAnimationFrame(()=>{this.eNg.resultsUpdated(Nb)});this.oYa.yZa(!0);this.rco(Math.round(window.performance.now()-this.ji))}Wuf(){const Q=this.oYa.Jj.lja.toString();return"1"===Q?String.format(CommonUIStrings.l_SearchResultText,Q):String.format(CommonUIStrings.l_SearchResultsText,Q)}bTm(Q){return!!Q&&!!Q.Dg&&""!==Q.Dg.trim()}qco(Q){const za={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",
["QueryLength"]:this.Kcb.Dg.length};this.sendActivityEvent(za,Q)}rco(Q){const za={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.Kcb.Dg.length};this.sendActivityEvent(za,Q)}sendActivityEvent(Q,za){Q=Jh.a.wC(Q);sh.a.rHa(Object.assign(new Cj.a,{name:"Latency",dataFields:Q,durationMs:za}),this.mld)}}Object(e.a)(mi,"WordFindInDocumentWithMatchesProvider",null,[1121]);class Dj{constructor(Q,za){this.pc=Q;this.LWd=
za}n2a(Q,za,fb){return this.LWd.n2a(0,Q,za,fb)}insertHtmlText(Q){return Q?32===this.hAf(Q):!1}hAf(Q){return this.executeCommand(ph.a.nCa,Q)}executeCommand(Q,za){const fb=new jg.DictionaryPropertySet;fb.setValue(Wl.a.gP,za);fb.setValue(Wl.a.Iia,!1);za=this.pc.processAction(Q,1);32===za&&(za=this.pc.Qb(Q,2,fb));return za}}Object(e.a)(Dj,"WordInsertContentHandler",null,[1700]);class Ej extends Qr{constructor(){super();this.Lx=()=>{if(m.AFrameworkApplication.nig){var Q=Za.App.ya.Nb.Otf(n.a.tellMe);Q.GTc?
this.M0i():Q.UZ(this.c$n);var za=new Ta(()=>!1);Mp.TellMeActor.instance.initialize(za,null,null,null,null,null,Object(a.a)(Za.App.ya,Za.App.ya.aNd,"forceUpdateRibbonControls"),m.AFrameworkApplication.K,this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.W.Sa("Common.IActionContextProvider"),this.W.Sa("Common.ISystemInitiatedFeedback"));Mp.TellMeActor.instance.eSn(Q);Mp.TellMeActor.instance.hUn(new Dj(m.AFrameworkApplication.va,this.W.Na("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));
za.CZh&&za.RLd&&Mp.TellMeActor.instance.JE(new mi(za),xp.a.tellMe)}};this.c$n=()=>{this.M0i()}}get name(){return"WordEditor.TellMe"}init(){m.AFrameworkApplication.K.No(this.Lx)}M0i(){Za.App.ya.updateCommandUI()}}Object(e.a)(Ej,"WordEditorTellMePackage",Qr,[]);class wf{constructor(){this.W=null;this.txj=(Q,za,fb)=>{2===fb&&(Q=new bc.StandardDialog,Q.Ad=0,Q.Yia(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>
{this.fn()})}dispose(){}fn(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(127)){m.AFrameworkApplication.va.fb(Ag.a.wordTestFeature,Ei.a.view,this.txj,96);var Q=ei.FocusManager.instance().ge(Xl.AppFrame.$E);wd.AFrame.Ai(Q,Df.KeyInputManager.kc(Rj.a.D8a,5|Df.KeyInputManager.Rh),Ag.a.wordTestFeature)}}xc(Q){this.W=Q}static main(){K.a.instance.Fc(new wf)}}Object(e.a)(wf,"WordEditorTestFeaturePackage",null,[1,2]);var cf=c(104);class jf{constructor(Q,za){this.Oej=Q;this.pc=za;this.xfe=(fb,
Nb,tc,bd,Yd)=>{if(1===tc)return 32;this.Oej.XM(9,Yd,!1);return 32};this.w0=(fb,Nb)=>{if(9===Nb.type){var tc;(fb=Nb.tL)?("string"===typeof fb?tc=fb:"data"===fb.type&&(tc=cf.a.wMh(fb.PEn,fb.newState,fb.fno)),tc&&jf.tDc(tc)):ra.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.t3c()}t3c(){this.pc.qa(Ag.a.xfe,z.a.frame,this.xfe);this.Oej.b3(this.w0)}dispose(){}static tDc(Q){Q=Za.App.ya.notificationBar.rma(Q,!1);Q.image=5;Q.Sna="CoAuth_AuthorStatus_16x16x32";
Za.App.ya.notificationBar.aA(Q)}}Object(e.a)(jf,"TrackChangeNotificationActor",null,[]);class xg{constructor(){this.fj=this.qVe=this.W=null;this.N_c=()=>{if(this.fj=Za.App.SSd().result)this.W.ha("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new jf(this.fj,m.AFrameworkApplication.va)).singleInstance(),this.qVe=this.W.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}xc(Q){this.W=Q}init(){this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>
{this.fn()})}fn(){Za.App.SSd().continueWith(this.N_c)}dispose(){this.qVe&&this.qVe.dispose()}}Object(e.a)(xg,"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var Bg=c(98),lk=c(1461),Ni=c(2003);class Qh{}Qh.ulg="UnsavedChanges";Qh.vlg="UnsavedChangesThemed";Qh.s9n="SavedChanges";Qh.$Cj="UnsavedChangesOpenPipe";Qh.dQo="UnsavedChangesOpenPipeCssClassNameThemed";Qh.ZCj="UnsavedChangesClosePipe";Qh.aQo="UnsavedChangesClosePipeThemed";Qh.bQo="UnsavedChanges";Qh.cQo="UnsavedChangesThemed";
Qh.wlg="UnsavedChangesIndicatorPositionRef";Object(e.a)(Qh,"UnsavedChangesHighlightUtils",null,[]);class ni extends lk.a{constructor(Q,za){super();this.aea=Q;this.ox=za;this.o2=[this.ox?new Ni.a(Qh.vlg,Qh.cQo):new Ni.a(Qh.ulg,Qh.bQo)]}get Cba(){return!0}get wib(){return 4}get V1a(){return this.o2}uGa(Q,za){if(this.aea){var fb=this.aea.rNf;if(fb&&fb.count&&fb.contains(Q.id))for(Q=za.OGa("span"),za=0;za<Q.length;za++)fb=Q[za],za||fb.classList.add(this.ox?Qh.dQo:Qh.$Cj),za===Q.length-1&&fb.classList.add(this.ox?
Qh.aQo:Qh.ZCj),fb.classList.add(this.ox?Qh.vlg:Qh.ulg)}}m1a(){}}Object(e.a)(ni,"UnsavedChangesHighlightActor",lk.a,[]);var Ok=c(1035);class nq{constructor(Q){this.Nwe=null;this.aea=Q;this.nFe=!1}get key(){return"UnsavedChangesHighlight"}get Pw(){return"UnsavedChanges"}reset(Q){if(this.aea){Q=Q.node;if(hf.ParagraphReader.Wb(Q)){const za=this.aea.rNf;if(za&&za.contains(Q.id)){this.nFe=!0;this.Nwe=Q.id;return}}this.nFe=!1;this.Nwe=fh.a.nil}}rIa(){let Q=null;return this.nFe?(Q=Object.assign(new Ok.a,
{KG:this.key,contentObject:this.Nwe,description:null}),{returnValue:!0,RF:Q}):{returnValue:!1,RF:Q}}}Object(e.a)(nq,"UnsavedChangesHighlightCpContentDetailsProvider",null,[416,417]);class pt{constructor(Q,za,fb,Nb,tc,bd,Yd){this.H6g=null;this.S5=Q;this.af=za;this.kW=fb;this.u6=Nb;this.Jih=tc;this.rYb=bd;this.ox=Yd;this.af.QMa(this.rY.bind(this))}get rNf(){return this.H6g}mrm(){if(this.S5){if(1===this.S5.X7e){if(0===this.S5.iIf&&this.S5.JXi()){this.H6g=this.S5.j4d;const Q=this.S5.tad;this.S5.t9n.forEach(this.Pll.bind(this));
Q.forEach(this.nrm.bind(this));0<Q.length&&this.Anl(this.kW);return 0}return this.SNn(this.S5.iIf)}return 2}return 1}SNn(Q){switch(Q){case 0:return this.S5.umi()?5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}pni(Q,za,fb){if(za)if(fb){fb=za.querySelectorAll("span");for(let Nb=0;Nb<fb.length;Nb++){const tc=fb[Nb];Nb||tc.classList.add(Qh.$Cj);Nb===fb.length-1&&tc.classList.add(Qh.ZCj);tc.classList.add(this.ox?Qh.vlg:Qh.ulg)}za.classList.add(Qh.wlg);Q&&this.u6.jmc(Q)}else za.classList.add(Qh.s9n)}q9b(Q,
za){const fb=this.Lem(Q);if(Q&&(Q=Q.De(km.App.ya.gb.wc.ic)))if(Q.Pg&&Q.Pg.Ri&&0!==Q.Pg.Ri.count)for(const Nb of Q.Pg.Ri)this.pni(fb,Nb,za);else this.pni(fb,Q.htmlElement,za)}Lem(Q){return this.Jih&&(Q=this.Jih.CPc(Q))&&Q&&(Q=Q.De(km.App.ya.gb.wc.ic))?Q:null}nrm(Q){this.q9b(Q,!0);return!0}Pll(Q){this.q9b(Q,!1);return!0}Anl(Q){Q&&Q.continueWith(()=>{Q.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}rY(Q,za){za===Sys.EventArgs.Empty?ra.ULS.sendTraceTag(572364513,
306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):za&&za.errorCode?this.rYb.aR||(Q=this.mrm(),ra.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",Q),La.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==Q&&4!==Q&&this.PJo(Q)):ra.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",za?"Error Code":"Kickout Event Args")}PJo(Q){let za;const fb=new Ee.a;fb.extendedProperties=new Map;fb.extendedProperties.set("HighlightUnsavedChangesResult",
Q.toString());fb.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(Q){case 1:case 2:case 6:za="HighlightInternalError";break;case 5:za="ChangeOutsideCanvas"}6!==Q&&5!==Q||fb.extendedProperties.set("UnsavedChangesCollectionResult",this.S5.iIf.toString());za&&(La.Health.instance.recordQosError(za,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,fb),La.Health.instance.recordKpiFailure("UnsavedChangesHighlight",za,!0,!0,fb))}dispose(){this.af.IMb(this.rY.bind(this))}}Object(e.a)(pt,"UnsavedChangesHighlighter",
null,[9]);var oq=c(498),Rr=c(458),uu=c(1459);class Op extends uu.a{constructor(Q,za){super();this.aea=Q;this.ox=za}Dob(Q){if(!this.aea)return!1;const za=this.aea.rNf;return za?za.contains(Q.Bb.id)||Q.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}OPk(Q,za){za=Q.kwa?Q.kwa[za]?Q.kwa[za].style?Q.kwa[za].style.marginLeft:null:null:null;var fb=Q.leftMargin;Q=1440<=fb?-(fb/1440*96):Q.geb(0,96,this.zoom);fb=0;za&&(za=za.match(/^(\d+)px/))&&za[1]&&(fb=Number(za[1]));return Q-fb}sQk(Q,za,fb){return Sys.UI.DomElement.getBounds(Q).y-
fb.Jba[za].y}EPk(Q){return Sys.UI.DomElement.getBounds(Q).height}RLh(Q,za,fb,Nb){let tc;tc=this.OPk(fb,za);za=this.sQk(Q,za,fb);Q=this.EPk(Q);Nb=oq.a.createElement(Nb,Rr.a.div);Nb.className=this.ox?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Nb.style.left=tc+"px";Nb.style.top=za+"px";Nb.style.height=Q+"px";return Nb}hLh(Q,za,fb,Nb){const tc=[],bd=Q.querySelectorAll("."+Qh.wlg);if(0===bd.length&&Q.classList.contains(Qh.wlg))fb=this.RLh(Q,za,fb,Nb),fb.xfa=za,tc.push(fb);else for(Q=0;Q<
bd.length;Q++){const Yd=this.RLh(bd[Q],za,fb,Nb);Yd.xfa=za;tc.push(Yd)}return tc}cfb(Q){let za=[];var fb=Q.I4;const Nb=fb.eh.ownerDocument;if(fb.yj){let tc=0;for(const bd of fb.Pg.Ri)(fb=this.hLh(bd,tc,Q,Nb))&&(za=za.concat(fb)),tc+=1}else za=this.hLh(fb.htmlElement,0,Q,Nb);return za}}Object(e.a)(Op,"UnsavedChangesIndicatorActor",uu.a,[]);class Tu{constructor(){this.RV=this.tv=this.vKa=this.u6=this.Xkd=this.aea=null}get name(){return"WordEditor.UnsavedChangesHighlight"}xc(){}init(){this.u6=ua.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;
this.aea=new pt(ua.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),rh.SessionStatusManager.instance,Hh.a.Ap(ua.a.instance.Sa("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.u6,ua.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),ua.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),!!Za.App.instance&&Za.App.instance.uoa);this.vKa=ua.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager");this.RV=ua.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;
this.Xkd=new Op(this.aea,!!Za.App.instance&&Za.App.instance.uoa);this.u6.u5a(this.Xkd);this.vKa&&this.vKa.execute(Q=>{Q.Q4(new nq(this.aea))});this.tv=new ni(this.aea,!!Za.App.instance&&Za.App.instance.uoa);this.RV.t5a(this.tv)}dispose(){this.u6&&this.Xkd&&this.u6.Yme(this.Xkd);this.RV&&this.tv&&this.RV.plg(this.tv);Bg.a.UB(this.aea)}static main(){K.a.instance.Fc(new Tu)}}Object(e.a)(Tu,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,9]);var Kx=c(536);class Uk{constructor(Q,za,fb,Nb){fb=new wordVersionHistory.AppBootSettings;
fb.logger=new Kx.a;fb.forcePdfDevEnv=!1;fb.userSessionId=m.AFrameworkApplication.userSessionId;fb.documentId=Q.ape?m.AFrameworkApplication.hm:"";fb.wacCluster=Nb;fb.publicScriptPath=m.AFrameworkApplication.o5;fb.userType=m.AFrameworkApplication.userType;fb.isStaticVersionDisplayEnabled=m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VersionHistoryStaticDisplay",!1);fb.disableVhsFileCache=Q.ape;this.toe=new wordVersionHistory.AppVersionControllerImpl(fb,za)}onVersionSelected(Q,
za,fb,Nb){this.toe.onVersionSelected(Q,za,fb,Nb)}onDownloadTokenReady(Q,za){this.toe.onDownloadTokenReady(Q,za)}getRenderFailureEvent(){return this.toe.getRenderFailureEvent()}getLoadFinishEvent(){return this.toe.getLoadFinishEvent()}}Object(e.a)(Uk,"AppVersionControllerImplWrapper",null,[1724]);class vu{create(Q,za,fb,Nb){return new Uk(Q,za,fb,Nb)}}Object(e.a)(vu,"AppVersionControllerImplWrapperFactory",null,[1706]);class Rt{getVersionHistoryControllerInstance(Q){return versionHistory?versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Q):
null}}Object(e.a)(Rt,"VersionHistoryControllerFactory",null,[1704]);class Vs{static addAppPLTEventToLog(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Q)}catch(za){}}static setIsPageLoadForFirstTime(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Q)}catch(za){}}}Object(e.a)(Vs,"VersionHistoryLogConnector",null,[]);var Sr=c(501),jr=c(1444),yp=c(1666);class Qo{constructor(){this.revisionId=null;this.D7f=0}}Object(e.a)(Qo,"ForceSaveData",
null,[]);class Tr extends Ao.a{constructor(){super();this.ExclusiveLockId=this.VersionToken=this.FileId=null}$k(){return 106}static construct(Q,za,fb){const Nb=new Tr;Nb.FileId=Q;Nb.VersionToken=za;Nb.ExclusiveLockId=tj.a(fb);return Nb}}Object(e.a)(Tr,"RestoreVersionRequest",Ao.a,[]);class Ro{static Dna(){return(new Date).getTime()}static Z2k(Q){const za=new Ee.a;za.durationMs=Q;za.extendedProperties=new Map;return za}}Object(e.a)(Ro,"VersionHistoryUtils",null,[]);class zp{constructor(Q,za,fb,Nb,
tc,bd,Yd,Fd,De,Nf,Je,va,Oa,Ba,wa){this.pc=Q;this.xg=za;this.bF=fb;this.XFl=Nb;this.it=tc;this.dIi=bd;this.dnc=Yd;this.SBd=Fd;this.G_o=De;this.K=Nf;this.XBk=Je;this.K2e=va;this.Bqb=Oa;this.Re=Ba;this.cog=wa;this.pUa=this.ULc=this.b8c=this.vie=this.qeg=this.Ykg=this.perfTelemetryInfos=this.baseVersion=this.currentVersion=this.controller=null;this.Nee=0;this.N0b=this.soe=null;this.eog=jr.b.None;this.ibc=!1;this.gog="";this.wxl={0:"GeneralSaveError",1:"InvalidFileName",2:"EmptyFileName",3:"InvalidPermission",
4:"OverwriteTarget",5:"TargetFileLocked",6:"InvalidFileNameDisallowPercentOctothorpe"};this.Rrj=(Ua,zb,Qb)=>{if(1===Qb)return rh.SessionStatusManager.instance.wj?8:32;if(2===Qb){this.soe=Ae.a.create().toString();ra.ULS.sendTraceTag(592196993,3005,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.soe);m.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IDocsWordVersionHistorySaveACopyOverFlowMenuSettings");m.AFrameworkApplication.Aha("WoVer882;WoVer882cf");
Object(yp.a)();this.Re.logKpiUsage("WordVersionHistory",0,{isForAlertableKpi:!0});this.Re.Hv(Ag.a.pvn,{succeeded:!0});this.fxj.ShowVersionHistoryDialog=(new Date).getTime().toString();this.Ku.VersionHistoryLaunchSessionId=this.soe;this.perfTelemetryInfos=[];this.controller||(this.gog=this.K.jb("WacCluster"),this.controller=this.G_o.getVersionHistoryControllerInstance({ulsLogger:new Kx.a,serviceBase:this.K.appSettings.VersionHistoryWebServiceBase,docId:m.AFrameworkApplication.hm,appSettings:{appName:jr.a.Word,
wdEnableDownloadTokens:this.dnc.GKj,wdEnableSaveACopy:!0,wdEnableRestore:this.dnc.EKj,userSessionId:m.AFrameworkApplication.userSessionId,wacCluster:this.gog,uiLocale:m.AFrameworkApplication.uiCulture?m.AFrameworkApplication.uiCulture:"en-us",wdEnableHiddenButtonsUntilVersionLoadComplete:!0,wdEnableShowVersionChanges:!0,disabledChangeGates:m.AFrameworkApplication.K.jb("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.dnc.FKj,isRtl:m.AFrameworkApplication.isRtl,wdEnableAppColorUpdate:this.K.$("AppColorUpdateIsEnabled"),
useXhr:!1,retryCount:0,wdEnableDeleteVersions:!1,wdEnableIterator:!1,viewerRootPositionRelative:!1,disableSaveACopy:!1,wdDisableSPOFileCache:this.dnc.ape},perfTelemetryInfos:this.perfTelemetryInfos}));if(!this.controller)return this.Re.logKpiFailure("WordVersionHistory","scriptDependencyUnavailable",{isIntentional:!1},{name:zp.vetoName,errorNameOverride:"VersionHistoryLaunchFailed",isIntentional:!1}),8;this.controller.setDisableSaveACopy(this.gpo()||this.dpo());this.Yvo()}return 32};this.D2n=(Ua,
zb,Qb)=>{if(1===Qb)return rh.SessionStatusManager.instance.KH?32:8;2===Qb&&(Ua=this.Leb(this.Nee),this.Re.logKpiSuccess("WordVersionHistorySaveACopy",{additionalValues:Ua}),this.o3f());return 32};this.C2n=(Ua,zb,Qb,Xb,Dc)=>{var Fc,Zc,kd;if(1===Qb)return rh.SessionStatusManager.instance.KH?32:8;2===Qb&&(Ua="Unknown",zb="",Dc&&(Ua=null!==(Fc=Dc.FailureReason)&&void 0!==Fc?Fc:Ua,Dc=null!==(Zc=Dc.ExtraInfo)&&void 0!==Zc?Zc:"",zb=null!==(kd=this.wxl[Dc])&&void 0!==kd?kd:Dc),Zc=this.Leb(this.Nee),""!==
zb&&Zc.extendedProperties.set("ExtraInfo",zb),kd=this.Bqb.Vhb(Ua,3,zb),this.Re.logKpiFailure("WordVersionHistorySaveACopy",Ua,{isIntentional:kd.isIntentional,additionalValues:Zc},kd),ra.ULS.sendTraceTag(592197004,3005,10,"Save failed with {0} {1}",Ua,zb));return 32};this.z0d=()=>{this.LQi();this.o3f();this.it&&this.it.refreshDocument({Mso:!0})};this.ZFl=Ua=>{ra.ULS.sendTraceTag(592197010,3005,50,"DocumentSavedSuccessfully");var zb=Ua.revisionId;const Qb=fh.a.create();zb=Tr.construct(m.AFrameworkApplication.rootQuerySignature,
zb,Qb);const Xb=Object.assign(new zk.a,{Cq:zb,status:1,GG:"RestoreVersion"});zb=this.K2e.rga(0,()=>{this.Imm(Xb,Ua.D7f)});zb.EI(Xb);zb.BT()};this.b1h=(Ua,zb)=>{this.ibc=!1;const Qb=this.Leb(Ua.D7f);Qb.extendedProperties.set("status",Sr.a[zb]);const Xb=this.Bqb.Vhb("ForceSaveFailed",5);this.Re.logKpiFailure("WordVersionHistoryRestore","forceSaveFailed",{isIntentional:Xb.isIntentional,additionalValues:Qb},Xb);this.Re.Hv(Ag.a.jGc,{succeeded:!1});ra.ULS.sendTraceTag(592197011,3005,10,"ForceSaveFailed with status"+
Sr.a[zb]+" for version "+Ua);this.controller.setRestoreFailedAtServer(this.z0d)};this.fxj={};this.Ku={};this.Xvo=!1;this.pJ=!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb.pJ}hDd(){null===this.ULc&&(this.ULc=Ro.Dna())}Leb(Q){const za=new Ee.a;null===Q?ra.ULS.sendTraceTag(541693581,3005,10,"constructKpiAdditionalValuesWithDurationFromStartTime called with null startTime"):(za.durationMs=Ro.Dna()-Q,za.extendedProperties=new Map);return za}vym(){null===this.pUa&&(this.pUa=Ro.Dna());this.Re.logKpiUsage("WordVersionHistorySelectVersion",
0,{isForAlertableKpi:!0})}o3f(){const Q=[],za=Object.assign(new Ee.a,{extendedProperties:new Map});if(null!=this.vie&&null!=this.qeg){var fb=this.vie-this.qeg;Q.push(Object.assign(new lc.a,{name:"showPaneDuration",string:fb.toString()}));za.extendedProperties.set("showPaneDuration",fb.toString())}null!=this.ULc&&null!=this.b8c&&(fb=this.ULc-this.b8c,Q.push(Object.assign(new lc.a,{name:"firstActionDuration",string:fb.toString()})),za.extendedProperties.set("firstActionDuration",fb.toString()));(fb=
this.eog===jr.b.None)?this.Re.logKpiSuccess("WordVersionHistory",{additionalValues:za}):this.Re.logKpiFailure("WordVersionHistory",jr.b[this.eog],{isIntentional:!1,additionalValues:za},{name:zp.vetoName,errorNameOverride:"VersionHistoryLaunchFailed",isIntentional:!1});this.Re.Hv(Ag.a.bZk,{succeeded:fb,customData:Q})}Tb(){this.pc.qa(n.a.Hie,z.a.frame,this.Rrj);this.pc.qa(n.a.F4c,z.a.frame,this.D2n);this.pc.qa(n.a.Ede,z.a.frame,this.C2n)}Yvo(){this.qeg=Ro.Dna();this.ULc=this.b8c=this.vie=null;if(document.getElementById("VersionHistoryOverlay"))this.CI();
else{this.CTn();this.BTn();this.lTn();this.qTn();this.zTn();this.pTn();this.dnc.HKj&&this.oTn();this.yTn();this.ATn();const Q=document.createElement("div");let za=Q.id="VersionHistoryOverlay",fb=null;this.rTn(Q);if(this.pJ&&(fb=Object(Hp.a)("Header"))){const Nb=document.getElementById("AppHeaderPanel");za=Nb&&"none"===Nb.style.display?String.format("{0} {1} {2}",za,"RegionComposer","NoAppHeader"):String.format("{0} {1}",za,"RegionComposer")}fb||(fb=document.getElementById("WACInnerFrame"));Q.className=
za;fb.appendChild(Q);this.Ykg=this.controller.createVersionHistoryDialog(Q);this.Wia()}document.getElementById("VersionHistoryOverlay").style.display="block";this.controller.getVersions("");this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VersionHistoryNvdaFix",!1)&&(document.getElementById("vhViewer").role="document")}gpo(){if(m.AFrameworkApplication.JG)return ra.ULS.sendTraceTag(570770272,3005,15,"Version History is disabling Save a Copy because this is a protected file."),!0;const Q=32==
this.pc.processAction(n.a.Ohc,1),za=32==this.pc.processAction(n.a.Qhc,1);return Q||za?!1:(ra.ULS.sendTraceTag(545403476,3005,15,"Version History is disabling Save a Copy because the save commands are disabled."),!0)}dpo(){return m.AFrameworkApplication.JG?(ra.ULS.sendTraceTag(545387291,3005,15,"Version History is disabling download version because this is a protected file."),!0):32!=this.pc.processAction(n.a.downloadACopy,1)?(ra.ULS.sendTraceTag(545403477,3005,15,"Version History is disabling download version because the download command is disabled."),
!0):!1}qTn(){this.controller.getFullAppErrorEvent().addListener(Q=>{const za=Q?jr.b[Q]:"";this.Ku[zp.LFo]=za;this.eog=Q;ra.ULS.sendTraceTag(592196994,3005,10,"Full App Error Event: {0}, VersionHistoryLaunchSessionId: {1}",za,this.soe)})}CTn(){this.controller.getVersionsReadyEvent().addListener(Q=>{this.vie=Ro.Dna();this.q3n(Q.containerDiv);this.cog.initialize(this.N0b);this.CI()})}BTn(){this.controller.getVersionSelectedEvent().addListener(Q=>{null===this.pUa&&(this.pUa=Ro.Dna());this.cog.display(Q)})}oTn(){this.controller.getDownloadTokenReadyEvent().addListener(Q=>
{try{ra.ULS.sendTraceTag(592196998,3005,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.vlm(Q)}catch(za){ra.ULS.sendTraceTag(592197002,3005,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",za)}})}vlm(Q){Q&&Q.versionSelected?(this.currentVersion=Q.versionSelected.currentVersion,this.baseVersion=Q.versionSelected.baseVersion,this.vym(),this.N0b.onVersionSelected(this.currentVersion,this.baseVersion,this.fxj,!this.Xvo)):ra.ULS.sendTraceTag(591697922,
3005,10,"handleGetDownloadTokenReadyEvent: downloadTokenReadyObject.versionSelected was null")}lTn(){this.controller.getCloseSelectedEvent().addListener(()=>{this.cZk();this.MWm()})}Nxm(Q){const za={};za.FileDownloadUrl=Q;za.SaveEntryPoint="VersionHistory";return za}s$l(Q){let za="Dialog Failure - ActionResponse "+Q.toString();2===Q?za="DialogNotHandled":8===Q&&(za="DialogFailed");return za}zTn(){this.controller.getSaveACopySelectedEvent().addListener(Q=>{this.Nee=Ro.Dna();this.Re.logKpiUsage("WordVersionHistorySaveACopy",
0);this.hDd();ra.ULS.sendTraceTag(592197003,3005,50,"VersionHistoryPaneActor: RegisterForSaveACopySelectedEvent");this.LQi();var za=this.Nxm(Q);Q=32==this.pc.processAction(n.a.Ohc,1);za=this.pc.Qb(Q?n.a.Ohc:n.a.Qhc,2,za);const fb=this.Leb(this.Nee),Nb=32===za;if(!Nb){const tc=this.s$l(za),bd=this.Bqb.Vhb(tc,2);this.Re.logKpiFailure("WordVersionHistorySaveACopy",tc,{isIntentional:bd.isIntentional,additionalValues:fb},bd);ra.ULS.sendTraceTag(578033103,3005,10,Q?"SaveACopy":"SaveToSharePoint failed with ActionResponse: "+
za.toString())}this.Re.Hv(Ag.a.YXk,{succeeded:Nb})})}pTn(){this.controller.getDownloadVersionSelectedEvent().addListener(Q=>{var za=Ro.Dna();this.Re.logKpiUsage("WordVersionHistoryDownloadVersion",0);this.hDd();Q=new Uf.QueryStringBuilder(Q);Q.Ce("fn",m.AFrameworkApplication.fileName);Q=this.pc.Qb(n.a.downloadACopy,2,{["FileDownloadUrl"]:Q.toString()});za=this.Leb(za);const fb=32===Q;fb?this.Re.logKpiSuccess("WordVersionHistoryDownloadVersion",{additionalValues:za}):(this.Re.logKpiFailure("WordVersionHistoryDownloadVersion",
Q.toString(),{isIntentional:!1,additionalValues:za},{name:zp.vetoName,errorNameOverride:"DownloadVersionFailed"}),ra.ULS.sendTraceTag(592197005,3005,10,"Download version failed with result: "+Q.toString()));this.Re.Hv(Ag.a.XXk,{succeeded:fb})})}Imm(Q,za){this.ibc=!1;if(2===Q.statusCode&&Q.zj&&0<Q.zj.length&&Q.zj[0])if(Q=Q.zj[0],za=this.Leb(za),this.dIi&&Q.ShouldAvoidLockRelease&&this.dIi.j6a(!1,"VersionHistory"),191===Q.StatusCode)Q=this.Bqb.Vhb("MultipleClientsInCoauthSession",5),this.Re.logKpiFailure("WordVersionHistoryRestore",
"multipleClientsInCoauthSession",{isIntentional:!0,additionalValues:za},Q),this.Re.Hv(Ag.a.jGc,{succeeded:!1}),ra.ULS.sendTraceTag(592197006,3005,10,"RestoreVersionRequest failed with MultipleClientsInCoauthSession"),this.controller.setCoauthRestoreError(),zp.NWm();else if(Q.StatusCode){za.extendedProperties.set("status",Sr.a[Q.StatusCode]);const fb=this.Bqb.Vhb("ServerOperationFailed",5);this.Re.logKpiFailure("WordVersionHistoryRestore","restoreVersionResponseFailed",{isIntentional:!1,additionalValues:za},
fb);this.Re.Hv(Ag.a.jGc,{succeeded:!1});ra.ULS.sendTraceTag(592197007,3005,10,"RestoreVersionRequest failed with "+Sr.a[Q.StatusCode]);this.controller.setRestoreFailedAtServer(this.z0d)}else this.Re.logKpiSuccess("WordVersionHistoryRestore",{additionalValues:za}),this.Re.Hv(Ag.a.jGc,{succeeded:!0}),ra.ULS.sendTraceTag(592197008,3005,50,"Restore Version Successful."),this.z0d();else za=this.Bqb.Vhb("ServerOperationFailed",5),this.Re.logKpiFailure("WordVersionHistoryRestore","serverOperationFailed",
{isIntentional:za.isIntentional},za),ra.ULS.sendTraceTag(592197009,3005,10,"serverOperation failed with "+jn.a[Q.statusCode]),this.controller.setRestoreFailedAtServer(this.z0d)}yTn(){this.controller.getRestoreVersionSelectedEvent().addListener(Q=>{if(this.ibc)ra.ULS.sendTraceTag(536998742,3005,50,"restore already in progress");else{this.ibc=!0;this.hDd();var za=Ro.Dna();this.Re.logKpiUsage("WordVersionHistoryRestore",0);var fb=null;Q&&(fb=Q.split("-")[0]);fb&&""!==fb?(Q=Object.assign(new Qo,{revisionId:fb,
D7f:za}),ra.ULS.sendTraceTag(592197013,3005,50,"VersionHistoryPaneActor: RegisterForRestoreVersionSelectedEvent: {0}",fb),this.controller.setRestoreInProgress(),this.XFl(19,!1,this.ZFl,this.b1h,Q,null,null)):(fb=this.Bqb.Vhb("InvalidRevisionId",5),this.Re.logKpiFailure("WordVersionHistoryRestore","invalidRevisionId",{isIntentional:fb.isIntentional},fb),this.Re.Hv(Ag.a.jGc,{succeeded:!1}),ra.ULS.shipAssertTag(592197012,3005,!1),this.ibc=!1)}})}DTn(){this.N0b.getRenderFailureEvent().addListener(Q=>
{const za=this.Bqb.Vhb(Q,1),fb=this.Leb(this.pUa);this.pUa=null;this.Re.logKpiFailure("WordVersionHistorySelectVersion",Q,{isIntentional:za.isIntentional,additionalValues:fb},za);try{this.Ku.ViewerErrorCode="ViewerErrorCode"in this.Ku?this.Ku.ViewerErrorCode+("; "+Q):Q,this.controller.setViewerError(!0),ra.ULS.sendTraceTag(592197014,3005,10,"Versions viewer error code: {0}",Q)}catch(Nb){ra.ULS.sendTraceTag(592197015,3005,10,"Failed to set viewer error: {0}",Nb)}})}sTn(){this.N0b.getLoadFinishEvent().addListener(()=>
{null==this.b8c&&(this.b8c=Ro.Dna());const Q=this.Leb(this.pUa);this.pUa=null;this.Re.logKpiSuccess("WordVersionHistorySelectVersion",{additionalValues:Q});this.controller.setVersionLoadComplete()})}ATn(){this.controller.getShowVersionChangesToggledEvent().addListener(()=>{null===this.pUa&&(this.pUa=Ro.Dna());this.cog.AIo()})}allowKeytips(Q){F.a("allowKeytips")&&appChrome.api.allowKeytips(Q)}CI(){this.bF.Rw(Xl.AppFrame.Upa);this.allowKeytips(!1);this.bF.Rw(wd.AFrame.Pn);this.bF.Rw(Xl.AppFrame.uqa);
this.xg.kL("VersionHistoryViewer",!1);this.bF.CI("VersionHistoryViewer");this.xg.kL("VersionHistoryHeader",!0);this.bF.CI("VersionHistoryHeader");this.xg.kL("VersionHistoryOverlay",!0);this.bF.CI("VersionHistoryOverlay")}Rw(){this.bF.CI(Xl.AppFrame.Upa);this.allowKeytips(!0);this.bF.CI(wd.AFrame.Pn);this.bF.CI(Xl.AppFrame.uqa);this.bF.Rw("VersionHistoryOverlay");this.xg.yR("VersionHistoryOverlay");this.bF.Rw("VersionHistoryHeader");this.xg.yR("VersionHistoryHeader");this.bF.Rw("VersionHistoryViewer");
this.xg.yR("VersionHistoryViewer")}cZk(){this.ibc&&ra.ULS.sendTraceTag(536998743,3005,10,"restore did not complete!");this.o3f();document.getElementById("VersionHistoryOverlay").style.display="none";this.Ku.browser=Aa.a.bG;Aa.a.a4&&(this.Ku.electronBrowserVersion=Aa.a.zrl);this.Rw();ra.ULS.sendTraceTag(592197017,3005,50,Ya.c(this.Ku))}q3n(Q){try{if(this.N0b)Vs.setIsPageLoadForFirstTime(!1);else{Vs.setIsPageLoadForFirstTime(!0);const za=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryBadGatewayFixEnabled",
!1)?this.gog:"";this.N0b=this.XBk.create(this.dnc,Q,this.SBd,za);this.DTn();this.sTn()}}catch(za){ra.ULS.sendTraceTag(592197018,3005,10,"WordVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",za)}}$Ab(Q){const za=this.xg.ge(Q);za.parent=wd.AFrame.rp;this.bF.uaa(Q);za.OH=!0;return za}Wia(){this.$Ab("VersionHistoryOverlay").d7((Q,za)=>{try{null!=Q&&"dialog/modal"==Q.name?this.controller.setSaveACopyCanceled():"VersionHistoryOverlay"===za.name&&this.Ykg.then(fb=>
{fb.enterFocusTrapZone();return null})}catch(fb){ra.ULS.sendTraceTag(592197019,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",fb)}});this.$Ab("VersionHistoryHeader").d7((Q,za)=>{try{"VersionHistoryHeader"===za.name&&this.Ykg.then(fb=>{fb.enterHeaderFocusTrapZone();return null})}catch(fb){ra.ULS.sendTraceTag(592197020,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",fb)}});this.$Ab("VersionHistoryViewer").d7((Q,za)=>{try{"VersionHistoryViewer"===
za.name&&ei.FocusManager.OJ(document.getElementById("vhViewer"))}catch(fb){ra.ULS.sendTraceTag(592197021,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",fb)}})}MWm(){const Q=ua.a.instance.Na("Common.ISystemInitiatedFeedback");Q?(Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"),Q.logActivity("VersionHistoryCheckExited","WordVersionHistoryFGIsEnabled")):ra.ULS.sendTraceTag(592197022,3005,10,"ISystemInitiatedFeedback was null")}LQi(){const Q=ua.a.instance.Na("Common.ISystemInitiatedFeedback");
Q?Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"):ra.ULS.sendTraceTag(592197023,3005,10,"ISystemInitiatedFeedback was null")}static NWm(){const Q=ua.a.instance.Na("Common.ISystemInitiatedFeedback");Q?Q.logActivity("VersionHistoryRestoreCoauthFailed","VersionHistoryRestoreSurveyEnabled"):ra.ULS.sendTraceTag(578359496,3005,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}rTn(Q){Q&&Q.addEventListener("keydown",za=>{za.ctrlKey&&"KeyC"===za.code&&
(this.hDd(),this.Re.logKpiUsage("WordVersionHistoryCopyText",0),!m.AFrameworkApplication.protectFile&&!m.AFrameworkApplication.JG||m.AFrameworkApplication.qCb||za.preventDefault());za.ctrlKey&&"KeyF"===za.code&&this.Re.logKpiUsage("WordVersionHistorySearchText",0)})}}zp.LFo="ErrorCode";zp.vetoName="VersionHistoryExperienceDegraded";Object(e.a)(zp,"VersionHistoryPaneActor",null,[1705]);class St{constructor(){this.ape=this.FKj=this.EKj=this.HKj=this.GKj=!1}}Object(e.a)(St,"WordVersionHistorySettings",
null,[]);class Uu{Vhb(Q,za,fb){const Nb={name:"VersionHistoryExperienceDegraded",isIntentional:!1};0==za?Nb.errorNameOverride="VersionHistoryLaunchFailed":1==za?Q.includes("Failed to fetch")?Nb.errorNameOverride="SelectVersionFailedBecauseFetchFailed":Q.includes("Unexpected server response (500) while retrieving PDF")?Nb.errorNameOverride="SelectVersionFailedServerResponseInternalError":Q.includes("Unexpected server response (502) while retrieving PDF")?Nb.errorNameOverride="SelectVersionFailedServerResponseBadGateway":
Q.includes("Unexpected server response (415) while retrieving PDF")?(Nb.errorNameOverride="SelectVersionFailedServerResponseUnsupportedMediaType",Nb.isIntentional=!0):Q.includes("Unexpected server response (408) while retrieving PDF")?Nb.errorNameOverride="SelectVersionFailedServerResponseRequestTimeout":Q.includes("Unexpected server response (400) while retrieving PDF")?Nb.errorNameOverride="SelectVersionFailedServerResponseBadRequest":Q.includes("Unexpected server response (413) while retrieving PDF")?
(Nb.errorNameOverride="SelectVersionFailedServerResponseRequestEntityTooLarge",Nb.isIntentional=!0):Nb.errorNameOverride="SelectVersionFailed":5==za?(Nb.errorNameOverride="RestoreVersionFailed"+Q,Nb.isIntentional="MultipleClientsInCoauthSession"===Q):4==za?Nb.errorNameOverride="DownloadVersionFailed"+Q:2==za?Nb.errorNameOverride=Uu.S8f+Q:3==za&&(fb?(Nb.errorNameOverride=Uu.S8f+fb,Nb.isIntentional="OverwriteTarget"===fb||"TargetFileLocked"===fb):(Q=this.WXl(Q),Nb.errorNameOverride=Q?"SaveVersionFailedServerResponse"+
Q:Uu.S8f));return Nb}WXl(Q){switch(Q){case "400":return"BadRequest";case "401":return"Unauthorized";case "403":return"Forbidden";case "404":return"NotFound";case "408":return"Timeout";case "500":return"InternalError";default:return""}}}Uu.S8f="SaveVersionFailed";Object(e.a)(Uu,"WordVersionHistoryVetoHelper",null,[1702]);var Vu=c(1037),cq=c(1030);class Wu{constructor(Q,za){this.Goe=Q;this.Re=za;this.I0e=null;this.CVc=!0}initialize(Q){this.I0e=Q}AIo(){this.CVc=!this.CVc;this.display(this.eff)}display(Q){this.eff=
Q;this.YKf(Q);if(this.I0e){var za=this.Goe.nhm(Q,this.CVc);if(2==za)this.Goe.Qtn(Q.currentVersion.RevisionID);else{1==za&&this.Re.logKpiFailure("WordVersionHistoryShowChanges","BaseNotAvailable",{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});this.Goe.Dln(Q.currentVersion.RevisionID);try{this.I0e.onVersionSelected(this.eff.currentVersion,this.eff.baseVersion,null,this.CVc)}catch(fb){ra.ULS.sendTraceTag(524957267,3005,10,"Exception thrown by onVersionSelected: {0}",fb)}}}else this.V5m()}YKf(Q){this.Goe.tEm(Q.currentVersion.RevisionID)||
(this.Re.logKpiUsage("WordVersionHistorySelectVersion",0,{isForAlertableKpi:!0}),this.CVc&&!Q.noBaseToCompareTo&&this.Re.logKpiUsage("WordVersionHistoryShowChanges",0))}V5m(){this.Re.logKpiFailure("WordVersionHistorySelectVersion","VersionDisplayActorUninitialized",{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});ra.ULS.sendTraceTag(524957266,3005,10,"AppVersionController was not initialized!")}}Object(e.a)(Wu,"VersionDisplayActor",null,[1701]);var pq;(function(Q){Q[Q.notStarted=0]="notStarted";
Q[Q.inProgress=1]="inProgress";Q[Q.complete=2]="complete"})(pq||(pq={}));Object(e.b)("WaitForBaseState",pq);class dq{constructor(Q,za){this.revisionId=Q;this.Re=za;this.state=pq.notStarted}get efl(){return this.revisionId}begin(){this.state==pq.notStarted&&(this.startTime=Ro.Dna(),this.state=pq.inProgress,this.Re.logKpiUsage("WordVersionHistoryWaitForBase",1),ra.ULS.sendTraceTag(524957265,3005,50,"WaitForBaseOperation.begin"))}end(Q){if(this.state==pq.inProgress){this.state=pq.complete;this.endTime=
Ro.Dna();const za=Ro.Z2k(this.endTime-this.startTime);this.revisionId==Q?this.Re.logKpiSuccess("WordVersionHistoryWaitForBase",{additionalValues:za}):this.Re.logKpiFailure("WordVersionHistoryWaitForBase","WaitForBaseTimedOut",{additionalValues:za},{name:"VersionHistoryExperienceDegraded"})}}}Object(e.a)(dq,"WaitForBaseOperation",null,[]);class Ap{constructor(Q){this.Re=Q}nhm(Q,za){return Q.noBaseToCompareTo||!za?0:Q.baseVersion?Q.baseVersion.DownloadUrl&&0<Q.baseVersion.DownloadUrl.length?0:void 0===
Q.baseVersion.DownloadUrl||null===Q.baseVersion.DownloadUrl?1:0==Q.baseVersion.DownloadUrl.length?2:1:1}tEm(Q){return this.aRb?this.aRb.efl==Q:!1}Dln(Q){this.aRb&&this.Vuj(Q)}Qtn(Q){this.aRb&&this.Vuj(Q);this.aRb=new dq(Q,this.Re);this.aRb.begin()}Vuj(Q){this.aRb.end(Q);this.aRb=null}}Object(e.a)(Ap,"WaitForBaseController",null,[1674]);class Xu{constructor(){this.qYo={crewAlias:"webasynccollabeng",featureName:"VersionHistory",topLevelKpiName:"VersionHistoryFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.VersionHistory"}init(){m.AFrameworkApplication.Q_d()?
(ra.ULS.sendTraceTag(39966528,3005,50,"WordVersionHistoryPackage:init - Initializing the React VersionHistory package"),Gb.a.get_instance().Dk(7,()=>{const Q=this.container.resolve("Common.IDynamicScriptLoaderProvider").Kz;(m.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("wordVersionHistory"):Q.loadScript("wordVersionHistory")).catch(za=>ra.ULS.sendTraceTag(39966529,3005,10,"Failed to load the resources for the versionHistory feature: {0}",za)).then(()=>this.Itn()).catch(za=>
ra.ULS.sendTraceTag(39966530,3005,10,"Failed to initialize the versionHistory feature: {0}",za))})):ra.ULS.sendTraceTag(39966498,3005,50,"WordVersionHistoryPackage:init - Not initializing the React VersionHistory package because the feature is disabled")}Itn(){ra.ULS.sendTraceTag(541942913,3005,50,"Finished loading resources for the versionHistory feature");this.container.resolve("IVersionHistoryPaneActor").Tb();return null}dispose(){}xc(Q){this.container=Q;this.K=this.container.resolve("Common.IAppSettingsManager");
if(this.K.$("AppSupportsVersionHistory")){var za=this.container.resolve("Common.IBrowserUtils"),fb=new St;fb.GKj=this.K.$("WordWdDownloadTokenIsEnabled");fb.HKj=this.K.$("WordWdDownloadTokenRegisterIsEnabled");fb.EKj=this.K.$("WordVersionHistoryEnableRestore");fb.FKj=this.K.$("WordVersionHistorySaveACopyOverFlowMenuIsEnabled");fb.ape=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableVhsFileCache",!1);this.container.ha("IFeatureUsageAndHealthLogger",()=>new Vu.a(La.Health.instance,new cq.a,
this.qYo)).singleInstance();this.container.ha("IWaitForBaseController",()=>new Ap(this.container.resolve("IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("IVersionDisplayActor",()=>new Wu(this.container.resolve("IWaitForBaseController"),this.container.resolve("IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("IVersionHistoryPaneActor",()=>new zp(m.AFrameworkApplication.va,ei.FocusManager.instance(),tb.a.instance,de.a.FQ,Za.App.ya,Za.App.fV,fb,za,new Rt,m.AFrameworkApplication.K,
new vu,new Cm.a,new Uu,this.container.resolve("IFeatureUsageAndHealthLogger"),this.container.resolve("IVersionDisplayActor"))).singleInstance()}}static main(){let Q=!1;m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("IsOnDemandVersionHistoryEnabled")&&m.AFrameworkApplication.Q_d()&&(Q=!0);K.a.instance.Fc(new Xu,0,Q)}}Object(e.a)(Xu,"WordVersionHistoryPackage",null,[1,2]);var Ur=c(126);class Xw{constructor(Q,za,fb){this.ga=Q;this.Vm=za;this.Ma=fb}Tb(){this.Ma.$("ZoomPopupDialogIsEnabled")&&
(this.ga.qa(n.a.Mjc,z.a.frame,Object(a.a)(this.Vm,this.Vm.Mjc,"showZoomDialog")),this.ga.fb(n.a.OKn,z.a.frame,Object(a.a)(this.Vm,this.Vm.HVi,"onQueryZoomText"),96),this.ga.qa(n.a.gcd,z.a.frame,Object(a.a)(this.Vm,this.Vm.VKj,"zoomDialogTabFocusHandler")),this.ga.qa(n.a.fcd,z.a.frame,Object(a.a)(this.Vm,this.Vm.VKj,"zoomDialogTabFocusHandler")));this.Ma.$("ZoomSliderIsEnabled")&&(this.ga.fb(n.a.J4i,z.a.frame,Object(a.a)(this.Vm,this.Vm.pqn,"onQueryZoomPercentage"),96),this.ga.fb(n.a.XKj,z.a.frame,
Object(a.a)(this.Vm,this.Vm.cun,"onZoomToPercentage"),96),this.ga.qa(n.a.G5o,z.a.frame,Ur.ActionManager.Of))}}Object(e.a)(Xw,"CommonZoomActor",null,[946]);class Xm extends Xw{constructor(Q,za,fb){super(Q,za,fb);this.Qea=za}Tb(){super.Tb();this.Ma.$("ZoomPopupDialogIsEnabled")&&(this.ga.qa(Ag.a.Kpg,z.a.frame,Ur.ActionManager.Of),this.ga.qa(Ag.a.ppe,z.a.frame,Object(a.a)(this.Qea,this.Qea.F5o,"zoomTo100")));this.ga.qa(Ag.a.zoomToPageWidth,z.a.frame,Object(a.a)(this.Qea,this.Qea.zoomToPageWidth,"zoomToPageWidth"));
this.ga.qa(n.a.Kib,z.a.frame,Object(a.a)(this.Qea,this.Qea.Kib,"increaseZoom"));this.ga.qa(n.a.tfb,z.a.frame,Object(a.a)(this.Qea,this.Qea.tfb,"decreaseZoom"));this.ga.qa(Ag.a.H9f,z.a.frame,Object(a.a)(this.Qea,this.Qea.Rmo,"setZoomLevelFromRibbon"));this.ga.fb(Ag.a.cnb,z.a.frame,Object(a.a)(this.Qea,this.Qea.HVi,"onQueryZoomText"),96);this.ga.fb(Ag.a.Dbe,Ei.a.application,Object(a.a)(this.Qea,this.Qea.oqn,"onQueryZoomLevelLabelText"),96);this.ga.qa(ph.a.yNh,z.a.frame,Ur.ActionManager.Of);this.ga.qa(ph.a.xNh,
z.a.frame,Ur.ActionManager.Of);this.ga.qa(ph.a.CNh,z.a.frame,Ur.ActionManager.Of);this.ga.qa(ph.a.zNh,z.a.frame,Ur.ActionManager.Of);this.ga.qa(Ag.a.yja,z.a.frame,Ur.ActionManager.Of)}}Object(e.a)(Xm,"WordEditorZoomActor",Xw,[]);class qt{constructor(Q,za){this.zoom=Q;this.wAk=za}}Object(e.a)(qt,"SetCustomZoomArgs",null,[]);var Br=c(1144);class dg{constructor(Q,za){this.ogl=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.pgl=[dg.Zdf,dg.zId,"200","150",
"100","75","50"];this.yma=3;this.uN=0;this.delta=.1;this.eJf=0;this.kd=new O.a;this.fi=null;this.K=Q;this.pc=za;this.jnj(1)}get ij(){return this.uN}jnj(Q){this.uN=Q}get AIc(){return Math.round(100*this.ij)}get Sen(){return Math.floor(this.AIc/10)/10+this.delta}get Ren(){return Math.ceil(this.AIc/10)/10-this.delta}get ga(){return m.AFrameworkApplication.va}myk(Q){this.kd.addHandler("ZoomChanged",Q)}P_n(Q){this.kd.removeHandler("ZoomChanged",Q)}I0(Q){this.myk(Q)}E5a(Q){this.P_n(Q)}o8i(){}i$i(){}n8i(){}h$i(){}hcd(Q){this.WKj(Q,
this.ij)}WKj(Q,za){null!==Q&&Y.a.Tlj(Q,za)}acg(Q,za=!0){let fb=Q*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(fb=new qt(Q,za));this.Jjj(fb)}Qmo(Q,za=!1){this.yja(Q,3|(za?0:4))}aun(Q,za,fb){if(1===Q)return 32;Q=fb/100;Q<this.TYc?Q=this.TYc:Q>this.xYc&&(Q=this.xYc);this.yja(Q,1);za&&(za.ks=Math.floor(100*Q));return 32}HVi(Q,za,fb,Nb,tc){if(1===fb)return 32;Q=Ra.a.$Da(this.AIc,6,m.AFrameworkApplication.numberFormat);tc.Value=Q;tc.LabelText=Q;return 32}cun(Q,za,fb,Nb,tc){return 1===fb?
32:this.aun(fb,Nb,tc.value)}pqn(Q,za,fb,Nb,tc){tc.MinValue=100*this.TYc;tc.MaxValue=100*this.xYc;tc.value=this.AIc;return 32}eji(){return this.ogl}fji(){return this.pgl}GRl(){let Q=Math.floor(100*this.ij).toString();1===this.yma?Q=dg.Zdf:2===this.yma&&(Q=dg.zId);return Q}Kib(Q,za,fb){if(1===fb)return 32;this.XXc(this.pc?this.pc.zD:0,"IncreaseZoom");this.yma=0;this.yja(this.Sen);return 32}tfb(Q,za,fb){if(1===fb)return 32;this.XXc(this.pc?this.pc.zD:0,"DecreaseZoom");this.yma=0;this.yja(this.Ren);return 32}Rmo(Q,
za,fb,Nb,tc){if(1===fb)return 32;this.XXc(this.pc?this.pc.zD:0,"SetZoomLevelFromRibbon");Q=tc.Value;if(Q.toLowerCase().startsWith("fit"))return Q=new Pc.a(0,1,0,()=>{this.zoomToPageWidth(0,null,2,null,null)},138,void 0,!0),pm.a.instance.Vb(Q),32;Q=parseInt(Q)/100;if(isNaN(Q))return 2;this.yma=0;this.yja(Q);return 32}XXc(Q,za){ra.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",Q,za,m.AFrameworkApplication.ta.Nb.Yq)}Mjc(Q,za,fb){if(1===fb)return 32;ra.ULS.sendTraceTag(7176728,
353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const Q=this.GRl();this.fi=new Br.a(this.eji(),this.fji(),Object(a.a)(this,this.Inm,"handleZoomDialogResult"),ei.FocusManager.instance(),!0);this.fi.Mjc(CommonUIStrings.l_ZoomDialogTitle,Q)}pHm(Q){return Q.toLowerCase()===dg.Zdf.toLowerCase()}qHm(Q){return Q.toLowerCase()===dg.zId.toLowerCase()}Inm(Q){if(Q){if(this.pHm(Q)){this.yma=1;var za=32}else if(this.qHm(Q))this.yma=2,za=this.zoomToPageWidth(0,null,
2,null,null);else if(za=Number.parseInvariant(Q)){this.yma=0;let fb=za;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(fb=new qt(za,!0));za=this.Jjj(fb)}else za=8;32===za?ra.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:Q}):ra.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}else ra.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}QMn(){this.kd.raiseEvent("ZoomChanged",null)}m5i(){}B2f(){}VKj(Q){if(!this.fi)return 2;
var za=this.fi.xg.Ps().Zj.s3;if(za===this.fi.Hz&&Q===n.a.gcd||za===this.fi.ZG&&Q===n.a.fcd)this.fi.Lyb||this.fi.bao(),this.fi.xg.Ps().Zj.Gy(this.fi.Lyb);else if(za.id.startsWith(this.fi.U2c)||za.className.startsWith(this.fi.R4i))za=null,Q===n.a.gcd?za=this.fi.ZG:Q===n.a.fcd&&(za=this.fi.Hz),this.fi.xg.Ps().Zj.Gy(za),Sys.UI.DomElement.removeCssClass(this.fi.Lyb.parentNode,this.fi.p2f);else if(Q===n.a.gcd)this.fi.xg.Ps().Hdc();else if(Q===n.a.fcd)this.fi.xg.Ps().Fdc();else return 2;return 32}}dg.Zdf=
"FullPage";dg.zId="PageWidth";Object(e.a)(dg,"ZoomManager",null,[846]);var Un;(function(Q){Q[Q.manual=0]="manual";Q[Q.fitToFullPage=1]="fitToFullPage";Q[Q.fitWidth=2]="fitWidth";Q[Q.onBoot=3]="onBoot"})(Un||(Un={}));Object(e.b)("ZoomStatus",Un);c(1059);var Oi;(function(Q){Q[Q.normal=0]="normal";Q[Q.quiet=1]="quiet";Q[Q.disableScrollUpdate=2]="disableScrollUpdate";Q[Q.disableUiControlUpdate=4]="disableUiControlUpdate"})(Oi||(Oi={}));Object(e.b)("ZoomUpdateFlags",Oi);var Ws=c(240),Cr=c(326),gp=c(1195);
class Tt extends dg{constructor(Q,za,fb,Nb,tc,bd,Yd){super(Q,za);this.e2o=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.f2o=[dg.zId,"200","150","125","100","75","50"];this.jWe=this.Vcj=!1;this.RLg="AutoFitForAdaptiveLayout";this.g2j="FitPageWidthFailure";this.Gmk="UpdateZoomFailure";this.dok="wwf";this.zXe=null;this.s7i=()=>{this.yma===Un.fitWidth&&this.tkf()};this.Gel=Fd=>{if(Fd.ctrlKey){m.AFrameworkApplication.va.processAction(ph.a.zNh,2);Fd=Fd.i1o;if(!Fd)return!1;this.yja(this.ij-
(0<Fd?.1:-.1));this.XXc(6,"CtrlScroll");return!0}return!1};this.bun=()=>{ra.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};this.AW=fb;this.rk=Nb;this.Ub=tc;this.hg=bd;this.otc=Yd;this.E2g=Q.$("KeepViewAfterZoomIsEnabled");this.eok=Q.$("ZoomShortCutIsEnabled");this.Umk=Q.$("DoNotAutoScrollAfterPinchIsEnabled");this.S6j=(this.pEe=Q.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&Q.$("AutoFitForSmallScreenModeIsEnabled");this.o0j=Q.$("DoNotProcessUpdateZoomActionIsEnabled");
this.fok=Q.$("ZoomSliderIsEnabled");this.wz()}get appName(){return"WordEditor"}get xYc(){return 4}get TYc(){return.1}get Hel(){return wacBoot.CtrlWheelMetrics}Bxk(Q){this.kd.addHandler("PinchStart",Q)}F_n(Q){this.kd.removeHandler("PinchStart",Q)}Axk(Q){this.kd.addHandler("PinchEnd",Q)}E_n(Q){this.kd.removeHandler("PinchEnd",Q)}get JJ(){return null!=this.wGg?this.wGg:this.wGg=ua.a.instance.Na("WordEditor.IStatusBarUser")}ZGj(Q){Q=!(Q&Oi.disableUiControlUpdate);const za=Gb.a.get_instance().isCompleted(7);
return Q&&za?(Q={SelectZoomOption:"ComboBoxModel"},Za.App.ya&&Za.App.ya.VG(Q),this.EXo(),!0):!1}yja(Q,za=Oi.normal){let fb=!0;this.o0j||m.AFrameworkApplication.va.processAction(Ag.a.yja,2);if(this.ij===Q)return this.jWe||(this.jWe=this.ZGj(za)),fb;Q>this.xYc?Q=this.xYc:Q<this.TYc&&(Q=this.TYc);var Nb=!!(za&Oi.quiet);1===Q||Nb||m.AFrameworkApplication.va.processAction(Ag.a.Kpg,2);try{Nb=null;Za.App.ya&&Object(Eh.a)(gp.PageView,Za.App.ya.gb.wc)&&(Nb=Za.App.ya.gb.wc);let tc=-1,bd=-1,Yd=-1;const Fd=!(za&
Oi.disableScrollUpdate);this.E2g&&Fd&&(tc=ze.SelectionEditor.Rgm(Of.a.instance.hb.kb,Nb),bd=Nb.mL.scrollLeft,Yd=Nb.mL.scrollTop);const De=this.ij;this.jnj(Q);this.QMn();this.jWe=this.ZGj(za);Fd&&this.gWo(Nb,tc,bd,Yd,De)}catch(tc){fb=!1,ra.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",tc)}return fb}gWo(Q,za,fb,Nb,tc){Q&&Q.isActive?this.E2g?0<=za&&100>=za?Q.Ls.W4(100-za,!0,!0):Q.Ls.HUm(fb,Nb,tc,this.ij):Q.Ls.W4():ra.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}F5o(Q,
za,fb){2===fb&&(this.XXc(this.pc?this.pc.zD:0,"ZoomTo100"),this.yma=Un.manual,this.yja(1));return 32}Jjj(Q){this.yma=Un.manual;let za,fb=!0;if(this.Umk){if(!Object(Eh.a)(qt,Q))return ra.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;za=Q.zoom/100;fb=Q.wAk}else za=Number.parseInvariant(String.format("{0}",Q))/100;ra.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",za);Q=Oi.normal;fb||(Q=Oi.disableScrollUpdate);this.yja(za,Q);return 32}zoomToPageWidth(Q,
za,fb){if(1===fb)return 32;ra.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(id.a)("ZoomToPageWidth",!0);this.yma=Un.fitWidth;this.Cul();return this.tkf()}oqn(Q,za,fb,Nb,tc){if(1===fb)return 32;Q=Ra.a.$Da(this.AIc,6,m.AFrameworkApplication.numberFormat);tc[Ws.a.labelText]=Q;return 32}eji(){return this.e2o}fji(){return this.f2o}Cul(){this.Vcj||(Za.App.ya?(Za.App.ya.VZ(this.s7i),this.Vcj=!0):ra.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}tkf(){var Q=
Za.App.ya?Za.App.ya.gb.wc:null;if(Q&&Za.App.ya.jD){var za=null;(Q=this.CRl(Q))&&(za=this.AW.wJ(Q));za||(za=this.AW.Qpf());if(null!==za)return za=nm.a.instance.Vt(za),za=Th.a.Ni(za,0),Q=this.otc(),za+=Q&&Q.zhe()?wacBoot.ShiftUtils.getFloatingObjectsContainerWidth():0,za+=2*Cr.a.ipg,this.yja(Za.App.ya.jD.offsetWidth/za),32;ra.ULS.sendTraceTag(7185433,353,10,"Zoom to page width: cannot find word section node.")}else ra.ULS.sendTraceTag(7185434,353,10,"Zoom to page width: cannot find editing view node.");
return 8}CRl(Q){return Q&&Q.mb&&Q.mb.hb.kb&&Q.mb.hb.kb.Qa&&Q.mb.hb.kb.Qa.node?Q.mb.hb.kb.Qa.node:null}EXo(){this.JJ&&(this.fok?(this.JJ.KU(Po.a.A5o),this.JJ.KU(Po.a.C5o)):this.JJ.KU(Po.a.D5o))}XAo(Q){Q||(Q=window.self.CtrlWheelMetrics);if(Q){var za=Q.ctrlWheelOccurred;if("boolean"!==typeof za)ra.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");else{ra.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",za);try{Q.stop()}catch(fb){ra.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",
fb)}}}else ra.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}wz(){this.XAo(this.Hel);if(this.rk){var Q=document.getElementById(Xl.AppFrame.dJd);Q&&this.rk.lb(X.a.klb,Q,this.Gel)}this.Ub&&(Q=this.Ub.ge(Xl.AppFrame.$E),this.eok&&(Q.bindAction(Df.KeyInputManager.kc(Rj.a.Bmc,Df.KeyInputManager.Rh),n.a.Kib),Q.bindAction(Df.KeyInputManager.kc(Rj.a.ubd,Df.KeyInputManager.Rh),n.a.Kib),Q.bindAction(Df.KeyInputManager.kc(Rj.a.Cmc,Df.KeyInputManager.Rh),n.a.tfb),Q.bindAction(Df.KeyInputManager.kc(Rj.a.Emc,
Df.KeyInputManager.Rh),n.a.tfb),Q.bindAction(Df.KeyInputManager.kc(Rj.a.ddd,Df.KeyInputManager.Rh),Ag.a.ppe)));this.hg&&(this.zXe=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.hg.lb(X.a.click,this.zXe,this.bun);this.S6j&&(Za.App.ya.DI.registerLayoutBreakpointChanged("canvas",za=>{this.t2e(za)}),Za.App.ya.DI.registerBoundingWindowRectsChanged("canvas",()=>{this.t2e(Za.App.ya.DI.getLayoutBreakpoint())}))}t2e(Q){let za=!0,fb="";if(this.yma!==Un.onBoot)return za;La.Health.instance.recordKpiUsage(this.RLg,
0,this.dok,null);switch(Q){case "Small":8===this.tkf()&&(fb=this.g2j,za=!1);break;default:1===this.ij||this.yja(1)||(fb=this.Gmk,za=!1)}za||La.Health.instance.recordKpiFailure(this.RLg,fb,!0,!0,null);return za}o8i(Q){this.Bxk(Q)}i$i(Q){this.F_n(Q)}n8i(Q){this.Axk(Q)}h$i(Q){this.E_n(Q)}m5i(){this.kd.raiseEvent("PinchStart",null)}B2f(){this.kd.raiseEvent("PinchEnd",null)}}Object(e.a)(Tt,"WordEditorZoomManager",dg,[1652,846]);class $l{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(m.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const Q=
this.W.resolve("WordEditor.Zoom.WordEditorZoomActor"),za=this.W.resolve("WordEditor.Zoom.WordEditorZoomManager");Q.Tb();Sys.UI.DomElement.overrideGetBounds=!0;m.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&m.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&za&&Gb.a.get_instance().Dk(4,()=>{za.t2e(Za.App.ya.DI.getLayoutBreakpoint())||ra.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}xc(Q){this.W=Q;m.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&
(this.W.ha("WordEditor.Zoom.WordEditorZoomManager",()=>new Tt(m.AFrameworkApplication.K,m.AFrameworkApplication.va,Yi.WordSectionNavigator.instance,Jp.a.instance,ei.FocusManager.instance(),zo.a.instance,()=>Q.Na("Box4.IFloatingObjectUpdater"))).singleInstance().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),this.W.ha("WordEditor.Zoom.WordEditorZoomActor",()=>new Xm(m.AFrameworkApplication.va,this.W.resolve("WordEditor.Zoom.WordEditorZoomManager"),m.AFrameworkApplication.K)).singleInstance())}static main(){K.a.instance.Fc(new $l)}}
Object(e.a)($l,"ZoomPackage",null,[1,2]);var qq=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",
ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",
Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},
children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",
attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",
attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",
LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",
QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",
MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",
attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},
children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},
children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]};class wu extends ik.a{constructor(Q){var za;super("DocumentOwnerConditionId");this.Hn=Q.Hn;this.Fcg=null!==(za=Q.Fcg)&&void 0!==za?za:!0}initialize(){super.initialize();const Q=m.AFrameworkApplication.K;Q.No(()=>{const za=Q.$("IsDocumentOwner");this.Rg(za===this.Fcg)})}Rg(Q){super.Rg(Q);ra.ULS.sendTraceTag(508958623,3028,50,this.tT(this.Hn,Q))}}Object(e.a)(wu,"DocumentOwnerCondition",ik.a,
[]);var hs=c(1720);class Ho extends ti.a{constructor(Q){const za=new uj({Hn:23,k0a:"Microsoft.Office.WordOnline.CopilotSummarySkittle"}),fb=new uj({Hn:23,k0a:"Microsoft.Office.WordOnline.CopilotPaneEnabled"}),Nb=new wu({Hn:23,Fcg:!1});Q=new hs.a({Hn:23},Q);super(23,new ib.a([za,fb,Nb,Q]),null,3028,"CopilotSummarySkittleInitTriggered")}}Object(e.a)(Ho,"CopilotSummarySkittleInitTriggerModel",ti.a,[]);var hl={get interop(){var Q=null===copilotSummarySkittleUx||void 0===copilotSummarySkittleUx?void 0:
copilotSummarySkittleUx.interop;if(!Q)throw Error("copilotSummarySkittleUx chunk is accessed before loading");return Q}};class Vn{constructor(Q,za){this.RFd=Q;this.N5c=za;this.zGa=async(fb,Nb)=>{if(Nb.JY){Object(id.a)("CopilotSummarySkittleInitializationTriggered");this.RFd.Kca(this.zGa);this.RFd.Md();try{const [,tc]=await Promise.all([this.KZm(),Promise.all([c.e(2),c.e(26)]).then(c.bind(null,2038))]);tc.main(hl.interop)}catch(tc){ra.ULS.sendTraceTag(508944738,3047,10,"Failed to load CopilotSummarySkittleUxChunk/CopilotSummarySkittlePackage")}}}}initialize(){this.RFd.a3(this.zGa);
this.RFd.initialize()}async KZm(){return m.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("copilotSummarySkittleUx"):(await Object(fg.c)(this.N5c)).Kz.loadScript("copilotSummarySkittleUx")}}Object(e.a)(Vn,"CopilotSummarySkittleInitializer",null,[]);class Xs extends Um.a{get name(){return"WordEditor.Copilot.SummarySkittle.Entry"}Qfa(Q){this.container=Q}Sfa(){(new Vn(new Ho(this.container.resolve("WordEditor.WordCount.IWordCountManagerFactory")),this.container.Sa("Common.IDynamicScriptLoaderProvider"))).initialize()}Rfa(){}static main(){m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSummarySkittle",
!1)&&K.a.instance.Fc(new Xs)}}Object(e.a)(Xs,"CopilotSummarySkittleEntryPackage",Um.a,[]);Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");
Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");Type.registerNamespace("Common.App.VersionHistory");
Type.registerNamespace("WordEditor.VersionHistory");K.a.instance.Fc(new Xu);Yj.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");R;Type.registerNamespace("CACPU");ya.main();Type.registerNamespace("CAEventTimingMeter");eb.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");gc.main();Type.registerNamespace("Common.App.GestureInput");Pa.main();Type.registerNamespace("Common.App.GestureManager");Xa.main();Type.registerNamespace("Common.ModernFontPicker");
null==m.AFrameworkApplication.K||m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableOfflineLogger",!1)||(Type.registerNamespace("Common.App.OfflineLogger"),K.a.instance.Fc(new pc));Type.registerNamespace("Common.App.O365Shell");Ib.main();Type.registerNamespace("Common.App.PhoneLink");$d.main();Type.registerNamespace("Common.App.SensitiveLogging");im.main();Type.registerNamespace("Common.App.Rename");K.a.instance.Fc(new fi,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");
K.a.instance.Fc(new Lg);Type.registerNamespace("Common.App.SaveAsToHost");Hk.main();Type.registerNamespace("Common.App.SaveToCloudStorage");hd.main();Type.registerNamespace("Common.App.SaveACopy");Il.main();Type.registerNamespace("Common.App.SaveToSharePoint");Vf.main();Type.registerNamespace("Common.App.SharedFilePicker");$g.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");
Type.registerNamespace("CATypingSpeedMeter");Bd.main();No;K.a.instance.Fc(new Vq);mf.main();qq;qo.main();K.a.instance.Fc(new Gn);up.main();Xo.a.prototype.toString=op.a.prototype.toString;Gp.a.bki=new go.a;K.a.instance.Fc(new so);$l.main();K.a.instance.Fc(new Og);K.a.instance.Fc(new ir);K.a.instance.Fc(new Ej);wf.main();Ek.main();Jl.main();Tu.main();Type.registerNamespace("NLRT");K.a.instance.Fc(new yk);Type.registerNamespace("Common.App.AccessibilitySettings");N.main();K.a.instance.Fc(new xg);Zf.main();
un.main();xs.main();Ii.main();Xs.main();window.EventTiming={EventTimingMeter:ll,FrameTimingMeter:$f}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19580616/wdjs/WordEditorDS.box4.dll2.js.map