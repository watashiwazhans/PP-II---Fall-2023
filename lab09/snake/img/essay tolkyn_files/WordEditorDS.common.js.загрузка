/*
 Microsoft Corporation. All rights reserved.
*/
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1474:function(E,M,c){c.d(M,"a",function(){return n});E=c(0);var m=c(2),e=c(1939),a=c(48),l=c(7),y=c(1604),z=c(1562);class n{static OIa(v,A){v||(l.ULS.sendTraceTag(16795331,369,10,"The {0} root node should not be null.",A),n.$f())}static Imc(v,A){v&&v.count||(l.ULS.sendTraceTag(16795332,369,10,"The list of {0} objects should not be null or empty.",A),n.$f())}static w1(v,A){n.OIa(v,A);v.isConnected||(l.ULS.sendTraceTag(16795333,
369,15,"The accessed node is no longer connected to the graph in class: {0}.",A),n.Wk())}static Px(v,A){null===v&&(l.ULS.sendTraceTag(16847773,369,10,"The {0} value should not be null.",A),n.nd())}static Jmc(v,A){v&&""!==v||(l.ULS.sendTraceTag(17056035,369,10,"The {0} value should not be null or empty.",A),n.nd())}static nUa(v,A){if(null===v||0>=v)l.ULS.sendTraceTag(17040545,369,10,"{0} is with not supported value: {1}.",A,v),n.nd()}static mUa(v,A){if(null===v||0>v)l.ULS.sendTraceTag(20534342,369,
10,"Set {0} with not supported value: {1}.",A,v),n.nd()}static xP(v){if("number"===typeof v)return v;n.nd();return 0}static MIa(v,A,w){n.Jmc(v,A);var G=e.a.pua(v);G=""!==G?G:v;"#"!==G.charAt(0)&&(G="#"+G);let F=!1;if(7>G.length)F=!0;else for(let I=1;7>I;I++){const K=G.charAt(I);if(!("0"<=K&&"9">=K||"A"<=K&&"F">=K||"a"<=K&&"f">=K)){F=!0;break}}if(F)throw l.ULS.sendTraceTag(19240924,369,15,"AppId:{0}, Set {1} with not supported argument: {2}.",w.appId,A,v),OfficeExtension.WacRuntime.Utility.createRichApiException(z.a.invalidArgument,
WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);return n.xEn(G)}static xEn(v){return v.substring(5,7)+v.substring(3,5)+v.substring(1,3)}static FM(v,A,w=0,G=!0){l.ULS.sendTraceTag(17576160,369,50,"{0}",{["MethodName"]:v,["BlobSize"]:w,["Latency"]:A,["ExecutionStatus"]:G})}static fN(v){return(new Date).getTime()-v}static $f(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(z.a.generalException,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_GeneralException);}static nd(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(z.a.invalidArgument,
WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);}static nk(v=""){if("Getter"!==v)throw OfficeExtension.WacRuntime.Utility.createRichApiException(z.a.notImplemented,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotImplemented);}static Fpb(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(z.a.Jyb,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_AccessDenied);}static Wk(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(z.a.XTm,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_ItemNotFound);
}static Yig(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(z.a.notSupported,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotSupported);}static klc(v,A,w="",G=""){v="AppId:"+v+",";v=(""!==w?v+("Property"+w):v+"Method")+(":"+A+", currently is not allowed on Word Wac");""!==G&&(v+=" for Parameter:"+G);l.ULS.sendTraceTag(19415938,369,15,v);"Getter"!==w&&n.hD()}static hD(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(z.a.notAllowed,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotAllowed);
}static jHo(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(z.a.rvn,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_OperationCancelled);}static yi(){return m.AFrameworkApplication.K.$("WordEditorExtensionRichApi_1_3_Enabled")}static Xbd(){return m.AFrameworkApplication.K.$("WordEditorContentControlUserEditingIsEnabled")}static Soe(){return m.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")}static get tza(){return a.a.kZf}static tHc(v){v=(v||
"").replace(RegExp("\\r","g"),"\\r");v=v.replace(RegExp("\\n","g"),"\\n");return v=v.replace(RegExp("\\v","g"),"\\v")}static Zjc(v){return v.split(RegExp("\r\n|\r|\n"))}static q7i(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorFontEnabled",!1)}static E3f(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorHyperlinkEnabled",!1)}static wRn(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorRangeTextEnabled",
!1)}static iua(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",!1)}static d2o(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CustomXmlPartApiIsEnabled",!1)}static wDl(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixRangeFontColorBug",!1)}static ykf(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixInsertBookmarkBug",!1)}static ukf(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixBookmarkGetRangeBug",
!1)}static oDl(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixGetHtmlStyleBug",!1)}static RHh(){var v;m.AFrameworkApplication.ue("46ab6280;fg4g7862");return null===(v=m.AFrameworkApplication.K)||void 0===v?void 0:v.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContentControlEventApiEnabled",!1)}static xkf(){m.AFrameworkApplication.ue("241fi198;754i3702");return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixFtnEtnClearFormat",
!1)}static vMc(){m.AFrameworkApplication.ue("0cdc8638;0cdc8638");return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FtnEtnBodyEnabled",!1)}static iKj(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocumentInsertFileFromBase64ApiIsEnabled",!1)}static h2o(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecognizeCCWhenTrackchangesONOrOFF",!1)}static g2o(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InlineContentControlIsValidEnabled",
!1)}static nNh(){var v;m.AFrameworkApplication.ue("aa6dc483;d84c1847");return null===(v=m.AFrameworkApplication.K)||void 0===v?void 0:v.getBooleanFeatureGate("Microsoft.Office.WordOnline.CrossFtnEtnNodeEnabled",!1)}static j2o(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetrieveStylesApiIsEnabled",!1)}static kvj(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StyleAPIEnabled",!1)}static GKc(v){null!==v&&void 0!==v&&v.length&&
v.some(A=>-1===n.h$c(A))&&n.nd()}static Khf(v,A){null!=v&&(v=n.h$c(v),l.ULS.sendTraceTag(509616404,369,50,`${A}.insertContentControl(${y.a[v]})`),-1===v&&n.nd())}static h$c(v,A=-1){switch(v){case 96:return 1;case 31:return 0;default:return A}}}n.Kkb="\r";n.GUh=new Map([[7,"\u0002"],[6,"\x0B"],[8,"\f"],[12,"\t"]]);n.Gha=9;Object(E.a)(n,"Utility",null,[])},1485:function(E,M,c){c.d(M,"f",function(){return w});c.d(M,"e",function(){return G});c.d(M,"d",function(){return F});c.d(M,"g",function(){return I});
c.d(M,"h",function(){return K});c.d(M,"a",function(){return J});c.d(M,"j",function(){return N});c.d(M,"i",function(){return R});c.d(M,"c",function(){return O});c.d(M,"b",function(){return L});var m=c(56),e=c(7),a=c(1492);c.n(a);E=[{role:2,roleType:a.RoleType.Title},{role:3,roleType:a.RoleType.Subtitle},{role:4,roleType:a.RoleType.Heading1},{role:5,roleType:a.RoleType.Heading2},{role:6,roleType:a.RoleType.Heading3},{role:7,roleType:a.RoleType.Heading4},{role:8,roleType:a.RoleType.Heading5},{role:9,
roleType:a.RoleType.Heading6},{role:10,roleType:a.RoleType.Heading7},{role:11,roleType:a.RoleType.Heading8},{role:12,roleType:a.RoleType.Heading9},{role:15,roleType:a.RoleType.ListItem},{role:13,roleType:a.RoleType.BodyText},{role:14,roleType:a.RoleType.Caption}];M=[{role:1,PG:{default:"Unknown",tJ:null}},{role:2,PG:{default:"Title",tJ:Box4Intl.Box4Strings.L_StyleWordTitle}},{role:3,PG:{default:"Subtitle",tJ:Box4Intl.Box4Strings.L_StyleWordSubtitle}},{role:4,PG:{default:"Heading1",tJ:Box4Intl.Box4Strings.L_StyleWordHeading1}},
{role:5,PG:{default:"Heading2",tJ:Box4Intl.Box4Strings.L_StyleWordHeading2}},{role:6,PG:{default:"Heading3",tJ:Box4Intl.Box4Strings.L_StyleWordHeading3}},{role:7,PG:{default:"Heading4",tJ:Box4Intl.Box4Strings.L_StyleWordHeading4}},{role:8,PG:{default:"Heading5",tJ:Box4Intl.Box4Strings.L_StyleWordHeading5}},{role:9,PG:{default:"Heading6",tJ:Box4Intl.Box4Strings.L_StyleWordHeading6}},{role:10,PG:{default:"Heading7",tJ:Box4Intl.Box4Strings.L_StyleWordHeading17}},{role:11,PG:{default:"Heading8",tJ:Box4Intl.Box4Strings.L_StyleWordHeading8}},
{role:12,PG:{default:"Heading9",tJ:Box4Intl.Box4Strings.L_StyleWordHeading9}},{role:13,PG:{default:"BodyText",tJ:Box4Intl.Box4Strings.L_StyleWordNormal}},{role:14,PG:{default:"Caption",tJ:Box4Intl.Box4Strings.L_StyleWordCaption}},{role:15,PG:{default:"ListItem",tJ:null}},{role:16,PG:{default:"SubtleEmphasis",tJ:Box4Intl.Box4Strings.L_StyleWordSubtleEmphasis}},{role:17,PG:{default:"Emphasis",tJ:Box4Intl.Box4Strings.L_StyleWordEmphasis}},{role:18,PG:{default:"IntenseEmphasis",tJ:Box4Intl.Box4Strings.L_StyleWordIntenseEmphasis}},
{role:19,PG:{default:"Strong",tJ:Box4Intl.Box4Strings.L_StyleWordStrong}},{role:20,PG:{default:"Quote",tJ:Box4Intl.Box4Strings.L_StyleWordQuote}},{role:21,PG:{default:"IntenseQuote",tJ:Box4Intl.Box4Strings.L_StyleWordIntenseQuote}},{role:22,PG:{default:"SubtleReference",tJ:Box4Intl.Box4Strings.L_StyleWordSubtleReference}},{role:23,PG:{default:"IntenseReference",tJ:Box4Intl.Box4Strings.L_StyleWordIntenseReference}},{role:24,PG:{default:"BookTitle",tJ:Box4Intl.Box4Strings.L_StyleWordBookTitle}},{role:25,
PG:{default:"NoSpacing",tJ:Box4Intl.Box4Strings.L_StyleWordNoSpacing}}];const l=new Map(M.map(U=>[U.PG.default,U.role])),y=new Map(M.map(U=>[U.role,U.PG.default])),z=new Map(M.map(U=>[U.role,U.PG.tJ])),n=new Map(E.map(U=>[U.roleType,U.role])),v=new Map(E.map(U=>[U.role,U.roleType])),A=(U,W,X)=>U.has(W)?U.get(W):X,w=U=>A(l,U,1),G=U=>A(n,U,1),F=U=>A(v,U,a.RoleType.Unknown),I=U=>A(y,U,"Unknown"),K=U=>A(z,U,null),J=U=>{switch(U){case 4:return 0;case 5:return 1;case 6:return 2;case 7:return 3;case 8:return 4;
case 9:return 5;case 10:return 6;case 11:return 7;case 12:return 8;default:return 9}},N=U=>{switch(U){case 13:return"Normal";case 1:return"Unknown";case 4:return"Heading 1";case 5:return"Heading 2";case 2:return"Title";case 15:return"List Paragraph";case 3:return"Subtitle";case 14:return"Caption";case 6:return"Heading 3";case 7:return"Heading 4";case 8:return"Heading 5";case 9:return"Heading 6";case 10:return"Heading 7";case 11:return"Heading 8";case 12:return"Heading 9";case 16:return"Subtle Emphasis";
case 17:return"Emphasis";case 18:return"Intense Emphasis";case 19:return"Strong";case 20:return"Quote";case 21:return"Intense Quote";case 22:return"Subtle Reference";case 23:return"Intense Reference";case 24:return"Book Title";case 25:return"No Spacing";default:return"Unknown"}},R=U=>{switch(U){case 13:return m.StyleReader.wordStyleIdNormal;case 4:return m.StyleReader.wordStyleIdHeading1;case 5:return m.StyleReader.wordStyleIdHeading2;case 2:return m.StyleReader.p8a;case 15:return m.StyleReader.wordStyleIdListParagraph;
case 3:return m.StyleReader.anc;case 6:return m.StyleReader.wordStyleIdHeading3;case 7:return m.StyleReader.i8a;case 8:return m.StyleReader.j8a;case 9:return m.StyleReader.k8a;case 10:return m.StyleReader.xqb;case 11:return m.StyleReader.yqb;case 12:return m.StyleReader.l8a;case 16:return m.StyleReader.o8a;case 17:return m.StyleReader.wUa;case 18:return m.StyleReader.m8a;case 19:return m.StyleReader.ppg;case 20:return m.StyleReader.iRb;case 21:return m.StyleReader.n8a;case 22:return m.StyleReader.qpg;
case 23:return m.StyleReader.opg;case 24:return m.StyleReader.npg;case 25:return m.StyleReader.hRb;case 14:return m.StyleReader.yKj;default:return e.ULS.sendTraceTag(512274639,3016,50,"Style ID not supported for role "+I(U)),"Unknown"}},O=U=>{switch(U){case 18:case 21:case 23:return!0;default:return!1}},L=U=>4<=U&&12>=U},1486:function(E,M,c){c.d(M,"c",function(){return I});c.d(M,"b",function(){return K});c.d(M,"t",function(){return N});c.d(M,"r",function(){return L});c.d(M,"q",function(){return U});
c.d(M,"g",function(){return W});c.d(M,"d",function(){return X});c.d(M,"o",function(){return V});c.d(M,"n",function(){return Z});c.d(M,"a",function(){return da});c.d(M,"e",function(){return aa});c.d(M,"i",function(){return ea});c.d(M,"m",function(){return na});c.d(M,"s",function(){return pa});c.d(M,"j",function(){return ja});c.d(M,"k",function(){return ma});c.d(M,"h",function(){return Ia});c.d(M,"v",function(){return Ja});c.d(M,"u",function(){return Ka});c.d(M,"p",function(){return ia});c.d(M,"f",
function(){return ua});c.d(M,"l",function(){return ya});E=c(22);var m=c(58),e=c(112),a=c(131);M=c(391);var l=c(37),y=c(8),z=c(48),n=c(417),v=c(6),A=c(7),w=c(1495),G=c(1593);const F=()=>document.getElementById(a.AppFrame.rUa),I=new M.a,K=`.ParaWrappingDiv .${l.a.pJd}`,J=E.a.instance.Ue("Box4.CommentParagraphMapping"),N=[Box4Intl.Box4Strings.l_HK_Bold,Box4Intl.Box4Strings.l_HK_Bold_Mac,Box4Intl.Box4Strings.l_HK_Italic,Box4Intl.Box4Strings.l_HK_Italic_Mac,Box4Intl.Box4Strings.l_HK_Underline,Box4Intl.Box4Strings.l_HK_Underline_Mac];
let R=void 0;const O=()=>{if(void 0===R){let ra;try{ra=CSS.supports("selector(:not(* *))")}catch(La){ra=!1}ra||A.ULS.sendTraceTag(526263553,324,15,"Cannot use complex CSS selector in CommentHelpers, falling back to less performant alternative");R=ra}return R},L=ra=>!!ra&&!!ra.Df,U=(ra,La,oa,Ca)=>{if(!ra||!ra.objectId)return!1;const Aa=oa.Db(m.a.If(ra.objectId)),db=w.a.v8b(Aa,!0),eb=w.a.v8b(Aa,!1);if(!db||!eb||db===eb&&db!==La||!y.ParagraphReader.RUc(La,db,eb))return!1;ra=!0;var ib=!1;db===La&&(ib=
w.a.mba(Aa,oa,!0),ra=ra&&!!ib&&ib.Ib.cp<=Ca,ib=!!ib&&ib.Ib.cp===Ca);La===eb&&(La=w.a.mba(Aa,oa,!1),ra=ra&&!!La&&La.Ib.cp>Ca,ib=ib&&!!La&&La.Ib.cp===Ca);return ra||ib},W=ra=>{if(!ra)return null;ra=e.a.Db(ra,l.a.KGc);return null!==ra&&void 0!==ra?ra:[]},X=ra=>ra?e.a.Db(ra,l.a.yEd):null,V=(ra,La)=>{if(!ra)return-1;for(let oa=0;oa<ra.length;oa++)if(ra[oa].sfc.equals(La))return oa;return-1},Z=(ra,La)=>{if(!ra)return-1;for(let oa=0;oa<ra.length;oa++)if(ra[oa].ksi.equals(La))return oa;return-1},da=ra=>`Comment Object Id: ${ra.objectId}`,
aa=(ra=!1)=>ua(F(),ra),ea=()=>z.a.Pj?Array.from(F().querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart")):ha()?Array.from(F().querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart")):[],na=(ra,La=!1)=>{if(ra.yj){for(const oa of ra.Pg.Ri)if(ya(oa,La))return!0;return!1}return ya(ra.htmlElement,La)},pa=
ra=>!!ra&&!!ra.ia(v.a.gM,null),ja=()=>{const ra=new Set,La=ea();for(let oa=0;oa<La.length;oa++)W(La[oa]).forEach(Ca=>{ra.add(Ca.toString())});return ra},ma=(ra,La)=>La?Ma(ra,!0,La):sa(ra,!0),Ia=(ra,La)=>La?Ma(ra,!1,La):sa(ra,!1),Ja=(ra,La)=>{xa(ra,La,!0);n.a.isEnabled&&!ra.pjb&&A.ULS.sendTraceTag(512372928,327,50,`Adding to CommentParagraphMapping CommentId: ${ra.id} StartParaId: ${La}`)},Ka=(ra,La)=>{xa(ra,La,!1);n.a.isEnabled&&!ra.pjb&&A.ULS.sendTraceTag(512372899,327,50,`Adding to CommentParagraphMapping CommentId: ${ra.id} EndParaId: ${La}`)},
Ma=(ra,La,oa)=>{var Ca,Aa;const db=ra.id.toString();return La?n.a.isEnabled?null!==(Ca=J.value.SZa.get(db))&&void 0!==Ca?Ca:oa:ra.ia(v.a.rTa,oa):n.a.isEnabled?null!==(Aa=J.value.RZa.get(db))&&void 0!==Aa?Aa:oa:ra.ia(v.a.dva,oa)},sa=(ra,La)=>{const oa=ra.id.toString();return La?n.a.isEnabled?J.value.SZa.get(oa):ra.getValue(v.a.rTa):n.a.isEnabled?J.value.RZa.get(oa):ra.getValue(v.a.dva)},xa=(ra,La,oa)=>{const Ca=ra.id.toString();n.a.isEnabled?ra.pjb||(oa?J.value.SZa:J.value.RZa).set(Ca,La):ra.setValue(oa?
v.a.rTa:v.a.dva,La)},ia=ra=>n.a.isEnabled?J.value.SZa.has(ra.objectId)&&J.value.RZa.has(ra.objectId):!0,ha=()=>0===G.a.Ej||2===G.a.Ej,ua=(ra,La)=>{if(La&&(ha()||z.a.Pj)){if(O())return Array.from(ra.querySelectorAll(z.a.Pj?".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)":".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)"));
La=z.a.Pj?ra.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart"):ra.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart");const oa=La.length;if(0<oa){ra=ra.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart");const Ca=[];let Aa=0;for(let db=0,eb=ra.length;db<eb;db++){const ib=
ra[db];Aa<oa&&La[Aa]===ib?++Aa:Ca.push(ib)}return Ca}}return Array.from(ra.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart"))},ya=(ra,La)=>{if(La&&(ha()||z.a.Pj)){if(O())return!!ra.querySelector(z.a.Pj?".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)":".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)");
La=z.a.Pj?ra.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart").length:ra.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart").length;if(0<La)return La!==ra.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart").length}return!!ra.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart")}},
1489:function(E,M,c){c.d(M,"a",function(){return l});E=c(0);var m=c(2),e=c(1790),a=c(19);class l{static B8h(){return l.tyk+"_"+e.a.bRc+"_"+a.a.SW(m.AFrameworkApplication.userName)+"_"}static Y2h(y){return y+"_"+e.a.bRc+"_"+a.a.SW(m.AFrameworkApplication.userName)+"_"}static Wdi(){return l.HFn+"_"+e.a.bRc+"_"+a.a.SW(m.AFrameworkApplication.userName)+"_"}}l.Ila="ack0";l.Jla="ack1";l.Izd="ack2";l.tyk="ack3";l.FDc="ack4";l.yqh="ack7";l.uIf="ack8";l.rqj="ack9";l.u2e="ack10";l.qqj="ack13";l.uEi="ack14";
l.Kzd="AddinDetailsRefreshed";l.ryk="DdaMethod";l.qyk="ControlId";l.Lzd="OsfcontrolId";l.z_e="SecurityOrigin";l.v0b="ak0";l.xyk="ak1";l.Bqh="ak2";l.GDc="ak4";l.xqh="Office.AutoShowTaskpaneWithDocument";l.zqh="value";l.wyk="errorCode";l.Fql="SourceControlId";l.Dql="OsfControl";l.Eql="RibbonUpdaterData";l.nle="AddinShared";l.HFn="__OSF_PRIVATECATALOG_ADDINIDS";Object(E.a)(l,"AddinConstantsString",null,[])},1491:function(E,M,c){var m=this&&this.lE||(Object.create?function(a,l,y,z){void 0===z&&(z=y);
var n=Object.getOwnPropertyDescriptor(l,y);if(!n||("get"in n?!l.bC:n.writable||n.configurable))n={enumerable:!0,get:function(){return l[y]}};Object.defineProperty(a,z,n)}:function(a,l,y,z){void 0===z&&(z=y);a[z]=l[y]}),e=this&&this.__exportStar||function(a,l){for(var y in a)"default"===y||Object.prototype.hasOwnProperty.call(l,y)||m(l,a,y)};Object.defineProperty(M,"__esModule",{value:!0});e(c(1808),M);e(c(1809),M);E.exports.ErrorCode||Object.defineProperty(E.exports,"ErrorCode",{enumerable:!0,get:function(){return E.exports.ErrorCode}});
E.exports.FormattingSuggestionType||Object.defineProperty(E.exports,"FormattingSuggestionType",{enumerable:!0,get:function(){return E.exports.FormattingSuggestionType}});E.exports.FormattingSuggestionsAnnotation||Object.defineProperty(E.exports,"FormattingSuggestionsAnnotation",{enumerable:!0,get:function(){return E.exports.FormattingSuggestionsAnnotation}});E.exports.FormattingSuggestionsRange||Object.defineProperty(E.exports,"FormattingSuggestionsRange",{enumerable:!0,get:function(){return E.exports.FormattingSuggestionsRange}});
E.exports.FormattingSuggestionsSummaryAnnotation||Object.defineProperty(E.exports,"FormattingSuggestionsSummaryAnnotation",{enumerable:!0,get:function(){return E.exports.FormattingSuggestionsSummaryAnnotation}})},1492:function(E,M,c){var m=this&&this.lE||(Object.create?function(a,l,y,z){void 0===z&&(z=y);var n=Object.getOwnPropertyDescriptor(l,y);if(!n||("get"in n?!l.bC:n.writable||n.configurable))n={enumerable:!0,get:function(){return l[y]}};Object.defineProperty(a,z,n)}:function(a,l,y,z){void 0===
z&&(z=y);a[z]=l[y]}),e=this&&this.__exportStar||function(a,l){for(var y in a)"default"===y||Object.prototype.hasOwnProperty.call(l,y)||m(l,a,y)};Object.defineProperty(M,"__esModule",{value:!0});e(c(1792),M);e(c(1793),M);E.exports.DocumentRoleDetectionAnnotation||Object.defineProperty(E.exports,"DocumentRoleDetectionAnnotation",{enumerable:!0,get:function(){return E.exports.DocumentRoleDetectionAnnotation}});E.exports.RoleDetectionAnnotation||Object.defineProperty(E.exports,"RoleDetectionAnnotation",
{enumerable:!0,get:function(){return E.exports.RoleDetectionAnnotation}});E.exports.RoleDetectionCustomMetadata||Object.defineProperty(E.exports,"RoleDetectionCustomMetadata",{enumerable:!0,get:function(){return E.exports.RoleDetectionCustomMetadata}});E.exports.RoleDetectionSettings||Object.defineProperty(E.exports,"RoleDetectionSettings",{enumerable:!0,get:function(){return E.exports.RoleDetectionSettings}});E.exports.RoleType||Object.defineProperty(E.exports,"RoleType",{enumerable:!0,get:function(){return E.exports.RoleType}})},
1495:function(E,M,c){E=c(0);var m=c(22),e=c(80),a=c(58),l=c(2),y=c(719),z=c(136),n=c(238),v=c(602),A=c(9),w=c(5),G=c(249),F=c(8),I=c(417),K=c(361),J=c(1163),N=c(76),R=c(61),O=c(1752),L=c(1795),U=c(1796),W=c(15),X=c(6),V=c(588),Z=c(7),da=c(110),aa=c(244),ea=c(77),na=c(1655);class pa extends Sys.EventArgs{constructor(xa,ia){super();this.graphNode=xa;this.L_k=ia}}Object(E.a)(pa,"OnCopyCommentEventArgs",Sys.EventArgs,[]);class ja extends Sys.EventArgs{constructor(xa,ia){super();this.graphNode=xa;this.JYk=
ia}}Object(E.a)(ja,"OnPasteCommentEventArgs",Sys.EventArgs,[]);var ma=c(1195),Ia=c(1486),Ja=c(1556);class Ka extends Sys.EventArgs{constructor(xa){super();this.commentNode=xa}}Object(E.a)(Ka,"OnDeleteEventArgs",Sys.EventArgs,[]);class Ma extends Sys.EventArgs{constructor(xa){super();this.commentNode=xa}}Object(E.a)(Ma,"OnPasteEventArgs",Sys.EventArgs,[]);c.d(M,"a",function(){return sa});class sa{static get characterPropertiesEditor(){return null!=sa.qwg?sa.qwg:sa.qwg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get kd(){return null!=
sa.Yxg?sa.Yxg:sa.Yxg=new e.a}static get VCa(){return Ja.a.instance}static get uj(){return A.App.ya.gb.Uc.od}static get Xb(){return null!=sa.Yyg?sa.Yyg:sa.Yyg=m.a.instance.Na("Box4.IFeatureHelper")}static isComment(xa){return 40===xa.We}static KXd(xa){return 40===xa.type}static RBf(xa){return!!xa&&39===xa.We}static gTf(xa,ia){ia.property===W.a.ff&&(sa.MGb=!1)}static kTf(xa,ia){ia&&!xa.Nc&&sa.GPh(xa)}static GPh(xa){const ia=xa.Ib.paragraph.Kc;xa=ia.Db(xa.Wj);sa.FKc();xa&&xa.anchor&&sa.deleteComment(xa,
ia)}static waf(xa){const ia=new w.GraphIterator;ia.set(xa.Bi());sa.VCa.j4a(ia);return ia}static deleteComment(xa,ia){xa?(sa.FKc(),sa.bId(xa,ia),xa.anchor&&(sa.kd.raiseEvent(sa.k_c,new Ka(xa)),ia=xa.ia(X.a.ZE,0),Z.ULS.sendTraceTag(592188697,327,15,`Comment deleted by canvas anchor removal. ${xa.id}`),sa.aPg.add(ia.toString()),ia=new w.GraphIterator,ia.set(xa),ia.zb(39),ia.wg())):Z.ULS.sendTraceTag(512275402,327,50,"Comment Node is Undefined")}static aHm(xa){return sa.aPg.contains(xa)}static bId(xa,
ia){sa.FKc();const ha=sa.mba(xa,ia,!0);ia=sa.mba(xa,ia,!1);sa.snb(ha);sa.snb(ia);ha&&ia&&ha.Ib===ia.Ib&&Z.ULS.sendTraceTag(50619292,327,10,`comment ${xa.id} start and end range objects belonged to same chp`)}static snb(xa){if(xa&&xa.Ib.tf){xa.Ib.tf.remove(xa);const ia=xa.Ib.paragraph;0<=xa.re&&xa.re<ia.ze.length&&(xa.Ib.cp||1!==ia.ze.length||(ia.ze.PX(0,4),ia.ze.iq.Z(1,G.CharacterPropertiesEditor.HM),ia.ze.Vs.Z(1,G.CharacterPropertiesEditor.pR)),ia.ze.removeAt(xa.re,4));ia.Xl()}}static wjn(xa,ia){if(ia){var ha=
ia.paragraph;xa=ia.cpBegin;var ua=ia.cpEnd;if(ha&&F.ParagraphReader.Wb(ha)&&(ha=ha.pa)){ia.Ko[sa.KEd]||(ia.Ko[sa.KEd]=[]);ia=ia.Ko[sa.KEd];for(let ra=0;ra<ha.length;ra++){const La=ha.J(ra).tf;if(!La)continue;const oa=La.length;var ya=ha.J(ra).cp;if(ya<xa||ya>ua)for(ya=0;ya<oa;ya++)ia.push(La.J(ya))}}}}static Iin(xa,ia){if(ia&&(xa=ia.Ko[sa.KEd]))for(ia=0;ia<xa.length;ia++)sa.GPh(xa[ia])}static mba(xa,ia,ha){if(!xa)return null;const ua=ha?Ia.k(xa,a.a.nil):Ia.h(xa,a.a.nil);ia=ia.Db(ua);return ia?sa.xva(ia,
xa.id,ha):(ha||Z.ULS.sendTraceTag(4531344,327,15,`Comment anchor missing! Comment Id: ${xa.id} Anchor Id: ${ua} ${sa.$Gm(ua)}`),null)}static $Gm(xa){return I.a.isEnabled?`isDeletedParagraph: ${sa.gQh.has(xa.toString())}`:""}static xva(xa,ia,ha){for(let ua=0;ua<xa.pa.length;ua++){const ya=xa.pa.J(ua);if(ya.tf)for(let ra=0;ra<ya.tf.length;ra++)if(ya.tf.J(ra).Wj.equals(ia)&&ha===ya.tf.J(ra).Nc)return ya.tf.J(ra)}return null}static v8b(xa,ia){if(!xa)return null;ia=ia?Ia.k(xa,a.a.nil):Ia.h(xa,a.a.nil);
return xa.Kc.Db(ia)}static pNc(xa,ia,ha,ua=null){const ya=!ua;for(let ra=0;ra<xa.pa.length;ra++){const La=xa.pa.J(ra);if(La.cp>=ia&&La.tf)for(let oa=0;oa<La.tf.length;oa++){const Ca=La.tf.J(oa).Wj.toString();if(La.tf.J(oa).Nc===ha&&(ya||ua.contains(Ca)))return La.tf.J(oa)}}return null}static g_l(xa,ia,ha,ua){for(let ya=0;ya<xa.pa.length;ya++){const ra=xa.pa.J(ya);if(ra.cp>ia)break;if(ra.cp===ia&&ra.tf)for(let La=ra.tf.length-1;0<=La;La--){const oa=ra.tf.J(La).Wj.toString();if(ra.tf.J(La).Nc===ha&&
ua.contains(oa))return ra.tf.J(La)}}return null}static P_b(xa,ia,ha,ua){let ya=null;for(let ra=0;ra<xa.pa.length;ra++){let La=xa.pa.J(ra);if(La.cp>=ha){La.cp>ha||!La.formatting?(ya=sa.characterPropertiesEditor.LY(xa,ra,ha,ya),La=xa.pa.J(ra)):ya=La.formatting;La.tf||(La.tf=new K.a(La));sa.Kyd(ia,La.tf,ya.Fj,ua);break}La.formatting&&(ya=La.formatting)}}static Kyd(xa,ia,ha,ua){ha=ia.Ib.paragraph;const ya=new J.a(ia.Ib,null,xa,ua);for(let ra=0;ra<ia.length;ra++)if(ia.J(ra).Wj===xa&&ia.J(ra).Nc===ua){Z.ULS.sendTraceTag(589616028,
327,10,"CommentRangeObject {0} already exists with isStart value {1} in commentRangeObjects",xa,ua);break}ia.add(ya);ha.Xl();ya.re?ha.ze.PX(ya.re-1,4):ha.ze.Zna(ya.re,4);ha.ze.iq.Z(ya.re,G.CharacterPropertiesEditor.HM);ha.ze.Vs.Z(ya.re,G.CharacterPropertiesEditor.pR);return ya}static FKc(){if(!sa.MGb){var xa=new w.GraphIterator;xa.set(A.App.ya.gb.Uc);sa.VCa.j4a(xa);if(xa.Rb(1))for(;xa.vf(1););sa.MGb=!0}}static mBl(xa){const ia=new w.GraphIterator;ia.set(A.App.ya.gb.Uc);sa.VCa.j4a(ia);if(39!==ia.We)return!1;
let ha;if(ha=ia.Rb(1)){if(ha.id.equals(xa))return!0;for(;ha=ia.vf(1);)if(ha.id.equals(xa))return!0}return!1}static vKb(xa,ia){sa.M3c(ia)}static LPj(xa,ia){I.a.isEnabled&&(xa=ia.node)&&(ia=F.ParagraphReader.LQ(xa),sa.Yee(ia)&&sa.gQh.add(xa.id.toString()))}static Yee(xa){return 0<xa?document.querySelector("div.PageContentContainer p[paraid='"+xa+"']"):null}static M3c(xa){sa.O4f(F.ParagraphReader.EDb(xa));let ia=null;var ha=new w.GraphIterator;ha.set(xa);if(ha.Dp()&&(ha=N.a.mt(ha,ha.origin),ha.moveNext()))for(;ha.moveNext();)if(F.ParagraphReader.uh(ha.iterator)){ia=
ha.iterator.currentNode;break}if(ia){xa=F.ParagraphReader.EDb(xa);for(const ua of xa)ua.Nc&&(xa=ua.Ib.paragraph.Kc.Db(ua.Wj))&&(sa.snb(ua),sa.P_b(ia,xa.id,0,!0),Ia.v(xa,ia.id))}}static O4f(xa){for(const ia of xa)if(!ia.Nc){xa=ia.Ib.paragraph.Kc;const ha=xa.Db(ia.Wj);sa.deleteComment(ha,xa)}}static UQd(xa,ia){const ha=[];if(!xa)return Z.ULS.shipAssertTag(594908762,327,!1,"Trying to highlight null node."),ha;if(!xa.isConnected)return Z.ULS.shipAssertTag(51467871,327,!1,"Trying to highlight disconnected node."),
ha;const ua=sa.mba(xa,sa.uj,!0),ya=sa.mba(xa,sa.uj,!1);if(!ua||!ya)return Z.ULS.shipAssertTag(51467872,327,!1,`Missing comment anchor ${xa.id}`),ha;xa=!1;let ra=ua.Ib.paragraph;for(;ra&&(!ia||!ia(ra,ra===ua.Ib.paragraph));){ra===ua.Ib.paragraph&&(xa=!0);xa&&ha.push(ra);if(ra===ya.Ib.paragraph)break;ra=F.ParagraphReader.ig(ra,!1)}return ha}static hTf(xa,ia){ia.Ko.Comments||(ia.Ko.Comments={});sa.g6d(ia.operation,ia.iYi,ia.original,ia.clone,ia.Ko.Comments,!0)}static jTf(xa,ia){ia.Ko.Comments||(ia.Ko.Comments=
{});sa.g6d(ia.operation,ia.iYi,ia.original,ia.clone,ia.Ko.Comments,!1)}static skn(xa,ia){ia.Ko.Comments||(ia.Ko.Comments={});xa=ia.Ko.Comments;if((ia=Object.keys(xa))&&0<ia.length)for(let ha=0;ha<ia.length;ha++){const ua=xa[ia[ha].toString()];ua&&(ua.Wj=null,sa.snb(ua))}}static g6d(xa,ia,ha,ua,ya,ra){const La=ha.Kc;var oa=F.ParagraphReader.EDb(ua);oa.sort((Ya,Fa)=>Ya.Ib.cp<Fa.Ib.cp||Ya.Ib.cp===Fa.Ib.cp&&Ya.Nc?-1:Ya.Ib.cp===Fa.Ib.cp&&Ya.Nc===Fa.Nc?0:1);const Ca=new ea.a,Aa=new aa.a,db=sa.Xb.isFeatureEnabled(116);
for(const Ya of oa)if(Object(da.a)(ma.PageView,R.InteractiveViewManager.instance.Bd)){var eb=La.Db(Ya.Wj);if(eb&&eb.isConnected)if(Ya.Nc)ya[Ya.Wj.toString()]=Ya;else{var ib=eb.ia(X.a.ZE,0);oa=ra?sa.J1c(eb,ua,xa,ia):sa.O1c(eb,ua,xa,ia);if(ra)db&&(ib=w.GraphIterator.$a(ua),ib.zb(25)&&ib.hd(25)&&na.a.kd.raiseEvent(na.a.ISi,new pa(ib.currentNode,oa.getValue(X.a.ZE))));else{if(db){var lb=oa.ia(X.a.ZE,0);ib&&lb&&(Aa.nb(ib)?Aa.J(ib)!==lb&&Z.ULS.sendTraceTag(589616029,327,10,"Failed to add Key {0}, Value {1} to clonedDurableIdMapping, since Key {0}, Value {2} already exists. This could affect copy/paste of tasks.",
ib,lb,Aa.J(ib)):Aa.add(ib,lb))}oa.setValue(X.a.njb,!0);eb.ia(X.a.n8e,null)||(ib=eb.ia(X.a.yNa,null))&&oa.setValue(X.a.n8e,ib);oa.setValue(X.a.yNa,l.AFrameworkApplication.userSessionId)}ib=Ya.Wj.toString();lb=ya[ib];Ya.Wj=oa.id;if(!ra){Ya.Yu=null;eb=eb.getValue(X.a.wH);const Fa=oa.getValue(X.a.wH);ya[eb]=Fa;if(eb=oa.ia(X.a.gM,null))Ca.nb(eb)||Ca.add(eb,[]),Ca.J(eb).push(oa)}Ia.u(oa,ua.id);ua.id||Z.ULS.shipAssertTag(5564305,327,!1,"Comment node has no end anchor!");lb?(lb.Wj=oa.id,ra||(lb.Yu=null),
Ia.v(oa,lb.Ib.paragraph.id),delete ya[ib]):(sa.P_b(ua,oa.id,Ya.Ib.cp,!0),Ia.v(oa,ua.id))}else Z.ULS.sendTraceTag(592188835,327,10,String.format("Node is null or not connected, IsNodeChildOfCommentContent:{0}, IsNull:{1}",sa.mBl(Ya.Wj),!eb)),Ya.Wj=null,sa.snb(Ya)}else Ya.Wj=null,sa.snb(Ya);if(!ra){for(const Ya of Ca){xa=Ya.key;ia=Ya.value;for(const Fa of ia)Fa.setValue(X.a.gM,ya[xa])}0<Aa.count&&db&&(ha=w.GraphIterator.$a(ha),ha.zb(25)&&ha.hd(25)&&na.a.kd.raiseEvent(na.a.hVi,new ja(ha.currentNode,
Aa)))}ua.ak()}static yhf(xa,ia){if(xa.zb(25)&&xa.hd(25)&&!xa.Nr(16)){const ha=w.GraphIterator.$a(ia);ha.zb(39);ha.hd(39);ia=V.a(ha.currentNode,ia.Bi().Kc,!0);xa.Hf(ia,16)}}static n$e(xa,ia){var ha=ia.Bi().od;ha=V.a(xa,ha,!0);ia=w.GraphIterator.$a(ia);sa.yhf(ia,xa);ia.Rb(16);ia.X2(ha,1,xa.id);return ha}static J1c(xa,ia,ha,ua){sa.FKc();ia=sa.n$e(xa,ia);ia.pjb=!0;sa.gwl(xa,ia,ha,ua);return ia}static gwl(xa,ia,ha,ua){xa=new O.a(w.GraphIterator.$a(xa),w.GraphIterator.$a(ia),{});xa.vOb=!0;ha=new y.a(ha,
ua,new L.a(xa,null));ha.Ig=!0;ha.Al("ExecuteInternalCommentCopy");ha.run()}static O1c(xa,ia,ha,ua){sa.FKc();var ya=ia.Bi().od;ia=w.GraphIterator.$a(ia);ia.zb(7);ia.hd(7);ia.Rb(16);ya=V.a(xa,ya,!0);ya.Zg(X.a.wH,z.a.create().toString());ya.Zg(X.a.commentId,n.a.vF());let ra=!1;sa.BCi(ya.Lf(X.a.ZE))?ra=!0:ya.Zg(X.a.ZE,sa.opf());ia.Hf(ya,1);sa.hwl(xa,ya,ha,ua);ia.Gi(ya);ia.iF(1);ia.ghb(2);ia.Rb(2);ya.setValue(X.a.wH,ia.currentNode.Lf(X.a.Lc).toString());sa.kd.raiseEvent(sa.Epn,new Ma(ya));ra&&this.fOh.add(ya.id.toString());
return ya}static hwl(xa,ia,ha,ua){xa=new U.a(w.GraphIterator.$a(xa),w.GraphIterator.$a(ia),null,null);ha=new y.a(ha,ua,xa);ha.Ig=!0;ha.Al("ExecuteInternalCommentPaste");ha.run()}static opf(){const xa=n.a.Fgc(1,this.XLi);return sa.BCi(xa)?xa:sa.opf()}static BCi(xa){if(!xa)return!1;if(A.App.ya){const ia=new w.GraphIterator;ia.set(A.App.ya.gb.Uc);sa.VCa.j4a(ia);let ha=ia.Qd();for(;ha;){if(ha.Lf(X.a.ZE)===xa)return!1;ha=ia.Rj()}}return!0}static VZe(xa){sa.kd.addHandler(sa.k_c,xa)}}sa.Epn="OnPaste";sa.k_c=
"OnDelete";sa.KEd="CommentRangesToTrimOutsideSelection";sa.aPg=new v.a;sa.MGb=!1;sa.XLi=2147483646;sa.fOh=new Set;sa.gQh=new Set;Object(E.a)(sa,"CommentEditor",null,[])},1500:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m extends Sys.EventArgs{constructor(e){super();this.data=e}}Object(E.a)(m,"DesignerEventArgs",Sys.EventArgs,[])},1504:function(E,M,c){c.d(M,"a",function(){return z});E=c(0);var m=c(6),e=c(286),a=c(1172),l=c(1078),y=c(7);class z{constructor(n,v,A,w){this.$Wm=n;this.FBm=
v;this.EBm=A;this.p0i=w}Efc(n,v,A,w,G){n?(n=this.XHc(n,v,A),null!==n&&(w=this.D$e(w,n,G),this.EBm.setState(this.$Wm.value,w))):y.ULS.shipAssertTag(543499408,3016,!1,"No ParagraphNode")}XHc(n,v,A){return 0>A?(y.ULS.sendTraceTag(539018900,389,10,"Attempted to create a ParagraphRange descriptor with negative length"),null):e.a.fIc(n.ia(m.a.Lc,-1),n.ia(m.a.qj,-1),v,A,v,A,n)}D$e(n,v,A){return Object.assign(new l.a,{annotationType:n,contentDescriptor:v,state:A})}uBf(n,v,A,w,G){if(n){var F=n.ia(m.a.Lc,-1),
I=n.ia(m.a.qj,-1);-1===F||-1===I?G(null):(n=this.XHc(n,v,A),null===n?G(0):this.FBm.F_c(n,w,K=>{G(K)}))}else y.ULS.shipAssertTag(543499409,3016,!1,"No ParagraphNode")}zAn(n){if(n){var v=a.a.I8k(n);this.p0i.ooh({Aob:v,settingType:n})||y.ULS.shipAssertTag(521416710,3016,!1,"Persist Designer suppression setting failed")}}tQm(n){return new Promise(v=>{this.p0i.gdi(n,A=>{(null===A||void 0===A?0:A.Aob)?v(A.Aob):v(null)})})}}z.V0f="WordDesignerPullQuotesAnnotation";z.HOh="WordDesignerDefaultAnnotation";z.Mgg=
"WordDesignerSuggestedImageAnnotation";z.Qxj="WordDesignerThemeImageAnnotation";z.Agg="WordDesignerStylizedTitleAnnotation";z.P2b="WordDesignerComplexDecoratorAnnotationType";z.wQh="DesignerPaneSuppressionSetting";Object(E.a)(z,"PersistenceHelperImpl",null,[1086])},1505:function(E,M,c){function m(J){return 1===(null===J||void 0===J?void 0:J.Eq)||3===(null===J||void 0===J?void 0:J.Eq)}E=c(0);var e=c(39),a=c(44),l=c(31),y=c(7),z=c(1606),n;(function(J){J[J.initial=0]="initial";J[J.c0o=.1]="viewingOriginal";
J[J.cFk=.5]="applying";J[J.applied=1]="applied";J[J.accepted=2]="accepted";J[J.rejected=3]="rejected";J[J.ojp=4]="roleChanged";J[J.zfp=5]="invalidated"})(n||(n={}));Object(E.b)("ReviewIntentState",n);const v=J=>{switch(J){case n.c0o:return n.rejected;case n.cFk:return n.applied;default:return J}};var A=c(135);c.d(M,"d",function(){return G});c.d(M,"e",function(){return m});c.d(M,"b",function(){return F});c.d(M,"c",function(){return I});c.d(M,"a",function(){return K});class w{constructor(J,N,R=null,
O,L=!0){this.id=J;this.Eq=N;this.hE=R;this.fe=O;this.pGm=L;this.Ywi=!1;this.QDi=e.a.$e()}cmi(){return!1}PQa(J){this.hca(n[v(J)]);this.M2d(J)}M2d(J){1===J&&this.hE&&this.fe&&(this.pGm?(this.fe.NDm()&&this.hE.execute(N=>{N.logActivity(A.a.GSj,null)}),2===this.Eq&&this.fe.wRm()?this.hE.execute(N=>{N.logActivity(A.a.WSj,null)}):1===this.Eq&&this.fe.tNm()?this.hE.execute(N=>{N.logActivity(A.a.QSj,null)}):0===this.Eq&&this.fe.rJm()&&this.hE.execute(N=>{N.logActivity(A.a.KSj,null)})):4===this.Eq&&this.fe.kHm()&&
this.hE.execute(N=>{N.logActivity(A.a.ISj,null)}))}TXc(){6E4>e.a.$e()-this.QDi?this.hca("removed"):y.ULS.sendTraceTag(539109067,3016,50,"ID: {0}, Type: {1}, State: {2}",this.id,this.Eq,"removedButKept")}M1m(){this.Ywi||(this.hca("hovered"),this.Ywi=!0)}hca(J){this.QDi=e.a.$e();y.ULS.sendTraceTag(540357460,3016,50,"ID: {0}; Type: {1}, State: {2};",this.id,this.Eq,J);a.a(A.a.bkl,!0,void 0,[Object.assign(new l.a,{name:"suggestionType",int64:this.Eq}),Object.assign(new l.a,{name:"ID",string:this.id.toString()}),
Object.assign(new l.a,{name:"State",string:J})])}}Object(E.a)(w,"DesignerSuggestion",null,[]);class G extends w{constructor(J,N=1,R=null,O,L=!1,U=0,W=""){super(J,N,R,O,L);this.f5a=U;this.d2c=W}}Object(E.a)(G,"PullQuoteSuggestion",w,[]);class F extends w{constructor(J,N,R,O=null,L,U){super(J,2,O,L);this.VQ=N;this.baseUrl=R;this.B_d=U;this.selectedIndex=0;this.qkc=A.a.qwm}Gum(){y.ULS.shipAssertTag(527708514,3016,this.qkc===A.a.chn,`${this.qkc}`);this.qkc=Math.min(this.VQ.length,A.a.H3d)}cmi(){return this.qkc<
Math.min(this.VQ.length,A.a.H3d)}bEb(J){return J>=this.VQ.length?(y.ULS.shipAssertTag(527708515,3016,!1),null):this.baseUrl+this.VQ[J].imageId}Luf(J){return J>=this.VQ.length?(y.ULS.shipAssertTag(527708544,3016,!1),null):this.baseUrl+this.VQ[J].thumbnailId}uX(J){return J>=this.VQ.length?(y.ULS.shipAssertTag(527708545,3016,!1),null):this.VQ[J].altText?this.VQ[J].altText:this.VQ[J].category===z.SuggestionCategory.AbstractImage?WordEditorIntl.WordEditorStrings.L_DesignerImageSuggestionAbstractImageAltText:
WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage}jYl(J){var N;return J>=this.VQ.length?(y.ULS.shipAssertTag(527210446,3016,!1),0):null!==(N=this.VQ[J].score)&&void 0!==N?N:0}PQa(J){if(!this.B_d){const N=n[v(J)];y.ULS.sendTraceTag(509653453,3016,50,"ID: {0}; Type: ImageSuggestion for Heading , State: {1};",this.id,N);a.a(A.a.Mjl,!0,void 0,[Object.assign(new l.a,{name:"ID",string:this.id.toString()}),Object.assign(new l.a,{name:"State",string:N})])}super.PQa(J)}}Object(E.a)(F,"ImageSuggestion",
w,[]);class I extends w{constructor(J,N=null,R,O,L=null){super(J,0,N,R,O);this.metadata=L;this.rNi=!1}PQa(J){this.rNi||(this.rNi=!0,this.metadata&&a.a(A.a.y9k,!0,0,this.metadata.concat([Object.assign(new l.a,{name:"ID",string:this.id.toString()})])));super.PQa(J)}}Object(E.a)(I,"InconsistencySuggestion",w,[]);class K extends w{constructor(J,N=null,R,O=!1,L){super(J,4,N,R,O);this.mzn=L}PQa(J){this.vCo=J;super.PQa(J)}}Object(E.a)(K,"DesignerPasteSuggestion",w,[])},1507:function(E,M,c){c.d(M,"a",function(){return m});
const m={FFh:"CommentDeepLinkNavigationFailed",wEd:"CommentDataLoss",J2b:"CommentExperienceDegraded",hjf:"CommentsFeatureUsage",r8e:"CommentThreadInProgress",LEd:"CommentReplyInProgress",IFh:"CommentEditInProgress",xEd:"CommentDeepLink",DFh:"CommentCommit",K2b:"CommentLoad",XFh:"CommentInitialization"}},1508:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}m.jq="SpellingErrorV2";m.xfg="SpellingErrorV2Themed";m.D4k="ContextualSpellingAndGrammarErrorV2";m.M9e="ContextualSpellingAndGrammarErrorV2Themed";
m.Rzd="AdvancedProofingIssueV2Themed";m.Y5i="AdvancedProofingIssueV2Themed";m.similarityReviewed="SimilarityReviewed";m.hsj="SimilarityReviewedThemed";m.similarityUnreviewed="SimilarityUnreviewed";m.isj="SimilarityUnreviewedThemed";m.Wjc="SpellingErrorHighlight";m.Q8b="GrammarErrorHighlight";m.vdb="CritiqueIndicatorHighlight";m.X5i="ReactiveRewriteIndicatorHighlight";m.pwo="SimilarityHighlight";m.qwo="SimilarityReviewedHighlight";m.hBd="IdeasSuggestionConfirmation";Object(E.a)(m,"CanvasContextualCssClasses",
null,[])},1509:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a,l,y=!1,z=!1,n=!1,v=!1,A=null){this.ll=e;this.source=a;this.BQa=l;this.$ea=y;this.Qjc=z;this.qif=n;this.UNa=v;this.Jo=A}}Object(E.a)(m,"ContextualIntentInvocationParameters",null,[])},1510:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a,l,y,z=null,n=null,v=null,A=0,w=0){this.y4=this.Ykc=this.BGa=this.sR=null;this.AH=A;this.bce=e;this.JRa=a;this.j7a=l;y&&(this.sR=y);null!=z&&
(this.BGa=z);null!=n&&(this.Ykc=n);v&&(this.y4=v);this.shapeId=w}}Object(E.a)(m,"AnchorData",null,[])},1512:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.completion=new Promise((e,a)=>{this.resolve=e;this.reject=a})}}Object(E.a)(m,"ControlledPromise",null,[])},1515:function(E,M,c){c.d(M,"a",function(){return w});E=c(0);var m=c(19),e=c(177),a=c(9),l=c(529),y=c(43),z=c(17),n=c(23),v=c(234),A=c(8);class w{constructor(G,F,I,K,J){this.PFb=G;this.D1a=F;this.gvb=I;this.Dka=
K;this.Kd=J;this.u4g=0;this.S$a=null;this.shk=!1;this.b4g=!0;this.VZg=null;this.kZc=this.Ind=!0;this.k0g=!1;this.ayc=G?G.innerText:A.ParagraphReader.text(F)}get QC(){throw Error.notImplemented("The inherit class should have the default value.");}set QC(G){}get AIb(){return this.u4g}unj(G){this.u4g=G}get kb(){return this.S$a}set kb(G){this.S$a=G}get EG(){return this.gvb}get l0(){return this.Dka}get qwi(){return this.k0g}get pCi(){return!1}get Cxa(){return this.ayc}get kso(){return!0}invoke(){this.k0g=
!0;if(this.PFb&&this.PFb.parentNode&&!this.QC){var G=this.PFb.innerText;if(this.kZc&&m.a.substring(this.ayc,this.gvb,this.Dka)!==m.a.substring(G,this.gvb,this.Dka))return 0;this.WBb(this.PFb);this.unj(this.PFb.innerText.length-G.length);return 1}this.Ind||e.a.instance.Yb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.b4g)return e.a.instance.Yb("AbortedAction",{["Reason"]:this.VZg}),0;var F=A.ParagraphReader.text(this.D1a);G=F.length;var I=this.ayc.length,K=m.a.substring(this.ayc,
this.gvb,this.Dka).trimEnd();F=m.a.substring(F,this.gvb,this.Dka).trimEnd();this.kso&&K===F&&this.Dka>I&&(this.Dka=I);if(this.kZc&&K!==F)if(I=K.replace(RegExp('"',"g"),""),I===m.a.substr(F,0,I.length))this.Dka-=2;else return 0;if(a.App.rd.Yo&&l.CoauthLockEditor.getInstance().D6a(w.Vf.a7b(this.D1a)))return 0;I=new y.GraphTransaction(15);I.Cb(this.D1a);I.fk=this.commandId;this.Ima(this.D1a);this.unj(A.ParagraphReader.textLength(this.D1a)-G);this.S$a&&!this.shk&&z.SelectionEditor.km(this.S$a)&&(F=this.S$a.Qa,
G=F.cpBegin,K=F.cpEnd,F=F.node,F===this.D1a&&this.AIb&&(G>=this.Dka&&(G+=this.AIb),K>=this.Dka&&(K+=this.AIb),this.S$a=n.SelectionFactory.GK(F,G,K)));I.dispose();return 2}jIj(){this.Ind=this.JCh()}WBb(){}JCh(){var G=A.ParagraphReader.text(this.D1a);const F=m.a.substring(this.ayc,this.gvb,this.Dka).trimEnd();G=m.a.substring(G,this.gvb,this.Dka).trimEnd();return F===G}static get Vf(){return v.a.instance}}Object(E.a)(w,"AAutoCorrectAction",null,[583])},1516:function(E,M,c){c.d(M,"a",function(){return a});
E=c(0);var m=c(28),e=c(7);class a{constructor(l){this.ll=l}static create(l){if(!l)return e.ULS.shipAssertTag(575930373,3016,!1),null;l=m.a.create(l);return new a(l)}}Object(E.a)(a,"ShowReviewArgs",null,[])},1517:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.data=this.landingTab=null}}Object(E.a)(m,"LaunchData",null,[])},1521:function(E,M,c){c.d(M,"c",function(){return a});c.d(M,"a",function(){return l});c.d(M,"b",function(){return y});E=c(0);var m=c(1504);class e{constructor(z,
n,v){this.suggestion=z;this.Eq=n;this.paragraphNode=v}get role(){switch(this.Eq){case 1:case 3:return 27;case 2:return 28;default:return 1}}}Object(E.a)(e,"AddEnhancementActionData",null,[]);class a extends e{constructor(z,n,v,A,w,G=1){super(z,G,n);this.f5a=v;this.d2c=A;this.callback=w}}Object(E.a)(a,"AddPullQuoteActionData",e,[]);class l extends e{constructor(z,n,v=0){super(z,2,n);this.Rna=v}}Object(E.a)(l,"AddCoverPhotoActionData",e,[]);class y{constructor(z,n,v,A,w){this.suggestion=z;this.ar=n;
this.j$b=v;this.OSc=A;this.NAd=w}get annotationType(){switch(this.suggestion.Eq){case 1:case 3:return m.a.V0f;case 2:return m.a.Mgg;default:return m.a.HOh}}get XQa(){return this.ar&&1<=this.ar.length?this.ar[0]:null}}Object(E.a)(y,"AddDesignerSuggestionActionData",null,[])},1526:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}Object(E.a)(m,"OAuthResult",null,[])},1527:function(E,M,c){c.r(M);c.d(M,"FindManagerHelper",function(){return z});E=c(0);var m=c(7),e=c(110),a=c(9),l=c(147),
y=c(1040);c=c(1804);class z extends c.a{constructor(){super()}get Uc(){return a.App.ya.gb.Uc}get uj(){return a.App.ya.gb.Uc.od}get soa(){return a.App.ya.gb.soa()}get $Bf(){return a.App.ya.gb.wc.Vi}jZe(n){a.App.Lj.Bl.MMa(n)}E4d(n,v,A){return y.b(n,v,A)}Jkg(n,v,A){if(1===A){if(!z.fh.Kkg(n))return!1}else if(!(n.We===v||n.zb(v)&&n.hd(v)))return!1;return Object(e.a)(73,n.currentNode)||this.E4d(n,v,A)?!0:!1}Bva(n){return this.uj.Db(n).Bva()}Nzi(n,v,A,w){if(!n||n.matchCase!==A.matchCase||n.matchWholeWord!==
A.matchWholeWord||w.length!==v.length)return!0;for(n=0;n<w.length;n++){if(w[n]!==v[n])return!0;if(A.matchCase){if(w[n]!==v[n])return!0}else if(w[n].toLocaleLowerCase()!==v[n].toLocaleLowerCase())return!0}return!1}Yzi(n,v,A,w){if(!n||n.matchWholeWord&&!A.matchWholeWord||n.matchCase&&!A.matchCase||w.length!==v.length)return!1;if(n.matchWholeWord)return n.matchCase?v[0]===w[0]:w[0].toLocaleLowerCase()===v[0].toLocaleLowerCase();for(let G=0;G<w.length;G++)if(n.matchCase){if(!w[G].startsWith(v[G]))return!1}else if(!w[G].toLocaleLowerCase().startsWith(v[G].toLocaleLowerCase()))return!1;
n.matchCase===A.matchCase&&n.matchWholeWord===A.matchWholeWord&&1===v.length&&m.ULS.sendTraceTag(4069025,313,50,"{0}",{["IncrementalSearchTriggeredQueryLength"]:A.text.length});return!0}yce(n,v,A){const w=a.App.Lj.Bl.Ze(12);w.Fo(n);w.Ot(v);w.Kw(A)}static get fh(){return l.PageNavigator.instance}static get instance(){z.dtb||(z.dtb=new z);return z.dtb}}z.dtb=null;Object(E.a)(z,"FindManagerHelper",c.a,[])},1528:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);var m=c(2);class e{constructor(){this.currentDocumentPath=
m.AFrameworkApplication.K.jb("EditDocInClientUrl")}}Object(E.a)(e,"SmartLookupApplicationInterface",null,[])},1529:function(E,M,c){c.d(M,"a",function(){return R});E=c(0);var m=c(719),e=c(5),a=c(1752),l=c(1795),y=c(1796),z=c(193),n=c(8),v=c(43),A=c(134),w=c(147),G=c(538),F=c(6),I=c(588),K=c(78),J=c(157),N=c(528);class R{constructor(O,L,U,W,X){R.kYd=!1;this.tE=O;this.BMe=L;this.AMe=U;this.Wc=W;this.S2j=X}Ago(O,L){this.tE.koa(O)&&O.properties.setValue(F.a.dna,L)}y5b(){if(!R.kYd){var O=this.zci();for(var L=
O.Rb(7);L;L=O.xi(7))for(L=O.Rb(8);L;L=O.xi(8));R.kYd=!0}}zci(){const O=this.Wc.xk();O.set(this.S2j());R.fh.eP(O);return O}Nu(){const O=this.zci();this.AMe.F4d(O);this.g1n(O.currentNode);R.kYd=!1}oGn(O){this.y5b();if(O.isConnected){var L=this.P3(O);if(L=this.tE.WNc(O,L)){var U=this.Wc.xk();U.set(L);U.zb(25);O.anchor&&(U.set(O),U.zb(37),U.wg())}}}Vtl(O,L){if(O.zb(25)&&O.hd(25)&&!O.Nr(7)){const U=e.GraphIterator.$a(L);U.zb(37);U.hd(37);L=I.a(U.currentNode,L.Bi().Kc,!0);O.Hf(L,7)}}lwl(O,L,U,W){O=new a.a(e.GraphIterator.$a(O),
e.GraphIterator.$a(L),{});O.vOb=!0;U=new m.a(U,W,new l.a(O,null));U.Ig=!0;U.Al("ExecuteInternalFootnoteEndnoteCopy");U.run()}n$e(O,L){L=L.Ib.paragraph;var U=L.Bi().od;U=I.a(O,U,!0);L=e.GraphIterator.$a(L);this.Vtl(L,O);L.Rb(7);L.Hf(U,8);return U}J1c(O,L,U,W){this.y5b();const X=this.P3(O);if(!this.tE.WNc(this.tE.Jci(O),X))return null;L=this.n$e(O,L);this.lwl(O,L,U,W);return L}O1c(O,L,U,W){this.y5b();var X=L.Ib.paragraph;const V=X.Bi().od;X=e.GraphIterator.$a(X);X.zb(7);X.hd(7);this.C4d(X,L.P3());L=
I.a(O,V,!0);X.Hf(L,8);this.mwl(O,L,U,W);return L}mwl(O,L,U,W){O=new y.a(e.GraphIterator.$a(O),e.GraphIterator.$a(L),null,null);U=new m.a(U,W,O);U.Ig=!0;U.Al("ExecuteInternalFootnoteEndnotePaste");U.run()}C4d(O,L){O.Rb(7);this.tE.Dwi(O,L)||O.vf(7)}H$h(O,L){const U=this.Wc.xk();U.set(L);U.zb(7);U.hd(7);this.C4d(U,O);return U}nbi(O,L,U){return this.wbi(O,L,U,!1)}x7l(O,L,U){return this.wbi(O,L,U,!0)}wbi(O,L,U,W){var X=this.Wc.xk();let V=null,Z=!1;X.set(O);X.Dp();X.hd(8);X.Qd();for(X=z.a.mt(X,X.dbd(8));X.moveNext();){if(n.ParagraphReader.Wb(X.currentNode)){const aa=
X.currentNode;var da=K.i(aa,7);for(const ea of da){if(aa===O){da=ea.Ib.cp;if(W&&da>=L)return V;da>=L&&-1!==L&&(Z=!0)}if(ea.P3()===U){if(!W&&Z)return ea;V=ea}}aa===O&&(Z=!0)}if(W&&Z)return V}return null}g1n(O){const L=new v.GraphTransaction(3);L.Cb(O);O=z.a.Vo(R.fh.Ts(O));let U=1,W=1;for(;O.moveNext();){var X=O.currentNode;if(X&&n.ParagraphReader.Wb(X)){X=K.i(X,7);for(const V of X){X=V.Q3();const Z=V.P3()?U++:W++;this.Ago(X,Z)}}}L.dispose()}P3(O){return this.tE.koa(O)?O.properties.getValue(F.a.G3):
0}static hWl(){return new R(N.a.instance,A.PageReader.instance,w.PageNavigator.instance,new G.a,R.xJl)}static xJl(){return J.App.Ln.gb.Uc}static get fh(){return w.PageNavigator.instance}static get instance(){return null!=R.xBg?R.xBg:R.xBg=R.hWl()}}R.kYd=!1;Object(E.a)(R,"FootnoteEndnoteEditorInteractive",null,[352])},1534:function(E,M,c){E=c(0);class m{static K2l(){return m._nextEventReceiverId++}}m._nextEventReceiverId=0;Object(E.a)(m,"EventReceiverIdCounter",null,[]);c.d(M,"a",function(){return e});
class e{constructor(a,l){this.wUb=a;this._id=m.K2l();this.qgk=l}get id(){return this._id}notify(a,l){this.qgk(a,l)}Yj(a,l){return this.wUb.nJn(a,l?this:null)}}Object(E.a)(e,"EventReceiver",null,[447])},1537:function(E,M,c){c.d(M,"a",function(){return I});E=c(0);var m=c(7),e=c(9),a=c(529),l=c(36),y=c(58),z=c(2001),n=c(2),v=c(1495),A=c(1507),w=c(116),G=c(593),F=c(1486);class I{static Q3m(){const K=document.getElementsByClassName(G.a.VWf);if(K&&K.length){var J=K[0].clientWidth;for(let N=1;N<K.length;N++){if(K[N].clientWidth!==
J||N===K.length-1){m.ULS.sendTraceTag(540160401,327,50,"{0}:NoOfContainers={1}",K[N].clientWidth-J,K.length);break}J=K[N].clientWidth}}}static Mrg(K,J,N){K&&(K=e.App.rd.kq.urf(K),a.CoauthLockEditor.getInstance().D6a(K)&&m.ULS.sendTraceTag(540160402,327,15,`Comment with ObjectId: ${J.objectId} added to a locked ${N?"start":"end"} paragraph. Lock Type ${K.Type.toString()}`))}static C_o(K,J,N){var R=J.Db(y.a.If(K.objectId));if(R){var O=v.a.mba(R,J,!0);J=v.a.mba(R,J,!1);null!==O&&void 0!==O&&O.Yu||(O=
F.k(R),m.ULS.sendTraceTag(540160404,327,15,`CommentRangeStart failed to save. startParaId: ${O}, CommentObjectId: ${K.objectId}`),I.rIi(N));null!==J&&void 0!==J&&J.Yu||(R=F.h(R),m.ULS.sendTraceTag(540160405,327,15,`CommentRangeEnd failed to save. endParaId: ${R}, CommentObjectId: ${K.objectId}`),I.rIi(N))}else m.ULS.sendTraceTag(540160403,327,15,`Commited Comment missing CommentNode graph object ObjectId: ${K.objectId}`)}static rIi(K){K.logKpiFailure(A.a.DFh,"CommentReferenceFailedToSave",{isIntentional:!1,
isInternal:!0},{name:A.a.wEd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1})}static W2m(K,J,N){0!==K.size&&K.forEach(R=>{J.has(R)||I.a3m(R,N)})}static a3m(K,J){J.Db(y.a.If(K))&&m.ULS.sendTraceTag(539800642,327,15,`comment start missing for ${K}`)}static GUk(K){const J=new Set;K.forEach(N=>{N&&N.hj&&((N=I.pci(N))?J.add(N):m.ULS.sendTraceTag(539554689,327,15,"Outline Node is undefined"))});J.forEach(N=>{const R=N.ia(w.a.v8e,[]);0===N.ia(w.a.t8e,[]).length&&0===R.length&&m.ULS.sendTraceTag(539800644,
327,15,`Outline Element Node ${N.id.toString()} is missing comment info while paragraph has comments. This will cause some comments to fail to load.`)})}static ZSm(K,J,N,R){K=N.J5h(K);if(!K)return!1;N=F.k(K,y.a.nil);R=R.Db(N);J.has(N.toString())&&m.ULS.sendTraceTag(539800643,327,15,`Para Node ${N} missing comment reference for comment ${K.id}`);return R&&R.hj?!0:(m.ULS.sendTraceTag(539567714,327,15,`Para Node ${N} with missing comment reference for comment ${K.id} is in a invalid state ${R?"paraNode containingGraph is null":
"paraNode is null"}`),!1)}static pci(K){let J;try{J=l.OutlineElementNavigator.Il(K)}catch(N){m.ULS.sendTraceTag(539567715,327,10,`ParaNode ${K.id} OutlineNode failed to retrieve ${N}`)}return J}static qTl(K){var J;switch(null===(J=K.gz)||void 0===J?void 0:J.sessionType){case z.a.create:return A.a.r8e;case z.a.reply:return A.a.LEd;case z.a.edit:return A.a.IFh}}static ACh(K){if(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForDuplicateReactionUsers",!0)&&(K=K[1])&&
0!==K.length){var J=new Set;for(let N=0;N<K.length;N++)J.add(K[N].UserId);K.length>J.size&&m.ULS.sendTraceTag(521458447,327,15,`Reaction UserList has duplicates: ${K.length-J.size}`)}}}Object(E.a)(I,"CommentDiagnosticHelpers",null,[])},1538:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}m.open="open";m.refresh="refresh";m.P8f="saveAs";m.translate="translate";m.modeSwitch="modeSwitch";m.Haf="createNew";Object(E.a)(m,"ReasonList",null,[])},1539:function(E,M,c){c.d(M,"a",function(){return m});
E=c(0);class m{static T$c(e){if(!e)return"{NULL}";const a=e.length;if(600>=a)return e;const l=a-195;return e.substring(0,400)+"[...]"+e.substring(l,a)}}Object(E.a)(m,"LogUtils",null,[])},1540:function(E,M,c){c.d(M,"b",function(){return m});c.d(M,"a",function(){return e});c.d(M,"c",function(){return a});const m=(l,y,z,n,v,A,w,G)=>{var F=1;if(!l&&!y||!z||!n)return F;v&&A?(A=z+l,F=n+y,l=1/z,y=1/n,v=l>y?l:y,1>A?A=1:1920<A&&(A=1920),1>F?F=1:1280<F&&(F=1280),l=A-z,y=F-n,G?(z=A/z,n=F/n,F=Math.abs(z-w)<Math.abs(n-
w)?z:n):F=Math.abs(l/z)>Math.abs(y/n)?A/z:F/n,F<v&&(F=v)):v?(w=z+l,1>w?w=1:1920<w&&(w=1920),F=w/z):A&&(w=n+y,1>w?w=1:1280<w&&(w=1280),F=w/n);return F},e=(l,y)=>{l=Math.atan2(y.y-l.y,y.x-l.x);0>l&&(l+=2*Math.PI);return l},a=l=>{l%=360;0>l&&(l+=360);return l}},1541:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}Object(E.a)(m,"SmartLookupSelection",null,[])},1543:function(E,M,c){c.d(M,"a",function(){return N});E=c(0);var m=c(22),e=c(887),a=c(538),l=c(32),y=c(147),z=c(6),n=c(42),v=c(15),
A=c(7),w=c(110),G=c(73),F=c(55),I=c(468),K=c(144),J=c(1041);class N{constructor(R,O,L,U,W,X){this.Enk=R;this.we=O;this.Rvf=L;this.sLa=U;this.FBe=W;this.EBe=X}get wk(){return null!=this.cHg?this.cHg:this.cHg=m.a.instance.resolve("WordEditor.ITableEditor")}get Ld(){return null!=this.fIg?this.fIg:this.fIg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=this.MHg?this.MHg:this.MHg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get $Qb(){return this.Enk.value}get Nbd(){return this.we.value}GXk(R){const O=
this.$Qb.x8b(R,e.a.m5d);O&&(this.z6a(O,R),this.Dya(1696,R))}z6a(R,O,L=!0){const U=this.$Qb.Shb(O);if(U&&(R=this.Nbd.kg(R),U.Fi(R))){const W=this.$Qb.$T(O);let X="Unknown";this.$Qb.tla.value&&(X=this.$Qb.tla.value.nb(R)?R:"CustomStyle");A.ULS.sendTraceTag(0,311,50,"{0}",{["ApplyTableStyleId"]:X,["RowCount"]:this.FBe(O),["ColumnCount"]:this.EBe(O),["HR"]:!!(W&32),["FC"]:!!(W&128),["TR"]:!!(W&64),["LC"]:!!(W&256),["BR"]:!(W&512),["BC"]:!(W&1024),["TableId"]:O.id.toString()});L&&this.Tia(O);this.Tmg(O,
U);L=U.Fi(R);O.properties.setValue(z.a.tableStyle,L.id);this.h7e(O);O.qT.q8(!0)}}h7c(R,O,L){if(R=this.$Qb.x8b(L,R))this.Dya(O,L),this.z6a(R,L)}Dya(R,O,L=!0){L&&this.Tia(O);O.properties.setValue(z.a.tableLook,R);A.ULS.sendTraceTag(0,311,50,"{0}",{["HR"]:!!(R&32),["FC"]:!!(R&128),["TR"]:!!(R&64),["LC"]:!!(R&256),["BR"]:!(R&512),["BC"]:!(R&1024),["TableId"]:O.id.toString()});O.qT.q8(!0)}Tmg(R,O){(R=this.sLa(R))&&O.Uic(R)}h7e(R){if(R.isConnected){R.hasProperty(n.a.Nv)&&R.removeProperty(n.a.Nv);this.w5f(R);
this.Y3c(R);R=this.Rvf.Uf(R);for(var O=R.Rb(1);O;){for(O=R.Rb(1);O;)O.hasProperty(v.a.vH)&&O.removeProperty(v.a.vH),O.hasProperty(z.a.Aqa)&&O.removeProperty(z.a.Aqa),this.qSa(O),this.Y3c(O),O=R.xi(1);O=R.xi(1)}}}C8b(R){let O=R.ia(n.a.Hxa,null);if(O)return O;if(R=this.Nbd.kg(R))if(O=({value:O}=this.$Qb.tla.value.Dc(R,O)).returnValue?O:null)return O;return R}Zij(R,O,L,U,W){R.properties.setValue(O.style,L);R.properties.setValue(O.size,U*K.a.t1b);R.properties.setValue(O.color,W)}Tia(R){if(this.Ld.qg){var O;
Object(w.a)(I.a,R)&&(O=Object(G.a)(I.a,R))&&(O=O.AR())&&this.lj.Tia(R,O)}}w5f(R){R.Eg(z.a.Wa,z.a.Xa,z.a.zqa,z.a.ob,z.a.pb,z.a.xqa,z.a.Ua,z.a.Va,z.a.wqa,z.a.qb,z.a.rb,z.a.yqa,z.a.tb,z.a.ub,z.a.Lya,z.a.Lb,z.a.Mb,z.a.Mya)}qSa(R){R.Eg.apply(R,this.wk.W5e)}Y3c(R){R.Eg(z.a.Ca,z.a.za,z.a.Aa,z.a.Ba,z.a.qP,z.a.KR,z.a.XHa,z.a.VHa)}static vuf(){return new N(m.a.instance.Ue("WordEditor.IWACTableStyleReader"),m.a.instance.Ue("Box4.Styles.IWACStyleReader"),new a.a,Object(F.a)(N.fh,N.fh.Ts,"navigateToPageContentNode"),
l.TableReader.eg,l.TableReader.Yg,J.a.instance)}static get fh(){return y.PageNavigator.instance}static get instance(){return null!=N.vCg?N.vCg:N.vCg=N.vuf()}}Object(E.a)(N,"WACTableStyleEditor",null,[286,287])},1544:function(E,M,c){c.d(M,"a",function(){return N});E=c(0);var m=c(112),e=c(2),a=c(540),l=c(237),y=c(335),z=c(1508),n=c(766),v=c(303),A=c(526),w=c(853);c.n(w);var G=c(603),F=c(1383),I=c(1641),K=c(102),J;(function(R){R[R.Spelling=0]="Spelling";R[R.Grammar=1]="Grammar";R[R.Style=2]="Style";
R[R.Hnc=3]="Similarity";R[R.lqg=4]="ContextIQ";R[R.CLj=5]="AutoReplace"})(J||(J={}));Object(E.b)("AnnotationRenderCategory",J);class N{static fRl(R){switch(N.ARd(R)){case J.Spelling:R=z.a.xfg;break;case J.Grammar:R=z.a.M9e;break;case J.Hnc:R=60!==R.M_.state&&70!==R.M_.state?z.a.isj:z.a.hsj;break;case J.lqg:if(I.a.nqg()&&I.a.YAi(R))return;R=z.a.Rzd;break;case J.CLj:R=z.a.hBd;break;default:R=z.a.Rzd}return R}static Lfm(R){switch(N.ARd(R)){case J.Spelling:return v.f.SpellingSquiggle;case J.Grammar:return v.f.GrammarSquiggle;
default:return v.f.CritiqueSquiggle}}static ARd(R){let O;if(N.MVc(R))switch(R.priority){case 0:O=J.Spelling;break;case 1:O=J.Grammar;break;default:O=J.Style}else N.sbc(R)?O=J.Hnc:N.QTc(R)&&(O=J.lqg);return O}static MVc(R){R=l.a.getTypeNameFor(R);return R===y.a.getTypeName()||R===n.a.getTypeName()}static QTc(R){return l.a.getTypeNameFor(R)===w.FlagAnnotation.getTypeName()}static sbc(R){return l.a.getTypeNameFor(R)===a.a.getTypeName()}static m_d(R){return N.MVc(R)?0===R.priority:!1}static DYd(R){return N.MVc(R)?
1===R.priority:!1}static qDm(R){return l.a.getTypeNameFor(R)===n.a.getTypeName()}static zBf(R){return null!=R&&"Spelling"===R.categoryName&&1===R.suggestions.length&&4===(R.suggestions[0].suggestionActions&4)}static xcm(R,O){const L=[v.b.IgnoreOnce];switch(R){case 0:L.push(v.b.IgnoreAll);O&&L.push(v.b.AddToDictionary);break;case 1:L.push(v.b.Options)}return L}static G4h(R){return N.MVc(R)?R.categoryName:N.sbc(R)?N.gsj:N.QTc(R)?N.RDl:null}static Ntf(R,O){let L=A.a.cjc;switch(R){case 0:L=O?A.a.rhe:
A.a.ooj;break;case 1:L=A.a.noj}return L}static N6b(R,O=!1,L){L="IntentProvider_Suggestion_"+L;let U=m.a.Db(R,L);O&&!U&&m.a.ql(R,L,U=new G.a);return U}static pwf(R,O,L,U,W,X,V,Z,da=!1,aa){U&&L&&(!(L=X.R2h(L,W))||!e.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")&&e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)&&this.ARd(L)==J.Style||(V.jKd(R,O,Z),N.N6b(R,!0,aa).add(L.id),O=N.fRl(L),R.classList.add(O),N.JQb&&N.kYe(R,L),da&&F.a.WXc()))}static get JQb(){return null!=
N.HIg?N.HIg:N.HIg=e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}static kYe(R,O){N.m_d(O)?R.setAttribute("aria-invalid","spelling"):N.DYd(O)&&R.setAttribute("aria-invalid","grammar")}static $Pa(R,O,L){R=(R=N.N6b(R,!1,L))?K.firstOrDefault(R):null;return{returnValue:!!R,type:R?L:null,data:R}}}N.gsj="Similarity";N.RDl="FlagAnnotation";Object(E.a)(N,"AnnotationHelper",null,[])},1556:function(E,M,c){c.d(M,"a",function(){return a});E=c(0);
var m=c(147),e=c(243);class a{j4a(l){a.fh.eP(l);return l.Rb(16)}static Jr(){return new e.a(()=>new a)}static get instance(){return a._instance.value}static get fh(){return m.PageNavigator.instance}}a._instance=a.Jr();Object(E.a)(a,"CommentNavigator",null,[312])},1558:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m extends Sys.EventArgs{constructor(){super();this.uTi=this.hGa=null}}Object(E.a)(m,"OnCommentInitArgs",Sys.EventArgs,[])},1559:function(E,M,c){c.d(M,"a",function(){return z});
E=c(0);var m=c(54),e=c(145),a=c(7),l=c(84),y=c(60);class z{constructor(n,v,A){a.ULS.shipAssertTag(6305502,307,!!n);this.properties=n;this.Ic=v;this.WS=A}ddi(){return this.properties.ia(e.a.gP,"")}J1i(){return!0}jBj(){let n=!1,v=null;const A=this.ddi();if(this.WS||""!==A)try{({Sua:v,returnValue:n}=this.Vlc(A))}catch(w){a.ULS.shipAssertTag(4203138,307,!1),this.Ic.Yb(l.a.Xma,{["Reason"]:y.a.e4e}),m.a.e_(v)}else a.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Ic.Yb(l.a.n1,{["Reason"]:y.a.Kif});
return{returnValue:n,xFd:v}}}Object(E.a)(z,"AStringInputImportStrategy",null,[478])},1560:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.e$=[]}r6h(){const e=new m;for(let a=0;a<this.e$.length;a++)e.add(this.J(a));return e}get count(){return this.e$.length}J(e){return this.e$[e]}Z(e,a){return this.e$[e]=a}add(e){this.e$.push(e)}clear(){Array.clear(this.e$)}contains(e){return Array.contains(this.e$,e)}getRange(e,a){const l=new m;for(let y=0;y<a;y++)l.add(this.J(e+
y));return l}indexOf(e){return Array.indexOf(this.e$,e)}insert(e,a){Array.insert(this.e$,e,a)}remove(e){return Array.remove(this.e$,e)}removeAt(e){Array.removeAt(this.e$,e)}removeRange(e,a){for(let l=0;l<a;l++)Array.removeAt(this.e$,e)}reverse(){this.e$.reverse()}sort(){this.e$.sort()}toArray(){return Array.clone(this.e$)}}Object(E.a)(m,"List",null,[])},1562:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}m.generalException="GeneralException";m.invalidArgument="InvalidArgument";m.notImplemented=
"NotImplemented";m.Jyb="AccessDenied";m.XTm="ItemNotFound";m.notSupported="NotSupported";m.apiNotAvailable="ApiNotAvailable";m.notAllowed="NotAllowed";m.rvn="OperationCancelled";m.userNotSignedIn="UserNotSignedIn";m.userAborted="UserAborted";m.invalidResourceUrl="InvalidResourceUrl";m.invalidGrant="InvalidGrant";m.clientError="ClientError";m.serverError="ServerError";Object(E.a)(m,"ErrorCodes",null,[])},1563:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e){this.id=e}}
Object(E.a)(m,"DesignerPaneToggleData",null,[])},1565:function(E,M,c){c.d(M,"a",function(){return y});E=c(0);var m=c(1839),e=c(538),a=c(6),l=c(1040);class y{constructor(z){this.VUl=(n,v)=>{const A=this.Yei(n),w=this.Wc.Uf(v);return w.zb(A)?(w.hd(A),new m.a(w.currentNode,v,n)):null};this.UUl=(n,v)=>{let A=null,w=null;const G=this.Yei(n);v=this.Wc.Uf(v);({rootNode:A,bja:w}=this.rko(v,n,G,A,w));return A&&w?new m.a(A,w,n):null};this.ZUl=n=>{n=this.Wc.Uf(n);return(this.H8(2)||this.H8(4))&&n.zb(36)?(n.hd(36),
this.$Bl(n.currentNode)):(this.H8(8)||this.H8(16))&&n.zb(37)?(n.hd(37),this.RZh(n.currentNode)):this.H8(32)&&n.zb(40)?32:this.H8(1)&&n.zb(8)?1:0};this.Wc=z;this.aCl=this.ZUl;this.MBl=this.VUl;this.LBl=this.UUl;this.qCl=31;this.Tgg=this.cVl()}h8h(z){const n=[],v=this.aCl(z);if(v){var A=this.MBl(v,z);A&&(n[n.length]=A)}for(const w of this.Tgg)w!==v&&w&&(A=this.LBl(w,z))&&(n[n.length]=A);return n}H8(z){return!!z&&!!(this.qCl&z)}rko(z,n,v,A,w){if(z.zb(7)){z.hd(7);if(8===v||37===v||39===v)for(var G=z.Qd();G;){if(G.type===
v)if(37===v){if((8===n||16===n)&&n===this.RZh(G)){A=z.currentNode;break}}else{A=z.currentNode;break}G=z.Rj()}A&&z.rA()&&(G=this.Wc.Uf(A),l.b(G,v,n)&&(w=z.currentNode))}return{rootNode:A,bja:w}}cVl(){const z=[];this.H8(1)&&(z[z.length]=1);this.H8(2)&&(z[z.length]=2);this.H8(4)&&(z[z.length]=4);this.H8(8)&&(z[z.length]=8);this.H8(16)&&(z[z.length]=16);this.H8(32)&&(z[z.length]=32);return z}Yei(z){let n=8;switch(z){case 1:case 2:case 4:n=8;break;case 8:case 16:n=37;break;case 32:n=39}return n}RZh(z){z=
z.properties.getValue(a.a.G3);return this.H8(8)&&1===z?8:this.H8(16)&&!z?16:0}$Bl(z){z=z.getValue(a.a.i9b);return this.H8(2)&&y.NJm(z)?2:this.H8(4)&&y.lJm(z)?4:0}static YE(){return new y(new e.a)}static get instance(){return null!=y.DBg?y.DBg:y.DBg=y.YE()}static NJm(z){return z&&1!==z&&2!==z?!1:!0}static lJm(z){return 3===z||4===z||5===z?!0:!1}}Object(E.a)(y,"WordFindContextHelper",null,[282])},1573:function(E,M,c){var m=this&&this.lE||(Object.create?function(e,a,l,y){void 0===y&&(y=l);var z=Object.getOwnPropertyDescriptor(a,
l);if(!z||("get"in z?!a.bC:z.writable||z.configurable))z={enumerable:!0,get:function(){return a[l]}};Object.defineProperty(e,y,z)}:function(e,a,l,y){void 0===y&&(y=l);e[y]=a[l]});E=this&&this.__exportStar||function(e,a){for(var l in e)"default"===l||Object.prototype.hasOwnProperty.call(a,l)||m(a,e,l)};Object.defineProperty(M,"__esModule",{value:!0});E(c(1902),M);E(c(1903),M);E(c(1904),M);E(c(1905),M);E(c(1906),M)},1581:function(E,M,c){var m=c(1510);E=c(0);class e{}Object(E.a)(e,"SerializableAnchorDataV1",
null,[]);class a{}Object(E.a)(a,"SerializableCpDataV1",null,[]);var l=c(981);c.d(M,"a",function(){return y});c.d(M,"c",function(){return z});c.d(M,"b",function(){return n});c.d(M,"d",function(){return v});const y=A=>new m.a(A.RK,A.PS,A.TS,c(1613).versionedDeserialize(A.OS),A.PE,A.TE,c(1613).versionedDeserialize(A.OE),A.DK,A.SI),z=A=>{const w=new e;w.RK=A.bce;w.PS=A.JRa;w.TS=A.j7a;w.DK=A.AH;w.SI=A.shapeId;A.sR&&(w.OS=v(A.sR));A.BGa&&(w.PE=A.BGa);A.Ykc&&(w.TE=A.Ykc);A.y4&&(w.OE=v(A.y4));return w},n=
A=>{if(!A)return null;const w=new l.a(A.CP);w.jva=null!=A.FB?A.FB:0;w.hga=null!=A.FE?A.FE:0;w.gua=null!=A.CB?A.CB:0;w.hua=null!=A.CE?A.CE:0;w.zPa=null!=A.HB?A.HB:0;w.Rga=null!=A.HE?A.HE:0;w.oya=null!=A.R?A.R:0;w.gva=null!=A.E?A.E:0;w.Rya=null!=A.TW?A.TW:0;w.Exa=null!=A.PB?A.PB:0;w.symbols=null!=A.SYM?A.SYM:0;w.mwa=null!=A.IE?A.IE:0;w.mxa=null!=A.OO?A.OO:0;w.wta=null!=A.AX?A.AX:0;w.mua=null!=A.CCI?A.CCI:0;w.dryDeletion=null!=A.DD?A.DD:0;return w},v=A=>{if(!A)return null;const w=new a;w.CP=A.cp;w.VS=
1;0<A.jva&&(w.FB=A.jva);0<A.hga&&(w.FE=A.hga);0<A.gua&&(w.CB=A.gua);0<A.hua&&(w.CE=A.hua);0<A.zPa&&(w.HB=A.zPa);0<A.Rga&&(w.HE=A.Rga);0<A.oya&&(w.R=A.oya);0<A.gva&&(w.E=A.gva);0<A.Rya&&(w.TW=A.Rya);0<A.Exa&&(w.PB=A.Exa);0<A.symbols&&(w.SYM=A.symbols);0<A.mwa&&(w.IE=A.mwa);0<A.mxa&&(w.OO=A.mxa);0<A.wta&&(w.AX=A.wta);0<A.mua&&(w.CCI=A.mua);0<A.dryDeletion&&(w.DD=A.dryDeletion);return w}},1591:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a="",l="",y=""){this.IsCurrentUser=
!1;this.UserId=e;this.Provider=a;this.DisplayName=l;this.Email=y}}Object(E.a)(m,"CommentTaskPerson",null,[926])},1592:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a,l,y,z=!1){this.priority=this.completion=-1;this.type=e;this.user=a;this.time=l;this.recordId=y;this.isLossy=z}}Object(E.a)(m,"HistoryRecord",null,[])},1593:function(E,M,c){c.d(M,"a",function(){return l});E=c(0);var m=c(497),e=c(391),a=c(614);class l{constructor(){this.vKg=null;this.dY=!1;this.aKb=this.Heb=
null;this.Nx=new m.a(new e.a);this.FU=new m.a(new e.a);this.E2f=this.ZFb=!1;this.c8c=!0}get Zm(){return a.a.Zm}set Zm(y){a.a.Zm=y}get jdb(){return this.vKg}set jdb(y){this.vKg=y}}l.Ej=1;Object(E.a)(l,"CommentsState",null,[])},1594:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}m.yellow="FFFF00";m.GXm="00FF00";m.hFk="00FFFF";m.mHl="FF00FF";m.blue="0000FF";m.red="FF0000";m.fen="000080";m.teal="008080";m.green="008000";m.purple="800080";m.t9m="800000";m.Whn="808000";m.gray="808080";
m.fxo="C0C0C0";m.black="000000";Object(E.a)(m,"FontHighlightColorEnum",null,[])},1595:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.u$={};this.u$.ops=[]}Wga(e){const a=this.u$.ops;if(a.length){var l=a.length-1;const y=a[l];if(!y.attributes){y.insert+=e;a[l]=y;this.u$.ops=a;return}}l={};l.insert=e;Array.add(a,l)}wri(e,a){const l={};this.Olj(l,a);Array.add(this.u$.ops,this.E3b(e,l))}cAf(e,a,l,y=!1){var z={};z.fullName=a.fullName;z.email=a.email;z.resolveState=a.resolveState;
a={};a.atmention=z;e=this.E3b(e,a);l&&(z={},z.contentId=l.contentId,a={},a.atmention=z,y&&(z.isCurrentUser=l.isCurrentUser),e.optional=a);Array.add(this.u$.ops,e)}insertImage(e,a){e=this.E3b(e,{});const l={};l.base64=a.base64;a={};a.image=l;e.optional=a;Array.add(this.u$.ops,e)}dri(e,a){const l={};l.link=a.link;this.Olj(l,a);Array.add(this.u$.ops,this.E3b(e,l))}GNc(){return Sys.Serialization.JavaScriptSerializer.serialize(this.u$)}E3b(e,a){const l={};l.insert=e;l.attributes=a;return l}Olj(e,a){this.LNb(a.weight>=
m.aNf,e,"weight",a.weight);this.LNb(a.italic,e,"italic",!0);this.LNb(a.underline,e,"underline",!0);this.LNb(a.strikethrough,e,"strikethrough",!0);this.LNb(!!a.highlight,e,"highlight",a.highlight);this.LNb(!!a.color,e,"color",a.color);this.LNb(!!a.paragraph,e,"paragraph",a.paragraph)}LNb(e,a,l,y){e&&(a[l]=y)}static QDb(e){return Sys.Serialization.JavaScriptSerializer.deserialize(e,!0)}}m.aNf=700;Object(E.a)(m,"DeltaFormatCreator",null,[881])},1596:function(E,M,c){c.d(M,"a",function(){return a});E=
c(0);var m=c(585),e=c(391);class a{constructor(l=!1){this.JM=null;this.N1a=!1;l&&(this.JM=new m.a(new e.a))}}Object(E.a)(a,"OpenCommentInfo",null,[])},1597:function(E,M,c){c.d(M,"b",function(){return v});c.d(M,"a",function(){return A});c.d(M,"c",function(){return w});c.d(M,"d",function(){return G});c.d(M,"e",function(){return F});var m=c(20),e=c(2),a=c(116),l=c(7),y=c(453),z=c(438),n=c(258);const v=()=>m.a.Xt,A=()=>void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1,w=I=>!!I&&I.isConnected,
G=(I,K,J,N)=>{if(!K||!K.isConnected)return I.dispose(),!1;const R=K.Bi(),O=K.ia(a.a.uJ,n.a.yt),L={};L[y.a.nodeId]=K.id.toString();L[y.a.cellId]=R.wm.toString();L[y.a.fileId]=R.rr;L[y.a.Qta]=R.contentReplicator.wt.toString();L[y.a.$O]=R.contentReplicator.$O;L[y.a.xT]=J.toString();L[y.a.lcid]=e.AFrameworkApplication.lcid.toString();L[y.a.accessToken]=e.AFrameworkApplication.accessToken;L[y.a.classId]=K.Pc.toString();L[y.a.uJ]=O;N=N||{};for(const U of z.a(N))L[U]=N[U];for(const U of z.a(L))I.z3b(U,L[U]);
return!0},F=(I,K,J)=>{const N={};N.IsResponseNull=!K;K&&(N.OperationResult=K.StatusCode,N.RevisionListLength=K.RevisionList?K.RevisionList.length.toString():"null");l.ULS.sendTraceTag(36783366,322,50,"UploadResponseReceived: {0}",N);J&&J.isConnected&&(K&&!K.StatusCode?(J.FH().contentReplicator.cF(null,null,null),I.NXo()):I.CLb(null,K?K.StatusCode:14))}},1598:function(E,M,c){var m=this&&this.lE||(Object.create?function(a,l,y,z){void 0===z&&(z=y);Object.defineProperty(a,z,{enumerable:!0,get:function(){return l[y]}})}:
function(a,l,y,z){void 0===z&&(z=y);a[z]=l[y]}),e=this&&this.__exportStar||function(a,l){for(var y in a)"default"===y||Object.prototype.hasOwnProperty.call(l,y)||m(l,a,y)};Object.defineProperty(M,"__esModule",{value:!0});e(c(1810),M);e(c(1811),M);E.exports.DocumentPullQuoteAnnotation||Object.defineProperty(E.exports,"DocumentPullQuoteAnnotation",{enumerable:!0,get:function(){return E.exports.DocumentPullQuoteAnnotation}});E.exports.PullQuoteAnnotation||Object.defineProperty(E.exports,"PullQuoteAnnotation",
{enumerable:!0,get:function(){return E.exports.PullQuoteAnnotation}});E.exports.PullQuotesSignal||Object.defineProperty(E.exports,"PullQuotesSignal",{enumerable:!0,get:function(){return E.exports.PullQuotesSignal}})},1599:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(E.a)(m,"InsightsParameters",null,[])},1603:function(E,M,c){c.d(M,"a",function(){return O});E=c(0);var m=c(22),e=c(887),a=c(56),l=c(5),
y=c(32),z=c(147),n=c(6),v=c(42),A=c(15),w=c(7),G=c(243),F=c(110),I=c(73),K=c(55),J=c(77),N=c(468),R=c(144);class O{constructor(L,U,W,X,V,Z){this.Su=L;this.HWg=U;this.mgd=W;this.sLa=X;this.FBe=V;this.EBe=Z;this.tla=new G.a(()=>this.mSd())}get wk(){return null!=this.dHg?this.dHg:this.dHg=m.a.instance.resolve("WordEditor.ITableEditor")}get Ld(){return null!=this.hIg?this.hIg:this.hIg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=this.NHg?this.NHg:
this.NHg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get W3e(){return this.Su.value}z6a(L,U,W=!0){const X=this.W3e.Shb(U);if(X&&(L=this.HWg(L),X.Fi(L))){const V=this.W3e.$T(U);let Z="Unknown";this.tla.value&&(Z=this.tla.value.nb(L)?L:"CustomStyle");w.ULS.sendTraceTag(39661653,311,50,"{0}",{["ApplyTableStyleId"]:Z,["RowCount"]:this.FBe(U),["ColumnCount"]:this.EBe(U),["HR"]:!!(V&32),["FC"]:!!(V&128),["TR"]:!!(V&64),["LC"]:!!(V&256),["BR"]:!(V&512),["BC"]:!(V&1024),["TableId"]:U.id.toString()});
W&&this.Tia(U);this.Tmg(U,X);W=X.Fi(L);U.properties.setValue(n.a.tableStyle,W.id);this.h7e(U);U.qT.q8(!0)}}h7c(L,U,W){if(L=this.W3e.x8b(W,L))this.Dya(U,W),this.z6a(L,W)}Dya(L,U,W=!0){W&&this.Tia(U);U.properties.setValue(n.a.tableLook,L);w.ULS.sendTraceTag(39661654,311,50,"{0}",{["HR"]:!!(L&32),["FC"]:!!(L&128),["TR"]:!!(L&64),["LC"]:!!(L&256),["BR"]:!(L&512),["BC"]:!(L&1024),["TableId"]:U.id.toString()});U.qT.q8(!0)}Tmg(L,U){(L=this.sLa(L))&&U.Uic(L)}h7e(L){if(L.isConnected){L.hasProperty(v.a.Nv)&&
L.removeProperty(v.a.Nv);this.w5f(L);this.Y3c(L);L=this.mgd(L);for(var U=L.Rb(1);U;){for(U=L.Rb(1);U;)U.hasProperty(A.a.vH)&&U.removeProperty(A.a.vH),U.hasProperty(n.a.Aqa)&&U.removeProperty(n.a.Aqa),this.qSa(U),this.Y3c(U),U=L.xi(1);U=L.xi(1)}}}w5f(L){L.Eg(n.a.Wa,n.a.Xa,n.a.zqa,n.a.ob,n.a.pb,n.a.xqa,n.a.Ua,n.a.Va,n.a.wqa,n.a.qb,n.a.rb,n.a.yqa,n.a.tb,n.a.ub,n.a.Lya,n.a.Lb,n.a.Mb,n.a.Mya)}qSa(L){L.Eg.apply(L,this.wk.W5e)}Y3c(L){L.Eg(n.a.Ca,n.a.za,n.a.Aa,n.a.Ba,n.a.qP,n.a.KR,n.a.XHa,n.a.VHa)}C8b(L){let U=
L.ia(v.a.Hxa,null);if(U)return U;if(L=this.HWg(L))if(U=({value:U}=this.tla.value.Dc(L,U)).returnValue?U:null)return U;return L}Zij(L,U,W,X,V){L.properties.setValue(U.style,W);L.properties.setValue(U.size,X*R.a.t1b);L.properties.setValue(U.color,V)}mSd(){const L=new J.a;L.Z(e.a.F9c,WordEditorIntl.WordEditorStrings.L_TableGrid);L.Z(e.a.a$d,WordEditorIntl.WordEditorStrings.L_PlainTable1);L.Z(e.a.b$d,WordEditorIntl.WordEditorStrings.L_PlainTable2);L.Z(e.a.c$d,WordEditorIntl.WordEditorStrings.L_PlainTable3);
L.Z(e.a.d$d,WordEditorIntl.WordEditorStrings.L_PlainTable4);L.Z(e.a.e$d,WordEditorIntl.WordEditorStrings.L_PlainTable5);L.Z(e.a.eUd,WordEditorIntl.WordEditorStrings.L_TableGridLight);L.Z(e.a.oTd,WordEditorIntl.WordEditorStrings.L_GridTable1Light);L.Z(e.a.iTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel5));L.Z(e.a.jTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel6));L.Z(e.a.kTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,
Box4Intl.Box4Strings.l_ThemeLabel7));L.Z(e.a.lTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel8));L.Z(e.a.mTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel9));L.Z(e.a.nTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel10));L.Z(e.a.vTd,WordEditorIntl.WordEditorStrings.L_GridTable2);L.Z(e.a.pTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel5));
L.Z(e.a.qTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel6));L.Z(e.a.rTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel7));L.Z(e.a.sTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel8));L.Z(e.a.tTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel9));L.Z(e.a.uTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel10));
L.Z(e.a.CTd,WordEditorIntl.WordEditorStrings.L_GridTable3);L.Z(e.a.wTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel5));L.Z(e.a.xTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel6));L.Z(e.a.yTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel7));L.Z(e.a.zTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel8));L.Z(e.a.ATd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,
Box4Intl.Box4Strings.l_ThemeLabel9));L.Z(e.a.BTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel10));L.Z(e.a.JTd,WordEditorIntl.WordEditorStrings.L_GridTable4);L.Z(e.a.DTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel5));L.Z(e.a.ETd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel6));L.Z(e.a.FTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel7));
L.Z(e.a.GTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel8));L.Z(e.a.HTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel9));L.Z(e.a.ITd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel10));L.Z(e.a.QTd,WordEditorIntl.WordEditorStrings.L_GridTable5Dark);L.Z(e.a.KTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel5));L.Z(e.a.LTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,
Box4Intl.Box4Strings.l_ThemeLabel6));L.Z(e.a.MTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel7));L.Z(e.a.NTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel8));L.Z(e.a.OTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel9));L.Z(e.a.PTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel10));L.Z(e.a.XTd,WordEditorIntl.WordEditorStrings.L_GridTable6Colorful);
L.Z(e.a.RTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));L.Z(e.a.STd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));L.Z(e.a.TTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));L.Z(e.a.UTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));L.Z(e.a.VTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,
Box4Intl.Box4Strings.l_ThemeLabel9));L.Z(e.a.WTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));L.Z(e.a.dUd,WordEditorIntl.WordEditorStrings.L_GridTable7Colorful);L.Z(e.a.YTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));L.Z(e.a.ZTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));L.Z(e.a.$Td,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,
Box4Intl.Box4Strings.l_ThemeLabel7));L.Z(e.a.aUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));L.Z(e.a.bUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));L.Z(e.a.cUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));L.Z(e.a.f1d,WordEditorIntl.WordEditorStrings.L_ListTable1Light);L.Z(e.a.$0d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,
Box4Intl.Box4Strings.l_ThemeLabel5));L.Z(e.a.a1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel6));L.Z(e.a.b1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel7));L.Z(e.a.c1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel8));L.Z(e.a.d1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel9));L.Z(e.a.e1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,
Box4Intl.Box4Strings.l_ThemeLabel10));L.Z(e.a.m1d,WordEditorIntl.WordEditorStrings.L_ListTable2);L.Z(e.a.g1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel5));L.Z(e.a.h1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel6));L.Z(e.a.i1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel7));L.Z(e.a.j1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel8));
L.Z(e.a.k1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel9));L.Z(e.a.l1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel10));L.Z(e.a.t1d,WordEditorIntl.WordEditorStrings.L_ListTable3);L.Z(e.a.n1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel5));L.Z(e.a.o1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel6));L.Z(e.a.p1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,
Box4Intl.Box4Strings.l_ThemeLabel7));L.Z(e.a.q1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel8));L.Z(e.a.r1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel9));L.Z(e.a.s1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel10));L.Z(e.a.A1d,WordEditorIntl.WordEditorStrings.L_ListTable4);L.Z(e.a.u1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel5));
L.Z(e.a.v1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel6));L.Z(e.a.w1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel7));L.Z(e.a.x1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel8));L.Z(e.a.y1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel9));L.Z(e.a.z1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel10));
L.Z(e.a.H1d,WordEditorIntl.WordEditorStrings.L_ListTable5Dark);L.Z(e.a.B1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel5));L.Z(e.a.C1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel6));L.Z(e.a.D1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel7));L.Z(e.a.E1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel8));L.Z(e.a.F1d,
this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel9));L.Z(e.a.G1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel10));L.Z(e.a.N1d,WordEditorIntl.WordEditorStrings.L_ListTable6Colorful);L.Z(e.a.Kcc,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));L.Z(e.a.I1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));L.Z(e.a.J1d,
this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));L.Z(e.a.K1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));L.Z(e.a.L1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));L.Z(e.a.M1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));L.Z(e.a.U1d,WordEditorIntl.WordEditorStrings.L_ListTable7Colorful);L.Z(e.a.O1d,
this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));L.Z(e.a.P1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));L.Z(e.a.Q1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));L.Z(e.a.R1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));L.Z(e.a.S1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,
Box4Intl.Box4Strings.l_ThemeLabel9));L.Z(e.a.T1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));return L}Od(L,U){return String.format(WordEditorIntl.WordEditorStrings.L_TableStyleNameWithThemeFormat,L,U)}Tia(L){if(this.Ld.qg){let U=null;if(Object(F.a)(N.a,L)){const W=Object(I.a)(N.a,L);W&&(U=W.AR())}U&&this.lj.Tia(L,U)}}static vuf(){return new O(new G.a(()=>a.StyleReader.HTa),a.StyleReader.kg,l.GraphIterator.$a,Object(K.a)(O.fh,O.fh.Ts,"navigateToPageContentNode"),
y.TableReader.eg,y.TableReader.Yg)}static get fh(){return z.PageNavigator.instance}static get instance(){return null!=O.wCg?O.wCg:O.wCg=O.vuf()}}Object(E.a)(O,"TableStyleEditor",null,[355,356])},1604:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);var m;(function(e){e[e.Unknown=-1]="Unknown";e[e.Z8o=0]="RichText";e[e.D8o=1]="PlainText";e[e.B8o=2]="Picture";e[e.w6o=3]="ComboBox";e[e.d7o=4]="DropDownList";e[e.o6o=5]="BuildingBlockGallery";e[e.Date=6]="Date";e[e.U8o=7]="RepeatSectionItem";e[e.t6o=
8]="CheckBox";e[e.T8o=9]="RepeatSection";e[e.Bibliography=10]="Bibliography";e[e.s9o=11]="TableOfContents";e[e.p8o=12]="NumberOfContentControlKinds"})(m||(m={}));Object(E.b)("ContentControlKind",m)},1605:function(E,M,c){c.d(M,"c",function(){return v});c.d(M,"b",function(){return A});c.d(M,"a",function(){return w});var m=c(2),e=c(39),a=c(587),l=c(62),y=c(61),z=c(276);let n=void 0;const v=(G,F,I)=>{var K=G.characterData.length;if(F>I||I>K)return null;a:{for(J of G.WG)if(K=J.oc,void 0===n&&(n=m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckSelectionViewInUxManager",
!1)),n){if(K.qe&&K===y.InteractiveViewManager.instance.Bd){var J=K;break a}}else if(K.qe){J=K;break a}J=null}if(!J)return null;J=G.Qj(J.ic);if(!J)return null;K=[];G=G.pa;for(let R=G.Ega(F);R<G.length;R++){var N=G.J(R);if(N.cp>I||N.cp===I&&F!==I)break;(N=z.a.Nva(J,N.cp))&&0>Array.indexOf(K,N)&&K.push(N)}return K},A=G=>{let F=null;for(const K of G){var I=e.a.getElementBounds(K);F?(G=F,G.x>I.x&&(G.x=I.x),G.x+G.width<I.x+I.width&&(G.width=I.x+I.width-G.x),G.y>I.y&&(G.y=I.y),G.y+G.height<I.y+I.height&&
(G.height=I.y+I.height-G.y)):F=I}F||(F=new Sys.UI.Bounds(0,0,0,0));return F},w=(G,F)=>{G=A(G);if(!G.width&&!G.height)return null;const I=document.createElement("div");I.id=F;I.style.position="absolute";I.style.left=G.x+"px";I.style.top=G.y+"px";I.style.width=G.width+"px";I.style.height=G.height+"px";I.style.zIndex="-9999";l.d(I,a.a.pzb,"true");return I}},1606:function(E,M,c){var m=this&&this.lE||(Object.create?function(a,l,y,z){void 0===z&&(z=y);Object.defineProperty(a,z,{enumerable:!0,get:function(){return l[y]}})}:
function(a,l,y,z){void 0===z&&(z=y);a[z]=l[y]}),e=this&&this.__exportStar||function(a,l){for(var y in a)"default"===y||Object.prototype.hasOwnProperty.call(l,y)||m(l,a,y)};Object.defineProperty(M,"__esModule",{value:!0});e(c(1833),M);e(c(1834),M);e(c(1835),M);e(c(1836),M);e(c(1837),M);E.exports.SuggestionCategory||Object.defineProperty(E.exports,"SuggestionCategory",{enumerable:!0,get:function(){return E.exports.SuggestionCategory}})},1607:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e){this.source=
e}}Object(E.a)(m,"AcceptAllActionData",null,[])},1609:function(E,M,c){c.d(M,"a",function(){return R});E=c(0);var m=c(701),e=c(28),a=c(9),l=c(17),y=c(23),z=c(8),n=c(12),v=c(743),A=c(540),w=c(237),G=c(73),F=c(74),I=c(110),K=c(1195),J=c(1509),N=c(853);c.n(N);class R{constructor(O,L,U,W,X,V,Z){this.HLa=O;this.ib=L;this.Fm=U;this.qn=W;this.b$a=X;this.j4j=V;this.aUb=Z}ona(O){return(O=this.qn.ona(O))&&Object(G.a)(m.a,O.errorDetails)&&!O.errorDetails.S2a()?O:null}fEa(O){return this.b$a.fEa(O)}Emf(O){if(!O)return null;
if(v.a(O.annotationType)){if((O=O.content)&&O.suggestions&&!R.D0b(O))return O}else if(O.annotationType===A.a.getTypeName()){if((O=O.content)&&O.suggestions)return O}else if(O.annotationType===N.FlagAnnotation.getTypeName()&&(O=O.content)&&O.results)return O;return null}yLd(O,L,U){let W=null,X=null,V=null;var Z=this.Fm.oOc(O,0);if(!Z||!Z.count)return{returnValue:!1,annotation:W,C3i:X,t0e:V};for(const da of Z){if(L&&(da.begin!==O.cpBegin||da.end!==O.cpEnd))continue;Z=this.Emf(da.intent);if(!Z||U&&!U(Z))continue;
let aa;({stop:aa}=R.Zpj(X,Z)).returnValue&&(W=da.intent,X=Z,V=e.a.createTextRange(O.node,da.begin,da.end));if(aa)break}return{returnValue:!!X,annotation:W,C3i:X,t0e:V}}R2h(O,L){let U=null;for(const W of O){if(W.type)continue;O=this.Emf(W.intent);if(!O||L&&!L(O))continue;let X;({stop:X}=R.Zpj(U,O)).returnValue&&(U=O);if(X)break}return U}Ehi(O,L,U,W,X){const V=new F.a;if(W.UVd){var Z=this.Fm.ZOa(O,0,da=>{if(L>da.begin||da.begin>U)return!1;da=this.Emf(da.intent);return!da||R.D0b(da)||W.a3c&&!W.a3c(da)?
!1:!0});for(const da of Z)V.add(da)}if(W.TVd){Z=this.qn.N3(O,da=>{if(L>da.begin||da.begin>U)return!1;da=da.errorDetails;return da.S2a()||W.W1c&&!W.W1c(da)?!1:!0});for(const da of Z)V.add(da)}if(W.SVd){O=this.b$a.fpf(O,da=>L>da.begin||da.begin>U||W.jJc&&!W.jJc(da.BD)?!1:!0);for(const da of O)V.add(da)}V.Sc(X);return V}ipf(O,L){return Math.min(Math.abs(L-O.begin),Math.abs(L-O.end))}V2l(O,L,U,W){let X,V=0;W?(W=0,X=L-1):(W=L+1,X=O.characterData.length);U=this.Ehi(O,W,X,U,(Z,da)=>this.ipf(Z,L)-this.ipf(da,
L));if(!U.count)return{returnValue:null,offset:V};V=L<U.J(0).begin||L>U.J(0).end?this.ipf(U.J(0),L):0;return{returnValue:e.a.createTextRange(O,U.J(0).begin,U.J(0).end),offset:V}}Vrf(O,L,U,W){let X=0;var V=({offset:X}=this.V2l(O,L,U,W)).returnValue;if(V)return{returnValue:V,offset:X};V=this.HLa.$Mh(O,W);if(!V)return{returnValue:null,offset:X};for(X=W?L:O.characterData.length-L;V.zba();){O=V.Ax;L=this.Ehi(O,0,O.characterData.length,U,(Z,da)=>Z.begin===da.begin?Z.end-da.end:Z.begin-da.begin);if(L.count)return U=
W?L.J(L.count-1):L.J(0),X+=W?O.characterData.length-U.end:U.begin,{returnValue:e.a.createTextRange(O,U.begin,U.end),offset:X};X+=O.characterData.length}return{returnValue:null,offset:X}}Urf(O,L,U,W){return this.Vrf(O,L,U,W).returnValue}eJc(O,L,U){let W=0,X=1;this.Urf(O,L,U,!1)&&X++;this.Urf(O,L,U,!0)&&(W++,X++);return{index:W,count:X}}FOl(O,L,U){let W;const X=({offset:W}=this.Vrf(O,L<O.characterData.length?L+1:L,U,!0)).returnValue;if(X&&!W)return X;L=({offset:O}=this.Vrf(O,1<L?L-1:0,U,!1)).returnValue;
return X&&L?W<O?X:L:X?X:L}vgj(O,L){let U=null;a.App.ya&&Object(I.a)(K.PageView,a.App.ya.gb.wc)&&(U=a.App.ya.gb.wc);if(!U)return!1;this.ib.setSelection(l.SelectionEditor.Cj(y.SelectionFactory.ho(O),!0,!1));O=U.Ls.z$l();const W=(O-250)/2;U.Ls.W4(100<W?100-100*W/O:-1,void 0,void 0,X=>{window.setTimeout(()=>{L(X)},0)});return!0}FJb(O,L,U=4,W=!0){const X=()=>{L.Tj.mF||L.hN(new J.a(O,U,!1,W,void 0,!0))};L.Tj.dismiss();this.j4j.select(O.node,O.cpBegin,O.cpBegin);if(!this.aUb.$Id(O.node))return this.vgj(O,
()=>{X()});X();return!0}static D0b(O){if(!O)return!0;if(!O.M_||!O.M_.state)return!1;O=O.M_.state;return 60===O||70===O}static Zpj(O,L){const U=w.a.getTypeNameFor(L)===A.a.getTypeName();return{returnValue:!O||U||v.a(w.a.getTypeNameFor(L))&&O.priority>L.priority,stop:U}}fQf(O,L,U,W,X=4,V=!0){O=this.lQl(O);if(!O)return!1;L=this.JQh(O,L,U,W);return this.FJb(O,L,X,V)}lQl(O){var L=this.ib.hb.kb;for(const U of L)if(z.ParagraphReader.Wb(U.node)&&(L=U.contextId,L===n.a.Tc||L===n.a.Hd||L===n.a.paragraph))return this.FOl(U.node,
L!==n.a.paragraph?U.cpBegin:0,O);return null}JQh(O,L,U,W){return this.oDm(O)?L:this.sHm(O)?W:U}oDm(O){return this.yLd(O,!0,null).returnValue}sHm(O){return!!this.fEa(O)}}Object(E.a)(R,"SuggestionNavigator",null,[])},1610:function(E,M,c){c.d(M,"c",function(){return e});c.d(M,"a",function(){return a});c.d(M,"b",function(){return l});var m=c(25);const e=(y,z,n)=>{if(!m.c(y)&&"#text"!==y.nodeName&&(z?y.setAttribute("unselectable","on"):y.setAttribute("unselectable","off"),n))for(y=y.firstChild;y;)e(y,
z,!0),y=y.nextSibling},a=y=>{y=document.createElement(y);y.setAttribute("unselectable","on");return y},l=(y,z)=>{if(!m.c(y)){var n=y.className;if(m.c(n)||-1===n.indexOf(z))z=n.trim()+" "+z,z=z.trim(),y.className=z}}},1611:function(E,M,c){c.d(M,"a",function(){return v});E=c(0);var m=c(7),e=c(55),a=c(2),l=c(185),y=c(22),z=c(288),n=c(31);class v{constructor(){this.Cea=null;this.Pfh=!0}xme(){try{this.Cea||(this.Cea=y.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"),this.Pfh=!!a.AFrameworkApplication.K&&
a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.EnableOAuthMgrForService",!0))}catch(A){m.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+A)}}Suf(A,w,G){return this.Cea?this.Cea.getToken(A,w,G):new Promise(F=>{y.a.instance.Sa("Common.App.SearchCommon.ISearchOAuthManager").execute(I=>{I?(this.Cea=I,this.Cea.getToken(A,w,G).then(K=>F(K))):F(null)})})}K0l(){this.xme();return this.Cea?this.Cea.getToken("Search",a.AFrameworkApplication.dLf,
!1):null}Agi(){if("Dev Box"===a.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(A=>{window.setTimeout(()=>{A(window.TellMeSubstrateTokenOverride)},750)});this.xme();return this.Cea?this.Cea.getToken("Search",a.AFrameworkApplication.Jgg,!0):null}Sdm(){this.xme();return this.Cea?this.Cea.getToken("Search",this.Pdm(),this.Pfh):null}Pdm(){return a.AFrameworkApplication.K.jb("TellMeServiceAuthEndpointForSearch")}Xam(){if("Dev Box"===
a.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(A=>{window.setTimeout(()=>{A(window.TellMeSubstrateTokenOverride)},750)});this.xme();return this.Cea?this.Cea.getToken("SmartLookup",this.Uam()):null}Uam(){return a.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint")}L0l(){return Object(e.a)(this,this.K0l,"getLokiTokenPromise")}ncm(){return Object(e.a)(this,this.Agi,
"getSubstrateTokenPromise")}zOb(){return!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Nb.zOb}Fem(){const A={};this.zOb()&&(A.Loki=this.L0l(),A.Substrate=this.ncm());return A}UXc(A){l.a.rHa(Object.assign(new z.a,{name:"Events",dataFields:[Object.assign(new n.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new n.a,{name:"Status",bool:A})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}NZm(){return a.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>
{this.UXc(!1);return!1}).then(()=>{this.UXc(!0);return!0}):new Promise((A,w)=>{const G=y.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Kz;G?G.loadScript("tellme-strings").then(()=>{this.UXc(!0);A(!0)}).catch(()=>{this.UXc(!1);w(!1)}):(this.UXc(!1),w(!1))})}static RPm(){return!!a.AFrameworkApplication.ta&&(a.AFrameworkApplication.ta.Nb.UVc||a.AFrameworkApplication.ta.Nb.rbc)}static $Zd(){return!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Nb.rbc}}Object(E.a)(v,"ReactSharedHeaderSearchUtils",
null,[])},1613:function(E,M,c){c.r(M);c.d(M,"validateCpDataV1",function(){return e});c.d(M,"isEqual",function(){return a});c.d(M,"isSupportedCpVersion",function(){return l});c.d(M,"validateVersionedCpData",function(){return z});c.d(M,"versionedDeserialize",function(){return n});var m=c(1581);const e=v=>"number"!==typeof v.CP||null!=v.FB&&"number"!==typeof v.FB||null!=v.FE&&"number"!==typeof v.FE||null!=v.HB&&"number"!==typeof v.HB||null!=v.HE&&"number"!==typeof v.HE||null!=v.CB&&"number"!==typeof v.CB||
null!=v.CE&&"number"!==typeof v.CE||null!=v.R&&"number"!==typeof v.R||null!=v.E&&"number"!==typeof v.E||null!=v.TW&&"number"!==typeof v.TW||null!=v.PB&&"number"!==typeof v.PB||null!=v.SYM&&"number"!==typeof v.SYM||null!=v.IE&&"number"!==typeof v.IE||null!=v.OO&&"number"!==typeof v.OO||null!=v.AX&&"number"!==typeof v.AX||null!=v.CCI&&"number"!==typeof v.CCI||null!=v.DD&&"number"!==typeof v.DD?!1:!0,a=(v,A)=>v||A?v&&A&&v.CP===A.CP&&v.FB===A.FB&&v.FE===A.FE&&v.HB===A.HB&&v.HE===A.HE&&v.CB===A.CB&&v.CE===
A.CE&&v.R===A.R&&v.E===A.E&&v.TW===A.TW&&v.PB===A.PB&&v.SYM===A.SYM&&v.IE===A.IE&&v.OO===A.OO&&v.AX===A.AX&&v.CCI===A.CCI&&v.DD===A.DD?!0:!1:!0,l=v=>1===v,y=v=>{let A=v,w=0;"number"===typeof A.VS&&(w=A.VS);if("number"===typeof A.VS||"number"===typeof A.CP)return{returnValue:A,fog:w};A=null;for(let G=0;G<v.length;G++){const F=v[G];1===F.VS&&F.VS>w&&(w=F.VS,A=v[G])}return{returnValue:A,fog:w}},z=v=>{const A=({fog:v}=y(v)).returnValue;if(!A)return!1;switch(v){case 0:case 1:return e(A);default:return!1}},
n=v=>{if(!v)return null;const A=({fog:v}=y(v)).returnValue;if(!A)return null;switch(v){case 0:case 1:return m.b(A);default:return null}}},1626:function(E,M,c){c.d(M,"a",function(){return a});E=c(0);var m=c(92),e=c(1512);class a{constructor(l){this.taskManager=l}kgb(l,y){const {priority:z=2,delay:n=0}=null!==y&&void 0!==y?y:{},v=new e.a,A=async()=>await l();y=new m.a(z,1,n,()=>{A().then(v.resolve).catch(v.reject)});this.taskManager.Vb(y);return v.completion}}Object(E.a)(a,"TaskDispatcher",null,[])},
1627:function(E,M,c){c.d(M,"a",function(){return l});E=c(0);var m=c(136),e=c(2),a=c(7);class l{constructor(y,z){this.nQ=y;this.bIa=z}JR(y,z,n){y={["appId"]:2155,["manifestType"]:"Fps",["submitTime"]:(new Date).toISOString(),["source"]:"Client",["type"]:"Survey",["clientFeedbackId"]:m.a.create().toString(),["email"]:z,["application"]:{["appData"]:"{}",["extendedManifestData"]:JSON.stringify({["surveySpecificData"]:JSON.stringify(n)})},["survey"]:{["surveyId"]:y},["telemetry"]:this.Nzb(),["web"]:this.bFc()};
this.RGa(JSON.stringify(y),{["Content-Type"]:"application/json"})}Nzb(){const y=e.AFrameworkApplication.sessionStartInfoSettings;return{["officeBuild"]:e.AFrameworkApplication.buildVersion,["featureArea"]:"EditorAi",["audienceGroup"]:y.AudienceGroup,["osBuild"]:y.OsVersion,["platform"]:y.Platform,["processSessionId"]:y.WACSessionID,["flights"]:e.AFrameworkApplication.K.jb("FlightId"),["loggableUserId"]:e.AFrameworkApplication.K.jb("LoggableUserId"),["tenantId"]:e.AFrameworkApplication.K.jb("TenantId")}}RGa(y,
z,n=0){3<n||this.bIa.kgb(()=>{this.nQ.sj("https://petrol.office.microsoft.com/v1/feedback",2,y,z,!1,2,()=>{a.ULS.sendTraceTag(509207132,3041,50,"Success sending OCV feedback for EditorAi")},()=>{this.RGa(y,z,n+1);a.ULS.sendTraceTag(509207131,3041,50,"Failure sending OCV feedback for EditorAi, attempt {0}",n)},null)},{delay:this.rSl(n)})}rSl(y=0){let z=0;1===y?z=200:1<y&&(z=200+500*(y-1));return z}bFc(){const y=e.AFrameworkApplication.sessionStartInfoSettings;return{["browser"]:y.Browser,["browserVersion"]:y.BrowserVersion,
["dataCenter"]:y.WACDatacenter}}}Object(E.a)(l,"EditorAiSurveysApiClient",null,[])},1628:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);class m{constructor(a){this.selectedRating=a}}Object(E.a)(m,"EditorAiRatingData",null,[]);class e{constructor(a,l,y){this.rating=[new m(a)];this.comment=[l,...y]}}Object(E.a)(e,"EditorAiSurveyData",null,[])},1629:function(E,M,c){E=c(0);var m=c(741),e=c(19),a=c(171),l=c(79),y=c(2),z=c(22),n=c(7),v=c(1435),A=c(12),w=c(101),G=c(28),F=c(3),I=c(1050),K=c(132),
J=c(17),N=c(23),R=c(121),O=c(8);class L{static get Cvh(){L.Koc||(L.Koc=[],L.edc(m.a.og("ar-sa")),L.edc(m.a.og("de-de")),L.edc(m.a.og("es-es")),L.k0(m.a.og("en-029"),m.a.og("en-us")),L.k0(m.a.og("en-au"),m.a.og("en-us")),L.k0(m.a.og("en-bz"),m.a.og("en-us")),L.k0(m.a.og("en-ca"),m.a.og("en-us")),L.k0(m.a.og("en-gb"),m.a.og("en-us")),L.k0(m.a.og("en-id"),m.a.og("en-us")),L.k0(m.a.og("en-my"),m.a.og("en-us")),L.k0(m.a.og("en-ph"),m.a.og("en-us")),L.k0(m.a.og("zh-tw"),m.a.og("en-us")),L.edc(m.a.og("fr-fr")),
L.k0(m.a.og("hr-ba"),m.a.og("hr-hr")),L.k0(m.a.og("it-ch"),m.a.og("it-it")),L.k0(m.a.og("nb-no"),m.a.og("nn-no")),L.edc(m.a.og("nl-nl")),L.k0(m.a.og("ro-md"),m.a.og("ro-ro")),L.k0(m.a.og("ru-md"),m.a.og("ru-ru")),L.k0(m.a.og("sr-latn-ba"),m.a.og("sr-latn-cs")),L.k0(m.a.og("sr-latn-me"),m.a.og("sr-latn-cs")),L.k0(m.a.og("sr-latn-rs"),m.a.og("sr-latn-cs")),L.edc(m.a.og("sr-cyrl-cs")),L.k0(m.a.og("sv-fi"),m.a.og("sv-se")));return L.Koc}static edc(Pa){L.Koc[Pa.languageId]=Pa.LCID}static k0(Pa,Ab){L.Koc[Pa.LCID]=
Ab.LCID}static Y7h(Pa){var Ab=m.a.og(Pa);if(!Ab)return 0;Ab=L.Cvh[Ab.LCID]||L.Cvh[Ab.languageId]||0;return Ab===Pa?0:Ab}}L.Koc=null;Object(E.a)(L,"AutoCorrectListFallback",null,[]);var U=c(354),W=c(83),X=c(145),V=c(116),Z=c(6),da=c(15),aa=c(5),ea=c(91),na=c(374),pa=c(36),ja=c(59),ma=c(93),Ia=c(43),Ja=c(1515);class Ka extends Ja.a{constructor(Pa,Ab,nb,Rb,Mb,oc){super(Pa,Ab,nb,Rb,oc);this.mY=Mb}get QC(){return!0}get commandId(){return F.a.jHk}set QC(Pa){super.QC=Pa}}Object(E.a)(Ka,"ARegexCorrectAction",
Ja.a,[]);class Ma extends Ka{static get Nkb(){if(null!=Ma.mDg)var Pa=Ma.mDg;else(Pa=z.a.instance.Na("Box4.List.IListCommands"))||n.ULS.sendTraceTag(512357316,393,50,"IListCommands was tried to be resolved before it was registered."),Pa=Ma.mDg=Pa;return Pa}static get Un(){return null!=Ma.qDg?Ma.qDg:Ma.qDg=z.a.instance.resolve("Box4.List.IListEditor")}static get Gd(){return null!=Ma.HDg?Ma.HDg:Ma.HDg=z.a.instance.resolve("Box4.List.IListReader")}get levelText(){const [Pa,Ab]=this.mY;return Ab?Pa.replace(Ab,
"%1"):Pa}}Object(E.a)(Ma,"AListAutoCorrectAction",Ka,[]);var sa=c(140);class xa extends Ma{get commandId(){return F.a.bHk}Ima(Pa){if(xa.Nkb){var Ab=aa.GraphIterator.$a(Pa);Ab.yd();pa.OutlineElementNavigator.Vd(Ab);if(xa.Un.whe(Ab,this.mY[0])){var nb=xa.Gd.hw(Ab),Rb=this.mY[0],Mb=e.a.charAt(Rb,0),oc=this.b1l(Mb),xb=na.a.uT(1,oc.listStyle);nb&&xb.bxf(nb)||(nb=new Ia.GraphTransaction(15),nb.hu(Ab),this.Kd.replaceTextRange(G.a.createTextRange(Pa,this.EG,this.l0+1),"",!0,!1),xa.Un.Who(xb),Pa=new U.DictionaryPropertySet,
Pa.setValue(X.a.tlf,!0),Mb&&(xb.kQ=Mb,Pa.setValue(V.a.kQ,xb.kQ)),Pa.setValue(Z.a.au,oc.levelText),Pa.setValue(da.a.font,oc.fontName),"-"===Mb&&W.Health.instance.recordKpiUsage("DashBulletAutoCreate",0,xa.qB,null),sa.a.bY&&(Pa.setValue(V.a.Ooa,"autocorrect"),Pa.setValue(V.a.vha,Rb)),xa.Nkb.fOk(xb.listType,xb.listStyle,Pa),nb.dispose())}}}b1l(Pa){const Ab={listStyle:0,levelText:ea.a.JHd,fontName:ea.a.LIc};switch(Pa){case "*":return{...Ab,listStyle:1};case "-":return{...Ab,levelText:"-",fontName:ma.a.kG};
default:return Ab}}static gG(Pa,Ab,nb,Rb,Mb){return new xa(null,Pa,Ab,nb,Rb,Mb)}static vT(Pa,Ab,nb,Rb,Mb){return new xa(Pa,ja.a(Pa).Bb,Ab,nb,Rb,Mb)}}xa.qB="wwaengidc";xa.L3f=["[\\*](?![\\*])","[\\-](?![\\-])"];Object(E.a)(xa,"BulletListAction",Ma,[]);var ia=c(77);class ha extends Ka{constructor(Pa,Ab,nb,Rb,Mb,oc){super(Pa,Ab,nb,Rb,Mb,oc);this.Vuc=!1;this.QC=!Pa;ha.gp=new ia.a}get QC(){return this.Vuc}set QC(Pa){this.Vuc=Pa}WBb(Pa){this.D6e(Pa.innerText,(Ab,nb,Rb)=>{Pa.innerText=e.a.substring(Pa.innerText,
0,Ab)+Rb+e.a.right(Pa.innerText,nb)})}Ima(Pa){this.D6e(O.ParagraphReader.text(Pa).substring(this.EG,this.l0),(Ab,nb,Rb)=>{this.Kd.replaceTextRange(G.a.createTextRange(Pa,this.EG+Ab,this.EG+nb),Rb,!0,!1)})}D6e(Pa,Ab){if(!(2>this.mY.length)&&this.mY[1]){var nb=this.mY[1];ha.gp.count||this.Z0i();ha.gp.nb(nb)&&(Pa=Pa.lastIndexOf(nb),-1!==Pa&&Ab(Pa,Pa+nb.length,ha.gp.J(nb)))}}}Object(E.a)(ha,"ADictionarySequenceReplacerAction",Ka,[]);class ua extends ha{get commandId(){return F.a.p2e}Z0i(){ha.gp.Z("--",
"\u2014");ha.gp.Z(" -- "," \u2013 ");ha.gp.Z(" - "," \u2013 ");ha.gp.Z("-- ","\u2014");ha.gp.Z(" --"," \u2013");ha.gp.Z(" -"," \u2013")}static gG(Pa,Ab,nb,Rb,Mb){return new ua(null,Pa,Ab,nb,Rb,Mb)}static vT(Pa,Ab,nb,Rb,Mb){return new ua(Pa,ja.a(Pa).Bb,Ab,nb,Rb,Mb)}}Object(E.a)(ua,"DashAction",ha,[]);class ya extends ha{constructor(Pa,Ab,nb,Rb,Mb,oc,xb){super(Pa,Ab,nb,Rb,Mb,oc);this.ga=xb}get commandId(){return F.a.cHk}Z0i(){ha.gp.Z(":)","\ud83d\ude0a");ha.gp.Z(":-)","\ud83d\ude0a");ha.gp.Z(":|","\ud83d\ude10");
ha.gp.Z(":-|","\ud83d\ude10");ha.gp.Z(":(","\ud83d\ude41");ha.gp.Z(":-(","\ud83d\ude41");ha.gp.Z(";)","\ud83d\ude09");ha.gp.Z(";-)","\ud83d\ude09");ha.gp.Z(":D","\ud83d\ude00");ha.gp.Z(":-D","\ud83d\ude00");ha.gp.Z(":')","\ud83d\ude02");ha.gp.Z("=D","\ud83d\ude03");ha.gp.Z(":>","\ud83d\ude06");ha.gp.Z(":->","\ud83d\ude06");ha.gp.Z(":3","\ud83d\ude0a");ha.gp.Z(":-3","\ud83d\ude0a");ha.gp.Z("B-)","\ud83d\ude0e");ha.gp.Z("*-*","\ud83d\ude0d");ha.gp.Z(":*","\ud83d\ude19");ha.gp.Z(":-*","\ud83d\ude19");
ha.gp.Z(":X","\ud83d\ude36");ha.gp.Z(":-X","\ud83d\ude36");ha.gp.Z(":O","\ud83d\ude2e");ha.gp.Z(":-O","\ud83d\ude2e");ha.gp.Z(":#","\ud83e\udd10");ha.gp.Z(":-#","\ud83e\udd10");ha.gp.Z(":P","\ud83d\ude1b");ha.gp.Z(":-P","\ud83d\ude1b");ha.gp.Z(";P","\ud83d\ude1c");ha.gp.Z(";-P","\ud83d\ude1c");ha.gp.Z(":-/","\ud83d\ude15");ha.gp.Z("$-$","\ud83e\udd11");ha.gp.Z(":S","\ud83d\ude16");ha.gp.Z(":-S","\ud83d\ude16");ha.gp.Z(":[","\ud83d\ude1f");ha.gp.Z(":-[","\ud83d\ude1f");ha.gp.Z(":\u2019(","\ud83d\ude22");
ha.gp.Z(":'(","\ud83d\ude22");ha.gp.Z("@-@","\ud83d\ude31")}Ima(Pa){this.D6e(O.ParagraphReader.text(Pa).substring(this.EG,this.l0),(Ab,nb,Rb)=>{Ab=G.a.createTextRange(Pa,this.EG+Ab,this.EG+nb);nb={};nb.MenuItemId=Rb;this.ga.Nf(Ab,F.a.Tib,2,!1,null,nb,null)})}static gG(Pa,Ab,nb,Rb,Mb,oc){return new ya(null,Pa,Ab,nb,Rb,Mb,oc)}static vT(Pa,Ab,nb,Rb,Mb,oc){return new ya(Pa,ja.a(Pa).Bb,Ab,nb,Rb,Mb,oc)}}Object(E.a)(ya,"EmojiAction",ha,[]);class ra{constructor(Pa,Ab,nb,Rb){this.mS=Pa;this.Pwd=Ab;this.Cvc=
Rb;this.MF=nb}bzi(){if(!this.MF)return!1;this.mS=this.mS.trimStart();return this.mS===this.MF?!0:!1}GTm(){if(!this.mS)return!1;const Pa=this.mS.lastIndexOf(" ");return-1!==Pa&&"."===this.mS.charAt(Pa-1)&&"."===this.mS.charAt(Pa-3)?!0:!1}FTm(){if(!this.mS)return!1;var Pa=this.mS.lastIndexOf(" ");return-1!==Pa&&(Pa=this.mS.substring(0,Pa-1).lastIndexOf(" "),"."===this.mS.charAt(Pa+2))?!0:!1}$Mm(){return this.bzi()&&(1===this.MF.length&&"."===this.Pwd||"."===this.mS.charAt(1))?!0:!1}aNm(){return this.MF?
0<="\\/".indexOf(this.Pwd)||3===this.MF.length&&0<="\\/".indexOf(this.MF.charAt(1))?!0:!1:!1}VLm(){return this.MF?0<=this.MF.indexOf("@")?!0:!1:!1}BB(){if(!this.MF)return!1;for(const Pa of ra.Evf())if(e.a.startsWith(this.MF+this.Pwd,Pa))return!0;return!1}CLm(){return this.MF?"i"===this.MF&&0<=ra.quotes.indexOf(this.Pwd)?!0:!1:!1}PFm(){if(!this.mS)return!1;const Pa=e.a.z3a(this.mS,this.mS.length-1);if(-1!==Pa&&this.mS.substring(Pa+1,this.mS.length)===this.MF){const Ab=this.mS.charAt(Pa-1);if(0<=ra.q$f.indexOf(Ab)||
0<=ra.quotes.indexOf(Ab)&&0<=ra.q$f.indexOf(this.mS.charAt(Pa-2)))return!0}return!1}WTk(){return!this.mS||this.GTm()||this.$Mm()||this.aNm()||this.FTm()||this.VLm()||this.BB()?!1:this.bzi()||this.CLm()||this.PFm()?!0:!1}static Evf(){return ra.z4g||(ra.z4g="http: https: ftp:// mailto: \\\\ www.".split(" "))}}ra.q$f=".!?";ra.quotes="'\"";ra.z4g=null;Object(E.a)(ra,"FirstLetterUpperCaseRules",null,[]);class La{constructor(Pa){this.MF=Pa}LGl(){if(!this.MF)return null;for(let Pa=0;Pa<La.mji().length;Pa++)if(this.MF===
La.mji()[Pa])return La.kim()[Pa];return null}static mji(){return La.PVg||(La.PVg=["1/2","1/4","3/4"])}static kim(){return La.OVg||(La.OVg=["\u00bd","\u00bc","\u00be"])}}La.PVg=null;La.OVg=null;Object(E.a)(La,"FractionsCollection",null,[]);class oa extends Ja.a{constructor(Pa,Ab,nb,Rb,Mb,oc){super(Pa,Ab,nb,Rb,oc);this.oJh=Mb}get QC(){return!0}get commandId(){return F.a.dHk}WBb(Pa){Pa.innerText=e.a.substring(Pa.innerText,0,this.EG)+this.oJh+e.a.right(Pa.innerText,this.l0)}Ima(Pa){this.Kd.replaceTextRange(G.a.createTextRange(Pa,
this.EG,this.l0),this.oJh,!0,!1)}set QC(Pa){super.QC=Pa}static gG(Pa,Ab,nb,Rb,Mb){return new oa(null,Pa,Ab,nb,Rb,Mb)}}Object(E.a)(oa,"FractionsReplaceCorrectAction",Ja.a,[]);class Ca extends Ma{get commandId(){return F.a.fHk}Ima(Pa){if(Ca.Nkb){var Ab=aa.GraphIterator.$a(Pa);Ab.yd();pa.OutlineElementNavigator.Vd(Ab);if(Ca.Un.whe(Ab,this.mY[0])){var [nb,Rb]=this.mY,Mb=Ca.Ygn(Rb),oc=e.a.Hbc(Rb)?4:2,xb=G.a.createTextRange(Pa,this.EG,this.l0+1);Ca.Un.f1b(Pa,Ab,oc,Mb,xb,nb,this.levelText,Ca.Nkb)}}}static gG(Pa,
Ab,nb,Rb,Mb){return new Ca(null,Pa,Ab,nb,Rb,Mb)}static vT(Pa,Ab,nb,Rb,Mb){return new Ca(Pa,ja.a(Pa).Bb,Ab,nb,Rb,Mb)}static Ygn(Pa){if(!Pa)return 0;Pa=e.a.Tg(Pa);if(!e.a.oXd(Pa.charAt(0)))return 0;const Ab=Pa.charCodeAt(0)-97+1;let nb;for(nb=1;nb<Pa.length&&Pa.charAt(nb)===Pa.charAt(0);nb++);return 26*(nb-1)+Ab}}Object(E.a)(Ca,"LetterListAction",Ma,[]);var Aa=c(120);class db extends Ma{get commandId(){return F.a.f1b}Ima(Pa){if(db.Nkb){var Ab=aa.GraphIterator.$a(Pa);Ab.yd();pa.OutlineElementNavigator.Vd(Ab);
if(db.Un.whe(Ab,this.mY[0])){var [nb,Rb]=this.mY,Mb=parseInt(Rb);if(!(99999999<=Mb)){var oc=G.a.createTextRange(Pa,this.EG,this.l0+1);Aa.a.X_d()&&Aa.a.ikm();db.Un.f1b(Pa,Ab,1,Mb,oc,nb,this.levelText,db.Nkb)}}}}static gG(Pa,Ab,nb,Rb,Mb){return new db(null,Pa,Ab,nb,Rb,Mb)}static vT(Pa,Ab,nb,Rb,Mb){return new db(Pa,ja.a(Pa).Bb,Ab,nb,Rb,Mb)}}Object(E.a)(db,"NumberListAction",Ma,[]);class eb extends Ja.a{get QC(){return!0}get commandId(){return F.a.hHk}WBb(){}Ima(Pa){const Ab=G.a.createTextRange(Pa,this.l0-
2,this.l0),nb=new Ia.GraphTransaction(15);nb.Cb(Pa);let Rb=!1,Mb=null,oc=0;for(;oc<Pa.pa.length;){var xb=Pa.pa.J(oc),cc=xb.G8;const Ob=xb.pU;if(xb.cp>=Ab.cpBegin){xb.cp>Ab.cpBegin||!xb.formatting?Mb=Rb?xb.formatting:this.Kd.LY(Pa,oc,Ab.cpBegin,Mb):(Mb=xb.formatting,Ob&&(Rb=!1),cc&&(Rb=!0));oc++;break}xb.formatting&&(Mb=xb.formatting);Ob&&(Rb=!1);cc&&(Rb=!0);oc++}for(;oc<Pa.pa.length;){cc=Pa.pa.J(oc);if(cc.cp>=Ab.cpEnd){if(cc.cp>Ab.cpEnd||!cc.formatting&&!cc.Sh)Rb||this.Kd.LY(Pa,oc,Ab.cpEnd,Mb);Rb||
eb.pp.iqa(Mb,!0);break}cc.formatting&&(Rb||eb.pp.iqa(Mb,!0),Mb=cc.formatting);xb=cc.G8;cc=cc.pU;xb&&(Rb=!0);!xb&&cc&&(Rb=!1);oc++}nb.dispose()}set QC(Pa){super.QC=Pa}static get pp(){return null!=eb.Lzg?eb.Lzg:eb.Lzg=z.a.instance.resolve("Box4.IFormattingEditor")}static gG(Pa,Ab,nb,Rb){return new eb(null,Pa,Ab,nb,Rb)}}Object(E.a)(eb,"OrdinalsReplaceCorrectAction",Ja.a,[]);var ib=c(103),lb=c(209),Ya;(function(Pa){Pa[Pa.rand=0]="rand";Pa[Pa.randOld=1]="randOld";Pa[Pa.lorem=2]="lorem"})(Ya||(Ya={}));
Object(E.b)("RandTextType",Ya);class Fa extends Ka{constructor(Pa,Ab,nb,Rb,Mb,oc){super(Pa,Ab,nb,Rb,Mb,oc);Fa.xOe||Fa.HAo()}static LMm(){var Pa;return null===(Pa=y.AFrameworkApplication.K)||void 0===Pa?void 0:Pa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isNoRandDoubleSpaceEnabled",!0)}get commandId(){return F.a.iHk}Ima(Pa){if(!(Pa.Qs||sa.a.getInstance().Yt&&(sa.a.getInstance().Wzi?ib.ListItemReader.isListItem(Pa):lb.a.noa(Pa)))){var Ab=this.S$a.Qa.node===Pa,nb=5,Rb=3;if(this.mY[0].startsWith("=rand.old")){var Mb=
Ya.randOld;nb=3}else if(this.mY[0].startsWith("=rand"))Mb=Ya.rand;else if(this.mY[0].startsWith("=lorem"))Mb=Ya.lorem;else return;this.mY[1]&&(nb=parseInt(this.mY[1]));this.mY[2]&&(Rb=parseInt(this.mY[2]));if(!(20<Rb||100<nb)){Pa.FH().jF.p7(7);var oc=aa.GraphIterator.$a(Pa);oc.yd();pa.OutlineElementNavigator.Vd(oc);Fa.lg.yB(oc,!1,!1);Fa.lg.OI(oc);var xb=!1;switch(Mb){case Ya.rand:Mb=Fa.xOe;break;case Ya.randOld:Mb=Fa.sbh;break;case Ya.lorem:Mb=Fa.t5g;xb=!0;break;default:return}var cc=0;for(let Ub=
0;Ub<nb;++Ub){const pb=[];for(var Ob=0;Ob<Rb;Ob++)pb.push(Mb[cc++%Mb.length]);Ob=G.a.Rc(oc.currentNode,0);if(xb){const Zb=w.FormattingReader.Kr(Ob);Fa.pp.Wl(Zb,Z.a.noProof,!0)}this.Kd.replaceTextRange(Ob,pb.join(Fa.LMm()?"":" "),!0,!1);Ub<nb-1&&(pa.OutlineElementNavigator.Vd(oc),Fa.lg.yB(oc,!1,!1),Fa.lg.OI(oc))}nb=oc.currentNode;oc=aa.GraphIterator.$a(Pa);oc.yd();pa.OutlineElementNavigator.Vd(oc);oc.wg();Ab&&(this.S$a=N.SelectionFactory.te(nb,O.ParagraphReader.textLength(nb)))}}}static get lg(){return null!=
Fa.nEg?Fa.nEg:Fa.nEg=z.a.instance.resolve("Box4.IOutlineElementEditor")}static get pp(){return null!=Fa.Pzg?Fa.Pzg:Fa.Pzg=z.a.instance.resolve("Box4.IFormattingEditor")}static HAo(){Fa.xOe="Video provides a powerful way to help you prove your point. ;When you click Online Video, you can paste in the embed code for the video you want to add. ;You can also type a keyword to search online for the video that best fits your document. ;To make your document look professionally produced, Word provides header, footer, cover page, and text box designs that complement each other. ;For example, you can add a matching cover page, header, and sidebar. ;Click Insert and then choose the elements you want from the different galleries. ;Themes and styles also help keep your document coordinated. ;When you click Design and choose a new Theme, the pictures, charts, and SmartArt graphics change to match your new theme. ;When you apply styles, your headings change to match the new theme. ;Save time in Word with new buttons that show up where you need them. ;To change the way a picture fits in your document, click it and a button for layout options appears next to it. ;When you work on a table, click where you want to add a row or a column, and then click the plus sign. ;Reading is easier, too, in the new Reading view. ;You can collapse parts of the document and focus on the text you want. ;If you need to stop reading before you reach the end, Word remembers where you left off - even on another device. ".split(";");
Fa.sbh=["The quick brown fox jumps over the lazy dog. "];Fa.t5g="Lorem ipsum dolor sit amet, consectetuer adipiscing elit. ;Maecenas porttitor congue massa. ;Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna. ;Nunc viverra imperdiet enim. ;Fusce est. ;Vivamus a tellus. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin pharetra nonummy pede. ;Mauris et orci. ;Aenean nec lorem. ;In porttitor. ;Donec laoreet nonummy augue. ;Suspendisse dui purus, scelerisque at, vulputate vitae, pretium mattis, nunc. ;Mauris eget neque at sem venenatis eleifend. ;Ut nonummy. ;Fusce aliquet pede non pede. ;Suspendisse dapibus lorem pellentesque magna. ;Integer nulla. ;Donec blandit feugiat ligula. ;Donec hendrerit, felis et imperdiet euismod, purus ipsum pretium metus, in lacinia nulla nisl eget sapien. ;Donec ut est in lectus consequat consequat. ;Etiam eget dui. ;Aliquam erat volutpat. ;Sed at lorem in nunc porta tristique. ;Proin nec augue. ;Quisque aliquam tempor magna. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Nunc ac magna. ;Maecenas odio dolor, vulputate vel, auctor ac, accumsan id, felis. ;Pellentesque cursus sagittis felis. ;Pellentesque porttitor, velit lacinia egestas auctor, diam eros tempus arcu, nec vulputate augue magna vel risus. ;Cras non magna vel ante adipiscing rhoncus. ;Vivamus a mi. ;Morbi neque. ;Aliquam erat volutpat. ;Integer ultrices lobortis eros. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin semper, ante vitae sollicitudin posuere, metus quam iaculis nibh, vitae scelerisque nunc massa eget pede. ;Sed velit urna, interdum vel, ultricies vel, faucibus at, quam. ;Donec elit est, consectetuer eget, consequat quis, tempus quis, wisi. ;In in nunc. ;Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos. ;Donec ullamcorper fringilla eros. ;Fusce in sapien eu purus dapibus commodo. ;Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. ;Cras faucibus condimentum odio. ;Sed ac ligula. ;Aliquam at eros. ;Etiam at ligula et tellus ullamcorper ultrices. ;In fermentum, lorem non cursus porttitor, diam urna accumsan lacus, sed interdum wisi nibh nec nisl. ;Ut tincidunt volutpat urna. ;Mauris eleifend nulla eget mauris. ;Sed cursus quam id felis. ;Curabitur posuere quam vel nibh. ;Cras dapibus dapibus nisl. ;Vestibulum quis dolor a felis congue vehicula. ;Maecenas pede purus, tristique ac, tempus eget, egestas quis, mauris. ;Curabitur non eros. ;Nullam hendrerit bibendum justo. ;Fusce iaculis, est quis lacinia pretium, pede metus molestie lacus, at gravida wisi ante at libero. ;Quisque ornare placerat risus. ;Ut molestie magna at mi. ;Integer aliquet mauris et nibh. ;Ut mattis ligula posuere velit. ;Nunc sagittis. ;Curabitur varius fringilla nisl. ;Duis pretium mi euismod erat. ;Maecenas id augue. ;Nam vulputate. ;Duis a quam non neque lobortis malesuada. ;Praesent euismod. ;Donec nulla augue, venenatis scelerisque, dapibus a, consequat at, leo. ;Pellentesque libero lectus, tristique ac, consectetuer sit amet, imperdiet ut, justo. ;Sed aliquam odio vitae tortor. ;Proin hendrerit tempus arcu. ;In hac habitasse platea dictumst. ;Suspendisse potenti. ;Vivamus vitae massa adipiscing est lacinia sodales. ;Donec metus massa, mollis vel, tempus placerat, vestibulum condimentum, ligula. ;Nunc lacus metus, posuere eget, lacinia eu, varius quis, libero. ;Aliquam nonummy adipiscing augue. ".split(";")}static gG(Pa,
Ab,nb,Rb,Mb){return new Fa(null,Pa,Ab,nb,Rb,Mb)}static vT(Pa,Ab,nb,Rb,Mb){return new Fa(Pa,ja.a(Pa).Bb,Ab,nb,Rb,Mb)}}Fa.xOe=null;Fa.sbh=null;Fa.t5g=null;Object(E.a)(Fa,"RandAction",Ka,[]);class $a{constructor(Pa,Ab,nb,Rb){this.pattern=Rb&8?new RegExp(Pa,"i"):new RegExp(Pa);this.nsm=Ab;this.ajm=nb;this.flags=Rb}}Object(E.a)($a,"RegexAutoCorrectEntry",null,[]);class Db extends Ma{get commandId(){return F.a.kHk}Ima(Pa){if(Db.Nkb){var Ab=aa.GraphIterator.$a(Pa);Ab.yd();pa.OutlineElementNavigator.Vd(Ab);
if(Db.Un.whe(Ab,this.mY[0])){var [nb,Rb]=this.mY,Mb=Db.Zgn(Rb);if(!(0>=Mb)){var oc=e.a.Hbc(Rb.charAt(0))?5:3,xb=G.a.createTextRange(Pa,this.EG,this.l0+1);Db.Un.f1b(Pa,Ab,oc,Mb,xb,nb,this.levelText,Db.Nkb)}}}}static gG(Pa,Ab,nb,Rb,Mb){return new Db(null,Pa,Ab,nb,Rb,Mb)}static vT(Pa,Ab,nb,Rb,Mb){return new Db(Pa,ja.a(Pa).Bb,Ab,nb,Rb,Mb)}static Dul(){Db.bMa||(Db.bMa={},Db.bMa.M=1E3,Db.bMa.D=500,Db.bMa.C=100,Db.bMa.L=50,Db.bMa.X=10,Db.bMa.V=5,Db.bMa.I=1)}static Zgn(Pa){if(!Pa)return 0;Db.Dul();Pa=e.a.QA(Pa);
let Ab=0,nb=0;for(let Rb=Pa.length-1;0<=Rb;Rb--){const Mb=Db.bMa[e.a.charAt(Pa,Rb).toString()];nb=Mb<Ab?nb-Mb:nb+Mb;Ab=Mb}return nb}}Db.bMa=null;Db.L3f=["M{1,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(CM|CD|DC{0,3}|C{1,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(XC|XL|LX{0,3}|X{1,3})(IX|IV|V?I{0,3})","(IX|IV|VI{0,3}|I{1,3})"].map(Pa=>`\\(?(${Pa})[\\.\\)\\-]`);Object(E.a)(Db,"RomanListAction",Ma,[]);var gc=c(40);class Eb extends Ja.a{constructor(Pa,Ab,nb,Rb,Mb,oc){super(Pa,Ab,nb,nb+1,oc);this.fmk=
Rb;this.PPg=Mb;this.kZc=!1}get QC(){return!1}get commandId(){return F.a.lHk}WBb(Pa){Pa.innerText=e.a.substring(Pa.innerText,0,this.EG)+this.PPg+e.a.right(Pa.innerText,this.l0)}Ima(Pa){this.Kd.replaceTextRange(G.a.createTextRange(Pa,this.EG,this.l0),this.fmk,!0,!1);this.Kd.replaceTextRange(G.a.createTextRange(Pa,this.EG,this.EG+1),this.PPg,!0,!1)}set QC(Pa){super.QC=Pa}static gG(Pa,Ab,nb,Rb,Mb,oc){if("'"!==nb&&'"'!==nb)return null;var xb=aa.GraphIterator.$a(Pa);xb.yd();pa.OutlineElementNavigator.Vd(xb);
if(gc.OutlineElementReader.$m(xb.currentNode))return null;Rb=!Ab||e.a.$ba(Rb)||-1!==Array.indexOf(Eb.tun,Rb);xb="'"===nb;return new Eb(oc,Pa,Ab,nb+"",Rb?xb?"\u2018":"\u201c":xb?"\u2019":"\u201d",Mb)}}Eb.tun=["[","{","("];Object(E.a)(Eb,"SmartQuoteCorrectAction",Ja.a,[]);class kb extends Ja.a{constructor(Pa,Ab,nb,Rb,Mb,oc){super(Pa,Ab,nb,Rb,oc);this.OPg=Mb}get QC(){return kb.Vuc}set QC(Pa){kb.Vuc=Pa}get commandId(){return F.a.mHk}jIj(){this.Ind=this.JCh();this.Ind||(this.b4g=!1,this.VZg="MatchTextIsNotTheSame")}WBb(Pa){Pa.innerText=
e.a.substring(Pa.innerText,0,this.EG)+this.OPg+e.a.right(Pa.innerText,this.l0)}Ima(Pa){this.Kd.replaceTextRange(G.a.createTextRange(Pa,this.EG,this.l0),this.OPg,!0,!1)}static vT(Pa,Ab,nb,Rb,Mb){const oc=ja.a(Pa);return new kb(Pa,oc?oc.Bb:null,Ab,nb,Rb,Mb)}static gG(Pa,Ab,nb,Rb,Mb){return new kb(null,Pa,Ab,nb,Rb,Mb)}}kb.Vuc=!1;Object(E.a)(kb,"StringReplaceCorrectAction",Ja.a,[]);class bb extends Ja.a{constructor(Pa,Ab,nb,Rb,Mb,oc,xb,cc){super(Pa,Ab,nb,Rb,Mb);this.Ik=oc;this.L7j=xb;this.xD=cc}get QC(){return!0}get commandId(){return F.a.nHk}WBb(Pa){let Ab=
e.a.substring(Pa.innerText,this.EG,this.l0);Ab.charAt(0)!==Ab.charAt(0).toUpperCase()&&(Ab=Ab.charAt(0).toUpperCase()+Ab.substring(1,Ab.length));Pa.innerText=e.a.substring(Pa.innerText,0,this.EG)+Ab+e.a.right(Pa.innerText,this.l0)}Ima(Pa){const Ab=this.EG,nb=this.EG+1,Rb=Pa.characterData.substring(Ab,nb).charAt(0);if(!e.a.Hbc(Rb)){const Mb=G.a.createTextRange(Pa,Ab,nb);this.lGm(Mb)||this.xD&&this.xD.XVc(Pa,Ab,nb)||this.Kd.replaceTextRange(Mb,Rb.toUpperCase().toString(),!0,!1)}}lGm(Pa){return this.L7j?
!!this.Ik&&this.Ik.A8(Pa):!1}set QC(Pa){super.QC=Pa}static vT(Pa,Ab,nb,Rb){const Mb=ja.a(Pa);return new bb(Pa,Mb?Mb.Bb:null,Ab,nb,Rb,null,!1,null)}static gG(Pa,Ab,nb,Rb,Mb,oc){return new bb(null,Pa,Ab,nb,Rb,Mb,!0,oc)}}Object(E.a)(bb,"UpperFirstLetterAutoCorrectAction",Ja.a,[]);class Gb{constructor(Pa,Ab){this.Cvc=Ab;this.MF=Pa}QZo(){const Pa=Number.parseInvariant(this.MF.substring(0,this.MF.length-2));switch(Number.parseInvariant(this.MF.charAt(this.MF.length-3).toString())){case 1:return 11===Pa?
"th":"st";case 2:return 12===Pa?"th":"nd";case 3:return 13===Pa?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}nNm(){var Pa=m.a.og(this.Cvc);if(!Pa||!Pa.name.toLowerCase().startsWith("en")||!this.MF||2>=this.MF.length)return!1;for(Pa=0;Pa<Gb.RSd().length;Pa++)if(this.MF.toLowerCase().endsWith(Gb.RSd()[Pa])){if(RegExp("^\\d+$").test(this.MF.substr(0,this.MF.length-2))){const Ab=this.QZo();if(this.MF.toLowerCase().endsWith(Gb.RSd()[Pa])&&Ab===Gb.RSd()[Pa])return!0}break}return!1}static RSd(){return Gb.F9g||
(Gb.F9g=["st","nd","rd","th"])}}Gb.F9g=null;Object(E.a)(Gb,"ValidateOrdinalsRule",null,[]);c.d(M,"a",function(){return Sa});class Sa{constructor(Pa,Ab,nb,Rb,Mb,oc,xb){this.rzc=[];this.rSb=[];this.Joc=[];this.bte=new Set;this.nab=-1;this.IYg=this.yea=!1;this.f5j=Pa;this.Kd=Ab;this.Ik=nb;this.ga=Rb;this.uV=oc;this.xD=xb;Mb?(this.yea=Mb.$("ReplaceQuoteWithSmartQuoteIsEnabled"),this.IYg=Mb.$("HyperlinkUrlValidationIsEnabled"),n.ULS.sendTraceTag(23418953,324,50,"{0}",{["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.yea})):
(n.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.yea=!1)}qjb(Pa){return 0<=Sa.q2e.indexOf(Pa)}HGf(Pa){return 0<=Sa.r2e.indexOf(Pa)}mEf(Pa){return Pa.toLowerCase()===Pa}Hbc(Pa){return Pa.toUpperCase()===Pa}oXd(Pa){return Pa.toLowerCase()!==Pa.toUpperCase()}KIm(Pa,Ab,nb,Rb){return(new ra(Pa,Ab,nb,Rb)).WTk()}lRl(Pa){do{if(Pa.getAttribute("xml:lang"))return m.a.og(Pa.getAttribute("xml:lang"))||m.a.WSc;if(Pa.getAttribute("lang"))return m.a.og(Pa.getAttribute("lang"))||
m.a.WSc;Pa=Pa.parentNode}while(Pa&&1===Pa.nodeType);return m.a.WSc}Qof(Pa){return m.a.og(w.FormattingReader.language(w.FormattingReader.Kr(Pa)))||m.a.WSc}TLd(Pa,Ab){0>Ab&&(Ab=0);let nb=-1;const Rb=Sa.q2e.length;for(let Mb=0;Mb<Rb;++Mb){const oc=Pa.lastIndexOf(e.a.charAt(Sa.q2e,Mb),Ab);oc>nb&&(nb=oc)}Pa=e.a.z3a(Pa,Ab);Pa>nb&&(nb=Pa);return nb}YAl(Pa){for(let Ab=0;Ab<Pa.length;++Ab)if(this.oXd(e.a.charAt(Pa,Ab)))return Ab;return-1}hkf(Pa,Ab){if(!Pa||0>Ab)return-1;let nb=Ab;nb=nb?this.TLd(Pa,nb-1):-1;
nb=nb>e.a.z3a(Pa,Ab-1)?nb:e.a.z3a(Pa,Ab-1);nb++;return nb}YZh(Pa,Ab,nb){this.EKc(Ab);if(!this.rSb[Ab]){Ab=L.Y7h(Ab);if(0>=Ab)return null;this.EKc(Ab);if(!this.rSb[Ab])return null}if(nb&&this.Joc[Ab]&&Array.contains(this.Joc[Ab],Pa+nb))return null;nb=this.rSb[Ab][e.a.Tg(Pa)];if("string"!==typeof nb||nb===Pa||!nb)return null;var Rb=this.YAl(Pa);if(0>Rb||this.mEf(e.a.charAt(Pa,Rb)))return nb;Ab=!0;for(Rb+=1;Rb<Pa.length;++Rb){const Mb=e.a.charAt(Pa,Rb);Ab&&!this.Hbc(Mb)&&(Ab=!1)}return Ab?null:e.a.QA(e.a.substring(nb,
0,1))+e.a.right(nb,1)}kBl(Pa,Ab,nb,Rb){a.a.mark(4666);const Mb=this.lRl(Ab).LCID;let oc=0,xb=Pa;const cc=Ab.innerText;var Ob=cc.lastIndexOf(" ",Pa);if(this.VCf(cc.substring(Ob+1,Pa)))return a.a.mark(4667),null;Ob=null;var Ub=!1;do{xb=xb?this.TLd(cc,xb-1):-1;if(-1===xb&&!nb){Ub=Ab;var pb=null;if(!this.qjb(cc.charAt(0))){do{for(;Ub&&!Ub.previousSibling;)Ub=Ub.parentNode;Ub&&(Ub=Ub.previousSibling,pb=Ub.innerText)}while(Ub&&!pb);if(Ub&&pb&&!this.qjb(e.a.charAt(pb,pb.length-1)))return a.a.mark(4667),
null}Ub=!0}pb=e.a.substring(cc,xb+1,Pa);++oc;var Zb=this.YZh(pb,Mb,Rb.toString());if(Zb)Ob=kb.vT(Ab,xb+1,Pa,Zb,this.Kd),Sa.bKf();else for(const Wa of this.rzc)if(!(Wa.flags&1&&!(nb&&1>xb)||Wa.flags&4||Wa.flags&2&&" "!==Rb)&&(Zb=Wa.pattern.exec(pb))){Ob=Wa.nsm(Ab,xb+1,Pa,Zb,this.Kd,this.ga);break}}while(!Ub&&!Ob&&oc<Sa.aMi&&0<=xb);a.a.mark(4667);return Ob}iBl(Pa,Ab,nb){const Rb=Pa.node;let Mb=O.ParagraphReader.text(Rb);0>Ab&&(Ab=Pa.cpBegin);Pa=this.Qof(Pa).LCID;if(this.VCf(Mb.substring(e.a.z3a(Mb,
Ab)+1,Ab)))return null;var oc=-1,xb=R.HyperlinkReader.hOc(Rb);for(var cc=0;cc<xb.length;cc++)if(Ab>xb[cc].cpEnd)oc=xb[cc].cpEnd;else{if(Ab>xb[cc].cpBegin)return null;break}xb=null;cc=(cc=Ab)?this.TLd(Mb,cc-1):-1;cc<oc&&(cc=oc-1);oc=e.a.substring(Mb,cc+1,Ab);oc=oc.trimStart();if(1>cc)for(const Ob of this.rzc){let Ub=Mb;" "!==nb&&(Ub=Mb+nb);if(Ob.pattern.exec(Ub))return null}Mb=Mb.substring(0,Ab);if(!this.KIm(Mb,nb.toString(),oc,Pa))return null;oc.charAt(0).toUpperCase()!==oc.charAt(0)&&(xb=bb.gG(Rb,
cc+1,Ab,this.Kd,this.Ik,this.xD));return xb}yZh(Pa,Ab,nb){Pa=N.SelectionFactory.fo(Pa,!1);if(!Pa)return null;Pa=Pa.Qc;return J.SelectionEditor.gf(Pa)?this.iBl(Pa,Ab,nb):null}VCf(Pa){return e.a.uU(Pa)}Njf(Pa,Ab,nb,Rb){a.a.mark(4666);const Mb=Pa.node,oc=this.Qof(Pa).LCID,xb=O.ParagraphReader.text(Mb);0>Ab&&(Ab=Pa.cpBegin);if(nb&&!this.qjb(e.a.charAt(xb,Ab))||this.VCf(xb.substring(e.a.z3a(xb,Ab)+1,Ab)))return a.a.mark(4667),null;Pa=-1;nb=R.HyperlinkReader.hOc(Mb);for(var cc=0;cc<nb.length;cc++)if(Ab>
nb[cc].cpEnd)Pa=nb[cc].cpEnd;else{if(Ab>nb[cc].cpBegin)return null;break}nb=0;cc=Ab;let Ob=null;do{cc=cc?this.TLd(xb,cc-1):-1;cc<Pa&&(cc=Pa-1);const pb=e.a.substring(xb,cc+1,Ab);++nb;var Ub=null;let Zb=!1;if(I.a.sTh){const Wa=xb+String.fromCharCode(Rb);Zb=this.rzc.some(Lb=>Lb.pattern.exec(Wa))}Zb||(Ub=this.YZh(pb,oc,null));if(Ub)this.uV.tSa&&(Ob=kb.gG(Mb,cc+1,Ab,Ub,this.Kd),Sa.bKf());else for(const Wa of this.rzc)if(!(Wa.flags&1&&-1!==cc||Wa.flags&4&&Rb!==l.a.zs||Wa.flags&2&&Rb!==l.a.LIa)&&(Ub=Wa.pattern.exec(pb))){Ob=
Wa.ajm(Mb,cc+1,Ab,Ub,this.Kd,this.ga);if(Ob.commandId!==F.a.p2e&&!this.uV.tSa||Ob.commandId===F.a.p2e&&!this.uV.s4c)Ob=null;break}}while(0<=cc&&cc>=Pa&&!Ob&&nb<Sa.aMi);a.a.mark(4667);return Ob}xZh(Pa,Ab,nb){Pa=N.SelectionFactory.fo(Pa,!1);if(!Pa)return null;Pa=Pa.Qc;return J.SelectionEditor.gf(Pa)?this.Njf(Pa,Ab,!1,nb):null}FZh(Pa,Ab){var nb=N.SelectionFactory.fo(Pa,!1);if(!nb)return null;let Rb=nb.Qc;nb.hy&&nb.Qc.contextId!==A.a.endOfParagraph&&0<=Ab&&(Rb=G.a.Rc(Pa,Ab));if(!J.SelectionEditor.gf(Rb)||
R.HyperlinkReader.Bwa(Rb,!1))return null;nb=O.ParagraphReader.text(Rb.node);Pa=0<Ab?e.a.z3a(nb,Ab-1)+1:e.a.z3a(nb,nb.length-1)+1;Ab=0<Ab?Ab:nb.length;nb=e.a.substring(nb,Pa,Ab);return!nb||this.IYg&&!R.HyperlinkReader.n3a(nb)||!e.a.uU(nb)&&!e.a.ITc(nb)||!Sa.hyperlinkEditor.HYn(Rb,Pa,Ab)?null:this.f5j.Y9k(Rb.node,Pa,Ab)}KZh(Pa,Ab){var nb=N.SelectionFactory.fo(Pa,!1);if(!nb)return null;var Rb=nb.Qc;if(!J.SelectionEditor.gf(Rb))return null;0>Ab&&(Ab=Rb.cpBegin);var Mb=O.ParagraphReader.text(Rb.node);
nb=this.hkf(Mb,Ab);const oc=Sa.r2e.length;for(let xb=0;xb<oc;++xb){const cc=Mb.lastIndexOf(e.a.charAt(Sa.r2e,xb),Ab-1);cc>nb&&(nb=cc+1)}Mb=e.a.substring(Mb,nb,Ab);if(!Mb)return null;Rb=this.Qof(Rb).LCID;return(new Gb(Mb,Rb)).nNm()?eb.gG(Pa,nb,Ab,this.Kd):null}uZh(Pa,Ab){var nb=N.SelectionFactory.fo(Pa,!1);if(!nb)return null;nb=nb.Qc;if(!J.SelectionEditor.gf(nb))return null;0>Ab&&(Ab=nb.cpBegin);var Rb=O.ParagraphReader.text(nb.node);nb=this.hkf(Rb,Ab);Rb=e.a.substring(Rb,nb,Ab);return Rb?(Rb=(new La(Rb)).LGl())?
oa.gG(Pa,nb,Ab,Rb,this.Kd):null:null}hCl(Pa,Ab,nb,Rb,Mb){var oc=N.SelectionFactory.fo(Pa,!1);if(!oc)return null;oc=oc.Qc;if(nb>Ab||!J.SelectionEditor.gf(oc))return null;0>Ab&&(Ab=oc.cpBegin);if(0>Ab)return null;oc=O.ParagraphReader.text(oc.node);return Eb.gG(Pa,nb,Mb,Ab?oc.charAt(Ab-1):"\x00",this.Kd,Rb)}Ryb(Pa,Ab,nb,Rb){this.rzc.push(new $a(`^${Pa}$`,Ab,nb,Rb))}IMf(Pa){if(this.rSb[this.nab]){const Ab=this.rSb[this.nab];for(const nb in Pa)Ab[nb]=Pa[nb]}else this.rSb[this.nab]=Pa}NMf(Pa){this.Joc[this.nab]?
this.Joc[this.nab].push(...(Pa||[])):this.Joc[this.nab]=Pa}RYm(Pa,Ab){var nb;this.bte.has(Ab)||(this.bte.add(Ab),null===(nb=y.AFrameworkApplication.Ne)||void 0===nb?void 0:nb.sj(Pa,1,null,null,!1,3,Rb=>{this.nab=Ab;try{Object(v.a)(Rb.data.xe)}catch(Mb){n.ULS.sendTraceTag(5898336,324,50,"Failed to parse autocorrect: {0}",{["ResponseData"]:Rb.data?Rb.data.xe:""})}this.nab=-1},()=>{this.Ntl(Ab)},null,void 0,void 0,void 0,void 0,"27"))}Ntl(Pa){Pa=L.Y7h(Pa);0<Pa&&this.EKc(Pa)}static get HHk(){return null!=
Sa.Yvg?Sa.Yvg:Sa.Yvg=(()=>Sa.Ivh.map(([Pa,...Ab])=>(new $a(`^${Pa}`,...Ab)).pattern))()}static get Ivh(){return null!=Sa.Zvg?Sa.Zvg:Sa.Zvg=(()=>[...xa.L3f.map(Pa=>[Pa,xa.vT,xa.gG,3]),["\\(?(\\d+)[\\.\\)\\-]",db.vT,db.gG,3],["\\(?(L|l|C|c|D|d|M|m){1}[\\.\\)\\-]",Ca.vT,Ca.gG,3],...Db.L3f.map(Pa=>[Pa,Db.vT,Db.gG,11]),["\\(?([A-Za-z]){1}[\\.\\)\\-]",Ca.vT,Ca.gG,3]])()}$Ym(){this.EKc(1033);this.Ryb("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Fa.vT,Fa.gG,5);this.Ryb("=rand\\.old\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",
Fa.vT,Fa.gG,5);this.Ryb("=lorem\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Fa.vT,Fa.gG,5);Sa.Ivh.forEach(Pa=>this.Ryb(...Pa));this.Ryb("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",ua.vT,ua.gG,0);this.Ryb("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",ya.vT,ya.gG,0);this.Ryb("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",ya.vT,ya.gG,0)}EKc(Pa){this.bte.has(Pa)||this.RYm(K.a.JKk(String.format("Acl/Acl{0}.js",Pa)),Pa)}static bKf(){z.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(Pa=>{Pa.logActivity("AutocorrectStringMatch",
null)})}static get hyperlinkEditor(){return null!=Sa.zAg?Sa.zAg:Sa.zAg=z.a.instance.resolve("Box4.IHyperlinkEditor")}}Sa.q2e=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";Sa.r2e=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";Sa.q$f=".!?";Sa.aMi=5;Object(E.a)(Sa,"AutoCorrectRules",null,[538])},1634:function(E,M,c){E=c(0);var m=c(35),e=c(7),a=c(453),l=c(568),y=c(55),z=c(2),n=c(38);const v=(Z,da,aa)=>{if(Z){var ea=0;do{try{Z();break}catch(na){if(e.ULS.sendTraceTag(50946190,
306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",ea,aa,na.message,na.stack),ea>=da)break}ea++}while(1)}};var A=c(92),w=c(26),G=c(201),F=c(191),I=c(57),K=c(311),J=c(20),N=c(136);class R{constructor(Z,da,aa,ea,na,pa,ja,ma,Ia=!0,Ja=null,Ka=!1){this.WYh="FileUpload.ashx";this._iframe=null;this._initialized=!1;this.El=this.Ksc=this.hAe=this.AYa=this.Eid=this.sE=this._form=null;this.Kh=!1;this.Ky=this.Fid=this.Wcb=null;this._parent=Z;this.$5j=da;this.ogk=aa;this.SVg=
na;this.xBa=ja;this.dKg=ma;this.BNg=Ja;this.mWe=!1;this.Z6j=ea.$("CanaryRenewalForFileUploadIsEnabled");this.vYo=!1;(this.sbb=Ka)||this.o7k(pa);Ia&&this.vqi()}get edj(){return this.ogk}get sessionId(){return this.xBa}get iFrame(){return this._iframe}get MT(){return this.sE}get EJb(){return z.AFrameworkApplication.K?z.AFrameworkApplication.K.$("NativeFileOpenDialogIsEnabled"):!1}get QYh(){return z.AFrameworkApplication.K?z.AFrameworkApplication.K.$("FileInputDescriptionAccessibilityIsEnabled"):!1}get QLm(){return this.sbb?
!1:F.b(this._iframe.contentWindow.location.pathname,this.WYh,0)}get uAk(){return!J.a.moa&&z.AFrameworkApplication.K.$("AllowMultipleImageInsertFromLocalDevice")}vqi(){this.Ky=N.a.create().toString();this.sbb?this.Ehf():this.jCk()}o7k(Z){this._iframe=document.createElement("iframe");this._iframe.className=Z;this._iframe.id=Z;this.SVg&&(this._iframe.style.visibility="visible",this._iframe.style.height="30px",this._iframe.setAttribute("frameborder","0"));this.AYa=Object(y.a)(this,this.pWf,"onUploadFrameLoad");
n.a.addHandler(this._iframe,"load",this.AYa)}RId(Z=null){z.AFrameworkApplication.ta.I$d();if(!this.sE)return e.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";n.a.addHandler(this.sE,"change",()=>{this.yzl(Z)});v(Object(y.a)(this,this.PYh,"fileInputClick"),1,"DoFileOpenDialog");return this.sE.value}yzl(Z){Z&&Z(this.sE.value)}zzl(){this.Eid&&(this.Eid.innerText=this.m$h())}GUn(Z){n.a.addHandler(this.sE,"change",()=>{Z(this.m$h())})}m$h(){let Z=null;if(this.sE.value){const da=this.sE.value,
aa=da.lastIndexOf("\\");0<aa&&(Z=da.substring(aa+1,da.length))}return Z?Z:""}PYh(){try{e.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.sE.click()}catch(Z){throw e.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",Z.message),Z;}}l9c(){this.mQm()?this.yvj():(this.$mg(),this._form.submit())}mQm(){return(this.Z6j||this.sbb)&&!(void 0===window.self.FormData||null===window.self.FormData)}$hj(Z){if(Z){const da=this.JJh();
this.El=new XMLHttpRequest;this.El.open("POST",da);this.El.setRequestHeader("X-CorrelationId",this.Ky);this.g1m(Z);this.El.onreadystatechange=Object(y.a)(this,this.gza,"uploadResponseReceived");this.El.send(Z)}}g1m(Z){if(!J.a.moa&&Z.get){var da=Z.get("ImageId");Z=window.self.navigator;da={["CorrelationId"]:this.Ky,["Canary"]:z.AFrameworkApplication.canary,["ImageNodeId"]:da};Z&&(Z=Z.connection?Z.connection:Z.mozConnection?Z.mozConnection:Z.webkitConnection?Z.webkitConnection:null)&&(da.effectiveType=
Z.effectiveType,da.downlink=Z.downlink,da.type=Z.type,da.rtt=Z.rtt);e.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",da)}}yvj(){try{this.$mg();e.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");const Z=new (Type.parse("FormData"))(this._form);this.$hj(Z)}catch(Z){e.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+Z.message),this.Uec(null)}}xvj(Z){try{if(this.$mg(),e.ULS.sendTraceTag(594888406,
322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.$Zo(Z)){this.Fid=Z;this._form.contains(this.sE)&&this._form.removeChild(this.sE);var da=new (Type.parse("FormData"))(this._form);da.append("applicationfileInput",Z.blob,Z.filename);this.$hj(da)}else this.Uec(null)}catch(aa){e.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+aa.message),this.Uec(null)}}$Zo(Z){return Z&&void 0!==Z.blob&&null!==Z.blob&&void 0!==Z.filename&&null!==
Z.filename&&""!==Z.filename?void 0===window.self.FormData||null===window.self.FormData?(e.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(Z=Z?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===Z.blob||null===Z.blob,void 0===Z.filename||null===Z.filename||""===Z.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",e.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",Z)),
!1)}gza(){if(4===this.El.readyState)if(200===this.El.status){e.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.Ky);const Z=this.El.getResponseHeader("X-NewKey"),da=this.cFm(this.El);let aa=!1;if(void 0!==Z&&null!==Z&&da&&(aa=this.LZo(Z),!this.mWe&&aa)){e.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.Ky);this.mWe=!0;this.AGd();void 0!==this.Fid&&
null!==this.Fid?this.xvj(this.Fid):this.yvj();return}e.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.mWe,da,!(void 0===Z||null===Z),aa,this.Ky);this.Uec(this.El.responseText)}else e.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.El.status,this.El.responseText?!1:!0,this.Ky),this.Uec(null)}cFm(Z){try{const da=
m.a(Z.responseText).Responses;if(void 0!==da&&null!==da&&1===da.length){const aa=da[0];if(void 0!==aa&&null!==aa&&2===aa.length&&28===aa[1].StatusCode)return!0}}catch(da){}return!1}LZo(Z){K.a.Ilg(Z);return z.AFrameworkApplication.canary!==Z?!1:!0}$mg(){this.Wcb||(this.Wcb=new Date)}dispose(){this.Kh||(this.sbb?this._parent.removeChild(this._form):(this._parent.removeChild(this._iframe),n.a.removeHandler(this._iframe,"load",this.AYa),this.AYa=null),this.hAe&&(n.a.removeHandler(this.sE,"change",this.hAe),
this.hAe=null),this.QYh&&(this.Ksc&&(n.a.removeHandler(this.sE,"change",this.Ksc),this.Ksc=null),this.Eid=null),this.sE=this._form=this._parent=this._iframe=null,this.Kh=!0,this.Wcb=null,e.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}delayedDispose(){this.dispose()}z3b(Z,da){if(this._form){var aa;(aa=this._form.querySelector("input[name="+Z+"]"))?aa.value=da:(aa=this.vaf(),aa.type="hidden",aa.id=Z,aa.name=Z,aa.value=da,this._form.appendChild(aa))}}vaf(){return this.sbb?document.createElement("input"):
this._iframe.contentWindow.document.createElement("input")}pWf(){try{if(!this._iframe.contentWindow.document.body)return}catch(da){this.sQc();return}if(!(this._initialized||this.EJb&&J.a.LH))this.Ehf();else if(!this.EJb||!J.a.LH||this.QLm){let da;da=J.a.ut?this._iframe.contentWindow.document.body.innerText:this.vYo?this._iframe.contentWindow.document.body.firstChild.innerText:this._iframe.contentWindow.document.body.firstChild.innerHTML;var Z=this._iframe.contentWindow.document.body.innerText.toLowerCase();
const aa=0<=Z.indexOf("responses")||0<=Z.indexOf("wopisrc");Z=0<=Z.indexOf("http error");!aa&&Z&&e.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this._iframe.contentWindow.document.body.innerText);this.Uec(da)}}Ehf(){if(!this._initialized){var Z=this.QD("uploadForm");const da=this.QD("fileInput"),aa=this.JJh();this.w9k();this._form.id=Z;this._form.method="post";this._form.encoding="multipart/form-data";this._form.action=aa;this.sE.type="file";this.dKg&&
(this.sE.accept=this.dKg,this.BNg&&(this.sE.capture=this.BNg));this.sE.id=da;this.sE.name=da;this.uAk&&(this.sE.multiple=!0);!this.QYh||J.a.ut||J.a.Xt||(this.Ksc=Object(y.a)(this,this.zzl,"fileInputChangedHandleAccessibility"),n.a.addHandler(this.sE,"change",this.Ksc),this.Eid=w.a.psh(this._form,this.sE,"InputFileDescription"));this.SVg&&(this.sbb||(Z=this._iframe.contentWindow.document.body,Z.style.margin="0",Z.style.overflow="hidden"),Z=z.AFrameworkApplication.ta,this.sE.style.fontFamily=Z.Zya,
this.sE.style.fontSize=Z.blg,this.sE.style.margin="0");(Z=document.getElementById("__REQUESTDIGEST"))&&this.z3b("__REQUESTDIGEST",Z.value);this.AGd();this._form.appendChild(this.sE);this._initialized=!0;this.$5j(this)}}w9k(){if(this.sbb)this._form=document.createElement("form"),this._parent.appendChild(this._form),this.sE=document.createElement("input");else{this._form=this._iframe.contentWindow.document.createElement("form");const Z=this._iframe.contentWindow.document;Z.body.appendChild(this._form);
this.sE=Z.createElement("input")}}jCk(){this._parent.appendChild(this._iframe);this.EJb&&J.a.LH&&this.Ehf()}JJh(){var Z=new G.QueryStringBuilder(this.WYh);z.AFrameworkApplication.Sea(Z);this.Rdo(Z);Z=Z.toString();if(J.a.jj||J.a.LH||J.a.Xt)Z=I.a.FMc(Z);return Z}Uyd(){const Z=new A.a(2,1,0,Object(y.a)(this,this.delayedDispose,"delayedDispose"),4);z.AFrameworkApplication.nc.Vb(Z)}}Object(E.a)(R,"UploadFrame",null,[9]);var O=c(19),L=c(251),U=c(9),W=c(1753);class X extends R{constructor(Z,da,aa,ea,na,
pa,ja=null,ma=!1){super(Z,da,aa,ea,na,"WACUploadFrame",z.AFrameworkApplication.userSessionId,pa,!1,ja,ma)}QD(Z){return U.App.ya.kj(Z)}Rdo(Z){L.a.instance.Wyb(Z)}AGd(){z.AFrameworkApplication.canary&&this.z3b(a.a.canary,z.AFrameworkApplication.canary);U.App.ya.gb.activeSection.CH&&this.z3b(a.a.CH,U.App.ya.gb.activeSection.CH)}Jtf(Z){let da=null,aa;({group:aa}=l.a.l1(Z)).returnValue?da=aa.Responses[0]:e.ULS.sendTraceTag(41697634,322,10,"Box4UploadFrame.GetServerResponse: unable to deserialize the response");
return da}sQc(){e.ULS.sendTraceTag(41697635,322,15,"Box4ImageUploadFrame.HandleUploadError: The response is invalid, falling back on a default unspecified failure response");const Z=new W.a;Z.StatusCode=14;this.edj(Z);this.Uyd()}Uec(Z){Z?(Z=O.a.ivj(Z),Z=Z.replace(RegExp("&amp;","g"),"&"),(Z=this.Jtf(Z))?(this.edj(Z),this.Uyd()):this.sQc()):this.sQc()}}Object(E.a)(X,"Box4UploadFrame",R,[]);c.d(M,"a",function(){return V});class V extends X{constructor(Z,da,aa,ea,na,pa=null,ja=!1){super(Z,da,aa,ea,na,
V.fJl(),pa,ja);this.vqi()}static fJl(){return V.tkh.join(",")+","+V.wWe.join(",")}AGd(){super.AGd();this.z3b(a.a.vqb,"1");this.z3b(a.a.PQb,"1")}sQc(){super.sQc();e.ULS.sendTraceTag(41697632,322,15,"Box4ImageUploadFrame.HandleUploadError: Falling back on a default Unspecified Failure response")}Jtf(Z){const da=super.Jtf(Z);if(!da)try{const aa=m.a(Z);l.a.Vlf(aa)}catch(aa){e.ULS.sendTraceTag(41697633,322,10,"Box4ImageUploadFrame.GetServerResponse: {0}",aa.toString())}return da}}V.tkh=".jpg .jpeg .png .gif .bmp .tif .tiff .jfif".split(" ");
V.wWe=[".webp"];Object(E.a)(V,"Box4ImageUploadFrame",X,[])},1636:function(E,M,c){E=c(0);var m=c(136),e=c(58),a=c(354),l=c(53),y=c(3),z=c(1180),n=c(18),v=c(5),A=c(298),w=c(43),G=c(1284),F=c(815),I=c(116),K=c(42),J=c(15),N=c(6),R=c(145),O=c(41),L=c(7),U=c(1848),W=c(681),X=c(1689),V=c(123),Z=c(1540);class da{constructor(ja,ma,Ia,Ja,Ka,Ma){this.f5b=this.BH=null;this.dmf=ma;if(ja[W.a.$Pc])this.eU=ja[W.a.$Pc],this.QDc=ja[W.a.QDc],this.f5b=Array(4),this.f5b[0]=ja[W.a.Rfb],this.f5b[1]=ja[W.a.Sfb],this.f5b[2]=
ja[W.a.Tfb],this.f5b[3]=ja[W.a.Qfb],this.p1o=ja[W.a.width],this.uqm=ja[W.a.height],this.Rwa=void 0!==ja[W.a.Rwa]?"true"===ja[W.a.Rwa].toLowerCase():void 0,this.Ys=Ia,this.V4b=Ja;else{ma=ja[W.a.Rfb];const sa=ja[W.a.Sfb],xa=ja[W.a.Tfb],ia=ja[W.a.Qfb];Ma&&Ma.$("EffectExtentPointsForGraphicsEditorIsEnabled")&&void 0!==ma&&void 0!==sa&&void 0!==xa&&void 0!==ia?(this.Rfb=ma,this.Sfb=sa,this.Tfb=xa,this.Qfb=ia):(this.Rfb=ja[W.a.left],this.Sfb=ja[W.a.right],this.Tfb=ja[W.a.top],this.Qfb=ja[W.a.bottom]);this.width=
ja[W.a.width];this.height=ja[W.a.height];this.rotationAngle=ja[W.a.angle];this.sBn=ja[W.a.rBn];this.Ys=Ia;this.V4b=Ja;this.yeb=Ka;this.REa=2;this.flipH=this.tX(ja,W.a.flipH);this.flipV=this.tX(ja,W.a.flipV);this.Ifn();this.QSo()}}QSo(){this.BH||(this.BH=Array(4),this.BH[0]=V.a.oG(this.Rfb),this.BH[1]=V.a.oG(this.Sfb),this.BH[2]=V.a.oG(this.Tfb),this.BH[3]=V.a.oG(this.Qfb))}Ifn(){var ja=Z.c(this.rotationAngle);if(45<=ja&&135>=ja||225<=ja&&315>=ja){ja=this.width/2;const ma=this.height/2;this.Rfb-=ja-
ma;this.Sfb+=ja-ma;this.Tfb-=ma-ja;this.Qfb+=ma-ja}}tX(ja,ma){if(ja.hasOwnProperty(ma))return ja[ma]}}Object(E.a)(da,"JsonToDocumentXmlResponseCommonParams",null,[]);class aa extends da{constructor(ja,ma,Ia,Ja,Ka,Ma){super(ja,ma,Ia,Ja,Ka,Ma);this.IAk="string"===typeof ja[W.a.hAd]?ja[W.a.hAd]:null;this.N5b="string"===typeof ja[W.a.N5b]?ja[W.a.N5b]:null}}Object(E.a)(aa,"JsonToDocumentXmlResponseDrawingParams",da,[]);var ea=c(514);class na extends da{constructor(ja,ma,Ia,Ja,Ka,Ma){var sa,xa,ia,ha,ua;
super(ja,ma,Ia,Ja,Ka,Ma);this.IXo=ja[W.a.bBn];this.u3k=ja[W.a.UAn];this.REa=1;this.u3k||(this.REa=0,this.BH=ea.a.instance.mna(V.a.oG(this.width),V.a.oG(this.height),this.rotationAngle));this.PWf=this.tX(ja,W.a.bfc);this.H8d=this.tX(ja,W.a.H8d);this.QWf=this.tX(ja,W.a.QWf);this.xJj=this.tX(ja,W.a.wJj);this.Joe=this.tX(ja,W.a.Joe);this.Mog=this.tX(ja,W.a.Mog);this.G3c=null!==(sa=this.tX(ja,W.a.G3c))&&void 0!==sa?sa:"";this.extension=ja[W.a.extension];this.Bua=null!==(xa=this.tX(ja,W.a.left))&&void 0!==
xa?xa:0;this.Dua=null!==(ia=this.tX(ja,W.a.top))&&void 0!==ia?ia:0;this.Cua=null!==(ha=this.tX(ja,W.a.right))&&void 0!==ha?ha:0;this.Aua=null!==(ua=this.tX(ja,W.a.bottom))&&void 0!==ua?ua:0;this.lockAspectRatio=this.tX(ja,W.a.lockAspectRatio);this.exh=this.tX(ja,W.a.hia);this.borderStyle=this.tX(ja,W.a.vpa);this.borderColor=this.tX(ja,W.a.GGa);this.hKk=void 0!==this.exh||void 0!==this.borderStyle||void 0!==this.borderColor;this.altTextDescription=this.tX(ja,W.a.altTextDescription);this.alphaModFix=
this.tX(ja,W.a.alphaModFix)}}Object(E.a)(na,"JsonToDocumentXmlResponsePictureParams",da,[]);c.d(M,"a",function(){return pa});class pa{constructor(ja,ma,Ia,Ja,Ka,Ma,sa,xa,ia,ha,ua,ya,ra,La,oa,Ca,Aa){this.A$a=this.Fxb=null;this.Ijd=ja;this.hBe=ma;this.WJ=Ia;this.Jm=Ja;this.Nl=Ka;this.Hc=Ma;this.o1j=xa;this.SSg=sa;this.Oj=ia;this.Do=ha;this.fek=ua;this.eek=ya;this.Ma=ra;this.vV=La;this.ld=oa;this.D7j=Ca;this.G5j=Aa}hpa(ja,ma,Ia,Ja,Ka,Ma,sa){Ma.stop();sa?L.ULS.sendTraceTag(575522565,3001,10,ja):L.ULS.sendTraceTag(575522566,
3001,10,ja);this.SSg?(Ja=this.Hc.Mc(7,y.a.aQc),Ja.Cb(Ia),this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&ma.Fb.setValue(I.a.yOa,!1),ma.Fb.setValue(K.a.O_,0),ma.Fb.setValue(J.a.uha,ma.$Ok),ma.Fb.setValue(J.a.tha,ma.YOk),Ja.dispose()):Ja();this.A$a&&this.A$a(ja);Ka()}Jec(ja,ma,Ia,Ja,Ka,Ma,sa){L.ULS.sendTraceTag(575522567,3001,50,"GraphicsEditorJsonToDocumentXmlRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:sa.si});
var xa=ja.data.xe,ia=null;try{ia=JSON.parse(xa)}catch(ua){this.hpa("Failed to parse incoming JSON blob.",ma,Ka,Ja,Ia,sa,!1);return}if(U.a.error in ia)this.hpa("Error code returned from WordGraphicsEditorHandler endpoint: "+ia[U.a.error],ma,Ka,Ja,Ia,sa,!1);else{xa=10;var ha=1;try{xa=parseInt(ia[W.a.Ys]),ha=parseInt(ia[W.a.V4b])}catch(ua){this.hpa("Invalid data found in the JSON blob. (i.e. placeholderkind/drawingid)",ma,Ka,Ja,Ia,sa,!1);return}Ia=ja.data.request?z.a.lLc(ja.data.request.get_body()):
null;ja=null;ja=ma.Fb;Ja=ma.getId();ma=ja.getValue(N.a.Ys);ma=ma!==xa&&(5===ma||5===xa||this.iom(ja,ia));5===xa?(ia=new na(ia,this.hBe,xa,ha,Ia,this.Ma),ja=this.xPl(Ka,Ma,ia,ma,ja,Ja)):(ia=new aa(ia,this.hBe,xa,ha,Ia,this.Ma),ja=this.wPl(Ka,Ma,ia,ma,ja,Ja));ia=this.Hc.Mc(7,y.a.aQc);xa=Ka;n.ImageReader.t8(Ka)&&ma&&(xa=v.GraphIterator.$a(Ka),xa.zb(12),xa=xa.parentNode);ia.Cb(xa);ja();this.WJ.uHa(Ma);ia.dispose();if(this.Nl&&this.Nl!==m.a.nil){const ua=xa.Bi();null===ua||void 0===ua?void 0:ua.contentReplicator.forceOutbound(()=>
{L.ULS.sendTraceTag(574358089,3001,50,"Graphical Content Properties Persisted to Box4: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:sa.si});sa.stop();const ya=new e.a(this.Nl,1);this.Jm.O2b(ua,ya);const ra=this.Ijd.properties;null!=ra&&Object(A.a)(()=>{const La=new w.GraphTransaction(3,y.a.imageRotate);La.Cb(Ka);ra.setValue(I.a.T4,1);La.dispose()})},null,null)}this.Fxb&&this.Fxb(Ka)}}ssh(ja,ma){ja.Ce(U.a.lZf,"false");ja.Ce(U.a.dmf,this.hBe);ja.Ce(U.a.S9e,"0");ja.FI(W.a.yeb,window.self.devicePixelRatio.toString());
void 0!==ma&&null!==ma&&(ma=this.Do.Ym(ma.$j),ma=this.Do.mk(ma),ja.Ce(W.a.Ys,G.a[ma]));this.D7j&&(ja.Ce(W.a.LVd,"true"),ja.Ce(W.a.eum,this.G5j.toString()))}gmh(ja){if(this.SSg){ja=ja.$j;var ma=this.Do.Ym(ja);if(!ma)return null;const Ia=new X.a(this.o1j,ma),Ja=this.Hc.Mc(15,y.a.aQc);Ja.Cb(ja.node);this.l0i(ma,!1);ma.setValue(N.a.Ys,ma.ia(N.a.Ys,10));Ja.fk=y.a.aQc;Ja.VFa(this.Nl,1);Ja.dispose();return Ia}ma=new a.DictionaryPropertySet;this.l0i(ma,!0);return(ja=this.Oj.vSh(ja,ma,this.Nl))&&ja.blob?new X.a(ja.blob.id,
ja.blob.properties):null}CRd(){return Box4Intl.Box4Strings.l_GraphicsEditorError}l0i(ja,ma){ja.setValue(J.a.uha,l.a.Tl(this.fek,0));ja.setValue(J.a.tha,l.a.Tl(this.eek,1));this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&!ma?ja.setValue(I.a.yOa,!0):ja.setValue(K.a.O_,1);ja.setValue(R.a.b4,!0)}wPl(ja,ma,Ia,Ja,Ka,Ma){const sa=xa=>{this.Ijd.oTo(Ia,xa,ja)};return this.mPi(Ja,Ka,ja)?this.M5h(ma,Ka,Ma,sa):()=>{sa(Ka)}}xPl(ja,ma,Ia,Ja,Ka,Ma){const sa=
xa=>{this.Ijd.pTo(Ia,xa,ja)};return this.mPi(Ja,Ka,ja,Ia)?this.M5h(ma,Ka,Ma,sa):()=>sa(Ka)}mPi(ja,ma,Ia,Ja){return ja?!0:Ja?n.ImageReader.HQd(ma,Ia.Kc,!1)!==Ja.PWf:!1}M5h(ja,ma,Ia,Ja){const Ka=F.a.instance.Mcd;Ka.Qw(ma);Ka.id=Ia;return()=>{this.Ijd.I1n(ja,Ia,Ka,this.vV,Ja)}}wlo(ja){this.Fxb=ja}Vfo(ja){this.A$a=ja}iom(ja,ma){return this.ld.isFeatureEnabled(46)&&(ja.hasProperty(O.a.eU)&&!ma[W.a.$Pc]||!ja.hasProperty(O.a.eU)&&ma[W.a.$Pc])?!0:!1}}Object(E.a)(pa,"GraphicsEditorJsonToDocumentXmlRequestHelper",
null,[569])},1637:function(E,M,c){E=c(0);var m=c(74),e=c(55),a=c(321),l=c(337);class y{constructor(G,F,I,K=0,J=0,N=null,R=null){this.commandId=G;this.controlId=F;this.timeStamp=I;this.commandSurface=a.a[K];this.Gx=l.a[J];this.contentType=N;this.$ke=R}}Object(E.a)(y,"CommandActionInfo",null,[]);class z{constructor(){this.RTj=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))")}jTm(G){return!this.RTj.exec(G)}}Object(E.a)(z,"EventsCacheLoggingUtils",null,
[]);var n=c(2),v=c(1807),A=c(651);c.d(M,"a",function(){return w});class w{constructor(){this.p5g=null;this.pJe=20;this.Osc=this.tfd=this.Xfd=null}init(){this.p5g=new z;this.Xfd=new m.a;this.tfd=new m.a;this.Osc=new m.a;this.pJe=n.AFrameworkApplication.K.mc("MaxCommandClickedEventQueueSize",20);v.a.nwk(Object(e.a)(this,this.x_k,"commandClickEventRaised"));A.a.instance.zph(Object(e.a)(this,this.pOn,"recordActionEvent"))}qkg(G){G.count>this.pJe&&G.removeAt(this.pJe)}x_k(G,F){this.Xfd.insert(0,new y(F.commandId,
F.controlId,F.time,F.commandSurface,F.Gx,F.contentType));this.qkg(this.Xfd)}pOn(G,F){this.tfd.insert(0,new y(F.actionName,F.controlId,F.timeStamp,F.commandSurface,F.Gx,F.contentType,F.$ke));this.qkg(this.tfd);this.p5g.jTm(F.actionName)&&(this.Osc.insert(0,new y(F.actionName,F.controlId,F.timeStamp,F.commandSurface,F.Gx,F.contentType,F.$ke)),this.qkg(this.Osc))}oNc(){return this.Xfd}Vgb(){return this.tfd}static get instance(){return w._instance||(w._instance=new w)}}w._instance=null;Object(E.a)(w,
"CommandClickEventsCache",null,[])},1639:function(E,M,c){E=c(0);class m{}Object(E.a)(m,"AuthContext",null,[]);var e=c(2),a=c(742);c.d(M,"a",function(){return l});class l{static getAuthContext(){const y=e.AFrameworkApplication.K.jb("UserPrincipalName")||"";let z=y;e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(z=a.OAuthManagerSettings.rhn||y);return Object.assign(new m,{upn:y,loginHint:z,authority:a.OAuthManagerSettings.authority,authorityType:l.JNd(),
tenantId:e.AFrameworkApplication.K.jb("TenantId")||""})}static JNd(){let y=0;const z=l.R3h();"aad"===z.toLowerCase()?y=2:"msa"===z.toLowerCase()&&(y=1);return y}static R3h(){return e.AFrameworkApplication.K.jb("HostAuthType")||""}}Object(E.a)(l,"OAuthIdentity",null,[])},1640:function(E,M,c){c.r(M);E=c(0);var m=c(1798),e=c(55),a=c(1800),l=c(443),y=c(1801),z=c(166),n=c(2),v=c(96),A=c(89),w=c(525),G=c(230),F=c(11),I=c(65),K=c(79),J=c(97),N=c(92),R=c(26),O=c(54),L=c(39),U=c(20),W=c(13);class X{constructor(da){this.e4d=
4;this.Xah=0;this.lRg=this.tNg=this.tch=this.tSg=this.Ndh=this.DBa=this.GZb=this.Hw=this.Ogh=this.yVg=this.zVg=this.uBa=this.GXa=this.Cye=this.GVa=this.zVa=this.W=this.X5=this.Rza=null;U.a.zwa&&(this.e4d=6);this.pv=da;this.sZ=J.KeyInputManager.kc(K.a.t1,0);this.render()}get containerElement(){return this.W}dispose(){var da=n.AFrameworkApplication.ta.fD;const aa=n.AFrameworkApplication.ta.gD;da.rc(F.a.click,this.W,Object(e.a)(this,this.ESi,"onContainerClick"));da.rc(F.a.mB,this.W,Object(e.a)(this,
this.FSi,"onContainerDoubleClick"));aa.rc(F.a.vh,this.W,Object(e.a)(this,this.GSi,"onContainerKeyPress"));this.zVa&&(da.rc(F.a.click,this.zVa,Object(e.a)(this,this.rTf,"onDeleteButtonClick")),aa.$pb(this.zVa,this.lRg));this.GVa&&(da.rc(F.a.click,this.GVa,Object(e.a)(this,this.yTf,"onDoneButtonClick")),aa.$pb(this.GVa,this.tSg));this.uBa&&(da.rc(F.a.click,this.uBa,Object(e.a)(this,this.H7d,"onSaveButtonClick")),aa.$pb(this.uBa,this.Ndh));this.Rza&&(da.rc(F.a.click,this.Rza,Object(e.a)(this,this.QSf,
"onCancelButtonClick")),aa.$pb(this.Rza,this.tNg));this.GXa&&(da.rc(F.a.click,this.GXa,Object(e.a)(this,this.wVf,"onReplyButtonClick")),aa.$pb(this.GXa,this.tch));this.Hw&&(aa.rc(F.a.Zt,this.Hw,Object(e.a)(this,this.rGa,"onKeyEvent")),aa.rc(F.a.vh,this.Hw,Object(e.a)(this,this.rGa,"onKeyEvent")),U.a.ti&&(da=n.AFrameworkApplication.ta.dlc,da.rc(F.a.SGc,this.Hw,Object(e.a)(this,this.lGa,"onCompositionEvent")),da.rc(F.a.R2b,this.Hw,Object(e.a)(this,this.lGa,"onCompositionEvent")),da.rc(F.a.S2b,this.Hw,
Object(e.a)(this,this.lGa,"onCompositionEvent"))),w.a.instance.rc(F.a.paste,this.Hw,Object(e.a)(this,this.D_c,"onPaste")));this.DBa=this.GZb=this.Hw=this.Rza=this.uBa=this.Cye=this.GVa=this.GXa=this.zVa=this.W=null}focus(){I.FocusManager.instance().cD(z.AFrame.Gr);this.W.focus();this.pv.Sq.eof().Zj.Gy(this.W)}l0h(){I.FocusManager.instance().cD(a.a.IGc);this.Hw.focus();this.pv.Sq.eof().Zj.Gy(this.Hw);2===this.pv.Tq&&this.Hw.value&&0<this.Hw.value.length&&L.a.T5c(this.Hw);const da=this.pv.Sq.wca.F0c,
aa=L.a.p1a(da,this.W);aa.y+this.W.clientHeight>da.scrollTop+da.clientHeight&&(da.scrollTop=aa.y+this.W.clientHeight-da.clientHeight)}ECl(){Sys.UI.DomElement.removeCssClass(this.W,"NewOrEditComment");this.Rza.style.display="none";this.Hw.style.display="none";I.FocusManager.vkg(this.Hw);I.FocusManager.vkg(this.uBa);I.FocusManager.instance().ge(a.a.IGc).ir(this.sZ);I.FocusManager.instance().B5a(a.a.IGc);J.KeyInputManager.instance.rc(F.a.Zt,this.Hw,Object(e.a)(this,this.rGa,"onKeyEvent"));J.KeyInputManager.instance.rc(F.a.vh,
this.Hw,Object(e.a)(this,this.rGa,"onKeyEvent"));if(U.a.ti){const da=n.AFrameworkApplication.ta.dlc;da.rc(F.a.SGc,this.Hw,Object(e.a)(this,this.lGa,"onCompositionEvent"));da.rc(F.a.R2b,this.Hw,Object(e.a)(this,this.lGa,"onCompositionEvent"));da.rc(F.a.S2b,this.Hw,Object(e.a)(this,this.lGa,"onCompositionEvent"))}w.a.instance.rc(F.a.paste,this.Hw,Object(e.a)(this,this.D_c,"onPaste"));this.X5.removeChild(this.Hw);this.X5.removeChild(this.GZb);this.DBa=this.GZb=this.Hw=null;this.Gmg();this.Oad();this.focus()}Oad(){this.$aj(this.Ogh,
this.zVg,this.yVg,this.Cye,this.W)}render(){var da=l.a("a",this.Fha("cc"),"CommentContainer");R.a.gr(da,R.a.cfa,a.a.N0k);da.tabIndex=0;this.pv.Df&&(da.className+=" Reply1");var aa=l.a("div",this.Fha("ch"),"CommentHeaderRow");const ea=l.a("span",this.Fha("ca"),"CommentAuthor UIFontBold");ea.innerText=this.pv.author;aa.appendChild(ea);const na=l.a("span",this.Fha("ct"),"CommentDate");na.innerText=X.Pfl(this.pv.date,this.pv.Sq.Ofl,this.pv.Sq.rHo);Sys.UI.DomElement.addCssClass(na,n.AFrameworkApplication.isRtl?
"FloatLeft":"FloatRight");aa.appendChild(na);const pa=l.a("span",this.Fha("ci"),"CommentStatusIcon");aa.appendChild(pa);let ja=null;this.pv.LGb&&(ja=y.a.i_a(this.Fha("cl"),a.a.R_k,CommonUIStrings.l_CommentCancelButton,"ClosePaneGlyph_16x16x32",!1),Sys.UI.DomElement.addCssClass(ja,n.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight"),ja.tabIndex=0,aa.appendChild(ja));this.X5=l.a("div",this.Fha("cn"),"CommentContent");let ma=null,Ia=null,Ja=null;this.pv.LGb?(ma=l.a("textarea",this.Fha("ce"),a.a.eGh+
" UIFont"),ma.rows=this.e4d,ma.cols=50,ma.tabIndex=0,R.a.gr(ma,"title",CommonUIStrings.l_CommentContent),this.X5.appendChild(ma),Ia=l.a("div","","CommentTextMeasurementContainer"),Ja=l.a("textarea","",a.a.eGh+" UIFont"),Ja.rows=1,Ja.cols=50,Ja.style.visibility="hidden",Ja.spellcheck=!1,Ia.appendChild(Ja),this.X5.appendChild(Ia),2===this.pv.Tq&&(ma.value=this.pv.text.join("\n")+"\n")):this.Gmg();const Ka=l.a("div","","CommentFooterRow"),Ma=l.a("span",this.Fha("cf"),""),sa=y.a.i_a(this.Fha("cr"),a.a.H0k+
" CommentFooterButton",CommonUIStrings.l_CommentReplyButton,"CommentReply_16x16x32",!1);sa.tabIndex=0;sa.setAttribute(R.a.qh,R.a.e3);Ma.appendChild(sa);const xa=y.a.i_a(this.Fha("cd"),"CommentDoneButton CommentFooterButton",CommonUIStrings.l_CommentDoneButton,"CheckboxUnchecked_16x16x32",!1);xa.tabIndex=0;const ia=xa.childNodes[0].childNodes[0];Ma.appendChild(xa);const ha=y.a.i_a(this.Fha("cx"),a.a.S_k+" CommentFooterButton",CommonUIStrings.l_CommentDeleteButton,"Delete_16x16x32",!1);xa.tabIndex=
0;Ma.appendChild(ha);Ka.appendChild(Ma);const ua=l.a("span",this.Fha("cfa"),""),ya=y.a.i_a(this.Fha("cs"),a.a.I0k,CommonUIStrings.l_CommentSaveCommentButton,null);y.a.MNb(ya,!1);ya.tabIndex=0;ua.appendChild(ya);Ka.appendChild(ua);this.$aj(pa,Ma,ua,ia,da);this.pv.Sq.jJh||(ea.setAttribute("Unselectable","on"),na.setAttribute("Unselectable","on"));da.appendChild(aa);da.appendChild(this.X5);da.appendChild(Ka);this.W=da;this.GVa=xa;this.Cye=ia;this.zVa=ha;this.GXa=sa;this.uBa=ya;this.Hw=ma;this.GZb=Ia;
this.DBa=Ja;this.Rza=ja;this.zVg=Ma;this.yVg=ua;this.Ogh=pa;da=n.AFrameworkApplication.ta.fD;aa=n.AFrameworkApplication.ta.gD;da.lb(F.a.click,this.W,Object(e.a)(this,this.ESi,"onContainerClick"));da.lb(F.a.mB,this.W,Object(e.a)(this,this.FSi,"onContainerDoubleClick"));aa.lb(F.a.vh,this.W,Object(e.a)(this,this.GSi,"onContainerKeyPress"));this.GVa&&(da.lb(F.a.click,this.GVa,Object(e.a)(this,this.yTf,"onDoneButtonClick")),this.tSg=aa.lnb(this.GVa,Object(e.a)(this,this.yTf,"onDoneButtonClick"),K.a.zs));
this.GXa&&(da.lb(F.a.click,this.GXa,Object(e.a)(this,this.wVf,"onReplyButtonClick")),this.tch=aa.lnb(this.GXa,Object(e.a)(this,this.wVf,"onReplyButtonClick"),K.a.zs));this.uBa&&(da.lb(F.a.click,this.uBa,Object(e.a)(this,this.H7d,"onSaveButtonClick")),this.Ndh=aa.lnb(this.uBa,Object(e.a)(this,this.H7d,"onSaveButtonClick"),K.a.zs));this.zVa&&(da.lb(F.a.click,this.zVa,Object(e.a)(this,this.rTf,"onDeleteButtonClick")),this.lRg=aa.lnb(this.zVa,Object(e.a)(this,this.rTf,"onDeleteButtonClick"),K.a.zs));
this.Rza&&(da.lb(F.a.click,this.Rza,Object(e.a)(this,this.QSf,"onCancelButtonClick")),this.tNg=aa.lnb(this.Rza,Object(e.a)(this,this.QSf,"onCancelButtonClick"),K.a.zs));ma&&(aa.lb(F.a.Zt,ma,Object(e.a)(this,this.rGa,"onKeyEvent")),aa.lb(F.a.vh,ma,Object(e.a)(this,this.rGa,"onKeyEvent")),U.a.ti&&(da=n.AFrameworkApplication.ta.dlc,da.lb(F.a.SGc,ma,Object(e.a)(this,this.lGa,"onCompositionEvent"),null),da.lb(F.a.R2b,ma,Object(e.a)(this,this.lGa,"onCompositionEvent"),null),da.lb(F.a.S2b,ma,Object(e.a)(this,
this.lGa,"onCompositionEvent"),null)),w.a.instance.lb(F.a.paste,ma,Object(e.a)(this,this.D_c,"onPaste")),this.Nno())}Slj(da){y.a.MNb(this.uBa,da)}Fha(da){return da+"_"+this.pv.id}$aj(da,aa,ea,na,pa){switch(this.pv.KSa){case 0:case 1:this.Hrj(da,0);break;case 2:case 4:da.style.display="none";break;case 3:Sys.UI.DomElement.addCssClass(pa,"SaveFailure"),Sys.UI.DomElement.addCssClass(pa,"NoReply"),this.Hrj(da,1)}this.pv.done?(Sys.UI.DomElement.addCssClass(pa,"CommentIsDone"),na.className=A.getImageClass("CheckboxChecked_16x16x32")):
(Sys.UI.DomElement.removeCssClass(pa,"CommentIsDone"),na.className=A.getImageClass("CheckboxUnchecked_16x16x32"));this.pv.LGb?(Sys.UI.DomElement.addCssClass(pa,"NewOrEditComment"),Sys.UI.DomElement.addCssClass(pa,"SelectedComment"),da.style.display="none",aa.style.display="none",ea.style.display="inline",0===this.pv.Sq.mode&&(this.Slj(!1),y.a.MNb(this.Rza,!1))):(1===this.pv.Kia?(Sys.UI.DomElement.addCssClass(pa,"SelectedComment"),Sys.UI.DomElement.removeCssClass(pa,"SelectedParentComment"),aa.style.display=
1!==this.pv.Sq.mode||3===this.pv.KSa||this.pv.fQa?"none":"inline"):(2===this.pv.Kia?(Sys.UI.DomElement.removeCssClass(pa,"SelectedComment"),Sys.UI.DomElement.addCssClass(pa,"SelectedParentComment")):(Sys.UI.DomElement.removeCssClass(pa,"SelectedComment"),Sys.UI.DomElement.removeCssClass(pa,"SelectedParentComment")),aa.style.display="inline"),ea.style.display="none")}Hrj(da,aa){O.a.tC(da);switch(aa){case 0:aa=document.createElement("img");aa.alt=CommonUIStrings.l_CommentProgressTooltip;aa.src=v.a.Oaa("progress16.gif");
da.appendChild(aa);break;case 1:aa=A.createClusteredImage(16,16,"Risks_16x16x32","",!0,CommonUIStrings.l_CommentFailTooltip),da.appendChild(aa)}da.style.display="inline-block"}Gmg(){O.a.e_(this.X5);var da=this.pv.text;1===da.length&&da[0]&&(da=da[0].split("\n"));for(const aa of da)da=l.a("p","","CommentContentPara"),da.innerText=aa||"\u00a0",this.pv.Sq.jJh||da.setAttribute("Unselectable","on"),this.X5.appendChild(da)}Nno(){const da=I.FocusManager.instance().ge(a.a.IGc);da.parent=z.AFrame.Gr;G.a.instance.S_b(a.a.IGc,
this.Hw);da.bindAction(J.KeyInputManager.kc(K.a.Rqe,2),W.a.Hg);da.bindAction(this.sZ,W.a.i8e);da.bindAction(J.KeyInputManager.kc(K.a.H5,0),W.a.P_a);da.bindAction(J.KeyInputManager.kc(K.a.vda,0),W.a.P_a);da.ir(I.FocusManager.instance().nW);da.ir(I.FocusManager.instance().oW)}ESi(da){if(this.pv.LGb&&da.Gb.target===this.Hw)return!0;this.pv.LVf();return!0}FSi(){this.pv.hTi();return!0}GSi(da){let aa=!1;da.Gb.keyCode===K.a.zs&&(0===this.pv.Kia?this.pv.LVf():this.pv.hTi(),aa=!0);return aa}rTf(){if(this.zVa.disabled)return!0;
this.pv.Rha();return!0}yTf(){if(this.GVa.disabled)return!0;this.pv.dtn();return!0}wVf(){if(this.GXa.disabled)return!0;this.pv.Xqn();return!0}H7d(){if(this.uBa.disabled)return!0;this.pv.AKb(this.Hw.value);return!0}QSf(){if(this.Rza.disabled)return!0;this.pv.$Jb();return!0}rGa(da){if(da.Gb.ctrlKey&&da.Gb.keyCode===K.a.zs)return 0<this.Hw.value.length&&this.H7d(null),!0;if(da.Gb.keyCode===K.a.t1)return!0;this.onTextEntered(da.eventName===F.a.Zt&&da.Gb.charCode===K.a.zs);return!1}lGa(){this.onTextEntered(!1);
return!1}D_c(){const da=new N.a(0,1,0,()=>{this.onTextEntered(!1)},1);n.AFrameworkApplication.nc.Vb(da);return!1}onTextEntered(da){if(0!==this.pv.Sq.mode&&(this.Slj(0<this.Hw.value.length),!U.a.zwa)){this.GZb.clientWidth!==this.Hw.clientWidth&&(this.GZb.style.width=this.Hw.clientWidth+"px");this.DBa.value=this.Hw.value+"___";this.Xah>this.Hw.value.length&&(this.DBa.rows=1);for(var aa=0,ea=Number.MAX_VALUE;1<=(aa=this.DBa.scrollHeight-this.DBa.clientHeight)&&aa<ea;)ea=aa,this.DBa.rows++;this.DBa.rows<
this.e4d?this.Hw.rows=this.e4d:(da&&this.DBa.rows++,this.Hw.rows=this.DBa.rows);this.Xah=this.Hw.value.length}}static Pfl(da,aa,ea){if(!da||isNaN(da.getDate()))return"";let na=ea;const pa=new Date;if(pa.getFullYear()!==da.getFullYear()||pa.getMonth()!==da.getMonth()||pa.getDate()!==da.getDate())na=String.format(CommonUIStrings.l_CommentLongDateFormat,aa,ea);return da.localeFormat(na)}}Object(E.a)(X,"CommentViewObject",null,[9,1109]);var V=c(136);c.d(M,"Comment",function(){return Z});class Z{constructor(da,
aa,ea,na,pa,ja,ma,Ia,Ja=!1,Ka=null,Ma=null,sa=null){this.WKg=this.XKg=this.OSg=null;this.Ltd=0;this.hcb=2;this.Xza=0;this.Lye=this.SN=null;this.yEf=!1;this.objectId=null;this.fQa=!1;this._id=da;this.aXg=aa;this.JLg=ea;this.Tgd=na;this.Dsd=pa;this.XJa=ja;this.eW=ma;this.ZWg=Ia;this.OHh=Ja;this.cWj=Ka;this.dWj=Ma;this.usersByReactionType=sa;this.$i=m.a.instance}get id(){return this._id}set id(da){this._id=da}get author(){return this.ZZd?CommonUIStrings.l_RemovedAuthorName:this.JLg}get authorId(){return this.cWj}get e1b(){return this.dWj}get date(){return this.ZZd?
null:this.Tgd}set date(da){this.Tgd=da}get done(){return this.XJa}set done(da){this.XJa!==da&&(this.XJa=da,this.SN&&this.SN.Oad())}get nki(){return this.ZWg}set nki(da){this.ZWg=da}get Df(){return this.Dsd}set Df(da){this.Dsd=da}get text(){return this.eW}set text(da){this.eW=da;this.SN&&this.SN.Gmg()}get mPa(){return this.aXg}set mPa(da){this.aXg=da}get U_a(){return this.OSg}set U_a(da){this.OSg=da}get UDc(){return this.XKg}set UDc(da){this.XKg=da}get TDc(){return this.WKg}set TDc(da){this.WKg=da}get Kia(){return this.Ltd}set Kia(da){this.Ltd!==
da&&(this.Ltd=da,this.SN&&this.SN.Oad())}get KSa(){return this.hcb}set KSa(da){this.hcb===da||0===this.hcb&&2===da||3===this.hcb||(this.hcb=da,this.SN&&this.SN.Oad())}get Tq(){return this.Xza}set Tq(da){if(this.Xza!==da){const aa=this.LGb&&0===da;this.Xza=da;aa&&this.SN&&this.SN.ECl()}}get LGb(){return 1===this.Xza||2===this.Xza}get ZZd(){return!!this.$i&&this.$i.removePersonalInformation}get containerElement(){return this.SN?this.SN.containerElement:null}get Sq(){return this.$i}get gz(){return this.Lye}set gz(da){this.Lye=
da}dispose(){this.SN&&(this.SN.dispose(),this.SN=null)}render(){this.SN=new X(this);return this.SN.containerElement}g4a(){this.SN&&this.SN.Oad()}focus(){this.LVf();this.SN.focus();this.LGb&&this.SN.l0h()}toString(){let da="[null]";this.eW&&0<this.eW.length&&(da=30<this.eW[0].length?this.eW[0].substr(0,30)+"...":this.eW[0]);return String.format('I:{0} A:{1} T:{2} R:{3} D:{4} "{5}"',this._id||"[null]",this.JLg||"[null]",this.Tgd?this.Tgd.toString():"[null]",this.Dsd||"[null]",this.XJa,da)}LVf(){2===
this.Sq.mode||3===this.Sq.mode?this.LGb&&this.SN.l0h():(I.FocusManager.instance().cD(z.AFrame.Gr),1!==this.Ltd&&this.Sq.selectComment(this._id))}hTi(){this.Sq.BCo&&0===this.Xza&&(I.FocusManager.instance().cD(z.AFrame.Gr),this.Xza=2,this.hcb=0,this.Sq.editComment(this,null))}Mln(){3===this.Sq.mode&&(I.FocusManager.instance().cD(z.AFrame.Gr),this.Xza=0,this.hcb=2,this.Sq.E5e())}Rha(){I.FocusManager.instance().cD(z.AFrame.Gr);this.Sq.deleteComment(this)}dtn(){this.Sq.iAb(this,!this.XJa)}Xqn(){2!==this.Sq.mode&&
(I.FocusManager.instance().cD(z.AFrame.Gr),this.Sq.addReply(this.Dsd||this._id,null))}AKb(da){I.FocusManager.instance().cD(z.AFrame.Gr);this.eW=Array(1);this.eW[0]=da;1===this.Xza?this.Sq.jua(this):this.Sq.Jeb(this)}$Jb(){I.FocusManager.instance().cD(z.AFrame.Gr);this.Sq.wca.F0c&&this.Sq.wca.F0c.focus();1===this.Xza?(this.Sq.deleteComment(this),this.Sq.bfe(this.Df)):this.Mln()}static kKh(da,aa,ea,na){const pa=V.a.create().toString();da=new Z(pa,Z.Sjm,da,new Date,aa,!1,[],ea,!1,n.AFrameworkApplication.K.jb("PresenceUserId"),
n.AFrameworkApplication.K.jb("PresenceProvider"));da.Xza=1;da.hcb=0;da.Lye=na;return da}}Z.Sjm=null;Z.mZi=-1;Object(E.a)(Z,"Comment",null,[9,627])},1641:function(E,M,c){E=c(0);var m=c(1199),e=c(2003),a=c(1078),l=c(8),y=c(101),z=c(43),n=c(28),v=c(23),A=c(303),w=c(1083),G=c(933),F=c(58),I=c(2),K=c(762),J=c(20),N=c(79),R=c(396),O=c(741),L=c(19),U=c(16),W=c(7),X=c(369),V=c(851),Z=c(368),da=c(853),aa=c(526),ea=c(1030),na=c(31);class pa{constructor(){this.OLe=void 0}onKeyPressed(xa){return this.OLe?this.OLe(xa):
!1}setKeyPressHandler(xa){this.OLe=xa}}var ja=c(1433),ma=c(1609),Ia=c(1544),Ja=c(1508);c.d(M,"a",function(){return sa});var Ka;(function(xa){xa[xa.yLj=0]="ArrowDown";xa[xa.zLj=1]="ArrowUp";xa[xa.c6o=2]="ArrowLeft";xa[xa.d6o=3]="ArrowRight";xa[xa.End=4]="End";xa[xa.rNj=5]="Enter";xa[xa.j7o=6]="Escape";xa[xa.QNj=7]="Home";xa[xa.p9o=8]="Space";xa[xa.Tab=9]="Tab"})(Ka||(Ka={}));Object(E.b)("KeyIdentifier",Ka);var Ma;(function(xa){xa.Seen="Seen";xa.Tried="Tried";xa.Kept="Kept";xa.Rejected="Rejected"})(Ma||
(Ma={}));Object(E.b)("EngagementType",Ma);class sa extends G.a{constructor(xa,ia,ha,ua,ya,ra,La,oa,Ca,Aa,db,eb,ib,lb,Ya,Fa,$a,Db,gc){super();this.ga=xa;this.Te=ia;this.Kd=ha;this.rD=ua;this.ib=ya;this.sI=ra;this.Zz=La;this.rV=oa;this.gLa=Ca;this.BI=db;this.sK=eb;this.fBa=ib;this.IUj=lb;this.Fm=Ya;this.fd=Fa;this.cC=$a;this.KF=Db;this.Hc=gc;this.Vik=0;this.BRe=!1;this.CJe=1E3;this.Yik=3500;this.Dud="ContextIQSignalId";this.dSe=0;this.m0g=!0;this.Fma=()=>{this.gLa.reset();this.S_m()};this.q_c=(Eb,kb)=>
{for(const bb of kb.Hj)Eb=bb.intent,8===Eb.type&&(0<=bb.AIb?(Eb=Eb.Ib.paragraph,kb=this.Fm.PPd(Eb,8,bb.cpBegin,bb.cpEnd),1<=kb.count&&kb.J(0)&&(kb=Eb.characterData.indexOf("@",kb.J(0).begin),this.Fm.klg(Eb,bb.cpBegin,bb.cpEnd),kb=new m.a(8,kb,kb+1,F.a.create()),this.Fm.$Qa(Eb,kb))):this.OAa.Hv(U.a.K9e,!0,void 0,void 0,void 0,void 0))};Aa&&Aa.execute(Eb=>this.Pka=Eb);this.OAa=new ea.a;this.L2g=new pa;this.getPersonImageUrl=this.getPersonImageUrl.bind(this);this.F2h(!0);this.h2h();this.Kd.XZe(this.q_c);
this.IUj.xMb(this);this.$da=[new e.a(Ja.a.vdb,Ja.a.vdb)]}onSessionClose(){}onSessionConnect(){this.F2h(!1);this.h2h()}onSessionDisconnect(){}get KFb(){return this.$da}static YAi(xa){return Ia.a.QTc(xa)?xa.isStealth:!1}static jPd(xa){var ia,ha;if(0!==(null===(ia=null===xa||void 0===xa?void 0:xa.results)||void 0===ia?void 0:ia.length))return null===(ha=null===xa||void 0===xa?void 0:xa.results[0])||void 0===ha?void 0:ha.entityType}$Pa(xa,ia){return Ia.a.$Pa(xa,ia,aa.a.pAb)}q_a(xa,ia){xa=Ia.a.N6b(xa,
!1,aa.a.pAb);if(!xa||!xa.contains(ia))return null;ia=this.Te.qga(ia);return sa.nqg()&&sa.YAi(null===ia||void 0===ia?void 0:ia.content)?Ja.a.Rzd:Ja.a.vdb}onb(xa){sa.Acd()&&!this.tv&&(this.tv=xa,this.fBa.PMa((ia,ha)=>{ia=ha.paragraphNode;const ua=ha.uia;for(const ya of ha.contents)1!=ya.nG&&0!=ya.nG||Ia.a.pwf(ya.element,ia,ya.intents,this.XDc,this.DHa,this.sK,this.tv,ua,!1,aa.a.pAb)}))}h2h(){const xa=I.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1),ia=I.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQSatoriFlags",!1),ha=I.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAddressFlags",!1),ua=I.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQTopicFlags",!1),ya=I.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQLoopFlags",!1),ra=sa.Bcd()&&sa.UBf?void 0:[Object.assign(new da.CustomProp,{name:"Filter",
value:'{"And":[{"Term":{"PeopleType":"Person"}},{"Term":{"PeopleSubtype":"OrganizationUser"}}]}'})],La=Object.assign(new V.a,{parentPath:["Signal",da.ClientConfigSignal.getTypeName()],items:[Object.assign(new X.a,{id:"ClientConfigSignal",body:Object.assign(new da.ClientConfigSignal,{timestamp:Date.now(),sessionConfig:Object.assign(new da.SessionConfig,{clientConfig:Object.assign(new da.ClientConfig,{ecc:Object.assign(new da.EccConfig,{enabled:sa.Ccd()||sa.Bcd(),entities:[Object.assign(new da.EccEntityConfig,
{entityType:da.EntityType.People,enabled:!0,queryPrefix:["@"],customProps:ra}),Object.assign(new da.EccEntityConfig,{entityType:da.EntityType.File,enabled:!0,queryPrefix:["@"]}),Object.assign(new da.EccEntityConfig,{entityType:da.EntityType.Loop,enabled:xa,queryPrefix:["@"]})],bestMatch:Object.assign(new da.BestMatchConfig,{enabled:sa.mqg()}),scopes:Object.assign(new da.ScopeConfig,{enabled:!1})}),flag:Object.assign(new da.FlagConfig,{enabled:sa.Acd(),entities:[Object.assign(new da.EntityConfig,{entityType:da.EntityType.Loop,
enabled:xa&&ya}),Object.assign(new da.EntityConfig,{entityType:da.EntityType.Topic,enabled:ua}),Object.assign(new da.EntityConfig,{entityType:da.EntityType.Address,enabled:ha}),Object.assign(new da.EntityConfig,{entityType:da.EntityType.Satori,enabled:ia})]}),nudge:Object.assign(new da.NudgeConfig,{enabled:!1}),prediction:Object.assign(new da.PredictionConfig,{enabled:!1})})})})})]});this.Zz.kl().then(()=>{this.rV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Z.a,{operation:La}));W.ULS.sendTraceTag(520104021,
3034,50,"Submitted ClientConfigSignal Operation.")})}F2h(xa){const ia=Object.assign(new V.a,{parentPath:["Signal",da.StartupSignal.getTypeName()],items:[Object.assign(new X.a,{id:"SessionStartupSignal",body:Object.assign(new da.StartupSignal,{timestamp:Date.now()})})]});this.Zz.kl().then(()=>{xa&&this.wF();this.rV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Z.a,{operation:ia}));W.ULS.sendTraceTag(521412674,3034,50,"Submitted StartupSignal Operation.")})}wF(){sa.Ccd()&&(I.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQUseEccResultAnnotation",
!1)?(this.Te.lb(this,da.EccResultAnnotation.getTypeName()),W.ULS.sendTraceTag(521412673,3034,50,"Registered for EccResultAnnotations.")):(this.Te.lb(this,da.UserInitiatedResultAnnotation.getTypeName()),W.ULS.sendTraceTag(521412672,3034,50,"Registered for UserInitiatedResultAnnotations.")));sa.Acd()&&(this.Te.lb(this,da.FlagResultAnnotation.getTypeName()),W.ULS.sendTraceTag(512361884,3034,50,"Registered for FlagResultAnnotations."))}mRo(xa,ia,ha,ua,ya){const ra=void 0===ia?!1:this.dSe>ia;this.Tj.mF&&
!ra&&(xa=this.l2h(xa),ua&&xa.suggestionGroups&&0<xa.suggestionGroups.length&&(xa.suggestionGroups[0].previewData=ua.substring(ya+1,ua.length)),this.Tj.definition=xa,ia&&(this.dSe=ia));ia?(ua=Date.now(),ha=[Object.assign(new na.a,{name:this.Dud,string:ha}),Object.assign(new na.a,{name:"ContextIQMenuOpen",bool:this.Tj.mF}),Object.assign(new na.a,{name:"ContextIQStaleAnnotation",bool:ra})],this.OAa.KXc("ContextIQUserInitUserPerceivedLatency",ua-ia,1,!0,void 0,ha)):W.ULS.sendTraceTag(537966025,3034,15,
"SignalGenerationTime is undefined, can not determine if this annotation is stale or generate User Perceived Latency telemetry.")}l2h(xa){if(xa){var ia=[],ha=[];switch(xa.annotationType){case da.UserInitiatedResultAnnotation.getTypeName():var ua=xa.content;if(!ua)return;for(var ya of ua.results)ia=ia.concat(ya.results);ua=aa.a.HZa;break;case da.EccResultAnnotation.getTypeName():ya=xa.content;if(!ya)return;for(const ra of ya.entityResults)ia=ia.concat(ra.entities);sa.mqg()&&(ha=null===(ua=ya.treatments)||
void 0===ua?void 0:ua.bestMatchEntries);ua=aa.a.HZa;break;case da.FlagAnnotation.getTypeName():ia=ia.concat(xa.content.results);ua=aa.a.pAb;break;default:return}xa={annotationId:xa.id,results:ia,bestMatchResults:ha};if(ia=this.m0g)this.m0g=!1;return{...A.g,id:ua,suggestionGroups:[{type:ua,isContentPending:!1,contentData:xa,isFirstInvoke:ia}]}}}async getPersonImageUrl(xa,ia){xa=new K.a(xa,"O365",ia,xa);if(this.Pka&&this.Pka.getPersonaIconPropertiesArray&&(xa=await this.Pka.getPersonaIconPropertiesArray([xa]),
0<xa.length&&xa[0].authorImageURL))return xa[0].authorImageURL}static Fpe(){return sa.Ccd()||sa.Acd()}static Ccd(){return sa.zpe&&I.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAtMentionEntryPointIsEnabled",!1)}static Bcd(){return sa.zpe&&I.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQConsumerAtMentionEntryPointIsEnabled",!1)}static Acd(){return sa.zpe&&I.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQFlagsAreEnabled",
!1)}static nqg(){return I.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQStealthFlagsAreEnabled",!1)}static rMj(){return I.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CIQFlagsIgnoreOnce",!1)}static mqg(){return I.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQBestMatchIsEnabled",!1)}static zpe(){return!J.a.Wba&&!J.a.a4}static get N6a(){return sa.Xik}Wvo(xa){if(this.Pka){var ia={...A.g,id:aa.a.HZa,
suggestionGroups:[{type:aa.a.HZa,isContentPending:!0,contentData:{annotationId:"",results:[]}}]},ha=!1;this.ga.v_(U.a.jTa)&&(ha=!0);this.Tj.oqa(xa,ia,this,!0,!1,null,this.Fma,null,!1,ua=>{ua.shouldIgnoreFocusEvent=ya=>{var ra;return this.BRe?!0:ya===(null===(ra=this.fd.editingView)||void 0===ra?void 0:ra.editingElement)};ua.getPersonImageUrl=this.getPersonImageUrl},ha,!1,this.L2g)}else W.ULS.sendTraceTag(539068165,3034,15,"PeopleAPI was not ready in time for showing a User Init Context IQ Card")}FEh(){this.Tj.dismiss()}onKeyDown(xa){if(xa&&
xa.Gb){switch(xa.Gb.keyCode){case N.a.vda:var ia=Ka.yLj;break;case N.a.wL:ia=Ka.End;break;case N.a.zs:ia=Ka.rNj;break;case N.a.G5:ia=Ka.QNj;break;case N.a.ww:ia=Ka.Tab;break;case N.a.H5:ia=Ka.zLj}void 0!==ia&&(xa.Gb.stopPropagation(),xa.Gb.preventDefault(),this.L2g.onKeyPressed(ia))}}UD(xa,ia){if(xa&&xa.content&&ia===w.a.getTypeName()&&(xa.annotationType===da.UserInitiatedResultAnnotation.getTypeName()||xa.annotationType===da.EccResultAnnotation.getTypeName())){var ha=ia=void 0,ua=void 0,ya=0,ra=
xa.parentPath.split("\\");if(ra&&6===ra.length)if(ha=ra[5],ra=Date.now(),ha in sa.N6a){clearTimeout(sa.N6a[ha].IHo);ia=sa.N6a[ha].startTime;ua=sa.N6a[ha].mwo;ya=sa.N6a[ha].bBd;delete sa.N6a[ha];const La=[Object.assign(new na.a,{name:this.Dud,string:ha})];this.OAa.KXc("ContextIQUserInitALLatency",ra-ia,1,!0,void 0,La)}else W.ULS.sendTraceTag(537962376,3034,15,"SignalId is not in the dictionary, can not generate AL Latency telemetry.");else W.ULS.sendTraceTag(537966026,3034,15,"Annotation's parent path is not the expected length of 6. Can not generate AL Latency telemetry.");
this.mRo(xa,ia,ha,ua,ya)}}get types(){return[aa.a.HZa,aa.a.pAb]}Olg(xa,ia){this.Tj.mF&&this.Tj.Olg(xa,ia)}get XDc(){return!R.SessionStatusManager.instance.wj&&1!=I.AFrameworkApplication.ta.mode}DHa(xa){return xa&&Ia.a.QTc(xa)?!ma.a.D0b(xa):!1}hN(xa){if(sa.Fpe()){var ia,ha;if(R.SessionStatusManager.instance.wj||!this.XDc||!({annotation:ia,t0e:ha}=this.sK.yLd(xa.ll,xa.qif,this.DHa)).returnValue)return!1;if(ia.annotationType===da.FlagAnnotation.getTypeName()){let ua=!1;this.ga.v_(U.a.jTa)&&(ua=!0);const ya=
this.l2h(ia);xa=this.Tj.oqa(ha,ya,this,xa.BQa,xa.UNa,null,ra=>{(null===ra||void 0===ra?void 0:ra.cardType)!==aa.a.pAb||(null===ra||void 0===ra?0:ra.Ngg)||this.OAa.Hv(U.a.BFd,!0,void 0,void 0,void 0,void 0,{ohf:Ma.Tried,entityType:sa.jPd(ia.content)})},null,!1,null,ua);this.Tj.Gic({Ngg:!1,cardType:aa.a.pAb});xa&&this.OAa.Hv(U.a.BFd,!0,void 0,void 0,void 0,void 0,{ohf:Ma.Seen,entityType:sa.jPd(ia.content)});return xa}return!1}}YMo(xa,ia){this.Te.bza(xa,70);const ha=this.cC.j6h(xa,0);if(ha){const ua=
new a.a;ua.contentDescriptor=ha;ua.annotationType=xa.annotationType;ua.state=70;this.KF.setState(ia,ua)}}executeAction(xa,ia,ha,ua){var ya,ra,La,oa=Date.now();if(!ia)return!1;switch(xa.actionType){case A.b.Apply:this.Tj.Gic({cardType:null===(ya=this.Tj.definition)||void 0===ya?void 0:ya.id,Ngg:!0});this.iUd(xa.descriptorData,ia,ha,ua);ia={ohf:Ma.Kept,entityType:sa.jPd(null===(ra=this.Te.qga(xa.descriptorData.annotationId))||void 0===ra?void 0:ra.content)};this.OAa.Hv(U.a.BFd,!0,void 0,void 0,void 0,
void 0,ia);this.FEh();break;case A.b.ClearSearch:this.BRe=!0;this.clearSearch(ia,ha,ua,!1);this.Tj.mF&&(this.lrj(),ra=l.ParagraphReader.text(ia).substring(0,ha+1),this.umf(ia,ra,ha,oa));this.BRe=!1;break;case A.b.Retry:this.Tj.mF&&(this.lrj(),ra=l.ParagraphReader.text(ia).substring(0,ua),this.umf(ia,ra,ha,oa));break;case A.b.OpenEditorPane:if(32!==this.ga.processAction(U.a.jTa,2))return W.ULS.sendTraceTag(520898381,3034,15,"Failed to launch the editor pane from contextual card.",xa.actionType),!1;
break;case A.b.IgnoreOnce:if(!sa.rMj)return!1;ha=this.Te.qga(null===(La=xa.descriptorData)||void 0===La?void 0:La.annotationId);this.YMo(ha,ia.Kc);oa=this.Hc.Mc(3);try{oa.Cb(ia),ia.Tk(16,!0)}finally{oa&&oa.dispose()}this.OAa.Hv(U.a.BFd,!0,void 0,void 0,void 0,void 0,{ohf:Ma.Rejected,entityType:sa.jPd(ha.content)});this.Tj.dismiss();break;default:return W.ULS.sendTraceTag(539849408,3034,15,"Failed to process action of type {0} since it is not known to us.",xa.actionType),!1}return!0}umf(xa,ia,ha,ua){var ya,
ra;const La=ha.toString(),oa=xa.id.toString(),Ca=oa+"-"+La;var Aa=++this.Vik;const db=Ca+"-"+Aa;Aa=(Aa=y.FormattingReader.hPd(xa,ha,l.ParagraphReader.textLength(xa)))?y.FormattingReader.language(Aa):I.AFrameworkApplication.lcid;Aa=null!==(ra=null===(ya=O.a.og(Aa))||void 0===ya?void 0:ya.Klf)&&void 0!==ra?ra:"";ia.length>this.CJe&&(ha-=ia.length-this.CJe,ia=ia.slice(-this.CJe));const eb=Object.assign(new V.a,{parentPath:["Signal",ja.a.getTypeName(),oa,La,Ca],items:[Object.assign(new X.a,{id:db,body:Object.assign(new ja.a,
{languageId:Aa,startOfSentence:!0,text:ia,timestamp:Date.now(),userInitQuery:!0})})]});this.Zz.kl().then(()=>{this.rV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Z.a,{operation:eb}));W.ULS.sendTraceTag(521412643,3034,50,"Submitted Text Predictor Signal.");const ib=[Object.assign(new na.a,{name:this.Dud,string:db})];this.OAa.KXc("ContextIQUserInitSignalGenerationLatency",Date.now()-ua,1,!0,void 0,ib)});"@"===ia.slice(-1)&&ha===ia.length-1&&(ya=this.Fm.PPd(xa,8,ha,ha))&&0===ya.count&&
(ya=new m.a(8,ha,ha+1,F.a.create()),this.Fm.$Qa(xa,ya));xa=setTimeout(()=>{this.Lto(db)},this.Yik);sa.N6a[db]={startTime:ua,mwo:ia,bBd:ha,IHo:xa}}YTo(){if(this.Tj.mF&&this.Tj.definition&&this.Tj.definition.suggestionGroups&&this.Tj.definition.suggestionGroups[0]){const xa=this.Tj.definition;xa.suggestionGroups[0].isContentPending=!0;this.Tj.definition=xa}}lrj(){this.Tj.definition={...A.g,id:aa.a.HZa,suggestionGroups:[{type:aa.a.HZa,isContentPending:!0,contentData:{annotationId:"",results:[]}}]}}Lto(xa){if(xa in
sa.N6a){var ia=sa.N6a[xa].startTime;ia=void 0===ia?!1:this.dSe>ia;!ia&&this.Tj.mF&&(this.Tj.definition={...A.g,id:aa.a.HZa,suggestionGroups:[{type:aa.a.HZa,isContentPending:!1,errorMessage:"No results received from AugLoop",contentData:{annotationId:"",results:[]}}]});xa=[Object.assign(new na.a,{name:this.Dud,string:xa}),Object.assign(new na.a,{name:"ContextIQMenuOpen",bool:this.Tj.mF}),Object.assign(new na.a,{name:"ContextIQStaleSignal",bool:ia})];this.OAa.KXc("ContextIQUserInitALTimeout",1,0,!0,
void 0,xa)}}iUd(xa,ia,ha,ua){var ya=xa.type;switch(ya){case da.EntityType.File:this.insertHyperlink(ia,ha,ua,xa.fileName,xa.url+"?web=1");break;case da.EntityType.People:sa.UBf?this.insertHyperlink(ia,ha,ua,xa.displayName,"mailto:"+xa.primaryEmailAddress):this.DMo(xa,ia,ha,ua);break;case da.EntityType.Loop:this.gAm(xa,ia,ha,ua);break;case da.EntityType.Address:this.hzm(xa,ia,ha,ua);break;case da.EntityType.Satori:ya="https://www.bing.com/search?q="+xa.title.replace(" ","+");this.insertHyperlink(ia,
ha,ua,xa.title,ya);break;case da.EntityType.Topic:this.insertHyperlink(ia,ha,ua,xa.title,xa.url);break;default:W.ULS.sendTraceTag(539849409,3034,15,"Failed to process entity of type {0} since it is not known to us.",ya)}}DMo(xa,ia,ha,ua){const ya=xa.primaryEmailAddress,ra=new K.a(ya,"O365",xa.displayName,ya);this.Pka.checkUserAccess(ra).then(La=>{La.UserCanWrite?(W.ULS.sendTraceTag(539100301,3034,50,"User has the correct permissions to be AtMentioned"),this.zSc(ia,ha,ua,ra)):this.ABj(ra,ia,ha,ua)},
()=>{W.ULS.sendTraceTag(539100302,3034,15,"Got back failed response from checking user access for AtMentioned User");this.ABj(ra,ia,ha,ua)})}ABj(xa,ia,ha,ua){this.Pka.grantUsersAccess([xa]).then(ya=>{let ra=!1;ya.Details&&(ra=ya.Details.Result[0].UserCanWrite);ra?(W.ULS.sendTraceTag(539100303,3034,50,"AtMentioned User has been granted access"),this.zSc(ia,ha,ua,xa)):(W.ULS.sendTraceTag(539100304,3034,50,"AtMentioned user has been denied access"),this.clearSearch(ia,ha,ua,!0))},()=>{W.ULS.sendTraceTag(539100305,
3034,15,"Failed Response from Attempt to grant access to AtMentioned user")})}zSc(xa,ia,ha,ua){this.Fm.klg(xa,ia,ha);this.OAa.Hv(U.a.K9e,!0,void 0,void 0,void 0,void 0);this.sI.zSc(xa,ia,ha,ua.DisplayName,ua.Email)}insertHyperlink(xa,ia,ha,ua,ya){if(xa){var ra=new z.GraphTransaction(15),La=ua+" ";try{ra.Cb(xa);this.Fm.klg(xa,ia,ha);this.OAa.Hv(U.a.K9e,!0,void 0,void 0,void 0,void 0);this.Kd.replaceTextRange(n.a.createTextRange(xa,ia,ha),La);const oa=L.a.y9b(ya);this.rD.hG(n.a.createTextRange(xa,ia,
ia+ua.length),oa,!1,!1,!1);this.ib.setSelection(v.SelectionFactory.te(xa,ia+La.length))}finally{ra&&ra.dispose()}}else W.ULS.sendTraceTag(509612897,3034,15,"Paragraph node is undefined/null.")}gAm(xa,ia,ha,ua){if(ia){var ya=new z.GraphTransaction(15);try{ya.Cb(ia);this.Kd.replaceTextRange(n.a.createTextRange(ia,ha,ua),"");this.ib.setSelection(v.SelectionFactory.te(ia,ha));const ra=xa.id;ra===aa.a.S6m?this.ga.processAction(U.a.FSc,2):ra===aa.a.Q6m?this.ga.processAction(U.a.sSc,2):W.ULS.sendTraceTag(537458136,
3034,15,"Trying to insert unsupported loop type.")}finally{ya&&ya.dispose()}}else W.ULS.sendTraceTag(537458135,3034,15,"Paragraph node is undefined/null.")}hzm(xa,ia,ha,ua){if(ia){var ya=new z.GraphTransaction(15);try{ya.Cb(ia);const ra=L.a.y9b(xa.url);this.rD.hG(n.a.createTextRange(ia,ha,ua),ra,!1,!1,!1);this.ib.setSelection(v.SelectionFactory.te(ia,ua));const La=this.Te.qga(xa.annotationId);this.Te.bza(La,60)}finally{ya&&ya.dispose()}}else W.ULS.sendTraceTag(509434014,3034,15,"Paragraph node is undefined/null.")}clearSearch(xa,
ia,ha,ua){if(xa){var ya=new z.GraphTransaction(15);ua||(ia+=1);try{ya.Cb(xa),this.Kd.replaceTextRange(n.a.createTextRange(xa,ia,ha),""),this.ib.setSelection(v.SelectionFactory.te(xa,ia))}finally{ya&&ya.dispose()}}else W.ULS.sendTraceTag(529413333,3034,15,"Paragraph node is undefined/null.")}S_m(){this.BI.execute(xa=>{xa.logActivity("CIQ_AtInvoke",null)})}}sa.UBf=!1;sa.Xik={};Object(E.a)(sa,"ContextIQIntentProvider",G.a,[251,283])},1651:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.handler=
null}}Object(E.a)(m,"SetAnnotationResultCallbackParameters",null,[])},1653:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{static get lfc(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}m.eDb="fontInfoTaskPane";m.experienceId="modernfontpicker";Object(E.a)(m,"FontInfoPaneConstants",null,[])},1654:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.endDate=this.startDate=null}}Object(E.a)(m,"CommentTaskSchedule",null,[])},1655:function(E,
M,c){c.d(M,"a",function(){return e});E=c(0);var m=c(80);class e{static get kd(){return null!=e.Wxg?e.Wxg:e.Wxg=new m.a}static owk(a){e.kd.addHandler(e.ISi,a)}static Swk(a){e.kd.addHandler(e.hVi,a)}}e.ISi="OnCopyComment";e.hVi="OnPasteComment";Object(E.a)(e,"CommentEventsManager",null,[])},1656:function(E,M,c){c.d(M,"a",function(){return m});const m={hjf:"TasksFeatureUsage",lFo:"TaskExperienceDegraded",Oke:"TaskCreate",Pke:"TaskEngagement"}},1659:function(E,M,c){c.d(M,"c",function(){return y});c.d(M,
"b",function(){return z});c.d(M,"a",function(){return n});var m=c(74),e=c(7),a=c(2),l=c(35);const y=v=>{if(!v)return null;let A;try{A=l.b(v)}catch(w){A=null,e.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",w)}return A},z=(v,A)=>{let w=[];if(v.breadcrumbs&&0<v.breadcrumbs.length)w=v.breadcrumbs;else{const G=v.service_info;G&&G.friendly_service_name&&Array.add(w,G.friendly_service_name);v.display_path&&Array.addRange(w,v.display_path)}return w.join(A?
" \u00ab ":" \u200f\u00bb ")},n=(v,A=!1)=>{if(!v)return[];if(!v.documents)return e.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!v.documents.items)return e.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];v=v.documents.items;const w=new m.a;for(let F=0;F<v.length;F++){const I=v[F];var G=I.web_url;if(!G){e.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!I.url){e.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}G=String.format("{0}?web=1",I.url)}const K=
{};K.DocumentUrl=G;K.MruId=I.mru_id;{G=I;let J=G.title;J?(G.extension&&(J=String.format("{0}.{1}",J,G.extension)),G=J):(e.ULS.sendTraceTag(578352837,202,15,"empty file title"),G="")}K.FileName=G;K.IsPinned=I.is_pinned;K.Path=z(I,a.AFrameworkApplication.isRtl);A&&(K.App=I.app,K.TimeStamp=I.time_stamp);w.add(K)}return w.toArray()}},1660:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}m.Callback="action";Object(E.a)(m,"MenuLauncherAsyncTriggerCommandProperties",null,[])},1661:function(E,
M,c){var m=this&&this.lE||(Object.create?function(a,l,y,z){void 0===z&&(z=y);Object.defineProperty(a,z,{enumerable:!0,get:function(){return l[y]}})}:function(a,l,y,z){void 0===z&&(z=y);a[z]=l[y]}),e=this&&this.__exportStar||function(a,l){for(var y in a)"default"===y||Object.prototype.hasOwnProperty.call(l,y)||m(l,a,y)};Object.defineProperty(M,"__esModule",{value:!0});e(c(1812),M);e(c(1813),M);e(c(1814),M);e(c(1815),M);e(c(1816),M);e(c(1817),M);E.exports.TextToImageAnnotation||Object.defineProperty(E.exports,
"TextToImageAnnotation",{enumerable:!0,get:function(){return E.exports.TextToImageAnnotation}});E.exports.TextToImageSignal||Object.defineProperty(E.exports,"TextToImageSignal",{enumerable:!0,get:function(){return E.exports.TextToImageSignal}})},1662:function(E,M,c){var m=this&&this.lE||(Object.create?function(a,l,y,z){void 0===z&&(z=y);var n=Object.getOwnPropertyDescriptor(l,y);if(!n||("get"in n?!l.bC:n.writable||n.configurable))n={enumerable:!0,get:function(){return l[y]}};Object.defineProperty(a,
z,n)}:function(a,l,y,z){void 0===z&&(z=y);a[z]=l[y]}),e=this&&this.__exportStar||function(a,l){for(var y in a)"default"===y||Object.prototype.hasOwnProperty.call(l,y)||m(l,a,y)};Object.defineProperty(M,"__esModule",{value:!0});e(c(1818),M);e(c(1819),M);E.exports.ThemeExtractorAnnotation||Object.defineProperty(E.exports,"ThemeExtractorAnnotation",{enumerable:!0,get:function(){return E.exports.ThemeExtractorAnnotation}});E.exports.ThemeExtractorSignal||Object.defineProperty(E.exports,"ThemeExtractorSignal",
{enumerable:!0,get:function(){return E.exports.ThemeExtractorSignal}})},1663:function(E,M,c){var m=this&&this.lE||(Object.create?function(a,l,y,z){void 0===z&&(z=y);var n=Object.getOwnPropertyDescriptor(l,y);if(!n||("get"in n?!l.bC:n.writable||n.configurable))n={enumerable:!0,get:function(){return l[y]}};Object.defineProperty(a,z,n)}:function(a,l,y,z){void 0===z&&(z=y);a[z]=l[y]}),e=this&&this.__exportStar||function(a,l){for(var y in a)"default"===y||Object.prototype.hasOwnProperty.call(l,y)||m(l,
a,y)};Object.defineProperty(M,"__esModule",{value:!0});e(c(1820),M);e(c(1821),M);E.exports.TableType||Object.defineProperty(E.exports,"TableType",{enumerable:!0,get:function(){return E.exports.TableType}});E.exports.TableTypeAnnotation||Object.defineProperty(E.exports,"TableTypeAnnotation",{enumerable:!0,get:function(){return E.exports.TableTypeAnnotation}})},1665:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(E.a)(m,
"CalloutButtonProps",null,[])},1666:function(E,M,c){function m(){a||(e.Health.instance.addQosPillar("AsyncCollab"),a=!0)}c.d(M,"a",function(){return m});var e=c(83);let a=!1},1667:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a=0,l=!1){this.UHj=!1;this.paragraphNode=e;this.IQf=a;this.UHj=l}}Object(E.a)(m,"ReviewActionArgs",null,[])},1671:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e=0,a=0,l=0,y=0,z="",n="",v="",A="",w="0pt",G="0pt",F="0pt",
I="0pt"){this.borderTopStyle=e;this.borderRightStyle=a;this.borderBottomStyle=l;this.borderLeftStyle=y;this.borderTopColor=z;this.borderRightColor=n;this.borderBottomColor=v;this.borderLeftColor=A;this.borderTopWidth=w;this.borderRightWidth=G;this.borderBottomWidth=F;this.borderLeftWidth=I}}Object(E.a)(m,"TableCellBorderProperties",null,[])},1672:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e="",a="",l="",y=""){this.WSk=e;this.VSk=a;this.TSk=l;this.USk=y}}Object(E.a)(m,
"TableCellMarginProperties",null,[])},1676:function(E,M,c){c.d(M,"a",function(){return a});E=c(0);var m=c(43);c(6);var e=c(7);class a{constructor(l,y){this.q5m=()=>{e.ULS.sendTraceTag(39358976,324,50,"ForceSave request was successful in AutoSaveParamsUpdateService.")};this.Xwa=(z,n)=>{e.ULS.sendTraceTag(39358977,324,10,"ForceSave request failed in AutoSaveParamsUpdateService with status code {0}.",n)};this.ltb=y}eij(l,y,z,n=null,v=null,A=null){if(l){var w=new m.GraphTransaction(0);w.Cb(l);l.setValue(y,
z);w.dispose();try{this.ltb(15,!1,n||this.q5m,v||this.Xwa,A,null,null)}catch(G){e.ULS.sendTraceTag(39358947,324,10,"Error calling ForceSave in TableOfContentsActor.SendSaveRequest. Message: {0}",G.message)}}else e.ULS.sendTraceTag(39358946,324,10,"AutoSaveParametersNode is null in AutoSaveParamsUpdateService.")}}Object(E.a)(a,"AutoSaveParamsUpdateService",null,[296])},1677:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);var m=c(7);class e{constructor(a){this.cyj=a}ie(a,l){if(a){var y=this.cyj();
a();a=this.cyj();m.ULS.sendTraceTag(555307094,345,50,`${l}-${a-y}`)}else m.ULS.shipAssertTag(520127454,345,!1)}}Object(E.a)(e,"PerfLogger",null,[524])},1678:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a){this.paragraphNode=e;this.state=a}}Object(E.a)(m,"ReviewCompletedArgs",null,[])},1679:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a){this.index=e;this.count=a}}Object(E.a)(m,"DesignerReviewPosition",null,[])},1680:function(E,M,c){c.d(M,
"a",function(){return e});E=c(0);var m;(function(a){a[a.empty=0]="empty";a[a.filled=1]="filled"})(m||(m={}));Object(E.b)("BlueDotHighlightContextType",m);class e{constructor(a,l,y=WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionTooltipClick,z=m.empty){this.ar=a;this.OEc=l;this.PIo=y;this.BJk=z}}Object(E.a)(e,"BlueDotHighlightContext",null,[])},1681:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.lv=this.Ao=this.marginRight=this.marginLeft=this.marginBottom=
this.marginTop=0;this.Cwa=!1;this.NKb=this.jJb=5;this.hma=this.RE=this.BGc=0;this.i_k=!1}}Object(E.a)(m,"SectionPropertiesData",null,[])},1682:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(190);class m extends c.a{constructor(){super();this.OnRetryCommandId=this.RetryButtonTitle=this.AriaDescription=this.IconName=this.Label=null}get ControlType(){return 12}}Object(E.a)(m,"ErrorViewProps",c.a,[])},1683:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(190);class m extends c.a{constructor(){super();
this.CommandValueId=this.ActionCommandValueId=this.ActionText=this.ActionId=this.Links=this.Description=this.SecondaryLabel=this.Label=this.iconSet=this.ActionCommandId=this.CommandId=null}get ControlType(){return 13}}Object(E.a)(m,"MultiActionButtonProps",c.a,[])},1684:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}Object(E.a)(m,"PersonaInfo",null,[])},1685:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}Object(E.a)(m,"PersonaIdentifiers",null,[])},1686:function(E,
M,c){c.d(M,"a",function(){return m});E=c(0);M=c(1129);c=c(1061);class m{}m.F0=[new M.a(1440,1440,1440,1440),new M.a(720,720,720,720),new M.a(1440,1440,1080,1080),new M.a(1440,1440,2880,2880),new M.a(1440,1440,1800,1800)];m.Bpa=[new c.a(12240,15840),new c.a(12240,20160),new c.a(10440,15120),new c.a(11907,16839),new c.a(8391,11907)];Object(E.a)(m,"PredefinedPageProperties",null,[])},1688:function(E,M,c){c.d(M,"a",function(){return F});E=c(0);var m=c(201),e=c(2),a=c(22),l=c(20),y=c(18),z=c(1284),n=c(251),
v=c(437),A=c(7),w=c(453),G=c(681);class F{constructor(I,K,J,N,R,O,L,U,W,X,V,Z,da,aa){this.kr=I;this.Ttb=K;this.Ma=J;this.sq=N;this.Es=R;this.mE=O;this.kaa=L;this.P9a=U;this.L9a=W;this.N9a=X;this.O9a=V;this.J$a=Z;this.K$a=da;this.Lmd=aa}build(I,K,J,N){const R=new m.QueryStringBuilder("WordOart.ashx");e.AFrameworkApplication.Sea(R);R.Ce(w.a.nodeId,K.id.toString());K=y.ImageReader.K6l(K,I.Kc);R.Ce(G.a.CHd,K?K.ia(v.a.MRf,""):"");R.Ce(G.a.width,this.sq.toString());R.Ce(G.a.height,this.Es.toString());R.Ce(G.a.h1c,
this.kaa.toString());R.Ce(G.a.b1n,z.a[this.Ttb]);K=this.Ma.$("WordEditorImageCropIsEnabled");R.Ce(G.a.lNh,K.toString());K&&(R.Ce(G.a.top,this.P9a.toString()),R.Ce(G.a.bottom,this.L9a.toString()),R.Ce(G.a.left,this.N9a.toString()),R.Ce(G.a.right,this.O9a.toString()));K=this.Ma.$("WordEditorImageRotateIsEnabled");R.Ce(G.a.Bej,K.toString());K&&(R.Ce(G.a.angle,this.mE.toString()),R.Ce(G.a.flipH,this.J$a?"true":"false"),R.Ce(G.a.flipV,this.K$a?"true":"false"));R.Ce(G.a.lZf,J?"true":"false");R.Ce(G.a.strict,
this.Lmd?"true":"false");this.Ma.$("WacWordEditorRenderHighContrastGraphicsIsEnabled")&&this.kr&&this.kr.Mxf&&R.Ce(G.a.S1a,this.kr.Mxf);(I=I.Bi())?(R.Ce(w.a.fileId,I.rr),R.Ce(w.a.cellId,I.wm.toString())):A.ULS.sendTraceTag(575522528,322,10,"parentGraphSpace is null. Cannot set FileId and CellId. url: {0}",R.toString());I=a.a.instance.Na("Box4.IFeatureHelper");I=!!I&&I.isFeatureEnabled(49);R.Ce(G.a.oql,"true");R.Ce(G.a.Pym,I.toString());R.Ce(G.a.HUh,"true");I&&R.Ce(G.a.z0i,I.toString());R.Ce(G.a.Sym,
"true");n.a.instance.Wyb(R);J&&N&&!l.a.ut&&R.FI(G.a.yeb,window.self.devicePixelRatio.toString());R.Ce(G.a.Nvh,"true");return R.toString()}}Object(E.a)(F,"WordOartEndpointUrlBuilder",null,[])},1689:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);var m=c(15);class e{constructor(a,l){this._id=a;this.Fb=l;this.$Ok=l.ia(m.a.uha,0);this.YOk=l.ia(m.a.tha,0)}getId(){return this._id}}Object(E.a)(e,"GraphicsEditorImageContainer",null,[594])},1690:function(E,M,c){c.d(M,"a",function(){return L});E=c(0);
var m=c(58),e=c(2),a=c(123),l=c(201),y=c(18),z=c(514),n=c(1180),v=c(6),A=c(145),w=c(42),G=c(15),F=c(41),I=c(437),K=c(116),J=c(989),N=c(7),R=c(681),O=c(1688);class L{constructor(U,W,X,V,Z,da){this.properties=null;this.kr=W;this.Oj=V;this.Ma=Z;this.Tz=da}oTo(U,W,X){U.eU||(W.setValue(v.a.gAd,U.IAk),W.setValue(v.a.dLd,U.N5b));this.NKj(U,W,X)}pTo(U,W,X){W.setValue(v.a.cLb,U.IXo);y.ImageReader.HQd(W,X.Kc,!1)!==U.PWf&&W.Eg(v.a.T9d,A.a.Wt,A.a.lpa,w.a.g8a);if(U.H8d)W.setValue(G.a.Bca,m.a.If(U.H8d));else{var V=
this.NKh(U.PWf,U.QWf,U.extension);X.Kc.Ju(V);W.setValue(G.a.Bca,V.id)}U.Joe?W.setValue(w.a.g8a,m.a.If(U.Joe)):U.xJj&&(V=this.NKh(U.xJj,U.Mog,U.extension),X.Kc.Ju(V),W.setValue(w.a.g8a,V.id));W.ia(v.a.U9d,"")!==U.G3c&&(""!==U.G3c?W.setValue(v.a.U9d,U.G3c):W.removeProperty(v.a.U9d));0===U.Bua&&0===U.Dua&&0===U.Cua&&0===U.Aua||this.Oj.Dag(W,U.Dua,U.Aua,U.Bua,U.Cua);void 0!==U.lockAspectRatio?W.setValue(v.a.OX,U.lockAspectRatio):W.setValue(v.a.OX,!1);U.hKk&&(this.$Nb(W,v.a.hia,U.exh),this.$Nb(W,v.a.vpa,
U.borderStyle),this.$Nb(W,v.a.GGa,U.borderColor));void 0!==U.altTextDescription&&W.setValue(v.a.NX,U.altTextDescription);this.$Nb(W,F.a.alphaModFix,U.alphaModFix);this.NKj(U,W,X);U=z.a.instance.iif(W);W.setValue(v.a.Cca,U)}NKh(U,W,X){const V=new J.a(524345);V.setValue(I.a.MRf,U);V.setValue(I.a.bfc,U);V.setValue(w.a.vzl,m.a.If(U).guid);V.setValue(v.a.Boi,W);V.setValue(I.a.ujf,e.AFrameworkApplication.rootQuerySignature);V.setValue(w.a.NYh,X);return V}NKj(U,W,X){U.eU?(this.properties=W,W.setValue(F.a.eU,
U.eU),U.QDc&&W.setValue(F.a.fAd,U.QDc),W.setValue(F.a.Sva,U.p1o),W.setValue(F.a.Tva,U.uqm),W.setValue(F.a.lPa,U.f5b),W.setValue(v.a.Ys,U.Ys),W.setValue(v.a.hCb,U.V4b),W.setValue(w.a.O_,0),this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&W.setValue(K.a.yOa,!1),W.setValue(K.a.T4,0),this.$Nb(W,F.a.E2a,U.Rwa),this.snh(W,X,!1,!0),this.$Vk(W)):(W.setValue(v.a.REa,U.REa),W.setValue(A.a.Wt,U.REa?U.sBn:""),U.yeb&&W.setValue(A.a.WFb,U.yeb),W.setValue(v.a.Ys,
U.Ys),W.setValue(v.a.hCb,U.V4b),W.setValue(v.a.Cca,U.BH),W.setValue(G.a.uha,a.a.oG(U.width)),W.setValue(G.a.tha,a.a.oG(U.height)),W.setValue(w.a.bZf,a.a.oG(U.width)),W.setValue(w.a.$Yf,a.a.oG(U.height)),W.setValue(A.a.PEa,-1),W.setValue(A.a.OEa,-1),W.setValue(G.a.Ewa,!0),W.setValue(v.a.jJ,U.rotationAngle),this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&W.setValue(K.a.yOa,!1),W.setValue(w.a.O_,0),U.REa&&this.snh(W,X,!0,!1),this.aWk(W));
5!=y.ImageReader.mk(W)?this.cWk(W):this.ZVk(W);this.$Nb(W,v.a.yQc,U.flipH);this.$Nb(W,v.a.KQc,U.flipV)}I1n(U,W,X,V,Z=null){U=this.Oj.D1n(U.$j,W,X,V);null==U?N.ULS.sendTraceTag(561538391,3001,10,"Failed to replace picture properties"):Z&&Z(U)}snh(U,W,X,V){let Z=!1;var da=this.Tz.Ts(W);da&&da.Lf(v.a.gGf)&&(Z=!0);da=y.ImageReader.pba(U);W=(new O.a(this.kr,y.ImageReader.mk(U),this.Ma,y.ImageReader.fF(U),y.ImageReader.wG(U),y.ImageReader.z_(U),y.ImageReader.Nhb(U),Math.max(da.top,0),Math.max(da.bottom,
0),Math.max(da.left,0),Math.max(da.right,0),y.ImageReader.DPd(U),y.ImageReader.ZDb(U),Z)).build(W,U,!0,!1);V&&(V=new l.QueryStringBuilder(W),V.Ce(R.a.LVd,"true"),W=V.toString());U.setValue(v.a.Ofb,W);X&&n.a.aOb(U,1,e.AFrameworkApplication.K,this.kr)}$Nb(U,W,X){void 0===X||null===X?U.removeProperty(W):U.setValue(W,X)}aWk(U){U.removeProperty(F.a.eU);U.removeProperty(F.a.fAd);U.removeProperty(F.a.Sva);U.removeProperty(F.a.Tva);U.removeProperty(F.a.lPa);U.removeProperty(F.a.F5d);U.removeProperty(F.a.Sol);
U.removeProperty(F.a.E2a)}cWk(U){U.removeProperty(v.a.T9d);U.removeProperty(v.a.cLb);U.removeProperty(G.a.Bca);U.removeProperty(v.a.U9d)}ZVk(U){U.removeProperty(v.a.dLd);U.removeProperty(v.a.gAd);U.removeProperty(F.a.eU);U.removeProperty(F.a.fAd)}$Vk(U){U.removeProperty(v.a.gAd);U.removeProperty(A.a.Wt);U.removeProperty(G.a.uha);U.removeProperty(G.a.tha);U.removeProperty(v.a.Cca);U.removeProperty(A.a.lpa);U.removeProperty(v.a.dLd);U.removeProperty(v.a.jJ)}}Object(E.a)(L,"GraphicsEditorImageEditor",
null,[570])},1691:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}Object(E.a)(m,"SmartLookupApplicationInterface",null,[])},1692:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a,l,y,z,n){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=e;this.url=a;this.spWebUrl=l;this.uniqueId=y;this.size=z;this.lastModified=n}}Object(E.a)(m,"FileInfo",null,[])},1699:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);
M=c(231);var m=c(109);class e extends M.a{constructor(){super();this.CellId=this.FileId=null}$k(){return 37}static construct(a){const l=new e;l.FileId=a.Bi().rr;l.CellId=m.a(a.Kc.id);return l}}Object(E.a)(e,"LastSavedRevisionRequest",M.a,[])},1719:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);var m=c(7);c=c(255);class e extends c.a{constructor(a,l,y,z){super(e.b3e);this.Hn=a;this.Gk=l;this.view=y;this.options=z}initialize(){super.initialize();const a=this.options.sNb==this.Gk.Jta(this.view.ed,
{TO:this.options.TO,Hba:this.options.R9b,Vna:this.options.Q9b,QO:this.options.QO});a&&!this.yoa&&m.ULS.sendTraceTag(557114691,3028,50,this.tT(this.Hn,!0,`satisfiedIfBlank=${this.options.sNb}`));this.Rg(a)}Md(){super.Md()}}e.b3e="BlankDocumentConditionId";Object(E.a)(e,"BlankDocumentCondition",c.a,[])},1723:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e){this.alt=this.ariaLabel=this.src=null;this.src=e}}Object(E.a)(m,"ImageProps",null,[])},1725:function(E,M,c){c.d(M,"a",
function(){return w});E=c(0);var m=c(58),e=c(8),a=c(12),l=c(7),y=c(16),z=c(1521),n=c(1505),v=c(1516),A=c(1509);class w{constructor(G,F,I,K,J,N,R){this.USi=(O,L)=>{L&&L.data&&L.data.ll&&(O=new A.a(L.data.ll,1,!0),this.zxe.hN(O))};this.$Vi=(O,L)=>{L&&L.data&&L.data.ll&&L.data.ll.node&&this.L_j.ePi(this.zxe,L.data.ll.node)};this.yhc=(O,L,U)=>{O=L.view.qe?L.view:null;if(!O||!O.mb)return 8;O=O.mb.hb.J(0).Qa;return e.ParagraphReader.Wb(O.node)?1===U?32:2===U?(U=new A.a(O,2,!1),this.zxe.hN(U),32):2:2};this.I3b=
(O,L,U)=>{var W,X;O=L.view.qe?L.view:null;if(!O||!O.mb)return 8;O=null===(W=O.mb.hb.J(0))||void 0===W?void 0:W.Qa;return O&&O.node?e.ParagraphReader.Wb(O.node)?1===U?32:2===U?(U=O.node,W=e.ParagraphReader.text(O.node),L=O.cpBegin,O=O.cpEnd-L,0<O&&(W=W.substr(L,O)),O=Math.floor(Math.random()*w.kfj),L=m.a.create(),l.ULS.sendTraceTag(541446531,3016,50,"Create Pull Quote invoked from context menu. PullQuote info: {0}; Document info: {1}",{["suggestionId"]:L,["textLength"]:W.length,["paragraphLength"]:e.ParagraphReader.textLength(U),
["paragraphRole"]:null===(X=this.dQ.pA(U))||void 0===X?void 0:X.role,["styleId"]:O},this.q$j.KPd()),X=[new z.c(new n.d(L,3,null,null,!1,O,W),U,O,W,V=>{this.LTb.Y2c(v.a.create(V));this.LTb.Dgc({role:27,paragraphNode:V,placeholder:!1})},3)],this.bfk.IAd(X),32):2:2:8};this.ga=G;this.zxe=F;this.L_j=I;this.LTb=K;this.bfk=J;this.dQ=N;this.q$j=R}initialize(){this.ga.fb(y.a.yhc,a.a.view,this.yhc,1028);this.LTb.lxk(this.$Vi);this.LTb.kwk(this.USi);this.ga.fb(y.a.I3b,a.a.view,this.I3b,4)}dispose(){this.ga.Lv(y.a.I3b,
a.a.view,this.I3b);this.LTb.c_n(this.USi);this.LTb.w_n(this.$Vi);this.ga.Lv(y.a.yhc,a.a.view,this.yhc)}}w.kfj=5;Object(E.a)(w,"DesignerActionListener",null,[1041,9])},1727:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}m.seen="Seen";m.kept="Kept";m.rejected="Rejected";Object(E.a)(m,"CritiqueAction",null,[])},1736:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.QPj="PageContentOrigin";this.nNj=500;this.kvg=["resize"];this.hHo=e=>()=>{!this.Kjd&&e&&
(this.Kjd=setTimeout(()=>this.IDh(),this.nNj),e())}}addHandler(e){this.CMb();this.DKa=this.hHo(e);this.$tn(this.DKa);this.kvg.forEach(a=>{window.addEventListener(a,this.DKa)})}CMb(){var e;this.IDh();null===(e=this.Glh)||void 0===e?void 0:e.disconnect();this.kvg.forEach(a=>{window.removeEventListener(a,this.DKa)});this.DKa=void 0}IDh(){this.Kjd&&(clearTimeout(this.Kjd),this.Kjd=void 0)}$tn(e){this.Glh=new MutationObserver(e);(e=document.getElementsByClassName(this.QPj)[0])&&this.Glh.observe(e,{attributes:!0,
attributeFilter:["style"]})}}Object(E.a)(m,"EditorAiWindowEventManager",null,[])},1737:function(E,M,c){c.d(M,"a",function(){return a});E=c(0);var m=c(38),e=c(11);class a{constructor(l){var y,z;this.yo=l;this.DR=null;this.DR=null===(z=null===(y=this.yo)||void 0===y?void 0:y.Bd)||void 0===z?void 0:z.container}addHandler(l){this.DR&&(this.CMb(),this.DKa=l,m.a.addHandler(this.DR,e.a.scroll,this.DKa),m.a.addHandler(this.DR,e.a.resize,this.DKa))}CMb(){this.DR&&this.DKa&&(m.a.removeHandler(this.DR,e.a.scroll,
this.DKa),m.a.removeHandler(this.DR,e.a.resize,this.DKa))}}Object(E.a)(a,"EditorAiPositionManager",null,[])},1739:function(E,M,c){var m=c(0),e=c(1799),a=c(365),l=c(602),y=c(58),z=c(22),n=c(1999),v=c(2),A=c(106),w=c(92),G=c(1595),F=c(182);class I{constructor(bc,vc){this.CommentId=bc;this.ResolveState=vc}}Object(m.a)(I,"CommentProperties",null,[]);var K=c(575),J=c(2001),N=c(2002),R=c(1640),O=c(189),L=c(1797);class U extends L.a{constructor(bc,vc="",Vc="",yd="",ee=!1){super(bc,vc,Vc,yd,ee);this.DateUtc=
null}}Object(m.a)(U,"CommentReactionUser",L.a,[]);var W;(function(bc){bc[bc.like=1]="like"})(W||(W={}));Object(m.b)("ReactionType",W);var X;(function(bc){bc[bc.first=0]="first";bc[bc.done=0]="done";bc[bc.undone=1]="undone";bc[bc.addComment=2]="addComment";bc[bc.deleteComment=3]="deleteComment";bc[bc.editComment=4]="editComment";bc[bc.addReaction=5]="addReaction";bc[bc.removeReaction=6]="removeReaction";bc[bc.last=7]="last"})(X||(X={}));Object(m.b)("CommentChangeType",X);var V=c(238),Z=c(586),da=c(243);
class aa{constructor(){this.Weh=this.mhh=!1;this.Ulk=[]}get Elc(){return this.Ulk}get gPb(){return this.mhh}set gPb(bc){this.mhh=bc;for(const vc of this.Elc)vc.gPb=bc}get VNb(){return this.Weh}set VNb(bc){this.Weh=bc;for(const vc of this.Elc)vc.VNb=bc}x7a(bc){for(const vc of this.Elc)bc=vc.x7a(bc);return bc}}Object(m.a)(aa,"AggregateCommentTaskPersonTransformer",null,[934]);var ea=c(7),na=c(136),pa=c(1592);class ja{constructor(bc,vc){this.o9j=new da.a(()=>vc.x7a(bc.value))}$Rl(){return new Date}h_a(bc,
vc,Vc){if(0===bc)throw ea.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");const yd=na.a.create().toString();Vc=new pa.a(bc,this.o9j.value,Vc,yd,!1);Vc.commentId=vc;ea.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",bc);return Vc}}Object(m.a)(ja,"HistoryRecordFactory",null,[935]);var ma=c(1654);class Ia{constructor(bc,vc,Vc,yd,ee,Qe){this.isLossy=
bc;this.title=vc;this.assignees=Vc;this.schedule=yd;this.completion=ee;this.priority=Qe}}Object(m.a)(Ia,"CommentTaskState",null,[]);class Ja{constructor(){this.commentId=null}}Object(m.a)(Ja,"HistoryItem",null,[]);class Ka{constructor(bc,vc,Vc,yd,ee,Qe,ue){this.FEe=!1;if(1!==vc.type)throw Error.argument("createRecord");this.crc=Vc;this.Zqc=yd;this.$qc=ee;this.s7g=1;this.wkd=bc;this.oak=Qe;this._state=new Ia(!1,this.crc,ue,new ma.a,this.$qc,this.Zqc);this._history=[];this.ELh(vc)}L3b(bc,vc){if(1!==
bc.type)throw Error.argument("createRecordTemplate");const Vc=Ka.Hcm(bc,this.s7g);this.s7g++;return Object.assign(new pa.a(vc,bc.user,bc.time,Vc),{commentId:bc.commentId})}get MDi(){return this.history[this.history.length-1]}get Kli(){return this.state.completion===this.$qc}get Jli(){return this.state.priority===this.Zqc}get Lli(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get Mli(){return this.state.title===
this.crc}ELh(bc){bc=Object.assign(new Ja,{commentId:bc.commentId,records:[bc]});this.history.push(bc)}M3h(bc){let vc=-1;for(let Vc=0;Vc<this.state.assignees.length;Vc++)if(this.wkd.equals(this.state.assignees[Vc],bc)){vc=Vc;break}return vc}zoo(bc){const vc=this.MDi,Vc=vc.records[vc.records.length-1];return this.wkd.equals(Vc.user,bc.user)&&vc.commentId===bc.commentId&&Vc.time.getTime()===bc.time.getTime()?!0:!1}AXo(bc){switch(bc.type){case 2:-1===this.M3h(bc.assignee)&&this.state.assignees.push(bc.assignee);
break;case 3:const vc=this.M3h(bc.assignee);0<=vc&&this.state.assignees.splice(vc,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=bc.schedule;break;case 6:this.state.completion=bc.completion;break;case 9:this.state.title=bc.title;break;case 10:this.state.priority=bc.priority;break;case 0:this.state.isLossy=!0;break;case 1:ea.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.FEe=!0;break;case 8:this.FEe=!1;break;case -1:ea.ULS.sendTraceTag(51139905,
327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}bc.isLossy&&(this.state.isLossy=!0);this.zoo(bc)?this.MDi.records.push(bc):this.ELh(bc)}get isDeleted(){return this.FEe}get state(){return this._state}get history(){return this._history}KXl(bc){if(!bc)return this.history;const vc=Array.clone(this.history),Vc=vc[0],yd=Vc.records.shift();if(!this.oak){var ee=this.L3b(yd,4);Vc.records.unshift(ee)}!bc.Kli&&this.Kli&&(ee=this.L3b(yd,6),ee.completion=this.$qc,Vc.records.unshift(ee));
!bc.Jli&&this.Jli&&(ee=this.L3b(yd,10),ee.priority=this.Zqc,Vc.records.unshift(ee));!bc.Lli&&this.Lli&&(ee=this.L3b(yd,5),ee.schedule=new ma.a,Vc.records.unshift(ee));!bc.Mli&&this.Mli&&(ee=this.L3b(yd,9),ee.title=this.crc,Vc.records.unshift(ee));bc.isDeleted&&(bc=this.L3b(yd,8),Vc.records.unshift(bc));return vc}static Hcm(bc,vc){return"Synthesized-"+bc.recordId+"-"+vc}}Object(m.a)(Ka,"CommentTaskStateBuilder",null,[]);class Ma{constructor(bc,vc,Vc,yd){this.id=bc;this.commentId=vc;this.currentState=
Vc;this.history=yd}}Object(m.a)(Ma,"CommentTaskItem",null,[]);var sa=c(1591);const xa=bc=>{const vc=new sa.a(bc.UserId,bc.Provider,bc.DisplayName,bc.Email);vc.IsCurrentUser=bc.IsCurrentUser;return vc};var ia=c(1794);class ha{static clone(bc){bc=ha.HYk(bc.extensions);return new ia.a(bc)}static xEh(bc){return bc?ha.clone(bc):null}static isEmpty(bc){return!bc.extensions||!bc.extensions.count}static jf(bc){return!bc||ha.isEmpty(bc)}static HYk(bc){if(!bc)return null;const vc=new a.a;bc.forEach((Vc,yd)=>
{vc.add(Vc,yd);return!0});return vc}}Object(m.a)(ha,"ExtensionListExtensions",null,[]);class ua{static clone(bc){var vc=xa(bc.user);vc=new pa.a(bc.type,vc,bc.time,bc.recordId,bc.isLossy);vc.commentId=bc.commentId;vc.anchorExtensionList=ha.xEh(bc.anchorExtensionList);vc.recordExtensionList=ha.xEh(bc.recordExtensionList);bc.assignee&&(vc.assignee=xa(bc.assignee));if(bc.schedule){var Vc=bc.schedule;const yd=new ma.a;yd.startDate=Vc.startDate;yd.endDate=Vc.endDate;vc.schedule=yd}vc.completion=bc.completion;
vc.title=bc.title;vc.priority=bc.priority;vc.undoId=bc.undoId;return vc}}Object(m.a)(ua,"HistoryRecordExtensions",null,[]);class ya{constructor(bc,vc,Vc,yd,ee,Qe,ue,ve=!1){this.wkd=bc;this.erd=vc;this.VLa=Vc;this.sZj=yd;this.crc=ee;this.Zqc=Qe;this.$qc=ue;this.lmd=ve}cdl(bc,vc,Vc,yd=null){if(!bc)throw ea.ULS.sendTraceTag(42796181,327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!vc)throw ea.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");
if(!Vc||!Vc.length)throw ea.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Vc[0].type)throw ea.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var ee=[],Qe=null,ue=this.BHn(Vc);for(var ve of Vc)if(!ue.contains(ve.recordId))if(Vc=this.lii(ve.commentId,yd),Vc=this.OIl(ve,Vc),1===Vc.type){let bf=[];this.lmd&&Qe&&Qe.state&&(bf=Qe.state.assignees);Qe=new Ka(this.wkd,
Vc,this.crc,this.Zqc,this.$qc,this.lmd,bf);ee.push(Qe)}else if(Qe)Qe.AXo(Vc);else throw ea.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");ue=null;ve=[];if(Qe){Qe.isDeleted||(ue=Qe.state);Qe=null;for(var xf of ee)ee=xf.KXl(Qe),Array.addRange(ve,ee),Qe=xf}xf=this.lii(vc,yd);ue&&(ue.completion=this.P1k(vc,
yd,ue.completion));return new Ma(bc,xf,ue,ve)}r2h(bc,vc,Vc,yd=null){if(!vc)throw ea.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(Vc&&!bc)throw ea.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const ee=[],Qe=this.VLa.$Rl();if(Vc){var ue=this.VLa.h_a(1,bc,Qe);ee.push(ue)}ue=null;if(vc.assigneeUpdate){if(!vc.assigneeUpdate.assigneesToAdd||!vc.assigneeUpdate.assigneesToRemove)throw ea.ULS.sendTraceTag(536999254,
327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var ve=0;ve<vc.assigneeUpdate.assigneesToAdd.length;ve++){var xf=this.FLh(2,vc.assigneeUpdate.assigneesToAdd[ve],bc,Qe);xf&&ee.push(xf)}for(ve=0;ve<vc.assigneeUpdate.assigneesToRemove.length;ve++)(xf=this.FLh(3,vc.assigneeUpdate.assigneesToRemove[ve],bc,Qe))&&ee.push(xf)}else vc.assignee&&(Vc||(ue=this.VLa.h_a(4,bc,Qe),ee.push(ue)),ve=this.VLa.h_a(2,bc,Qe),ue=this.erd.x7a(vc.assignee),ve.assignee=ue,ee.push(ve));
vc.title?(yd=this.VLa.h_a(9,bc,Qe),yd.title=vc.title,ee.push(yd)):Vc&&yd&&(ve=this.VLa.h_a(9,bc,Qe),ve.title=this.sZj.wfm(yd,ue),ee.push(ve));if(vc.schedule){if(vc.schedule.startDate>vc.schedule.endDate)throw ea.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");yd=this.VLa.h_a(5,bc,Qe);yd.schedule=vc.schedule;ee.push(yd)}if(void 0!==vc.completion&&null!==vc.completion){yd=vc.completion;if(0>yd||100<yd)throw ea.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),
Error.argumentOutOfRange("completion");Vc||ea.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",yd);Vc=this.VLa.h_a(6,bc,Qe);Vc.completion=yd;ee.push(Vc)}if(void 0!==vc.priority&&null!==vc.priority){vc=vc.priority;if(0>vc||10<vc)throw ea.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");bc=this.VLa.h_a(10,bc,Qe);bc.priority=vc;ee.push(bc)}return ee}FLh(bc,vc,Vc,yd){if(2!==bc&&3!==bc)return ea.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),
null;bc=this.VLa.h_a(bc,Vc,yd);bc.assignee=this.erd.x7a(vc);return bc}BHn(bc){const vc=new l.a,Vc=new l.a;for(let yd=bc.length-1;0<=yd;yd--){const ee=bc[yd],Qe=Vc.contains(ee.recordId);Qe||-1!==ee.type||(Vc.contains(ee.undoId)?ea.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):Vc.add(ee.undoId));if(Qe||-1===ee.type)vc.contains(ee.recordId)?ea.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):
vc.add(ee.recordId)}return vc}OIl(bc,vc){const Vc=ua.clone(bc);Vc.commentId=vc;Vc.user=this.erd.x7a(bc.user);Vc.assignee=this.erd.x7a(bc.assignee);return Vc}P1k(bc,vc,Vc){let yd=Vc;bc&&vc&&(({value:vc}=vc.Dc(bc)).returnValue?(yd=vc.ResolveState?100:100===Vc?0:Vc,yd!==Vc&&ea.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",bc)):ea.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",
bc));return yd}lii(bc,vc){let Vc=bc;bc&&vc&&(({value:vc}=vc.Dc(bc)).returnValue?Vc=vc.CommentId:(ea.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",bc),Vc=bc));return Vc}}Object(m.a)(ya,"CommentTaskTranslatorImpl",null,[936]);var ra=c(1031),La=c(1204);class oa{constructor(){this.Vfb=CommonUIStrings.l_Ellipsis}wfm(bc,vc){if(!bc)throw ea.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");
try{var Vc=G.a.QDb(bc)}catch(xf){throw ea.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var yd=bc=0,ee=0;const Qe=RegExp("\\s+","g"),ue=new Sys.StringBuilder;for(var ve of Vc.ops)ve.attributes&&ve.attributes.atmention&&ve.attributes.atmention.email&&vc&&(Vc=ve.attributes.atmention.email,0<Vc.length&&(Vc===vc.UserId||Vc===vc.Email||Vc===ra.a.vgb(vc.UserId))&&(yd=bc,ee=yd+ve.insert.length)),Vc=ve.insert.replace(Qe,
" "),bc+=Vc.length,ue.append(Vc);!ee&&vc&&ea.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",vc.Provider);vc=ue.toString().trimEnd();bc=vc.length;255<bc?(ve=(255-(ee-yd))/2,0>yd-ve?(bc=La.a.instance.E0a(vc,255-this.Vfb.length),ee=vc.substring(0,bc)+this.Vfb,bc="Trimmed End"):ee+ve>bc?(yd=La.a.instance.X0a(vc,bc-255+this.Vfb.length),ee=this.Vfb+vc.substring(yd,bc),bc="Trimmed Start"):(yd=La.a.instance.X0a(vc,yd-ve+this.Vfb.length),bc=La.a.instance.E0a(vc,ee+ve-this.Vfb.length),
ee=this.Vfb+vc.substring(yd,bc)+this.Vfb,bc="Trimmed Both")):(bc="No Trim",ee=vc);ea.ULS.sendTraceTag(592998804,327,50,bc);return ee}}Object(m.a)(oa,"ContentExtractor",null,[]);class Ca{constructor(bc,vc){this.m5j=bc;this.p9j=vc;this.VNb=this.gPb=!1}x7a(bc){if(!bc)return null;if(void 0===bc.UserId||null===bc.UserId)throw ea.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(bc.IsCurrentUser||!this.m5j.equals(this.p9j.value,bc))return bc;bc=xa(bc);bc.IsCurrentUser=
!0;return bc}}Object(m.a)(Ca,"EnsureIsCurrentUserSetTransformer",null,[934]);class Aa{constructor(){this.VNb=this.gPb=!1}x7a(bc){if(!bc)return null;if(void 0===bc.UserId||null===bc.UserId)return bc;if(!bc.Email||""===bc.Email){let vc;if(vc=ra.a.vgb(bc.UserId))return bc=xa(bc),bc.Email=vc,bc}return bc}}Object(m.a)(Aa,"RestoreEmailTransformer",null,[934]);class db{constructor(){this.VNb=this.gPb=!1}x7a(bc){if(!bc)return null;if(void 0!==bc.UserId&&null!==bc.UserId)return bc;switch(this.gPb?this.VNb?
2:1:0){case 0:if(void 0===bc.UserId||null===bc.UserId)throw ea.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");bc=xa(bc);break;case 1:if(void 0===bc.Id||null===bc.Id)throw ea.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===bc.Email||null===bc.Email)throw ea.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var vc=db.p_i(bc.Id,bc.Email,null);if(!vc||""===vc)throw ea.ULS.sendTraceTag(593368212,
327,10,"Failed to generate UserId"),Error.argument("UserId");var Vc=v.AFrameworkApplication.K.jb("HostAuthType")||"";if("aad"!==Vc.toLowerCase()||vc.startsWith("S::")){if("msa"===Vc.toLowerCase())throw ea.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");ea.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",Vc)}else throw ea.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");
bc=new sa.a(vc,"AD",bc.DisplayName,bc.Email);break;case 2:if(void 0===bc.UserPrincipalName||null===bc.UserPrincipalName)throw ea.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==bc.SuggestionSubtype&&null!==bc.SuggestionSubtype)if("OrganizationUser"===bc.SuggestionSubtype)vc="AD";else throw ea.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",bc.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");
else throw ea.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");Vc=db.p_i(bc.Id,bc.UserPrincipalName,bc.AadObjectId);if(!Vc||""===Vc)throw ea.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===vc&&!Vc.startsWith("S::"))throw ea.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");bc=new sa.a(Vc,vc,bc.Name,bc.UserPrincipalName);break;default:throw ea.ULS.sendTraceTag(593368203,
327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return bc}static p_i(bc,vc,Vc){if(!vc||""===vc)return ea.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),bc;if(Vc&&""!==Vc)return"S::"+vc+"::"+Vc;if(!bc||""===bc)return ea.ULS.sendTraceTag(593368217,327,50,"Missing ID"),bc;if(bc.startsWith("S::"))return bc;if(-1!==bc.indexOf("@")){Vc=bc.split("@");if(na.a.isValid(Vc[0]))return"S::"+vc+"::"+Vc[0];ea.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return bc}}
Object(m.a)(db,"UserIdCanonicalizationTransformer",null,[934]);class eb{constructor(bc,vc,Vc=!1,yd=!1){this.a1j=bc;this.vNg=vc;this.$9j=Vc;this.lmd=yd}i8k(){const bc=new ra.a;var vc=new da.a(eb.DRl);const Vc=new aa;this.vNg&&(Vc.Elc.push(new db),Vc.Elc.push(new Aa));this.a1j&&Vc.Elc.push(new Ca(bc,vc));Vc.gPb=this.vNg;Vc.VNb=this.$9j;vc=new ja(vc,Vc);const yd=new oa;return new ya(bc,Vc,vc,yd,eb.bhl,eb.Tgl,eb.Ugl,this.lmd)}static DRl(){const bc=new sa.a(v.AFrameworkApplication.K.jb("PresenceUserId")||
"",v.AFrameworkApplication.K.jb("PresenceProvider")||"",v.AFrameworkApplication.userName||"");bc.IsCurrentUser=!0;return bc}}eb.bhl="";eb.Tgl=5;eb.Ugl=0;Object(m.a)(eb,"CommentTaskTranslatorFactory",null,[925]);var ib=c(44),lb=c(170),Ya=c(13),Fa=c(5),$a=c(51),Db=c(9),gc=c(147),Eb=c(46),kb=c(23),bb=c(724),Gb=c(37),Sa=c(17),Pa=c(8),Ab=c(1199),nb=c(28),Rb=c(76),Mb=c(281),oc=c(133),xb=c(202),cc=c(391),Ob=c(705),Ub=c(332),pb=c(61),Zb=c(234),Wa=c(12),Lb=c(246),qc=c(6),Ra=c(694),yb=c(585),Bb=c(355),cb=c(55),
Xa=c(603),hb=c(110),Cb=c(77),ob=c(219),ab=c(1455),Ib=c(35),Yb=c(1033);class ub{create(){return new Yb.a}}Object(m.a)(ub,"CommentNodeFactory",null,[298]);var Ac=c(1195),Pc=c(1055),Mc=c(1495),Ed=c(1556);class ne{constructor(){this.vKc=this.X8c=null;this.VJd=this.uje=!1;this.xNa=this.SCa=null}}Object(m.a)(ne,"CommentAnchorParaNodesStatus",null,[]);var Ie=c(1391),cd=c(15);class Ic extends Ie.a{constructor(bc){super();this.Afk=bc}get index(){return 2}run(){this.Afk()}EFh(bc,vc){vc.property===cd.a.ff&&
this.pY()}}Object(m.a)(Ic,"CommentContentPropertyTracker",Ie.a,[]);var Rc=c(1486);class xc{constructor(bc,vc){this.sfc=bc;this.ksi=vc}}Object(m.a)(xc,"CommentIntentIdentifier",null,[]);var Ae=c(1023),Ue=c(1205),Xe=c(194),ef=c(157);class Se extends Ie.a{constructor(bc,vc){super();this.q9a=new yb.a(new Ae.a);this.d_b=new Ue.a(Rc.c);this.e_b=new Xe.ScriptSharpLegacyMap;this.xbk=bc;this.Bck=vc;this.e_b.add(qc.a.Maa,1);this.e_b.add(qc.a.wH,0);this.e_b.add(cd.a.ff,0);this.e_b.add(qc.a.z7,2)}get index(){return 4}run(){let bc=
"";for(const vc of this.q9a)if(this.xbk(vc),this.d_b.nb(vc.id))for(const Vc of this.d_b.J(vc.id))bc+="_"+Vc;this.Bck(bc);this.q9a.clear();this.d_b=new Ue.a(Rc.c)}C0k(bc,vc){bc=vc.property;if(bc===qc.a.Maa||bc===qc.a.wH||bc===cd.a.ff||ef.App.Zoe&&bc===qc.a.H2b||bc===qc.a.z7)this.q9a.add(vc.node),this.e_b.nb(bc)&&(this.d_b.nb(vc.node.id)||this.d_b.add(vc.node.id,new Xa.a),this.d_b.J(vc.node.id).add(this.e_b.J(bc))),this.pY();Mc.a.fOh.has(vc.node.id.toString())&&bc===qc.a.ZE&&ea.ULS.sendTraceTag(521484097,
327,15,"Durable ID changed of a Cut Pasted Comment")}O0k(bc,vc){vc.property===cd.a.mo&&(bc=vc.node,bc.NGb&&(this.q9a.add(bc),this.pY()))}sFo(bc,vc){this.q9a.add(vc.node);this.pY()}}Object(m.a)(Se,"CommentNodeTransactionCompletedProcessor",Ie.a,[]);var pc=c(1558),id=c(1596);class Xc{constructor(){this.Pye=new Map;this.UBe=new Map}uqk(bc,vc){if(this.Pye.has(bc))throw Error("DuplicateDurableId");if(this.UBe.has(vc))throw Error("DuplicateGuardId");this.Pye.set(bc,vc);this.UBe.set(vc,bc)}TWl(bc){return this.Pye.get(bc)}v7h(bc){return this.UBe.get(bc)}}
Object(m.a)(Xc,"CommentIdMapper",null,[]);var he=c(16),$d=c(1507),Ud=c(1656),Jf=c(1537),hh=c(119),Qi=c(113);c.d(M,"a",function(){return Lg});class Lg extends e.a{constructor(bc,vc,Vc,yd,ee,Qe,ue,ve,xf,bf,Df,nf,Yf,Kf,wb,Tb,Wc,Gd,Ye,od,vf,df,dh,Ki,Zh,rh=null,bm){super();this.qx=bc;this.pIe=vc;this.kIe=Vc;this.Hc=yd;this.DYj=ee;this.Oub=Qe;this.iXe=ue;this.Ypc=ve;this.Ma=xf;this.ld=bf;this.Fm=Df;this.KWb=nf;this.y6=Yf;this.yWb=Kf;this.n4g=wb;this.ih=Tb;this.Jm=Wc;this.IUa=Gd;this.rj=Ye;this.P1=od;this.XJ=
vf;this.mYa=df;this.Pzc=dh;this.bqc=[];this.aVa=[];this.wUe=new a.a(0);this.Msd=new a.a;this.Qvd=new yb.a(Bb.a.ei());this.XTe=new yb.a(Bb.a.ei());this.Dhd=null;this.Gsb=new a.a;this.sxe=!1;this.Dfd=new l.a;this.QZg=!1;this.Dve=new Set;this.ave=0;this.oZ=[];this.eUb=2;this.FBa=new a.a(!1);this.oxc=new l.a;this.Urc=new Map;this.yfd=new Xc;this.zfd=0;this.CYj=5;this.VJb=(Bf,ig)=>{Bf=ig.paragraphNode;for(const md of ig.contents)this.Wva(md.element,Bf,md.intents,md.nG)};this.ZZc=(Bf,ig)=>{if(Bf.Kc.id.equals(this.od.id)){this.IUa.VGa(7);
var md=Bf.getValue(qc.a.wH),td=Bf.getValue(qc.a.ZE).toString();md=this.ih.cgb?this.Urc.has(td)?this.Urc.get(td):td:md;md=this.KD(md);if(ig){if(md){this.ny&&this.ny.Df===md.id&&(ea.ULS.sendTraceTag(592188698,327,50,"Draft lost by parent deletion"),this.XJ.logKpiFailure($d.a.LEd,"DraftCommentLostOnParentDelete",{isIntentional:!1,isInternal:!0},{name:$d.a.wEd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}));ig=md.Df?"The comment is a reply":"";td=Rc.k(Bf,y.a.nil).toString();const wd=Rc.h(Bf,
y.a.nil).toString();if(this.Dfd.contains(md.id)&&!Mc.a.aHm(md.U_a)){this.Dfd.remove(md.id);const pm=+new Date-+md.date;ea.ULS.sendTraceTag(577307335,327,15,"New session comment deleted by inbound change: {0}. duration: {1}. startParaId: {2}. endParaId: {3}. {4}.",Rc.a(md),pm,td,wd,ig)}else ea.ULS.sendTraceTag(50426379,327,50,"{0} deleted by inbound changes. startParaId: {1}. endParaId: {2}. {3}.",Rc.a(md),td,wd,ig);this.$i.UIc(md);this.UPh(Bf.id)}}else if(!md){this.XJ.ensureFeatureDenominatorLoggedAndVetoPillarRegistered();
z.a.instance.Na("WordEditor.Comments.EditorCommentManager")||ea.ULS.sendTraceTag(525379405,327,10,"comment Manager resolve failed");if(this.ih.LBb&&!this.rj.dY){this.P1.s9("OnCommentInit",Object.assign(new pc.a,{uTi:()=>{this.iTf(Bf);this.tMb()}}));return}this.ih.Uq||this.rj.dY||this.P1.s9("OnCommentInit");this.QKn(Bf)||this.iTf(Bf)}this.sxe=!0}};this.tMb=(Bf=null)=>{this.ih.GPb&&this.jqi();this.ih.GPb&&this.vtl();this.KK.vMb(void 0,Bf);this.IUa.VGa(8)};this.fXi=(Bf,ig,md)=>{if(Bf.Kc.id.equals(this.od.id)){var td=
Bf.ia(qc.a.taskId,"");if(""===td)ea.ULS.sendTraceTag(42856717,3003,10,"Newly added or deleted task node does not have a task id.");else{if(ig)if(this.XTe.add(td),td=this.yWb.value.khi(Bf),void 0!==td&&null!==td)this.Gsb.remove(td);else{ea.ULS.sendTraceTag(591971722,3003,10,"A task without comment id was deleted even though that shouldn't be possible.");return}else if(this.Qvd.add(td),ig=this.yWb.value,Bf=ig.khi(Bf),void 0!==Bf&&null!==Bf)for(this.Gsb.J(Bf)?this.Gsb.Z(Bf,td):this.Gsb.add(Bf,td),Bf=
ig.mhi(td),ig=0;ig<Bf.length;ig++){var wd=Bf[ig].commentId;wd&&(wd=Number.parseInvariant(wd),this.Gsb.J(wd)||this.Gsb.add(wd,td))}else{ea.ULS.sendTraceTag(591971723,3003,10,"A task without comment id was added or modified even though that shouldn't be possible.");return}md&&this.tMb()}}};this.KRo=Bf=>{if(Mc.a.KXd(Bf)){const md=this.w_(Bf.id.toString());if(md){const td={text:md.text,done:md.done};var ig=Fa.GraphIterator.$a(Bf);md.text=this.FDb(ig);this.CIi(md.text);md.done=Bf.ia(qc.a.Maa,!1);Bf.hasProperty(qc.a.z7)&&
(ig=(ig=Bf.getValue(qc.a.z7))?Ib.b(ig||""):null,md.usersByReactionType=ig,Jf.a.ACh(md.usersByReactionType),this.QUk(md));this.NRo(Bf,md);md.Df||this.SRo(Bf,md);!this.ih.iua||!this.xE||this.ny&&this.ny.id===md.id||this.xE.fireEvent(10,{comment:md,vRi:td})}}else this.ld.isFeatureEnabled(116)&&72===Bf.type?this.fXi(Bf,!1,!1):this.MRo(Bf)};this.wtl=()=>{const Bf=this.gOd();for(this.bqc.sort((ig,md)=>{const td=ig.ia(qc.a.gM,null),wd=md.ia(qc.a.gM,null);if(!td&&wd)return-1;if(!wd&&td)return 1;ig.hasProperty(qc.a.TCa)&&
md.hasProperty(qc.a.TCa)?(ig=ig.getValue(qc.a.TCa),md=md.getValue(qc.a.TCa),md=ig<md):(ig=new Date(ig.getValue(qc.a.HGc)),md=new Date(md.getValue(qc.a.HGc)),md=ig<md);return md?-1:1});this.bqc.length;){const ig=this.bqc[0];Bf.hib(ig)&&(Bf.Gi(ig),this.$i.addComment(this.tGd(Bf),null),this.$i.mode=1);Array.removeAt(this.bqc,0)}if(Bf.Rb(1))for(;Bf.vf(1););this.ld.isFeatureEnabled(116)&&this.yWb.value.ohi();this.sxe&&(this.tMb(),this.sxe=!1)};this.ill=Bf=>{1===Bf&&(ob.WoncaApp.fle.TJh(),this.KWb.value.j6a(!0,
"CommentInboundFailed"));this.y6.VC($a.a.w$e,this.xDi)};this.$ga=Bf=>{if(!this.ih.Uq||Bf.done)return!1;if(Bf.Tq===n.a.beingCreated)return!0;if(Bf.objectId){if(this.JFm(Bf))return!1;if(!this.SLm(Bf.objectId)||Bf.Df)return!0;for(const ig of this.xO())if(ig.Df===Bf.id)return!0}return!1};Lg.WJ=rh;this.bpd=new yb.a(Bb.a.ei());!this.ih.LBb&&this.ih.Uq||Yb.a.kSa(this.ZZc);Zh.PMa(this.VJb);Ki&&(Ki.Kw((Bf,ig)=>{Bf=Rc.o(this.oZ,ig.node.id);0<this.oZ.length&&(!Bf||Bf===this.oZ.length-1)&&(this.eUb=1,this.oZ=
[])}),bm.execute(Bf=>{this.xE=Bf}),v.AFrameworkApplication.CM&&(v.AFrameworkApplication.ue("AutoPopulateShareTUIComment;AutoPopulateShareTUICommentCf"),this.ih.wHk&&this.Fpk()))}Fpk(){A.a.instance.Vb(new w.a(5,1,0,()=>{const bc=this.Hc.Mc(7);bc.Cb(this.UIa);var vc=Db.App.ya.gb.Uc;vc&&(vc=gc.PageNavigator.instance.IO(vc),vc=Fa.GraphIterator.$a(vc),vc.Qd(),vc.Qd(),vc.Qd(),vc.Qd(),Eb.a.instance.setSelection(kb.SelectionFactory.GK(vc.currentNode,0,0)),vc=new G.a,vc.Wga("Get the conversation going by adding comments and using Share (above) to send a link to this doc. It\u2019s free! No subscription or sign-in necessary. \n"),
this.dBb(Eb.a.instance.hb.kb,"Microsoft Word",vc),bc.dispose(),ib.a("ShareTUICommentCreated"),ea.ULS.sendTraceTag(520728590,327,50,"ShareTUICommentCreated"))}))}get KK(){return this.$i}get e0e(){return this.$g}get xDi(){return null!=this.cDg?this.cDg:this.cDg=Object.assign(new bb.a,{k3:WoncaIntl.WoncaStrings.l_InboundingCommentFailed,nfa:1})}get ur(){return this.Hc}get ax(){return this.qx.value}get od(){return this.ax.od}get UIa(){return this.pIe.value}get VCa(){return this.kIe.value}get mb(){return this.Oub.value}get zY(){return this.Ma.jb("PresenceUserId")}get Z4a(){return this.Ma.jb("PresenceProvider")}Wva(bc,
vc,Vc,yd){if(Vc&&this.ny&&(!this.ny||!this.ny.Df)){var ee=!1;for(const Qe of Vc)if(3===Qe.type)switch(ee=!0,Vc=Rc.n(this.oZ,Qe.id),-1<Vc&&(this.oZ[Vc].sfc=vc.id),bc.classList.add(Gb.a.pJd),yd){case 1:bc.classList.add(Gb.a.Tff);break;case 0:bc.classList.add(Gb.a.Uff)}ee||bc.classList.remove(Gb.a.pJd,Gb.a.Uff,Gb.a.Tff);this.IUa.VGa(3)}}fof(bc=!1){return this.iXe.hHl(this.$g,v.AFrameworkApplication.va.mode,vc=>!this.ih.WOb||!bc||this.$ga(vc))}Lnf(bc){return this.iXe.nNl(this.$i.model.xO(),v.AFrameworkApplication.va.mode,
bc)}Fsf(bc){if(!bc||!bc.Df)return bc;bc=bc.Df;for(let vc=0;vc<this.$g.length;vc++)if(this.$g[vc].id===bc)return this.$g[vc];return null}h8k(){const bc=[];if(this.ld.isFeatureEnabled(116)){var vc=this.yWb.value;for(const Vc of vc.ohi())(vc=this.H2h(Vc))&&bc.push(vc)}return bc}Vum(bc){if(!this.aVa)throw F.a.invalidOperation("UpdateContent must have been called before this.");for(let vc=0;vc<this.aVa.length;vc++)if(this.aVa[vc].id===bc)return vc;return-1}jqi(){const bc=new Cb.a;for(const Vc of this.$g)if(Vc.objectId&&
Vc.mPa){var vc=y.a.If(Vc.objectId);if((vc=this.od.Db(vc))&&vc.hasProperty(qc.a.ZE))if(vc=vc.getValue(qc.a.ZE).toString(),bc.nb(vc)){const yd=bc.J(vc).CommentId;this.QOj(yd,Vc,vc)}else bc.add(vc,new I(Vc.id,Vc.done))}this.Dhd=bc}QOj(bc,vc,Vc){bc!==vc.mPa?(ea.ULS.sendTraceTag(42866777,327,10,"Multiple comments contains the same DurableId [{0}]; ObjectId [{1}], GuardId [{2}], GuardId of existing entry: {3}",Vc,vc.objectId,vc.mPa,bc),this.XJ.logKpiFailure($d.a.K2b,"MultipleCommentsWithSameDurableId",
{isInternal:!0},{name:$d.a.J2b,isInternal:!0})):ea.ULS.sendTraceTag(554297428,327,15,"Duplicate entry of same comment with DurableId [{0}], GuardId [{1}], ObjectId [{2}]",Vc,vc.mPa,vc.objectId)}H2h(bc){const vc=this.n4g.value;var Vc=this.yWb.value;const yd=Vc.E8b(bc);if(void 0===yd||null===yd)return ea.ULS.sendTraceTag(592234717,3003,50,"GenerateTaskItemForTaskId was called with a taskId [{0}] that has no comment anchor id.",bc),null;Vc=Vc.mhi(bc);try{return vc.cdl(bc,yd.toString(),Vc,this.Dhd)}catch(ee){return ea.ULS.sendTraceTag(42856716,
3003,10,"CreateTaskItemFromHistoryRecords Failed due to [{0}]",ee.message),null}}K5h(bc=!1,vc=!1){const Vc=new l.a,yd=vc?Rc.j():new Set;this.FBa.keys.forEach(ee=>{yd.has(ee)||bc&&this.FBa.J(ee)||Vc.add(ee);return!0});return Vc}GQd(){if(!this.$g)return 0;let bc=0;for(const vc of this.$g)vc.Df||bc++;return bc}HTc(bc){var vc,Vc;return(null===(Vc=null===(vc=this.ny)||void 0===vc?void 0:vc.gz)||void 0===Vc?void 0:Vc.draftId)===bc}xqk(bc){var vc;if(bc.Tq===n.a.beingCreated){if(this.$i.mode=2,this.mab=bc,
this.mb.hb){var Vc=this.mb.hb.kb;if(Vc&&Vc.Qa){if(Sa.SelectionEditor.km(Vc)){var yd=Sa.SelectionEditor.C3(Vc.Qa,!1);yd&&(this.mb.setSelection(yd),Vc=yd)}for(yd=0;yd<Vc.length;yd++){var ee=Vc.J(yd).node;if(!Pa.ParagraphReader.Wb(ee)||!(-1!==Vc.J(yd).cpBegin&&-1!==Vc.J(yd).cpEnd||-1!==Vc.J(yd).Aj&&-1!==Vc.J(yd).Ip))continue;var Qe=-1===Vc.J(yd).cpBegin?Vc.J(yd).Aj:Vc.J(yd).cpBegin;const ue=-1===Vc.J(yd).cpEnd?Vc.J(yd).Ip:Vc.J(yd).cpEnd,ve=y.a.create();this.Fm.$Qa(ee,new Ab.a(3,Qe,ue,ve));this.oZ.push(new xc(ee.id,
ve));this.crk(null===(vc=bc.gz)||void 0===vc?void 0:vc.draftId,ee,Qe,Vc)}}}}else this.w3f(bc);Vc=({index:vc}=this.pme(bc)).returnValue;yd=null;if(!bc.Df){ee=this.K5h();bc.Tq!==n.a.beingCreated&&(yd=this.jam(bc),ee.remove(bc.objectId));ee=({index:Qe}=this.n2l(yd,ee)).returnValue;vc=-1<Qe?Qe:vc;Qe=0;if(ee)for(;vc<this.$g.length&&this.$g[vc].Df;)vc++;if(!ee&&this.ih.Uq&&bc.Tq===n.a.beingCreated)for(ee=0;ee<vc;ee++)this.$g[ee].Df||this.$g[ee].done||Qe++;this.CBo(bc,Qe)}Vc&&(Array.insert(this.$g,vc,bc),
this.ih.iua&&this.xE&&bc.Tq!==n.a.beingCreated&&(bc.Df?this.xE.fireEvent(10,{comment:bc,changeType:"replyAdded"}):this.xE.fireEvent(11,{comment:bc})),this.Aqk(bc,yd))}crk(bc,vc,Vc,yd){this.ih.contentNavigationApiEnabled&&bc&&vc&&yd&&this.Pzc.xZe({contentId:bc,containerContentType:0,n9:{xd:Vc,IM:vc.Cl}},{selection:yd})}Aqk(bc,vc){if(this.ih.contentNavigationApiEnabled&&bc&&!bc.Df&&bc.Tq!==n.a.beingCreated){var Vc=this.od.Db(bc.objectId);if(Vc){var yd=Rc.k(Vc,y.a.nil);yd=this.od.Db(yd);yd=Mc.a.xva(yd,
Vc.id,!1);(null===yd||void 0===yd?0:yd.Ib)&&(null===yd||void 0===yd?0:yd.paragraph)?this.Pzc.xZe({contentId:bc.id,containerContentType:0,n9:{xd:yd.Ib.cp,IM:yd.paragraph.Cl}},{selection:vc}):ea.ULS.sendTraceTag(520717896,327,10,`comment object id: ${Vc.id},
        commentStartRangeObject Valid: ${!!yd},
        containingProperties Valid: ${!(null===yd||void 0===yd||!yd.Ib)},
        paragraph valid: ${!(null===yd||void 0===yd||!yd.paragraph)};
        Failed to add to ReviewSuggestionModel`)}}}jua(bc){super.jua(bc);this.Dfd.add(bc.id)}u1n(bc,vc){this.ih.contentNavigationApiEnabled&&this.Pzc.t1n(bc,vc)}CBo(bc,vc){this.ih.Uq&&bc.Tq===n.a.beingCreated&&bc.gz&&this.wUe.Z(bc.gz.draftId,vc)}nem(bc){return this.wUe.J(bc)}r9i(bc){this.wUe.remove(bc)}NYl(bc){let vc=0,Vc=0;for(let yd=0;yd<this.$g.length;yd++){if(this.$g[yd].id===bc.id){Vc=yd;break}this.$g[yd].Df||this.$g[yd].done||vc++}return{returnValue:Vc,eHo:vc}}Ftf(bc){var vc=null,Vc=this.od.Db(bc);
bc=Mc.a.mba(Vc,this.od,!0);Vc=Mc.a.mba(Vc,this.od,!1);bc&&Vc&&(vc=kb.SelectionFactory.te(bc.Ib.paragraph,bc.Ib.cp),vc=kb.SelectionFactory.jA(vc,nb.a.Rc(Vc.Ib.paragraph,Vc.Ib.cp)));bc&&Vc||this.XJ.logKpiFailure($d.a.K2b,"ParaNodeNotConnected",{isIntentional:!1,isInternal:!0});return vc}jam(bc){bc=y.a.If(bc.objectId);return this.Ftf(bc)}j5f(bc,vc){var Vc=this.od.Db(bc);if(Vc){var yd=this.od.Db(Rc.k(Vc));Vc=this.od.Db(Rc.h(Vc));if(yd===Vc)for(Vc=0;Vc<yd.pa.length&&!yd.pa.J(Vc).hNo(bc,vc);Vc++);}}n2l(bc,
vc){let Vc=-1;var yd=null;bc||(bc=this.mb.hb?this.mb.hb.kb:null);if(!bc||!bc.Qa)return{returnValue:null,index:Vc};const ee=this.Bdi(bc.Qa);if(!ee)return{returnValue:null,index:Vc};var Qe=Mc.a.g_l(ee.iterator.currentNode,bc.Qa.cpBegin,this.ih.Uq,vc);Qe&&(yd=this.w_(Qe.Wj.toString()),Qe=Array.indexOf(this.$g,yd),yd=0<=Qe?yd:null,Vc=0<=Qe?Qe+1:Vc);yd||(bc=this.I5h(ee,bc.Qa,this.ih.Uq,vc),yd=0<=bc?this.$g[bc]:null,Vc=0<=bc?bc:Vc);return{returnValue:yd,index:Vc}}kPl(bc=null){var vc=null;vc=this.mb.hb.kb;
return vc&&vc.Qa?this.jVl(vc.Qa,this.ih.Uq,bc):null}Bdi(bc){const vc=new Fa.GraphIterator;vc.set(bc.node);return vc.Dp()?Rb.a.mt(vc,vc.origin):null}jVl(bc,vc,Vc=null){const yd=this.Bdi(bc);bc=this.I5h(yd,bc,vc,Vc);return-1<bc?this.$g[bc]:null}I5h(bc,vc,Vc,yd=null){let ee=-1;if(bc)for(vc=vc.cpBegin;-1===ee&&bc.moveNext();)Pa.ParagraphReader.uh(bc.iterator)&&((vc=Mc.a.pNc(bc.iterator.currentNode,vc,Vc,yd))&&(ee=Array.indexOf(this.$g,this.w_(vc.Wj.toString()))),vc=0);return ee}uui(bc){const vc=bc.toString();
return this.FBa.nb(vc)&&this.FBa.J(vc)||this.oxc.contains(bc)&&this.od.$va(bc)&&this.od.Db(bc).ia(qc.a.Maa,!1)}rjj(bc,vc=!1){if(bc=this.qNc(bc))bc.yEf=!vc}XEf(bc){return this.FBa.nb(bc.toString())||this.oxc.contains(bc)&&this.od.$va(bc)&&!this.od.Db(bc).ia(qc.a.gM,null)}w3f(bc){!bc.objectId||bc.Df||this.FBa.nb(bc.objectId)||this.FBa.add(bc.objectId,bc.done)}deleteComment(bc){bc&&!bc.Df&&(this.ih.Uq&&bc.Tq!==n.a.beingCreated?this.FBa.remove(bc.objectId):bc.Tq===n.a.beingCreated&&this.OCj());this.Dfd.remove(bc.id);
return super.deleteComment(bc)}ppf(bc){return bc&&bc.hasProperty(qc.a.ZE)?bc.Lf(qc.a.ZE).toString():""}qNc(bc){if(!bc)return null;if(this.ih.cgb)return this.KD(bc);for(const vc of this.$g){const Vc=this.od.Db(y.a.If(vc.objectId));if(this.ppf(Vc)===bc.toString())return bc=Vc.Lf(qc.a.wH),this.KD(bc)}return null}m2f(bc,vc=!1){if(bc&&Mc.a.KXd(bc)&&this.ld.isFeatureEnabled(116)){const Vc=this.ppf(bc);if(""!==Vc){if(vc){let yd;if(this.Dhd&&({value:yd}=this.Dhd.Dc(Vc,yd)).returnValue&&yd.ResolveState===
bc.ia(qc.a.Maa,!1))return}(bc=this.Gsb.J(Number.parseInvariant(Vc)))&&this.Qvd.add(bc)}}}QKn(bc){const vc=this.dof(bc);let Vc=!1;vc.uje&&vc.VJd||(this.oxc.add(bc.id),Vc=!0,this.CSi(bc));return Vc}CSi(bc){K.a.Z2(v.AFrameworkApplication.nc,()=>{this.iTf(bc);this.oxc.remove(bc.id);this.oxc.count||(this.tMb(),this.KK.USo())},"DelayLoadCommentNodeIntoModel")}iTf(bc){if(!this.$i&&(ea.ULS.sendTraceTag(525379406,327,10,"Comment Manager Not initialized"),this.zfd<this.CYj)){this.zfd+=1;this.CSi(bc);ea.ULS.sendTraceTag(525378784,
327,50,`Comment Node add Retry attempt ${this.zfd}`);return}const vc=this.gOd();vc.Gi(bc);if(vc.rA()){let Vc;try{Vc=this.tGd(vc)}catch(yd){ea.ULS.fE(512553930,327,10,yd,"create comment from comment node failed")}if(!Vc){ea.ULS.sendTraceTag(512553929,327,15,`CommentNode Failed to add: ${null===bc||void 0===bc?void 0:bc.id}`);this.XJ.logKpiFailure($d.a.K2b,"CommentCreationFailed",{isInternal:!0},{name:$d.a.J2b,isInternal:!0});return}this.$i.addComment(Vc,null);2!==this.$i.mode&&3!==this.$i.mode&&(this.$i.mode=
1);this.m2f(bc);this.mgn(Vc);this.LIj(Vc)}else this.bqc.push(bc);this.P1.s9("OnCommentNodeAdded",{commentNode:bc})}mgn(bc){this.ih.Uq&&!this.rj.Zm&&this.KK.KA&&bc.Df&&this.KK.KA.id===bc.Df&&this.KK.notify(String.format(Box4Intl.Box4Strings.L_CommentReplyAdded,bc.author),!1)}dof(bc){const vc=new ne;vc.X8c=Rc.k(bc,y.a.nil);vc.vKc=Rc.h(bc,y.a.nil);bc=vc.X8c.equals(y.a.nil);const Vc=vc.vKc.equals(y.a.nil);bc||(vc.SCa=this.od.Db(vc.X8c),vc.uje=!!vc.SCa&&vc.SCa.isConnected);Vc||(vc.xNa=this.od.Db(vc.vKc),
vc.VJd=!!vc.xNa&&vc.xNa.isConnected);return vc}QVh(bc,vc){const Vc=this.Vum(bc);-1!==Vc&&Array.removeAt(this.aVa,Vc);vc||((bc=this.H2h(bc))?this.aVa.push(bc):ea.ULS.sendTraceTag(42870813,3003,10,"GenerateTaskItemForTaskId returned null"))}vtl(){for(const bc of this.Qvd)this.QVh(bc,!1);this.Qvd.clear();for(const bc of this.XTe)this.QVh(bc,!0);this.XTe.clear()}pme(bc){var vc=this.$g.length,Vc=!1;if(bc.Df){var yd=(Vc=this.KD(bc.Df))&&Vc.objectId?this.od.Db(y.a.If(Vc.objectId)):null;yd=!!yd&&yd.hasProperty(qc.a.TCa);
vc=Array.indexOf(this.$g,Vc);Vc=0>vc;for(vc+=1;vc<this.$g.length&&this.$g[vc].Df===bc.Df&&this.$g[vc]!==this.ny&&!(yd&&bc.date<this.$g[vc].date);)vc++}return{returnValue:!Vc,index:vc}}zrm(){const bc=new Se(this.KRo,this.tMb),vc=Db.App.Lj.Bl;vc.Ze(40).Fo(Object(cb.a)(bc,bc.C0k,"commentPropertyChanged"));vc.Ze(12).Fo(Object(cb.a)(bc,bc.O0k,"commentTextChanged"));this.ld.isFeatureEnabled(116)&&vc.Ze(72).Fo(Object(cb.a)(bc,bc.sFo,"taskPropertyChanged"));Mb.GraphTransactionManager.instance.aqa(bc,3)}CIi(bc){this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.EmptyCommentLogging",
!1)&&bc&&0!==bc.length&&(bc=G.a.QDb(bc[0]),1<bc.ops.length||0===bc.ops.length||("\n"===bc.ops[0].insert&&(this.ave+=1),3<this.ave&&ea.ULS.sendTraceTag(509437908,327,15,"comments content cleared. Potentially resulting in data loss")))}QUk(bc){if(bc&&this.Dve.has(bc.id)){var vc=bc.usersByReactionType[1];for(let Vc=0;vc&&Vc<vc.length;Vc++)if(vc[Vc].UserId===this.zY)return;ea.ULS.sendTraceTag(542765345,327,15,`Like by current user on Comment ${bc.objectId} removed by inbound changes`)}}SRo(bc,vc){this.TYk(vc);
const Vc=this.ih.Uq;Vc&&this.eom(vc)?(this.whl(vc),this.m2f(bc),this.UVo(vc)):Vc||this.m2f(bc,!0)}MRo(bc){const vc=new Fa.GraphIterator;vc.set(bc);vc.zb(40);vc.hd(40);if(vc.currentNode){if(bc=this.w_(vc.currentNode.id.toString())){const Vc={done:bc.done,text:bc.text};bc.text=this.FDb(vc);this.CIi(bc.text);!this.ih.iua||!this.xE||this.ny&&this.ny.id===bc.id||this.xE.fireEvent(10,{comment:bc,vRi:Vc})}}else ea.ULS.sendTraceTag(592738053,327,15,"UpdateComment Unexpected Node Type: "+oc.a[bc.type])}UVo(bc){if(!this.rj.Zm){var vc=
new Xa.a;this.Ane(bc,vc);0<vc.count&&Ra.b(vc)}}whl(bc){const vc=new w.a(0,1,0,()=>{this.LRo(bc)},137,void 0,!0);v.AFrameworkApplication.nc.Vb(vc)}TYk(bc){var vc;null!==(vc=this.ny)&&void 0!==vc&&vc.gz&&this.ny.gz.sessionType!==J.a.metadata&&(vc=this.ny,bc.Df||!bc.done||vc.Df!==bc.id&&vc.id!==bc.id||(ea.ULS.sendTraceTag(592188699,327,15,"Draft comment lost on parent resolve, DraftType: {0}",vc.Tq),this.XJ.logKpiFailure($d.a.LEd,"DraftCommentLostOnParentResolve",{isIntentional:!1,isInternal:!0},{name:$d.a.wEd,
isIntentional:!1,isInternal:!0,isSessionEndingError:!1}),vc.Tq===n.a.beingCreated?(this.$i.clearSelection(),this.deleteComment(vc),this.selectComment(bc)):vc.Tq===n.a.beingEdited&&(vc.Tq=n.a.normal,vc.KSa=N.a.succeeded,this.$i.E5e())))}NRo(bc,vc){var Vc;const yd=null===(Vc=vc.gz)||void 0===Vc?void 0:Vc.draftId;if(this.ih.cgb){if(bc=bc.getValue(qc.a.ZE).toString(),vc.id!==bc){if(!vc.Df)for(Vc=Array.indexOf(this.$g,vc)+1;Vc<this.$g.length&&this.$g[Vc].Df===vc.id;Vc++)this.$g[Vc].Df=bc;ea.ULS.sendTraceTag(555044877,
327,50,"durable Id updated.");vc.id=bc;this.Urc.has(bc)&&this.Urc.delete(bc)}}else if(bc=bc.getValue(qc.a.wH),vc.id!==bc){if(!vc.Df)for(Vc=Array.indexOf(this.$g,vc)+1;Vc<this.$g.length&&this.$g[Vc].Df===vc.id;Vc++)this.$g[Vc].Df=bc;vc.id=bc}yd&&this.u1n(yd,vc.id)}eom(bc){return this.FBa.nb(bc.objectId)&&this.FBa.J(bc.objectId)!==bc.done}LRo(bc){this.FBa.Z(bc.objectId,bc.done);if(bc.done)if(this.KK.imc(bc),this.rj.Zm)this.KK.u_c(bc,!0);else{var vc=new w.a(0,1,0,()=>{this.KK.u_c(bc,!0,!1);this.Msd.remove(bc.id)},
139);this.Msd.add(bc.id,vc);v.AFrameworkApplication.nc.Vb(vc);this.Qy&&bc.id===(void 0===this.Qy.Df||null===this.Qy.Df?this.Qy.id:this.Qy.Df)&&this.KK.clearSelection()}else this.KK.imc(bc),vc=null,({value:vc}=this.Msd.Dc(bc.id)).returnValue?(v.AFrameworkApplication.nc.Ve(vc),this.Msd.remove(bc.id)):this.KK.u_c(bc,!1)}EUi(){this.Rwm();this.Pwm();v.AFrameworkApplication.K.$("IsDocumentOwner")||z.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(bc=>{bc.logActivity("ShowTUIForCommentAwareness",
null)})}Pwm(){this.ih.GPb&&this.jqi();this.ih.GPb&&(this.aVa=this.h8k(),Pc.a.kSa(this.fXi))}Rwm(){!this.ih.LBb&&this.ih.Uq&&Yb.a.kSa(this.ZZc);this.zrm();this.yrm()}yrm(){const bc=new Ic(this.wtl),vc=Db.App.Lj.Bl;vc.Ze(39).Fo(Object(cb.a)(bc,bc.EFh,"commentContainerPropertyChanged"));this.ld.isFeatureEnabled(116)&&vc.Ze(71).Fo(Object(cb.a)(bc,bc.EFh,"commentContainerPropertyChanged"));Mb.GraphTransactionManager.instance.aqa(bc,3)}w_(bc){for(let vc=0;vc<this.$g.length;vc++){const Vc=this.$g[vc];if(Vc.objectId===
bc)return Vc}return null}Auk(bc){if(bc)for(const vc of bc)vc&&this.bpd.add(vc)}fXk(){this.bpd.clear()}rYe(bc,vc){Array.insert(this.$g,vc,bc);this.w3f(bc);this.e0m(bc);vc=this.JOd(bc);this.bpd.contains(vc)&&(bc.yEf=!0,this.bpd.remove(vc))}LIj(bc){Rc.p(bc)||ea.ULS.sendTraceTag(512278912,327,15,`Missing Start or End mapping info for Comment ${bc.objectId}`)}e0m(bc){ea.ULS.sendTraceTag(539800645,327,50,`Comment added to Model. ${Rc.a(bc)} `)}tGd(bc){40!==bc.We&&ea.ULS.sendTraceTag(594363294,327,15,"[CreateCommentForNode] Iterator is not at commentNode");
const vc=bc.currentNode;var Vc=vc.getValue(qc.a.H2b);const yd=vc.getValue(qc.a.wH),ee=vc.getValue(qc.a.ZE).toString(),Qe=vc.getValue(qc.a.HGc);let ue=null,ve=null;if(vc.hasProperty(qc.a.z7)){var xf=vc.getValue(qc.a.z7);ue=xf?Ib.b(xf||""):null;Jf.a.ACh(ue)}vc.hasProperty(qc.a.TCa)&&(ve=vc.getValue(qc.a.TCa));let bf=null,Df=null;vc.hasProperty(qc.a.tEd)&&vc.hasProperty(qc.a.GGc)&&(bf=vc.getValue(qc.a.tEd),Df=vc.getValue(qc.a.GGc));xf=Rc.k(vc,y.a.nil).toString();const nf=Rc.h(vc,y.a.nil).toString(),
Yf=vc.ia(qc.a.Maa,!1),Kf=vc.ia(qc.a.gM,null),wb=vc.ia(qc.a.nib,!1),Tb=this.FDb(bc);Vc=new R.Comment(this.ih.cgb?ee:yd,yd,Vc,ve||new Date(Qe),this.ih.cgb?this.yfd.v7h(Kf):Kf,Yf,Tb,R.Comment.mZi,wb,Df,bf,ue);Vc.UDc=xf;Vc.TDc=nf;Vc.objectId=vc.id.toString();Vc.U_a=ee;this.inh(ee,yd);bc.hd(39);return Vc}inh(bc,vc){(!bc||Number.parseInvariant(bc)>=Mc.a.XLi)&&ea.ULS.sendTraceTag(544022547,327,10,`Durable Id is invalid ${bc}`);vc||ea.ULS.sendTraceTag(544022548,327,10,`Guard Id is invalid ${vc}`);try{this.yfd.uqk(bc,
vc)}catch(Vc){"DuplicateDurableId"===Vc.message?ea.ULS.sendTraceTag(544511521,327,10,`Duplicate Durable Id: ${bc} with Guard Id: ${vc}`):"DuplicateGuardId"===Vc.message?ea.ULS.sendTraceTag(544511522,327,10,`Duplicate GuardId: ${vc} with Durable Id: ${bc}`):ea.ULS.sendTraceTag(544022549,327,10,`Unkown Error when adding to CommentIds map: ${Vc}`)}}FDb(bc){var vc;if(40!==bc.We)return ea.ULS.sendTraceTag(594379426,327,15,"Trying to get text from node of type: {0}",bc.We),this.Ypc.ljg([]);let Vc=bc.We+
":";const yd=bc.xq();0<yd?(bc.Qd(),Vc+=bc.We+":"):(ea.ULS.sendTraceTag(509642946,327,15,`Comment has no paragraphs. ${null===(vc=bc.currentNode)||void 0===vc?void 0:vc.id}`),vc=new hh.a,vc.inStaging=!0,this.XJ.logKpiFailure($d.a.K2b,"CommentContentNotFound",{isIntentional:!1,isInternal:!0},{name:$d.a.wEd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:vc},Qi.a));vc=Array(yd);for(let ee=0;ee<yd;ee++){bc.Qd();Vc+=bc.We+":";const Qe=bc.currentNode;Qe.NGb=!0;vc[ee]=Qe;Qe.pa||ea.ULS.sendTraceTag(594363293,
327,15,"[GetCommentText_Crash] "+Vc);!Qe.pa&&this.ih.obo&&(v.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordSendErrorReportOnCommentInboundCrashSettings"),this.yp());bc.uc();bc.Rj();Vc+=ee<yd-1?":"+bc.We+":":":"}return this.Ypc.ljg(vc)}yp(){if(ob.WoncaApp.fle){var bc=new ab.a(!0,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportTitle,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportDescription,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportPrivacyStatement);bc.Ad=
1;bc.Ee(1,WoncaIntl.WoncaStrings.l_SendErrorReport);bc.Ee(0,WoncaIntl.WoncaStrings.l_NoThanks);bc.XU(1);bc.ix($a.a.w$e,CommonUIStrings.l_DefaultDialogTitle,WoncaIntl.WoncaStrings.l_InboundingCommentFailed,this.ill,!1)}else this.y6.VC($a.a.w$e,this.xDi)}JOd(bc){if(!bc||!bc.objectId)return"";bc=y.a.If(bc.objectId);bc=this.od.Db(bc);return this.ppf(bc)}d6l(bc){return this.JOd(bc.Df?this.KD(bc.Df):bc)}cRn(bc,vc){if(this.ld.isFeatureEnabled(116))if(this.ih.removePersonalInformation)ea.ULS.sendTraceTag(595128897,
3003,50,"RecordTaskChanges no ops because filter PII flag on"),this.tMb();else{this.mYa.Hv(Ya.a.scg);var Vc=null===vc||void 0===vc?void 0:vc.taskId,yd=!Vc;yd?this.mYa.logKpiUsage(Ud.a.Oke,0):this.mYa.logKpiUsage(Ud.a.Pke,0);try{const xf=this.yWb.value,bf=this.JOd(bc);if(""===bf)this.N2d(yd,"FailedDurableIdForComment");else{var ee=this.d6l(bc);if(""===ee)this.N2d(yd,"FailedDurableIdForParentComment");else if(yd&&bc.gz.sessionType!==J.a.create&&bc.gz.sessionType!==J.a.reply)ea.ULS.sendTraceTag(42856725,
3003,10,"Unexpected create task for drafting session type [{0}]",bc.gz.sessionType),this.mYa.logKpiFailure(Ud.a.Oke,"FailedTaskCreateInvalidSessionType");else{var Qe=null;bc.gz.sessionType!==J.a.metadata&&(Qe=bf);var ue=this.n4g.value;var ve=O.a.jf(bc.text)?ue.r2h(Qe,vc,yd):ue.r2h(Qe,vc,yd,bc.text[0]);0<ve.length?yd?(xf.ifb(Number.parseInvariant(ee),ve)||this.mYa.logKpiFailure(Ud.a.Oke,"TaskCreateFailed"),this.tMb()):(this.mYa.logKpiUsage(Ud.a.Pke,0),xf.yCk(Vc,ve)||this.mYa.logKpiFailure(Ud.a.Pke,
"TaskEngagementFailed")):this.N2d(yd,"HistoryRecordsLengthZero")}}}catch(xf){this.N2d(yd,"RecordTaskChangesFailed")}}}N2d(bc,vc){const Vc={name:Ud.a.lFo,isInternal:!0};bc?this.mYa.logKpiFailure(Ud.a.Oke,vc,Vc):this.mYa.logKpiFailure(Ud.a.Pke,vc,Vc)}Lyd(bc,vc){if(bc){var Vc=v.AFrameworkApplication.userName,yd=vc.toString();bc.usersByReactionType||(bc.usersByReactionType={});var ee=bc.usersByReactionType[yd];Vc=new U(this.zY,this.Z4a,Vc);Vc.DateUtc=new Date;ee?ee.push(Vc):bc.usersByReactionType[yd]=
[Vc];ea.ULS.sendTraceTag(572014993,327,50,"Reaction type {0} added to {1} with Object Id: {2} ",vc,bc.Df?"reply":"parent",bc.objectId);yd=[bc];this.XJ.Hv(he.a.D0k,{succeeded:!0,customData:{reactionType:W[vc]}});this.j3c(yd,X.addReaction);this.Dve.add(bc.id)}}Pce(bc,vc){if(bc&&bc.usersByReactionType){var Vc=bc.usersByReactionType[vc.toString()];if(Vc&&Vc.length){for(let yd=0;yd<Vc.length;yd++)if(Vc[yd].UserId===this.zY){Array.removeAt(Vc,yd);break}ea.ULS.sendTraceTag(572014994,327,50,"Reaction type {0} removed from {1} with Object Id: {2} ",
vc,bc.Df?"reply":"parent",bc.objectId);Vc=[bc];this.XJ.Hv(he.a.E0k,{succeeded:!0,customData:{reactionType:W[vc]}});this.Dve.delete(bc.id);this.j3c(Vc,X.removeReaction)}}}j3c(bc,vc){const Vc=this.Hc.Mc(15);Vc.Cb(this.UIa);this.ax.jF.p7(3);switch(vc){case X.deleteComment:for(vc=0;vc<bc.length;vc++){var yd=bc[vc];if(yd.Tq===n.a.beingCreated)this.ih.contentNavigationApiEnabled&&this.Pzc.remove(yd.gz.draftId),this.KK.amg();else{var ee=y.a.If(yd.objectId);(ee=this.od.Db(ee))&&Mc.a.bId(ee,this.od);ea.ULS.sendTraceTag(39364559,
327,50,`Deleting Comment: [CommentObjectId:${yd.objectId}]`);this.ih.iua&&this.xE&&(yd.Df?this.xE.fireEvent(10,{comment:yd,changeType:"replyDeleted"}):this.xE.fireEvent(7,{comment:yd}));this.ih.contentNavigationApiEnabled&&this.Pzc.remove(yd.id)}}break;case X.addComment:this.$i.mode=1;bc=bc[0];bc.date=new Date;vc=this.Cal(bc);yd=vc.getValue(qc.a.ZE).toString();bc.U_a=yd;this.ih.cgb&&this.Urc.set(yd,bc.id);yd=bc.text;ee=this.gOd();if(bc.Df){var Qe=this.KD(bc.Df),ue=this.od.Db(y.a.If(Qe.objectId));
vc.setValue(qc.a.gM,ue.getValue(qc.a.wH));this.addReply(vc,yd,this.od,ee,ue);ea.ULS.sendTraceTag(39364560,327,50,`Adding Reply: [ObjectId:${bc.objectId}][ParentObjectId:${Qe.objectId}]`)}else(Qe=this.mb.hb.kb)&&Qe.Qa&&(Sa.SelectionEditor.km(Qe)&&(ue=Sa.SelectionEditor.C3(Qe.Qa,!1))&&(this.mb.setSelection(ue),Qe=ue,ea.ULS.sendTraceTag(592569872,327,50,"[RecordChanges] Selection extended")),Pa.ParagraphReader.Wb(Qe.Qa.node)&&Pa.ParagraphReader.Wb(Qe.Qc.node)&&(this.Qyb(vc,yd,ee,Qe),ea.ULS.sendTraceTag(39364561,
327,50,`Adding Comment: [ObjectId:${bc.objectId}]`)));yd=vc.ia(qc.a.wH,null);bc.mPa=yd;bc.KSa=N.a.sentToServer;bc.KSa=N.a.succeeded;bc.objectId=vc.id.toString();this.w3f(bc);this.LIj(bc);this.inh(bc.U_a,bc.mPa);this.ih.iua&&this.xE&&(bc.Df?this.xE.fireEvent(10,{comment:bc,changeType:"replyAdded"}):this.xE.fireEvent(11,{comment:bc}));break;case X.editComment:this.$i.mode=1;bc=bc[0];vc=y.a.If(bc.objectId);vc=this.od.Db(vc);yd=bc.mPa;bc.mPa||(yd=vc.getValue(qc.a.wH),ea.ULS.sendTraceTag(554446870,327,
15,`Missing GuardID for Comment with objectId ${bc.objectId} while editing`),yd=this.ih.cgb?yd:bc.id);this.WDj(vc,bc.text,yd);ea.ULS.sendTraceTag(39364562,327,50,`Editing Comment: [CommentObjectId:${bc.objectId}]`);bc.KSa=N.a.sentToServer;bc.KSa=N.a.succeeded;this.ih.iua&&this.xE&&this.xE.fireEvent(10,{comment:bc,changeType:bc.Df?"replyEdited":"edited"});break;case X.addReaction:case X.removeReaction:vc=bc[0];bc=y.a.If(vc.objectId);bc=this.od.Db(bc);(vc=(vc=vc.usersByReactionType)?Ib.c(vc):"")&&bc.setValue(qc.a.z7,
vc);break;case X.done:case X.undone:for(vc=0;vc<bc.length;vc++)yd=bc[vc],ee=y.a.If(yd.objectId),this.od.Db(ee).setValue(qc.a.Maa,yd.done),ea.ULS.sendTraceTag(594124932,327,50,`${yd.done?"Resolved":"Re-opened"} Comment: [CommentObjectId:${yd.objectId}]`),this.ih.iua&&this.xE&&this.xE.fireEvent(10,{comment:yd,changeType:yd.done?"resolved":"reopened"})}this.Jm.kF();ea.ULS.sendTraceTag(572281361,327,50,"Disposing transaction, should raise context reload event");Vc.dispose()}gOd(){const bc=new Fa.GraphIterator;
bc.set(this.ax);this.VCa.j4a(bc);return bc}Y5c(){return this.chj(!0)}Z5c(){return this.chj(!1)}chj(bc){if(!this.$g.length)return null;let vc=this.Qy;do{if(vc){const Vc=this.ih.Uq&&!this.rj.Zm;vc=bc?this.hVl(vc,Vc):this.iVl(vc,Vc)}else vc=bc?this.$g[0]:this.$g[this.$g.length-1];if(!vc)return null}while(vc.Df&&""!==vc.Df);this.selectComment(vc);return vc}lKh(bc,vc,Vc,yd,ee){const Qe=this.DYj.create(1074135127);this.ih.removePersonalInformation&&(vc=CommonUIStrings.l_RemovedAuthorName,Vc=null);Qe.setValue(qc.a.commentId,
V.a.vF());Qe.setValue(qc.a.ZE,Mc.a.opf());Qe.setValue(qc.a.yNa,v.AFrameworkApplication.userSessionId);Qe.setValue(qc.a.wH,bc);Qe.setValue(qc.a.H2b,vc);Qe.setValue(qc.a.YFh,vc);Qe.setValue(qc.a.HGc,Vc?Z.a.bNd(Vc,"MM/dd/yyyy HH:mm:ss",Z.a.dataCulture):"");Qe.setValue(qc.a.TCa,Vc);Qe.setValue(qc.a.Maa,yd);ee&&(bc=ee?Ib.c(ee):"",Qe.setValue(qc.a.z7,bc));Qe.setValue(qc.a.GGc,this.zY);Qe.setValue(qc.a.tEd,this.Z4a);return Qe}Cal(bc){var vc;const Vc=this.lKh(bc.id,bc.author,bc.date,bc.done,null!==(vc=bc.usersByReactionType)&&
void 0!==vc?vc:{});bc.Df&&(this.ih.cgb?((vc=this.yfd.TWl(bc.Df))||ea.ULS.sendTraceTag(555008772,327,10,`Missing guardId for Comment With Durable Id ${bc.Df}`),bc=vc):bc=bc.Df,Vc.setValue(qc.a.gM,bc));return Vc}addReply(bc,vc,Vc,yd,ee){this.addComment(bc,vc,yd);vc=Lg.xoh(bc,Vc,ee,!0);Vc=Lg.xoh(bc,Vc,ee,!1);vc&&Rc.v(bc,vc.Ib.paragraph.id);Vc&&(Rc.u(bc,Vc.Ib.paragraph.id),Vc.Ib.paragraph.id||ea.ULS.shipAssertTag(5564303,327,!1,"Comment node has no end anchor!"))}Qyb(bc,vc,Vc,yd){this.addComment(bc,vc,
Vc);let ee,Qe;({start:vc,end:ee,startCp:Vc,endCp:Qe,nuh:ue}=this.ePk());ue&&(yd.Qa.node===vc&&(Vc=xb.a.mhb(yd,!0)),yd.Qc.node===ee&&(Qe=xb.a.mhb(yd,!1)));if(-1===Vc||-1===Qe){this.QZg||0!==this.eUb||(this.XJ.logKpiFailure($d.a.r8e,"DraftSelectionLost",{isInternal:!0},{name:$d.a.J2b,isInternal:!0}),this.QZg=!0);vc=yd.Qa.node;Vc=xb.a.mhb(yd,!0);ee=yd.Qc.node;Qe=xb.a.mhb(yd,!1);if(2<yd.length){var ue=[];for(let ve=0;ve<yd.length;ve++)ue.push(yd.J(ve).node.id);this.aoh(bc,ue)}ea.ULS.sendTraceTag(51233603,
327,50,"Intents invalid reason {0}",this.eUb)}else if(2<this.oZ.length){ue=[];for(yd=0;yd<this.oZ.length;yd++)ue.push(this.oZ[yd].sfc);this.aoh(bc,ue)}Mc.a.P_b(vc,bc.id,Vc,!0);Mc.a.P_b(ee,bc.id,Qe,!1);Rc.v(bc,vc.id);Rc.u(bc,ee.id);this.OCj();ee.id||ea.ULS.shipAssertTag(5564304,327,!1,"Comment node has no end anchor!")}aoh(bc,vc){if(!(2>=vc.length||!bc||Rc.s(bc))){this.rj.FU.add(bc.id,new yb.a(new cc.a));for(var Vc=y.a.Zp(vc[0],vc[1])?2:1,yd=vc.length-2;Vc<=yd;Vc++){const ee=vc[Vc];this.rj.Nx.nb(ee)?
this.rj.Nx.J(ee).JM||(this.rj.Nx.J(ee).JM=new yb.a(new cc.a)):this.rj.Nx.add(ee,new id.a(!0));this.rj.Nx.J(ee).N1a=!0;this.rj.Nx.J(ee).JM.add(bc.id);this.rj.FU.J(bc.id).add(ee)}}}ePk(){let bc=null,vc=-1,Vc=null;var yd=-1;let ee=!1;if(!this.oZ.length||2!==this.eUb)return{start:bc,end:Vc,startCp:vc,endCp:yd,nuh:ee};bc=this.od.Db(this.oZ[0].sfc);Vc=1===this.oZ.length?bc:this.od.Db(this.oZ[this.oZ.length-1].sfc);if(Pa.ParagraphReader.Wb(bc)&&Pa.ParagraphReader.Wb(Vc)){yd=ue=>3===ue.type;let Qe=this.Fm.ZOa(bc,
3,yd);vc=0<Qe.count?Qe.J(0).begin:-1;bc!==Vc&&(Qe=this.Fm.ZOa(Vc,3,yd));yd=0<Qe.count?Qe.J(0).end:-1;-1===vc&&null!=bc&&(vc=bc.pa.first.cp,ee=!0,ea.ULS.sendTraceTag(524862562,327,50,"Draft Anchor startCp was adjusted"));-1===yd&&null!=Vc&&(yd=Vc.pa.last.cp,ee=!0,ea.ULS.sendTraceTag(524862563,327,50,"Draft Anchor endCp was adjusted"))}this.eUb=-1===vc||-1===yd?0:2;return{start:bc,end:Vc,startCp:vc,endCp:yd,nuh:ee}}OCj(){for(const bc of this.oZ){const vc=this.od.Db(bc.sfc);Pa.ParagraphReader.Wb(vc)&&
this.Fm.$Ta(vc,3)}this.oZ=[];this.eUb=2}addComment(bc,vc,Vc){bc.anchor||(Vc.Hf(bc,1),Vc.Gi(bc),this.sjj(bc,vc,Vc))}sjj(bc,vc,Vc){let yd=0;var ee=null;vc=this.Ypc.bIo(vc,Qe=>{const ue=new Ob.a;Vc.Hf(ue,1);Vc.Gi(ue);Vc.Hf(Qe,2);Vc.Gi(Qe);Vc.uc();Vc.uc()});for(let Qe=0;Qe<vc.length;Qe++)ee=vc[Qe],yd=ee.getValue(qc.a.Lc),Lg.paragraphEditor.hUa(ee),Lg.WJ&&Lg.WJ.hNa&&Lg.WJ.uHa(nb.a.create(ee));bc.setValue(qc.a.wH,yd.toString());return ee}mjb(bc,vc){return this.WDm(bc,vc)}mom(){return 0<this.oZ.length}dBb(bc,
vc,Vc){return bc.Qa&&Pa.ParagraphReader.Wb(bc.Qa.node)&&Pa.ParagraphReader.Wb(bc.Qc.node)?(vc=this.lKh(Pa.ParagraphReader.LQ(bc.Qc.node).toString(),vc?vc:v.AFrameworkApplication.userName,new Date,!1,{}),Vc||(Vc=new G.a,Vc.Wga("\n")),this.Qyb(vc,[Vc.GNc()],this.gOd(),bc),vc):null}es(bc){return!this.iXe.mdg(this.qNc(bc.getValue(qc.a.ZE)))}WDj(bc,vc,Vc){const yd=new Fa.GraphIterator;for(yd.set(bc);yd.Qd();)yd.wg();this.sjj(bc,vc,yd).Zg(qc.a.Lc,Number.parseInvariant(Vc));bc.setValue(qc.a.wH,Vc);if(vc=
this.w_(bc.id.toString()))vc.OHh=!1;bc.setValue(qc.a.nib,!1)}VDj(bc,vc){this.WDj(bc,[Sys.Serialization.JavaScriptSerializer.serialize(vc)],bc.getValue(qc.a.wH))}CG(bc){bc=this.od.Db(y.a.If(bc));return!!bc&&bc.ia(qc.a.CG,!1)}B0i(bc){bc=this.od.Db(y.a.If(bc));return!!bc&&bc.ia(qc.a.wHh,!1)}JFm(bc){const vc=Rc.j();return bc&&vc.has(bc.objectId)}SLm(bc){const vc=this.od.Db(y.a.If(bc));return vc?this.Iac(vc):(ea.ULS.sendTraceTag(562562755,341,15,"CommentNode is null, commentObjectId: "+bc),!1)}Iac(bc){var vc=
bc.id,Vc=Rc.k(bc),yd=Rc.h(bc);if(!y.a.Zp(Vc,yd))return!1;Vc=bc.Kc.Db(Vc);if(!Vc)return!1;yd=({XFc:bc}=this.GHc(Vc,vc,!0)).returnValue;var ee=({XFc:vc}=this.GHc(Vc,vc,!1)).returnValue;if(-1===yd||-1===ee)return!1;Vc=Vc.pa;yd=Vc.J(bc);ee=Vc.J(vc);if(!yd.hyperlink||!yd.hyperlink.BG||!ee.Om)return!1;for(bc+=1;bc<vc;bc++)if(yd=Vc.J(bc),yd.hyperlink||yd.Om)return!1;return!0}Xwf(){return Lg.wom(this.$g,bc=>this.CG(bc),bc=>this.B0i(bc))}GHc(bc,vc,Vc){let yd;for(yd=0;yd<bc.pa.length;yd++){const ee=bc.pa.J(yd);
if(ee.tf)for(let Qe=0;Qe<ee.tf.length;Qe++){const ue=ee.tf.J(Qe);if(ue.Wj.equals(vc)&&ue.Nc===Vc)return{returnValue:ee.cp,XFc:yd}}}return{returnValue:-1,XFc:yd}}UPh(bc){if(this.rj.FU.nb(bc)){const vc=new Xa.a;for(const Vc of this.rj.FU.J(bc))this.qXn(Vc,bc,vc);this.rj.FU.remove(bc);Ra.b(vc)}}Ane(bc,vc){if(bc.objectId){bc=y.a.If(bc.objectId);var Vc=this.od.Db(bc);if(Vc){var yd=Rc.k(Vc,y.a.nil);Vc=Rc.h(Vc,y.a.nil);yd.equals(y.a.nil)||vc.add(this.od.Db(yd));Vc.equals(y.a.nil)||vc.add(this.od.Db(Vc));
if(this.rj.FU.nb(bc))for(const ee of this.rj.FU.J(bc))vc.add(this.od.Db(ee))}}}qXn(bc,vc,Vc){let yd;({value:yd}=this.rj.Nx.Dc(bc,yd));yd&&(yd.JM.remove(vc),yd.JM.count||(yd.N1a=!1,Vc.add(this.od.Db(bc))))}static get paragraphEditor(){return null!=Lg.ZEg?Lg.ZEg:Lg.ZEg=z.a.instance.resolve("Box4.IParagraphEditor")}static getInstance(){return Lg.Rl()}static Rl(){if(Lg._instance)return Lg._instance;const bc=new da.a(()=>(new eb(!0,!0,!0)).i8k()),vc=z.a.instance;Lg._instance=new Lg(new da.a(()=>Db.App.ya.gb.Uc),
new da.a(()=>Db.App.ya.gb.wc.ed),new da.a(()=>Ed.a.instance),new Ub.a,new ub,new da.a(()=>Eb.a.instance),vc.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),vc.resolve("WordEditor.Comments.ICommentFormatTranslator"),vc.resolve("Common.IAppSettingsManager"),vc.resolve("Box4.IFeatureHelper"),vc.resolve("Box4.Intent.IIntentRangeEditor"),new da.a(()=>Db.App.fV),vc.resolve("Box4.IKickoutExecutor"),vc.Ue("WordEditor.Tasks.ITaskActor"),bc,vc.resolve("WordEditor.Comments.CommentsSettings"),
vc.resolve("Box4.IUndoManager"),vc.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),vc.resolve("WordEditor.Comments.CommentsState"),vc.resolve("WordEditor.Comments.WordCommentEventsActor"),vc.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),vc.resolve("WordEditor.Comments.ITasksUsageAndHealthLogger"),vc.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentModel"),Db.App.Lj.Bl.Ze(12),vc.resolve("Box4.ParagraphRenderEvents"),vc.resolve("Box4.CatchUpActivity.IChangeIdEditor"),
vc.Sa("WordEditor.Extension.RichApiEventManager"));return Lg._instance}static xoh(bc,vc,Vc,yd){vc=Mc.a.mba(Vc,vc,yd);if(!vc)return null;vc=vc.Ib.tf;return Mc.a.Kyd(bc.id,vc,vc.J(0).Yu,yd)}WDm(bc,vc){if(Db.App.lostSession||(vc?!Db.App.es:!Db.App.es&&!Db.App.um)||1===bc.mode||!Object(hb.a)(Ac.PageView,pb.InteractiveViewManager.instance.Bd))return!1;bc=this.VKl();return!bc||Zb.a.instance.i_(bc)||Zb.a.instance.iha(bc)||bc.contextId===Wa.a.anchoredObject||Lb.a.hDf(bc)&&Lb.a.hac()?!1:!0}VKl(){const bc=
pb.InteractiveViewManager.instance.Bd;var vc=bc.mb.sg;this.LFm()&&this.ny&&lb.n(vc.node)&&(vc=Fa.GraphIterator.$a(vc.node),vc.zb(12),vc=vc.Xn(12),vc=kb.SelectionFactory.qma(vc),bc.mb.setSelection(vc),vc=bc.mb.sg);return vc}LFm(){var bc;return null===(bc=this.Ma)||void 0===bc?void 0:bc.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCommentInLoopsBugFixEnabled",!1)}static wom(bc,vc,Vc){const yd=new Xa.a,ee=new Xa.a,Qe=new Cb.a,ue=new Cb.a;for(const bf of bc){var ve=bf.id,xf=bf.objectId;bc=bf.done;
const Df=!!xf&&vc(xf);ve&&(bc&&yd.add(ve),Df&&ee.add(ve),xf&&Qe.Z(ve,xf));if(ve=bf.Df)({value:xf}=ue.Dc(ve,0)).returnValue||(xf=0),ue.Z(ve,xf+1);if(!ve&&!bc&&!Df)return!0}for(const bf of ee){if(yd.contains(bf))continue;let Df;if(({value:Df}=Qe.Dc(bf,Df)).returnValue&&Vc(Df))return!0;let nf;if(({value:nf}=ue.Dc(bf,0)).returnValue&&0<nf)return!0}return!1}ePl(bc){const vc=[];let Vc=this.$g.findIndex(yd=>yd.id===bc);if(-1<Vc)for(vc.push(this.$g[Vc]);++Vc<this.$g.length&&this.$g[Vc].Df===bc;)vc.push(this.$g[Vc]);
return vc}uTl(bc){return this.yfd.v7h(bc)}}Lg._instance=null;Lg.WJ=null;Object(m.a)(Lg,"EditorCommentModel",e.a,[614,615,616])},1742:function(E,M,c){E=c(0);var m=c(396),e=c(136),a=c(44),l=c(303),y=c(3),z=c(7),n=c(16),v=c(1607),A=c(1563);class w{constructor(aa,ea,na=!1){this.paragraphNode=aa;this.role=ea;this.Esj=na}}Object(E.a)(w,"DesignerReviewActionData",null,[]);class G{constructor(aa,ea,na){this.paragraphNode=aa;this.Eq=ea;this.role=na}}Object(E.a)(G,"TriageActionData",null,[]);class F extends G{constructor(aa,
ea){super(aa,0,ea)}}Object(E.a)(F,"RoleTriageActionData",G,[]);class I extends G{constructor(aa,ea,na){super(aa,1,27);this.styleId=ea;this.xT=na}}Object(E.a)(I,"PullQuoteTriageActionData",G,[]);class K extends G{constructor(aa,ea){super(aa,2,28);this.Rna=ea}}Object(E.a)(K,"ImageTriageActionData",G,[]);class J{constructor(aa,ea){this.paragraphNode=aa;this.$Hb=ea}}Object(E.a)(J,"ViewOriginalActionData",null,[]);var N=c(135),R=c(1505),O=c(1678);class L{constructor(aa,ea){this.currentNode=aa;this.nextNode=
ea}}Object(E.a)(L,"ReviewNavigationArgs",null,[]);class U{constructor(aa,ea){this.paragraphNode=aa;this.isVisible=ea}}Object(E.a)(U,"ReviewVisibilityArgs",null,[]);class W{constructor(aa){this.lhk=aa}getSelectedOption(){return this.lhk}getSeparatorIndexes(){return[1]}}Object(E.a)(W,"DesignerPreviewData",null,[]);var X=c(526),V=c(933),Z=c(1679);c.d(M,"a",function(){return da});class da extends V.a{constructor(aa,ea,na,pa,ja,ma,Ia,Ja,Ka,Ma,sa,xa){super();this.pc=aa;this.fe=ea;this.rId=na;this.pwa=pa;
this.Gk=ja;this.QB=ma;this.dAj=Ia;this.Vl=Ja;this.Sw=Ka;this.sId=Ma;this.ns=sa;this.cmf=xa;this.Pcb=null;this.jed=void 0;this.cwe=0;this.oH=[X.a.pQh]}get types(){return this.oH}get shj(){return Box4Intl.Box4Strings.l_ShowDesignerReviewTooltipSelectOrPress}get G$d(){return 0}Gro(aa){return 3!==aa.suggestion.Eq&&!this.Sw.isVisible&&(!this.cwe||!aa.lzb&&1===this.cwe)}hN(aa){var ea;if(!aa.source||m.SessionStatusManager.instance.wj)return!1;const na=aa.ll;var pa=this.pwa.oOc(na,1);if(!pa||!pa.count)return!1;
const ja=pa.J(0).intent;if(aa.Qjc)return.5!=(null===ja||void 0===ja?void 0:ja.state)&&4!=(null===ja||void 0===ja?void 0:ja.state);const ma=na.node;if(0==(null===ja||void 0===ja?void 0:ja.state)&&(2==(null===ja||void 0===ja?void 0:ja.suggestion.Eq)||1==(null===ja||void 0===ja?void 0:ja.suggestion.Eq)))return ja.lzb(),this.pwa.$Ta(ma,1),this.QB.f5i(new O.a(ma,1)),!0;if(1==aa.source&&27==(null===ja||void 0===ja?void 0:ja.Qib)&&(.5==(null===ja||void 0===ja?void 0:ja.state)||4==(null===ja||void 0===ja?
void 0:ja.state)))return!1;pa=this.Sw.isVisible?this.rId.Dkl(ma):new Z.a(0,1);let Ia;const Ja=this.tZl(null===(ea=null===ja||void 0===ja?void 0:ja.suggestion)||void 0===ea?void 0:ea.Eq);ea=this.Tj.oqa(na,{id:"Intent-"+X.a.pQh,suggestionGroups:[{type:Ja,id:Ja,title:ja.description,snippet:this.tEn(this.Gk.plainText(na.node)),snippetFormatting:[],supportedActions:this.Qnf(null===ja||void 0===ja?void 0:ja.suggestion,!0),suggestions:({zao:Ia}=this.WMh(ma)).returnValue,previewData:Ia?new W(Ia):null,isContentPending:!1}],
setSize:pa.count,positionInSet:pa.index},this,aa.BQa,!1,()=>{var Ka;this.QB.g5i(new U(ma,!0));this.Sw.isVisible||3===(null===(Ka=null===ja||void 0===ja?void 0:ja.suggestion)||void 0===Ka?void 0:Ka.Eq)||this.cwe++},()=>{this.QB.g5i(new U(ma,!1))},null,!1,Ka=>{Ka.showDesignerButton=!this.Sw.isVisible;Ka.shouldSkipTwoStepReview=!0;Ka.isFormattingSuggestion=0==ja.suggestion.Eq;Ka.isMultiParagraphSuggestion=1<ja.XN.length;Ka.proactivePromptHintType=this.Gro(ja)?l.e.HideFromReviewCardAndRibbon:l.e.None});
a.c(n.a.zun,ea,void 0,void 0,30);return ea}executeAction(aa,ea){var na,pa,ja,ma,Ia;if(!aa||!ea)return!1;const Ja=this.Vl.pA(ea);z.ULS.sendTraceTag(541446529,3016,50,"Action: {0}; Role: {1}; Pane: {2};",aa.actionType,null===Ja||void 0===Ja?void 0:Ja.role,this.Sw.isVisible);const Ka=this.sId.dU(ea);try{switch(aa.actionType){case l.b.Accepted:const Ma=this.pc.Qb(n.a.gyd,2,new w(ea,null===Ja||void 0===Ja?void 0:Ja.role,!0));this.pmg(La=>{La.supportedActions=this.Qnf(null===Ka||void 0===Ka?void 0:Ka.suggestion,
!1)});return this.Sw.isVisible&&32===Ma?this.eQf(ea):32===Ma;case l.b.Rejected:const sa=this.pc.Qb(n.a.Bce,2,new w(ea,null===Ja||void 0===Ja?void 0:Ja.role,!0));2===(null===Ka||void 0===Ka?void 0:Ka.suggestion.Eq)||Object(R.e)(null===Ka||void 0===Ka?void 0:Ka.suggestion)||this.Gad(ea,!1);2===(null===Ka||void 0===Ka?void 0:Ka.suggestion.Eq)&&this.Tj.dismiss();return this.Sw.isVisible&&32===sa?this.eQf(ea):32===sa;case l.b.Next:case l.b.Previous:return!this.Sw.isVisible||this.eQf(ea,aa.actionType===
l.b.Previous);case l.b.Apply:const xa=null===(na=aa.suggestion)||void 0===na?void 0:na.contentData;let ia;switch(null===xa||void 0===xa?void 0:xa.Eq){case 0:ia=new F(ea,xa.role);break;case 1:case 3:const La=xa.f5a;z.ULS.sendTraceTag(541446530,3016,50,"Changing PullQuote style: {0}",{["suggestionId"]:null===(pa=null===Ka||void 0===Ka?void 0:Ka.suggestion)||void 0===pa?void 0:pa.id,["newStyleId"]:La});Ka.suggestion.f5a=La;ia=new I(ea,La,e.a.create());break;case 2:ia=new K(ea,xa.Rna);break;default:return z.ULS.shipAssertTag(527459665,
3016,!1,String.format("DesignerSuggestionType: {0}",xa.Eq)),!1}this.Tj.focus();const ha=this.pc.Qb(n.a.changeDesignerRole,2,ia);this.Gad(ea,!1);return 32===ha;case l.b.AcceptAll:return 32===this.pc.Qb(y.a.hdb,2,new v.a(2));case l.b.RejectAll:return 32===this.pc.processAction(n.a.F3c,2);case l.b.SnoozeAll:return 32===this.pc.processAction(n.a.designerSnoozeContextualSuggestions,2);case l.b.Undo:const ua=this.pc.Qb(n.a.AIa,2,new w(ea,null===Ja||void 0===Ja?void 0:Ja.role));this.Gad(ea,!0);return 32===
ua;case l.b.OpenDesignerPane:return 32===this.pc.Qb(n.a.gIa,2,new A.a(6));case l.b.ViewOriginal:const ya={$Hb:aa.descriptorData.isViewingOriginal,Iag:aa.descriptorData.setIsViewingOriginal};if(void 0==(null===ya||void 0===ya?void 0:ya.$Hb)||void 0==(null===ya||void 0===ya?void 0:ya.Iag))return z.ULS.shipAssertTag(538789889,3016,!1,String.format("isViewingOriginal: {0}; setIsViewingOriginal: {1}",null===ya||void 0===ya?void 0:ya.$Hb,null===ya||void 0===ya?void 0:ya.Iag)),!1;this.Tj.focus();const ra=
this.pc.Qb(n.a.Qdf,2,new J(ea,ya.$Hb));ya.Iag(!ya.$Hb);this.Gad(ea,!0);return 32===ra;case l.b.GiveFeedback:switch(null===(ja=null===Ka||void 0===Ka?void 0:Ka.suggestion)||void 0===ja?void 0:ja.Eq){case 0:return this.ns.invokeUserFeedback(N.a.MSj),!0;case 1:case 3:return this.ns.invokeUserFeedback(N.a.SSj),!0;case 2:return this.ns.invokeUserFeedback(N.a.OSj),!0;default:return z.ULS.shipAssertTag(537658138,3016,!1,String.format("DesignerSuggestionType: {0}",null===(ma=null===Ka||void 0===Ka?void 0:
Ka.suggestion)||void 0===ma?void 0:ma.Eq)),!1}case l.b.ShowMore:switch(null===(Ia=null===Ka||void 0===Ka?void 0:Ka.suggestion)||void 0===Ia?void 0:Ia.Eq){case 2:z.ULS.sendTraceTag(527210449,3016,50,"User clicked show more images"),Ka.suggestion.Gum(),this.Gad(ea,!0,!0)}return!0;default:return!1}}catch(Ma){return z.ULS.shipAssertTag(572027277,3016,!1,String.format("{0} {1}",Ma.message,Ma.stack)),!1}}eQf(aa,ea=!1){const na=this.rId.L7b(aa,ea)||this.rId.L7b(aa,!ea);this.QB.$Ln(new L(aa,na,!ea));return!na||
this.rId.ePi(this,na)}pWl(aa){switch(aa.Eq){case 0:case 1:case 3:return{...l.h,font:aa.font,cssColor:aa.color,fontSize:aa.fontSize,fontWeight:aa.bold?l.d.Bold:l.d.Normal,italic:aa.italic,underlineType:aa.underline?l.f.Single:l.f.None,backgroundImg:aa.backgroundImg};case 2:break;default:z.ULS.shipAssertTag(527569927,3016,!1,`${aa.Eq}`)}}qYl(aa){if(2===aa.Eq)return{src:aa.imageUrl,width:0,height:0,imageAltText:aa.altText}}WMh(aa){var ea=null;let na=null;if(this.Pcb=this.dAj.h4l(aa)){na=Array(this.Pcb.options.length);
for(aa=0;aa<this.Pcb.options.length;aa++)ea=this.Pcb.options[aa],na[aa]={type:"DesignerTriageItem",id:String.format("DesignerTriageItem {0}",aa),title:ea.title,supportedActions:[l.b.Apply],contentData:ea,image:this.qYl(ea),titleFormatting:[this.pWl(ea)]};ea=(null===na||void 0===na?0:na.length)?na[this.Pcb.selectedIndex]:void 0}return{returnValue:na,zao:ea}}pmg(aa){this.Tj.definition?this.Tj.definition.suggestionGroups?1===this.Tj.definition.suggestionGroups.length&&(aa(this.Tj.definition.suggestionGroups[0]),
this.Tj.definition=this.Tj.definition):z.ULS.sendTraceTag(512274571,3016,50,"UXManger.definition.suggestionGroups is null"):z.ULS.sendTraceTag(512274572,3016,50,"UXManger.definition is null")}Gad(aa,ea,na=!1){const pa=this.sId.dU(aa);this.pmg(ja=>{ja.supportedActions=this.Qnf(null===pa||void 0===pa?void 0:pa.suggestion,ea);if(this.Pcb){if(na){var ma=this.WMh(aa).returnValue;ja.suggestions=ma}ma=this.dAj.N$l(this.Pcb.options,aa);ja.previewData=new W(ja.suggestions[ma])}})}Qnf(aa,ea){const na=[];ea?
(na.push(l.b.Accepted),na.push(l.b.Rejected),0==(null===aa||void 0===aa?void 0:aa.Eq)&&na.push(l.b.ViewOriginal)):(na.push(l.b.Next),na.push(l.b.Undo));this.Sw.isVisible||(this.fe.qGm()&&this.tFk(pa=>{pa&&this.pmg(ja=>ja.supportedActions.push(l.b.GiveFeedback))})&&na.push(l.b.GiveFeedback),this.fe.dHm()&&na.push(l.b.OpenDesignerPane),na.push(l.b.SnoozeAll));0===(null===aa||void 0===aa?void 0:aa.Eq)&&na.push(l.b.AcceptAll);na.push(l.b.RejectAll);(null===aa||void 0===aa?0:aa.cmi())&&na.push(l.b.ShowMore);
return na}tEn(aa){const ea=aa.split(" ",10);return 10>ea.length?aa:ea.join(" ")+"\u2026"}static jHm(aa){return aa===X.a.qQh||aa===X.a.rQh||aa===X.a.vQh}tZl(aa){return 2===aa?X.a.rQh:1===aa||3===aa?X.a.vQh:X.a.qQh}tFk(aa){void 0===this.jed&&this.cmf.execute(async ea=>{this.jed=await ea.isFeatureEnabled(N.a.TOi,!1);aa(this.jed)});return!!this.jed}}Object(E.a)(da,"DesignerIntentProvider",V.a,[])},1750:function(E,M,c){E=c(0);var m=c(498),e=c(458),a=c(11),l=c(1459),y=c(2004),z=c(350),n=c(7),v=c(110),A=
c(1516);class w{constructor(J,N,R){this.isVisible=J;this.elements=N;this.content=R}}Object(E.a)(w,"TooltipVisibilityArgs",null,[]);var G;(function(J){J[J.consistency=0]="consistency";J[J.Pip=1]="pullQuote";J[J.mlp=2]="suggestedImage";J[J.Qip=3]="pullQuoteMenu";J[J.gcp=4]="designerPaste"})(G||(G={}));Object(E.b)("DesignerSuggestionType",G);var F=c(135),I=c(1680);c.d(M,"a",function(){return K});class K extends l.a{constructor(J,N,R,O,L,U,W,X){super();this.An=J;this.Au=N;this.VXk=R;this.aOi=O;this.Gk=
L;this.QB=U;this.VH=W;this.wc=X;this.$ta=this.LEa=null;this.onMouseEnter=V=>{V=V.Oo;this.QB.z5i(new w(!0,[V.OEc],V.PIo));if(V.ar&&0<V.ar.length){const Z=this.VH.dU(V.ar[0]);Z&&Z.suggestion.M1m()}return this.wkj(V)};this.fpa=V=>{this.QB.z5i(new w(!1));return this.LDh(V.Oo)};this.kGa=V=>{if(K.h3a(V.Oo,this.$ta))return!0;this.QB.aMn(A.a.create(V.Oo.ar[0]));return!0};this.yVf=(V,Z)=>{Z.data?Z.data.isVisible?this.Beo(Z.data.paragraphNode):this.EWk():n.ULS.shipAssertTag(573850384,3016,!1)};this.QB.f_e(this.yVf)}Vgo(J){J?
(J=this.sqf(J))&&this.wkj(J):n.ULS.shipAssertTag(589693324,3016,!1)}VWk(){this.LDh(this.LEa)}Dob(J){J=this.Gk.xl(J.Bb);return!!J&&this.VH.rVc(J)}cfb(J){const N=J.geb(0,F.a.AJk,this.zoom),R=[];R.push(this.hDa(J.I4,N,J.Pmc[0].y-J.Jba[0].y));return R}hDa(J,N,R){var O,L=J.eh.ownerDocument;const U=m.a.createElement(L,e.a.div);U.className=F.a.vJk;U.style.left=N+"px";U.style.top=R+"px";N=m.a.createElement(L,e.a.div);N.className=F.a.yJk;L=m.a.createElement(L,e.a.div);L.className=F.a.wJk;J=this.Gk.xl(J.Bb);
R=this.VH.dU(J);if(null===(O=null===R||void 0===R?void 0:R.suggestion)||void 0===O?0:O.Eq)L.className+=String.format(" {0}",G[R.suggestion.Eq]);N.appendChild(L);U.appendChild(N);U.id=K.f4h(J);O=this.sqf(J,U);1==O.BJk&&(L.className+=String.format(" {0}",F.a.xJk));this.$ta&&this.$ta.ar.includes(J)?(U.className+=String.format(" {0}",F.a.j3e),this.$ta=O):this.LEa&&this.LEa.ar.includes(J)&&(U.className+=String.format(" {0}",F.a.i3e),this.LEa=O);this.aOi(a.a.mR,U,this.onMouseEnter,O);this.aOi(a.a.eL,U,
this.fpa,O);this.VXk(a.a.click,U,this.kGa,O);return U}Beo(J){if(J){var N=this.sqf(J);N?(this.VH.dU(J)&&(J=Object.assign(new y.a,{action:0,type:3,sA:N,BJ:this.$ta}),this.Au.BF(J)),this.$ta=N,K.h3a(this.LEa,this.$ta)&&(this.LEa=null)):n.ULS.shipAssertTag(590112344,3016,!1)}else n.ULS.shipAssertTag(590112343,3016,!1)}EWk(){if(this.$ta){var J=Object.assign(new y.a,{action:1,type:3,sA:null,BJ:this.$ta});this.$ta=null;this.Au.BF(J)}}wkj(J){if(K.h3a(J,this.$ta)||K.h3a(J,this.LEa))return!0;const N=Object.assign(new y.a,
{action:2,type:3,sA:J,BJ:this.LEa});this.LEa=J;this.Au.BF(N);return!0}LDh(J){if(K.h3a(J,this.$ta))return!0;J=Object.assign(new y.a,{action:3,type:3,sA:null,BJ:this.LEa});this.LEa=null;this.Au.BF(J);return!0}sqf(J,N){N=N?N:this.oMl(J);if(!N)return null;const R=this.VH.dU(J);return new I.a(0<(null===R||void 0===R?void 0:R.XN.length)?null===R||void 0===R?void 0:R.XN:[J],N,K.Yhi(R),K.pMl(R))}static Yhi(J){if(!J)return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion;switch(J.suggestion.Eq){case 0:return K.xXd(J.state)?
WordEditorIntl.WordEditorStrings.L_ReviewUpdatedDesignerFormattingSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerFormattingSuggestion;case 1:case 3:return K.xXd(J.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerPullQuoteSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerPullQuoteSuggestion;case 2:return K.xXd(J.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerText2ImageSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerText2ImageSuggestion;default:return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion}}static pMl(J){return J?
K.xXd(J.state)?1:0:0}static xXd(J){return 0!==J&&.1!==J}oMl(J){var N=null,R=this.An.Uf(J);R.zb(11)&&(R.uc(),R=R.currentNode.Qj(this.wc.ic))&&(J=String.format("#{0}",K.f4h(J)),N=R.htmlElement.querySelector(J),!N&&Object(v.a)(z.a,R)&&(N=(N=R.Rjf())?N.querySelector(J):null));return N}static f4h(J){return String.format("p{0}{1}",J.id.guid,J.id.n)}static h3a(J,N){return!!N&&!!J&&J.OEc===N.OEc}}Object(E.a)(K,"BlueDotActor",l.a,[593,548])},1752:function(E,M,c){E=c(0);var m=c(632);class e{constructor(l){this.eFa=
l.wZl();this.kFb=l.kqf("intCopy");this.p9d=l.Rci("intCopy");this.oAb=l.Vnf("intCopy");this.Rdb=l.snf("intCopy")}static eF(){return e.Jr()}static Jr(){return new e(m.a.instance)}}Object(E.a)(e,"InternalCopyUsageHelper",null,[]);c.d(M,"a",function(){return a});class a{constructor(l,y,z){this.yW=e.eF();this.qDd=null;this.vOb=this.Une=!1;this.oUg=null;this.source=l;this.target=y;this.RXf=z}get zja(){return this.yW}get Ko(){return this.oUg}set Ko(l){this.oUg=l}}Object(E.a)(a,"InternalCopyArguments",null,
[])},1753:function(E,M,c){E=c(0);var m=c(1429);class e extends m.a{constructor(){super();this.LastAutoSaveErrorReported=0;this.LastAutoSaveCorrelation=null;this.MeritsErrorReport=!1;this.LocalCobaltMachineId=this.LocalCobaltSessionId=null;this.WaciiEnabledRequests=0;this.ShowMergePrompt=!1;this.PartMergeInfo=0}}Object(E.a)(e,"ALocalCobaltServerResponse",m.a,[]);c.d(M,"a",function(){return a});class a extends e{constructor(){super();this.RootCellId=null;this.AvailableFileAccess=0;this.PageHtml=this.ClientKnowledge=
this.LatestRevisionId=this.RevisionList=null;this.PinRevisionForAugLoopResponse=this.ContentBytes=0;this.RevisionIdPinnedForAugLoop=null;this.ScheduledShutdownTime=0;this.LastSavedToHostRevisionSequenceNumber=-1}}Object(E.a)(a,"GetChangesResponse",e,[])},1754:function(E,M,c){E=c(0);var m=c(80);class e extends Sys.EventArgs{constructor(){super()}}Object(E.a)(e,"UploadEventArgs",Sys.EventArgs,[]);c.d(M,"a",function(){return a});class a{constructor(){this.ra=new m.a}ing(l){this.ra.raiseEvent("UploadStarted",
new e(l,-1))}smc(l,y){this.ra.raiseEvent("UploadComplete",new e(l,y))}static get instance(){return null!=a.kCg?a.kCg:a.kCg=new a}}Object(E.a)(a,"Box4UploadNotifier",null,[496])},1757:function(E,M,c){E=c(0);var m=c(31),e=c(1047);class a extends e.a{isUserPromptField(I){return new l(I)}annotationStatusField(I){return new y(I)}annotationCharCountField(I){return new z(I)}userPromptCharCountField(I){return new n(I)}precedingTextsCharCountField(I){return new v(I)}followingTextsCharCountField(I){return new A(I)}promptTriggerSourceField(I){return new w(I)}promptIdField(I){return new G(I)}}
Object(E.a)(a,"AiInserterDataFieldsFactoryImpl",e.a,[]);class l extends m.a{constructor(I){super();this.name="isUserPrompt";this.bool=I}}Object(E.a)(l,"IsUserPromptDataField",m.a,[]);class y extends m.a{constructor(I){super();this.name="annotationStatus";this.int64=I}}Object(E.a)(y,"AnnotationStatusDataField",m.a,[]);class z extends m.a{constructor(I){super();this.name="annotationCharCount";this.int64=I}}Object(E.a)(z,"AnnotationCharCountField",m.a,[]);class n extends m.a{constructor(I){super();this.name=
"userPromptCharCount";this.int64=I}}Object(E.a)(n,"UserPromptCharCountField",m.a,[]);class v extends m.a{constructor(I){super();this.name="precedingTextsCharCount";this.int64=I}}Object(E.a)(v,"PrecedingTextsCharCountField",m.a,[]);class A extends m.a{constructor(I){super();this.name="followingTextsCharCount";this.int64=I}}Object(E.a)(A,"FollowingTextsCharCountField",m.a,[]);class w extends m.a{constructor(I){super();this.name="promptTriggerSource";this.string=I}}Object(E.a)(w,"PromptTriggerSourceField",
m.a,[]);class G extends m.a{constructor(I){super();this.name="promptId";this.string=I}}Object(E.a)(G,"PromptIdField",m.a,[]);m=c(944);c.d(M,"a",function(){return F});class F extends m.a{constructor(I){super(I,"AiInsert");this.fieldsFactory=new a}}Object(E.a)(F,"AiInserterTelemetryLoggerImpl",m.a,[])},1762:function(E,M,c){E=c(0);var m=c(331),e=c(272);class a{constructor(y,z,n,v,A,w,G){this.ol=y;this.xg=z;this.bF=n;this.clickInputManager=v;this.L5c=A;this.d_i=w;this.hPh=G;this.EQ=this.$Ab();this.bF.uaa(this.EQ.name);
this.clickInputManager.S_b(this.EQ.name,this.ol,this.EQ.jUa);y=this.aaf();this.xg.Ozb(this.ol,this.EQ,y)}focus(){this.xg.mg(this.EQ.name)}get isFocused(){return this.xg.currentScope===this.EQ}addIsFocusChangedHandler(y){this.EQ.d7(()=>y(!0));this.EQ.RYa(()=>y(!1))}doh(y){this.EQ.PYa(y)}dispose(){var y;this.xg.B5a(this.EQ.name);this.xg.currentScope||this.xg.mg(null!==(y=this.hPh)&&void 0!==y?y:e.a.Pn)}$Ab(){var y;const z=this.xg.ge(this.L5c);z.parent=null!==(y=this.d_i)&&void 0!==y?y:e.a.rp;z.jUa=
!0;z.$4c=!0;z.OH=!0;return z}aaf(){const y=new m.DOMFocusListing(()=>this.ol);y.Wm(8);return y}}Object(E.a)(a,"EditorAiFocusScopeImpl",null,[]);c.d(M,"a",function(){return l});class l{constructor(y,z,n,v){this.options=y;this.xg=z;this.bF=n;this.clickInputManager=v}registerScope(y){return new a(y,this.xg,this.bF,this.clickInputManager,this.options.L5c,this.options.d_i,this.options.hPh)}}Object(E.a)(l,"EditorAiFocusManagerImpl",null,[])},1788:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.authority=
this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static Q3h(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(E.a)(m,"WopiAuthContext",null,[735])},1789:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}m.gun="OneDriveWOPI";Object(E.a)(m,"HostApplicationType",
null,[])},1790:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}m.IKj="WAC_Word";m.bRc=null;Object(E.a)(m,"AddinHostApp",null,[])},1792:function(E,M){Object.defineProperty(M,"__esModule",{value:!0});M.RoleType=M.ErrorCode=void 0;(function(c){c[c.Success=0]="Success";c[c.DocumentTooLarge=1]="DocumentTooLarge"})(M.ErrorCode||(M.ErrorCode={}));(function(c){c[c.Unknown=0]="Unknown";c[c.Title=1]="Title";c[c.Subtitle=2]="Subtitle";c[c.Heading1=3]="Heading1";c[c.Heading2=4]="Heading2";c[c.Heading3=
5]="Heading3";c[c.Heading4=6]="Heading4";c[c.Heading5=7]="Heading5";c[c.Heading6=8]="Heading6";c[c.Heading7=9]="Heading7";c[c.Heading8=10]="Heading8";c[c.Heading9=11]="Heading9";c[c.ListItem=12]="ListItem";c[c.BodyText=13]="BodyText";c[c.ListHeader=14]="ListHeader";c[c.Caption=15]="Caption";c[c.CoverPageElement=16]="CoverPageElement"})(M.RoleType||(M.RoleType={}))},1793:function(E,M,c){Object.defineProperty(M,"__esModule",{value:!0});M.NavigationPaneInputClassifierSignal=M.DesignerInputClassifierSignal=
M.DocumentRoleDetectionAnnotation=M.RoleDetectionAnnotation=M.RoleDetectionSettings=M.RoleDetectionCustomMetadata=M.BasePartialDocumentLevelAnnotation=M.WordNavPaneInputTargetDocumentClassificationAnnotation=M.WordDesignerInputTargetDocumentClassificationAnnotation=M.BaseInputTargetDocumentClassificationAnnotation=void 0;const m=c(211);class e{constructor(F){m.SchemaObject.assign(e,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,
[e.getTypeName()])}}M.BaseInputTargetDocumentClassificationAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(F){m.SchemaObject.assign(a,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_WordDesignerInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,
[a.getTypeName()])}}M.WordDesignerInputTargetDocumentClassificationAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(F){m.SchemaObject.assign(l,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_WordNavPaneInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,
[l.getTypeName()])}}M.WordNavPaneInputTargetDocumentClassificationAnnotation=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class y{constructor(F){m.SchemaObject.assign(y,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,[y.getTypeName()])}}M.BasePartialDocumentLevelAnnotation=y;y.H_=
{T_:y.getTypeName(),B_:y.getBaseTypes()};class z{constructor(F){m.SchemaObject.assign(z,this,F)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionCustomMetadata"}static getBaseTypes(){return[]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,[z.getTypeName()])}}M.RoleDetectionCustomMetadata=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class n{constructor(F){m.SchemaObject.assign(n,this,F)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionSettings"}static getBaseTypes(){return[]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,
[n.getTypeName()])}}M.RoleDetectionSettings=n;n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class v{constructor(F){m.SchemaObject.assign(v,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,[v.getTypeName()])}}M.RoleDetectionAnnotation=v;v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};
class A{constructor(F){m.SchemaObject.assign(A,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_DocumentRoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,[A.getTypeName()])}}M.DocumentRoleDetectionAnnotation=A;A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class w{constructor(F){m.SchemaObject.assign(w,
this,F)}static getTypeName(){return"AugLoop_RoleDetection_DesignerInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,[w.getTypeName()])}}M.DesignerInputClassifierSignal=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class G{constructor(F){m.SchemaObject.assign(G,this,F)}static getTypeName(){return"AugLoop_RoleDetection_NavigationPaneInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,
[G.getTypeName()])}}M.NavigationPaneInputClassifierSignal=G;G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()}},1794:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e){this.extensions=e}}Object(E.a)(m,"ExtensionList",null,[])},1795:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(1752);class m extends c.a{constructor(e,a){super(e.source,e.target,e.RXf);this.Di=e;this.insertAfter=a}get zja(){return this.Di.zja}get Ko(){return this.Di.Ko}set Ko(e){this.Di.Ko=e}}Object(E.a)(m,
"CoreInternalCopyArguments",c.a,[])},1796:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a,l,y,z=null){this.source=e;this.target=a;this.insertAfter=l;this.ZWf=y;this.Ko=z||{}}}Object(E.a)(m,"CoreInternalPasteArguments",null,[])},1797:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a="",l="",y="",z=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=e;this.Provider=a;this.DisplayName=l;this.Email=
y;this.IsCurrentUser=z}}Object(E.a)(m,"OfficeSharedCommentUser",null,[])},1798:function(E,M,c){c.d(M,"a",function(){return J});E=c(0);var m=c(55),e=c(1799),a=c(166),l=c(2),y=c(126),z=c(331),n=c(1365),v=c(757),A=c(530),w=c(1366),G=c(176),F=c(175),I=c(67),K=c(13);class J{constructor(N){this.B$=this.Zh=this.Q1=null;this.mD=0;this.aTb=this.jka=this.Ub=null;this.gfh=!1;this.zve=null;this.jJh=!0;this.ga=N;this.Tb()}get wca(){return this.Q1}get model(){return this.Zh}get s9b(){return this.B$}get Ofl(){return l.AFrameworkApplication.too}get rHo(){return l.AFrameworkApplication.voj}get ail(){return CommonUIStrings.l_DeleteCommentConfirm}get BCo(){return!1}get hA(){return!1}get FPi(){return!1}get Jhj(){return!1}get PWh(){return this.jka}set PWh(N){this.jka=
N}get mode(){return this.mD}set mode(N){N!==this.mD&&(this.mD=N,-1!==this.mD&&(this.Q1.g4a(),this.Zh.g4a(),0===this.mD&&this.ehf()))}get qOb(){return this.gfh}set qOb(N){this.gfh=N}get removePersonalInformation(){return!1}get xqj(){return!0}dispose(){this.Q1&&(this.Q1.dispose(),this.Q1=null);this.Zh&&(this.Zh.dispose(),this.Zh=null);this.B$&&(this.B$.dispose(),this.B$=null);this.ehf()}selectComment(N,R=1){const O=this.Zh.KD(N);!O||2===this.mode&&1!==O.Tq||(this.Zh.selectComment(O),this.B$.highlightComment(O,
!0),this.Q1.selectComment(O,R),1===R&&this.qOb&&this.jka.selectComment(N))}Y5c(){const N=this.Zh.Y5c();N&&(this.B$.highlightComment(N,!0),this.Q1.selectComment(N),this.qOb&&this.jka.selectComment(N.id))}Z5c(){const N=this.Zh.Z5c();N&&(this.B$.highlightComment(N,!0),this.Q1.selectComment(N),this.qOb&&this.jka.selectComment(N.id))}bfe(N){N?this.selectComment(N,0):this.Q1.uPi&&this.eof().Zj.Gy(this.Q1.uPi)}clearSelection(){this.Zh.clearSelection();this.qOb&&this.jka.selectComment(null);this.B$.TWk()}paneClosing(){this.hA||
(2===this.mD?(this.clearSelection(),this.deleteComment(this.Zh.ny)):this.clearSelection())}Qyb(N){if(1===this.mode){N=e.a.dBb(N);var R=({anchor:O}=this.B$.j7k()).returnValue;if(O&&0===R)this.addComment(N,O);else{switch(R){case 1:N=CommonUIStrings.l_NewCommentError;break;case 2:N=CommonUIStrings.l_NewCommentInvalidContent;break;default:N=CommonUIStrings.l_NewCommentError}var O=new F.StandardDialog;O.Ad=0;O.Yia(CommonUIStrings.l_DefaultDialogTitle,N,null)}}}addComment(N){0!==this.mode&&(this.Zh.xqk(N),
0===N.Tq||this.FPi||this.selectComment(N.id),this.ga.processAction(K.a.$Fh,2))}editComment(N,R){1===this.mode&&N&&(this.Zh.bKc(N,R),this.selectComment(N.id))}E5e(){this.Zh.dSk()}addReply(N,R){1===this.mode&&(N=this.Zh.OJh(N,R),this.selectComment(N.id,0),this.ga.processAction(K.a.dGh,2))}deleteComment(N){if(1!==this.mode)if(2===this.mode){if(1!==N.Tq)return;this.mode=1}else return;this.xqj&&1!==N.Tq?(this.aTb=N,N=new F.StandardDialog,N.Ad=4,N.XU(2),N.ueg(CommonUIStrings.l_DefaultDialogTitle,this.ail,
Object(m.a)(this,this.hil,"deleteDialogHandler"))):this.UIc(N)}Tb(){this.ga.fb(K.a.N_k,I.a.frame,y.ActionManager.Of,64);this.ga.fb(K.a.O_k,I.a.frame,y.ActionManager.Of,64);this.ga.fb(K.a.zFh,I.a.frame,y.ActionManager.Of,64);this.ga.qa(K.a.i8e,I.a.frame,y.ActionManager.Of);this.ga.qa(K.a.GFh,I.a.frame,y.ActionManager.Of);this.ga.qa(K.a.HFh,I.a.frame,y.ActionManager.Of);this.ga.fb(K.a.T_k,I.a.frame,y.ActionManager.Of,64);this.ga.fb(K.a.U_k,I.a.frame,y.ActionManager.Of,64);this.ga.qa(K.a.$Fh,I.a.frame,
y.ActionManager.Of);this.ga.qa(K.a.aGh,I.a.frame,y.ActionManager.Of);this.ga.qa(K.a.dGh,I.a.frame,y.ActionManager.Of);this.ga.fb(K.a.J0k,I.a.frame,y.ActionManager.Of,64);this.ga.fb(K.a.L0k,I.a.frame,y.ActionManager.Of,64);this.ga.fb(K.a.K0k,I.a.frame,y.ActionManager.Of,64);this.ga.qa(K.a.fGh,I.a.frame,y.ActionManager.Of);this.ga.qa(K.a.n4a,I.a.frame,()=>{this.n4a();return 32})}hil(N){1===N?this.UIc(this.aTb):(this.aTb&&this.selectComment(this.aTb.id),this.aTb=null)}UIc(N){const R=N.Df;1===N.Tq?this.ga.processAction(K.a.i8e,
2):this.ga.processAction(K.a.GFh,2);this.aTb=null;this.qOb||this.clearSelection();N=this.Zh.deleteComment(N);for(let O=0;O<N.length;O++)N[O].dispose();this.bfe(R)}iAb(N,R){0!==this.mode&&(this.ga.processAction(R?K.a.HFh:K.a.fGh,2),this.Zh.iAb(N,R))}jua(N){this.Zh.jua(N);this.mode=1;this.ga.processAction(K.a.aGh,2)}Jeb(N){this.Zh.Jeb(N);this.mode=1}Z0k(N,R){this.Zh.cRn(N,R)}lSc(){}ehf(){}NOb(N,R,O,L,U){return this.Q1.NOb(N,R,O,L,U)}NY(N,R,O,L,U){return this.Q1.NY(N,R,O,L,U)}eof(){var N=this.Ub.getRegion(a.AFrame.Gr);
if(!N){const R=this.Ub.ge(a.AFrame.Gr);N=new z.DOMFocusListing(()=>this.wca.F0c);N.Mpa=!0;N.Wm(3);N.Wm(2);N.Wm(4);N.Wm(1);N.Wm(6);N.Wm(5);this.Ub.Yla(()=>this.wca.F0c,R,N);N=this.Ub.getRegion(a.AFrame.Gr);N.mSa();N.jR=!0;N.UZa=!0;R.ir(this.Ub.nW);R.ir(this.Ub.oW)}return N}Lyd(N,R){0!==this.mode&&this.Zh.Lyd(N,R)}Pce(N,R){0!==this.mode&&this.Zh.Pce(N,R)}n4a(){G.UISurfaces.tM().then(N=>{var R=Object.assign(new n.a,{target:this.Jhj?'[data-unique-id*="ShowCommentsTopBar"]':'[data-unique-id~="ShowCommentsTopBar"]',
showCloseIcon:!0,content:CommonUIStrings.l_DeepLinkedCommentDoesNotExistNotification,calloutProps:Object.assign(new w.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});R=N.callout(R);const O=Object.assign(new A.a,{expirationOptions:Object.assign(new v.a,{displayTimeoutSeconds:10,onExpire:Object(m.a)(this,this.dismiss,"dismiss")})});this.zve=N.addNotification(R,O)})}dismiss(){G.UISurfaces.tM().then(N=>{N.removeNotification(this.zve);return this.zve=null})}static get instance(){return J._instance||
(J.factory?J._instance=J.factory():null)}static set instance(N){J._instance=N}}J._instance=null;J.factory=null;Object(E.a)(J,"CommentManager",null,[618,619,9])},1799:function(E,M,c){c.d(M,"a",function(){return a});E=c(0);var m=c(2),e=c(934);class a{constructor(){this.$i=null;this.$g=[];this._changes=[];this.mab=this.GYb=this.Qy=null}get $s(){return this.Qy}get ny(){return this.mab}initialize(l){this.$i=l}dispose(){const l=this.$g.length;for(let y=0;y<l;y++)this.$g[y].dispose();this.$g=[]}g4a(){this.Qy&&
this.Qy.g4a();this.GYb&&this.GYb.g4a()}selectComment(l){this.clearSelection();l.Kia=1;this.Qy=l;if(l.Df){var y=Array.indexOf(this.$g,l);for(--y;0<=y;y--){const z=this.$g[y];if(z.id===l.Df){z.Kia=2;this.GYb=z;break}}}m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Nb.zoa&&e.ShyRibbon.qeb(1,0)}Y5c(){if(!this.$g.length)return null;let l;l=this.Qy?this.F5h(this.Qy,!0):this.$g[0];this.selectComment(l);return l}Z5c(){if(!this.$g.length)return null;let l;l=this.Qy?this.fPl(this.Qy):this.$g[this.$g.length-
1];this.selectComment(l);return l}clearSelection(){this.Qy&&(this.Qy.Kia=0,this.Qy=null);this.GYb&&(this.GYb.Kia=0,this.GYb=null)}bKc(l,y){this.$i.mode=3;l.Tq=2;l.KSa=0;l.gz=y;this.mab=l}dSk(){this.mab=null;this.$i.mode=1}OJh(l,y){var z=this.KD(l);this.$i.mode=2;this.mab=l=c(1640).Comment.kKh(m.AFrameworkApplication.userName,l,z.nki,y);for(y=this.$g.length-1;0<=y;y--)if(z=this.$g[y],z.Df===l.Df||z.id===l.Df){Array.insert(this.$g,y+1,l);break}return l}jua(l){this.gGh(l,2)}Jeb(l){this.gGh(l,4)}deleteComment(l){const y=
[],z=Array.indexOf(this.$g,l);for(;z<this.$g.length;){const n=this.$g[z];if(n.id===l.id||n.Df===l.id)Array.removeAt(this.$g,z),Array.add(y,n);else break}this.j3c(y,3);-1<Array.indexOf(y,this.mab)&&(this.mab=null,this.$i.mode=1);return y}iAb(l,y){const z=[];let n=Array.indexOf(this.$g,l);for(;n<this.$g.length;){const v=this.$g[n];if(v.id===l.id||v.Df===l.id)v.done=y,Array.add(z,v),n++;else break}this.j3c(z,y?0:1)}xO(){return Array.clone(this.$g)}Y8b(){return!!this.$g&&!!this.$g.length}KD(l){for(let y=
0;y<this.$g.length;y++){const z=this.$g[y];if(z.id===l)return z}return null}F5h(l,y){l=Array.indexOf(this.$g,l);return l===this.$g.length-1?y?this.$g[0]:null:this.$g[l+1]}hVl(l,y=!1){let z=l=Array.indexOf(this.$g,l);do if(z=z===this.$g.length-1?0:z+1,!y||!this.$g[z].done)return this.$g[z];while(z!==l);return this.$g[l]}fPl(l){return(l=Array.indexOf(this.$g,l))?this.$g[l-1]:this.$g[this.$g.length-1]}iVl(l,y=!1){let z=l=Array.indexOf(this.$g,l);do if(z=z?z-1:this.$g.length-1,!y||!this.$g[z].done)return this.$g[z];
while(z!==l);return this.$g[l]}Lyd(){}Pce(){}gGh(l,y){const z=[];l.Tq=0;Array.add(z,l);this.j3c(z,y);this.mab=null}static dBb(l){return c(1640).Comment.kKh(m.AFrameworkApplication.userName,null,c(1640).Comment.mZi,l)}}Object(E.a)(a,"CommentModel",null,[9,615])},1800:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}m.IGc="CommentPaneTextbox";m.JEd="CommentPane";m.S_k="CommentDeleteButton";m.I0k="CommentSaveButton";m.H0k="CommentReplyButton";m.R_k="CommentCancelButton";m.eGh="CommentTextEntry";
m.N0k="CommentTabHelp";Object(E.a)(m,"CommentManagerConstants",null,[])},1801:function(E,M,c){c.d(M,"a",function(){return l});E=c(0);var m=c(443),e=c(89),a=c(26);class l{dispose(){}static i_a(y,z,n,v=null,A=!0){var w=A?"":n;y=m.a("a",y,"StandardButton "+z);y.title=w;y.tabIndex=0;w=null;v?(w=e.createClusteredImage(16,16,v,"StandardButtonImage",!0,null),w.setAttribute(a.a.qh,a.a.Yy),y.appendChild(w)):Sys.UI.DomElement.addCssClass(y,"StandardButtonNoImage");A?(v=m.a("span",null,"StandardButtonLabel"),
v.innerText=n,y.appendChild(v)):Sys.UI.DomElement.addCssClass(w,"StandardButtonImageNoText");y.setAttribute(a.a.qh,a.a.e3);return y}static MNb(y,z){void 0!==y&&null!==y&&(y.disabled=!z,z?(z=a.a.dM,Sys.UI.DomElement.removeCssClass(y,"DisabledButton"),Sys.UI.DomElement.removeCssClass(y,"cui-disabled")):(z=a.a.jp,Sys.UI.DomElement.containsCssClass(y,"DisabledButton")||Sys.UI.DomElement.addCssClass(y,"DisabledButton"),Sys.UI.DomElement.containsCssClass(y,"cui-disabled")||Sys.UI.DomElement.addCssClass(y,
"cui-disabled")),a.a.gr(y,a.a.N1e,z))}}Object(E.a)(l,"SimpleButtonFactory",null,[9])},1803:function(E,M,c){c.d(M,"a",function(){return w});E=c(0);var m=c(79),e=c(11),a=c(2),l=c(20),y=c(19),z=c(44),n=c(7),v=c(3),A=c(9);class w{constructor(G,F,I,K,J="@"){this.wPe=this.Xmd=this.XDe=this.ae=null;this.I2g=this.dub=this.yka=this.nsa=this.eMg=!1;this.kea=0;this.ydg=!1;this.FKb=()=>{this.reset()};this.aNa=N=>{this.kea=N.Gb.keyCode;var R=N.Gb.rawEvent.key;R&&R!==this.Dma||(this.ydg=!0);return this.yka&&this.Xmd?
N.Gb.keyCode===m.a.t1||N.Gb.keyCode===m.a.zs||N.Gb.keyCode===m.a.ww?(R=!1,N.Gb.keyCode===m.a.t1?(n.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),R=!0):N.Gb.keyCode===m.a.zs?n.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):N.Gb.keyCode===m.a.ww&&n.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up"),this.Xmd(N),R&&this.reset(),!0):N.Gb.keyCode===m.a.vda||N.Gb.keyCode===m.a.H5||N.Gb.keyCode===
m.a.u1||N.Gb.keyCode===m.a.v1||N.Gb.keyCode===m.a.G5||N.Gb.keyCode===m.a.wL?(this.Xmd(N),!0):!1:!1};this.Hqa=N=>{if(this.ydg||this.yka){this.ydg=!1;var R=this.ROc(),O=this.ENc(N.Gb.target),L=N.Gb.rawEvent.inputType;return(void 0!==L&&null!==L||this.kea!==m.a.aC&&this.kea!==m.a.s1)&&"deleteContentBackward"!==L&&"deleteContentForward"!==L?this.sli(R,O,N.Gb.target):!1}};this.tIk=N=>{if(1!==N.Gb.rawEvent.key.length)return!1;const R=this.ROc(),O=this.ENc(N.Gb.target);return this.sli(R,O,N.Gb.target)};
this.CQa=N=>{if(!this.yka)return!1;const R=this.ROc(),O=this.ENc(N.Gb.target);(N.Gb.keyCode===m.a.aC||N.Gb.keyCode===m.a.s1||(N.Gb.keyCode===m.a.HUa||N.Gb.keyCode===m.a.Qnc)&&N.Gb.ctrlKey)&&this.swf(R,O,N.Gb.target);return!1};this.D2e=(N,R)=>{this.kea=R.ABf?m.a.aC:R.isDelete?m.a.s1:this.kea;this.yka&&(R.ABf?this.kkm(R.sDi):R.isDelete&&this.Pkm(R.sDi))};this.Ae=G;this.pk=F;this.Moc=I;this.fd=K;this.Dma=J;this.reset()}Odb(G,F){this.nsa||(this.nsa=!0,G.swa?this.Pdb(F):G.Xea(()=>{this.nsa||this.Pdb(F)}))}dispose(){this.dub&&
(A.App.ya.glc.rc(e.a.input,this.fd.editingView.editingElement,this.Hqa),this.dub=!1);this.eMg&&(this.ae.rc(e.a.rBd,this.fd.editingView.editingElement,this.tIk),this.eMg=!1);this.I2g&&(this.ae.rc(e.a.XF,this.fd.editingView.editingElement,this.aNa),this.ae.rc(e.a.vh,this.fd.editingView.editingElement,this.CQa));A.App.ya.Jca(this.FKb);this.Euj()}g4f(G){this.XDe=G}q4f(G){this.wPe=G}h4f(G){this.Xmd=G}zIk(){this.yka=!0;a.AFrameworkApplication.ue("ContextIQAtMentionEntryPoint-Treatment;ContextIQAtMentionEntryPoint-Control")}Euj(){this.yka=
!1}mF(){return this.yka}Pdb(G){this.ae=G;if(!this.fd.Bd)n.ULS.sendTraceTag(593376530,324,10,"SelectionView is null. AtMentions will not work in this session");else if(this.fd.Bd.Vi){if(A.App.WEc&&l.a.fke||l.a.Xt)A.App.ya.glc.lb(e.a.input,this.fd.editingView.editingElement,this.Hqa,null),this.dub=!0;this.ae&&(this.ae.lb(e.a.XF,this.fd.editingView.editingElement,this.aNa),this.ae.lb(e.a.vh,this.fd.editingView.editingElement,this.CQa),this.I2g=!0);this.Moc.Gph(this.D2e);A.App.ya.VZ(this.FKb)}}sli(G,
F,I){if(1>F)return!1;G=G.replace(new RegExp(w.newLine,"g"),"");const K=G.charAt(F-1);this.yka&&K!==this.Dma?this.swf(G,F,I):this.yka||K!==this.Dma?this.yka&&K===this.Dma&&n.ULS.sendTraceTag(41178052,324,50,"Tried to type @ while already in at mention mode"):this.XDe&&(this.reset(),this.jFn(F,G)&&(this.zIk(),this.swf(G,F,I),n.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===F?"true":"false")));return this.yka}reset(){this.nsa=!1;this.Euj();this.wPe&&this.wPe()}ENc(G){return this.pk.U6b(2,
G)}ROc(){return this.Ae.gw().innerText}jFn(G,F){return 0>G-2||this.ATk(F.charAt(G-2))?!0:!1}ATk(G){return y.a.$ba(G)||"("===G}swf(G,F,I){if(!G||""===G||0>F)this.reset();else{const {Ggj:K,bBd:J}=this.cVm(G,F);this.XDe(K,I,J)}}cVm(G,F){const I=this.CLl(G,F);if(0<=I&&F<=G.length)return{Ggj:G.substring(I,F),bBd:I};this.reset();return{Ggj:"",bBd:I}}CLl(G,F){let I=-1,K=F;for(K;0<=K&&63>=F-K;K--)if(G.charAt(K)===this.Dma){I=K;break}63<F-K&&-1==I&&z.c(v.a.JNo,!0,void 0,void 0,void 0,void 0);return I}kkm(G){G=
this.ENc(G.Gb.target);G=this.ROc().charAt(G-1);this.yka&&G===this.Dma&&this.reset()}Pkm(G){G=this.ENc(G.Gb.target);G=this.ROc().charAt(G);this.yka&&G===this.Dma&&this.reset()}}w.newLine="\n";Object(E.a)(w,"AtMentionsListener",null,[12])},1804:function(E,M,c){c.d(M,"a",function(){return A});E=c(0);var m=c(7),e=c(78),a=c(755),l=c(124),y=c(8),z=c(347),n=c(1805);class v{constructor(w,G){this.YQc=w;this.jTc=G}x7h(){return this.jTc?this.YQc.begin:this.YQc.end}Bfo(w){this.jTc?this.YQc.begin=w:this.YQc.end=
w}dxi(w,G){const F=this.x7h()+(this.jTc?0:-1);return F>=w&&F<G}}Object(E.a)(v,"HitRangeEdge",null,[]);class A{get Uc(){return null}get uj(){return null}get soa(){return!1}get $Bf(){return!1}jZe(){}E4d(){return!1}Jkg(){return!1}j8h(w){return e.f(w,()=>!1)}Bva(){return null}X3d(w,G,F,I,K){G=G||[];F=F||[];const J=[];let N=0,R=0,O=0;for(;N<G.length||R<F.length;){const L=N<G.length&&R<F.length?G[N].begin<F[R].begin?G[N++]:F[R++]:N<G.length?G[N++]:F[R++];J[O]=n.a.createInstance(L.begin,L.end,w,O,I,K);++O}return J}LXl(w,
G){if(!G)return null;if(!y.ParagraphReader.AHh(w))return this.E1a(w.characterData,G);const F=this.dhm(w,l.AParagraphNode.SLc);w=this.hhm(w,F);G=this.E1a(w,G);if(!G)return G;G=this.jCn(G);this.IWn(G,F);return G=this.kAl(G,F)}dhm(w,G){G=Object(z.c)(G);const F=Object(z.a)(G);return[...y.ParagraphReader.bPc(w)].map(I=>{I.isVisible=F(I);return I})}hhm(w,G){G=G.filter(F=>F.isVisible);return y.ParagraphReader.sSd(w,G)}jCn(w){const G=[];for(const F of w)G.push(new v(F,!0)),G.push(new v(F,!1));return G}IWn(w,
G){if(0!==w.length){var F=0,I=0;for(const K of G){if(F>=w.length)break;if(K.isVisible)for(;F<w.length;){G=w[F];if(!G.dxi(K.chp.cp-I,K.cpEnd-I))break;G.Bfo(G.x7h()+I);F++}else I+=K.cpEnd-K.chp.cp}}}kAl(w,G){if(0===w.length)return[];const F=[];let I=0,K=!1;for(const J of G){if(I>=w.length)break;if(J.isVisible)for(;I<w.length;){G=w[I];if(!G.dxi(J.chp.cp,J.cpEnd))break;G.jTc?K=!0:!G.jTc&&K&&(F.push(G.YQc),K=!1);I++}else K=!1}return F}Nzi(){return!1}Yzi(){return!1}E1a(w,G){if(G&&w){let F;const I=[];try{for(;F=
G.exec(w);){const K=new a.a(F.index,G.lastIndex);I.push(K)}return I}catch(K){m.ULS.sendTraceTag(522846819,313,15,K instanceof SyntaxError?"Invalid regular expression":`errorName: ${K.name}`)}}return null}yce(){}}Object(E.a)(A,"BaseFindManagerHelper",null,[716])},1805:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a,l,y,z,n,v){this.id=++m.sgk;this.fMg=e;this.u$a=a;this.y7g=l;this.dYg=y;this.Ak=z;this.e_g=n;this.ap=v;this.next=this.previous=null}get begin(){return this.fMg}get end(){return this.u$a}get type(){return this.Ak}ici(){return this.ap.Bva(this.nodeId)}get nodeId(){return this.y7g}get vPa(){return this.dYg}get mXd(){return this.e_g}g6k(e){this.fMg=
e.begin;this.u$a=e.end;this.y7g=e.nodeId;this.dYg=e.vPa;this.Ak=e.type;this.e_g=e.mXd}static createInstance(e,a,l,y,z,n){const {FindManagerHelper:v}=c(1527);return new m(e,a,l,y,z,n,v.instance)}}m.sgk=0;Object(E.a)(m,"FindResult",null,[741])},1806:function(E,M,c){c.d(M,"a",function(){return l});E=c(0);var m=c(55),e=c(92),a=c(20);class l{constructor(y,z,n){this.ys=this.oWf=null;this.Uch=this.acb=this.Tch=this.oBa=0;this.Hid=null;this._context=y;this.Hb=z;this.Ma=n;this.y4b=!1;this.Yne=!0;this.b4n();
this.EJb=this.K.$("NativeFileOpenDialogIsEnabled")}get context(){return this._context}get K(){return this.Ma}get retryCount(){return this.oBa}get Z5n(){return this.Tch}get P5a(){return this.acb}get $5n(){return this.Uch}Tec(y){this.ys=y;if(!this.y4b){if(this.Yne){if(this.EJb&&a.a.LH){this.Hid=y.RId(Object(m.a)(this,this.DTf,"onFileChosen"));return}this.Hid=y.RId(null);if(!this.oza(this.Hid,y))return}this.tOa(y,null)}}DTf(y){if(this.oza(y,this.ys)){if(a.a.LH||a.a.jj)this.Hid=y;this.tOa(this.ys,null)}}S_c(){this.oWf&&
this.oWf()}f6n(y){if(!y||this.retryCount>=this.Z5n)return!1;this.oBa=this.retryCount+1;const z=new e.a(2,1,this.P5a,()=>{this.zde(y)},110);this.Hb.Vb(z);this.P5a<this.$5n&&(this.acb=2*this.P5a);return!0}b4n(){this.oBa=0;this.Tch=this.K.mc("Box4UploadRetryCount",20);this.acb=this.K.mc("Box4UploadRetryDelayStart",200);this.Uch=this.K.mc("Box4UploadRetryDelayMax",3200);this.ys&&(this.ys.dispose(),this.ys=null)}}Object(E.a)(l,"FileUploader",null,[])},1807:function(E,M,c){c.d(M,"a",function(){return e});
E=c(0);var m=c(2);c=c(80);class e{static nwk(a){e.yvg.addHandler(e.lFh,a)}static vLn(a){m.AFrameworkApplication.K.$("SqmCommandEventSourceEnabled")&&e.yvg.raiseEvent(e.lFh,a)}}e.lFh="CommandClickEvent";e.yvg=new c.a;Object(E.a)(e,"CommandClickEvents",null,[])},1808:function(E,M){Object.defineProperty(M,"__esModule",{value:!0});M.ErrorCode=M.FormattingSuggestionsRange=M.FormattingSuggestionType=void 0;(function(c){c[c.FontSize=0]="FontSize";c[c.FontFamily=1]="FontFamily";c[c.FontColor=2]="FontColor";
c[c.Alignment=3]="Alignment";c[c.Indentation=4]="Indentation";c[c.Bold=5]="Bold";c[c.RightIndentation=6]="RightIndentation";c[c.Italic=7]="Italic";c[c.Underline=8]="Underline";c[c.AllCaps=9]="AllCaps";c[c.LineSpacing=10]="LineSpacing";c[c.BeforeSpacing=11]="BeforeSpacing";c[c.AfterSpacing=12]="AfterSpacing";c[c.SpecialIndentType=13]="SpecialIndentType";c[c.SpecialIndentBy=14]="SpecialIndentBy";c[c.FontKerning=15]="FontKerning"})(M.FormattingSuggestionType||(M.FormattingSuggestionType={}));(function(c){c[c.Paragraph=
0]="Paragraph";c[c.List=1]="List"})(M.FormattingSuggestionsRange||(M.FormattingSuggestionsRange={}));(function(c){c[c.Success=0]="Success";c[c.DocumentTooLarge=1]="DocumentTooLarge"})(M.ErrorCode||(M.ErrorCode={}))},1809:function(E,M,c){Object.defineProperty(M,"__esModule",{value:!0});M.FormattingSuggestionsSummaryAnnotation=M.FormattingSuggestionsAnnotation=void 0;const m=c(211);class e{constructor(l){m.SchemaObject.assign(e,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,
[e.getTypeName()])}}M.FormattingSuggestionsAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}M.FormattingSuggestionsSummaryAnnotation=a;a.H_={T_:a.getTypeName(),
B_:a.getBaseTypes()}},1810:function(E,M){Object.defineProperty(M,"__esModule",{value:!0})},1811:function(E,M,c){Object.defineProperty(M,"__esModule",{value:!0});M.PullQuotesSignal=M.DocumentPullQuoteAnnotation=M.PullQuoteAnnotation=void 0;const m=c(211);class e{constructor(y){m.SchemaObject.assign(e,this,y)}get metadata(){return this.M_}set metadata(y){this.M_=y}static getTypeName(){return"AugLoop_PullQuotes_PullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(y){return m.SchemaObject.matchesTypesFor(y,
[e.getTypeName()])}}M.PullQuoteAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(y){m.SchemaObject.assign(a,this,y)}get metadata(){return this.M_}set metadata(y){this.M_=y}static getTypeName(){return"AugLoop_PullQuotes_DocumentPullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(y){return m.SchemaObject.matchesTypesFor(y,[a.getTypeName()])}}M.DocumentPullQuoteAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(y){m.SchemaObject.assign(l,
this,y)}static getTypeName(){return"AugLoop_PullQuotes_PullQuotesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(y){return m.SchemaObject.matchesTypesFor(y,[l.getTypeName()])}}M.PullQuotesSignal=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},1812:function(E,M){Object.defineProperty(M,"__esModule",{value:!0})},1813:function(E,M){Object.defineProperty(M,"__esModule",{value:!0})},1814:function(E,M){Object.defineProperty(M,"__esModule",{value:!0})},1815:function(E,M,
c){Object.defineProperty(M,"__esModule",{value:!0});M.TextToImageAnnotation=void 0;var m=c(211);E=function(){function e(a){m.SchemaObject.assign(e,this,a)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(a){this.M_=a},enumerable:!1,configurable:!0});e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageAnnotation"};e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};e.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};
e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();M.TextToImageAnnotation=E},1816:function(E,M,c){Object.defineProperty(M,"__esModule",{value:!0});M.TextToImageSignal=void 0;var m=c(211);E=function(){function e(a){m.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageSignal"};e.getBaseTypes=function(){return["AugLoop_TextToSuggestions_TextToSuggestionSignal","AugLoop_Signals_Signal"]};e.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();M.TextToImageSignal=E},1817:function(E,M,c){Object.defineProperty(M,"__esModule",{value:!0});M.TextToImageTraceSignal=void 0;var m=c(211);E=function(){function e(a){m.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageTraceSignal"};e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};e.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_=
{T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();M.TextToImageTraceSignal=E},1818:function(E,M){Object.defineProperty(M,"__esModule",{value:!0})},1819:function(E,M,c){Object.defineProperty(M,"__esModule",{value:!0});M.ThemeExtractorSignal=M.ThemeExtractorAnnotation=void 0;const m=c(211);class e{constructor(l){m.SchemaObject.assign(e,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,
[e.getTypeName()])}}M.ThemeExtractorAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}M.ThemeExtractorSignal=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1820:function(E,M){Object.defineProperty(M,"__esModule",{value:!0});M.TableType=
void 0;E=M.TableType||(M.TableType={});E[E.Other=0]="Other";E[E.SimpleHeaded=1]="SimpleHeaded"},1821:function(E,M,c){Object.defineProperty(M,"__esModule",{value:!0});M.TableTypeAnnotation=void 0;const m=c(211);class e{constructor(a){m.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_TableAnalysis_TableTypeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])}}M.TableTypeAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1822:function(E,M,c){c.d(M,"a",function(){return w});E=c(0);c(1541);var m=c(1599),e=c(2),a=c(19);c(1528);c(35);var l=c(7),y=c(1394),z=c(9),n=c(17),v=c(124),A=c(8);class w{constructor(G=2E3){this.Lmk=/(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)?/g;this.bbb=G}HGm(){w.WT();return!0}RSm(){return!0}getSelectedText(){const G=w.WT();return this.QRd(G)}Ctf(){const G=
w.WT();return this.$$l(G)}QRd(G){return this.wfi(G,!0)}$$l(G){return this.wfi(G,!1)}wfi(G,F){try{return this.Z$l(G,F)}catch(I){l.ULS.sendTraceTag(545869845,1303,15,"Error accessing selection: {0}",I)}return Object.assign(new m.a,{neighborhood:"",mentionStart:0,mentionLength:0})}Z$l(G,F){var I=null;let K=!1;F&&G&&G.hy&&n.SelectionEditor.gf(G.Qa)&&n.SelectionEditor.$jb(G.Qa)&&(l.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),K=n.SelectionEditor.gf(G.Qa),(I=
n.SelectionEditor.C3(G.Qa,!1))&&I.hy&&0<=I.Qa.cpBegin&&0<=I.Qa.cpEnd&&1>=I.Qa.cpEnd-I.Qa.cpBegin&&(I=null));I&&(G=I);if(!G)return Object.assign(new m.a,{neighborhood:"",mentionStart:0,mentionLength:0});const J=new Sys.StringBuilder;I=F=0;const N=[],R=G.length;let O=null;for(let X=0;X<R;X++){var L=G.J(X);if(!A.ParagraphReader.Wb(L.node)||Array.contains(N,L.node.Cl))continue;N.push(L.node.Cl);const V=y.a.create(L.cpBegin,L.cpEnd),Z=A.ParagraphReader.Agb(L.node,v.AParagraphNode.SLc,null,V);e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",
!1)&&K&&(O=this.Wxl(Z,V.xd));let da=Z,aa=0;var U=A.ParagraphReader.ig(L.node,!0,!0,!0);L=A.ParagraphReader.ig(L.node,!1,!0,!0);let ea=0;for(;da.length<this.bbb&&(U||L);){if(!(ea%2)&&U){var W=A.ParagraphReader.text(U,v.AParagraphNode.SLc);W&&(da=W+" "+da,aa+=W.length+1);U=A.ParagraphReader.ig(U,!0,!0,!0)}1===ea%2&&L&&(da=(W=A.ParagraphReader.text(L,v.AParagraphNode.SLc))?da+" "+W:da,L=A.ParagraphReader.ig(L,!1,!0,!0));ea++}U=X===R-1;X||-1===V.xd||(F=V.xd);I+=U&&-1!==V.endCp?V.endCp:Z.length;J.append(da);
e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",!1)&&K&&O&&(F=O.start,I=O.start+O.length);F+=aa;I+=aa;U||(J.append(" "),I++)}for(G=v.AParagraphNode.OU(J.toString()," ");F<I&&a.a.Ev(G.charCodeAt(F));)F++;for(;I>F&&a.a.Ev(G.charCodeAt(I-1));)I--;return this.lzk(G,F,I)}Wxl(G,F){for(var I;null!==(I=this.Lmk.exec(G));){const K=I.index;I=I[0].length;if(F>=K&&F<=K+I)return{start:K,length:I}}return null}lzk(G,F,I){if(G.length>this.bbb){var K=I-F;if(K>
this.bbb)G=G.substr(F,this.bbb),I=this.bbb,F=0;else{K=Math.max(F-Math.floor((this.bbb-K)/2),0);let J;J=Math.min(K+this.bbb,G.length);K=Math.max(J-this.bbb,0);F-=K;I-=K;G=G.substring(K,J)}}return Object.assign(new m.a,{neighborhood:G,mentionStart:F,mentionLength:I-F})}static WT(){var G=z.App.ya.gb.wc;if(!G)return l.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;G=G.mb;return G&&G.hb&&G.hb.length?G.hb.kb:(l.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),
null)}}Object(E.a)(w,"Box4InsightsSelection",null,[683,684])},1823:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(401);class m extends c.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(E.a)(m,"IconGalleryButtonProps",c.a,[])},1824:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.y=this.x=0}}Object(E.a)(m,"IPoint",null,[])},1825:function(E,M,c){c.d(M,"a",function(){return a});
E=c(0);var m=c(19),e=c(7);c=c(1559);class a extends c.a{constructor(l,y,z,n,v){super(l,y,v);this.hk=z;this.Nfh=v}Vlc(l){let y;if(this.WS&&!l)return e.ULS.sendTraceTag(594408835,307,10,"No htmlDomContent"),{returnValue:!1,Sua:null};if(this.Nfh){if(this.hk)return y=this.hk.jYf(l,!1),{returnValue:!0,Sua:y};e.ULS.sendTraceTag(592269661,307,10,"_clipboardDataHelper should not be null")}y=document.createElement("div");l=l.split(RegExp("\r\n|\r|\n"));for(var z=0;z<l.length-1;z++){const n=document.createElement("p");
n.innerText=this.pXc(l[z]);y.appendChild(n)}z=document.createElement("span");z.innerText=m.a.tKc(l[l.length-1]);y.appendChild(z);return{returnValue:!0,Sua:y}}pXc(l){return m.a.tKc(l.length?l:" ")}}Object(E.a)(a,"MultiLineTextImportStrategy",c.a,[])},1826:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(850);class m extends c.a{constructor(e,a,l,y,z=null,n=0,v=0,A=null,w=null,G=null,F=null){super(z?z.f9:null,z?z.vB:null,z?z.mpa:null,z?z.cultureName:null,z?z.VBa:null);this.src=e;this.alt=
a;this.width=l;this.height=y;this.maxWidth=n;this.maxHeight=v;this.href=A;this.ojl=w;this.Vif=G;this.RDd=F}}Object(E.a)(m,"ImageSemanticArgs",c.a,[])},1827:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);var m=c(109);class e{constructor(){this.Desc=this.Alt=this.Src=this.ImageId=null;this.ImageAnchorId=this.LockId=this.Height=this.Width=0;this.IsImageFromPaste=!1;this.EditContainerWidth=0;this.LocalizedPicture=null;this.IsLayoutSizeSetByUser=!1;this.ClipServiceArgs=this.WordId=this.RunId=this.ContentNodes=
null}static construct(a,l,y,z,n,v,A,w,G,F,I,K,J,N,R,O=null){const L=new e;L.ImageId=a;L.Src=l;L.Alt=y;L.Width=z;L.Height=n;L.Desc=v;L.LockId=A;L.ImageAnchorId=w;L.IsImageFromPaste=G;L.EditContainerWidth=F;L.LocalizedPicture=I;L.IsLayoutSizeSetByUser=K;if(J&&0<J.length){L.ContentNodes=Array(J.length);a=0;for(const U of J)L.ContentNodes[a]=m.a(U),a++}L.RunId=N;L.WordId=R;L.ClipServiceArgs=O;return L}}Object(E.a)(e,"PastedPicture",null,[])},1828:function(E,M,c){c.d(M,"a",function(){return a});E=c(0);
var m=c(22);M=c(582);var e=c(1829);class a extends M.a{constructor(){super();this.DataUriPictures=!1;this.FileId=this.PastedPictures=null;this.InkExternalPartFileFormatFixIsEnabled=this.PictureEditingInIllustrationCanvasIsEnabled=this.InkEditingInCanvasSupportedIsEnabled=this.ChartsPasteFromXLOIsEnabled=this.ClipServicePictures=!1}$k(){return 31}static construct(l,y,z=null,n=!1){const v=new a;v.DataUriPictures=y;v.PastedPictures=l;(l=m.a.instance.Na("Box4.IFeatureHelper"))&&l.isFeatureEnabled(e.a.chartsPasteFromXLO)&&
l.isFeatureEnabled(e.a.graphicsEditor)&&(v.ClipServicePictures=n,v.ChartsPasteFromXLOIsEnabled=!0,v.InkEditingInCanvasSupportedIsEnabled=!0,v.PictureEditingInIllustrationCanvasIsEnabled=!0,v.InkExternalPartFileFormatFixIsEnabled=!0);z&&z.length&&(v.FileId=z);return v}}Object(E.a)(a,"PicturePasteRequest",M.a,[])},1829:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);var m;(function(e){e[e.addAuthorInfoOnPutChanges=0]="addAuthorInfoOnPutChanges";e[e.addUpdateHintsToGraph=1]="addUpdateHintsToGraph";
e[e.addThemeColorValues=2]="addThemeColorValues";e[e.adjustStyles=3]="adjustStyles";e[e.agaveRangeEnhancement=4]="agaveRangeEnhancement";e[e.allowIdenticalRevisionMergeWithoutBase=5]="allowIdenticalRevisionMergeWithoutBase";e[e.annotationIgnorePersistence=6]="annotationIgnorePersistence";e[e.basicRichTextInComments_deprecated=7]="basicRichTextInComments_deprecated";e[e.blobFormatting=8]="blobFormatting";e[e.bookmarksFloatie=9]="bookmarksFloatie";e[e.catchUpActivity=10]="catchUpActivity";e[e.chartsPasteFromXLO=
11]="chartsPasteFromXLO";e[e.clientSideImageTransform=12]="clientSideImageTransform";e[e.clientSideNumbering=13]="clientSideNumbering";e[e.commentBackReferenceRemoval=14]="commentBackReferenceRemoval";e[e.contentApp=15]="contentApp";e[e.contentControlAdjustUnsupportedBlockContentControl=16]="contentControlAdjustUnsupportedBlockContentControl";e[e.contentControlAroundTableFix=17]="contentControlAroundTableFix";e[e.contentControlContainerNodeMerge=18]="contentControlContainerNodeMerge";e[e.contentControlCustomizedPlaceholder=
19]="contentControlCustomizedPlaceholder";e[e.contentControlDataModelEnhancement=20]="contentControlDataModelEnhancement";e[e.contentControlEditing=21]="contentControlEditing";e[e.contentControlPlainTextAdding=22]="contentControlPlainTextAdding";e[e.contentControlPlainTextMultilineSupport=23]="contentControlPlainTextMultilineSupport";e[e.contentControlRead=24]="contentControlRead";e[e.contentControlRendering=25]="contentControlRendering";e[e.contentControlSetPlaceholderText=26]="contentControlSetPlaceholderText";
e[e.contentControlTextVanish=27]="contentControlTextVanish";e[e.contentControlTrackedChangesFix=28]="contentControlTrackedChangesFix";e[e.contentControlTrackedFormattingFix=29]="contentControlTrackedFormattingFix";e[e.contentControlTuningUnsupportedCases=30]="contentControlTuningUnsupportedCases";e[e.contentControlWrite=31]="contentControlWrite";e[e.createNewStyleUI=32]="createNewStyleUI";e[e.customFontReadModePDF=33]="customFontReadModePDF";e[e.deleteFontStyles=34]="deleteFontStyles";e[e.deleteStyleInternalAPI=
35]="deleteStyleInternalAPI";e[e.docReplays=36]="docReplays";e[e.docPartObjectSdtSupport=37]="docPartObjectSdtSupport";e[e.doNotDeleteLastOG=38]="doNotDeleteLastOG";e[e.docxMergeUsingUpdateHints=39]="docxMergeUsingUpdateHints";e[e.editorClpProtectedCoauth=40]="editorClpProtectedCoauth";e[e.embeddedFonts=41]="embeddedFonts";e[e.endOfParagraphFormatting=42]="endOfParagraphFormatting";e[e.fixContentControlAdvanceIndex_Deprecated=43]="fixContentControlAdvanceIndex_Deprecated";e[e.fontSlotsImprovement=
44]="fontSlotsImprovement";e[e.forceLokiFallbackToACLPToken=45]="forceLokiFallbackToACLPToken";e[e.gc2InCanvasCore=46]="gc2InCanvasCore";e[e.gc2InCanvasPictures=47]="gc2InCanvasPictures";e[e.gc2InCanvasShapes=48]="gc2InCanvasShapes";e[e.graphicsEditor=49]="graphicsEditor";e[e.graphicsServiceDarkTraffic=50]="graphicsServiceDarkTraffic";e[e.graphMergeReplaysPrompt=51]="graphMergeReplaysPrompt";e[e.graphStoredFeatures=52]="graphStoredFeatures";e[e.hyperlinkColorBugFix=53]="hyperlinkColorBugFix";e[e.isProgressiveStyleEnabled=
54]="isProgressiveStyleEnabled";e[e.ignoreFormattingConflictsOnParagraphMerge=55]="ignoreFormattingConflictsOnParagraphMerge";e[e.ignoreMalformedColors=56]="ignoreMalformedColors";e[e.imageOverflow=57]="imageOverflow";e[e.imageRotate=58]="imageRotate";e[e.includeCommentsInMergeIgnoreFmtEnabled=59]="includeCommentsInMergeIgnoreFmtEnabled";e[e.increaseMaxWebFriendlyDimensionTo1600=60]="increaseMaxWebFriendlyDimensionTo1600";e[e.initializeTrackedRunState=61]="initializeTrackedRunState";e[e.intelligenceV2Schema=
62]="intelligenceV2Schema";e[e.intentSuggestion_Deprecated=63]="intentSuggestion_Deprecated";e[e.keepTogether=64]="keepTogether";e[e.labelingPolicies=65]="labelingPolicies";e[e.latentStylesSupportOnClient=66]="latentStylesSupportOnClient";e[e.lcsMergeReducedOps=67]="lcsMergeReducedOps";e[e.listDefinitionPropertyMergeFailure=68]="listDefinitionPropertyMergeFailure";e[e.listDocumentMetricsTelemetry=69]="listDocumentMetricsTelemetry";e[e.listIdAndListLevelOnParaNode=70]="listIdAndListLevelOnParaNode";
e[e.listMergeTableCells=71]="listMergeTableCells";e[e.listNumberingFix=72]="listNumberingFix";e[e.lockNotFullySupportedParagraphInBlockContentControl=73]="lockNotFullySupportedParagraphInBlockContentControl";e[e.logAddedAndDeletedReferences=74]="logAddedAndDeletedReferences";e[e.logRemovedCommentObjectIds=75]="logRemovedCommentObjectIds";e[e.mergeLogUnmatchedMarkers=76]="mergeLogUnmatchedMarkers";e[e.mergeMissingEopFix=77]="mergeMissingEopFix";e[e.mergePropertyValidationEnabled=78]="mergePropertyValidationEnabled";
e[e.mergeStrategyForUpdateFieldAutoSaveParameters=79]="mergeStrategyForUpdateFieldAutoSaveParameters";e[e.mergeStyleToggleProperties=80]="mergeStyleToggleProperties";e[e.mergeUsingUpdateHints=81]="mergeUsingUpdateHints";e[e.modifyStylesInternalApi=82]="modifyStylesInternalApi";e[e.nestedFieldsAdjustFix=83]="nestedFieldsAdjustFix";e[e.newStyleModel=84]="newStyleModel";e[e.numberedBulletFormatting=85]="numberedBulletFormatting";e[e.objectDataBlobIdMappedByHash=86]="objectDataBlobIdMappedByHash";e[e.outlineElementBasedCommentNavigation=
87]="outlineElementBasedCommentNavigation";e[e.pageBackgroundColor=88]="pageBackgroundColor";e[e.persistedAnnotationCoauthFix=89]="persistedAnnotationCoauthFix";e[e.pictureBorders=90]="pictureBorders";e[e.preserveEopFormattingReader=91]="preserveEopFormattingReader";e[e.qoESingleLevelListSupport=92]="qoESingleLevelListSupport";e[e.readListInfoFromParaNodeInsteadOfListNode=93]="readListInfoFromParaNodeInsteadOfListNode";e[e.readOnlyRecommended=94]="readOnlyRecommended";e[e.removalOfListNode=95]="removalOfListNode";
e[e.removeEditedImageUrlFromIgnoredProperties=96]="removeEditedImageUrlFromIgnoredProperties";e[e.removePersonalInformation=97]="removePersonalInformation";e[e.replaceFollowUpsWithComments=98]="replaceFollowUpsWithComments";e[e.resendCurrentRevision=99]="resendCurrentRevision";e[e.saveProofingInfo=100]="saveProofingInfo";e[e.setStyleOnParagraphNodeDesignerProof=101]="setStyleOnParagraphNodeDesignerProof";e[e.shapeEditingInlineCanvas=102]="shapeEditingInlineCanvas";e[e.stylesFlatteningOnClient=103]=
"stylesFlatteningOnClient";e[e.syntheticListNode=104]="syntheticListNode";e[e.tableCellMergeWithoutOENode=105]="tableCellMergeWithoutOENode";e[e.tableMergeReliabilityImprovement=106]="tableMergeReliabilityImprovement";e[e.tableNodeNormalization=107]="tableNodeNormalization";e[e.tableOfContentCreateAndDelete_Deprecated=108]="tableOfContentCreateAndDelete_Deprecated";e[e.tableOfContentRender=109]="tableOfContentRender";e[e.tableOfContentUpdate=110]="tableOfContentUpdate";e[e.tableRowFormatTrackChanges_Deprecated=
111]="tableRowFormatTrackChanges_Deprecated";e[e.tableStyle=112]="tableStyle";e[e.tableStyleMargin=113]="tableStyleMargin";e[e.tableStyleCellSpacing=114]="tableStyleCellSpacing";e[e.tableStyleCellVerticalAlignment=115]="tableStyleCellVerticalAlignment";e[e.tasks=116]="tasks";e[e.touchImprovement=117]="touchImprovement";e[e.trackChangeSettingNotificationInCurrentLocale_Deprecated=118]="trackChangeSettingNotificationInCurrentLocale_Deprecated";e[e.undoMergeUsingUpdateHints=119]="undoMergeUsingUpdateHints";
e[e.updateCpUsingUpdateHints=120]="updateCpUsingUpdateHints";e[e.updateTOCInWeb=121]="updateTOCInWeb";e[e.useImagePropertySet=122]="useImagePropertySet";e[e.useNSIDInLists=123]="useNSIDInLists";e[e.userBookmarks=124]="userBookmarks";e[e.userBookmarksHighlight=125]="userBookmarksHighlight";e[e.wordBookmarks=126]="wordBookmarks";e[e.wordTestFeature=127]="wordTestFeature"})(m||(m={}));Object(E.b)("WordEditorFeature",m)},1830:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,
a,l,y=!1){this.kDb=e;this.rDi=a;this.ZQk=l;this.IUm=y}}Object(E.a)(m,"ClearSpecificFormattingProperties",null,[])},1833:function(E,M){Object.defineProperty(M,"__esModule",{value:!0})},1834:function(E,M){Object.defineProperty(M,"__esModule",{value:!0});M.SuggestionCategory=void 0;E=M.SuggestionCategory||(M.SuggestionCategory={});E[E.TextRelatedImage=0]="TextRelatedImage";E[E.AbstractImage=1]="AbstractImage";E[E.Icon=2]="Icon"},1835:function(E,M){Object.defineProperty(M,"__esModule",{value:!0})},1836:function(E,
M){Object.defineProperty(M,"__esModule",{value:!0})},1837:function(E,M,c){Object.defineProperty(M,"__esModule",{value:!0});M.TextToSuggestionSignal=void 0;var m=c(211);E=function(){function e(a){m.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToSuggestions_TextToSuggestionSignal"};e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};e.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();
M.TextToSuggestionSignal=E},1838:function(E,M,c){c.d(M,"a",function(){return z});E=c(0);var m=c(92),e=c(189),a=c(7),l=c(110),y=c(48);class z{constructor(n,v,A,w,G,F,I,K,J){this.Pxd=0;this.cW=null;this.DYa="";this.zVb=this.mAe=!1;this.lKa=this.Z6=null;this.w6f=!1;this.GUb=null;this.Pzo=N=>{this.lKa===N&&(this.lKa=null,this.Z6?this.DYa=this.xea.Yfc(this.cW.text):(this.ESf(),this.findInternal(null)),this.Mtj())};this.findInternal=()=>{this.Z6=null;if(!this.G5e())if(!this.xea.Hmb(this.DYa).length)this.jeb(),
this.yob(!0);else if(!this.z7f())switch(this._state){case 0:this.O0o();break;case 1:this.m6i()}};this.G$a=n;this.xea=v;this.S1j=A;this.ap=w;this.nIe=G;this.Pwb=F;this.b2j=I;this.HUb=K;this.Jj=J;this._state=2;this.FL=0}get Bog(){return this.Pxd}set Bog(n){this.Pxd=n}get Umc(){return this.Pxd}set Umc(n){this.Pxd=n}get taskManager(){return this.nIe.value}get NMb(){return this.Pwb.value}get a5c(){return this.b2j.value}get IAl(){return this.mAe}yob(n){(this.mAe=n)&&this.G$a&&this.G$a.a6b()}get $jf(){return null}get OLc(){return this.GUb}find(n){this.cW=
n;this.pXk();this.lKa=new m.a(2,1,this.Bog,this.Pzo,51);this.taskManager.Vb(this.lKa)}yZa(){}X4c(){}woj(){return!1}XSd(){}YSd(){}qmi(){return!1}pXk(){this.Z6&&(this.taskManager.Ve(this.Z6),this.Z6=null);this.lKa&&(this.taskManager.Ve(this.lKa),this.lKa=null)}O0o(){var n=(new Date).getTime();this.gSi();const v=this.P0o(n);this._state||(this.Z6=new m.a(2,1,this.Umc,this.findInternal,52),this.taskManager.Vb(this.Z6));n=(new Date).getTime()-n;a.ULS.sendTraceTag(17306246,313,50,"{0}",{["Extension Walk Time"]:n,
["Count"]:v})}Zvf(n,v,A=!0){this.rCh(n);if(Object(l.a)(73,n))if(12===n.type)this.yjm(n,v,this.zVb,A);else{const w=this.ap.E1a(n.Bva(),this.OLc);A&&(w&&0<w.length?this.Nia(n,w):n.rfa());A=this.ap.X3d(n.id,w,null,v,this.zVb);this.kzd(n.id,A,n,v);this.eMf(n)}}yjm(n,v,A,w=!0){const G=[];var F=this.ap.j8h(n);if(!e.a.jf(F)&&(this.eMf(n),w))for(var I of F)F=this.ap.E1a(I.Bva(),this.OLc),e.a.jf(F)?this.rfa(I):(this.Nia(I,F),G.push(F));I=y.a.Pj?this.ap.LXl(n,this.OLc):this.ap.E1a(n.Bva(),this.OLc);this.rfa(n);
!e.a.jf(I)&&w&&this.Nia(n,I);A=this.ap.X3d(n.id,I,G,v,A);this.kzd(n.id,A,n,v)}P0o(n){let v=this._state=0;const A=this.mgi();this.O1i();const w=this.Lmj();do this.vWf(),v++;while(this.N8e(A)&&(new Date).getTime()-n<z.tMi);w&&w.dispose();this.oSf();return v}ESf(){}Mtj(){}G5e(){return!1}jeb(){}z7f(){return!1}m6i(){}gSi(){}rCh(){}Nia(){}rfa(){}eMf(){}kzd(){}oSf(){}mgi(){return null}O1i(){}Lmj(){return null}vWf(){}N8e(){return!1}}z.tMi=200;Object(E.a)(z,"BaseFindManager",null,[1345])},1839:function(E,
M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a,l){this.rootNode=e;this.bja=a;this.g6b=l}}Object(E.a)(m,"FindNodeContext",null,[])},1845:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a=null,l=null,y=null){this.iconSet={};this.iconSet["default"]=e;this.iconSet.icon16=a;this.iconSet.icon24=l;this.iconSet.icon32=y}}Object(E.a)(m,"IconSetContainer",null,[])},1848:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);c=c(453);class m extends c.a{constructor(){super()}}
m.S9e="conversionRequestType";m.lZf="png";m.dmf="gc2json";m.strict="strict";m.Fwl="existingcontent";m.error="error";Object(E.a)(m,"GraphicsEditorParameters",c.a,[])},1864:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e){this.zrb=0;this.Kod=isFinite(e)?Math.max(e,8):8;this.fp=Array(this.Kod);this.aj=this.edb=this.zXa=0;this.UPg=this.w6h(this.Kod)}get count(){return this.aj}get isEmpty(){return!this.count}enqueue(e){this.count===this.zrb&&this.Bum();this.fp[this.edb]=e;
this.edb++;this.edb===this.zrb&&(this.edb=0);this.aj=this.count+1}dequeue(){if(!this.count)throw Error.create("Empty Queue");const e=this.fp[this.zXa];this.zXa++;this.zXa===this.zrb&&(this.zXa=0);this.aj=this.count-1;this.count<=this.UPg&&this.agl();return e}IA(){if(!this.count)throw Error.create("Empty Queue");return this.fp[this.zXa]}Bum(){this.hlj(2*this.zrb)}agl(){const e=Math.max(this.zrb/2,this.Kod);this.count>e||this.hlj(e)}hlj(e){const a=Array(e);let l=0;if(this.zXa<this.edb||!this.count)for(var y=
this.zXa;y<this.edb;y++)a[l]=this.fp[y],l++;else{for(y=this.zXa;y<this.zrb;y++)a[l]=this.fp[y],l++;for(y=0;y<this.edb;y++)a[l]=this.fp[y],l++}this.fp=a;this.zrb=e;this.zXa=0;this.edb=l;this.UPg=this.w6h(e)}w6h(e){return e<=this.Kod?-1:Math.floor(.25*e)}}Object(E.a)(m,"Queue",null,[])},1902:function(E,M){Object.defineProperty(M,"__esModule",{value:!0});M.AnnotationStatus=M.DocumentCategory=void 0;(function(c){c.Article="Article";c.Letter="Letter";c.Poem="Poem";c.Story="Story";c.General="General";c.InterviewAssistant=
"InterviewAssistant";c.TravelPlan="TravelPlan";c.Recipe="Recipe";c.Resume="Resume";c.PodcastQuestions="PodcastQuestions"})(M.DocumentCategory||(M.DocumentCategory={}));(function(c){c[c.Success=0]="Success";c[c.OffensiveContentInput=1]="OffensiveContentInput";c[c.OffensiveContentOutput=2]="OffensiveContentOutput";c[c.EmptyResponse=3]="EmptyResponse";c[c.ErrorInExecution=4]="ErrorInExecution";c[c.ResourcesNotAvailable=5]="ResourcesNotAvailable";c[c.NonEnglishContentInput=6]="NonEnglishContentInput";
c[c.NonEnglishContentOutput=7]="NonEnglishContentOutput";c[c.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList";c[c.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList";c[c.InputAttackDetected=10]="InputAttackDetected";c[c.OutputAttackDetected=11]="OutputAttackDetected";c[c.ModelResultConversionFailed=12]="ModelResultConversionFailed";c[c.ResumeEntityRecognitionFailed=13]="ResumeEntityRecognitionFailed"})(M.AnnotationStatus||(M.AnnotationStatus={}))},1903:function(E,
M){Object.defineProperty(M,"__esModule",{value:!0})},1904:function(E,M){Object.defineProperty(M,"__esModule",{value:!0})},1905:function(E,M,c){Object.defineProperty(M,"__esModule",{value:!0});M.DocumentTextContentGeneratorAnnotation=M.DocumentTextContentGeneratorSignal=void 0;const m=c(211);class e{constructor(l){m.SchemaObject.assign(e,this,l)}static getTypeName(){return"AugLoop_DocumentTextContentGenerator_DocumentTextContentGeneratorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,
[e.getTypeName()])}}M.DocumentTextContentGeneratorSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_DocumentTextContentGenerator_DocumentTextContentGeneratorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}M.DocumentTextContentGeneratorAnnotation=a;a.H_=
{T_:a.getTypeName(),B_:a.getBaseTypes()}},1906:function(E,M,c){Object.defineProperty(M,"__esModule",{value:!0});M.PromptAssistanceAnnotation=M.PromptAssistanceSignal=void 0;const m=c(211);class e{constructor(l){m.SchemaObject.assign(e,this,l)}static getTypeName(){return"AugLoop_DocumentTextContentGenerator_PromptAssistanceSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[e.getTypeName()])}}M.PromptAssistanceSignal=e;e.H_={T_:e.getTypeName(),
B_:e.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_DocumentTextContentGenerator_PromptAssistanceAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}M.PromptAssistanceAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1930:function(E,M,c){c.r(M);E=c(0);var m=c(2),e=c(92),a=c(2007),
l=c(7),y=c(73),z=c(55),n=c(110),v=c(243),A=c(538),w=c(332),G=c(76),F=c(3),I=c(9),K=c(71),J=c(43),N=c(1040),R=c(5),O=c(95);class L extends K.a{constructor(){super(new O.a(33));this.bkf=this.v8f=0}cWd(){return 0}jGa(){const eb=new J.GraphTransaction(3);eb.Cb(this);const ib=new R.GraphIterator;ib.set(this);if(ib.rA()){const lb=ib.Qd();ib.set(lb);const Ya=N.b(ib,this.v8f,this.bkf),Fa=new R.GraphIterator;Fa.set(this);Fa.Qd();Fa.wg();Ya&&ib.currentNode!==lb&&Fa.Hf(ib.currentNode,-2)}eb.dispose()}}Object(E.a)(L,
"FindTrackingNode",K.a,[]);var U=c(17),W=c(46),X=c(8),V=c(1838),Z=c(1839);class da{constructor(eb){this.Wc=eb;eb=[];eb.push(1);this.Tgg=eb}h8h(eb){const ib=this.Wc.xk();ib.set(eb);const lb=[];ib.zb(8)&&(ib.hd(8),lb.push(new Z.a(ib.currentNode,eb,1)));return lb}static YE(){return new da(new A.a)}static get instance(){return null!=da.pBg?da.pBg:da.pBg=da.YE()}}Object(E.a)(da,"FindContextHelper",null,[282]);var aa=c(1527),ea=c(365),na=c(106),pa=c(15);class ja{constructor(eb,ib,lb,Ya,Fa,$a,Db,gc,Eb){this.vo=
null;this.dVb=this.XBe=!1;this.$9a=this.AKg=this.q9a=null;this.Nch=!1;this.sY=(kb,bb)=>{kb=bb.node;bb.property===pa.a.mo&&this.JUc(kb)&&this.oFb(kb,3)};this.amb=(kb,bb)=>{kb=bb.node;this.JUc(kb)&&this.oFb(kb,2)};this.Tha=(kb,bb)=>{kb=bb.node;bb=bb.rCf;!this.WA.IAl&&bb||!this.JUc(kb)||this.oFb(kb,1)};this.processDirtyNodes=()=>{const kb=this.he.Zf("UserAction","ProcessDirtyNodesInFindResultsTime");this.vo=null;const bb=this.Hc.Mc(3);bb.Cb(this.ap.Uc);0<this.addedNodes.count&&(this.dVb=!0,this.jOg(this.addedNodes,
this.WA.Jj));0<this.YIc.count&&this.jOg(this.YIc,this.WA.Jj);if(0<this.reb.count){const Gb=!this.Efk(this.reb,this.WA,this.ap,this.Dfk);this.dVb=this.dVb||Gb}bb.dispose();this.WA.Jj.aqb();this.pob(this.dVb);this.dgj();kb.stop()};this.M9n=()=>{this.JDd();if(0<this.reb.count||0<this.addedNodes.count||0<this.YIc.count)this.vo=new e.a(2,1,500,this.processDirtyNodes,53),this.Hb.Vb(this.vo)};this.WA=eb;this.MV=ib;this.ap=lb;this.Hb=Ya;this.Hc=Fa;this.jOg=$a;this.Efk=Db;this.Dfk=gc;this.he=Eb;this.reset();
this.dgj=this.M9n;this.ap.yce(this.sY,this.Tha,this.amb)}get reb(){return this.q9a}get addedNodes(){return this.AKg}get YIc(){return this.$9a}get pdj(){return this.Nch}get com(){return 0<this.reb.count||0<this.YIc.count}start(){this.XBe=!0;this.pob(!1)}stop(){this.reset()}reset(){this.XBe=!1;this.pob(!1);this.q9a=new ea.a;this.AKg=new ea.a;this.$9a=new ea.a;this.JDd()}JUc(eb){return!!eb.Kc&&!!this.ap.uj&&eb.Kc.id.equals(this.ap.uj.id)}oFb(eb,ib){if(this.XBe&&Object(n.a)(73,eb)&&!this.WA.NMb.t4c)if(this.WA.Jj.r7a||
this.WA.Jj.ykb.length){switch(ib){case 1:this.reb.nb(eb.id)||this.addedNodes.Z(eb.id,eb);break;case 2:this.reb.nb(eb.id)&&this.reb.remove(eb.id);this.addedNodes.nb(eb.id)?this.addedNodes.remove(eb.id):this.YIc.Z(eb.id,eb);break;case 3:this.reb.Z(eb.id,eb)}this.dgj()}else 2!==ib&&this.pob(this.dVb=!0)}JDd(){this.vo&&(this.Hb.Ve(this.vo),this.vo=null)}pob(eb){this.pdj!==eb&&(this.Nch=eb,this.MV.pob(eb));eb||(this.dVb=!1)}static YE(eb,ib){return new ja(eb,ib,aa.FindManagerHelper.instance,na.a.instance,
new w.a,ja.KWk,ja.mWn,ja.lWn,I.App.ya.Fq)}static createInstance(eb,ib){return ja._instance||(ja._instance=ja.YE(eb,ib))}static mWn(eb,ib,lb,Ya){let Fa=!1;const $a=ja.vii(eb,ja.h$m);for(let Db=0;Db<$a.length;++Db){const gc=!Ya($a[Db],ib,lb);Fa=Fa||gc;eb.remove($a[Db].id)}return!Fa}static lWn(eb,ib,lb){const Ya=ib.Jj;eb.rfa();const Fa=eb.id,$a=Ya.l8b(Fa);if($a)ib=lb.E1a(eb.Bva(),ib.OLc),lb=lb.X3d(Fa,ib,null,$a.type,$a.mXd),eb.Nia(ib),Ya.vde(Fa,lb);else return!1;return!0}static KWk(eb,ib){const lb=ja.vii(eb,
ja.g$m);for(let Ya=0;Ya<lb.length;++Ya){const Fa=lb[Ya],$a=Fa.id;Fa.rfa();ib.W3c($a);eb.remove($a)}}static vii(eb,ib){const lb=[];let Ya=ib;eb.forEach((Fa,$a)=>{lb.push($a);--Ya;return Ya?!0:!1});return lb}}ja.h$m=5;ja.g$m=15;ja._instance=null;Object(E.a)(ja,"FindResultAppEventCoordinator",null,[1372]);class ma{constructor(eb,ib){this.ayb=this.SRb=0;this.Hqc=this.jBc=this.Gja=null;this.VZb=0;this.Dub=null;this.MV=eb;this.mka=ib;this.LXa=new ea.a;this.Twb=new ea.a;this.lbb=new ea.a;this.h$a=new ea.a;
this.KXa=new ea.a(0);this.Mzc=new ea.a;for(eb=0;eb<ib.length;++eb)this.KXa.Z(ib[eb],0);this.ykb=[]}get EE(){return this.Gja}set EE(eb){this.Gja=eb;eb=Array(1);eb[0]=this.Gja;this.MV.uOa(3,eb)}get P9(){return this.jBc}set P9(eb){this.jBc=eb}get v3(){return this.Hqc}set v3(eb){this.Hqc=eb}get WDa(){let eb=null;for(const ib of this.mka)if(eb=this.LXa.J(ib))break;return eb}get $Xe(){return this.SRb}ohe(eb){eb!==this.SRb&&(this.SRb=eb)}get lja(){return this.ayb}ajc(eb){eb!==this.ayb&&(this.ayb=eb,this.MV&&
!this.ayb&&(this.MV.Ffe(0),this.MV.jhe(0)))}get r7a(){return this.VZb}get jcc(){return this.Dub}hYe(eb,ib){if(eb&&!(0>=eb.length)){var lb=eb[0].type,Ya=ib,Fa=Ya?Ya.next:this.LXa.J(lb);Ya||this.LXa.Z(lb,eb[0]);for(const $a of eb){const Db=$a;this.Mzc.Z(Db.id,Db);Ya&&(Ya.next=Db);Db.previous=Ya;Ya=Db}Ya&&(Ya.next=Fa);Fa&&(Fa.previous=Ya);ib&&eb[0].nodeId.equals(ib.nodeId)||this.lbb.Z(eb[0].nodeId,eb[0]);!Fa&&Ya&&this.Twb.Z(Ya.type,Ya);this.jcc===ib&&(this.Dub=Ya);this.KXa.Z(lb,this.KXa.J(lb)+eb.length);
this.ajc(this.lja+eb.length);this.VZb=this.r7a+eb.length;this.MV&&this.MV.uOa(0,eb)}}pzd(eb){!eb||0>=eb.length||this.hYe(eb,this.Twb.J(eb[0].type))}Pmh(eb){!eb||0>=eb.length||(this.jcc&&this.jcc.type!==eb[0].type&&(this.Dub=null),this.hYe(eb,this.jcc))}W3c(eb){const ib=this.l8b(eb);if(ib){eb=ib;for(var lb=0;eb;){++lb;if(!eb.next||!eb.nodeId.equals(eb.next.nodeId))break;eb=eb.next}this.o$i(ib,eb)}else l.ULS.sendTraceTag(4069027,313,15,"RemoveResultsForNode called for node not in cache: {0}",eb.toString())}o$i(eb,
ib){let lb=0,Ya=0;const Fa=[];let $a=eb;for(;$a!==ib.next;){const Db=this.iAi($a);this.lbb.J($a.nodeId).id===$a.id&&($a.next&&$a.next.nodeId.equals($a.nodeId)?(this.lbb.Z($a.nodeId,$a.next),Db&&this.h$a.Z($a.nodeId,$a.next)):(this.lbb.remove($a.nodeId),Db&&this.h$a.remove($a.nodeId)));this.jcc&&this.jcc.id===$a.id&&(this.Dub=eb.previous);this.P9&&this.P9.id===$a.id&&(this.P9=this.Wrf($a,eb));this.v3&&this.v3.id===$a.id&&(this.v3=this.Wrf($a,eb));this.EE&&this.EE.id===$a.id&&(this.EE=this.Wrf($a,eb));
this.Mzc.remove($a.id);Fa.push($a);$a=$a.next;Db?++Ya:++lb}eb.previous?eb.previous.next=ib.next:ib.next?this.LXa.Z(ib.type,ib.next):this.LXa.remove(ib.type);ib.next?ib.next.previous=eb.previous:eb.previous?this.Twb.Z(eb.type,eb.previous):this.Twb.remove(eb.type);ib.next=null;eb.previous=null;this.KXa.Z(eb.type,this.KXa.J(eb.type)-lb);this.ajc(this.lja-lb);this.VZb=this.r7a-(lb+Ya);this.MV&&this.MV.uOa(1,Fa)}vde(eb,ib){const lb=this.l8b(eb);if(lb){const Ya=[],Fa=[],$a=[];let Db=lb,gc,Eb=0;do Eb<ib.length?
(Db.g6k(ib[Eb]),Ya.push(Db)):(Fa.push(Db),this.P9&&this.P9.id===Db.id&&0<Ya.length&&(this.P9=Ya[Ya.length-1])),++Eb,gc=Db,Db=Db.next;while(Db&&gc.nodeId.equals(Db.nodeId));for(;Eb<ib.length;++Eb)$a.push(ib[Eb]);0<Fa.length&&this.o$i(Fa[0],Fa[Fa.length-1]);0<$a.length&&this.hYe($a,0<Ya.length?Ya[Ya.length-1]:lb);ib=Ya.length;if(0<ib){if(this.h$a.nb(eb)){this.h$a.remove(eb);this.ajc(this.lja+ib);let kb,bb;(kb=this.KXa).Z(bb=Ya[0].type,kb.J(bb)+ib)}this.MV&&this.MV.uOa(4,Ya)}}else l.ULS.sendTraceTag(4069056,
313,15,"ReplaceResultsForNode: NodeId not found in cache nodeId={0}",eb.toString())}WDh(){this.lbb=new ea.a;this.h$a=new ea.a;this.LXa=new ea.a;this.Twb=new ea.a;this.Mzc=new ea.a;for(let eb=0;eb<this.mka.length;++eb)this.KXa.Z(this.mka[eb],0);this.EE=null;this.ohe(0);this.v3=this.P9=this.Dub=null;this.ajc(0);this.VZb=0;this.MV&&this.MV.uOa(2,null)}DLi(){this.h$a=new ea.a;this.lbb.forEach((eb,ib)=>{this.h$a.Z(eb,ib);return!0});for(let eb=0;eb<this.mka.length;++eb)this.KXa.Z(this.mka[eb],0);this.EE=
null;this.ohe(0);this.Dub=null;this.ajc(0);this.MV&&this.MV.uOa(2,null)}l8b(eb){return this.lbb.nb(eb)?this.lbb.J(eb):null}Yj(eb){let ib=null;this.Mzc.nb(eb)&&(ib=this.Mzc.J(eb));return ib}u8h(eb){return this.LXa.nb(eb)?this.LXa.J(eb):null}i_l(eb){return this.Twb.nb(eb)?this.Twb.J(eb):null}aqb(){var eb=0;if(this.EE){eb=0;const Ya=this.EE.type;var ib=this.LXa.J(Ya);if(ib){for(var lb=1;ib&&this.EE.id!==ib.id;)this.iAi(ib)||++lb,ib=ib.next;ib&&(eb=lb)}if(ib){ib=0;for(lb=0;lb<this.mka.length&&this.mka[lb]!==
Ya;++lb)ib+=this.KXa.J(this.mka[lb]);eb=ib+eb}else l.ULS.sendTraceTag(4069057,313,10,"UpdateActiveIndexFromActiveResult, active result not found in cache, setting it to null"),this.EE=null,eb=0}this.ohe(eb);this.MV&&(this.MV.Ffe(this.$Xe),this.MV.jhe(this.lja))}i1a(eb){return this.DQd(eb,!1)}sRd(eb){return this.DQd(eb,!0)}DQd(eb,ib){let lb=ib?eb.previous:eb.next,Ya=eb.type;for(;!lb&&(Ya=this.U2l(Ya,ib),lb=ib?this.i_l(Ya):this.u8h(Ya),Ya!==eb.type););return lb||eb}p7b(eb){return this.r5h(eb,!1)}W$h(eb){return this.r5h(eb,
!0)}r5h(eb,ib){let lb=this.DQd(eb,ib);for(;lb.nodeId.equals(eb.nodeId)&&lb.id!==eb.id;)lb=this.DQd(lb,ib);return lb}U2l(eb,ib){let lb=0;for(let Ya=0;Ya<this.mka.length;++Ya)if(eb===this.mka[Ya]){lb=Ya;break}ib?(--lb,0>lb&&(lb=this.mka.length-1)):(++lb,lb===this.mka.length&&(lb=0));return this.mka[lb]}Gcj(){this.Dub=null}Wrf(eb,ib){eb=this.i1a(eb);eb.id===ib.id&&(eb=null);return eb}iAi(eb){return this.h$a.nb(eb.nodeId)}static createInstance(eb,ib,lb=!1){return lb?new ma(eb,ib):ma._instance||(ma._instance=
new ma(eb,ib))}}ma._instance=null;Object(E.a)(ma,"FindResultManager",null,[1343]);class Ia{constructor(eb,ib){this.Sim=lb=>{const Ya=this.ap.uj.Db(lb.nodeId);if(Ya){if(this.mC.EE){var Fa=this.ap.uj.Db(this.mC.EE.nodeId);(Fa=Object(y.a)(73,Fa))?Fa.yDh():l.ULS.sendTraceTag(4069060,313,15,"{0}",{["GoToResultInternal"]:"ActiveHitNodeNotFound",["NodeId"]:this.mC.EE.nodeId})}Ya.TLf(lb.vPa,lb.type)?(this.mC.EE=lb,l.ULS.sendTraceTag(4065305,313,50,"{0}",{["GoToResultInternal"]:"Success",["ResultId"]:lb.id})):
c(1930).FindManager.instance.qmi()?l.ULS.sendTraceTag(4575581,313,15,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:Ya.id,["HitIndexInNode"]:lb.vPa,["ResultId"]:lb.id}):l.ULS.sendTraceTag(4069061,313,10,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:Ya.id,["HitIndexInNode"]:lb.vPa,["ResultId"]:lb.id});this.mC.aqb()}else l.ULS.sendTraceTag(4069059,313,10,"{0}",{["GoToResultInternal"]:"Invalid findResult.NodeId",["NodeId"]:lb.nodeId})};this.mC=eb;this.ap=ib;this.Hvf=this.Sim}Qji(){const eb=
this.mC.EE?this.mC.i1a(this.mC.EE):this.mC.WDa;this.Hvf(eb)}Rim(){const eb=this.mC.EE?this.mC.sRd(this.mC.EE):this.mC.WDa;this.Hvf(eb)}Tji(eb){const ib=this.mC.Yj(eb);ib?this.Hvf(ib):l.ULS.sendTraceTag(4069058,313,10,"{0}",{["GoToResult"]:"Invalid FindResult",["ResultId"]:eb})}static YE(eb){return new Ia(eb,aa.FindManagerHelper.instance)}static createInstance(eb){return Ia._instance||(Ia._instance=Ia.YE(eb))}}Ia._instance=null;Object(E.a)(Ia,"FindResultNavigator",null,[1342]);var Ja=c(19),Ka=c(1204);
K=c(146);class Ma{static Hmb(eb){const ib=[];var lb=RegExp('"[^"\\r\\n]*"',"ig"),Ya=eb.match(lb);let Fa;if(Ya&&0<Ya.length)for(Fa=0;Fa<Ya.length;Fa++){var $a=Ya[Fa].split('"').join("");$a=$a.trim();$a=$a.split(Ma.I8c).join(" ");if(""!==$a){ib.push($a);var Db=$a.split(Ma.punctuation).join(" ");Db=Db.trim();Db=Db.split(Ma.I8c).join(" ");""!==Db&&Db!==$a&&ib.push(Db)}}eb=eb.split(lb).join(" ");lb=Ka.a.instance.SMl(eb);if(!lb.length)return ib.sort(Ma.Xsj),ib;Ya=lb[0];for(Fa=1;Fa<lb.length;Fa++)if(Db=
lb[Fa],2!==Ya.xL||2!==Db.xL)$a=eb.substring(Ya.cp,Db.cp),$a=$a.trim(),Ma.XCi($a,Ya)&&ib.push($a),Ya=Db;$a=eb.substring(Ya.cp,eb.length);$a=$a.trim();Ma.XCi($a,Ya)&&ib.push($a);ib.sort(Ma.Xsj);return ib}static XCi(eb,ib){return""!==eb&&'"'!==eb&&1!==ib.xL}static K1n(eb){for(let ib=0;ib<eb.length;ib++)eb[ib]=eb[ib].split(Ma.I8c).join("\\s+");return eb}static Xsj(eb,ib){return eb.length>ib.length?-1:eb.length===ib.length?0:1}}Ma.punctuation=RegExp("[\\[\\]\\\\\\^\\$\\.\\|\\+\\(\\)\\?\\*\\-_=,;:%!'<>/@#&{}]");
Ma.I8c=RegExp("\\s+");Ma.ZRn=[new K.a(RegExp("\\[","g"),"\\["),new K.a(RegExp("\\]","g"),"\\]"),new K.a(RegExp("\\\\","g"),"\\\\"),new K.a(RegExp("\\^","g"),"\\^"),new K.a(RegExp("\\$","g"),"\\$"),new K.a(RegExp("\\.","g"),"\\."),new K.a(RegExp("\\|","g"),"\\|"),new K.a(RegExp("\\+","g"),"\\+"),new K.a(RegExp("\\(","g"),"\\("),new K.a(RegExp("\\)","g"),"\\)"),new K.a(RegExp("\\?","g"),"\\?"),new K.a(RegExp("\\*","g"),"\\*")];Object(E.a)(Ma,"SearchAndFindUtils",null,[]);class sa{Yfc(eb){return Ja.a.$fa(eb,
Ma.ZRn)}Hmb(eb){eb=Ma.Hmb(eb);return eb=Ma.K1n(eb)}S1i(){return null}O_d(){return!1}static get instance(){return null!=sa.QBg?sa.QBg:sa.QBg=new sa}}Object(E.a)(sa,"QueryProcessor",null,[945]);var xa=c(719),ia=c(22),ha=c(12),ua=c(28),ya=c(642),ra=c(755),La=c(202),oa=c(234);class Ca{constructor(){this.u4c=this.transaction=null;this.iIa=this.y6f=0;this.v6f=this.ofb=null}}Object(E.a)(Ca,"ReplaceAllContext",null,[]);class Aa{constructor(eb,ib,lb,Ya,Fa,$a,Db,gc,Eb,kb,bb){this.Hmn=(Gb,Sa,Pa,Ab,nb)=>{let Rb=
null;if(Gb>Sa)for(Rb=Pa;0<Sa&&Rb.nodeId.equals(nb.id);)Rb=this.mC.i1a(Rb),--Sa;else 0<Gb?Rb=this.mC.p7b(Pa):Ab.nodeId!==nb.id&&(Rb=Ab);return Rb};this.ODh=()=>{const Gb=this.mC.ykb;if(Gb&&0<Gb.length){const Sa=this.Hc.Mc(3);Sa.Cb(this.ap.uj.Db(Gb[0]));for(let Pa=0;Pa<Gb.length;++Pa){const Ab=this.ap.uj.Db(Gb[Pa]);Ab?Ab.rfa(!1,!0):l.ULS.sendTraceTag(4069064,313,10,"Last replaced node not found in object Space, NodeId: {0}",Gb[Pa])}Sa.dispose();Array.clear(this.mC.ykb)}};this.usn=(Gb,Sa)=>{this.Dzc=
!0;this.R9i();const Pa=new Ca;Pa.u4c=Gb?Gb:"";Pa.v6f=Sa;Pa.iIa=this.mC.lja;Gb=this.Hc.Mc(15);Gb.Cb(this.ap.Uc);Pa.transaction=Gb;this.uwl(Pa,Gb)};this.$ln=(Gb,Sa)=>{Gb=new xa.a(null,this.bHn,Gb);const Pa=this.ap.Uc;Pa&&Pa.FH().jF.p7(9);Gb.Al("ReplaceAll");Sa.tHa(Gb);Gb.run()};this.iqn=(Gb,Sa)=>{Gb=this.he.Zf("UserAction","OnProcessReplaceAll");if(this.iPm(Sa))return this.C1k(Sa),!1;let Pa=Sa.ofb;Pa||(Pa=this.mC.WDa);Sa.ofb=this.mC.p7b(Pa);const Ab=this.ap.uj.Db(Pa.nodeId);if(!Ab)return l.ULS.sendTraceTag(4065307,
313,10,"ReplaceAll: Node for result with id: {0} and nodeId: {1}, Not Found!",Pa.id,Pa.nodeId),!0;const nb=Ab.rna();if(nb&&nb.length)if(this.ITk(Ab,nb[0].begin,nb[0].end))l.ULS.sendTraceTag(5007254,313,50,"ReplaceAll: Skipping node: {0} as Paragraph is locked",Ab.id);else{let Rb=0;for(let Mb=0;Mb<nb.length;++Mb){Sa.y6f+=1;const oc=this.replaceText(this.WA.$jf,Ab,Sa.u4c,ua.a.createTextRange(Ab,nb[Mb].begin+Rb,nb[Mb].end+Rb));Rb+=Sa.u4c.length-(nb[Mb].end-nb[Mb].begin)+oc;Ab.nbg(0,Sa.u4c.length)}0<
Sa.u4c.length&&this.mC.ykb.push(Pa.nodeId)}else l.ULS.sendTraceTag(4065308,313,15,"ReplaceAll: No hits found for result with id: {0} and nodeId: {1}!",Pa.id,Pa.nodeId);Gb.stop();return!0};this.Dkn=Gb=>{Gb.transaction.dispose();this.Dzc=!1;this.WA.yZa(!1);Gb.v6f&&Gb.v6f(Gb.y6f,Gb.iIa)};this.Vqn=(Gb,Sa,Pa,Ab)=>{!Gb.matchCase&&0<Pa.length&&(Gb=Sa.Bva().substr(Ab.cpBegin,Ab.cpEnd-Ab.cpBegin),Pa=this.sSk(Pa,Gb));return this.Ezc(Ab,Pa,!0,!1)};this.WA=eb;this.mC=ib;this.ap=lb;this.Hc=Ya;this.mIe=Fa;this.f7j=
Db;this.iKg=gc;this.Ezc=Eb;this.n9j=kb;this.he=bb;this.Dzc=!1;this.kAo=this.usn;this.bHn=this.iqn;this.C1k=this.Dkn;this.uwl=this.$ln;this.R9i=this.ODh;this.replaceText=this.Vqn;this.sSk=Aa.Njn;this.a3l=this.Hmn}get P0(){return this.mIe.value}get t4c(){return this.Dzc}replace(eb){var ib=!1;if(this.t4c)return l.ULS.sendTraceTag(4069062,313,15,"Replace: Cancelled as replace is already in progress"),ib;if(this.P0.Xel){var lb=this.P0.E3;const $a=lb.node;lb.contextId===ha.a.paragraph&&(lb=ua.a.createTextRange($a,
0,X.ParagraphReader.textLength($a)));var Ya=Object(y.a)(73,$a);if(Ya){var Fa=new ra.a(lb.cpBegin,lb.cpEnd);Fa=Ya.c$h(Fa);if(Fa!==ya.a.invalid&&0<=Fa){if(this.bCh(lb))return l.ULS.sendTraceTag(5007250,313,50,"Replace: Cancelled as Paragraph is locked"),ib;this.Dzc=!0;ib=this.Hc.Mc(15);ib.Cb($a);this.replaceText(this.WA.$jf,Ya,eb,lb);ib.dispose();this.R9i();Ya.nbg(Fa,eb.length);0<eb.length&&this.mC.ykb.push($a.id);eb=this.mC.l8b($a.id);lb=this.mC.i1a(eb);Ya=Ya.rna();Ya=this.ap.X3d($a.id,Ya,null,eb.type,
eb.mXd);this.mC.vde($a.id,Ya);(lb=this.a3l(Ya.length,Fa,eb,lb,$a))?this.WA.a5c.Tji(lb.id):this.mC.aqb();ib=!0;this.Dzc=!1}else l.ULS.sendTraceTag(5007251,313,50,"Replace: Cancelled as current selection not on a find hit.")}else l.ULS.sendTraceTag(4069063,313,15,"Replace: Failed as No node found corresponding to current selection")}else l.ULS.sendTraceTag(5007252,313,50,"Replace: Cancelled as current selection does not contain single context");ib?(l.ULS.sendTraceTag(4065306,313,50,"ReplaceManager Replace Success"),
this.WA.w6f=!0):(l.ULS.sendTraceTag(5007253,313,50,"ReplaceManager Replace Not Successful"),this.WA.a5c.Qji());return ib}replaceAll(eb,ib){this.t4c?l.ULS.sendTraceTag(4069065,313,15,"ReplaceAll: Called when Replace is already in Progress"):this.mC.lja?this.kAo(eb,ib):l.ULS.sendTraceTag(4069066,313,15,"ReplaceAll: Called when total results is 0")}bCh(eb){const ib=this.f7j(eb);!ib&&this.iKg.value&&this.n9j.value&&this.iKg.value(eb.node);return ib}ITk(eb,ib,lb){return this.bCh(ua.a.createTextRange(eb,
ib,lb))}iPm(eb){return eb.ofb===this.mC.WDa}static get characterPropertiesEditor(){return null!=Aa.pwg?Aa.pwg:Aa.pwg=ia.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static YE(eb,ib){const lb=new v.a(()=>I.App.rd&&I.App.rd.kq?Object(z.a)(I.App.rd.kq,I.App.rd.kq.rH,"acquireAndApplyLock"):null);return new Aa(eb,ib,aa.FindManagerHelper.instance,new w.a,new v.a(()=>La.a.instance),new v.a(()=>W.a.instance),Object(z.a)(oa.a.instance,oa.a.instance.oGm,"isContextSetInLockedRange"),lb,Object(z.a)(Aa.characterPropertiesEditor,
Aa.characterPropertiesEditor.replaceTextRange,"replaceTextRange"),new v.a(()=>I.App.rd.Yo),I.App.ya.Fq)}static createInstance(eb,ib){return Aa._instance||(Aa._instance=Aa.YE(eb,ib))}static Njn(eb,ib){const lb=Ja.a.Tg(ib);!Ja.a.localeCompare(Ja.a.QA(ib),ib)&&Ja.a.localeCompare(lb,ib)?eb=Ja.a.QA(eb):Ja.a.Hbc(ib.charAt(0))&&!Ja.a.mEf(ib.charAt(0))&&(ib=Ja.a.QA(eb.substr(0,1)),eb=1===eb.length?ib:ib+eb.substr(1,eb.length-1));return eb}}Aa._instance=null;Object(E.a)(Aa,"ReplaceManager",null,[1284]);c.d(M,
"FindManager",function(){return db});class db extends V.a{constructor(eb,ib,lb,Ya,Fa,$a,Db,gc,Eb,kb,bb,Gb,Sa,Pa,Ab,nb=!1){super(eb,ib,lb,Fa,$a,Sa,Pa,bb,Gb);this.lka=this.jAc=null;this.Rxd=!1;this.QBa=this.W9a=this.Nab=null;this.rsc=0;this.pvd=Ya;this.Oub=Db;this.Wc=gc;this.Hc=Eb;this.CNe=kb;this.a2j=Ab;this.Zvc=[];this._state=2;this.rxb=!nb;this.dsb=new L;this.ap.jZe(this.dsb);this.mZb=new L;this.ap.jZe(this.mZb);this.ap.Uc&&(this.Nab=this.ap.uj);this.Bog=400;this.Umc=100}get mb(){return this.Oub.value}get $jf(){return this.jAc}get ZLd(){return this.a2j.value}yZa(eb=
!0){this.NMb&&this.NMb.t4c||(this.jeb(eb),this.G$a.reset(),this.DYa="",this.pvd&&this.ZLd.stop(),this.qXk(),this.imj(null))}qXk(){this.Z6&&(this.taskManager.Ve(this.Z6),this.Z6=null);this.lKa&&(this.taskManager.Ve(this.lKa),this.lKa=null)}jeb(eb=!0){!this.Nab&&0<this.Jj.r7a&&l.ULS.sendTraceTag(4235910,313,10,"{0}",{["CancelFind"]:"LastKnowSpaceNull"});if(0<this.Jj.r7a&&this.Nab){let lb=this.Jj.WDa;const Ya=lb.nodeId;if(this.Nab.Db(Ya)){const Fa=this.Hc.Mc(3);for(Fa.Cb(this.Nab.Db(Ya));lb;){const $a=
this.Nab.Db(lb.nodeId);var ib=Object(y.a)(73,$a);if(ib){if(this.rxb&&(ib.rfa(void 0,eb),X.ParagraphReader.Wb($a)&&(ib=this.ap.j8h($a))))for(const Db of ib)Db.rfa(void 0,eb);$a.Tk(16,!0)}lb=this.Jj.p7b(lb);if(!lb||lb.nodeId.equals(Ya))break}Fa.dispose()}else l.ULS.sendTraceTag(4235911,313,10,"ClearFindHits: Error - node not in last known space");this.Jj.WDh()}eb&&this.NMb&&this.NMb.ODh();this.Ncj();this.Zvc=[];this.GUb=this.jAc=null;this.FL=0;this.w6f=this.Rxd=!1}X4c(){const eb=this.cW;this.jeb();
eb&&""!==eb.text&&this.find(eb)}woj(){return""===this.DYa}qmi(){return this.pvd&&this.ZLd.com}hdj(){10>this.rsc?(this.rsc++,l.ULS.sendTraceTag(4069014,313,15,"{0}",{["ErrorRestartCount"]:this.rsc}),this.find(this.cW)):(l.ULS.sendTraceTag(4235912,313,10,"RestartFindAfterErrorCondition: max retries reached"),m.AFrameworkApplication.va.processAction(F.a.dAb,2),this.rsc=0)}m6i(){var eb=(new Date).getTime();let ib=!1;this.Jj.r7a||(ib=!0);let lb=0;if(!ib){this.Jj.P9||(this.Jj.P9=this.Jj.WDa);this.Jj.v3||
(this.Jj.v3=this.Jj.P9,this.Jj.EE=null);let Ya=null,Fa=!0;for(;!ib&&this.Jj.v3&&(new Date).getTime()-eb<V.a.tMi;){const $a=this.Jj.v3,Db=this.ap.uj.Db($a.nodeId);Db?(Fa&&(Ya=this.Hc.Mc(3),Ya.Cb(Db),Fa=!1),$a.mXd&&!this.W9a&&(this.W9a=Db),this.Jj.v3=this.Jj.p7b(this.Jj.v3),ib=!this.Jj.v3||this.Jj.v3.nodeId.equals(this.Jj.P9.nodeId),this.Zvf(Db,$a.type,this.rxb),++lb):this.Jj.W3c($a.nodeId)}Ya&&Ya.dispose()}this.Jj.aqb();ib&&(this.Jj.v3=null,this.Rxd?this._state=0:(this._state=2,this.yob(!0)));this.Z6=
new e.a(2,1,this.Umc,Object(z.a)(this,this.findInternal,"findInternal"),52);this.taskManager.Vb(this.Z6);eb=(new Date).getTime()-eb;l.ULS.sendTraceTag(4065247,313,50,"{0}",{["RecheckTime"]:eb,["Count"]:lb,["Total"]:this.Jj.lja,["TotalWithDirty"]:this.Jj.r7a})}cEn(){this.jeb();this.FL=0;if(this.ap.$Bf&&this.rxb){var eb=this.mb;if(eb){var ib=eb.hb.kb;if(ib){var lb=I.App.ya.gb.wc;(lb=lb?lb.Ls:null)&&lb.c7a();ib=U.SelectionEditor.Cj(ib,!1,!1);eb.setSelection(ib);lb&&lb.ZYa()}}}eb=this.Pkl();this.lka=
this.S1j.h8h(eb)}jmj(){this.imj(this.lka[this.FL].bja)}imj(eb){this.nlo(eb);this.Cjj(eb)}Ncj(){this.W9a=null;this.zVb=!1}Trf(eb){const ib=this.Wc.xk();ib.set(eb);if(!ib.zb(7))return ib.reset(),null;if(this.ap.E4d(ib,7,0))return eb=ib.currentNode,ib.reset(),eb;l.ULS.sendTraceTag(4235914,313,10,"GetNextFindableNode: No findable nodes");ib.reset();return null}Pkl(){if(this.ap.$Bf){var eb=this.mb;if((eb=eb?eb.hb.kb:null)&&this.rxb)return eb.Qc.al?(eb=eb.Qc,U.SelectionEditor.hv(eb)?(eb=eb.node,Object(n.a)(73,
eb)?eb:this.Trf(eb)):Object(n.a)(73,eb.node)?eb.node:this.Trf(eb.node)):this.Trf(this.ap.Uc);eb=this.Wc.xk();eb.set(this.ap.Uc);if(this.ap.Jkg(eb,8,1)){l.ULS.sendTraceTag(4069018,313,50,"No Selection: No selection, choosing title or first findable");const ib=eb.currentNode;eb.reset();return ib}l.ULS.sendTraceTag(4235915,313,10,"TryMoveToPageLeadingContent failed")}l.ULS.sendTraceTag(4235916,313,10,"Error: ContentView isn't PageView");return null}Wtf(){const eb=this.Wc.xk();eb.set(this.mZb);if(1===
eb.xq())return eb.Qd(),eb.currentNode;l.ULS.sendTraceTag(4069019,313,15,"Something went wrong in GetStartingNode...");return null}nlo(eb){const ib=this.Hc.Mc(3);ib.Cb(this.mZb);const lb=this.Wc.xk();lb.set(this.mZb);lb.rA()&&(lb.Qd(),lb.wg());eb&&(lb.Hf(eb,81),eb=this.lka[this.FL],this.mZb.v8f=eb.rootNode.type,this.mZb.bkf=eb.g6b);ib.dispose()}xRl(){if(this.dsb){var eb=this.Wc.xk();eb.set(this.dsb);if(eb.xq())return eb.Qd(),eb.currentNode;eb=this.CNe(this.ap.Uc);eb.moveNext();if(eb.currentNode)return eb.currentNode}l.ULS.sendTraceTag(4069020,
313,15,"Something went wrong in GetCurrentNode...");return null}Cjj(eb){const ib=this.Hc.Mc(3);ib.Cb(this.dsb);const lb=this.Wc.xk();lb.set(this.dsb);lb.rA()&&(lb.Qd(),lb.wg());eb&&(lb.Hf(eb,81),eb=this.lka[this.FL],this.dsb.v8f=eb.rootNode.type,this.dsb.bkf=eb.g6b);ib.dispose()}XSd(){let eb=this.Jj.EE||this.Jj.WDa;if(eb){for(var ib=!1,lb=!0;eb;){var Ya=this.ap.uj.Db(eb.nodeId);if(Ya=Object(y.a)(73,Ya))if(ib=Ya.ULf(eb.type)){lb&&(eb=this.Jj.i1a(eb));break}else eb=this.Jj.i1a(eb);else if(lb=eb,eb=
this.Jj.p7b(eb),this.Jj.W3c(lb.nodeId),!eb||lb.nodeId.equals(eb.nodeId))break;lb=!1}ib?(this.Jj.EE=eb,this.Jj.aqb(),l.ULS.sendTraceTag(4065248,313,50,"FindManager GoToNextHit Success")):l.ULS.sendTraceTag(4069022,313,15,"Failed to go to Next Hit")}}YSd(){let eb=this.Jj.EE||this.Jj.WDa;if(eb){for(var ib=!1,lb=!0;eb;){var Ya=this.ap.uj.Db(eb.nodeId);if(Ya=Object(y.a)(73,Ya))if(ib=Ya.wLi(eb.type)){lb&&(eb=this.Jj.sRd(eb));break}else eb=this.Jj.sRd(eb);else if(lb=eb,eb=this.Jj.W$h(eb),this.Jj.W3c(lb.nodeId),
!eb||lb.nodeId.equals(eb.nodeId))break;lb=!1}ib?(this.Jj.EE=eb,l.ULS.sendTraceTag(4065249,313,50,"FindManager GoToPreviousHit Success")):l.ULS.sendTraceTag(4069024,313,15,"Failed to go to Previous Hit");this.Jj.aqb()}}SRk(){return 2===this._state&&(this.w6f||this.pvd&&this.ZLd.pdj)}ESf(){this.ap.soa?(this.DYa=this.xea.Yfc(this.cW.text),this.Nab=this.ap.uj,this.Ncj()):this.hdj()}Mtj(){this.pvd&&this.ZLd.start()}G5e(){if(!this.ap.soa||this.Nab!==this.ap.uj)return this.jeb(),this.hdj(),!0;this.rsc=0;
return!1}z7f(){const eb=this.xea.Hmb(this.DYa),ib=this.SRk();let lb=!1;if(ib||this.ap.Nzi(this.jAc,this.Zvc,this.cW,eb)){lb=!0;this.yob(!1);this.G$a.update();this.G$a.ekf();!ib&&this.ap.Yzi(this.jAc,this.Zvc,this.cW,eb)?(this.Jj.DLi(),this.Jj.v3=null,this._state=1):(this.cEn(),this.jmj(),this._state=0,this.Rxd=!0);this.jAc=this.cW;this.Zvc=eb;try{this.GUb=this.HUb.LEb(this.Zvc.join("|"),this.cW)}catch(Ya){return l.ULS.sendTraceTag(0,313,10,"FindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",
this.cW.matchCase,this.cW.matchWholeWord),this.GUb=null,this._state=2,this.yob(!0),!0}this.Z6=new e.a(2,1,this.Umc,Object(z.a)(this,this.findInternal,"findInternal"),52);this.taskManager.Vb(this.Z6)}return lb}gSi(){if(!this.W9a){const eb=this.Wc.xk();eb.set(1===this.lka[this.FL].g6b?this.ap.Uc:this.lka[this.FL].rootNode);this.ap.Jkg(eb,this.lka[this.FL].rootNode.type,this.lka[this.FL].g6b)?(this.W9a=eb.currentNode,eb.reset()):(l.ULS.sendTraceTag(17306254,313,10,"TryToMoveToPageLeadingParagraph failed."),
eb.reset(),this.Z6=new e.a(2,1,this.Umc,Object(z.a)(this,this.findInternal,"findInternal"),52),this.taskManager.Vb(this.Z6))}}oSf(){this.Jj.aqb();this.Cjj(this.QBa.currentNode);this.QBa.currentNode===this.Wtf()&&(this.FL++,this.FL===this.lka.length?(this.FL=0,this._state=2,this.Rxd=!1,this.yob(!0)):this.jmj());this.QBa=null}mgi(){return this.Wtf()}O1i(){const eb=this.xRl();this.QBa=this.Wc.xk();this.QBa.set(eb);this.QBa.m1(this.lka[this.FL].rootNode)}Lmj(){const eb=this.Hc.Mc(3);eb.Cb(this.QBa.currentNode);
return eb}vWf(){this.Zvf(this.QBa.currentNode,this.lka[this.FL].g6b,this.rxb);this.ap.E4d(this.QBa,this.lka[this.FL].rootNode.type,this.lka[this.FL].g6b)}N8e(eb){return!!this.QBa.currentNode&&!this.QBa.currentNode.id.equals(eb.id)}rCh(eb){!this.zVb&&this.W9a&&eb.id===this.W9a.id&&this.Wtf().id!==this.W9a.id&&0<this.Jj.r7a&&(this.zVb=!0,this.Jj.Gcj())}kzd(eb,ib,lb,Ya){const Fa=this.Jj.l8b(eb);Fa?this.Jj.vde(eb,ib):this.zVb?this.Jj.Pmh(ib):this.Jj.pzd(ib);this.rxb&&!this.Jj.EE&&0<ib.length&&lb.ULf(Ya)&&
(this.Jj.EE=Fa?Fa:ib[0],this.Jj.P9||(this.Jj.P9=this.Jj.EE))}Nia(eb,ib){eb.Nia(ib)}rfa(eb){this.rxb&&eb.rfa()}eMf(eb){eb.Tk(16,!0)}static YE(eb,ib,lb,Ya,Fa=!1){ib||(ib=sa.instance);lb||(lb=da.instance);const $a=ma.createInstance(eb,lb.Tgg,Fa),Db=new v.a(()=>Aa.createInstance(db.instance,db.instance.Jj)),gc=new v.a(()=>Ia.createInstance(db.instance.Jj)),Eb=new v.a(()=>ja.createInstance(db.instance,eb));return new db(eb,ib,lb,Ya,aa.FindManagerHelper.instance,new v.a(()=>m.AFrameworkApplication.nc),
new v.a(()=>W.a.instance),new A.a,new w.a,G.a.createInstance,a.a.instance,$a,Db,gc,Eb,Fa)}static get instance(){return db._instance}static createInstance(eb,ib=null,lb=null,Ya=!1,Fa=!1){return Fa?db.YE(eb,ib,lb,Ya,!0):db.instance||(db._instance=db.YE(eb,ib,lb,Ya))}}db._instance=null;Object(E.a)(db,"FindManager",V.a,[])},1932:function(E,M,c){E=c(0);var m=c(22),e=c(2),a=c(238),l=c(44),y=c(6),z=c(15),n=c(42),v=c(7),A=c(73),w=c(110),G=c(74),F=c(86),I=c(206),K=c(12),J=c(5),N=c(588),R=c(101),O=c(815),L=
c(1027),U=c(36),W=c(218),X=c(204),V=c(81);class Z{constructor(Eb){this.$oa=Eb}}Object(E.a)(Z,"ValidParentData",null,[]);var da=c(40),aa=c(334),ea=c(659),na=c(363),pa=c(658),ja=c(508);class ma{constructor(){this.s4b=0}}Object(E.a)(ma,"BelowOutlineElementData",null,[]);var Ia=c(630),Ja=c(857),Ka=c(532);class Ma extends Ia.a{constructor(Eb,kb,bb,Gb){super(4,Gb);this.r4b=Eb;this.Iyb=kb;this.IEc=bb}L8b(){var Eb=this.r4b;if(!Eb)return v.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),
null;const kb=[],bb=new Ja.a(this.r4b.id,this.r4b.Lc,this.Iyb?this.Iyb.id:null);""!==Eb.characterData&&Eb.characterData&&(Eb=new Ka.DeleteTextUpdateHint(this.r4b.id,0,Eb.characterData),kb.push(Eb));kb.push(bb);return kb}}Object(E.a)(Ma,"DeleteParagraphOperation",Ia.a,[]);var sa=c(938),xa=c(463);class ia extends Ia.a{constructor(Eb,kb,bb,Gb,Sa){super(3,Sa);this.cpa=Eb;this.rRa=kb;this.ten=bb;this.hxa=Gb}L8b(){const Eb=[];var kb=new sa.AddParagraphUpdateHint(this.hxa.id,this.hxa.Lc,this.cpa?this.cpa.id:
null);Eb.push(kb);""!==this.hxa.characterData&&this.hxa.characterData&&(kb=new xa.a(this.hxa.id,0,this.hxa.characterData),Eb.push(kb));return Eb}}Object(E.a)(ia,"InsertNewParagraphOperation",Ia.a,[]);var ha=c(937);class ua extends Ia.a{constructor(Eb,kb,bb,Gb){super(2,Gb);this.cpa=Eb;this.rRa=kb;this.V3d=bb}L8b(){const Eb=[],kb=new ha.MergeParagraphUpdateHint(this.cpa.id,this.cpa.Lc,this.cpa.characterData.length,this.rRa.id,this.rRa.Lc,this.V3d.id,this.V3d.Lc);Eb.push(kb);return Eb}}Object(E.a)(ua,
"MergeParagraphOperation",Ia.a,[]);var ya=c(856);class ra extends Ia.a{constructor(Eb,kb,bb,Gb,Sa){super(1,Sa);this.z4=Eb;this.otj=kb;this.Iyb=bb;this.IEc=Gb}L8b(){const Eb=[],kb=new ya.a(this.z4.id,this.z4.Lc,this.otj,this.Iyb.id,this.Iyb.Lc,this.IEc.id,this.IEc.Lc);Eb.push(kb);return Eb}}Object(E.a)(ra,"SplitParagraphOperation",Ia.a,[]);var La=c(373),oa=c(9),Ca=c(529),Aa=c(43),db=c(1089),eb=c(32),ib=c(124),lb=c(234),Ya=c(8),Fa=c(178),$a=c(13),Db=c(103);c.d(M,"a",function(){return gc});class gc{constructor(Eb,
kb,bb,Gb,Sa,Pa,Ab=null,nb=null,Rb=null,Mb=null,oc=null){this.Fxa=oc;this.lK=Eb;this.iK=kb;this.Gf=bb;this.p6=Ab;this.Qu=nb;this.Sy=Rb;this.Hp=Mb}Sok(Eb){var kb;(null===(kb=oa.App.rd)||void 0===kb?0:kb.Yo)&&oa.App.rd.kq.rH(Eb)}Bya(Eb,kb,bb,Gb=!1){U.OutlineElementNavigator.Ge(Eb);Ya.ParagraphReader.uh(Eb)?gc.paragraphEditor.fq.Bya(Eb,kb,bb):eb.TableReader.isTable(Eb)&&14===Eb.We&&(kb=(new na.a(1,bb)).Ft,bb=Object(A.a)(aa.TableNode,Eb.currentNode),this.tmj(bb,kb,Gb));U.OutlineElementNavigator.Vd(Eb)}tmj(Eb,
kb,bb=!1){Eb&&Object(w.a)(aa.TableNode,Eb)&&(bb?kb?(Eb.setValue(y.a.$d,kb),kb=eb.TableReader.Yg(Eb),gc.wk.$ag(Eb,kb)):Eb.removeProperty(y.a.$d):Eb.$d=kb)}get fq(){return L.a.BEb}get XG(){return this.Qu||(this.Qu=m.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}get sc(){return this.Sy||(this.Sy=m.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Ld(){return null!=this.YHg?this.YHg:this.YHg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=this.JHg?
this.JHg:this.JHg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Un(){return this.iK.value}get Gd(){return this.Gf.value}get iL(){return this.lK.value}get Vf(){return lb.a.instance}get AD(){return null!=this.Swg?this.Swg:this.Swg=m.a.instance.Na("Box4.IContentControlConverter")}gfb(){const Eb=O.a.instance.createInstance(393229);Eb.setValue(z.a.jL,W.a.first);Eb.setValue(z.a.ael,new Date);Eb.kmc();return Eb}Yal(){const Eb=new db.a;Eb.setValue(z.a.jL,W.a.first);return Eb}fgf(Eb,
kb,bb=!1){da.OutlineElementReader.FFf(Eb)?(Eb=da.OutlineElementReader.isRtl(Eb),bb?this.dOb(kb,Eb):this.cOb(kb,Eb)):this.dZn(kb)}Yic(Eb,kb){const bb=U.OutlineElementNavigator.Il(Eb);da.OutlineElementReader.$m(bb)!==kb&&(this.cOb(bb,kb),Eb.anchor.QX(4))}cOb(Eb,kb){const bb=new Aa.GraphTransaction(7);bb.Cb(Eb);this.dOb(Eb,kb);const Gb=new J.GraphIterator;Gb.set(Eb);La.a.instance.hCm(Gb);if(Gb.zb(10)){const Sa=Gb.hd(10);Gb.Rb(1)===Eb&&this.iL.cOb(Sa,kb)}bb.dispose()}dOb(Eb,kb){let bb=null,Gb=null;if(F.a.instance.J(1)&&
Eb.isConnected){bb=Ya.ParagraphReader.jw(Eb,!0,!0);Gb=new G.a;for(let Sa=0;Sa<bb.count;Sa++)12===bb.J(Sa).type&&Gb.add(bb.J(Sa).LD())}Eb.properties.setValue(z.a.x0,kb);if(F.a.instance.J(1)&&bb&&Gb)if(bb.count!==Gb.count)v.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",bb.count,Gb.count);else for(Eb=0;Eb<bb.count;Eb++)this.lj.YU(bb.J(Eb),Gb.J(Eb),this.Ld.qg)}dZn(Eb){Eb.properties.removeProperty(z.a.x0)}OI(Eb,kb=null,bb=!1){var Gb,Sa=null;let Pa=
null;if(!da.OutlineElementReader.Bh(Eb))return v.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),null;let Ab=null,nb=null,Rb=0;kb&&(Ab=kb.formatting,nb=kb.Yqa,Rb=kb.languageId);bb||({cpa:Sa,rRa:Pa}=this.S2h(Eb,Sa,Pa));kb=I.a.instance.createInstance(393230);kb.setValue(z.a.mo,"");Eb.Hf(kb,2);Eb.Gi(kb);gc.paragraphEditor.EMb(kb);gc.paragraphEditor.N7m(kb);gc.paragraphEditor.hUa(kb);this.Sok(kb);e.AFrameworkApplication.CM&&!e.AFrameworkApplication.zaj&&(e.AFrameworkApplication.ue("AutoRenameNewDocument-tf;AutoRenameNewDocument-cf"),
(null===(Gb=e.AFrameworkApplication.K)||void 0===Gb?0:Gb.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocument",!1))&&this.zHk());Ab&&(kb.pa.first.formatting.Fj=Ab);Rb||(Rb=e.AFrameworkApplication.lcid);Eb.currentNode.Zg(z.a.m5c,Eb.currentNode.ia(z.a.m5c,Rb));Eb.currentNode.setValue(y.a.KRa,0);nb&&this.XG.HJ(nb,kb,!0);!bb&&Sa&&(bb=new ja.a(kb),Sa=new ia(Sa,Pa,Sa,bb,kb.Kma),Eb.currentNode.FH().jF.EI(Sa));return kb}zHk(){if(this.Fxa){for(var Eb,kb=this.Fxa.pkf();kb;){const bb=kb.node;
if(0<Ya.ParagraphReader.textLength(bb,9)&&(Eb=ib.AParagraphNode.OUl(bb.characterData.trim()),0<Eb.length))break;kb=kb.next}Eb&&32===e.AFrameworkApplication.va.Qb($a.a.renameFile,2,Eb)&&this.Hp&&(this.Hp.execute(bb=>{bb.logActivity("AutoRenameDocumentCallout",null)}),l.a("AutoRenameDocumentSuccess"))}}S2h(Eb,kb,bb){bb=new J.GraphIterator;bb.Yc(Eb);kb=null;bb.bDf?bb.currentNode.FH().jF.p7(6):(U.OutlineElementNavigator.p0(bb,!0,!1),kb=this.tPd(bb));bb.Yc(Eb);bb=this.Z3h(bb);return{cpa:kb,rRa:bb}}Z3h(Eb){const kb=
new J.GraphIterator;kb.Yc(Eb);Eb=null;kb.xFa||(U.OutlineElementNavigator.Ur(kb,!0,!1),Eb=this.tPd(kb));return Eb}tPd(Eb,kb=!1){Eb=U.OutlineElementNavigator.Ge(Eb,!0);return Eb?this.f9h(Eb,kb):(v.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}f9h(Eb,kb=!1){if(12===Eb.type)return kb?new ja.a(Eb):new pa.a(Eb);Eb.FH().jF.p7(5);return new ea.a(Eb)}qYk(Eb,kb){var bb=kb.currentNode.clone();Eb.HH(bb,null,1);Eb.Gi(bb);bb.Kaa=kb.currentNode;U.OutlineElementNavigator.Ge(kb);
kb.p8&1&&kb.currentNode.UQb(null);bb=kb.currentNode.clone();bb.wTa=kb.currentNode.wTa;bb.yP=kb.currentNode.yP;Eb.HH(bb,null,2);Eb.Gi(bb);Eb.S_(1);bb.Kaa=kb.currentNode;bb.setValue(y.a.Lc,a.a.vF());kb.At(11)}EMb(Eb){Eb.Rb(2)&&Eb.wg()}v1n(Eb,kb){const bb=Eb.currentNode;U.OutlineElementNavigator.Ge(Eb);const Gb=Eb.currentNode;U.OutlineElementNavigator.Vd(Eb);kb.iF(1);U.OutlineElementNavigator.Ge(kb);Eb.Hf(kb.currentNode,2);kb.wg();var Sa=new J.GraphIterator;Sa.Yc(kb);if(Sa.Rb(1)){const Pa=new J.GraphIterator;
Pa.Yc(Eb);const Ab=new Z(null);if(!this.Ggm(Pa,Sa.currentNode,Ab))return;N.f(Pa,null,1,1,Sa,-1)}kb.wg();Sa=null;Eb.KC(1)&&(Sa=Eb.currentNode);for(Eb.uc();X.OutlineNavigator.T8(kb);)Eb.HH(kb.currentNode,Sa,1),Sa=kb.currentNode,kb.wg();Eb.Gi(bb);Eb.Gi(Gb);Eb.wg()}N9(Eb,kb,bb,Gb,Sa,Pa,Ab=!1,nb=!1){var Rb=da.OutlineElementReader.Bh(Eb),Mb=da.OutlineElementReader.Bh(kb),oc=bb.isValid&&bb.contextId===K.a.Tc;Rb&&Mb&&oc||v.ULS.sendTraceTag(594642515,307,15,"sourceOutlineElementIsValid:{0}; destinationOutlineElementIsValid:{1}; ipContextIsValid:{2}",
Rb,Mb,oc);var xb=Eb.currentNode;this.EMb(kb);Mb=kb.We;let cc,Ob=null;Rb=oc=null;let Ub=!1;U.OutlineElementNavigator.Ge(Eb);const pb=Eb.We;if(Ya.ParagraphReader.uh(Eb)){cc=Eb.currentNode;(oc=Object(A.a)(ib.AParagraphNode,cc))?oc.pa&&oc.pa.length||v.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",oc):v.ULS.sendTraceTag(38925731,307,15,"srcParaNode is null");oc=new ja.a(oc);(Ub=bb.cpBegin===Ya.ParagraphReader.textLength(cc))&&(Rb=this.Z3h(kb));const Zb=kb.currentNode;
Ob=this.OI(kb,void 0,!0);gc.paragraphEditor.qTa(Eb,kb,bb,Sa,Pa,Ab,nb);Gb?(Sa=this.sc.Lo(cc))&&this.XG.HJ(Sa,Ob,!0):Ub&&(Sa=this.sc.Lo(cc))&&((nb=Sa.ia(n.a.Xd,null))?(Sa=this.sc.JC(Ob).Fi(nb),this.XG.HJ(Sa,Ob,!1)):this.XG.HJ(Sa,Ob,!0));this.fgf(xb,Zb)}U.OutlineElementNavigator.Vd(Eb);U.OutlineElementNavigator.Vd(kb);U.OutlineElementNavigator.Ge(Eb);(xb=Object(A.a)(ib.AParagraphNode,Eb.currentNode))?xb.pa&&xb.pa.length||v.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",
xb):v.ULS.sendTraceTag(38925761,307,15,"srcPara is null");xb=new ja.a(xb);U.OutlineElementNavigator.Vd(Eb);(Eb=Ob)?Eb.pa&&Eb.pa.length||v.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",Eb):(v.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),v.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:Ub,["moveText"]:Pa,["overrideParagraphStyle"]:Gb,["sourceOutlineElementContentNodeType"]:pb,["destinationOutlineElementNodeType"]:Mb,
["alwaysMoveEopToDestinationPara"]:Ab}));Ub?(bb=new ja.a(Eb),bb=new ia(oc,Rb,xb,bb,Eb.Kma),kb.currentNode.FH().jF.EI(bb)):(bb=Pa?new ra(oc,bb.cpBegin,xb,new ja.a(Eb),Eb.Kma):new ra(oc,bb.cpBegin,new ja.a(Eb),xb,Eb.Kma),kb.currentNode.FH().jF.EI(bb));return Eb}kAh(Eb,kb){U.OutlineElementNavigator.Ge(Eb);let bb=Ya.ParagraphReader.Qt(Eb.currentNode)&&this.yRk(Eb);const Gb=Eb.currentNode;bb=kb?bb&&!this.Vf.$xn(Gb):bb&&!this.Vf.Rxn(Gb);U.OutlineElementNavigator.Vd(Eb);return bb}yRk(Eb){return Ya.ParagraphReader.uh(Eb)&&
!Ya.ParagraphReader.Oeb(Eb.currentNode)}merge(Eb,kb,bb,Gb,Sa=null,Pa=!1,Ab,nb=!1,Rb=!1,Mb=!1){var oc;if(Eb.currentNode.id===kb.currentNode.id)return!1;let xb;const cc=new J.GraphIterator;cc.Yc(kb);Ab=this.tPd(cc);cc.Yc(Eb);xb=this.tPd(cc,!0);if(!this.kAh(kb,!0)||!this.kAh(Eb,!1))return!1;if(this.Vf.kh){U.OutlineElementNavigator.Ge(Eb);U.OutlineElementNavigator.Ge(kb);var Ob=Ya.ParagraphReader.uh(Eb)?Eb.currentNode:null,Ub=Ya.ParagraphReader.uh(kb)?kb.currentNode:null;U.OutlineElementNavigator.Vd(Eb);
U.OutlineElementNavigator.Vd(kb);if(Ob&&Ub&&!this.Vf.lAh(Ob,Ub,!1)){if(!this.AD||!this.Vf.lAh(Ob,Ub,!0))return!1;this.AD&&(this.AD.fCj(Ob,!1),this.AD.fCj(Ub,!0))}}Ob=Object(A.a)(ib.AParagraphNode,Eb.currentNode);Ob=(bb||!Ob||!Ob.characterData.length)&&!Db.ListItemReader.sh(Eb);nb||this.Un.merge(Eb,kb,Ob,Sa);U.OutlineElementNavigator.Ge(Eb);Sa=Eb.currentNode.Kma;U.OutlineElementNavigator.Ge(kb);if(Ya.ParagraphReader.uh(kb)){nb=kb.currentNode;if(null===(oc=oa.App.rd)||void 0===oc?0:oc.Yo)if(oc=Eb.currentNode,
Ob=Ca.CoauthLockEditor.getInstance(),Ob.D6a(this.Vf.a7b(nb))||Ob.D6a(this.Vf.a7b(oc)))return kb.uc(),Eb.uc(),!1;oc=!1;(nb=Eb.parentNode)&&da.OutlineElementReader.roa(nb)&&(oc=Db.ListItemReader.sh(nb));(nb=this.Eoo(Ya.ParagraphReader.isEmpty(Eb),oc,bb,Gb,Rb))&&(Ob=this.sc.$tf(kb))&&this.XG.HJ(Ob,Eb.currentNode,!0);bb&&(Ob=kb.currentNode,Ub=Eb.currentNode,(nb||oc)&&Fa.b(Ob,Ub),Rb&&Gb||this.p6.hNi(Ob,Ub,oc),e.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordPreserveEopFormattingPasteSettings"),
Mb&&(Rb=this.e6k(Ub,Ob),v.ULS.sendTraceTag(588288132,307,50,"wasCopied: {0}",Rb)));bb=gc.paragraphEditor.merge(Eb,kb,bb,Gb,Pa);Pa=cc.currentNode;Gb=Eb.currentNode;Eb.uc();bb&&da.OutlineElementReader.isEmpty(kb,!0)&&this.N_a(kb);Eb=new ua(xb,Ab,new pa.a(Pa),Sa);Gb.FH().jF.EI(Eb);return!0}kb.uc();Eb.uc();return!1}e6k(Eb,kb){let bb=null;kb&&kb.pa&&0<kb.pa.length&&kb.pa.first.Sh&&(bb=kb.pa.first.formatting);return bb&&Eb&&Eb.pa&&0<Eb.pa.length&&R.FormattingReader.C3k(Eb.pa)?(Eb.pa.last.formatting=bb.Ef(Eb.pa.last),
!0):!1}Eoo(Eb,kb,bb,Gb,Sa){return kb?!1:bb?!(Gb&&Sa):Eb}zAm(Eb){const kb=new J.GraphIterator;kb.set(Eb.node);kb.yd();U.OutlineElementNavigator.Vd(kb);const bb=this.aoa(kb),Gb=this.aoa(kb);this.N9(kb,bb,Eb,!1,!0,!0);da.OutlineElementReader.isEmpty(kb,!1)&&(this.Un.Hca(kb),kb.wg());da.OutlineElementReader.isEmpty(bb,!1)&&!da.OutlineElementReader.Hjb(bb)&&(this.Un.Hca(bb),bb.wg());return Gb}yB(Eb,kb,bb,Gb=null,Sa=!1,Pa=!0){if(!this.uRk(Eb))return null;const Ab=Eb.currentNode;var nb=!1;Pa&&(nb=Db.ListItemReader.sh(Eb),
Sa=kb||Sa||!da.OutlineElementReader.isEmpty(Eb,!1),nb=this.Un.gso(nb,Sa));Sa=kb?Eb.KC(1):Eb.currentNode;Eb.uc();bb=this.iL.Uib(Eb,Sa,bb,Gb);if(!bb)return null;this.fgf(Ab,bb);Pa&&nb&&this.Un.fKo(Eb,kb,Ab,bb);return bb}uRk(Eb){return da.OutlineElementReader.Bh(Eb)&&(Eb=Eb.parentNode,V.OutlineReader.zZd(Eb)||da.OutlineElementReader.roa(Eb)||da.OutlineElementReader.jQa(Eb))?!0:!1}ZGa(Eb){const kb=new J.GraphIterator;kb.set(Eb);kb.yd();kb.At(11);let bb=null,Gb=null;({cpa:bb,rRa:Gb}=this.S2h(kb,bb,Gb));
let Sa=-1;12===Eb.type&&(Sa=Eb.Kma);kb.currentNode?(kb.currentNode.FH().jF.EI(new Ma(this.f9h(Eb,!0),bb,Gb,Sa)),this.N_a(kb)):v.ULS.sendTraceTag(574650269,324,15,"The content to be deleted does not have a containing OE")}N_a(Eb){if(Eb.Nr(1)){const kb=new ma,bb=new J.GraphIterator;bb.Yc(Eb);this.YLl(bb,kb)&&this.fq.ZIc(Eb,-kb.s4b)}Eb.wg();eb.TableReader.Yw(Eb)&&this.UCn(Eb)}uAf(Eb,kb,bb){if(!V.OutlineReader.Zw(Eb)&&!da.OutlineElementReader.Bh(Eb))return null;const Gb=this.Yal();0<bb&&bb<W.a.last&&
Gb.setValue(z.a.jL,Math.min(W.a.nil,bb));Eb.HH(Gb,kb,1);return Gb}BAm(Eb,kb){if(!da.OutlineElementReader.Bh(Eb)&&!da.OutlineElementReader.aL(Eb)||!V.OutlineReader.Gwa(Eb.parentNode)&&!da.OutlineElementReader.roa(Eb.parentNode))return null;const bb=Eb.currentNode;let Gb;Gb=Eb.currentNode;Eb.uc();kb=this.uAf(Eb,Gb,kb);Eb.Gi(bb);return kb}UCn(Eb){da.OutlineElementReader.aL(Eb)&&(Eb.Nr(1)||Eb.wg());this.G_h(Eb,!1);this.$qh(Eb)}G_h(Eb,kb){var bb,Gb=null;for(bb=Eb.Rb(1);bb;){var Sa=!1;da.OutlineElementReader.jQa(bb)&&
!Eb.Nr(1)&&(Sa=!0);var Pa=bb;bb=Eb.xi(1);if(Sa)Sa=new J.GraphIterator,Sa.set(Pa),Sa.yd(),Sa.wg();else if(da.OutlineElementReader.jQa(Pa)){if(Gb){Sa=new J.GraphIterator;Sa.set(Gb);var Ab=new J.GraphIterator;Ab.set(Pa);Ab.yd();Sa.Hf(Ab.currentNode,1);Ab.wg();Ab=da.OutlineElementReader.sga(Pa);Ab===W.a.nil&&(Ab=1);const nb=da.OutlineElementReader.sga(Pa);(Ab=Math.max(0,nb-Ab))?Pa.setValue(z.a.jL,Math.min(W.a.nil,Ab)):(Sa.Gi(Pa),Eb.Rb(1),N.d(Sa),Sa.uc());kb&&this.G_h(Sa,!0)}}else Gb=Pa}kb=null;Gb=W.a.last+
1;for(bb=Eb.Rb(1);bb;bb=Eb.xi(1))if(da.OutlineElementReader.aL(Eb))Pa=da.OutlineElementReader.sga(bb),Gb>Pa&&(Gb=Pa,kb=bb);else{Eb.uc();return}if(kb){for(bb=Eb.Rb(1);bb;bb=Eb.xi(1))bb!==kb&&(bb=da.OutlineElementReader.sga(bb),Eb.currentNode.setValue(z.a.jL,Math.min(W.a.nil,bb-Gb)));Gb+=da.OutlineElementReader.sga(Eb.currentNode);Eb.currentNode.setValue(z.a.jL,Math.min(W.a.nil,Gb));bb=new J.GraphIterator;bb.Yc(Eb);bb.Gi(kb);bb.Rb(1);N.d(bb)}}Ggm(Eb,kb,bb){var Gb=da.OutlineElementReader.sga(Eb.currentNode);
if(1===Gb)return!0;if(da.OutlineElementReader.aL(Eb))return!1;if(!Eb.ghb(1)||this.eNm(Eb,kb))return Eb.currentNode.setValue(z.a.jL,Math.min(W.a.nil,1)),!0;if(bb.$oa&&Eb.Gi(bb.$oa)){if(da.OutlineElementReader.aL(Eb)&&1===Gb+da.OutlineElementReader.sga(Eb.currentNode))return bb.$oa=Eb.iF(1),Eb.uc(),!0;Eb.uc()}if(bb.$oa&&Eb.Gi(bb.$oa)||!bb.$oa&&Eb.Rb(1)){if(Eb.currentNode!==kb&&Eb.vf(1)&&da.OutlineElementReader.aL(Eb)&&1===Gb+da.OutlineElementReader.sga(Eb.currentNode))return bb.$oa=null,!0;Eb.uc()}if(Eb.hib(kb)&&
this.dNm(Eb,kb)){for(bb=Eb.Rb(1);bb;bb=Eb.xi(1))if(bb!==kb){var Sa=da.OutlineElementReader.sga(bb);bb.setValue(z.a.jL,Math.min(W.a.nil,Sa+(Gb-1)))}Eb.currentNode.setValue(z.a.jL,Math.min(W.a.nil,1));return!0}if(1>Gb)return Gb=this.uAf(Eb,bb.$oa,1-Gb),Eb.Gi(Gb),bb.$oa=null,!0;if(1<Gb){Eb.currentNode.setValue(z.a.jL,Math.min(W.a.nil,1));kb=null;for(Sa=Eb.Rb(1);Sa;){if(da.OutlineElementReader.aL(Eb)){Sa.setValue(z.a.jL,Math.min(W.a.nil,Gb-1+da.OutlineElementReader.sga(Sa)));Sa=Eb.xi(1);continue}kb||
(kb=this.BAm(Eb,Gb-1));const Pa=Sa;Sa=N.h(Eb,kb,1);Sa===kb&&(Sa=Eb.xi(1));bb.$oa===Pa&&(bb.$oa=kb,kb=null)}return!0}return!1}eNm(Eb,kb){return J.GraphIterator.dba(()=>{if(1===Eb.ghb(1)){const bb=Eb.Rb(1);Eb.uc();if(bb===kb)return!0}return!1})}dNm(Eb,kb){return J.GraphIterator.dba(()=>{let bb;for(bb=Eb.Rb(1);bb;bb=Eb.xi(1))if(bb!==kb&&!da.OutlineElementReader.aL(Eb))return Eb.uc(),!1;return!0})}YLl(Eb,kb){kb.s4b=0;do{const bb=Eb.currentNode;if(Eb.Rb(1))kb.s4b-=da.OutlineElementReader.sga(bb);else{if(V.OutlineReader.Zw(Eb)||
null===Eb.currentNode)return!1;if(3!==Eb.role||!Eb.Oga(1))for(;!Eb.xi(1);)if(kb.s4b+=da.OutlineElementReader.sga(Eb.currentNode),V.OutlineReader.Zw(Eb)||null===Eb.currentNode)return!1}}while(da.OutlineElementReader.aL(Eb));return!0}aoa(Eb,kb=!1){return this.wWd(Eb,!1,kb)}yAm(Eb){return this.wWd(Eb,!0,!1)}wWd(Eb,kb,bb=!1){const Gb=new J.GraphIterator;Gb.Yc(Eb);Eb=new J.GraphIterator;Eb.Yc(Gb);this.yB(Eb,kb,!1,null,bb);Eb.currentNode.setValue(z.a.jL,Math.min(W.a.nil,da.OutlineElementReader.sga(Gb.currentNode)));
Gb.Rb(1)&&N.f(Eb,null,1,1,Gb,-1);return Eb}$qh(Eb){if(da.OutlineElementReader.e3n(Eb)){1!==da.OutlineElementReader.sga(Eb.currentNode)&&Eb.currentNode.setValue(z.a.jL,W.a.first);for(var kb=Eb.Rb(1);kb;)if(da.OutlineElementReader.aL(Eb)){kb=new J.GraphIterator;kb.Yc(Eb);kb.uc();const bb=new J.GraphIterator;bb.Yc(Eb);bb.Rb(1);N.f(kb,Eb.currentNode,1,1,bb,-1);kb=Eb.L_a(1)}else this.$qh(Eb),kb=Eb.xi(1)}}static get wk(){return null!=gc.iHg?gc.iHg:gc.iHg=m.a.instance.resolve("Box4.ITableEditor")}static get paragraphEditor(){return gc.Is||
(gc.Is=m.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(Eb){gc.Is=Eb}}gc.Is=null;Object(E.a)(gc,"OutlineElementEditor",null,[300])},1933:function(E,M,c){E=c(0);var m=c(136),e=c(57),a=c(22),l=c(2),y=c(58),z=c(638),n=c(92),v=c(83),A=c(396),w=c(353),G=c(19),F=c(354),I=c(53),K=c(175),J=c(44),N=c(35),R=c(13),O=c(1560),L=c(116),U=c(6),W=c(15),X=c(145),V=c(7),Z=c(453),da=c(681),aa=c(568),ea=c(119),na=c(18),pa=c(245),ja=c(247),ma=c(28),Ia=c(34);class Ja{constructor(lb){this.Iy=null;
this.U5g=!1;this.Fp=null;this.UL=new O.a;this.xDe=new O.a;this.Ec=lb}get Dlb(){Ia.a(4281429,307,this.UL.count===this.xDe.count);return this.UL.count}get J3d(){return this.U5g}set J3d(lb){this.U5g=lb}k1b(lb){this.Iy=lb}get xT(){return null}grh(lb,Ya){this.UL.add(lb);this.xDe.add(Ya)}}Ja.blb=2712;Object(E.a)(Ja,"APicturePasteHandler",null,[479]);var Ka=c(251),Ma=c(3),sa=c(9),xa=c(1141),ia;(function(lb){lb[lb.unknown=0]="unknown";lb[lb.other=1]="other";lb[lb.file=2]="file";lb[lb.blob=3]="blob";lb[lb.chromeExtension=
4]="chromeExtension";lb[lb.cid=5]="cid"})(ia||(ia={}));Object(E.b)("UnsupportedUrlScheme",ia);var ha=c(258),ua=c(43),ya=c(8),ra=c(1827),La=c(1828),oa=c(1754);class Ca{constructor(){this.delay=this.retry=0}}Object(E.a)(Ca,"ForceInboundData",null,[]);class Aa{constructor(lb,Ya,Fa,$a){this.BUd=!1;this.request=lb;this.W2n=Ya;this.url=$a;this.NAm=Fa}}Object(E.a)(Aa,"PicturePasteRequestInfo",null,[]);var db=c(393);c.d(M,"a",function(){return ib});const eb=["ImageInsertFailed"];class ib extends Ja{constructor(lb,
Ya,Fa,$a,Db,gc=null,Eb=null,kb=!1,bb=null,Gb=null){super(lb);this.Nl=m.a.nil;this.dB=new O.a;this.uLa=0;this.Mvc=this.adh=null;this.lbh=!1;this.Nyc=null;this.fjd=new O.a;this.Rp=null;this.oEn=()=>{var Sa=this.TLl(),Pa=131073;this.I8j&&(Pa=1073872970);Sa=e.a.eo(Sa,Z.a.cellId,this.Fp.wm.toString());Sa=e.a.eo(Sa,Z.a.xT,this.Nl.toString());Sa=e.a.eo(Sa,Z.a.classId,Pa.toString());this.Fp.CH&&(Sa=e.a.eo(Sa,Z.a.CH,this.Fp.CH));Sa=e.a.eo(Sa,Z.a.vqb,"1");Sa=e.a.eo(Sa,da.a.imageType,"1");Sa=Ka.a.instance.zZe(Sa);
this.Fp.contentReplicator&&this.Fp.contentReplicator.XHb&&(Sa=e.a.eo(Sa,Z.a.h3e,"1"));let Ab=0;Pa=Sa;var nb=new O.a;const Rb=new O.a,Mb=new O.a,oc=new O.a,xb=new O.a,cc=new O.a;var Ob="",Ub=a.a.instance.Na("Box4.IFeatureHelper");Ub=!!Ub&&Ub.isFeatureEnabled(11)&&Ub.isFeatureEnabled(49);for(let qc=0;qc<this.Dlb;qc++){var pb=this.xDe.J(qc);V.ULS.shipAssertTag(7869452,307,!!pb.src);V.ULS.shipAssertTag(7869453,307,""!==pb.src);V.ULS.shipAssertTag(7869454,307,19922944>pb.src.length);const Ra=this.UL.J(qc);
var Zb=Ra.node.ia(L.a.uJ,ha.a.yt);this.PTo(Ra.blob,pb);var Wa=pb.alt;var Lb=pb.ojl;Lb||(Lb=Wa,Wa="");const yb=Ra.blob;Zb=ra.a.construct(yb?yb.id.toString():Ra.node.id.toString(),pb.src,Wa,pb.width,pb.height,Lb,Zb,Ra.kU,!!yb&&yb.properties.ia(U.a.gha,!1),yb?yb.properties.ia(L.a.Wfa,-1):-1,yb?yb.properties.ia(U.a.Tkb,Box4Intl.Box4Strings.l_Picture):"",Ra.node.properties.ia(W.a.Ewa,!1),null,null,null,pb.RDd);pb.src.startsWith("data:")?(Lb=!1,Ub&&pb.RDd?(Lb=!0,pb=xb,Wa=cc):(pb=Mb,Wa=oc),pb.add(Zb),Wa.add(Ra),
Lb=La.a.construct(pb.toArray(),!Lb,l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Fp.rr:null,Lb),Lb=N.c(Lb),Lb.length>ib.B$m?(V.ULS.shipAssertTag(7869456,307,1<pb.count),pb.remove(Zb),Wa.remove(Ra),Lb=this.dB.count?(new y.a(this.Nl,Ab)).toString():this.Fp.contentReplicator.wt.toString(),Pa=e.a.eo(Pa,Z.a.Qta,Lb),Pa=e.a.eo(Pa,Z.a.zfc,Ab.toString()),na.ImageReader.increaseMaxWebFriendlyDimensionTo1600&&(Pa=e.a.eo(Pa,Z.a.PQb,"1")),this.dB.add(new Aa(La.a.construct(pb.toArray(),
!0,l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Fp.rr:null),Ob,Wa,Pa)),Ab+=Mb.count,pb=new O.a,pb.add(Zb),Wa=new O.a,Wa.add(Ra)):Ob=Lb):(nb.add(Zb),Rb.add(Ra))}Mb.count&&(Pa=Sa,Lb=this.dB.count?(new y.a(this.Nl,Ab)).toString():this.Fp.contentReplicator.wt.toString(),Pa=e.a.eo(Pa,Z.a.Qta,Lb),Pa=e.a.eo(Pa,Z.a.zfc,Ab.toString()),na.ImageReader.increaseMaxWebFriendlyDimensionTo1600&&(Pa=e.a.eo(Pa,Z.a.PQb,"1")),Ob=La.a.construct(Mb.toArray(),!0,l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?
this.Fp.rr:null),this.dB.add(new Aa(Ob,N.c(Ob),oc,Pa)),Ab+=Mb.count,this.fjd.add(ib.qlf));nb.count&&(Pa=Sa,Lb=this.dB.count?(new y.a(this.Nl,Ab)).toString():this.Fp.contentReplicator.wt.toString(),Pa=e.a.eo(Pa,Z.a.Qta,Lb),Pa=e.a.eo(Pa,Z.a.zfc,Ab.toString()),Pa=e.a.eo(Pa,Z.a.PQb,"1"),nb=La.a.construct(nb.toArray(),!1,l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Fp.rr:null),this.dB.add(new Aa(nb,N.c(nb),Rb,Pa)),l.AFrameworkApplication.Aha("WoInc325;WoInc325cf"),this.fjd.add(this.CVg));
xb.count&&(Pa=Sa,Lb=this.dB.count?(new y.a(this.Nl,Ab)).toString():this.Fp.contentReplicator.wt.toString(),Pa=e.a.eo(Pa,Z.a.Qta,Lb),Pa=e.a.eo(Pa,Z.a.zfc,Ab.toString()),Pa=e.a.eo(Pa,Z.a.PQb,"1"),Sa=La.a.construct(xb.toArray(),!1,l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Fp.rr:null,!0),this.dB.add(new Aa(Sa,N.c(Sa),cc,Pa)),this.fjd.add(this.CVg));V.ULS.sendTraceTag(595068930,307,50,"Prepared "+(this.dB?this.dB.count:-1)+" picture paste requests to send");this.Ynb()};
this.picturePasteRequestSucceeded=Sa=>{var Pa;V.ULS.sendTraceTag(572528019,307,50,"PicturePasteRequestSucceeded received response with Http status: {0}",this.XXl(Sa));if(({group:Ab}=aa.a.l1(Sa.data.xe)).returnValue){var Ab=Ab.Responses[0];if(Ab.StatusCode)if(46!==Ab.StatusCode||this.dB.J(this.uLa).BUd){V.ULS.sendTraceTag(51212675,322,15,"Picture paste request failed with reason "+Ab.StatusCode);Sa=Object.assign(new ea.a,{extendedProperties:new Map});Sa.extendedProperties.set("statuscode",Ab.StatusCode.toString());
if(null===(Pa=l.AFrameworkApplication.K)||void 0===Pa?0:Pa.$("ShouldLogPicturesExtendedHealthKpis")){var nb={name:db.c.H9b,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:Sa};Sa.extendedProperties.set("ErrorLevel","warning");this.$h.logKpiFailure({kpiName:db.c.QEa,errorName:"PictureRemotePasteFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:Sa},optionalVeto:nb})}else v.Health.instance.recordQosError("PictureRemotePasteFailed",
eb,!1,!0,!1,!1,Sa);this.nlm()}else this.dB.J(this.uLa).BUd=!0,this.Ynb();else{Ab=Pa="";Sa&&Sa.data&&Sa.data.vj&&(da.a.QH in Sa.data.vj&&Sa.data.vj[da.a.QH]&&(Ab=Sa.data.vj[da.a.QH]),"X-CorrelationId"in Sa.data.vj&&Sa.data.vj["X-CorrelationId"]&&(Pa=Sa.data.vj["X-CorrelationId"]));V.ULS.sendTraceTag(595068929,307,50,"PicturePasteRequestSucceeded called.[Status code: {0}][X-CorrelationID: {1}]",Ab,Pa);(null===(nb=l.AFrameworkApplication.K)||void 0===nb?0:nb.$("ShouldLogPicturesExtendedHealthKpis"))&&
this.$h.logKpiSuccess({kpiName:db.c.QEa});this.Nyc&&(this.Nyc.stop(),this.Nyc=null);this.uLa++;this.bDj&&this.Ynb();this.adh=this.Fp.contentReplicator.wt;let Rb=null;Rb=Object.assign(new Ca,{retry:0,delay:this.fjd.J(this.uLa-1)});Sa=new n.a(2,1,ib.qlf,()=>{this.Fp.contentReplicator.C$d(this.X0h,null,Rb)},124);this.Hb.Vb(Sa)}}else V.ULS.sendTraceTag(7869457,307,10,"PicturePasteRequestSucceeded received null or empty server response group"),Sa=new z.a(Sa.data),this.Gfc(Sa)};this.X0h=Sa=>{const Pa=!y.a.Zp(this.adh,
this.Fp.contentReplicator.wt);V.ULS.sendTraceTag(8246492,307,50,"Revision changed after ForceInbound: {0}",Pa);if(Pa)this.aAh();else{const Ab=Sa?Sa:null;if(Sa&&Ab&&Ab.retry<ib.PFl){Ab.retry+=1;Sa=new n.a(2,1,Ab.delay,()=>{this.Fp.contentReplicator.C$d(this.X0h,null,Ab)},125);this.Hb.Vb(Sa);return}Sa=ib.qlf;null!=Ab&&(Sa=Ab.delay);Sa=new n.a(2,1,Sa,()=>{this.Fp.contentReplicator.C$d(null,null,null)},125);this.Hb.Vb(Sa);this.bAh()}ib.FRf--;l.AFrameworkApplication.va.processAction(R.a.S7a,2);oa.a.instance.smc(this.Fp,
0);this.Dug();this.su.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)};this.Gfc=Sa=>{var Pa,Ab="",nb="";Sa&&Sa.data&&Sa.data.vj&&("X-CorrelationId"in Sa.data.vj&&Sa.data.vj["X-CorrelationId"]&&(Ab=Sa.data.vj["X-CorrelationId"]),da.a.QH in Sa.data.vj&&Sa.data.vj[da.a.QH]&&(nb=Sa.data.vj[da.a.QH]));nb=""===nb?"":String.format("[Operation Result: {0}]",nb);Ab=""===Ab?"":String.format("[X-CorrelationID: {0}]",Ab);V.ULS.sendTraceTag(51212676,322,15,"Picture paste request failed.[HttpStatus: {2}] [Connection state: {3}]{0}{1}",
nb,Ab,Sa.data.Qe,A.SessionStatusManager.instance.KH);9===Sa.data.status||this.dB.J(this.uLa).BUd?(oa.a.instance.smc(this.Fp,127),this.LBh(),this.Nyc=null,(null===(Pa=l.AFrameworkApplication.K)||void 0===Pa?0:Pa.$("ShouldLogPicturesExtendedHealthKpis"))?(Sa=Object.assign(new ea.a,{extendedProperties:new Map([["HttpStatus",String(Sa.data.Qe)],["ConnectionState",String(A.SessionStatusManager.instance.KH)],["OperationResult",nb],["CorrelationId",Ab],["ErrorLevel","warning"]])}),this.$h.logKpiFailure({kpiName:db.c.QEa,
errorName:"PictureRemotePasteFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:Sa},optionalVeto:{name:db.c.H9b,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):v.Health.instance.recordQosError("PictureRemotePasteFailed",eb,!1,!0,!1,!1,null)):(this.dB.J(this.uLa).BUd=!0,this.Ynb())};this.$h=w.a.getInstance(db.a);this.Oj=Ya;this.Hb=Fa;this.Jm=$a;this.he=sa.App.ya.Fq;this.yDe=gc;this.I6=Eb;this.g$j=kb;this._operationId=
bb;this.Vgk=Gb;this.CVg=l.AFrameworkApplication.K.mc("PicturePasteHttpForceInboundDelay",3E3);this.lbh=this.K?this.K.$("ProvideUnsupportedUrlSchemeIsEnabled"):!1;sa.App.elc.addHandler(this);this.I8j=!!Db&&Db.isFeatureEnabled(122)}get su(){return this.Rp||(this.Rp=a.a.instance.resolve("Common.Utils.IAriaNotifier"))}get K(){return l.AFrameworkApplication.K}get Ffc(){return sa.App.Ffc}get oMi(){return this.Dlb===sa.App.mMf}get bDj(){return this.uLa!==this.dB.count}Dug(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&
window.setTimeout(()=>{const lb=a.a.instance.Sa("Common.ISystemInitiatedFeedback");lb&&lb.execute(Ya=>{Ya.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}get xT(){return this.Nl}qxa(lb){var Ya;lb.alt.length>Ja.blb&&(lb.alt=lb.alt.substring(0,G.a.mz(lb.alt,Ja.blb)?Ja.blb-1:Ja.blb));this.$h.logKpiUsage({kpiName:db.c.QEa,kpiType:0});if(this.I6&&ib.oKm(lb)){this.g$j&&J.c(Ma.a.iyl);var Fa="unknown";this.lbh&&(lb=new URL(lb.src),Fa=ia[xa.a.qQo(lb.protocol)]);V.ULS.sendTraceTag(41969745,
322,15,"Unable to paste image with local URL. OperationId: {0}, URL scheme: {1}, rtfDataStatus: {2}",this._operationId,Fa,this.Vgk);lb=Object.assign(new ea.a,{extendedProperties:new Map});lb.extendedProperties.set("protocol",Fa);(null===(Ya=l.AFrameworkApplication.K)||void 0===Ya?0:Ya.$("ShouldLogPicturesExtendedHealthKpis"))?(Ya={name:db.c.H9b,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:lb},lb.extendedProperties.set("ErrorLevel",
"warning"),this.$h.logKpiFailure({kpiName:db.c.QEa,errorName:"PictureRemoteWithLocalPath",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:lb},optionalVeto:Ya})):v.Health.instance.recordQosError("PictureRemoteWithLocalPath",eb,!0,!0,!1,!1,lb);this.tvo()}else Ya=new F.DictionaryPropertySet,lb=this.Ufj(lb),null!==lb.RDd&&"chart"===lb.RDd.type&&Ya.setValue(U.a.Ys,7),this.Oj.J$d(Ya,lb.width,lb.height,!0),V.ULS.shipAssertTag(7869444,307,ya.ParagraphReader.Wb(this.Ec.currentNode)),this.Nyc=
this.he.Zf("WebServiceCall",ib.WAn),V.ULS.sendTraceTag(20505094,322,50,String.format("ImagePasteRequest img width: {0}, height {1}",lb.width,lb.height)),Fa=ma.a.fw(this.Ec.currentNode),Ya=this.Oj.zWd(Fa,Ya),this.grh(Ya,lb)}bVf(){0<this.Dlb&&(this.Nl=m.a.create(),this.Fp=this.UL.J(0).node.Bi(),V.ULS.sendTraceTag(38122840,307,50,"Pasted pictures: {0}",this.Dlb),this.J3d&&(V.ULS.sendTraceTag(38122841,307,15,"MaxPicturesExceeded in paste."),this.Auo()),oa.a.instance.ing(this.Fp),this.Dug(),this.Fp.contentReplicator.forceOutbound(this.oEn,
null,null))}oge(lb){if(0<this.Dlb){const Fa=lb.ia(U.a.gha,!1),$a=lb.ia(X.a.hWc,!1),Db=lb.ia(X.a.b4,!1);lb=lb.ia(L.a.Wfa,-1);for(let gc=0;gc<this.UL.count;gc++){var Ya=this.UL.J(gc).blob;Ya&&(Ya=Ya.properties,Ya.setValue(U.a.gha,Fa),Ya.setValue(X.a.hWc,$a),Ya.setValue(X.a.b4,Db),Ya.setValue(L.a.Wfa,lb),this.Oj.c9f(Ya,lb))}}}D4a(){}Ufj(lb){var Ya=pa.WordSectionNavigator.instance.wJ(this.Ec.Nn);if(!Ya)return lb;var Fa=I.a.Ni(ib.Sf.uB(Ya)-ib.Sf.Iva(Ya)-ib.Sf.tna(Ya),1);Ya=I.a.Ni(ib.Sf.Vt(Ya)-ib.Sf.gJ(Ya)-
ib.Sf.VK(Ya),0);V.ULS.shipAssertTag(7869449,307,0<=Fa);V.ULS.shipAssertTag(7869450,307,0<=Ya);if(lb.height>Fa){const $a=Fa/lb.height;lb.height=Fa;lb.width=Math.floor(lb.width*$a)}lb.width>Ya&&(Fa=Ya/lb.width,lb.width=Ya,lb.height=Math.floor(lb.height*Fa));return lb}tvo(){const lb=Box4Intl.Box4Strings.l_PastedImageFailedWithInvalidUrl;if(!this.Mvc||this.Mvc.message!==lb&&!this.Mvc.oha)this.Mvc=this.I6.rma(lb,!1),this.I6.aA(this.Mvc)}TLl(){if(this.yDe&&this.yDe.Dfp())return this.yDe.iep();var lb=new Sys.Net.WebRequest;
lb.set_url("PicturePaste.ashx");lb=lb.getResolvedUrl();l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")||(lb=e.a.eo(lb,Z.a.fileId,this.Fp.rr));return lb}PTo(lb,Ya){if(lb&&Ya){const Fa=I.a.xf(na.ImageReader.ND(lb.properties),0);lb=I.a.xf(na.ImageReader.dJ(lb.properties),1);0<Fa&&Fa<Ya.width&&(Ya.width=Fa,Ya.height=lb)}}Ynb(){const lb={},Ya=m.a.create().toString();lb[ib.correlationID]=Ya;l.AFrameworkApplication.Ne.sj(this.dB.J(this.uLa).url,2,this.dB.J(this.uLa).W2n,lb,!1,
2,this.picturePasteRequestSucceeded,this.Gfc,null,void 0,void 0,void 0,void 0,"26");ib.FRf++;V.ULS.sendTraceTag(572528018,307,50,"SendPicturePasteRequest PicturePaste request added to the queue with correlation id : {0}",Ya)}XXl(lb){return lb&&lb.data?lb.data.Qe:-1}nlm(){oa.a.instance.smc(this.Fp,127);this.LBh()}LBh(){V.ULS.shipAssertTag(7869458,307,this.bDj);const lb=new ua.GraphTransaction(15);lb.Cb(this.UL.J(0).node);for(let Ya=this.uLa;Ya<this.dB.count;Ya++){const Fa=this.dB.J(Ya).NAm;for(let $a=
0;$a<Fa.count;$a++){const Db=Fa.J($a).blob.properties;this.Oj.VSa(Db,Box4Intl.Box4Strings.l_PastedImageFailed);na.ImageReader.Bkj(Db)}}lb.dispose();this.Jm.y2b(this.Fp,!1);this.$zh()}Auo(){const lb=new K.StandardDialog;lb.Ad=0;lb.ix(0,Box4Intl.Box4Strings.l_MaxPicturesExceededTitle,String.format(Box4Intl.Box4Strings.l_MaxPicturesExceededMessage,sa.App.mMf),null,!0);l.AFrameworkApplication.va.processAction(Ma.a.K_i,2)}Dnn(lb,Ya){lb.alt.length>Ja.blb&&(lb.alt=lb.alt.substring(0,G.a.mz(lb.alt,Ja.blb)?
Ja.blb-1:Ja.blb));const Fa=new F.DictionaryPropertySet;this.Oj.J$d(Fa,lb.width,lb.height);Ya=this.Oj.zWd(Ya,Fa);lb=this.Ufj(lb);this.grh(Ya,lb)}$zh(){}aAh(){}bAh(){}SUd(){return!!ib.FRf}static get Sf(){return ja.a.instance}static oKm(lb){return!!lb&&!!lb.src&&!xa.a.kBi(lb.src)}}ib.qlf=1E3;ib.PFl=4;ib.WAn="PicturePasteRequestTime";ib.correlationID="X-CorrelationId";ib.FRf=0;ib.B$m=20971520;Object(E.a)(ib,"Box4ImageSteward",Ja,[480])},1935:function(E,M,c){E=c(0);var m=c(55),e=c(89),a=c(11),l=c(26);
class y extends Sys.UI.Control{constructor(I,K,J,N){super(document.createElement("div"));this.gZ=this.Pja=this.CL=this.Qv=this.m2=this.b9a=this.ubb=null;this.Dtc=this.V$a=!1;this.content=this._title=null;this.Dja=0;this.Svh=null;this.hfa=0;this.DWi=null;this.Nhh=I;this.zXb=K;this.rk=J;this.AEh=N;this.ej=K.ownerDocument;this.RUd=this.rt=this.xS=!1}get d9(){this.ubb||(this.ubb=this.ej.createElement("div"),this.ubb.id=this.kj("WACCalloutOuter"),this.ubb.className="WACCalloutOuter",this.ubb.setAttribute(l.a.qh,
l.a.wuh),this.ubb.style.width=this.Dja+"px");return this.ubb}get GEc(){if(!this.b9a){this.b9a=this.ej.createElement("div");this.b9a.id=this.kj("WACCalloutBeakContainer");this.b9a.className="WACCalloutBeakContainer";var I="CalloutBeakTopFilled_32x16x32";if(5===this.hfa||6===this.hfa||4===this.hfa)I="CalloutBeakBottomFilled_32x16x32";I=e.createClusteredImage(32,16,I,"WACCalloutBeak",!0,"");this.b9a.appendChild(I)}return this.b9a}set GEc(I){this.b9a=I}get Xw(){return this.xS}get title(){return this._title}set title(I){this._title!==
I&&(this._title=I,this.Pja&&(this.Pja.innerText=this._title))}get rt(){return this.V$a}set rt(I){this.V$a!==I&&(this.V$a=I,this.m2&&(this.m2.contains(this.CL)&&!this.V$a?this.m2.removeChild(this.CL):!this.m2.contains(this.CL)&&this.V$a&&this.hnh()))}get RUd(){return this.Dtc}set RUd(I){this.Dtc!==I&&(this.Dtc=I,this.m2&&(this.m2.contains(this.Pja)&&!this.Dtc?this.m2.removeChild(this.Pja):!this.m2.contains(this.Pja)&&this.Dtc&&this.Roh()))}show(){this.xS||(this.U8k(),this.HI(),this.zXb.appendChild(this.d9),
this.d9.style.display="Block",this.elo(),this.xS=!0,this.DWi&&this.DWi())}dismiss(){this.xS&&(this.kkl(),this.zXb.removeChild(this.d9),this.xS=!1,this.AEh&&this.AEh())}dispose(){this.dismiss();this.Pja=this.CL=this.Qv=this.b9a=this.m2=this.ubb=null;Sys.Component.prototype.dispose.call(this)}kj(I){return this.get_element().id+I}U8k(){this.m2=this.ej.createElement("div");this.m2.id=this.kj("WACCalloutHeader");this.m2.className="WACCalloutHeader";this.rt&&this.hnh();this.RUd&&this.Roh();this.Qv=this.ej.createElement("div");
this.Qv.id=this.kj("WACCalloutContent");this.Qv.className="WACCalloutContent";this.Qv.style.width=190<this.Dja?this.Dja-26+"px":"164px";this.Qv.appendChild(this.content);this.d9.appendChild(this.GEc);this.d9.appendChild(this.m2);this.d9.appendChild(this.Qv)}hnh(){this.CL=this.ej.createElement("a");this.CL.className="WACCalloutCloseAnchor";this.CL.id=this.kj("WACCalloutCloseAnchor");this.CL.href="#";this.m2.appendChild(this.CL);const I=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",
!0,CommonUIStrings.l_DialogClose);this.CL.appendChild(I)}Roh(){this.Pja=this.ej.createElement("div");this.Pja.className="WACCalloutTitle UIFontBold";this.Pja.style.width=190<this.Dja?this.Dja-30+"px":"160px";this.Pja.id=this.kj("WACCalloutTitle");this.Pja.innerText=this.title;this.m2.contains(this.CL)?this.m2.insertBefore(this.Pja,this.CL):this.m2.appendChild(this.Pja)}elo(){var I=this.Nhh;let K;if(1===this.hfa){var J=this.Svh.y+16;K=-16}else 2===this.hfa||3===this.hfa||0===this.hfa?(J=I.y+I.height+
15,K=-15):(J=I.y-this.d9.clientHeight-15-2,K=this.d9.clientHeight-1);this.d9.style.top=J+"px";this.GEc.style.top=K+"px";1===this.hfa?(I=this.Svh.x-16,this.d9.style.left="50%",this.d9.style.marginLeft=-this.Dja/2+"px",J=Sys.UI.DomElement.getBounds(this.d9),this.GEc.style.left=I-J.x+"px"):(J=I.x+this.Nhh.width/2,2===this.hfa||5===this.hfa?(I=20,J-=36):0===this.hfa||4===this.hfa?(I=this.Dja/2-16,J-=this.Dja/2):(I=this.Dja-20-32,J=J-this.Dja+36),this.d9.style.left=J+"px",this.GEc.style.left=I+"px")}HI(){this.rt&&
!this.gZ&&(this.gZ=Object(m.a)(this,this.fma,"closeHandler"),this.rk.lb(a.a.click,this.CL,this.gZ,null))}kkl(){this.rt&&this.gZ&&(this.rk.rc(a.a.click,this.CL,this.gZ),this.gZ=null)}fma(){this.dismiss();return!0}}Object(E.a)(y,"Callout",Sys.UI.Control,[1024]);class z extends y{constructor(I,K,J,N,R,O=null){super(I,J,R.f1,O);this.D6g=0;this.Dja=this.E1l(N);this.UZb=K;this.Ui=R;this.HHo=7;this.Lq=this.UZb.ownerDocument.createElement("div");this.Lq.className="ModalCalloutControlOverlay";this.Lq.tabIndex=
0;this.UZb.insertBefore(this.Lq,this.UZb.firstChild)}show(){this.Xw||(this.Ui.I$d(),this.Ui.ifa(!1),this.Lq.style.zIndex=String(this.Ui.YBa),super.show(),this.wz(),this.D6g=window.setTimeout(Object(m.a)(this,this.dismiss,"dismiss"),1E3*this.HHo))}dismiss(){this.Xw&&(this.Ui.cba(!1),this.X9(),this.UZb&&this.UZb.contains(this.Lq)&&this.UZb.removeChild(this.Lq),super.dismiss(),window.clearTimeout(this.D6g))}wz(){this.Ui.VZ(Object(m.a)(this,this.dismiss,"dismiss"));this.Ui.fD.lb(a.a.click,this.Lq,Object(m.a)(this,
this.onClick,"onClick"))}X9(){this.Ui.Jca(Object(m.a)(this,this.dismiss,"dismiss"));this.Ui.fD.rc(a.a.click,this.Lq,Object(m.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}E1l(I){let K=0;switch(I){case 0:K=190;break;case 1:K=250;break;case 2:K=300;break;case 3:K=360}return K}}Object(E.a)(z,"ModalCallout",y,[]);var n=c(7),v=c(530),A=c(176);class w extends z{constructor(I,K,J,N,R,O=null){super(I,K,J,N,R,O);this.GS=null}show(){if(!this.Xw){const I=Object.assign(new v.a,{onShow:()=>
{z.prototype.show.call(this)}});A.UISurfaces.tM().then(K=>{const J=K.externalNotification();this.GS=K.addNotification(J,I);return null},K=>{n.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",K);return null})}}dismiss(){this.Xw&&this.GS&&(A.UISurfaces.tM().then(I=>{I.removeNotification(this.GS);return this.GS=null},I=>{n.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",I);return null}),super.dismiss())}}Object(E.a)(w,"ReactManagedModalCallout",
z,[]);var G=c(2);c.d(M,"a",function(){return F});class F{static xLh(I,K,J,N){return G.AFrameworkApplication.ta.Nb.oQa?new w(I,K,J,N,G.AFrameworkApplication.ta,null):new z(I,K,J,N,G.AFrameworkApplication.ta,null)}}Object(E.a)(F,"ModalCalloutControlFactory",null,[])},1939:function(E,M,c){E=c(0);var m=c(53),e=c(123),a=c(19),l=c(2),y=c(82);class z{constructor(F,I){this.value=F;this.fHl=I}get zYd(){return this.fHl}}Object(E.a)(z,"ElementValueWrapper",null,[]);class n extends z{constructor(F,I,K){super(F,
I);this.aAi=K}}Object(E.a)(n,"DimensionWrapper",z,[]);var v=c(1671),A=c(1672),w=c(7);c.d(M,"a",function(){return G});class G{static get Sni(){return G.a5j}static get yke(){return G.tkk}static get wke(){return G.skk}static qvf(F,I,...K){I=G.Eii(I);let J=!1;I||(I=G.Mgm(F,...K),J=!!I);return new z(I,J)}static Eii(F){for(const I of F)if(void 0!==I&&null!==I&&""!==I)return I.trim();return null}static Mgm(F,...I){for(const K of I)if(I=F.getAttribute(K),void 0!==I&&null!==I&&(I+="",void 0!==I&&null!==I&&
""!==I))return I.trim();return null}static M6l(F,I){I=parseFloat(I);if(isNaN(I))return 0;switch(F){case "px":return Math.round(I);case "pt":return Math.round(m.a.E0(I,0,!1));case "in":return Math.round(m.a.Gba(I,0,!1));case "cm":return Math.round(m.a.Gba(e.a.FBh(I),0,!1));case "mm":return Math.round(m.a.Gba(e.a.FBh(.1*I),0,!1));default:return I}}static cee(F,I,...K){F=G.qvf(F,I,...K);K=0;I=!1;if(F.value){I=F.value.endsWith("%");let J;I?(K="%",J=a.a.substring(F.value,0,F.value.length-1)):F.zYd?(K=
"px",J=F.value):(K=F.value.substr(F.value.length-2),isNaN(parseFloat(K))?J=a.a.substring(F.value,0,F.value.length-2):(K="px",J=F.value));K=G.M6l(K,J)}return new n(K,F.zYd,I)}static Sii(F){return G.cee(F,[F.style.width],"width","WIDTH","Width")}static t9h(F){return G.cee(F,[F.style.height],"height","HEIGHT","Height")}static gJ(F){return G.cee(F,[F.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")}static VK(F){return G.cee(F,[F.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static Qgm(F){F=
G.qvf(F,[F.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return F.value&&F.value in G.yke&&void 0!==G.yke[F.value]&&null!==G.yke[F.value]?G.yke[F.value]:0}static zRm(F){F=G.Eii([F.style.borderCollapse]);return!!F&&!(void 0===F||null===F)&&("collapse"===F||"COLLAPSE"===F||"Collapse"===F)}static NLl(F){return G.qvf(F,[F.style.backgroundColor,F.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static D5k(F){const I=a.a.substring(F,0,1),K=a.a.substring(F,1,2);F=a.a.substring(F,
2,3);return I+I+K+K+F+F}static pua(F){let I="";if(!F||""===F)return I;I=F.trim();if(I.startsWith("rgb")){I=a.a.substring(I,I.indexOf("(")+1,I.length-1);F=I.split(",");if(3!==F.length)return"";I="";for(let J=0;J<F.length;J++){var K=parseInt(F[J]);if(isNaN(K)||0>K||255<K)return"";K=K.toString(16);1===K.length&&(K="0"+K);I+=K}return a.a.QA(I)}if(G.Sni[a.a.Tg(I)])return G.Sni[a.a.Tg(I)];I.startsWith("#")&&(I=a.a.substring(I,1,I.length));if(isNaN(parseInt(I,16)))return"";3===I.length&&(I=G.D5k(I));return 6!==
I.length?"":I}static Qyn(F){var I=F.indexOf("mso-tab-count");if(-1===I)return 0;const K=RegExp("([\\d])");let J="";for(I=I+13+1;I<F.length;I++){const N=F.charAt(I).toString();if(K.test(N))J+=N;else break}F=0;""!==J&&(F=parseInt(J));return F}static lUd(F,I){const K=G.NLl(F);K&&""!==K&&I.dv(J=>J.D9(G.pua(K)))}static H4h(F){var I,K=F.style;if(!K)return null;let J=G.wke[K.borderTopStyle];const N=G.pua(K.borderTopColor);let R=K.borderTopWidth,O=G.wke[K.borderRightStyle];const L=G.pua(K.borderRightColor);
let U=K.borderRightWidth,W=G.wke[K.borderBottomStyle];const X=G.pua(K.borderBottomColor);let V=K.borderBottomWidth,Z=G.wke[K.borderLeftStyle];const da=G.pua(K.borderLeftColor);K=K.borderLeftWidth;l.AFrameworkApplication.ue("gdea6103;0df65435");if(null===(I=l.AFrameworkApplication.K)||void 0===I?0:I.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))F=F.getAttribute("border"),null!==F&&(J=this.wic(F,J),W=this.wic(F,W),Z=this.wic(F,Z),O=this.wic(F,O),R=this.xic(F,R),
U=this.xic(F,U),V=this.xic(F,V),K=this.xic(F,K),w.ULS.sendTraceTag(509125330,3022,50,"getCellBorders: Table Border Attribute found and fixed"));return new v.a(J,O,W,Z,N,L,X,da,R,U,V,K)}static xic(F,I){return""===I?F+"px":I}static wic(F,I){return 0===I?"0"===F?1:11:I}static GNl(F){var I=F.querySelectorAll("[class^=TableCellContent]");I=1===I.length?I[0]:void 0;return(F=(null===I||void 0===I?0:I.style)?I.style:F.style)?new A.a(F.paddingTop,F.paddingRight,F.paddingBottom,F.paddingLeft):null}}G.a5j=y.a.v5("aliceblue",
"F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood","DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9",
"darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B","darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia",
"FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo","4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3",
"lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00","limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise",
"48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500","orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080",
"red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD","slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5",
"yellow","FFFF00","yellowgreen","9ACD32");G.tkk=y.a.v5("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);G.skk=y.a.v5("",0,"initial",3,"inherit",11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(E.a)(G,"DefaultHtmlTranslatorHelper",null,[])},1942:function(E,M,c){E=c(0);class m{constructor(a){this.next=null;this.data=a}}Object(E.a)(m,
"QueueNode",null,[]);c.d(M,"a",function(){return e});class e{constructor(){this.otb=this.orb=null;this.aj=0}get count(){return this.aj}get isEmpty(){return!this.count||!this.orb||!this.otb}enqueue(a){a=new m(a);this.isEmpty?this.otb=this.orb=a:this.orb=this.orb.next=a;this.aj=this.count+1}back(){return this.isEmpty?null:this.orb.data}dequeue(){if(this.isEmpty)return null;const a=this.otb;this.otb=a.next;this.aj=this.count-1;this.otb||(this.orb=null);return a.data}clear(){this.otb=this.orb=null;this.aj=
0}toArray(){const a=Array(this.count);let l=this.otb;for(let y=0;y<this.count&&l;y++)a[y]=l.data,l=l.next;return a}}Object(E.a)(e,"Queue",null,[])},1997:function(E,M,c){c.d(M,"b",function(){return m});c.d(M,"e",function(){return e});c.d(M,"d",function(){return a});c.d(M,"c",function(){return l});c.d(M,"h",function(){return y});c.d(M,"a",function(){return z});c.d(M,"f",function(){return n});c.d(M,"g",function(){return v});var m;(function(A){A[A.Unspecified=0]="Unspecified";A[A.Inline=1]="Inline";A[A.Floating=
2]="Floating"})(m||(m={}));var e;(function(A){A[A.Undefined=0]="Undefined";A[A.Bullet=1]="Bullet";A[A.Numbered=2]="Numbered";A[A.Lim=3]="Lim";A[A.Nil=4]="Nil";A[A.Any=5]="Any";A[A.NoList=6]="NoList";A[A.Invalid=7]="Invalid"})(e||(e={}));var a;(function(A){A[A.DontCare=1]="DontCare";A[A.Thin=2]="Thin";A[A.ExtraLight=3]="ExtraLight";A[A.Light=4]="Light";A[A.Normal=5]="Normal";A[A.Medium=6]="Medium";A[A.SemiBold=7]="SemiBold";A[A.Bold=8]="Bold";A[A.ExtraBold=9]="ExtraBold";A[A.Heavy=10]="Heavy"})(a||
(a={}));var l;(function(A){A[A.NoCaps=0]="NoCaps";A[A.SmallCaps=1]="SmallCaps";A[A.AllCaps=2]="AllCaps";A[A.AllPetiteCaps=3]="AllPetiteCaps";A[A.PetiteCaps=4]="PetiteCaps";A[A.Unicase=5]="Unicase";A[A.Titling=6]="Titling";A[A.Other=7]="Other"})(l||(l={}));var y;(function(A){A[A.None=0]="None";A[A.Words=1]="Words";A[A.SingleLine=2]="SingleLine";A[A.DoubleLine=3]="DoubleLine";A[A.HeavyLine=4]="HeavyLine";A[A.DottedLine=5]="DottedLine";A[A.DottedHeavyLine=6]="DottedHeavyLine";A[A.DashLine=7]="DashLine";
A[A.DashHeavyLine=8]="DashHeavyLine";A[A.DashLongLine=9]="DashLongLine";A[A.DashLongHeavyLine=10]="DashLongHeavyLine";A[A.DotDashLine=11]="DotDashLine";A[A.DotDashHeavyLine=12]="DotDashHeavyLine";A[A.DotDotDashLine=13]="DotDotDashLine";A[A.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";A[A.WavyLine=15]="WavyLine";A[A.WavyHeavyLine=16]="WavyHeavyLine";A[A.WavyDoubleLine=17]="WavyDoubleLine"})(y||(y={}));var z;(function(A){A[A.Left=0]="Left";A[A.Right=1]="Right";A[A.Center=2]="Center";A[A.Justified=
3]="Justified";A[A.Other=4]="Other";A[A.None=5]="None";A[A.JustifyLow=6]="JustifyLow";A[A.Distributed=7]="Distributed";A[A.ThaiDistributed=8]="ThaiDistributed"})(z||(z={}));var n;(function(A){A[A.Image=0]="Image";A[A.TextBox=1]="TextBox";A[A.Chart=2]="Chart";A[A.SmartArt=3]="SmartArt";A[A.Drawing=4]="Drawing";A[A.EquationObject=5]="EquationObject";A[A.Ink=6]="Ink";A[A.InkSpace=7]="InkSpace";A[A.InkEndOfLine=8]="InkEndOfLine";A[A.LineBreak=9]="LineBreak";A[A.PageBreak=10]="PageBreak";A[A.PageNumbers=
11]="PageNumbers";A[A.FootnoteEndnote=12]="FootnoteEndnote";A[A.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";A[A.Tab=14]="Tab";A[A.UnsupportedObject=15]="UnsupportedObject";A[A.Other=16]="Other"})(n||(n={}));var v;(function(A){A[A.Initial=0]="Initial";A[A.FirstLine=1]="FirstLine";A[A.Hanging=2]="Hanging"})(v||(v={}))},1999:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);var m;(function(e){e[e.normal=0]="normal";e[e.beingCreated=1]="beingCreated";e[e.beingEdited=2]="beingEdited"})(m||
(m={}));Object(E.b)("CommentType",m)},2001:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{static Nqf(e){return e===m.create?0:e===m.reply?1:e===m.edit?2:e===m.metadata?3:null}}m.create="CREATE";m.reply="REPLY";m.edit="EDIT";m.metadata="METADATA";Object(E.a)(m,"CommentSessionType",null,[])},2002:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);var m;(function(e){e[e.unsaved=0]="unsaved";e[e.sentToServer=1]="sentToServer";e[e.succeeded=2]="succeeded";e[e.failed=3]="failed";e[e.saveNotNeeded=
4]="saveNotNeeded"})(m||(m={}));Object(E.b)("CommentSaveStatus",m)},2003:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a){this.className=e;this.bQc=a}}Object(E.a)(m,"HighlightCssClassPair",null,[])},2004:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.type=this.action=0;this.BJ=this.sA=null}}Object(E.a)(m,"HighlightOperation",null,[])},2005:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);M=c(231);var m=c(109);class e extends M.a{constructor(){super();
this.LastKnownPaginationRevision=this.FileId=null}$k(){return 36}static Paa(a,l){const y=new e;y.FileId=a;y.LastKnownPaginationRevision=m.a(l);return y}}Object(E.a)(e,"PaginationRequest",M.a,[])},2007:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{LEb(e,a){let l="g";a.matchCase||a.B3d||(l+="i");if(a.matchPrefix||a.matchWholeWord)e="\\b"+e;if(a.matchSuffix||a.matchWholeWord)e+="\\b";return new RegExp(e,l)}static get instance(){return m._instance||(m._instance=new m)}}m._instance=null;
Object(E.a)(m,"FindUtils",null,[1131])},2009:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a){this._text=e;this.Psc=a}get text(){return this._text}get matchCase(){return this.AHb(1)}get matchWholeWord(){return this.AHb(2)}get B3d(){return this.AHb(4)}get matchPrefix(){return this.AHb(8)}get matchSuffix(){return this.AHb(16)}get ignorePunct(){return this.AHb(32)}get ignoreSpace(){return this.AHb(64)}AHb(e){return(this.Psc&e)===e}static createQuery(e,a){return new m(e,
a)}}Object(E.a)(m,"Query",null,[1129])},2010:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);var m;(function(e){e[e.none=0]="none";e[e.matchCase=1]="matchCase";e[e.wholeWordOnly=2]="wholeWordOnly";e[e.wildCards=4]="wildCards";e[e.prefix=8]="prefix";e[e.suffix=16]="suffix";e[e.ignorePunct=32]="ignorePunct";e[e.ignoreSpace=64]="ignoreSpace"})(m||(m={}));Object(E.b)("QueryFilters",m)},2011:function(E,M,c){c.d(M,"a",function(){return z});E=c(0);var m=c(174),e=c(166),a=c(2),l=c(65),y=c(199);class z extends m.a{constructor(n,
v=!1){super(n,!1,v)}get EUc(){return!1}get NK(){return y.a.iJc+"/modeless"}get Akb(){return null}set Akb(n){}get wkb(){return null}set wkb(n){}Wh(n,v=null,A=null){this.bT&&(A.isModal=!1);super.Wh(n,v,A)}hide(){if(a.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Jc)this.kFj(),a.AFrameworkApplication.ta.jx.Rw(e.AFrame.pNf),super.hide()}lrk(){const n=a.AFrameworkApplication.ta.jx,v=a.AFrameworkApplication.ta.Bp;n.uaa(this.NK);
n.dT(this.NK);v.ge(this.NK).parent=e.AFrame.rp}bCa(){l.FocusManager.SJ()&&(super.bCa(),this.lrk(),a.AFrameworkApplication.ta.jx.CI(e.AFrame.pNf))}X4f(){if(l.FocusManager.SJ()&&!a.AFrameworkApplication.Lk){const n=l.FocusManager.instance();n.yR(this.NK);const v=n.getRegion(this.NK);v&&v.Zj.Gy(null);n.B5a(this.NK)}}Fca(){"DL"===this.SBa||"DP"===this.SBa?super.Fca():a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WacAutoFitNonModalDialogIsEnabled")?(this.kFj(),this.Fvh()&&this.ssj(this.Jc.clientHeight,
this.Jc.clientWidth)):this.qL()}qL(){this.ssj(m.a.XQg,m.a.dRg)}ssj(n,v){if(this.wkb&&this.Akb){let A,w;A=y.a.y$d+this.Akb;w=y.a.x$d+this.wkb;A+n>this.uB()&&(A=this.uB()-n);w+v>this.Vt()&&(w=this.Vt()-v);this.tsj(A,w)}else super.qL()}csf(n){if(!n)return null;n.endsWith("px")&&(n=n.substring(0,n.length-2));return y.a.Qac(n)?((n=parseInt(n))||(n=1),n):null}kFj(){if(this.Jc&&this.Jc.style){var n=this.csf(this.Jc.style.top);n&&(this.Akb=n-y.a.y$d);if(n=a.AFrameworkApplication.isRtl?this.csf(this.Jc.style.right):
this.csf(this.Jc.style.left))this.wkb=n-y.a.x$d}}}Object(E.a)(z,"ModelessCustomDialog",m.a,[])},2012:function(E,M,c){c.d(M,"a",function(){return A});E=c(0);var m=c(7),e=c(2),a=c(311),l=c(197),y=c(638),z=c(760),n=c(761),v=c(19);class A{constructor(w,G=null,F=-1,I=null){this.U6=w;this.Lkh=I||(()=>G);this.Ygd=F}sj(w,G,F,I,K,J,N,R,O,L=null,U=!1,W=null,X=null){const V=new XMLHttpRequest;let Z="";J="";2===G?(Z="POST",F&&(J=F)):Z="GET";G={};this.U6&&(w=a.a.HYe(G,w,a.a.goe,e.AFrameworkApplication.SQb,this.U6));
V.open(Z,w,!0);this.hNk(G,w);if(I)for(let aa in I)V.setRequestHeader(aa,v.a.TQ(I[aa]));for(let aa in G)V.setRequestHeader(aa,G[aa]);w=W||this.Ygd;0<w&&(V.timeout=w);w=[];Array.add(w,a.a.F7);I=new Sys.Net.WebRequest;const da=new z.a(1,2,I,w,K,N,R,O,U,L,X);V.onreadystatechange=()=>{this.uqn(V,da)};try{V.send(J)}catch(aa){m.ULS.sendTraceTag(24938643,205,15,"Invoke failed in SimpleClientRequestSender")}return 1}k8b(){return 1}uqn(w,G){if(this.eVk(w,G)&&4===w.readyState)if(w.getResponseHeader(a.a.vVh)&&
e.AFrameworkApplication.xKc)e.AFrameworkApplication.xKc();else{var F=w.getResponseHeader(a.a.GAh);a.a.Ilg(F);this.RVo(w,G);w.status===l.a.Hy?(G.status=2,G.aI(new n.a(G))):(G.status=w.status&&w.status!==l.a.ehc?w.status===l.a.nia?5:3:7,G.D3(new y.a(G)))}}hNk(w,G){w["X-xhr"]=1;e.AFrameworkApplication.a3a&&(w[a.a.NIi]=1);e.AFrameworkApplication.buildVersion&&(w[a.a.gec]=v.a.TQ(e.AFrameworkApplication.buildVersion));let F=null;this.Lkh&&(F=this.Lkh());F&&(w[a.a.vog]=F);e.AFrameworkApplication.canary&&
(w[a.a.W1b]=v.a.TQ(e.AFrameworkApplication.canary),e.AFrameworkApplication.LXc&&m.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",w[a.a.W1b]));e.AFrameworkApplication.accessToken&&(a.a.mAb(G,e.AFrameworkApplication.a7)||(w[a.a.HXe]=v.a.TQ(e.AFrameworkApplication.accessToken)),a.a.mAb(G,e.AFrameworkApplication.XBa)||(w[a.a.IXe]=e.AFrameworkApplication.GMa.toString()));e.AFrameworkApplication.userType&&(w[a.a.RHj]=v.a.TQ(e.AFrameworkApplication.userType))}RVo(w,G){G.Qe=w.status?w.status:l.a.ehc;
try{G.xe=w.responseText;if(void 0!==G.CSa&&null!==G.CSa){G.vj={};for(let F=0;F<G.CSa.length;++F){const I=G.CSa[F];G.vj[I]=w.getResponseHeader(I)}}G.Mhe&&(G.Aia=w.responseText&&w.responseText.length?w.responseXML:null)}catch(F){m.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",G.id,G.request.get_url(),4===w.readyState)}}eVk(w,G){return w?G?!0:(m.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),
!1):(m.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(w,G,F){return new A(w,null,F,G)}}Object(E.a)(A,"SimpleClientRequestSender",null,[863])},2013:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);var m;(function(e){e[e.connected=0]="connected";e[e.disconnected=1]="disconnected";e[e.connecting=2]="connecting";e[e.timeout=3]="timeout"})(m||(m={}));Object(E.b)("AppNetworkConnectivityState",m)},2014:function(E,
M,c){c.d(M,"a",function(){return m});E=c(0);class m{uOa(){}a6b(){}jhe(){}Ffe(){}reset(){}ekf(){}update(){}pob(){}dispose(){}}Object(E.a)(m,"FindStatusManagerStub",null,[275,9])},2022:function(E,M,c){c.d(M,"b",function(){return m});c.d(M,"a",function(){return e});var m;(function(a){a[a.None=0]="None";a[a.BetweenLeftAndRightMargin=1]="BetweenLeftAndRightMargin";a[a.BetweenLeftAndRightEdge=2]="BetweenLeftAndRightEdge";a[a.FitToBox=3]="FitToBox"})(m||(m={}));var e;(function(a){a.left="left";a.center=
"center";a.right="right";a.both="both"})(e||(e={}))},2040:function(E,M,c){E=c(0);var m=c(1591),e=c(1592),a=c(1654),l=c(223),y=c(35);class z{}z.eventType="Type";z.jgb="Time";z.eventId="Id";z.mvh="AttributionId";z.nvh="AttributionProvider";z.lvh="AttributionName";z.Wuh="AssigneeId";z.Xuh="AssigneeProvider";z.Vuh="AssigneeName";z.startDate="Start";z.endDate="End";z.title="Title";z.yFh="Anchor";z.anchorExtensionList="AnchorExtensionList";z.S_i="Percent";z.priority="Priority";z.undoId="UndoId";z.isLossy=
"IsLossy";z.recordExtensionList="RecordExtensionList";Object(E.a)(z,"Key",null,[]);var n=c(365),v=c(1794);const A=G=>{if(!G)return null;let F=null;G=n.a.x3b(G,I=>I.toString(),I=>I.toString());0<G.count&&(F=new v.a(G));return F};c.d(M,"a",function(){return w});class w{r$f(G){if(!G)return"[]";G=w.t5k(G);return y.c(G)}u4b(G){G=y.b(G||"[]");return w.c5k(G)}static rda(G,F){throw Error.argument(G,F);}static R7b(G,F){F=F.toString();return F in G?G[F].toString():null}static UEb(G,F){F=F.toString();F in G||
w.rda("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",F));return G[F].toString()}static Qqf(G,F){F=F.toString();F in G||w.rda("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",F));return Number.parseInvariant(G[F].toString())}static f4l(G,F,I){F=F.toString();return F in G?Boolean.parse(G[F].toString()):I}static g4l(G,F){F=F.toString();return F in G?G[F]:null}static rgg(G){G=new Date(G);isNaN(G.getUTCMilliseconds())&&w.rda("dateTime",
"Date and time is in invalid format");return G}static Ccf(G){return G.toISOString()}static LKh(G,F){return A(w.g4l(G,F))}static u5k(G){const F={};F[z.eventType]=G.type;F[z.jgb]=w.Ccf(G.time);F[z.eventId]=G.recordId;G.isLossy!==w.fyi&&(F[z.isLossy]=G.isLossy);G.user&&(G.user.UserId&&G.user.Provider&&G.user.DisplayName||w.rda("record","HistoryRecord has invalid attribution"),F[z.mvh]=G.user.UserId,F[z.nvh]=G.user.Provider,F[z.lvh]=G.user.DisplayName);G.commentId&&(F[z.yFh]=G.commentId);if(G.anchorExtensionList&&
G.anchorExtensionList.extensions){var I=G.anchorExtensionList.extensions.qlc();F[z.anchorExtensionList]=I}G.recordExtensionList&&G.recordExtensionList.extensions&&(I=G.recordExtensionList.extensions.qlc(),F[z.recordExtensionList]=I);switch(G.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:G.assignee&&G.assignee.UserId&&G.assignee.Provider&&G.assignee.DisplayName||w.rda("record","HistoryRecord has invalid assignee");F[z.Wuh]=G.assignee.UserId;F[z.Xuh]=G.assignee.Provider;F[z.Vuh]=G.assignee.DisplayName;
break;case 5:G.schedule||w.rda("record","Schedule history record must have a schedule object");G.schedule.startDate&&(F[z.startDate]=w.Ccf(G.schedule.startDate));G.schedule.endDate&&(F[z.endDate]=w.Ccf(G.schedule.endDate));break;case 6:(0>G.completion||100<G.completion)&&w.rda("record","Progress history record must have a completion >= 0 and <= 100");F[z.S_i]=G.completion;break;case 10:(0>G.priority||10<G.priority)&&w.rda("record","Priority history record must have a completion >= 0 and <= 10");F[z.priority]=
G.priority;break;case 9:G.title||w.rda("record","SetTitle history record must have a title");F[z.title]=G.title;break;case -1:G.undoId||w.rda("record","Undo history record must have an id to undo");F[z.undoId]=G.undoId;break;default:w.rda("record","Unsupported history record type")}return F}static C5k(G){var F=null,I=w.R7b(G,z.mvh);const K=w.R7b(G,z.nvh),J=w.R7b(G,z.lvh);if(I||K||J)I&&K&&J||w.rda("dictionary","Record has invalid attribution user"),F=new m.a(I,K,J);F=new e.a(w.Qqf(G,z.eventType),F,
w.rgg(w.UEb(G,z.jgb)),w.UEb(G,z.eventId));F.commentId=w.R7b(G,z.yFh);F.anchorExtensionList=w.LKh(G,z.anchorExtensionList);F.recordExtensionList=w.LKh(G,z.recordExtensionList);F.isLossy=w.f4l(G,z.isLossy,w.fyi);switch(F.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:F.assignee=new m.a(w.UEb(G,z.Wuh),w.UEb(G,z.Xuh),w.UEb(G,z.Vuh));break;case 5:F.schedule=new a.a;if(I=w.R7b(G,z.startDate))F.schedule.startDate=w.rgg(I);if(G=w.R7b(G,z.endDate))F.schedule.endDate=w.rgg(G);break;case 10:F.priority=
w.Qqf(G,z.priority);(0>F.priority||10<F.priority)&&w.rda("dictionary","Priority record must have history >= 0 and <= 10");break;case 6:F.completion=w.Qqf(G,z.S_i);(0>F.completion||100<F.completion)&&w.rda("dictionary","Progress record must have history >= 0 and <= 100");break;case 9:F.title=w.UEb(G,z.title);break;case -1:F.undoId=w.UEb(G,z.undoId);break;default:w.rda("dictionary","Unsupported history record type")}return F}static t5k(G){const F=Array(G.length);for(let I=0;I<G.length;++I)F[I]=w.u5k(G.J(I));
return F}static c5k(G){const F=new l.a;for(const I of G)G=w.C5k(I),F.add(G);return F}}w.fyi=!1;Object(E.a)(w,"JsonTaskHistorySerialization",null,[634])},2042:function(E,M,c){E=c(0);class m{constructor(l){this.result=null;this.E7i=l}exec(l){return(this.result=this.E7i.exec(l))?!0:!1}eJ(){return this.result.index}bQd(){return this.E7i.lastIndex}}Object(E.a)(m,"RegularExpressionWrapper",null,[]);var e=c(19);c.d(M,"a",function(){return a});class a{Yfc(l){return this.Dtj(l).join("").replace(RegExp("(\\\\.\\\\.\\\\.)",
"g"),"(\\.\\.\\.|\u2026)")}S1i(l){var y=l.text;y=l.B3d?this.azo(y):this.Dtj(y);if(l.ignorePunct||l.ignoreSpace){let z="";l.ignoreSpace&&(z+="\\s");l.ignorePunct&&(z+=a.PIn);z="["+z+"]*";for(let n=1;n<y.length;n++)if(!l.B3d||"{"!==y[n].charAt(0)&&"@"!==y[n].charAt(0))y[n]=z+y[n]}return y.join("")}Hmb(l){return[l]}O_d(l){for(let y=0;y<l.length;++y){const z=l.charAt(y);let n=0;if("["===z){if(!({JD:n}=this.WQm(l.substr(y))).returnValue)return!1;y=n+y-1}else if("<"===z){if(!this.TQm(l.substr(y)))return!1}else if(">"===
z){if(!y)return!1}else if("{"===z){if(!y||!({JD:n}=this.VQm(l.substr(y))).returnValue)return!1;y=n+y-1}else if("@"===z){if(!y||!this.UQm(l.substr(y)))return!1}else if("("===z){if(!({JD:n}=this.SQm(l.substr(y))).returnValue)return!1;y=n+y-1}else if("}"===z||"]"===z||")"===z)return!1}return!0}f_h(l,y){let z,n;n=z=0;if(l.length<=y)return{returnValue:!1,JD:z,Qbd:n};const v=l.length;var A=l.charAt(y);if("["===A)for(A=y+1;A<v;A++){if("]"===l.charAt(A)&&1!==A-y)return z=A,n=5,{returnValue:!0,JD:z,Qbd:n}}else if("{"===
A)for(A=-1,y+=1;y<v;y++){let w=l.charAt(y);if(","===w)A=y;else if("}"===w)return n=-1===A?6:1!==y-A?7:8,z=y,{returnValue:!0,JD:z,Qbd:n}}return{returnValue:!1,JD:z,Qbd:n}}HNo(l,y,z){let n;if((n=y)||1!==l.length)switch(l.charAt(y+1)){case "{":let v,A;if(!({JD:v,Qbd:A}=this.f_h(l,y+1)).returnValue)return{returnValue:this.wIa("*",z,!1),JD:n};l=this.wIa("*",z,!0)+this.wIa(l.substring(y+1,v+1),A);n=v;if(7===A||8===A)l+="?";return{returnValue:l,JD:n};case "@":return n=y+1,{returnValue:this.wIa("*",z,!0),
JD:n};case "*":if(!y){for(n++;"*"===l.charAt(n);)n++;if(n===l.length)return{returnValue:this.wIa("*",z,!0),JD:n}}return{returnValue:this.wIa("*",z,!1),JD:n};default:return{returnValue:this.wIa("*",z,!1),JD:n}}else return{returnValue:this.wIa(l,z,!0),JD:n}}wIa(l,y,z=!1){const n=l.length;switch(y){case 5:return"!"===l.charAt(1)&&2<n?"([^"+this.T1i(l.substr(2,n-3))+"]\u0640*)":"(["+this.T1i(l.substr(1,n-2))+"]\u0640*)";case 6:return l;case 7:return l;case 9:return"+?";case 8:return l;case 3:return"\\b";
case 4:return"\\b";case 1:return".";case 2:return z?"(.+?)":"(.*?)";case 10:return l}return null}Uii(l){switch(l){case "?":return 1;case "*":return 2;case "<":return 3;case ">":return 4;case "@":return 9}return 0}uDn(l){return"["===l||"]"===l||"\\"===l||"("===l||")"===l?String.format("\\{0}",l):"'"===l||"\u2018"===l||"\u2019"===l||'"'===l||"\u201c"===l||"\u201d"===l||e.a.$ba(l)?this.W_f(l):l}T1i(l){const y=[];for(let z=0;z<l.length;++z)y[z]=this.uDn(l.charAt(z));return y.join("")}WQm(l){let y;var z;
y=-1;var n=new m(RegExp("\\[.+?\\]","g"));if(n.exec(l)){if(z=n.eJ())return{returnValue:!1,JD:y};y=n.bQd()}else return{returnValue:!1,JD:y};if((new m(RegExp("(\\(\\))|(.+?!)","g"))).exec(l.substring(1,y-1)))return{returnValue:!1,JD:y};z=new m(RegExp("[^!\\[]-[^\\]]","g"));for(l.substring(0,y);z.exec(l.substring(0,y));){n=z.eJ();const v=RegExp("[-]","g");n=l.substring(n,z.bQd()).split(v);if(n[0].charAt(0)>n[1].charAt(0))return{returnValue:!1,JD:y}}return{returnValue:!0,JD:y}}TQm(l){return(new m(RegExp("\\<(\\{|\\@|\\>|\\<|\\}|\\))",
"g"))).exec(l)?!1:!0}VQm(l){let y;y=-1;var z;if((new m(RegExp("(\\}\\{)|(\\}\\@)","g"))).exec(l))return{returnValue:!1,JD:y};const n=new m(RegExp("\\{\\d+(,|(,\\d+))?\\}","g"));if(n.exec(l)){if(z=n.eJ())return{returnValue:!1,JD:y};y=n.bQd();z=RegExp("[{,}]","g");z=l.substring(0,y).split(z);if(4===z.length&&(l=Number.parseInvariant(z[1]),z=Number.parseInvariant(z[2]),l>=z))return{returnValue:!1,JD:y}}else return{returnValue:!1,JD:y};return{returnValue:!0,JD:y}}UQm(l){return(new m(RegExp("\\@\\{","g"))).exec(l)?
!1:!0}SQm(l){let y;y=-1;let z;const n=new m(RegExp("\\(([^\\[\\]]*?(\\[.+?\\])?)+?\\)","g"));if(n.exec(l)){z=n.eJ();y=n.bQd();if(z)return{returnValue:!1,JD:y};if(this.O_d(l.substring(1,y-1)))return{returnValue:!0,JD:y}}return{returnValue:!1,JD:y}}azo(l){const y=[],z=l.length;let n=0;for(let v=0;v<z;++v){const A=n,w=l.charAt(v);let G=0,F=0;"["===w||"\\"===w||"^"===w||"$"===w||"."===w||"|"===w||"+"===w||"("===w||")"===w||"?"===w||"*"===w||"<"===w||">"===w||"@"===w||"?"===w||"{"===w?"["!==w&&"{"!==w||
!({JD:G,Qbd:F}=this.f_h(l,v)).returnValue?"?"===w||"<"===w||">"===w||"@"===w?(F=this.Uii(w),y[A]=this.wIa(w,F)):"*"===w?(F=this.Uii(w),y[A]=({JD:G}=this.HNo(l,v,F)).returnValue,v=G):"("===w||")"===w?(F=10,y[A]=this.wIa(w,F)):y[A]=String.format("\\{0}",w):(y[A]=this.wIa(l.substr(v,G+1-v),F),v=G):y[A]="'"===w||"\u2018"===w||"\u2019"===w||'"'===w||"\u201c"===w||"\u201d"===w||"-"===w||"\u2013"===w||"\u2014"===w||e.a.$ba(w)?"["+this.W_f(w)+"]":"\u2026"===w?"\\.\\.\\.":w;""!==y[A]&&0===F&&(y[A]=v<l.length-
1&&("@"===l.charAt(v+1)||"{"===l.charAt(v+1))?"("+y[A]+"\u0640*)":y[A]+"\u0640*");n++}return y}Dtj(l){const y=[];for(let z=0;z<l.length;++z){const n=l.charAt(z);y[z]="["===n||"\\"===n||"^"===n||"$"===n||"."===n||"|"===n||"+"===n||"("===n||")"===n||"?"===n||"*"===n?String.format("\\{0}",n):"'"===n||"\u2018"===n||"\u2019"===n||'"'===n||"\u201c"===n||"\u201d"===n||"-"===n||"\u2013"===n||"\u2014"===n||e.a.$ba(n)?"["+this.W_f(n)+"]":"\u2026"===n?"\\.\\.\\.":n;""!==y[z]&&(y[z]+="\u0640*")}return y}W_f(l){return"'"===
l||"\u2018"===l||"\u2019"===l?"'\u2018\u2019":'"'===l||"\u201c"===l||"\u201d"===l?'"\u201c\u201d':"-"===l||"\u2013"===l||"\u2014"===l?"-\u2013\u2014":e.a.$ba(l)?a.KOo:l}static get instance(){return a._instance||(a._instance=new a)}}a._instance=null;a.KOo=" \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000";a.PIn='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d\u201c';Object(E.a)(a,"WordQueryProcessor",null,[945])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19580616/wdjs/WordEditorDS.common.js.map