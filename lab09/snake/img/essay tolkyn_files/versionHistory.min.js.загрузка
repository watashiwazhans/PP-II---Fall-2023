(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[217],{2768:function(e,t,o){"use strict";o.r(t);var r,n,i,s=o(5);!function(e){e[e.None=0]="None",e[e.VHUnknown=1]="VHUnknown",e[e.VHFailedToLoadVersionList=100]="VHFailedToLoadVersionList",e[e.VHFailedToGetDownloadToken=101]="VHFailedToGetDownloadToken",e[e.VHFailedToParseVersionList=102]="VHFailedToParseVersionList",e[e.VHFetchFailed=103]="VHFetchFailed",e[e.VHVersioningNotEnabled=104]="VHVersioningNotEnabled",e[e.VHFileNotFound=105]="VHFileNotFound",e[e.VHVersionTooOld=106]="VHVersionTooOld",e[e.VHFetchException=107]="VHFetchException",e[e.VHServiceUnavailable=108]="VHServiceUnavailable",e[e.VHBadGateway=109]="VHBadGateway",e[e.VHUnauthorized=110]="VHUnauthorized",e[e.VHInternalServerError=111]="VHInternalServerError",e[e.VHEmptyVersionMetadatas=112]="VHEmptyVersionMetadatas",e[e.VHFailedHostDownload=113]="VHFailedHostDownload",e[e.VHFailedToAddDownloadToVersionStore=114]="VHFailedToAddDownloadToVersionStore",e[e.VHFailedToCacheParts=115]="VHFailedToCacheParts",e[e.VHFailedToDownloadVersionMetadata=116]="VHFailedToDownloadVersionMetadata",e[e.VHFailedToDownloadParts=117]="VHFailedToDownloadParts",e[e.VHInvalidDocID=118]="VHInvalidDocID",e[e.VHMissingDocID=119]="VHMissingDocID",e[e.VHNullDocID=120]="VHNullDocID",e[e.VHNullHashedDocID=121]="VHNullHashedDocID",e[e.VHNullGetDownloadAccessTokenRequest=122]="VHNullGetDownloadAccessTokenRequest",e[e.VHFailedToDownloadVersionFromHost=123]="VHFailedToDownloadVersionFromHost",e[e.VHNullResponseFromFetch=124]="VHNullResponseFromFetch",e[e.VHGetTipVersionException=125]="VHGetTipVersionException",e[e.VHGetVersionsException=126]="VHGetVersionsException",e[e.VHGetDownloadTokenException=127]="VHGetDownloadTokenException",e[e.VHFetchRetryException=128]="VHFetchRetryException",e[e.VHNullResponseFromRequestVersionHistory=129]="VHNullResponseFromRequestVersionHistory",e[e.VHNullResponseFromRequestDownloadToken=130]="VHNullResponseFromRequestDownloadToken",e[e.VHXhrJsonParseFailed=131]="VHXhrJsonParseFailed",e[e.VHXhrException=132]="VHXhrException",e[e.VHNullResponseFromXhr=133]="VHNullResponseFromXhr",e[e.VHFileGone=134]="VHFileGone",e[e.VHNullRevisionIDs=135]="VHNullRevisionIDs",e[e.VHRequestDeleteVersionsException=136]="VHRequestDeleteVersionsException",e[e.VHNullResponseFromRequestDeleteVersions=137]="VHNullResponseFromRequestDeleteVersions",e[e.VHVersionInfoFromTipVersionException=138]="VHVersionInfoFromTipVersionException"}(r||(r={})),function(e){e[e.NotSet=0]="NotSet",e[e.PowerPoint=100]="PowerPoint",e[e.Word=110]="Word",e[e.Excel=120]="Excel",e[e.OneNote=130]="OneNote"}(n||(n={})),function(e){e[e.None=0]="None",e[e.Share=1]="Share",e[e.Rename=2]="Rename",e[e.Restore=3]="Restore"}(i||(i={}));var a=o(1200),l=o(2376),c=o(1374),d=function(){function e(){}return e.setDisabledChangeGates=function(t){t&&t.length>0?e.disabledChangeGates=t.toLowerCase().split(","):e.disabledChangeGates=[]},e.getDisabledChangeGates=function(){return e.disabledChangeGates.toString()},e.isChangeGateEnabled=function(t){return!(t.length<1)&&(e.disabledChangeGates.length<1||e.disabledChangeGates.indexOf(t.toLowerCase())<0)},e.disabledChangeGates=[],e}(),p=function(){function e(){}return e.FetchTelemetryChange="FetchTelemetryChange",e.ResolvingWholeGridSelectedOnIteration="ResolvingWholeGridSelectedOnIteration",e}(),u=function(e,t,o,r){this.correlationId=e||"",this.errorType=t,this.status=o,this.statusText=r},h=function(){function e(e,t,o,r){this._theUri="",this._serviceBase="",this._docId="",this._retryCount=3,this._wdEnableDownloadTokens=!1,this._handlerName="versions.ashx",this._handlerQueryParam="DocID",this._appId=n.NotSet,this._userSessionId="",this._wacCluster="",this._latestStreamServiceBase="",this._useXhr=!1,this._wdEnableDeleteVersions=!1,this._wdDisableSPOFileCache=!1,this._serviceBase=e,this._docId=t,this._wdEnableDownloadTokens=!!o.wdEnableDownloadTokens&&o.wdEnableDownloadTokens,this._retryCount=o.retryCount?o.retryCount:3,this._appId=o.appName?o.appName:n.NotSet,this._userSessionId=o.userSessionId?o.userSessionId:"",this._wacCluster=o.wacCluster?o.wacCluster:"",this._latestStreamServiceBase=r||"",this._useXhr=!!o.useXhr&&o.useXhr,this._wdEnableDeleteVersions=!!o.wdEnableDeleteVersions&&o.wdEnableDeleteVersions,this._wdDisableSPOFileCache=!!o.wdDisableSPOFileCache,this.buildVersionHistoryRequestUri()}return e.prototype.updateDocId=function(e){a.a.shipAssertTag(520173205,l.a.msoulscat_Wac_VersionHistory,Boolean(e),"New docId should not be empty"),e&&(this._docId=e)},e.prototype.versionInfoFromTipVersion=function(e){try{if(!e)return;if(!e.data)return{data:null,errorCode:e.errorCode,message:e.message,isDirty:!1};var t={};return e.data.downloadUrl?(t.DownloadUrl=e.data.downloadUrl,{correlationID:e.correlationID,data:t,isDirty:"true"===e.data.isDirty}):(t.DownloadUrl=null,{data:t,errorCode:e.errorCode,message:"null download url",isDirty:!1})}catch(t){var o="versionInfoFromTipVersion exception: ".concat(t.message);return a.a.sendTraceTag(579342617,l.a.msoulscat_Wac_VersionHistory,c.a.Error,o),{data:e.data,errorCode:r.VHVersionInfoFromTipVersionException,message:o,isDirty:!1}}},e.prototype.getAppIdHeader=function(e){switch(e){case n.Excel:return"Excel";case n.PowerPoint:return"PPT";case n.Word:return"Word"}return"None"},e.prototype.requestTipVersionAsync=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,t,o,n,i;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:e={method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","X-AppId":this.getAppIdHeader(this._appId),"X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster}},t="&waccluster="+this._wacCluster,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.fetchRetry(this._latestStreamServiceBase+t,e,this._retryCount)];case 2:return o=s.sent(),[2,this.versionInfoFromTipVersion(o)];case 3:return n=s.sent(),i="requestTipVersionAsync fetchRetry exception: ".concat(n.message),a.a.sendTraceTag(591934727,l.a.msoulscat_Wac_VersionHistory,c.a.Error,i),[2,{errorCode:r.VHFetchRetryException,message:i,isDirty:!1}];case 4:return[2]}}))}))},e.prototype.requestTipVersion=function(){return this.requestTipVersionAsync()},e.prototype.requestVersionHistory=function(){var e={method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","X-AppId":this.getAppIdHeader(this._appId),"X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster,"X-WacNoAuth":"1","X-NoSpoCache":this._wdDisableSPOFileCache?"1":"0"}},t="&wdEnableDownloadTokens="+this._wdEnableDownloadTokens.toString();return this._useXhr?this.xhrRetry(e.method,this._theUri+t,e.headers,null,this._retryCount):this.fetchRetry(this._theUri+t,e,this._retryCount)},e.prototype.requestDownloadToken=function(e,t){var o={method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","X-AppId":this.getAppIdHeader(this._appId),"X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster,"X-WacNoAuth":"1"},body:JSON.stringify({RevisionIDs:e,OptionalIDs:t})},r="&action=GetDownloadToken&wdEnableDownloadTokens="+this._wdEnableDownloadTokens.toString();return this._useXhr?this.xhrRetry(o.method,this._theUri+r,o.headers,o.body,this._retryCount):this.fetchRetry(this._theUri+r,o,this._retryCount)},e.prototype.requestDeleteVersions=function(e){if(!e||0===e.length||e.includes(void 0)){var t={errorCode:r.VHNullRevisionIDs,message:"requestDeleteVersions: revisionIDs list is null."};return Promise.resolve(t)}var o={method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","X-AppId":this.getAppIdHeader(this._appId),"X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster,"X-WacNoAuth":"1"},body:JSON.stringify({RevisionIDs:e})},n="&action=DeleteVersions&wdEnableDeleteVersions="+this._wdEnableDeleteVersions.toString();return this._useXhr?this.xhrRetry(o.method,this._theUri+n,o.headers,o.body,1):this.fetchRetry(this._theUri+n,o,1)},e.prototype.buildVersionHistoryRequestUri=function(){this._serviceBase.indexOf(this._handlerName)<0?this._theUri=this._serviceBase+this._handlerName+"?"+this._handlerQueryParam+"="+encodeURIComponent(this._docId):this._theUri=this._serviceBase+"?"+this._handlerQueryParam+"="+encodeURIComponent(this._docId)},e.prototype.xhrRetry=function(t,o,n,i,h){return Object(s.__awaiter)(this,void 0,void 0,(function(){var g,m,f,v,b,C,S,_,y;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:m=!1,f="",v=r.VHUnknown,b=0,C=0,S=0,s.label=1;case 1:if(!(S<h))return[3,7];d.isChangeGateEnabled(p.FetchTelemetryChange)&&(C+=1),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this.xhr(t,o,n,i)];case 3:return(g=s.sent())?(m=!1,v=r.None):(m=!0,v=r.VHNullResponseFromXhr,f=d.isChangeGateEnabled(p.FetchTelemetryChange)?"VersionHistoryRequestManager::xhrRetry: unexpected null response from xhr, tryNumber: ".concat(C," of ").concat(h):"xhrRetry: unexpected null response from xhr.",a.a.sendTraceTag(591934728,l.a.msoulscat_Wac_VersionHistory,d.isChangeGateEnabled(p.FetchTelemetryChange)?c.a.Warning:c.a.Error,f)),[3,5];case 4:return _=s.sent(),f=d.isChangeGateEnabled(p.FetchTelemetryChange)?"VersionHistoryRequestManager::xhrRetry xhr exception: ":"xhrRetry xhr exception: ",_ instanceof u?(m=e.isRetriableError(_.errorType),v=_.errorType,f+=_.statusText,b=_.status):(m=!0,v=r.VHXhrException,f+=_.message),d.isChangeGateEnabled(p.FetchTelemetryChange)&&(f+=", tryNumber: ".concat(C," of ").concat(h,", isRetriableError: ").concat(m)),a.a.sendTraceTag(591934729,l.a.msoulscat_Wac_VersionHistory,d.isChangeGateEnabled(p.FetchTelemetryChange)?c.a.Warning:c.a.Error,f),[3,5];case 5:if(!m)return[3,7];s.label=6;case 6:return S+=1,[3,1];case 7:return d.isChangeGateEnabled(p.FetchTelemetryChange)&&(y=!g||v!==r.None,a.a.sendTraceTag(574128981,l.a.msoulscat_Wac_VersionHistory,y?c.a.Error:c.a.Info,"VersionHistoryRequestManager::xhrRetry exiting loop; tryNumber: ".concat(C," of ").concat(h,", isError: ").concat(y))),g?v!==r.None?[2,{errorCode:v,responseStatusCode:b,message:f,correlationId:g.headers.get("X-CorrelationId")}]:[2,g]:[2,{errorCode:v,message:f}]}}))}))},e.prototype.xhr=function(t,o,n,i){var s=this;return new Promise((function(a,l){var c=new XMLHttpRequest;c.open(t,o,!0),c.onload=function(){if(200===this.status)try{var t=JSON.parse(c.response);a({errorCode:r.None,data:t,correlationId:this.getResponseHeader("X-CorrelationId")})}catch(e){l(new u(this.getResponseHeader("X-CorrelationId"),r.VHXhrJsonParseFailed,this.status,"xhr: exception, statusText: ".concat(this.statusText,", error: ").concat(e.message)))}else{var o=this.getResponseHeader("X-ErrorCode");l(new u(this.getResponseHeader("X-CorrelationId"),e.parseResponseError(this.status,null!=o?o:""),this.status,"xhr: failed, statusText: ".concat(this.statusText,", X-ErrorCode: ").concat(o)))}},c.onerror=function(){var t=this.getResponseHeader("X-ErrorCode");l(new u(this.getResponseHeader("X-CorrelationId"),e.parseResponseError(this.status,null!=t?t:""),this.status,"xhr: onerror, statusText: ".concat(this.statusText,", X-ErrorCode: ").concat(t)))},s.addXhrHeaders(n,c),c.send(i)}))},e.prototype.addXhrHeaders=function(e,t){if(e)for(var o in e)e.hasOwnProperty(o)&&t.setRequestHeader(o,e[o])},e.prototype.fetchRetry=function(t,o,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var i,u,h,g,m,f,v,b,C,S;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:i=null,u=r.VHUnknown,h="",g=!1,m=0,f=0,s.label=1;case 1:if(!(f<n))return[3,7];d.isChangeGateEnabled(p.FetchTelemetryChange)&&(m+=1),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,fetch(t,o)];case 3:return(i=s.sent())?i.ok?g=!1:(g=e.isRetriableError(this.parseServerError(i)),h=d.isChangeGateEnabled(p.FetchTelemetryChange)?"VersionHistoryRequestManager::fetchRetry status: ".concat(i.status,", statusText: ").concat(i.statusText,", errorCode: ").concat(e.getResponseErrorCode(i),", correlationId: ").concat(i.headers.get("X-CorrelationId"),", tryNumber: ").concat(m," of ").concat(n,", isRetriableError: ").concat(g):"fetchRetry status: ".concat(i.status,", statusText: ").concat(i.statusText,", errorCode: ").concat(e.getResponseErrorCode(i),", correlationId: ").concat(i.headers.get("X-CorrelationId")),a.a.sendTraceTag(591934731,l.a.msoulscat_Wac_VersionHistory,d.isChangeGateEnabled(p.FetchTelemetryChange)?c.a.Warning:c.a.Error,h)):(g=!0,u=r.VHNullResponseFromFetch,h=d.isChangeGateEnabled(p.FetchTelemetryChange)?"VersionHistoryRequestManager::fetchRetry: unexpected null response from fetch, tryNumber: ".concat(m," of ").concat(n):"fetchRetry: unexpected null response from fetch.",a.a.sendTraceTag(591934730,l.a.msoulscat_Wac_VersionHistory,d.isChangeGateEnabled(p.FetchTelemetryChange)?c.a.Warning:c.a.Error,h)),[3,5];case 4:return v=s.sent(),g=!0,u=r.VHFetchException,h=d.isChangeGateEnabled(p.FetchTelemetryChange)?"VersionHistoryRequestManager::fetchRetry fetch exception: ".concat(v.message,"}, tryNumber: ").concat(m," of ").concat(n):"fetchRetry fetch exception: ".concat(v.message),a.a.sendTraceTag(591934732,l.a.msoulscat_Wac_VersionHistory,d.isChangeGateEnabled(p.FetchTelemetryChange)?c.a.Warning:c.a.Error,h),[3,5];case 5:if(!g)return[3,7];s.label=6;case 6:return f+=1,[3,1];case 7:if(d.isChangeGateEnabled(p.FetchTelemetryChange)&&(b=!i||u!==r.VHUnknown,a.a.sendTraceTag(574128982,l.a.msoulscat_Wac_VersionHistory,b?c.a.Error:c.a.Info,"VersionHistoryRequestManager::fetchRetry exiting loop; tryNumber: ".concat(m," of ").concat(n,", isError: ").concat(b))),!i)return[2,{errorCode:u,message:h}];if(!i.ok)return[2,{errorCode:this.parseServerError(i),responseStatusCode:i.status,message:h,correlationId:i.headers.get("X-CorrelationId")}];s.label=8;case 8:return s.trys.push([8,10,,11]),[4,i.json()];case 9:return C=s.sent(),[2,{errorCode:r.None,data:C,correlationId:i.headers.get("X-CorrelationId")}];case 10:return S=s.sent(),h="fetchRetry response.json exception: ".concat(S.message,", status: ").concat(i.status,", statusText: ").concat(i.statusText),a.a.sendTraceTag(591934733,l.a.msoulscat_Wac_VersionHistory,c.a.Error,h),[2,{errorCode:r.VHFailedToParseVersionList,responseStatusCode:i.status,message:h,correlationId:i.headers.get("X-CorrelationId")}];case 11:return[2]}}))}))},e.prototype.parseServerError=function(t){var o;return e.parseResponseError(t.status,null!==(o=t.headers.get("X-ErrorCode"))&&void 0!==o?o:"")},e.parseResponseError=function(e,t){var o;switch(e){case 503:o=r.VHServiceUnavailable;break;case 502:o=r.VHBadGateway;break;case 401:o=r.VHUnauthorized;break;case 410:o=r.VHFileGone}switch(t){case"VersioningNotEnabled":o=r.VHVersioningNotEnabled;break;case"FileNotFound":o=r.VHFileNotFound;break;case"VersionTooOld":o=r.VHVersionTooOld;break;case"FileNotFound":o=r.VHFileNotFound;break;case"ServiceUnavailable":o=r.VHServiceUnavailable;break;case"BadGateway":o=r.VHBadGateway;break;case"Unauthorized":o=r.VHUnauthorized;break;case"InternalServerError":o=r.VHInternalServerError;break;case"EmptyVersionMetadatas":o=r.VHEmptyVersionMetadatas;break;case"FailedHostDownload":o=r.VHFailedHostDownload;break;case"FailedToAddDownloadToVersionStore":o=r.VHFailedToAddDownloadToVersionStore;break;case"FailedToCacheParts":o=r.VHFailedToCacheParts;break;case"FailedToDownloadVersionMetadata":o=r.VHFailedToDownloadVersionMetadata;break;case"FailedToDownloadParts":o=r.VHFailedToDownloadParts;break;case"InvalidDocID":o=r.VHInvalidDocID;break;case"MissingDocID":o=r.VHMissingDocID;break;case"NullDocID":o=r.VHNullDocID;break;case"NullHashedDocID":o=r.VHNullHashedDocID;break;case"NullGetDownloadAccessTokenRequest":o=r.VHNullGetDownloadAccessTokenRequest;break;case"FailedToDownloadVersionFromHost":o=r.VHFailedToDownloadVersionFromHost;break;default:o=r.VHUnknown}return o},e.getResponseErrorCode=function(t){var o,r;return null!==(r=null!==(o=e.getResponseStatusError(t.status))&&void 0!==o?o:t.headers.get("X-ErrorCode"))&&void 0!==r?r:""},e.getResponseStatusError=function(e){switch(e){case 503:return"ServiceUnavailable";case 502:return"BadGateway";case 401:return"Unauthorized";case 410:return"Gone"}return null},e.isRetriableError=function(e){switch(e){case r.VHVersioningNotEnabled:case r.VHFileNotFound:case r.VHFileGone:case r.VHVersionTooOld:case r.VHInvalidDocID:case r.VHMissingDocID:case r.VHNullDocID:case r.VHNullHashedDocID:case r.VHNullHashedDocID:return!1}return!0},e}(),g=["#0078d4","#4f6bed","#e3008c","#004e8c","#005b70","#750b1c","#0b6a0b","#8764b8","#a4262c","#038387","#c239b3","#d13438","#498205","#5c2e91","#ca5010","#986f0b","#881798","#8e562e"],m=function(){function e(){}return e.getInitialsColorFromName=function(e){if(!e)return this.getColorByIndex(0);for(var t=0;t<this.nameColorMap.length;t+=1){var o=this.nameColorMap[t];if(o.name===e)return this.getColorByIndex(o.colorIndex)}var r={name:e,colorIndex:this.getNextColorIndex()};return this.nameColorMap.push(r),this.getColorByIndex(r.colorIndex)},e.getNextColorIndex=function(){return this.currentColorIndex=(this.currentColorIndex+1)%g.length,this.currentColorIndex},e.getColorByIndex=function(e){return g[e%g.length]},e.currentColorIndex=0,e.nameColorMap=[],e}(),f=function(){function e(){}return Object.defineProperty(e,"UILocale",{get:function(){return null!=this.uiLocale&&""!==this.uiLocale?this.uiLocale:"en-us"},set:function(e){this.uiLocale=e},enumerable:!1,configurable:!0}),e.uiLocale="",e}();function v(e,t,o){return!(!e||null===t||null===o||e.length<=t||e.length<=o)&&(e.length-1!==t&&e.length-1!==o&&Intl.DateTimeFormat(f.UILocale,{month:"long",day:"numeric",year:"numeric"}).format(e[t].Time)===Intl.DateTimeFormat(f.UILocale,{month:"long",day:"numeric",year:"numeric"}).format(e[o].Time))}var b=function(){function e(e,t,o,r,n,i,s,a,l,c){this.Versions=[],this._isDisposed=!1,this._getCachedTokensCount=0,this._cachedTokensPrefetchCount=0,this._disableSPOFileCache=!1,this._versionHistoryRequestManager=l||new h(n,i,s,a),this._versionHistoryReadyEvent=e,this._perfTelemetryInfos=c,this._downloadTokenReadyEvent=t,this._fullAppErrorEvent=o,this._tipVersionTokenReadyEvent=r,this._disableSPOFileCache=!!s.wdDisableSPOFileCache}return e.prototype.updateDocId=function(e){this._versionHistoryRequestManager.updateDocId(e)},e.prototype.getTipVersion=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,o,r,n,i,d,p;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:t=Date.now(),a.a.sendTraceTag(590144346,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,JSON.stringify({event:"getTipVersion: started",startTime:t})),null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadTipVersionStart",TelemetryEventData:t.toString()}),o=Date.now(),r=0,this._tipVersionResponse=null,n=null,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this._versionHistoryRequestManager.requestTipVersion()];case 2:return n=s.sent(),[3,4];case 3:return i=s.sent(),r=Date.now(),a.a.sendTraceTag(591934734,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getTipVersion:: requestTipVersion exception",error:i.message,startTime:t,duration:r-t,versionReqDuration:r-o})),[2,!1];case 4:return d=Date.now(),this._tipVersionResponse=n,null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadTipVersionEnd",TelemetryEventData:Date.now().toString()}),n?n.data?n.data.DownloadUrl?(this.Versions&&this.Versions.length>0&&!this.Versions[0].DownloadUrl&&!n.isDirty?(a.a.sendTraceTag(595882755,l.a.msoulscat_Wac_VersionHistory,c.a.Info,"Storing First Version Download Url, sending TipVersionTokenReadyEvent"),e.updateVersionInfo(this.Versions[0],n.data)):a.a.sendTraceTag(595882756,l.a.msoulscat_Wac_VersionHistory,c.a.Info,"No Versions list, sending TipVersionTokenReadyEvent"),p=Date.now(),this.fireTipVersionTokenReadyEvent(n.data,n.correlationID),r=Date.now(),a.a.sendTraceTag(590144347,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,JSON.stringify({event:"getTipVersion: ended",error:"None",startTime:t,duration:r-t,versionReqDuration:d-o,eventFireDuration:r-p,versionCount:this.Versions.length})),[2,!0]):(a.a.sendTraceTag(591934737,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getTipVersion: !response.data.DownloadUrl",error:"null download url",startTime:t,duration:Date.now()-t,versionReqDuration:d-o})),[2,!1]):(a.a.sendTraceTag(591934736,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getTipVersion: !response.data",error:"errorCode: ".concat(n.errorCode,", errorMessage: ").concat(n.message),startTime:t,duration:Date.now()-t,versionReqDuration:d-o})),[2,!1]):(a.a.sendTraceTag(591934735,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getTipVersion: !response",error:"null response",startTime:t,duration:Date.now()-t,versionReqDuration:d-o})),[2,!1])}}))}))},e.prototype.getVersions=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,o,n,i,d,p,u,h,g,m,f,v,b=this;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:t=1,o=500,n=Date.now(),a.a.sendTraceTag(590144348,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,JSON.stringify({event:"getVersions: started",startTime:n})),null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadVersionListStart",TelemetryEventData:n.toString()}),i=Date.now(),d=0,p=0,u=null,h=3,g=0,s.label=1;case 1:if(!(g<h))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this._versionHistoryRequestManager.requestVersionHistory()];case 3:return u=s.sent(),[3,5];case 4:return m=s.sent(),d=Date.now(),this.fireFullAppErrorEvent(r.VHGetVersionsException),p=Date.now(),a.a.sendTraceTag(591934738,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getVersions: requestVersionHistory exception",error:m.message,startTime:n,duration:p-n,versionReqDuration:d-i,eventFireDuration:p-d})),[2,!1];case 5:if(!u||!u.data||u.data.Versions&&u.data.Versions[0])return[3,7];s.label=6;case 6:return g+=1,[3,1];case 7:return f=Date.now(),null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadVersionListEnd",TelemetryEventData:Date.now().toString()}),u?u.data?u.data.Versions?u.data.Versions[0]?this._isDisposed?(a.a.sendTraceTag(590127842,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getVersions: this._isDisposed",error:"this object is disposed",startTime:n,duration:Date.now()-n,versionReqDuration:f-i})),[2,!1]):(this.Versions=u.data.Versions?u.data.Versions.filter((function(e){return e.Time=new Date(e.Time.toString())})):[],this.Versions.sort((function(e,t){return e&&t&&e.Time&&t.Time?t.Time.getTime()-e.Time.getTime():0})),this.Versions.forEach((function(t){return e.updateAuthorColorInfo(t)})),this.Versions.length>0&&(!this.Versions[0].RevisionID||this._disableSPOFileCache||this.Versions[0].DownloadUrl||this._tipVersionResponse&&this._tipVersionResponse.data.DownloadUrl&&!this._tipVersionResponse.isDirty&&(a.a.sendTraceTag(595882271,l.a.msoulscat_Wac_VersionHistory,c.a.Info,"Using stored tip version as first version downloadurl"),this.Versions[0].DownloadUrl=this._tipVersionResponse.data.DownloadUrl,this.Versions[0].WopiInfo=this._tipVersionResponse.data.WopiInfo),d=Date.now(),!this._disableSPOFileCache&&this._cachedTokensPrefetchCount<t&&(v=[],setTimeout((function(){b.getDownloadToken(v,void 0).then((function(){}),(function(){}))}),o),this._cachedTokensPrefetchCount+=1,a.a.sendTraceTag(574660755,l.a.msoulscat_Wac_VersionHistory,c.a.Info,"getVersions: prefetching cached URLs after version list request complete")),this.fireVersionsReadyEvent(this.Versions,u.correlationID)),p=Date.now(),a.a.sendTraceTag(590144349,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,JSON.stringify({event:"getVersions: ended",error:"None",startTime:n,duration:p-n,versionReqDuration:f-i,eventFireDuration:p-d,versionCount:this.Versions.length})),[2,!0]):(d=Date.now(),this.fireFullAppErrorEventWithDefaultCode(u.errorCode),p=Date.now(),a.a.sendTraceTag(595682910,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getVersions: !response.data.Versions[0]",error:"null Versions[0]",startTime:n,duration:p-n,versionReqDuration:f-i,eventFireDuration:p-d})),[2,!1]):(d=Date.now(),this.fireFullAppErrorEventWithDefaultCode(u.errorCode),p=Date.now(),a.a.sendTraceTag(595682909,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getVersions: !response.data.Versions",error:"null Versions",startTime:n,duration:p-n,versionReqDuration:f-i,eventFireDuration:p-d})),[2,!1]):(d=Date.now(),this.fireFullAppErrorEventWithDefaultCode(u.errorCode),p=Date.now(),a.a.sendTraceTag(591934740,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getVersions: !response.data",error:"errorCode: ".concat(u.errorCode,", errorMessage: ").concat(u.message),startTime:n,duration:p-n,versionReqDuration:f-i,eventFireDuration:p-d})),[2,!1]):(d=Date.now(),this.fireFullAppErrorEvent(r.VHNullResponseFromRequestVersionHistory),p=Date.now(),a.a.sendTraceTag(591934739,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getVersions: !response",error:"null response",startTime:n,duration:p-n,versionReqDuration:f-i,eventFireDuration:p-d})),[2,!1])}}))}))},e.prototype.getDownloadToken=function(t,o){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,i,d,p,u,h,g,m,f=this;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:n=Date.now(),a.a.sendTraceTag(590144350,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,JSON.stringify({event:"getDownloadToken: started",startTime:n})),null!=this._perfTelemetryInfos&&t.length>0&&this._perfTelemetryInfos.push({TelemetryEventKey:"GetDownloadTokenStart",TelemetryEventData:n.toString()}),i=this.getOrderedOptionalTokenList(t),d=Date.now(),p=0,u=0,h=null,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this._versionHistoryRequestManager.requestDownloadToken(t,i)];case 2:return h=s.sent(),this._getCachedTokensCount+=1,[3,4];case 3:return g=s.sent(),p=Date.now(),this.fireFullAppErrorEvent(r.VHGetDownloadTokenException),u=Date.now(),a.a.sendTraceTag(591934741,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getDownloadToken: requestDownloadToken exception",error:g.message,startTime:n,duration:u-n,versionReqDuration:p-d,eventFireDuration:u-p})),[2,!1];case 4:return m=Date.now(),null!=this._perfTelemetryInfos&&t.length>0&&this._perfTelemetryInfos.push({TelemetryEventKey:"GetDownloadTokenEnd",TelemetryEventData:Date.now().toString()}),h?h.data?h.data.Versions&&h.data.Versions[0]?(o&&(o.correlationID=h.correlationID),this._isDisposed?(a.a.sendTraceTag(590127872,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getDownloadToken: this._isDisposed",error:"this object is disposed",startTime:n,duration:Date.now()-n,versionReqDuration:m-d})),[2,!1]):(h.data.Versions.forEach((function(t){if(t&&t.DownloadUrl){var r=f.Versions.filter((function(e){return e.RevisionID===t.RevisionID}));r[0]&&(r[0].DownloadUrl=t.DownloadUrl,null!==t.WopiInfo&&(r[0].WopiInfo=t.WopiInfo),o&&(o.baseVersion&&o.baseVersion.RevisionID===t.RevisionID?e.updateVersionInfo(o.baseVersion,t):o.currentVersion&&o.currentVersion.RevisionID===t.RevisionID&&e.updateVersionInfo(o.currentVersion,t)))}})),p=Date.now(),this.fireDownloadTokenReadyEvent(this.Versions,o),u=Date.now(),a.a.sendTraceTag(590144351,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,JSON.stringify({event:"getDownloadToken ended",error:"None",startTime:n,duration:u-n,versionReqDuration:m-d,eventFireDuration:u-p,versionCount:t.length})),[2,!0])):(h.data.Versions&&!h.data.Versions[0]&&0===t.length||(p=Date.now(),h&&h.errorCode?this.fireFullAppErrorEvent(h.errorCode):this.fireFullAppErrorEvent(r.VHFailedToGetDownloadToken),u=Date.now(),h.data.Versions?a.a.sendTraceTag(590127843,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getDownloadToken: !response.data.Versions[0]",error:"null Versions[0]",startTime:n,duration:u-n,versionReqDuration:m-d,eventFireDuration:u-p})):a.a.sendTraceTag(595907533,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getDownloadToken: !response.data.Version",error:"null Versions",startTime:n,duration:u-n,versionReqDuration:m-d,eventFireDuration:u-p}))),[2,!1]):(p=Date.now(),this.fireFullAppErrorEventWithDefaultCode(h.errorCode),u=Date.now(),a.a.sendTraceTag(591934743,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getDownloadToken: !response.data",error:"errorCode: ".concat(h.errorCode,", errorMessage: ").concat(h.message),startTime:n,duration:u-n,versionReqDuration:m-d,eventFireDuration:u-p})),[2,!1]):(p=Date.now(),this.fireFullAppErrorEvent(r.VHNullResponseFromRequestDownloadToken),u=Date.now(),a.a.sendTraceTag(591934742,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"getDownloadToken: !response",error:"null response",startTime:n,duration:u-n,versionReqDuration:m-d,eventFireDuration:u-p})),[2,!1])}}))}))},e.prototype.getOrderedOptionalTokenList=function(e){var t,o=this,r=[];t=e.length>0?e[0]:"-1";var n=[],i=[],s=!1,a=-1,l=[];this.Versions.forEach((function(e,r){e.RevisionID===t?(s=!0,a=r):r>0&&!e.DownloadUrl&&!v(o.Versions,r,r-1)&&(s?n.push(e.RevisionID):i.unshift(e.RevisionID)),o._getCachedTokensCount<2&&l.length<15&&!e.DownloadUrl&&r!==a&&l.push(e.RevisionID)}));for(var c=0;c<1;c+=1){n.length>c&&!r.includes(n[c])&&r.push(n[c]),i.length>c&&!r.includes(i[c])&&r.push(i[c]);var d=a-1-c,p=a+1+c;d>=0&&!r.includes(this.Versions[d].RevisionID)&&!this.Versions[d].DownloadUrl&&r.push(this.Versions[d].RevisionID),a>=0&&p<this.Versions.length&&!r.includes(this.Versions[p].RevisionID)&&!this.Versions[p].DownloadUrl&&r.push(this.Versions[p].RevisionID)}return l.forEach((function(e){r.includes(e)||r.push(e)})),r},e.prototype.dispose=function(){this._isDisposed=!0,this.Versions=[]},e.prototype.deleteVersions=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,o,n,i;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"DeleteVersionsStart",TelemetryEventData:Date.now().toString()}),o=[],s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this._versionHistoryRequestManager.requestDeleteVersions(e)];case 2:return t=s.sent(),[3,4];case 3:return n=s.sent(),a.a.sendTraceTag(589312513,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"deleteVersions requestDeleteVersions exception: ".concat(n.message)),this.fireFullAppErrorEvent(r.VHRequestDeleteVersionsException),[2,null];case 4:return null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"DeleteVersionsEnd",TelemetryEventData:Date.now().toString()}),t?t.data?t.data.Versions?(t.data.Versions.forEach((function(e){return(null==e?void 0:e.RevisionID)?o.push(e.RevisionID):void 0})),i=e.filter((function(e){return!o.includes(e)})),this.Versions=this.Versions.filter((function(e){return!e.RevisionID||!i.includes(e.RevisionID)})),[2,o]):(a.a.sendTraceTag(589312516,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"deleteVersions failed: !response.data.Versions"),this.fireFullAppErrorEventWithDefaultCode(t.errorCode),[2,null]):(a.a.sendTraceTag(589312515,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"deleteVersions: null response.data, errorCode: ".concat(t.errorCode,", errorMessage: ").concat(t.message)),this.fireFullAppErrorEventWithDefaultCode(t.errorCode),[2,null]):(a.a.sendTraceTag(589312514,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"deleteVersions: unexpected null response."),this.fireFullAppErrorEvent(r.VHNullResponseFromRequestDeleteVersions),[2,null])}}))}))},e.prototype.fireTipVersionTokenReadyEvent=function(e,t){if(!this._isDisposed){var o={tipVersion:e,updatedVersions:this.Versions,containerDiv:document.getElementById("vhViewer"),correlationID:t};a.a.sendTraceTag(595882757,l.a.msoulscat_Wac_VersionHistory,c.a.Info,"fireTipVersionTokenReadyEvent"),this._tipVersionTokenReadyEvent.fireEvent(o)}},e.prototype.fireVersionsReadyEvent=function(e,t){if(!this._isDisposed){var o={versions:e,containerDiv:document.getElementById("vhViewer"),correlationID:t};a.a.sendTraceTag(595914892,l.a.msoulscat_Wac_VersionHistory,c.a.Info,"fireVersionsReadyEvent"),this._versionHistoryReadyEvent.fireEvent(o)}},e.prototype.fireDownloadTokenReadyEvent=function(e,t){if(!this._isDisposed){var o={updatedVersions:e,versionSelected:t};a.a.sendTraceTag(595907532,l.a.msoulscat_Wac_VersionHistory,c.a.Info,"fireDownloadTokenReadyEvent"),this._downloadTokenReadyEvent.fireEvent(o)}},e.prototype.fireFullAppErrorEventWithDefaultCode=function(e){e?this.fireFullAppErrorEvent(e):(this.fireFullAppErrorEvent(r.VHFailedToLoadVersionList),a.a.sendTraceTag(577380355,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"VHFailedToLoadVersionList"))},e.prototype.fireFullAppErrorEvent=function(e){this._isDisposed||(a.a.sendTraceTag(595906849,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"fireFullAppErrorEvent, error code: "+e),this._fullAppErrorEvent.fireEvent(e))},e.updateVersionInfo=function(e,t){null!=e?null!=t?(e.DownloadUrl=t.DownloadUrl,e.WopiInfo=t.WopiInfo):a.a.sendTraceTag(595858567,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"updateVersionInfo, currentVersionInfo is null"):a.a.sendTraceTag(595858566,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"currentVersionInfo, currentVersionInfo is null")},e.updateAuthorColorInfo=function(e){e.Authors&&e.Authors.forEach((function(e){e&&(e.InitialsColor=m.getInitialsColorFromName(e.UserName))}))},e}(),C=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e}(),S=o(4),_=o(31),y=o(2403),V=o(812),D=o(45),T=function(e,t){void 0===t&&(t=!1);var o=e?w:E;return t&&(o.vhHeaderBackground=e?"#141414":"#F5F5F5"),o},E={versionCardRootSelectedBackgroundColor:"#D2D0CE",versionCardRootBackgroundColor:"#EDEBE9",versionCardRootSelectedBoxShadow:"",versionCardRootFocusSelectedBackgroundColor:"#D2D0CE",versionCardRootFocusBackgroundColor:"#EDEBE9",versionCardRootFocusBorder:"#000000",versionCardRootHoverBackground:"#E1DFDD",versionCardRootActiveBackground:"#C8C6C4",versionCardAuthorNameColor:"#252423",versionCardTimestampColor:"#252423",versionCardExpandCollapseIconColor:"#303030",errorDefaultButtonColor:"",errorDefaultButtonBorder:"",errorDefaultButtonHoverColor:"",errorDefaultButtonFocusBorder:"",errorDefaultButtonActiveColor:"",headerDefaultButtonColor:"",headerDefaultButtonBorder:"rgba(200, 198, 196, 1.0)",headerDefaultButtonFont:"",headerDefaultButtonHoverBorderColor:"",headerDefaultButtonHoverBackground:"",headerDefaultButtonHoverFont:"",headerDefaultButtonFocusBorder:"#000000",headerDefaultButtonActiveColor:"",headerDefaultButtonActiveFont:"",headerDefaultButtonActiveBorder:"",headerDefaultButtonDisabledBackground:"",headerDefaultButtonDisabledText:"",headerDefaultButtonDisabledBorder:"",spinnerBorder:"#dddddd",spinnerTopColor:"",vhViewerBackground:"#EDEBE9",vhHeaderBackground:"#F4F3F1",headerBackArrowAndIterator:"#4A4A4A",headerText:"#4A4A4A",headerIteratorTooltip:"#252423",viewerNoSelectionBackground:"#E4E4E4",viewerNoSelectionText:"#4A4A4A",viewerErrorBackground:"#EDEBE9",viewerErrorMessage:"#252423",viewerLoadingBackground:"#EDEBE9",paneBorder:"#DEDEDE",paneBackground:"#EDEBE9",paneHeaderColor:"#505050",dialogBackgroundColor:"#F3F3F3",fullAppErrorBackground:"#FFFFFF",fullAppErrorText:"#252423",appColors:{shade30:"#0e336a",shade20:"#13458f",shade10:"#1651aa",primary:"#185abd",tint10:"#2e6ac5",tint20:"#6794d7",tint30:"#aec6eb",tint40:"#d2e0f4"}},w={versionCardRootSelectedBackgroundColor:"#000000",versionCardRootBackgroundColor:"#1B1A19",versionCardRootSelectedBoxShadow:"",versionCardRootFocusSelectedBackgroundColor:"#000000",versionCardRootFocusBackgroundColor:"#1B1A19",versionCardRootFocusBorder:"white",versionCardRootHoverBackground:"#201F1E",versionCardRootActiveBackground:"#000000",versionCardAuthorNameColor:"#F3F2F1",versionCardTimestampColor:"#F3F2F1",versionCardExpandCollapseIconColor:"#F3F2F1",errorDefaultButtonColor:"white",errorDefaultButtonBorder:"",errorDefaultButtonHoverColor:"#F3F2F1",errorDefaultButtonFocusBorder:"",errorDefaultButtonActiveColor:"#E1DFDD",headerDefaultButtonColor:"#1B1A19",headerDefaultButtonBorder:"#484644",headerDefaultButtonFont:"#F3F2F1",headerDefaultButtonHoverBorderColor:"#161514",headerDefaultButtonHoverBackground:"#161514",headerDefaultButtonHoverFont:"#F3F2F1",headerDefaultButtonFocusBorder:"white",headerDefaultButtonActiveColor:"#000000",headerDefaultButtonActiveFont:"#F3F2F1",headerDefaultButtonActiveBorder:"#484644",headerDefaultButtonDisabledBackground:"#797775",headerDefaultButtonDisabledText:"#605E5C",headerDefaultButtonDisabledBorder:"#3B3A39",spinnerBorder:"#3B3A39",spinnerTopColor:"",vhViewerBackground:"#1B1A19",vhHeaderBackground:"#252423",headerBackArrowAndIterator:"#E1DFDD",headerText:"#E1DFDD",headerIteratorTooltip:"#F3F2F1",viewerNoSelectionBackground:"#1B1A19",viewerNoSelectionText:"#F3F2F1",viewerErrorBackground:"#1B1A19",viewerErrorMessage:"#F3F2F1",viewerLoadingBackground:"#1B1A19",paneBorder:"transparent",paneBackground:"#1B1A19",paneHeaderColor:"#F3F2F1",dialogBackgroundColor:"#000000",fullAppErrorBackground:"#1B1A19",fullAppErrorText:"#F3F2F1",appColors:{shade30:"#0e336a",shade20:"#13458f",shade10:"#1651aa",primary:"#185abd",tint10:"#2e6ac5",tint20:"#6794d7",tint30:"#aec6eb",tint40:"#d2e0f4"}},x=Object(V.c)((function(e,t){return void 0===t&&(t=!1),{root:Object(D.eb)({backgroundColor:T(t).dialogBackgroundColor,display:"flex",flexFlow:"row",width:"100%",height:"100%",overflow:"auto",direction:e?"rtl":"ltr"}),dialog:Object(D.eb)({display:"flex",flexFlow:"row",width:"100%",height:"100%",minWidth:"1000px",minHeight:"200px"}),hidden:Object(D.eb)({display:"none"}),fullAppErrorDiv:Object(D.eb)({display:"flex",flexFlow:"column",width:"100%",height:"100%"})}})),I=o(809),H=o(1202),F=o(449),O=Object(V.c)((function(e,t,o,r){var n,i,a=T(e);return{root:Object(D.eb)({display:"flex",flexFlow:"column",flexBasis:"22%",flexGrow:1,flexShrink:1.5,maxWidth:"338px",minWidth:"338px",height:"calc(100% - 2px)",border:"1px solid "+a.paneBorder,backgroundColor:a.paneBackground}),scrollRegion:Object(D.eb)({flexFlow:"column",overflowY:"auto",overflowX:"hidden",marginBottom:"40px",marginTop:"16px"}),loadingDiv:Object(D.eb)({display:"flex",flexGrow:1,justifyContent:"center",alignItems:"center"}),loadingSpinner:Object(D.eb)({selectors:{"& .ms-Spinner-circle":{borderColor:a.spinnerBorder,borderTopColor:a.spinnerTopColor}}}),paneHeader:Object(D.eb)({width:"",color:a.paneHeaderColor,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"15px",fontWeight:600,lineHeight:"17px",marginLeft:"12px",marginRight:"12px",marginTop:"14px",marginBottom:"4px"}),showChangesDiv:Object(D.eb)({display:r?"block":t?"flex":"none",height:t?"":"0px",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",fontWeight:600,marginTop:"16px"},r?{clear:"both",width:"100%"}:{}),hidden:Object(D.eb)({display:"none"}),changesDiv:Object(D.eb)({display:"flex",marginBottom:"8px",paddingLeft:"16px",float:"right",marginRight:"9px"}),changesText:Object(D.eb)({display:r?"flex":"none",height:"16px",color:a.headerText,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"13px",lineHeight:"14px",marginLeft:"4px",marginRight:"4px"}),iteratorTooltip:Object(D.eb)({color:a.headerIteratorTooltip,fontFace:"ms-fontSize-Secondary12",paddingBottom:"4px",paddingLeft:"8px",paddingRight:"8px",paddingTop:"4px",shadow:"ms-depth-8"}),iteratorIcon:Object(D.eb)({display:r?"flex":"none",height:"16px",width:"16px",color:"",justifyContent:"center",lineHeight:"14px",marginLeft:"4px",marginRight:"3px",cursor:"pointer",selectors:(n={},n[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{fill:"ButtonText"}),n)},(i={},i["svg > path.OfficeIconColors_DynamicColor"]={fill:a?a.headerBackArrowAndIterator:""},i)),changesCountText:Object(D.eb)({display:r?"flex":"none",height:"16px",width:"fill-content",color:a.headerText,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"13px",lineHeight:"16px",cursor:"pointer"})}})),R=o(816),A=o(906),k={overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},B=Object(V.c)((function(e,t,o,r){var n,i,a,l,c,d,p,u,h,g=T(o);return{root:Object(D.eb)({backgroundColor:e?g.versionCardRootSelectedBackgroundColor:g.versionCardRootBackgroundColor,marginLeft:"",marginRight:"",marginBottom:Object(A.b)()?"-3px":"",padding:"12px 0 12px 16px",display:"flex",flexFlow:"row",outline:"none",boxShadow:e?(t?"inset -4px 0 0 ":"inset 4px 0 0 ")+g.versionCardRootSelectedBoxShadow:"",selectors:(n={},n[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:e?"Highlight":"ButtonFace",color:e?"HighlightText":"ButtonText",boxShadow:e?(t?"inset -6px 0 0 ":"inset 6px 0 0 ")+(Object(A.b)()?"GrayText":"LinkText"):""}),n[":focus"]={backgroundColor:e?g.versionCardRootFocusSelectedBackgroundColor:g.versionCardRootFocusBackgroundColor,padding:"11px 0 11px 15px",border:"1px solid "+g.versionCardRootFocusBorder,boxShadow:e?(t?"inset -3px 0 0 ":"inset 3px 0 0 ")+g.versionCardRootSelectedBoxShadow:"",selectors:(i={},i[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",padding:"12px 0 12px 16px",border:"none",boxShadow:e?(t?"inset -6px 0 0 ":"inset 6px 0 0 ")+(Object(A.b)()?"GrayText":"LinkText"):""}),i)},n[":hover"]={backgroundColor:g.versionCardRootHoverBackground,selectors:(a={},a[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText"}),a)},n[":active"]={backgroundColor:g.versionCardRootActiveBackground,selectors:(l={},l[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"Highlight"}),l)},n)},k),cardMouseDownStyleForIE:Object(D.eb)({position:"relative",padding:"11px 0 11px 15px",boxShadow:e?(t?"inset -3px 0 0":"inset 3px 0 0 ")+g.versionCardRootSelectedBoxShadow:"",border:"1px solid "+g.versionCardRootFocusBorder,selectors:{":hover":{backgroundColor:g.versionCardRootActiveBackground,selectors:(c={},c[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",padding:"12px 0 12px 16px",boxShadow:e?(t?"inset -6px 0 0 ":"inset 6px 0 0 ")+"GrayText":"",border:"none"}),c)}}}),body:Object(D.eb)({width:"100%",display:"flex",flexFlow:"column",cursor:"pointer",selectors:(d={},d[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{color:"inherit"}),d)}),authorBold:Object(D.eb)({display:"inline-block",fontWeight:"inherit",marginTop:""}),miniAuthorDiv:Object(D.eb)({display:"flex",flexFlow:"row",marginLeft:"20px",marginRight:"20px",marginTop:"4px",selectors:(p={},p[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{color:"inherit"}),p)}),authorName:Object(D.eb)({color:g.versionCardAuthorNameColor,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"11px",marginLeft:"6px",selectors:(u={},u[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{color:"inherit"}),u)}),groupContextMenuDiv:Object(D.eb)({display:"inline-block",position:"relative",float:"right",marginRight:"16px",height:"14px",maxWidth:Object(A.b)()?"22px":"14px"}),groupTimestampDiv:Object(D.eb)({display:"inline-block"}),groupTimestampMenuDiv:Object(D.eb)({display:"inline-block",width:"auto",color:g.versionCardTimestampColor,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontWeight:e?"600":"normal",fontSize:"11px",marginTop:"",marginLeft:"20px",marginRight:"",selectors:(h={},h[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{color:"inherit"}),h)})}})),N=o(937);function j(e,t,o){var r=t||new Date,n=(r.getTime()-e.getTime())/1e3,i=Math.floor((r.getTime()-6e4*r.getTimezoneOffset())/864e5),s=Math.floor((e.getTime()-6e4*e.getTimezoneOffset())/864e5),d=r.getTime()-(36e5*r.getHours()+6e4*r.getMinutes()+1e3*r.getSeconds())-(r.getDay()+6)%7*864e5,p=d-6048e5,u=p-6048e5,h=u-6048e5,g=N.namespace();if(g.setup({locale:P(),missingTranslation:"ignore"}),null!=o){if(e<=r){if(n<120)return{friendlyDateString:o.JustNow,friendlyGroupString:o.TodayVersionsLabel};if(n<3600){var m=Math.floor(n/60);return isNaN(m)?(a.a.sendTraceTag(594883874,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"Minutes ago is NaN, input date was: "+e.toUTCString()),{friendlyDateString:W(e),friendlyGroupString:o.TodayVersionsLabel}):{friendlyDateString:g(o.MinutesAgo,{mins:m}),friendlyGroupString:o.TodayVersionsLabel}}if(s===i){var f=Math.floor(n/3600);return isNaN(f)?(a.a.sendTraceTag(594883875,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"Hours ago is NaN, input date was: "+e.toUTCString()),{friendlyDateString:W(e),friendlyGroupString:o.TodayVersionsLabel}):{friendlyDateString:g(o.HoursAgo,{hours:f}),friendlyGroupString:o.TodayVersionsLabel}}if(s===i-1)return{friendlyDateString:o.YesterdayWithTime.replace("{0}",W(e)),friendlyGroupString:o.YesterdayVersionsLabel};if(e.getTime()>=d){var v=Intl.DateTimeFormat(P(),{weekday:"long"}).format(e);return{friendlyDateString:o.DateTimeComboNoAt.replace("{0}",v).replace("{1}",W(e)),friendlyGroupString:v}}if(e.getTime()>=p)return L(e,o);if(e.getTime()>=u&&e.getMonth()===r.getMonth())return L(e,o);if(e.getTime()>=h&&e.getMonth()===r.getMonth())return L(e,o);if(function(e,t){return e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}(e,r))return L(e,o);if(function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()-1}(e,r))return L(e,o);if(e.getFullYear()===r.getFullYear())return L(e,o);var b=Intl.DateTimeFormat(P(),{month:"long",day:"numeric",year:"numeric"}).format(e);return{friendlyDateString:o.DateTimeComboNoAt.replace("{0}",b).replace("{1}",W(e)),friendlyGroupString:b}}return{friendlyDateString:o.JustNow,friendlyGroupString:o.TodayVersionsLabel}}return a.a.sendTraceTag(595682912,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"localizedStrings is null. Version date: "+e.toUTCString()+", Now: "+r.toUTCString()),{friendlyDateString:Intl.DateTimeFormat(P(),{month:"long",day:"numeric",year:"numeric"}).format(e>r?r:e),friendlyGroupString:Intl.DateTimeFormat(P(),{month:"long",day:"numeric",year:"numeric"}).format(e>r?r:e)}}function L(e,t){var o=Intl.DateTimeFormat(P(),{month:"long",day:"numeric"}).format(e);return{friendlyDateString:t.DateTimeComboNoAt.replace("{0}",o).replace("{1}",W(e)),friendlyGroupString:o}}function W(e){return Intl.DateTimeFormat(P(),{hour:"numeric",minute:"numeric"}).format(e)}function P(){return f.UILocale}var z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.componentDidMount=function(){G.register(this)},t.prototype.componentWillUnmount=function(){G.unregister(this)},t.prototype.render=function(){return j(this.props.date,void 0,this.props.localizedStrings).friendlyDateString},t}(S.PureComponent),G=new(function(){function e(){this.components=[]}return e.prototype.register=function(e){var t=this;this.components.push(e),void 0===this.timerId&&(this.timerId=window.setInterval((function(){return t.onTimerFired()}),6e4))},e.prototype.unregister=function(e){this.components=this.components.filter((function(t){return t!==e})),this.components.length||window.clearInterval(this.timerId)},e.prototype.onTimerFired=function(){this.components.forEach((function(e){return e.forceUpdate()}))},e}()),M=Object(V.c)((function(e,t){var o,r;void 0===t&&(t=!1);var n=T(t).versionCardAuthorNameColor;return{authorRole:Object(D.eb)({fontWeight:"normal",fontSize:"12px",color:n,selectors:(o={},o[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{color:"inherit"}),o)}),authorName:Object(D.eb)({color:n,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",fontWeight:600,selectors:(r={},r[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{color:"inherit"}),r)}),colorBlock:Object(D.eb)({backgroundColor:e,width:"8px",height:"8px",marginRight:"4px",display:"inline-block"})}})),U=o(2580);function q(e,t){return e.EmailAddress==t.EmailAddress&&e.LogOnName==t.LogOnName&&e.UserName==t.UserName}function X(e){switch(e){case i.Rename:return 4;case i.Restore:return 2}return 0}var J=o(2448);function K(e,t){return t||e.GuestUserDisplayName}var Y=S.memo((function(e){var t=K(e.localizedStrings,e.name),o=function(e,t){return t||m.getInitialsColorFromName(e)}(t,e.color),r=M(o,Object(J.b)()),n=e.role?e.role:e.actionType?function(e,t){switch(e){case 1:return t.UserAction;case 4:return t.UserRenameAction;case 2:case 3:return t.UserRestoreAction}}(e.actionType,e.localizedStrings):void 0;if(n){var i=Object(U.a)(e.localizedStrings.UserActionComboString,(function(e){return"0"===e?S.createElement("span",{className:r.authorName},S.createElement("span",{className:r.colorBlock,"data-is-focusable":!1}),t):"1"===e?S.createElement("span",{className:r.authorRole},n):""}));return S.createElement("span",null,i)}var s=e.actionType?function(e,t){switch(e){case 5:return t.UserModifyRenameActions;case 6:case 7:return t.UserRestoreRenameActions}}(e.actionType,e.localizedStrings):void 0;if(s){i=Object(U.a)(s,(function(e){return"0"===e?S.createElement("span",{className:r.authorName},S.createElement("span",{className:r.colorBlock,"data-is-focusable":!1}),t):""}));return S.createElement("span",{className:r.authorRole},i)}return S.createElement("span",{className:r.authorName},S.createElement("span",{className:r.colorBlock}),t)})),Z=o(109),Q=o(2846),$=o(737),ee=o(381),te=o.n(ee),oe=Object(V.c)((function(e){var t,o,r;return{contextMenuButtonStyles:{rootHasMenu:{display:"inline-flex",position:"relative",height:"16px",width:"16px",padding:"0",selectors:(t={},t[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{color:"ButtonText",fill:"ButtonText"}),t[":hover"]={selectors:(o={},o[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{color:"HighlightText",fill:"HighlightText"}),o)},t[":focus"]={selectors:(r={},r[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{outline:"1px Solid HighlightText"}),r)},t),direction:e?"rtl":"ltr"},menuIcon:{width:"12px",margin:"0 2px"}},contextMenuItemStyles:{root:{fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",fontWeight:"normal",height:"auto",width:"auto",direction:e?"rtl":"ltr"}},tooltipStyle:{root:{borderWidth:"1px",borderStyle:"solid",padding:"3px",margin:0},content:{fontSize:"10px"}}}}));function re(e,t){return void 0===t&&(t="versionHistorySprite"),t+"."+e}var ne=function(){function e(){}return e.isEnableMenu=function(t,o){return e.isSaveEnabled(t)||e.isDownloadEnabled(t)||e.isDeleteEnabled(t,o)},e.isSaveEnabled=function(e){return!e.disableSaveACopy&&e.wdEnableSaveACopy&&e.wdEnableSaveACopyOverFlowMenu},e.isDownloadEnabled=function(e){return!e.disableSaveACopy},e.isDeleteEnabled=function(e,t){return e.wdEnableDeleteVersions&&!t},e}(),ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._contextMenuRef=S.createRef(),t}return Object(s.__extends)(t,e),t.prototype.render=function(){var e=oe(this.props.appSettings.isRtl),t=[];if(this.props.onSaveACopyClicked&&t.push({key:"vh-save-a-copy",name:this.props.localizedStrings.SaveACopy,styles:e.contextMenuItemStyles,onClick:this.props.onSaveACopyClicked}),this.props.onDownloadVersionClicked&&t.push({key:"vh-download-version",name:this.props.localizedStrings.Download,styles:e.contextMenuItemStyles,onClick:this.props.onDownloadVersionClicked}),this.props.onDeleteVersionsClicked&&t.push({key:"vh-delete-versions",name:this.props.localizedStrings.Delete,styles:e.contextMenuItemStyles,onClick:this.props.onDeleteVersionsClicked}),t.length<1)return null;var o={iconName:re(te.a?te.a.Ellipsis_12:"")},r={items:t},n={styles:e.tooltipStyle},i={gapSpace:0,beakWidth:5,directionalHint:Z.a.topAutoEdge};return S.createElement(Q.a,{content:this.props.localizedStrings.MoreOptions,calloutProps:i,tooltipProps:n},S.createElement($.a,{id:"vh-context-menu",componentRef:this._contextMenuRef,styles:e.contextMenuButtonStyles,ariaLabel:this.props.localizedStrings.MoreOptions,menuProps:r,menuIconProps:o}))},t.prototype.openMenu=function(){var e;null===(e=this._contextMenuRef.current)||void 0===e||e.openMenu()},t}(S.Component),se=o(354),ae=o(3),le=function(e){function t(t){var o=e.call(this,t)||this;return o._root=S.createRef(),o._rootHTMLElement=null,o._contextMenu=S.createRef(),o.onFocus=function(){o._root.current&&(o._root.current.tabIndex=-1,o._root.current.focus(),o._rootHTMLElement||(o._rootHTMLElement=document.getElementById(o._root.current.id)),o._rootHTMLElement&&Object(R.b)(!0,o._rootHTMLElement))},o.onClick=function(){var e={currentVersion:o.props.currentVersion,baseVersion:o.props.baseVersion,noBaseToCompareTo:!o.props.baseVersion};o.props.onVersionSelectedAction(e),a.a.sendTraceTag(595632832,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"User manually selected a version"),Object(ae.logUserAction)("VersionHistorySelectVersion")},o.onContextMenu=function(e){var t;e.preventDefault(),null===(t=o._contextMenu.current)||void 0===t||t.openMenu()},o.onKeyDownInCard=function(e){if(e.shiftKey&&(e.which||e.keyCode)===I.a.f10)return void o.onContextMenu(e);(e.which===I.a.left&&!o.props.appSettings.isRtl||e.which===I.a.right&&o.props.appSettings.isRtl)&&o.props.onLeftButton&&o.props.onLeftButton()},o.onCardMouseDownHandlerForIE=function(){var e=B(o.props.isSelected,o.props.appSettings.isRtl,Object(J.b)(),o.props.appSettings.appName);o._root&&o._root.current&&o._root.current.classList.toggle(e.cardMouseDownStyleForIE)},o.onCardMouseUpHandlerForIE=function(){var e=B(o.props.isSelected,o.props.appSettings.isRtl,Object(J.b)(),o.props.appSettings.appName);o._root&&o._root.current&&(o._root.current.classList.toggle(e.cardMouseDownStyleForIE),o._root.current.focus())},o.onDownloadVersionClicked=function(){var e;o.props.onDownloadVersionSelectedAction&&(a.a.sendTraceTag(592316623,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"Download clicked."),o.props.onDownloadVersionSelectedAction(null!==(e=o.props.currentVersion.DownloadUrl)&&void 0!==e?e:""))},o.onSaveACopyClicked=function(){var e;o.props.onSaveACopySelectedAction&&(a.a.sendTraceTag(592065615,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"SaveACopy clicked."),o.props.onSaveACopySelectedAction(null!==(e=o.props.currentVersion.DownloadUrl)&&void 0!==e?e:""))},o.onDeleteVersionsClicked=function(){o.props.onDeleteVersionsSelectedAction&&o.props.currentVersion.RevisionID&&(a.a.sendTraceTag(590147736,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"DeleteVersions clicked."),o.props.onDeleteVersionsSelectedAction([o.props.currentVersion.RevisionID]))},o}return Object(s.__extends)(t,e),t.prototype.render=function(){var e,t,o=this,r=this.props,n=r.currentVersion,i=r.isSelected,d=r.ariaPosinset,p=r.ariaSetsize,u=B(i,this.props.appSettings.isRtl,Object(J.b)(),this.props.appSettings.appName),h=[],g=(t=[],(e=n).Authors&&e.Authors.length>0?e.Authors.forEach((function(e){e&&t.push({type:1,author:e})})):t.push({type:1,author:{UserName:e.AuthorID}}),e.Events&&e.Events.forEach((function(e){if(e&&e.Author){for(var o=!1,r=0,n=t;r<n.length;r++){var i=n[r];q(i.author,e.Author)&&(o=!0,i.type|=X(e.Type))}o||t.push({author:e.Author,type:X(e.Type)})}})),{time:e.Time,events:t});if(!g.time)return a.a.sendTraceTag(594367690,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({msg:"Version missing timestamp or author",id:n.RevisionID})),!1;g.events.forEach((function(e){if(e){var t="".concat(n.RevisionID,"_").concat(Object(y.a)());h.push(S.createElement("div",{className:u.miniAuthorDiv},S.createElement(Y,{key:t,name:e.author.UserName,color:e.author.InitialsColor,actionType:e.type,localizedStrings:o.props.localizedStrings})))}}));var m=S.createElement(z,{date:g.time,localizedStrings:this.props.localizedStrings});return S.createElement("div",Object(s.__assign)({ref:this._root,id:"vhCard"+this.props.currentVersion.RevisionID,onClick:this.onClick,className:u.root,"data-is-focusable":!0,"data-unique-id":this.props.currentVersion.RevisionID,"aria-selected":i,role:"treeitem","aria-posinset":d,"aria-setsize":p,onKeyDown:this.onKeyDownInCard},Object(se.d)()?{onMouseDown:this.onCardMouseDownHandlerForIE,onMouseUp:this.onCardMouseUpHandlerForIE}:{}),S.createElement("div",{className:u.body},S.createElement("div",{className:u.groupTimestampMenuDiv},S.createElement("div",{className:u.groupTimestampDiv},m),this.isShowContextMenu()&&S.createElement("div",{className:u.groupContextMenuDiv},this.getVersionHistoryContextMenu())),S.createElement("div",{className:u.authorBold},h)))},t.prototype.isShowContextMenu=function(){return ne.isEnableMenu(this.props.appSettings,this.props.isTipVersion)&&this.props.isSelected},t.prototype.getVersionHistoryContextMenu=function(){return S.createElement(ie,{ref:this._contextMenu,appSettings:this.props.appSettings,localizedStrings:this.props.localizedStrings,onDownloadVersionClicked:ne.isDownloadEnabled(this.props.appSettings)?this.onDownloadVersionClicked:void 0,onSaveACopyClicked:ne.isSaveEnabled(this.props.appSettings)?this.onSaveACopyClicked:void 0,onDeleteVersionsClicked:ne.isDeleteEnabled(this.props.appSettings,this.props.isTipVersion)?this.onDeleteVersionsClicked:void 0})},t}(S.Component),ce=o(2860),de=Object(V.c)((function(e,t,o,r){var n,i,a,l,c,d,p,u,h,g,m,f,v,b,C,S=T(o),_={height:"16px",width:"16px",color:S.versionCardExpandCollapseIconColor,lineHeight:"16px",verticalAlign:"center",display:"none",cursor:"pointer"},y={display:"flex",width:"auto",padding:"15px 0 15px 11px",border:"1px solid transparent",selectors:(n={},n[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:e?"Highlight":"ButtonFace",color:e?"HighlightText":"ButtonText",fill:e?"HighlightText":"ButtonText"}),n["svg > path.OfficeIconColors_m22"]={selectors:(i={},i[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{fill:e?"HighlightText !important":"ButtonText !important"}),i)},n[":hover"]={backgroundColor:S.versionCardRootHoverBackground,selectors:(a={},a[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",fill:"HighlightText"}),a)},n[":hover svg > path.OfficeIconColors_m22"]={selectors:(l={},l[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{fill:"HighlightText !important"}),l)},n[":focus"]={outline:"0",border:"1px solid "+S.versionCardRootFocusBorder,boxShadow:e?(t?"inset -3px 0 0 ":"inset 3px 0 0 ")+S.versionCardRootSelectedBoxShadow:"",padding:"15px 0 15px 11px",selectors:(c={},c[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",fill:"HighlightText",boxShadow:e?(t?"inset -6px 0 0 ":"inset 6px 0 0 ")+(Object(A.b)()?"GrayText":"LinkText"):"",border:"none",padding:"16px 0 16px 12px"}),c)},n[":focus svg > path.OfficeIconColors_m22"]={selectors:(d={},d[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{fill:"HighlightText !important"}),d)},n[":active"]={backgroundColor:S.versionCardRootActiveBackground,selectors:(p={},p[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",fill:"HighlightText"}),p)},n[":active svg > path.OfficeIconColors_m22"]={selectors:(u={},u[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{fill:"HighlightText !important"}),u)},n)};return{toggleSpan:Object(D.eb)({flexBasis:"16px",height:"16px",width:"16px"}),sectionName:Object(D.eb)({display:"inline-flex",color:S.versionCardTimestampColor,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"15px",fontWeight:"normal",selectors:(h={},h[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{color:"inherit"}),h)}),sectionHeaderFocusBackground:Object(D.eb)({padding:"15px 0 15px 11px",boxShadow:e?(t?"inset -3px 0 0 ":"inset 3px 0 0 ")+S.versionCardRootSelectedBoxShadow:"",backgroundColor:e?S.versionCardRootSelectedBackgroundColor:S.versionCardRootFocusBackgroundColor,border:"1px solid "+S.versionCardRootFocusBorder,selectors:(g={},g[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{boxShadow:e?(t?"inset -6px 0 0":"inset 6px 0 0 ")+(Object(A.b)()?"GrayText":"LinkText"):"",border:"none",padding:"16px 0 16px 12px"}),g)},y),sectionHeader:Object(D.eb)({boxShadow:e?(t?"inset -4px 0 0 ":"inset 4px 0 0 ")+S.versionCardRootSelectedBoxShadow:"",backgroundColor:e?S.versionCardRootSelectedBackgroundColor:S.versionCardRootBackgroundColor,selectors:(m={},m[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{boxShadow:e?(t?"inset -6px 0 0":"inset 6px 0 0 ")+(Object(A.b)()?"GrayText":"LinkText"):""}),m)},y),sectionHeaderMouseDownStyleForIE:Object(D.eb)({position:"relative",padding:"15px 0 15px 11px",boxShadow:e?(t?"inset -3px 0 0 ":"inset 3px 0 0 ")+S.versionCardRootSelectedBoxShadow:"",border:"1px solid "+S.versionCardRootFocusBorder,selectors:{":hover":{backgroundColor:S.versionCardRootActiveBackground,selectors:(f={},f[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",padding:"16px 0 16px 12px",boxShadow:e?(t?"inset -6px 0 0 ":"inset 6px 0 0 ")+"GrayText":"",border:"none"}),f)}}}),sectionNameDiv:Object(D.eb)({width:"",flexBasis:"calc(100% - 20px)",color:S.versionCardTimestampColor,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",verticalAlign:"center",lineHeight:"16px",cursor:"pointer",marginRight:"8px",marginLeft:"8px",selectors:(v={},v[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{color:"inherit"}),v)}),currentVersionDiv:Object(D.eb)({fontSize:"12px",paddingTop:"4px",fontWeight:"normal",paddingBottom:"2px"}),authorsList:Object(D.eb)({fontSize:"12px",marginTop:"4px",fontWeight:"normal"}),expand:Object(D.eb)(Object(s.__assign)(Object(s.__assign)({},_),{display:"none"}),(b={},b["svg > path.OfficeIconColors_m22"]={fill:S?S.versionCardExpandCollapseIconColor:""},b)),collapse:Object(D.eb)(Object(s.__assign)(Object(s.__assign)({},_),{display:"inline-block"}),(C={},C["svg > path.OfficeIconColors_m22"]={fill:S?S.versionCardExpandCollapseIconColor:""},C)),versionList:Object(D.eb)({display:"none"}),contextMenuDiv:Object(D.eb)({display:"inline-block",position:"relative",float:"right",top:"",marginRight:"8px",height:"16px",width:"16px",maxWidth:Object(A.b)()?"22px":"16px"}),timestampDiv:Object(D.eb)({display:"inline-block"}),versionItemDiv:Object(D.eb)({display:"inline-block",width:"100%",padding:0,border:"none"})}})),pe=o(838),ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._list=S.createRef(),t._id=Object(y.a)(),t._header=S.createRef(),t._chevronButton=S.createRef(),t._headerHTMLElement=null,t._groupVersion=void 0,t._isExpanded=!1,t._firstVersionCard=void 0,t._headerDescribedBy="",t._contextMenu=S.createRef(),t.isShowContextMenu=function(){return ne.isEnableMenu(t.props.appSettings,t.props.containsTip)&&t.props.selectedGroupName===t.props.label},t.onDownloadVersionClicked=function(){var e;a.a.sendTraceTag(593293320,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"Download clicked."),t.props.onDownloadVersionSelectedAction(null!==(e=t.props.currentSectionVersion.DownloadUrl)&&void 0!==e?e:"")},t.onSaveACopyClicked=function(){var e;a.a.sendTraceTag(591987292,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"Save a copy clicked."),t.props.onSaveACopySelectedAction(null!==(e=t.props.currentSectionVersion.DownloadUrl)&&void 0!==e?e:"")},t.onDeleteVersionsClicked=function(){a.a.sendTraceTag(590147735,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"DeleteVersions clicked.");var e=[];t.props.versions.forEach((function(t){return t.RevisionID?e.push(t.RevisionID):void 0})),t.props.onDeleteVersionsSelectedAction(e)},t.setDescribedBy=function(){t._isExpanded?t._headerDescribedBy="":t._headerDescribedBy=t._id+"DisplayString "+t._id+"AuthorList",t.props.containsTip&&(t._headerDescribedBy+=" "+t._id+"Tip"),t._header&&t._header.current&&t._header.current.setAttribute("aria-describedby",t._headerDescribedBy)},t.onSectionHeaderFocus=function(){var e=de(t.props.selectedGroupName===t.props.label,t.props.appSettings.isRtl,Object(J.b)(),t.props.appSettings.appName);t._header&&t._header.current&&(t._header.current.className=e.sectionHeaderFocusBackground)},t.onSectionHeaderBlur=function(){var e=de(t.props.selectedGroupName===t.props.label,t.props.appSettings.isRtl,Object(J.b)(),t.props.appSettings.appName);t._header&&t._header.current&&(t._header.current.className=e.sectionHeader)},t.onSectionHeaderMouseDownHandlerForIE=function(){var e=de(t.props.selectedGroupName===t.props.label,t.props.appSettings.isRtl,Object(J.b)(),t.props.appSettings.appName);t._header&&t._header.current&&t._header.current.classList.toggle(e.sectionHeaderMouseDownStyleForIE)},t.onSectionHeaderMouseUpHandlerForIE=function(){var e=de(t.props.selectedGroupName===t.props.label,t.props.appSettings.isRtl,Object(J.b)(),t.props.appSettings.appName);t._header&&t._header.current&&(t._header.current.classList.toggle(e.sectionHeaderMouseDownStyleForIE),t._header.current.focus())},t.renderToggleSpan=function(e){return S.createElement("span",{className:e.toggleSpan,ref:t._chevronButton,"aria-expanded":"false",role:"button",onClick:t.onSectionIconClick,"aria-label":t.props.localizedStrings.ExpandCollapseChevronButtonAriaLabel.replace("{0}",t.props.clickableGroupChevronAriaLabel)},S.createElement(pe.a,{id:t._id+"IconExpand",className:e.expand,iconName:re(te.a?te.a.CommonControlChevronDown_16:"")}),S.createElement(pe.a,{id:t._id+"IconCollapse",className:e.collapse,iconName:re(te.a?t.props.appSettings.isRtl?te.a.CommonControlChevronLeft_16:te.a.CommonControlChevronRight_16:"")}))},t.renderVersionCardList=function(e){return S.createElement(ce.a,{id:t._id,className:e.versionList,ref:t._list,items:t.props.versions,onRenderCell:t.onRenderListItem,onShouldVirtualize:t.onShouldVirtualize,getKey:t.getListItemKey,role:"presentation"})},t.renderAndSetAuthorList=function(){var e=de(t.props.selectedGroupName===t.props.label,t.props.appSettings.isRtl,Object(J.b)(),t.props.appSettings.appName),o=he(t.props.versions,t.props.localizedStrings),r=[];switch(o.length){case 0:a.a.sendTraceTag(595644672,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"there were no authors to display");break;case 1:r=t.render1To4Authors(t.props.localizedStrings.OneUserAuthorList,o);break;case 2:r=t.render1To4Authors(t.props.localizedStrings.TwoUserAuthorList,o);break;case 3:r=t.render1To4Authors(t.props.localizedStrings.ThreeUserAuthorList,o);break;case 4:r=t.render1To4Authors(t.props.localizedStrings.FourUserAuthorList,o);break;default:r=Object(U.a)(t.props.localizedStrings.FivePlusUserAuthorList,(function(e){return"3"===e?(o.length-3).toString():t.renderAuthor(o[parseInt(e,10)])}))}return t._groupVersion&&(t._groupVersion.Authors=o),S.createElement("div",{id:t._id+"AuthorList",className:e.authorsList},r)},t.render1To4Authors=function(e,o){return Object(U.a)(e,(function(e){return t.renderAuthor(o[parseInt(e,10)])}))},t.renderAuthor=function(e){return S.createElement(Y,{name:e.UserName,color:e.InitialsColor,localizedStrings:t.props.localizedStrings})},t.getListItemKey=function(e,t){return e.RevisionID||""},t.getBaseVersion=function(e,t,o){var r=null;return t.forEach((function(n,i){n===e&&(r=i!==t.length-1?t[i+1]:o)})),r},t.onShouldVirtualize=function(){return!1},t._commonCardProps={localizedStrings:t.props.localizedStrings,onVersionSelectedAction:t.props.onVersionSelectedAction},t.onRenderListItem=function(e,o){if(void 0!==e){var r=de(t.props.selectedGroupName===t.props.label,t.props.appSettings.isRtl,Object(J.b)(),t.props.appSettings.appName),n=new le({localizedStrings:t._commonCardProps.localizedStrings,currentVersion:e,baseVersion:t.getBaseVersion(e,t.props.versions,t.props.finalBaseVersion),isSelected:!t.props.selectedGroupName&&t.props.selectedVersionId===e.RevisionID,ariaPosinset:void 0!==o?o+1:0,ariaSetsize:t.props.versions.length,appSettings:t.props.appSettings,isTipVersion:0===o&&t.props.containsTip,onVersionSelectedAction:t._commonCardProps.onVersionSelectedAction,onLeftButton:t.programaticFocus,onDownloadVersionSelectedAction:t.props.onDownloadVersionSelectedAction,onSaveACopySelectedAction:t.props.onSaveACopySelectedAction,onDeleteVersionsSelectedAction:t.props.onDeleteVersionsSelectedAction});return 0===o&&(t._firstVersionCard=n),S.createElement("div",{className:r.versionItemDiv,role:"presentation"},n.render())}},t.onSectionIconClick=function(e){t.expandOrCollapseSubsection(!t.isListVisible()),e.stopPropagation()},t.onSectionClicked=function(){a.a.sendTraceTag(595632606,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"group section header manually selected"),Object(ae.logUserAction)("VersionHistorySelectVersionGroup"),t.onSectionSelected()},t.onSectionSelected=function(){var e={currentVersion:t._groupVersion?t._groupVersion:t.props.currentSectionVersion,baseVersion:t.props.finalBaseVersion,groupName:t.props.label,noBaseToCompareTo:!t.props.finalBaseVersion};t.props.onVersionSelectedAction(e),t.isListVisible()&&t.expandOrCollapseSubsection(!1),(t.props.appSettings.wdEnableDeleteVersions||t.props.appSettings.wdEnableSaveACopyOverFlowMenu)&&t.programaticFocus()},t.isListVisible=function(){var e=document.getElementById(t._id);return null!=e&&"block"===e.style.display},t.onContextMenu=function(e){var o;e.preventDefault(),null===(o=t._contextMenu.current)||void 0===o||o.openMenu()},t.onKeyDownInSectionHeader=function(e){if(e.shiftKey&&(e.which||e.keyCode)===I.a.f10)return void t.onContextMenu(e);e.which===I.a.left&&!t.props.appSettings.isRtl||e.which===I.a.right&&t.props.appSettings.isRtl?t.expandOrCollapseSubsection(!1):(e.which===I.a.right&&!t.props.appSettings.isRtl||e.which===I.a.left&&t.props.appSettings.isRtl)&&(t._isExpanded?t._firstVersionCard&&t._firstVersionCard.onFocus():t.expandOrCollapseSubsection(!0)),e.which===I.a.enter&&t.onSectionSelected()},t.programaticFocus=function(){t._header&&t._header.current&&(t._header.current.focus(),t._headerHTMLElement||(t._headerHTMLElement=document.getElementById(t._header.current.id)),t._headerHTMLElement&&Object(R.b)(!0,t._headerHTMLElement))},t.displayElement=function(e,t){t&&(t.style.display=e?"block":"none")},t.setAriaExpanded=function(e,t){null==t||t.setAttribute("aria-expanded",e?"true":"false")},t}return Object(s.__extends)(t,e),t.prototype.render=function(){var e=de(this.props.selectedGroupName===this.props.label,this.props.appSettings.isRtl,Object(J.b)(),this.props.appSettings.appName),t=this.props.versions;this._groupVersion=Object(s.__assign)({},this.props.currentSectionVersion);var o=this.renderAndSetAuthorList();this.props.selectedGroupName===this._groupVersion.RevisionID&&this.onSectionSelected(),this.setDescribedBy();var r="";this.props.versions.forEach((function(e){r+="vhCard"+e.RevisionID+" "}));var n=this.props.clickableGroupDisplayString;return this.props.containsTip&&(n=this.props.localizedStrings.CurrentVersionGroupHeaderAriaText.replace("{0}",this.props.clickableGroupDisplayString)),S.createElement(S.Fragment,null,t.length>0&&S.createElement("div",{id:this._id+"GroupDiv"},S.createElement("div",Object(s.__assign)({id:this._id+"GroupHeaderDiv",className:1===this.props.positionInSet?[e.sectionHeader,this.props.classNameForItemToBeDefaultFocused].join(" "):e.sectionHeader,onKeyDown:this.onKeyDownInSectionHeader,"aria-label":n,role:"treeitem","aria-expanded":"false",ref:this._header,"aria-level":1,"aria-owns":r,"aria-posinset":this.props.positionInSet,"aria-setsize":this.props.subsectionCount,"data-is-focusable":!0,onClick:this.onSectionClicked},Object(se.d)()?{onMouseDown:this.onSectionHeaderMouseDownHandlerForIE,onMouseUp:this.onSectionHeaderMouseUpHandlerForIE}:{onFocus:this.onSectionHeaderFocus,onBlur:this.onSectionHeaderBlur},{"aria-describedby":this._headerDescribedBy,"aria-selected":this.props.selectedGroupName===this.props.label}),this.renderToggleSpan(e),S.createElement("div",{className:e.sectionNameDiv},S.createElement("div",{className:e.sectionName,id:this._id+"DisplayString"},S.createElement("div",{className:e.timestampDiv},this.props.clickableGroupDisplayString)),this.isShowContextMenu()&&S.createElement("div",{className:e.contextMenuDiv},S.createElement(ie,{ref:this._contextMenu,appSettings:this.props.appSettings,localizedStrings:this.props.localizedStrings,onDownloadVersionClicked:ne.isDownloadEnabled(this.props.appSettings)?this.onDownloadVersionClicked:void 0,onSaveACopyClicked:ne.isSaveEnabled(this.props.appSettings)?this.onSaveACopyClicked:void 0,onDeleteVersionsClicked:ne.isDeleteEnabled(this.props.appSettings,this.props.containsTip)?this.onDeleteVersionsClicked:void 0})),this.props.containsTip&&S.createElement("div",{className:e.currentVersionDiv,id:this._id+"Tip"},this.props.localizedStrings.CurrentVersion),o)),this.renderVersionCardList(e)))},t.prototype.componentDidUpdate=function(){},t.prototype.expandOrCollapseSubsection=function(e){this.displayElement(!e,document.getElementById(this._id+"IconCollapse")),this.displayElement(!e,document.getElementById(this._id+"AuthorList")),this.displayElement(e,document.getElementById(this._id)),this.displayElement(e,document.getElementById(this._id+"IconExpand"));var t=this._header.current;this.setAriaExpanded(e,t);var o=this._chevronButton.current;this.setAriaExpanded(e,o),this._isExpanded=e,this.setDescribedBy(),e?a.a.sendTraceTag(595632607,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"group section expanded"):a.a.sendTraceTag(595632608,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"group section collapsed")},t}(S.PureComponent);function he(e,t){var o=[];return e.forEach((function(e){if(e.Authors&&e.Authors.length>0)e.Authors.forEach((function(e){e&&(o.some((function(t){return q(t,e)}))||o.push(e))}));else{var r=K(t,e.AuthorID);if(o.some((function(e){return e.UserName===r})))return;var n={UserName:r};o.push(n)}e.Events&&e.Events.forEach((function(e){if(e&&e.Author){var r=e.Author;if(void 0===r.UserName||null===r.UserName){var n=K(t,r.UserName);if(o.some((function(e){return e.UserName===n})))return}if(o.some((function(e){return q(e,r)})))return;o.push(r)}else;}))})),o}var ge=Object(V.c)((function(){return{nothingFoundRoot:Object(D.eb)({display:"flex",flex:"none",margin:"1px 8px"}),nothingFoundText:Object(D.eb)({padding:"14px",textAlign:"center",margin:"0 auto"})}})),me=o(2412),fe=o(1450),ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._nothingFoundId=Object(y.a)(),t}return Object(s.__extends)(t,e),t.prototype.render=function(){var e=this,t=ge(),o=this.props,r=o.localizedStrings,n=o.versions,i=[];n.forEach((function(e,t){var o=j(e.Time,void 0,r),s=o.friendlyGroupString,a=i.length,l=a>0&&i[a-1].versions.length>0?i[a-1].startIndex:null;0===a?i.push({versions:[e],label:s,startIndex:t,clickableGroupDisplayString:o.friendlyDateString,clickableGroupChevronAriaLabel:o.friendlyGroupString,finalBaseVersion:null,currentSectionVersion:e,containsTip:!0}):v(n,l,t)?i[a-1].versions.push(e):(i[a-1].finalBaseVersion=e,i.push({versions:[e],label:t===n.length-1?s+"_2":s,startIndex:t,clickableGroupDisplayString:o.friendlyDateString,clickableGroupChevronAriaLabel:o.friendlyGroupString,finalBaseVersion:null,currentSectionVersion:e,containsTip:!1}))})),this.props.selectedVersionId||a.a.sendTraceTag(587544262,l.a.msoulscat_Wac_VersionHistory,c.a.Info,JSON.stringify({msg:"Grouped section generated",versionCount:n.length,groupCount:i.length}));var d={selectedVersionId:this.props.selectedVersionId,localizedStrings:this.props.localizedStrings,appSettings:this.props.appSettings,onVersionSelectedAction:this.props.onVersionSelectedAction,onDownloadVersionSelectedAction:this.props.onDownloadVersionSelectedAction,onSaveACopySelectedAction:this.props.onSaveACopySelectedAction,onDeleteVersionsSelectedAction:this.props.onDeleteVersionsSelectedAction};return S.createElement(S.Fragment,null,n.length?S.createElement(me.a,{direction:fe.a.vertical,role:"tree"},i.length>0&&i.map((function(t,o){return S.createElement(ue,Object(s.__assign)({key:t.label,label:t.label,clickableGroupDisplayString:t.clickableGroupDisplayString,clickableGroupChevronAriaLabel:t.clickableGroupChevronAriaLabel,versions:t.versions,finalBaseVersion:t.finalBaseVersion,currentSectionVersion:t.currentSectionVersion,selectedGroupName:e.props.selectedGroupName,containsTip:t.containsTip,positionInSet:o+1,subsectionCount:i.length,classNameForItemToBeDefaultFocused:e.props.classNameForItemToBeDefaultFocused},d))}))):S.createElement("div",{className:t.nothingFoundRoot,tabIndex:0,"aria-labelledby":this._nothingFoundId,role:"note"},S.createElement("div",{className:t.nothingFoundText,id:this._nothingFoundId,"aria-hidden":!0},r.VersionHistoryTitle)))},t}(S.PureComponent),be=o(2848),Ce=o(2867),Se=o(429),_e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ftzone=S.createRef(),t._paneDescribedById="versionHistoryPane",t._classNameForItemToBeDefaultFocused="classNameForItemToBeDefaultFocused",t._iteratorRef=S.createRef(),t.showChangesChecked=!0,t.getToggleStyles=function(){return t.props.appSettings.wdExperimentWithIteratorLocation?{root:{height:16,marginLeft:12,float:"left",display:"flex"},label:{fontSize:13,order:0,marginLeft:0,marginRight:5,marginBottom:4,color:Object(J.b)()?"white":""},pill:{width:32,height:14,borderRadius:7,marginBottom:1},thumb:{width:4,height:4,borderRadius:"50%"},text:{display:"none"}}:{root:{height:14,marginLeft:12},label:{fontSize:13,order:0,marginLeft:0,marginRight:5,marginBottom:4,color:Object(J.b)()?"white":""},pill:{width:32,height:14,borderRadius:7,marginBottom:1},thumb:{width:4,height:4,borderRadius:"50%"},text:{display:"none"}}},t.getToggleTheme=function(){var e=T(Object(J.b)());return Object(J.b)()?{palette:{themePrimary:e.appColors.primary,themeSecondary:e.appColors.tint10,themeDark:e.appColors.shade10,neutralDark:e.appColors.shade20}}:{palette:{themePrimary:e.appColors.primary,themeSecondary:e.appColors.tint10,themeDark:e.appColors.shade10,neutralDark:e.appColors.shade20},semanticColors:{inputBackgroundChecked:e.appColors.tint10}}},t.renderStandardListView=function(){var e=O(Object(J.b)(),t.props.appSettings.wdEnableShowVersionChanges,t.props.appSettings.appName,t.isIteratorEnabled()),o=t.props,r=o.paneLoading,n=o.versions,i=o.viewerLoading,a=o.viewerError,l=o.selectedVersionId,c=!!t.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete&&(i||a),d={localizedStrings:t.props.localizedStrings,selectedVersionId:t.props.selectedVersionId,onVersionSelectedAction:t.props.onVersionSelectedAction,appSettings:t.props.appSettings},p=!1,u=!1,h="",g="";t.props.appSettings.wdExperimentWithIteratorLocation&&(p=!(r||void 0===l||c),u=t.isIteratorEnabled()&&p,t.props.totalChangesCount>=0&&t.props.currentChange<=t.props.totalChangesCount&&t.props.viewerLoading,g=0===t.props.totalChangesCount?t.props.localizedStrings.IteratorNoEditsToolTip:"",h=0===t.props.totalChangesCount?g:t.props.localizedStrings.IteratorTotalEditsLabel.replace("{0}",t.props.localizedStrings.IteratorEditsCountLabel.replace("{0}",t.props.currentChange.toString()).replace("{1}",t.props.totalChangesCount.toString())));var m=S.createElement(Ce.a,Object(s.__assign)({theme:Object(Se.a)(t.getToggleTheme()),styles:t.getToggleStyles(),defaultChecked:!0,label:t.props.appSettings.wdExperimentWithIteratorLocation?t.props.localizedStrings.ShowEditsText:t.props.localizedStrings.ShowChangesText,inlineLabel:!0,onChange:t.onShowVersionChangesChange},{disabled:t.props.appSettings.wdExperimentWithIteratorLocation?!p:r||void 0===l||c}));return S.createElement(S.Fragment,null,S.createElement("div",{className:e.paneHeader},d.localizedStrings.VersionHistoryTitle),S.createElement("div",{className:e.showChangesDiv},m,t.props.appSettings.wdExperimentWithIteratorLocation&&u&&t.showChangesChecked?t.renderIteratorSection(e,g,h,t.isIteratorEnabled()):""),r?S.createElement("div",{className:e.loadingDiv},S.createElement(H.a,{className:e.loadingSpinner,size:F.a.large})):S.createElement("div",{className:e.scrollRegion},S.createElement(ve,Object(s.__assign)({versions:n,selectedGroupName:t.props.selectedGroupName,classNameForItemToBeDefaultFocused:t._classNameForItemToBeDefaultFocused},d,{onDownloadVersionSelectedAction:t.props.onDownloadVersionSelectedAction,onSaveACopySelectedAction:t.props.onSaveACopySelectedAction,onDeleteVersionsSelectedAction:t.props.onDeleteVersionsSelectedAction}))))},t.focus=function(){return t._ftzone.current&&t._ftzone.current.focus()},t.isIteratorEnabled=function(){return!!t.props.appSettings.wdExperimentWithIteratorLocation&&(!!t.props.appSettings.wdEnableIterator&&t.props.appSettings.wdEnableIterator)},t.onIteratorPrevKeyDown=function(e){e.which!==I.a.enter&&e.which!==I.a.space||t.onIteratorPrevClick()},t.onIteratorNextKeyDown=function(e){e.which!==I.a.enter&&e.which!==I.a.space||t.onIteratorNextClick()},t.onIteratorNextClick=function(){t.props.totalChangesCount>0&&(a.a.sendTraceTag(595648670,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"Iterator Next clicked-current count:"+t.props.currentChange.toString()+" ,total count:"+t.props.totalChangesCount.toString()),Object(ae.logUserAction)("IteratorClicked"),t.props.onIteratorSelectedAction(!0))},t.onIteratorPrevClick=function(){t.props.totalChangesCount>0&&(a.a.sendTraceTag(595648671,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"Iterator Previous clicked-current count:"+t.props.currentChange.toString()+" ,total count:"+t.props.totalChangesCount.toString()),Object(ae.logUserAction)("IteratorClicked"),t.props.onIteratorSelectedAction(!1))},t.onKeyDown=function(e){e.which!==I.a.up&&e.which!==I.a.down||e.preventDefault()},t.onShowVersionChangesChange=function(e,o){void 0!==o&&(t.props.appSettings.wdExperimentWithIteratorLocation&&(t.showChangesChecked=o),o?(a.a.sendTraceTag(595637793,l.a.msoulscat_Wac_VersionHistory,c.a.Info,"Toggle Changes diffs turned on"),t.props.appSettings.wdExperimentWithIteratorLocation&&t._iteratorRef&&t._iteratorRef.current&&(t._iteratorRef.current.style.display="flex")):(a.a.sendTraceTag(595637794,l.a.msoulscat_Wac_VersionHistory,c.a.Info,"Toggle Changes diffs turned off"),t.props.appSettings.wdExperimentWithIteratorLocation&&t._iteratorRef&&t._iteratorRef.current&&(t._iteratorRef.current.style.display="none")),t.props.onShowVersionChangesToggledAction(o))},t}return Object(s.__extends)(t,e),t.prototype.render=function(){var e=O(Object(J.b)(),this.props.appSettings.wdEnableShowVersionChanges,this.props.appSettings.appName,!!this.props.appSettings.wdExperimentWithIteratorLocation&&this.isIteratorEnabled()),t=this.props.localizedStrings;return S.createElement(be.a,{componentRef:this._ftzone,onKeyDown:this.onKeyDown,className:e.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!0,firstFocusableSelector:this._classNameForItemToBeDefaultFocused,"aria-label":t.VersionHistoryTitle,"aria-describedby":this._paneDescribedById,role:"group","aria-roledescription":this.props.localizedStrings.PaneRoleDescription},this.renderStandardListView(),S.createElement("div",{id:this._paneDescribedById,className:e.hidden,"aria-hidden":!0},t.VersionHistoryTitle))},t.prototype.iteratorBackIcon=function(){return te.a?this.props.appSettings.isRtl?te.a.NextChevronPaddle_24:te.a.BackChevronPaddle_24:""},t.prototype.iteratorNextIcon=function(){return te.a?this.props.appSettings.isRtl?te.a.BackChevronPaddle_24:te.a.NextChevronPaddle_24:""},t.prototype.renderIteratorSection=function(e,t,o,r){if(r){var n=0===this.props.totalChangesCount?this.props.localizedStrings.IteratorPreviousButtonNoEditsString:this.props.localizedStrings.IteratorPreviousButtonXEditsString.replace("{0}",this.props.totalChangesCount.toString()),i={styles:{content:{color:T(Object(J.b)()).headerIteratorTooltip}}},s={root:{display:"inline-block"}};return S.createElement("div",{ref:this._iteratorRef,className:e.changesDiv},S.createElement("div",{id:"CountText",className:e.changesCountText,title:t,"aria-label":o},this.props.localizedStrings.IteratorEditsCountLabel.replace("{0}",this.props.currentChange.toString()).replace("{1}",this.props.totalChangesCount.toString())),S.createElement(Q.a,{content:0===this.props.totalChangesCount?t:this.props.localizedStrings.IteratorPreviousEditButtonLabel,directionalHint:Z.a.topCenter,className:e.iteratorTooltip,tooltipProps:i,styles:s},S.createElement(pe.a,{id:"iterateBack",className:e.iteratorIcon,tabIndex:0,"aria-label":this.props.localizedStrings.IteratorPreviousEditButtonLabel+" . "+n,role:"button",iconName:re(this.iteratorBackIcon()),onClick:this.onIteratorPrevClick,onKeyDown:this.onIteratorPrevKeyDown})),S.createElement(Q.a,{content:0===this.props.totalChangesCount?void 0:this.props.localizedStrings.IteratorNextEditButtonLabel,directionalHint:Z.a.topCenter,className:e.iteratorTooltip,tooltipProps:i,styles:s},S.createElement(pe.a,{id:"iterateFront",className:e.iteratorIcon,title:t,"aria-label":this.props.localizedStrings.IteratorNextEditButtonLabel,role:"button",tabIndex:0===this.props.totalChangesCount?void 0:0,iconName:re(this.iteratorNextIcon()),onClick:this.onIteratorNextClick,onKeyDown:this.onIteratorNextKeyDown})))}},t}(S.PureComponent),ye=o(1446),Ve=o(2395),De=Object(V.c)((function(e,t,o,r,n,i,a,l,c){var d,p,u,h,g,m,f,v;void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===l&&(l=!1),void 0===c&&(c=!1);var b=T(o,r);return{root:Object(D.eb)({display:"flex",flexBasis:"78%",flexFlow:"column",minWidth:"400px",flexGrow:1.5,flexShrink:1,height:"100%"}),vhHeader:Object(D.eb)({height:"48px",width:"100%",backgroundColor:b.vhHeaderBackground,display:"flex"}),vhViewer:Object(D.eb)({backgroundColor:b.vhViewerBackground,flexDirection:"column",flexGrow:1,width:"100%",display:e||t?"none":"flex",position:l?"relative":"static"}),backArrow:Object(D.eb)({height:"20px",width:"20px",color:"",marginLeft:"8px",marginRight:"8px",minWidth:"20px",cursor:"pointer",selectors:(d={},d[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{fill:"ButtonText"}),d)}),icon:Object(D.eb)({flex:"none",marginTop:"3px",width:"16px",height:"16px"}),backToDoc:Object(D.eb)({height:"16px",whiteSpace:"nowrap",color:b.headerBackArrowAndIterator,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",lineHeight:"16px",cursor:"pointer",marginRight:"8px",selectors:(p={},p[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{color:"ButtonText"}),p)}),unselectedVersion:Object(D.eb)({fontStyle:"italic"}),selectedVersionTime:Object(D.eb)({color:b.headerText,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",fontWeight:600,lineHeight:"16px",marginLeft:"10px",marginRight:"10px"}),changesText:Object(D.eb)({display:c?"flex":"none",height:"16px",color:b.headerText,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",lineHeight:"16px",marginLeft:"4px",marginRight:"4px"}),changesCountText:Object(D.eb)({display:c?"flex":"none",height:"16px",width:"fill-content",color:b.headerText,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",lineHeight:"16px",cursor:"pointer"}),iteratorIcon:Object(D.eb)({display:c?"flex":"none",height:"16px",width:"16px",color:"",justifyContent:"center",lineHeight:"16px",marginLeft:"12px",marginRight:"12px",cursor:"pointer",selectors:(u={},u[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{fill:"ButtonText"}),u)},(h={},h["svg > path.OfficeIconColors_DynamicColor"]={fill:b?b.headerBackArrowAndIterator:""},h)),IteratorIconButton:Object(D.eb)({display:c?"flex":"none",height:"16px",width:"16px",color:"",justifyContent:"center",lineHeight:"16px",marginLeft:"12px",marginRight:"12px",cursor:"pointer",selectors:(g={},g["svg > path.OfficeIconColors_DynamicColor"]={fill:b?b.headerBackArrowAndIterator:""},g[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{selectors:(m={},m["svg > path.OfficeIconColors_DynamicColor"]={fill:"ButtonText"},m)}),g[":hover, :active"]={backgroundColor:"transparent"},g[":focus::after"]={outline:"none !important"},g[":focus"]={outlineWidth:"2px",outlineStyle:"solid",outlineColor:b?b.headerBackArrowAndIterator:"",outlineOffset:"1px",selectors:(f={},f[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{outline:"2px solid ButtonText"}),f)},g[":focus:not(:focus-visible)"]={outline:"none"},g)}),iteratorTooltip:Object(D.eb)({color:b.headerIteratorTooltip,fontFace:"ms-fontSize-Secondary12",paddingBottom:"4px",paddingLeft:"8px",paddingRight:"8px",paddingTop:"4px",shadow:"ms-depth-8"}),viewerNoSelection:Object(D.eb)({display:"flex",flexFlow:"column",alignItems:"center",backgroundColor:b.viewerNoSelectionBackground,color:b.viewerNoSelectionText,height:"100%",width:"100%",paddingTop:"20vh",boxSizing:"border-box",fontSize:"18px"}),viewerError:Object(D.eb)({display:t?"flex":"none",flexFlow:"column",justifyContent:"center",alignItems:"center",backgroundColor:b.viewerErrorBackground,height:"100%",width:"100%"}),viewerErrorMessage:Object(D.eb)({height:"16px",width:"371px",color:b.viewerErrorMessage,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",textAlign:"center",marginTop:"22px"}),loadingDiv:Object(D.eb)({display:e&&!t?"flex":"none",justifyContent:"center",alignItems:"center",backgroundColor:b.viewerLoadingBackground,height:"100%",width:"100%",flexFlow:"column"}),loadingSpinner:Object(D.eb)({selectors:{"& .ms-Spinner-circle":{borderColor:b.spinnerBorder,borderTopColor:b.spinnerTopColor}}}),hidden:Object(D.eb)({display:"none"}),saveACopyButton:Object(D.eb)({display:i?"flex":"none",lineHeight:"16px",marginLeft:"5px",marginRight:"5px",whiteSpace:"nowrap"}),restoreButton:Object(D.eb)({display:a?"flex":"none",lineHeight:"16px",marginLeft:"5px",marginRight:"5px"}),headerContent:Object(D.eb)({display:"flex",flexGrow:"1",justifyContent:"space-between",width:"100%",overflow:"auto"}),headerContentGroup:Object(D.eb)({display:"flex",justifyContent:"flex-start",alignItems:"center",marginTop:"5px",marginBottom:"5px",marginLeft:"5px",marginRight:"5px"},(v={},v["#vhHeaderBackArrow svg > path.OfficeIconColors_m24"]={fill:b.headerBackArrowAndIterator},v))}})),Te=o(399),Ee=Object(V.c)((function(e,t,o,r,n,i,a,l,c,d,p,u,h,g){var m,f,v,b,C,S;return{defaultButton:Object(D.eb)(Object(se.d)()?{overflow:"visible"}:{},{color:r,borderColor:o,background:t,selectors:(m={},m[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"ButtonFace",color:"ButtonText",border:"1px solid ButtonText"}),m[":hover"]={color:a,background:i,borderColor:n,selectors:(f={},f[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText"}),f)},m[":focus"]={borderColor:l,selectors:(v={},v[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{borderColor:"ButtonText"}),v)},m[":active"]={color:d,background:c,borderColor:p,selectors:(b={},b[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",borderColor:"ButtonText"}),b)},m[":disabled"]={color:h,background:u,borderColor:g,selectors:(C={},C[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"Window",color:"GrayText",border:"1px solid GrayText"}),C)},m[":focus::after"]={outline:e?"none !important":"",selectors:(S={},S[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{outline:"1px solid ButtonText !important"}),S)},m)})}})),we=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.button=S.createRef(),t.focus=function(){if(t.button.current){t.button.current.focus();var e=document.getElementById(t.props.id);e&&Object(R.b)(!0,e)}},t}return Object(s.__extends)(t,e),t.prototype.render=function(){var e,t,o,r,n,i,s,a,l,c,d,p,u,h,g,m,f=(e=this.props.isHeaderButton,t=Object(J.b)(),o=T(t),r="",n="",i="",s="",a="",l="",c="",d="",p="",u="",h="",g="",m="",e?(r=o.headerDefaultButtonColor,n=o.headerDefaultButtonBorder,i=o.headerDefaultButtonFont,s=o.headerDefaultButtonHoverBorderColor,a=o.headerDefaultButtonHoverBackground,l=o.headerDefaultButtonHoverFont,c=o.headerDefaultButtonFocusBorder,d=o.headerDefaultButtonActiveColor,p=o.headerDefaultButtonActiveFont,u=o.headerDefaultButtonActiveBorder,h=o.headerDefaultButtonDisabledBackground,g=o.headerDefaultButtonDisabledText,m=o.headerDefaultButtonDisabledBorder):(r=o.errorDefaultButtonColor,n=o.errorDefaultButtonBorder,a=o.errorDefaultButtonHoverColor,c=o.errorDefaultButtonFocusBorder,d=o.errorDefaultButtonActiveColor),Ee(e,r,n,i,s,a,l,c,d,p,u,h,g,m));return S.createElement(Te.a,{componentRef:this.button,text:this.props.text,className:[this.props.className,f.defaultButton].join(" "),id:this.props.id,onClick:this.props.onClick,disabled:this.props.isDisabled,ariaDescription:this.props.ariaDescribedBy})},t}(S.PureComponent),xe=Object(V.c)((function(e){var t,o,r;void 0===e&&(e=!1);var n=T(e);return{backArrow:Object(D.eb)({height:"20px",width:"20px",color:"",lineHeight:"16px",marginLeft:"19px",marginRight:"19px",marginTop:"16px",minWidth:"20px",cursor:"pointer",selectors:(t={},t[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{fill:"ButtonText"}),t)}),fullAppError:Object(D.eb)({display:"flex",flexFlow:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",backgroundColor:n.fullAppErrorBackground}),fullAppErrorTop:Object(D.eb)({height:"24px",width:"284px",color:n.fullAppErrorText,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"18px",fontWeight:"300",lineHeight:"24px",textAlign:"center",marginTop:"38px"}),fullAppErrorSub:Object(D.eb)({height:"32px",width:"239px",color:n.fullAppErrorText,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",textAlign:"center",marginTop:"15px"}),fullAppErrorButtons:Object(D.eb)({display:"flex",flexFlow:"row",marginTop:"33px"}),vhHeader:Object(D.eb)({height:"48px",width:"100%",backgroundColor:n.vhHeaderBackground,display:"flex"},(o={},o["#vhHeaderBackArrow svg > path.OfficeIconColors_m24"]={fill:n.headerBackArrowAndIterator},o)),backToDoc:Object(D.eb)({height:"16px",width:"97px",color:n.headerBackArrowAndIterator,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",marginTop:"16px",cursor:"pointer",selectors:(r={},r[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{color:"ButtonText"}),r)}),errorButtons:Object(D.eb)({marginLeft:"5px",marginRight:"5px"})}})),Ie=o(582),He=Object(V.c)((function(){var e,t,o,r;return{primaryButton:Object(D.eb)(Object(se.d)()?{overflow:"visible"}:{},{minWidth:"auto",selectors:(e={},e[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"ButtonText",color:"ButtonFace",border:"1px solid ButtonFace"}),e[":hover"]={selectors:(t={},t[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",borderColor:"HighlightText"}),t)},e[":active"]={selectors:(o={},o[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",borderColor:"HighlightText"}),o)},e[":disabled"]={selectors:(r={},r[D.m]=Object(s.__assign)(Object(s.__assign)({},Object(D.S)()),{backgroundColor:"ButtonFace",color:"GrayText",border:"1px solid GrayText"}),r)},e)})}})),Fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.button=S.createRef(),t.focus=function(){if(t.button.current){t.button.current.focus();var e=document.getElementById(t.props.id);e&&Object(R.b)(!0,e)}},t.getPrimaryButtonTheme=function(){return Object(J.b)()?{semanticColors:{primaryButtonBackground:T(!0).appColors.primary,primaryButtonBorder:T(!0).appColors.primary,primaryButtonText:"#F3F2F1",primaryButtonBackgroundHovered:T(!0).appColors.shade10,primaryButtonTextHovered:"#F3F2F1",primaryButtonBackgroundPressed:T(!0).appColors.shade30,primaryButtonTextPressed:"#F3F2F1",focusBorder:"white",primaryButtonBackgroundDisabled:"#797775",primaryButtonTextDisabled:"#605E5C",buttonBorderDisabled:"#3B3A39"}}:{semanticColors:{primaryButtonBackground:T(!1).appColors.primary,primaryButtonBackgroundHovered:T(!1).appColors.shade10,primaryButtonBackgroundPressed:T(!1).appColors.shade20}}},t}return Object(s.__extends)(t,e),t.prototype.render=function(){var e=He();return S.createElement(Ie.a,{componentRef:this.button,text:this.props.text,theme:Object(Se.a)(this.getPrimaryButtonTheme()),className:[this.props.primaryClassName,e.primaryButton].join(" "),id:this.props.id,onClick:this.props.onClick,disabled:this.props.isDisabled,ariaDescription:this.props.ariaDescribedBy})},t}(S.PureComponent);function Oe(e){var t;switch(e){case n.Excel:t="xlsx";break;case n.PowerPoint:t="pptx";break;case n.Word:t="docx";break;default:return""}return"https://static2.sharepointonline.com/files/fabric/assets/brand-icons/document/svg/"+t+"_48x1_5.svg"}var Re,Ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.render=function(){return this.props.fullAppError===r.VHVersioningNotEnabled?this.renderVersioningDisabled():this.renderGenericError()},t.prototype.componentDidUpdate=function(){this.setFocusOnLoad()},t.prototype.componentDidMount=function(){this.setFocusOnLoad()},t.prototype.renderHeader=function(e){return S.createElement("div",{id:"vhHeader",className:e.vhHeader},S.createElement(pe.a,{id:"vhHeaderBackArrow",className:e.backArrow,iconName:re(te.a?te.a.ArrowBack_20:""),onClick:this.props.onCloseSelectedAction}),S.createElement("div",{id:"backToDoc",className:e.backToDoc,onClick:this.props.onCloseSelectedAction},this.props.localizedStrings.ReturnToDoc))},t.prototype.renderErrorImage=function(){return S.createElement("img",{src:Oe(this.props.appSettings.appName),role:"presentation",alt:"",width:"62",height:"55"})},t.prototype.renderVersioningDisabled=function(){var e=xe(Object(J.b)()),t=this.props.localizedStrings.VersioningDisabledError,o=this.props.localizedStrings.VersioningDisabledDetails;return this._primaryButtonForFocus=new Fe({text:this.props.localizedStrings.BackLabel,primaryClassName:e.errorButtons,id:"VHErrorBackButton",onClick:this.props.onCloseSelectedAction,isDisabled:!1,ariaDescribedBy:t}),S.createElement(S.Fragment,null,this.renderHeader(e),S.createElement("div",{className:e.fullAppError},this.renderErrorImage(),S.createElement("div",{className:e.fullAppErrorTop}," ",t),S.createElement("div",{className:e.fullAppErrorSub},o),S.createElement("div",{className:e.fullAppErrorButtons},S.createElement(Fe,{text:this.props.localizedStrings.TryAgainLabel,primaryClassName:e.errorButtons,id:"VHTryAgainButton",onClick:this.props.getVersions,isDisabled:!0}),this._primaryButtonForFocus.render())))},t.prototype.renderGenericError=function(){var e=xe(Object(J.b)()),t=this.props.localizedStrings.FullAppErrorTextTop,o=this.props.localizedStrings.FullAppErrorTextSub;return this._primaryButtonForFocus=new Fe({text:this.props.localizedStrings.TryAgainLabel,primaryClassName:e.errorButtons,id:"VHTryAgainButton",onClick:this.props.getVersions,isDisabled:!1,ariaDescribedBy:t}),this._defaultButtonForFocus=new we({text:this.props.localizedStrings.BackLabel,id:"VHErrorBackButton",className:e.errorButtons,onClick:this.props.onCloseSelectedAction,isHeaderButton:!1}),S.createElement(S.Fragment,null,this.renderHeader(e),S.createElement("div",{className:e.fullAppError},this.renderErrorImage(),S.createElement("div",{className:e.fullAppErrorTop}," ",t),S.createElement("div",{className:e.fullAppErrorSub},o),S.createElement("div",{className:e.fullAppErrorButtons},this._primaryButtonForFocus.render(),this._defaultButtonForFocus.render())))},t.prototype.setFocusOnLoad=function(){this._primaryButtonForFocus&&this._primaryButtonForFocus.focus()},t}(S.PureComponent),ke=o(2496),Be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ftzoneRoot=S.createRef(),t._ftzoneHeader=S.createRef(),t._ftzoneViewer=S.createRef(),t._saveACopyButton=S.createRef(),t._headerId="VersionHistoryHeader",t.onSaveAsClick=function(){t.getVersionInfoFromId(t.props.selectedVersionId,t.props)&&t.props.onSaveACopySelectedAction(t.getVersionInfoFromId(t.props.selectedVersionId,t.props).Version.DownloadUrl)},t.renderHeader=function(){var e,o=!!t.getVersionInfoFromId(t.props.selectedVersionId,t.props),r=!!t.props.appSettings.wdEnableSaveACopy&&(!t.props.appSettings.wdEnableSaveACopyOverFlowMenu&&!t.props.appSettings.disableSaveACopy),n=!!t.props.appSettings.wdEnableRestore&&t.props.appSettings.wdEnableRestore,i=!t.props.appSettings.wdExperimentWithIteratorLocation&&(!!t.props.appSettings.wdEnableIterator&&t.props.appSettings.wdEnableIterator),s=t.props.appSettings.viewerRootPositionRelative,a=!!t.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete&&(t.props.viewerLoading||t.props.viewerError),l=!t.props.appSettings.wdExperimentWithIteratorLocation&&(i&&o&&t.props.totalChangesCount>=0&&t.props.currentChange<=t.props.totalChangesCount),c=De(t.props.viewerLoading,t.props.viewerError,Object(J.b)(),Object(ke.a)(),t.props.appSettings.appName,r&&o,n&&o&&t.props.versions[0]&&t.props.selectedVersionId!==t.props.versions[0].RevisionID,s,!t.props.appSettings.wdExperimentWithIteratorLocation&&l);e=o?S.createElement(z,{date:t.getVersionInfoFromId(t.props.selectedVersionId,t.props).Version.Time,localizedStrings:t.props.localizedStrings}):S.createElement("div",null);var d=t.props.appSettings.wdExperimentWithIteratorLocation?"":0===t.props.totalChangesCount?t.props.localizedStrings.IteratorNoChangesToolTip:"",p=t.props.appSettings.wdExperimentWithIteratorLocation?"":0===t.props.totalChangesCount?d:t.props.localizedStrings.IteratorTotalChangesLabel.replace("{0}",t.props.localizedStrings.IteratorChangesCountLabel.replace("{0}",t.props.currentChange.toString()).replace("{1}",t.props.totalChangesCount.toString()));return t.createRenderHeader(c,a,!t.props.appSettings.wdExperimentWithIteratorLocation&&i,t.props.appSettings.wdExperimentWithIteratorLocation?"":d,t.props.appSettings.wdExperimentWithIteratorLocation?"":p,e)},t.focus=function(){return t._ftzoneRoot.current&&t._ftzoneRoot.current.focus()},t.focusHeader=function(){return t._ftzoneHeader.current&&t._ftzoneHeader.current.focus()},t.focusViewer=function(){return t._ftzoneViewer.current&&t._ftzoneViewer.current.focus()},t.focusSaveACopy=function(){return t._saveACopyButton.current&&t._saveACopyButton.current.focus()},t.getVersionInfoFromId=function(e,t){if(e){var o=Object(ye.e)(t.versions,(function(t){return t.RevisionID===e}));return o>=0?{Version:t.versions[o]}:void 0}},t.onRestoreClick=function(){t.getVersionInfoFromId(t.props.selectedVersionId,t.props)&&t.props.onRestoreVersionAction(t.getVersionInfoFromId(t.props.selectedVersionId,t.props).Version.RevisionID)},t.onBackArrowKeyDown=function(e){e.which!==I.a.enter&&e.which!==I.a.space||t.onBackToDocumentClicked()},t.onIteratorPrevKeyDown=function(e){d.isChangeGateEnabled(p.ResolvingWholeGridSelectedOnIteration)||e.which!==I.a.enter&&e.which!==I.a.space||t.onIteratorPrevClick()},t.onIteratorNextKeyDown=function(e){d.isChangeGateEnabled(p.ResolvingWholeGridSelectedOnIteration)||e.which!==I.a.enter&&e.which!==I.a.space||t.onIteratorNextClick()},t.onBackToDocumentClicked=function(){a.a.sendTraceTag(595632281,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"Back to Document clicked"),t.props.onCloseSelectedAction()},t.onIteratorNextClick=function(){t.props.totalChangesCount>0&&(a.a.sendTraceTag(595648670,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"Iterator Next clicked-current count:"+t.props.currentChange.toString()+" ,total count:"+t.props.totalChangesCount.toString()),t.props.onIteratorSelectedAction(!0))},t.onIteratorPrevClick=function(){t.props.totalChangesCount>0&&(a.a.sendTraceTag(595648671,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,"Iterator Previous clicked-current count:"+t.props.currentChange.toString()+" ,total count:"+t.props.totalChangesCount.toString()),t.props.onIteratorSelectedAction(!1))},t}return Object(s.__extends)(t,e),t.prototype.render=function(){var e=De(this.props.viewerLoading,this.props.viewerError,Object(J.b)(),Object(ke.a)(),this.props.appSettings.appName);return S.createElement(S.Fragment,null,S.createElement(be.a,{componentRef:this._ftzoneRoot,id:this._headerId,className:e.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0,"aria-label":this.props.localizedStrings.HeaderAriaLabel,role:"group","aria-roledescription":this.props.localizedStrings.PaneRoleDescription},this.renderHeader()))},t.prototype.createRenderHeader=function(e,t,o,r,n,i){return this.createRenderWithFocusTrapZone(e,t,o,r,n,i)},t.prototype.createRenderWithFocusTrapZone=function(e,t,o,r,n,i){var s=!!this.getVersionInfoFromId(this.props.selectedVersionId,this.props),a=!this.props.paneLoading&&!s;return S.createElement(S.Fragment,null,S.createElement(be.a,{componentRef:this._ftzoneHeader,id:"vhHeader",className:e.vhHeader,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0},this.renderHeaderComponents(e,t,r,n,i,o)),a?this.renderBlankLoadLabel(e):this.renderErrorHeader(e),S.createElement(be.a,{componentRef:this._ftzoneViewer,className:e.vhViewer,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0},S.createElement("div",{id:"vhViewer",className:a?e.hidden:e.vhViewer,tabIndex:0})))},t.prototype.renderBackButtonSection=function(e){return S.createElement("div",{className:e.headerContentGroup,onClick:this.onBackToDocumentClicked,tabIndex:0,onKeyDown:this.onBackArrowKeyDown,role:"button"},S.createElement(pe.a,{id:"vhHeaderBackArrow",className:e.backArrow,iconName:re(te.a?te.a.ArrowBack_20:"")}),S.createElement("div",{id:"backToDoc",className:e.backToDoc,"aria-label":this.props.localizedStrings.ReturnToDoc},this.props.localizedStrings.ReturnToDoc))},t.prototype.renderSelectedVersionSection=function(e,t){return S.createElement(S.Fragment,null,S.createElement("div",{id:"selectedVersionTime",className:e.selectedVersionTime},t))},t.prototype.renderButtonsSection=function(e,t){var o="";return this.getVersionInfoFromId(this.props.selectedVersionId,this.props)&&(o=j(this.getVersionInfoFromId(this.props.selectedVersionId,this.props).Version.Time,void 0,this.props.localizedStrings).friendlyDateString),S.createElement(S.Fragment,null,S.createElement(we,{ref:this._saveACopyButton,text:this.props.localizedStrings.SaveACopy,className:e.saveACopyButton,id:"VHSaveACopyButton",onClick:this.onSaveAsClick,isDisabled:t,isHeaderButton:!0,ariaDescribedBy:this.props.localizedStrings.SaveACopyAriaDescribedByText.replace("{0}",o)}),S.createElement(we,{text:this.props.localizedStrings.RestoreLabel,className:e.restoreButton,id:"VHRestoreButton",onClick:this.onRestoreClick,isDisabled:t,isHeaderButton:!0,ariaDescribedBy:this.props.localizedStrings.RestoreAriaDescribedByText.replace("{0}",o)}))},t.prototype.iteratorBackIcon=function(){return te.a?this.props.appSettings.isRtl?te.a.NextChevronPaddle_24:te.a.BackChevronPaddle_24:""},t.prototype.iteratorNextIcon=function(){return te.a?this.props.appSettings.isRtl?te.a.BackChevronPaddle_24:te.a.NextChevronPaddle_24:""},t.prototype.renderIteratorSection=function(e,t,o,r){var n=this;if(r){var i=0===this.props.totalChangesCount?this.props.localizedStrings.IteratorPreviousButtonNoChangesString:this.props.localizedStrings.IteratorPreviousButtonXChangesString.replace("{0}",this.props.totalChangesCount.toString()),s={styles:{content:{color:T(Object(J.b)(),Object(ke.a)()).headerIteratorTooltip}}},a={root:{display:"inline-block"}};return S.createElement(S.Fragment,null,S.createElement("div",{id:"ChangesText",className:e.changesText},this.props.localizedStrings.IteratorChangesLabel),S.createElement(Q.a,{content:0===this.props.totalChangesCount?t:this.props.localizedStrings.IteratorPreviousChangeButtonLabel,directionalHint:Z.a.topCenter,className:e.iteratorTooltip,tooltipProps:s,styles:a},d.isChangeGateEnabled(p.ResolvingWholeGridSelectedOnIteration)?S.createElement($.a,{iconProps:{iconName:re(n.iteratorBackIcon())},id:"iterateBack",className:e.IteratorIconButton,tabIndex:0,"aria-label":n.props.localizedStrings.IteratorPreviousChangeButtonLabel+" . "+i,role:"button",onClick:n.onIteratorPrevClick,onKeyDown:n.onIteratorPrevKeyDown}):S.createElement(pe.a,{id:"iterateBack",className:e.iteratorIcon,tabIndex:0,"aria-label":n.props.localizedStrings.IteratorPreviousChangeButtonLabel+" . "+i,role:"button",iconName:re(n.iteratorBackIcon()),onClick:n.onIteratorPrevClick,onKeyDown:n.onIteratorPrevKeyDown})),S.createElement("div",{id:"CountText",className:e.changesCountText,title:t,"aria-label":o},this.props.localizedStrings.IteratorChangesCountLabel.replace("{0}",this.props.currentChange.toString()).replace("{1}",this.props.totalChangesCount.toString())),S.createElement(Q.a,{content:0===this.props.totalChangesCount?void 0:this.props.localizedStrings.IteratorNextChangeButtonLabel,directionalHint:Z.a.topCenter,className:e.iteratorTooltip,tooltipProps:s,styles:a},d.isChangeGateEnabled(p.ResolvingWholeGridSelectedOnIteration)?S.createElement($.a,{iconProps:{iconName:re(n.iteratorNextIcon())},id:"iterateFront",className:e.IteratorIconButton,title:t,"aria-label":n.props.localizedStrings.IteratorNextChangeButtonLabel,role:"button",tabIndex:0===n.props.totalChangesCount?void 0:0,onClick:n.onIteratorNextClick,onKeyDown:n.onIteratorNextKeyDown}):S.createElement(pe.a,{id:"iterateFront",className:e.iteratorIcon,title:t,"aria-label":n.props.localizedStrings.IteratorNextChangeButtonLabel,role:"button",tabIndex:0===n.props.totalChangesCount?void 0:0,iconName:re(n.iteratorNextIcon()),onClick:n.onIteratorNextClick,onKeyDown:n.onIteratorNextKeyDown})))}},t.prototype.renderHeaderComponents=function(e,t,o,r,n,i){return this.props.appSettings.wdExperimentWithIteratorLocation?S.createElement(S.Fragment,null,S.createElement("div",{className:e.headerContent},this.renderBackButtonSection(e),S.createElement("div",{className:e.headerContentGroup},this.renderSelectedVersionSection(e,n),this.renderButtonsSection(e,t)),S.createElement("div",{className:e.headerContentGroup}))):S.createElement(S.Fragment,null,S.createElement("div",{className:e.headerContent},this.renderBackButtonSection(e),S.createElement("div",{className:e.headerContentGroup},this.renderSelectedVersionSection(e,n),this.renderButtonsSection(e,t)),S.createElement("div",{className:e.headerContentGroup},this.renderIteratorSection(e,o,r,i))))},t.prototype.renderBlankLoadLabel=function(e){return S.createElement(S.Fragment,null,S.createElement("div",{"aria-live":"polite",className:e.viewerNoSelection},S.createElement(Ve.a,{delay:50},S.createElement("div",null,this.props.localizedStrings.BlankLoadSelectVersionLabel))))},t.prototype.renderErrorHeader=function(e){return S.createElement(S.Fragment,null,S.createElement("div",{className:e.viewerError},S.createElement("img",{src:Oe(this.props.appSettings.appName),width:"62",height:"55"}),S.createElement("div",{className:e.viewerErrorMessage},this.props.localizedStrings.ViewerAreaErrorText)),S.createElement("div",{className:e.loadingDiv},S.createElement(H.a,{className:e.loadingSpinner,size:F.a.large})))},t}(S.PureComponent),Ne=function(e){var t=T(e);return je(t.spinnerBorder,t.spinnerTopColor)},je=Object(V.c)((function(e,t){return{loadingSpinner:Object(D.eb)({selectors:{"& .ms-Spinner-circle":{borderColor:e,borderTopColor:t}}})}})),Le=o(2847),We=o(845),Pe=o(2047);!function(e){e[e.Hidden=1]="Hidden",e[e.CoauthRestoreDisplayed=2]="CoauthRestoreDisplayed",e[e.CoauthRestoreFailedServer=3]="CoauthRestoreFailedServer",e[e.CoauthRestoreInProgress=4]="CoauthRestoreInProgress"}(Re||(Re={}));var ze,Ge=function(e){function t(t){return e.call(this,t)||this}return Object(s.__extends)(t,e),t.prototype.render=function(){var e=Ne(Object(J.b)());switch(this.props.modalErrorState){case Re.CoauthRestoreDisplayed:return S.createElement(Le.a,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{type:We.a.normal,title:this.props.localizedStrings.OtherEditors,subText:this.props.localizedStrings.OtherEditorsSubtext,showCloseButton:!1}},S.createElement(Pe.a,null,S.createElement(Fe,{text:this.props.localizedStrings.RestoreContinue,primaryClassName:"",id:"VHRestorContinue",onClick:this.props.onDismiss,isDisabled:!1})));case Re.CoauthRestoreInProgress:return S.createElement(Le.a,{hidden:!1,isBlocking:!0,onDismiss:this.props.onDismiss,modalProps:{isModeless:!0,dragOptions:void 0},dialogContentProps:{type:We.a.normal,title:this.props.localizedStrings.RestoreInProgress,showCloseButton:!1}},S.createElement(H.a,{className:e.loadingSpinner,size:F.a.large,ariaLabel:this.props.localizedStrings.RestoreInProgress}));case Re.CoauthRestoreFailedServer:return S.createElement(Le.a,{hidden:!1,isBlocking:!0,onDismiss:this.props.onDismiss,dialogContentProps:{type:We.a.normal,title:this.props.localizedStrings.RestoreFailed,subText:this.props.localizedStrings.RestoreFailedSubtext,showCloseButton:!1}},S.createElement(Pe.a,null,S.createElement(Fe,{text:this.props.localizedStrings.RestoreContinue,primaryClassName:"",id:"VHRestorContinue",onClick:this.props.refreshCallback,isDisabled:!1})));case Re.Hidden:default:return null}},t}(S.PureComponent);!function(e){e[e.Hidden=1]="Hidden",e[e.DeleteConfirmation=2]="DeleteConfirmation",e[e.DeleteInProgress=3]="DeleteInProgress",e[e.DeletePartialFailure=4]="DeletePartialFailure",e[e.DeleteFullFailure=5]="DeleteFullFailure"}(ze||(ze={}));var Me=function(e){function t(t){return e.call(this,t)||this}return Object(s.__extends)(t,e),t.prototype.render=function(){var e=Ne(Object(J.b)());switch(this.props.deleteModalErrorState){case ze.DeleteConfirmation:return S.createElement(Le.a,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{type:We.a.normal,subText:1===this.props.revisionIDsToDeleteCount?this.props.localizedStrings.DeleteIndividualConfirmation:this.props.localizedStrings.DeleteGroupConfirmation.replace("{0}",this.props.revisionIDsToDeleteCount.toString()),title:this.props.localizedStrings.DeleteContinue}},S.createElement(Pe.a,null,S.createElement(Fe,{text:this.props.localizedStrings.Delete,primaryClassName:"",id:"VHDeleteContinue",onClick:this.props.deleteVersions,isDisabled:!1}),S.createElement(we,{text:this.props.localizedStrings.DeleteCancel,id:"VHDeleteCancel",className:"",onClick:this.props.onDismiss,isHeaderButton:!1})));case ze.DeleteInProgress:return S.createElement(Le.a,{hidden:!1,isBlocking:!0,dialogContentProps:{type:We.a.normal,title:this.props.localizedStrings.Deleting}},S.createElement(H.a,{className:e.loadingSpinner,size:F.a.large,ariaLabel:"Deleting"}));case ze.DeletePartialFailure:return S.createElement(Le.a,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{type:We.a.normal,title:this.props.localizedStrings.DeleteFailedPartialGroup,subText:this.props.localizedStrings.DeleteFailedPartialGroupFailureCount.replace("{0}",this.props.failedToDeleteCount.toString()).replace("{1}",this.props.revisionIDsToDeleteCount.toString())+" "+this.props.localizedStrings.DeleteFailedTryAgain}},S.createElement(Pe.a,null,S.createElement(Fe,{text:this.props.localizedStrings.BackLabel,primaryClassName:"",id:"VHDeletePartialFailure",onClick:this.props.onDismiss,isDisabled:!1})));case ze.DeleteFullFailure:return S.createElement(Le.a,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{type:We.a.normal,title:1===this.props.revisionIDsToDeleteCount?this.props.localizedStrings.DeleteFailedIndividual:this.props.localizedStrings.DeleteFailedWholeGroup,subText:this.props.localizedStrings.DeleteFailedTryAgain}},S.createElement(Pe.a,null,S.createElement(Fe,{text:this.props.localizedStrings.BackLabel,primaryClassName:"",id:"VHDeleteFullFailure",onClick:this.props.onDismiss,isDisabled:!1})));case ze.Hidden:default:return null}},t}(S.PureComponent),Ue=function(e){function t(t){var o=e.call(this,t)||this;return o._ftzone=S.createRef(),o._vhPane=S.createRef(),o._vhHeader=S.createRef(),o._dialogDescribedById=Object(y.a)(),o.renderVersionHistoryDialog=function(){var e=o.props.versions,t={localizedStrings:o.props.localizedStrings,selectedVersionId:o.props.selectedVersionId,selectedGroupName:o.props.selectedGroupName,totalChangesCount:o.props.totalChangesCount,currentChange:o.props.currentChange,onVersionSelectedAction:o.props.onVersionSelectedAction,onCloseSelectedAction:o.props.onCloseSelectedAction,onRestoreVersionAction:o.props.onRestoreVersionAction,onDeleteVersionsSelectedAction:o.props.onDeleteVersionsSelectedAction,paneLoading:o.props.paneLoading,viewerLoading:o.props.viewerLoading,viewerError:o.props.viewerError,fullAppError:o.props.fullAppError,appSettings:o.props.appSettings,modalErrorState:o.props.modalErrorState,deleteModalErrorState:o.props.deleteModalErrorState,refreshCallback:o.props.refreshCallback,revisionIDsToDeleteCount:o.props.revisionIDsToDeleteCount,failedToDeleteCount:o.props.failedToDeleteCount},r=x(t.appSettings.isRtl);return S.createElement(S.Fragment,null,o.props.fullAppError?S.createElement(S.Fragment,null,S.createElement("div",{className:r.fullAppErrorDiv},S.createElement(Ae,Object(s.__assign)({versions:e},t,{getVersions:o.props.getVersions})))):S.createElement(S.Fragment,null,S.createElement(Ge,Object(s.__assign)({versions:e},t,{onDismiss:o._onDismiss})),S.createElement(Be,Object(s.__assign)({versions:e},t,{onSaveACopySelectedAction:o.props.onSaveACopySelectedAction,onRestoreVersionAction:o.props.onRestoreVersionAction,onIteratorSelectedAction:o.props.onIteratorSelectedAction,ref:o._vhHeader})),o.props.appSettings.wdEnableDeleteVersions?S.createElement(Me,Object(s.__assign)({versions:e},t,{onDismiss:o._onDeleteDismiss,deleteVersions:o.props.deleteVersions})):S.createElement(S.Fragment,null),S.createElement(_e,Object(s.__assign)({versions:e},t,{onShowVersionChangesToggledAction:o.props.onShowVersionChangesToggledAction,onDownloadVersionSelectedAction:o.props.onDownloadVersionSelectedAction,onSaveACopySelectedAction:o.props.onSaveACopySelectedAction,onDeleteVersionsSelectedAction:o.props.onDeleteVersionsSelectedAction,onIteratorSelectedAction:o.props.onIteratorSelectedAction,ref:o._vhPane}))))},o.focus=function(){return o._vhPane.current&&o._vhPane.current.focus()},o.focusHeader=function(){o._vhHeader.current&&o._vhHeader.current.focusHeader()},o.focusSaveACopy=function(){o._vhHeader.current&&o._vhHeader.current.focusSaveACopy()},o._onDismiss=function(){t.setModalError(Re.Hidden)},o._onDeleteDismiss=function(){t.setDeleteModalError(ze.Hidden)},o}return Object(s.__extends)(t,e),t.prototype.render=function(){var e=x(this.props.appSettings.isRtl,Object(J.b)()),t=this.props.localizedStrings;return S.createElement(be.a,{componentRef:this._ftzone,className:e.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!0,"aria-label":t.VersionHistoryTitle,"aria-describedby":this._dialogDescribedById,role:"group","aria-roledescription":t.VersionHistoryTitle},S.createElement("div",{className:e.dialog},this.renderVersionHistoryDialog(),S.createElement("div",{id:this._dialogDescribedById,className:e.hidden,"aria-hidden":!0},t.VersionHistoryTitle)))},t.prototype.focusViewer=function(){this._vhHeader.current&&this._vhHeader.current.focusViewer()},t}(S.PureComponent),qe=o(146);var Xe,Je=o(2640),Ke=o(1190),Ye=o(288);function Ze(e,t,o){return versionHistorySprite&&(versionHistorySprite.icons=versionHistorySprite.icons.map((function(e){return Object(s.__assign)(Object(s.__assign)({},e),{id:re(e.id)})})),Object(D.ib)({icons:Object(qe.iconSpriteToReactMap)(versionHistorySprite)}),versionHistorySprite=void 0),new Promise((function(r){_.render(S.createElement(Qe,Object(s.__assign)({ref:function(e){return r(e)}},t,o)),e)}))}!function(e){e[e.SelectOlderSubsection=1]="SelectOlderSubsection",e[e.SelectNewerSubsection=2]="SelectNewerSubsection",e[e.SelectOlderVersion=3]="SelectOlderVersion",e[e.SelectNewerVersion=4]="SelectNewerVersion",e[e.SelectTipSubsection=5]="SelectTipSubsection"}(Xe||(Xe={}));var Qe=function(e){function t(t){var o=e.call(this,t)||this;return o._dialog=S.createRef(),o._disableSPOFileCache=!1,o.selectedVersionId=null,o.onVersionSelectedAction=function(e){if(e.currentVersion&&e.currentVersion.RevisionID){if(a.a.sendTraceTag(595933192,l.a.msoulscat_Wac_VersionHistory,c.a.Info,o.getLoggableVersionInfoString("onVersionSelectedAction - Version selected in pane",e.currentVersion.RevisionID,o.state)),o.selectedVersionId=e.currentVersion.RevisionID?e.currentVersion.RevisionID:void 0,o._disableSPOFileCache||e.currentVersion.DownloadUrl)a.a.sendTraceTag(595907534,l.a.msoulscat_Wac_VersionHistory,c.a.Info,o.getLoggableVersionInfoString("selectVersion - Version selected in pane",e.currentVersion.RevisionID,o.state)),o.setState({selectedVersionId:o.selectedVersionId,selectedGroupName:e.groupName?e.groupName:void 0,viewerError:!1,viewerLoading:!!o.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete},(function(){return o.props.onVersionSelectedAction(e)}));else{o.setState({selectedVersionId:o.selectedVersionId,viewerError:!1,viewerLoading:!0});var t=[e.currentVersion.RevisionID];e.baseVersion&&e.baseVersion.RevisionID&&t.push(e.baseVersion.RevisionID),o.props.getDownloadToken(t,e)}if(!o._disableSPOFileCache&&e.currentVersion.DownloadUrl&&e.baseVersion&&e.baseVersion.RevisionID&&!e.baseVersion.DownloadUrl){t=[e.currentVersion.RevisionID,e.baseVersion.RevisionID];o.props.getDownloadToken(t,e)}}},o.onCloseSelectedAction=function(){o.props.onCloseSelectedAction(),o.resetState(),o.disableSearchBar(!1)},o.onSaveACopySelectedAction=function(e){a.a.sendTraceTag(595903688,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,o.getLoggableVersionInfoString("onSaveACopySelectedAction",o.state.selectedVersionId,o.state)),o.props.onSaveACopySelectedAction(e)},o.onDownloadVersionSelectedAction=function(e){a.a.sendTraceTag(593072918,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,o.getLoggableVersionInfoString("onDownloadVersionSelectedAction",o.state.selectedVersionId,o.state)),o.props.onDownloadVersionSelectedAction(e)},o.onRestoreVersionAction=function(e){a.a.sendTraceTag(595892446,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,o.getLoggableVersionInfoString("onRestoreVersionAction",e,o.state)),o.props.onRestoreVersionAction(e)},o.onDeleteVersionsSelectedAction=function(e){a.a.sendTraceTag(590147609,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,1===e.length?o.getLoggableVersionInfoString("onDeleteVersionsSelectedAction",e[0],o.state):o.getLoggableVersionInfoString("onDeleteVersionsSelectedAction with {0} versions, info for most recent version in group".replace("{0}",e.length.toString()),e[0],o.state));var t=e.length;o.setState({revisionIDsToDeleteCount:t}),o.props.onDeleteVersionsSelectedAction(e)},o.getInitState=function(){return{versions:[],selectedVersionId:void 0,selectedGroupName:void 0,totalChangesCount:0,currentChange:0,paneLoading:!0,viewerLoading:!0,viewerError:!1,fullAppError:r.None,modalErrorState:Re.Hidden,deleteModalErrorState:ze.Hidden,revisionIDsToDeleteCount:0,failedToDeleteCount:0,refreshCallback:function(){}}},o.resetState=function(){o.setState(o.getInitState())},o.getAgeOfTime=function(e){return Date.now()-e.getTime()},o.getVersionInfoFromId=function(e,t){if(e){var o=Object(ye.e)(t.versions,(function(t){return t.RevisionID===e}));return o>=0?{version:t.versions[o],index:o}:void 0}},o.getLoggableVersionInfoString=function(e,t,r){var n=o.getVersionInfoFromId(t,r);if(n){var i=n.version,s=n.index,a=i.Time?o.getAgeOfTime(i.Time):"-1";return JSON.stringify({msg:e,revisionId:i.RevisionID,revisionAge:a,revisionIndex:s})}return""},o.getGroupTipFromVersion=function(e,t){if(t<0||t>e.length)return a.a.sendTraceTag(589312481,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"getGroupTipFromVersion: index out of bounds: currIndex = {0}".replace("{0}",t.toString())),e[0];if(0===t)return e[0];var r=e[t],n=t-1,i=e[n];for(n-=1;i&&o.areVersionsInSameGroup(r,i);)r=i,i=e[n],n-=1;return r},o.areVersionsInSameGroup=function(e,t){var o,r,n,i,s,a;return e===t||(null===(o=null==e?void 0:e.Time)||void 0===o?void 0:o.getDate())===(null===(r=null==t?void 0:t.Time)||void 0===r?void 0:r.getDate())&&(null===(n=null==e?void 0:e.Time)||void 0===n?void 0:n.getMonth())===(null===(i=null==t?void 0:t.Time)||void 0===i?void 0:i.getMonth())&&(null===(s=null==e?void 0:e.Time)||void 0===s?void 0:s.getFullYear())===(null===(a=null==t?void 0:t.Time)||void 0===a?void 0:a.getFullYear())},o.showDeleteFullOrPartialFailure=function(e,t){return e<=0?(a.a.sendTraceTag(589312482,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"showDeleteFullOrPartialFailure: no versions to delete: toDelete = {0}".replace("{0}",e.toString())),!0):e===t?(o.setDeleteModalError(ze.DeleteFullFailure),!0):(t>0&&(o.setState({failedToDeleteCount:t}),o.setDeleteModalError(ze.DeletePartialFailure)),!1)},o.removeVersions=function(e,t){var r=e.filter((function(e){return!t.includes(e)}));return o.state.versions.filter((function(e){return!e.RevisionID||!r.includes(e.RevisionID)}))},o.selectAfterDelete=function(e,t,r){var n,i;if(0===e)return a.a.sendTraceTag(589312483,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"selectAfterDelete: attempting to delete tip version"),Xe.SelectTipSubsection;if(e<0||e-1>=t.length)return a.a.sendTraceTag(589312512,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"selectAfterDelete: firstIndexDeleted out of bounds: currIndex = {0}".replace("{0}",e.toString())),Xe.SelectTipSubsection;n=t[e-1],i=e>=t.length?void 0:t[e];var s=o.state.versions[e];return r?i?Xe.SelectOlderSubsection:Xe.SelectNewerSubsection:o.areVersionsInSameGroup(s,i)?Xe.SelectOlderVersion:o.areVersionsInSameGroup(s,n)?Xe.SelectNewerVersion:i?Xe.SelectOlderSubsection:Xe.SelectNewerSubsection},o.state=o.getInitState(),o.setModalError=o.setModalError.bind(o),o.setDeleteModalError=o.setDeleteModalError.bind(o),o.setRefreshCallback=o.setRefreshCallback.bind(o),o._disableSPOFileCache=!!t.appSettings.wdDisableSPOFileCache,o.disableSearchBar(!0),a.a.sendTraceTag(595933189,l.a.msoulscat_Wac_VersionHistory,c.a.Info,"Pane constructed"),o}return Object(s.__extends)(t,e),t.prototype.insertVersions=function(e){a.a.sendTraceTag(595933190,l.a.msoulscat_Wac_VersionHistory,c.a.Info,JSON.stringify({msg:"insertVersions",count:e.length})),this.setState({versions:e})},t.prototype.insertVersionsAndClearLoading=function(e){a.a.sendTraceTag(592066071,l.a.msoulscat_Wac_VersionHistory,c.a.Info,JSON.stringify({msg:"insertVersions and clear pane and viewer loading",count:e.length})),this.setState({versions:e,paneLoading:!1,viewerLoading:!1})},t.prototype.removeVersionsAndSelectNext=function(e,t){a.a.sendTraceTag(589939200,l.a.msoulscat_Wac_VersionHistory,c.a.Info,JSON.stringify({msg:"removeVersionsAndSelectNext",count:e.length-t.length}));var o=!1,r=!1;if(!(t.length>0&&(r=!(o=this.showDeleteFullOrPartialFailure(e.length,t.length)),o))){var n=this.state.versions.findIndex((function(t){return t.RevisionID===e[0]})),i=this.removeVersions(e,t),s=this.selectAfterDelete(n,i,r),d=i[n],p=i[n+1],u=i[n-1],h=d;switch(s){case Xe.SelectTipSubsection:this.setVersionsAndSelectSubSection(i,i[0]);break;case Xe.SelectOlderVersion:this.setVersionsAndSelectVersion(i,{currentVersion:d,baseVersion:p,noBaseToCompareTo:!p});break;case Xe.SelectNewerVersion:this.setVersionsAndSelectVersion(i,{currentVersion:u,baseVersion:h,noBaseToCompareTo:!h});break;case Xe.SelectOlderSubsection:this.setVersionsAndSelectSubSection(i,d);break;case Xe.SelectNewerSubsection:this.setVersionsAndSelectSubSection(i,this.getGroupTipFromVersion(i,n-1))}r||this.setDeleteModalError(ze.Hidden)}},t.prototype.setVersionsAndSelectSubSection=function(e,t){this._dialog&&this._dialog.current&&t?(a.a.sendTraceTag(592066072,l.a.msoulscat_Wac_VersionHistory,c.a.Info,JSON.stringify({msg:"insertVersions and select subsection",count:e.length})),this.setState({versions:e,paneLoading:!1,selectedGroupName:t.RevisionID?t.RevisionID:void 0})):(a.a.sendTraceTag(592066073,l.a.msoulscat_Wac_VersionHistory,c.a.Info,JSON.stringify({msg:"insertVersions and clear pane loading",count:e.length})),this.setState({versions:e,paneLoading:!1}))},t.prototype.setTotalChangesCount=function(e){this._dialog&&this._dialog.current&&this.setState({totalChangesCount:e})},t.prototype.setCurrentChangeCount=function(e){this._dialog&&this._dialog.current&&this.setState({currentChange:e})},t.prototype.setViewerLoading=function(e){this.setState({viewerLoading:e})},t.prototype.setViewerError=function(e){this.setState({viewerError:e})},t.prototype.setFullAppErrorCode=function(e){this.setState({fullAppError:e})},t.prototype.hitFullAppError=function(e){this.setState({fullAppError:e,viewerLoading:!1,paneLoading:!1,viewerError:!1})},t.prototype.disableSearchBar=function(e){Object(Ke.a)(Ye.a)(Object(Je.a)(e))},t.prototype.getVersionsTriggered=function(){this.resetState(),this.disableSearchBar(!0)},t.prototype.setModalError=function(e){this.setState({modalErrorState:e})},t.prototype.setDeleteModalError=function(e){this.setState({deleteModalErrorState:e})},t.prototype.setRefreshCallback=function(e){this.setState({refreshCallback:e})},t.prototype.setRestoreFailedAtServer=function(e,t){this.setState({modalErrorState:e,refreshCallback:t})},t.prototype.setVersionsAndSelectVersion=function(e,t){var o=this;if(t.currentVersion&&t.currentVersion.RevisionID){var r=this.state.viewerLoading;a.a.sendTraceTag(595907534,l.a.msoulscat_Wac_VersionHistory,c.a.Info,this.getLoggableVersionInfoString("selectVersion - Version selected in pane",t.currentVersion.RevisionID,this.state)),this.selectedVersionId=t.currentVersion.RevisionID;var n=this.selectedVersionId,i=t.groupName?t.groupName:void 0;r=!!this.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete,a.a.sendTraceTag(592066074,l.a.msoulscat_Wac_VersionHistory,c.a.Info,JSON.stringify({msg:"insertVersions during select",count:e.length})),this.setState({versions:e,paneLoading:!1,viewerLoading:r,selectedVersionId:n,selectedGroupName:i,viewerError:!1},(function(){return o.props.onVersionSelectedAction(t)}))}},t.prototype.render=function(){return S.createElement(Ue,Object(s.__assign)({ref:this._dialog,setModalError:this.setModalError,setDeleteModalError:this.setDeleteModalError,setRefreshCallback:this.setRefreshCallback},this.props,this.state,{onVersionSelectedAction:this.onVersionSelectedAction,onCloseSelectedAction:this.onCloseSelectedAction,onSaveACopySelectedAction:this.onSaveACopySelectedAction,onDownloadVersionSelectedAction:this.onDownloadVersionSelectedAction,onRestoreVersionAction:this.onRestoreVersionAction,onDeleteVersionsSelectedAction:this.onDeleteVersionsSelectedAction,getVersions:this.props.getVersions,deleteVersions:this.props.deleteVersions,setSaveACopyCanceled:this.setSaveACopyCanceled}))},t.prototype.enterFocusTrapZone=function(){this._dialog.current&&this._dialog.current.focus()},t.prototype.enterHeaderFocusTrapZone=function(){this._dialog.current&&this._dialog.current.focusHeader()},t.prototype.setSaveACopyCanceled=function(){if(this.props.appSettings.wdEnableSaveACopyOverFlowMenu){var e=this.state.versions,t=this.state.selectedVersionId,o=this.state.selectedGroupName,r=this.state.versions.findIndex((function(e){return e.RevisionID===t})),n=e[-1===r?0:r];if(o)this.setVersionsAndSelectSubSection(e,n);else{var i=e[r+1];this.setVersionsAndSelectVersion(e,{currentVersion:n,baseVersion:i,noBaseToCompareTo:!i})}}else this._dialog.current&&this._dialog.current.focusSaveACopy()},t.prototype.enterViewerFocusTrapZone=function(){this._dialog.current&&this._dialog.current.focusViewer()},t}(S.PureComponent),$e={shade30:"#0e336a",shade20:"#13458f",shade10:"#1651aa",primary:"#185abd",tint10:"#2e6ac5",tint20:"#6794d7",tint30:"#aec6eb",tint40:"#d2e0f4"},et={shade30:"#0e336a",shade20:"#002050",shade10:"#124078",primary:"#2b579a",tint10:"#3c65a4",tint20:"#4a78b0",tint30:"#7da3c6",tint40:"#a5b9d1"},tt={shade30:"#6e220f",shade20:"#740912",shade10:"#a92b1a",primary:"#b7472a",tint10:"#c75033",tint20:"#e86e58",tint30:"#ed9583",tint40:"#fdc9b5"},ot={shade30:"#094624",shade20:"#0C5F32",shade10:"#0F703B",primary:"#107C41",tint10:"#218D51",tint20:"#55B17E",tint30:"#A0D8B9",tint40:"#CAEAD8"};var rt,nt,it,st=function(){function e(e,t,o,r,i,s,l,c){this._onVersionsReadyEvent=new C,this._onDownloadTokenReadyEvent=new C,this._fullAppErrorEvent=new C,this._onVersionSelectedEvent=new C,this._onTipVersionTokenReadyEvent=new C,this._onCloseSelectedEvent=new C,this._onSaveACopySelectedEvent=new C,this._onDownloadVersionSelectedEvent=new C,this._onRestoreVersionSelectedEvent=new C,this._onIteratorSelectedEvent=new C,this._onAppRefreshTriggeredEvent=new C,this._onShowVersionChangesToggledEvent=new C,a.a.setLogger(t),this._perfTelemetryInfos=c,this._appSettings=l||{appName:n.NotSet,wdEnableDownloadTokens:!1,retryCount:3,wdEnableSaveACopy:!1,wdEnableRestore:!1,wdEnableIterator:!1,userSessionId:"",wacCluster:"",uiLocale:"en-us",isRtl:!1,useXhr:!1,viewerRootPositionRelative:!1,wdEnableHiddenButtonsUntilVersionLoadComplete:!1,wdEnableShowVersionChanges:!1,disableSaveACopy:!1,disabledChangeGates:"",wdEnableAppColorUpdate:!1,wdExperimentWithIteratorLocation:!1,wdDisableSPOFileCache:!1},f.UILocale=this._appSettings.uiLocale,this._versionHistoryStringsBag=e,this._versionHistoryCache=new b(this._onVersionsReadyEvent,this._onDownloadTokenReadyEvent,this._fullAppErrorEvent,this._onTipVersionTokenReadyEvent,o,r,this._appSettings,i,s,this._perfTelemetryInfos),this._revisionIDsToDelete=[],this._onVersionsReadyEvent.addListener(this.onVersionsReady.bind(this)),this._onDownloadTokenReadyEvent.addListener(this.onDownloadTokenReady.bind(this)),this._fullAppErrorEvent.addListener(this.fullAppError.bind(this)),this._onTipVersionTokenReadyEvent.addListener(this.onTipVersionTokenReady.bind(this)),d.setDisabledChangeGates(this._appSettings.disabledChangeGates||"")}return e.prototype.createVersionHistoryDialog=function(e){var t,o=this,r=Date.now();if(a.a.sendTraceTag(590144343,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,JSON.stringify({event:"createVersionHistoryDialog: started",startTime:r})),e){null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"CreateVersionHistoryDialogStart",TelemetryEventData:r.toString()});var i={onVersionSelectedAction:this._onVersionSelectedEvent.fireEvent.bind(this._onVersionSelectedEvent),onCloseSelectedAction:this._onCloseSelectedEvent.fireEvent.bind(this._onCloseSelectedEvent),onSaveACopySelectedAction:this._onSaveACopySelectedEvent.fireEvent.bind(this._onSaveACopySelectedEvent),onDownloadVersionSelectedAction:this._onDownloadVersionSelectedEvent.fireEvent.bind(this._onDownloadVersionSelectedEvent),onRestoreVersionAction:this._onRestoreVersionSelectedEvent.fireEvent.bind(this._onRestoreVersionSelectedEvent),onDeleteVersionsSelectedAction:function(e){return o.onDeleteVersionsSelectedEvent(e)},onIteratorSelectedAction:this._onIteratorSelectedEvent.fireEvent.bind(this._onIteratorSelectedEvent),onShowVersionChangesToggledAction:this._onShowVersionChangesToggledEvent.fireEvent.bind(this._onShowVersionChangesToggledEvent),getVersions:function(){return o.getVersions()},getDownloadToken:function(e,t){return o.getDownloadToken(e,t)},deleteVersions:function(){return o.deleteVersions()}},s=et;if(this._appSettings.appName)switch(this._appSettings.appName){case n.Word:s=!!this._appSettings.wdEnableAppColorUpdate?$e:et;break;case n.PowerPoint:s=tt;break;case n.Excel:s=ot;break;default:a.a.sendTraceTag(592548236,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"invalid app name used"+this._appSettings.appName)}else a.a.sendTraceTag(592548237,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"no app name was passed in");return t=s,w.versionCardRootSelectedBoxShadow=t.primary,w.spinnerTopColor=t.primary,w.appColors=t,E.versionCardRootSelectedBoxShadow=t.primary,E.headerDefaultButtonFont=t.primary,E.headerDefaultButtonHoverFont=t.shade10,E.headerDefaultButtonActiveFont=t.shade10,E.spinnerTopColor=t.primary,E.appColors=t,Ze(e,{localizedStrings:this._versionHistoryStringsBag,appSettings:this._appSettings},i).then((function(e){return o._versionHistoryDialog=e,o._versionHistoryDialog.insertVersions(o._versionHistoryCache.Versions),null!=o._perfTelemetryInfos&&o._perfTelemetryInfos.push({TelemetryEventKey:"CreateVersionHistoryDialogEnd",TelemetryEventData:Date.now().toString()}),a.a.sendTraceTag(590144344,l.a.msoulscat_Wac_VersionHistory,c.a.Warning,JSON.stringify({event:"createVersionHistoryDialog: ended",error:"None",startTime:r,duration:Date.now()-r,versionCount:o._versionHistoryCache.Versions.length})),e}))}return a.a.sendTraceTag(590144345,l.a.msoulscat_Wac_VersionHistory,c.a.Error,JSON.stringify({event:"createVersionHistoryDialog: ended",error:"no containerElement",startTime:r,duration:Date.now()-r})),Promise.reject(void 0)},e.prototype.getTipVersion=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this._versionHistoryCache.getTipVersion()];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),a.a.sendTraceTag(591680147,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"VersionHistoryController.getTipVersion: unexpected exception, error: ".concat(e.message)),[3,3];case 3:return[2]}}))}))},e.prototype.updateDocId=function(e){this._versionHistoryCache.updateDocId(e)},e.prototype.getVersions=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(t){switch(t.label){case 0:this._versionHistoryDialog&&this._versionHistoryDialog.getVersionsTriggered(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this._versionHistoryCache.getVersions()];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),a.a.sendTraceTag(591680148,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"VersionHistoryController.getVersions: unexpected exception, error: ".concat(e.message)),[3,4];case 4:return[2]}}))}))},e.prototype.setVersionLoadComplete=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return this._versionHistoryDialog&&(a.a.sendTraceTag(588335171,l.a.msoulscat_Wac_VersionHistory,c.a.Info,"Version done loading"),this._versionHistoryDialog.setViewerLoading(!1)),[2]}))}))},e.prototype.setTotalChangesCount=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return this._versionHistoryDialog&&(a.a.sendTraceTag(595658889,l.a.msoulscat_Wac_VersionHistory,c.a.Info,"setTotalChangesCount with count:"+e.toString()),this._versionHistoryDialog.setTotalChangesCount(e)),[2]}))}))},e.prototype.setCurrentChangeCount=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return this._versionHistoryDialog&&(a.a.sendTraceTag(595658890,l.a.msoulscat_Wac_VersionHistory,c.a.Info,"setCurrentChangeCount with count:"+e.toString()),this._versionHistoryDialog.setCurrentChangeCount(e)),[2]}))}))},e.prototype.setFullAppErrorCode=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return this._versionHistoryDialog&&this._versionHistoryDialog.setFullAppErrorCode(e),[2]}))}))},e.prototype.setViewerError=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return e&&a.a.sendTraceTag(587309088,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"setViewerError with true"),this._versionHistoryDialog&&this._versionHistoryDialog.setViewerError(e),[2]}))}))},e.prototype.setCoauthRestoreError=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return this._versionHistoryDialog&&(this._versionHistoryDialog.setModalError(Re.Hidden),this._versionHistoryDialog.setModalError(Re.CoauthRestoreDisplayed)),[2]}))}))},e.prototype.setRestoreFailedAtServer=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return this._versionHistoryDialog&&e&&this._versionHistoryDialog.setRestoreFailedAtServer(Re.CoauthRestoreFailedServer,e),[2]}))}))},e.prototype.setRestoreInProgress=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return this._versionHistoryDialog&&this._versionHistoryDialog.setModalError(Re.CoauthRestoreInProgress),[2]}))}))},e.prototype.setDeleteConfirmation=function(){this._versionHistoryDialog&&this._versionHistoryDialog.setDeleteModalError(ze.DeleteConfirmation)},e.prototype.setDeleteInProgress=function(){this._versionHistoryDialog&&this._versionHistoryDialog.setDeleteModalError(ze.DeleteInProgress)},e.prototype.setDeletePartialFailure=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return this._versionHistoryDialog&&this._versionHistoryDialog.setDeleteModalError(ze.DeletePartialFailure),[2]}))}))},e.prototype.setDeleteFullFailure=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return this._versionHistoryDialog&&this._versionHistoryDialog.setDeleteModalError(ze.DeleteFullFailure),[2]}))}))},e.prototype.setDisableSaveACopy=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return this._appSettings&&(this._appSettings.disableSaveACopy=e),[2]}))}))},e.prototype.setSaveACopyCanceled=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return this._versionHistoryDialog&&this._versionHistoryDialog.setSaveACopyCanceled(),[2]}))}))},e.prototype.getDownloadToken=function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var o;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:if(!this._versionHistoryDialog)return[3,4];this._versionHistoryDialog.setFullAppErrorCode(r.None),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this._versionHistoryCache.getDownloadToken(e,t)];case 2:return n.sent(),[3,4];case 3:return o=n.sent(),a.a.sendTraceTag(591680149,l.a.msoulscat_Wac_VersionHistory,c.a.Error,"VersionHistoryController.getDownloadToken: unexpected exception, error: ".concat(o.message)),[3,4];case 4:return[2]}}))}))},e.prototype.deleteVersions=function(){var e,t;return Object(s.__awaiter)(this,void 0,void 0,(function(){var o;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return this.setDeleteInProgress(),[4,this._versionHistoryCache.deleteVersions(this._revisionIDsToDelete)];case 1:return o=r.sent(),null===(e=this._versionHistoryDialog)||void 0===e||e.setDeleteModalError(ze.Hidden),o&&(null===(t=this._versionHistoryDialog)||void 0===t||t.removeVersionsAndSelectNext(this._revisionIDsToDelete,o)),[2]}}))}))},e.prototype.getVersionSelectedEvent=function(){return this._onVersionSelectedEvent},e.prototype.getCloseSelectedEvent=function(){return this._onCloseSelectedEvent},e.prototype.getSaveACopySelectedEvent=function(){return this._onSaveACopySelectedEvent},e.prototype.getDownloadVersionSelectedEvent=function(){return this._onDownloadVersionSelectedEvent},e.prototype.getRestoreVersionSelectedEvent=function(){return this._onRestoreVersionSelectedEvent},e.prototype.getIteratorSelectedEvent=function(){return this._onIteratorSelectedEvent},e.prototype.getVersionsReadyEvent=function(){return this._onVersionsReadyEvent},e.prototype.getAppRefreshTriggeredEvent=function(){return this._onAppRefreshTriggeredEvent},e.prototype.getDownloadTokenReadyEvent=function(){return this._onDownloadTokenReadyEvent},e.prototype.getTipVersionTokenReadyEvent=function(){return this._onTipVersionTokenReadyEvent},e.prototype.getFullAppErrorEvent=function(){return this._fullAppErrorEvent},e.prototype.getShowVersionChangesToggledEvent=function(){return this._onShowVersionChangesToggledEvent},e.prototype.onVersionsReady=function(e){this._versionHistoryDialog&&e&&e.versions&&this._versionHistoryDialog.insertVersionsAndClearLoading(e.versions.filter((function(e){return e})))},e.prototype.onDownloadTokenReady=function(e){if(this._versionHistoryDialog&&e&&e.updatedVersions){var t=e.updatedVersions.filter((function(e){return e}));!e.versionSelected||!e.versionSelected.currentVersion||this._versionHistoryDialog.selectedVersionId&&this._versionHistoryDialog.selectedVersionId!==e.versionSelected.currentVersion.RevisionID?this._versionHistoryDialog.insertVersions(t):this._versionHistoryDialog.setVersionsAndSelectVersion(t,e.versionSelected)}},e.prototype.onTipVersionTokenReady=function(e){if(this._versionHistoryDialog&&e&&e.tipVersion&&e.tipVersion.DownloadUrl&&e.updatedVersions&&e.updatedVersions[0]&&e.tipVersion.DownloadUrl===e.updatedVersions[0].DownloadUrl){var t=e.updatedVersions.filter((function(e){return e}));this._versionHistoryDialog.selectedVersionId&&this._versionHistoryDialog.selectedVersionId!==e.updatedVersions[0].RevisionID?this._versionHistoryDialog.insertVersions(t):this._versionHistoryDialog.setVersionsAndSelectVersion(t,{currentVersion:e.updatedVersions[0],noBaseToCompareTo:!1})}},e.prototype.onDeleteVersionsSelectedEvent=function(e){this._revisionIDsToDelete=e,this.setDeleteConfirmation()},e.prototype.fullAppError=function(e){this._versionHistoryDialog&&this._versionHistoryDialog.hitFullAppError(e)},e}(),at=function(){function e(){}return e.createVersionHistoryController=function(e,t,o,r,n,i,a){var l=Object(s.__assign)(Object(s.__assign)({},OfficeVersionHistoryStrings),FriendlyDatesStrings);return new st(l,e,t,o,r,n,i,a)},e}(),lt=function(){function e(){}return e.prototype.getVersionHistoryControllerInstance=function(e){if(e&&e.docId&&e.ulsLogger)return at.createVersionHistoryController(e.ulsLogger,null===e.serviceBase||void 0===e.serviceBase?"":e.serviceBase,e.docId,null===e.latestStreamServiceBase||void 0===e.latestStreamServiceBase?"":e.latestStreamServiceBase,void 0,e.appSettings,e.perfTelemetryInfos)},e}();!function(e){e[e.None=0]="None",e[e.VHUnknown=1]="VHUnknown",e[e.VHFailedToLoadVersionList=100]="VHFailedToLoadVersionList",e[e.VHFailedToGetDownloadToken=101]="VHFailedToGetDownloadToken",e[e.VHFailedToParseVersionList=102]="VHFailedToParseVersionList",e[e.VHFetchFailed=103]="VHFetchFailed",e[e.VHVersioningNotEnabled=104]="VHVersioningNotEnabled",e[e.VHFileNotFound=105]="VHFileNotFound",e[e.VHVersionTooOld=106]="VHVersionTooOld",e[e.VHFetchException=107]="VHFetchException",e[e.VHServiceUnavailable=108]="VHServiceUnavailable",e[e.VHBadGateway=109]="VHBadGateway",e[e.VHUnauthorized=110]="VHUnauthorized",e[e.VHInternalServerError=111]="VHInternalServerError",e[e.VHEmptyVersionMetadatas=112]="VHEmptyVersionMetadatas",e[e.VHFailedHostDownload=113]="VHFailedHostDownload",e[e.VHFailedToAddDownloadToVersionStore=114]="VHFailedToAddDownloadToVersionStore",e[e.VHFailedToCacheParts=115]="VHFailedToCacheParts",e[e.VHFailedToDownloadVersionMetadata=116]="VHFailedToDownloadVersionMetadata",e[e.VHFailedToDownloadParts=117]="VHFailedToDownloadParts",e[e.VHInvalidDocID=118]="VHInvalidDocID",e[e.VHMissingDocID=119]="VHMissingDocID",e[e.VHNullDocID=120]="VHNullDocID",e[e.VHNullHashedDocID=121]="VHNullHashedDocID",e[e.VHNullGetDownloadAccessTokenRequest=122]="VHNullGetDownloadAccessTokenRequest",e[e.VHFailedToDownloadVersionFromHost=123]="VHFailedToDownloadVersionFromHost",e[e.VHNullResponseFromFetch=124]="VHNullResponseFromFetch",e[e.VHGetTipVersionException=125]="VHGetTipVersionException",e[e.VHGetVersionsException=126]="VHGetVersionsException",e[e.VHGetDownloadTokenException=127]="VHGetDownloadTokenException",e[e.VHFetchRetryException=128]="VHFetchRetryException",e[e.VHNullResponseFromRequestVersionHistory=129]="VHNullResponseFromRequestVersionHistory",e[e.VHNullResponseFromRequestDownloadToken=130]="VHNullResponseFromRequestDownloadToken",e[e.VHXhrJsonParseFailed=131]="VHXhrJsonParseFailed",e[e.VHXhrException=132]="VHXhrException",e[e.VHNullResponseFromXhr=133]="VHNullResponseFromXhr",e[e.VHFileGone=134]="VHFileGone",e[e.VHNullRevisionIDs=135]="VHNullRevisionIDs",e[e.VHRequestDeleteVersionsException=136]="VHRequestDeleteVersionsException",e[e.VHNullResponseFromRequestDeleteVersions=137]="VHNullResponseFromRequestDeleteVersions",e[e.VHVersionInfoFromTipVersionException=138]="VHVersionInfoFromTipVersionException"}(rt||(rt={})),function(e){e[e.NotSet=0]="NotSet",e[e.PowerPoint=100]="PowerPoint",e[e.Word=110]="Word",e[e.Excel=120]="Excel",e[e.OneNote=130]="OneNote"}(nt||(nt={})),function(e){e[e.None=0]="None",e[e.Share=1]="Share",e[e.Rename=2]="Rename",e[e.Restore=3]="Restore"}(it||(it={}));var ct=new lt;o.d(t,"FactoryGlobal",(function(){return ct}))},381:function(e,t){e.exports={CancelGlyph_16:"CancelGlyph_16",ArrowStyle3_20:"ArrowStyle3_20",ArrowBack_20:"ArrowBack_20",BackChevronPaddle_24:"BackChevronPaddle_24",NextChevronPaddle_24:"NextChevronPaddle_24",CommonControlChevronRight_16:"CommonControlChevronRight_16",CommonControlChevronLeft_16:"CommonControlChevronLeft_16",CommonControlChevronDown_16:"CommonControlChevronDown_16",UpChevronMedium_20:"UpChevronMedium_20",DownChevronMedium_20:"DownChevronMedium_20",CommonControlMore_12:"CommonControlMore_12",Ellipsis_12:"Ellipsis_12",HintBarEllipses_20:"HintBarEllipses_20",CancelGlyph_16:"CancelGlyph_16",CommonControlChevronDown_8:"CommonControlChevronDown_8",CommonControlChevronDownGlyph_8:"CommonControlChevronDownGlyph_8",CommonControlChevronDownGlyph_12:"CommonControlChevronDownGlyph_12",CommonControlChevronUp_8:"CommonControlChevronUp_8",CommonControlChevronRight_12:"CommonControlChevronRight_12",CommonControlChevronRight_16:"CommonControlChevronRight_16",CommonControlChevronLeft_16:"CommonControlChevronLeft_16",CommonControlCheckboxCheck_16:"CommonControlCheckboxCheck_16",CheckmarkWithDynamicColor_16:"CheckmarkWithDynamicColor_16",CommonControlDialogLauncher_8:"CommonControlDialogLauncher_8"}}}]);
//# sourceMappingURL=versionHistory.min.js.map