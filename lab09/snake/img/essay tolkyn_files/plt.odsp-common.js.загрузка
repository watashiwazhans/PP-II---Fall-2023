(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["plt.odsp-common"],Array(3).concat([function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.default=0]="default";e[e.shareShimmer=1]="shareShimmer";e[e.modifyPermissions=2]="modifyPermissions";e[e.permissionsList=3]="permissionsList";e[e.linkSuccess=4]="linkSuccess";e[e.grantPermissions=5]="grantPermissions";e[e.policyDetails=6]="policyDetails";e[e.error=7]="error";e[e.linkSettings=8]="linkSettings";e[e.notify=9]="notify";e[e.addPeople=10]="addPeople";e[e.linksFromTemplateList=12]="linksFromTemplateList";e[e.atMention=13]="atMention";e[e.spinner=14]="spinner";e[e.copyLinkShortcut=15]="copyLinkShortcut";e[e.permissionsPivot=16]="permissionsPivot";e[e.shareToTeams=17]="shareToTeams"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r={};n.r(r);n.d(r,"requiredDiagnostic",function(){return i});n.d(r,"optionalDiagnostic",function(){return s});n.d(r,"requiredService",function(){return o});var i="requiredDiagnostic",s="optionalDiagnostic",o="requiredService",u=r,a={String:1,Number:2,Boolean:3,Object:4,Array:5,Enum:6}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r=n(159),i=void 0;function s(e){if(void 0===i){i={};for(var t in r.e){var n=parseInt(t);if(!isNaN(n)){var s=r.e[n].toLowerCase();i[s]=n}}}var o=e?e.toLowerCase():"";return i[o]||r.e.unknown}t.e=r.e},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(136),s=n(4),o=n(26);n.d(t,"t",function(){return o.e});var u=(function(e){Object(r.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.end=function(t){t&&t.extraData&&this.data.extraData&&(t=Object(r.e)(Object(r.e)({},t),{extraData:Object(r.e)(Object(r.e)({},this.data.extraData),t.extraData)}));return e.prototype.end.call(this,t)};return t})(Object(i.e)({eventName:"Qos,",shortEventName:"Qos"},{name:{isKey:!0,isPrefixingDisabled:!0,type:s.e.String},startTimeOverride:{isPrefixingDisabled:!0,type:s.e.Number},resultCode:{isPrefixingDisabled:!0,type:s.e.String},resultType:{typeRef:o.e,isPrefixingDisabled:!0,type:s.e.Enum},error:{isPrefixingDisabled:!0,type:s.e.String},extraData:s.e.Object,extraMetrics:{isPrefixingDisabled:!0,type:s.e.Object},privacyClassification:{isPrefixingDisabled:!0,type:s.e.String}}).withData({privacyClassification:s.t.requiredService,privacyDataTypes:["productAndServicePerformance"]}))},,function(e,t,n){"use strict";n.d(t,"$",function(){return l});n.d(t,"c",function(){return c});n.d(t,"L",function(){return h});n.d(t,"k",function(){return p});n.d(t,"K",function(){return d});n.d(t,"M",function(){return v});n.d(t,"m",function(){return m});n.d(t,"g",function(){return g});n.d(t,"v",function(){return y});n.d(t,"O",function(){return b});n.d(t,"l",function(){return w});n.d(t,"s",function(){return E});n.d(t,"p",function(){return S});n.d(t,"d",function(){return x});n.d(t,"B",function(){return T});n.d(t,"b",function(){return N});n.d(t,"w",function(){return C});n.d(t,"J",function(){return k});n.d(t,"F",function(){return L});n.d(t,"C",function(){return A});n.d(t,"S",function(){return O});n.d(t,"T",function(){return M});n.d(t,"x",function(){return _});n.d(t,"E",function(){return D});n.d(t,"D",function(){return P});n.d(t,"h",function(){return H});n.d(t,"z",function(){return B});n.d(t,"P",function(){return j});n.d(t,"j",function(){return F});n.d(t,"I",function(){return I});n.d(t,"q",function(){return q});n.d(t,"Q",function(){return R});n.d(t,"_",function(){return U});n.d(t,"y",function(){return z});n.d(t,"H",function(){return W});n.d(t,"u",function(){return X});n.d(t,"n",function(){return V});n.d(t,"A",function(){return $});n.d(t,"W",function(){return J});n.d(t,"R",function(){return K});n.d(t,"U",function(){return Q});n.d(t,"r",function(){return G});n.d(t,"N",function(){return Y});n.d(t,"i",function(){return Z});n.d(t,"f",function(){return ee});n.d(t,"o",function(){return te});n.d(t,"t",function(){return ne});n.d(t,"V",function(){return re});n.d(t,"X",function(){return ie});n.d(t,"e",function(){return se});n.d(t,"a",function(){return oe});n.d(t,"G",function(){return ue});var r=n(27),i=n(32),s=n(9),o=window._spPageContextInfo,u=(o&&"21"===o.webTemplate&&o.listBaseTemplate,[]),a=!1;function f(e){var t=u.filter(function(t){return t.flightStringId===e})[0];return t?t.flightEnabled:e}function l(){return!0}function c(){return r.e.isFeatureEnabled({ODB:1977})}function h(){return r.e.isFeatureEnabled({ODB:60345})}function p(){return r.e.isFeatureEnabled({ODC:f("ManageAccessRevampConsumer"),ODB:!1,ECS:1076813,OneDrive:a?f("ManageAccessRevampConsumer"):void 0})}function d(){return!s.t.isActivated("227ee00d-a46d-42cd-8beb-de7befc5cff7","4/27/2021","Deactivate require signin link clientid flag")}function v(){return!r.e.isFeatureEnabled({ODC:f("ODCHideNonPremiumLinkFeatures"),ODB:!1,OneDrive:a?f("ODCHideNonPremiumLinkFeatures"):void 0})}function m(){return!s.t.isActivated("ac3be7d5-fbd4-47c9-b4f4-275d4e8ebb4c","02/21/2023","fixRequireSignIn")&&!r.e.isFeatureEnabled({ECS:1071208})}function g(){return!s.t.isActivated("619db829-6a03-46d3-8b8e-dfe012a69983","01/19/2023","sharingRoleFix")&&!r.e.isFeatureEnabled({ECS:1064519})}function y(){return!s.t.isActivated("a0f6091d-e62c-4e67-b0a6-72bbb134892d","02/10/2023","fixPeoplePickerOdcCustomerPromise")&&!r.e.isFeatureEnabled({ECS:1069468})}function b(){return!r.e.isFeatureEnabled({ODC:f("FamilySharingWacKS"),ODB:!1,OneDrive:a?f("FamilySharingWacKS"):void 0})}function w(){return!s.t.isActivated("da13eadb-9185-4fff-895e-e7d4e149be07","01/18/2023","external sharing in people picker")&&!r.e.isFeatureEnabled({ECS:1056503})}function E(){return!s.t.isActivated("8a705e30-e665-4b70-a48f-be3b5872cdb4","10/22/2021","copyLink shortcut experiment killswitch")&&!r.e.isFeatureEnabled({ECS:108074})}function S(){return!s.t.isActivated("cb7d2c6b-f7da-457b-aca2-d8b94f0ababb","01/18/2023","fixLinkSettingsOpenLog")&&!r.e.isFeatureEnabled({ECS:1064203})}function x(){return!s.t.isActivated("b94c9c2c-6f5f-4f91-b002-0bd352472576","01/05/2023","fixOnAudienceChange")&&!r.e.isFeatureEnabled({ECS:1061682})}function T(){return s.t.isActivated("faddb478-21be-4f5e-8faa-df13a82e3741","04/03/23","fix Share Link Details input")||r.e.isFeatureEnabled({ECS:1081339})}function N(){return!s.t.isActivated("FE17821F-BAE7-44D8-91C0-5145C4D97969","10/01/2021","Invite placeholder user")&&r.e.isFeatureEnabled({ODB:60596})}function C(){return s.t.isActivated("34f56314-e874-4fd6-ab55-d5989a76f8ae","10/12/2021","Check sharing abilities for read permissions")||r.e.isFeatureEnabled({ECS:100295})}function k(){return r.e.isFeatureEnabled({ODB:60149})}function L(){return!s.t.isActivated("dcfb2c5d-46bc-4a7f-8970-f5066f36bb16","10/12/2021","Share To Teams in web")}function A(){return!s.t.isActivated("8511183b-9de9-4797-ada1-ac052cf3ecb1","2/23/2022","Manage Access V3 in ODB")}function O(){return s.t.isActivated("2B61136D-C6A8-432B-9B67-392506BF2DB4","12/07/2021","fix NGSC userphoto")||r.e.isFeatureEnabled({ECS:112341})}function M(){return s.t.isActivated("5108f6ec-83ee-43f0-b941-7183bcf0a99f","02/09/2022","get GSI response before rendering Share component")||r.e.isFeatureEnabled({ECS:1002677})}function _(){return s.t.isActivated("45a2c5f9-21b8-4775-9e30-4e61d1f67106","02/02/2022","use new share Messenger for cross window communication")||r.e.isFeatureEnabled({ECS:1000619})}function D(){return s.t.isActivated("7D579513-ED41-46CC-A73A-20870B56E146","02/04/2022","html format copy link")||r.e.isFeatureEnabled({ECS:1000922})}function P(){return!s.t.isActivated("e6dbe5d1-55f9-439b-a975-1931c6bf9c90","02/25/2021","People picker improvements")&&!r.e.isFeatureEnabled({ECS:1005398})}function H(){return r.e.isFeatureEnabled({ODC:f("FamilySharing"),ODB:!1,OneDrive:a?f("FamilySharing"):void 0})}function B(){return s.t.isActivated("61C832C8-21D8-4A3C-AB3F-96B622EDF097","05/03/2022","sharing telemetry change")||r.e.isFeatureEnabled({ECS:1014685})}function j(){return!s.t.isActivated("2f7d46e9-cb5e-4ab7-8239-0c53e0934af9","05/06/2022","refactorCopyLinkSection")&&!r.e.isFeatureEnabled({ECS:1015255})}function F(){return s.t.isActivated("725d183a-c483-493d-9da2-9625b110c77e","04/28/2022","share site theming fix")||r.e.isFeatureEnabled({ECS:1014033})}function I(){return s.t.isActivated("0865093c-8bb2-4412-bde8-5d4fdfb6cd0b","05/16/2022","share link details action btn fix ks")||i.e.isFeatureEnabled({ECS:1016798})}function q(){return s.t.isActivated("6f92e945-60ed-4655-8ae4-8ea1fd9355ba","05/18/2022","share update select tooltip to callout ks")||i.e.isFeatureEnabled({ODC:f("SharingTooltipCalloutKS"),ECS:1017301,OneDrive:a?f("SharingTooltipCalloutKS"):void 0})}function R(){return s.t.isActivated("6da0bda6-e708-4aea-80ef-0cf1a2b7fbd1","07/28/2022","wait for 29 sec if microservice share still did not receive context info, we mark it as expected failure")||i.e.isFeatureEnabled({ECS:1033235})}function U(){return!s.t.isActivated("6acc2587-8c04-4366-960a-8754df787145","10/03/2022","People picker 3s search with non mail security group indexing")&&!r.e.isFeatureEnabled({ECS:1044963})&&r.e.isFeatureEnabled({ODB:1596})||r.e.isFeatureEnabled({ODC:f("Enable3SonWacWord"),ODB:!1,ECS:1076914,OneDrive:a?f("Enable3SonWacWord"):void 0})}function z(){return s.t.isActivated("d6acbcb0-5618-4923-b629-0cdd43763c4a","10/31/2022","new header reformat")||i.e.isFeatureEnabled({ECS:1050305})}function W(){return!s.t.isActivated("ee93955a-86ab-4a37-8d56-90bb650597e6","11/03/2022","ask shareLink to return nav in copy link instead of adding it on the client side")&&!i.e.isFeatureEnabled({ECS:1050946})}function X(){return!s.t.isActivated("9d1d251f-6408-4e8d-9307-3bf390882d26","11/08/2022","Enable 3s init call when launching sharedialog")&&!i.e.isFeatureEnabled({ECS:1051805})}function V(){return!s.t.isActivated("eedcb79a-92e9-4d30-94b2-2c5aa2b4796a","11/30/2022","report ASHA customer promise")&&!i.e.isFeatureEnabled({ECS:1056502})}function $(){return s.t.isActivated("925a3ec4-31b0-4511-9c21-f4059a23084a","11/30/2022","Max height set in od-Share based on window.parent.innerHeight")||i.e.isFeatureEnabled({ECS:1056462})}function J(){return s.t.isActivated("8eadce6c-f9e5-4276-9513-09fa22db604f","12/6/2022","show edit and view permissions when requesting access")||i.e.isFeatureEnabled({ECS:1057666})}function K(){return!s.t.isActivated("eed24e3c-2a9b-47cf-9505-3fe89cb0e1e7","12/11/2022","Default message text with document summary")&&r.e.isFeatureEnabled({ODB:1785})}function Q(){return!s.t.isActivated("429328b1-73c4-4346-b204-29ce8a8d354d","12/21/2022","Enable rendering a message bar in the default, copy link, or manage access sharing dialog.")&&i.e.isFeatureEnabled({ODB:1556})}function G(){return s.t.isActivated("4d8d94d3-0fe1-4964-ab4d-ff9c8653e4ba","12/20/2022","Add / Remove PSL users KS")||i.e.isFeatureEnabled({ECS:1066831})}function Y(){return s.t.isActivated("4456afcc-746e-405e-b60e-164960cf7116","1/10/2023","Fix for manage access back button not working through shared with facepile endpoint")||i.e.isFeatureEnabled({ECS:1062499})}function Z(){return!s.t.isActivated("2a092b3f-6729-4a0a-a847-7c2e1dc366e9","1/24/2023","Contextual Sharing Feature")&&!i.e.isFeatureEnabled({ECS:1065461})&&r.e.isFeatureEnabled({ODB:1743})}function ee(){return!s.t.isActivated("d685ea9e-632d-414f-9b9c-6982bc1c6eec","01/24/2023","Disables expiration date picker based on get/delete submitOnlyLink status.")}function te(){return!s.t.isActivated("a8176101-afe0-4540-975d-cd326db8ee52","01/23/2023","Allows file request sharelink to be edited from manage access pane.")}function ne(){return s.t.isActivated("3e85cd31-2807-44c1-96bf-35f08619ec11","1/31/2023","Fix for not appending navId to SPL link")}function re(){return s.t.isActivated("5a8c7e3f-c3a1-4937-b292-499cbc09620b","2/23/2023","Simplified Sharing Dialog")||i.e.isFeatureEnabled({ECS:1080753})}function ie(){return r.e.isFeatureEnabled({ODB:60045})}function se(){return!s.t.isActivated("25e8dd3e-bd83-48a1-99d8-35f34eaf9031","1/13/2023")&&!r.e.isFeatureEnabled({ODC:f("ODCFacepileFeature"),ODB:!1,OneDrive:a?f("ODCFacepileFeature"):void 0})&&i.e.isFeatureEnabled({ECS:1066859})}function oe(){return s.t.isActivated("ccfe8581-04e5-4529-b8c4-d2b8512f0b1a","03/23/2023","KS for showing search directory, and filtering personas based on email to remove duplicates")||i.e.isFeatureEnabled({ECS:1078726})}function ue(){return s.t.isActivated("1e2059ca-d032-4ff5-83b5-c5ff4a9e0479","03/30/2023","KS for using sharing scope instead of linkKind to determind if user is external and has CSL configured")||i.e.isFeatureEnabled({ECS:1080346})}},function(e,t,n){"use strict";n.d(t,"n",function(){return f});n.d(t,"e",function(){return v});n.d(t,"t",function(){return v});var r=n(152),i=n(62),s="".concat("KillSwitchOverrides","_").concat("enableKillSwitches"),o="".concat("KillSwitchOverrides","_").concat("disableKillSwitches");function u(e){try{var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}catch(e){return""}}function a(e){var t=[],n=[];for(var r in e)(e[r]?t:n).push(r);try{document.cookie="".concat(s,"=").concat(t.join(","),";path=/;samesite=none;secure;").concat(t.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;");document.cookie="".concat(o,"=").concat(n.join(","),";path=/;samesite=none;secure;").concat(n.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;")}catch(e){}}function f(){if(h){for(var e=[],t=0,n=Object.keys(h);t<n.length;t++){var r=n[t];e.push(h[r]?r:"!".concat(r))}return e.join(",")}}function l(){return(function(e,t,n,r){if(t)for(var s=0,o=t.split(",");s<o.length;s++){var u=o[s];e[i.normalizeUpper(u,!1)]=!0}if(n)for(var a=0,f=n.split(",");a<f.length;a++){u=f[a];e[i.normalizeUpper(u,!1)]=!1}if(r)for(var l=0,c=r.split(",");l<c.length;l++){"!"===(u=c[l])[0]?e[i.normalizeUpper(u.slice(1),!1)]=!1:e[i.normalizeUpper(u,!1)]=!0}return e})({},u(s),u(o),void 0)}var c,h={},p=function(){h=l();var e=(function(){try{return location.search?location.search.substring(1):""}catch(e){return""}})(),t=Object(r.e)(e);t.enableKillSwitches,t.disableKillSwitches,t.debugKillSwitches;0;a(h);try{window.__debugSetKillSwitch=function(e,t){void 0===t&&(t=!0);h[i.normalizeUpper(e,!1)]=!!t;a(h)}}catch(e){}p=function(){}};function d(e,t){c&&c(e,t)}var v=(function(){function e(){}e.initKillSwitches=function(t){e._killSwitch=m({killSwitches:t||{}})};e.isActivated=function(t,n,r){var i;p();if(e._killSwitch){e.isActivated=e._killSwitch.isActivated;return e._killSwitch.isActivated(t,n,r)}try{if(window._spPageContextInfo){var s=m(window._spPageContextInfo);(null===(i=window._spPageContextInfo)||void 0===i?void 0:i.killSwitches)&&(e.isActivated=s.isActivated);return s.isActivated(t,n,r)}if(window.Flight){var o=void 0;if(window.Flight.KillSwitches){o={};for(var u=0,a=Object.keys(window.Flight.KillSwitches);u<a.length;u++){var f=a[u];o[window.Flight.KillSwitches[f]]=!0}}var l=m({killSwitches:o});o&&(e.isActivated=l.isActivated);return l.isActivated(t,n,r)}}catch(e){d(t,!1);return!1}d(t,!1);return!1};return e})();function m(e){var t=e&&e.killSwitches;return{isActivated:function(e,n,r){var s=!1;if(e){var o=i.normalizeUpper(e,!1);o in h?s=!!h[o]:t&&(s=!!t[o])}d(e,s);return s}}}},function(e,t,n){"use strict";n.d(t,"a",function(){return L});n.d(t,"F",function(){return A});n.d(t,"I",function(){return O});n.d(t,"j",function(){return M});n.d(t,"e",function(){return E});n.d(t,"R",function(){return _});n.d(t,"z",function(){return D});n.d(t,"U",function(){return P});n.d(t,"B",function(){return B});n.d(t,"L",function(){return j});n.d(t,"k",function(){return F});n.d(t,"M",function(){return I});n.d(t,"A",function(){return q});n.d(t,"O",function(){return R});n.d(t,"_",function(){return U});n.d(t,"b",function(){return z});n.d(t,"y",function(){return W});n.d(t,"l",function(){return X});n.d(t,"f",function(){return V});n.d(t,"E",function(){return $});n.d(t,"o",function(){return K});n.d(t,"S",function(){return Q});n.d(t,"p",function(){return G});n.d(t,"N",function(){return Y});n.d(t,"m",function(){return Z});n.d(t,"s",function(){return ee});n.d(t,"x",function(){return ne});n.d(t,"P",function(){return re});n.d(t,"h",function(){return ie});n.d(t,"v",function(){return se});n.d(t,"w",function(){return oe});n.d(t,"d",function(){return ue});n.d(t,"r",function(){return ae});n.d(t,"i",function(){return fe});n.d(t,"D",function(){return le});n.d(t,"c",function(){return ce});n.d(t,"u",function(){return he});n.d(t,"q",function(){return pe});n.d(t,"C",function(){return de});n.d(t,"T",function(){return ve});n.d(t,"H",function(){return me});n.d(t,"t",function(){return ge});n.d(t,"n",function(){return ye});n.d(t,"g",function(){return be});var r=n(0),i=n(202),s=n(242),o=n(55),u=n(370),a=1,f=2,l=n(203),c=n(29),h=n(35),p=n(1),d=n(15),v=n(266),m=n(96),g=n(8),y=/[<>&'"\\]/g,b={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","\\":"&#92;"};function w(e){return b[e]}var E,S=(function(){function e(){}e.encodeText=function(e){return e?e.replace(y,w):""};return e})(),x=n(22),T=n(6),N=n(97),C=n(134),k=n(49),L=[p.Uu,p.nr,p.Ku,p.aa,p.Vu,p.on,p.yo],A=[p.bu,p.du,p.Eu,p.Su,p.wu,p.au,p.gu],O=[p.fu,p.uu,p.hu,p.iu,p.pu,p.cu,p.lu,p.su,p.yu,p.mu,p.vu,p.ou],M=[p.Nn,p.Zt,p.Xn,p.W,p.$n,p.kn,p.Cn,p.te,p.Lo,p.Wr,p.zr,p.st];(function(e){e[e.none=0]="none";e[e.pastDate=1]="pastDate";e[e.adminPolicy=2]="adminPolicy";e[e.overMax=3]="overMax";e[e.adminRequired=4]="adminRequired"})(E||(E={}));function _(e,t){return H(e,t=t||26)}function D(e,t){return H(e,t=t||25)}function P(e,t){return H(e,t=t||20)}function H(e,t){if(!e)return"";var n=t,r=n/2;if(e.length<=n)return e;var i=e.slice(0,r),s=e.slice(e.length-r);return"".concat(i,"...").concat(s)}function B(e){return e.userRole===i.e.none&&e.defaultLinkKind===s.e.uninitialized}function j(e,t){switch(e){case"anonymous":return t?s.e.anonymousEdit:s.e.anonymousView;case"organization":return t?s.e.organizationEdit:s.e.organizationView;case"users":return s.e.flexible;default:return s.e.direct}}function F(e){switch(e){case"anonymous":return o.e.anyone;case"organization":return o.e.organization;case"users":return o.e.specificPeople;default:return o.e.existing}}function I(e){switch(e){case s.e.anonymousEdit:case s.e.anonymousView:return"anonymous";case s.e.organizationEdit:case s.e.organizationView:return"organization";case s.e.flexible:return"users";default:return"existingAccess"}}function q(e){switch(e){case o.e.anyone:return"anyone";case o.e.organization:return"organization";case o.e.specificPeople:case o.e.specificPeopleFlex:case o.e.customLabeledSpecificPeople:return"specificPeople";case o.e.existing:default:return"existingAccess"}}function R(e){switch(e){case o.e.anyone:return u.e.anyone;case o.e.organization:return u.e.organization;case o.e.specificPeople:case o.e.specificPeopleFlex:case o.e.customLabeledSpecificPeople:return u.e.specificPeople;case o.e.existing:default:return u.e.existing}}function U(e){switch(e){case a:return"created";case f:return"updated";default:return"uninitialized"}}function z(e,t,n){var r=t.sharingLinkKind,i=t.audience,u=window.require?window.require.toUrl("odsp-media/images/sharedialog"):"https://res-1.cdn.office.net/files/fabric-cdn-prod_20211207.001/assets/icons/sharing",a=d.l(e)?"directrecipients.svg":"peopleinchat.svg";switch(r){case s.e.organizationView:case s.e.organizationEdit:return"".concat(u,"/companyonly.svg");case s.e.anonymousView:case s.e.anonymousEdit:return"".concat(u,"/anyone.svg");case s.e.flexible:return t.audience===o.e.customLabeledSpecificPeople?n&&n.iconUrl||"".concat(u,"/").concat(a):"".concat(u,"/specificpeople.svg");default:return i===o.e.customLabeledSpecificPeople?n&&n.iconUrl||"".concat(u,"/").concat(a):window.require?"".concat(u,"/existingaccess.svg"):"".concat(u,"/existingaccess.svg?v2")}}function W(e){if(e.isCreateOnlyLink)return"FileRequest";switch(e.sharingLinkKind){case s.e.requestAccess:return"Mail";case s.e.organizationView:case s.e.organizationEdit:return"Work";case s.e.anonymousView:case s.e.anonymousEdit:return"Globe";case s.e.flexible:return e.audience===o.e.anyone?"Globe":e.audience===o.e.organization?"Work":"PeopleAdd";default:return"Link"}}function X(){return{palette:{themePrimary:"#3A96DD",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#004578",themeDarker:"#82C7FF",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",neutralQuaternary:"#605E5C",neutralTertiaryAlt:"#484644",neutralTertiary:"#A19F9D",neutralSecondary:"#BEBBB8",neutralPrimaryAlt:"#E1DFDD",neutralPrimary:"#F3F2F1",neutralDark:"#FAF9F8",redDark:"#FF4343",black:"#FFFFFF",white:"#252423",primaryBackground:"#f9f8f7",primaryText:"#252423",bodyBackground:"#252423",bodyText:"#252423",disabledBackground:"#3B3A39",disabledText:"#c8c8c8"}}}function V(e,t,n,r){var i=d.l(e);switch(n&&n.audienceType||i&&"recipient"){case"channel":switch(t){case"edit":return p.Oi;case"review":return v.e[r]?p.Mi:p._i;default:return p.Di}case"team":switch(t){case"edit":return p.Fi;case"review":return v.e[r]?p.Ii:p.qi;default:return p.Ri}case"recipient":switch(t){case"edit":return p.Js;case"review":return v.e[r]?p.Ks:p.Qs;default:return p.Gs}default:switch(t){case"edit":return p.Pi;case"review":return v.e[r]?p.Hi:p.Bi;default:return p.ji}}}function $(e,t,n,r,i,u){var a=e.sharingLinkKind,f=e.audience;if(e.isCreateOnlyLink)return!e.allowsAnonymousAccess&&t?h.n(p.en,t):p.tn;if(u)return p.s;switch(a){case s.e.requestAccess:var l=e.invitees[0],c=l.primaryText||l.email||l.id;return h.n(p.ao,c);case s.e.organizationView:return h.n(p.Ze,t);case s.e.organizationEdit:return h.n(p.Ke,t);case s.e.anonymousView:return p.F;case s.e.anonymousEdit:return p.O;case s.e.direct:return f===o.e.customLabeledSpecificPeople?e.isReview?r&&r.entityName?h.n(p.rt,r.entityName):V(n,"review",r,i):e.isEdit?r&&r.entityName?h.n(p.nt,r.entityName):V(n,"edit",r):r&&r.entityName?h.n(p.it,r.entityName):V(n,"view",r):p.Ot;case s.e.flexible:return f===o.e.existing?p.Ot:f===o.e.anyone?e.blockDownload?e.hasPassword?p.q:p.I:e.hasPassword?e.isReview?v.e[i]?p.P:p.H:e.isEdit?p.D:p.B:e.isReview?v.e[i]?p._:p.j:e.isEdit?p.O:p.F:f===o.e.customLabeledSpecificPeople?e.isReview?r&&r.entityName?h.n(p.rt,r.entityName):V(n,"review",r,i):e.isEdit?r&&r.entityName?h.n(p.nt,r.entityName):V(n,"edit",r):r&&r.entityName?h.n(p.it,r.entityName):V(n,"view",r):e.audience===o.e.organization?e.blockDownload?h.n(p.et,t):e.isReview?v.e[i]?h.n(p.Ge,t):h.n(p.Ye,t):e.isEdit?h.n(p.Ke,t):h.n(p.Ze,t):e.blockDownload?p._u:e.isReview?v.e[i]?p.Os:p.Ms:e.isEdit?p.As:p._s;default:return""}}function J(e){return{principalId:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,principalType:e.type}}function K(e){return{id:e.principalId,primaryText:e.name,imageUrl:e.image,loginName:e.userId,email:e.email,secondaryText:e.job,isExternal:e.isExternal,type:e.principalType}}function Q(e){for(var t=[],n=e.principals,r=e.invitees,i=0,s=n;i<s.length;i++){var o=s[i];t.push(J(o))}for(var u=function(e){0===(!0===e.isExternal?t.filter(function(t){return t.email===e.email}):t.filter(function(t){return t.principalName===e.loginName})).length&&t.push(J(e))},a=0,f=r;a<f.length;a++){u(f[a])}return t}function G(e){if(!e)return 0;var t=0,n=e.length,r=0,i=!1;if(0===e.length)return 0;for(var s="&#160;",o="<br />",u="&quot;&quot;&quot;",a="&amp;",f="&#39;",l="&lt;",c="&gt;",h=" ";r<n;){var p=null,d=e[r];if(" "===d)p=r+1<n&&" "===e[r+1]||i?s:" ";else if("\n"===d){p=o;i=!0}else{'"'===d?p=u:"&"===d?p=a:"'"===d?p=f:"<"===d?p=l:">"===d?p=c:"\r"===d&&(p=h);i=!1}t+=null!==p?p.length:1;r++}return t}function Y(e,t){var n,r;switch(e){case i.e.manageList:n="EditListPencil";r=p.ue;break;case i.e.edit:n="Edit";r=p.ue;break;case i.e.view:n="View";r=p.ge;break;case i.e.review:n="Feedback";r=p.pe;break;case i.e.owner:n="Signin";r=p.un;break;case i.e.none:n="Delete";r=p.bt}return{name:n,title:t?r.toLowerCase():r}}function Z(e){var t=i.e.none,n=te(),r=e.accessMap;null==r||r.forEach(function(e){var r=ne(e);n.indexOf(r)>n.indexOf(t)&&(t=r)});return t}function ee(e,t){var n=te();return n.indexOf(e)>n.indexOf(t)}function te(){return[i.e.none,i.e.submit,i.e.restrictedview,i.e.view,i.e.review,i.e.edit,i.e.manageList,i.e.owner]}function ne(e){var t=e.role,n=e.rawPermission;if(e.isSPO);else{if(n.roles){t=i.e.view;for(var r=0,s=n.roles;r<s.length;r++){"write"===s[r]&&(t=i.e.edit)}}n.link&&n.link.type&&("edit"===n.link.type?t=i.e.edit:"view"===n.link.type&&(t=i.e.view))}return t}function re(e){return e===i.e.edit||Object(g.L)()&&e===i.e.manageList}function ie(e,t){return Object(g.L)()&&d.r(e)&&(null==t?void 0:t.sharedObjectType)===m.e.list?i.e.manageList:i.e.edit}function se(e,t){var n=E.none,r=t;if(!e||e.getTime()===new Date(0).getTime())return n;var i=new Date;i.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());var s=Math.floor((e.getTime()-i.getTime())/864e5);s<1?n=E.pastDate:s>730?n=E.overMax:s>r&&-1!==r&&(n=E.adminPolicy);return n}function oe(e,t){return e===o.e.anyone?t?s.e.anonymousEdit:s.e.anonymousView:e===o.e.organization?t?s.e.organizationEdit:s.e.organizationView:e===o.e.specificPeople||e===o.e.existing?s.e.direct:s.e.flexible}function ue(e,t){switch(e){case E.pastDate:return p.Li;case E.adminPolicy:return h.n(p.N,t);case E.overMax:return h.n(p.Vn,730);case E.adminRequired:return p.co;default:return""}}function ae(e){return e.canAddExternalPrincipal||e.canAddInternalPrincipal}function fe(e){return!!(e&&e.organizationLinkAbilities&&e.organizationLinkAbilities.canManageReadLink)&&e.organizationLinkAbilities.canManageReadLink.enabled}function le(e,t,n){return d.l(e)||t===l.e.linkSettings&&d.h(e)&&n&&(!!n.entityName||!!n.audienceType)}function ce(e){var t=e;if(-1===t)return null;var n=new Date;n.setDate(n.getDate()+t);return n}function he(e){var t,n;return Object(r.t)(this,void 0,void 0,function(){var i,s,o,u,a,f,l,c,h,p;return Object(r.i)(this,function(r){switch(r.label){case 0:i=!1;if(d.o(e.clientId))return[3,7];s=new T.e({name:"shareLinkExecCopyCommandToClipboard"});try{e.textField.focus();e.textField.setSelectionRange(0,e.textField.value.length);i=document.execCommand("copy");s.end({resultType:T.t.Success})}catch(e){h=new k.e({code:"exeCopyCommandError",innerError:e});s.end(Object(C.e)(Object(N.e)(e),{resultCode:h.code}))}if(!window.navigator||!window.navigator.clipboard)return[3,7];o=new T.e({name:"shareLinkClipboardWrite"});r.label=1;case 1:r.trys.push([1,6,,7]);if(Object(g.E)()||!("write"in window.navigator.clipboard)||!e.itemName)return[3,3];u=(null===(t=e.textField)||void 0===t?void 0:t.value)||e.linkUrl;"text/plain";"text/html";a=new Blob([u],{type:"text/plain"});f=new Blob(["<a href=".concat(u,">").concat(S.encodeText(e.itemName),"</a>")],{type:"text/html"});l=[new ClipboardItem((p={},p["text/plain"]=a,p["text/html"]=f,p))];return[4,window.navigator.clipboard.write(l)];case 2:r.sent();return[3,5];case 3:return[4,window.navigator.clipboard.writeText((null===(n=e.textField)||void 0===n?void 0:n.value)||e.linkUrl)];case 4:r.sent();r.label=5;case 5:i=!0;o.end({resultType:T.t.Success});return[3,7];case 6:c=r.sent();h=new k.e({code:"clipboardWriteError",innerError:c});o.end(Object(C.e)(Object(N.e)(c),{resultCode:h.code}));return[3,7];case 7:try{i=Object(x.n)(e.linkUrl)}catch(e){}return[2,i]}})})}function pe(e,t){return!Object(g.S)()&&e&&e.toLowerCase().indexOf("/_layouts/15/userphoto.aspx")>=0&&location.href.toLowerCase().indexOf("sharedialog.aspx")<0&&(d.a(t)||d.v(t))}function de(e,t){var n=e.sharingLinks,r=e.sharingPrincipals,o=t?n:n.filter(function(e){var t=new Date(e.expiration);return e.isActive&&e.sharingLinkKind!==s.e.direct&&(!e.expiration||t.getTime()>Date.now())&&!(e.isAddressBarLink&&!0===e.isUnhealthy)}),u=!!o.length;if(!u&&r.length)for(var a=0,f=r;a<f.length;a++){if(f[a].role!==i.e.owner){u=!0;break}}return{shared:u,activeLinks:o,sharingPrincipals:r}}function ve(e){var t;switch(e){case c.e.user:t="user";break;case c.e.none:t="none";break;default:t="group"}return t}function me(e){var t=new Date(null),n=new Date(0),r=e instanceof Date&&!isNaN(e.getTime()),i=!1;if(r)try{var s=new Date(e),o=s.getFullYear&&s.getFullYear();0!==o&&1!==o||(i=!0)}catch(e){}return!e||e===t||e===n||i||!r}var ge=340,ye=480,be=function(e){var t=e.clientId,n=e.companyName,r=e.currentSettings,u=e.customLabeledAudienceConfig,a=e.sharingInformation;if(!r||!a)return"";if(r.preventDownload){if(r.audience===o.e.anyone)return p.I;if(r.audience===o.e.organization)return h.n(p.et,n);if(r.audience===o.e.specificPeopleFlex)return p._u}switch(r.sharingLinkKind){case s.e.direct:return r.audience===o.e.specificPeople?a.requiresAccessApproval?p.oo:r.sharingRole?re(r.sharingRole)?p.ku:r.sharingRole===i.e.review?v.e[a.fileExtension]?p.Au:p.Ou:p.Mu:r.isEdit?p.ku:p.Mu:p.Ot;case s.e.organizationView:return h.n(p.Ze,n);case s.e.organizationEdit:return h.n(p.Ke,n);case s.e.anonymousView:return p.F;case s.e.anonymousEdit:return p.O;case s.e.flexible:return we(t,n,r,u,a);default:return""}},we=function(e,t,n,r,s){return n.audience===o.e.existing?p.Ot:n.audience===o.e.specificPeopleFlex?n.sharingRole?n.sharingRole==i.e.manageList?p.Lu:re(n.sharingRole)?p.ku:n.sharingRole===i.e.review?v.e[s.fileExtension]?p.Au:p.Ou:p.Mu:n.isEdit?p.ku:p.Mu:n.audience===o.e.customLabeledSpecificPeople?n.sharingRole===i.e.review?r&&r.entityName?h.n(p.rt,r.entityName):V(e,"review",r,s.fileExtension):n.isEdit?r&&r.entityName?h.n(p.nt,r.entityName):V(e,"edit",r):r&&r.entityName?h.n(p.it,r.entityName):V(e,"view",r):n.audience===o.e.organization?n.sharingRole===i.e.review?v.e[s.fileExtension]?h.n(p.Ge,t):h.n(p.Ye,t):n.sharingRole==i.e.manageList?h.n(p.Qe,t):n.isEdit?h.n(p.Ke,t):h.n(p.Ze,t):n.audience===o.e.anyone?n.sharingRole===i.e.review?v.e[s.fileExtension]?p._:p.j:n.sharingRole==i.e.manageList?p.M:n.isEdit?p.O:p.F:""}},,function(e,t,n){"use strict";n.d(t,"t",function(){return p});n.d(t,"e",function(){return v});n.d(t,"i",function(){return m});n.d(t,"r",function(){return E});n.d(t,"n",function(){return P});var r,i=n(0),s=n(147),o=n(69),u=n(137),a=n(286),f=n(9),l=0;(function(e){e[e.none=0]="none";e[e.lazy=1]="lazy";e[e.local=2]="local";e[e.optional=4]="optional";e[e.bypass=8]="bypass";e[e.async=16]="async";e[e.suspensible=32]="suspensible";e[e.notAsync=-18]="notAsync";e[e.handleViral=16]="handleViral";e[e.loaderViral=8]="loaderViral"})(r||(r={}));function c(e){return{get:function(){return new d(this.key,this.flags|e)}}}var h={async:c(r.async|r.lazy),suspensible:c(r.suspensible),lazy:c(r.lazy),local:c(r.local),optional:c(r.optional),bypass:c(r.bypass)},p=(function(){function e(e){this.id=++l;if("string"==typeof e){this.name=e;this.factory=void 0;this.loader=void 0}else{this.name=e.name;this.factory=e.factory;this.loader=e.loader}}Object.defineProperty(e.prototype,"key",{get:function(){return this},enumerable:!1,configurable:!0});e.prototype.toString=function(){return"Resource #".concat(this.id,' "').concat(this.name,'"')};return e})();Object.defineProperty(p.prototype,"flags",{value:r.none});Object.defineProperties(p.prototype,h);var d=(function(){function e(e,t){this.key=e;this.flags=t}e.prototype.toString=function(){var e=this.flags;return"".concat(this.key).concat(e&r.async?".async":e&r.suspensible?".suspensible":e&r.lazy?".lazy":"").concat(e&r.local?".local":"").concat(e&r.optional?".optional":"").concat(e&r.bypass?".bypass":"")};return e})();Object.defineProperties(d.prototype,h);var v=(function(){function e(e){this._value=e;this.dependencies={}}e.prototype.create=function(){return{instance:this._value}};return e})(),m=new p({name:"resources"});function g(e){return e===m}var y=new p({name:"asyncLoadBarrier"}),b=(function(){function e(e){this._loader=e;this._cached=void 0}e.prototype.load=function(){var e=this;return this._cached?this._cached:(this._cached=B(this._loader.load())).then(function(t){e._loader=void 0;return t},function(t){e._cached=void 0;return Promise.reject(t)})};return e})(),w=(function(){function e(e,t){this.entry=e;this.manager=t;this.instance=void 0}e.prototype.getInstance=function(e,t){if(this.instance)return this.instance;var n=this.manager,r=this.entry.factory,i=r.create(n.resolve(r.dependencies,t)),s=this.instance=i.instance;i.disposable&&n.scope.attach(i.disposable);return s};e.prototype.promote=function(t){var n=this.entry;return new e({manager:t,loader:n.loader,factory:n.factory})};return e})();function E(e,t){var n=function(n){return e.call(this,n,t)||this};n.prototype=e.prototype;return n}function S(e){return e.length<1?" Consumed directly.":Object(i.o)(Object(i.o)([],e,!0),[""],!1).reverse().join("\n  Required by ")}function x(e,t){return new Error("".concat(e," is being consumed, but is not available in the current scope.")+"\n  1) Check to ensure that the dependency on this resource (and each step up the chain) is properly declared."+"\n  2) If availability is expected, check to see if the target resource has a dependency that is only available in a child scope.".concat(S(t)))}function T(e,t){return new Error("".concat(e," is being consumed synchronously, but was exposed asynchronously and has not been loaded. Either:")+"\n  1) Ensure that the root call that is requesting this resource is a consumeAsync(). Or"+"\n  2) Ensure that the dependency on this resource is properly declared, so that it can be picked up by an earlier consumeAsync() or load() call.".concat(S(t)))}function N(e,t){return new Error("".concat(e," is being loaded, but has no factory / loader.Check to ensure that either: ")+"\n  1) ".concat(e," is defined with a 'factory' or 'loader' specified.")+"\n  2) A higher - level component calls 'expose', 'exposeFactory', or 'exposeAsync' for ".concat(e,".").concat((function(e){return e.length<2?" Loaded directly.":Object(i.o)([""],e.slice(1),!0).join("\n  Required by ")})(t)))}function C(e){return{handle:e,error:void 0}}function k(e){return{handle:void 0,error:e}}function L(e){var t=e.flags;return t&r.async?new d(e.key,t&r.notAsync):e}var A=(function(){function e(t){this._handles={};this._isLocked=!1;this._loader=void 0;var n;if(t instanceof e){if(t.isDisposed)throw new Error("Parent ResourceScope has already been disposed!");n=t.options;this._parent=t;this._level=t._level+1}else{n=t||{};this._parent=void 0;this._level=0}this.scope=new o.e;this.options=n}Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.scope.isDisposed},enumerable:!1,configurable:!0});e.prototype.block=function(e){return this._expose(e)};e.prototype.isDescendantOf=function(e){return this._level>e._level};e.prototype.getHandle=function(e){for(var t=this,n=e.id;!(n in t._handles)&&t._parent;)t=t._parent;var r=t._handles;return r[n]||this.options.useFactoriesOnKeys&&(e.factory&&(r[n]=new w({factory:e.factory,manager:t}))||e.loader&&(r[n]=new w({loader:new b(e.loader),manager:t})))||void 0};e.prototype.expose=function(e,t,n){return this._expose(e,function(e){return new w({factory:t.factory,loader:t.loader,manager:e},n&&e)})};e.prototype.getLoader=function(){if(this._loader)return this._loader;this.lock();return this._loader=new _(this)};e.prototype.dispose=function(){this.scope.dispose();this._handles={};this._loader=void 0;this.consume=this.resolve=O;this.getLoader=M};e.prototype.bind=function(e){var t=this.getHandle(e);return t?this._expose(e,function(e){return t.promote(e)}):this};e.prototype.lock=function(){this._isLocked=!!this.options.lockResourcesForChildren};e.prototype.consume=function(e,t){var n=this;this.lock();var i,s=e.flags,o=e.key;if(s&r.async){var u,a=L(e),f=function(){return n.consume(a,t)};if(g(o))return function(){return u||(u=Promise.resolve(f()))};if((p=this._getValidHandle(e,r.none,[])).handle)return function(){return u||(u=B(n.getLoader().loadAsync(a,r.none,[],[]).promise).then(f,D(s)))};if(s&r.optional)return function(){return Promise.resolve(void 0)};throw(m=p.error)[0](m[1],m[2])}if(s&r.suspensible){var l,c=(function(e){var t=e.flags;return t&r.suspensible?new d(e.key,t&~r.suspensible):e})(e);return{read:function(){if(g(o))return function(){return n.consume(c,t)};var i=n._getValidHandle(e,r.none,[]);if(i.handle)return i.handle.getInstance(o,t||{owner:"".concat(o," ")});var u=i.error;if(u[0]===T){var a=n._getValidHandle(new d(e.key,s|r.async),r.none,[]);if(a.handle)throw l||(l=B(n.getLoader().loadAsync(e,r.none,[],[]).promise).catch(function(){}));var f=a.error;throw f[0](f[1],f[2])}if(!(s&r.optional))throw u[0](u[1],u[2])}}}if(g(o)){var h;i=function(){h||(h=n.scope.attach(new P(n,t||{owner:"".concat(o," ")})));return h}}else{var p,v=(p=this._getValidHandle(e,r.none,[])).handle;if(v)i=function(){return v.getInstance(o,t||{owner:"".concat(o," ")})};else if(!(s&r.optional)){var m;throw(m=p.error)[0](m[1],m[2])}}return s&r.lazy?i:i&&i()};e.prototype.isExposed=function(e){return!!g(e.key)||!!this._getValidHandle(e,r.none,[]).handle};e.prototype.resolve=function(e,t){for(var n={},r=0,i=Object.keys(e);r<i.length;r++){var s=i[r];e[s]&&(n[s]=this.consume(e[s],t))}return n};e.prototype._getValidHandle=function(e,t,n){var i=e.key,s=i.id;if(n.indexOf(i)>=0)throw new Error("".concat(i," has a circular dependency.").concat(S(n)," "));var o=this._handles[s];if(o&&o.manager)return C(o);var u=this.getHandle(i);if(!u)return k([x,e,n]);var a=e.flags|t,f=u.entry,l=f.factory;if(a&r.async&&f.loader)return C(u);if(!l)return k([T,e,n]);for(var c=n.push(i)-1,h=u.manager,p=a&r.local?this:h||f.manager,d=l.dependencies||{},v=0,m=Object.keys(d);v<m.length;v++){var y=d[m[v]];if(y&&!g(y.key)){var b=this._getValidHandle(y,a&r.handleViral,n),E=b.handle;if(E){var N=E.manager||E.entry.manager;N.isDescendantOf(p)&&(p=N)}else if(!(y.flags&r.optional)||b.error[0]===T&&this.options.errorOnOptionalAsyncOnly)return b}}n.splice(c);if(!h||h!==p){u=new w(f,p);p._handles[s]=u}this._handles[s]=u;return C(u)};e.prototype._expose=function(t,n){if(this.isDisposed)throw new Error("Cannot expose a resource on a ResourceScope that has been disposed.");if(g(t))throw new Error("It is invalid to expose `resourceScopeKey`");var r=t.id,i=this._isLocked?this.scope.attach(new e(this)):this,s=i._handles;if(s[r]&&this.options.noDoubleExpose)throw new Error("".concat(t," has already been exposed / consumed at this scope."));s[r]=n?n(i):void 0;return i};return e})();function O(e){if(e instanceof d||e instanceof p)throw new Error("Cannot consume ".concat(e," from a disposed ResourceScope."));throw new Error("Cannot resolve resources from a disposed ResourceScope.")}function M(){throw new Error("Cannot load a resource from a ResourceScope that has been disposed.")}var _=(function(){function e(e){this._handleManager=e;this._loadState={};this._root=e.consume(y.optional)}e.prototype.loadAsync=function(e,t,n,r){if(g(e.key))return{bypass:j,promise:Promise.resolve(void 0)};var s=this._loadAsync(e,t,Object(i.o)([e],n,!0),r);return{promise:s.promise.catch(D(e.flags,!0)),bypass:s.bypass}};e.prototype.loadAllAsync=function(e,t,n,r){if(e){var i=Object.keys(e),s=i.length;if(s>0){for(var o=[];s--;){var u=e[i[s]];u&&o.push(this.loadAsync(u,t,n,r))}return{bypass:F(function(){for(var e=0,t=o;e<t.length;e++){t[e].bypass()}}),promise:Object(a.e)(o.map(function(e){return e.promise}))}}}return{bypass:j,promise:Promise.resolve(void 0)}};e.prototype._loadAsync=function(e,t,n,o){var u=this,a=e.key,l=a.id,c=this._loadState,h=e.flags|t,p=c[l];if(p){if(o&&o.indexOf(a)>=0)throw new Error("".concat(a," has a circular dependency.").concat(S(o)," "));h&r.bypass&&p.bypass();return p}if(h&r.async)return{bypass:j,promise:Promise.resolve(void 0)};var d=this._handleManager.getHandle(a);if(!d)return c[l]={bypass:j,promise:Promise.reject([N,e,n])};c[l]={bypass:j,promise:Promise.resolve(void 0)};var v=d.entry,m=v.factory;if(m)return c[l]=this.loadAllAsync(m.dependencies,h&r.loaderViral,n,o?Object(i.o)(Object(i.o)([],o,!0),[a],!1):[a]);var g=v.loader;if(!g)return c[l]={bypass:j,promise:Promise.reject([N,e,n])};var y,b=this._root,w=new s.e,E=w.resolve,x=w.reject,T=w.promise;h&r.bypass||!b?E():b.wait().then(E).catch(x);return c[l]={bypass:F(function(){if(!f.e.isActivated("D6B556B6-1D2A-4DC3-A9A2-AC42C0A3127C","06/29/2022","Allow bypass to force-resolve existing loaders")){h|=r.bypass;E();y&&y()}}),promise:T.then(function(){return g.load()}).then(function(e){v.factory=e;var t=e.dependencies;if(t){var s=u.loadAllAsync(t,h&r.loaderViral,n,o?Object(i.o)(Object(i.o)([],o,!0),[a],!1):[a]);y=s.bypass;return s.promise}})}};return e})();function D(e,t){return function(n){if(Array.isArray(n)&&"function"==typeof n[0]){if("number"==typeof e&&e&r.optional)return;if(t)return Promise.reject(n);throw n[0](n[1],n[2])}return Promise.reject(n)}}var P=(function(){function e(t,n){var r,i;if(t instanceof e){i=t._handleManager;r=t._owner}else t instanceof A?i=t:n=t||n;var s=new o.e;if(i){if(i.scope.isDisposed)throw new Error("Parent ResourceScope has already been disposed.");i.lock();i.options.lockResourcesForChildren||(this._forkOnWrite=!0)}this._handleManager=i||(i=s.attach(new A(n)));this._scope=s;var u=n?n.owner:"";this._owner=r?"".concat(r," > ").concat(u," "):u}e.prototype.consume=function(e){return this._handleManager.consume(e)};e.prototype.consumeAsync=function(e){var t=this._handleManager,n=L(e);return B(t.getLoader().loadAsync(n,r.none,[],[]).promise).then(function(){return t.consume(n)}).catch(D(n.flags))};e.prototype.load=function(e){return B(this._handleManager.getLoader().loadAllAsync(e,r.none,[],[]).promise).catch(D(r.none))};e.prototype.exposeAsync=function(e,t){this._expose(e,{loader:new b(t)})};e.prototype.exposeFactory=function(e,t){this._expose(e,{factory:t})};e.prototype.expose=function(e,t){this._expose(e,{factory:new v(t)},t);return t};e.prototype.block=function(e){this._handleManager=this._prepareWrite().block(e)};e.prototype.bind=function(e){this._handleManager=this._prepareWrite().bind(e)};e.prototype.isDefined=function(e){var t=this._handleManager;return!t.isDisposed&&!!t.getHandle(e)};e.prototype.isExposed=function(e){var t=this._handleManager;return!t.isDisposed&&t.isExposed(e)};e.prototype.injected=function(t,n){void 0===n&&(n={});var r=n.injectChildResourceScope,i={owner:n.owner||t.name},s=r?this._scope.attach(new e(this,i)):this,o=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.resources=s;var i=t.apply(this,e)||this;r&&Object(u.e)(i,H);return i};o.prototype=t.prototype;return o};e.prototype.resolve=function(e){return this._handleManager.resolve(e)};e.prototype.resolveAsync=function(e){var t=this;return this.load(e).then(function(){return t.resolve(e)})};e.prototype.resolved=function(e,t){return E(e,this.resolve(Object(i.e)(Object(i.e)({},e.dependencies||{}),t||{})))};e.prototype.resolvedAsync=function(e,t){var n=this;return this.load(Object(i.e)(Object(i.e)({},e.dependencies||{}),t||{})).then(function(){return n.resolved(e,t)})};e.prototype.dispose=function(){this._scope.dispose()};e.prototype._expose=function(e,t,n){this._handleManager=this._prepareWrite().expose(e,t,n)};e.prototype._prepareWrite=function(){if(this._forkOnWrite){this._forkOnWrite=!1;return this._scope.attach(new A(this._handleManager))}return this._handleManager};return e})();function H(){this.resources.dispose()}function B(e){var t=new s.e;e.then(function(e){return t.resolve(e)},function(e){return t.reject(e)});return t.promise}function j(){}function F(e){return function(){if(e){var t=e;e=void 0;t()}}}},,,function(e,t,n){"use strict";n.d(t,"a",function(){return s});n.d(t,"u",function(){return o});n.d(t,"r",function(){return u});n.d(t,"l",function(){return a});n.d(t,"s",function(){return f});n.d(t,"n",function(){return l});n.d(t,"o",function(){return c});n.d(t,"m",function(){return h});n.d(t,"e",function(){return p});n.d(t,"g",function(){return d});n.d(t,"t",function(){return v});n.d(t,"d",function(){return m});n.d(t,"i",function(){return g});n.d(t,"c",function(){return y});n.d(t,"p",function(){return b});n.d(t,"f",function(){return w});n.d(t,"h",function(){return E});n.d(t,"y",function(){return S});n.d(t,"v",function(){return x});var r=n(5),i=n(8);function s(e){return m(e)||y(e)||g(e)||b(e)||w(e)||(function(e){return e===r.e.officemobileIos||e===r.e.officemobileAndroid})(e)}function o(e){return e===r.e.odb||e===r.e.sharePoint||e===r.e.odc||e===r.e.consumerList||e===r.e.oneup||e===r.e.sharePointPages}function u(e){return e===r.e.consumerList}function a(e){return e===r.e.outlookWeb||e===r.e.outlookWindows||e===r.e.outlookMac||e===r.e.outlookAndroid||e===r.e.outlookiOS}function f(e){return e===r.e.odIos||e===r.e.wordIos||e===r.e.excelIos||e===r.e.visioIos||e===r.e.onenoteIos||e===r.e.powerpointIos||e===r.e.teamsIos||e===r.e.officemobileIos||e===r.e.listsIos||e===r.e.streamIos||e===r.e.loopIos||e===r.e.outlookiOS}function l(e){return e===r.e.odAndroid||e===r.e.wordAndroid||e===r.e.excelAndroid||e===r.e.visioAndroid||e===r.e.onenoteAndroid||e===r.e.powerpointAndroid||e===r.e.teamsAndroid||e===r.e.officemobileAndroid||e===r.e.streamAndroid||e===r.e.outlookAndroid}function c(e){return f(e)||l(e)}function h(e){return o(e)||e===r.e.onenoteWeb||e===r.e.outlookWeb||e===r.e.officecom||e===r.e.teams||e===r.e.sample||e===r.e.outlookGroupsWeb||e===r.e.fluid||e===r.e.odcWac||e===r.e.wac||e===r.e.businesscentral||e===r.e.listPart||e===r.e.listsHome||e===r.e.shareDemo||c(e)}function p(e){return o(e)||e===r.e.listPart||e===r.e.shareDemo}function d(e){return o(e)||e===r.e.officecom||e===r.e.wac||e===r.e.businesscentral}function v(e){return c(e)||E(e)}function m(e){return e===r.e.word||e===r.e.wordAndroid||e===r.e.wordIos}function g(e){return e===r.e.excel||e===r.e.excelAndroid||e===r.e.excelIos}function y(e){return e===r.e.powerpoint||e===r.e.powerpointAndroid||e===r.e.powerpointIos}function b(e){return e===r.e.visio||e===r.e.visioIos||e===r.e.visioAndroid}function w(e){return e===r.e.onenote||e===r.e.onenoteWeb||e===r.e.onenoteUWP||e===r.e.onenoteIos||e===r.e.onenoteAndroid}function E(e){return e===r.e.teams||e===r.e.teamsIos||e===r.e.teamsAndroid}function S(e){return e===r.e.odc||i.O()&&e===r.e.odcWac}function x(e){return e===r.e.word||e===r.e.excel||e===r.e.powerpoint||e===r.e.ngsc||e===r.e.visio||e===r.e.windowsShare}},,,,,function(e,t,n){"use strict";var r=n(169);t.e=r.e},function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"n",function(){return f});n.d(t,"t",function(){return l});n.d(t,"r",function(){return c});n.d(t,"i",function(){return h});var r=n(0),i=(n(84),n(60),n(220),n(6)),s=(n(26),n(4),n(67),n(136),n(61),n(97));n(134);var o,u=n(1),a=n(465);(function(e){e[e.render=0]="render";e[e.api=1]="api";e[e.generic=2]="generic"})(o||(o={}));function f(e){var t;switch(e){case 2:case 9:t="files";break;case 3:t="doclib";break;case 4:t="sync";break;case 12:case 41:case 42:t="list";break;default:t=void 0}return t}function l(e,t,n,i){var s=e?Object(r.e)({},e):null,f=n;switch(t){case o.generic:case o.render:s.error=f.message;s.errorCategory=a.e.generic;s.errorMessage=u.Qu;s.rawError=n;s.debugErrorMessage=i?i.toString():(f.stack?f.stack:f.toString()).substring(0,1024);break;case o.api:if(!e){var l=a.t.generic,c=null==n?void 0:n.code,h=null==n?void 0:n.status,p=u.fn,d=JSON.stringify(n||{});c?c.indexOf("-2147024809")>-1&&d&&d.indexOf("Item does not exist")>-1&&(l=a.t.invalidItem):h&&parseInt(h,10)>=500&&(l=a.t.serverFailure);s={error:l,errorCategory:a.e.getSharingInformation,errorMessage:p,debugErrorMessage:d,rawError:n,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0}}}return s}function c(e){var t,n=e.customerPromise,i=e.rawErrorMessage,u=e.engagementExtraData,a=e.errorType,f=e.sharingStore;if(n){0;var l=i,c=Object(s.e)(l);n.end({resultType:c.resultType,errorCode:(t=c.resultCode,t&&t.split(",").join("_")),extraData:Object(r.e)(Object(r.e)(Object(r.e)(Object(r.e)({},null==f?void 0:f.getEngagementHelper().getEngagementExtraData()),u),c.extraData),{error:c.error,rawErrorMessage:i,errorType:a||o.generic})})}}function h(e){var t=e.customerPromise,n=e.engagementExtraData,s=e.sharingStore;if(t){0;t.end({resultType:i.t.Success,extraData:Object(r.e)(Object(r.e)({},null==s?void 0:s.getEngagementHelper().getEngagementExtraData()),n)})}}},function(e,t,n){"use strict";n.d(t,"t",function(){return d});n.d(t,"i",function(){return v});n.d(t,"x",function(){return m});n.d(t,"n",function(){return g});n.d(t,"l",function(){return y});n.d(t,"b",function(){return b});n.d(t,"c",function(){return w});n.d(t,"E",function(){return E});n.d(t,"T",function(){return S});n.d(t,"o",function(){return x});n.d(t,"e",function(){return T});n.d(t,"v",function(){return N});n.d(t,"d",function(){return C});n.d(t,"m",function(){return L});n.d(t,"N",function(){return A});n.d(t,"y",function(){return O});n.d(t,"w",function(){return M});n.d(t,"g",function(){return _});n.d(t,"p",function(){return D});n.d(t,"a",function(){return P});n.d(t,"s",function(){return H});n.d(t,"u",function(){return B});n.d(t,"f",function(){return j});n.d(t,"h",function(){return F});n.d(t,"r",function(){return I});n.d(t,"S",function(){return q});n(0);var r=n(5),i=n(203),s=n(55),o=n(114),u=n(6),a=n(10),f=(n(68),n(8)),l=n(97),c=n(134),h=n(49),p=!1;function d(){window.parent.postMessage(JSON.stringify({name:"share_copyLinkClicked"}),"*")}function v(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}}function m(e,t){try{window.external.ShareCompleted(e)}catch(r){var n={name:"share_completed",shareType:e,scope:t};window.parent.postMessage(JSON.stringify(n),"*")}}function g(e){var t=!1,n=!1,r=new u.e({name:"sharingCopyToClipboardInterop"});try{var i=window.external;n=!i.CopyToClipboard;n=(t=i.CopyToClipboard(e))||void 0===t;r.end({resultType:u.t.Success})}catch(e){var s=new h.e({code:"windowExternalCopyToClipboardError",innerError:e});r.end(Object(c.e)(Object(l.e)(e),{resultCode:s.code}))}return n}function y(){var e=!1;try{e=window.external.IsSendCopyEnabled()}catch(e){}return e}function b(){try{window.external.SendCopy()}catch(e){}}function w(){var e=!1;try{e=window.external.IsSendPdfEnabled()}catch(e){}return e}function E(){try{window.external.SendPdf()}catch(e){}}function S(e,t,n){var r=t?t.length:0;try{window.external.SendLinkViaTeams(e.url)}catch(t){var i={name:"share_teamsClicked",sharingLink:e.url};window.parent.postMessage(JSON.stringify(i),"*")}try{window.external.SendLinkViaTeamsWithContext(e.url,t,r,n)}catch(i){var s={name:"share_teamsClickedWithContext",sharingLink:e.url,recipients:t,numRecipients:r,body:n};window.parent.postMessage(JSON.stringify(s),"*")}}function x(e){try{window.external.GrantAccessCompleted(e)}catch(n){var t={name:"share_grantAccessCompleted",successful:e};window.parent.postMessage(JSON.stringify(t),"*")}}function T(e,t){void 0===t&&(t="");try{window.external.AddPeopleCompleted(e,t)}catch(r){var n={name:"share_addPeopleCompleted",successful:e,completionMessage:t};window.parent.postMessage(JSON.stringify(n),"*")}}function N(e,t,n,s,o,a){if(p){(function(e,t,n,s,o,a){var f=r.e[t]||"unknown";new u.e({name:"ShareV3.".concat(i.e[n],".AfterPageLoad"),startTimeOverride:e||void 0}).end({resultType:o?u.t.Failure:u.t.Success,extraData:{clientId:f,scenario:s,isError:!!o,correlationId:a,error:o}})})(e,t,n,s,o.isStubFile?"file uploading":o.errorMessage||"unknown error",a)}else{k(e,t,n,s,o.errorMessage||"unknown error",a);p=!0}try{window.external.PageError(o.error,o.errorCategory,o.errorMessage,o.debugErrorMessage)}catch(e){var f={name:"share_error",error:o.error,errorCategory:o.errorCategory,errorMessage:o.errorMessage,debugErrorMessage:o.debugErrorMessage};window.parent.postMessage(JSON.stringify(f),"*")}}function C(){window.parent.postMessage(JSON.stringify({name:"share_outlookClicked"}),"*")}function k(e,t,n,s,o,a){if(e){var f=r.e[t]||"unknown";new u.e({name:"ShareV3.".concat(i.e[n],".PageLoaded"),startTimeOverride:e}).end({resultType:o?u.t.Failure:u.t.Success,extraData:{clientId:f,scenario:s,isError:!!o,correlationId:a,error:o}})}}function L(e,t,n,r,i){if(p){k(e,t,n,r,void 0,i);s=new u.e({name:"Sharing.post_share_ready_instant_load"});try{o={name:"share_instantLoadReady"};window.parent.postMessage(JSON.stringify(o),"*");s.end({resultType:u.t.Success})}catch(e){s.end({resultType:u.t.Failure,resultCode:"post_share_ready_instant_load_failure"})}}else{k(e,t,n,r,void 0,i);try{window.external.PageFinishedLoading();0;new u.e({name:"Sharing.post_webview_share_ready"}).end({resultType:u.t.Success})}catch(e){var s=new u.e({name:"Sharing.post_iframe_share_ready"});try{var o={name:"share_ready"};window.parent.postMessage(JSON.stringify(o),"*");0;s.end({resultType:u.t.Success})}catch(e){s.end({resultType:u.t.Failure,resultCode:"post_share_ready_failure"})}}p=!0}}function A(){try{window.external.UIReady()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_uiReady"}),"*")}}function O(){window.parent.postMessage(JSON.stringify({name:"share_readyForRecipients"}),"*")}function M(){window.parent.postMessage(JSON.stringify({name:"share_sendClicked"}),"*")}function _(){try{window.external.PeoplePickerFocused()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_peoplePickerFocused"}),"*")}}function D(e,t,n,r){var i,o=Object(a.b)(r,e,n),u=Object(a.E)(e,t,r,n),l=Object(f.z)()?Object(a.M)(e.sharingLinkKind):Object(a.A)(e.audience),c=Object(a._)(e.status),h=e.audience===s.e.existing?"00000000-0000-0000-0000-000000000000":e.shareId,p=!1;try{window.external.LinkSettingsCompleted(h,e.url,o,u,l);p=!0}catch(e){}var d={id:h,expirationDateTime:null===(i=e.expiration)||void 0===i?void 0:i.toISOString(),hasPassword:!!e.hasPassword,link:{type:e.isReview?"review":e.isEdit?"edit":"view",blocksDownload:!!e.blockDownload,preventsDownload:!!e.blockDownload,createOnly:!!e.isCreateOnlyLink,iconUrl:o,localizedDescription:u,webUrl:e.url,scope:l,customLabeledAudience:e.audience===s.e.customLabeledSpecificPeople,status:c,createdDateTime:e.created}};try{window.external.LinkSettingsCompletedV2(JSON.stringify(d));p=!0}catch(e){}if(!p){var v={name:"share_linkSettingsCompleted",type:e.isReview?"review":e.isEdit?"edit":"view",shareId:h,linkUrl:e.url,iconUrl:o,linkDescription:u,scope:l,blocksDownload:!!e.blockDownload,customLabeledAudience:e.audience===s.e.customLabeledSpecificPeople};window.parent.postMessage(JSON.stringify(v),"*");window.parent.postMessage(JSON.stringify({name:"share_linkSettingsCompletedV2",permissions:d}),"*")}}function P(){var e=!1;try{e=window.external.IsDarkMode()}catch(e){}return e}function H(){var e=void 0;try{e=window.parent.GetShareDialogTheme()}catch(e){}return e}function B(){window.parent.postMessage(JSON.stringify({name:"share_manageAccessClicked"}),"*")}function j(){try{return window.external.IsMoreAppsEnabled()}catch(e){return!1}}function F(){try{return window.external.IsTeamsEnabled()}catch(e){return!1}}function I(){try{return window.external.CheckSendViaOutlookAvailability()}catch(e){return o.e.none}}function q(e,t,n,r){try{window.external.SendViaOutlookWithContext(e,t,n,r)}catch(e){}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});n.d(t,"n",function(){return s});var r,i,s;(function(e){e[e.regularUser=0]="regularUser";e[e.externalUser=1]="externalUser";e[e.group=2]="group";e[e.application=3]="application";e[e.linkedinUser=4]="linkedinUser"})(r||(r={}));(function(e){e.graph="graph";e.sharepointSearch="sharepointSearch";e.substrate="substrate"})(i||(i={}));(function(e){e.unified="unifiedGroup";e.securityGroup="securityGroup";e.SPGroup="SPGroup";e.PublicDistributionList="PublicDistributionList";e.family="family"})(s||(s={}))},,function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.session=1]="session";e[e.local=2]="local";e[e.sharedMemory=3]="sharedMemory"})(r||(r={}));t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Success=0]="Success";e[e.Failure=1]="Failure";e[e.ExpectedFailure=2]="ExpectedFailure"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"t",function(){return y});var r,i=n(152),s=n(9),o=n(32),u=n(228),a=s.e.isActivated("26b61085-e68c-4a13-a8de-ae84ba2d96d2","1/16/2023","Validate if window object is present or not"),f={ODB:587,ODC:"AllowFeatureOverrides",Fallback:!1},l={ODB:357,ODC:null,Fallback:!1},c={ODB:342,ODC:null,Fallback:!1},h={ODB:60763,ODC:"AllowFeatureOverrides",Fallback:!1},p={},d="".concat("FeatureOverrides","_").concat("enableFeatures"),v="".concat("FeatureOverrides","_").concat("disableFeatures");function m(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}function g(e){var t=[],n=[];for(var r in e)(e[r]?t:n).push(r);try{document.cookie="".concat(d,"=").concat(t.join(","),";path=/;samesite=none;secure;").concat(t.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;");document.cookie="".concat(v,"=").concat(n.join(","),";path=/;samesite=none;secure;").concat(n.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;")}catch(e){}}function y(){if(p){for(var e=[],t=0,n=Object.keys(p);t<n.length;t++){var r=n[t];e.push(p[r]?r:"!".concat(r))}return e.join(",")}}function b(e,t,n,r){if(t)for(var i=0,s=t.split(",");i<s.length;i++){e[l=s[i]]=!0}if(n)for(var o=0,u=n.split(",");o<u.length;o++){e[l=u[o]]=!1}if(r)for(var a=0,f=r.split(",");a<f.length;a++){var l;"!"===(l=f[a])[0]?e[l.slice(1)]=!1:e[l]=!0}return e}var w=(function(){function e(){}Object.defineProperty(e,"Overrides",{get:function(){return p},enumerable:!1,configurable:!0});e.evaluateCanOverride=function(){a||"undefined"!=typeof window?e.CanOverride=o.e.isFeatureEnabled(f)||o.e.isFeatureEnabled(l)||o.e.isFeatureEnabled(c)||o.e.isFeatureEnabled(h)||!(!(null===window||void 0===window?void 0:window.Flight)||"dev"!==window.Flight.version&&!window.Flight.devMode):e.CanOverride=!1};e.isFeatureEnabled=function(t,n){var i=e._isFeatureEnabled(t,n);(function(e,t){r&&r(e,t)})(t,i);return i};e._isFeatureEnabled=function(t,n){if(e.CanOverride){if(t.ODB in p)return p[t.ODB];if(t.ODC in p)return p[t.ODC]}return n?Object(u.e)(t,n):o.e.isFeatureEnabled(t)};e.AllowFeatureOverrides=f;e.SPODebugOnlyCookieRedirect=l;e.ClientDebugFeatureOverrides=h;return e})();t.e=w;w.evaluateCanOverride();w.CanOverride&&(function(){p=b({},m(d),m(v),void 0);var e=location.search?location.search.substring(1):"",t=Object(i.e)(e),n=t.enableFeatures,r=t.disableFeatures,s=t.debugFlights;b(p,n,r,s);g(p);try{window.__debugSetFeature=function(e,t){void 0===t&&(t=!0);p[e]=!!t;g(p)}}catch(e){}})()},function(e,t,n){"use strict";var r,i=n(35),s=n(9);(function(e){e[e.scheme=0]="scheme";e[e.authority=1]="authority";e[e.path=2]="path";e[e.query=3]="query"})(r||(r={}));var o=/[;\/?:@&=$,]/,u=/[\/?]/;function a(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n.toLowerCase()]=e[n].toLowerCase());return t}var f=(function(){function e(e,t){this._scheme="";this._user="";this._host="";this._port="";this._path="";this._pathSegments=[];this._pathEncoded="";this._query={};this._fragment="";if(t){this._queryCaseInsensitive=!!t.queryCaseInsensitive;this._pathCaseInsensitive=!!t.pathCaseInsensitive}this._isCatchParsePathDecodeExceptionKSActive=s.t.isActivated("e759149e-00c5-412d-bc6d-d63d0bb5fe84","08/24/2022","Catch decoding errors while parsing the URI path");this._isMailtoPathSlashFixingKSActive=s.t.isActivated("ec2e96a7-d77c-4fb3-addd-1c430d6985b3","11/22/2022","Avoid adding slash prefix for mailto schema");this._parseURI(e)}e.concatenate=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r="",i=0;i<t.length;i++){var s=t[i];i>0&&(s=e.ensureNoPrecedingSlash(s));i<t.length-1&&(s=e.ensureTrailingSlash(s));r+=s}return r};e.ensureNoPrecedingSlash=function(e){return"/"===e[0]?e.substr(1):e};e.ensureTrailingSlash=function(e){return"/"!==e[e.length-1]?e+"/":e};e.prototype.getScheme=function(){return this._scheme};e.prototype.setScheme=function(e){this._scheme=e};e.prototype.getAuthority=function(){return this._getAuthority(!1)};e.prototype.setAuthority=function(e){this._parseAuthority(e)};e.prototype.getUser=function(){return this._user};e.prototype.getHost=function(){return this._host};e.prototype.getPort=function(){return this._port};e.prototype.getPath=function(e){var t=this._path;Boolean(e)&&null!==t&&t.lastIndexOf("/")===t.length-1&&(t=t.slice(0,-1));return t};e.prototype.getLeftPart=function(e){var t=this._scheme+"://";e===r.authority&&(t+=this.getAuthority());e===r.path&&(t+=this.getPath());e===r.query&&(t+=this.getQuery());return t};e.prototype.setPath=function(e){this._isMailtoPathSlashFixingKSActive?e&&"/"!==e[0]&&(e="/"+e):"mailto"!==this.getScheme().toLowerCase()&&e&&"/"!==e[0]&&(e="/"+e);this._parsePath(e)};e.prototype.getPathSegments=function(){return this._pathSegments};e.prototype.getLastPathSegment=function(){var e=this._pathSegments;return e[e.length-1]||""};e.prototype.getQuery=function(e){return this._serializeQuery(e)};e.prototype.setQuery=function(e){this.setQueryFromObject(this._deserializeQuery(e))};e.prototype.getQueryAsObject=function(){return this._query};e.prototype.setQueryFromObject=function(e){this._query={};for(var t in e)e.hasOwnProperty(t)&&this.setQueryParameter(t,e[t])};e.prototype.getQueryParameter=function(e){var t=null,n=this._query;if(this._queryCaseInsensitive){e=e.toLowerCase();for(var r in n)n.hasOwnProperty(r)&&r.toLowerCase()===e&&(t=n[r])}else t=n[e];return t||null};e.prototype.setQueryParameter=function(e,t,n){void 0===n&&(n=!0);var r=this._decodeQueryString(t);(r||n)&&(this._query[this._decodeQueryString(e)]=r)};e.prototype.removeQueryParameter=function(e){delete this._query[this._decodeQueryString(e)]};e.prototype.getFragment=function(){return this._fragment};e.prototype.setFragment=function(e){"#"===e[0]&&(e=e.substring(1));this._fragment=this._decodeQueryString(e)};e.prototype.equals=function(e){return Object(i.t)(this._scheme,e.getScheme())&&this._user===e.getUser()&&Object(i.t)(this._host,e.getHost())&&this._port===e.getPort()&&this._fragment===e.getFragment()&&this._equalsCaseAppropriate(this.getPath(!0),e.getPath(!0),this._pathCaseInsensitive)&&this._equalsCaseAppropriate(this.getQuery(),e.getQuery(),this._queryCaseInsensitive)};e.prototype.equivalent=function(e){return Object(i.t)(this._scheme,e.getScheme())&&Object(i.t)(this._user,e.getUser())&&Object(i.t)(this._host,e.getHost())&&Object(i.t)(this._port,e.getPort())&&Object(i.t)(this.getPath(!0),e.getPath(!0))&&(t=a(this.getQueryAsObject()),n=a(e.getQueryAsObject()),s=[],o=[],u=r||function(e,t){return e===t},(function e(t,n){if(t===n)return!0;if(null===t||null===n)return!1;if("object"!=typeof t||"object"!=typeof n)return!1;var r=Object.keys(t).sort(),i=Object.keys(n).sort();return r.length===i.length&&!!r.every(function(r,a){if(r!==i[a])return!1;if("function"==typeof t[r]||"function"==typeof n[r])return!0;if(u(t[r],n[r]))return!0;if("object"==typeof t[r]){if(-1!==s.indexOf(t[r]))throw new Error("Cannot perform DeepCompare() because a circular reference was encountered, object: ".concat(t,", ")+"property: ".concat(r));s.push(t[r]);if(-1!==o.indexOf(n[r]))throw new Error("Cannot perform DeepCompare() because a circular reference was encountered, object: ".concat(n,", ")+"property: ".concat(r));o.push(n[r]);if(!e(t[r],n[r]))return!1;s.pop();o.pop();return!0}return!1})})(t,n))&&Object(i.t)(this._fragment,e.getFragment());var t,n,r,s,o,u};e.prototype.toString=function(e){return this._getStringInternal(!0,e)};e.prototype.getDecodedStringForDisplay=function(){return this._getStringInternal(!1)};e.prototype.getStringWithoutQueryAndFragment=function(){return this._getStringWithoutQueryAndFragmentInternal(!0)};e.prototype._equalsCaseAppropriate=function(e,t,n){return n?Object(i.t)(e,t):e===t};e.prototype._getStringInternal=function(e,t){var n=this._getStringWithoutQueryAndFragmentInternal(e,t),r=this.getQuery(e);r&&(n+="?"+r);this._fragment&&(n+="#"+(e?encodeURIComponent(this._fragment):this._fragment));return n};e.prototype._getStringWithoutQueryAndFragmentInternal=function(e,t){var n="";this._scheme&&(n+=(e?encodeURIComponent(this._scheme):this._scheme)+":");var r=this._getAuthority(e,t);r&&(n+="//"+r);this._pathEncoded&&(n+=e?this._pathEncoded:this._path);return n};e.prototype._deserializeQuery=function(e){var t={};0===e.indexOf("?")&&(e=e.substring(1));for(var n=0,r=e.split(/[;&]+/);n<r.length;n++){var i=r[n],s=i.indexOf("=");s<0&&(s=i.length);s>0&&(t[i.substr(0,s)]=i.substr(s+1))}return t};e.prototype._serializeQuery=function(e){var t="";for(var n in this._query)if(this._query.hasOwnProperty(n)){var r=n,i=this._query[n];if(e){r=encodeURIComponent(r);i=encodeURIComponent(i)}t+=null===i||""===i?r+"=&":r+"="+i+"&"}""!==t&&(t=t.slice(0,-1));return t};e.prototype._parseURI=function(e){var t=e,n=t.indexOf("#");if(n>=0){var r=t.substring(n+1);this.setFragment(r);t=t.substring(0,n)}var i=t.search(o);if(i>=0){if(":"===t[i]){this.setScheme(t.substring(0,i));t=t.substring(i+1)}var s="";if(0===t.indexOf("//")){var a=(t=t.substring(2)).search(u);if(a>=0){s=t.substring(0,a);t=t.substring(a)}else{s=t;t=""}this.setAuthority(s);if(!t){this.setPath("");return}}var f=t.indexOf("?");if(f>=0){this.setQuery(t.substring(f+1));t=t.substring(0,f)}this.setPath(t)}else this.setPath(t)};e.prototype._parseAuthority=function(e){this._host=e;var t=e.lastIndexOf("@");t>=0&&(this._host=this._host.substring(t+1));var n=this._host.indexOf(":");if(!(t<0&&n<0)){var r=e;if(t<0)this._host=r;else{this._user=r.substring(0,t);this._host=r.substring(t+1)}if(n>=0){this._port=this._host.substring(n+1);this._host=this._host.substring(0,n)}this._user=decodeURIComponent(this._user);this._host=decodeURIComponent(this._host)}};e.prototype._parsePath=function(e){if(this._isCatchParsePathDecodeExceptionKSActive)this._path=decodeURIComponent(e);else try{this._path=decodeURIComponent(e)}catch(t){this._path=e}var t=this._pathSegments=[];this._pathEncoded=e;for(var n=e.split("/"),r=0;r<n.length;++r)if(this._isCatchParsePathDecodeExceptionKSActive)t[r]=decodeURIComponent(n[r]);else try{t[r]=decodeURIComponent(n[r])}catch(e){t[r]=n[r]}""===t[0]&&t.shift();""===t[t.length-1]&&t.pop()};e.prototype._getAuthority=function(e,t){void 0===t&&(t={});var n,r,i,s=t&&t.doNotPercentEncodeHost,o="";if(e){n=encodeURIComponent(this._user).replace("%3A",":");r=s?this._host:encodeURIComponent(this._host);i=encodeURIComponent(this._port)}else{n=this._user;r=this._host;i=this._port}""!==n&&(o=n+"@");""!==this._host&&(o+=r);""!==this._port&&(o+=":"+i);return o};e.prototype._decodeQueryString=function(e){var t=e;try{t=decodeURIComponent(e.replace(/\+/g," "))}catch(e){}return t};return e})();t.e=f},function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.user=1]="user";e[e.distributionList=2]="distributionList";e[e.securityGroup=4]="securityGroup";e[e.sharePointGroup=8]="sharePointGroup";e[e.all=15]="all"})(r||(r={}));t.e=r},,function(e,t,n){"use strict";n.d(t,"e",function(){return c});n.d(t,"s",function(){return h});n.d(t,"t",function(){return p});n.d(t,"o",function(){return d});n.d(t,"i",function(){return v});n.d(t,"r",function(){return m});n.d(t,"n",function(){return g});var r,i,s,o,u,a,f=n(107),l=n(8);function c(e){r=Object(f.t)(90076,e);i=Object(f.t)(90022,e);s=Object(f.t)(90128,e);o=Object(f.t)(90127,e);u=Object(f.t)(90058,e);a=Object(f.t)(90167,e)}function h(){try{if(sessionStorage.getItem("simplifiedSharingDialog"))return parseInt(sessionStorage.getItem("simplifiedSharingDialog"))}catch(e){}if(!a||l.V())return 0;if(l.X())return 1;a.logExposure();return a.variantToDisplay}function p(){try{if(sessionStorage.getItem("externalSharingConfirmationDialog"))return parseInt(sessionStorage.getItem("externalSharingConfirmationDialog"))}catch(e){}if(!u||!l.l())return 0;u.logExposure();return u.variantToDisplay}function d(){if(!r||!l.$())return 0;r.logExposure();return r.variantToDisplay}function v(){if(!i||!l.F())return 0;i.logExposure();return i.variantToDisplay}function m(){if(!l.D()||!s)return 0;s.logExposure();return s.variantToDisplay}function g(){if(!o||!l.C())return 0;o.logExposure();return o.variantToDisplay}},function(e,t,n){"use strict";var r,i,s,o,u,a=n(228),f=!1;function l(){var e;r=window.PageContext;var t=window.Flight;i=t&&t.Ramps;s=window.FilesConfig;var n=window.Flighting,a=window._spPageContextInfo;u=null===(e=window.Flight)||void 0===e?void 0:e.ecsRolloutsEnabled;if(!o&&a){!a.ExpFeatures&&n&&n.ExpFeatures&&(a.ExpFeatures=n.ExpFeatures);c.initSPExpFeatures(a.ExpFeatures)}f=!0}var c=(function(){function e(){}e.initSPExpFeatures=function(e){o=e};e.isFeatureEnabled=function(e){f||l();var t=!!e.Fallback,n=e.ODB,c=e.ODC,h=e.ECS,p=e.OneDrive;void 0!==n&&o&&(t=Object(a.e)(e,o));void 0!==c&&s&&("boolean"==typeof c?t=c:(i&&i[c]||s&&s[c])&&(t=!0));void 0!==h&&u&&u.indexOf(h)>=0&&(t=!0);void 0!==p&&r&&(t=p);return t};e.On={Fallback:!0};e.Off={};return e})();t.e=c},,,function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"r",function(){return s});n.d(t,"s",function(){return o});n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});n.d(t,"i",function(){return f});var r=/\{(\d+)\}/g;function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(r,function(e,n){var r=t[Number(n)];return null===r?"":"".concat(r)})}function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var i,s=[],o=0;i=r.exec(e);){var u=i[0],a=parseInt(u.replace(/\{|\}+/g,""),10),f=t[a];i.index>o&&s.push(e.substring(o,i.index));o=r.lastIndex;s.push(f)}o!==e.length&&s.push(e.substring(o,e.length));return s}function o(e,t){for(var n=e.toString();n.length<t;)n="0".concat(n);return n}function u(e,t){return e&&t?e.toUpperCase()===t.toUpperCase():e===t}function a(e){return e?e[0].toUpperCase()+e.substr(1):e}function f(e,t,n){n=Number(n);if(void 0===e||void 0===t||void 0===n)return"";for(var r="",i=-1,s=t.split("||"),o=0,u=s.length;o<u;o++){var a=s[o];if(a){for(var f=0,l=a.split(",");f<l.length;f++){var c=l[f];if(c)if(isNaN(Number(c))){if(-1!==c.indexOf("-")){var h=c.split("-");if(2!==h.length)continue;var p=void 0,d=void 0;if("*"===c[0]){var v=h[0].substring(1),m=h[1];if(isNaN(Number(v))||isNaN(Number(m)))continue;p=parseInt(v,10);d=parseInt(m,10);for(var g=void 0,y=p;y<=d;y++){var b="[0-9]*"+y;if(new RegExp("^".concat(b,"$")).test(n.toString())){g=!0;break}}if(g){i=o;break}}else{if(""===h[0])p=0;else{if(isNaN(Number(h[0])))continue;p=parseInt(h[0],10)}if(n>=p){if(""===h[1]){i=o;break}if(isNaN(Number(h[1])))continue;if(n<=(d=parseInt(h[1],10))){i=o;break}}}}else if(-1!==c.indexOf("*")){b=c.trim().replace(/\*/g,"[0-9]*");if(new RegExp("^".concat(b,"$")).test(n.toString())){i=o;break}}}else{if(n===parseInt(c,10)){i=o;break}}}if(-1!==i)break}}if(-1!==i){var w=e.split("||");w[i]&&(r=w[i])}return r}},,,,,,function(e,t,n){"use strict";var r=n(84);t.e=r},function(e,t,n){"use strict";var r=(function(){function e(){}e.encodeURIComponent=function(e,t,n,r){var i="",s=0;if(!e)return"";var o=e.length;for(s=0;s<o;s++){var u=e.charCodeAt(s),a=e.charAt(s);if(t&&("#"===a||"?"===a)){i+=e.substr(s);break}if(n&&"&"===a)i+=a;else if(u<=127)r||u>=97&&u<=122||u>=65&&u<=90||u>=48&&u<=57||t&&u>=32&&u<=95&&" \"%<>'&".indexOf(a)<0?i+=a:u<=15?i+="%0"+u.toString(16).toUpperCase():u<=127&&(i+="%"+u.toString(16).toUpperCase());else if(u<=2047){i+="%"+(192|u>>6).toString(16).toUpperCase();i+="%"+(128|63&u).toString(16).toUpperCase()}else if(55296!=(64512&u)){i+="%"+(224|u>>12).toString(16).toUpperCase();i+="%"+(128|(4032&u)>>6).toString(16).toUpperCase();i+="%"+(128|63&u).toString(16).toUpperCase()}else if(s<e.length-1){u=(1023&u)<<10;s++;u|=1023&e.charCodeAt(s);i+="%"+(240|(u+=65536)>>18).toString(16).toUpperCase();i+="%"+(128|(258048&u)>>12).toString(16).toUpperCase();i+="%"+(128|(4032&u)>>6).toString(16).toUpperCase();i+="%"+(128|63&u).toString(16).toUpperCase()}}return i};e.escapeUrlForCallback=function(t){var n=t.indexOf("#"),r=t.indexOf("?");if(n>0&&(-1===r||n<r)){var i=t.substr(0,n);r>0&&(i+=t.substr(r));t=i}return e.encodeURIComponent(t,!0,!1,!0)};e.encodeRestUriStringToken=function(t){if(t){t=(t=t.replace(/'/g,"''")).replace(/%27/g,"%27%27");t=e.encodeURIComponent(t)}return t};return e})();t.e=r},function(e,t,n){"use strict";n.d(t,"s",function(){return i});n.d(t,"r",function(){return s});n.d(t,"i",function(){return o});n.d(t,"a",function(){return u});n.d(t,"f",function(){return a});n.d(t,"t",function(){return f});n.d(t,"n",function(){return l});n.d(t,"e",function(){return c});n.d(t,"u",function(){return h});n.d(t,"l",function(){return p});n.d(t,"o",function(){return d});n.d(t,"h",function(){return v});n.d(t,"c",function(){return m});n.d(t,"p",function(){return g});var r=n("react-lib"),i=r.lazy(function(){return n.ee([20],409)}),s=r.lazy(function(){return n.ee([13],410)}),o=r.lazy(function(){return n.ee([18],407)}),u=r.lazy(function(){return n.ee([24],398)}),a=r.lazy(function(){return n.ee([26],411)}),f=r.lazy(function(){return n.ee([21],386)}),l=r.lazy(function(){return n.ee(2,408)}),c=r.lazy(function(){return n.ee([14],415)}),h=r.lazy(function(){return n.ee([19],412)}),p=r.lazy(function(){return n.ee([23],416)}),d=r.lazy(function(){return n.ee([22],405)}),v=r.lazy(function(){return n.ee([25],417)}),m=r.lazy(function(){return n.ee([27],413)}),g=r.lazy(function(){return n.ee([17],418)})},,function(e,t,n){"use strict";var r=n(25),i=(function(){function e(t,n){void 0===n&&(n=r.e.none);e.init();this.dataStoreKey=t;this.defaultCachingType=n;if(n===r.e.none)this.dataStore={};else{void 0===e._dataStore[this.dataStoreKey]&&(e._dataStore[this.dataStoreKey]={});this.dataStore=e._dataStore[this.dataStoreKey]}}e.hasStorageType=function(t){e.init();switch(t){case r.e.none:case r.e.sharedMemory:return!0;case r.e.session:return!!e._sessionStorage;case r.e.local:return!!e._localStorage;default:return!1}};e.init=function(){if(!e._initialized){try{"localStorage"in window&&window.localStorage&&e.testStorage(window.localStorage)&&(e._localStorage=window.localStorage)}catch(e){}try{"sessionStorage"in window&&window.sessionStorage&&e.testStorage(window.sessionStorage)&&(e._sessionStorage=window.sessionStorage)}catch(e){}null==e._localStorage&&(e._localStorage=e._sessionStorage);e._initialized=!0}};e.testStorage=function(e){var t="BrowserStorageTest",n=!1;try{e.setItem(t,"1");"1"===e.getItem(t)&&(n=!0);e.removeItem(t)}catch(e){}return n};e.prototype.setValue=function(e,t,n,r){void 0===r&&(r=!0);e=r?this.normalizeKey(e):e;this.dataStore[e]=t;var i=this.getStorage(n);if(i)try{var s=[],o=JSON.stringify(t,function(e,t){if("object"==typeof t&&null!==t){if(-1!==s.indexOf(t))return;s.push(t)}return t});s=null;i.setItem(this.dataStoreKey+e,o)}catch(e){}};e.prototype.getValue=function(e,t,n,r){void 0===n&&(n=!0);void 0===r&&(r=!1);e=n?this.normalizeKey(e):e;var i=this.dataStore[e],s=this.getStorage(t);if((void 0===i||r)&&s){var o=s.getItem(this.dataStoreKey+e);if(o)try{i=JSON.parse(o);this.dataStore[e]=i}catch(e){i=void 0}}return i};e.prototype.remove=function(e,t,n){void 0===n&&(n=!0);e=n?this.normalizeKey(e):e;var r=this.getStorage(t);r&&r.removeItem(this.dataStoreKey+e);delete this.dataStore[e]};e.prototype.getStorage=function(t){switch(t||this.defaultCachingType){case r.e.none:case r.e.sharedMemory:return null;case r.e.session:return e._sessionStorage;case r.e.local:return e._localStorage;default:return null}};e.prototype.normalizeKey=function(e){return e&&e.toLowerCase()||""};e._sessionStorage=null;e._localStorage=null;e._dataStore={};e._initialized=!1;return e})();t.e=i},function(e,t,n){"use strict";n.d(t,"s",function(){return m});n.d(t,"o",function(){return g});n.d(t,"i",function(){return y});n.d(t,"e",function(){return b});n.d(t,"t",function(){return w});n.d(t,"n",function(){return E});n.d(t,"r",function(){return S});n.d(t,"u",function(){return x});var r=n(115),i=n(55),s=n(242),o=n(370),u=n(372),a=n(23),f=n(35),l=n("react-lib"),c=n(366),h=n(1),p=n(29),d=n(8),v=["ownerCannotShareWithSelf","maximumRecipientsExceeded","invalidAclEmailSpecified","duplicateMembersInRequest","secureSharingInvalidRequest"];function m(e){return v.indexOf(e)>-1}function g(e){var t,n;return!("UNVALIDATED_EMAIL_ADDRESS"!==(null===(n=null===(t=null==e?void 0:e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.PrincipalType))}function y(e){var t,n;return!(!(null==e?void 0:e.isExternal)||"GUEST_USER"!==(null===(n=null===(t=null==e?void 0:e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.PrincipalType))}function b(e){return e&&0!==e.length?e.filter(function(e){return e.entityType===a.e.externalUser}).length:0}function w(e){return e&&0!==e.length?e.filter(function(e){return e.entityType===a.e.linkedinUser}).length:0}function E(e){var t=e.filter(function(e){return e.entityType===a.e.externalUser}),n=t.length,r=t.map(function(e){return e.name});if(2===n){var i=(s=r.join(", ")).lastIndexOf(",");return"".concat(s.substring(0,i)," ").concat(h.A," ").concat(s.substring(i+1)," ").concat(h.ti)}if(n>2){var s;i=(s=r.join(", ")).lastIndexOf(",");return"".concat(s.substring(0,i+1)," ").concat(h.A," ").concat(s.substring(i+1)," ").concat(h.ti)}return 1===n?"".concat(r[0]," ").concat(h.ni):""}function S(e,t){var n=e.filter(function(e){return e.entityType===a.e.group}).length,r="";1===n?r=h.Kr:n>1&&(r=f.n(h.ar,n));t>=1e3?r+=" ".concat(h.vn):t>=25&&(r+=" ".concat(f.n(h.dn,t)));return r}function x(e){var t=e.selectedItems,n=e.sharingLinkKind,f=e.canAddExternalPrincipal,v=e.sharingInformation,m=e.viewPolicyTipCallback,g=e.permissionsMap,b=e.setSharingByCopyIsDisabled,w=e.scope,E=l.createElement("div",null,l.createElement("span",{role:"alert","aria-live":"assertive"},h.Ds," "),l.createElement(c.e,{onClick:m},h.$s)),S=v.item.hasDlpPolicy||v.sharingAbilities&&v.sharingAbilities.directSharingAbilities&&v.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason===r.e.documentIsProtectedByDlp,x=!1,N=!1,C=e.audience;if(v.sharingAbilities&&e.audience&&t&&t.length)switch(C){case i.e.specificPeople:case i.e.specificPeopleFlex:if(v.sharingAbilities.peopleSharingLinkAbilities&&v.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals){x=v.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals.disabledReason===r.e.loopFilesExternalSharingNotSupported;N=v.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals.disabledReason===r.e.blockedByWhoCanShareSettings}break;case i.e.anyone:if(v.sharingAbilities.anyoneLinkAbilities&&v.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals){x=v.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals.disabledReason===r.e.loopFilesExternalSharingNotSupported;N=v.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals.disabledReason===r.e.blockedByWhoCanShareSettings}break;case i.e.organization:if(v.sharingAbilities.organizationLinkAbilities&&v.sharingAbilities.organizationLinkAbilities.canAddNewExternalPrincipals){x=v.sharingAbilities.organizationLinkAbilities.canAddNewExternalPrincipals.disabledReason===r.e.loopFilesExternalSharingNotSupported;N=v.sharingAbilities.organizationLinkAbilities.canAddNewExternalPrincipals.disabledReason===r.e.blockedByWhoCanShareSettings}}for(var k=0,L=t;k<L.length;k++){var A=L[k];if(!A.isResolved)return S&&!f?E:x&&A.isExternal?l.createElement("span",{role:"alert","aria-live":"assertive"},h.zn):A.rawData?T(A.rawData,v.customizedExternalSharingServiceUrl):l.createElement("span",{role:"alert","aria-live":"assertive"},h.dr);if(A.isExternal&&S&&!f)return E;if(A.isExternal&&!f&&!y(A)||A.isExternal&&N)return l.createElement("span",{role:"alert","aria-live":"assertive"},h.Wi);if(A.isExternal&&A.principalType===p.e.distributionList&&A.entityType===a.e.group)return l.createElement("span",{role:"alert","aria-live":"assertive"},h.zi);var O=d.G()?n===s.e.organizationEdit||n===s.e.organizationView:w===o.e.organization;if(A.isExternal&&O){b&&b(!0);return l.createElement("span",{role:"alert","aria-live":"assertive"},h.Ui)}}if(g&&n===s.e.direct){var M=0;for(var _ in g)g[_]===u.e.none&&M++;var D="";1===M?D=h.wn:M>1&&(D=h.En);var P=e.onShareHintClick?l.createElement("a",{className:"od-Share-PeoplePicker-error-changeTypeLink",onClick:function(){return e.onShareHintClick()},href:"javascript:void(0)"},h.xe):void 0;if(D)return l.createElement("div",null,l.createElement("span",{role:"alert","aria-live":"assertive"},D),P)}return v.peoplePickerError?l.createElement("span",{role:"alert","aria-live":"assertive"},v.peoplePickerError):null}function T(e,t){var n=e.EntityData&&e.EntityData.BlockingSharingPolicy||0;return 0===n||607===n?l.createElement("span",{role:"alert","aria-live":"assertive"},e.Description):n>=401&&n<=404?t?l.createElement("div",{role:"alert","aria-live":"assertive"},f.r(h.Wt,l.createElement("a",{href:t,target:"_blank"},h.vr))):l.createElement("span",{role:"alert","aria-live":"assertive"},h.zt):n>=200&&n<=209||n>=301&&n<=305?t?l.createElement("div",{role:"alert","aria-live":"assertive"},f.r(h.Jt,l.createElement("a",{href:t,target:"_blank"},h.vr))):l.createElement("span",{role:"alert","aria-live":"assertive"},h.$t):n>=600&&n<=603?t?l.createElement("div",{role:"alert","aria-live":"assertive"},f.r(h.eu,l.createElement("a",{href:t,target:"_blank"},h.vr))):l.createElement("span",{role:"alert","aria-live":"assertive"},h.Zo):void 0}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"s",function(){return a});n.d(t,"i",function(){return f});n.d(t,"n",function(){return l});n.d(t,"r",function(){return c});var r=window.performance,i=void 0!==typeof r&&!!r&&"function"==typeof r.mark&&"function"==typeof r.clearMarks&&"function"==typeof r.now,s="EUPL.",o=0,u=window._perfMarks=window._perfMarks||[];function a(e,t){var n=h(e);if(null==t||o<t){i?r.mark(n):u.push({name:n,startTime:Date.now()});o++}}function f(e,t){void 0===t&&(t=!0);var n=t?h(e):e;if(i){var s=r.getEntriesByName(n,"mark");return s&&s.length>0?Math.round(s[0].startTime):NaN}var o=u.filter(function(e){return e.name===n})[0];return o&&o.startTime}function l(e){var t=[];e&&(t=e.map(h));i?r.getEntriesByType("mark").filter(function(e){return t.length>0?t.indexOf(e.name)>=0:0===e.name.lastIndexOf(s,0)}).forEach(function(e){r.clearMarks(e.name)}):u=[]}function c(){return i?r.getEntriesByType("mark").filter(function(e){return 0===e.name.lastIndexOf(s,0)}):u}function h(e){return 0===e.lastIndexOf(s,0)?e:s+e}},function(e,t,n){"use strict";var r=n(62);t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=function(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);this.message=t.message;this.innerError=e.innerError;this.stack=t.stack;this.name=t.name;for(var n in this)Object.prototype.hasOwnProperty.call(this,n)&&(t[n]=this[n]);var r=Object.getPrototypeOf(this);Error.captureStackTrace&&Error.captureStackTrace(t,r);if(Object.setPrototypeOf){Object.setPrototypeOf(t,r);return t}};if(Object.setPrototypeOf){i.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}});Object.setPrototypeOf(i,Error)}var s=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.name="ApiError";var i=t.innerError,s=t.wrapErrorCode,o=i||void 0,u=o?Object(r.e)(Object(r.e)(Object(r.e)(Object(r.e)(Object(r.e)({},"string"==typeof o.correlationId?{correlationId:o.correlationId}:{}),"boolean"==typeof o.isExpected?{isExpected:o.isExpected}:{}),"string"==typeof o.name?{code:o.name}:{}),"string"==typeof o.code?{code:o.code}:{}),"object"==typeof o.extraData?{extraData:o.extraData}:{}):{},a=t.correlationId,f=void 0===a?u.correlationId:a,l=t.isExpected,c=void 0===l?u.isExpected:l,h=t.extraData;n.correlationId=f;n.isExpected=!!c;n.code=s&&u.code&&t.code&&"".concat(t.code," (").concat(u.code,")")||t.code||u.code||"";n.extraData=Object(r.e)(Object(r.e)({},u.extraData||{}),h||{});return n}return t})(i)},function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});var r,i;(function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully";e[e.AccessRequestsQueued=1]="AccessRequestsQueued";e[e.Error=2]="Error"})(r||(r={}));(function(e){e[e.UnshareLink=0]="UnshareLink";e[e.ShareLink=1]="ShareLink";e[e.FetchSharingInformation=2]="FetchSharingInformation"})(i||(i={}))},function(e,t,n){"use strict";var r=n(120),i=n(12),s=(function(){function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var n=this.resources,s=void 0===n?t.resources?new i.n(t.resources):e.resources:n;this.resources=s;this._Component_scope=new r.e}Object.defineProperty(e.prototype,"scope",{get:function(){return this._Component_scope},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.scope.isDisposed},enumerable:!1,configurable:!0});e.prototype.dispose=function(){this._Component_scope.dispose()};e.prototype.managed=function(e){this.resources&&(e=this.resources.injected(e));return this.scope.attached(e)};e.prototype.child=function(e){var t;t=e instanceof i.t?this.resources.consume(e):this.resources?this.resources.injected(e,{injectChildResourceScope:!0}):e;return this.scope.attached(t)};e.dependencies={resources:i.i};return e})();t.e=s},function(e,t,n){"use strict";var r=(function(){function e(){}e.invalidate=function(t){if("undefined"!=typeof window){e.isRightToLeft=window.document&&"rtl"===document.documentElement.getAttribute("dir");e.safeLeft=e.isRightToLeft?"right":"left";e.safeRight=e.isRightToLeft?"left":"right";t=t||window._spPageContextInfo&&window._spPageContextInfo.currentUICultureName;e.language=t||window.document&&(document.documentElement.getAttribute("lang")||document.documentElement.getAttribute("xml:lang"))||"en-us";e.cultureLCID=window._spPageContextInfo&&window._spPageContextInfo.currentCultureName||e.language}};return e})();r.invalidate();t.e=r},function(e,t,n){"use strict";var r=(function(){function e(){this.R=0;this.G=0;this.B=0;this.A=e.maxComponent}e.clone=function(t){return e.fromRgba(t.R,t.G,t.B,t.A)};e.equals=function(e,t){var n=!e,r=!t;return n||r?n&&r:e.R===t.R&&e.G===t.G&&e.B===t.B&&e.A===t.A};e.fromRgba=function(t,n,r,i){var s=new e;s.R=Math.round(t);s.G=Math.round(n);s.B=Math.round(r);s.A=null!=i?Math.round(i):e.maxComponent;return s};e.fromRgbaString=function(t){var n=new e;if(/^rgb.+/.test(t)){var r=t.match(/[\d.]+/g);n=e.fromRgba(Number(r[0]),Number(r[1]),Number(r[2]),4===r.length?Number(r[3])*e.maxComponent:null)}return n};e.fromHtmlColor=function(t){function n(e,t,n){return parseInt(e.charAt(t)+e.charAt(n),16)}var r=new e;if("string"==typeof t&&"#"===t.charAt(0))switch(t.length){case 9:r.A=n(t,1,2);r.R=n(t,3,4);r.G=n(t,5,6);r.B=n(t,7,8);break;case 7:r.R=n(t,1,2);r.G=n(t,3,4);r.B=n(t,5,6);break;case 4:r.R=n(t,1,1);r.G=n(t,2,2);r.B=n(t,3,3)}else/^rgb.+/.test(t)&&(r=e.fromRgbaString(t));return r};e.toHtmlString=function(t,n){function r(t){var n=Number(t);if(!(n>=0&&n<=e.maxComponent))throw new Error("Argument must be a Number in [0, 255]");var r=n.toString(16);n<16&&(r="0"+r);return r}return t.A<e.maxComponent&&!n?"rgba("+t.R.toString(10)+", "+t.G.toString(10)+", "+t.B.toString(10)+", "+(t.A/e.maxComponent).toFixed(2)+")":"#"+(n?r(t.A):"")+r(t.R)+r(t.G)+r(t.B)};e.maxComponent=255;return e})();t.e=r},,function(e,t,n){"use strict";var r;(function(e){e[e.specificPeople=0]="specificPeople";e[e.organization=1]="organization";e[e.anyone=2]="anyone";e[e.existing=3]="existing";e[e.specificPeopleFlex=4]="specificPeopleFlex";e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"})(r||(r={}));t.e=r},,,function(e,t,n){"use strict";n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(0),i=n(382),s=n(30),o=n("react-lib"),u={gapSpace:0},a={styles:{content:{fontSize:"0.75rem"}},maxWidth:"300px"},f=0;function l(e,t,n){var l=(n=n||{}).tooltipId?n.tooltipId:"od-Share-tooltip-".concat(f);f++;var c=n.targetElementId?Object(r.e)(Object(r.e)({},u),{target:"#".concat(n.targetElementId)}):u;return o.createElement(i.e,{id:l,content:t,directionalHint:void 0===n.position?s.e.topCenter:n.position,calloutProps:c,tooltipProps:a,styles:n.styles},e)}function c(e,t,n,r){return o.createElement("span",{tabIndex:-1,"aria-hidden":!!r,className:"od-Share-screenReaderOnly","aria-live":t,role:n},e||"")}},,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return f});n.d(t,"r",function(){return c});n.d(t,"n",function(){return p});var r,i=n(0),s=n(67),o=n(4),u=n(251),a=n(278);(function(e){e[e.Single=0]="Single";e[e.Start=1]="Start";e[e.End=2]="End"})(r||(r={}));var f,l=0;(function(e){e[e.Consumer=0]="Consumer";e[e.ConsumerAnonymous=1]="ConsumerAnonymous";e[e.Business=2]="Business";e[e.BusinessAnonymous=3]="BusinessAnonymous";e[e.Unknown=4]="Unknown";e[e.ConsumerOnSPO=5]="ConsumerOnSPO"})(f||(f={}));function c(e,t,n,r){Object(a.e)(e,t);var s={};for(var u in n)if(Object.prototype.hasOwnProperty.call(n,u)){var f=n[u],l=s[u]="number"==typeof f?{type:f}:f;l.definedInName=t.shortEventName;l.type===o.e.Number&&(l.isMetric=!0)}e.metadata=r?Object(i.e)(Object(i.e)({},r.prototype.metadata),s):s}var h=new WeakMap,p=(function(){function e(e,t,n){this.context={};this.data={};this.context=Object(i.e)({},this.addContext({}));this.id=l++;this.enabled=this._isEnabled();n&&(this.parentId=n.id);this.startTime=e&&e.startTimeOverride||s.e.getTime();this.vector=new u.e(n?n.vector:u.e.RootVector);e&&this._setData(e);this._logEvent(t)}e.enabled=function(){return this.prototype._isEnabled()};e.isTypeOf=function(e){return e.eventName?e.eventName.indexOf(this.prototype.shortEventName+",")>=0:!!e.prototype&&e.prototype.shortEventName===this.prototype.shortEventName};e.withManager=function(e){if(!e||e===s.e)return this;var t=h.get(e);if(!t){t=new WeakMap;h.set(e,t)}var n=t.get(this);if(n)return n;var r=(function(e){Object(i.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t})(this);r.prototype.manager=e;n=r;t.set(this,n);return n};e.withData=function(e){if(!e)return this;var t="function"!=typeof e?function(t){return Object(i.e)(Object(i.e)({},e),t)}:e;return(function(e){Object(i.r)(n,e);function n(){return null!==e&&e.apply(this,arguments)||this}n.prototype.addData=function(n){var r=Object(i.e)(Object(i.e)({},n),t(n));return Object(i.e)(Object(i.e)({},r),e.prototype.addData.call(this,r))};return n})(this)};e.withContext=function(e){if(!e)return this;var t="function"!=typeof e?function(t){return Object(i.e)(Object(i.e)({},e),t)}:e;return(function(e){Object(i.r)(n,e);function n(){return null!==e&&e.apply(this,arguments)||this}n.prototype.addContext=function(n){var r=Object(i.e)(Object(i.e)({},n),t(n));return Object(i.e)(Object(i.e)({},r),e.prototype.addContext.call(this,r))};return n})(this)};e.from=function(e){return e?this.withManager(e.prototype.manager).withContext(function(t){return e.prototype.addContext(t)}).withData(function(t){return e.prototype.addData(t)}):this};e.prototype.addContext=function(e){return v(this.manager,e,{})};e.prototype.addData=function(e){return e};e.prototype._isEnabled=function(){return!this.samplingFeature||s.e.isFeatureEnabled(this.samplingFeature)};e.prototype._setData=function(e){var t=Object(i.e)(Object(i.e)({},this.addData(this.data)),e);(function(e,t,n,r){for(var i=0,s=Object.keys(n);i<s.length;i++){var o=s[i];if(o in t){var u=t[o];d(e,n,r,o,u)}}})(this.manager,this.metadata,t,this.data)};e.prototype._logEvent=function(e){this.manager.logEvent(this,e)};return e})();function d(e,t,n,r,i){var s=t[r];switch(typeof s){case"string":var o=e.cleanString(s,r,i);void 0!==o&&(n[r]=o);return;case"undefined":return;case"object":s&&Object.getPrototypeOf(s)===Object.prototype?n[r]=v(e,s,{}):n[r]=s;return;default:n[r]=s;return}}function v(e,t,n){for(var r=0,i=Object.keys(t);r<i.length;r++){d(e,t,n,i[r])}return n}var m=p.prototype;m.eventName="EventBase,";m.shortEventName="EventBase";m.critical=!1;m.manager=s.e},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(60);function s(e,t){return new this(e,i.t.Single,t)}function o(e){return new this(null,i.t.Single,e)}function u(e,t,n){var u=(function(e){Object(r.r)(n,e);function n(){return null!==e&&e.apply(this,arguments)||this}n.logData=t?s:o;return n})(i.n);Object(i.r)(u.prototype,e,t||{},n);return u}},function(e,t,n){"use strict";n.r(t);n.d(t,"cryptoRandom",function(){return i});n.d(t,"Empty",function(){return s});n.d(t,"_guidRegEx",function(){return o});n.d(t,"generate",function(){return u});n.d(t,"normalizeLower",function(){return a});n.d(t,"normalizeUpper",function(){return f});n.d(t,"normalizeDashes",function(){return l});n.d(t,"isValidGuid",function(){return c});function r(e,t){for(var n="";n.length<e;){var r=16*(null!=t?t:Math.random)();n+=(r|=0).toString(16)}return n}function i(){return crypto.getRandomValues(new Uint32Array(1))[0]/4294967296}var s="00000000-0000-0000-0000-000000000000",o=/^[0-9a-f]{8}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{12}$/i;function u(e){var t=[];t.push(r(8,e));t.push(r(4,e));var n="4"+r(3,e);t.push(n);var i=r(4,e),s=parseInt(i[0],16);s&=3;i=(s|=8).toString(16)+i.substr(1);t.push(i);t.push(r(12,e));return t.join("-")}function a(e,t){void 0===t&&(t=!1);return e?h(e.toLowerCase(),t):""}function f(e,t){void 0===t&&(t=!1);return e?h(e.toUpperCase(),t):""}function l(e,t){void 0===t&&(t=!1);if(e){var n=e.replace(/[^A-Fa-f0-9]/g,"");if(32===n.length)return h("".concat(n.slice(0,8),"-").concat(n.slice(8,12),"-").concat(n.slice(12,16),"-").concat(n.slice(16,20),"-").concat(n.slice(20)),t)}return""}function c(e){return!(!e||!o.test(a(e)))}function h(e,t){var n=e.match(/^\{(.*)\}$/);return n?t?n[0]:n[1]:t?"{"+e+"}":e}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(41),i=n(173);function s(e){r.e.log(e)}var o=(function(){function e(t,n){void 0===n&&(n=s);this._id=e._uniqueId++;this._parent=t;this._onError=n;this._eventRecords=[]}e.raise=function(e,t,n,r){return i.n(e,t,n,r)};e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]};e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]};e.stopPropagation=function(e){e.stopPropagation&&e.stopPropagation()};e.prototype.dispose=function(){if(!this._isDisposed){this._isDisposed=!0;this.off();this._parent=null}};e.prototype.onAll=function(e,t,n){for(var r in t)this.on(e,r,t[r],n)};e.prototype.on=function(t,n,r,s){var o=this;if(n.indexOf(",")>-1)for(var u=n.split(/[ ,]+/),a=0;a<u.length;a++)this.on(t,u[a],r,s);else{var f=this._parent,l={target:t,eventName:n,parent:f,callback:r,objectCallback:null,elementCallback:null,useCapture:s},c=t.__events__=t.__events__||{};c[n]=c[n]||{count:0};c[n][this._id]=c[n][this._id]||[];c[n][this._id].push(l);c[n].count++;if(i.t(t)){var h=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(!o._isDisposed){try{var i=r.apply(f,t);if(!1===i&&t[0]&&t[0].preventDefault){var s=t[0];s.preventDefault();e.stopPropagation(s)}}catch(s){o._onError(s)}return i}};l.elementCallback=h;t.addEventListener(n,h,s)}else{l.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!o._isDisposed)return r.apply(f,e)}}this._eventRecords.push(l)}};e.prototype.off=function(e,t,n,r){for(var i=0;i<this._eventRecords.length;i++){var s=this._eventRecords[i];if(!(e&&e!==s.target||t&&t!==s.eventName||n&&n!==s.callback||"boolean"==typeof r&&r!==s.useCapture)){var o=s.target.__events__,u=o[s.eventName],a=u?u[this._id]:null;if(a){if(1!==a.length&&n){u.count--;a.splice(a.indexOf(s),1)}else{u.count-=a.length;delete o[s.eventName][this._id]}u.count||delete o[s.eventName]}s.elementCallback&&s.target.removeEventListener&&s.target.removeEventListener(s.eventName,s.elementCallback,s.useCapture);this._eventRecords.splice(i--,1)}}};e.prototype.raise=function(t,n,r){return e.raise(this._parent,t,n,r)};e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0};e._uniqueId=0;return e})();t.t=o},function(e,t,n){"use strict";n.d(t,"t",function(){return a});n.d(t,"e",function(){return f});var r=n(0);var i=n(196),s=n(9),o=!s.e.isActivated("115330F7-9AB5-4692-80AB-7401BE3808AA","03/17/2022","Events are stored in a Circular Buffer instead of an array");var u=(function(){function e(){this._handlers=[];this._buffer=o?new i.e(500):new i.t(500);this._featureEnablers=[];this._hasBufferOverflown=!1}Object.defineProperty(e.prototype,"startDate",{get:function(){return window.performance&&window.performance.timing&&window.performance.timing.navigationStart?new Date(window.performance.timing.navigationStart):new Date},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"startTime",{get:function(){return this.startDate.getTime()},enumerable:!1,configurable:!0});e.prototype.getTime=function(){return(new Date).getTime()};e.prototype.cleanString=function(e){return e};e.prototype.addLogHandler=function(e){var t=this._handlers,n=this._buffer;t.push(e);return n.getAll()};e.prototype.removeLogHandler=function(e){for(var t=this._handlers,n=0;n<t.length;n++)if(t[n]===e){t.splice(n,1);break}};e.prototype.logEvent=function(e,t){var n,i,s=this._buffer,o=this._handlers,u=Object.freeze({data:(n=e.data,i=[],"object"!=typeof n?n:(function e(t){var n=null;if(t){n=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t));Object.keys(t).forEach(function(r){var s=t[r];if("object"==typeof s){if(-1!==i.indexOf(s))throw new Error("Cannot perform DeepCopy() because a circular reference was encountered, object: ".concat(t,", ")+"property: ".concat(r));i.push(s);n[r]=e(s);i.pop()}else n[r]=s})}return n})(n)),context:Object(r.e)({},e.context),id:e.id,enabled:e.enabled,critical:e.critical,endTime:e.endTime,eventName:e.eventName,shortEventName:e.shortEventName,parentId:e.parentId,startTime:e.startTime,eventType:t,metadata:e.metadata,vector:e.vector,isEventTypePrefixingDisabled:e.isEventTypePrefixingDisabled}),a=s.isFull;s.push(u);if(!this._hasBufferOverflown&&a){this._hasBufferOverflown=!0;0===o.length&&l(new Error("Logging buffer overflow hit before any logging handler was registered"))}for(var f=0;f<o.length;f++)try{o[f](u)}catch(e){l(e)}};e.prototype.addValidationErrorLogger=function(){};e.prototype.removeValidationErrorLogger=function(){};e.prototype.logValidationError=function(){};e.prototype.isFeatureEnabled=function(e){for(var t=0,n=this._featureEnablers;t<n.length;t++){if((0,n[t])(e))return!0}return!1};e.prototype.addFeatureEnabler=function(e){this._featureEnablers.push(e)};e.prototype.removeFeatureEnabler=function(e){var t=this._featureEnablers,n=t.indexOf(e);n>-1&&t.splice(n,1)};e.prototype.getStack=function(){var e;try{var t=window;t.______ExpectedError______&&t.______ExpectedError______()}catch(t){e=t}return e&&e.stack||void 0};return e})();function a(){return new u}var f="undefined"!=typeof window?window.ODSP_TELEMETRY_MANAGER=window.ODSP_TELEMETRY_MANAGER||a():"undefined"!=typeof self?self.ODSP_TELEMETRY_MANAGER=self.ODSP_TELEMETRY_MANAGER||a():a();function l(e){console.error("Telemetry Manager:",e)}},function(e,t,n){"use strict";n.d(t,"e",function(){return z});var r=n(0),i=n(173);function s(e){window.setTimeout(function(){i.n(R,m,{error:e})},0)}var o,u,a,f,l,c,h,p,d,v,m="error",g=1;function y(){}o={name:"created",enter:function(e){e._setState(u)},cancel:y,done:y,then:y,_completed:y,_error:y,_notify:y,_setCompleteValue:y,_setErrorValue:y};u={name:"working",enter:y,cancel:function(e){e._setState(l)},done:N,then:P,_completed:b,_error:C,_notify:y,_setCompleteValue:D,_setErrorValue:_};a={name:"waiting",enter:function(e){var t=e._value;if(t instanceof U&&t._state!==v&&t._state!==p)O(t,{promise:e});else{var n=function(r){if(t._errorId)e._chainedError(r,t);else{A(e,r,E,t,n);e._error(r)}};n.handlesOnError=!0;t.then(e._completed.bind(e),n)}},cancel:function(e){e._setState(f)},done:N,then:P,_completed:b,_error:C,_notify:y,_setCompleteValue:D,_setErrorValue:_};f={name:"waiting_canceled",enter:function(e){e._setState(c);var t=e._value;R.is(t)&&t.cancel()},cancel:y,done:N,then:P,_completed:b,_error:C,_notify:y,_setCompleteValue:D,_setErrorValue:_};l={name:"canceled",enter:function(e){e._setState(c);e._cancelAction()},cancel:y,done:N,then:P,_completed:b,_error:C,_notify:y,_setCompleteValue:D,_setErrorValue:_};c={name:"canceling",enter:function(e){var t=new Error("Canceled");t.name=t.message;t._handled=!0;e._value=t;e._setState(d)},cancel:y,done:y,then:y,_completed:y,_error:y,_notify:y,_setCompleteValue:y,_setErrorValue:y};h={name:"complete_notify",enter:function(e){if(e._listeners)for(var t=[e],n=void 0;t.length;)(n=t.shift())&&n._state._notify(n,t);e._setState(p)},cancel:y,done:function(e,t,n){return F.prototype.done.call(e,t)},then:function(e,t,n){return F.prototype.then.call(e,t,n)},_completed:y,_error:y,_notify:k,_setCompleteValue:y,_setErrorValue:y};p={name:"success",enter:function(e){e._cleanupAction()},cancel:y,done:function(e,t,n){return F.prototype.done.call(e,t)},then:function(e,t,n){return F.prototype.then.call(e,t)},_completed:y,_error:y,_notify:k,_setCompleteValue:y,_setErrorValue:y};d={name:"error_notify",enter:function(e){if(e._listeners)for(var t=[e],n=void 0;t.length;)(n=t.shift())&&n._state._notify(n,t);e._setState(v)},cancel:y,done:function(e,t,n){return B.prototype.done.call(e,t,n)},then:function(e,t,n){return B.prototype.then.call(e,t,n)},_completed:y,_error:y,_notify:L,_setCompleteValue:y,_setErrorValue:y};v={name:"error",enter:function(e){e._cleanupAction()},cancel:y,done:function(e,t,n){return B.prototype.done.call(e,t,n)},then:function(e,t,n){return B.prototype.then.call(e,t,n)},_completed:y,_error:y,_notify:L,_setCompleteValue:y,_setErrorValue:y};function b(e,t){e._value=t;e._setState(R.isPromise(t)?a:h)}function w(e,t,n,r,i,s){return{exception:e,error:t,promise:n,handler:s,id:r,parent:i}}function E(e,t,n,r){var i=null==n?void 0:n._isException;return w(i?t:null,i?null:t,e,null==n?void 0:n._errorId,n,r)}function S(e,t,n){var r=null==n?void 0:n._isException,i=null==n?void 0:n._errorId;e instanceof R&&M(e,i,r);return w(r?t:null,r?null:t,e,i,n)}function x(e,t){var n=++g;e instanceof R&&M(e,n);return w(null,t,e,n)}function T(e,t){var n=++g;e instanceof R&&M(e,n,!0);return w(t,null,e,n)}function N(e,t,n){O(e,{c:t,e:n})}function C(e,t,n,r){e._value=t;A(e,t,n,r);e._setState(d)}function k(e,t){var n=e._value,r=e._listeners;if(r){e._listeners=null;var i,s;for(i=0,s=r.length;i<s;i++){var o=r[i],u=o.c,f=o.promise;if(f){try{f._setCompleteValue(u?u(n):n)}catch(e){f._setExceptionValue(e)}f._state!==a&&f._listeners&&t.push(f)}else F.prototype.done.call(e,u)}}}function L(e,t){var n=e._value,r=e._listeners;if(r){e._listeners=null;var i,s;for(i=0,s=r.length;i<s;i++){var o=r[i],u=o.e,f=o.promise;if(f){try{if(u){u.handlesOnError||A(f,n,E,e,u);f._setCompleteValue(u(n))}else f._setChainedErrorValue(n,e)}catch(e){f._setExceptionValue(e)}f._state!==a&&f._listeners&&t.push(f)}else B.prototype.done.call(e,void 0,u)}}}function A(e,t,n,r,s){t instanceof Error&&"Canceled"===t.message||i.n(R,m,n(e,t,r,s))}function O(e,t){var n=e._listeners;n?n.push(t):n=[t];e._listeners=n}function M(e,t,n){e._isException=n||!1;e._errorId=t}function _(e,t,n,r){e._value=t;A(e,t,n,r);e._setState(v)}function D(e,t){var n;n=R.isPromise(t)?a:p;e._value=t;e._setState(n)}function P(e,t,n){var r=new U(e);O(e,{promise:r,c:t,e:n});return r}var H,B=(function(){function e(e,t){void 0===t&&(t=x);this._value=e;A(this,e,t)}e.prototype.cancel=function(){};e.prototype.done=function(e,t){var n=this._value;if(t)try{t.handlesOnError||A(this,n,E,this,t);var r=t(n);R.is(r)&&r.done();return}catch(e){n=e}n instanceof Error&&"Canceled"===n.message||s(n)};e.prototype.then=function(e,t){if(!t)return this;var n,r=this._value;try{t.handlesOnError||A(this,r,E,this,t);n=new F(t(r))}catch(e){n=e===r?this:new j(e)}return n};e.prototype.catch=function(e){return this.then(void 0,e)};return e})(),j=(function(e){Object(r.r)(t,e);function t(t){return e.call(this,t,T)||this}return t})(B),F=(function(){function e(e){if(R.isPromise(e)){var t=new U(null);t._setCompleteValue(e);return t}this._value=e}e.prototype.cancel=function(){};e.prototype.done=function(e,t){if(e)try{var n=e(this._value);R.is(n)&&n.done()}catch(e){s(e)}};e.prototype.then=function(t,n){var r;try{var i=t?t(this._value):this._value;r=this._isSameValue(i,this)?this:new e(i)}catch(e){r=new j(e)}return r};e.prototype.catch=function(e){return this.then(void 0)};e.prototype._isSameValue=function(e,t){return e===this._value};return e})();function I(e){var t;return new R(function(n){t=window.setTimeout(n,e)},function(){t&&window.clearTimeout(t)})}function q(e){var t=e;return function(){for(var e=0,n=Object.keys(t);e<n.length;e++){var r=n[e];R.as(t[r]).cancel()}}}var R=(function(){function e(e,t){this._init(e,t)}Object.defineProperty(e,"cancel",{get:function(){return H||(H=new B(new Error("Canceled")))},enumerable:!1,configurable:!0});e.any=function(t){return new e(function(n,r){var i=Object.keys(t),s=i.length;0===s&&n();for(var o=t,u=function(t){var i=e.as(o[t]);i.then(function(){n({key:t,value:i})},function(o){o instanceof Error&&"Canceled"===o.name?0==--s&&n(e.cancel):r({key:t,value:i})})},a=0,f=i;a<f.length;a++){u(f[a])}},q(t))};e.race=function(t){return new e(function(n,r){var i=Object.keys(t),s=i.length;0===s&&n();for(var o=t,u=0,a=i;u<a.length;u++){var f=a[u];e.as(o[f]).then(n,function(t){t instanceof Error&&"Canceled"===t.name?0==--s&&n(e.cancel):r(t)})}},q(t))};e.as=function(t){return e.is(t)?t:new F(t)};e.is=function(t){return e.isPromise(t)&&"function"==typeof t.cancel};e.isPromise=function(e){return!!e&&"object"==typeof e&&"function"==typeof e.then};e.isCanceled=function(e){return e instanceof Error&&"Canceled"===e.name};e.all=function(t){return new e(function(n,r){for(var i=Object.keys(t),s=Array.isArray(t)?[]:{},o=Array.isArray(t)?[]:{},u=i.length,a=function(){if(0==--u){var t=Object.keys(s);0===t.length?n(o):t.every(function(t){return e.isCanceled(s[t])})?n(e.cancel):r(s)}},f=function(n){var r=t[n];void 0===r?u--:e.then(r,function(e){o[n]=e;a()},function(e){s[n]=e;a()})},l=0,c=i;l<c.length;l++){f(c[l])}0===u&&n(o)},q(t))};e.then=function(t,n,r){return e.as(t).then(n,r)};e.thenEach=function(t,n,r){for(var i=Array.isArray(t)?[]:{},s=0,o=Object.keys(t);s<o.length;s++){var u=o[s];i[u]=e.then(t[u],n,r)}return e.all(i)};e.serial=function(t){return t.reduce(function(e,t){return e.then(t)},e.wrap())};e.timeout=function(e,t){var n=I(e);return t?(function(e,t){var n=function(){e.cancel()};e.then(function(){t.cancel()});t.then(n,n);return t})(n,t):n};e.wrap=function(e){return new F(e)};e.resolve=function(t){return e.wrap(t)};e.wrapError=function(e){return new B(e)};e.reject=function(t){return e.wrapError(t)};e.prototype.cancel=function(){this._state.cancel(this);this._run()};e.prototype.done=function(e,t){this._state.done(this,e,t)};e.prototype.then=function(e,t){return this._state.then(this,e,t)};e.prototype.catch=function(e){return this.then(void 0,e)};e.prototype._init=function(e,t){this._oncancel=t;this._setState(o);this._run();try{e?e(this._completed.bind(this),this._error.bind(this)):this._setExceptionValue(new Error("No init value for Promise"))}catch(e){this._setExceptionValue(e)}};e.prototype._cancelAction=function(){if(this._oncancel)try{this._oncancel()}catch(e){}};e.prototype._cleanupAction=function(){this._oncancel=void 0};e.prototype._chainedError=function(e,t){var n=this._state._error(this,e,S,t);this._run();return n};e.prototype._completed=function(e){var t=this._state._completed(this,e);this._run();return t};e.prototype._error=function(e){var t=this._state._error(this,e,x);this._run();return t};e.prototype._setState=function(e){this._nextState=e};e.prototype._setCompleteValue=function(e){this._state._setCompleteValue(this,e);this._run()};e.prototype._setChainedErrorValue=function(e,t){var n=this._state._setErrorValue(this,e,S,t);this._run();return n};e.prototype._setExceptionValue=function(e){var t=this._state._setErrorValue(this,e,T);this._run();return t};e.prototype._run=function(){for(;this._nextState;){this._state=this._nextState;this._nextState=void 0;this._state.enter(this)}};e.prototype._isSameValue=function(e,t){return e===this._value};return e})();i.e(R,m);var U=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this)||this;n._creator=t;n._initThen();return n}t.prototype._init=function(){};t.prototype._cancelAction=function(){this._creator&&this._creator.cancel()};t.prototype._cleanupAction=function(){this._creator=null};t.prototype._initThen=function(){this._setState(o);this._run()};return t})(R),z=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this)||this;n._oncancel=t;n._initSignal();return n}t.prototype._init=function(){};t.prototype._cancelAction=function(){this._oncancel&&this._oncancel()};t.prototype._cleanupAction=function(){this._oncancel=void 0};t.prototype._initSignal=function(){this._setState(o);this._run()};return t})(R),W=R;t.t=W},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(137),i=(function(){function e(){this._disposables={};this._lastDisposableId=0;this.isDisposed=!1}e.prototype.attach=function(e){var t=this,n="".concat(++this._lastDisposableId),i=Object(r.e)(e,function(){delete t._disposables[n]});this._disposables[n]=i;return i};e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,n=Object.keys(e);t<n.length;t++){var i=n[t],s=e[i];s&&Object(r.t)(s)&&s.dispose();delete e[i]}};return e})()},function(e,t,n){"use strict";n.d(t,"r",function(){return r});n.d(t,"t",function(){return i});n.d(t,"n",function(){return s});n.d(t,"e",function(){return m});var r,i,s,o=n(0),u=n(46),a=n(5),f=n(203),l=n(335),c=n(55),h=n(242),p=n(208),d=n(220),v=n(3);(function(e){e.Opening="Opening";e.Opened="Opened";e.Completed="Completed"})(r||(r={}));(function(e){e.MainLinkSettingsHint="MainLinkSettingsHint";e.PeoplePickerErrorLinkSettingsHint="PeoplePickerErrorLinkSettingsHint";e.CopyLinkSettingsHint="CopyLinkSettingsHint";e.RoleSelector="RoleSelector";e.Other="Unknown"})(i||(i={}));(function(e){e.People="People";e.Groups="Groups";e.Links="Links";e.Other="Unknown"})(s||(s={}));var m=(function(){function e(e,t){this._manager=e;this._extraData=t;this._engagmentCounts={}}e.prototype.setEngagementExtraData=function(e){this._extraData=Object(o.e)(Object(o.e)({},this._extraData),e)};e.prototype.getEngagementExtraData=function(){return this._extraData};e.prototype.linkSettingsOpened=function(e,t){this.log("LinkSettings.Opened",Object(o.e)(Object(o.e)({},e),{linkSettingsOpenSource:t||i.Other}))};e.prototype.linkSettingsApplyClicked=function(e){this.log("LinkSettings.ApplyClicked",e)};e.prototype.linkSettingsCancelClicked=function(e){this.log("LinkSettings.CancelClicked",e)};e.prototype.linkSettingsLearnMoreClicked=function(e){this.log("LinkSettings.LearnMoreClicked",e)};e.prototype.linkSettingsOnAllowEditingClicked=function(e){this.log("LinkSettings.AllowEditingClicked",e)};e.prototype.linkTrackLinkClicked=function(e){this.log("LinkSettings.TrackLinkClicked",e)};e.prototype.linkSettingsLinkTypeChanged=function(e){this.log("LinkSettings.LinkTypeChanged",e)};e.prototype.manageAccessNumberOfSharingPrincipals=function(e){this.log("ManageAccess.NumberOfSharingPrincipals",e)};e.prototype.manageAccessOpened=function(e){this.log("ManageAccess.Opened",e)};e.prototype.manageAccessAddressBarLinkTypeClicked=function(e){this.log("ManageAccess.AddressBarLinkTypeClicked",e)};e.prototype.manageAccessFacePileClicked=function(e){this.log("ManageAccess.FacePileClicked",e)};e.prototype.manageAccessRemoveDirectAccess=function(e){this.log("ManageAccess.RemoveDirectAccess",e)};e.prototype.manageAccessLinkCopyButtonClicked=function(e){this.log("ManageAccess.LinkCopyClicked",e)};e.prototype.manageAccessLinkDetailsClicked=function(e){this.log("ManageAccess.LinkDetailsClicked",e)};e.prototype.manageAccessLinkInviteesToggled=function(e,t){this.log("ManageAccess.LinkInviteesToggled",Object(o.e)(Object(o.e)({},t),{isExpanded:e}))};e.prototype.manageAccessAdvancedLinkClicked=function(e){this.log("ManageAccess.AdvancedLinkClicked",e)};e.prototype.manageAccessLinkSectionShareClicked=function(e){this.log("ManageAccess.LinkSectionShareClicked",e)};e.prototype.manageAccessGrantAccessClicked=function(e){this.log("ManageAccess.DiretAccessSectionGrantAccessClicked",e)};e.prototype.manageAccessV3Opened=function(e){this.log("ManageAccessV3.Opened",e)};e.prototype.manageAccessV3NumberOfSharingPrincipals=function(e){this.log("ManageAccessV3.NumberOfSharingPrincipals",e)};e.prototype.manageAccessV3AdvancedSettingsClicked=function(e){this.log("ManageAccessV3.AdvancedSettingsClicked",e)};e.prototype.manageAccessV3UserDidSearch=function(e){this.log("ManageAccessV3.UserDidSearch",e)};e.prototype.manageAccessV3StopSharingClicked=function(e){this.log("ManageAccessV3.StopSharingClicked",e)};e.prototype.compactRoleSelectorClicked=function(e){this.log("RoleSelectorCompact.Clicked",e)};e.prototype.linkSettingsInCompactRoleSelectorClicked=function(e){this.log("RoleSelectorCompact.LinkSettingsClicked",e)};e.prototype.SharingRoleChangedFromCompactRoleSelector=function(e){this.log("SharingRoleChangedFromCompactRoleSelector",e)};e.prototype.SharingRoleChangedFromLargeRoleSelector=function(e){this.log("SharingRoleChangedFromLargeRoleSelector",e)};e.prototype.manageAccessV3NavClicked=function(e,t,n){this.log("ManageAccessV3.NavigationClicked",Object(o.e)(Object(o.e)({},n),{sectionName:e||s.Other,sectionItemCount:t}))};e.prototype.manageAccessV3ShareClicked=function(e,t){this.log("ManageAccessV3.ShareClicked",Object(o.e)(Object(o.e)({},t),{shareLocation:e}))};e.prototype.manageAccessV3PrincipalDetailsClicked=function(e,t){this.log("ManageAccessV3.PrincipalDetailsClicked",Object(o.e)(Object(o.e)({},t),{principalType:e}))};e.prototype.manageAccessV3PrincipalRemoveDirectAccess=function(e,t){this.log("ManageAccessV3.PrincipalRemoveDirectAccess",Object(o.e)(Object(o.e)({},t),{principalType:e}))};e.prototype.manageAccessV3CancelPermissionUpdate=function(e){this.log("ManageAccessV3.CancelPermissionUpdate",e)};e.prototype.shareToTeamsTeachingBubbleShown=function(e){this.log("ShareToTeamsTeachingBubble.Shown",e)};e.prototype.shareCompleted=function(e){e=Object(o.e)(Object(o.e)({},e),{compactRoleSelectorClicked:this._engagmentCounts["RoleSelectorCompact.Clicked"]>0,linkSettingsOpened:this._engagmentCounts["LinkSettings.Opened"]>0,sharingRoleChangedFromCompactRoleSelector:this._engagmentCounts.SharingRoleChangedFromCompactRoleSelector>0});this.log("Completed",e)};e.prototype.sendACopyClicked=function(e){this.log("SendACopy.Clicked",e)};e.prototype.sendACopyOfficeClicked=function(e){this.log("SendACopy.OfficeClicked",e)};e.prototype.sendACopyPdfClicked=function(e){this.log("SendACopy.PdfClicked",e)};e.prototype.whoElseHasAccessClicked=function(e){this.log("WhoElseHasAccess.Clicked",e)};e.prototype.externalSharingCslError=function(e){this.log("externalSharingCslError",e)};e.prototype.copyLinkInterruptOpened=function(e){this.log("copyLinkInterruptOpened",e)};e.prototype.copyLinkInterruptEditLinkChosen=function(e){this.log("copyLinkInterruptEditLinkChosen",e)};e.prototype.copyLinkInterruptExistingLinkChosen=function(e){this.log("copyLinkInterruptExistingLinkChosen",e)};e.prototype.copyLinkInterruptCancelled=function(e){this.log("copyLinkInterruptCancelled",e)};e.prototype.shareErrorFileIsUploading=function(e){this.log("shareError.FileUploading",e)};e.prototype.webShareToTeamsTargetClicked=function(e){this.log("ShareToTeams.TeamsTargetClicked",e)};e.prototype.onLinkParticipantOpenDelete=function(e){this.log("ShareLinkParticipants.OpenParticipantDeletionDialog",e)};e.prototype.onLinkParticipantDelete=function(e){this.log("ShareLinkParticipants.ParticipantDeleted",e)};e.prototype.peoplePickerLinkedinSuggestions=function(e,t){this.log("PeoplePicker.Suggestions",Object(o.e)(Object(o.e)({},e),{linkedinSuggestionsCount:u.t(t)}))};e.prototype.onShareLinkDelete=function(e){this.log("ShareLink.Delete",e)};e.prototype.logShareLinkGeneration=function(e,t){this.log("ShareV3.odspShareLink",Object(o.e)(Object(o.e)({},t),{allowsAnonymousAccess:e.allowsAnonymousAccess,audience:e.audience,blockDownload:e.blockDownload,createdViaCopyLinkCommand:e.createdViaCopyLinkCommand,hasDescription:!!e.description,hasExpiration:!!e.expiration,hasPassword:e.hasPassword,numOfInvitees:e.invitees?e.invitees.length:0,isActive:e.isActive,isAddressBarLink:e.isAddressBarLink,isCreateOnlyLink:e.isCreateOnlyLink,isEdit:e.isEdit,isManageList:e.isManageList,isReview:e.isReview,isUnhealthy:e.isUnhealthy,shareId:e.shareId,sharingLinkStatus:e.status,trackLinkUsers:e.trackLinkUsers}))};e.prototype.showSensitivityLabel=function(e){this.log("showSensitivityLabel",e)};e.prototype.hoverOverSensitivityLabel=function(e){this.log("hoverOverSensitivityLabel",e)};e.prototype.logEvent=function(e,t){this.log(r[e],t)};e.prototype.log=function(e,t){void 0===this._engagmentCounts[e]?this._engagmentCounts[e]=1:this._engagmentCounts[e]++;var n=Object(o.e)(Object(o.e)({},this._extraData),t),r=location.href.toLowerCase().indexOf("sharedialog.aspx")>=0,i=location.href.toLowerCase().indexOf("www.odwebp.svc.ms")>=0,s=Object(p.e)(location.search.substring(1)),u="12"===s.p,m=!!s.migratedhosting&&"true"===s.migratedhosting.toLowerCase(),g=Object(o.e)(Object(o.e)(Object(o.e)({},n),{clientId:a.e[n.clientId],scenarioId:n.scenarioId,mode:f.e[n.mode],shareType:l.e[n.shareType],audience:c.e[n.audience],shareTargets:this._getFriendlyShareTargets(n.shareTargets),sharingLinkKind:h.e[n.sharingLinkKind],isShareDialogASPXHosted:r,isP12:u,isMigratedhosting:m,isMicroServiceHosted:i}),void 0===n.shareViewState?{}:{shareViewState:v.e[n.shareViewState]}),y={name:0===e.indexOf("ShareV3")?e:"".concat("ShareV3",".").concat(e),webTemplateId:n.webTemplateId?n.webTemplateId.toString():void 0,docId:n.itemUniqueId,extraData:g};(this._manager?d.e.withManager(this._manager):d.e).logData(y)};e.prototype._getFriendlyShareTargets=function(e){var t=[];if(e)for(var n=0,r=e;n<r.length;n++){var i=r[n];t.push(l.e[i])}return t};return e})()},,function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"u",function(){return i});n.d(t,"t",function(){return s});n.d(t,"o",function(){return o});n.d(t,"e",function(){return u});n.d(t,"s",function(){return a});n.d(t,"i",function(){return f});n.d(t,"r",function(){return l});n.d(t,"a",function(){return c});n.d(t,"f",function(){return h});n.d(t,"l",function(){return p});n.d(t,"c",function(){return d});var r=6e4,i=2*r,s=60*r,o=2*s,u=24*s,a=2*u,f=7*u,l=32*u;function c(e,t){return e.getDate()===t.getDate()&&Math.abs(t.getTime()-e.getTime())<u}function h(e,t){return e.getFullYear()===t.getFullYear()}function p(e,t,n){if(e)try{return e.toLocaleDateString(t,n)}catch(t){return e.toLocaleDateString([],n)}}function d(e,t,n){if(e)try{return e.toLocaleTimeString(t,n)}catch(t){return e.toLocaleTimeString([],n)}}},,function(e,t,n){"use strict";n.d(t,"n",function(){return d});n.d(t,"r",function(){return v});n.d(t,"s",function(){return m});n.d(t,"f",function(){return g});n.d(t,"l",function(){return y});n.d(t,"t",function(){return b});n.d(t,"e",function(){return w});n.d(t,"a",function(){return E});n.d(t,"c",function(){return S});n.d(t,"i",function(){return x});n.d(t,"u",function(){return N});n.d(t,"o",function(){return C});var r=n(55),i=n(203),s=n(115),o=n(32),u=n(266),a=n(202),f=n(96),l=n(8),c=n(10),h={ODB:772},p={ODB:1935};function d(e){return"anyoneLinkAbilities"===e||"anonymousLinkAbilities"===e?r.e.anyone:"organizationLinkAbilities"===e?r.e.organization:"peopleSharingLinkAbilities"===e?r.e.specificPeopleFlex:void 0}function v(e,t){return e===r.e.anyone?t.anyoneLinkAbilities?t.anyoneLinkAbilities:t.anonymousLinkAbilities:e===r.e.organization?t.organizationLinkAbilities:e===r.e.specificPeopleFlex||e===r.e.customLabeledSpecificPeople?t.peopleSharingLinkAbilities:t.directSharingAbilities}function m(e,t){var n=v(e,t);return(null==n?void 0:n.canManageEditLink)?n.canManageEditLink.enabled:!!(null==n?void 0:n.canAddInternalPrincipal)&&n.canAddInternalPrincipal.enabled}function g(e,t){var n,r=v(e,t);return!!(null==r?void 0:r.canManageReadLink)&&(null===(n=null==r?void 0:r.canManageReadLink)||void 0===n?void 0:n.enabled)}function y(e,t,n){if(o.e.isFeatureEnabled(h)&&!u.e[n]){var r=v(e,t);return(null==r?void 0:r.canManageReviewLink)?r.canManageReviewLink.enabled:!!(null==r?void 0:r.supportsReviewPermission)&&r.supportsReviewPermission.enabled}return!1}function b(e){var t=e.sharingInformation,n=e.audience,s=e.mode,o=!1,u=!1,h=!1,p=!1,d=!0;if(!Object(c.B)(t)){o=t.sharedObjectType===f.e.list;u=(function(e){var t=e.audience,n=e.sharingAbilities,i=e.sharingRole,s=v(t,n);return(null==s?void 0:s.canManageManageListLink)?s.canManageManageListLink.enabled:t===r.e.existing&&(i===a.e.manageList||i===a.e.owner)})({audience:n,sharingAbilities:t.sharingAbilities,sharingRole:t.userRole});p=y(n,t.sharingAbilities,t.fileExtension)||E(n,t.sharingAbilities,t.fileExtension);h=m(n,t.sharingAbilities);d=l.w()||g(n,t.sharingAbilities)}var b=s===i.e.addPeople||s===i.e.manageAccess||h,w=d;(n==r.e.specificPeople&&C(n,t.sharingAbilities)||t.requiresAccessApproval&&!l.W())&&(b=w=!0);return{fullControl:{enabled:!1,shouldDisplay:!1},manageList:{enabled:u,shouldDisplay:o},review:{enabled:p,shouldDisplay:p},edit:{enabled:b,shouldDisplay:!0},view:{enabled:w,shouldDisplay:w}}}function w(e){var t=e.sharingInformation,n=e.scenarioId,r=!1,i=!1,s=!1;if(!Object(c.B)(t)){r=t.sharedObjectType===f.e.list;i=(function(e){var t=e.sharingRole;return t===a.e.manageList||t===a.e.owner})({sharingRole:t.userRole});s=(function(e,t){var n=e.sharedObjectType===f.e.list;return t&&n&&e.userRole===a.e.owner})(t,!0)}return{fullControl:{enabled:s,shouldDisplay:s},manageList:{enabled:i,shouldDisplay:r},review:{enabled:!1,shouldDisplay:!1},edit:{enabled:!0,shouldDisplay:!0},view:{enabled:"SharePrivateDraft"!==n,shouldDisplay:"SharePrivateDraft"!==n}}}function E(e,t,n){if(u.t===u.e[n]){var r=v(e,t);return r.canManageReviewLink?r.canManageReviewLink.enabled:!!r.supportsReviewPermission&&r.supportsReviewPermission.enabled}return!1}function S(e,t){var n=v(e,t);return!!n.supportsRestrictedView&&n.supportsRestrictedView.enabled}function x(e,t){var n=[];if(o.e.isFeatureEnabled(p))for(var r=0,i=t;r<i.length;r++){var s=i[r];if(s.linkDetails&&s.linkDetails.shareId){var u=v(s.linkDetails.audience,e);if(!(!!u.canManageEditLink&&u.canManageEditLink.enabled||!!u.canManageReviewLink&&u.canManageReviewLink.enabled||!!u.canManageReadLink&&u.canManageReadLink.enabled)){!!(s.linkDetails.expiration&&s.linkDetails.expiration<new Date(Date.now()))||n.push(s.linkDetails)}}}return n}function T(e,t,n){var r;if(!e||!t)return!1;var i=v(e,t);for(var s in i)if((null===(r=i[s])||void 0===r?void 0:r.disabledReason)==n)return!0;return!1}function N(e,t){return T(e,t,s.e.sharingBlockedByVirusCheckStatus)}function C(e,t){return T(e,t,s.e.irmIsEnabled)}},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(0),i=n(111);function s(e,t){return function(n){var r=Object(i.getUserPhotoUrl)(n,t||i.UserPhotoSize.Small);return 0===r.indexOf("https://")||0===r.indexOf("http://")?r:r&&e?e+r:void 0}}function o(e){!e||window._spPageContextInfo&&window._spPageContextInfo.userPhotoCdnBaseUrl||(window._spPageContextInfo=Object(r.e)(Object(r.e)({},window._spPageContextInfo),{userPhotoCdnBaseUrl:e}))}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});n.d(t,"t",function(){return f});n.d(t,"n",function(){return l});var r=n(119),i=n(32),s=n(9),o=n(112),u={ODB:s.t.isActivated("904afe8e-3cce-4ab4-ac2f-97b60197cf59","11/9/2021","Disable check for webTemplate mySite as qualification for isOdb"),ECS:108854},a=window._spPageContextInfo&&(window._spPageContextInfo.listBaseTemplate===r.n.mySiteDocumentLibrary||!i.e.isFeatureEnabled(u)&&Number(window._spPageContextInfo.webTemplate)===o.t.mySite),f=!!window.FilesConfig,l=a||f},,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return p});n.d(t,"e",function(){return d});n.d(t,"n",function(){return v});var r={};n.r(r);n.d(r,"Default",function(){return u});n.d(r,"Tenant",function(){return a});n.d(r,"Hub",function(){return f});n.d(r,"Site",function(){return l});var i,s=n(27),o=n(9),u=0,a=1,f=2,l=3,c=o.t.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),h="undefined"!=typeof window&&s.e.isFeatureEnabled({ODB:1737});(function(e){e[e.FooterEnabled=2]="FooterEnabled";e[e.MegaMenuEnabled=128]="MegaMenuEnabled";e[e.FooterEmphasis0=256]="FooterEmphasis0";e[e.FooterEmphasis1=512]="FooterEmphasis1";e[e.FooterLayout0=1024]="FooterLayout0";e[e.FooterLayout1=2048]="FooterLayout1";e[e.HideTitleInHeader=33554432]="HideTitleInHeader";e[e.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"})(i||(i={}));function p(e){var t=e.webAbsoluteUrl,n=e.webServerRelativeUrl,r=e.isSiteListsHost;return"/"===n||""===n||!c&&r||h&&(null==e?void 0:e.isUnifiedAdminUrl)?t:t.substring(0,t.lastIndexOf(n))}function d(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl}function v(e){return e&&e.webAbsoluteUrl===e.siteAbsoluteUrl}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=function(){try{return!!window.sessionStorage.getItem("_isRunningTABTest")}catch(e){console.log("No session storage accessible: "+e);return!1}}},function(e,t,n){"use strict";n.r(t);n.d(t,"verbose",function(){return p});n.d(t,"logError",function(){return d});n.d(t,"log",function(){return v});n.d(t,"getErrorMessage",function(){return m});n.d(t,"isExpectedError",function(){return g});var r=n(61),i=n(4),s=n(227),o=Object(r.e)({eventName:"CaughtError,Trace,",shortEventName:"CaughtError",critical:!0},{stack:i.e.String,extraData:i.e.Object,privacyClassification:{isPrefixingDisabled:!0,type:i.e.String}},s.e).withData({privacyClassification:i.t.requiredService}),u=n(26),a=Object(r.e)({eventName:"QosError,CaughtError,Trace,",shortEventName:"QosError",critical:!0},{name:{isKey:!0,type:i.e.String},resultCode:i.e.String,resultType:{typeRef:u.e,type:i.e.Enum}},o).withData({privacyClassification:i.t.requiredDiagnostic}),f=n(314),l=n(196),c=n(197),h=new l.e(50);function p(e,t){h.push({name:t,message:e})}function d(e,t,n){var r;if(!e||(function(e){return"Canceled"===e||"Canceled"===(null==e?void 0:e.name)||"Canceled"===(null==e?void 0:e.message)})(e)||"object"==typeof e&&e.isExpected)try{if("true"===sessionStorage.getItem("suppressErrorHandling"))return}catch(e){}else{for(var i,s=m(e),u=null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:"";i=h.popOldest();)f.e.logData(i);n&&n.eventName?a.logData({name:n.eventName,resultCode:n.resultCode,resultType:n.resultType,extraData:t||{},message:s,stack:u}):o.logData({extraData:t||{},message:s,stack:u})}}function v(e,t,n,r){d(e,void 0,{eventName:t,resultCode:n,resultType:r})}function m(e){var t,n;return e?"object"==typeof e?null!==(n=null!==(t=e.message)&&void 0!==t?t:e.description)&&void 0!==n?n:Object(c.e)(e):e.toString():""}function g(e,t){if(!0===e.isExpected)return!0;void 0===e.message&&void 0===e.code&&console.error('Error message and code are both undefined. "error" must specify at least message or code');for(var n=function(e,t){return!(!e||!t)&&(0===e.localeCompare(t,void 0,{sensitivity:"base"})||e===t)},r=!1,i=0,s=t;i<s.length;i++){var o=s[i],u=n(o.code,e.code),a=n(o.message,e.message);o.code&&e.code&&o.message&&e.message?r=u&&a:o.code&&e.code?r=u:o.message&&e.message&&(r=a);if(r)return r}return r}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){return{clientId:e.clientId,scenarioId:e.scenarioId,correlationId:e.correlationId,hostOptions:e.hostOptions}}},function(e,t,n){"use strict";var r;(function(e){e[e.button=0]="button";e[e.link=1]="link";e[e.copyLink=2]="copyLink"})(r||(r={}));t.e=r},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"n",function(){return s});n.d(t,"i",function(){return o});n.d(t,"r",function(){return u});n.d(t,"t",function(){return a});var r=n(0),i=(function(e){Object(r.r)(t,e);function t(t,n){var i=this,s=n.response,o=(void 0===s?{}:s).error,u=(void 0===o?{}:o).innerError,f=(void 0===u?{}:u).stackTrace,l=void 0===f?"":f,c=n.response,h=n.request,p=n.status,d=n.code,v=void 0===d?a(c,p,function(e){return"".concat(e)})||"unhandled":d,m=Object(r.e)({innerError:t,code:v},n);(i=e.call(this,m)||this).name="GraphError";i.response=c;i.status=p;i.serverStack=l;i.request=h;i.error=t;return i}return t})(n(49).e);function s(e){var t={};t.errorMessage=e.message;if(o(e)){t.vroomStatus=e.status;var n=e.response;if(n&&n.error){var r=n.error;t.vroomErrorCode=r.code;t.vroomErrorMessage=r.message;var i=r.innerError||r.innererror;if(i){t.vroomErrorInnerCode=i.code;t.vroomErrorInnerMessage=i.message;t.vroomErrorInnerDebugMessage=i.debugMessage;t.vroomErrorInnerStack=i.stackTrace}}}return t}function o(e){return e instanceof i}function u(e){return(function(e,t){if(o(e)){return a(e.response,e.status,function(n){return t(n,e)})}})(e,function(e){return"".concat(e)})||"unhandled"}function a(e,t,n){if(e){for(var r=[],i=e.error;i;){r.push(i);i=i.innerError||i.innererror}for(;i=r.pop();)if(void 0!==i.code){var s=n(i.code);if(void 0!==s)return s}}return n(t)}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e.success="success";e.error="error";e.inProgress="inProgress";e.closed="closed"})(r||(r={}))},,,function(e,t,n){"use strict";var r=n(41);function i(){}function s(e){r.e.log(e)}var o=(function(){function e(e,t){void 0===t&&(t=s);this._isDisposed=!1;this._parent=e||null;this._onErrorHandler=t;this._timeoutIds=null;this._immediateIds=null;this._animationFrameIds=null;this._intervalIds=null}e.prototype.dispose=function(){if(!this._isDisposed){this._isDisposed=!0;this._parent=null;if(this._timeoutIds){for(var e=0,t=Object.keys(this._timeoutIds);e<t.length;e++){var n=t[e];this.clearTimeout(Number(n))}this._timeoutIds=null}if(this._immediateIds){for(var r=0,i=Object.keys(this._immediateIds);r<i.length;r++){n=i[r];this.clearImmediate(Number(n))}this._immediateIds=null}if(this._intervalIds){for(var s=0,o=Object.keys(this._intervalIds);s<o.length;s++){n=o[s];this.clearInterval(Number(n))}this._intervalIds=null}if(this._animationFrameIds){for(var u=0,a=Object.keys(this._animationFrameIds);u<a.length;u++){n=a[u];this.cancelAnimationFrame(Number(n))}this._animationFrameIds=null}}};e.prototype.setTimeout=function(e,t){var n=this,r=0;if(!this._isDisposed){var i=this._timeoutIds||(this._timeoutIds={}),s=this._parent;r=setTimeout(function(){try{delete i[r];e.apply(s)}catch(e){n._logError(e)}},t);i[r]=!0}return r};e.prototype.clearTimeout=function(e){var t=this._timeoutIds;if(t&&t[e]){clearTimeout(e);delete t[e]}};e.prototype.setImmediate=function(e){var t=this,n=0;if(!this._isDisposed){var r=this._immediateIds||(this._immediateIds={}),i=this._parent,s=function(){try{delete r[n];e.apply(i)}catch(e){t._logError(e)}};n=window.setImmediate?window.setImmediate(s):window.setTimeout(s,0);r[n]=!0}return n};e.prototype.clearImmediate=function(e){var t=this._immediateIds;if(t&&t[e]){window.clearImmediate?window.clearImmediate(e):window.clearTimeout(e);delete t[e]}};e.prototype.setInterval=function(e,t){var n=this,r=0;if(!this._isDisposed){this._intervalIds||(this._intervalIds={});var i=this._parent;r=setInterval(function(){try{e.apply(i)}catch(e){n._logError(e)}},t);this._intervalIds[r]=!0}return r};e.prototype.clearInterval=function(e){if(this._intervalIds&&this._intervalIds[e]){clearInterval(e);delete this._intervalIds[e]}};e.prototype.throttle=function(e,t,n){var r=this;void 0===n&&(n={});if(this._isDisposed)return i;var s,o,u=t||0,a=n.leading,f=void 0===a||a,l=n.trailing,c=void 0===l||l,h=0,p=null,d=this._parent,v=function(t){var n=(new Date).getTime(),i=n-h,a=f?u-i:u;if(i>=u&&(!t||f)){h=n;if(p){r.clearTimeout(p);p=null}s=e.apply(d,o)}else null===p&&c&&(p=r.setTimeout(v,a));return s};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o=e;return v(!0)}};e.prototype.debounce=function(e,t,n){var r=this;void 0===n&&(n={});if(this._isDisposed)return i;var s,o,u=t||0,a=n.leading,f=void 0!==a&&a,l=n.trailing,c=void 0===l||l,h=n.maxWait,p=void 0===h?NaN:h,d=0,v=(new Date).getTime(),m=null,g=this._parent,y=function(t){var n=(new Date).getTime(),i=!1;if(t){f&&n-d>=u&&(i=!0);d=n}var a=n-d,l=u-a,h=n-v,b=!1;isNaN(p)||(h>=p&&m?b=!0:l=Math.min(l,p-h));if(a>=u||b||i){if(m){r.clearTimeout(m);m=null}v=n;s=e.apply(g,o)}else null!==m&&t||!c||(m=r.setTimeout(y,l));return s};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o=e;return y(!0)}};e.prototype.requestAnimationFrame=function(e){var t=this,n=0;if(!this._isDisposed){var r=this._animationFrameIds||(this._animationFrameIds={}),i=this._parent,s=function(){try{delete r[n];e.apply(i)}catch(e){t._logError(e)}};n=window.requestAnimationFrame?window.requestAnimationFrame(s):window.setTimeout(s,0);r[n]=!0}return n};e.prototype.cancelAnimationFrame=function(e){var t=this._animationFrameIds;if(t&&t[e]){window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.clearTimeout(e);delete t[e]}};e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)};return e})();t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.unknown=0]="unknown";e[e.file=1]="file";e[e.folder=2]="folder";e[e.item=3]="item";e[e.list=4]="list";e[e.web=5]="web";e[e.max=6]="max"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(6);function s(e){var t=e||void 0;return Object(r.e)(Object(r.e)({error:e&&(e.message||e.name),resultCode:t&&o(t)||e&&e.name||"Unknown"},t?Object(r.e)({},"boolean"==typeof t.isExpected?{resultType:t.isExpected?i.t.ExpectedFailure:i.t.Failure}:{resultType:i.t.Failure}):{resultType:i.t.Success}),{extraData:Object(r.e)({stack:e&&e.stack},t?Object(r.e)(Object(r.e)(Object(r.e)({},"object"==typeof t.innerError?{innerError:s(t.innerError)}:{}),"string"==typeof t.correlationId?{correlationId:t.correlationId}:{}),"object"==typeof t.extraData?Object(r.e)({},t.extraData):{}):{})})}function o(e){var t=[];"object"==typeof e.extraData&&e.extraData&&void 0!==e.extraData.status&&t.push("[".concat(e.extraData.status,"]"));"string"==typeof e.code&&t.push("".concat(e.code));return t.join(" ")}},,,function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"r",function(){return i});n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=3e5,i=864e5,s="odsp-ds-",o={useCacheAndUpdateInTheBackground:0,useCacheIfNotExpired:1,onlyCache:2,bypassCache:3,useCacheAndNoUpdate:4}},,function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.fullPageLoad=4]="fullPageLoad";e[e.onePageAppNavigation=5]="onePageAppNavigation"})(r||(r={}));t.e=r},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"r",function(){return i});n.d(t,"n",function(){return s});n.d(t,"t",function(){return o});var r="role:1073741827",i="role:1073741826",s="role:1073741829",o="role:1073741830"},,function(e,t,n){"use strict";var r;(function(e){e[e.File=0]="File";e[e.Folder=1]="Folder";e[e.Media=2]="Media";e[e.OneNote=3]="OneNote";e[e.Unknown=4]="Unknown";e[e.Error=5]="Error";e[e.App=6]="App";e[e.Subsite=7]="Subsite";e[e.Shortcut=8]="Shortcut";e[e.Album=9]="Album";e[e.MultiShare=10]="MultiShare"})(r||(r={}));t.e=r},function(e,t,n){"use strict";n.d(t,"n",function(){return a});n.d(t,"t",function(){return f});n.d(t,"e",function(){return l});var r=n(152),i=n(61),s=n(4),o=Object(i.e)({eventName:"ExperimentFlight,",shortEventName:"ExperimentFlight"},{experimentId:{isPrefixingDisabled:!0,type:s.e.Number},variant:{isPrefixingDisabled:!0,type:s.e.Number},isAATest:{isPrefixingDisabled:!0,type:s.e.Boolean},isOverride:{isPrefixingDisabled:!0,type:s.e.Boolean},isLoggedAtExposure:{isPrefixingDisabled:!0,type:s.e.Boolean},serverTime:{isPrefixingDisabled:!0,type:s.e.String}}),u=(function(){function e(t,n,i){var s;this._isAATest=!1;this._isOverride=!1;this._serverTime="";this._shouldLogVariantPropertyAccess=!1;this._loggedPropertyAccess=!1;this._loggedExposure=!1;this._variantToDisplay=0;this._experimentId=t;this._shouldLogVariantPropertyAccess=i;this._serverTime=null!==(s=null==n?void 0:n.serverTime)&&void 0!==s?s:"";if(window&&window.location&&window.location.search){var o=Object(r.e)(window.location.search.substr(1)).expOverrides;if(o){var u=void 0;try{u=JSON.parse(o)}catch(e){u=[]}for(var a=0,f=u;a<f.length;a++){var l=f[a];if(l&&2===l.length&&l[0]===t){this._setProperties(l[1],l[1],!1,!0);return}}}}if(!n||void 0===n.experimentData||void 0===n.experimentDataLookup||void 0===n.serverTime||this._experimentId<9e4){this._variantToDisplay=0;this._variantToLog=void 0}else{var c=t-9e4,h=e._decodeAt(n.experimentData,c);if(0===h)this._setProperties(0,void 0,!1,!1);else if(h>=1&&h<=4)this._setProperties(h-1,h-1,!1,!1);else if(5===h){var p=e._lookup(n.experimentDataLookup,c);this._setProperties(p,p,!1,!1)}else if(h>=6&&h<=9)this._setProperties(0,h-6,!0,!1);else if(10===h)this._setProperties(0,e._lookup(n.experimentDataLookup,c),!0,!1);else if(h>=11&&h<=14)this._setProperties(h-11,h-11,!1,!0);else{p=e._lookup(n.experimentDataLookup,c);this._setProperties(p,p,!1,!0)}this._saveExperiments()}}Object.defineProperty(e.prototype,"variantToDisplay",{get:function(){this._shouldLogVariantPropertyAccess&&this._logInternal(!1);return this._variantToDisplay},enumerable:!1,configurable:!0});e._decodeAt=function(t,n){if(n>Math.floor(3*t.length/2)-1)return 0;var r=Math.floor(n/3*2);switch(n%3){case 0:return e._ctoi(t[r])>>2;case 1:return(3&e._ctoi(t[r]))<<2|e._ctoi(t[r+1])>>4;case 2:return 15&e._ctoi(t[r])}return 0};e._ctoi=function(e){var t=e.charCodeAt(0);return t>=65&&t<=90?t-65:t>=97&&t<=122?t-71:t>=48&&t<=57?t+4:43===t?62:63};e._lookup=function(e,t){var n=t.toString(36);n=Array(4-n.length).join("0")+n;for(var r=0;r<e.length;r++)for(var i=0;i<e[r].length-2;i+=3)if(e[r].substring(i,i+3)===n)return r+4;return 0};e._getItemFromSessionStorageNoThrow=function(e){try{return sessionStorage.getItem(e)}catch(e){return null}};e._setItemInSessionStorageNoThrow=function(e,t){try{sessionStorage.setItem(e,t)}catch(e){}};e.prototype.logExposure=function(){this._logInternal(!0)};e.prototype._saveExperiments=function(){window.ODSP_EXPERIMENTS=window.ODSP_EXPERIMENTS||{};window.ODSP_EXPERIMENTS[this._experimentId]=this};e.prototype._logInternal=function(t){var n=void 0!==this._variantToLog&&(t&&!this._loggedExposure||!t&&!this._loggedPropertyAccess),r=null,i=null;if(n){r=e._getItemFromSessionStorageNoThrow("experimentLogCacheTime");i=e._getItemFromSessionStorageNoThrow("experimentLogCache");n=r!==this._serverTime||!i||-1===i.indexOf(this._experimentId.toString()+t)}if(n&&void 0!==this._variantToLog){var s={experimentId:this._experimentId,variant:this._variantToLog,isAATest:this._isAATest,isOverride:this._isOverride,isLoggedAtExposure:t,serverTime:this._serverTime};o.logData(s);t?this._loggedExposure=!0:this._loggedPropertyAccess=!0;if(r===this._serverTime)e._setItemInSessionStorageNoThrow("experimentLogCache",(null!=i?i:"")+this._experimentId.toString()+t);else{e._setItemInSessionStorageNoThrow("experimentLogCacheTime",this._serverTime);e._setItemInSessionStorageNoThrow("experimentLogCache",this._experimentId.toString()+t)}}};e.prototype._setProperties=function(e,t,n,r){this._variantToDisplay=e;this._variantToLog=t;this._isAATest=n;this._isOverride=r};return e})();function a(e,t){var n=new u(e,t,!1);n.logExposure();return n.variantToDisplay}function f(e,t){return new u(e,t,!0)}function l(e,t){return new u(e,t,!1).variantToDisplay}},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(123),s=n(152),o=(function(e){Object(r.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t})(i.n),u=(function(e){Object(r.r)(t,e);function t(t,n){var r=n.itemUrlPartsType,i=void 0===r?o:r;return e.call(this,{context:n.pageContext,itemUrlPartsType:i})||this}t.prototype.getUrlParts=function(t){return e.prototype.getUrlParts.call(this,t)};t.prototype.getItemUrlParts=function(e){var t=Object(s.e)(e);return this.getUrlParts({path:t.id,listUrl:t.listurl})};return t})(i.t)},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n("react-lib");function i(e){var t=r.useRef(e);t.current=e;var n=r.useRef();return n.current||(n.current=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=t.current;return r.apply(null,e)})}},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(123),s=n(187),o=(function(e){Object(r.r)(t,e);function t(t,n){var r=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;r._pageContext=n.pageContext;r._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl;r._itemUrlHelper=n.itemUrlHelper;return r}t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))};t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,r=e.fullItemUrl,s=this;(n||t===i.r.crossSite)&&(s=s.method("SP.RemoteWeb",r));return s.segment("web")};t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)};t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})};return t})(s.e),u=(function(e){Object(r.r)(t,e);function t(t,n){var i=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,s=n.itemUrlHelper,u=n.pageContext,a=n.encodeWebAbsoluteUrl,f=n.apiUrlType,l=void 0===f?(function(e){Object(r.r)(t,e);function t(){return e.call(this,{},{itemUrlHelper:s,pageContext:u,encodeWebAbsoluteUrl:a})||this}return t})(o):f;i._apiUrlType=l;return i}t.prototype.build=function(){return new this._apiUrlType};return t})(s.t)},function(e,t,n){"use strict";n.r(t);n.d(t,"UserPhotoSize",function(){return s});n.d(t,"tryGetAlternativeUrl",function(){return a});n.d(t,"isAlterantiveUrlFresh",function(){return f});n.d(t,"updateMap",function(){return l});n.d(t,"getUrlTable",function(){return c});n.d(t,"getUserPhotoUrl",function(){return h});n.d(t,"_testGetCDNUrlExpiryFromCache",function(){return p});var r=n(28),i=n(6),s={Small:1,Medium:2,Large:3},o={},u={};function a(e){var t,n;function r(e){if(f(window[e].userPhotoCdnBaseUrl))return window[e].userPhotoCdnBaseUrl;delete window[e].userPhotoCdnBaseUrl;return""}try{var s=o&&o[e];s||"UserPhotoAspx"!==e||((null===(t=window._spPageContextInfo)||void 0===t?void 0:t.userPhotoCdnBaseUrl)?s=r("_spPageContextInfo"):(null===(n=window._spHomePageContext)||void 0===n?void 0:n.userPhotoCdnBaseUrl)&&(s=r("_spHomePageContext")));if(!s)return;if(!f(s)){delete o[e];return}return s}catch(e){new i.e({name:"TryGetAlternativeUrlFailure"}).end({resultType:i.t.Failure,resultCode:"Unexpected",extraData:{error:e}})}}function f(e){if(-1===e.indexOf("_oat_"))return!0;var t=u[e];if(t)return Date.now()/1e3<t;var n=new r.e(e),s=n.getQueryParameter("_oat_");if(s){var o=s.split("_");2===o.length&&(t=Number(o[0]));if(!t){new i.e({name:"TryGetAlternativeUrlFailure"}).end({resultType:i.t.Failure,resultCode:"OatParamUnexpectedFormat",extraData:{eatParam:s}});u[e]=Date.now()/1e3+86400;return!0}t-=30;u[e]=t;if(Date.now()/1e3>t)return!1}var a=n.getQueryParameter("P1");if(!a)return!0;var f=Number(a);f-=30;u[e]=Math.min(f,u[e]);return!(Date.now()/1e3>f)}function l(e){if(e)for(var t in e)o[t]=e[t]}function c(){return o}function h(e,t,n){n=n||a("UserPhotoAspx")||"/_layouts/15/userphoto.aspx";var i;switch(t){case s.Medium:i="M";break;case s.Large:i="L";break;default:i="S"}var o=new r.e(n);o.setQueryParameter("size",i);o.setQueryParameter("accountname",e||"");return o.toString()}function p(e){return u[e]}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.invalid=-1]="invalid";e[e.teamSite=1]="teamSite";e[e.meetings=2]="meetings";e[e.centralAdmin=3]="centralAdmin";e[e.wiki=4]="wiki";e[e.documentCenter=7]="documentCenter";e[e.blog=9]="blog";e[e.tenantAdmin=16]="tenantAdmin";e[e.app=17]="app";e[e.appCatalog=18]="appCatalog";e[e.mySite=21]="mySite";e[e.subgroup=39]="subgroup";e[e.publishingPortal=52]="publishingPortal";e[e.mySiteHost=54]="mySiteHost";e[e.enterpriseWiki=56]="enterpriseWiki";e[e.group=64]="group";e[e.pointPublishingPersonal=66]="pointPublishingPersonal";e[e.sitePagePublishing=68]="sitePagePublishing";e[e.teamChannel=69]="teamChannel";e[e.projectWebAppSite=6221]="projectWebAppSite";e[e.contentCenter=6001]="contentCenter"})(r||(r={}));for(var i={},s=0,o=Object.keys(r);s<o.length;s++){var u=o[s];"string"==typeof u&&(i[u.toUpperCase()]=r[u])}t.t=r},,function(e,t,n){"use strict";var r;(function(e){e[e.none=1]="none";e[e.available=2]="available";e[e.other=3]="other"})(r||(r={}));t.e=r},function(e,t,n){"use strict";var r;(function(e){e[e.unavailable=-1]="unavailable";e[e.none=0]="none";e[e.disabled=1]="disabled";e[e.notShareableByLink=2]="notShareableByLink";e[e.parentListIsPrivate=3]="parentListIsPrivate";e[e.parentListIsCatalogDocLib=4]="parentListIsCatalogDocLib";e[e.notSupportedByWopi=5]="notSupportedByWopi";e[e.irmIsEnabled=6]="irmIsEnabled";e[e.documentIsProtectedByDlp=7]="documentIsProtectedByDlp";e[e.forceCheckoutEditLink=8]="forceCheckoutEditLink";e[e.anonymousEditLinkNotAllowedByTenant=9]="anonymousEditLinkNotAllowedByTenant";e[e.nonClaimsWebapp=10]="nonClaimsWebapp";e[e.accessDeniedToAnonGuest=11]="accessDeniedToAnonGuest";e[e.blockedByWhoCanShareSettings=12]="blockedByWhoCanShareSettings";e[e.blockedByExternalShareSettings=13]="blockedByExternalShareSettings";e[e.accessDeniedNotEnoughPermissions=14]="accessDeniedNotEnoughPermissions";e[e.sharingBlockedByVirusCheckStatus=40]="sharingBlockedByVirusCheckStatus";e[e.loopFilesExternalSharingNotSupported=43]="loopFilesExternalSharingNotSupported"})(r||(r={}));t.e=r},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});n.d(t,"r",function(){return s});n.d(t,"i",function(){return o});n.d(t,"s",function(){return u});var r,i;(function(e){e[e.invalidType=-1]="invalidType";e[e.noListTemplate=0]="noListTemplate";e[e.genericList=100]="genericList";e[e.documentLibrary=101]="documentLibrary";e[e.survey=102]="survey";e[e.links=103]="links";e[e.announcements=104]="announcements";e[e.contacts=105]="contacts";e[e.events=106]="events";e[e.tasks=107]="tasks";e[e.pictureLibrary=109]="pictureLibrary";e[e.webTemplateCatalog=111]="webTemplateCatalog";e[e.webPartCatalog=113]="webPartCatalog";e[e.listTemplateCatalog=114]="listTemplateCatalog";e[e.xmlFormLibrary=115]="xmlFormLibrary";e[e.masterPageCatalog=116]="masterPageCatalog";e[e.webPageLibrary=119]="webPageLibrary";e[e.customGrid=120]="customGrid";e[e.solutionCatalog=121]="solutionCatalog";e[e.themeCatalog=123]="themeCatalog";e[e.designCatalog=124]="designCatalog";e[e.appDataCatalog=125]="appDataCatalog";e[e.ganttTasks=150]="ganttTasks";e[e.promotedLinks=170]="promotedLinks";e[e.tasksWithTimelineAndHierarchy=171]="tasksWithTimelineAndHierarchy";e[e.meetings=200]="meetings";e[e.externalList=600]="externalList";e[e.mySiteDocumentLibrary=700]="mySiteDocumentLibrary";e[e.publishingPageLibrary=850]="publishingPageLibrary";e[e.publishingAsset=851]="publishingAsset";e[e.issueTracking=1100]="issueTracking";e[e.contentCenterModelLibrary=1328]="contentCenterModelLibrary";e[e.contentCenterPrimeLibrary=1329]="contentCenterPrimeLibrary";e[e.contentCenterSampleLibrary=1330]="contentCenterSampleLibrary";e[e.contentCenterModelUsageList=1331]="contentCenterModelUsageList";e[e.contentCenterExplanationList=1332]="contentCenterExplanationList";e[e.corporateCatalog=330]="corporateCatalog";e[e.siteCollectionCorporateCatalog=336]="siteCollectionCorporateCatalog"})(r||(r={}));(function(e){e[e.invalidType=-1]="invalidType";e[e.GenericList=0]="GenericList";e[e.DocumentLibrary=1]="DocumentLibrary"})(i||(i={}));r.mySiteDocumentLibrary,r.documentLibrary,r.pictureLibrary,r.xmlFormLibrary,r.webPageLibrary,r.publishingPageLibrary,r.publishingAsset;r.documentLibrary,r.contentCenterPrimeLibrary;function s(e){return Number(e)===i.DocumentLibrary}function o(e){return e===r.genericList||e===r.announcements||e===r.issueTracking||e===r.contacts||e===r.customGrid}function u(e){return Number(e)===r.promotedLinks}t.n=r},function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.attached=function(e){var t=this,n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.attach(e.apply(this,n)||this)};n.prototype=e.prototype;return n};return t})(n(69).e);t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return C});var r=n(0),i=n(95),s=n(102),o=n(61),u=n(4),a=Object(o.e)({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:u.e.String,dictionary:u.e.Object,privacyClassification:{isPrefixingDisabled:!0,type:u.e.String}}).withData({privacyClassification:u.t.requiredService}),f=n(157),l=n(47),c=n(9);var h,p="undefined"==typeof window?self:window;(function(e){e[e.xhr=0]="xhr";e[e.fetch=1]="fetch"})(h||(h={}));var d,v,m=(function(){function e(){this._requestIdGenerator=(e=0,function(){return(e++).toString()});var e}e.prototype.instrument=function(e){var t=this;if(!p.__RUMOneAPITrackerInstrumented){p.__RUMOneAPITrackerInstrumented=!0;var n=e.fetch,r=e.xhr;if("XMLHttpRequest"in p&&"undefined"!=typeof XMLHttpRequest){this._originalXhrSend=XMLHttpRequest.prototype.send;this._originalXhrOpen=XMLHttpRequest.prototype.open;var i=this;XMLHttpRequest.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.requestUrl=e[1];return i._originalXhrOpen.apply(this,e)};XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var s=i._requestIdGenerator();r.onRequest({request:this,id:s,type:h.xhr});this.addEventListener("readystatechange",function(){4===e.readyState&&r.onResponse({request:e,id:s,type:h.xhr})});return i._originalXhrSend.apply(this,t)}}if("fetch"in p&&void 0!==p.fetch){this._originalFetch=p.fetch.bind(p);p.fetch=function(e,r){return new Promise(function(i,s){var o=t._requestIdGenerator();n.onRequest({request:e,id:o,type:h.fetch});t._originalFetch(e,r).then(function(e){n.onResponse({response:e,id:o,type:h.fetch});i(e)},function(e){s(e)})})}}}};e.prototype.undoInstrument=function(){p.__RUMOneAPITrackerInstrumented=!1;this._originalXhrOpen&&(XMLHttpRequest.prototype.open=this._originalXhrOpen);this._originalXhrSend&&(XMLHttpRequest.prototype.send=this._originalXhrSend);this._originalFetch&&(p.fetch=this._originalFetch)};return e})(),g=n(28),y=n(20);n(315);(function(e){e[e.own=0]="own";e[e.cors=1]="cors"})(v||(v={}));var b,w=function(e,t,n,r,i,s,o){this.url=e;this.duration=t;this.correlationId=n;this.status=r;this.startTime=i;this.endTime=s;this.name=o;this.clientDurationInMilliseconds=new Date(s).getTime()-new Date(i).getTime();this.origin=e&&new g.e(e).getHost()};(function(e){e[e.Incomplete=1]="Incomplete";e[e.ReadyToUpload=2]="ReadyToUpload";e[e.Uploaded=3]="Uploaded";e[e.TimeOut=4]="TimeOut";e[e.Skipped=5]="Skipped"})(b||(b={}));var E=["EUPL","ScenarioId"],S=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,x=/(?:\/api\/|\/_api\/)(.*?)(?:\(|\?|sharePoint\:|$)/;function T(e){return null==e}var N={checkInterval:100,error_timeout:3e4,max_markers:200},C=(function(){function e(e,t,n){void 0===n&&(n=N);var r=this;this._keyMetrics=E.slice(0);this.async=new i.e(this);this.dataStartTime=Date.now();this._rumoneData={};this.dataState=b.Incomplete;this.controls=[];this.apis=[];this._apiBuffer={};this._loggingFunctions=[];this.euplBreakDown={};this.ttiBreakDown={};this.serverMetrics={};this.isW3cTimingCollected=!1;this._isW3cResourceTimingCollected={};this.tempData={};this._settings={};this._emergencyUpdateFunc=this._emergencyUpload.bind(this);this.undoAPIInstrument=function(){r._apiTracker.undoInstrument()};this._name=e;this.registerLoggingFunc(t);this._config=n;this.setPerfDataTimer();this._platformDetection=new f.e;this._hookUnloadEvent();this._apiTracker=new m}e.getRUMOneLogger=function(t,n,r){void 0===t&&(t="__default_rumone__");void 0===r&&(r=N);var i=n||function(e,t){a.logData({streamName:e,dictionary:t})};if(!e.Loggers[t])try{var s=new e(t,i,r);"__default_rumone__"===t&&(e.rumOneLogger=s);e.Loggers[t]=s}catch(e){}return e.Loggers[t]};e.prototype.registerLoggingFunc=function(e){var t=this,n=this._loggingFunctions.indexOf(e);n<0&&this._loggingFunctions.push(e);return function(){n>=0&&t._loggingFunctions.splice(n,1)}};Object.defineProperty(e.prototype,"KeyMetrics",{get:function(){this._TTIMeasurementEnabled()&&this.addExpectedKeyMetric("TTI");this._FCIMeasurementEnabled()&&this.addExpectedKeyMetric("FCI");return this._keyMetrics},enumerable:!1,configurable:!0});e.prototype.getPerformanceData=function(){return this._rumoneData};e.prototype.startAPIMeasurement=function(e){var t=this,n=e&&e.ignore||function(e){return!1},i=e&&e.getAPIName||function(e){},s=function(e){var n=e.id,r=e.request,i=e.type,s=new w;s.startTime=(new Date).toISOString();s.startTimeRelative=t.now();i===h.fetch&&(s.url="string"==typeof r?r:r.url);t._apiBuffer[n]=s};this._apiTracker.instrument({fetch:{onRequest:s,onResponse:function(e){var s=e.response,o=e.id,u=t._apiBuffer[o];if(u&&!n(u.url)){var a=void 0,f=void 0;try{a=s.headers.get("SPClientServiceRequestDuration");f=s.headers.get("SPSQLQueryCount")}catch(e){}var l=void 0;try{l=s.headers.get("SPRequestGuid")}catch(e){}u.name=i(u.url);u=Object(r.e)(Object(r.e)({},u),Object(r.e)(Object(r.e)(Object(r.e)({endTime:(new Date).toISOString(),endTimeRelative:t.now(),clientDurationInMilliseconds:t.now()-u.startTimeRelative,status:s.status},a?{duration:Number(a)}:{}),f?{sqlRT:Number(f)}:{}),l?{correlationId:l}:{}));t.apis.push(u)}}},xhr:{onRequest:s,onResponse:function(e){var s,o,u=e.request,a=e.id,f=t._apiBuffer[a],l=u.responseURL||u.requestUrl;if(f&&!n(l)){var c=null!==(o=null===(s=u.getAllResponseHeaders())||void 0===s?void 0:s.toLowerCase())&&void 0!==o?o:"",h=c.indexOf("spclientservicerequestduration:")>=0&&u.getResponseHeader("SPClientServiceRequestDuration"),p=c.indexOf("spsqlquerycount:")>=0&&u.getResponseHeader("SPSQLQueryCount"),d=c.indexOf("sprequestguid:")>=0&&u.getResponseHeader("SPRequestGuid");f.name=i(l);f=Object(r.e)(Object(r.e)({},f),Object(r.e)(Object(r.e)(Object(r.e)(Object(r.e)({endTime:(new Date).toISOString(),endTimeRelative:t.now(),clientDurationInMilliseconds:t.now()-f.startTimeRelative,status:u.status},h?{duration:Number(h)}:{}),p?{sqlRT:Number(p)}:{}),d?{correlationId:d}:{}),{url:l}));t.apis.push(f)}}}});return function(){t._apiTracker.undoInstrument()}};e.prototype.resetLogger=function(){this._emergencyUpload();this._apiBuffer={};this.dataStartTime=(new Date).getTime();this.dataState=b.Incomplete;this.isW3cTimingCollected=!1;this._isW3cResourceTimingCollected={};this.controls=[];this.apis=[];this.tempData={};this._rumoneData={};this._settings={};this._keyMetrics=E.slice(0);this.clearPerfDataTimer();this.setPerfDataTimer();this.euplBreakDown={};this.ttiBreakDown={};this.serverMetrics={};this.clearResourceTimings();Object(l.n)(this._getOwnMakers().map(function(e){return e.name}));e._markers[this._name]=[];this._unhookUnloadEvent();this._hookUnloadEvent();this._ttiPromise=void 0;this._fciPromise=void 0;this.logMessageInConsole("Reset performance Logger Done")};e.prototype.setSettings=function(e){this._settings=Object(r.e)(Object(r.e)({},this._settings),e)};e.prototype.excludePageForPerfData=function(){this.setSettings({excludePageData:!0})};e.prototype.getPerformanceDataPropertyValue=function(e){return e&&this._rumoneData[e]};e.prototype.setPerformanceDataPropertyValue=function(e,t){if(e&&S.test(e)){this._rumoneData[e]=t;return!0}console.error("key ".concat(e," does not confrim to the Regex ").concat(S));return!1};e.prototype.addExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)?this.controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=t.ignoreForEUPL:this.controls.push(t)};e.prototype.ignoreExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)&&(this.controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=!0)};e.prototype.expectingControl=function(e){var t=this._normalizeControl(e);return this.controls.filter(function(e){return e.controlId===t.controlId}).length>0};e.prototype.writeServerCorrelationId=function(e){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||e};e.prototype.writeServerUrl=function(){this._rumoneData.ServerUrl=this._processEUIIUrl(location.href)};e.prototype.writeServerSideLatency=function(e,t){if(!this.isCollected("ServerRequestDuration")){this._rumoneData.ServerRequestDuration=e;this._rumoneData.IISLatency=t}};e.prototype.writeControlPerformanceData=function(e){if(e){var t=this.controls.filter(function(t){return t.controlId===e.controlId})[0];if(t)t.data||(t.data=e);else{var n={controlId:e.controlId,data:e,ignoreForEUPL:e.ignoreForEUPL};this.controls.push(n)}}};e.prototype.writeAPICallPerformanceData=function(e){e&&this.apis.push(e)};e.prototype.readAPICallPerformanceData=function(){return this.apis};e.prototype.writeAppCache=function(e){this.isCollected("AppCache")||(this._rumoneData.AppCache=e)};e.prototype.writePageTransitionType=function(e,t){this.isCollected("PageTransitionType")&&!t||e!==s.e.fullPageLoad&&e!==s.e.none&&e!==s.e.onePageAppNavigation||(this._rumoneData.PageTransitionType=e)};e.prototype.writeScenarioId=function(e,t){this.isCollected("ScenarioId")&&!t||(this._rumoneData.ScenarioId=e)};e.prototype.collectW3CPerfTimings=function(){if(!this.isW3cTimingCollected){var e=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"],t=performance&&performance.timing;if(t){for(var n=0;n<e.length;n++){var r=t[e[n]];r&&this._logRUMOneData(this.getW3cTimingName(e[n]),Number(r))}this.isW3cTimingCollected=!0}}};e.prototype.collectW3cResourceTimings=function(t){void 0===t&&(t=void 0);var n=t||{},i=n.logSummery,s=void 0===i||i,o=n.start,u=void 0===o?0:o,a=n.end,f=void 0===a?Math.round(this.now()):a,l=n.columnNameOverride,c=void 0===l?function(e){return e}:l,h="logSummery=".concat(s,"|start=").concat(u,"|end=").concat(f,"|columnNameOverride=").concat(c),p=this._isW3cResourceTimingCollected[h];if(window.document&&!p&&performance&&performance.getEntriesByType){for(var d=performance.getEntriesByType("resource"),v=document.getElementsByTagName("iframe"),m=0;m<v.length;m++){var g=null;try{g=v[m].contentWindow.performance}catch(e){}g&&g.getEntriesByType&&d.concat(g.getEntriesByType("resource"))}var y={SharePoint:function(e){return 0===e.name.search(window.location.protocol+"//"+window.location.host)}};y.CDN=e._isRequestFromCDN;y.ThirdParty=function(e){return!y.SharePoint(e)&&!y.CDN(e)};var b={ASPX:function(e){return/\.aspx/i.test(e.name)},JS:function(e){return/script/i.test(e.initiatorType)},CSS:function(e){return/link|css/i.test(e.initiatorType)},IMG:function(e){return/img/i.test(e.initiatorType)}};d=d.filter(function(e){return e.startTime>=u&&e.startTime<=f});var w=Object.keys(y);for(m=0;m<w.length;m++){var E=w[m],S=this.categorizeResourceRequests(d,{from:y[E],requestType:null});s&&this._logRUMOneData(c(E+"RequestCountTotal"),S.length);for(var x=Object.keys(b),T=0;T<x.length;T++){var N=x[T];s&&this._logRUMOneData(c(E+"RequestCount"+N),this.categorizeResourceRequests(S,{from:null,requestType:b[N]}).length)}if(S.length>0){s&&this._logRUMOneData(c(E+"RequestDownloadTime"),Math.round(S.reduce(function(e,t){return e+t.duration},0)/S.length));if("CDN"===E){var C=JSON.stringify(S.map(function(e){return Object(r.e)(Object(r.e)(Object(r.e)(Object(r.e)({name:e.name.split("/").map(function(e){return e.split("?")[0]}).filter(function(e){return e&&e.length>0}).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(e.startTime),duration:Math.round(e.duration),transferSize:e.transferSize||0,fetchStart:Math.round(e.fetchStart),requestStart:Math.round(e.requestStart),connect:Math.round(e.connectEnd-e.connectStart),domainLookup:Math.round(e.domainLookupEnd-e.domainLookupStart),redirect:Math.round(e.redirectEnd-e.redirectStart)},k(e,"workerStart")),k(e,"responseStart")),k(e,"responseEnd")),k(e,"secureConnectionStart"))}));this._logRUMOneData(c(E+"RequestNames"),C)}}}this._isW3cResourceTimingCollected[h]=!0}};e.prototype.saveTempData=function(e,t){this.tempData[e]=t};e.prototype.readTempData=function(e){return this.tempData[e]};e.prototype.writeRenderTime=function(e,t){this.isCollected("RenderTime")&&!t||(this._rumoneData.RenderTime=e)};e.prototype.writePreRenderTime=function(e){this.isCollected("PreRender")||(this._rumoneData.PreRender=e)};e.prototype.writePostRenderTime=function(e){this.isCollected("PostRender")||(this._rumoneData.PostRender=e)};e.prototype.writeDataFetchTime=function(e,t){this.isCollected("DataFetch")&&!t||(this._rumoneData.DataFetch=e)};e.prototype.writeAppInfo=function(e,t){this.isCollected("AppInfo")&&!t||(this._rumoneData.AppInfo=e)};e.prototype.isRunning=function(){return!(this.dataState===b.Uploaded||this.dataState===b.TimeOut||this.dataState===b.Skipped)};e.prototype.writeEUPLBreakdown=function(e,t){return this._writeBreakdown(this.euplBreakDown,e,t)};e.prototype.addEUPLBreakdown=function(e,t,n){return this._addBreakdown(this.euplBreakDown,e,t,n)};e.prototype.readEUPLBreakdown=function(e){return this._readBreakdown(this.euplBreakDown,e)};e.prototype.writeTTIBreakdown=function(e,t){return this._writeBreakdown(this.ttiBreakDown,e,t)};e.prototype.addTTIBreakdown=function(e,t,n){return this._addBreakdown(this.ttiBreakDown,e,t,n)};e.prototype.readTTIBreakdown=function(e){return this._readBreakdown(this.ttiBreakDown,e)};e.prototype.addFlights=function(e){if(e&&e.length>0){for(var t=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]"),n=0;n<e.length;n++){var r=e[n];r&&-1===t.indexOf(r)&&t.push(r)}this._rumoneData.Flights=JSON.stringify(t)}};e.prototype.collectSPClientFlights=function(e){for(var t="",n=0,r=e.ExpFeatures;n<r.length;n++){var i=r[n];t+=this._numberToBinString(i).split("").reverse().join("")}this._rumoneData.Flights=t};e.prototype.collectODCClientRamps=function(e,t){for(var n=e.Ramps,r=void 0===n?{}:n,i=[],s=0,o=t;s<o.length;s++){var u=o[s];u.ODC&&"boolean"!=typeof u.ODC&&r[u.ODC]&&i.push(u.ODC)}this._rumoneData.Flights=JSON.stringify(i)};e.prototype.addServerMetrics=function(e,t){if(e)for(var n in e)n&&!T(e[n])&&(T(this.serverMetrics[n])||t)&&(this.serverMetrics[n]=e[n])};e.prototype.writeServerVersion=function(e){this._rumoneData.SharePointServerVersion=e};e.prototype.readControlPerformanceData=function(){return this.controls.filter(function(e){return!!e.data}).map(function(e){return e.data})};e.prototype.mark=function(t){(e._markers[this._name]=e._markers[this._name]||[]).push(t);Object(l.s)(t)};e.prototype.now=function(){return performance&&performance.now?Math.round(performance.now()):NaN};e.prototype.registerEUPLComputedHandler=function(e){this._EUPLComputedHandler=e};e.prototype.registerErrorHandler=function(e){};e.prototype.getMarkerTime=function(e){return Object(l.i)(e)};e.prototype.addExpectedKeyMetric=function(e){this._keyMetrics&&-1===this._keyMetrics.indexOf(e)&&this._keyMetrics.push(e)};Object.defineProperty(e.prototype,"waitOnAddingExpectedControl",{set:function(e){this.setSettings({waitOnAddingExpectedControl:e})},enumerable:!1,configurable:!0});e._isRequestFromCDN=function(e){var t=window._spPageContextInfo,n=e.name;return!(!t||!t.cdnPrefix||0!==n.search(window.location.protocol+"//"+t.cdnPrefix))||(!(!t||!t.cdnBaseUrl||0!==n.search(t.cdnBaseUrl))||/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net|akamai\.odsp\.cdn\.office\.net/i.test(n))};e.prototype._measureTTI=function(){var e=this;this._rumoneData.TTISupported="PerformanceLongTaskTiming"in window;if(this._TTIMeasurementEnabled()&&!this._ttiPromise){this._ttiPromise=(function(e){return Object(r.t)(this,void 0,void 0,function(){var t;return Object(r.i)(this,function(i){switch(i.label){case 0:t=Object(r.e)({minValue:Math.round(window.performance&&performance.now?Math.round(performance.now()):Date.now()),useMutationObserver:!1,trackNetworkRequests:!1,requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3},e);return[4,n.ee(5,404)];case 1:return[2,i.sent().getFirstConsistentlyInteractive(t).then(function(e){return Object(r.e)(Object(r.e)({},e||{}),{options:t})})]}})})})(this._settings.TTISettings.TTIPolyfillSettings.options);this._ttiPromise.then(function(t){var n=t||{},r=n.tti,i=n.longTasks,s=n.options,o=r;if(T(r))r=NaN;else{var u=e._settings.TTISettings.TTIPolyfillSettings.calculateTTI;u&&(r=u(Math.round(r),e._rumoneData,"TTI"))}T(e._rumoneData.TTI)?e.addEUPLBreakdown("currentTTI",{data:JSON.stringify(r),needFlatten:!1}):e.addEUPLBreakdown("prevTTI",{data:JSON.stringify(e._rumoneData.TTI),needFlatten:!1});e._rumoneData.TTI=r;if(i){e._rumoneData.TTILongTasks=JSON.stringify(i);c.t.isActivated("4c338685-350e-4aae-a03e-fb969ab4dc98","02/24/2021")||(e._rumoneData.TTILongTasksPostFMPCount=i.filter(function(t){return t.end>e._rumoneData.EUPL}).length)}e._logLastRequestBeforeTTI(r,i,"TTI");e.collectW3cResourceTimings({logSummery:!1,start:o-(r-e._rumoneData.EUPL),end:o,columnNameOverride:function(e){return"".concat(e,"OfTTI")}});s&&e.addEUPLBreakdown("TTIOptions",{data:JSON.stringify(s),needFlatten:!1});var a=d;if(a){e._rumoneData.CLS=a.cls;e._rumoneData.CLSFullResult=a}})}if(this._FCIMeasurementEnabled()&&!this._fciPromise){if(c.t.isActivated("eff83b08-6883-438b-9f0e-59724a25b7e7","10/27/2021")){this._rumoneData.FCI=NaN;return}var t=this._settings.TTISettings.TTIPolyfillSettings.getAbsoluteEUPL,i=t?t(this._rumoneData.EUPL):this.now();this._fciPromise=(function(e){return Object(r.t)(this,void 0,void 0,function(){var t;return Object(r.i)(this,function(r){switch(r.label){case 0:t={measurementStartTime:e,requiredMainThreadCPUIdleDurationInMilliseconds:1e3};return[4,n.ee(5,779)];case 1:return[2,r.sent().getFirstCPUIdle(t)]}})})})(i);this._fciPromise.then(function(t){var n=t||{},r=n.fci,i=n.longTasks;if(T(r))r=NaN;else{var s=e._settings.TTISettings.TTIPolyfillSettings.calculateTTI;s&&(r=s(Math.round(r),e._rumoneData,"FCI"))}e._rumoneData.FCI=r;if(i){e._rumoneData.FCILongTasks=JSON.stringify(i);c.t.isActivated("4c338685-350e-4aae-a03e-fb969ab4dc98","02/24/2021")||(e._rumoneData.FCILongTasksPostFMPCount=i.filter(function(t){return t.end>e._rumoneData.EUPL}).length)}e._logLastRequestBeforeTTI(r,i,"FCI")})}};e.prototype._logLastRequestBeforeTTI=function(t,n,r){var i=performance.getEntriesByType("resource");if(t&&n&&n.length>0&&i&&i.length>0){for(var s=n[n.length-1].start,o=i[0],u=0,a=i;u<a.length;u++){var f=a[u];f.responseEnd<s&&f.responseEnd>o.responseEnd&&(o=f)}var l=void 0;l=e._isRequestFromCDN(o)?o.name:this._processLastNetworkUrl(o.name);var c=void 0;c=/\.aspx/i.test(o.name)?"ASPX":/\.js/i.test(o.name)?"JS":/\.css/i.test(o.name)?"CSS":/img/i.test(o.initiatorType)||/\.jpg|\.jpeg|\.png|\.gif/i.test(o.name)?"IMG":/aria\.microsoft\.com/i.test(o.name)?"Aria":/_api/i.test(o.name)?"API":"Other";if("TTI"===r){this._rumoneData.TTILastRequestName=l;this._rumoneData.TTILastRequestType=c;this._rumoneData.TTILastRequestStartTime=o.startTime;this._rumoneData.TTILastRequestEndTime=o.responseEnd}else{this._rumoneData.FCILastRequestName=l;this._rumoneData.FCILastRequestType=c;this._rumoneData.FCILastRequestStartTime=o.startTime;this._rumoneData.FCILastRequestEndTime=o.responseEnd}}};e.prototype._numberToBinString=function(e){var t=(e>>>0).toString(2);return"".concat(Array(32-t.length+1).join("0")).concat(t)};e.prototype._logRUMOneData=function(e,t){e&&(this._rumoneData[e]=t)};e.prototype.clearResourceTimings=function(){performance&&performance.clearResourceTimings&&performance.clearResourceTimings()};e.prototype._isBreakdownValue=function(e){return void 0!==e.needFlatten};e.prototype.collectMarks=function(){var e=this,t={},n=0;this._getOwnMakers().forEach(function(r){if(n<e._config.max_markers){var i=r.name.substr(l.t.length)+".mark".concat(n++);t[i]=Math.round(r.startTime)}});this.writeEUPLBreakdown(JSON.stringify(t))};e.prototype._getOwnMakers=function(){var t=this,n=e._markers,r=[].concat.apply([],Object.keys(n).filter(function(e){return n.hasOwnProperty(e)&&e!==t._name}).map(function(e){return n[e]}));return Object(l.r)().filter(function(e){return-1===r.indexOf(e.name)})};e.prototype.logMessageInConsole=function(e){this.isRUMOneDebuggingEnabled&&console.log(e)};Object.defineProperty(e.prototype,"isRUMOneDebuggingEnabled",{get:function(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableRUMOneDebugging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1},enumerable:!1,configurable:!0});e.prototype.logObjectForDebugging=function(e,t){if(this.isRUMOneDebuggingEnabled){var n="".concat(this._name," ").concat(e)+" : "+JSON.stringify(t);console.log(n)}};e.prototype.isCollected=function(e){return!T(this.getPerformanceDataPropertyValue(e))};e.prototype._normalizeControl=function(e){return"string"==typeof e?{controlId:e,ignoreForEUPL:!1}:e};e.prototype.setPerfDataTimer=function(){this.perfDataTimer=this.async.setTimeout(this.loopForDataCompleteness,this._config.checkInterval)};e.prototype.clearPerfDataTimer=function(){if(!T(this.perfDataTimer)){this.async.clearTimeout(this.perfDataTimer);this.perfDataTimer=null}};e.prototype._hookUnloadEvent=function(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc)};e.prototype._unhookUnloadEvent=function(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc)};e.prototype.categorizeResourceRequests=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];t.from&&!t.from(i)||t.requestType&&!t.requestType(i)||n.push(i)}return n};e.prototype._setFCP=function(){var e=NaN,t=performance&&performance.getEntriesByType&&performance.getEntriesByType("paint");if(t&&t.length>0){var n=t.filter(function(e){return"first-contentful-paint"===e.name});if(n&&1===n.length)e=n[0].startTime;else{var r=t.filter(function(e){return"first-paint"===e.name});r&&1===r.length&&(e=r[0].startTime)}}isNaN(e)||(this._rumoneData.FCP=Math.round(e))};e.prototype.collectSupplementaryData=function(){this._setFCP();this.setAPIDataToRUMOne();this.collectMarks();this.writeServerUrl();this.setBrowseInfo();this.setReferrer();this._collectMemoryData();this._collectPageServerData();this._setAppInfo();this._setTestName();this._collectExperiments();this._rumoneData.DOMElements=document&&document.querySelectorAll("*").length;this._rumoneData.ServerMetrics=JSON.stringify(this.serverMetrics);this._rumoneData.EUPLBreakdown=JSON.stringify(this.euplBreakDown);this._rumoneData.TTIBreakdown=JSON.stringify(this.ttiBreakDown);this._normalizeTTI()};e.prototype._normalizeTTI=function(){var e;this._rumoneData.PageTransitionType===s.e.fullPageLoad&&((null===(e=this._rumoneData.ScenarioId)||void 0===e?void 0:e.indexOf("SPPages"))>-1||!c.t.isActivated("c930d25d-de79-434f-ba7b-c2fbf0aa9204","09/01/2022")&&this._rumoneData.ScenarioId.indexOf("VivaHome")>-1)&&(this._rumoneData.TTI=this._rumoneData.FCI||this._rumoneData.TTI)};e.prototype._collectExperiments=function(){var e=window.ODSP_EXPERIMENTS||{},t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];r&&r._serverTime&&Date.now()-new Date(r._serverTime).getTime()<1296e6&&(t[n]=e[n])}this._rumoneData.SPExperiments=JSON.stringify(t)};e.prototype._setTestName=function(){var e=new g.e(location.href).getQueryParameter("perftest");e&&!this._rumoneData.TestName&&(this._rumoneData.TestName=e)};e.prototype.loopForDataCompleteness=function(){this.clearPerfDataTimer();if(!this._settings.waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled){this.logMessageInConsole("====================================================================");this.logObjectForDebugging("RUMONE: ",this._rumoneData);this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this.dataState)));this.logObjectForDebugging("Controls: ",this.controls);this.logObjectForDebugging("API Performance Data: ",this.apis);this.logObjectForDebugging("Temp Data: ",this.tempData);this.logObjectForDebugging("EUPLBreakdown: ",this.euplBreakDown);this.logObjectForDebugging("TTIBreakdown: ",this.ttiBreakDown);this.logObjectForDebugging("ServerMetrics: ",this.serverMetrics);this.logMessageInConsole("====================================================================\n\n")}if(!this.isRunning())return;this._updateState()}this._checkTimeout();this.isRunning()&&this.setPerfDataTimer()};e.prototype._updateState=function(){switch(this.dataState){case b.Incomplete:this.processControlRenderTime();this.readyToComputeEUPL()&&this.setEUPL();var e=this._getMissedControls();this._TTIMeasurementEnabled()&&this.isCollected("EUPL")&&0===e.length&&this._measureTTI();0===this._getMissedKeyMetrics().length&&0===e.length&&(this.dataState=b.ReadyToUpload);break;case b.ReadyToUpload:this._uploadPerfData({emergency:!1})}};e.prototype._checkTimeout=function(){if(this.isRunning()&&this.dataState!==b.ReadyToUpload){var e=Date.now();if(!(this.dataState===b.Incomplete&&e-this.dataStartTime<=this._config.error_timeout)){var t={reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this._getMissedControls()}};this._rumoneData.RUMOneError=JSON.stringify(t);this.dataState=b.TimeOut;this._uploadPerfData({emergency:!1})}}};e.prototype._getMissedKeyMetrics=function(){for(var e=[],t=0;t<this.KeyMetrics.length;t++){T(this.getPerformanceDataPropertyValue(this.KeyMetrics[t]))&&e.push(this.KeyMetrics[t])}return e};e.prototype._getMissedControls=function(){return this.controls.filter(function(e){return!e.data||!e.data.renderTime})};e.prototype._emergencyUpload=function(){this.isRunning()&&this._uploadPerfData({emergency:!0})};e.prototype._uploadPerfData=function(e){this.writeControlDataToRUMOne();this.collectSupplementaryData();var t,n=e.emergency;this._rumoneData.EmergencyUploaded=!!n;try{if(this._settings.excludePageData){this.dataState=b.Skipped;this.logMessageInConsole("Uploading perf data skipped as requested by the consumer")}else if(n||this.dataState===b.ReadyToUpload||this.dataState===b.TimeOut)if(this._loggingFunctions&&this._loggingFunctions.length>0)if(this._rumoneData){var r=this.getPerformanceData();this._loggingFunctions.forEach(function(e){e("RUMOne",r)});this.dataState=b.Uploaded;if(this.isRUMOneDebuggingEnabled){this.logMessageInConsole("Final Data uploaded");this.logObjectForDebugging("RUMONE: ",r);this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this.dataState))}}else console.error("Error: Uploading perf data called but perf data is not available");else console.error("Uploading perf data skipped as loggingFunc is not defined");else console.error("Error: Uploading perf data called with wrong data state ".concat(this.dataState))}catch(e){t="PerformanceLogger error writing RUMOne data: ".concat(e),"undefined"!=typeof console&&Boolean(console)&&console.error(t)}finally{if(!this.isRunning()){this._unhookUnloadEvent();this._apiTracker.undoInstrument()}}};e.prototype._TTIPolyfillEnabled=function(){return!!(this._settings.TTISettings&&this._settings.TTISettings.TTIPolyfillSettings&&this._settings.TTISettings.TTIPolyfillSettings.enabled)};e.prototype._FCIMeasurementEnabled=function(){var e=this._TTIPolyfillEnabled();return c.t.isActivated("CC5234AA-C7A5-4D4A-B6E5-52CC2A4E7078","11/4/2021")?e:!(!e||this._settings.TTISettings.FCIMeasurementSettings&&this._settings.TTISettings.FCIMeasurementSettings.disabled)};e.prototype._TTIMeasurementEnabled=function(){return this._TTIPolyfillEnabled()};e.prototype.getReadableDataState=function(e){for(var t in b)if(e===Number(b[t]))return t;return"NaN"};e.prototype.writeControlDataToRUMOne=function(){if(this.controls&&this.controls.length){var e=this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!e.ignoreForEUPL});e.sort(function(e,t){return t.data.renderTime-e.data.renderTime});for(var t=0;t<10&&t<e.length;t++){this._logRUMOneData("Control".concat(t+1,"Id"),e[t].controlId);this._logRUMOneData("Control".concat(t+1,"RenderTime"),e[t].data.renderTime)}var n={};this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!!e.ignoreForEUPL}).forEach(function(e){n[e.controlId]={data:e.data.renderTime,needFlatten:e.data.needFlatten}});Object.keys(n).length>0&&this.writeEUPLBreakdown(JSON.stringify(n),!0)}};e.prototype.processControlRenderTime=function(){for(var e=0,t=this.controls;e<t.length;e++){var n=t[e];n.data&&!n.data.renderTime&&n.data.renderTimeRequiredDataChecker(n.data)&&(n.data.renderTime=n.data.renderTimeCalculator(n.data))}};e.prototype.readyToComputeEUPL=function(){for(var e=this.controls.filter(function(e){return!e.ignoreForEUPL}),t=e.length>0,n=0,r=e;n<r.length;n++){var i=r[n];if(!i.data||!i.data.renderTime){t=!1;break}}return t};e.prototype.setEUPL=function(){if(!this.isCollected("EUPL")){for(var e=0,t=0,n=this.controls;t<n.length;t++){var r=n[t];!r.ignoreForEUPL&&r.data&&r.data.renderTime&&e<r.data.renderTime&&(e=r.data.renderTime)}this._rumoneData.EUPL=e;"function"==typeof this._EUPLComputedHandler&&this._EUPLComputedHandler(e)}};e.prototype.setBrowseInfo=function(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor;this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile};e.prototype._collectMemoryData=function(){if(!this.isCollected("UsedJSHeapSize")&&"undefined"!=typeof performance&&void 0!==performance.memory){this._rumoneData.UsedJSHeapSize=performance.memory.usedJSHeapSize;this._rumoneData.TotalJSHeapSize=performance.memory.totalJSHeapSize}};e.prototype._collectPageServerData=function(){this.addServerMetrics({cpuDuration:window.g_cpuDuration,duration:window.g_duration,iisLatency:window.g_iisLatency,queryCount:window.g_queryCount,queryDuration:window.g_queryDuration,spPageContextDuration:window.g_pageContextDuration,deferred_cpuDuration:window.g_deferred_cpuDuration,deferred_duration:window.g_deferred_duration,deferred_iisLatency:window.g_deferred_iisLatency,deferred_queryCount:window.g_deferred_queryCount,deferred_queryDuration:window.g_deferred_queryDuration})};e.prototype.setAPIDataToRUMOne=function(){for(var e=0,t=0,n=[],i=0;i<this.apis.length;i++){var s=this.apis[i];if(s){e++;t+=s.duration;s.origin||(s.origin=new g.e(s.url).getHost());s.hostType=new g.e(window.location.href).getHost()===s.origin?v.own:v.cors;s.url;var o=Object(r.s)(s,["url"]);n.push(o)}}this._rumoneData.APICallCount=e;this._rumoneData.APICallDurationSum=t;this._rumoneData.APICalls=JSON.stringify(n)};e.prototype.setReferrer=function(){this._rumoneData.Referrer=this._processEUIIUrl(document.referrer)};e.prototype._setAppInfo=function(){if(!this._rumoneData.AppInfo){var e=window._spModuleLink;if(e){var t=e.buildNumber,n=e.manifestName,r=e.scenarioName,i=JSON.stringify({buildNumber:t,manifestName:n,scenarioName:r});this._rumoneData.AppInfo=i}}};e.prototype.getW3cTimingName=function(e){return"secureConnectionStart"!==e?"W3c"+e.charAt(0).toUpperCase()+e.slice(1):"W3cSecureConnectStart"};e.prototype._writeBreakdown=function(e,t,n){if(t)try{var r=JSON.parse(t);for(var i in r)r.hasOwnProperty(i)&&this._addBreakdown(e,i,r[i],n)}catch(e){this.logMessageInConsole("Failed to write EUPL breakdown data:"+e.toString())}};e.prototype._addBreakdown=function(e,t,n,r){if(t&&!T(n)){if(T(e[t])||r){var i=this._isBreakdownValue(n)?n.data:n;e[t]=i}this._isBreakdownValue(n)&&n.needFlatten&&(!this.isCollected(t)||r)&&this._logRUMOneData(t,n.data)}};e.prototype._readBreakdown=function(e,t){return t?e[t]:e};e.prototype._processEUIIUrl=function(e){var t=new y.e(e||"");return"".concat(t.authority,"/{ length: ").concat(t.path.length,", segments: ").concat(t.segments.length," }")};e.prototype._processLastNetworkUrl=function(e){var t=new y.e(e||"");if(t.authority.indexOf("lpcres")>0)return e;if(t.authority.indexOf("shell.cdn.office")>0)return e;var n=x.exec(e),r="";n&&n.length>0&&(r="".concat(n[0]));return"".concat(t.authority).concat(r)};e.rumOneLogger=void 0;e.Loggers={};e._markers={};return e})();t.t=C;function k(e,t){var n;return t in e?((n={})[t]=Math.round(e[t]),n):{}}},function(e,t,n){"use strict";n.d(t,"e",function(){return $});var r=n(0),i=n(68),s=n(461);var o=n(186),u=n(220),a=n(6),f=n(121),l=n(49),c=n(169),h=n(170),p=n(163),d=n(28),v=n(42),m="MS-CV",g="Retry-After",y="WWW-Authenticate",b="x-ms-diagnostics",w="X-SubStatusCode",E="X-SPO-ErrorCode",S="X-SPO-ErrorMessage",x="X-SPO-ErrorCustomPromptLocation",T="X-MSDAVEXT_Error",N="SPSQLQueryCount",C="SPClientServiceRequestDuration",k="SPGroupThrottle",L="X-ServiceWorkerFetchInfo",A="X-SERVICEWORKER-DATA-SOURCE",O="x-virus-infected";var M=(function(){function e(e,t,n){this._request=e;this._url=t;this._webAbsoluteUrl=n&&n.webAbsoluteUrl;this._isCanaryRequest=n&&n.isCanaryRequest}e.prototype.getSourceUrl=function(){return this._url};e.prototype.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders()};e.prototype.getCorrelationId=function(){return this.getResponseHeader("SPRequestGuid")};e.prototype.getServiceWorkerDataSourceHeader=function(){return this.getResponseHeader(A)};e.prototype.getStatus=function(){var e=-1;try{e=this._request.status}catch(e){}return"number"==typeof e?e:-1};e.prototype.getAuthenticationRedirect=function(){return this.getResponseHeader("X-Forms_Based_Auth_Required")};e.prototype.getResponseType=function(){return this._request.responseType};e.prototype.getResponseText=function(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText};e.prototype.getErrorResponseText=function(){if("blob"===this._request.responseType){return{status:this._request.status,statusText:this._request.statusText,infected:!!this.getResponseHeader(O),authenticate:this.getResponseHeader(y)}}return this.getResponseText()};e.prototype.parseError=function(){var e=this,t=new s.e;this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?(function(e){var t,n=new s.e,r=function(){if(t.result){var e=void 0;try{e=JSON.parse(t.result);n.complete(e)}catch(e){n.complete({message:"Unable to parse blob result."})}}},i=function(){n.complete({message:"Unable to read blob error response."})};try{(t=new FileReader).addEventListener("load",r);t.addEventListener("error",i);t.readAsText(e)}catch(e){i()}return n.getPromise().then(function(e){if(t){t.removeEventListener("load",r);t.removeEventListener("error",i)}return e})})(this._request.response).then(function(n){var r={data:n,status:e.getStatus(),statusText:e._request.statusText,infected:!!e.getResponseHeader(O),authenticate:e.getResponseHeader(y)};t.complete(r)}):t.complete(this._request.response):t.complete(this._request.responseText);return t.getPromise()};e.prototype.getValue=function(t){var n;switch(t){case e.DataValueKeys.SourceURL:n=this.getSourceUrl();break;case e.DataValueKeys.CorrelationId:n=this.getCorrelationId();break;case e.DataValueKeys.Status:n=this.getStatus();break;case e.DataValueKeys.AuthenticationRedirect:n=this.getAuthenticationRedirect();break;case e.DataValueKeys.ResponseText:n=this.getResponseText();break;case e.DataValueKeys.ErrorResponseText:n=this.getErrorResponseText()}return n};e.prototype.getRedirectUrl=function(){return this._isCanaryRequest?403===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():this.getAccessDeniedRedirectUrl():403===this.getStatus()||401===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():void 0};e.prototype.getRedirectLoginPageUrl=function(){var e,t=this.getAuthenticationRedirect();if(t){var n=new d.e(t);n.setQueryParameter("ReturnUrl",v.e.encodeURIComponent(window.location.href));e=n.toString()}return e};e.prototype.getAccessDeniedRedirectUrl=function(){var e;if(this._webAbsoluteUrl){var t=this._webAbsoluteUrl+"/_layouts/15/AccessDenied.aspx";if(t){var n=new d.e(t);n.setQueryParameter("Source",v.e.encodeURIComponent(window.location.href));n.setQueryParameter("Type","list");n.setQueryParameter("correlation",v.e.encodeURIComponent(this.getCorrelationId()));e=n.toString()}}return e};e.prototype.getRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader(x),t=new d.e(e);t.setQueryParameter("ReturnUrl",window.location.href);return t.toString()};e.prototype.shouldRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader(E),t=this.getResponseHeader("sharepointerror");return"9.3"===e||"-2130575129"===t};e.prototype.getResponseHeadersDictionary=function(){var e={},t=this.getAllResponseHeaders();if(t){var n=t.trim().split(/[\r\n]+/);n&&n.length>0&&n.forEach(function(t){var n=t.split(": "),r=n.shift(),i=n.join(": ");e[r]=i})}this.getResponseHeadersDictionary=function(){return e};return e};e.prototype.getResponseHeader=function(e){var t=this.getResponseHeadersDictionary();return t[e.toLowerCase()]||t[e]||this._request.getResponseHeader(e)};e.prototype.getHeaderNumberValue=function(e){var t=this.getResponseHeader(e),n=Number(t);return isNaN(n)?void 0:n};e.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"};return e})(),_=n(120),D=n(66),P=n(9);var H=(function(){function e(e){void 0===e&&(e={});var t;this._scope=new _.e;this._events=this._scope.attach(new D.t(this));var n=e.webAbsoluteUrl||e.webUrl;this._webServerRelativeUrl=e.webServerRelativeUrl||n&&new d.e(n).getPath();"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl="");if(P.e.isActivated("5F6AAA43-30D4-4E2C-B9CF-76C77A7F48DE","10/04/2022","Always use token provider to fetch tokens"))if(n){this._webAbsoluteUrl=n;this._alwaysGetDigest=!0}else this._alwaysGetDigest=!1;else this._alwaysGetDigest=null!==(t=e.alwaysGetDigest)&&void 0!==t&&t;this._needsRequestDigest=!1!==e.needsRequestDigest;this._needsRequestDigest&&this._tryLoadDigest(e.formDigest);this._requestCanaryForAuth=!1;this._engagement=e.engagement;this._operationName=e.operationName}e._isValidFormDigest=function(e){return e&&e.serverTime&&Date.now()-new Date(e.serverTime).getTime()<1e3*(e.formDigestTimeoutSeconds-60)};e.prototype.dispose=function(){this._scope.dispose()};e.prototype.abort=function(){if(this._currentRequest){var e=this._currentRequest;e.isCancelled=!0;e.abort();this._currentRequest=void 0}};e.prototype.isRequestActive=function(){return!!this._currentRequest};e.prototype.getServerDataFromUrl=function(e){var t=this,n=e.url,r=e.successCallback,i=e.failureCallback,s=e.uploadProgressCallback,o=e.additionalPostData,u=e.isRest,a=void 0===u||u,f=e.method,l=void 0===f?"POST":f,c=e.withCredentials,h=e.additionalHeaders,p=e.contentType,d=e.noRedirect,v=e.responseType,m=e.needsRequestDigest,g=void 0===m?this._needsRequestDigest:m,y=(new Date).toISOString(),b=new XMLHttpRequest;b.open(l,n,!0);"boolean"==typeof c&&(b.withCredentials=c);v&&(b.responseType=v);p?b.setRequestHeader("Content-Type",p):a?b.setRequestHeader("Content-Type","application/json;odata=verbose"):b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var w=!1;if(h)for(var E in h)if(E){b.setRequestHeader(E,h[E]);"accept"===E.toLowerCase()&&(w=!0)}w||b.setRequestHeader("accept","application/json;odata=verbose");this._currentRequest=b;var S=function(e){g&&e&&b.setRequestHeader("x-requestdigest",e);t._events.on(b,"readystatechange",function(){t._onReadyStateChange(b,n,r,i,d,y)});s&&b.upload&&t._events.on(b.upload,"progress",function(e){s(e)});b.send(o)};g?this._ensureRequestDigest(S,i):S()};e.prototype.ensureRequestDigest=function(e,t){this._ensureRequestDigest(e,t)};e.prototype._ensureRequestDigest=function(t,n){var r=e._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&e._isValidFormDigest(r)?t(r.formDigestValue):this._ensureRequestDigestWorker(t,n)};e.prototype._ensureRequestDigestWorker=function(t,n){var r=this,s=new Date,o=new e({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});t||(o._requestCanaryForAuth=!0);var u=this._webAbsoluteUrl||this._webServerRelativeUrl;if("string"==typeof u){e._requestDigestPromise||(e._requestDigestPromise=new i.t(function(i,a){o.getServerDataFromUrl({url:d.e.concatenate(u,"/_api/contextinfo"),successCallback:function(t){var n=t.getResponseText(),o=JSON.parse(n).d.GetContextWebInformation;e._formDigests[r._webServerRelativeUrl]={serverTime:s.toISOString(),formDigestValue:o.FormDigestValue,formDigestTimeoutSeconds:o.FormDigestTimeoutSeconds-60,updateFormDigestPageLoaded:new Date};i(e._formDigests[r._webServerRelativeUrl].formDigestValue);e._requestDigestPromise=void 0},failureCallback:function(r,i){t?t(void 0):n&&n(r,i);a(void 0);e._requestDigestPromise=void 0},method:"POST",noRedirect:!!n})}));e._requestDigestPromise.then(function(e){t&&t(e);return e})}else n&&n(void 0,new l.e({code:"MissingWebForDigestAuth",isExpected:!1}))};e.prototype._onReadyStateChange=function(t,n,r,i,s,o){if(4===t.readyState){this._currentRequest=void 0;this._events.off(t);t.upload&&this._events.off(t.upload);if((h=t)&&h.isCancelled)i(void 0,new l.e({code:"RequestAborted",isExpected:!0}));else if((function(e){try{if(4===e.readyState&&(void 0===e.status||0===e.status))return!1}catch(e){return!1}return!0})(t)){var u=new M(t,n,{webAbsoluteUrl:this._webAbsoluteUrl||this._webServerRelativeUrl,isCanaryRequest:this._requestCanaryForAuth}),a=u.getStatus(),f=!s&&u.shouldRedirectToErrorCustomPromptLocation();if(this._requestCanaryForAuth){this._requestCanaryForAuth=!1;if(403===a){var c=u.getRedirectLoginPageUrl();try{f?window.location.href=u.getRedirectToErrorCustomPromptLocation():i(u)}catch(e){}c&&!s&&(window.location.href=c)}else{c=u.getAccessDeniedRedirectUrl();try{i(u)}catch(e){}if(c&&!s){this._engagement&&this._engagement.logData({name:"AccessDeniedRedirect",isIntentional:!1,extraData:{originalOperation:this._operationName||""}});window.location.href=c}}return}if(200===a||201===a||204===a){r(u);return}if(403===a){e._requestDigestPromise=void 0;s?this._ensureRequestDigestWorker(void 0,function(e,t){return i(u,t)}):f?window.location.href=u.getRedirectToErrorCustomPromptLocation():this._ensureRequestDigestWorker(void 0);return}401===a&&f&&(window.location.href=u.getRedirectToErrorCustomPromptLocation());i(u)}else i(void 0,new l.e({code:"NoConnection",isExpected:!0}));var h}};e.prototype._tryLoadDigest=function(t){if(e._isValidFormDigest(t))e._formDigests[this._webServerRelativeUrl]=t;else{var n=e._formDigests[this._webServerRelativeUrl];e._isValidFormDigest(t)&&(!e._isValidFormDigest(n)||n&&new Date(n.serverTime).getTime()<new Date(t.serverTime).getTime())&&(e._formDigests[this._webServerRelativeUrl]=t)}};e._formDigests={};e._requestDigestPromise=void 0;return e})();function B(e){var t=e.options,n=t.url,s=t.authToken,o=t.telemetryHandler,u=t.useExactAuthToken,f=t.method,l=t.additionalHeaders,c=e.dataSyncClient,h=e.aadUserId,p=e.getData,d=function(){return p({url:n,telemetryHandler:o,authToken:s,useExactAuthToken:u})};if(!h)return d();var v=function(e){var t=(function(e,t){return function(n,i){var s=n.eventData,o=s.extraData,u={performanceEntry:o&&o.performanceEntry,httpStatus:o&&o.HttpStatus,correlationId:o&&o.CorrelationId,succeeded:s&&s.resultType===a.t.Success||!1,resultCode:s&&s.resultCode,endpoint:i},f=t&&t(n),l=e.onRequestComplete(u);o.dataSyncQos=e.getQosInfo();return Object(r.e)(Object(r.e)({},f||{}),{eventData:Object(r.e)(Object(r.e)({},f?f.eventData:s),{extraData:Object(r.e)(Object(r.e)({},f?f.eventData.extraData:s.extraData),e.getQosInfo())}),canRetry:l&&(!f||f.canRetry)})}})(e,o);return e.getData({url:n,method:f,additionalHeaders:l},function(e,n){return p({url:e.url,authToken:e.authToken,telemetryHandler:function(n){return t(n,e)},useExactAuthToken:!0,additionalHeaders:n})},d)};return i.t.resolve(c).then(function(e){return e?v(e):d()})}var j=n(32),F=n(26),I=n(97);function q(e){var t=e.options,n=e.webAbsoluteUrl,s=e.apiEvent,o=e.tokenProvider,u=e.getData,a=e.qosName,f=t.url,l=new c.e(f),h="".concat(l.authority,"/{ length: ").concat(l.path.length,", segments: ").concat(l.segments.length," }"),p=function(e,t){if(!o.getAuthToken)return i.t.resolve({authToken:void 0});var n=new s({name:"".concat(a,".getAuthToken").concat(t?".retry":""),url:h});return i.t.resolve(o.getAuthToken(e)).then(function(e){if(!e||"string"==typeof e){n.end({resultType:F.e.Success,resultCode:e?"tokenAuth.string":"cookieAuth.string"});return{authToken:e}}n.end({resultType:F.e.Success,resultCode:e.authToken?"tokenAuth":"cookieAuth",extraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}});return e}).catch(function(e){n.end(Object(I.e)(e));return i.t.reject(e)})},d=function(e,t){if(!o.getFormDigest)return i.t.resolve(void 0);var n=new s({name:"".concat(a,".getAuthToken").concat(t?".retry":""),url:h});return i.t.resolve(o.getFormDigest(e)).then(function(e){n.end({resultType:F.e.Success,resultCode:e?"newDigest":"sameDigest"});return e}).catch(function(e){n.end(Object(I.e)(e));return i.t.reject(e)})};if(!p&&!d)return u({url:f});var v={url:f,webAbsoluteUrl:n},m={url:f,webAbsoluteUrl:n};return p(v,!1).then(function(e){return e.authToken?e:d(m,!1).then(function(t){return e})}).then(function(e){return u({url:f,authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}).catch(function(t){if(e.authToken){var n=void 0;U(t)?n={claimsChallenge:{authToken:e.authToken,claims:R(t),error:t}}:z(t)&&(n={expiration:{authToken:e.authToken,error:t}});if(n)return p(Object(r.e)(Object(r.e)({},v),n),!0).then(function(n){return n.authToken&&n.authToken!==e.authToken?u({url:f,authToken:n.authToken,qosExtraData:{AuthCorrelationId:n.correlationId,AuthExpiration:n.expiresOn}}):i.t.reject(t)})}if(o.getFormDigest){var s=void 0;U(t)?s={claimsChallenge:{claims:R(t),error:t}}:z(t)&&(s={expiration:{error:t}});if(s)return d(Object(r.e)(Object(r.e)({},m),s),!0).then(function(e){return u({url:f})})}return i.t.reject(t)})})}function R(e){var t=e.authenticate;if(t){var n=t.indexOf('claims="');if(n>-1){var r=t.indexOf('"',n+'claims="'.length);if(r>-1){var i=t.slice(n+'claims="'.length,r);return P.e.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?i:atob(i)}}}}function U(e){var t=e.authenticate;return!!(t&&"Bearer"===t.slice(0,"Bearer".length)&&t.indexOf('error="insufficient_claims"')>-1)}function z(e){var t=e.code;return"3000002,invalid_client"===t||"10013"===t||"917656"===t}var W="undefined"!=typeof window?window:void 0,X=W&&W.performance;var V=P.t.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023"),$=(function(){function e(e,t){var n,r,i,s,a,f,l,c;this._pageContext=t?t.pageContext:e.pageContext;this._tokenProvider=null!==(n=null==t?void 0:t.tokenProvider)&&void 0!==n?n:null===(r=this._pageContext)||void 0===r?void 0:r.tokenProvider;this._dataSyncClient=null!==(i=null==t?void 0:t.dataSyncClient)&&void 0!==i?i:null===(s=this._pageContext)||void 0===s?void 0:s.dataSyncClient;this._qosName=e.qosName;this._apiEvent=null!==(a=null==t?void 0:t.apiEvent)&&void 0!==a?a:o.t;this._engagement=null!==(f=null==t?void 0:t.engagement)&&void 0!==f?f:u.e;this._normalizeErrors=!!e.normalizeErrors;this._getDataWithTokenProvider=null!==(l=null==t?void 0:t.getDataWithTokenProvider)&&void 0!==l?l:q;this._getDataWithSyncClient=null!==(c=null==t?void 0:t.getDataWithSyncClient)&&void 0!==c?c:B;this._offlineDetection=null==t?void 0:t.offlineDetection;this._noRedirect=null==t?void 0:t.noRedirect}e.parseJSON=function(e){return e&&JSON.parse(e)||void 0};e.prototype.getData=function(t){var n=this,o=t.parseResponse,u=void 0===o?e.parseJSON:o,d=t.qosExtraData,v=t.additionalPostData,x=void 0===v?"":v,A=t.contentType,O=t.method,M=void 0===O?"POST":O,_=t.maxRetries,D=void 0===_?0:_,B=t.responseType,F=t.onUploadProgress,I=t.timeout,q=t.noTimeoutInLastRetry,R=void 0!==q&&q,U=t.webAbsoluteUrl,z=this._pageContext,$=this._tokenProvider,J=this._getDataWithTokenProvider,K=this._getDataWithSyncClient,Q=[];this._qosName&&Q.push(this._qosName);t.qosName&&Q.push(t.qosName);var G=Q.join("."),Y=function(e){var o=e.url,v=e.telemetryHandler,O=e.authToken,_=e.useExactAuthToken,q=void 0!==_&&_,K=e.additionalHeaders,Q=!0,Y=new c.e(o),Z="".concat(Y.authority,"/{ length: ").concat(Y.path.length,", segments: ").concat(Y.segments.length," }"),ee=function(e){var O=e.authToken,_=e.qosExtraData,$=t.crossSiteCollectionCall,J=void 0!==$&&$,Y=t.noRedirect,ee=void 0===Y?n._noRedirect:Y,te=t.needsRequestDigest,ne=void 0===te||te,re=Object(r.e)(Object(r.e)(Object(r.e)({},t.additionalHeaders),V?{}:K),P.e.isActivated("3404B5AF-0FCD-496E-AE1A-7249248BACFE","10/5/2021","Send CollectSPPerfMetrics header for all SP data requests")?{}:{CollectSPPerfMetrics:N});if(O){var ie=!1;P.t.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","06/09/2021","check if auth token has auth header already, if yes, use exact auth token")||j.e.isFeatureEnabled({ECS:86137})||O.split(" ").length>1&&(ie=!0);var se=q||ie?O:"Bearer ".concat(O),oe=!1;for(var ue in re)ue&&"authorization"===ue.toLowerCase()&&(oe=!0);oe||(re.Authorization=se);J=!0;ne=!1;ee=!0}var ae,fe,le=new H(Object(r.e)(Object(r.e)({},z?Object(r.e)(Object(r.e)({webServerRelativeUrl:z.webServerRelativeUrl},P.e.isActivated("5F6AAA43-30D4-4E2C-B9CF-76C77A7F48DE","10/04/2022","Always use token provider to fetch tokens")?{webAbsoluteUrl:J?z.webAbsoluteUrl:U}:{webAbsoluteUrl:U||z.webAbsoluteUrl,alwaysGetDigest:J}),{formDigest:{serverTime:z.serverTime,updateFormDigestPageLoaded:z.updateFormDigestPageLoaded,formDigestValue:z.formDigestValue,formDigestTimeoutSeconds:z.formDigestTimeoutSeconds}}):{}),{needsRequestDigest:ne,engagement:n._engagement,operationName:n._qosName})),ce=W&&W.location&&new c.e(W.location.href).authority,he=new c.e(o).authority,pe=f.e.getRUMOneLogger(),de=Date.now();pe&&(Boolean(pe.readTempData("appDataFetchStart"))||pe.saveTempData("appDataFetchStart",de));return(function(e){var t,n=e.onExecute,r=e.onCancel,o=e.timeout,u=e.canRetry,a=e.noTimeoutInLastRetry,f=0,l=Math.max(e.maxRetries,0),c=function(){var e=new i.t(n,function(){r(f>=l||!u())});return o&&(!a||f<l)?i.t.timeout(o,e):e};t=f<l?(function(e){var t,n=e.adjustRetries,r=e.async,i=e.beforeRetry,o=e.callback,u=e.canRetry,a=void 0===u?function(){return!0}:u,f=e.delay,l=e.resetAttemptsOnRestart,c=e.retries,h=e.shouldRestart,p=0,d=new s.e(function(){t.cancel()});function v(e){if(h&&h()){l&&(p=0);g()}else d.complete(e)}function m(e){n&&(c=n(e));if(p<c&&a(e)){p++;i&&i();"number"==typeof f&&r?r.setTimeout(g,f):g()}else d.error(e)}function g(){(t=o()).then(v,m)}g();return d.getPromise()})({canRetry:u,retries:l,callback:c,beforeRetry:function(){f++}}):c();return t})({timeout:I,onExecute:function(e,t){var i=function(i,s){return function(f){var l=f.getResponseText();fe=f.getServiceWorkerDataSourceHeader();var c,m,g,y,b=Object(h.e)(o,s),w=Object(r.e)(Object(r.e)(Object(r.e)(Object(r.e)({},d||{}),{needsRequestDigest:ne,hasAuthToken:!!O,isCrossOrigin:!!ce&&ce!==he,CorrelationId:f.getCorrelationId()}),_||{}),{HttpStatus:f.getStatus(),serviceWorkerDataSource:fe||void 0,rawRequestDuration:b.duration,performanceEntry:JSON.stringify(b),serviceWorkerFetchInfo:f.getResponseHeader(L)||void 0,SQLRT:f.getHeaderNumberValue(N),ServerDuration:f.getHeaderNumberValue(C)}),E=!1;try{!(function(e,t){return"blob"===e&&t&&"object"==typeof t})(B,l)?m=u(l,f):g=l;E=!0}catch(e){c=e;y={resultType:a.t.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:w}}y||(y={resultType:a.t.Success,extraData:w});if(v){y=v({response:m,eventData:y,serverData:f}).eventData}i.end(y);if(E)try{e(g||m)}catch(e){}else t(n._normalizeErrors?new p.e({code:"-1,parse_response",innerError:c,errorData:{status:f.getStatus()}}):void 0);le=void 0}},s=function(e,i){return function(s,u){var f=Object(h.e)(o,i),c=Object(r.e)(Object(r.e)({},d||{}),{needsRequestDigest:ne,hasAuthToken:!!O,isCrossOrigin:!!ce&&ce!==he,rawRequestDuration:f.duration,performanceEntry:JSON.stringify(f)}),x="undefined"!=typeof navigator&&!1===navigator.onLine;n._offlineDetection&&(x=n._offlineDetection.offline);if(s){var N=function(i){var o=void 0,u=(function(e){var t=!1,n={order:[],map:{}},r=e.getResponseHeader(b);if(r)try{var i=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(r),s=i[1],o=void 0===s?"-1":s,u=i[2],a=void 0===u?"":u,f=i[3],l=void 0===f?"unknown":f;switch(Number(o)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:t=!0;break;default:t=!1}var c={source:b,code:"".concat(o,",").concat(l),message:a,isDisplayable:!0};n.order.push(c.source);n.map[c.source]=c}catch(e){}var h=e.getResponseHeader(T);if(h)try{var p=/(\d+);\s+(.+)/.exec(h),d=p[1],v=void 0===d?"-1":d,m=p[2];c={source:T,code:v,message:a=void 0===m?"":m,isDisplayable:!1};n.order.push(c.source);n.map[c.source]=c}catch(e){}if(!P.e.isActivated("653DFB77-4F5B-4F7E-BAAE-0AA791061E25","03/30/2023","Add extra error codes")){var g=e.getResponseHeader(E);if(g){var y=e.getResponseHeader(S);c={source:E,code:g,message:y,isDisplayable:!0};n.order.push(c.source);n.map[c.source]=c}}if(!P.e.isActivated("32B53DE1-9D7F-48EE-BE6A-6D02852E7030","03/30/2023","Add extra error codes")){var x=e.getResponseHeader(w);if(x){c={source:w,code:x};n.order.push(c.source);n.map[c.source]=c}}return{codes:n,isExpected:t}})(s),f=u.isExpected,l=u.codes;if("object"==typeof i&&"number"==typeof i.status)o=i;else if("string"==typeof i){var h=void 0;try{h=JSON.parse(i)}catch(e){}if(h)if(h.error_description){o={code:"-1,".concat(h.error||"Unknown"),message:h.error_description};"policy_enforced"===h.error&&(f=!0)}else if("string"==typeof h.error)o={message:h.error};else if(h.error&&h.error.message&&h.error.message.value){var d={source:p.t.spServiceResponse,code:h.error.code,message:"".concat(h.error.message.value),isDisplayable:!0};l.order.push(d.source);l.map[d.source]=d;o=h.error}else o=h.error||h["odata.error"]||{responseData:h}}var N=s.getStatus(),C=s.getCorrelationId(),L=s.getResponseHeader(k),A=s.getResponseHeader(T);c=Object(r.e)(Object(r.e)({},c),{CorrelationId:C,HttpStatus:N,GroupThrottle:L,MSCorrelationVector:s.getResponseHeader(m)});if(401===N&&A||403===N||404===N||429===N||503===N||-1===N||0===N&&x){Q=!1;f=!0}(o=o||{}).codes=l;o.status=N;o.retryAfter=s.getHeaderNumberValue(g);o.authenticate=s.getResponseHeader(y);C&&(o.correlationId=C);L&&(o.groupThrottle=L);var O=o["@error.redirectUrl"],M=s.getRedirectUrl()||O;if(M){f=!0;o.redirectUrl=M}var _=JSON.stringify(o),D=l.map[p.t.spServiceResponse];D&&(o.message=D.message);var H=l.order[0];if(H){if(d=l.map[H])if(H===E&&d.message){o.code="XSPOErrorMessage";o.message=d.message}else d.code&&(o.code=d.code)}o.code||(o.code="Unknown");var B="[".concat(N,"] ").concat(o.code),j={resultType:f?a.t.ExpectedFailure:a.t.Failure,error:_,resultCode:B,extraData:c};if(v){var F=v({eventData:j,errorData:o,serverData:s}),I=F.eventData,q=F.canRetry;I&&(j=I);!0!==q&&!1!==q||(Q=q);j.resultType===a.t.ExpectedFailure&&(f=!0)}var R=n._normalizeErrors?new p.e({errorData:o,isExpected:f}):o;R.codes&&R.codes&&(j.extraData.errorCodes=JSON.stringify(R.codes.map));e.end(j);t(R)},C=s.getResponseType();if(C&&"text"!==C)s.parseError().then(N);else{N(s.getResponseText())}}else{var L="Unknown",A=!0,M=0;if(u&&u instanceof l.e){L=u.code;A=u.isExpected;M=-1}!x||"NoConnection"!==L&&"Unknown"!==L||(L="Offline");var _={status:M,code:L},D={resultType:A?a.t.ExpectedFailure:a.t.Failure,resultCode:L,extraData:c};if(v){D=v({eventData:D,errorData:_}).eventData}e.end(D);t(n._normalizeErrors?new p.e({errorData:_,innerError:u}):_)}}};(function(){var e=ae=new n._apiEvent({url:Z,name:G}),t=X&&X.now();le.getServerDataFromUrl({url:o,successCallback:i(e,t),failureCallback:s(e,t),uploadProgressCallback:F,additionalPostData:x,method:M,additionalHeaders:re,contentType:A,withCredentials:!O&&void 0,noRedirect:ee,responseType:B,needsRequestDigest:ne})})()},maxRetries:D,noTimeoutInLastRetry:R,canRetry:function(){return Q},onCancel:function(e){if(le){le.abort();e&&le.dispose()}}}).then(function(e){le&&le.dispose();return e},function(e){le&&le.dispose();!ae.endTime&&i.t.isCanceled(e)&&ae.end({resultCode:"Canceled",resultType:a.t.ExpectedFailure});return i.t.reject(e)})};if(O)return i.t.resolve(O).then(function(e){return ee({url:o,authToken:e})});if($)return J({apiEvent:n._apiEvent,getData:ee,options:{url:o,authToken:t.authToken,qosExtraData:t.qosExtraData},webAbsoluteUrl:!P.e.isActivated("5F6AAA43-30D4-4E2C-B9CF-76C77A7F48DE","10/04/2022","Always use token provider to fetch tokens")&&U||z&&z.webAbsoluteUrl,qosName:G,tokenProvider:$});if(z){if(z.getAuthToken)return i.t.resolve(z.getAuthToken()).then(function(e){return ee({url:o,authToken:e})});if(z.authToken)return i.t.resolve(z.authToken).then(function(e){return ee({url:o,authToken:e})})}return ee({url:o})},Z={authToken:t.authToken,telemetryHandler:t.telemetryHandler,url:t.url,useExactAuthToken:t.useExactAuthToken,method:t.method,additionalHeaders:t.additionalHeaders};return this._dataSyncClient&&!t.skipSyncClient?K({options:Z,aadUserId:null==z?void 0:z.aadUserId,dataSyncClient:this._dataSyncClient,getData:Y}):Y(Z)};return e})();t.t=$},function(e,t,n){"use strict";n.d(t,"r",function(){return r});n.d(t,"e",function(){return i});n.d(t,"n",function(){return u});n.d(t,"t",function(){return p});var r,i,s=n(20),o=n(35);(function(e){e[e.sameSite=0]="sameSite";e[e.crossSite=1]="crossSite";e[e.unknown=2]="unknown"})(r||(r={}));(function(e){e[e.sameGeo=0]="sameGeo";e[e.crossGeo=1]="crossGeo";e[e.unknown=2]="unknown"})(i||(i={}));var u=(function(){function e(e){var t=e.defaultFullWebUrl,n=e.defaultListUrl,r=e.multiGeoInfo,i=e.options,s=void 0===i?{}:i,o=s.path,u=void 0===o?void 0:o,a=s.listUrl,l=void 0===a?void 0:a,c=s.webUrl,h=void 0===c?void 0:c,p=s.mayInferListUrl,d=void 0!==p&&p;this._rawPath=u||void 0;this._rawListUrl=l||void 0;this._rawWebUrl=h||void 0;this.defaultFullWebUrl=f(t||void 0);this.defaultListUrl=f(n||void 0);this.multiGeoInfo=r;this.mayInferListUrl=d}Object.defineProperty(e.prototype,"serverRelativeItemUrl",{get:function(){return a(this._getServerRelativeItemUrl())},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"serverRelativeListUrl",{get:function(){return a(this._getServerRelativeListUrl())},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"fullListUrl",{get:function(){return this._getFullListUrl()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"normalizedListUrl",{get:function(){return a(this._getNormalizedListUrl())},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"fullItemUrl",{get:function(){return this._getFullItemUrl()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"normalizedItemUrl",{get:function(){return a(this._getNormalizedItemUrl())},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"listRelativeItemUrl",{get:function(){return this._getListRelativeItemUrl()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"webRelativeItemUrl",{get:function(){return this._getWebRelativeItemUrl()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"fullWebUrl",{get:function(){return this._getFullWebUrl()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"normalizedWebUrl",{get:function(){return a(this._getNormalizedWebUrl())},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"serverRelativeWebUrl",{get:function(){return a(this._getServerRelativeWebUrl())},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"isCrossDomain",{get:function(){return this._getIsCrossDomain()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"isCrossList",{get:function(){return this._getIsCrossList()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"siteRelation",{get:function(){return this._getSiteRelation()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"geoRelation",{get:function(){return this._getGeoRelation()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"path",{get:function(){return this._getPath()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"listUrl",{get:function(){return this._getListUrl()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"webUrl",{get:function(){return this._getWebUrl()},enumerable:!1,configurable:!0});e.prototype._getPath=function(){var e,t=this._rawPath;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=f(t);else{var n=this._getListUrl()||this.defaultListUrl;n&&(e="".concat(n,"/").concat(t))}this._getPath=function(){return e};return e};e.prototype._getListUrl=function(){var e,t=this._rawListUrl;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=f(t);else{var n=this._getWebUrl()||this.defaultFullWebUrl;n&&(e="".concat(n,"/").concat(t))}this._getListUrl=function(){return e};return e};e.prototype._getWebUrl=function(){var e,t=this._rawWebUrl;t&&(e="/"===t[0]||t.indexOf("://")>-1?f(t):"".concat(this.defaultFullWebUrl,"/").concat(t));this._getWebUrl=function(){return e};return e};e.prototype._getCurrentAuthority=function(){var e=new s.e(this.defaultFullWebUrl).authority;this._getCurrentAuthority=function(){return e};return e};e.prototype._getNormalizedWebUrl=function(){var e,t=this._getFullWebUrl(),n=this.defaultFullWebUrl;if(void 0!==t&&!Object(o.t)(t,n)){var r=new s.e(t);e=Object(o.t)(r.authority,this._getCurrentAuthority())?r.path:t}this._getNormalizedItemUrl=function(){return e};return e};e.prototype._getNormalizedItemUrl=function(){var e,t=this._getFullItemUrl();if(void 0!==t){var n=new s.e(t);e=Object(o.t)(n.authority,this._getCurrentAuthority())?n.path:t}this._getNormalizedItemUrl=function(){return e};return e};e.prototype._getNormalizedListUrl=function(){var e,t=this._getFullListUrl(),n=this._getDefaultListUrl();void 0===t||Object(o.t)(t,n)||(e=Object(o.t)(new s.e(t).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():t);this._getNormalizedListUrl=function(){return e};return e};e.prototype._getServerUrl=function(){var e=this.path&&new s.e(this.path).authority||this.listUrl&&new s.e(this.listUrl).authority||this.webUrl&&new s.e(this.webUrl).authority||this.defaultListUrl&&new s.e(this.defaultListUrl).authority||new s.e(this.defaultFullWebUrl).authority;this._getServerUrl=function(){return e};return e};e.prototype._getServerRelativeListUrl=function(){var e;if(void 0!==this.listUrl)e=new s.e(this.listUrl).path;else{var t=this._getDefaultListUrl(),n=this.mayInferListUrl;if(void 0!==t||n){var r=this._getServerRelativePath(),i=new s.e(t).path;if(void 0===r&&(void 0===this.webUrl||i&&h(c(i),c(this._getServerRelativeWebUrl())))||i&&h(c(r),c(i)))e=i;else if(void 0!==r&&(""===this.defaultListUrl||n)){var o=this._getServerRelativeWebUrl();if(h(c(r),c(o))){var u=new s.e(r).segments[new s.e(o).segments.length];e="".concat(c(o)).concat(u)}}}}this._getServerRelativeListUrl=function(){return e};return e};e.prototype._getFullListUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeListUrl();void 0!==n&&(e="".concat(t).concat(n));return e};e.prototype._getFullItemUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeItemUrl();void 0!==n&&(e="".concat(t).concat(n));this._getFullItemUrl=function(){return e};return e};e.prototype._getServerRelativeWebUrl=function(){var e,t;if(void 0!==this.webUrl)e=new s.e(this.webUrl).path;else if(!this.defaultListUrl&&!this.listUrl||this.mayInferListUrl||void 0===(t=this._getServerRelativeListUrl()))this.defaultFullWebUrl&&(e=new s.e(this.defaultFullWebUrl).path);else{var n=new s.e(t);e="".concat(n.segments.slice(0,-1).join("/"))}this._getServerRelativeWebUrl=function(){return e};return e};e.prototype._getServerRelativePath=function(){var e;void 0!==this.path&&(e=new s.e(this.path).path);this._getServerRelativePath=function(){return e};return e};e.prototype._getServerRelativeItemUrl=function(){var e;this.path||this._rawPath?e=this._getServerRelativePath():this.listUrl?e=this._getServerRelativeListUrl():this.webUrl?e=this._getServerRelativeWebUrl():this.defaultListUrl?e=this._getServerRelativeListUrl():this.defaultFullWebUrl&&(e=this._getServerRelativeWebUrl());this._getServerRelativeItemUrl=function(){return e};return e};e.prototype._getListRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),r=this._getServerRelativeListUrl();void 0!==this.path&&void 0!==r&&h(c(n),t=c(r))&&(e=n&&n.substring(t.length));this._getListRelativeItemUrl=function(){return e};return e};e.prototype._getWebRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),r=this._getServerRelativeWebUrl();void 0!==this.path&&void 0!==r&&h(c(n),t=c(r))&&(e=n&&n.substring(t.length));this._getWebRelativeItemUrl=function(){return e};return e};e.prototype._getDefaultListUrl=function(){var e;void 0!==this.defaultListUrl&&(e=new s.e(this.defaultListUrl).authority?this.defaultListUrl:"".concat(this._getCurrentAuthority()).concat(this.defaultListUrl));this._getDefaultListUrl=function(){return e};return e};e.prototype._getIsCrossDomain=function(){var e=this._getCurrentAuthority(),t=!Object(o.t)(new s.e(this._getServerUrl()).authority,e);this._getIsCrossDomain=function(){return t};return t};e.prototype._getIsCrossList=function(){var e=this._getFullListUrl(),t=this._getDefaultListUrl(),n=!Object(o.t)(e,t);this._getIsCrossList=function(){return n};return n};e.prototype._getSiteRelation=function(){var e=r.unknown;if(this._getIsCrossDomain())e=r.crossSite;else if(void 0!==this.webUrl)e=Object(o.t)(l(this.defaultFullWebUrl),l(this._getFullWebUrl()))?r.sameSite:r.crossSite;else{var t=new s.e(this.defaultFullWebUrl).path,n=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==n)if(h(c(n),c(t))){var i=new s.e(l(n)),u=new s.e(l(t));e=i.segments.length-1===u.segments.length||i.segments.length-2===u.segments.length&&"Lists"===i.segments[i.segments.length-2]?r.sameSite:r.unknown}else e=r.crossSite}this._getSiteRelation=function(){return e};return e};e.prototype._getFullWebUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeWebUrl();void 0!==n&&(e="".concat(t).concat(n));this._getFullWebUrl=function(){return e};return e};e.prototype._getGeoRelation=function(){if(!this._getIsCrossDomain())return i.sameGeo;var e=new s.e(this._getServerUrl()).authority;if(!e)return i.unknown;var t=this._getCurrentGeo();if(!t)return i.unknown;var n=this._getGeoByAuthority()[e.toUpperCase()];return n?Object(o.t)(n,t)?i.sameGeo:i.crossGeo:i.unknown};e.prototype._getGeoByAuthority=function(){var e={},t={};function n(n,r,i){var o=new s.e(n).authority.toUpperCase();!i&&t[o]||(e[o]=r);i&&(t[o]=!0)}if(this.multiGeoInfo)for(var r=0,i=this.multiGeoInfo;r<i.length;r++){var o=i[r],u=o.InstanceId,a=o.IsDefaultDataLocation;n(o.MySiteHostUrl,u,a);n(o.PortalUrl,u,a);n(o.RootSiteUrl,u,a);n(o.TenantAdminUrl,u,a);if(o.AdditionalUrls)for(var f=0,l=o.AdditionalUrls;f<l.length;f++){n(l[f],u,a)}}this._getGeoByAuthority=function(){return e};return e};e.prototype._getCurrentGeo=function(){var e=this._getCurrentAuthority();if(e){var t=this._getGeoByAuthority()[e.toUpperCase()];this._getCurrentGeo=function(){return t};return t}};return e})();function a(e){return""===e?"/":e}function f(e){return"/"===e?"/":e}function l(e){void 0===e&&(e="");return"/"===e[e.length-1]?e.substring(0,e.length-1):e}function c(e){void 0===e&&(e="");return"/"===e[e.length-1]?e:"".concat(e,"/")}function h(e,t){var n=e.toUpperCase(),r=t&&t.toUpperCase();return n.substring(0,r&&r.length||0)===r}var p=(function(){function e(e){var t=e.context,n=e.itemUrlPartsType,r=void 0===n?u:n;this.itemUrlPartsType=r;this.itemUrlContext=t}e.prototype.getUrlParts=function(e){var t=this.itemUrlContext,n=t.webAbsoluteUrl,r=t.listUrl,i=t.multiGeoInfo;return new this.itemUrlPartsType({defaultFullWebUrl:n,defaultListUrl:r,multiGeoInfo:i,options:e})};return e})()},function(e,t,n){"use strict";n.d(t,"e",function(){return f});n.d(t,"t",function(){return c});var r=n(68),i=n(6),s=n(126),o=n(45),u=n(25),a=n(27),f="https://outlook.office.com/search",l={ODB:1286},c=(function(){function e(e,t){this._dataRequestor=new s.e({},{});this._pageContext=t.pageContext;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation=t.sharingContextInformation;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken);this.initializeDataStore()}e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;if(this._pageContext&&!this._pageContext.isSPO)return e;if(this._pageContext&&this._pageContext.authToken)return e;this._pageContext&&this._oAuthTokenProvider&&a.e.isFeatureEnabled(l)&&(e=!0);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableSubstrateSearch",u.e.session));return e};e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableSubstrateSearch",!0,u.e.session)};e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return r.t.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new i.e({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(f).then(function(e){t.end({resultType:i.t.Success});return e},function(n){if(r.t.isCanceled(n)){t.end({resultType:i.t.ExpectedFailure,resultCode:"Canceled"});return r.t.reject(n)}t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:i.t.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}});e.disableSubstrateCallsForPicker();return null})}return null};e.prototype.init=function(e){var t,n,r="".concat(f,"/api/v1/init?scenario=").concat("documentshare");this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:r,headers:{Authorization:"Bearer "+e,"X-AnchorMailbox":"OID:".concat(null===(t=this._pageContext)||void 0===t?void 0:t.aadUserId,"@").concat(null===(n=this._pageContext)||void 0===n?void 0:n.aadTenantId)},needsAuthorization:!1})};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new o.e("PeoplePicker",u.e.session))};return e})()},function(e,t,n){"use strict";var r=n(0),i=n(60),s=n(67),o=n(136),u=n(4),a=Object(o.e)({eventName:"Beacon,",shortEventName:"Beacon"},{name:u.e.String,status:u.e.String,success:u.e.Boolean,retryCount:u.e.Number,totalRetries:u.e.Number,eventCount:u.e.Number}),f=n(41),l=n(157),c=n(182),h=(function(){function e(e,t,n,r,i){this._endpointUrl=e.callbackEndpoint.authority+e.callbackEndpoint.path;var s={};if(i)for(var o=0;o<i.length;++o)s[i[o].EventType]=s[i[o].EventType]+1||1;var u={TelemetryTenantId:e.telemetryTenantToken.substring(0,32),AppVersion:e.appVersion,EventType:t,StatusCode:n,EventCount:i?i.length:0,Timestamp:r,Environment:e.environment||"",DatapointSchemaVersion:"1.0",TelemetrySource:"Aria",EventSummary:s,Workload:e.workload||"",FarmLabel:e.farmLabel||"",FarmName:e.farmName||""};this._dataCompletenessJson=JSON.stringify(u)}Object.defineProperty(e.prototype,"endpointUrl",{get:function(){return this._endpointUrl},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"dataCompletenessJson",{get:function(){return this._dataCompletenessJson},enumerable:!1,configurable:!0});e.prototype.send=function(){new c.e({method:"POST",url:this._endpointUrl,json:this._dataCompletenessJson,requestTimeoutInMS:1e3}).start(function(e,t){},function(e,t,n){0})};return e})(),p=n(169),d=n(193),v=(function(){function e(e){this._handlerLoader=e}e.prototype.attach=function(e){var t,n=!1;this._getHandler().then(function(r){n||(t=r.attach(e))});return function(){n=!0;t&&t()}};e.prototype._getHandler=function(){var e=this._handlerLoader();this._getHandler=function(){return e};return e};return e})();var m,g,y=n(68),b=n(9),w={logStartEvents:!1,Init:function(e,t,n,i){var o=this;void 0===i&&(i={});try{w.logStartEvents=!0;var u,l=x(t,i.platformDetection),c=new p.e(t.completenessCallbackEndpoint),d={telemetryTenantToken:e,appVersion:t.version,environment:t.environment,workload:t.workload,farmLabel:t.farmLabel,farmName:t.farmName,callbackEndpoint:c},g={ariaLoader:function(){return y.t.resolve(n)},context:l,tenantToken:e,disableCookies:t.disableCookies,ariaLogConfiguration:{collectorUrl:t.collectorUrl},logStartEvents:w.logStartEvents,offlineDetection:i.offlineDetection,offlineCache:i.offlineCache,ariaQos:{isQosEvent:function(e){return a.isTypeOf(e)&&!!e.data&&"AriaBeacon"===e.data.name},reportQos:function(e){var t=e.result,n=e.statusCode,r=e.events;new a({name:"AriaBeacon",retryCount:0,totalRetries:0,eventCount:r?r.length:0}).end({success:0===t,status:n+""});0;""!==c.authority&&new h(d,t,n,(new Date).getTime(),r).send()}}},b=t.getAuthToken?new v(function(){return Object(r.t)(o,void 0,void 0,function(){var e;return Object(r.i)(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,t.getAuthToken()];case 1:e=n.sent();return[3,3];case 2:n.sent();return[3,3];case 3:return[2,m=new S(Object(r.e)({userAuthToken:e},g))]}})})}):m=new E(g);u=i.customManager?b.attach(i.customManager):b.attach(s.e);return function(){u();m=void 0}}catch(e){e instanceof n.Exception&&(e=new Error("Aria error: ".concat(e.toString())));f.e.log(e);m=void 0;return function(){}}},updateContext:function(e,t){void 0===t&&(t={});if(m){var n=x(e,t.platformDetection);m.updateContext(n)}},isInitialized:function(e){return!!m},flushTelemetry:function(){return Object(r.t)(this,void 0,void 0,function(){return Object(r.i)(this,function(e){switch(e.label){case 0:return m?[4,m.flush()]:[3,2];case 1:e.sent();e.label=2;case 2:return[2]}})})}},E=(t.e=w,(g=u.t.requiredService,function(e){var t="function"==typeof g?g:function(){return g};return(function(e){Object(r.r)(n,e);function n(n){var i=n.onLogEvent;return e.call(this,Object(r.e)(Object(r.e)({},n),{onLogEvent:function(e){var n=i?i(e):e;if(n.data)return Object(r.e)(Object(r.e)({},n),{data:Object(r.e)(Object(r.e)({},n.data),{privacyClassification:t(n)})})}}))||this}return n})(e)})(d.e)),S=(function(e){Object(r.r)(t,e);function t(t){var n=t.context,i=void 0===n?{}:n,s=t.userAuthToken,o=t.userId,u=(t.context,Object(r.s)(t,["userAuthToken","userId","context"])),a=s&&(function(e){try{var t=e.split(".")[1];if(t)return JSON.parse(atob(t.replace(/-/g,"+").replace(/_/g,"/")))}catch(e){return}})(s),f=a&&a.puid?"Business":"Unknown",l=a&&a.app_displayname||"Unknown",c=a&&a.appid||"Unknown",h=(function(e,t,n){return e?"Unknown"===n?"":e:"Business"===n&&t&&t.puid||""})(o,a,f),p=h?1:0,d=a&&a.tid||"Unknown";return e.call(this,Object(r.e)({context:Object(r.e)({AccountType:f,AppName:l,AppId:c,IsAuthenticated:p,SiteSubscriptionId:d,UserId:h},i)},u))||this}return t})(E);function x(e,t){void 0===t&&(t=new l.e);var n=Object(r.e)({AccountType:i.e[e.accountType],BrowserIsMobile:t.isMobile,BrowserIsPWA:t.isPWA,BrowserMajVer:t.browserMajor,BrowserMinVer:t.browserMinor,BrowserName:t.browserName,BrowserUserAgent:t.userAgent,CloudType:e.cloudType,Environment:e.environment,FarmLabel:e.farmLabel,FarmName:e.farmName,IsAuthenticated:e.isAuthenticated?1:0,Market:e.market,Manifest:e.manifest,OSName:t.osName,OSVersion:t.osVersion,Session:e.session,SiteSubscriptionId:e.siteSubscriptionId||"",UserId:e.userId,Version:e.version,Workload:e.workload,SiteId:e.siteId,WebId:e.webId,WebTemplateId:e.webTemplateId,pageCorrelationId:e.pageCorrelationId,originalSession:e.originalSession,ResourceTenantId:e.resourceTenantId,listId:e.listId,product:e.product,SessionId:e.session,TenantId:e.siteSubscriptionId,UserAgent:t.userAgent,ServerGU:e.sideBySideToken},e.context||{});!b.t.isActivated("25407BCB-74C5-4CCE-BCBC-8B84FCBBB346","12/16/2022","Add __debugLoggerContext onto the window object to obtain logging context information.")&&(window.__debugLoggerContext={session:e.session,workload:e.workload,product:e.product});return n}},function(e,t,n){"use strict";n.d(t,"e",function(){return E});var r=n(0),i=n(68),s=n(288),o=n(186),u=n(26),a=n(49),f=n(28),l=n(170),c=n(91),h=n(48),p=n(84),d=n(20),v=n(164),m=n(27),g=n(9);function y(e){var t=e.dataSyncClient,n=e.options,s=e.getData,o=function(){return s(n)};return i.t.resolve(t).then(function(t){return t?(function(t){return t.getData({url:n.path,method:n.requestType},function(t,n){var i=Object(r.e)(Object(r.e)({},e.options),{path:t.url,accessToken:{accessToken:t.authToken},forceContentType:!0,useExactAuthToken:!0,headers:n});return s(i)},o)})(t):o()})}var b=window&&window.performance,w={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},E=(function(){function e(e,t){this._sendUrlToGetFormDigestKSActive=g.e.isActivated("2F2E0E27-606F-4542-90E2-56D10E78DC5B","03/24/2023","send url to getFormDigest");this._sendSyncClientHeadersKs=g.t.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023");var n=e.alwaysSendContentType,r=void 0!==n&&n,i=t.sessionManagementProvider,s=t.urlDataSource,u=t.apiEvent,a=void 0===u?o.e:u,f=t.cookieOrigin,l=t.isOffline,c=t.dataSyncClient;this._sessionManagementProvider=i;this._alwaysSendContentType=r;this._apiEvent=a;this._apiName=s&&"function"==typeof s.getApiName?s.getApiName():"Vroom";this._urlDataSource=s;this._cookieOrigin=f;this._isOffline=l;this._dataSyncClient=c;this._encodingFixEnabled=!g.t.isActivated("179f8622-1596-43df-a186-a4b42e1d7917","08/04/2020","Decode unicode characters in graph errors")&&!m.e.isFeatureEnabled({ODC:"GraphEncodingFixKillswitch"});this._isPassAuthTokenInHeaderFeatureEnabled=m.e.isFeatureEnabled({ODB:60762,ODC:"PassAuthTokenInHeader"});this._driveIdUrlCheckEnabled=!g.t.isActivated("16BE6F20-C2C6-46AF-8EA5-6D43B30F7112","06/09/2022","Validate driveUrl against driveId")}e.prototype.send=function(e){var t=this,n=function(n){var o=e.headers,m=void 0===o?{}:o,g=e.endpoint,y=e.driveUrl,E=e.driveId,x=e.apiName,T=e.disableLogging,N=void 0!==T&&T,C=e.timeout,k=e.onProgress,L=e.onUploadProgress,A=e.qosExtraData,O=e.apiVersion,M=void 0===O?"v2.0":O,_=e.needsAuthorization,D=void 0===_||_,P=e.postProcessQos,H=e.breakCache,B=e.allowCookies,j=e.hasContentType,F=void 0===j||j,I=e.useMultiPart,q=void 0!==I&&I,R=e.getErrorAsMessage,U=void 0!==R&&R,z=e.expectedErrors,W=n.path,X=n.accessToken,V=n.forceContentType,$=void 0!==V&&V,J=n.useExactAuthToken,K=void 0!==J&&J,Q=n.headers;if(!g){var G="v2.1"===M?M:void 0;g=t._urlDataSource?"function"==typeof t._urlDataSource.getApiBaseUrl?t._urlDataSource.getApiBaseUrl({apiVersion:G,driveId:E}):t._urlDataSource.getVroomApiBaseUrl():void 0}if(t._driveIdUrlCheckEnabled&&y&&E){if(("me"!==E?"".concat(g,"/drives/").concat(E):y)!==y)throw new a.e({code:"DriveIdAndDriveUrlMismatch"})}var Y=e.useAuthorizationHeaders,Z=void 0!==Y&&Y;t._isPassAuthTokenInHeaderFeatureEnabled&&(Z=!0);var ee=Object(r.e)(Object(r.e)({},w),e.expectedErrorCodes||{}),te=e.requestType,ne=void 0===te?"GET":te,re=t._cookieOrigin,ie=new d.e(W).authority?W:"".concat(g).concat(W),se=function(n){var o,a,y="",w={};if(q){y=h.e.generate();w={"Content-Type":"multipart/form-data;boundary=".concat(y)}}else w=Object(r.e)(Object(r.e)(Object(r.e)(Object(r.e)(Object(r.e)({Accept:"application/json"},(e.postData||t._alwaysSendContentType)&&F||$?{"Content-Type":"application/json"}:{}),n.useCookies&&n.digestValue?{"x-requestdigest":n.digestValue}:{}),U?{prefer:"rich-error-as-message"}:{}),m),t._sendSyncClientHeadersKs?{}:Q);if(n.sessionToken&&n.sessionToken.tokenUrl&&0===W.indexOf("/drive/"))a=new f.e("".concat(n.sessionToken.tokenUrl,"/").concat(W.substring(7)));else{a=new f.e(W);g&&!a.getScheme()&&(a=new f.e(g+W))}if(q){a.setQueryParameter("ump","1");"POST"!==ne&&(m["X-HTTP-Method-Override"]=ne);ne="POST"}var E,S=a.toString();if(!q&&n.sessionToken){var T=n.sessionToken,O=T.accessToken,M=T.proofToken,_=T.wlidToken,D=T.isBadger;if(_)w=Object(r.e)(Object(r.e)({},w),{Authorization:"wlid1.1 ".concat(_)});else if(Z){if(O){var B=D?"badger":"bearer",j=K?O:"".concat(B," ").concat(O);w=Object(r.e)(Object(r.e)({},w),{Authorization:j})}M&&(w=Object(r.e)(Object(r.e)({},w),{"X-PROOF_TOKEN":M}))}else{O&&a.setQueryParameter("access_token",O);M&&a.setQueryParameter("prooftoken",M)}}if(q){var I="";I+="--".concat(y,"\r\n");I+="Content-Disposition: form-data;name=data\r\n";if(m)for(var R=0,X=Object.keys(m);R<X.length;R++){var V=X[R];I+="".concat(V,": ").concat(m[V],"\r\n")}I+="Content-Type: application/json\r\n";var J=n.sessionToken;O=J.accessToken,D=J.isBadger;if(O){I+="Authorization: ".concat(B=D?"badger":"bearer"," ").concat(O,"\r\n")}U&&(I+="prefer: rich-error-as-message\r\n");I+="\r\n";I+="".concat(void 0!==e.postData?e.postData:"","\r\n");I+="--".concat(y,"--")}H&&a.setQueryParameter("r",Math.random().toFixed(8));(null===(o=n.sessionToken)||void 0===o?void 0:o.authKey)&&a.setQueryParameter("authKey",n.sessionToken.authKey);if(!N){var G=new d.e(S),Y={url:"".concat(G.authority,"/{ length: ").concat(G.path.length,", segments: ").concat(G.segments.length," }"),name:"".concat(t._apiName,"DataRequest.").concat(x),extraData:A};E=new t._apiEvent(Y)}var te=a.toString(),re=b&&b.now();return s.e.start({url:te,headers:w,method:ne,json:I||e.postData||"",requestTimeoutInMS:C,withCredentials:n.useCookies,onProgress:k,onUploadProgress:L,responseType:e.responseType||void 0}).then(function(t){var n,r,i=Object(l.e)(te,re);if(E){var s=null!==(r=null===(n=t.getAllResponseHeaders())||void 0===n?void 0:n.toLowerCase())&&void 0!==r?r:"",o={resultType:u.e.Success,extraData:{rawRequestDuration:i.duration,performanceEntry:JSON.stringify(i),requestId:s.indexOf("sprequestguid:")>=0?t.getResponseHeader("sprequestguid"):s.indexOf("request-id:")>=0?t.getResponseHeader("request-id"):null,MSCorrelationVector:s.indexOf("ms-cv:")>=0?t.getResponseHeader("MS-CV"):null}};E.end(o)}return e.parseResponse?e.parseResponse(t):0===t.responseText.length?null:JSON.parse(t.responseText)},function(e){var s,o=function(e,t){P&&(e=P(e,t));E&&E.end(e);return i.t.reject(t)},f=Object(l.e)(te,re);if(e instanceof Error){var h=i.t.isCanceled(e),d=h?u.e.ExpectedFailure:u.e.Failure,m={error:e.message,resultCode:h?"Canceled":"",resultType:d,extraData:{rawRequestDuration:f.duration,performanceEntry:JSON.stringify(f)}};return o(m,e)}if(e.responseText)try{s=JSON.parse(e.responseText)}catch(e){}if(U)try{var g=t._encodingFixEnabled?JSON.parse(Object(v.e)(s.error.message)):JSON.parse(atob(s.error.message));s={error:g}}catch(e){}var y=e.status,b=e.statusText,w=(s||{}).error,S=void 0===w?{}:w,x=S.message,T=void 0===x?"":x,N=S.innerError,C=void 0===N?{}:N,k=C.stackTrace,L=void 0===k?"":k,O=C.debugMessage,M=void 0===O?"":O;return(y||!t._isOffline?i.t.resolve(!1):t._isOffline()).then(function(t){var i,l,h=t?"Offline":"",d=null!==(l=null===(i=e.getAllResponseHeaders())||void 0===i?void 0:i.toLowerCase())&&void 0!==l?l:"",v=d.indexOf("sprequestguid")>=0&&e.getResponseHeader("sprequestguid")||d.indexOf("request-id")>=0&&e.getResponseHeader("request-id"),m=t||!!Object(c.t)(s,y,function(e){return ee[e]}),g=new c.e(new Error(T||h),{response:s,status:y,request:e,correlationId:v,isExpected:m});z&&Object(p.isExpectedError)({code:g.code,message:T},z)&&(m=!0);var w={resultType:m?u.e.ExpectedFailure:u.e.Failure,error:T,resultCode:g.code,extraData:Object(r.e)(Object(r.e)(Object(r.e)({},A||{}),Object(c.n)(g)),{stack:L,httpStatus:y,httpStatusText:b,requestId:v,correlationId:v,MSCorrelationVector:d.indexOf("ms-cv:")>=0?e.getResponseHeader("MS-CV"):null,debugMessage:M,accessTokenLength:n.sessionToken&&n.sessionToken.accessToken?n.sessionToken.accessToken.length:-1,urlLength:a.toString().length,useCookies:!!n.useCookies,isOffline:t,rawRequestDuration:f.duration,performanceEntry:JSON.stringify(f)})};return o(w,g)})})},oe=t._sessionManagementProvider;if(D){if(X)return se({sessionToken:X});var ue=new d.e(ie).authority;if(B&&ue&&re&&ue===re)return oe&&oe.getFormDigest&&"GET"!==ne?oe.getFormDigest(t._sendUrlToGetFormDigestKSActive?void 0:ie).then(function(e){return se({digestValue:e,useCookies:!0})}):se({useCookies:!0});if(oe&&oe.getSessionToken){var ae={apiVersion:M,endpoint:g,driveUrl:y,path:ie};return i.t.resolve(oe.getSessionToken(ae)).then(function(e){return se({sessionToken:e}).catch(function(t){return e&&(function(e){if(e instanceof c.e){var t=e.request,n=t&&t.getResponseHeader("WWW-Authenticate");if(n&&"Bearer"===n.slice(0,"Bearer".length)&&n.indexOf('error="insufficient_claims"')>-1)return!0}return!1})(t)?oe.getSessionToken(Object(r.e)(Object(r.e)({},ae),{claimsChallenge:{sessionToken:e,claims:S(t),error:t}})).then(function(n){return n.accessToken!==e.accessToken?se({sessionToken:n}):i.t.reject(t)}):i.t.reject(t)})})}if(oe&&oe.getToken)return oe.getToken(M,ie).then(function(e){return se({sessionToken:e})})}return se({})},o=Object(r.e)({},e);return!g.e.isActivated("83F9234E-0E49-4110-943D-2F0394E9F9FF","5/24/2022","Route graph calls to Nucleus")&&this._dataSyncClient?y({dataSyncClient:this._dataSyncClient,options:o,getData:n}):n(o)};return e})();t.t=E;function S(e){var t=e.request&&e.request.getResponseHeader("WWW-Authenticate");if(t){var n=t.indexOf('claims="');if(n>-1){var r=t.indexOf('"',n+'claims="'.length);if(r>-1){var i=t.slice(n+'claims="'.length,r);return g.e.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?i:atob(i)}}}}},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r,i=n(169),s=n(111);(function(e){e.Small="S";e.Medium="M";e.Large="L"})(r||(r={}));function o(e,t,n){var r=Object(s.getUserPhotoUrl)(t,void 0,n);if(!e||!r||0===r.indexOf("http"))return r;try{return new i.e(e).authority+r}catch(e){return r}}},,function(e,t,n){"use strict";var r,i,s=n(0),o=n(27),u=n(125),a=n(9),f=n(151);function l(){return n.ee(1,"aria-lib")}var c={ODB:588,ODC:"EnableAriaLogging",OneDrive:!0,Fallback:!1},h={ODB:-990,ODC:"ForceEnableAria"},p=(function(){function e(){}e.Init=function(e,t,n,i,s){void 0===n&&(n=l);e&&d(t)&&(r=n().then(function(n){u.e.Init(e,t,n,{offlineDetection:i,customManager:s})},function(e){}))};e.InitCustomerPromise=function(e,t,n,r){void 0===n&&(n=l);e&&d(t)&&(i=n().then(function(n){u.e.Init(e,t,n,{offlineDetection:r,customManager:Object(f.e)()})},function(e){}))};e.UpdateContext=function(e){r&&r.then(function(){u.e.updateContext(e)}).catch(function(){});i&&i.then(function(){u.e.updateContext(e)}).catch(function(){})};Object.defineProperty(e,"logStartEvents",{get:function(){return u.e.logStartEvents},set:function(e){u.e.logStartEvents=e},enumerable:!1,configurable:!0});e.flushTelemetry=function(){return Object(s.t)(this,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:if(!r)return[3,4];e.label=1;case 1:e.trys.push([1,3,,4]);return[4,u.e.flushTelemetry()];case 2:e.sent();return[3,4];case 3:e.sent();return[3,4];case 4:return[2]}})})};e.getAriaTimeZone=function(e){var t=Math.abs(e),n=t%60,r=Math.floor(t/60);return"".concat(e>0?"-":"+").concat(r>=10?r:"0".concat(r),":").concat(n>=10?n:"0".concat(n))};return e})();t.e=p;function d(e){var t=e.version;return!(function(){if(!a.t.isActivated("010437DC-D681-4308-A21E-8BD4ADE3783C","11/12/2021","Use session storage TAB test running flag to bypass client-side logging."))return v("_isRunningTABTest");return!1})()&&("dev"!==t&&o.e.isFeatureEnabled(c)||(function(){if(o.e.isFeatureEnabled(h))return!0;return v("enableAriaUpload")})())}function v(e){var t=!a.t.isActivated("6DC50D29-3FD6-465C-9E8D-80A877497A9D","10/10/2022","Ensure that a boolean value is returned and not undefined.");try{if("sessionStorage"in window&&window.sessionStorage){var n=window.sessionStorage[e],r=n&&"true"===n.toLowerCase();return t?!!r&&"undefined"!=typeof console&&!!console:r&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}},function(e,t,n){"use strict";n.d(t,"n",function(){return m});n.d(t,"e",function(){return y});n.d(t,"r",function(){return b});n.d(t,"t",function(){return w});var r=n(0),i=(n(250),n(300),n(301),n(305),n(302),n(239)),s=n(129),o=n(67),u=n(28),a=/[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}/gi;var f=["guestaccesstoken","access_token","prooftoken","tempauth","share","auth_token","auth_key","originalPath","querytext","querytemplate","selectproperties","hithighlightedproperties","refiners","sortlist","refinementfilters","collapsespecification","hiddenconstraints","querytemplatepropertiesurl","zerotermsuggestions","pageinfo","immediacyquerystring","immediacytitle","immediacyurl","k","q","InplaceSearchQuery","Default"],l=["/_api/search/","/_api/searchsetting/","/results.aspx","/osssearchresults.aspx","/peopleresults.aspx","/conversationresults.aspx","/videoresults.aspx","/sharepoint.aspx","/search.aspx","RenderListDataAsStream"];var c,h=n(9),p=n(48),d=n(60),v=!h.t.isActivated("05CA5404-D3C3-45DE-9B8A-9025897012D1","1/31/2023","Use CloudType instead of Env from spPageContext to determine Aria environment");function m(e){void 0===e&&(e={});var t,n=e.pageContext,r=void 0===n?window._spPageContextInfo:n,i=e.spModuleLink,s=void 0===i?window._spModuleLink:i,o=r.env||"devbox",u=r.cloudType||o,a="",f="",l=o;if(v){l=u;switch(u.toLowerCase()){case"devbox":case"edog":case"prodbubble":case"spdf":t="ppe";break;default:l="prod";t="prod"}}else switch(o.toLowerCase()){case"prod":case"dprod":t="prod";break;default:case"edog":case"prodbubble":t="ppe"}if(s){a=s.buildNumber;f=s.manifestName;s.usingRedirectCookie&&(a="dev")}return{version:a,manifest:f,appEnvironment:l,ariaEnvironment:t}}function g(e){e&&e.length>36&&(e=e.replace(/[{}]/g,""));return e}o.e.cleanString=function(e,t,n){return(function(e,t){void 0===t&&(t={});var n,r=t.keyDeclaration,i=t.pathsToSanitize,s=void 0===i?[]:i,o=t.keysToSanitize,f=void 0===o?[]:o;r&&r.isKey&&(e=e.replace(a,"<guid>"));if(e.indexOf("http")<0)return e;try{n=new u.e(e)}catch(t){return e}if(""===n.getAuthority())return e;for(var l=e,c=!1,h=0;h<s.length;h++)if(n.getPath().indexOf(s[h])>=0){c=!0;break}if(c)l="".concat(n.getScheme(),"://").concat(n.getAuthority()).concat(n.getPath(),"<scrubbedquerystring>...");else{for(var p=n.getQueryAsObject(),d=0;d<f.length;d++){var v=f[d];p[v]&&(p[v]="<scrubbed>")}n.setQueryFromObject(p);l=n.getDecodedStringForDisplay()}return l})(e,{key:t,keyDeclaration:n,keysToSanitize:f,pathsToSanitize:l})};i.e.init();function y(e){var t=(function(e){var t=m(e).ariaEnvironment,n=void 0===t?"ppe":t;return n&&e.tokens[n]})(e),n=(function(e){if(c)return c;var t=e.pageContext,n=void 0===t?window._spPageContextInfo:t,r=m(e),i=r.version,s=r.manifest,o=r.appEnvironment,u=n.isAnonymousGuestUser,a=n.currentUICultureName,f=n.systemUserKey,l=n.userLoginName,h=n.siteSubscriptionId,v=n.farmLabel,y=n.farmName,b=n.siteId,w=n.webTemplate,E=n.webId,S=n.ariaCollectorUrl,x=n.CorrelationId,T=n.cloudType,N=n.getAuthToken,C=n.homeTenantId,k=n.listId,L=n.SideBySideToken;return c={isAuthenticated:!u,market:a,session:e.sessionId||p.e.generate(),version:i,manifest:s,userId:f,accountType:l?d.e.Business:d.e.BusinessAnonymous,siteSubscriptionId:h,farmLabel:v,farmName:y,collectorUrl:S,environment:o,workload:e.workload,disableCookies:u,siteId:g(b),webTemplateId:w,webId:g(E),context:e.context,pageCorrelationId:x,cloudType:T,getAuthToken:N,resourceTenantId:C,listId:g(k),sideBySideToken:L,product:e.product}})(e);if(n){s.e.Init(t,n,e.ariaLoader,e.offlineDetection,e.customManager);e.initCustomerPromise&&s.e.InitCustomerPromise(t,n,e.ariaLoader,e.offlineDetection)}}function b(e,t){if(c){var n=void 0;n=!h.t.isActivated("822FAA33-162E-4C69-9EFA-C5212C551A18","12/16/2022","Actually persist InitContext value when updating the Aria Context.")?(function(e){return c?c=Object(r.e)(Object(r.e)({},c),e):null})(t):Object(r.e)(Object(r.e)({},c),t);s.e.UpdateContext(Object(r.e)(Object(r.e)({},n),{context:Object(r.e)(Object(r.e)({},c.context),e)}))}}function w(){if(c)return s.e.flushTelemetry()}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(0);function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(e,t){return Object(r.e)(Object(r.e)(Object(r.e)(Object(r.e)({},e),t),e.extraMetrics||t.extraMetrics?{extraMetrics:Object(r.e)(Object(r.e)({},e.extraMetrics||{}),t.extraMetrics||{})}:{}),e.extraData||t.extraData?{extraData:Object(r.e)(Object(r.e)({},e.extraData||{}),t.extraData||{})}:{})},e)}},function(e,t,n){"use strict";n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});n.d(t,"i",function(){return a});n.d(t,"t",function(){return f});n.d(t,"e",function(){return l});n.d(t,"s",function(){return c});n.d(t,"o",function(){return h});var r=n(0),i=n(12),s=n(137),o=((function(){function e(e,t){this._load=e;this._dependencies=t}e.prototype.load=function(){var e=this,t=this._load().then(function(t){return new o(t,e._dependencies)});this.load=function(){return t};return t}})(),(function(){function e(e,t){this._type=e;this.dependencies=Object(r.e)(Object(r.e)({},e.dependencies||{}),t||{})}e.prototype.create=function(e){var t=new this._type({},e);return{instance:t,disposable:t}};return e})()),u=(function(){function e(e,t){this._type=e;this.dependencies=Object(r.e)(Object(r.e)({},e.dependencies||{}),t||{})}e.prototype.create=function(e){return{instance:Object(i.r)(this._type,e)}};return e})(),a=(function(){function e(e){this._type=e;this.dependencies={}}e.prototype.create=function(){var e=new this._type;return{instance:e,disposable:Object(s.t)(e)?e:void 0}};return e})(),f=(function(){function e(e){this._load=e}e.prototype.load=function(){var e=this._load().then(function(e){return new l(e)});this.load=function(){return e};return e};return e})(),l=(function(){function e(e){this.dependencies={value:e.lazy}}e.prototype.create=function(e){return{instance:e.value()}};return e})();i.n.prototype.alias=function(e,t){return this.exposeFactory(e,new l(t))};function c(e,t,n){return new i.t({name:e,factory:new o(t,n)})}function h(e,t,n){return new i.t({name:e,factory:new u(t,n)})}},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(0),i=n(60),s=n(67),o=n(4),u=n(26),a=n(84),f=n(197);function l(e,t,n){var r={resultType:e};t&&(r.resultCode=t);n&&(r.error=n);return r}var c=(function(e){Object(r.r)(t,e);function t(t,n){return e.call(this,t,i.t.Start,n)||this}t.instrumentPromise=function(e,t,n,r,i,s,o){var a,c=new this(e,o);i&&c.setTimeout(i,s);try{a=t()}catch(e){c.end(l(u.e.Failure,"PromiseCreationFailed",e.toString()));throw e}a.then(function(e){var t;if(n)try{t=n(e)}catch(e){t=l(u.e.Failure,"GetSchemaException",e.toString())}else t=l(u.e.Success);c.end(t)},function(e){var t;if(r)try{t=r(e)}catch(e){t=l(u.e.Failure,"GetSchemaException",e.toString())}else if(e){t=l(e instanceof Error&&"Canceled"===e.name?u.e.ExpectedFailure:u.e.Failure,void 0,Object(f.e)(e))}else t=l(u.e.Failure);c.end(t)});return a};t.prototype.setTimeout=function(e,t){var n=this;this._clearTimeout();t||(t=l(u.e.Failure,"Timeout"));this.timeoutId=window.setTimeout(function(){n.end(t)},e)};t.prototype.verbose=function(e){if(!this.endTime&&this._isQosEvent()){var t=this.data;a.verbose(e,t.name)}};t.prototype.end=function(e){if(!this.endTime){this.endTime=e&&e.endTimeOverride||s.e.getTime();var t=Object(r.e)({duration:this.endTime-this.startTime},e);this._setData(t);this._logEvent(i.t.End);if(this._isQosEvent()){var n=this.data;n.error&&a.log(n.error,n.name,n.resultCode,n.resultType)}this._clearTimeout()}};t.prototype._clearTimeout=function(){if(this.timeoutId){window.clearTimeout(this.timeoutId);this.timeoutId=void 0}};t.prototype._isQosEvent=function(){return this.eventName.indexOf("Qos,")>=0};return t})(i.n);function h(e,t,n){var s=(function(e){Object(r.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t})(c),u=Object(r.e)(Object(r.e)({},t),{duration:{isPrefixingDisabled:!0,type:o.e.Number}});Object(i.r)(s.prototype,e,u,n);return s}},function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=(function(){function e(e){this._callbacks=[];this._owner=e}e.prototype.addCallback=function(e){this._callbacks.push(e)};e.prototype.dispose=function(){for(var e;e=this._callbacks.pop();)e.call(this._owner)};return e})();function i(e){return"function"==typeof e.dispose}function s(e,t){var n=e,i=n.dispose;("function"==typeof i&&i.disposalChain||(function(e){var t=new r(e),n=e.dispose,i=function(){t.dispose();if(n){e.dispose=n;e.dispose()}};e.dispose=i;i.disposalChain=t;return t})(n)).addCallback(t);return n}},function(e,t,n){"use strict";var r=(function(){function e(t,n){void 0===t&&(t=0);void 0===n&&(n=0);if(t instanceof e){var r=t;this.x=r.x;this.y=r.y}else{this.x=t;this.y=n}}e.areEqual=function(e,t,n){void 0===n&&(n=1e-6);return Math.abs(e.x-t.x)<n&&Math.abs(e.y-t.y)<n};e.getCenter=function(t){return t.reduce(function(e,t){return e.add(t)},e.ORIGIN).scale(1/t.length)};e.prototype.scale=function(t){return new e(this.x*t,this.y*t)};e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)};e.prototype.subtract=function(t){return new e(this.x-t.x,this.y-t.y)};e.prototype.distance=function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)};e.prototype.negate=function(){return new e(-this.x,-this.y)};e.prototype.abs=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};e.prototype.unit=function(){var e=this.abs();return this.scale(e&&1/e||0)};e.prototype.toString=function(){return"[Point ".concat(this.x,", ").concat(this.y,"]")};e.ORIGIN=new e;return e})();t.e=r},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){return e}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e.ScriptLoaded="share_scriptsLoaded";e.UIReady="share_uiReady";e.Ready="share_ready";e.Error="share_error";e.Resize="share_resize";e.GrantAccessCompleted="share_grantAccessCompleted";e.Dismiss="share_dismiss";e.ReadyForRecipients="share_readyForRecipients";e.OutlookClicked="share_outlookClicked";e.SendRecipients="atMention_defaultRecipients";e.ManageAccessClicked="share_manageAccessClicked";e.ShareCompleted="share_completed";e.MakeVisible="share_makeVisible";e.Destruct="share_destruct";e.ResetMakeVisible="share_resetMakeVisible";e.InstantLoadReady="share_instantLoadReady";e.ShareContextInformation="share_postContextInformation";e.Started="share_started";e.LinkSettingCompleted="share_linkSettingsCompleted";e.GetToken="share_getToken";e.DocumentInformation="share_documentInformation";e.SharingInfoBarInformation="share_sharingInfoBarInformation";e.SharingStoreReady="share_sharingStoreReady"})(r||(r={}))},function(e,t,n){"use strict";var r;(function(e){e[e.anyone=0]="anyone";e[e.workGroup=1]="workGroup";e[e.specificPeople=2]="specificPeople";e[e.onlyYou=3]="onlyYou";e[e.existing=4]="existing";e[e.chat=5]="chat";e[e.mail=6]="mail"})(r||(r={}));t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(e){this._cachedRect={width:0,height:0,top:0,left:0,bottom:0,right:0};this._resizeCallback=e;this._callbackDelayMilliseconds=20}e.prototype.checkSizeChangeForRef=function(e){e&&e.current&&this.checkSizeChange(e.current)};e.prototype.checkSizeChange=function(e){var t=this;if(e&&this._resizeCallback){var n=e.getBoundingClientRect();this._cachedRect.width===n.width&&this._cachedRect.height===n.height&&this._cachedRect.top===n.top&&this._cachedRect.right===n.right&&this._cachedRect.left===n.left&&this._cachedRect.bottom===n.bottom||(this._callbackDelayMilliseconds?setTimeout(function(){t._resizeCallback()},this._callbackDelayMilliseconds):this._resizeCallback());this._cachedRect=n}};return e})()},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=function(){var e,t;this.promise=new Promise(function(n,r){e=n;t=r});this.resolve=e;this.reject=t}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(122),s=(function(){function e(e,t){var n=this._pageContext=t.pageContext,s=t.tokenProvider,o=t.noRedirect,u=t.dataRequestorType,a=void 0===u?(function(e){Object(r.r)(t,e);function t(t){return e.call(this,t,{pageContext:n,tokenProvider:s,noRedirect:o})||this}return t})(i.t):u,f=e.dataSourceName,l=void 0===f?"DataSource":f;this.dataRequestor=new a({qosName:l})}e.prototype.getDataSourceName=function(){return this.dataSourceName};e.prototype.needsRequestDigest=function(e){return!0};e.prototype.getData=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){void 0===i&&(i="POST");var m=e(),g=r&&r(),y=this.needsRequestDigest(m);return this.dataRequestor.getData({url:m,parseResponse:t,qosName:n,additionalPostData:g,method:i,additionalHeaders:s,contentType:o,maxRetries:u,noRedirect:a,crossSiteCollectionCall:f,telemetryHandler:l,qosExtraData:c,needsRequestDigest:y,authToken:h,webAbsoluteUrl:p,useExactAuthToken:d,skipSyncClient:v})};return e})();t.t=s},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(67);function i(){return window.CUSTOMERPROMISE_MANAGER=window.CUSTOMERPROMISE_MANAGER||Object(r.t)()}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t={};if(e)for(var n=e.split("&"),r=0;r<n.length;r++){var i=n[r].split("=");if(void 0!==i[1]){i[1]=i[1].replace(/\+/g," ");t[i[0]]=decodeURIComponent(i[1])}}return t}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(0);var i=function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;e||(e=t&&t.navigator&&navigator.userAgent||"");var n,i=e,s=e.toLowerCase(),o=(function(e){e=e.toLowerCase();var t;function n(n){return t=RegExp("".concat(n,"(\\d+)([\\d.]*)")).exec(e)}var r=n("msie ")||n("trident.*rv:"),i=t&&"9"===t[1],s=!t&&n("edge/"),o=!t&&n("edg/"),u=!t&&n("fxios|firefox/"),a=!t&&n("(?:chrome|crios)/"),f=!t&&/safari\/(\d+)/.test(e);f&&n("version/");return{browserName:r?"IE":s?"Edge":o?"EdgeChromium":u?"Firefox":a?"Chrome":f?"Safari":"NA",isChrome:!!a,isEdge:!!s,isEdgeChromium:!!o,isFirefox:!!u,isIE:!!r,isIE9:!!i,isSafari:!!f,matchedBrowser:t}})(s),u={browserMajor:(n=o.matchedBrowser)&&parseInt(n[1],10)||0,browserMinor:n&&n[2]&&n[2].slice(1)||"0"},a=(function(e){e=e.toLowerCase();var t=/windows phone|wpdesktop/.test(e),n=t||/ipad|iphone|ipod|android/.exec(e),r=n&&n[0],i="android"===r,s="ipad"===r,o=!!r&&!i,u=!n&&e.indexOf("macintosh")>-1,a=!n&&e.indexOf("windows nt")>-1;return{isAndroid:i,isIOS:o,isIPad:s,isMac:u,isWindows:a,isWinPhone:!!t,isMobile:!!n,osName:a?"Windows":t?"Windows Phone":u?"OSX":o?"IOS":i?"Android":"NA"}})(s),f=a.isMobile,l=/electron\/\\d+[\\d.]*/.test(s),c=s.indexOf("winappwipenabled")>-1,h=!("undefined"==typeof window||!window.matchMedia)&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),p=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(s),d=!1,v=!1,m=!1,g=!1;if(t&&t.document){var y=document.createElement("style");y.type="text/css";d=!y.styleSheet;v="addBehavior"in HTMLDivElement.prototype;var b=document.createElement("input");b.type="file";var w=t.File,E=w&&w.prototype;g=!(!E||!(E.slice||E.mozSlice||E.webkitSlice));m="webkitdirectory"in b&&!l}return Object(r.e)(Object(r.e)(Object(r.e)(Object(r.e)({},o),u),a),{isElectron:l,osVersion:p?p[2]:"NA",isWindows81:!f&&/windows (?:8\.1|nt 6\.3)/.test(s),isWindows10:!f&&s.indexOf("windows nt 10")>-1,isWindows7:!f&&s.indexOf("windows nt 6.1")>-1,isWinAppWipEnabled:c,isPWA:h,areCSS3TransitionsSupported:!o.isIE||u.browserMajor>9,areTouchEventsSupported:!!t&&"ontouchstart"in t,isFolderUploadSupported:m,isHtml5FileUploadSupported:g,isRetinaSupported:!!t&&t.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:d,isWebDavSupported:v,userAgent:i})}},function(e,t,n){"use strict";n.d(t,"e",function(){return f});n.d(t,"t",function(){return l});var r=n(68),i=n(27),s=n(6),o=n(45),u=n(25),a={ODB:387},f="https://graph.microsoft.com",l=(function(){function e(e,t){this._pageContext=t.pageContext;this._sharingContextInformation=t.sharingContextInformation;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken);this.initializeDataStore()}e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&i.e.isFeatureEnabled(a);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableGraph",u.e.session));return e};e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableGraph",!0,u.e.session)};e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return r.t.resolve(this._graphToken);if(this._oAuthTokenProvider){var t=new s.e({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken(f).then(function(e){t.end({resultType:s.t.Success});return e},function(n){if(r.t.isCanceled(n)){t.end({resultType:s.t.ExpectedFailure,resultCode:"Canceled"});return r.t.reject(n)}t.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:s.t.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}});e.disableGraphCallsForPicker();return null})}return null};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new o.e("PeoplePicker",u.e.session))};return e})()},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.unknown=1]="unknown";e[e.odb=2]="odb";e[e.sharePoint=3]="sharePoint";e[e.ngsc=4]="ngsc";e[e.word=5]="word";e[e.powerpoint=6]="powerpoint";e[e.excel=7]="excel";e[e.onenoteWeb=8]="onenoteWeb";e[e.wac=9]="wac";e[e.visio=10]="visio";e[e.officecom=11]="officecom";e[e.listPart=12]="listPart";e[e.outlookWeb=13]="outlookWeb";e[e.odIos=14]="odIos";e[e.odAndroid=15]="odAndroid";e[e.teams=16]="teams";e[e.sample=17]="sample";e[e.odc=18]="odc";e[e.wordAndroid=19]="wordAndroid";e[e.excelAndroid=20]="excelAndroid";e[e.powerpointAndroid=21]="powerpointAndroid";e[e.wordIos=22]="wordIos";e[e.excelIos=23]="excelIos";e[e.powerpointIos=24]="powerpointIos";e[e.onenote=25]="onenote";e[e.teamsIos=26]="teamsIos";e[e.teamsAndroid=27]="teamsAndroid";e[e.onenoteIos=28]="onenoteIos";e[e.visioIos=29]="visioIos";e[e.onenoteAndroid=30]="onenoteAndroid";e[e.visioAndroid=31]="visioAndroid";e[e.outlookWindows=32]="outlookWindows";e[e.outlookMac=33]="outlookMac";e[e.onenoteUWP=34]="onenoteUWP";e[e.officemobileIos=35]="officemobileIos";e[e.officemobileAndroid=36]="officemobileAndroid";e[e.odcWac=37]="odcWac";e[e.outlookGroupsWeb=38]="outlookGroupsWeb";e[e.fluid=39]="fluid";e[e.modernFileExplorer=40]="modernFileExplorer";e[e.listsHome=41]="listsHome";e[e.listsIos=42]="listsIos";e[e.edgeEnterpriseNtp=43]="edgeEnterpriseNtp";e[e.officeFeed=44]="officeFeed";e[e.searchUx=45]="searchUx";e[e.consumerList=46]="consumerList";e[e.shareDemo=47]="shareDemo";e[e.onePlayer=48]="onePlayer";e[e.windowsShare=49]="windowsShare";e[e.streamIos=50]="streamIos";e[e.streamAndroid=51]="streamAndroid";e[e.loopIos=52]="loopIos";e[e.outlookAndroid=53]="outlookAndroid";e[e.outlookiOS=54]="outlookiOS";e[e.whiteboard=55]="whiteboard";e[e.businesscentral=56]="businesscentral";e[e.mslens=57]="mslens";e[e.pbidesktop=58]="pbidesktop";e[e.oneup=59]="oneup";e[e.sharePointPages=60]="sharePointPages"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r,i;function s(e,t){if(!r||i!==e){r=(function(e,t){var n,r=t||window._spPageContextInfo;r&&(n=e.webThemeProvider(r));return n})(e,t);i=e}return r}},function(e,t,n){"use strict";var r=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendButton{font-size:.875rem;font:-apple-system-title1;margin:0;padding:0;border-radius:.25rem;min-height:2rem;height:fit-content}.od-SendButton .ms-Button-label{font:-apple-system-body}@media screen and (-ms-high-contrast:active){.od-SendButton.send:focus,.od-SendButton.send:hover{background:highlight}}"}]);var s=n("react-lib"),o=n(403),u=n(309),a=n(366),f=n(55),l=n(89),c=n(10),h=n("prop-types-lib"),p=n(14),d=(function(e){Object(r.r)(t,e);function t(t,n){var r=e.call(this,t)||this;r._buttonRef=s.createRef();r._onSendLinkClicked=function(){r.props.onSendLinkClicked(r.props.messageText,r.props.subjectText)};r._platformDetection=n.platformDetection;return r}t.prototype.componentDidMount=function(){this._buttonRef&&this.props.shouldBeFocused&&this._buttonRef.current.focus()};t.prototype.render=function(){if(!this.props.ctaLabel)return null;var e=!1;if(this.props.currentSettings.audience===f.e.existing&&this.props.linkRecipients)for(var t=0,n=this.props.linkRecipients;t<n.length;t++){var r=n[t];if(void 0===this.props.permissionsMap[r.email]&&void 0===this.props.permissionsMap[r.userId]){e=!0;break}}var i=!!this.props.errorMessage||Object(c.B)(this.props.sharingInformation)||e||Object(c.p)(this.props.messageText)>this.props.maximumMessageLength||Object(c.p)(this.props.subjectText)>this.props.maximumSubjectLength;switch(this.props.sendButtonType){case l.e.button:return s.createElement(o.e,{className:"od-SendButton send",disabled:i,onClick:this._onSendLinkClicked,componentRef:this._buttonRef},this.props.ctaLabel);case l.e.link:return s.createElement("div",{className:"od-SendButton link"},s.createElement(a.e,{disabled:i,onClick:this._onSendLinkClicked},this._platformDetection.isAndroid?this.props.ctaLabel.toUpperCase():this.props.ctaLabel));case l.e.copyLink:var h=Object(p.A)(),d={color:h.palette.themeDarker,backgroundColor:h.palette.neutralLighter,borderColor:h.palette.neutralSecondary},v={root:{color:h.palette.themePrimary,backgroundColor:h.palette.white,borderColor:h.palette.neutralTertiary},rootHovered:d,rootFocused:d,rootDisabled:{color:h.palette.themeTertiary,backgroundColor:h.palette.white,borderColor:h.palette.neutralTertiary}};this.context.sharingStore.isConsumer()&&this.props.currentSettings.audience!==f.e.specificPeople&&(i=!1);return s.createElement(u.e,{className:"od-SendButton copy",onClick:this._onSendLinkClicked,styles:v,disabled:i},this.props.ctaLabel)}};t.contextTypes={platformDetection:h.object.isRequired,sharingStore:h.object.isRequired};return t})(s.Component);t.e=d},,function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return a});var r=n(0),i=n(49),s=n(9),o={unknown:"Unknown",spServiceResponse:"SPServiceResponse"},u=!s.e.isActivated("05F6D32A-E2A4-45FA-B486-30818AF5FC7E","03/17/2023","Stop process response error in GetDataError. Do it in DataRequestor instead"),a=(function(e){Object(r.r)(t,e);function t(n){var i=this,s=n.errorData,o=n.innerError instanceof t&&n.innerError.errorData,a=n.errorData||o||{status:0},f=a.message,l=void 0===f?void 0:f,c=a.correlationId,h=void 0===c?void 0:c,p=a.code,d=void 0===p?void 0:p,v=Object(r.s)(a,["message","correlationId","code"]),m="object"==typeof l?l?"string"!=typeof l.value||u?JSON.stringify(l):l.value:"".concat(l):l,g=s&&s.codes||{order:[],map:{}};if(o&&o.codes)for(var y=0,b=o.codes.order;y<b.length;y++){var w=b[y];if(!g.map[w]){g.order.push(w);g.map[w]=o.codes.map[w]}}var E=Object(r.e)(Object(r.e)(Object(r.e)(Object(r.e)(Object(r.e)({},"string"==typeof h?{correlationId:h}:{}),"string"==typeof d?{code:d}:{}),"string"==typeof m?{message:m}:{}),n),{extraData:Object(r.e)(Object(r.e)({},n.extraData||{}),{hasAuthChallenge:!!a.authenticate,status:a.status,infected:a.infected,groupThrottle:a.groupThrottle,statusText:a.statusText})});(i=e.call(this,E)||this).name="GetDataError";i.codes=g;i.errorData=a;for(var S=0,x=Object.keys(v);S<x.length;S++){i[w=x[S]]=v[w]}return i}return t})(i.e)},function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});function r(e){return decodeURIComponent(escape(atob(e)))}function i(e){try{return!!btoa(atob(e)).match(/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/)}catch(e){return!1}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){if(!e||0===e.length)return 0;for(var t=5381,n=0;n<e.length;n++){t=(t<<5)+t+e.charCodeAt(n);t&=t}return t}},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.IconButton{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.IconButton:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";outline:1px solid "},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);var s=n(382),o=n(419);function u(e){var t=e.iconProps,n=e.onClick,i=e.ariaLabel,u=e.tooltipContent,f=e.menuProps,l=e.menuIconProps,c=e.className,h=e.directionalHint,p=e.disabled;return r.createElement(s.e,{content:u,id:u,calloutProps:a,directionalHint:h},r.createElement(o.e,{className:c||"IconButton",iconProps:t,onClick:n,ariaLabel:i,menuProps:f,menuIconProps:l,disabled:p}))}var a={gapSpace:0,calloutMaxWidth:180}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r;(function(e){e[e.absolute=0]="absolute";e[e.relative=1]="relative";e[e.serverRelative=2]="serverRelative";e[e.dataUrl=3]="dataUrl"})(r||(r={}));var i=function(e,t){void 0===e&&(e="");void 0===t&&(t=!1);var n=e.indexOf("//"),i=e.indexOf("/"),o=n>-1&&n<=i?n+"//".length:-1,u=(function(e,t){if(t>-1){var n=e.indexOf("/",t);return n>-1?e.slice(0,n):e}return""})(e,o),a=u&&u.slice(o),f=e.slice(u.length),l=u?r.absolute:t&&s.test(e)?r.dataUrl:"/"===f[0]?r.serverRelative:r.relative,c=f.split("/");this.authority=u;this.domain=a;this.format=l;this.path=f;this.segments=c;this.value=e},s=/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[\w\W]*?[^;])*),(.+)$/},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(169);function i(e,t,n){var i,s,o,u,a,f,l,c=n||window;if(!(c&&c.performance&&e&&t))return{duration:-1};try{var h=performance.getEntriesByType("resource");if(!new r.e(e).authority){e=(c.location&&new r.e(c.location.href).authority)+e}for(var p=void 0,d=h.length-1;d>=0;d--){var v=h[d];if(v.startTime<t)break;decodeURIComponent(v.name)===decodeURIComponent(e)&&(p=v)}if(p){return s=(i=p).connectEnd,o=i.connectStart,u=i.decodedBodySize,a=i.domainLookupend,f=i.domainLookupStart,l=i.duration,{connectEnd:s,connectStart:o,decodedBodySize:u,domainLookupend:a,domainLookupStart:f,duration:void 0===l?-1:l,encodedBodySize:i.encodedBodySize,fetchStart:i.fetchStart,nextHopProtocol:i.nextHopProtocol,redirectEnd:i.redirectEnd,redirectStart:i.redirectStart,requestStart:i.requestStart,responseEnd:i.responseEnd,responseStart:i.responseStart,secureConnectionStart:i.secureConnectionStart,startTime:i.startTime,transferSize:i.transferSize,workerStart:i.workerStart}}return{duration:-1}}catch(e){return{duration:-1}}}},function(e,t,n){"use strict";n.d(t,"t",function(){return g});n.d(t,"e",function(){return y});var r,i=n(0),s=n(27),o=n(32),u=n(14),a=n(90),f=n(77),l={neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8"},c=n(9),h="#3d3e66",p="#e9eaf6",d="#616161",v="#ebebeb",m={black:"#242424",neutralDark:"#424242",neutralPrimary:d,neutralPrimaryAlt:d,neutralSecondary:"#8a8a8a",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#d1d1d1",neutralQuaternary:v,neutralQuaternaryAlt:v,neutralLight:"#f0f0f0",neutralLighter:"#f5f5f5",neutralLighterAlt:"#fafafa",white:"#fff",themeDarker:"#323348",themeDark:h,themeDarkAlt:h,themePrimary:"#5b5fc7",themeSecondary:"#9092c1",themeTertiary:"#a5a7cf",themeLight:"#385dc2",themeLighter:p,themeLighterAlt:p,accent:"#137ad1"};function g(e,t,n){var r;a.e.applyBatchedUpdates(function(){r=Object(u._)(y(e,t))});return r}function y(e,t){if(c.t.isActivated("0d6cef16-2b13-4ef6-94c6-60e57e73d2a3"))return(function(e,t){t&&o.e.initSPExpFeatures(t.ExpFeatures);s.e.evaluateCanOverride();if(!f.n){e=E({palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}},e)}var n=e.palette;n&&(n.black||n.neutralPrimary||n.white||n.neutralQuaternary)&&!(n.black&&n.white&&n.neutralPrimary&&n.neutralQuaternary&&0===n.black.indexOf("#000")&&0===n.white.toLowerCase().indexOf("#fff")&&0===n.neutralPrimary.indexOf("#333")&&0===n.neutralQuaternary.toLowerCase().indexOf("#d0d0d0"))||(e.palette=Object(i.e)(Object(i.e)({},e.palette),l));return e})(e,t);t&&o.e.initSPExpFeatures(t.ExpFeatures);s.e.evaluateCanOverride();return(function(e,t){switch(e){case r.noDefault:return b(t);case r.vivaHomeDefault:return(function(e){return w({palette:m},e)})(t);case r.spDefault:default:return(function(e){return w({palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}},e)})(t)}})((function(e){return f.n?r.noDefault:(function(e){var t;if(s.e.isFeatureEnabled({ODB:1712})&&!c.t.isActivated("a7baa93c-d9fa-4e23-aa22-5f51ad9fab63")&&e){var n=null===(t=e.featureInfo)||void 0===t?void 0:t.VivaBackendFeature;return n?n.Enabled:e.isCurrentSiteAVivaBackendSite}return!1})(e)?r.vivaHomeDefault:r.spDefault})(t),e)}function b(e){(function(e){var t=e.palette,n=!t.black&&!t.neutralPrimary&&!t.white&&!t.neutralQuaternary||t.black&&t.white&&t.neutralPrimary&&t.neutralQuaternary&&0===t.black.indexOf("#000")&&0===t.white.toLowerCase().indexOf("#fff")&&0===t.neutralPrimary.indexOf("#333")&&0===t.neutralQuaternary.toLowerCase().indexOf("#d0d0d0");return!(t&&!n)})(e)&&(e.palette=(t=e.palette,Object(i.e)(Object(i.e)({},t),l)));var t;return e}function w(e,t){return t=b(t=E(e,t))}function E(e,t){return e=Object(i.e)(Object(i.e)(Object(i.e)({},e),t),{effects:Object(i.e)(Object(i.e)({},e.effects),t.effects),fonts:Object(i.e)(Object(i.e)({},e.fonts),t.fonts),palette:Object(i.e)(Object(i.e)({},e.palette),t.palette)})}(function(e){e[e.noDefault=0]="noDefault";e[e.vivaHomeDefault=1]="vivaHomeDefault";e[e.spDefault=2]="spDefault"})(r||(r={}))},,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});function r(e){return!!e&&"function"==typeof e.addEventListener}function i(e){return!!e&&!!e.__events__}function s(e,t){var n=e,r=n.__declaredEvents=n.__declaredEvents||{};if("string"==typeof t)r[t]=!0;else for(var i=0;i<t.length;i++)r[t[i]]=!0}function o(e,t,n,s){var o,u=e;if(r(u)){if(document.createEvent){var a=document.createEvent("HTMLEvents");a.initEvent(t,s,!0);a.args=n;o=u.dispatchEvent(a)}}else for(;u&&!1!==o;)if(i(u)){var f=u.__events__[t];for(var l in f)if(Object.prototype.hasOwnProperty.call(f,l))for(var c=f[l],h=0;!1!==o&&h<c.length;h++){var p=c[h];p.objectCallback&&(o=p.objectCallback.call(p.parent,n))}u=s?u.parent:null}else u=null;return o}},,,function(e,t,n){"use strict";n.d(t,"t",function(){return C});n.d(t,"n",function(){return L});n.d(t,"r",function(){return A});n.d(t,"e",function(){return M});n(0);var r=n(141),i=(n(174),n(52)),s=n(35),o=n(32),u=n(72);function a(e,t,n){void 0===n&&(n=!1);var r=Date.now()-e.getTime();if(r<-5*u.n)return h(e,t);if(r<u.n)return f("LessThanAMinute",n);if(r<u.u)return f("AboutAMinute",n);if(r<u.t){return l(Math.floor(r/u.n),"XMinutes")}if(r<u.o)return f("AboutAnHour",n);if(r<u.e){return l(Math.floor(r/u.t),"XHours")}if(r<u.s){var i=e.toLocaleTimeString(t);return f("YesterdayAndTime",n).replace("{0}",i)}if(r<u.r){return l(Math.floor(r/u.e),"XDays")}return h(e,t)}function f(e,t,n,i){return r[["RelativeDateTime_",e,n?"Future":"",i?"Intervals":"",t?"_StartWithLowerCase":""].join("")]}function l(e,t,n,r){var i=f(t,!!r&&n,r),o=f(t,!1,r,!0);return(Object(s.i)(i,o,e)||"").replace("{0}",e+"")}var c={};function h(e,t){if("undefined"!=typeof Intl&&Intl.DateTimeFormat){c[t]||(c[t]=new Intl.DateTimeFormat(t));return c[t].format(e)}return e.toLocaleDateString(t)}var p,d,v,m,g,y,b,w,E,S,x=n(9),T=void 0,N={ODB:1469,ODC:"ChromiumDateFix"};function C(e,t){void 0===t&&(t=!1);return a(e,O(i.e.language),t)}function k(){var e=p(),t=_();if(window.Intl&&window.Intl.DateTimeFormat){var n={},r={hour:"2-digit",minute:"2-digit"};v=new Intl.DateTimeFormat(e,n);m=new Intl.DateTimeFormat(e,r);if(t){n.timeZone="UTC";r.timeZone="UTC"}g=new Intl.DateTimeFormat(e,n);y=new Intl.DateTimeFormat(e,r);b=v.format;w=m.format;E=g.format;S=y.format}else{b=E=function(t){return t.toLocaleDateString(e)};w=S=function(t){return t.toLocaleTimeString(e)}}}function L(e,t){if(!e)return"";b||k();var n=u.a(new Date,e);return(t?n?S:E:n?w:b)(e)}function A(e,t){return u.l(e,O(i.e.language),t)}function O(e){if(void 0===T)try{T=o.e.isFeatureEnabled(N)}catch(e){T=!1}return T&&(function(e){void 0===P&&(function(){P={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,r=D;n<r.length;n++){var i=r[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(P[i]=!0)}}catch(e){}})();if(e){e=e.toLowerCase();return P[e]}return})(e)?"en":e}function M(){var e=new Date(2e3,11,22);return e.toLocaleDateString(O(i.e.language),{day:"numeric",month:"numeric",year:"numeric"}).replace(e.getDate().toString(),"DD").replace((e.getMonth()+1).toString(),"MM").replace(e.getFullYear().toString(),"YYYY")}p=function(){for(var e,t=0,n=!x.t.isActivated("6f22587b-a676-47a0-b10c-3e037c3f7b14","03/11/2022","Use currentCultureName to display numbers and dates.")?[window.$Config&&window.$Config.mkt,i.e.cultureLCID,i.e.language,navigator.language,"en"].filter(function(e){return!!e}):[window.$Config&&window.$Config.mkt,i.e.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var r=n[t];try{(new Date).toLocaleDateString(r);e=r;break}catch(e){}}e=O(e);p=function(){return e};return e};function _(){if(void 0===d)try{var e=p();(new Date).toLocaleDateString(e,{timeZone:"UTC"});d=!0}catch(e){d=!1}return d}var D=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","hy-am","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","sq-al","ur-pk","uz-latn-uz","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","mk","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku"],P=void 0},function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHeader{align-items:center;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";display:flex;justify-content:flex-start;padding:0}.od-ShareHeader.V2{display:flex;overflow:hidden;width:100%}[dir=ltr] .od-ShareHeader.od-ShareHeader-withBackButton{padding-left:8px}[dir=rtl] .od-ShareHeader.od-ShareHeader-withBackButton{padding-right:8px}[dir=ltr] .od-ShareHeader.od-ShareHeader-withBackButton{padding-left:10px}[dir=rtl] .od-ShareHeader.od-ShareHeader-withBackButton{padding-right:10px}.od-ShareHeader-notification{display:flex;align-items:center}.od-ShareHeader-notification .od-ShareHeader-linkSuccessIcon{font-size:1.5rem;color:#107c10}.od-ShareHeader-linkSettings{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:';display:flex;margin:0;font-size:1.25rem;font-weight:600;font:-apple-system-title1}.od-ShareHeader-linkSettings.IE{margin-top:0}.teams .od-ShareHeader-linkSettings{font-weight:700;margin-top:32px}.od-ShareHeader-backgroundColor{background-color:transparent}.teams .od-ShareHeader-backgroundColor{background-color:transparent}.od-ShareHeader-moreContextualMenu .is-open{border:none;width:auto}.od-ShareHeader-buttons-left{padding-top:16px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-buttons-left{padding-left:8px}[dir=rtl] .od-ShareHeader-buttons-left{padding-right:8px}[dir=ltr] .od-ShareHeader-buttons-left{left:0}[dir=rtl] .od-ShareHeader-buttons-left{right:0}.od-ShareHeader-buttons-left.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right{padding-top:16px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-buttons-right{padding-right:8px}[dir=rtl] .od-ShareHeader-buttons-right{padding-left:8px}[dir=ltr] .od-ShareHeader-buttons-right{right:0}[dir=rtl] .od-ShareHeader-buttons-right{left:0}.od-ShareHeader-buttons-right.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right-fullscreen{padding:0;top:0;display:flex;flex-direction:row}[dir=ltr] .od-ShareHeader-buttons-right-fullscreen{right:0}[dir=rtl] .od-ShareHeader-buttons-right-fullscreen{left:0}.od-ShareHeader-buttons-right-fullscreen.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right-fullscreenV2{display:flex;flex-direction:row}[dir=ltr] .od-ShareHeader-buttons-right-fullscreenV2{padding-left:8px}[dir=rtl] .od-ShareHeader-buttons-right-fullscreenV2{padding-right:8px}.od-ShareHeader-buttons-right-fullscreenV2.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right-fullscreenV2.new{padding:0}.od-ShareHeader-buttons-right-wac{padding-top:8px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-buttons-right-wac{padding-right:8px}[dir=rtl] .od-ShareHeader-buttons-right-wac{padding-left:8px}[dir=ltr] .od-ShareHeader-buttons-right-wac{right:0}[dir=rtl] .od-ShareHeader-buttons-right-wac{left:0}.od-ShareHeader-moreOptionsIcon{font-size:1rem}.od-ShareHeader-closeButtonIcon{font-size:1rem}.od-ShareHeader-button{z-index:10}.od-ShareHeader-button:not(.od-ShareHeader-button-fabric){outline:transparent;position:relative;background:0 0;border:none;padding:0;width:1.875rem;cursor:pointer}.od-ShareHeader-button:not(.od-ShareHeader-button-fabric)::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareHeader-button:not(.od-ShareHeader-button-fabric):focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareHeader-button.od-ShareHeader-button-fabric{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:1rem;width:1.875rem;height:1.875rem}.od-ShareHeader-button:focus,.od-ShareHeader-button:hover{outline:1px solid black}.od-ShareHeader-title{align-items:flex-start;display:flex;flex-direction:column}.od-ShareHeader-filename-and-label{display:flex;flex-direction:row;align-items:center}.od-ShareHeader-viewName{font-size:1.25rem;font-weight:600;font:-apple-system-title1;margin:0 2rem 4px 0}[dir=rtl] .od-ShareHeader-viewName{margin:0 0 4px 2rem}.od-ShareHeader-viewName.new{margin:0}[dir=ltr] .od-ShareHeader-viewName.new{padding-left:16px}[dir=rtl] .od-ShareHeader-viewName.new{padding-right:16px}.od-ShareHeader-itemName{font-size:.75rem;font-weight:400;text-align:initial;width:100%;font:-apple-system-caption1;margin:0;white-space:nowrap}@media (forced-colors:active) and (prefers-color-scheme:dark){.od-ShareHeader-closeButtonIcon:focus,.od-ShareHeader-closeButtonIcon:hover{color:#fff}}@media (forced-colors:active) and (prefers-color-scheme:light){.od-ShareHeader-closeButtonIcon:focus,.od-ShareHeader-closeButtonIcon:hover{color:#000}}.od-ShareHeader-flexBox{display:flex;justify-content:space-between;align-items:center;width:100%;margin:0}@media screen and (-ms-high-contrast:active){.od-Share .od-ShareHeader-button{outline:1px solid "},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-Share .od-ShareHeader-button:focus,.od-Share .od-ShareHeader-button:hover{background-color:highlight}.od-Share .od-ShareHeader-button:focus .od-ShareHeader-closeButtonIcon,.od-Share .od-ShareHeader-button:hover .od-ShareHeader-closeButtonIcon{forced-color-adjust:none;background-color:highlight;color:highlighttext}}@media screen and (-ms-high-contrast:active){.od-Share .od-ShareHeader-button .od-ShareHeader-closeButtonIcon:focus,.od-Share .od-ShareHeader-button .od-ShareHeader-closeButtonIcon:hover{forced-color-adjust:none;background-color:highlight;color:highlighttext}}.od-ShareHeader-header-V2{display:flex;flex-direction:row;width:100%}.od-ShareHeader-title-V2{display:flex;flex-direction:column;overflow:hidden;width:100%}.od-ShareHeader-viewName-V2{font-size:1.25rem;font-weight:600;font:-apple-system-title1;margin:0}.od-ShareHeader-viewName-V2.new{margin:0;padding-left:1rem}"}]);var s=n(419),o=n(203),u=n(3),a=n("react-lib"),f=n("prop-types-lib"),l=n(35),c=n(15),h=n(10),p=n(1),d=n(30),v=n(58),m=n(8),g=n(225),y=n(392),b=m.y(),w=(function(e){Object(r.r)(t,e);function t(t,n){var r=e.call(this,t)||this;r._closeButtonRef=Object(a.createRef)();r._onInfoButtonClicked=function(){r._store.getEngagementHelper().linkSettingsLearnMoreClicked(r.props.engagementExtraData);window.open("https://go.microsoft.com/fwlink/?linkid=846149")};r._dismissComponent=function(e){e.stopPropagation();e.preventDefault();r._onDismiss()};r.state={target:null,headerAria:""};r._onDismiss=n.onDismiss;r._platformDetection=n.platformDetection;r._store=n.sharingStore;r._onManageExistingAccessClick=r._onManageExistingAccessClick.bind(r);return r}t.prototype.componentDidMount=function(){this.props.viewState===u.e.linkSuccess&&this._titleAriaText&&this._updateHeaderAria(this._titleAriaText)};t.prototype.render=function(){var e,t=this.props,n=this._platformDetection.isIE?"od-ShareHeader-linkSettings IE":"od-ShareHeader-linkSettings",r=this.props.mode===o.e.manageAccess?"od-ShareHeader-buttons-right-wac":"od-ShareHeader-buttons-right";this.props.fullScreenIframeMode&&(r="od-ShareHeader-buttons-right-fullscreen");if(t.mode===o.e.linkSettings||t.mode===o.e.manageAccess)return a.createElement("div",{className:"od-ShareHeader-flexBox"},a.createElement("h2",{className:n},this._getViewName()),!this.props.doNotrenderHeaderButtons&&a.createElement("div",{className:r},this._renderCloseButton()));var i=t.viewState===u.e.notify,s=i?"":" od-ShareHeader-backgroundColor",f=this.props.hasBackButton?" od-ShareHeader-withBackButton":"",l=this.props.title||(null===(e=this.props.hostOptions)||void 0===e?void 0:e.customHeaderString)||this._getViewName();this._titleAriaText=this.props.titleAria||l;var c="od-ShareHeader"+s+f+(b?"":" V2"),h=this.props.titleIsSubLevel||b?this.props.titleIsSubLevel?a.createElement("div",{className:"od-ShareHeader-title"},a.createElement("h2",{className:"od-ShareHeader-viewName od-ShareHeader-subheading",id:"od-shareHeader-viewTitle"},l),this._renderItemName()):a.createElement("div",{className:"od-ShareHeader-header"},a.createElement("div",{className:"od-ShareHeader-title"},a.createElement("h1",{className:"od-ShareHeader-viewName",id:"od-shareHeader-viewTitle"},l)),a.createElement("div",{className:"od-ShareHeader-filename-and-label"},this._renderItemName(),this.props.viewState===u.e.default?this._renderSensitivityLabel():null)):a.createElement("div",{className:"od-ShareHeader-header-V2"},a.createElement("div",{className:"od-ShareHeader-title-V2"},a.createElement("h1",{className:"od-ShareHeader-viewName-V2",id:"od-shareHeader-viewTitle"},l),a.createElement("div",{className:"od-ShareHeader-filename-and-label"},this._renderItemName(this.props.sensitivityLabelInformation?35:70),this.props.viewState===u.e.default?this._renderSensitivityLabel():null)));t.viewState===u.e.linkSuccess&&(h=a.createElement("div",{className:"od-ShareHeader-notification"},a.createElement(y.e,{iconName:"CheckMark",className:"od-ShareHeader-linkSuccessIcon"}),v.e(this.state.headerAria,"polite","alert"),a.createElement("h1",{className:"od-ShareHeader-viewName new",id:"od-shareHeader-viewTitle"},l)));var p=i?a.createElement("div",null):a.createElement("div",{className:c},h);return a.createElement("div",{className:"od-ShareHeader-flexBox"},p,!this.props.doNotrenderHeaderButtons&&this._renderRightHeaderButtons(!1,i,t.viewState))};t.prototype._renderSensitivityLabel=function(){if(this.props.sensitivityLabelInformation){var e="",t=this.props.item;if(t){var n=t.childCount>1?" (".concat(l.n(p.sn,t.childCount),")"):"";e=h.R("".concat(t.name," ").concat(n))}return a.createElement(g.e,{sensitivityLabelInformation:this.props.sensitivityLabelInformation,engagementExtraData:this.props.engagementExtraData,getGraphToken:this.props.getGraphToken,filename:e.split(" ").join("")})}};t.prototype._renderInfoButton=function(){if(this.props.viewState!=u.e.modifyPermissions)return null;var e=a.createElement(s.e,{className:"od-ShareHeader-button od-ShareHeader-button-fabric","aria-label":"".concat(p.Ln,": ").concat(p.ms,". ").concat(p.Gr),iconProps:{iconName:"Info"},onClick:this._onInfoButtonClicked});this._platformDetection.isMobile||(e=v.t(e,p.Ln,{position:d.e.bottomRightEdge}));return e};t.prototype._renderMoreButton=function(){if(!(this.props.viewState!==u.e.default&&this.props.viewState!==u.e.addPeople||this.props.hideShareDialogOverflowButton||this._store.isBundleShare())){var e={items:[{key:"manageaccess",text:p.Wn,ariaLabel:p.Wn,onClick:this._onManageExistingAccessClick}],styles:{list:{selectors:{".ms-ContextualMenu-itemText":{fontSize:"0.875rem"},".ms-ContextualMenu-link":{height:"2.25rem",lineHeight:"2.25rem"}}}}},t=a.createElement(s.e,{className:"od-ShareHeader-button od-ShareHeader-button-fabric",ariaLabel:p.or,menuIconProps:{iconName:"More",className:"od-ShareHeader-moreOptionsIcon"},menuProps:e});return this._platformDetection.isMobile?t:v.t(t,p.or,{position:d.e.bottomRightEdge})}};t.prototype._renderCloseButton=function(){var e,t,n,r=null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)&&void 0!==n?n:c.m(this.props.clientId);if(this._onDismiss&&r){var i=a.createElement(s.e,{componentRef:this._closeButtonRef,className:"od-ShareHeader-button od-ShareHeader-button-fabric","aria-label":p.Le,onClick:this._dismissComponent,iconProps:{iconName:"Cancel",className:"od-ShareHeader-closeButtonIcon"}});return this._platformDetection.isMobile?i:v.t(i,p.Le,{position:d.e.bottomRightEdge})}};t.prototype._renderRightHeaderButtons=function(e,t,n){var r;r="od-ShareHeader-buttons-right-fullscreen"+(b||this.props.viewState!==u.e.default||this.props.titleIsSubLevel?"":"V2");return e&&!t&&n===u.e.default?a.createElement("div",{className:r},this._renderMoreButton()):e&&(t||n!==u.e.default)?"":a.createElement("div",{className:r},this._renderInfoButton(),this._renderMoreButton(),this._renderCloseButton())};t.prototype._renderItemName=function(e){var t=this.props,n=t.item;if(n){var r=n.childCount>1?" (".concat(l.n(p.sn,n.childCount),")"):"";return a.createElement("div",{className:"od-ShareHeader-itemNameWrapper"},!t.hideItemName&&a.createElement("p",{className:"od-ShareHeader-itemName","aria-label":n.name},h.R("".concat(n.name," ").concat(r),e)))}};t.prototype._renderContextualMenu=function(){[].push({key:"editable",name:p.Wn,onClick:this._onManageExistingAccessClick})};t.prototype._onManageExistingAccessClick=function(){this.props.onManageExistingAccessClick&&this.props.onManageExistingAccessClick()};t.prototype._updateHeaderAria=function(e){this.setState({headerAria:e})};t.prototype._getViewName=function(){switch(this.props.viewState){case u.e.default:return p.Ho;case u.e.modifyPermissions:return p.Zn;case u.e.linksFromTemplateList:return p.tr;case u.e.permissionsList:return p.Wn;case u.e.policyDetails:return p.ws;case u.e.grantPermissions:return p.hn;case u.e.addPeople:return p.b;default:return p.Ho}};t.prototype.focusCloseButton=function(){if(this._closeButtonRef.current){this._closeButtonRef.current.focus();this.props.closeButtonOnFocus&&this.props.closeButtonOnFocus()}};t.contextTypes={onDismiss:f.func,platformDetection:f.object.isRequired,sharingStore:f.object.isRequired};return t})(a.Component)},,,,,function(e,t,n){"use strict";var r,i=n(95),s=n(41),o=n(197);(function(e){e[e.blocked=0]="blocked";e[e.exception=-1]="exception";e[e.timeout=-2]="timeout";e[e.abort=-3]="abort"})(r||(r={}));var u=(function(){function e(t){this._async=new i.e(this);var n=t.url,r=t.requestTimeoutInMS,s=void 0===r?e.DEFAULT_TIMEOUT_MS:r,o=t.json,u=t.responseType,a=void 0===u?"":u,f=t.headers,l=void 0===f?{}:f,c=t.withCredentials,h=void 0!==c&&c,p=t.needsCors,d=void 0!==p&&p,v=t.onProgress,m=t.onUploadProgress,g=t.method,y=void 0===g?o?"POST":"GET":g;this._url=n;this._requestTimeoutInMS=s;this._postData=o;this._headers=l;this._method=y;this._withCredentials=h;this._needsCors=d;this._responseType=a;this._progressCallback=v;this._uploadProgressCallback=m}e.prototype.abort=function(e){this._abortRequest()&&!e&&this._callFailureCallback(this._request,r.abort,!1)};e.prototype.start=function(e,t){var n=this;this._successCallback=e;this._failureCallback=t;var i=this._method,u=this._headers;try{this._request=this._getRequest();var a=this._progressCallback,f=this._uploadProgressCallback,l=this._request,c=this._responseType;a&&(l.onprogress=function(e){try{a(e)}catch(e){s.e.logError(e)}});f&&(l.upload.onprogress=function(e){try{f(e)}catch(e){s.e.logError(e)}});this._async.setTimeout(function(){n._completed||n._timeoutCallback()},this._requestTimeoutInMS);l.onreadystatechange=function(){if(!n._completed){var e=4;try{e=l.DONE||4}catch(e){}l.readyState===e&&n._requestEndCallback()}};l.open(i,this._url,!0);"withCredentials"in l&&(l.withCredentials=this._withCredentials);l.responseType=c;for(var h in u)l.setRequestHeader(h,u[h]);l.send(this._postData)}catch(e){s.e.logError(e,{origin:location?location.origin:"unknown",withCredentials:this._withCredentials,requestUrl:this._url,headers:Object(o.e)(u),method:i});this._abortRequest();this._callFailureCallback(this._request,r.exception,!1)}};e.prototype._getRequest=function(){var e=this;if(!this._needsCors||!window.XDomainRequest)return new XMLHttpRequest;var t=new XDomainRequest;t.setRequestHeader=function(){};t.onprogress=function(){};t.ontimeout=function(){};t.onload=function(){e._requestEndCallback()};return t};e.prototype._abortRequest=function(){var e=!1;if(!this._completed){this._completed=!0;this._async.dispose();try{this._request&&this._request.abort()}catch(e){}e=!0}return e};e.prototype._timeoutCallback=function(){if(!this._completed){this._abortRequest();this._callFailureCallback(this._request,r.timeout,!0)}};e.prototype._callSuccessCallback=function(e,t){try{this._successCallback&&this._successCallback(e,t)}catch(e){s.e.log(e)}};e.prototype._callFailureCallback=function(e,t,n){try{this._failureCallback&&this._failureCallback(e,t,n)}catch(e){s.e.log(e)}};e.prototype._requestEndCallback=function(){if(!this._completed){this._completed=!0;var e=r.exception;try{this._async.dispose();try{e=this._request.status}catch(e){}}catch(t){e=r.exception;s.e.log(t)}e<400&&e>0?this._callSuccessCallback(this._request,e):this._callFailureCallback(this._request,e,!1)}};e.DEFAULT_TIMEOUT_MS=3e4;return e})();t.e=u},function(e,t,n){"use strict";n.d(t,"e",function(){return x});var r=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHint{background:0 0;margin:0 16px;position:relative}.od-ShareHint.new{margin:0;padding:0;flex:1}.od-ShareHint.od-ShareHint--shimmerFadeout .od-ShareHint-shimmer{opacity:0;display:none}.od-ShareHint.od-ShareHint--loaded .od-ShareHint-data{opacity:1;line-height:1rem}.od-ShareHint .ms-Label{font-size:.75rem;padding:5px 8px;vertical-align:top}.od-ShareHint .ms-Icon--CaretDownSolid8{vertical-align:top;font-size:.625rem;padding-top:9px;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.od-ShareHint .od-ShareHint-data,.od-ShareHint .od-ShareHint-shimmer{display:flex;align-items:center}.od-ShareHint .od-ShareHint-data{font-size:.875rem;background:0 0;padding:10px 10px 10px 0;margin:0;opacity:0;transition:opacity .2s;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";border:0}@media screen and (-ms-high-contrast:active){.od-ShareHint .od-ShareHint-data{border:1px solid WindowText}}.od-ShareHint .od-ShareHint-data .od-ShareHint-iconHolder{vertical-align:top}.od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{display:inline-block;vertical-align:top;margin-top:4px;font-size:.625rem;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-left:auto}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-right:auto}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-left:4px}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-right:4px}.od-ShareHint div.od-ShareHint-data{border:0}.od-ShareHint button.od-ShareHint-data{width:100%}.od-ShareHint .od-ShareHint-shimmer{width:100%;position:absolute;top:0;box-sizing:border-box;border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:14px 10px;background:linear-gradient(to right, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 0, "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:" 50%, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 100%);background-size:90% 100%;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";background-clip:content-box;background-repeat:no-repeat;animation:2s ease-in-out infinite placeholderShimmer;transition:opacity .2s,visibility .2s}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer{width:2.25rem;height:1.5rem}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer svg{fill:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-text-shimmer{color:transparent;width:100%;height:1.5rem;border-bottom:4px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";border-top:4px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";box-sizing:border-box}.teams .od-ShareHint-data .od-ShareHint-chevron{transform:rotate(90deg);margin-top:0}.ms-TeachingBubble-closebutton{color:#fff}@keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}"}]);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHintDetail-status{padding:0 8px;vertical-align:middle}.od-ShareHintDetail-statusText{display:inline-block;font-size:.875rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font:-apple-system-body;word-break:break-word}[dir=ltr] .od-ShareHintDetail-statusText{margin-right:4px}[dir=rtl] .od-ShareHintDetail-statusText{margin-left:4px}.od-ShareHintDetail-statusText.accessSummaryLink{font-size:.75rem}.od-ShareHintDetail-statusText.unHealthy{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ShareHintDetail-statusText:hover{cursor:default}.od-ShareHintDetail-statusText:hover.clickable{cursor:pointer}.od-ShareHintDetail-statusText i{vertical-align:middle;padding-bottom:2px}.od-ShareHintDetail{height:100%;background-color:transparent;border:none}.od-ShareHintDetail.od-ShareHintDetail--clickable:hover{cursor:pointer}.od-ShareHintDetail.od-ShareHintDetail--clickable:hover .od-ShareHintDetail-statusText{text-decoration:underline}.od-ShareHintDetail-statusDetails{position:absolute;top:0}[dir=ltr] .od-ShareHintDetail-statusDetails{right:-36px}[dir=rtl] .od-ShareHintDetail-statusDetails{left:-36px}[dir=ltr] .od-ShareHintDetail-statusDetails{text-align:right}[dir=rtl] .od-ShareHintDetail-statusDetails{text-align:left}.od-ShareHintDetail-expirationText{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ShareHintDetail-iconsList{display:inline-block}.od-ShareHintDetail-item{display:inline-block;margin-bottom:0;font-size:.625rem;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .od-ShareHintDetail-item{margin-left:4px}[dir=rtl] .od-ShareHintDetail-item{margin-right:4px}.od-ShareHintDetail-item .ms-Icon{background-color:transparent;position:relative}.od-ShareHintDetail-item .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-ShareHintDetail-item-expired{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-ShareHintDetail-description{text-align:left}[dir=rtl] .od-ShareHintDetail-description{text-align:right}.od-ShareHintDetail-chevron{margin-left:4px;font-size:.5rem;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-ShareHintDetail-iconTooltipContent{font-size:.875rem}@media screen and (-ms-high-contrast:active){.od-ShareHintDetail.od-ShareHintDetail--clickable:hover .od-ShareHintDetail-statusText{color:highlight}}"}]);var s=n(392),o=n(55),u=n(242),a=n(202),f=n(382),l=n("react-lib"),c=n(35),h=n(1),p=n(176),d=n(10),v=n(266),m=n(8),g=n(15),y=n(52),b=n(308),w=(function(e){Object(r.r)(t,e);function t(t,n){var r=e.call(this,t)||this;r._renderStatusIcons=r._renderStatusIcons.bind(r);return r}t.prototype.render=function(){var e=this._getLabel(this.props.currentSettings),t="od-ShareHintDetail ".concat(this.props.isClickable?"od-ShareHintDetail--clickable":""),n=e+", "+h.Do;return l.createElement(b.e,{className:t,onClick:this.props.isClickable?this.props.onClickCallback:void 0,"aria-label":n},l.createElement("div",{className:"od-ShareHintDetail-description"},l.createElement("div",{className:"od-ShareHintDetail-status"},l.createElement("span",{className:"od-ShareHintDetail-statusText ".concat(this.props.isClickable?"clickable":"")},e,this._renderStatusIcons(),this._renderChevron(this.props.isClickable)))))};t.prototype._renderStatusIcons=function(){if(this.props.currentSettings){var e=this.props.currentSettings.expiration,t=this.props.currentSettings.hasPassword,n=this.props.currentSettings.preventDownload,r=[];e&&e.getTime()!==new Date(0).getTime()&&r.push({icon:"Calendar",tooltip:"".concat(c.n(h.Ut,Object(p.n)(e)))});t&&r.push({icon:"Lock",tooltip:h.jo});n&&r.push({icon:"Blocked2",tooltip:h.xs});this.props.currentSettings.audience!==o.e.existing&&this.props.currentSettings.isReview&&v.e[this.props.sharingInformation.fileExtension]&&r.push({icon:"Feedback",tooltip:h.Xr});this.props.currentSettings.audience===o.e.anyone&&this.props.currentSettings.trackLinkUsers&&r.push({icon:"ReminderPerson",tooltip:m.K()&&g.r(this.props.clientId)?h.ho:h.vo});var i=r.map(function(e,t){var n={onRenderContent:function(){return l.createElement("div",{className:"od-ShareHintDetail-iconTooltipContent"},e.tooltip)}};return l.createElement("i",{className:"od-ShareHintDetail-item"},l.createElement(f.e,{id:e.icon,tooltipProps:n},l.createElement(s.e,{iconName:e.icon,"aria-describedby":e.icon,styles:{root:{fontSize:"0.625rem",width:"2.75",height:"2.75"}}})))});return l.createElement("div",{className:"od-ShareHintDetail-iconsList"},i)}};t.prototype._renderChevron=function(e){if(e)return l.createElement(s.e,{iconName:y.e.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHintDetail-chevron",styles:{root:{fontSize:"0.625rem",width:"2.75",height:"2.75"}}})};t.prototype._getLabel=function(e){var t=this.props.companyName,n=this.props.sharingInformation.addressBarLinkSettings,r=this.props.sharingInformation.sharingAbilities;if(this.props.isAddressBarLinkHint&&n)return n.linkDisabled||!Object(d.i)(r)?h.is:c.n(h.Ze,t);if(!e)return"";if(e.preventDownload){if(e.audience===o.e.anyone)return h.I;if(e.audience===o.e.organization)return c.n(h.et,t);if(e.audience===o.e.specificPeopleFlex)return h._u}switch(e.sharingLinkKind){case u.e.direct:return e.audience===o.e.specificPeople?this.props.sharingInformation.requiresAccessApproval?h.oo:e.sharingRole?Object(d.P)(e.sharingRole)?h.ku:e.sharingRole===a.e.review?v.e[this.props.sharingInformation.fileExtension]?h.Au:h.Ou:h.Mu:e.isEdit?h.ku:h.Mu:h.Ot;case u.e.organizationView:return c.n(h.Ze,t);case u.e.organizationEdit:return c.n(h.Ke,t);case u.e.anonymousView:return h.F;case u.e.anonymousEdit:return h.O;case u.e.flexible:return this._getFlexibleLabel(e,t);default:return""}};t.prototype._getFlexibleLabel=function(e,t){return e.audience===o.e.existing?h.Ot:e.audience===o.e.specificPeopleFlex?e.sharingRole?e.sharingRole==a.e.manageList?h.Lu:Object(d.P)(e.sharingRole)?h.ku:e.sharingRole===a.e.review?v.e[this.props.sharingInformation.fileExtension]?h.Au:h.Ou:h.Mu:e.isEdit?h.ku:h.Mu:e.audience===o.e.customLabeledSpecificPeople?e.sharingRole===a.e.review?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?c.n(h.rt,this.props.customLabeledAudienceConfig.entityName):Object(d.f)(this.props.clientId,"review",this.props.customLabeledAudienceConfig,this.props.sharingInformation.fileExtension):e.isEdit?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?c.n(h.nt,this.props.customLabeledAudienceConfig.entityName):Object(d.f)(this.props.clientId,"edit",this.props.customLabeledAudienceConfig):this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?c.n(h.it,this.props.customLabeledAudienceConfig.entityName):Object(d.f)(this.props.clientId,"view",this.props.customLabeledAudienceConfig):e.audience===o.e.organization?e.sharingRole===a.e.review?v.e[this.props.sharingInformation.fileExtension]?c.n(h.Ge,t):c.n(h.Ye,t):e.sharingRole==a.e.manageList?c.n(h.Qe,t):e.isEdit?c.n(h.Ke,t):c.n(h.Ze,t):e.audience===o.e.anyone?e.sharingRole===a.e.review?v.e[this.props.sharingInformation.fileExtension]?h._:h.j:e.sharingRole==a.e.manageList?h.M:e.isEdit?h.O:h.F:""};return t})(l.Component),E=n(218),S=n(145);function x(e){var t,n,i=e.clientId,u=e.companyName,a=e.currentSettings,f=e.onShareHintClick,p=e.sharingInformation,v=e.linkRecipients,m=e.customLabeledAudienceConfig,g=e.isAddressBarLinkHint,b=e.addressBarLink,x=l.useRef(),T=Object(l.createRef)(),N=(l.useCallback(function(e){if(e)return l.createElement("div",{ref:T},l.createElement(s.e,{iconName:y.e.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHint-chevron",styles:{root:{fontSize:"1.3125rem",width:"2.75",height:"2.75"}}}))},[]),l.useCallback(function(){f&&f()},[f])),C=l.useCallback(function(){var e=a.audience;return e===o.e.anyone?S.e.anyone:e===o.e.organization?S.e.workGroup:e===o.e.existing?S.e.existing:e===o.e.customLabeledSpecificPeople?S.e.chat:S.e.specificPeople},[a]),k=l.useCallback(function(e){return e===S.e.anyone?h.Zi:e===S.e.workGroup?c.n(h.ns,u):e===S.e.existing?h.is:e===S.e.specificPeople?h.gs:void 0},[u]),L=!!f,A="od-ShareHint ".concat(Object(d.B)(e.sharingInformation)?"":"od-ShareHint--shimmerFadeout od-ShareHint--loaded"," new"),O="od-ShareHint-data ".concat(L?"od-ShareHint--clickable":"");t=l.createElement("div",{className:"od-ShareHint-shimmer"},l.createElement("div",{className:"od-ShareHint-iconHolder-shimmer"},l.createElement("svg",{viewBox:"0 0 15 10",width:"36",height:"24"},l.createElement("path",{d:"M0,0 L15,0 L15,10 L0,10 L0,0 Z M0,5 C0,7.76142375 2.23857625,10 5,10 C7.76142375,10 10,7.76142375 10,5 C10,2.23857625 7.76142375,2.22044605e-16 5,0 C2.23857625,-2.22044605e-16 0,2.23857625 0,5 L0,5 Z"}))),l.createElement("div",{className:"od-ShareHint-text-shimmer"}));if(g){var M=p.addressBarLinkSettings,_=p.sharingAbilities,D=(P=M.linkDisabled||!Object(d.i)(_)?S.e.existing:S.e.workGroup)===S.e.existing?h.is:c.n(h.ns,u);n=l.createElement("div",{className:O,ref:x},l.createElement("div",{className:"od-ShareHint-iconHolder"},l.createElement(E.e,{label:D,permissionsType:P,showLabel:!1})),l.createElement(w,{clientId:i,companyName:u,currentSettings:null,sharingInformation:p,linkRecipients:v,customLabeledAudienceConfig:null,isAddressBarLinkHint:!0,addressBarLink:b,isClickable:L,onClickCallback:N}))}else{D=k(P=C());var P,H=a.audience===o.e.customLabeledSpecificPeople&&m&&m.iconUrl;n=f?l.createElement("div",{className:O,ref:x},l.createElement("div",{className:"od-ShareHint-iconHolder"},l.createElement(E.e,{label:D,permissionsType:P,iconUrl:H,showLabel:!1})),l.createElement(w,{clientId:i,companyName:u,currentSettings:a,sharingInformation:p,linkRecipients:v,customLabeledAudienceConfig:m,isClickable:L,onClickCallback:N})):l.createElement("div",Object(r.e)({className:O},{autoFocus:!0}),l.createElement("div",{className:"od-ShareHint-iconHolder"},l.createElement(E.e,{label:D,permissionsType:P,iconUrl:H,showLabel:!1})),l.createElement(w,{clientId:i,companyName:u,currentSettings:a,sharingInformation:p,linkRecipients:v,customLabeledAudienceConfig:m,isClickable:L}))}return l.createElement("div",{"aria-label":h.Zn,className:A},n,t)}},function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(202),o=n(79),u=n(30),a=n(419),f=n(35),l=n(1),c=n(13);Object(c.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-RoleSelectorCompact-permissionButton{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}[dir=ltr] .od-RoleSelectorCompact-permissionButton{margin-left:8px}[dir=rtl] .od-RoleSelectorCompact-permissionButton{margin-right:8px}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorCompact-permissionButton:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton span.ms-Button-flexContainer{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton .od-RoleSelectorCompact-permissionButton-Chevron{font-size:.75rem;height:1rem;line-height:1rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton .od-RoleSelectorCompact-permissionButton-Chevron{font:-apple-system-body;height:auto}}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton i.ms-Button-icon{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton.simplified-share{height:100%;align-self:center;border-radius:0 4px 4px 0}[dir=ltr] .od-RoleSelectorCompact-permissionButton.simplified-share{margin-left:0}[dir=rtl] .od-RoleSelectorCompact-permissionButton.simplified-share{margin-right:0}.od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{display:flex;flex-direction:column;margin:8px}[dir=ltr] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:left}[dir=rtl] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:right}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";line-height:2.25rem;height:3.25rem;font-size:.875rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{font:-apple-system-body;height:auto!important}}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link.is-disabled{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:transparent;font-size:1rem;width:1rem;max-height:unset}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-itemText{font-size:.875rem;line-height:1.25rem;font:-apple-system-body}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText{font-size:.75rem;line-height:1rem;font:-apple-system-caption1}.od-RoleSelectorCompact-menuItem.od-RoleSelectorCompact-settingsItem .ms-Icon-placeHolder{display:none}.od-RoleSelectorCompact-menuItem.selected{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem.selected .ms-ContextualMenu-link{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem-stopSharing .ms-ContextualMenu-link{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-RoleSelectorCompact-menuItem-textWrapper.ms-ContextualMenu-secondaryText:hover{color:highlighttext}.ms-ContextualMenu-linkContent.ms-ContextualMenu-icon{color:highlighttext}@media screen and (-ms-high-contrast:active){.od-RoleSelectorCompact-menuItem-textWrapper.ms-ContextualMenu-secondaryText:hover{color:highlighttext}.ms-ContextualMenu-linkContent.ms-ContextualMenu-icon{color:highlighttext}button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover{background-color:highlight;border-color:highlight;color:highlighttext;forced-color-adjust:none}button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-icon,button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-menuIcon.od-RoleSelectorCompact-permissionButton-Chevron{color:highlighttext;font-weight:600;forced-color-adjust:none}}.od-RoleSelectorCompact-simplifiedPermissionsButton{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:0 4px 2px 0;height:100%;align-self:center;padding:2px}[dir=ltr] .od-RoleSelectorCompact-simplifiedPermissionsButton{margin-left:0}[dir=rtl] .od-RoleSelectorCompact-simplifiedPermissionsButton{margin-right:0}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-simplifiedPermissionsButton.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:focus{outline:unset}.od-RoleSelectorCompact-simplifiedPermissionsButton:focus span.ms-Button-flexContainer{outline:1px solid;border-radius:2px}.od-RoleSelectorCompact-simplifiedPermissionsButton span.ms-Button-flexContainer{height:100%;padding-left:10px;padding-right:10px}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton span.ms-Button-flexContainer{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-simplifiedPermissionsButton .od-RoleSelectorCompact-permissionButton-Chevron{font-size:.75rem;height:1rem;line-height:1rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton .od-RoleSelectorCompact-permissionButton-Chevron{font:-apple-system-body;height:auto}}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton i.ms-Button-icon{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-checkmarkIcon{font-size:.75rem;max-height:unset}"}]);var h,p=n("prop-types-lib"),d=n(58),v=n(31);(function(e){e.edit="edit";e.view="view";e.review="comment";e.fullControl="full-control";e.manageList="manage-list";e.divider="divider";e.stopSharing="stop-sharing";e.linkSettings="linkSettings"})(h||(h={}));var m=(function(e){Object(r.r)(t,e);function t(t,n){var r=e.call(this,t)||this;r._linkSettingsClickedInRoleSelector=function(){r.context.sharingStore.getEngagementHelper().linkSettingsInCompactRoleSelectorClicked({clientId:r.props.clientId,scenarioId:"",mode:r.props.mode});r.props.onLinkSettingsClicked()};r._onItemClicked=function(e,t){var n;switch(t.key){case h.fullControl:n=s.e.owner;break;case h.manageList:n=s.e.manageList;break;case h.edit:n=s.e.edit;break;case h.view:n=s.e.view;break;case h.review:n=s.e.review;break;default:n=s.e.none}r._selectedRole!==n&&r.props.onRoleChange(n,r.props.permissionId||"")};r._selectedRole=r._parseRole(t.sharingRole);r._menuOpen=!1;r._showSimplifiedDialog=1===v.s();return r}t.prototype.render=function(){var e=this;this._selectedRole=this._parseRole(this.props.sharingRole);var n,r=this.props,c=r.menuPermissionOptions,h=r.showLinkSettings,p=r.showStopSharing,v=this._getMenuItems({menuPermissionOptions:c,showLinkSettings:h,showStopSharing:p,sharingRole:this.props.sharingRole}),m=v.filter(function(e){return e.itemType!==o.e.Divider}).length;switch(this.props.sharingRole){case s.e.owner:n=l.un;break;case s.e.edit:n=l.ue;break;case s.e.review:n=l.pe;this.props.showDropdownWithOfficeReview&&(n=l.ce);break;case s.e.view:n=l.ge;break;case s.e.manageList:n=l.se;break;case s.e.none:n="";break;default:return null}var g={directionalHint:u.e.bottomRightEdge,shouldFocusOnMount:!0,items:v,isBeakVisible:!1,onItemClick:this._onItemClicked,onMenuOpened:function(){e._logRoleSelectorClicked(e.context.sharingStore);e._menuOpen=!0},onMenuDismissed:function(){e._menuOpen=!1},styles:t.menuItemStyles},y={iconName:"ChevronDown",className:"od-RoleSelectorCompact-permissionButton-Chevron"};if(this.props.shimmer)return i.createElement(a.e,{menuIconProps:y,iconProps:{iconName:"Stop"},className:"od-RoleSelectorCompact-permissionButton",menuProps:g,disabled:!0,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}});var b=this._menuOpen?f.n(l._n,this.props.ariaLabel,n,m):f.n(l.Dn,this.props.ariaLabel,n,m);return d.t(i.createElement(a.e,{menuIconProps:y,iconProps:this.getRoleIconName(this.props.sharingRole),className:this._showSimplifiedDialog?"od-RoleSelectorCompact-simplifiedPermissionsButton":"od-RoleSelectorCompact-permissionButton",menuProps:g,disabled:this.props.disabled,ariaLabel:b,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}}),n,{position:u.e.bottomRightEdge,styles:this._showSimplifiedDialog&&{root:{height:"100%",display:"flex"}}})};t.prototype._renderContent=function(e,t){return i.createElement(i.Fragment,null,t.renderCheckMarkIcon(e),t.renderItemIcon(e),i.createElement("div",{className:"od-RoleSelectorCompact-menuItem-textWrapper"},t.renderItemName(e),t.renderSecondaryText(e)),t.renderSubMenuIcon(e))};t.prototype._parseRole=function(e){return(e!==s.e.review||this.props.menuPermissionOptions.review.enabled)&&(e!==s.e.owner||this.props.menuPermissionOptions.fullControl.enabled)?e===s.e.restrictedview?s.e.view:e:s.e.edit};t.prototype._addRenderContent=function(e){var t=this;return e.map(function(e){return Object(r.e)(Object(r.e)({},e),{onRenderContent:t._renderContent})})};t.prototype._getMenuItems=function(e){var t=[],n=e.menuPermissionOptions,r=e.showLinkSettings,i=e.showStopSharing,u=e.sharingRole,a=n.fullControl,c=(a.enabled,a.shouldDisplay),p=void 0!==c&&c,d=n.review,v=(d.enabled,d.shouldDisplay),m=void 0!==v&&v,g=n.edit,y=g.enabled,b=void 0===y||y,w=g.shouldDisplay,E=void 0===w||w,S=n.view,x=(S.enabled,S.shouldDisplay),T=void 0===x||x,N=n.manageList,C=N.enabled,k=void 0!==C&&C,L=N.shouldDisplay,A=void 0!==L&&L,O={key:h.edit,text:A?l.ae:l.ue,disabled:!b,secondaryText:A?l.le:l.fe,ariaLabel:f.n(l.go,A?l.ae:l.ue,A?l.le:l.fe),className:"od-RoleSelectorCompact-menuItem ".concat(this._showSimplifiedDialog||u!==s.e.edit?"":"selected"),iconProps:{iconName:"Edit"},itemProps:{styles:{checkmarkIcon:this._showSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},canCheck:this._showSimplifiedDialog,isChecked:this._showSimplifiedDialog&&u===s.e.edit},M={key:h.view,text:l.ge,secondaryText:A?l.be:l.ye,ariaLabel:f.n(l.go,l.ge,A?l.be:l.ye),className:"od-RoleSelectorCompact-menuItem ".concat(this._showSimplifiedDialog||u!==s.e.view?"":"selected"),iconProps:{iconName:"View"},itemProps:{styles:{checkmarkIcon:this._showSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},canCheck:this._showSimplifiedDialog,isChecked:this._showSimplifiedDialog&&u===s.e.view},_={key:h.fullControl,text:l.un,secondaryText:l.an,ariaLabel:f.n(l.go,l.un,l.an),className:"od-RoleSelectorCompact-menuItem ".concat(this._showSimplifiedDialog||u!==s.e.owner?"":"selected"),iconProps:{iconName:"Signin"},itemProps:{styles:{checkmarkIcon:this._showSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},canCheck:this._showSimplifiedDialog,isChecked:this._showSimplifiedDialog&&u===s.e.owner},D={key:h.manageList,text:l.se,disabled:!k,secondaryText:l.oe,ariaLabel:f.n(l.go,l.se,l.oe),className:"od-RoleSelectorCompact-menuItem ".concat(this._showSimplifiedDialog||u!==s.e.manageList?"":"selected"),iconProps:{iconName:"EditListPencil"},itemProps:{styles:{checkmarkIcon:this._showSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},canCheck:this._showSimplifiedDialog,isChecked:this._showSimplifiedDialog&&u===s.e.manageList},P={key:h.review,text:l.pe,secondaryText:l.de,ariaLabel:f.n(l.go,l.pe,l.de),className:"od-RoleSelectorCompact-menuItem ".concat(this._showSimplifiedDialog||u!==s.e.review?"":"selected"),iconProps:{iconName:"Feedback"},itemProps:{styles:{checkmarkIcon:this._showSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},canCheck:this._showSimplifiedDialog,isChecked:this._showSimplifiedDialog&&u===s.e.review},H={key:h.review,text:l.ce,secondaryText:l.he,ariaLabel:f.n(l.go,l.ce,l.he),className:"od-RoleSelectorCompact-menuItem ".concat(this._showSimplifiedDialog||u!==s.e.review?"":"selected"),iconProps:{iconName:"Feedback"},itemProps:{styles:{checkmarkIcon:this._showSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},canCheck:this._showSimplifiedDialog,isChecked:this._showSimplifiedDialog&&u===s.e.review},B={key:h.divider,itemType:o.e.Divider},j={key:h.stopSharing,text:l.Pu,ariaLabel:l.Pu,canCheck:!1,onClick:this.props.onStopSharing,className:"od-RoleSelectorCompact-menuItem od-RoleSelectorCompact-menuItem-stopSharing",iconProps:{iconName:"Delete"}},F={key:"linkSettings",text:l.Zn,onClick:this._linkSettingsClickedInRoleSelector,iconProps:{iconName:"Settings"},className:"od-RoleSelectorCompact-menuItem",ariaLabel:l.Zn};p&&t.push(_);A&&t.push(D);E&&t.push(O);m&&(this.props.showDropdownWithOfficeReview?t.push(H):t.push(P));T&&t.push(M);i&&t.push(B,j);r&&t.push(B,F);return this._addRenderContent(t)};t.prototype._logRoleSelectorClicked=function(e){e.getEngagementHelper().compactRoleSelectorClicked({clientId:this.props.clientId,scenarioId:"",mode:this.props.mode})};t.prototype.getRoleIconName=function(e){var t;switch(e=this._parseRole(e)){case s.e.owner:t="Signin";break;case s.e.edit:t="Edit";break;case s.e.view:t="View";break;case s.e.review:t="Feedback";break;case s.e.manageList:t="EditListPencil";break;case s.e.none:t="";break;default:throw new Error("Sharing role does not exist")}return{iconName:t}};t.contextTypes={sharingStore:p.object.isRequired};t.menuItemStyles={subComponentStyles:{menuItem:{root:{height:"auto !important"},label:{margin:"0",fontSize:"0.875rem",fontWeight:"600",lineHeight:"1.3"},secondaryText:{paddingLeft:"0",fontSize:"0.75rem",lineHeight:"1.3",textAlign:"left",whiteSpace:"normal"}}}};return t})(i.Component)},,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(136),i=n(4),s=n(6),o=Object(r.e)({eventName:"Api,Qos,",shortEventName:"Api"},{url:i.e.String,privacyClassification:{isPrefixingDisabled:!0,type:i.e.String}},s.e).withData({privacyClassification:i.t.requiredService});t.t=o},function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(0),i=n(42),s=(function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,r=void 0===n||n;this._webAbsoluteUrl=t;this._encodeWebAbsoluteUrl=r;this._segments=[];this._parameters=[];this._rawParameters=[];this._lastParameterId=0}e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){var t=e.name,n=e.serializedValue;return"".concat(t,"=").concat(n)}).join("&"));t.push.apply(t,this._rawParameters);e=t.length?"?".concat(t.join("&")):"";var n=this._webUrl,i=void 0===n?this._webAbsoluteUrl:n,s=Object(r.o)([this._encodeWebAbsoluteUrl?encodeURI(i):i,"_api"],this._segments,!0);return"".concat(s.join("/")).concat(e)};e.prototype.segment=function(e){return this._extend({segments:[e]})};e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})};e.prototype.methodWithAliases=function(e,t){for(var n=this,r=[],i=0,s=Object.keys(t);i<s.length;i++){var o=s[i],u=t[o],a=n._autoParameter(u);n=a.apiUrl;r.push("".concat(o,"=").concat(a.name))}return n.segment("".concat(e,"(").concat(r.join(","),")"))};e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=this,i=[],s=0,o=t;s<o.length;s++){var u=o[s],a=r._autoParameter(u);r=a.apiUrl;i.push(a.name)}return r.segment("".concat(e,"(").concat(i.join(","),")"))};e.prototype.parameter=function(e,t){return this._parameter(e,t)};e.prototype.parameters=function(e){for(var t=this,n=0,r=Object.keys(e);n<r.length;n++){var i=r[n],s=e[i];t=t.parameter(i,s)}return t};e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})};e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})};e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a".concat(t);return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}};e.prototype._parameter=function(e,t){var n;n=(function(e){return!!e&&"object"==typeof e&&"json"in e})(t)?i.e.encodeRestUriStringToken(JSON.stringify(t.json)):(function(e){return!!e&&"object"==typeof e&&"guid"in e})(t)?"guid'".concat(t.guid,"'"):(function(e){return!!e&&"object"==typeof e&&"raw"in e})(t)?t.raw:"number"==typeof t||"boolean"==typeof t?"".concat(t):"'".concat(i.e.encodeRestUriStringToken(t),"'");return this._extend({parameters:[{name:e,serializedValue:n}]})};e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})};e.prototype._extend=function(e){var t,n,r,i,s,o;void 0===e&&(e={});var u=this.clone();u._webUrl=this._webUrl;u._lastParameterId=this._lastParameterId;(t=u._parameters).push.apply(t,this._parameters);(n=u._segments).push.apply(n,this._segments);(r=u._rawParameters).push.apply(r,this._rawParameters);"webUrl"in e&&(u._webUrl=e.webUrl);"lastParameterId"in e&&(u._lastParameterId=e.lastParameterId);"parameters"in e&&(i=u._parameters).push.apply(i,e.parameters);"rawParameters"in e&&(s=u._rawParameters).push.apply(s,e.rawParameters);"segments"in e&&(o=u._segments).push.apply(o,e.segments);return u};return e})(),o=(function(){function e(e){this._apiUrlType=(function(t){Object(r.r)(n,t);function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return n})(s)}e.prototype.build=function(){return new this._apiUrlType};e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var r=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>r?"".concat(e.substring(0,i),"_").concat(e.substring(i+1)):e}return"".concat(t,"/_api/contextinfo")};return e})()},function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});function r(e){if(!e)return{};try{var t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch(e){return{}}}function i(e){return e?r(decodeURIComponent(e).split(".")[1]):{}}function s(e){if(e){var t=e.azp||e.appid;if(t)return t;var n=e.nameid;return n&&"true"!==e.isuser&&n.split("@")[0]||void 0}}function o(e,t){void 0===t&&(t=Date.now());var n=t/1e3;if(!e)return!1;var r=e.exp,i=e.nbf;return("number"!=typeof i||n>=i)&&("number"!=typeof r||n<r)}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(){}e.hasItemPermission=function(t,n){return t&&t.permissions&&e.hasPermission(t.permissions,n)};e.hasPermission=function(e,t){return!!t&&!!e&&(t.Low&e.Low)>>>0===t.Low&&(t.High&e.High)>>>0===t.High};e.hasAny=function(t,n){return(n||[]).some(function(n){return e.hasPermission(t,n)})};e.hasIdentityPermission=function(t,n){return n&&t.webPermMasks&&e.hasPermission(t.webPermMasks,n)};e.viewListItems={High:0,Low:1};e.insertListItems={High:0,Low:2};e.editListItems={High:0,Low:4};e.deleteListItems={High:0,Low:8};e.approveItems={High:0,Low:16};e.openItems={High:0,Low:32};e.viewVersions={High:0,Low:64};e.deleteVersions={High:0,Low:128};e.cancelCheckout={High:0,Low:256};e.manageLists={High:0,Low:2048};e.viewFormPages={High:0,Low:4096};e.reviewListItems={High:0,Low:16384};e.viewPages={High:0,Low:131072};e.layoutsPage={High:0,Low:135168};e.addAndCustomizePages={High:0,Low:262144};e.applyThemeAndBorder={High:0,Low:524288};e.viewUsageData={High:0,Low:2097152};e.manageSubwebs={High:0,Low:8388608};e.managePermissions={High:0,Low:33554432};e.browseDirectories={High:0,Low:67108864};e.manageWeb={High:0,Low:1073741824};e.useClientIntegration={High:16,Low:0};e.manageAlerts={High:64,Low:0};e.createAlerts={High:128,Low:0};e.enumeratePermissions={High:1073741824,Low:0};e.useRemoteAPIs={High:32,Low:0};e.fullMaskWithoutACP={High:2147483647,Low:4294705151};e.fullMask={High:2147483647,Low:4294967295};return e})();t.t=r},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e,t){void 0===t&&(t=!0);e=encodeURI(e);t&&e&&(e=e.replace(/#/g,"%23"));return e}},,function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});n.d(t,"n",function(){return a});var r=n(106),i={word:["doc","docm","docx","docb","dot","dotm","dotx"],excel:["xls","xlsb","xlsm","xlsx","xlt","xltm","xltx"],powerpoint:["ppt","pptm","pptx","sldx","sldm","pot","potm","potx","pps","ppsm","ppsx"],onenote:["one"],visio:["vsd","vsdm","vsdx","vdw","vss","vssm","vssx","vst","vstm","vstx"],fluid:["fluid"],pdf:["pdf"],document:["epub","gdoc","odt","rtf","wri","pages"],presentation:["odp","gslides","key"],spreadsheet:["ods","gsheet","numbers"],txt:["dif","diff","readme","out","plist","properties","text","txt"],archive:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z","zip"],photo:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"],audio:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"],video:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4"," mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"],vector:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"],model:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"],csv:["csv"],xml:["xaml","xml","xsl"],html:["htm","html","mht"],code:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"],email:["eml","msg","ost","pst"],application:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"],font:["ttf","otf","woff"],sysfile:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},s=void 0;function o(e){return e?null!==e.itemType&&void 0!==e.itemType&&e.itemType!==r.e.File?r.e[e.itemType].toLowerCase():u(e.extension):"none"}function u(e){if(!e)return"none";if(!s){s={};Object.keys(i).map(function(e){i[e].forEach(function(t){s[t]=e})})}var t=s[e.toLowerCase()];return t||"other"}function a(e){return"word"===u(e)}},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(60),s=n(303),o=n(256),u=n(84),a=n(255),f=(function(){function e(e){var t=this;this.logEvent=function(e){var n=t._onLogEvent?t._onLogEvent(e):e;t._createLogHandler().then(function(e){return e(n)})};this._getAria=l(function(){return e.ariaLoader().then(function(t){(function(e,t){if(!e.LogManager.isInitialized()){e.LogManager.initialize(t.tenantToken,Object(r.e)(Object(r.e)({disableCookies:t.disableCookies},t.offlineCache?{browserOverrides:{onGetData:t.offlineCache.getData,onSaveData:t.offlineCache.saveData}}:{}),t.ariaLogConfiguration||{}));"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.addEventListener("beforeunload",function(){e.LogManager.flush()})}e.LogManager.addCallbackListener(function(e,n,r,i){r===t.tenantToken&&t.ariaQos&&t.ariaQos.reportQos({result:e,statusCode:n,events:i})})})(t,e);return t})});this._getLogger=l(function(){return t._getAria().then(function(r){var i=(function(e,t,n){void 0===n&&(n={});var r=new e.Logger(t);Object(o.e)(r,n);return r})(r,e.tenantToken,e.context),s=e.offlineDetection;return a.e&&s?n.ee([38],414).then(function(n){t._offlineEventQueue=n.makeOfflineAriaEventQueue(i,e.tenantToken,s);return[i,r]}):Promise.resolve([i,r])})});this._createLogHandler=l(function(){return t._getLogger().then(function(n){var r=n[0];return(function(e,t,n,r,o){void 0===n&&(n=!0);void 0===r&&(r=void 0);void 0===o&&(o=void 0);return function(f){try{if(f.enabled&&(f.eventType!==i.t.Start||n)&&(!r||!r.isQosEvent(f))){var l=Object(s.e)(e,f,u);a.e&&(null==o?void 0:o.storeEventIfNecessary(l))||t.logEvent(l)}}catch(t){var c=void 0;t instanceof e.Exception&&(c=new Error("Aria error: ".concat(t.toString())));t&&t.handled||u.log(c||t)}}})(n[1],r,e.logStartEvents,e.ariaQos,t._offlineEventQueue)})});this._onLogEvent=e.onLogEvent}e.prototype.attach=function(e){this._createLogHandler();var t=this.logEvent;e.addLogHandler(t).forEach(t);return function(){return e.removeLogHandler(t)}};e.prototype.updateContext=function(e){this._getLogger().then(function(t){var n=t[0];return Object(o.e)(n,e)})};e.prototype.flush=function(){return this._getAria().then(function(e){e.LogManager.flush()})};return e})();function l(e){var t=void 0;return function(){t||(t=e());return t}}},,,function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(0),i=(function(){function e(e){this._items=[];this._maxSize=e}Object.defineProperty(e.prototype,"isFull",{get:function(){return this._items.length>=this._maxSize},enumerable:!1,configurable:!0});e.prototype.getAll=function(){return this._items.slice()};e.prototype.push=function(e){this._items.length>=this._maxSize&&(this._items.length=0);this._items.push(e)};return e})(),s=(function(){function e(e){if(e<=0)throw new Error("Size must be positive");this._size=e;this._buffer=new Array(e);this._length=0;this._head=-1}e.prototype.push=function(e){this._length<this._size&&this._length++;this._head++;this._head===this._size&&(this._head=0);this._buffer[this._head]=e};e.prototype.popOldest=function(){if(0===this._length)return null;var e=(this._head-this._length+1+this._size)%this._size;this._length--;return this._buffer[e]};Object.defineProperty(e.prototype,"isFull",{get:function(){return this._length>=this._size},enumerable:!1,configurable:!0});e.prototype.getAll=function(){var e=this._head+1;return this._length<this._size?this._buffer.slice(0,e):Object(r.o)(Object(r.o)([],this._buffer.slice(e),!0),this._buffer.slice(0,e),!0)};return e})()},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t;try{var n=[];t=JSON.stringify(e,function(e,t){if(t===window)return"[window]";if(t instanceof HTMLElement)return"[HTMLElement]";if("function"==typeof t)return"[function]";if("object"==typeof t){if(null===t)return t;if(-1===n.indexOf(t)){n.push(t);return t}return"[circular]"}return t})}catch(e){t=JSON.stringify("[object]")}return t}},function(e,t,n){"use strict";var r=n(247),i=(function(){function e(e){this._itemUrlHelper=e.itemUrlHelper;this._sharingContextInformation=e.sharingContextInformation}e.prototype.getApiRoot=function(e,t,n){if(this._sharingContextInformation){var i=this._sharingContextInformation,s=i.isFolder,o=i.isListSharing,u=i.itemUrl,a=i.listId,f=i.listItemId,l=i.listUrl,c=i.resourceId,h=i.serverRelativeItemUrl,p=i.uniqueId,d=i.webAbsoluteUrl;if(o)return e.build().webByUrl({webUrl:d}).method("Lists",a);if(p){if(a)return e.build().webByUrl({webUrl:d}).segment("lists").method("getbyid",a).method("GetItemByUniqueId",p);var v=s?"GetFolderById":"GetFileById",m={guid:p};return e.build().webByUrl({webUrl:d}).method(v,m).segment("ListItemAllFields")}return l?e.build().webByUrl({listUrl:l}).method("GetListItem",h):u?e.build().webByUrl({webUrl:d}).method("GetFileByUrl",r.t(u)).segment("ListItemAllFields"):a&&f?e.build().webByUrl({webUrl:d}).method("Lists",a).method("GetItemById",f):e.build().webByUrl({webUrl:d}).method("GetListItemByResourceId",c)}var g;g=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var y=e.build().webByItemUrl(g).method("Lists",n);t.isRootFolder||(y=t.properties.ID?y.method("GetItemById",t.properties.ID):y.method("GetItemByUniqueId",t.properties.uniqueId));return y};e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl};e.prototype.canUseSecurable=function(e){var t=e.properties;return!!t&&(e.isRootFolder?!!e.list&&!!e.list.id:!!t.ID||!!t.uniqueId)};e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){if(t.has(e.loginName))return!1;t.add(e.loginName);return!0})}};return e})();t.e=i},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044"}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.none=0]="none";e[e.view=1]="view";e[e.edit=2]="edit";e[e.owner=3]="owner";e[e.review=6]="review";e[e.restrictedview=7]="restrictedview";e[e.submit=8]="submit";e[e.manageList=9]="manageList"})(r||(r={}))},function(e,t,n){"use strict";var r;(function(e){e[e.share=1]="share";e[e.copy=2]="copy";e[e.atMention=3]="atMention";e[e.linkSettings=4]="linkSettings";e[e.manageAccess=5]="manageAccess";e[e.notify=6]="notify";e[e.addPeople=7]="addPeople"})(r||(r={}));t.e=r},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.none=0]="none";e[e.link=1]="link";e[e.linkV2=2]="linkV2";e[e.linkInheritance=3]="linkInheritance";e[e.linkBundle=4]="linkBundle";e[e.direct=5]="direct";e[e.participant=6]="participant";e[e.linkSettings=7]="linkSettings";e[e.back=8]="back";e[e.shareDialogPasswordOnly=9]="shareDialogPasswordOnly";e[e.shareDialogExpirationOnly=10]="shareDialogExpirationOnly";e[e.shareDialogPasswordAndExpiration=11]="shareDialogPasswordAndExpiration";e[e.copyInterruptUpdate=12]="copyInterruptUpdate";e[e.copyInterruptRemove=13]="copyInterruptRemove";e[e.addressBarLinkOff=14]="addressBarLinkOff";e[e.shareDialogExternalSharing=15]="shareDialogExternalSharing"})(r||(r={}))},function(e,t,n){"use strict";var r=n(152);n.d(t,"e",function(){return r.e});var i=n(367);n.d(t,"t",function(){return i.e})},,,,function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(13);Object(s.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PeoplePickerContainer{display:flex;flex-direction:row;flex-wrap:nowrap}.od-Share-PeoplePickerContainer.space-between{justify-content:space-between}.od-Share-PeoplePickerContainer.normal{justify-content:normal}.od-Share-PeoplePickerContainer .od-Share-PeoplePicker-ErrorWarnings-wrapper,.od-Share-PeoplePickerContainer .od-Share-PeoplePicker-wrapper{max-width:calc(100% - (1.75rem + 34px));width:100%;flex-grow:1}.od-Share-PeoplePicker-flexGrow{flex-grow:1;height:100%}.od-Share-PeoplePicker-PeoplePickerIcon{font-size:1.5rem;padding-top:10px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker-PeoplePickerIcon{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker-PeoplePickerIcon{padding-right:12px}#od-Share-PeoplePicker-wrapper-id .ms-BasePicker-text::after{content:none}.od-Share-PeoplePicker-RoleSelector{align-self:flex-end;grid-row:1;grid-column:2;-ms-grid-row:1;-ms-grid-column:2;-ms-grid-row-align:end}[dir=ltr] .od-Share-PeoplePicker.withIcon{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker.withIcon{padding-right:12px}.od-Share-PeoplePicker .ms-Callout{width:100%}.od-Share-PeoplePicker .ms-Callout .ms-Suggestions{width:100%;min-width:100%}.od-Share-PeoplePicker .ms-BasePicker-text{min-height:26px;border:none;padding:0;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";display:block}.od-Share-PeoplePicker .ms-BasePicker-input{font-size:.75rem;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";width:100%}[dir=ltr] .od-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir=rtl] .od-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}@supports (font:-apple-system-body){.od-Share-PeoplePicker .ms-BasePicker-input{font:-apple-system-body;height:auto}}.od-Share-PeoplePicker .ms-BasePicker-input::-ms-clear{display:none;width:0;height:0}.od-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Share-PeoplePicker input.ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}@supports (font:-apple-system-caption1){.od-Share-PeoplePicker input.ms-BasePicker-input::placeholder{font:-apple-system-caption1;height:auto}}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:.75rem}.od-Share-PeoplePicker .ms-TextField-field{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{font-size:.75rem;font:-apple-system-caption1}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{font-size:.75rem}.od-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px;max-width:208px}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px;font-size:1rem}@supports (font:-apple-system-body){.od-Share-PeoplePicker .ms-PickerItem-content{font:-apple-system-body;height:auto}}.od-Share-PeoplePicker .ms-PickerItem-content.ms-Button--icon{width:2rem;height:100%}.od-Share-PeoplePicker .ms-PickerItem-content .ms-Button-flexContainer i.ms-Button-icon{font-size:1rem;height:1rem;line-height:1rem}.od-Simplified-Share-PeoplePicker{height:100%;padding:12px 6px 12px 0}.od-Simplified-Share-PeoplePicker.smaller-padding{padding:10px 6px 10px 0}.od-Simplified-Share-PeoplePicker .ms-Callout{width:100%}.od-Simplified-Share-PeoplePicker .ms-Callout .ms-Suggestions{width:100%;min-width:100%}.od-Simplified-Share-PeoplePicker .ms-BasePicker-text{min-height:unset;border:none;padding:0;display:block;height:100%}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input{font-size:.875rem;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";width:100%;height:100%;padding:0}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}@supports (font:-apple-system-body){.od-Simplified-Share-PeoplePicker .ms-BasePicker-input{font:-apple-system-body;height:auto}}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input::-ms-clear{display:none;width:0;height:0}.od-Simplified-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}@supports (font:-apple-system-caption1){.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input::placeholder{font:-apple-system-caption1;height:auto}}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:.875rem}.od-Simplified-Share-PeoplePicker .ms-TextField-field{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{font-size:.75rem;font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px;max-width:208px}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px;font-size:1rem}@supports (font:-apple-system-body){.od-Simplified-Share-PeoplePicker .ms-PickerItem-content{font:-apple-system-body;height:auto}}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content.ms-Button--icon{width:2rem;height:100%}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content .ms-Button-flexContainer i.ms-Button-icon{font-size:1rem;height:1rem;line-height:1rem}.od-Simplified-Share-PeoplePicker .ms-SelectionZone{height:100%}@media screen and (min-width:400px){.ms-Suggestions,.ms-Suggestions-none{width:370px!important}}.od-Share-PeoplePicker-Suggestions-Simplified-Share{width:432px!important}@media screen and (min-width:400px){.od-Share-PeoplePicker-Suggestions-Simplified-Share .ms-Suggestions,.od-Share-PeoplePicker-Suggestions-Simplified-Share .ms-Suggestions-none{width:432px!important}}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container{max-height:200px;width:100%}@supports (font:-apple-system-body){.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Suggestions-item,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container button.ms-Suggestions-itemButton{font:-apple-system-body;height:auto}}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-PeoplePicker-pickerPersona,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container div.ms-PeoplePicker-personaContent{font:-apple-system-headline;height:auto}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions.od-Share-PeoplePicker-Suggestions-condensed .ms-Suggestions-container{max-height:150px}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button{font-size:.75rem;height:2.5rem;font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button i.ms-Button-icon{font-size:1rem;width:1.5625rem;font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button span.ms-Button-label{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-none{font-size:.75rem;line-height:1.875rem}@supports (font:-apple-system-caption1){.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-none{font:-apple-system-caption1;height:auto}}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner{line-height:1.875rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-circle{width:1.25rem;height:1.25rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-label{font-size:.75rem}@supports (font:-apple-system-caption1){.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-label{font:-apple-system-caption1;height:auto}}.od-Share-PeoplePicker-error{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";display:block;margin-bottom:4px;font:-apple-system-caption2}[dir=ltr] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-left:5px}[dir=rtl] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-right:5px}.od-Share-PeoplePicker-warning{word-break:break-word;font:-apple-system-caption2}.od-Share-PeoplePicker-warning .ms-MessageBar{display:block;padding:6px;box-sizing:border-box}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-text{margin:0}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 5px 0 0}[dir=rtl] .od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 0 0 5px}.od-Share-PeoplePicker-selectedItem--error .ms-PickerPersona-container{border-style:solid;border-width:1px;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";background-color:RGBA("},{theme:"redDark",defaultValue:"#a4262c"},{rawString:", .06);font:-apple-system-caption2}.od-Share-PeoplePicker-resolve-spinner{padding:3px}@media screen and (-ms-high-contrast:active){.od-Share-PeoplePicker-Suggestions .ms-Button.is-suggested .od-Share-PeoplePicker-Suggestions .ms-Persona .od-Share-PeoplePicker-Suggestions .ms-Persona-details .od-Share-PeoplePicker-Suggestions .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast:active){.od-Share-PeoplePicker-Suggestions .ms-Button:hover .od-Share-PeoplePicker-Suggestions .ms-Persona .od-Share-PeoplePicker-Suggestions .ms-Persona-details .od-Share-PeoplePicker-Suggestions .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast:active){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText:hover,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-personaContent:hover,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-pickerPersona:hover,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-item:hover{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:highlighttext;forced-color-adjust:none}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-personaContent,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-pickerPersona,.od-Share-PeoplePicker-Suggestions .ms-Persona-secondaryText{color:inherit}}@media (forced-colors:active) and (prefers-color-scheme:dark){::placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#fff!important;forced-color-adjust:none}}@media (forced-colors:active) and (prefers-color-scheme:light){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText,::placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#000!important;forced-color-adjust:none}}.od-RoleSelectorCompact-permissionButton:focus{outline:1px solid}.od-Share-PeoplePicker-selectedItem--error{display:flex}.od-Share-PeoplePicker-height{height:100%}"}]);var o=n(383),u=n(23),a=n(499),f=n(2),l=n(498),c=n(382),h=n(30),p=n(419),d=n(392),v=n(336),m=n(35);Object(s.t)([{rawString:"@media screen and (-ms-high-contrast:active){.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-secondaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-secondaryText{color:HighlightText}}.ms-PickerPersona-container{position:relative;display:inline-flex;vertical-align:top;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:';margin:1px;vertical-align:top;white-space:nowrap;cursor:default;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ms-PickerPersona-container::-moz-focus-inner{border:0}.ms-PickerPersona-container{outline:transparent}.ms-PickerPersona-container{position:relative}.ms-Fabric--isFocusVisible .ms-PickerPersona-container:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:"}.ms-PickerPersona-container:hover{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.ms-PickerPersona-container.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}.ms-PickerPersona-container.is-selected:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.ms-PickerPersona-container.is-listbelow{width:100%}.ms-PickerItem-sideContent{display:inline-block}.ms-PickerPersona-content{flex:1;vertical-align:middle;min-width:100px}.ms-PeoplePicker-personaContent{min-width:100px;padding:7px 12px;display:flex;align-items:center}.od-PeoplePicker-linkedInLogo{color:#0077b5}.itemContent_780e3396{flex:0 1 auto;min-width:0;max-width:100%;overflow:hidden}.peoplePickerPill_780e3396{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:24px;border-radius:12px;display:inline-flex;align-items:center;margin:4px}.peoplePickerClose_780e3396{border-radius:12px;height:24px;width:24px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}html[dir=ltr] .peoplePickerClose_780e3396{padding-left:4px}html[dir=rtl] .peoplePickerClose_780e3396{padding-right:4px}.peoplePickerClose_780e3396:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:";border-radius:12px}.placeholderUser_780e3396{background-color:unset;outline:1px dashed;outline-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}]);var g,y=n(128),b=n(32),w=n(245),E=n(9),S=n(14),x={ODB:60596};function T(e){var t,n;return!E.e.isActivated("E453BAFB-1A08-4222-89F4-568CF37CA2B8","11/02/2021","Placeholder sharing")&&b.e.isFeatureEnabled(x)&&!(!e.invitationId&&!(null===(n=null===(t=e.rawData||e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.invitation))}(function(e){e[e.standalone=0]="standalone";e[e.pill=1]="pill"})(g||(g={}));function N(e,t){void 0===t&&(t={});var n=Object(S.A)(),r=t.fontSize;return{coinProps:{styles:{initials:e===g.standalone?{border:"1px dashed ".concat(n.palette.themePrimary),boxSizing:"border-box",fontSize:null!=r?r:"16px",fontWeight:"normal",color:n.palette.themePrimary}:{border:"none",boxSizing:"border-box",fontSize:null!=r?r:"12px",color:n.palette.themePrimary,paddingLeft:"4px",paddingRight:"4px"}}},initialsColor:f.e.transparent,onRenderInitials:function(){return i.createElement(d.e,{iconName:"Contact",style:{fontWeight:"normal"}})}}}var C=b.e.isFeatureEnabled({ODC:"ToolTipEmailKillSwitch"})||E.e.isActivated("2f7a87f9150a4ef3b35a1ad82e402730","08/28/2021","ToolTipEmailKillSwitchActivated");function k(e,t,n){var r="3rem";if(t)switch(t){case f.n.size24:r="1.5rem";break;case f.n.size32:r="2rem";break;case f.n.size40:r="2.5rem";break;case f.n.extraSmall:r="1.75rem";break;default:r="3rem"}var i={text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:r,height:r,maxWidth:"75px",maxHeight:"75px",flexShrink:0},image:{width:r+"!important",height:r+"!important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:r,height:r,maxWidth:"75px",maxHeight:"75px"},initials:{width:r,height:r,fontSize:"0.625rem",lineHeight:r}}},styles:{root:{height:"auto"},primaryText:{height:"auto",whiteSpace:"normal",fontSize:"0.875rem"},secondaryText:{height:"auto",whiteSpace:"normal",fontSize:"0.75rem"}}};return T(e)&&void 0!==n?Object(w.default)(i,N(n)):i}var L=function(e){return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(l.e,Object(r.e)({},e.personaProps,{presence:f.t.none,size:f.n.size40,className:"ms-PeoplePicker-pickerPersona"})),e.person.entityType===u.e.linkedinUser&&i.createElement(d.e,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},A=function(e){var t,n=e.item,s=e.onRemoveItem,o=e.index,u=e.selected,a=e.removeButtonAriaLabel,d=k(n,f.n.extraSmall,g.pill);C||(d.onRenderPrimaryText=function(){return i.createElement(c.e,{content:n.email||d.text,directionalHint:h.e.topLeftEdge},d.text)});return i.createElement("div",{className:Object(v.e)("ms-PickerPersona-container",(t={"is-selected":!!u},t.placeholderUser_780e3396=T(n),t)),"data-is-focusable":!0,"data-selection-index":o,key:o,role:"listitem"},i.createElement("div",{className:Object(v.e)("ms-PickerItem-content","itemContent_780e3396")},i.createElement(l.e,Object(r.e)({},d,{presence:f.t.none,size:f.n.extraSmall}))),i.createElement(p.e,{styles:{root:{flexShrink:0}},onClick:s,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":null!=a?a:m.n(y.t,n.name),disabled:e.disabled}))},O=function(e){var t=e.item,n=e.onRemoveItem,s=e.index,o=e.selected,u=k(t,f.n.size40),a="PickerPersonaId"+Math.floor(1e4*Math.random()),c=m.n(y.t,t.name);return i.createElement("div",{className:Object(v.e)("ms-PickerPersona-container is-listbelow",{"is-selected":!!o}),"data-is-focusable":!0,"data-selection-index":s,key:s,"aria-labelledby":a,role:"listitem"},i.createElement("div",{className:"ms-PickerPersona-content"},i.createElement(l.e,Object(r.e)({id:a},u,{presence:f.t.none,size:f.n.size40}))),i.createElement("div",{className:"ms-PickerItem-content"},i.createElement(p.e,{onClick:n,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":c})))},M=n(490),_=(function(e){Object(r.r)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.onClick=function(e){t.props.inputProps&&t.props.inputProps.onClick&&t.props.inputProps.onClick(e);0!==e.button||e&&e.target&&e.target.value||t.onEmptyInputFocus()};t.onInputFocus=function(e){var n,r;D()||null===(r=null===(n=t.props.inputProps)||void 0===n?void 0:n.onFocus)||void 0===r||r.call(n,e)};return t}return t})(M.e);function D(){return E.t.isActivated("f7dc3d8b-8019-4187-9e11-6dcb2597352b")}var P,H=n(68),B=n(235),j=n(45),F=n(25),I=n(165),q=(function(e){Object(r.r)(t,e);function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;n._MaxItems=200;n._Version=5;n._buffer=n.getValue(t._StorageKey);n._buffer&&n._buffer.version===n._Version&&n._buffer.lastCachePrune||n.initializeBuffer();n._data={};if(Date.now()<n._buffer.lastCachePrune+6048e5)for(var r=0;r<n._buffer.dataArray.length;r++){var i=n._buffer.dataArray[r],s=n._getItemKey(i);n._data[s]=i}else{n.initializeBuffer();n.setValue(t._StorageKey,n._buffer)}return n}t.clear=function(){new j.e(t._Key,t._DataStoreCachingType).remove(t._StorageKey)};t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone};t.prototype.setItem=function(e){var n=this._getItemKey(e),r=this._data[n];if(r){if(t.isCacheEntryFresh(r,e))return;var i=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[i]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++;this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var s=this._buffer.dataArray[this._buffer.index],o=this._getItemKey(s);delete this._data[o];this._buffer.dataArray[this._buffer.index]=e}else{this._buffer.dataArray.push(e);this._buffer.index++}this._data[n]=e;this.setValue(t._StorageKey,this._buffer)};t.prototype.getItems=function(e,t){for(var n=[],r=0;r<this._buffer.dataArray.length;r++){var i=(this._buffer.index-r+this._MaxItems)%this._MaxItems,s=this._buffer.dataArray[i];!(s.email&&s.email.toLowerCase().indexOf(e.toLowerCase())>=0||s.name&&s.name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&s.entityType===u.e.externalUser||n.push(s)}return n};t.prototype.containsItem=function(e){var t=this._getItemKey(e);return Boolean(this._data[t])};t.prototype.initializeBuffer=function(){this._buffer={};this._buffer.dataArray=[];this._buffer.index=-1;this._buffer.version=this._Version;this._buffer.lastCachePrune=Date.now()};t.prototype._getItemKey=function(e){return e.email||e.userId||Object(I.e)(JSON.stringify(e)).toString()};t._Key="ClientPeoplePicker";t._StorageKey="MRU";t._DataStoreCachingType=F.e.local;return t})(j.e),R=(function(){function e(e){this._dataSource=e.peoplePickerDataSource?e.peoplePickerDataSource:new B.e({imageAbsoluteWebUrl:e.imageAbsoluteWebUrl},{pageContext:e.pageContext,apiUrlHelper:e.apiUrlHelper,graphPeoplePickerHelper:e.graphPeoplePickerHelper});this._ppCapabilities=this._dataSource.getCapabilities();if(this._ppCapabilities.supportsMruCaching){this._mruCache=new q;this.MaxCacheSuggestions=5}else this.MaxCacheSuggestions=0}e.prototype.search=function(e,t){var n,r,i=this,s={cached:null,promise:null};this._mruCache&&!t.groupID&&(r=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(s.cached=r);s.promise=new H.t(function(s,o){n=i._dataSource.search(e,t).then(function(e){if(e)if(r){r.length>0&&(r=i._removeStaleCacheResults(r,e));var t=r.map(function(e){return e.userId});s(e.filter(function(e){return t.indexOf(e.userId)<0}))}else s(e)},function(e){o(e)})},function(){n&&n.cancel()});return s};e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){n._mruCache&&e.isResolved&&n.addToMruCache(e);return e})};e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})};e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)};e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)};e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)};e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t).then(function(e){return e})};e.prototype.canUseGraph=function(e){return this._dataSource.canUseGraph(e)};e.prototype.canUseSubstrate=function(e){return this._dataSource.canUseSubstrate(e)};e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper()};e.prototype.searchMruCache=function(e,t){var n=[],r=this._mruCache;if(r){n=r.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n};e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),r=[];t.forEach(function(t){var i=n.indexOf(t.userId);if(i>-1){var s=e[i];q.isCacheEntryFresh(s,t)&&r.push(s)}});return r};return e})(),U=n(29);(function(e){e[e.normal=0]="normal";e[e.listBelow=1]="listBelow"})(P||(P={}));Object(s.t)([{rawString:".ms-Suggestions{width:260px}"}]);var z,W=E.t.isActivated("41868B4D-8044-4ACF-8E89-CFD71EF69C3D","10/31/2021","fix people picker suggestion dup"),X=_,V=M.t,$=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n._onResolveSuggestions=function(e){if(n._peoplePickerSearchPromise){n._peoplePickerSearchPromise.cancel();n._peoplePickerSearchPromise=void 0}if(!(e=e.trim())&&!n._canCallGraph)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var t=n._getPeoplePickerQueryParams(),r=null==t?void 0:t.conversationId;t&&t.conversationId&&delete t.conversationId;var i="peoplePickerSearch_".concat(e.trim(),"_").concat(JSON.stringify(t));t&&r&&(t.conversationId=r);var s=function(){var r=n._dataProvider.search(e.trim(),t);if(!r)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var i=r.cached?r.cached:[];n._peoplePickerSearchPromise=r.promise;return n._peoplePickerSearchPromise.then(function(e){n._peoplePickerSearchPromise=void 0;return e?i.concat(e):[]}).then(function(t){var r=W?t:n._dedupeSuggestions(t);return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions(r,e):r})};if(!n.props.peoplePickerImprovementsExperiment||!n.props.persistCachePeopleSearch)return s().then(function(e){n._callRumOneLoggerFromProps();return e});try{return n.props.persistCachePeopleSearch({getData:s,key:i}).then(function(e){var t=!isNaN(e.cacheStats.lastModified);n._callRumOneLoggerFromProps(t);return e.data})}catch(e){return s().then(function(e){n._callRumOneLoggerFromProps();return e})}};n._callRumOneLoggerFromProps=function(e){void 0===e&&(e=!1);n.props.writeUserInputDataToRumoneLogger&&n.props.writeUserInputDataToRumoneLogger(e)};n._onGetMoreResults=function(e){n._onGetMoreResultsClicked&&n._onGetMoreResultsClicked();var t;if(n.props.peoplePickerQueryParams){(t=Object(r.e)({},n.props.peoplePickerQueryParams)).useGraph=!1;t.useSubstrate=!1}return n._dataProvider&&n._dataProvider.sharePointSearch&&t?n._dataProvider.sharePointSearch(e,t).then(function(t){if(n.props.onResolvedSuggestions){var r=n.props.onResolvedSuggestions(t,e);if(r instanceof Array)return r}return t}):[]};if(t.dataProvider)n._dataProvider=t.dataProvider;else{if(!t.context)throw new Error("No pageContext available for PeoplePickerProvider.");n._dataProvider=new R({pageContext:t.context,peoplePickerDataSource:t.dataSource})}n._canCallGraph=!!(n._dataProvider.canUseGraph&&n.props.peoplePickerQueryParams&&n._dataProvider.canUseGraph(n.props.peoplePickerQueryParams));n._handleGetMoreResultsInBaseClass=n._canCallGraph&&!n.props.onGetMoreResults;n.state={hasUnresolvedText:!1,searchForMoreText:n._getSearchForMoreText(n._handleGetMoreResultsInBaseClass)};return n}Object.defineProperty(t.prototype,"selectedPeople",{get:function(){return this._peoplePicker&&this._peoplePicker.items||[]},enumerable:!1,configurable:!0});t.prototype.render=function(){var e=this,t=this.props,n=t.className,s=t.onRenderItem,o=t.onRenderSuggestionsItem,u=t.defaultSelectedItems,a=t.onSelectedPersonasChange,l=t.suggestionsHeaderText,c=t.suggestionsClassName,h=t.noResultsFoundText,p=t.loadingText,d=t.inputProps,v=t.onSuggestionSelected,m=t.suggestionsAvailableAlertText,b=t.enableSelectedSuggestionAlert,w=t.selectedItems,E=t.itemLimit,S=t.onInputChange,x=t.onGetMoreResults,T=t.searchForMoreIcon,N=t.searchForMoreText,C=t.ariaLabel,M=void 0===C?"":C,_=t.pickerCalloutProps,D=t.pickerOverrideStyles,H=t.theme,B=t.disabled,j=t.onGetMoreResultsClicked,F=t.removeButtonAriaLabel,I=t.onEmptyResolveSuggestions,q=t.showDefaultSuggestion,R=t.customizeSuggestionPersonaProps;this._onGetMoreResultsClicked=j;var U={className:n,onRenderSuggestionsItem:o||function(e){return(function(e,t){var n,r=k(e,f.n.size40,g.standalone);n=r;t&&(n=t(r));return i.createElement(L,{person:e,personaProps:n})})(e,R)},onResolveSuggestions:this._onResolveSuggestions,defaultSelectedItems:u,selectedItems:w,onChange:a,inputProps:d,enableSelectedSuggestionAlert:b,pickerSuggestionsProps:{suggestionsHeaderText:l,loadingText:p,noResultsFoundText:h,className:c,suggestionsAvailableAlertText:m,searchForMoreIcon:T,searchForMoreText:N||(this._handleGetMoreResultsInBaseClass?this.state.searchForMoreText:void 0),suggestionsContainerAriaLabel:y.e},onItemSelected:v,itemLimit:E,onInputChange:S,onGetMoreResults:x||(this._handleGetMoreResultsInBaseClass?this._onGetMoreResults:void 0),pickerCalloutProps:_,styles:D,theme:H,"aria-label":M,disabled:B,removeButtonAriaLabel:F,onEmptyResolveSuggestions:q&&this._canCallGraph?function(){e.props.initRumone&&e.props.initRumone("",!0);return e._onResolveSuggestions("")}:I};switch(this.props.peoplePickerType){case P.listBelow:U.onRenderItem=s||O;return i.createElement(V,Object(r.e)({},U,{componentRef:this._resolveRef("_peoplePicker")}));default:U.onRenderItem=s||A;return i.createElement(X,Object(r.e)({},U,{componentRef:this._resolveRef("_peoplePicker")}))}};t.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()};t.prototype._getPeoplePickerQueryParams=function(){if(this.props.peoplePickerQueryParams){!this.props.peoplePickerQueryParams.onToggleGetMoreResults&&this._handleGetMoreResultsInBaseClass&&(this.props.peoplePickerQueryParams.onToggleGetMoreResults=this._onToggleGetMoreResults);return this.props.peoplePickerQueryParams}return{allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:U.e.user|U.e.securityGroup|U.e.sharePointGroup}};t.prototype._dedupeSuggestions=function(e){var t=this,n=[],i=this._peoplePicker&&this._peoplePicker.items||[];i=Object(r.o)([],i,!0);for(var s=function(e){var r=o._getItemKey(e);if(!i.some(function(e){var n=t._getItemKey(e);return r===n})){n.push(e);i.push(e)}},o=this,u=0,a=e;u<a.length;u++){s(a[u])}return n};t.prototype._getItemKey=function(e){return e.email||e.userId||Object(I.e)(JSON.stringify(e)).toString()};t.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})};t.prototype._getSearchForMoreText=function(e){return e?y.n:void 0};return t})(o.e),J=n(203),K=n(242),Q=n(372),G=n("prop-types-lib"),Y=n(1),Z=n(15),ee=n(22),te=n(497),ne=n(48),re=n(46),ie=n(146),se=n(8),oe=n(58),ue=n(241),ae=n(10),fe=n(230),le=n(121),ce=n(31),he=n(285),pe=n(72),de=n(100);(function(e){e[e.None=0]="None";e[e.Family=1]="Family";e[e.FamilyMember=2]="FamilyMember"})(z||(z={}));E.e.isActivated("c0f33ab5-b308-47d6-9537-a4b510e6093f","09/14/2021","Fix for button label in high contrast mode cause by .ms-Button-flexContainer:hover in PeoplePicker.scss.")||(function(){var e=document.createElement("style");e.innerHTML="\n  @media screen and (-ms-high-contrast: active) {\n    .ms-Button-flexContainer:hover {\n      font-size: inherit !important;\n      color: inherit !important;\n      forced-color-adjust: none;\n    }\n  }\n  ";document.head.insertAdjacentElement("beforeend",e)})();var ve=E.e.isActivated("ae5c4aaa-bb38-4467-acbe-e98893341883","02/28/2022","Show default suggestions killswitch"),me=(function(e){Object(r.r)(t,e);function t(t,n){var s=e.call(this,t)||this;s._inputs=[];s._onItemsChange=function(e){var t=s.state.selectedItems.concat(e);s.setState({selectedItems:t},function(){s.props.onChange(t)});e.forEach(function(e){s._onAutoResolve(e)})};s._initRumone=function(e,t){void 0===t&&(t=!1);if(!s._inputStartTime&&!t&&e.length>1||!s._inputStartTime&&t&&0===e.length){s._inputStartTime=Date.now();s._rumoneLogger||(s._rumoneLogger=new fe.e("peoplepicker"));s._rumoneLogger.resetRumOneApiMeasurement();s._rumoneLogger.resetRumOne();var n=le.e.getRUMOneLogger("peoplepicker"),r=E.e.isActivated("882A3AE3-7D25-485F-B28D-658F339604DF")?"browser.pipe.aria.microsoft.com":"/Collector/3.0/";n.startAPIMeasurement({ignore:function(e){return e.indexOf(r)>=0},getAPIName:function(e){var t=e.toLowerCase();return-1!==t.indexOf("graph.microsoft.com/v1.0/me/people")&&-1!==t.indexOf("search")?"GraphSearch":-1!==t.indexOf("/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface.clientpeoplepickersearchuser")?"SPClientPeoplePickerSearchUser":-1!==t.indexOf("https://outlook.office.com/search/api/v1/suggestions")?"SubstrateSearch":void 0}})}};s._onInputChange=function(e){s._inputs.push(e);s._initRumone(e);s._hasTakenErrorFocus=!1;if(e&&e.indexOf(";")>-1){var t=e.split(";").map(function(e){var t=/<[^\]]*>/g.exec(e);t&&t[0]&&(e=t[0].substring(1,t[0].length-1));if(e=e.trim())return s._createGenericPerson(e)}).filter(function(e){return e});s._onItemsChange(t);s.props.onInputChange&&s.props.onInputChange("");return""}var n=/['"].*['"]/g.exec(e);if(n&&n[0])return n[0].substring(1,n[0].length-1);s.props.onInputChange&&s.props.onInputChange(e);return e};s._onGetMoreResults=function(e){var t=s.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:s._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:!1,allowSharePointGroups:!1,forceResolve:!0,useSubstrate:!!s.props.sharingInformation.enforceIBSegmentFiltering,siteIBSegmentIDs:s.props.sharingInformation.siteIBSegmentIDs};return se.a()?s._peoplePickerProvider.sharePointSearch(e,n):s._peoplePickerProvider.sharePointSearch(e,n).then(function(e){return e.filter(function(e){return 0===s.state.selectedItems.filter(function(t){return t.email===e.email}).length})})};s._onSuggestionSelected=function(e){var t=s.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:s._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};s._store.getEngagementHelper().log("PeoplePicker.SuggestionSelected",{clientId:s.props.clientId,mode:J.e.share,detailedGroupInfo:e.detailedGroupInfo,principalType:void 0===e.principalType?"unknown":U.e[e.principalType],entityType:void 0===e.entityType?"unknown":u.e[e.entityType],isDefaultSuggestion:!/\S/.test(s._inputs.join(""))});if(se.h()&&Z.y(s.props.clientId)){var r=s._store.getFamily(),i=s._store.getFamilyMembers();r&&i&&(e.userId===r.userId?s._store.getEngagementHelper().log("PeoplePicker.FamilyGroupSelected",{clientId:s.props.clientId,scenarioId:"",familySuggestionType:z[s.state.familyType],mode:J.e.share}):i.some(function(t){return t.userId===e.userId})&&s._store.getEngagementHelper().log("PeoplePicker.FamilyMemberSelected",{clientId:s.props.clientId,scenarioId:"",familySuggestionType:z[s.state.familyType],mode:J.e.share}))}if(!1===e.isExternal||e.isExternal&&e.providerName)return e;if(e.principalType===U.e.distributionList){n.isGraphDistributionList=!0;n.useGraph=!0}var o=Object(re.o)(e),a=Object(re.i)(e);return!e.isResolved||o?s._peoplePickerProvider.resolve(e.userId,n).then(function(t){!t.email&&t.rawData&&t.rawData.EntityData&&(t.email=t.rawData.EntityData.OtherMails);!t.name&&t.rawData&&t.rawData.EntityData&&(t.name=t.rawData.EntityData.OtherMails);e.entityType===u.e.linkedinUser&&(t.entityType=e.entityType);void 0===t.isExternal&&(o||a)&&(t.isExternal=!0);return t}):e};s._onRenderItem=function(e){var t=s.props.permissionsMap,n=s._computeAllowExternalUsers(s.props.sharingLinkKind,s.props.sharingInformation.canAddExternalPrincipal),o=e.item.isExternal&&!n||s.props.sharingLinkKind===K.e.direct&&t&&(void 0!==t[e.item.email]&&t[e.item.email]===Q.e.none||void 0!==t[e.item.userId]&&t[e.item.userId]===Q.e.none)||!e.item.isResolved&&!e.item.isResolving,u=e.item.name;e.removeButtonAriaLabel=m.n(Y.io,u);e.item.imageAlt=m.n(Y.oa,u);return o?i.createElement("div",{className:"od-Share-PeoplePicker-selectedItem--error"},i.createElement(A,Object(r.e)({},e))):e.item.isResolving?i.createElement(te.e,{className:"od-Share-PeoplePicker-resolve-spinner"}):i.createElement(A,Object(r.e)({},e))};s._onToggleGetMoreResults=function(e){se.a()?s.state&&(e&&!s.state.searchForMoreText||!e&&s.state.searchForMoreText)&&s.setState({searchForMoreText:s._getSearchForMoreText(e)}):s.setState({searchForMoreText:s._getSearchForMoreText(s.props.sharingInformation.isGraphAvailable||e)})};s._writeUserInputDataToRumoneLogger=function(e){void 0===e&&(e=!1);if(s._rumoneLogger){var t=s._rumoneLogger.breakdownData,n={modeName:"peoplePicker",startTime:s._inputStartTime,endTime:Date.now(),breakDownData:{customerInputs:t(s._inputs.length),isSearchFromCache:e}};s._rumoneLogger.logSharingPerformance(n)}s._inputs=[];s._inputStartTime=null};s._peoplePickerProvider=n.peoplePickerProvider;s._resize=n.resize;s._platformDetection=n.platformDetection;s._hasTakenErrorFocus=!1;s._store=n.sharingStore;s._clientId=n.clientId;s._rumoneLogger=null;s._sharingClientMessenger=n.sharingClientMessenger;s._persistentRequestCache=new he.e({id:"PeoplePickerSearch"},{pageContext:n});s._showSimplifiedDialog=1===ce.s()&&s.props.mode===J.e.share;s.state={selectedItems:t.defaultSelectedItems,searchForMoreText:s._getSearchForMoreText(t.sharingInformation.isGraphAvailable),addedUsers:[],removedUsers:[],familyType:z.None,familyResolveEventFired:!1};s._resizeTracker=new ie.e(n.resize);s._peoplePickerControl=i.createRef();return s}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.defaultSelectedItems,n=this.props.defaultSelectedItems,r=[];n.forEach(function(e){var n=t.filter(function(t){return t.name===e.name});n.length>0&&r.push({name:n[0].name,userId:n[0].userId})});this.setState({selectedItems:t,addedUsers:r})};t.prototype.componentDidUpdate=function(e,t){var n;this._peoplePicker.scrollTop=this._peoplePicker.scrollHeight;var r=t.addedUsers,i=this.state.addedUsers,s=this.state.removedUsers;this._resizeTracker?this._resizeTracker.checkSizeChange(this._peoplePicker):null!==this.props.error&&null===e.error&&this._resize();if(r.length>i.length){s=r.filter(function(e){return-1===i.indexOf(e)});this.setState({removedUsers:s})}else r.length!==i.length&&s.length>0&&this.setState({removedUsers:[]});var o=this._platformDetection&&this._platformDetection.isIE;if(this._peoplePickerControl&&!o&&this.props.error&&!this._hasTakenErrorFocus){null===(n=this._peoplePickerControl.current)||void 0===n||n.focusInput();this._hasTakenErrorFocus=!0}};t.prototype.componentDidMount=function(){var e,t=this._platformDetection&&this._platformDetection.isIE;this._peoplePickerControl&&!t&&(null===(e=this._peoplePickerControl.current)||void 0===e||e.focusInput())};t.prototype.render=function(){var e=this,t={placeholder:this._computePlaceholderText(),autoFocus:!0,onFocus:function(t){e._onFocus()},onBlur:function(t){e._onBlur()},"aria-label":this._computeAddAnotherAriaLabel(),"aria-description":Y.So},n=this.props.pickerSettings,s=!!this.props.sharingInformation.enforceIBSegmentFiltering,o={principalSource:n.PrincipalSource,principalType:this._convertPrincipalType(n.PrincipalAccountType),querySettings:n.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:n.UseSubstrateSearch,allowSharePointGroups:!!this.props.allowSPGroups,forceResolve:!0,useGraph:!this.props.disableGraph,useSubstrate:s,onToggleGetMoreResults:this._onToggleGetMoreResults,conversationId:ne.e.generate(),siteIBSegmentIDs:this.props.sharingInformation.siteIBSegmentIDs,siteIBMode:this.props.sharingInformation.siteIBMode,useNew3Ssearch:n.useNew3Ssearch,enforceIBSegmentFiltering:s},u=this.props.renderIcon?"withIcon":"",a=this.props.error&&!this._showSimplifiedDialog?"od-Share-PeoplePicker ms-Share-PeoplePicker--error "+u:this._showSimplifiedDialog?"od-Simplified-Share-PeoplePicker ".concat(this.state.selectedItems.length>0&&"smaller-padding")+u:"od-Share-PeoplePicker "+u,f=Z.o(this.props.clientId)||this._platformDetection&&this._platformDetection.isMobile,l={preventDismissOnScroll:f,preventDismissOnResize:!0};this._showSimplifiedDialog&&(l.target=this.props.peoplePickerRef);var c,h=f?Y.Gt:Y.Qt,p=this.props.roleSelectorProps&&this.props.roleSelectorProps.roleSelectorAs,v=document.body,m=v?parseInt(getComputedStyle(v).fontSize,10):null;!(m&&m>16)||this._platformDetection&&this._platformDetection.isIE||(c={flexWrap:"wrap"});this._showSimplifiedDialog&&(c=Object(r.e)(Object(r.e)({},c),{width:"100%",height:"100%"}));var g="od-Share-PeoplePicker-Suggestions".concat(this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?" od-Share-PeoplePicker-Suggestions-condensed":"");this._showSimplifiedDialog&&(g="od-Share-PeoplePicker-Suggestions-Simplified-Share od-Share-PeoplePicker-Suggestions-condensed");return i.createElement("div",{style:c},i.createElement("div",{id:"od-Share-PeoplePicker-wrapper-id",role:"presentation",ref:function(t){e._peoplePicker=t},className:this._showSimplifiedDialog?"od-Share-PeoplePicker-height":void 0},oe.e(this._computePeopleAddOrRemoveMessage(),"assertive","alert",!0),i.createElement("div",{className:this._showSimplifiedDialog?"od-Share-PeoplePicker-flexGrow ".concat(this.props.renderIcon?"normal":"space-between"):"od-Share-PeoplePickerContainer ".concat(this.props.renderIcon?"normal":"space-between")},this.props.renderIcon&&i.createElement(d.e,{className:"od-Share-PeoplePicker-PeoplePickerIcon",iconName:"CirclePlus"}),i.createElement("div",{className:"od-Share-PeoplePicker-wrapper"},i.createElement($,{"aria-describedby":"inputErrorMessage",componentRef:function(t){e._peoplePickerControl.current=t},className:a,dataProvider:this._peoplePickerProvider,selectedItems:this.state.selectedItems,inputProps:t,loadingText:Y.Rn,noResultsFoundText:Y.wr,onSelectedPersonasChange:this.props.onChange,peoplePickerQueryParams:o,suggestionsClassName:g,onRenderItem:this._onRenderItem,onSuggestionSelected:this._onSuggestionSelected,onResolvedSuggestions:this._onResolvedSuggestions.bind(this),itemLimit:this.props.selectionLimit,onInputChange:this._onInputChange,onRenderSuggestionsItem:this._store&&this._store.showEmailsInSuggestions()?this._onRenderSuggestionsItem:null,onGetMoreResults:this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?this._onGetMoreResults:null,searchForMoreText:this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?this.state.searchForMoreText:null,suggestionsAvailableAlertText:h,enableSelectedSuggestionAlert:this._platformDetection&&this._platformDetection.isIE,role:"presentation",pickerCalloutProps:l,showDefaultSuggestion:!ve,peoplePickerImprovementsExperiment:!!ce.r(),persistCachePeopleSearch:function(t){var n=e._persistentRequestCache.getRequestKey(t.key,"POST");return e._persistentRequestCache.getDataUtilizingCache({cachingStrategy:de.e.useCacheIfNotExpired,cacheTimeoutTime:pe.e,cacheRequestKey:n,getData:t.getData,returnStatistics:!0})},writeUserInputDataToRumoneLogger:this._writeUserInputDataToRumoneLogger,initRumone:this._initRumone})),this.props.renderRoleSelector&&i.createElement("div",{className:"od-Share-PeoplePicker-RoleSelector"},i.createElement(p,Object(r.e)({},this.props.roleSelectorProps)))),!this._showSimplifiedDialog&&i.createElement("div",{className:"od-Share-PeoplePickerContainer"},i.createElement("div",{id:"inputErrorMessage",className:"od-Share-PeoplePicker-ErrorWarnings-wrapper"},this._renderError(),this._renderWarnings()))))};t.prototype._onResolvedSuggestions=function(e,t){var n=this;if(se.h()&&Z.y(this.props.clientId)){var r=this._store.getFamily(),i=this._store.getFamilyMembers();if(r&&t.length>1){var s=0===Y.Yt.toLocaleLowerCase().indexOf(t.toLocaleLowerCase()),o=!1,u=z.None;if(s){u=z.Family;o=!0;e=[r].concat(i,e)}else{e.forEach(function(t,n){i.forEach(function(i){if(!o&&t.userId===i.userId||t.email===i.email){e.splice(n+1,0,r);o=!0}})});o&&(u=z.FamilyMember)}this.setState({familyType:u});if(o&&!this.state.familyResolveEventFired){this.setState({familyResolveEventFired:!0});this._store.getEngagementHelper().log("PeoplePicker.FamilyGroupResolved",{clientId:this.props.clientId,scenarioId:"",mode:J.e.share,familySuggestionType:z[u]})}}}var a=[],f=[this._store.getCurrentUserId()],l=[];e.forEach(function(e){Object(ae.q)(e.image,n._clientId)&&(e.image=void 0);if(-1===f.indexOf(e.userId)&&-1===a.indexOf(e.email)){n.state.addedUsers.some(function(t){return t.name===e.name&&t.userId===e.userId})||l.push(e);e.userId&&f.push(e.userId);e.email&&a.push(e.email)}});try{return this.props.onResolvedSuggestions(l)}catch(e){return l}};t.prototype._createGenericPerson=function(e){return{userId:e,name:e,email:e,isResolving:!0}};t.prototype._onRenderSuggestionsItem=function(e){var t={text:e.name||"",imageUrl:e.image||"",tertiaryText:e.email&&e.email!==e.name?e.email:"",secondaryText:e.email||"",imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"},image:{width:"2.5rem !important",height:"2.5rem !important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"}}},styles:{root:{height:"2.5rem"},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}};return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(l.e,Object(r.e)({},t,{presence:f.t.none,size:f.n.size40,className:"ms-PeoplePicker-pickerPersona"})),e.entityType===u.e.linkedinUser&&i.createElement(d.e,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))};t.prototype._onAutoResolve=function(e){var t=this,n=this.props.pickerSettings,i={principalSource:n.PrincipalSource,principalType:this._convertPrincipalType(n.PrincipalAccountType),querySettings:n.QuerySettings,allowEmailAddresses:n.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};this._peoplePickerProvider.resolve(e.email,i).then(function(n){!n.email&&n.rawData&&n.rawData.EntityData&&(n.email=n.rawData.EntityData.OtherMails);!n.name&&n.rawData&&n.rawData.EntityData&&(n.name=n.rawData.EntityData.OtherMails);var r=[];t.state.selectedItems.forEach(function(t){t.email===e.email?r.push(n):r.push(t)});t.setState({selectedItems:r},function(){t.props.onChange(r)})}).catch(function(){var n=Object(r.e)(Object(r.e)({},e),{isResolving:!1}),i=[];t.state.selectedItems.forEach(function(t){t.email===e.email?i.push(n):i.push(t)});t.setState({selectedItems:i},function(){t.props.onChange(i)})})};t.prototype._isResolveInProgress=function(){for(var e=0,t=this.state.selectedItems;e<t.length;e++){if(t[e].isResolving)return!0}return!1};t.prototype._computePlaceholderText=function(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?Y.Ki:Y.Gi};t.prototype._computePeopleAddOrRemoveMessage=function(){var e=this.state,t=e.addedUsers,n=e.removedUsers,r=[];t.length>0&&(r=r.concat(t.map(function(e){return m.n(Y.$i,e)+". "+Y.Gi})));n.length>0&&(r=r.concat(n.map(function(e){return m.n(Y.Ji,e)})));return r.length>0?r.toString():""};t.prototype._convertPrincipalType=function(e){if(!e)return U.e.none;for(var t=U.e.none,n=0,r=e.split(",");n<r.length;n++){var i=r[n];"User"===i&&(t|=U.e.user);"DL"===i&&(t|=U.e.distributionList);"SecGroup"===i&&(t|=U.e.securityGroup);"SPGroup"===i&&(t|=U.e.sharePointGroup)}return t};t.prototype._computeAllowExternalUsers=function(e,t){var n=e===K.e.organizationView,r=e===K.e.organizationEdit;return!(n||r)&&t};t.prototype._renderError=function(){var e,t=this.props.error;if(t&&!this._isResolveInProgress()){if(this._peoplePickerControl&&!this._hasTakenErrorFocus){null===(e=this._peoplePickerControl.current)||void 0===e||e.focusInput();this._hasTakenErrorFocus=!0}return i.createElement(ue.e,{error:t,iconName:"Blocked2",backgroundColor:"#FDE7E9",className:"od-Share-PeoplePicker-error"})}};t.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,n=[],r={icon:{fontSize:"1rem",minWidth:"1rem",minHeight:"1rem"},text:{fontSize:"0.75rem",lineHeight:"1rem"},innerText:{lineHeight:"1rem"}};if(!this.props.error){this.state.selectedItems.length===this.props.selectionLimit&&n.push(i.createElement(a.e,{ariaLabel:Y.Vi,styles:r},Y.Vi));e&&n.push(i.createElement(a.e,{ariaLabel:e,styles:r},e));t&&n.push(i.createElement(a.e,{ariaLabel:t,styles:r},t));return n.length>0?i.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},n):void 0}};t.prototype._getSearchForMoreText=function(e){return e?Y.wo:void 0};t.prototype._onFocus=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendPeoplePickerFocused():ee.g();this.props.setPeoplePickerFocused&&this.props.setPeoplePickerFocused(!0)};t.prototype._onBlur=function(){this.props.setPeoplePickerFocused&&this.props.setPeoplePickerFocused(!1)};t.prototype._computeAddAnotherAriaLabel=function(){return 0===this.props.defaultSelectedItems.length?Y.xo:Y.Eo};t.contextTypes={peoplePickerProvider:G.object.isRequired,resize:G.func.isRequired,platformDetection:G.object.isRequired,sharingStore:G.object.isRequired,clientId:G.number.isRequired,sharingClientMessenger:G.object};return t})(o.e),ge=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.state={hasError:!1};return n}t.getDerivedStateFromError=function(e){return{hasError:!0}};t.prototype.render=function(){return this.state.hasError?null:i.createElement(i.Fragment,null,this.props.children)};t.prototype.componentDidCatch=function(e,t){this.props.onError&&this.props.onError(e,t)};return t})(i.PureComponent),ye=n(41),be=n(26),we=n(109);function Ee(e){e.onError;var t=e.componentName,n=Object(we.e)(function(e,n){ye.e.logError(e,{"react.componentStack":n.componentStack,"react.component":t},{eventName:"ReactRenderError",resultCode:"",resultType:be.e.Failure})});return i.createElement(ge,Object(r.e)({},e,{onError:n}))}var Se=(function(e){Object(r.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return i.createElement(Ee,{componentName:"peoplePicker.peoplePickerWrapper"},i.createElement(me,Object(r.e)({},this.props,{selectionLimit:100})))};return t})(i.Component);t.e=Se},function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharedWith{align-items:center;display:flex}.od-SharedWith .label{font-size:.875rem;font-weight:600;font:-apple-system-body;margin:0}[dir=ltr] .od-SharedWith .label{padding-right:4px}[dir=rtl] .od-SharedWith .label{padding-left:4px}.od-SharedWith-Facepile{display:flex;position:relative}.od-SharedWith-Facepile button.compact{height:auto;padding:2px;width:auto}.od-SharedWith-Facepile button.compact:hover{background-color:transparent}.od-SharedWith-Facepile li{display:flex}.od-SharedWith-List{display:flex}.od-SharedWith-List li{flex-shrink:0}.od-SharedWith-Link--simplified{display:flex}.od-SharedWith-Link--simplified li{flex-shrink:0}.od-SharedWith-Link--simplified .ms-Button-flexContainer{align-items:flex-end}.od-SharedWith-Link--simplified,.od-SharedWith-More--simplified,.od-SharedWith-Persona--simplified{position:relative}.od-SharedWith-Link--simplified .ms-Button-flexContainer,.od-SharedWith-More--simplified .ms-Button-flexContainer,.od-SharedWith-Persona--simplified .ms-Button-flexContainer{align-items:center}.od-SharedWith-Link--simplified .ms-Image,.od-SharedWith-More--simplified .ms-Image,.od-SharedWith-Persona--simplified .ms-Image{border:2px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-SharedWith-More--simplified .ms-Persona-initials{border:2px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.od-SharedWith-Persona{display:flex;position:relative}.od-SharedWith-Persona-measure{left:0;position:absolute;visibility:hidden}.od-SharedWith-Persona .od-SharedWith-Persona-measure{margin-left:0}.od-SharedWith-Link .ms-Persona-initials{background-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-SharedWith-Link .ms-Persona-initials i{font-weight:400}@media screen and (-ms-high-contrast:active){.od-SharedWith-Link .ms-Persona-initials{color:WindowText}}.od-SharedWith-More .ms-Persona-initials{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-SharedWith-More .ms-Persona-initials{color:WindowText}}.od-SharedWith-beak{left:3%!important}.ms-Tooltip-subtext{font-size:.75rem}"}]);var s=n(29),o=n(1),u=n(35),a=n("react-lib"),f=n("react-dom-lib"),l=n(30),c=n(2),h=n(392),p=n(498),d=n(419),v=n(382),m=n(10),g=n(31),y=n("prop-types-lib");(function(){if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=(function(e){for(var t=window.document,n=o(t);n;)n=o(t=n.ownerDocument);return t})(),t=[],n=null,r=null,i=function(e){this.time=e.time;this.target=e.target;this.rootBounds=l(e.rootBounds);this.boundingClientRect=l(e.boundingClientRect);this.intersectionRect=l(e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0});this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,n=t.width*t.height,r=this.intersectionRect,i=r.width*r.height;this.intersectionRatio=n?Number((i/n).toFixed(4)):this.isIntersecting?1:0},s=(function(){function s(e,t){this.THROTTLE_TIMEOUT=100;this.POLL_INTERVAL=null;this.USE_MUTATION_OBSERVER=!0;var n,r,i,s=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(s.root&&1!=s.root.nodeType&&9!=s.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),r=this.THROTTLE_TIMEOUT,i=null,function(){i||(i=setTimeout(function(){n();i=null},r))});this._callback=e;this._observationTargets=[];this._queuedEntries=[];this._rootMarginValues=this._parseRootMargin(s.rootMargin);this.thresholds=this._initThresholds(s.threshold);this.root=s.root||null;this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" ");this._monitoringDocuments=[];this._monitoringUnsubscribes=[]}s.prototype._setupCrossOriginUpdater=function(){n||(n=function(e,n){r=e&&n?c(e,n):{top:0,bottom:0,left:0,right:0,width:0,height:0};t.forEach(function(e){e._checkForIntersections()})});return n};s.prototype._resetCrossOriginUpdater=function(){n=null;r=null};s.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance();this._observationTargets.push({element:e,entry:null});this._monitorIntersections(e.ownerDocument);this._checkForIntersections()}};s.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e});this._unmonitorIntersections(e.ownerDocument);0==this._observationTargets.length&&this._unregisterInstance()};s.prototype.disconnect=function(){this._observationTargets=[];this._unmonitorAllIntersections();this._unregisterInstance()};s.prototype.takeRecords=function(){var e=this._queuedEntries.slice();this._queuedEntries=[];return e};s.prototype._initThresholds=function(e){var t=e||[0];Array.isArray(t)||(t=[t]);return t.sort().filter(function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]})};s.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map(function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});t[1]=t[1]||t[0];t[2]=t[2]||t[0];t[3]=t[3]||t[1];return t};s.prototype._monitorIntersections=function(t){var n=t.defaultView;if(n&&-1==this._monitoringDocuments.indexOf(t)){var r=this._checkForIntersections,i=null,s=null;if(this.POLL_INTERVAL)i=n.setInterval(r,this.POLL_INTERVAL);else{u(n,"resize",r,!0);u(t,"scroll",r,!0);this.USE_MUTATION_OBSERVER&&"MutationObserver"in n&&(s=new n.MutationObserver(r)).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}this._monitoringDocuments.push(t);this._monitoringUnsubscribes.push(function(){var e=t.defaultView;if(e){i&&e.clearInterval(i);a(e,"resize",r,!0)}a(t,"scroll",r,!0);s&&s.disconnect()});var f=this.root&&(this.root.ownerDocument||this.root)||e;if(t!=f){var l=o(t);l&&this._monitorIntersections(l.ownerDocument)}}};s.prototype._unmonitorIntersections=function(t){var n=this._monitoringDocuments.indexOf(t);if(-1!=n){var r=this.root&&(this.root.ownerDocument||this.root)||e;if(!this._observationTargets.some(function(e){var n=e.element.ownerDocument;if(n==t)return!0;for(;n&&n!=r;){var i=o(n);if((n=i&&i.ownerDocument)==t)return!0}return!1})){var i=this._monitoringUnsubscribes[n];this._monitoringDocuments.splice(n,1);this._monitoringUnsubscribes.splice(n,1);i();if(t!=r){var s=o(t);s&&this._unmonitorIntersections(s.ownerDocument)}}}};s.prototype._unmonitorAllIntersections=function(){var e=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0;this._monitoringUnsubscribes.length=0;for(var t=0;t<e.length;t++)e[t]()};s.prototype._checkForIntersections=function(){if(this.root||!n||r){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(r){var s=r.element,o=f(s),u=this._rootContainsTarget(s),a=r.entry,l=e&&u&&this._computeTargetAndRootIntersection(s,o,t),c=null;this._rootContainsTarget(s)?n&&!this.root||(c=t):c={top:0,bottom:0,left:0,right:0,width:0,height:0};var h=r.entry=new i({time:window.performance&&performance.now&&performance.now(),target:s,boundingClientRect:o,rootBounds:c,intersectionRect:l});a?e&&u?this._hasCrossedThreshold(a,h)&&this._queuedEntries.push(h):a&&a.isIntersecting&&this._queuedEntries.push(h):this._queuedEntries.push(h)},this);this._queuedEntries.length&&this._callback(this.takeRecords(),this)}};s.prototype._computeTargetAndRootIntersection=function(t,i,s){if("none"!=window.getComputedStyle(t).display){for(var o,u,a,l,h,d,v,m,g=i,y=p(t),b=!1;!b&&y;){var w=null,E=1==y.nodeType?window.getComputedStyle(y):{};if("none"==E.display)return null;if(y==this.root||9==y.nodeType){b=!0;if(y==this.root||y==e)if(n&&!this.root)if(!r||0==r.width&&0==r.height){y=null;w=null;g=null}else w=r;else w=s;else{var S=p(y),x=S&&f(S),T=S&&this._computeTargetAndRootIntersection(S,x,s);if(x&&T){y=S;w=c(x,T)}else{y=null;g=null}}}else{var N=y.ownerDocument;y!=N.body&&y!=N.documentElement&&"visible"!=E.overflow&&(w=f(y))}w&&(g=(o=w,u=g,a=void 0,l=void 0,h=void 0,d=void 0,v=void 0,m=void 0,a=Math.max(o.top,u.top),l=Math.min(o.bottom,u.bottom),h=Math.max(o.left,u.left),d=Math.min(o.right,u.right),m=l-a,(v=d-h)>=0&&m>=0&&{top:a,bottom:l,left:h,right:d,width:v,height:m}||null));if(!g)break;y=y&&p(y)}return g}};s.prototype._getRootRect=function(){var t;if(this.root&&!d(this.root))t=f(this.root);else{var n=d(this.root)?this.root:e,r=n.documentElement,i=n.body;t={top:0,left:0,right:r.clientWidth||i.clientWidth,width:r.clientWidth||i.clientWidth,bottom:r.clientHeight||i.clientHeight,height:r.clientHeight||i.clientHeight}}return this._expandRectByRootMargin(t)};s.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map(function(t,n){return"px"==t.unit?t.value:t.value*(n%2?e.width:e.height)/100}),n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3],height:0,width:0};n.width=n.right-n.left;n.height=n.bottom-n.top;return n};s.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1,r=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==r)for(var i=0;i<this.thresholds.length;i++){var s=this.thresholds[i];if(s==n||s==r||s<n!=s<r)return!0}};s.prototype._rootIsInDom=function(){return!this.root||h(e,this.root)};s.prototype._rootContainsTarget=function(t){var n=this.root&&(this.root.ownerDocument||this.root)||e;return h(n,t)&&(!this.root||n==t.ownerDocument)};s.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)};s.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)};return s})();window.IntersectionObserver=s;window.IntersectionObserverEntry=i}function o(e){try{return e.defaultView&&e.defaultView.frameElement||null}catch(e){return null}}function u(e,t,n,r){"function"==typeof e.addEventListener?e.addEventListener(t,n,r||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function a(e,t,n,r){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,r||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,n)}function f(e){var t;try{t=e.getBoundingClientRect()}catch(e){}if(!t)return{top:0,bottom:0,left:0,right:0,width:0,height:0};t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top});return t}function l(e){return!e||"x"in e?e:{top:e.top,y:e.top,bottom:e.bottom,left:e.left,x:e.left,right:e.right,width:e.width,height:e.height}}function c(e,t){var n=t.top-e.top,r=t.left-e.left;return{top:n,left:r,height:t.height,width:t.width,bottom:n+t.height,right:r+t.width}}function h(e,t){for(var n=t;n;){if(n==e)return!0;n=p(n)}return!1}function p(t){var n=t.parentNode;if(9==t.nodeType&&t!=e)return o(t);n&&n.assignedSlot&&(n=n.assignedSlot.parentNode);return n&&11==n.nodeType&&n.host?n.host:n}function d(e){return e&&9===e.nodeType}})();function b(e,t){var n=e.ariaLabel,r=e.label,i=e.getPhotoUrl,c=e.onClick,h=e.sharingPrincipals,p=e.sharingLinks,d=e.personaSizeInPixels,y=void 0===d?24:d,b=e.renderOverlap,E=1===g.s(),S=a.useRef(null),x=a.useRef(null),T=a.useRef(null),N=a.useState(!0),C=N[0],k=N[1],L=a.useState(0),A=L[0],O=L[1],M=a.useMemo(function(){var e=[],r={},f=0;if(p.length)for(var l=0,d=p;l<d.length;l++){var v=d[l];if(v.principals.length||v.invitees.length){for(var g=0,S=v.principals;g<S.length;g++){r[(_=S[g]).loginName||_.email]=_}var x=new Date(v.expiration);if(v.isActive&&(!v.expiration||x.getTime()>Date.now()))for(var T=0,N=v.invitees;T<N.length;T++){r[(_=N[T]).loginName||_.email]=_}}f++}for(var C=0,k=h;C<k.length;C++){r[(_=k[C]).loginName||_.email]=_}if(f&&!E){var L=1===f?o.$o:Object(u.n)(o.Vo,f),A=L+(n?", "+n:"");e.push(a.createElement(w,{ariaLabel:A,className:"".concat(E&&b?"od-SharedWith-Link--simplified":"od-SharedWith-Link"),iconName:"Link",key:".link",onClick:c,title:L,personaSizeInPixels:y,renderOverlap:b}))}for(var O=0,M=Object.keys(r);O<M.length;O++){var _,D=M[O],P=void 0;P=(_=r[D]).imageUrl?_.imageUrl:_.type===s.e.user&&i?i(D):void 0;Object(m.q)(P,t.clientId)&&(P=void 0);var H=_.primaryText+(n?", "+n:"");e.push(a.createElement(w,{ariaLabel:H,imageUrl:P,className:"".concat(E&&b?"od-SharedWith-Persona--simplified":""),key:_.primaryText,onClick:c,text:_.primaryText,title:_.email?"".concat(_.primaryText," <").concat(_.email,">"):_.primaryText,personaSizeInPixels:y,renderOverlap:b}))}return e},[h,p]);a.useEffect(function(){S.current=new IntersectionObserver(P,{root:T.current,threshold:1});return function(){return S.current.disconnect()}},[]);a.useEffect(function(){if(S.current&&x.current){for(var e=[],n=0;n<x.current.children.length;n++){var r=x.current.children[n];S.current.observe(r);e.push(r)}return function(){for(var n,r=0,i=e;r<i.length;r++){var s=i[r];S.current.unobserve(s)}null===(n=t.resize)||void 0===n||n.call(t)}}});a.useEffect(function(){if(E&&b)for(var e=document.getElementsByTagName("li"),t=0;t<=A;t++){e[t].style.right="".concat(6*t,"px")}});var _=(function(e,t){var n="";n=1===t?1===e?o.Yo:u.n(o.Go,e):1===e?u.n(o.Qo,t):u.n(o.Ko,t,e);return n})(h.length,p.length),D=a.createElement("div",{className:"od-SharedWith",ref:T},r&&a.createElement("h2",{className:"label"},r),a.createElement("div",{"aria-label":r,className:"od-SharedWith-Facepile"},!C&&a.createElement("ul",{className:"od-SharedWith-List","aria-label":_},M.slice(0,A<M.length-1?A:void 0),A<M.length-1?a.createElement(w,{ariaLabel:n,className:"".concat(E&&b?"od-SharedWith-More--simplified":"od-SharedWith-More"),iconName:"More",key:".more",onClick:c,title:o.Jo,personaSizeInPixels:y,renderOverlap:b}):null),a.createElement("ul",{"aria-hidden":!0,className:"od-SharedWith-List od-SharedWith-Persona-measure",ref:x,role:"presentation"},M)));return E?a.createElement(v.e,{hostClassName:"od-SharedWith-tooltip",calloutProps:{gapSpace:0,directionalHint:l.e.topLeftEdge,styles:{beak:["od-SharedWith-beak"]}},content:_},D):D;function P(e){var t=0,n=1e3;if(x.current){for(var r=0,i=e;r<i.length;r++)for(var s=i[r],o=0;o<x.current.children.length;o++){if(x.current.children[o]===s.target){s.intersectionRect.width===s.boundingClientRect.width?t=Math.max(t,o):n=Math.min(n,o);break}}0===t&&1e3!==n&&(t=Math.max(0,n-1));Object(f.unstable_batchedUpdates)(function(){O(function(e){return e!==t?t:e});k(!1)})}}}b.contextTypes={clientId:y.number.isRequired,resize:y.func.isRequired};function w(e){var t=e.ariaLabel,n=e.className,i=e.iconName,s=e.imageUrl,o=e.onClick,u=e.text,f=e.title,m=e.personaSizeInPixels,y=e.renderOverlap,b=E(m),w=m/16,S=1===g.s(),x={styles:{coin:{width:"".concat(w,"rem"),height:"".concat(w,"rem")},image:{width:"".concat(w,"rem!important"),height:"".concat(w,"rem !important")},imageArea:{width:"".concat(w,"rem"),height:"".concat(w,"rem")},initials:{width:"".concat(w,"rem"),height:"".concat(w,"rem"),fontSize:"0.625rem",lineHeight:"".concat(w,"rem")}}},T={text:u,imageUrl:s,hidePersonaDetails:!0,showInitialsUntilImageLoads:!0,size:b||c.n.size24,onRenderInitials:i?function(){return a.createElement(h.e,{iconName:i})}:void 0,coinProps:x,styles:{root:{height:"1.5rem",minWidth:"".concat(m,"px")},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}},N=a.createElement(p.e,Object(r.e)({},T));N=o?a.createElement(d.e,{"aria-haspopup":!0,ariaLabel:t,className:"compact",onClick:o,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}},N):a.createElement("span",{className:"od-SharedWith-noninteractivePersona",tabIndex:0,"aria-label":t,"data-is-focusable":!0,role:"img"},N);return S&&y?a.createElement("li",{className:n},N):a.createElement("li",{className:n},a.createElement(v.e,{hostClassName:"od-SharedWithPersona-tooltip",calloutProps:{gapSpace:0},content:f,directionalHintForRTL:l.e.topLeftEdge},N))}var E=function(e){switch(e){case 24:return c.n.size24;case 28:return c.n.size28;case 48:return c.n.size48;default:return c.n.size24}}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ActivityIndicator{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2;text-align:center}.od-ActivityIndicator .ms-Spinner{display:inline-block;width:1.75rem}.od-ActivityIndicator span{font-size:1rem}"}]);var s=n("react-lib"),o=n(497),u=n(105),a=(function(e){Object(r.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return s.createElement("div",{className:"od-ActivityIndicator","aria-hidden":this.props.ariaHidden,"aria-live":"assertive"},s.createElement("div",null,s.createElement(o.e,{type:u.t.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}})),s.createElement("span",{role:"alert"},this.props.message))};return t})(s.Component)},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLinkDescription{align-items:top;display:flex;padding:0;width:100%}.od-ShareLinkDescription .od-ShareLinkDescription-label-section{width:80%;text-align:left}[dir=ltr] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{padding-left:2%}[dir=rtl] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{padding-right:2%}[dir=rtl] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{text-align:right}.od-ShareLinkDescription .od-ShareLinkDescription-label-section .od-ShareLinkDescription-detailText{font-size:.75rem;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ShareLinkDescription-label{font-size:.875rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:flex;overflow:hidden;text-overflow:ellipsis;vertical-align:top;font:-apple-system-subheadline;top:2px;position:relative;margin:0;width:100%}[dir=ltr] .od-ShareLinkDescription-label{text-align:left}[dir=rtl] .od-ShareLinkDescription-label{text-align:right}.od-ShareLinkDescription-image{width:1rem;height:1rem}.od-ShareLinkDescription-icon{align-items:center;border-radius:50%;border-style:solid;border-width:.0625rem;box-sizing:border-box;display:flex;height:1.5rem;justify-content:center;width:1.5rem;font-size:.875rem}.od-ShareLinkDescription-icon .ms-Icon{font-size:.875rem}.od-ShareLinkDescription-icon.icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939}.od-ShareLinkDescription-icon.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.od-ShareLinkDescription-icon.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-ShareLinkDescription-icon.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-ShareLinkDescription-icon.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.od-ShareLinkDescription-icon.icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{top:50%;left:50%;transform:translate(-50%,-50%);color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:";position:relative;display:inline-block;border-radius:50%;width:1.5rem;height:1.5rem;border:.0625rem solid "},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-right:10px}[dir=rtl] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-left:10px}"}]);var s=n(282),o=n(307),u=n(392),a=n("react-lib"),f=(function(e){Object(r.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=s.e[this.props.permissionsType],t=this.props.iconUrl?a.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:this.props.iconUrl,alt:this.props.label}):a.createElement(u.e,{"aria-hidden":"true",iconName:e,styles:{root:{fontSize:"0.875rem",width:"2.75",height:"2.75"}}});return a.createElement("div",{className:"od-ShareLinkDescription"},a.createElement("div",{className:"od-ShareLinkDescription-icon icon-".concat(e),"aria-hidden":"true"},t),this._renderLabel())};t.prototype._renderLabel=function(){var e=this.props.infoButtonMessage,t=e?a.createElement(o.e,{message:e}):"";if(this.props.showLabel){var n=this.props.isSelected;t=n?null:t;var r=a.createElement("div",{className:"od-ShareLinkDescription-label"},this.props.label,t);return a.createElement("div",{className:"od-ShareLinkDescription-label-section"},r,n&&a.createElement("span",{className:"od-ShareLinkDescription-detailText"},this.props.detailText))}};return t})(a.Component)},,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(61),i=n(4),s=Object(r.e)({eventName:"Engagement,",shortEventName:"Engagement"},{name:{isKey:!0,isPrefixingDisabled:!0,type:i.e.String},isIntentional:{isPrefixingDisabled:!0,type:i.e.Boolean},scenario:{isPrefixingDisabled:!0,type:i.e.String},location:{isPrefixingDisabled:!0,type:i.e.String},usageType:{isPrefixingDisabled:!0,type:i.e.String},currentPage:{isPrefixingDisabled:!0,type:i.e.String},previousPage:{isPrefixingDisabled:!0,type:i.e.String},experiment:{isPrefixingDisabled:!0,type:i.e.Object},siteId:{isPrefixingDisabled:!0,type:i.e.String},webId:{isPrefixingDisabled:!0,type:i.e.String},listId:{isPrefixingDisabled:!0,type:i.e.String},groupId:{isPrefixingDisabled:!0,type:i.e.String},docId:{isPrefixingDisabled:!0,type:i.e.String},webTemplateId:{isPrefixingDisabled:!0,type:i.e.String},listTemplateId:{isPrefixingDisabled:!0,type:i.e.String},siteType:{isPrefixingDisabled:!0,type:i.e.String},feature:{isPrefixingDisabled:!0,type:i.e.String},component:{isPrefixingDisabled:!0,type:i.e.String},extraData:i.e.Object,objectType:{isPrefixingDisabled:!0,type:i.e.String},datasource:{isPrefixingDisabled:!0,type:i.e.String},action:{isPrefixingDisabled:!0,type:i.e.String},privacyClassification:{isPrefixingDisabled:!0,type:i.e.String}}).withData({privacyClassification:i.t.optionalDiagnostic,privacyDataTypes:["browsingHistory"]})},,function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(13),i=n(68),s=n(160),o=n(14),u=n(143),a=n(171);Object(u.i)("body");var f=(function(){function e(){}e.initializeTheme=function(t,n,u,f){window.__loadTheme=o._;(window.FabricConfig=window.FabricConfig||{}).fontBaseUrl="";var l=window._spModuleLink;l&&l.libraries&&l.libraries.length>0&&Object(r.e)(1);if(e._useOverrideTheme)return i.t.resolve(Object(o.A)());var c=Object(s.e)(t,n);if(c){e._themePromise=c.loadFullFormattedThemeData(u).then(function(e){var t=e||{};Object(a.t)(t,n,f);return e});return e._themePromise}return i.t.resolve(Object(a.t)({},n,f))};e.overrideTheming=function(t,n){t&&Object(a.t)(t,n,!0);e._useOverrideTheme=!0;e._themePromise&&e._themePromise.cancel()};e._useOverrideTheme=!1;return e})();window.FabricConfig&&window.FabricConfig.legacyTheme&&f.overrideTheming()},,function(e,t,n){"use strict";n.d(t,"e",function(){return ue});n.d(t,"t",function(){return ae});var r=n(0),i=n(13);Object(i.t)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareMain.blocker{position:relative}.od-ShareMain.blocker:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-ShareMain.wide{min-width:480px}@media (max-width:480px){.od-ShareMain.wide{min-width:320px}}.od-ShareMain-section{padding:16px 16px 0;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:12px}.od-ShareMain-section.new{padding:24px;padding-top:14px}.od-ShareMain-section.full-bleed{padding:0}.od-ShareMain-section.separator-top{border-top:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:"}.od-ShareMain-section.od-ShareMain-SharedWith{align-self:stretch;padding-bottom:20px;height:2.25rem}.od-ShareMain-section .od-ShareMain-ShareHint.animation{animation:highlight 2s ease-in-out}.od-ShareMain-targets{clear:both;padding:0 20px 20px 20px}.od-ShareMain-targets-newPadding{clear:both;padding:10px}.od-ShareMain-footer{outline:transparent;position:relative;font-size:12px;font-weight:400;display:flex!important;align-items:center;justify-content:flex-start;padding:0 16px!important;width:100%;height:44px!important;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";cursor:pointer!important;border:none!important;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:'!important;font:-apple-system-subheadline;bottom:0}.od-ShareMain-footer::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareMain-footer:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareMain-attachIcon{margin-top:2px;font-size:16px}[dir=ltr] .od-ShareMain-attachIcon{margin-right:4px}[dir=rtl] .od-ShareMain-attachIcon{margin-left:4px}.od-ShareMain-attachmentOptions .is-open{border:none;width:auto}.od-ShareMain-attachmentOptions button{width:auto}@media screen and (-ms-high-contrast:active){.od-ShareMain-footer:focus,.od-ShareMain-footer:hover{outline:2px solid}}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-ShareMain-section-body{margin-bottom:0}}.od-ShareMain-copyLink.shareType-section{display:flex;align-items:center;justify-content:space-between}[dir=ltr] .od-ShareMain-Header-backBtnAdjust{margin-left:16px}[dir=rtl] .od-ShareMain-Header-backBtnAdjust{margin-right:16px}@keyframes highlight{from{background:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}35%{background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}to{background:0 0}}"}]);var s=n(177),o=n(55),u=n(242),a=n(370),f=n(335),l=n(5),c=n(203),h=n(465);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendLink--exclustionNotification .ms-BasePicker-text{border-bottom:.0625rem solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-method{display:flex;justify-content:space-between;align-items:center}.od-SendLink-message .od-SendLink-message-TextField{margin-bottom:12px}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field{padding:.375rem 0;font-size:.875rem;font-weight:"},{theme:"mediumFontWeight",defaultValue:"400"},{rawString:";font:-apple-system-body}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}#od-SendLink-message-id .ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}@media screen and (-ms-high-contrast:active){#od-SendLink-message-id .ms-Button::after{outline-color:window}}.od-SendLink-spinner .ms-Spinner-circle{display:inline-block}[dir=ltr] .od-SendLink-spinner .ms-Spinner-circle{margin-right:8px}[dir=rtl] .od-SendLink-spinner .ms-Spinner-circle{margin-left:8px}.od-SendLink-spinner .ms-Spinner-label{display:inline}.od-SendLink-ITPolicy{position:absolute;top:-24px}[dir=ltr] .od-SendLink-ITPolicy{right:0}[dir=rtl] .od-SendLink-ITPolicy{left:0}.od-SendLink-emailButtons{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons{float:right}[dir=rtl] .od-SendLink-emailButtons{float:left}.od-SendLink-emailButtons-allCaps{font:-apple-system-headline;font-style:uppercase;border-radius:2px}[dir=ltr] .od-SendLink-emailButtons-allCaps{float:right}[dir=rtl] .od-SendLink-emailButtons-allCaps{float:left}[dir=ltr] div.od-SendLink-emailButtons-left{text-align:right}[dir=rtl] div.od-SendLink-emailButtons-left{text-align:left}.od-SendLink-emailButtons-rounded{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons-rounded{float:right}[dir=rtl] .od-SendLink-emailButtons-rounded{float:left}[dir=ltr] .od-SendLink-emailButtons-roleSelector{float:right}[dir=rtl] .od-SendLink-emailButtons-roleSelector{float:left}.od-SendLink-emailButtons-roleSelector .ms-Button{border-radius:2px}.od-SendLink-sendWrapper{display:block;width:100%;height:24px;padding-bottom:5px}.od-SendLink-email{position:relative}.od-SendLink-email .ms-TextField-field{height:4.0625rem;padding-bottom:30px;font-size:.75rem}[dir=ltr] .od-SendLink-email .ms-TextField-field{padding-left:0}[dir=rtl] .od-SendLink-email .ms-TextField-field{padding-right:0}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:.875rem;height:2rem;width:100%}@supports (font:-apple-system-footnote){.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font:-apple-system-body;height:auto}}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}.od-SendLink-sendContainer{justify-content:flex-end}.od-SendLink-characterCounter{font-size:.75rem}[dir=ltr] .od-SendLink-characterCounter{float:right}[dir=rtl] .od-SendLink-characterCounter{float:left}.od-SendLink-characterCounter--error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-characterCounterWrapper{display:block;height:16px;padding-bottom:5px}.od-SendLink-permissions{display:flex;flex-direction:row}.od-SendLink-peoplePicker{margin-bottom:12px;flex-grow:2;width:100%}"}]);var p=n(492),d=n(46),v=n("react-lib"),m=n("prop-types-lib"),g=n(212),y=n(161),b=n(89),w=n(1),E=n(10),S=n(497),x=n(105),T=n(15),N=n(146),C=n(74),k=n(184);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareTargets{padding-top:20px}.od-ShareTargets-items{list-style:none;display:inline-block}[dir=ltr] .od-ShareTargets-items{margin-right:-10px}[dir=rtl] .od-ShareTargets-items{margin-left:-10px}.od-ShareTargets-item{vertical-align:top;display:inline-block;text-align:center}[dir=ltr] .od-ShareTargets-item{margin-right:10px}[dir=rtl] .od-ShareTargets-item{margin-left:10px}.od-ShareTargets-item.new{margin:0}.od-ShareTargets-item--bottomMargin{margin-bottom:16px}.od-ShareTargets-itemImage{align-items:center;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-radius:50%;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:";cursor:pointer;display:inline-block;height:3rem;margin-bottom:8px;width:3rem}.od-ShareTargets-itemImage.new{height:2rem;width:2rem;margin-bottom:0;display:flex;align-items:center;justify-content:center}.od-ShareTargets-icon{font-size:1.625rem;padding-top:.6875rem}.od-ShareTargets-icon.new{padding:0;height:24px;width:24px;font-size:24px}.od-ShareTargets-itemImage--border{border:.0625rem solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareTargets-itemText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';font:-apple-system-short-caption2;font-size:.625rem}.od-ShareTargets-target{outline:transparent;position:relative;background:0 0;border:none}.od-ShareTargets-target::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareTargets-target:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareTargets-target.new{padding:0 8px 0 0}.od-ShareTargets-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-Share button:not(.ms-Button).od-ShareTargets-target{outline:.0625rem solid windowText}.od-Share button:not(.ms-Button).od-ShareTargets-target:focus{outline:.125rem solid highlight}}"}]);var L=n(114),A=n(392),O=n(382),M=n(30),_=n(31),D=n(9);P.contextTypes={shouldTeachingBubbleBeShown:m.func,markTeachingBubbleAsDismissed:m.func,loadTeachingBubbleCampaigns:m.func,campaignKey:m.number};function P(e,t){var i=this,s=v.useState({showCoachmark:!1,teachingBubbleCampaigns:void 0}),o=s[0],u=s[1],a=v.lazy(function(){return Object(r.t)(i,void 0,void 0,function(){return Object(r.i)(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t){return setTimeout(t,e.delayTimeInMilliseconds)})];case 1:t.sent();return[2,n.ee([15],774)]}})})});v.useEffect(function(){var n=setTimeout(function(){return Object(r.t)(i,void 0,void 0,function(){return Object(r.i)(this,function(e){Promise.all([t.loadTeachingBubbleCampaigns(),t.shouldTeachingBubbleBeShown(t.campaignKey)]).then(function(e){var t=e[0],n=e[1];u({teachingBubbleCampaigns:t,showCoachmark:n})});return[2]})})},e.delayTimeInMilliseconds);return function(){return clearTimeout(n)}},[u]);return o.showCoachmark&&o.teachingBubbleCampaigns&&v.createElement(v.Suspense,{fallback:v.createElement(v.Fragment,null)},v.createElement(a,{componentRef:e.componentRef,delayTimeInMilliseconds:e.delayTimeInMilliseconds,target:e.target,teachingBubbleCampaign:o.teachingBubbleCampaigns[t.campaignKey],dismissCallback:function(){t.markTeachingBubbleAsDismissed(t.campaignKey);u({showCoachmark:!1,teachingBubbleCampaigns:void 0})},onTeachingBubbleSeen:e.onTeachingBubbleSeen,onPrimaryButtonClicked:e.onPrimaryButtonClicked}))}var H=n(22),B=n(83),j=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/outlook_48x1.svg"),F=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/teams_48x1.svg"),I=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n._shareToTeamsExperiment=_.i();n._shareToTeamsCoachmarkTarget=v.createRef();n._coachmarkRef=v.createRef();n._showTeams=!1;n.state={areTargetsReady:!1};return n}t.prototype.componentDidMount=function(){var e=this;this._shareToTeamsExperiment&&this.context.canUseTeams().then(function(t){e._showTeams=t;e.setState({areTargetsReady:!0})})};t.prototype.render=function(){var e=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==o.e.existing&&this.props.currentSettings.audience!==o.e.anyone&&this.props.currentSettings.audience!==o.e.organization;if(this._shareToTeamsExperiment){this._shareTargetsData=this.state.areTargetsReady&&this._getShareTargetsData();return e?v.createElement(O.e,{content:w.r,calloutProps:{calloutWidth:300,directionalHint:M.e.topCenter}},v.createElement("ul",{className:"od-ShareTargets-items","aria-label":w.Yr},this.state.areTargetsReady&&this._renderTargets())):v.createElement("ul",{className:"od-ShareTargets-items","aria-label":w.Yr},this.state.areTargetsReady&&this._renderTargets())}this._shareTargetsData=this._getShareTargetsData();return e?v.createElement(O.e,{content:w.r,calloutProps:{calloutWidth:300,directionalHint:M.e.topCenter}},v.createElement("ul",{className:"od-ShareTargets-items","aria-label":w.Yr},this._renderTargets())):v.createElement("ul",{className:"od-ShareTargets-items","aria-label":w.Yr},this._renderTargets())};t.prototype._renderTargets=function(){for(var e=[],t=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==o.e.existing&&this.props.currentSettings.audience!==o.e.anyone&&this.props.currentSettings.audience!==o.e.organization,n=!D.t.isActivated("2f033097-46da-4c25-9748-ce932d169987","07/01/2021","Blocking share targets (e.g. CopyLink) by blockPeoplePickerAndSharing.")&&this.props.sharingInformation.blockPeoplePickerAndSharing&&this.props.currentSettings.audience!==o.e.existing,r=0,i=this._shareTargetsData;r<i.length;r++){var s=i[r],u=void 0,a=s.icon,l=a.split(":",2)[1],c=t||n||Object(E.B)(this.props.sharingInformation),h="od-ShareTargets-icon ".concat(c?"od-ShareTargets-disabled":""," new");"od-ShareTargets-itemText ms-font-xs ".concat(c?"od-ShareTargets-disabled":"");u=a.indexOf("font:")>-1?v.createElement(A.e,{iconName:l,className:h}):v.createElement("img",{src:a,className:h});e.push(v.createElement("li",{key:s.shareType,className:"od-ShareTargets-item new"},v.createElement(O.e,{content:s.label,styles:{root:{display:"inline-block"}}},v.createElement("button",{className:"od-ShareTargets-target new","aria-label":s.label,disabled:c,onClick:s.action,id:s.id,ref:s.shareType===f.e.webShareToTeams?this._shareToTeamsCoachmarkTarget:null},s.shareType===f.e.webShareToTeams?this._renderCoachmark():v.createElement(v.Fragment,null),v.createElement("div",{role:"presentation","aria-hidden":"true",className:"od-ShareTargets-itemImage new"},u)))))}return e};t.prototype._renderCoachmark=function(){return v.createElement(P,{componentRef:this._coachmarkRef,delayTimeInMilliseconds:200,target:this._shareToTeamsCoachmarkTarget,onTeachingBubbleSeen:this.context.onTeachingBubbleSeen(this.context.campaignKey),onPrimaryButtonClicked:this._onClick.bind(this,f.e.webShareToTeams)})};t.prototype._getShareTargetsData=function(){var e=[],t=this._determineMailShareTarget(this.props.clientId);Object(B.e)()&&window.sessionStorage.setItem("outlookAvailability",t.toString());if(t===L.e.available){var n=T.o(this.props.clientId)?"font:OutlookLogo":j,r="".concat(w.Io," ").concat(w.ei);e.push({label:r,icon:n,bgColor:"ms-bgColor-themePrimary",shareType:f.e.outlook,action:this._onClick.bind(this,f.e.outlook),id:"od-ShareTarget-outlookButton"})}else if(t===L.e.other){r="".concat(w.Io," ").concat(w.Er);e.push({label:r,icon:"font:Mail",bgColor:"ms-bgColor-themePrimary",shareType:f.e.nonOutlook,action:this._onClick.bind(this,f.e.nonOutlook),id:"od-ShareTarget-nonOutlookButton"})}if(Object(H.h)()){r="".concat(w.Io," ").concat(w.Xu);e.push({label:r,icon:"font:TeamsLogo",bgColor:"ms-bgColor-themePrimary",shareType:f.e.mobileShareToTeams,action:this._onClick.bind(this,f.e.mobileShareToTeams),id:"od-ShareTarget-mobileTeamsButton"})}else if(this.props.fullscreenIframeMode&&this._shareToTeamsExperiment&&!this.context.platformDetection.isIE&&this._showTeams){n=F,r="".concat(w.Io," ").concat(w.Xu);e.push({label:r,icon:n,bgColor:"ms-bgColor-themePrimary",shareType:f.e.webShareToTeams,action:this._onClick.bind(this,f.e.webShareToTeams),id:"od-ShareTarget-webTeamsButton"})}if(Object(H.f)()){r="".concat(w.Io," ").concat(w.rr);e.push({label:r,icon:"font:More",bgColor:"ms-bgColor-themePrimary",shareType:f.e.moreApps,action:this._onClick.bind(this,f.e.moreApps),id:"od-ShareTarget-moreAppsButton"})}return e};t.prototype._onClick=function(e){var t;e===f.e.webShareToTeams&&(null===(t=this._coachmarkRef.current)||void 0===t||t.dismiss());this.props.onShareTargetClicked(e)};t.prototype._determineMailShareTarget=function(e){return T.g(this.props.clientId)&&this.props.outlookAvailability===L.e.available?L.e.available:Object(H.r)()};t.contextTypes={platformDetection:m.object.isRequired,shouldTeachingBubbleBeShown:m.func,onTeachingBubbleSeen:m.func,markTeachingBubbleAsDismissed:m.func,campaignKey:m.number,canUseTeams:m.func};return t})(v.Component);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SummaryBox-header-Area{display:flex;justify-content:space-between;align-items:center;min-height:24px}.od-SummaryBox-header-TextField{display:flex;font-weight:600;font-size:.625rem;align-self:center}.od-SummaryBox-summary-Main{margin:auto;padding-top:0}.od-SummaryBox-header-sparkle{height:15%;width:15%;align-self:center}[dir=ltr] .od-SummaryBox-header-sparkle{margin-right:3px}[dir=rtl] .od-SummaryBox-header-sparkle{margin-left:3px}.od-Summary-tooltipIcon{vertical-align:middle}[dir=ltr] .od-Summary-tooltipIcon{margin-left:calc(50% - 5px + 5px)}[dir=rtl] .od-Summary-tooltipIcon{margin-right:calc(50% - 5px + 5px)}.od-SummaryBox-buttonsContainer{display:flex}.od-SummaryBox-header-closeButton{height:16px;width:16px}.od-SummaryBox-header-closeButtonIcon{font-size:.625rem}.od-SummaryBox-summary-Main::-webkit-scrollbar{width:5px;height:27px}.od-SummaryBox-summary-Main::-webkit-scrollbar-thumb{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-radius:38px}.od-SummaryBox-summary-Main::-webkit-scrollbar-track{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:38px}.od-SummaryBox-footer-CharacterCount{text-align:right;font-size:.625rem;margin-top:5px;align-self:center}"}]);var q=n(419),R=n(500),U=function(e){var t,n=e.summaryText,r=e.onSave,i=e.renderSeparator,s=Object(v.useState)(!1),o=s[0],u=s[1],a=Object(v.useState)(n),f=a[0],l=a[1],c=Object(v.useState)(!1),h=c[0],d=c[1],m="(".concat(f.length,"/").concat(500,")");return v.createElement(v.Fragment,null,!o&&v.createElement(v.Fragment,null,i&&v.createElement(R.e,null),v.createElement("div",{className:"od-SummaryBox-Entire"},v.createElement("div",{className:"od-SummaryBox-header-Area"},v.createElement("div",{className:"od-SummaryBox-header-TextField"},(t=window.require.toUrl("odsp-media/images/photostream/sparklepreviewcolor.svg"),v.createElement("img",{role:"presentation",src:t,className:"od-SummaryBox-header-sparkle"})),w.Uo,v.createElement(O.e,{content:w.zo},v.createElement(A.e,{iconName:"Error",className:"od-Summary-tooltipIcon"}))),v.createElement(q.e,{className:"od-SummaryBox-header-closeButton",onClick:function(){u(!0);r("")},iconProps:{iconName:"Cancel",className:"od-SummaryBox-header-closeButtonIcon"},title:w.Zs})),v.createElement("div",{className:"od-SummaryBox-summary-TextArea"},v.createElement(p.e,{className:"od-SummaryBox-summary-Main",borderless:!0,ariaLabel:w.qo,placeholder:w.Ro,defaultValue:f,value:f,styles:{fieldGroup:{border:"none",borderRadius:"0px"}},multiline:!0,resizable:!1,onChange:function(e,t){l(t||"");d(!0)},onBlur:function(){if(h){r(f);d(!1)}}}),f.length>250&&v.createElement("div",{className:"od-SummaryBox-footer-CharacterCount"},m)))))};U.propTypes={summaryText:m.string.isRequired,onSave:m.func.isRequired};var z,W=U,X=(function(e){Object(r.r)(t,e);function t(t,n){var i=e.call(this,t)||this;i._topLevelDivRef=v.createRef();i._validateMessage=function(e){i.props.onSendLinkMessageChange(e);var t=Object(E.p)(e);i.setState(Object(r.e)(Object(r.e)({},i.state),{messageLength:t}));return""};i._validateSubject=function(e){i.props.onSendLinkSubjectChange(e);var t=Object(E.p)(e);i.setState(Object(r.e)(Object(r.e)({},i.state),{subjectLength:t}));return e.length<=i.props.maximumSubjectLength?"":e.length+"/"+i.props.maximumSubjectLength};i._onResolvedSuggestions=function(e){i.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e);return e};i._onSendLinkClicked=function(e,t){if(i.props.summaryText){var n=Object(r.e)(Object(r.e)({},i.props.engagementExtraData),{summaryTextRemoved:""===i.state.summaryContent,summaryTextEdited:""!==i.state.summaryContent&&i.state.summaryContent!==i.props.summaryText,summaryTextFailed:!!i.props.summaryText&&-1!==i.props.summaryText.indexOf("Something went wrong with retrieving a summary")});i.context.sharingStore.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked.WithSummary",n)}i.props.onSendLinkClicked(e,t)};i._platformDetection=n.platformDetection;i.state={messageLength:0,summaryContent:i.props.summaryText,subjectLength:0};i._onManageExistingAccessClick=i._onManageExistingAccessClick.bind(i);i._resizeTracker=new N.e(n.resize);return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){d.u({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:Object(E.r)(e.sharingInformation)?e.onShareHintClick:void 0,permissionsMap:e.permissionsMap});this.setState(Object(r.e)({},this.state))};t.prototype.componentDidMount=function(){this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(e){this._resizeIfNeeded();e.summaryText!==this.props.summaryText&&this.props.showItemInsights&&this.props.summaryText&&this.updateSummaryContent(this.props.summaryText)};t.prototype.render=function(){var e=this.props,t=e.currentSettings,n=e.linkRecipients,r=d.n(n),i=d.r(n,e.groupsMemberCount),s=this._platformDetection.isIOS||T.s(this.props.clientId)?"od-SendLink-emailButtons-rounded":this._platformDetection.isAndroid||T.n(this.props.clientId)?"od-SendLink-emailButtons-allCaps":"od-SendLink-emailButtons-left";s+=this._isRoleSelectorCompactExperimentOn?" od-SendLink-emailButtons-roleSelector":"";var o=v.createElement(I,{fullscreenIframeMode:this.props.fullscreenIframeMode,clientId:this.props.clientId,currentSettings:this.props.currentSettings,onShareTargetClicked:this.props.onShareTargetClicked,outlookAvailability:this.props.outlookAvailability,sharingInformation:this.props.sharingInformation}),u=!D.t.isActivated("c64fce8e-f4d5-4df5-904c-2fbb56e98484","02/23/2023","Allow the sending of document summary in an email through sharing dialog."),a=this.props.showSendButton?v.createElement("div",{className:s},v.createElement(y.e,{ctaLabel:this.props.ctaLabel,currentSettings:this.props.currentSettings,errorMessage:this.props.errorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:this.props.maximumMessageLength,maximumSubjectLength:this.props.maximumSubjectLength,messageText:u?""===this.props.summaryText?this.props.messageText:this.props.messageText+"\n"+this.state.summaryContent:this.props.messageText,subjectText:this.props.subjectText,onSendLinkClicked:this._onSendLinkClicked,permissionsMap:this.props.permissionsMap,sendButtonType:b.e.button,sharingInformation:this.props.sharingInformation})):"",f=e.isLoadingDefaultRecipients?v.createElement("div",null,v.createElement(S.e,{className:"od-SendLink-spinner",label:w.Un,size:x.e.small})):v.createElement(g.e,{defaultSelectedItems:n,error:e.errorMessage,onChange:e.onSelectedPeopleChange,onResolvedSuggestions:this._onResolvedSuggestions,oversharingExternalsWarning:r,oversharingGroupsWarning:i,pickerSettings:e.sharingInformation.peoplePickerSettings,sharingLinkKind:t.sharingLinkKind,sharingInformation:e.sharingInformation,permissionsMap:e.permissionsMap,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),clientId:e.clientId,onInputChange:e.onPeoplePickerInputChange||null,renderRoleSelector:this._shouldRenderRoleSelector(),roleSelectorProps:this._getRoleSelectorProps()});return v.createElement("div",{ref:this._topLevelDivRef,className:"od-SendLink"},v.createElement("div",{className:"od-SendLink-email"},v.createElement("div",{className:"od-SendLink-peoplePicker"},f),v.createElement("div",{className:"od-SendLink-message",id:"od-SendLink-message-id"},this._renderTextArea(),this._renderCharacterCounter(),v.createElement("div",{className:"od-SendLink-method"},o,a))))};t.prototype._shouldRenderRoleSelector=function(){return this.props.currentSettings.audience!==o.e.existing};t.prototype._getRoleSelectorProps=function(){var e=Object(E.B)(this.props.sharingInformation),t=Object(C.t)({sharingInformation:this.props.sharingInformation,audience:this.props.currentSettings.audience,mode:c.e.share}),n=Object(C.a)(this.props.currentSettings.audience,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension);return{shimmer:e,menuPermissionOptions:t,sharingRole:this.props.currentSettings.sharingRole,mode:c.e.share,clientId:this.props.clientId,ariaLabel:w.Pn,showStopSharing:!1,onRoleChange:this.props.onRoleChange,showLinkSettings:!0,onLinkSettingsClicked:this.props.onLinkSettingsClicked,currentSettings:this.props.currentSettings,roleSelectorAs:k.e,showDropdownWithOfficeReview:n}};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._onManageExistingAccessClick=function(){this.context.sharingStore.getEngagementHelper().whoElseHasAccessClicked(this.props.engagementExtraData);this.props.onManageExistingAccessClick()};t.prototype.updateSummaryContent=function(e){this.setState({summaryContent:e})};t.prototype._renderTextArea=function(){var e=this;if(this.props.showTextArea){var t=this.props.showItemInsights&&!!this.props.summaryText,n=this.props.summaryText;return v.createElement("div",{className:"od-SendLink-message-TextField"},this._isSubjectExperimentOn&&v.createElement(p.e,{borderless:!0,underlined:!0,placeholder:w.Ru,onGetErrorMessage:this._validateSubject,defaultValue:this.props.subjectText}),v.createElement(p.e,{borderless:!0,placeholder:w.Kn,ariaLabel:w.Qn,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,defaultValue:this.props.messageText}),t&&v.createElement(W,{summaryText:n,onSave:function(t){n=t;e.updateSummaryContent(t)},renderSeparator:!0}))}};t.prototype._renderCharacterCounter=function(){var e=this.state.messageLength,t=e>this.props.maximumMessageLength,n="od-SendLink-characterCounter ".concat(t?"od-SendLink-characterCounter--error":"");if(e>this.props.maximumMessageLength/2)return t?v.createElement("div",{className:"od-SendLink-characterCounterWrapper"},v.createElement("span",{"aria-label":w.Ne,role:"alert",className:n},e,"/",this.props.maximumMessageLength)):v.createElement("div",{className:"od-SendLink-characterCounterWrapper"},v.createElement("span",{className:n},e,"/",this.props.maximumMessageLength))};t.contextTypes={platformDetection:m.object.isRequired,sharingStore:m.object.isRequired,resize:m.func.isRequired};return t})(v.Component),V=n(213),$=n(183),J=n(88),K=n(3);(z||(z={})).getAttachAsCopyOptions=function(e,t,n,r){var i=[],s=(function(e,t,n,r){var i=n.name.split("."),s="";i.length>1&&(s=i[1].toLowerCase());if(Object(H.l)()){var o=function(){(function(e,t){e.getEngagementHelper().sendACopyOfficeClicked(t);Object(H.b)()})(e,r)};return T.d(t)||(function(e){return["doc","docx","dot","docm","odt","rtf","txt"].indexOf(e)>-1})(s)?{key:"word",name:w.fa,iconProps:{iconName:"WordDocument",className:"Share-wordIcon"},onClick:o}:T.c(t)||(function(e){return["ppt","pptx","pptm","ppsx","pps","ppsm","odp"].indexOf(e)>-1})(s)?{key:"powerpoint",name:w.Es,iconProps:{iconName:"PowerPointDocument",className:"Share-powerpointIcon"},onClick:o}:T.i(t)||(function(e){return["xlsx","xlsm","xlsb","xls","ods","csv","xlt","xltm","xltx"].indexOf(e)>-1})(s)?{key:"excel",name:w.At,iconProps:{iconName:"ExcelDocument",className:"Share-excelIcon"},onClick:o}:T.p(t)||(function(e){return["vsd","vsdx"].indexOf(e)>-1})(s)?{key:"visio",name:w.ua,iconProps:{iconName:"VisioLogo"},onClick:o}:{key:"document",name:w.St,iconProps:{iconName:"Document"},onClick:o}}})(n,e,t,r);s&&i.push(s);var o=(function(e,t){if(Object(H.c)())return{key:"pdf",name:w.Ai,iconProps:{iconName:"PDF",className:"Share-pdfIcon"},onClick:function(){(function(e,t){e.getEngagementHelper().sendACopyPdfClicked(t);Object(H.E)()})(e,t)}}})(n,r);o&&i.push(o);return i};var Q=z,G=n(214),Y=n(309),Z=n(76),ee=n(58),te=n(8),ne=n(70),re=n(279),ie=n(231),se=n(207),oe=n(43),ue=500,ae=(function(e){Object(r.r)(t,e);function t(t,n){var r=e.call(this,t)||this;r._headerControl=Object(v.createRef)();r._peoplePickerHasUnresolvedText=!1;r._onSharedWithClicked=function(){r.context.sharingStore.getEngagementHelper().manageAccessFacePileClicked(r._engagementExtraData);r.props.onShowPermissionsListClicked()};r._onConfirmationExternalSharingApply=function(){r.setState({showConfirmationDialog:!1,showShareHintAnimation:!0},function(){r.props.onAudienceChange(o.e.specificPeopleFlex,u.e.flexible,a.e.specificPeople)})};r._onConfirmationExternalSharingCancel=function(){r.setState({showConfirmationDialog:!1})};r._onSelectedPeopleChange=function(e){var t=r.props,n=void 0;if(Object(E.r)(t.sharingInformation)){n=t.onShareHintClick;te.p()&&(n=t.onShareHintClick.bind(r,ne.t.PeoplePickerErrorLinkSettingsHint))}var i=d.u({selectedItems:e,sharingLinkKind:t.currentSettings.sharingLinkKind,canAddExternalPrincipal:t.sharingInformation.canAddExternalPrincipal,sharingInformation:t.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked,onShareHintClick:n,permissionsMap:t.permissionsMap,audience:t.currentSettings.audience,scope:t.currentSettings.sharingScope}),s=!1,o=!1,f=null;if(i){for(var l=t.currentSettings.sharingLinkKind,c=te.G()?l===u.e.organizationEdit||l===u.e.organizationView:t.currentSettings.sharingScope===a.e.organization,h=0,p=e;h<p.length;h++){var v=p[h];if(v.isExternal&&c){s=!0;if(_.t()){o=!0;f=v}break}}s&&r.context.sharingStore.getEngagementHelper().externalSharingCslError(r._engagementExtraData)}r.setState({peoplePickerErrorMessage:i,showConfirmationDialog:o,externalSharingPerson:f},function(){t.onSelectedPeopleChange(e)})};r._onPeoplePickerInputChange=function(e){r._peoplePickerHasUnresolvedText=""!==e};r._onShareTargetClicked=function(e,t){(r.context.sharingStore.isConsumer()&&r.props.currentSettings.audience!==o.e.specificPeople||r._isPeoplePickerValid(e)||!(r.props.currentSettings.audience===o.e.specificPeopleFlex||r.props.currentSettings.audience===o.e.specificPeople||r.props.linkRecipients.length>0))&&r.setState({showActivityIndicator:!0,shareType:e},function(){r.props.onShareTargetClicked(e,t)})};r._onCopyLinkSectionCopyButtonClicked=function(){r.context.sharingStore.getEngagementHelper().log("ShareV3.copyLinkSectionCopyButtonClicked",r.props.engagementExtraData);r._onShareTargetClicked(f.e.copy,!0)};r._onSendLinkClicked=function(e,t){r.context.sharingStore.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked",r.props.engagementExtraData);r._isPeoplePickerValid(f.e.share)&&r.setState({showActivityIndicator:!0,shareType:f.e.share},function(){r.props.onSendLinkClicked(e,t)})};r._onAttachAsCopyClicked=function(){var e=r.props.clientId;r.context.sharingStore.getEngagementHelper().sendACopyClicked(r._engagementExtraData);if(T.a(e)){var t=!r.state.isAttachAsCopyContextualMenuVisible;r.setState({isAttachAsCopyContextualMenuVisible:t},function(){})}else if(e===l.e.ngsc||T.o(e))try{window.external.SendCopy()}catch(e){}};r._shareClickTime=n.shareClickTime;r._shouldRenderSharedWith=!n.sharingStore.isConsumer||!n.sharingStore.isConsumer()||te.e();r._engagementExtraData=t.engagementExtraData;r._sharingClientMessenger=n.sharingClientMessenger;r.state={isAttachAsCopyContextualMenuVisible:!1,shareType:f.e.share,showActivityIndicator:!1,peoplePickerErrorMessage:null,showConfirmationDialog:!1,externalSharingPerson:null,showShareHintAnimation:!1};return r}t.prototype.componentDidMount=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():H.m(this._shareClickTime,this.props.clientId,c.e.share,this.props.scenarioId,this.props.correlationId);this._updatePeoplePickerError(this.props);T.o(this.props.clientId)&&this._headerControl.current&&this._headerControl.current.focusCloseButton()};t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._updatePeoplePickerError(e)};t.prototype.render=function(){var e=this.props,t=this.state.showActivityIndicator?this._getActivityMessage():"",n=this.props.hideShareDialogOverflowButton||this._shouldRenderSharedWith,i=this._renderFooter(),o=this.props.hasBackButton?"od-ShareMain-Header-backBtnAdjust":"";return v.createElement("div",{className:"od-ShareMain ".concat(this.state.showActivityIndicator?" blocker":"")},v.createElement("div",{className:"od-ShareMain-section new"},v.createElement("div",{className:"od-ShareMain-Header ".concat(o)},v.createElement(s.e,Object(r.e)({},Object(J.e)(this.props),{item:e.item,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,viewState:K.e.default,hideShareDialogOverflowButton:n,ref:this._headerControl,hasBackButton:this.props.hasBackButton,closeButtonOnBlur:this.props.closeButtonOnBlur,closeButtonOnFocus:this.props.closeButtonOnFocus,fullScreenIframeMode:this.props.fullScreenIframeMode,sensitivityLabelInformation:this.props.sharingInformation.sensitivityLabelInformation,getGraphToken:this.props.getGraphToken}))),v.createElement("div",{className:"od-ShareMain-ShareHint ".concat(this.state.showShareHintAnimation?"animation":"")},v.createElement($.e,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,onShareHintClick:e.onShareHintClick.bind(this,ne.t.MainLinkSettingsHint),sharingInformation:e.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig})),this._renderSendLink(),this.props.shouldWaitForSharingInfoBarInformation&&this._renderSharingInfoBar()),this._renderCopyLinkSection(n),this._renderSharedWith(),i,this._renderActivityIndicator(),this._renderConfirmationDialogExternalSharing(),ee.e(t,"assertive","alert",!0))};t.prototype._renderSharingInfoBar=function(){return v.createElement(v.Suspense,{fallback:v.createElement(S.e,null)},v.createElement(oe.c,{sharingInfoBarMessageTypeId:this.props.sharingInfoBarMessageTypeId,parentCssClass:"ShareMain"}))};t.prototype._renderCopyLinkSection=function(e){return te.P()?v.createElement(v.Fragment,null,v.createElement(re.e,null),v.createElement(ie.e,{singleComponent:!1,clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:this.props.currentSettings,sharingInformation:this.props.sharingInformation,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,hostOptions:this.props.hostOptions,onShareHintClick:this.props.onShareHintClick,onSendLinkClicked:this._onCopyLinkSectionCopyButtonClicked})):v.createElement("div",{className:"od-ShareMain-section new separator-top"},v.createElement(s.e,Object(r.e)({},Object(J.e)(this.props),{item:this.props.item,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,viewState:K.e.default,hideShareDialogOverflowButton:e,ref:this._headerControl,title:w.We,doNotrenderHeaderButtons:!0,hideItemName:!0,titleIsSubLevel:!0})),v.createElement("div",{className:"od-ShareMain-copyLink shareType-section"},v.createElement($.e,{clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:this.props.currentSettings,onShareHintClick:this.props.onShareHintClick.bind(this,ne.t.CopyLinkSettingsHint,!0),sharingInformation:this.props.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}),v.createElement("div",{className:"od-ShareMain-copyLink copyLink-button"},v.createElement(y.e,{ctaLabel:w.Xe,currentSettings:this.props.currentSettings,errorMessage:this.state.peoplePickerErrorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:ue,maximumSubjectLength:ue,messageText:this.props.messageText,subjectText:this.props.subjectText,onSendLinkClicked:this._onCopyLinkSectionCopyButtonClicked,permissionsMap:this.props.permissionsMap,sendButtonType:b.e.copyLink,sharingInformation:this.props.sharingInformation}))))};t.prototype._renderFooter=function(){var e=this.props,t=e.clientId;if(T.a(t)){var n=Q.getAttachAsCopyOptions(t,e.item,this.context.sharingStore,this._engagementExtraData);if(1===n.length&&"pdf"!==n[0].key)return v.createElement("div",null,v.createElement("button",{className:"od-ShareMain-footer",onClick:n[0].onClick},v.createElement("div",{"aria-hidden":!0,role:"presentation",className:"od-ShareMain-attachIcon"},v.createElement(A.e,{iconName:"Copy"})),v.createElement("span",null,w.Z)));if(n.length>0)return v.createElement("div",null,v.createElement(Y.e,{className:"od-ShareMain-footer",text:w.Z,iconProps:{iconName:"Copy"},menuProps:{shouldFocusOnMount:!0,items:n},styles:{label:{marginLeft:"0px"}}}))}else if((t===l.e.ngsc||T.o(t))&&this._isSendCopyEnabled())return v.createElement("div",null,v.createElement("button",{className:"od-ShareMain-footer",onClick:this._onAttachAsCopyClicked},v.createElement("div",{className:"od-ShareMain-attachIcon"},v.createElement(A.e,{iconName:"Copy"})),v.createElement("span",null,w.Z)))};t.prototype._renderSendLink=function(){if(!this.props.sharingInformation.blockPeoplePickerAndSharing||Object(E.B)(this.props.sharingInformation)){var e=this.props;return v.createElement(X,{fullscreenIframeMode:this.props.fullScreenIframeMode,ctaLabel:w.To,showTextArea:!0,sharingInformation:e.sharingInformation,onSendLinkClicked:this._onSendLinkClicked,currentSettings:e.currentSettings,onSelectedPeopleChange:this._onSelectedPeopleChange,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,linkRecipients:e.linkRecipients,permissionsMap:e.permissionsMap,messageText:e.messageText,summaryText:e.summaryText,subjectText:e.subjectText,onSendLinkMessageChange:e.onSendLinkMessageChange,onSendLinkSubjectChange:e.onSendLinkSubjectChange,createPeopleSharingLinks:e.createPeopleSharingLinks,errorMessage:this.state.peoplePickerErrorMessage,clientId:e.clientId,showSendButton:!0,maximumMessageLength:ue,maximumSubjectLength:100,isLoadingDefaultRecipients:e.isLoadingDefaultRecipients,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,engagementExtraData:this._engagementExtraData,onShareHintClick:this.props.onShareHintClick,onRoleChange:this.props.onRoleChange,onPeoplePickerInputChange:this._onPeoplePickerInputChange,onLinkSettingsClicked:e.onShareHintClick.bind(this,ne.t.RoleSelector),onShareTargetClicked:this._onShareTargetClicked,outlookAvailability:this.props.outlookAvailability,showItemInsights:this.props.showItemInsights})}};t.prototype._renderSharedWith=function(){if(this._shouldRenderSharedWith){var e=Object(E.C)(this.props.sharingInformation,this.context.sharingStore.isConsumer()),t=e.shared,n=e.activeLinks,r=e.sharingPrincipals;return t?v.createElement("div",{className:"od-ShareMain-section od-ShareMain-SharedWith new separator-top"},v.createElement(V.e,{ariaLabel:w.Wn,label:w.Xo,getPhotoUrl:Object(Z.t)(this.props.sharingInformation.webUrl),onClick:this._onSharedWithClicked,sharingLinks:n,sharingPrincipals:r})):null}return null};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return v.createElement(G.e,{message:this._getActivityMessage(),ariaHidden:!0})};t.prototype._renderConfirmationDialogExternalSharing=function(){if(!_.t()||!this.state.showConfirmationDialog||!this.state.externalSharingPerson)return null;var e=this.state.externalSharingPerson;return v.createElement(v.Suspense,{fallback:v.createElement(S.e,null)},v.createElement(oe.t,{confirmationCode:se.e.shareDialogExternalSharing,participant:e,onApply:this._onConfirmationExternalSharingApply,onCancel:this._onConfirmationExternalSharingCancel}))};t.prototype._getActivityMessage=function(){switch(this.state.shareType){case f.e.share:return w.p;case f.e.mobileShareToTeams:case f.e.webShareToTeams:return w.h;case f.e.outlook:return w.c;case f.e.copy:case f.e.nonOutlook:case f.e.moreApps:default:return w.l}};t.prototype._isSendCopyEnabled=function(){return H.l()};t.prototype._isPeoplePickerValid=function(e){if(!this.state.peoplePickerErrorMessage){if(e!==f.e.share&&!this.props.createPeopleSharingLinks&&this.props.currentSettings.audience===o.e.specificPeople){for(var t=!1,n=!1,r=0,i=this.props.linkRecipients;r<i.length;r++){var s=i[r];t||(t=s.isExternal&&!s.providerName);n||(n=!s.isExternal||s.isExternal&&!!s.providerName)}if(t&&n){this.setState({peoplePickerErrorMessage:v.createElement("span",{role:"alert","aria-live":"assertive"},w.Yn)});return!1}}var u=this.props.currentSettings.audience===o.e.specificPeopleFlex||this.props.currentSettings.audience===o.e.specificPeople||e===f.e.share;if(this._peoplePickerHasUnresolvedText){this.setState({peoplePickerErrorMessage:v.createElement("span",{role:"alert","aria-live":"assertive"},w.Gu)});return!1}if(0===this.props.linkRecipients.length&&u){this.setState({peoplePickerErrorMessage:v.createElement("span",{role:"alert","aria-live":"assertive"},w.Ys)});return!1}return!0}};t.prototype._updatePeoplePickerError=function(e){var t=void 0;if(Object(E.r)(e.sharingInformation)){t=e.onShareHintClick;te.p()&&(t=e.onShareHintClick.bind(this,ne.t.PeoplePickerErrorLinkSettingsHint))}if(e.linkRecipients||e.sharingInformation.errorCategory==h.e.shareLink){var n=d.u({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:t,permissionsMap:e.permissionsMap,audience:e.currentSettings.audience,scope:e.currentSettings.sharingScope});n||e.sharingInformation.errorCategory!=h.e.shareLink||(n=v.createElement("span",null,e.sharingInformation.errorMessage));this.setState({peoplePickerErrorMessage:n,showActivityIndicator:!n&&this.state.showActivityIndicator})}};t.prototype.shouldShowActivityIndicator=function(e){this.setState({showActivityIndicator:e})};t.contextTypes={shareClickTime:m.number,sharingStore:m.object.isRequired,sharingClientMessenger:m.object};return t})(v.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n("react-lib"),i=n("prop-types-lib"),s=n(13);Object(s.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-sensitiviity-label-left-align{border-radius:2px;padding:3px!important;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-sensitivity-label{border-radius:4px;padding:3px 6px 3px 6px!important;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";display:flex}[dir=ltr] .od-sensitivity-label{margin-left:8px}[dir=rtl] .od-sensitivity-label{margin-right:8px}.od-sensitivity-text{font-size:.75rem;font-weight:400;font:-apple-system-caption1;margin:0;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.od-sensitivity-tooltip-text{font-size:.75rem;font-weight:600;margin:0;margin-bottom:2px}.od-sensitivity-tooltip-information{font-size:.75rem;margin:0}"}]);var o=n(397),u=n(382),a=n(30),f=n(31),l=n(1);c.contextTypes={sharingStore:i.object.isRequired};function c(e,t){var n=r.useState(null),i=n[0],s=n[1],c=1===f.s();e.sensitivityLabelInformation.displayName&&t.sharingStore.getEngagementHelper().showSensitivityLabel(e.engagementExtraData);return r.createElement(u.e,{tooltipProps:{directionalHint:a.e.bottomAutoEdge,onRenderContent:function(){return(function(){t.sharingStore.getEngagementHelper().hoverOverSensitivityLabel(e.engagementExtraData);return r.createElement("div",{className:"od-sensitivity-tooltip"},r.createElement("p",{className:"od-sensitivity-tooltip-text"},c&&l.ko," ",e.sensitivityLabelInformation.displayName),r.createElement("p",{className:"od-sensitivity-tooltip-information"},i))})()},calloutProps:{hidden:null===i||0===i.length}},onTooltipToggle:function(n){return n?void(null===i&&t.sharingStore.getSensitivityLabels(e.getGraphToken).then(function(t){if(t){var n=t.filter(function(t){return t.id===e.sensitivityLabelInformation.id});0!==n.length?s(n[0].tooltip):s("")}else s("")}).catch(function(){s("")})):null},styles:{root:{display:"flex",overflow:"hidden",width:"min-content"}}},r.createElement(o.e,{tabIndex:0,className:e.filename&&0!==e.filename.length?"od-sensitivity-label":"od-sensitiviity-label-left-align"},r.createElement("p",{className:"od-sensitivity-text"},e.sensitivityLabelInformation.displayName)))}},,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(61),i=n(4),s=Object(r.e)({eventName:"Trace,",shortEventName:"Trace"},{message:i.e.String,privacyClassification:{isPrefixingDisabled:!0,type:i.e.String}}).withData({privacyClassification:i.t.requiredService,privacyDataTypes:["browsingHistory"]})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e,t){var n,r,i=!!e.Fallback,s=e.ODB;if("boolean"==typeof s)i=s;else if(s>0){if(s>=6e4){var o=s-6e4+2e3+1;n=Math.floor(o/32);r=1<<o%32}else{if(!(s<=2e3))return!1;n=Math.floor(s/32);r=1<<s%32}i=n<t.length&&0!=(t[n]&r)}return i}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={CUSTOM_SETTINGS_1:"WorkloadSettingsSubLinks1",CUSTOM_SETTINGS_2:"WorkloadSettingsSubLinks2",CUSTOM_SETTINGS_3:"WorkloadSettingsSubLinks3",FEEDBACK:"ShellFeedback",DIAGNOSTICS:"Diagnostics",O365_SETTINGS:"ShellO365Settings",ADD_APP:"SuiteMenu_zz5_MenuItemCreate",SITE_CONTENTS:"SuiteMenu_zz6_MenuItem_ViewAllSiteContents",SITE_SETTINGS:"SuiteMenu_zz7_MenuItem_Settings",SITE_INFORMATION:"SuiteMenu_MenuItem_SiteInformation",SITE_PERMISSIONS:"SuiteMenu_MenuItem_SitePermissions",SITE_DESIGNS:"SuiteMenu_MenuItem_SiteDesigns",SITE_TEMPLATES:"SuiteMenu_MenuItem_SiteTemplates",HUB_SETTINGS:"SuiteMenu_MenuItem_HubSettings",USER_ACTIVITY:"UserActivity",LIBRARY_SETTINGS:"SuiteMenu_LibrarySettings",LIST_SETTINGS:"SuiteMenu_ListSettings",LANGUAGE:"SuiteMenu_Language",CHANGE_THE_LOOK:"Change_The_Look",VIVA_CONNECTIONS:"Viva_Connections_Settings",ABOUT_ME:"ShellAboutMe",SETTINGS:"ShellSettings",MY_SETTINGS:"SuiteMenu_zz2_ID_PersonalInformation",SIGN_OUT:"ShellSignout",HELP:"HelpLink",COMMUNITY:"ShellCommunity",PRIVACY:"ShellPrivacy",LEGAL:"ShellLegal",USERVOICE:"UserVoice",FIRSTRUN:"FirstRun",DEVELOPERS:"Developers",ABUSE:"ReportAbuse",IMPRESSUM:"Impressum",MAIL:"ShellMail",CALENDAR:"ShellCalendar",PEOPLE:"ShellPeople",ONEDRIVE:"ShellDocuments",WORD:"ShellWordOnline",EXCEL:"ShellExcelOnline",POWERPOINT:"ShellPowerPointOnline",ONENOTE:"ShellOneNoteOnline",SITES:"ShellSites",YAMMER:"ShellYammer",TASKS:"ShellTasks",POWER_BI:"ShellPowerBI",DELVE:"ShellOfficeGraph",VIDEO:"ShellVideo",ALCHEMY:"ShellAlchemy",SMILE:"ShellSendASmile",STREAM:"ShellStream",LISTS:"Lists",SHAREPOINT:"Sharepoint",CLIPCHAMP:"Clipchamp"}},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(121),s=n(102),o=n(289),u=n(47),a=n(107),f=(function(){function e(e){void 0===e&&(e="sharedialog");var t=this;this.resetRumOneApiMeasurement=function(){t._rumone.undoAPIInstrument()};this.computeRenderTime=function(e){return e&&e.startTime&&e.endTime?e.endTime-e.startTime:0};this.checkRenderTimeRequiredDataAvailable=function(e){return!!e&&(!!e.startTime&&!!e.endTime)};this._rumone=i.e.getRUMOneLogger(e)}e.prototype.logSharingPerformance=function(e,t){var n=this;if(this._rumone&&this._rumone.isRunning()){var i=this.breakdownData;this._rumone.writeScenarioId("ShareDialog.".concat(e.modeName));this._rumone.addExpectedControl("ShareControl");this._rumone.writePageTransitionType(t||s.e.fullPageLoad);this._rumone.collectW3CPerfTimings();this._rumone.collectW3cResourceTimings();var u=location.href.toLowerCase().indexOf("sharedialog.aspx")>=0;if(u){this._rumone.collectSPClientFlights(window._spPageContextInfo);this._evaluateExperiments(window._spPageContextInfo)}this._rumone.setSettings({TTISettings:{TTIPolyfillSettings:{enabled:!0,calculateTTI:function(t,r,i){var s=n._regulateTime(t)-n._regulateTime(e.startTime);n._rumone.addEUPLBreakdown("ttiAbsoluteTime_".concat(i),{data:t,needFlatten:!1});n._rumone.addEUPLBreakdown("transactionStartTime_".concat(i),{data:e.startTime,needFlatten:!1});n._rumone.addEUPLBreakdown(i,{data:s,needFlatten:!1});return s},options:Object(r.e)({useMutationObserver:!1,trackNetworkRequests:!1},{requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3})},FCIMeasurementSettings:{disabled:!0}}});var a=new o.e({controlId:"ShareControl",startTime:e.startTime,endTime:e.endTime,renderTimeCalculator:this.computeRenderTime,renderTimeRequiredDataChecker:this.checkRenderTimeRequiredDataAvailable});this._rumone.writeControlPerformanceData(a);var f=e.breakDownData,l=this._getResponseEnd();f=Object(r.e)(Object(r.e)({},f),{waitForDomReady:Math.round(this._rumone.getMarkerTime("EUPL.AfterWaitForDomReady")-this._rumone.getMarkerTime("EUPL.BeforeWaitForDomReady")),herf:i(location.href),isShareDialogASPXHosted:i(u),w3cResponseEnd:i(l-performance.timing.navigationStart),appStart:i(this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart"))-this._regulateTime(l)),render:i(this._regulateTime(e.endTime)-this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart")))});this._rumone.writeEUPLBreakdown(JSON.stringify(f))}};e.prototype.resetRumOne=function(){if(!this._rumone.isRunning()){this._rumone.resetLogger();return!0}return!1};e.prototype.breakdownData=function(e){return{data:e,needFlatten:!0}};e.prototype._isDateTime=function(e){var t=new Date;return e>new Date(t.setDate(t.getDate()-1)).getTime()};e.prototype._regulateTime=function(e){return this._isDateTime(e)&&u.e?e-performance.timing.navigationStart:e};e.prototype._getResponseEnd=function(){return performance&&performance.timing?window.g_responseEnd&&(performance.timing.responseEnd&&Number(window.g_responseEnd)<performance.timing.responseEnd||!performance.timing.responseEnd)?Number(window.g_responseEnd):performance.timing.responseEnd:NaN};e.prototype._evaluateExperiments=function(e){e&&Object(a.n)(90089,e)};return e})()},function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(177),o=n(161),u=n(89),a=n(88),f=n(3),l=n(183),c=n(1),h=n(70);t.e=function(e){var t={hideItemName:!e.singleComponent,doNotrenderHeaderButtons:!e.singleComponent,titleIsSubLevel:!0,sendButtonType:e.singleComponent?u.e.button:u.e.copyLink,shouldBeFocused:e.singleComponent,hostOptions:e.hostOptions};return i.createElement("div",{className:"od-ShareMain-section new"},i.createElement(s.e,Object(r.e)({},Object(a.e)(e),{item:e.sharingInformation.item,viewState:f.e.copyLinkShortcut,title:c.We,hideItemName:t.hideItemName,doNotrenderHeaderButtons:t.doNotrenderHeaderButtons,titleIsSubLevel:t.titleIsSubLevel,hostOptions:t.hostOptions})),i.createElement("div",{className:"od-ShareMain-copyLink shareType-section"},i.createElement(l.e,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,onShareHintClick:function(){e.onShareHintClick(h.t.CopyLinkSettingsHint,!0)},sharingInformation:e.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig}),i.createElement("div",{className:"od-ShareMain-copyLink copyLink-button"},i.createElement(o.e,{ctaLabel:c.Xe,currentSettings:e.currentSettings,linkRecipients:null,onSendLinkClicked:e.onSendLinkClicked,permissionsMap:null,sharingInformation:e.sharingInformation,sendButtonType:t.sendButtonType,shouldBeFocused:t.shouldBeFocused}))))}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(61),i=n(4),s=Object(r.e)({eventName:"UnhandledError,",shortEventName:"UnhandledError",critical:!0},{message:i.e.String,stack:i.e.String,builtStack:i.e.String,line:i.e.Number,col:i.e.Number,url:i.e.String,privacyClassification:{isPrefixingDisabled:!0,type:i.e.String}}).withData({privacyClassification:i.t.requiredService,privacyDataTypes:["productAndServicePerformance"]})},function(e,t,n){"use strict";n.d(t,"e",function(){return _});var r=n(0),i=n(23),s=n(82),o=n(27),u=n(48),a=0,f=1,l=2,c=3,h=4,p=5,d=6,v=7,m=n(148),g=n(29),y=n(68),b=n(124),w=n(110),E=n(108),S=n(127),x=n(126),T=n(91),N=n(9),C=(function(){function e(t){var n;this._raw=t;if(t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var r,i,s=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,u=e.EmailMatchTypes.None;null!==(i=s.exec(t));){var a=i[0],f=a.charAt(0),l=a.charAt(a.length-1);if((u="<"===f&&">"===l?e.EmailMatchTypes.Bracketed:'"'===f&&'"'===l?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o){r=i;o=u;if(u===e.EmailMatchTypes.Bracketed)break}}var c=t;if(r){n=r[0];var h=r.index,p=h+n.length,d=h>0?t.substr(0,h).trim():"",v=p<t.length?t.substr(p):"";if("'"===(n=e.StripBracketsAndQuotesRegex.exec(n)[1]).charAt(0)&&v&&"'"===v.charAt(0)){n=n.slice(1);v=v.slice(1).trim()}c=""===d?v:d;this._email=n.trim()}(c=c.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==c.charAt(c.length-2)&&(c=c.replace(/\s*"$/,""));""!==(c=c.replace(/\//g,""))&&c!==n&&(this._name=c)}}e.isValidEmailSyntax=function(t,n){return!!t&&!!(n?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())};e.parse=function(t){if(!t)return[];for(var n=e._splitAddresses(t),r=[],i=0,s=n.length;i<s;i++)r.push(new e(n[i]));return r};e.endsWithDelimiter=function(t){if(t){var n=t.split(e.DelimiterRegex);return!n[n.length-1].trim()}return!1};e._splitAddresses=function(t){for(var n=t.split(e.DelimiterRegex),r=n.length-1;r>=0;r--){n[r]=n[r].trim();0===n[r].length&&n.splice(r,1)}return n};e.prototype.getEmail=function(){return this._email};e.prototype.getName=function(){return this._name};e.prototype.getRaw=function(){return this._raw};e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?";e.EmailRegex=new RegExp(e.EmailRegexPattern,"i");e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)";e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i");e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/;e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/;e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3};return e})(),k=n(28),L=n(6),A={ODB:60307},O=!N.t.isActivated("b7426b02-fdf6-4c5e-9809-e0c21db41db7","07/10/2022","remove hard code graph endpoint and read from spPageContextInfo")&&!o.e.isFeatureEnabled({ECS:1026572}),M=!N.t.isActivated("29b79ab1-ae17-42fd-b4e1-39e58a904f55","04/02/2023","enable IB discovery"),_=(function(e){Object(r.r)(t,e);function t(t,n){var r=this,i=D(t)?t:n.pageContext,s=null==n?void 0:n.noRedirect;r=e.call(this,{dataSourceName:"PeoplePickerDataSource"},{pageContext:i,noRedirect:s})||this;var o=D(t)?t.apiUrlHelper:n.apiUrlHelper;r._apiUrlHelper=o||new w.e({},{itemUrlHelper:new E.e({},{pageContext:i}),pageContext:i});r._capabilities={supportsMruCaching:!0};if(n){r._dataRequestor=n.dataRequestor;r._graphPeoplePickerHelper=n.graphPeoplePickerHelper;r._substratePeoplePickerHelper=n.substratePeoplePickerHelper;r._livePeoplePickerHelper=n.livePeoplePickerHelper;r._getAuthToken=n.getAuthToken}r._webAbsoluteUrl=i.webAbsoluteUrl;return r}t.prototype.getCapabilities=function(){return this._capabilities};t.prototype.getPersonaDetails=function(e){var t=this;return y.t.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},r=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,i={personDetails:n(r.Primary),managerChain:r.ManagerChain.results.map(n),directReports:r.DirectReports.results.map(n)};i.personDetails.profilePage=Object(s.t)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(i.personDetails.sip)+"&origin=ProfileODBCard";return i}})})};t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===g.e.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var r=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return y.t.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:r,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})};t.prototype.resolve=function(e,t){var n=this;return y.t.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){var s=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:r,additionalHeaders:s,parseResponse:function(e){var r=JSON.parse(e),s=JSON.parse(r.d.ClientPeoplePickerResolveUser),o=[];o[0]=s;s.IsResolved||s.EntityData.IsBlockedOnODB&&"true"===s.EntityData.IsBlockedOnODB.toLowerCase()||o&&!o[0].DisplayText&&(o[0].DisplayText=s.Key);var u=(o=n._transformData(o,t.filterExternalUsers))[0];if(t.filterExternalUsers&&u&&u.entityType===i.e.externalUser){u.isResolved=!1;u.entityType=i.e.regularUser}else if(t.blockViaPolicy&&!t.filterExternalUsers&&u&&!u.isResolved&&0===u.multipleMatches.length){u.isResolved=!0;u.isExternal=!0;u.entityType=i.e.externalUser}if(t.isGraphDistributionList&&t.useGraph&&u.isExternal){u.entityType=i.e.group;u.principalType=g.e.distributionList}return u}})})};t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t&&!this._dataRequestor&&(this._dataRequestor=new x.t({},{}));return t};t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();t&&!this._dataRequestor&&(this._dataRequestor=new x.t({},{}));return t};t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper};t.prototype.search=function(e,t){if(M&&t.enforceIBSegmentFiltering)return this.sharePointSearch(e,t);if(this.canUseSubstrate(t)||t.useNew3Ssearch)return this._substrateSearch(e,t);if(this.canUseGraph(t))return this._graphSearch(e,t);0===t.groupID&&(t.useSubstrateSearch=!0);return this.sharePointSearch(e,t)};t.prototype.sharePointSearch=function(e,t){var n=this;t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1);return y.t.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){var s=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"ClientPeoplePickerSearchUser",additionalHeaders:s,authToken:r,parseResponse:function(r){var s=t.allowSharePointGroups,o=void 0===s||s,u=t.filterExternalUsers,a=JSON.parse(r),f=JSON.parse(a.d.ClientPeoplePickerSearchUser),l=n._transformData(f,u);u&&(l=l.filter(function(e){return e.entityType!==i.e.externalUser}));l=l.filter(function(e){return e.principalType===g.e.sharePointGroup?o:e.principalType===g.e.securityGroup?o||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)});return n._handleZeroSearchResult(l,e,t,i.t.sharepointSearch)}})})};t.prototype.subscribePresence=function(e,t){var n=this;try{this._ensureSkypePresence();if(!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var r=function(e){try{switch(e){case 0:t(a);break;case 1:t(f);break;case 2:t(l);break;case 3:t(c);break;case 4:t(h);break;case 5:t(p);break;case 6:t(d);break;case 8:t(v);break;default:t(a)}}catch(e){}};this._skypeIntegration.TrackPresence(e,r);return{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,r)}catch(e){}}}}catch(e){}return null};t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)};t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}};t.prototype._graphSearch=function(e,n){var r=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(s){var o;if(!s)return r.sharePointSearch(e,n);var u=O&&r._pageContext&&r._pageContext.msGraphEndpointUrl?null===(o=r._pageContext)||void 0===o?void 0:o.msGraphEndpointUrl:"https://graph.microsoft.com",a=new k.e("".concat(u,"/v1.0/me/people"));if(e){a.setQueryFromObject({$search:'"'.concat(e,'"'),$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"});if(N.t.isActivated("08c31a2f-5109-4dd9-b6ab-d6ea8fec0d9f","09/29/2020","Fix bug: Should correctly handle PrincipalType in Graph query filter."))!1!==n.filterPublicDistributionList&&a.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'");else{var f=t._getPersonTypeFilter(n);f&&a.setQueryParameter("$filter",f)}}var l=new L.e({name:"PeoplePickerGraphSearch"});return r._dataRequestor.send({apiName:"Graph.PeopleSearch",path:a.toString(),headers:{Authorization:"Bearer "+s,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0);if(t&&t.value&&0!==t.value.length)l.end({resultType:L.t.Success});else{l.end({resultType:L.t.Failure,extraData:{error:"graph search return empty results"}});if(e)return r.sharePointSearch(e,n)}var s=t.value,o=[];s.forEach(function(e){if(!e.personType.subclass||!r._isIgnorablePeopleSubType(e.personType.subclass)){var t,s=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",u=e.userPrincipalName&&r._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:s,a={Key:u,IsResolved:!1},f="ImplicitContact"===e.personType.subclass,l="OrganizationUser"===e.personType.subclass,c="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,h="PublicDistributionList"===e.personType.subclass,p=Object(S.e)(r._webAbsoluteUrl,s);h&&(t=i.n.PublicDistributionList);c&&(t=i.n.unified);var d={department:e.department,email:s,image:f?void 0:p,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||s,name:e.displayName,providerName:l?"Provider":void 0,userId:u,rawData:a,rawPersonData:a,isExternal:!l,aadObjectId:e.id,fromDataSource:i.t.graph,detailedGroupInfo:t};if(l){d.entityType=i.e.regularUser;d.principalType=g.e.user;d.isResolved=!0}else if(c){d.entityType=i.e.group;d.principalType=g.e.securityGroup;d.isResolved=!1;d.userId=e.id}else{d.principalType=h?g.e.distributionList:g.e.none;d.entityType="Group"===e.personType.class?i.e.group:i.e.externalUser;d.isResolved=!1;d.providerName=void 0}d.userId&&o.push(d)}});return r._handleZeroSearchResult(o,e,n,i.t.graph)},function(t){l.end({resultType:L.t.Failure,extraData:{error:t}});if(Object(T.i)(t))switch(t.status){case 400:case 401:case 403:case 404:r._graphPeoplePickerHelper.disableGraphCallsForPicker();return r.sharePointSearch(e,n);default:return r.sharePointSearch(e,n)}else"Canceled"!==t.name&&r._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:r.sharePointSearch(e,n)})})};t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(r){if(!r)return n.sharePointSearch(e,t);var s=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(s=t.siteIBSegmentIDs);var a=t.useNew3Ssearch?["Mailbox","Directory","SecurityGroups"]:["Mailbox","Directory"],f={Authorization:"Bearer "+r},l="";if(o.e.isFeatureEnabled(A)){var c=t.useNew3Ssearch?["OrganizationUser","Guest","UnifiedGroup","MailUniversalSecurityGroup"]:["OrganizationUser","Guest","PublicDistributionList","UnifiedGroup"],h=u.e.isValidGuid(e),p={Or:c.map(function(e){return{Term:{PeopleSubtype:e}}})},d=s?{Or:s.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null,v=h?{Or:{Term:{ExternalDirectoryObjectId:e}}}:null,m=s||h?h?s?{And:[p,d,v]}:{And:[p,v]}:{And:[p,d]}:p;l=JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:a,Query:{QueryString:h?null:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:m}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}})}else l=o.e.isFeatureEnabled(A)&&!N.t.isActivated("0576d3d3-42b4-4c60-a920-0e10e34a19a0","05/13/2021","Pass SiteIBMode to 3S.")?JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:a,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:s?{Or:s.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}}):JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:a,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],Filter:s?{Or:s.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}});var y=new L.e({name:"PeoplePickerSubstrateSearch"});return n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:b.e+"/api/v1/suggestions",headers:f,needsAuthorization:!1,requestType:"POST",postData:l}).then(function(r){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var s=r.Groups[0]?r.Groups[0].Suggestions:[];if(0===s.length){y.end({resultType:L.t.Failure,extraData:{error:"substrate search return empty results"}});if(e)return n.sharePointSearch(e,t)}else y.end({resultType:L.t.Success});var o=[];s.forEach(function(e){if(!e.PeopleSubtype||!n._isIgnorablePeopleSubType(e.PeopleSubtype)){var r=e.EmailAddresses[0]||e.QueryText||"",s=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:r;t.useNew3Ssearch&&!s&&e.Id&&e.Id.indexOf("@")&&(s=e.Id.substring(0,e.Id.indexOf("@")));var u,a={Key:s,IsResolved:!1},f="ImplicitContact"===e.PeopleSubtype,l="OrganizationUser"===e.PeopleSubtype,c="LinkedIn"===e.PeopleSubtype,h="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,p="PublicDistributionList"===e.PeopleSubtype,d=Object(S.e)(n._webAbsoluteUrl,r);p&&(u=i.n.PublicDistributionList);h&&(u=i.n.unified);var v={department:e.Department,office:e.OfficeLocation,email:r,image:f?void 0:d,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||r,name:e.DisplayName,providerName:"Provider",userId:s,rawData:a,rawPersonData:a,isExternal:!l,detailedGroupInfo:u};if(l){v.entityType=i.e.regularUser;v.principalType=g.e.user;v.isResolved=!0}else if(h){v.entityType=i.e.group;v.principalType=g.e.securityGroup;v.isResolved=!1;v.providerName=void 0}else if(c)v.entityType=i.e.linkedinUser;else{v.principalType=p?g.e.distributionList:g.e.none;v.entityType="Group"===e.PeopleType?i.e.group:i.e.externalUser;v.isResolved=!1;v.providerName=void 0}v.userId&&o.push(v)}});return n._handleZeroSearchResult(o,e,t,i.t.substrate)},function(r){y.end({resultType:L.t.Failure,extraData:{error:r}});if(Object(T.i)(r))switch(r.status){case 400:case 401:case 403:case 404:n._substratePeoplePickerHelper.disableSubstrateCallsForPicker();return n.sharePointSearch(e,t);default:return n.sharePointSearch(e,t)}else if("Canceled"!==r.name){n._substratePeoplePickerHelper.disableSubstrateCallsForPicker();n.sharePointSearch(e,t)}return null})})};t.prototype._handleZeroSearchResult=function(e,t,n,r){if(!t)return e;if(!1!==n.resolveEmailIfNoResults&&0===e.length&&this._isValidEmail(t,!1)){var s={Key:t,IsResolved:!1};e.push({email:t,entityType:i.e.externalUser,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:t,name:t,userId:t,rawData:s,rawPersonData:s,isExternal:!0,fromDataSource:r})}return e};t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&C.isValidEmailSyntax(e,!1):!t};t._getPersonTypeFilter=function(e){var t="";e.principalType&g.e.user&&(t+="personType/subclass eq 'OrganizationUser' or personType/subclass eq 'Guest'");if(e.principalType&g.e.securityGroup){t&&(t+=" or ");t+="personType/subclass eq 'UnifiedGroup'"}if(e.principalType&g.e.distributionList&&null!==e.filterPublicDistributionList&&e.filterPublicDistributionList!==!N.t.isActivated("18c99317-6e4f-4859-85bf-b127709b6eff","01/28/2022","Include public distribuition list in filter by default")){t&&(t+=" or ");t+="personType/subclass eq 'PublicDistributionList'"}return t};t.prototype._isIgnorablePeopleSubType=function(e){if(!e)return!1;return["PersonalDistributionList","ImplicitGroup","Unknown"].some(function(t){return t===e})};t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var r=e.EntityData,s={name:e.DisplayText,email:r.Email,userId:e.Key,job:r.Title,department:r.Department,phone:r.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};if(s.multipleMatches.length>0){s.multipleMatches=n._transformData(s.multipleMatches,t);t&&(s.multipleMatches=s.multipleMatches.filter(function(e){return e.entityType!==i.e.externalUser}))}var o=s.email;s.isResolved&&(s.image=o?Object(S.e)(n._webAbsoluteUrl,o):null);var u=r.PrincipalType||e.EntityType;switch(u){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":s.entityType=i.e.externalUser;s.principalType=g.e.user;s.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":case"SecurityGroup":if(!N.t.isActivated("5bcee89c-f8f5-4973-82d2-ab06c37b03e0","1/25/2025","Fix bug: SharePointSearch result principleType of SecurityGroup was treated as user type")||"SecurityGroup"!==u){s.entityType=i.e.group;s.principalType="SharePointGroup"===u?g.e.sharePointGroup:g.e.securityGroup;s.detailedGroupInfo="SharePointGroup"===u?i.n.SPGroup:i.n.securityGroup;break}default:s.entityType=i.e.regularUser;s.principalType=g.e.user}return s})};return t})(m.t);function D(e){return!!e.webAbsoluteUrl}},function(e,t,n){"use strict";n.d(t,"t",function(){return p});n.d(t,"e",function(){return d});var r,i,s,o,u,a,f,l=n(68),c=(n(82),n(112)),h=(function(){function e(e){this._features=new Map;if(!e)throw new Error("Cannot create SPFeatureInfo object, incoming data is undefined.");for(var t in e)if(void 0!==t){var n=e[t];this._features.set(t,{version:n.Version,enabled:n.Enabled})}}e.prototype._serialize=function(){var e={};this._features.forEach(function(t,n){e[n]={Version:t.version,Enabled:t.enabled}});return e};e.prototype.get=function(e){if(!e||e&&0===e.length)throw new Error("Cannot get feature, featureName input is empty or undefined");return this._features.get(e)};return e})();n(189),n(27);(function(e){e[e.HEADER=0]="HEADER";e[e.NAV=1]="NAV";e[e.FOOTER=2]="FOOTER";e[e.SEARCHBOX=3]="SEARCHBOX"})(r||(r={}));(function(e){e[e.LEFT=0]="LEFT";e[e.HORIZONTAL=1]="HORIZONTAL"})(i||(i={}));(function(e){e[e.FULLBLEED=0]="FULLBLEED";e[e.WITHLEFTNAV=1]="WITHLEFTNAV"})(s||(s={}));(function(e){e[e.none=0]="none";e[e.standard=1]="standard";e[e.compact=2]="compact";e[e.minimal=3]="minimal";e[e.extended=4]="extended"})(o||(o={}));(function(e){e[e.left=0]="left";e[e.middle=1]="middle";e[e.right=2]="right"})(u||(u={}));(function(e){e[e.SIMPLE=0]="SIMPLE";e[e.EXTENDED=1]="EXTENDED";e[e.STACKED=2]="STACKED"})(a||(a={}));(function(e){e[e.Strong=0]="Strong";e[e.Neutral=1]="Neutral";e[e.Soft=2]="Soft";e[e.None=3]="None"})(f||(f={}));n(48);function p(e,t,n){var r=0;return new l.t(function(i,s){var o=setInterval(function(){if(!(r*t<=n)){clearInterval(o);throw"Timed out waiting for checker "+e}r++;if(e()){clearInterval(o);i()}},t)})}function d(e){if(e.featureInfo){var t=new h(e.featureInfo);if(t){var n=t.get("SitePagePublishing");return!!n&&n.enabled}return!1}return Number(e.webTemplate)===c.t.sitePagePublishing}},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(68),i=n(53),s=n(45),o=n(25),u=(function(){function e(){}e.clearThemeCache=function(){var t=e.getThemeDataStore();t.remove("Data");t.remove("CacheToken");t.remove("CacheVersion")};e.getCachedTheme=function(t){var n,r=e.getThemeDataStore();try{t===r.getValue("CacheToken")&&"1.7"===r.getValue("CacheVersion")&&(n=r.getValue("Data"))}catch(e){}return n};e.updateThemeCache=function(t,n){var r=e.getThemeDataStore();r.setValue("Data",t);r.setValue("CacheToken",n||t.cacheToken);r.setValue("CacheVersion","1.7")};e.getThemeDataStore=function(){return new s.e("odTheme",o.e.local)};return e})(),a=n(6),f=(function(){function e(e){this._loadData=e}e.getBackgroundUrl=function(t){return t?e._makeCssUrl(t.backgroundImageUri):"none"};e._makeCssUrl=function(t){var n="none";t&&(n='url("'+e._escapeQuotesAndParentheses(t)+'")');return n};e._escapeQuotesAndParentheses=function(e){var t={"'":"%27",'"':"%22","(":"%28",")":"%29"},n=null;null!=e&&(n=e.replace(/(['"\(\)])/gm,function(e,n){return t[n]}));return n};e.prototype.loadThemeTokenMap=function(t,n){return this.loadThemeData(t,n).then(function(t){var n;if(t&&t.palette){n={};var r=t.palette;for(var s in r){var o=r[s];n[s]=o?i.e.toHtmlString(o):null}n.backgroundImageUri=e._makeCssUrl(t.backgroundImageUri)}return n},function(e){return null})};e.prototype.loadThemeData=function(e,t){if(!t&&this._dataPromise)return this._dataPromise;var n=this,i=null,s=a.t.Failure;this._dataPromise=a.e.instrumentPromise({name:"ThemeProvider.LoadData"},function(){return new r.t(function(o,f){var l=null;t||(l=u.getCachedTheme(e));l?o(l):n._loadData(t).done(function(t){if(t){t.cacheToken&&u.updateThemeCache(t,e);o(t)}else{i="NoData";f&&f("No model returned")}},function(e){if(r.t.isCanceled(e)){i="Canceled";s=a.t.ExpectedFailure}else i="ServerLoadFailure";f&&f(e)})})},null,function(e){if(r.t.isCanceled(e)){s=a.t.ExpectedFailure;i="Canceled"}var t=e;if(e){var n={name:e.name||void 0,message:e.message&&e.message.value||e.message||void 0,correlationId:e.correlationId||void 0};t=JSON.stringify(n)}return{resultType:s,resultCode:i||"Other",error:t}});return this._dataPromise};return e})(),l=n(112),c=n(171),h=(function(){function e(e){this._pageContext=e.pageContext?e.pageContext:window._spPageContextInfo;this._getThemeDataSource=e.getThemeDataSource;this._themeProvider=new f(this._loadTheme.bind(this))}e.prototype.loadThemeSlotsMap=function(e){var t=this._getThemeCacheToken();return t?this._themeProvider.loadThemeTokenMap(t,e):r.t.resolve()};e.prototype.loadFullFormattedThemeData=function(e){var t=this;return this.loadFullThemeData(e).then(function(e){if(e){var n={},r=e.palette;for(var s in r){var o=r[s];o&&(n[s]=i.e.toHtmlString(o))}e.backgroundImageUri&&(n.backgroundImageUri=f.getBackgroundUrl(e));var u={palette:n,isInverted:e.isInverted};return u=Object(c.e)(u,t._pageContext)}})};e.prototype.loadFullThemeData=function(e){var t=this._getThemeCacheToken();if(t)return this._themeProvider.loadThemeData(t,e);return r.t.resolve(void 0)};e.prototype._getThemeCacheToken=function(){var e,t=this._pageContext;if(t){var n=Number(t.webTemplate),r=n===l.e.teamSite||n===l.e.group?t.groupColor:void 0,i=r?r+";web#"+t.webTemplate:null;e=t.themedCssFolderUrl||i||null}return e};e.prototype._loadTheme=function(e){if(!!this._getThemeCacheToken()){this._themeDataSource||(this._themeDataSource=this._getThemeDataSource());return this._themeDataSource.then(function(t){return t?t.loadTheme(e):r.t.resolve()})}return r.t.resolve()};return e})()},,function(e,t,n){"use strict";n(250);var r,i=n(61),s=n(4),o=Object(i.e)({eventName:"PageInit,",shortEventName:"PageInit"},{screenWidth:s.e.Number,screenHeight:s.e.Number,availableScreenWidth:s.e.Number,availableScreenHeight:s.e.Number,renderWidth:s.e.Number,renderHeight:s.e.Number,browserWidth:s.e.Number,browserHeight:s.e.Number,devicePixelRatio:s.e.Number,referrer:s.e.String}),u=(function(){function e(){}e.init=function(){r||(r=o.logData({screenWidth:window.screen.width,screenHeight:window.screen.availHeight,availableScreenWidth:window.screen.availWidth,availableScreenHeight:window.screen.availHeight,renderWidth:window.innerWidth,renderHeight:window.innerHeight,browserWidth:window.outerWidth,browserHeight:window.outerHeight,devicePixelRatio:window.devicePixelRatio?window.devicePixelRatio:0}));return r};return e})();t.e=u},function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r={};n.r(r);n.d(r,"fileNotFound",function(){return o});n.d(r,"invalidView",function(){return u});n.d(r,"listNotFound",function(){return a});n.d(r,"docAlreadyExists",function(){return f});n.d(r,"queryThrottled",function(){return l});n.d(r,"newExperieceRenderingNotSupported",function(){return c});n.d(r,"onePageNavigationViewMismatch",function(){return h});n.d(r,"onePageNavigationError",function(){return p});n.d(r,"offline",function(){return d});var i,s,o=-2147024894,u=-2147024809,a=-1,f=-2130575257,l=-2147024860,c=-2,h=-3,p=-4,d=-5;(function(e){e[e.icon=16]="icon";e[e.iconMin=16]="iconMin";e[e.bigIcon=48]="bigIcon";e[e.bigIconMin=48]="bigIconMin";e[e.regularMin=90]="regularMin";e[e.regular=130]="regular";e[e.nameMin=220]="nameMin";e[e.nameODC=440]="nameODC";e[e.nameODB=280]="nameODB";e[e.originalLocation=300]="originalLocation";e[e.custom=900]="custom";e[e.sharedWith=150]="sharedWith";e[e.note=250]="note";e[e.dateModifiedMl=150]="dateModifiedMl";e[e.dotDotDot=32]="dotDotDot";e[e.ratingsMin=110]="ratingsMin"})(i||(i={}));(function(e){e[e.none=0]="none";e[e.icon=1]="icon";e[e.name=2]="name";e[e.title=3]="title";e[e.calloutInvoker=4]="calloutInvoker";e[e.shareHeroCommand=5]="shareHeroCommand";e[e.modified=6]="modified";e[e.url=7]="url"})(s||(s={}));var v,m={none:0,notify:1,block:2,notifyAndBlock:3,blockSharing:4};(function(e){e[e.Auto=0]="Auto";e[e.Pinned=1]="Pinned";e[e.Removed=2]="Removed"})(v||(v={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PeoplePickerErrorContainer{display:flex;padding:8px 32px 8px 12px}.od-Share-PeoplePickerErrorContainer .od-Share-PeoplePickerErrorDiv{padding:0 8px;font-size:.75rem;color:#323130}.od-Simplified-Share-PeoplePickerErrorContainer{display:flex;flex-direction:row;align-items:center}.od-Simplified-Share-PeoplePickerErrorIcon{padding-right:5px;font-size:.625rem}.od-Simplified-Share-PeoplePickerErrorText{font-size:.75rem}.od-Simplified-Share-primary{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Simplified-Share-warning{color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}.od-Simplified-Share-error{color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}"}]);var s=n(392),o=n(31);function u(e){return 1===o.s()?r.createElement("div",{className:"od-Simplified-Share-PeoplePickerErrorContainer od-Simplified-Share-".concat(e.textColorType)},r.createElement("div",null,r.createElement(s.e,{className:e.className,iconName:e.iconName})),r.createElement("div",{className:"od-Simplified-Share-PeoplePickerErrorText od-Simplified-Share-".concat(e.textColorType)},e.error)):r.createElement("div",{className:"od-Share-PeoplePickerErrorContainer",style:{backgroundColor:e.backgroundColor}},r.createElement(s.e,{iconName:e.iconName,className:e.className}),r.createElement("div",{className:"od-Share-PeoplePickerErrorDiv"},e.error))}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.uninitialized=0]="uninitialized";e[e.direct=1]="direct";e[e.organizationView=2]="organizationView";e[e.organizationEdit=3]="organizationEdit";e[e.anonymousView=4]="anonymousView";e[e.anonymousEdit=5]="anonymousEdit";e[e.flexible=6]="flexible";e[e.requestAccess=7]="requestAccess"})(r||(r={}))},,,function(e,t,n){"use strict";n.r(t);n.d(t,"GraftOperationType",function(){return r});n.d(t,"remove",function(){return s});n.d(t,"optional",function(){return o});n.d(t,"backup",function(){return u});n.d(t,"replace",function(){return a});n.d(t,"default",function(){return f});var r,i=n(0);(function(e){e[e.none=0]="none";e[e.replace=1]="replace";e[e.optional=2]="optional";e[e.remove=3]="remove";e[e.backup=4]="backup"})(r||(r={}));function s(){return{graftOperationType:r.remove}}function o(e){return{graftOperationType:r.optional,value:e}}function u(e){return{graftOperationType:r.backup,value:e}}function a(e){return{graftOperationType:r.replace,value:e}}function f(e,t){if(!l(e))throw new Error("Value for 'base' passed to 'graft' is not an object.");if(!l(t))throw new Error("Value for 'extension' passed to 'graft' is not an object");if(t===e)return e;for(var n=0,s=Object.keys(t);n<s.length;n++){var o=s[n],u=t[o],a=e[o];if(u!==a){var g=u;if(p(g))if(g.graftOperationType===r.replace){a=void 0;u=y=g.value}else if(d(g)){var y=g.value;if(void 0!==e[o])continue;u=y}else{if(!m(g)){if(v(g)){delete e[o];continue}throw new Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.")}if(void 0===(y=g.value))continue;u=y}var b=void 0;if(c(u))b=new Date(u.getTime());else if(h(u)){var w=a;h(w)||(w=[]);w.splice.apply(w,Object(i.o)([0,w.length],u,!1));b=w}else if(l(u)){var E=a;l(E)||(E={});f(E,u);b=E}else b=u;e[o]=b}}return e}function l(e){return"object"==typeof e&&!!e}function c(e){return e instanceof Date}function h(e){return Array.isArray(e)}function p(e){return l(e)&&!!e.graftOperationType}function d(e){return e.graftOperationType===r.backup}function v(e){return e.graftOperationType===r.remove}function m(e){return e.graftOperationType===r.optional}},function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"n",function(){return u});n.d(t,"t",function(){return f});n.d(t,"r",function(){return l});var r=n(0),i=n(49),s=n(147),o=(function(e){Object(r.r)(t,e);function t(t){void 0===t&&(t={message:"Canceled"});var n=e.call(this,Object(r.e)({code:t.code||"Canceled",isExpected:!0},t))||this;n.name="Canceled";return n}return t})(i.e);function u(e){if(e instanceof o)return!0;if(e&&"object"==typeof e){if("Canceled"===e.code)return!0;if("Canceled"===e.name)return!0}return!1}var a=function(e){var t,n=e.catch(function(e){t=e;return Promise.reject(e)});this.subscribe=function(e){var t=e;n.then(function(){t=void 0},function(e){if(t){var n=t;t=void 0;n(e)}});return function(){t=void 0}};this.isCanceled=function(){return!!t};this.throwIfCanceled=function(){if(t)throw new o(t)}},f=function(){var e=new s.e,t=e.reject,n=e.resolve,r=e.promise;this.cancel=function(e){return t(e||new o)};this.dispose=function(){return n()};this.token=new a(r)};function l(e,t){return Object(r.t)(this,void 0,void 0,function(){var n,i,o=this;return Object(r.i)(this,function(u){switch(u.label){case 0:return t?[3,2]:[4,e];case 1:return[2,u.sent()];case 2:n=new s.e;i=t.subscribe(function(e){n.reject(e)});Object(r.t)(o,void 0,void 0,function(){var t,s,o;return Object(r.i)(this,function(r){switch(r.label){case 0:r.trys.push([0,2,3,4]);s=(t=n).resolve;return[4,e];case 1:s.apply(t,[r.sent()]);return[3,4];case 2:o=r.sent();n.reject(o);return[3,4];case 3:i();return[7];case 4:return[2]}})});return[4,n.promise];case 3:return[2,u.sent()]}})})}},function(e,t,n){"use strict";n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});n.d(t,"t",function(){return a});n.d(t,"e",function(){return f});var r=n(190),i=n(32),s=n(9);function o(e){var t=e.lastIndexOf("/");return t>=0?e.substring(t+1):e}function u(e){return decodeURI(e)}function a(e){var t;try{t=decodeURI(e)}catch(n){t=e}if(t===e)e=Object(r.e)(e,!0);else{e=e.replace("#","%23");s.t.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","05/19/2021","encode url with %number in the name")||i.e.isFeatureEnabled({ECS:83959})||!e.indexOf("%25")||(e=Object(r.e)(e,!0))}return e}function f(e){e&&e.indexOf("?")<0&&(e=(e=encodeURI(e)).replace(/#/g,"%23"));return e}},,,function(e,t,n){"use strict";var r=n(67),i=n(32);r.e.addFeatureEnabler(function(e){return i.e.isFeatureEnabled(e)})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(62),i=(function(){function e(e,t){if(e){this.root=e.root;this.parent=e.current}else this.root=this.parent=r.Empty;this.current=t||r.generate()}e._getCorrelationVector=function(){var t;"undefined"!=typeof window?t=window.rootVector:"undefined"!=typeof self&&(t=self.rootVector);return t||new e};e.prototype.toString=function(){return"".concat(this.root,"#").concat(this.parent,"#").concat(this.current)};e.RootVector=e._getCorrelationVector();return e})()},function(e,t,n){"use strict";var r=n(66),i=n(120),s="formFactorChange",o="hamburgerVisibilityChange",u="showCommandLabelsChange",a={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},f={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},l=(function(){function e(e,t){this._scope=new i.e;this._events=new(this._scope.attached(r.t))(this);this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));var n=t.breakpoints;this._breakpoints="function"==typeof n?n:function(){return n};this._windowWidth=0;this._windowHeight=0;this._onContainerResize()}e.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};e.determineWindowSize=function(e,t){void 0===t&&(t=f);if(0===e)return"Medium";for(var n in f)if(e<t[n])return n};e.determineCssClass=function(e){return a[e]};e.getScrollbarWidth=function(){var e=document.createElement("div"),t=document.createElement("div"),n=e.style;n.visibility="hidden";n.width="100px";n.msOverflowStyle="scrollbar";n.overflow="scroll";t.style.width="100%";document.body.appendChild(e);e.appendChild(t);var r=e.offsetWidth,i=t.offsetWidth;e.parentNode.removeChild(e);var s=r-i;this.getScrollbarWidth=function(){return s};return s};Object.defineProperty(e.prototype,"windowWidth",{get:function(){return this._windowWidth},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"windowHeight",{get:function(){return this._windowHeight},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"formFactorSize",{get:function(){return this._formFactorSize},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"isHamburgerVisible",{get:function(){return this._isHamburgerVisible},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"showLabels",{get:function(){return this._showLabels},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"cssClass",{get:function(){return this._cssClass},enumerable:!1,configurable:!0});e.prototype.dispose=function(){this._scope.dispose()};e.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]};e.prototype._afterContainerResize=function(){};e.prototype._onContainerResize=function(){var t=document.body,n=document.documentElement,r=this._windowHeight=n.clientWidth||t.clientWidth;this._windowWidth=n.clientHeight||t.clientHeight;var i=this._formFactorSize,a=this._formFactorSize=e.determineWindowSize(r,this._breakpoints());this._cssClass=e.determineCssClass(a);var l=this._isHamburgerVisible;this._isHamburgerVisible=r<f.Large;var c=this._showLabels;this._showLabels=this.compareSize(a,"Medium")>0;i&&a!==i&&this._events.raise(s);"boolean"==typeof l&&l!==this._isHamburgerVisible&&this._events.raise(o);"boolean"==typeof c&&c!==this._showLabels&&this._events.raise(u);this._afterContainerResize()};e.DEFAULT_BREAKPOINTS=f;e.MAC_SCROLL_BAR_WIDTH=8;return e})();t.e=l},,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(61),i=n(4),s=Object(r.e)({eventName:"RequireJSError,",shortEventName:"RequireJSError",critical:!0},{message:i.e.String,requireModules:i.e.Array,requireType:i.e.String,stack:i.e.String})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=!n(9).t.isActivated("6d2a844a-9c33-46b3-80c2-9e47560a97b7","4/26/2022")},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(0),i=n(35),s=n(165);function o(e,t){var n=t.Session,o=t.Version,u=t.OSName,a=t.OSVersion,f=t.Market,l=t.UserId,c=t.Manifest,h=Object(r.s)(t,["Session","Version","OSName","OSVersion","Market","UserId","Manifest"]),p=e.getSemanticContext();n&&e.setContext("AppInfo.Session",n);c&&e.setContext("AppInfo.Manifest",c);o&&p.setAppVersion(o);p.setUserLanguage(f||"");if(l){var d=(function(e){return e&&e.replace(/(membership\|urn(%3a|:)spo(%3a|:)guest#)([^@]+)(@[^@]+)$/i,function(e,t,n,r,i,o){return"".concat(t).concat(Object(s.e)(i)).concat(o)})})(l);p.setUserId(d)}u&&p.setDeviceOsName(u);a&&p.setDeviceOsVersion(a);for(var v in h)if(Object.prototype.hasOwnProperty.call(h,v)){var m=h[v];if(null==m)continue;var g=Object(i.e)(v);e.setContext(g,h[v])}}},function(e,t,n){"use strict";t.e={Active:0,Restricted:1,RestrictedICN:2,ConditionalAccessBlocked:3,ConditionalAccessViewOnly:4}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return c});var r,i=n(0),s=(n(250),n(300),n(301),n(305),n(302),n(239)),o=n(129),u=n(48),a=n(60);s.e.init();function f(e){var t=window.PageContext,n=t.env||"devbox",r=window.Flight,i=e.oAuthToken&&(function(e){if(e){var t=e.split(".");if(3===t.length)try{return JSON.parse(atob(t[1].replace(/-/g,"+").replace(/_/g,"/")))}catch(e){return}}})(e.oAuthToken),s=i&&i.puid||r.session,o=i&&i.puid||t.userName,f=i&&i.tid||t.siteSubscriptionId;return{isAuthenticated:!!o,market:t.mkt,session:u.e.generate(),collectorUrl:t.ariaCollectorUrl,version:r.version,manifest:r.manifest||r.name,userId:s,accountType:o?a.e.Business:a.e.BusinessAnonymous,siteSubscriptionId:f,farmLabel:t.farmLabel,environment:n,workload:e.workload,disableCookies:!t.userName,context:e.context,cloudType:t.cloudType}}function l(e,t){void 0===t&&(t={});(function(e){var t="",n=window.PageContext.env||"devbox",i=window.Flight;if(i){i.ramps&&!i.Ramps&&(i.Ramps=i.ramps);if(i.usingRedirectCookie)t=e.tokens.ppe;else switch(n.toLowerCase()){case"edog":case"dogfood":case"prodbubble":t=e.tokens.ppe;break;case"prod":case"dprod":t=e.tokens.prod}}else t=e.tokens.prod;r=f(e);t&&o.e.Init(t,r)})({oAuthToken:e,workload:"ODB",tokens:{ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044"},context:t.context})}function c(e,t){void 0===t&&(t={});(function(e){if(r){var t=f(e);o.e.UpdateContext(Object(i.e)(Object(i.e)(Object(i.e)({},r),t),{context:Object(i.e)(Object(i.e)({},r.context),e.context)}))}})({oAuthToken:e,workload:"ODB",tokens:{ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044"},context:t.context})}},function(e,t,n){"use strict";n.d(t,"e",function(){return D});var r,i=n(0),s=n(466),o=n(108),u=n(110),a=n(148),f=n(464);(function(e){e[e.unknown=0]="unknown";e[e.prefetch=1]="prefetch";e[e.hostapp=2]="hostapp";e[e.api=3]="api"})(r||(r={}));var l=n(463),c=n(202),h=n(465),p=n(5),d=n(242),v=n(55),m=n(370),g=n(467),y=n(203),b=n(82),w=n(106),E=n(198),S=n(240),x=n(112),T=n(127),N=n(9),C=n(236),k=n(104),L=n(83),A=n(32),O=!N.t.isActivated("48d0bf6b-2e41-42a8-a3a3-e8d2ef405dbb","7/14/2022","better error handling"),M=N.t.isActivated("3e85cd31-2807-44c1-96bf-35f08619ec11","1/31/2023","Fix for not appending navId to SPL link"),_=N.t.isActivated("62a4337e-d21e-407b-b2ef-2163777d20b8","12/19/2022","Link unfurl using displayName KS")||A.e.isFeatureEnabled({ECS:1059927}),D=(function(e){Object(i.r)(t,e);function t(t,n){void 0===n&&(n={pageContext:t.pageContext});var r=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;r._getParentListId=t.getParentListId;r._itemUrlHelper=t.itemUrlHelper||new o.e({},{pageContext:t.pageContext});r._apiUrlHelper=t.apiUrlHelper||new u.e({},{pageContext:t.pageContext,itemUrlHelper:r._itemUrlHelper});r._sharingContextInformation=t.sharingContextInformation||void 0;r._sharingDataSourceHelper=new E.e({itemUrlHelper:r._itemUrlHelper,sharingContextInformation:r._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i=Object(b.e)(r._pageContext);r._shareUrl=i+"/_api/SP.Web.ShareObject";return r}t.parsePeople=function(e){return e.map(function(e){var n={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:n}})};t.parseSharingRole=function(e){switch(e){case 0:return f.e.None;case 1:return f.e.View;case 2:return f.e.Edit;case 6:return f.e.Review;default:return f.e.View}};t.prototype.getSharingInformation=function(e,t,n,i,s,o){var u,a=this,f=(i=i||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),l="pickerSettings";t&&(l+=",permissionsInformation");n&&(l+=",sharingLinkTemplates");s&&(l+=",addressBarLinkSettings");u=f.oDataParameter("$Expand",l).toString();return this.getData(function(){return u},function(t){var n=JSON.parse(t),i=a._parseGetSharingInformationResponse(n,e);i.getSharingInformationSources=r.api;return i},"GetSharingInformation",null,"POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&F(this._sharingContextInformation.listId.slice(1,-1))?{"X-SP-REQUESTRESOURCES":"WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))}:null,null,null,!0,void 0,void 0,this._getExtraData(),o)};t.prototype.emailWithoutPermissioning=function(e,n,r,i){var s=this,o=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ForwardObjectLink").toString();return this.getData(function(){return o},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t.parsePeople(i);o.invitedUsers=t.parsePeople(s);o.itemId=n&&n.id;s.length>0&&(o.invitationLink=s[0].InvitationLink);o.invalidEmails=[];if(r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var u=0,a=r.UsersWithInvalidEmails.results;u<a.length;u++){var f=a[u];o.invalidEmails.push(f.User)}return o},"ForwardObjectLink",function(){for(var t=[],n=0,o=e;n<o.length;n++){var u=o[n];t.push(u.rawPersonData)}var a={peoplePickerInput:JSON.stringify(t),emailBody:r,emailSubject:i,linkParameters:{}};s._sharingContextInformation&&s._sharingContextInformation.navId&&s._sharingContextInformation.optInSendNavIdInShareLink&&!M&&(a.linkParameters.nav=s._sharingContextInformation.navId);return JSON.stringify(a)})};t.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);if(t.d){return t.d.CheckPermissions.results}return null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})};t.prototype.share=function(e,n){var r,i=this,s=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(n.linkType===l.e.Organization||n.linkType===l.e.Edit||n.linkType===l.e.View)return this._shareLink(e,n);if(s){var o=n.items[0],u=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,o,this._getParentListId(o));r=u.segment("ShareObject").toString()}else r=this._shareUrl;return this.getData(function(){return r},function(e){var r=JSON.parse(e).d,i=[];Object(L.e)()&&window.sessionStorage.setItem("Share_Response",JSON.stringify(r));r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t.parsePeople(i);o.invitedUsers=t.parsePeople(s);o.itemId=n.items[0]&&n.items[0].id;s.length>0&&(o.invitationLink=s[0].InvitationLink);o.invalidEmails=[];if(r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var u=0,a=r.UsersWithInvalidEmails.results;u<a.length;u++){var f=a[u];o.invalidEmails.push(f.User)}return o},"Share",function(){for(var t=[],r=0;r<e.length;r++){var o=e[r];t.push(o.rawPersonData)}n.roleValue===f.e.Edit.toString()?n.roleValue=k.e:n.roleValue===f.e.View.toString()&&(n.roleValue=k.r);var u={peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};s||(u.url=i._sharingDataSourceHelper.getFileUrl(n.items[0]));Object(L.e)()&&window.sessionStorage.setItem("Share_Payload",JSON.stringify(u));return JSON.stringify(u)})};t.prototype.updatePermissions2=function(e,t,n){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case c.e.none:case c.e.view:case c.e.review:case c.e.edit:case c.e.owner:t=n;break;default:t=c.e.view}var r={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})};t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return s},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case c.e.none:t=0;break;case c.e.view:t=1;break;case c.e.review:t=6;break;case c.e.edit:t=2;break;default:t=1}var s={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:r,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(s)})};t.prototype.parseRawSharingInformation=function(e,t){return this._parseGetSharingInformationResponse(e,t)};t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})};t.prototype.shareLink=function(e){var t=this,n=e.settings,r=e.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(r)).segment("ShareLink").toString(),o={};if(this._sharingContextInformation){this._sharingContextInformation.listId&&F(this._sharingContextInformation.listId.slice(1,-1))&&(o["X-SP-REQUESTRESOURCES"]="WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1)));this._sharingContextInformation&&this._sharingContextInformation.enableFallbackShareLink&&(o.Prefer="DirectUrlWithShareToken")}return this.getData(function(){return i},function(e){var t=JSON.parse(e);if(t.d){Object(L.e)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(t.d));return(function(e){if(e.d){return P(e.d.ShareLink.sharingLinkInfo)}})(t)}if(t.error)return{error:h.t.generic,errorMessage:t.error.message}},"ShareLink",function(){var r=null;n.expiration&&(r=Object(s.e)(n.expiration.toString()));var i=null;if(e.recipients&&e.recipients.length>0){i=[];for(var o=0,u=e.recipients;o<u.length;o++){var a=u[o];a.rawPersonData&&i.push(a.rawPersonData)}}var f=null;if(n.inviteesToRemove&&n.inviteesToRemove.length>0){f=[];for(var l=0,c=n.inviteesToRemove;l<c.length;l++){var h=c[l];f.push({id:h.id,loginName:h.loginName,name:h.primaryText,isExternal:h.isExternal,principalType:h.type,email:h.email})}}var p={request:{createLink:!!n.createLink,settings:{allowAnonymousAccess:n.allowAnonymousAccess,trackLinkUsers:n.trackLinkUsers,linkKind:n.sharingLinkKind,expiration:r,role:n.role,restrictShareMembership:n.restrictShareMembership,updatePassword:n.updatePassword,password:n.password,shareId:n.shareId,description:n.description,scope:n.scope}}};t._sharingContextInformation&&t._sharingContextInformation.navId&&t._sharingContextInformation.optInSendNavIdInShareLink&&(p.request.settings.nav=t._sharingContextInformation.navId);f&&(p.request.settings.inviteesToRemove={results:f});if(i&&i.length>0){p.request.peoplePickerInput=JSON.stringify(i);var d=e.emailData,v=e.emailSubject;void 0!==d&&void 0===v&&(p.request.emailData={body:e.emailData,subject:""});void 0===d&&void 0!==v&&(p.request.emailData={body:"",subject:e.emailSubject});void 0!==d&&void 0!==v&&(p.request.emailData={body:e.emailData,subject:e.emailSubject})}var m=e.settings.shareId;if(m){p.request.settings.shareId=m;p.request.emailData={body:""}}var g=JSON.stringify(p);Object(L.e)()&&window.sessionStorage.setItem("ShareLink_Payload",g);return g},"POST",0!==Object.keys(o).length?o:null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(O)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:h.t.generic,debugErrorMessage:t}})};t.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})};t.prototype.shareLinkExpress=function(e,t,n){var r=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?P(t.d.ShareLinkExpress.sharingLinkInfo):t.error?{error:h.t.generic,errorMessage:t.error.message}:void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(O)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:h.t.generic,debugErrorMessage:t}})};t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if(Object(C.e)(this._pageContext))return p.e.sharePoint;switch(e){case x.t.teamSite:case x.t.group:case x.t.subgroup:case x.t.sitePagePublishing:return p.e.sharePoint;case x.t.mySite:return p.e.odb;default:return p.e.sharePoint}};t.prototype._shareLink=function(e,t){var n=this,r=t.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,r,this._getParentListId(r)).segment("ShareLink").toString();return this.getData(function(){return i},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var r=[],i=0,o=e;i<o.length;i++){var u=o[i];r.push(u.rawPersonData)}var a=null;t.expiration&&(a=Object(s.e)(t.expiration));var f={request:{peoplePickerInput:JSON.stringify(r),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:a}};return JSON.stringify(f)})};t.prototype._getSharingLinkKind=function(e,t){var n=d.e.direct;e===l.e.Edit?n=d.e.anonymousEdit:e===l.e.View?n=d.e.anonymousView:e===l.e.Organization&&(n=t===f.e.Edit.toString()?d.e.organizationEdit:d.e.organizationView);return n};t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:h.t.generic,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0,userPhotoCdnBaseUrl:void 0,permissionsInformation:void 0,sensitivityLabelInformation:void 0,displayName:void 0};var n=e.d,r=n.userPhotoCdnBaseUrl,s=n.permissionsInformation,o=!!s,u=!!n.sharingLinkTemplates,a=o,f=!!n.addressBarLinkSettings,l=o?this._parseSharingLinks(s.links.results,n.directUrl,r):[],c=u?this._parseSharingLinkTemplates(n.sharingLinkTemplates.templates.results,r):[],p=f?n.addressBarLinkSettings:null,g=[];if(o){var y=s.siteAdmins.results,b=s.principals.results,E=this._parseSharingPrincipals(y,void 0,r);E.forEach(function(e){return e.isSiteAdmin=!0});var x=this._parseSharingPrincipals(b,void 0,r);g=E.concat(x)}var T=this._getDefaultSharingLink(n.defaultLinkKind,n.defaultShareLinkScope,l,n.sharingAbilities),N=this._sharingContextInformation?this._sharingContextInformation.itemName:void 0;_||N||!n||(N=n.displayName);var C={name:N,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:n.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var k=t.properties,A=k.ItemChildCount?parseInt(k.ItemChildCount,10):0,O=k.FolderChildCount?parseInt(k.FolderChildCount,10):0,M=t.type===w.e.OneNote?0:A+O,D=this._isPolicyTipFlagSet(t.policyTip,S.e.blockSharing),P=t.name;_||P||!n.displayName||(P=n.displayName);C={name:P,childCount:M,hasDlpPolicy:D,extension:t.extension,appmap:t.appMap,itemType:t.type}}var H=n.canRequestAccessForGrantAccess||n.canAddInternalPrincipal||l.length>1,B={anonymousLinkExpirationRestrictionDays:0===n.anonymousLinkExpirationRestrictionDays?-1:n.anonymousLinkExpirationRestrictionDays,anyoneLinkTrackUsers:n.anyoneLinkTrackUsers,canAddExternalPrincipal:n.canAddExternalPrincipal,canAddInternalPrincipal:n.canAddInternalPrincipal,defaultShareLinkToExistingAccess:n.defaultShareLinkToExistingAccess,canManagePermissions:H,defaultSharingLink:T,fileExtension:n.fileExtension,sharedObjectType:n.sharedObjectType,hasInheritedLinks:!!a&&n.permissionsInformation.hasInheritedLinks,isShared:this._computeIsShared(l,g),item:C,sharingLinks:l,sharingPrincipals:g,peoplePickerSettings:n.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:n.blockPeoplePickerAndSharing,requiresAccessApproval:!n.canAddInternalPrincipal&&n.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:n.canRequestAccessForGrantAccess,userRole:n.currentRole,defaultShareLinkPermission:n.defaultShareLinkPermission,sharingAbilities:n.sharingAbilities,defaultLinkKind:n.defaultLinkKind,defaultShareLinkScope:n.defaultShareLinkScope,directLink:{allowsAnonymousAccess:!1,audience:v.e.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:d.e.direct,sharingScope:m.e.existing,url:n.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!n.permissionsInformation,sharingLinkTemplates:c,addressBarLinkSettings:p,webTemplateId:n.webTemplateId,itemUniqueId:n.itemUniqueId,customizedExternalSharingServiceUrl:n.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:n.siteIBSegmentIDs?n.siteIBSegmentIDs.results:null,siteIBMode:n.siteIBMode,enforceIBSegmentFiltering:!!n.enforceIBSegmentFiltering,enforceSPOSearch:!!n.enforceSPOSearch,outlookEndpointHostUrl:n.outlookEndpointHostUrl?n.outlookEndpointHostUrl:null,webUrl:n.webUrl?n.webUrl:null,isStubFile:!!n.isStubFile&&n.isStubFile,userPhotoCdnBaseUrl:n.userPhotoCdnBaseUrl,permissionsInformation:n.permissionsInformation,sensitivityLabelInformation:n.sensitivityLabelInformation,displayName:n.displayName};if(Object(L.e)()){var j=window.sessionStorage.getItem("Get_Sharing_Information");if(j&&Object.keys(j).length>0){var F=JSON.parse(j);return Object(i.e)(Object(i.e)({},B),F)}}return B};t.prototype._computeIsShared=function(e,t){for(var n=!1,r=0,i=e;r<i.length;r++){var s=i[r];s.isActive&&s.sharingLinkKind!==d.e.direct&&(n=!0)}n||(n=t.length>0);return n};t.prototype._parseSharingLinks=function(e,t,n){var r=this,i=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t,i=e.linkDetails;t=void 0!==i.Scope&&i.Scope!==m.e.uninitialized?B(i.LinkKind,i.Scope):H(i.LinkKind,i.AllowsAnonymousAccess,i.RestrictedShareMembership);return{allowsAnonymousAccess:i.AllowsAnonymousAccess,hasPassword:i.RequiresPassword,blockDownload:i.BlocksDownload,description:i.Description,audience:t,expiration:i.Expiration?new Date(i.Expiration):null,isActive:i.IsActive,isEdit:j(i.LinkKind)||i.IsEditLink,isReview:i.IsReviewLink,isManageList:i.IsManageListLink,principals:r._parseSharingPrincipals(e.linkMembers.results,i.LinkKind,n),invitees:r._parseLinkInvitees(i,n),shareId:i.ShareId,sharingLinkKind:i.LinkKind,sharingScope:i.Scope,url:i.Url,updatePassword:i.UpdatePassword,password:i.Password,passwordLastModifiedBy:r._parseSharingPrincipal(i.PasswordLastModifiedBy,n),isCreateOnlyLink:i.IsCreateOnlyLink,isAddressBarLink:i.IsAddressBarLink,isUnhealthy:i.IsUnhealthy,status:i.SharingLinkStatus,created:i.Created,trackLinkUsers:i.TrackLinkUsers}});(i=i.sort(function(e,t){return r._getLinkRanking(t)-r._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:v.e.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:d.e.direct,sharingScope:m.e.specificPeople,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null});return i};t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case v.e.anyone:t+=30;break;case v.e.organization:t+=20;break;case v.e.specificPeopleFlex:t+=10}e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1);return t};t.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case g.e.anyone:t+=30;break;case g.e.organization:t+=20;break;case g.e.specificPeople:t+=10}switch(e.role){case c.e.edit:t+=3;break;case c.e.review:t+=2;break;case c.e.view:t+=1}}return t};t.prototype._parseSharingLinkTemplates=function(e,t){var n=this,r=e.map(function(e){var r,i=e.linkDetails;if(null!==i){var s=void 0;s=void 0!==i.Scope&&i.Scope!==m.e.uninitialized?B(i.LinkKind,i.Scope):H(i.LinkKind,i.AllowsAnonymousAccess,i.RestrictedShareMembership);r={allowsAnonymousAccess:i.AllowsAnonymousAccess,hasPassword:i.RequiresPassword,blockDownload:i.BlocksDownload,audience:s,expiration:i.Expiration?new Date(i.Expiration):null,description:i.Description,isActive:i.IsActive,isEdit:j(i.LinkKind)||i.IsEditLink,isReview:i.IsReviewLink,principals:void 0,invitees:n._parseLinkInvitees(i,t),shareId:i.ShareId,sharingLinkKind:i.LinkKind,sharingScope:i.Scope,url:i.Url,updatePassword:i.UpdatePassword,password:i.Password,passwordLastModifiedBy:n._parseSharingPrincipal(i.PasswordLastModifiedBy,t)}}return{linkDetails:r,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}});return r=r.sort(function(e,t){return n._getSharingLinkTemplateRanking(t)-n._getSharingLinkTemplateRanking(e)})};t.prototype._parseLinkInvitees=function(e,t){var n=this,r=e.Invitations;if(!r)return[];for(var i=[],s=0,o=r.results;s<o.length;s++){var u=o[s];u&&u.invitee&&i.push(u.invitee)}return i.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:Object(T.e)(n._pageContext.webAbsoluteUrl,e.email,t)}})};t.prototype._parseSharingPrincipals=function(e,t,n){var r=this,i=e.map(function(e){var i=e.principal;i||(i=e);var s={id:i.id,isExternal:i.isExternal,loginName:i.loginName,primaryText:i.name,role:e.role,secondaryText:i.jobTitle,type:i.principalType,imageUrl:Object(T.e)(r._pageContext.webAbsoluteUrl,i.email,n),email:i.email};t&&(s.sharingLinkKind=t);return s});return E.e.getUniqueSharingPrincipals(i)};t.prototype._getExtraData=function(){var e;this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:y.e[this._sharingContextInformation.mode]});return e};t.prototype._parseSharingPrincipal=function(e,t){if(e){var n=e.principal;n||(n=e);return{id:n.id,isExternal:n.isExternal,loginName:n.loginName,primaryText:n.name,role:e.role,secondaryText:n.jobTitle,type:n.principalType,imageUrl:Object(T.e)(this._pageContext.webAbsoluteUrl,n.email,t),email:n.email}}return null};t.prototype._getDefaultSharingLink=function(e,t,n,r){r.peopleSharingLinkAbilities&&(r.peopleSharingLinkAbilities.canManageEditLink.enabled||r.peopleSharingLinkAbilities.canManageReadLink.enabled)&&e===d.e.direct&&(e=d.e.flexible);var i=e,s=t;if(r.anyoneLinkAbilities){i!==d.e.anonymousEdit||r.anyoneLinkAbilities.canManageEditLink.enabled||(i=d.e.anonymousView);i!==d.e.anonymousView||r.anyoneLinkAbilities.canManageReadLink.enabled||(i=d.e.organizationEdit);s!==m.e.anyone||r.anyoneLinkAbilities.canManageReadLink.enabled||r.anyoneLinkAbilities.canManageReadLink.enabled||(s=m.e.organization)}else{i!==d.e.anonymousEdit||r.anonymousLinkAbilities.canManageEditLink.enabled||(i=d.e.anonymousView);i!==d.e.anonymousView||r.anonymousLinkAbilities.canManageReadLink.enabled||(i=d.e.organizationEdit);s!==m.e.anyone||r.anonymousLinkAbilities.canManageReadLink.enabled||r.anonymousLinkAbilities.canManageReadLink.enabled||(s=m.e.organization)}if(r.organizationLinkAbilities){i!==d.e.organizationEdit||r.organizationLinkAbilities.canManageEditLink.enabled||(i=d.e.organizationView);i!==d.e.organizationView||r.organizationLinkAbilities.canManageReadLink.enabled||(i=d.e.direct);s!==m.e.organization||r.organizationLinkAbilities.canManageReadLink.enabled||r.organizationLinkAbilities.canManageEditLink.enabled||(s=m.e.specificPeople)}r.peopleSharingLinkAbilities&&(s!==m.e.specificPeople||r.peopleSharingLinkAbilities.canManageReadLink.enabled||r.peopleSharingLinkAbilities.canManageEditLink.enabled||(s=m.e.existing));var o=void 0;e===d.e.anonymousEdit||e===d.e.anonymousView?o=v.e.anyone:e===d.e.organizationEdit||e===d.e.organizationView?o=v.e.organization:e===d.e.direct?o=v.e.specificPeople:e===d.e.flexible&&(o=v.e.specificPeopleFlex);return{allowsAnonymousAccess:void 0,audience:o,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:i,sharingScope:s,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}};t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};return t})(a.t);function P(e){var t;t=void 0!==e.Scope&&e.Scope!==m.e.uninitialized?B(e.LinkKind,e.Scope):H(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);var n=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:t,expiration:n,description:e.Description,isActive:e.IsActive,isEdit:j(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,hasPassword:e.RequiresPassword,shareId:e.ShareId,sharingLinkKind:e.LinkKind,sharingScope:e.Scope,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created}}}function H(e,t,n){return e===d.e.anonymousEdit||e===d.e.anonymousView?v.e.anyone:e===d.e.organizationEdit||e===d.e.organizationView?v.e.organization:e===d.e.direct?v.e.specificPeople:e===d.e.flexible?t?v.e.anyone:!1===n?v.e.organization:v.e.specificPeopleFlex:void 0}function B(e,t){return e===d.e.anonymousEdit||e===d.e.anonymousView?v.e.anyone:e===d.e.organizationEdit||e===d.e.organizationView?v.e.organization:e===d.e.direct?v.e.specificPeople:e===d.e.flexible?t==m.e.anyone?v.e.anyone:t===m.e.organization?v.e.organization:v.e.specificPeopleFlex:void 0}function j(e){return e===d.e.anonymousEdit||e===d.e.organizationEdit||e!==d.e.anonymousView&&e!==d.e.organizationView&&null}function F(e){"{"===e[0]&&(e=e.substring(1,e.length-1));return/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(e)&&"00000000-0000-0000-0000-000000000000"!=e}},,,function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"e",function(){return h});var r,i="ms-word",s="onenote|UsePlain",o="ms-powerpoint",u="ms-excel",a="ms-visio",f="ms-publisher",l="ms-project",c=i,h={accdb:"ms-access",csv:u,doc:i,docm:i,docx:i,dot:i,dotm:i,dotx:i,odp:o,ods:u,odt:i,one:s,onepkg:s,onetoc2:s,mpp:l,notebook:s,pot:o,potm:o,potx:o,ppa:o,ppam:o,pps:o,ppsm:o,ppsx:o,ppt:o,pptm:o,pptx:o,pub:f,vdw:a,vsd:a,vsdm:a,vsdx:a,vsl:a,vss:a,vssm:a,vssx:a,vst:a,vstm:a,vstx:a,xla:u,xlam:u,xll:u,xls:u,xlsb:u,xlsm:u,xlsx:u,xlt:u,xltm:u,xltx:u};(r={})["ms-access"]="Access",r[i]="Word",r[s]="OneNote",r[o]="PowerPoint",r[u]="Excel",r[a]="Visio",r[f]="Publisher",r[l]="Project"},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(0);function i(e,t){return Object(r.e)(e,t)}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n("react-lib"),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.separator{border-top:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:"}"}]);function s(){return r.createElement("div",{className:"separator"})}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r,i=n(145),s=((r={})[i.e.anyone]="Globe",r[i.e.onlyYou]="Lock",r[i.e.specificPeople]="PeopleAdd",r[i.e.workGroup]="Work",r[i.e.existing]="SecurityGroup",r[i.e.chat]="Chat",r[i.e.mail]="Mail",r)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return O});var r={};n.r(r);n.d(r,"localStorage",function(){return a});n.d(r,"indexedDB",function(){return f});n.d(r,"none",function(){return l});var i,s=n(0),o=n(68),u=n(9),a=0,f=1,l=2,c=r,h=n(157),p=n(62),d="undefined"==typeof window?self:window,v=n(6);(function(e){e.success="success";e.error="error"})(i||(i={}));var m=(new h.e).isFirefox,g="indexedDB is not supported",y=(function(){function e(t){if(!("indexedDB"in d)||!d.indexedDB)throw new Error(g);this._logger=t;e._openDBPromise||(e._openDBPromise=this._openIndexedDB().then(function(t){e._db=t;return t}))}e.prototype.freeSpace=function(t,n){return Object(s.t)(this,void 0,void 0,function(){var r,i,o,u=this;return Object(s.i)(this,function(s){switch(s.label){case 0:i=e;return(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=s.sent();s.label=2;case 2:r=i._db=o;return[2,new Promise(function(e,i){var s=r.transaction(["ODSP_DB_TABLE"],"readwrite").objectStore("ODSP_DB_TABLE").index("app_lastRead").openCursor();s.onsuccess=function(r){var i=s.result;if(i){if(i.value.app===t&&n>0){n-=i.value.size;i.delete()}n>0?i.continue():e()}else e()};s.onerror=function(e){u._errorHandling(e,i)}})]}})})};e.prototype.read=function(e){return Object(s.t)(this,void 0,void 0,function(){return Object(s.i)(this,function(t){return[2,this._readInternal("ODSP_DB_TABLE",function(t){return t.get(e)})]})})};e.prototype.rangeQuery=function(t){return Object(s.t)(this,void 0,void 0,function(){var n,r,i,o,u,a,f,l,c,h,p,d,v,m=this;return Object(s.i)(this,function(s){switch(s.label){case 0:n={};i=e;return(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=s.sent();s.label=2;case 2:r=i._db=o;u=r.transaction(["ODSP_DB_TABLE"],"readonly");a=u.objectStore("ODSP_DB_TABLE");f=[];l=t.index,c=t.range,h=t.direction,p=t.count;d=a.index(l);(v=d.openKeyCursor(c,h)).onerror=function(e){m._errorHandling(e,n.reject)};v.onsuccess=function(e){var t=e.target.result;if(t){f.push(t.primaryKey);f.length>=p?n.resolve(f):t.continue()}else n.resolve(f)};return[2,new Promise(function(e,t){n.resolve=e;n.reject=t})]}})})};e.prototype.write=function(e){return Object(s.t)(this,void 0,void 0,function(){var t;return Object(s.i)(this,function(n){t=e.key;return void 0!==e.data?[2,this._writeInternal({tableName:"ODSP_DB_TABLE",key:t,row:Object(s.e)(Object(s.e)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:"ODSP_DB_TABLE",key:t,row:void 0})]})})};e.prototype.statistics=function(){return Object(s.t)(this,void 0,void 0,function(){var e,t;return Object(s.i)(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent();this._dbMetaData=e;n.label=2;case 2:return[4,this._iterate("ODSP_DB_TABLE",function(e){return e.size})];case 3:t=n.sent();return[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})};e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,r){if(e._db)n(e._db);else{var i=m?indexedDB.open("ODSP_DB",{version:4,storage:"temporary"}):indexedDB.open("ODSP_DB",4);i.onerror=function(e){t._errorHandling(e,r)};i.onsuccess=function(t){var r=e._db=i.result;n(r)};i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,r)};var s=e.oldVersion;t._handleDBUpgrade(i,n,s)}}})};e.prototype._handleDBUpgrade=function(e,t,n){var r;if(n<1){(r=t.createObjectStore("ODSP_DB_TABLE",{keyPath:"key"})).createIndex("lastModified","lastModified",{unique:!1});r.createIndex("reads","reads",{unique:!1});t.createObjectStore("ODSP_DB_METADATA_TABLE",{keyPath:"key"})}if(n<2){(r=r||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("app","app",{unique:!1});r.createIndex("lastRead","lastRead",{unique:!1});r.createIndex("app_lastRead",["app","lastRead"],{unique:!1})}if(n<3){(r=r||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("app_lastModified",["app","lastModified"],{unique:!1});r.createIndex("app_reads",["app","reads"],{unique:!1})}if(n<4){(r=r||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("parentKey","parentKey",{unique:!1});r.createIndex("parentKey_app",["parentKey","app"],{unique:!1});r.createIndex("parentKey_app_lastModified",["parentKey","app","lastModified"],{unique:!1});r.createIndex("parentKey_app_lastRead",["parentKey","app","lastRead"],{unique:!1});r.createIndex("parentKey_app_reads",["parentKey","app","reads"],{unique:!1})}};e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal("ODSP_DB_METADATA_TABLE",function(e){return e.get("database_metadata")}).then(function(t){if(t)return t.data;var n={id:p.generate(),created:Date.now(),cacheType:c.indexedDB};return e._writeInternal({tableName:"ODSP_DB_METADATA_TABLE",key:"database_metadata",row:{key:"database_metadata",data:n}}).then(function(){return n})})};e.prototype._readInternal=function(t,n){return Object(s.t)(this,void 0,void 0,function(){var r,i,o,u=this;return Object(s.i)(this,function(s){switch(s.label){case 0:i=e;return(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=s.sent();s.label=2;case 2:r=i._db=o;return[2,new Promise(function(e,i){var s=u._logger({name:"PersistentCacheIDB.readInternal"}),o=Date.now(),a=r.transaction([t],"readonly").objectStore(t),f=n(a);f.onsuccess=function(t){s({resultType:v.t.Success,extraData:{io:Math.round(Date.now()-o)}});e(f.result)};f.onerror=function(e){s({resultType:v.t.Failure,extraData:{io:Math.round(Date.now()-o)}});u._errorHandling(e,i)}})]}})})};e.prototype._iterate=function(t,n){return Object(s.t)(this,void 0,void 0,function(){var r,i,o,u,a=this;return Object(s.i)(this,function(s){switch(s.label){case 0:i=e;return(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=s.sent();s.label=2;case 2:r=i._db=o;u=[];return[2,new Promise(function(e,i){var s=r.transaction([t],"readonly").objectStore(t).openCursor();s.onsuccess=function(t){var r=s.result;if(r){u.push(n(r.value));r.continue()}else e(u)};s.onerror=function(e){a._errorHandling(e,i)}})]}})})};e.prototype._writeInternal=function(t){return Object(s.t)(this,void 0,void 0,function(){var n,r,i,o,u,a,f=this;return Object(s.i)(this,function(s){switch(s.label){case 0:n=t.tableName,r=t.key,i=t.row;u=e;return(a=e._db)?[3,2]:[4,e._openDBPromise];case 1:a=s.sent();s.label=2;case 2:o=u._db=a;return[2,new Promise(function(e,t){try{var s=o.transaction([n],"readwrite"),u=s.objectStore(n);s.oncomplete=function(){};s.onerror=function(e){f._errorHandling(e,t)};var a=i?u.put(i):u.delete(r);a.onsuccess=function(t){e()};a.onerror=function(e){f._errorHandling(e,t)}}catch(e){throw e}})]}})})};e.prototype._deleteDataRows=function(e){return Object(s.t)(this,void 0,void 0,function(){var t,n=this;return Object(s.i)(this,function(r){t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1);return[2,this.rangeQuery({index:"parentKey",range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return n._writeInternal({tableName:"ODSP_DB_TABLE",key:e,row:void 0})}))}).then(function(){})]})})};e.prototype._errorHandling=function(e,t){if(e.type===i.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}};return e})(),b="localStorage is not supported",w=(function(){function e(){try{if("localStorage"in d&&d.localStorage){this._localStorage=d.localStorage;if(!this._localStorage.getItem("PersistentCache_metadata")){var e={id:p.generate(),created:Date.now(),cacheType:c.localStorage};this._localStorage.setItem("PersistentCache_metadata",JSON.stringify(e))}}}catch(e){}if(!this._localStorage)throw new Error(b)}e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")};e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))};e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=Object(s.e)(Object(s.e)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(this._cacheKey(t))};e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf("PersistentCache")){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem("PersistentCache_metadata")),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}};e.prototype.rangeQuery=function(e){return Object(s.t)(this,void 0,void 0,function(){return Object(s.i)(this,function(e){return[2,void 0]})})};e.prototype._cacheKey=function(e){return"".concat("PersistentCache","_").concat(e)};return e})(),E="wrong secret or signature.",S=0,x=(function(){function e(){this._queue={}}e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],r=!0,i=[];if(n.length>0)if(n[0].schedule){i=n.slice(1);this._queue[e]=[n[0]];r=!1}else{i=this._queue[e];this._queue[e]=[]}var s=this._createUpateTask(e,t);i.length>0&&(s.signal=i[0].signal);this._queue[e].push(s);r&&this._scheduleTask(e);return s};e.prototype._createUpateTask=function(e,t){var n=this,r={};r.promise=new Promise(function(e,t){r.resolve=e;r.reject=t});var i={execute:function(){return Object(s.t)(n,void 0,void 0,function(){var e;return Object(s.i)(this,function(n){switch(n.label){case 0:n.trys.push([0,2,3,4]);return[4,t()];case 1:n.sent();return[3,4];case 2:e=n.sent();i.error=e;return[3,4];case 3:this._completeTask(i);return[7];case 4:return[2]}})})},schedule:0,id:S++,key:e,signal:r};return i};e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=d.setTimeout(n.execute,5)}};e.prototype._completeTask=function(e){var t=e.id,n=e.key,r=this._queue[n],i=r[0],s=r.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=s;this._scheduleTask(n);e.error?e.signal.reject(e.error):e.signal.resolve()};return e})();function T(){return d.performance&&performance.now?Math.round(performance.now()):Date.now()}var N=n(26),C={cacheType:c.indexedDB},k=(function(){function e(e){var t=e.cacheType,n=void 0===t?C.cacheType:t,r=Object(s.s)(e,["cacheType"]);this._config=Object(s.e)(Object(s.e)({},r),{cacheType:n});this._cacheSecret=this._config.secret;this._dataIsEncrypted=!!this._cacheSecret;this._crypto=this._config.crypto;if(this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType;this._app=e.app;this._cacheUpdateTaskManager=new x;this._qos=this._config.telemetry&&this._config.telemetry.qos;this._initLocalStorage(this._cacheType)}Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!1,configurable:!0});e.prototype.read=function(t){return Object(s.t)(this,void 0,void 0,function(){var n,r,i,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,S,x;return Object(s.i)(this,function(s){switch(s.label){case 0:n=this._logQos({name:"PersistentCache.read"});u=T();a=Date.now();s.label=1;case 1:s.trys.push([1,12,,13]);l=this._getCacheKey(t);c=!1;h={lastModified:NaN,lastRead:a,reads:1};p=void 0;if(!l)return[3,11];d=T();return[4,this._storage.read(l)];case 2:f=s.sent();o=Math.round(T()-d);if(!f)return[3,11];v=f.data;h={lastModified:f.lastModified,lastRead:a,reads:f.reads+1};if(!(r=e._buffer[l])||r.cacheStats.lastModified!==f.lastModified)return[3,3];r.app=f.app||this._app;r.key={original:t,encoded:f.key||l};r.cacheStats.lastRead=a;r.cacheStats.reads++;r.performance={total:Math.round(T()-u)};return[3,11];case 3:r=void 0;if(void 0===v)return[3,11];if(!this._dataIsEncrypted)return[3,10];m=v;g=this._cacheSecret,y=g.CurrentKey.Key,b=g.PreviousKey.Key;w=T();s.label=4;case 4:s.trys.push([4,6,,9]);return[4,this._crypto.decrypt({encryptedData:m,encryptionSecret:y})];case 5:p=s.sent();return[3,9];case 6:return(S=s.sent())&&S.message&&S.message.indexOf(E)>=0?[4,this._crypto.decrypt({encryptedData:m,encryptionSecret:b})]:[3,8];case 7:p=s.sent();c=void 0!==p;n({resultType:N.e.ExpectedFailure,error:S.message,extraData:{cacheResult:"hit"}});s.label=8;case 8:return[3,9];case 9:i=Math.round(T()-w);return[3,11];case 10:p=v;s.label=11;case 11:r=r||{key:{original:t,encoded:f&&f.key||l},app:f&&f.app||this._app,data:p,cacheStats:h,cacheType:this._cacheType,performance:{crypto:i,io:o,total:Math.round(T()-u)}};e._buffer[l]=r;c&&this.update(t,p);return[3,13];case 12:x=s.sent();n({resultType:N.e.Failure,error:x.message?x.message:x.toString(),extraData:{cacheResult:"miss"}});throw x;case 13:n({resultType:N.e.Success,extraData:{cacheResult:"".concat(void 0!==r.data?"hit":"miss")}});return[2,Promise.resolve(r)]}})})};e.prototype.rangeQuery=function(e){return Object(s.t)(this,void 0,void 0,function(){var t,n,r,i,o,u,a,f=this;return Object(s.i)(this,function(s){if(this._cacheType!==c.indexedDB)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"});n=0;r=T();i=Date.now();u={lastModified:NaN,lastRead:i,reads:1};try{a=T();o=this._storage.rangeQuery(e).then(function(e){n=Math.round(T()-a);return{key:void 0,app:void 0,data:e.map(function(e){return{original:f._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:u,cacheType:f._cacheType,performance:{io:n,total:Math.round(T()-r)}}})}catch(e){t({resultType:N.e.Failure,error:e.message?e.message:e.toString()});throw e}t({resultType:N.e.Success});return[2,o||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:u,cacheType:this._cacheType,performance:{io:n,total:Math.round(T()-r)}})]})})};e.prototype.update=function(e,t){return Object(s.t)(this,void 0,void 0,function(){var n,r=this;return Object(s.i)(this,function(i){switch(i.label){case 0:n=this._getCacheKey(e);return[4,this._cacheUpdateTaskManager.enqueue(n,function(){return r._doCacheUpdate(e,t)}).signal.promise];case 1:i.sent();this._logCacheStats();return[2]}})})};e.prototype.remove=function(e){return Object(s.t)(this,void 0,void 0,function(){return Object(s.i)(this,function(t){return[2,this.update(e,void 0)]})})};e.prototype.freeSpace=function(e,t){return Object(s.t)(this,void 0,void 0,function(){return Object(s.i)(this,function(n){return[2,this._storage.freeSpace(e,t)]})})};e.prototype.readAndUpdate=function(e,t){return Object(s.t)(this,void 0,void 0,function(){var n,r,i,o,u,a,f=this;return Object(s.i)(this,function(s){switch(s.label){case 0:n=T();r=Date.now();i=this._logQos({name:"PersistentCache.readAndUpdate"});o=t().then(function(t){var i={app:f._app,key:{original:e,encoded:f._getCacheKey(e)},data:t,cacheType:c.none,cacheStats:{lastModified:void 0,lastRead:r,reads:1},performance:{total:Math.round(T()-n)}};f.update(e,t);return i});s.label=1;case 1:s.trys.push([1,8,,9]);s.label=2;case 2:s.trys.push([2,4,,5]);return[4,Promise.race([this.read(e),o])];case 3:u=s.sent();return[3,5];case 4:s.sent();return[3,5];case 5:return!u||u.cacheType!==c.none&&void 0===u.data?[4,o]:[3,7];case 6:u=s.sent();s.label=7;case 7:return[3,9];case 8:a=s.sent();i({resultType:N.e.Failure,error:a.message?a.message:a.toString()});throw a;case 9:i({resultType:N.e.Success});return[2,u]}})})};e.prototype._initLocalStorage=function(e){switch(e){case c.localStorage:this._storage=new w;break;case c.indexedDB:default:try{this._storage=new y(this._logQos.bind(this))}catch(e){if(e.message===g){this._storage=new w;this._cacheType=c.localStorage}}}};e.prototype._getCacheKey=function(e){var t=encodeURIComponent("".concat(e.key).concat(e.user?"_____"+e.user:""));return"".concat("_odspcache_").concat(this._dataIsEncrypted?btoa(t):t)};e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace("_odspcache_",""),n=this._dataIsEncrypted?atob(t):t,r=decodeURIComponent(n);if(r.indexOf("_____")>=0){var i=r.split("_____");return{key:i[0],user:i[1]}}return{key:r}};e.prototype._doCacheUpdate=function(t,n){return Object(s.t)(this,void 0,void 0,function(){var r,i,o,u,a,f,l;return Object(s.i)(this,function(h){switch(h.label){case 0:r=this._logQos({name:"PersistentCache.update"});h.label=1;case 1:h.trys.push([1,9,,10]);i=this._getCacheKey(t);if(void 0===n)return[3,6];(o=e._buffer[i]=Object(s.e)(Object(s.e)({},e._buffer[i]),{data:n,cacheType:this._cacheType})).cacheStats||(o.cacheStats={lastModified:NaN,lastRead:T(),reads:1});u=n;a=NaN;if(!this._dataIsEncrypted)return[3,3];f=this._cacheSecret.CurrentKey.Key;return[4,this._crypto.encrypt({encryptionSecret:f,data:n,doSerialize:this._cacheType===c.localStorage})];case 2:u=h.sent();a=u.cipherText?u.cipherText.byteLength:0;return[3,4];case 3:try{a="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}h.label=4;case 4:return[4,this._storage.write({app:this._app,key:i,data:u,lastRead:o.cacheStats.lastRead,parentKey:t.parentKey,reads:o.cacheStats.reads,size:a})];case 5:h.sent();return[3,8];case 6:delete e._buffer[i];return[4,this._storage.write({key:i,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:h.sent();h.label=8;case 8:return[3,10];case 9:l=h.sent();r({resultType:N.e.Failure,error:l.message?l.message:l.toString()});throw l;case 10:r({resultType:N.e.Success});return[2]}})})};e.prototype._logCacheStats=function(){return Object(s.t)(this,void 0,void 0,function(){var e=this;return Object(s.i)(this,function(t){this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return Object(s.t)(e,void 0,void 0,function(){return Object(s.i)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:e.sent();return[2]}})})},3e4));return[2]})})};e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={});e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={});e.extraData.alias=e.extraData.alias||t;n.end(e)}}return function(e){}};e._buffer={};return e})(),L=n(100),A=!u.e.isActivated("32DD9EE9-56B8-4C7C-BC57-67F6BCAD585E","09/27/2022","Fix PersistentRequestCache to always clear cached promise once it resolves/rejects"),O=(function(){function e(e,t){this._getDataPromises={};var n=e.id,r=e.dataSourceName,i=e.cacheType,o=void 0===i?c.indexedDB:i,u=(t.pageContext||{}).aadUserId;this._id=n;this._userId=u;var a=r||n,f=v.e.withData(function(e){return e.name&&a&&!e.name.startsWith(a)?Object(s.e)(Object(s.e)({},e),{name:"".concat(a,".").concat(e.name)}):e});this._cache=new k({cacheType:o,telemetry:{qos:f}})}e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,r=n.cacheRequestKey,i=n.cachingStrategy,s=void 0===i?L.e.useCacheAndUpdateInTheBackground:i,u=n.cacheTimeoutTime,a=void 0===u?L.r:u,f=n.getData,l=n.returnStatistics,c=void 0!==l&&l,h=n.cacheRequestParentKey,p={key:r,user:this._userId,parentKey:h},d=function(){if(A){var e=t._getDataPromises[r];e||(e=t._getDataPromises[r]=f()).then(function(e){t._cache.update(p,e);delete t._getDataPromises[r];return e}).catch(function(e){delete t._getDataPromises[r];throw e});return e.then(function(e){return c?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})}t._getDataPromises[r]||(t._getDataPromises[r]=f().then(function(e){delete t._getDataPromises[r];return e}).catch(function(e){delete t._getDataPromises[r];throw e}));return t._getDataPromises[r].then(function(e){t._cache.update(p,e);return c?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})};return s===L.e.onlyCache?o.t.resolve(this._cache.read(p)).then(function(e){var t=e||(A?{}:void 0),n=t.data,r=t.cacheStats;return null==n?null:c?{data:n,cacheStats:r}:n}).catch(function(){return null}):o.t.resolve(this._cache.read(p)).then(function(e){var n=e||(A?{}:void 0),r=n.data,i=n.cacheStats;if(null==r)return d();var o=c?{data:r,cacheStats:i}:r,u=t._isCacheExpired(i.lastModified,a);switch(s){case L.e.useCacheAndNoUpdate:return o;case L.e.useCacheAndUpdateInTheBackground:u&&d();return o;case L.e.useCacheIfNotExpired:return u?d():o;case L.e.bypassCache:default:return d()}}).catch(function(){return d()})};e.prototype.getRequestKey=function(e,t,n){var r=[];r.push(e);r.push(t);n&&r.push(n.toString());return r.join(",")};Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!1,configurable:!0});e.prototype.flushCache=function(e,t){var n={key:e,user:this._userId,parentKey:t};delete this._cache[e];this._cache.remove(n)};e.prototype.updateCache=function(e,t){var n={key:e,user:this._userId};this._cache.update(n,t)};e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t};return e})()},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(246);function s(e){return Object(r.t)(this,void 0,void 0,function(){var t,n,s,o,u,a,f;return Object(r.i)(this,function(r){switch(r.label){case 0:return[4,Promise.all(e.map(function(e){return e.then(function(e){return{result:e}},function(e){return{error:e}})}))];case 1:t=r.sent();n=[];s=[];o=!0;for(u=0,a=t;u<a.length;u++){f=a[u];if("error"in f){Object(i.n)(f.error)||(o=!1);s.push(f.error)}else{n.push(f.result);o=!1}}if(s.length>0)throw o?new i.e:s[0];return[2,n]}})})}},,function(e,t,n){"use strict";var r=n(182),i=n(68),s=(function(){function e(){}e.start=function(e){var t=new r.e(e);return new i.t(function(e,n){t.start(e,n)},function(){t.abort(!0)})};e.startAndPostProcess=function(e,t){var n=new r.e(e);return new i.t(function(e,r){n.start(function(n,r){e(t(n,r))},r)},function(){n.abort(!0)})};return e})();t.e=s},function(e,t,n){"use strict";n.d(t,"e",function(){return s});function r(e){return e?e.endTime-e.startTime:0}function i(e){return!(!e||!e.startTime&&0!==e.startTime||!e.endTime&&0!==e.endTime||!(e.endTime>e.startTime))}var s=function(e){var t=e.controlId,n=e.startTime,s=e.endTime,o=e.ignoreForEUPL,u=e.needFlatten,a=e.renderTimeCalculator,f=void 0===a?r:a,l=e.renderTimeRequiredDataChecker,c=void 0===l?i:l;this.controlId=t;this.startTime=n;this.endTime=s;this.renderTimeCalculator=f;this.renderTimeRequiredDataChecker=c;this.ignoreForEUPL=void 0===o||o;this.needFlatten=void 0!==u&&u}},,,,,,,,,,,function(e,t,n){"use strict";var r=n(234),i=0;function s(e){var t;if(e){var n=e&&e.toString?e.toString():"InvalidMethod()",r=8===n.indexOf(" ")?9:0,i=n.indexOf(")")+1;if(0===(t=n.substring(r,i)).indexOf("function")||t.indexOf("(")<3){var s=i+50;t=(function(e,t){e&&e.length>t&&(e=e.substr(0,t-3)+"...");return e})(n=n.replace(/\s\s*/g," "),s)+(s<n.length?"}":"")}}return t}var o=[function(e){return"string"==typeof e&&0===e.indexOf("ResizeObserver loop limit exceeded")}];function u(e,t,n,a,f){try{window.parent&&window.parent.opener&&"LogOnError"in window.parent.opener&&(o.some(function(t){return t(e,f)})||Function.prototype.apply.call(window.parent.opener.LogOnError,window.parent.opener,[e,t,n,a,f]))}catch(e){}var l=f&&f.stack,c=(function e(){var t,n=[];try{t=arguments.callee;for(;t===u||t===e;)t=t?t.caller:t}catch(e){t=null}var r=0;try{for(;t&&r<10;){n.push(s(t));t=t.caller;r++}}catch(e){}return n})().join("\n");l=l?l.replace(/[ \t]{2,}/g," "):"";c=c.replace(/[ \t]{2,}/g," ");var h={message:e,url:t,line:n,col:a,stack:l,builtStack:c};i<100?r.e.logData(h):100===i&&r.e.logData({message:"Hit max error limit of ".concat(100),url:"NA",line:0,col:0,stack:"",builtStack:""});i++}window.onerror=u},function(e,t,n){"use strict";var r=n(45),i=n(25),s=n(254),o=n(41),u=new r.e("RequireJS",i.e.session),a=(function(){function e(){}e.log=function(e){s.e.logData(e);var t=u.getValue("error")||[];t.push(e.message);u.setValue("error",t);e&&("define"===e.requireType||"require"===e.requireType)&&e.stack&&e.requireModules&&o.e.log(e)};e.registerRequireOnError=function(){if(window.requirejs&&"function"==typeof window.requirejs){var t=window.requirejs.onError;window.requirejs.onError=function(n){e.log(n);t&&!n.isTest&&t(n)}}};return e})();a.registerRequireOnError()},function(e,t,n){"use strict";0},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r=n(60),i=n(35),s=n(9);function o(e){for(var t={CorrelationVector:e.vector.toString(),WebLog_FullName:e.eventName,WebLog_EventType:r.t[e.eventType]},n=e.eventName.split(","),s=0,o=n;s<o.length;s++){var u=o[s];u&&(t["WebLog_Type_".concat(u)]=1)}var a=e.data,f=e.context;if(f)for(var l in f)if(Object.prototype.hasOwnProperty.call(f,l)){if(null==(h=f[l]))continue;t[d=Object(i.e)(l)]=h}if(a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var h;if(null==(h=a[c]))continue;var p=e.metadata[c];if(p){var d=p.isPrefixingDisabled?Object(i.e)(c):"".concat(Object(i.e)(p.definedInName),"_").concat(c),v=p.type;if(4===v){for(var m in h)if(Object.prototype.hasOwnProperty.call(h,m)){var g=h[m];if(null!=g&&""!==g){var y=void 0;if("object"==typeof g)try{y=JSON.stringify(g)}catch(e){y=g}else y=g;t["".concat(d,"_").concat(m.replace(/\./g,"_"))]=y}}}else t[d]=6===v?p.typeRef[h]:h}}return{name:e.isEventTypePrefixingDisabled?n[n.length-2]:"ev_".concat(n[n.length-2]),values:t}}function u(e,t,n){var r=o(t),i=r.name,u=r.values,a=new e.EventProperties;a.name=i;if(!s.t.isActivated("2657d5a5-7313-42a0-ab20-287781f44d1b")){(function(e){return"AppChrome.PageOpenedInTeamsVivaConnections1PAppContext"===e||"SPO.DashboardWebPart.Load"===e||"AdaptiveCardExtension.CardAction"===e||"TeamsNavigation.Navigation.ClickedInTeamsviva1pAppContext"===e||"TeamsSiteHeader.RefreshButtonClicked"===e||"TeamsSiteHeader.CopyLinkButtonClicked.successful"===e||"TeamsSiteHeader.GoToBrowserButtonClicked"===e})(u.Name)&&(a.eventType="VivaAnalytics")}(function(e,t,n,r){var i;try{for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){i=s;t.setProperty(s,n[s])}}catch(t){var o=void 0,u=void 0;if(t instanceof e.Exception){o=t.ErrorCode();u=new Error("Aria error: ".concat(t.toString()))}if(u){t.handled=!0;r&&r.logError(u,{errorCode:o,propertyKey:i})}throw t}})(e,a,u,n);return a}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(157);function i(e){void 0===e&&(e=new r.e);return{BrowserIsMobile:e.isMobile,BrowserIsPWA:e.isPWA,BrowserMajVer:e.browserMajor,BrowserMinVer:e.browserMinor,BrowserName:e.browserName,BrowserUserAgent:e.userAgent,OSName:e.osName,OSVersion:e.osVersion}}},function(e,t,n){"use strict";var r=n(41),i=n(95),s=n(68),o=n(66),u=n(197),a=n(61),f=n(4),l=Object(a.e)({eventName:"UnhandledPromise,",shortEventName:"UnhandledPromise"},{message:f.e.String,extraData:f.e.String}).withData({privacyClassification:f.t.requiredService,privacyDataTypes:["productAndServicePerformance"]}),c=new((function(){function e(){this._outstandingPromiseErrors={};this._async=new i.e}e.prototype.log=function(e){var t=this,n=e.id;if(e.parent)e.handler&&delete this._outstandingPromiseErrors[n];else{this._outstandingPromiseErrors[n]=e;1===Object.keys(this._outstandingPromiseErrors).length&&this._async.setTimeout(function(){var e=t._outstandingPromiseErrors;t._outstandingPromiseErrors={};Object.keys(e).forEach(function(t){var n=e[t],i=n.exception?n.exception:n.error;i instanceof Error||i&&i.stack?s.t.isCanceled(n)||r.e.log(i):l.logData({message:"Promise with no error callback",extraData:Object(u.e)(i)});if(window.console&&console.log){var o="Promise with no error callback:"+n.id;console.warn?console.warn(o):console.log(o);console.log(n);i&&i.stack&&console.log(i.stack)}})},0)}};return e})());new o.t(c).on(s.t,"error",c.log)},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r,i=!(!(null===window||void 0===window?void 0:window.Flight)||"dev"!==window.Flight.version&&!window.Flight.devMode),s=-1!==(null===(r=null===window||void 0===window?void 0:window.document)||void 0===r?void 0:r.cookie.indexOf("srr"))||i,o="".concat("https://res-1.cdn.office.net").concat("/files/fabric-cdn-prod_20230223.001","/"),u=s?o:"";var a=(function(e){var t,n;if(!u){var r=null===(n=null===(t=window.require)||void 0===t?void 0:t.toUrl)||void 0===n?void 0:n.call(t,"");u=r?"".concat((function(e){var t=e.indexOf("//"),n=e.indexOf("/"),r=t>-1&&t<=n?t+"//".length:-1;if(r>-1){var i=e.indexOf("/",r);return i>-1?e.slice(0,i):e}return""})(r)).concat("/files/fabric-cdn-prod_20230223.001"):o}return"".concat(u).concat(e)})("")},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-InfoButton-infoIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:5px 4px 4px 4px;font-size:.75rem}.od-InfoButton-button{background:0 0;border:none;padding:0}.od-InfoButton-content{font-size:.75rem;display:flex;flex-direction:column;padding:10px;width:250px}"}]);var s=n(496),o=n(30),u=n(392),a=n("react-lib"),f=n("prop-types-lib"),l=(function(e){Object(r.r)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onShowCallout=function(){i.setState(Object(r.e)(Object(r.e)({},i.state),{isCalloutVisible:!0}))};i._onDismissCallout=function(){i.setState(Object(r.e)(Object(r.e)({},i.state),{isCalloutVisible:!1}))};i._onInfoButton=function(e){i._infoButton=e};i.state={isCalloutVisible:!1};return i}t.prototype.render=function(){var e=this.props,t=this.state;return a.createElement("div",null,a.createElement("div",{className:"od-InfoButton-button",onClick:this._onShowCallout,ref:this._onInfoButton},a.createElement(u.e,{iconName:"Info",className:"od-InfoButton-infoIcon",onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,styles:{root:{fontSize:"0.75rem"}}})),t.isCalloutVisible&&a.createElement(s.e,{directionalHint:o.e.topCenter,gapSpace:2,onDismiss:this._onDismissCallout,target:this._infoButton,setInitialFocus:!0},a.createElement("div",{className:"od-InfoButton-content"},a.createElement("span",{className:"od-InfoButton-message"},e.message))))};t.contextTypes={strings:f.object.isRequired};return t})(a.Component)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n("react-lib"),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.Header-width{width:100%}@media screen and (max-width:352px){.Header-width{max-width:294px}}.Header-flex-row{display:flex;flex-direction:row}.Header-flex-row i{font-size:.875rem}.Header-flex-row button:hover{outline:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:4px}.Header-flex-grow{flex-grow:1}.Header-main-text{white-space:nowrap;overflow:hidden}.Header-filename{margin:0;font-size:1.25rem;font-weight:600;font:-apple-system-title1;overflow:hidden;text-overflow:ellipsis}@media screen and (max-width:511px){.Header-filename{font-size:1rem}}.Header-actions{padding-left:5px;gap:5px}.Header-actions button{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.Header-backButton button{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}"}]);var s=n(30),o=n(1),u=n(58),a=n(10),f=n(166);function l(e){var t=e.mainHeaderText,n=e.actions,i=e.renderBackButton,l=e.onBackButtonClicked,c=Object(a.R)(t),h=c!==t;return r.createElement("div",{className:"Header-flex-row Header-width"},i&&r.createElement("div",{className:"Header-flex-row Header-backButton"},r.createElement(f.e,{iconProps:{iconName:"Back"},ariaLabel:o.ne,onClick:l,tooltipContent:o.ne})),r.createElement("div",{className:"Header-main-text Header-flex-grow"},h?Object(u.t)(r.createElement("h1",{className:"Header-filename"},c),t,{position:s.e.bottomLeftEdge}):r.createElement("h1",{className:"Header-filename","aria-label":t},t)),r.createElement("div",{className:"Header-flex-row Header-actions"},n))}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(61),i=n(4),s=n(227),o=Object(r.e)({eventName:"Verbose,Trace,",shortEventName:"Verbose"},{name:{isKey:!0,type:i.e.String},privacyClassification:{isPrefixingDisabled:!0,type:i.e.String}},s.e).withData({privacyClassification:i.t.requiredService})},,function(e,t,n){"use strict";var r,i=n(68),s=n(6);(function(e){e[e.InteractionRequired=10013]="InteractionRequired"})(r||(r={}));var o=(function(){function e(e,t){void 0===e&&(e={});this._dataSource=t.oAuthTokenDataSource}e.prototype.getToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){n.end({resultType:s.t.Success});return e},function(e){n.end({resultType:s.t.Failure});return i.t.reject(e)})};e.prototype.getInstrumentedToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){n.end({resultType:s.t.Success});return e},function(e){n.end({resultType:s.t.Failure});return i.t.reject(e)})};return e})();t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(42),i=n(112),s=(function(){function e(e){this._pageContext=e.pageContext;this._listId=e.listId;this._listItemId=e.listItemId;this._webAbsoluteUrl=e.webAbsoluteUrl}e.prototype.getAdvancedUrl=function(){var e=[this._webAbsoluteUrl];e.push("/_layouts/15/user.aspx");e.push("?List="+r.e.encodeURIComponent(this._listId));if(this._listId&&this._listItemId){e.push("&obj=",r.e.encodeURIComponent(this._listId),",",r.e.encodeURIComponent(this._listItemId),",LISTITEM");Number(this._pageContext.webTemplate)===i.t.group&&e.push("&noredirect=true");return e.join("")}};return e})()},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){return(function(e){return!!e&&"object"==typeof e&&"default"in e})(e)?e.default:e}},function(e,t,n){"use strict";n.d(t,"e",function(){return I});var r=n(0),i=n(14),s=n(461),o=n(45),u=n(25),a=n(199),f=n(61),l=n(4),c=Object(f.e)({eventName:"SuiteNavError,",shortEventName:"SuiteNavError"},{message:l.e.String,stack:l.e.String,type:l.e.String}),h=n(112),p=n(229),d=n(66),v=n(27),m=n(9),g=n(160),y=n(237),b=n(330),w=n(68);var E,S=n(77),x=n(400),T=n(157);var N=(function(){function e(){}e.hasClass=function(e,t){return e.classList?e.classList.contains(t):-1!==(e.className?e.className.split(" "):[]).indexOf(t)};e.toggleClass=function(e,t,n){if(e.classList)n?e.classList.add(t):e.classList.remove(t);else{var r=e.className?e.className.split(" "):[],i=r.indexOf(t);n?-1===i&&r.push(t):i>-1&&r.splice(i,1);e.className=r.join(" ")}};e.loadStyles=function(t){e._platform.isUnlimitedStyleSheetsSupported?e.registerStyle(t):e.registerStyleIE(t)};e.registerStyle=function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css";n.appendChild(document.createTextNode(e));t.appendChild(n)};e.registerStyleIE=function(t){var n=document.getElementsByTagName("head")[0],r=e._lastStyleElement?e._lastStyleElement.styleSheet.cssText:"";if(!e._lastStyleElement||r.length+e._styleText.length>e.MAX_STYLE_CONTENT_SIZE){e._lastStyleElement=document.createElement("style");e._lastStyleElement.type="text/css";n.appendChild(e._lastStyleElement)}e._lastStyleElement.styleSheet.cssText+=t};e.loadStylesheet=function(e){var t=document.createElement("link");t.rel="stylesheet";t.type="text/css";t.href=e;document.head.appendChild(t)};e.setText=function(t,n){void 0===E&&(E=void 0!==e.ce("div").textContent?"textContent":"innerText");t[E]=n};e.ce=function(e,t,n){var r=document.createElement(e);if(t)for(var i=Object.keys(t),s=0;s<i.length;s++){var o=i[s];r.setAttribute(o,t[o])}if(n)for(var u=0;u<n.length;u++)r.appendChild(n[u]);return r};e.setShadowParent=function(t,n){t[e.SHADOW_PARENT_KEY]=n};e.getParent=function(t,n){void 0===n&&(n=!0);return n&&t[e.SHADOW_PARENT_KEY]||t.parentElement};e.ct=function(e){return document.createTextNode(e)};e.createComment=function(e){return document.createComment(e)};e.clickElement=function(e){e.onclick?e.onclick(void 0):e.click&&e.click()};e.insertAfter=function(e,t){var n=t.parentNode,r=t.nextSibling;r?n.insertBefore(e,r):n.appendChild(e)};e.waitForElement=function(e,t,n){var r=document.querySelector(e);if(!r){var i=new MutationObserver(function(n,r){var i=document.querySelector(e);if(i){t(i);r.disconnect()}});i.observe(n||document.documentElement,{childList:!0,subtree:!0});return i}t(r)};e.getElementByTagAndPartialId=function(e,t,n){for(var r=[],i=e.getElementsByTagName(t),s=0;s<i.length;s++)i[s].id.indexOf(n)>=0&&r.push(i[s]);return r.length>0?r[0]:null};e.findAncestor=function(t,n,r){void 0===r&&(r=!0);for(;t&&t!==document.body;){if(e.hasClass(t,n))return t;t=e.getParent(t,r)}return null};e.calculateRect=function(e,t){var n=e.getBoundingClientRect(),r=0,i=0,s=0,o=0;if(t){var u=window.getComputedStyle(e);r=parseFloat(u.marginLeft);i=parseFloat(u.marginRight);s=parseFloat(u.marginTop);o=parseFloat(u.marginBottom)}return new x.e(n.left-r,n.top-s,n.width+r+i,n.height+s+o)};e.calculateSubtreeRect=function(t){for(var n=null,r=[t];r.length>0;){t=r.shift();var i=e.calculateRect(t);i.width>0&&i.height>0&&(n=n?n.union(i):i);for(var s=0,o=t.children.length;s<o;s++)r.push(t.children[s])}n||(n=new x.e);return n};e.insertAtIndex=function(e,t,n,r){if(e&&t){n=n<0?0:n;for(var i=e.firstElementChild,s=0;s<n&&i;){r&&r!==i.tagName||s++;i=i.nextElementSibling}i?e.insertBefore(t,i):e.appendChild(t)}};e.MAX_STYLE_CONTENT_SIZE=1e4;e.SHADOW_PARENT_KEY="_OneDrive_shadowParent";e._platform=new T.e;e._lastStyleElement=null;e._styleText="";return e})(),C=N,k=n(220),L=n(6),A=n(26),O=n(236),M=(function(){function e(){}e.GetLoadPromise=function(){return window.o365ShellLoadPromise};e.GetRenderPromise=function(){return window.o365ShellRenderPromise};e.GetPostRenderPromise=function(){return window.o365ShellPostRenderPromise};return e})(),_=(function(){function e(){var e=this;this._PostRenderSignal=new s.e;M.GetLoadPromise()&&M.GetLoadPromise().then(function(){e._signalAction(function(){})});M.GetRenderPromise()&&M.GetRenderPromise().then(function(){e._signalAction(function(){})});M.GetPostRenderPromise()&&M.GetPostRenderPromise().then(function(){e._signalAction(function(){})})}Object.defineProperty(e.prototype,"FlexPane",{get:function(){return O365Shell.FlexPane},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"Header",{get:function(){return O365Shell.Header},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"Navigation",{get:function(){return O365Shell.Navigation},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"Settings",{get:function(){return O365Shell.Settings},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"Theme",{get:function(){return O365Shell.Theme},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"Search",{get:function(){return O365Shell.Search},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"NFD",{get:function(){return O365Shell.NFD},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"Extensibility",{get:function(){return O365Shell.Extensibility},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"MeControl",{get:function(){return O365Shell.MeControl},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"DTT",{get:function(){return O365Shell.DTT},enumerable:!1,configurable:!0});e.prototype.SetData=function(e){O365Shell.SetData(e)};e.prototype.Render=function(e,t){var n=this;O365Shell.Render(e,function(){return n._signalAction(t)})};e.prototype.RenderAsync=function(e,t,n){var r=this;O365Shell.RenderAsync(e,function(){return r._signalAction(t)},function(){return r._signalAction(n)})};e.prototype.GetResourceLoader=function(){return O365Shell.GetResourceLoader()};e.prototype.OnDataChanged=function(e){return O365Shell.OnDataChanged(e)};e.prototype.OnSuiteAPILoaded=function(e){return O365Shell.OnSuiteAPILoaded(e)};e.prototype.LoadShellPlus=function(){O365Shell.LoadShellPlus()};e.prototype.Exists=function(){return"undefined"!=typeof O365Shell};e.prototype.HasMember=function(e){return this.Exists()&&!!O365Shell[e]};e.prototype.OnHasMember=function(e,t){var n=this;this.HasMember(e)?t():this._PostRenderSignal.getPromise().done(function(){return n.OnHasMember(e,t)})};e.prototype._signalAction=function(e){e();var t=this._PostRenderSignal;this._PostRenderSignal=new s.e;t.complete()};return e})(),D="SuiteNavProvider.GetO365Shell",P=(function(){function e(t,n){this._cachePrefix="odSuiteNav";this._cacheDataKey="Data";this._cacheThemeDataKey="ThemeData";this._cacheDateKey="CacheDate";this._cacheVersionKey="CacheVersion";this._cacheSessionKey="CachedThisSession";this._cacheVersion=6;this._cacheExpire=24;this._cacheRenew=12;this._cache=new o.e(this._cachePrefix,u.e.local);this._dataSourceBasic=n.dataSource;this._engagementEvent=t.engagementEvent;this._qosEvents=t.qosEvents;this._capabilities=this._dataSourceBasic.getCapabilities();var r=n.require,i=void 0===r?e.require:r;this._require=i}Object.defineProperty(e.prototype,"suiteNavPlaceholder",{get:function(){return this._suiteNavPlaceholder},set:function(e){this._suiteNavPlaceholder||(this._suiteNavPlaceholder=e)},enumerable:!1,configurable:!0});e.prototype.getCapabilities=function(){return this._capabilities};e.prototype.getO365Shell=function(){var e=this;if(!this._capabilities.supportsRealSuiteNav)return w.t.reject(new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true."));if(v.e.isFeatureEnabled({ODB:1136})){var t=new _;return w.t.resolve().then(M.GetLoadPromise).then(function(){return t})}var n=new s.e,r=this._qosEvents&&this._qosEvents[D];this._getSuiteNavShellViaBootstrapper(n);n.getPromise().then(function(){e._qosRecordSuccess(r)},function(t){e._qosRecordError(r,t)});return n.getPromise()};e.prototype.getInitialRenderNavBarData=function(){return this._dataSourceBasic.getInitialRenderNavBarData()};e.prototype.getCachedData=function(){var e;if(this._capabilities.supportsCaching&&this._isCacheValid()){var t=this._cache.getValue(this._cacheDataKey);e=t&&t.data}return e};e.prototype.getCachedThemeData=function(){var e;if(this._capabilities.supportsCaching){var t=this._cache.getValue(this._cacheThemeDataKey);t&&t.themeData&&(e=t.themeData)}return e};e.prototype.updateCachedThemeData=function(e){var t={themeData:e,cacheDate:(new Date).toISOString()};this._cache.setValue(this._cacheThemeDataKey,t)};e.prototype._requestShellCore=function(t,n,r){var i=n?t+"?odb_cb="+(new Date).toISOString():t,o=new s.e;this._require(i,"SuiteNavShellCore",function(e){r&&r();var t=new _;t.Exists()?o.complete(t):o.error(H({error:{message:"O365Shell not defined after require() succeeded"},resultCode:"O365ShellNotDefined",extraData:{shellUrl:i}}))},function(t,n){e.removeHeadScriptElement("SuiteNavShellCore");o.error(H({error:n||t.message,resultCode:"LoadScriptError",extraData:{shellUrl:i}}))});return o.getPromise()};e.removeHeadScriptElement=function(e){var t=document.head.querySelector("#"+e);t&&t.parentNode.removeChild(t)};e.prototype._isCacheValid=function(){var e=this._cache.getValue(this._cacheDataKey),t=this._cache.getValue(this._cacheVersionKey),n=Date.parse(this._cache.getValue(this._cacheDateKey)),r=this._capabilities.supportsRealSuiteNav,i=this._dataSourceBasic;return e&&e.data&&(!r||e.jsUrl)&&t===this._cacheVersion&&e.userIdentifier===i.getUserIdentifier()&&e.cacheToken===i.getCacheToken()&&this._isCacheNotExpired(n,this._cacheExpire)};e.prototype._qosRecordSuccess=function(e){e&&e.end({resultType:A.e.Success})};e.prototype._qosRecordError=function(e,t){e&&e.end(H({error:t}))};e.prototype._logEngagementData=function(e){this._engagementEvent&&this._engagementEvent.logData(e)};e.prototype._isCacheNotExpired=function(e,t){return!isNaN(e)&&Date.now()-e<60*t*60*1e3};e.prototype._getSuiteNavShellViaBootstrapper=function(e,t){var n=this;this._logEngagementData({name:"SuiteNavProvider.GetO365ShellByBootstrapper"});var r=this._dataSourceBasic.getReactShellBootstrapperUrl();this._requestShellCore(r,t).then(function(t){e.complete(t)},function(t){t=H({error:t});if(n._hasRetriedO365Shell)e.error(t);else{n._logEngagementData({name:"SuiteNavProvider.O365ShellRetry"});n._hasRetriedO365Shell=!0;n._getSuiteNavShellViaBootstrapper(e,!0)}})};e.require=function(t,n,r,i){var s=function(){return void 0!==window.O365Shell};if(s())r&&r(null);else{var o=document.head.querySelector("#"+n);if(o&&o.src===t)try{Object(O.t)(s,300,3e4).then(function(){r(null)})}catch(e){i(null,"Unable to load O365Shell")}else{o&&o.src!==t&&e.removeHeadScriptElement(n);var u=document.createElement("script");u.id=n;u.src=t;r&&u.addEventListener("load",function(e){r(e)});i&&u.addEventListener("error",function(e){i(e)});document.head.appendChild(u)}}};return e})();function H(e){var t=e.error;if(t&&t.resultCode)return t;var n=A.e.Failure;if(w.t.isCanceled(t)){n=A.e.ExpectedFailure;e.resultCode="Canceled"}return{resultType:n,resultCode:e.resultCode||"Other",error:t,extraData:e.extraData}}var B={ODB:556,ODC:null,Fallback:!1},j={ODB:1302,ODC:null,Fallback:!1},F={ODB:1836,ODC:null,Fallback:!1},I=(function(e){Object(r.r)(t,e);function t(t,n){var r=e.call(this,{engagementEvent:k.e,qosEvents:{"SuiteNavProvider.GetO365Shell":new L.e({name:"SuiteNavProvider.GetO365Shell"})}},n)||this;r._dataSource=n.dataSource;r._cssLoaded=!1;r._isSuiteNavBootstrapperLoadingFlowEnabled=v.e.isFeatureEnabled(j);return r}t.prototype.clearCachedPromise=function(){this._modelPromise=void 0};t.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})};t.prototype.getO365Shell=function(){if(this._isSuiteNavBootstrapperLoadingFlowEnabled)return e.prototype.getO365Shell.call(this);if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var t=new s.e,n=new L.e({name:"SuiteNavProvider.GetO365Shell"});this._getSuiteNavShell(t);t.getPromise().then(function(){n.end({resultType:L.t.Success})},function(e){n.end(H({error:e}))});return t.getPromise()};t.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i&&i.Id===p.e.MAIL)return i.Url}})};t.prototype.updateWorkloadSettingsLinks=function(e){var t,n=this;return this.getO365Shell().then(function(r){return(t=r)&&t.Settings?n.loadData(e):void 0}).then(function(e){e&&e.CurrentWorkloadSettingsSubLinks&&e.CurrentWorkloadSettingsSubLinks.length>0&&t.Settings.SetWorkloadSettingsLinks(e.CurrentWorkloadSettingsSubLinks)}).catch(function(e){k.e.logData({name:"SuiteNavProvider.UpdateWorkloadSettingsLinksError"})})};t.prototype.trySetDataAfterInitialRender=function(e,t){var n=this,i=this._dataSource.getSuiteNavContext();if(i&&i.isConsumer){if(!m.t.isActivated("0461c2e7-c91a-4038-b591-09477f3f84a6","09/27/2021","Extra SuiteNav configuration for Consumer")&&e.NFD){i.helpNamespace&&e.NFD.UpdateHelpNamespace(i.helpNamespace);e.NFD.OnFeedbackMetadataRequested(function(e,t){return e=n._dataSource.setFeedbackMetadata(e,t)});this._addFeedbackButton(e)}m.t.isActivated("F9F01D2F-A402-49F0-97B9-C03F77BEAD5B","01/24/2022","SuiteNav Settings Gear links configuration for Consumer")||i.actionsMap&&e.Navigation.OnLinkClick(function(e){var t=i.actionsMap[e.Id];t&&(e.Cancel=!t(Object(r.e)({},e)))});this._logEngagementData({name:"SuiteNavProvider.SetDataNotNeededInConsumer"});return w.t.wrap(!0)}k.e.logData({name:"SuiteNavProvider.SetDataAfterInitialRender"});var s=t.actionContext,o=t.bundleLoader;return this.loadData().then(function(t){if(!t){k.e.logData({name:"SuiteNavProvider.NoSuiteNavData"});return!1}if(!e){k.e.logData({name:"SuiteNavProvider.NoO365Shell"});return!1}var i=n._isStreamAspx(),u=(i||v.e.isFeatureEnabled(F))&&!!e.NFD,a=u&&(i||n._shouldAddFeedbackButton(e));if(a){var f=JSON.parse(t.ClientData);n._isFeedbackButtonEnabled()&&S.e&&(f.EnableVNextFeedback=!0);if(f.OCVFeedbackMAXEnabled){if(!m.t.isActivated("7897BF84-323B-4580-95D2-A14836FE65F6","09/15/2021","Stop modifying OCVFeedbackMAXEnabled")){f.OCVFeedbackMAXEnabled=!1;t.ClientData=JSON.stringify(f)}}else u=a=!1}try{e.SetData(t)}catch(e){k.e.logData({name:"SuiteNavProvider.SetDataFail"});L.e.instrumentPromise({name:"SuiteNav.RefreshCacheAfterInvalidShellData"},function(){return n.loadData(!0)});return!1}t.ActionsMap&&e.Navigation.OnLinkClick(function(e){var n=t.ActionsMap[e.Id];n&&(e.Cancel=!n(Object(r.e)(Object(r.e)({},e),s||{})))});e.OnHasMember("OnDataChanged",function(){e.OnDataChanged(function(){return L.e.instrumentPromise({name:"SuiteNav.RefreshCacheForShellDataChanged"},function(){return n.loadData(!0)}).done()})});if(u){e.NFD.OnFeedbackMetadataRequested(function(e,t){return e=n._dataSource.setFeedbackMetadata(e,t)});a&&n._addFeedbackButton(e)}o&&o.pageRenderingIsComplete();return!0},function(e){k.e.logData({name:"SuiteNavProvider.LoadDataError"});return!1})};t.prototype._getSuiteNavShell=function(e,t){var n=this;this._loadModel().then(function(r){if(!n._cssLoaded&&r.cssUrl){C.loadStylesheet(r.cssUrl);n._dataSource.onCssLoad&&n._dataSource.onCssLoad(r);n._cssLoaded=!0}k.e.logData({name:"SuiteNavProvider.GetO365ShellByS2S"});n._requestShellCore(r.jsUrl,t,q).then(function(t){e.complete(t)},function(t){n._modelPromise=void 0;if((t=H({error:t}))&&"LoadScriptError"===t.resultCode&&n._isDataFromCache){k.e.logData({name:"SuiteNavProvider.O365ShellCacheFailed"});n._clearCache();n._getSuiteNavShell(e)}else if(n._hasRetriedShell)e.error(t);else{n._hasRetriedShell=!0;n._cssLoaded=!1;k.e.logData({name:"SuiteNavProvider.O365ShellRetry"});n._getSuiteNavShell(e,!0)}})})};t.prototype._loadModel=function(e){var t=this;if(!e&&this._modelPromise)return this._modelPromise;var n,r,i,o,u,a=new s.e,f=this._capabilities.supportsCaching,l=this._dataSource,c=L.t.Failure,h=L.e.instrumentPromise({name:"SuiteNavProvider.LoadData"},function(){return new w.t(function(r,i){var s;!e&&f&&t._isCacheValid()&&(s=t._cache.getValue(t._cacheDataKey));if(s&&s.data){k.e.logData({name:"SuiteNavProvider.DataFromCache"});l.updateDataForCurrentPage&&(s.data=l.updateDataForCurrentPage(s.data));if(f&&t._isCacheOutdated()){k.e.logData({name:"SuiteNavProvider.RefreshCache"});l.loadData().then(function(e){t._updateCache(e)})}t._isDataFromCache=!0;r(s)}else{t._isDataFromCache=!1;e&&k.e.logData({name:"SuiteNavProvider.ForceUpdateData"});k.e.logData({name:"SuiteNavProvider.DataFromServer"});l.loadData().done(function(e){if(e)if(e.data){f&&!(function(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})})(e)&&t._updateCache(e);r(e)}else{n="NoModelData";i("Model with no data returned")}else{n="NoModel";i("No model returned")}},function(e){if(w.t.isCanceled(i)){n="Canceled";c=L.t.ExpectedFailure}else n="ServerLoadFailure";i(e)})}})},null,function(e){if(w.t.isCanceled(e)){c=L.t.ExpectedFailure;n="Canceled"}return{resultType:c,resultCode:n||"Other",error:e}});(r=(o=i||window._spPageContextInfo,u={webThemeProvider:function(){return new y.e({pageContext:o,getThemeDataSource:function(){return w.t.resolve(new b.default(o))}})}},Object(g.e)(u,o)))?this._modelPromise=w.t.all({suiteNavModel:h,theme:r.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,n=e.theme,r=t&&t.data,i=t&&t.hasCobranding,s=r&&r.UseSPOBehaviors,o=v.e.isFeatureEnabled(B),u=n&&n.suiteBarBackground;!(u&&r&&s)||i&&o||(r.ThemeColors=[u,n.primaryText,u,n.suiteBarText,n.suiteBarDisabledText,n.topBarBackground,n.topBarText,n.topBarHoverText,n.primaryBackground,n.themeLighterAlt,n.dialogBorder]);return t}):this._modelPromise=h;this._modelPromise.then(function(e){return a.complete(e)},function(e){return a.error(e)});return a.getPromise()};t.prototype._isFeedbackButtonEnabled=function(){return v.e.isFeatureEnabled({ODB:S.e?-1246:1246,ODC:null,Fallback:!1})};t.prototype._shouldAddFeedbackButton=function(e){var t=!1;if(this._isFeedbackButtonEnabled()){var n=this._dataSource.getWebTemplateType?this._dataSource.getWebTemplateType():h.t.invalid;t=n!==h.t.mySiteHost&&!S.t&&n!==h.t.tenantAdmin||/\/_layouts\/15\/Lists.aspx$/i.test(window.location.pathname)}m.t.isActivated("37979f7f-d962-4d4c-b18d-d795d7c42ffd","04/27/2022","Always add feedback button for stream.aspx")&&!t&&/\/_layouts\/15\/stream.aspx$/i.test(window.location.pathname)&&(t=v.e.isFeatureEnabled({ODB:1246,ODC:null,Fallback:!1}));!t&&/\/_layouts\/15\/videoeditor.aspx$/i.test(window.location.pathname)&&(t=v.e.isFeatureEnabled({ODB:1246,ODC:null,Fallback:!1}));return t};t.prototype._isStreamAspx=function(){return!(m.t.isActivated("37979f7f-d962-4d4c-b18d-d795d7c42ffd","04/27/2022","Always add feedback button for stream.aspx")||!/\/_layouts\/15\/stream.aspx$/i.test(window.location.pathname))};t.prototype._addFeedbackButton=function(e){var t,n="GiveFeedbackButton",r=function(){var t;null===(t=e.FlexPane)||void 0===t||t.CloseFlexPaneForProvider("Feedback");d.e.raise(document.body,"resize",void 0,!0)},s=function(){var t;if(e.FlexPane){e.FlexPane.OpenFlexPaneForProvider("Feedback");d.e.raise(document.body,"resize",void 0,!0)}null===(t=e.Extensibility)||void 0===t||t.UpdateButtonState(n,!0)};if(m.t.isActivated("4dcd117e-f86f-4bbe-bef1-3afc60df78f7","03/02/2022","Load Feedback icon before using it"))null===(t=e.Extensibility)||void 0===t||t.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:a.e,ariaLabel:a.e,iconFontFamily:"FabricMDL2Icons",iconFontName:"",id:n,onShow:s,onHide:r});else if(e.Extensibility){Object(i.N)("Feedback");e.Extensibility.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:a.e,ariaLabel:a.e,iconFontFamily:"FabricMDL2Icons",iconFontName:"",id:n,onShow:s,onHide:r})}};t.prototype._clearCache=function(){this._cache.remove(this._cacheDataKey);this._cache.remove(this._cacheThemeDataKey);this._cache.remove(this._cacheDateKey);this._cache.remove(this._cacheVersionKey);this._cache.remove(this._cacheSessionKey,u.e.session)};t.prototype._updateCache=function(e,t){this._cache.setValue(this._cacheDataKey,e);this._cache.setValue(this._cacheDateKey,new Date);this._cache.setValue(this._cacheVersionKey,this._cacheVersion);this._cache.setValue(this._cacheSessionKey,!0,u.e.session)};t.prototype._isCacheOutdated=function(){var e=this._cache.getValue(this._cacheSessionKey,u.e.session),t=Date.parse(this._cache.getValue(this._cacheDateKey));return o.e.hasStorageType(u.e.session)&&!e||Date.now()-t>=60*this._cacheRenew*60*1e3};return t})(P);function q(){var e=window._o365su;if(e&&e.b)for(var t=0,n=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<n.length;t++){var r=n[t];R(e.b,r)}}function R(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];try{return n.apply(this,e)}catch(e){var i=e;c.logData({message:i&&i.message||"",stack:i&&i.stack||"",type:t})}})}},function(e,t,n){"use strict";n.d(t,"e",function(){return T});var r=n(0),i=n(69),s=(function(){function e(e){this._scope=new i.e;this._targetMap=new WeakMap;this._disposableMap=new WeakMap}e.prototype.on=function(e,t,n){var r;if(o(e))r=e;else{var i=this._targetMap.get(e);if(i)r=i;else{r=new EventTarget;this._targetMap.set(e,r)}}r.addEventListener(t,n);var s=this._disposableMap.get(e);if(!s){s=new Map;this._disposableMap.set(e,s)}var u=this._scope.attach({dispose:function(){r.removeEventListener(t,n)}});s.set(t,u)};e.prototype.off=function(e,t,n){var r;if(o(e))r=e;else{var i=this._targetMap.get(e);i&&(r=i)}var s=this._disposableMap.get(e);if(s){var u=s.get(t);if(u){u.dispose();s.delete(t)}0===s.size&&this._disposableMap.delete(e)}r&&r.removeEventListener(t,n)};e.prototype.dispose=function(){this._scope.dispose()};return e})();function o(e){return!!e.addEventListener}var u=(function(){function e(e){this._scope=new i.e;this._timeoutMap=new Map}e.prototype.setTimeout=function(e,t){var n=this,r=setTimeout(function(){n._timeoutMap.delete(r);e()},t),i=this._scope.attach({dispose:function(){clearTimeout(r)}});this._timeoutMap.set(r,i);return r};e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);if(t){this._timeoutMap.delete(e);t.dispose()}};e.prototype.dispose=function(){this._scope.dispose()};return e})(),a="unsupportedCommand",f="handlerError",l="handlerRejection",c="acknowledgeTimeout",h="resultTimeout",p="setupTimeout",d="canceled",v="disposed",m=0,g=(function(){function e(e,t){void 0===t&&(t={});var n=this,r=new Map,o={onCommand:e.onCommand,onNotification:e.onNotification},c=e.initResources,h=e.initTimeoutMs,v=void 0===h?1e4:h,m=e.ackTimeoutMs,g=void 0===m?1e3:m,y=e.resultTimeoutMs,b=void 0===y?1e4:y,w=t.asyncType,E=void 0===w?u:w,S=t.eventGroupType,x=void 0===S?s:S,T=this._scope=new i.e;T.attach(c);var N,C=this._async=T.attach(new E(this)),k=T.attach(new x(this));this._ackTimeoutMs=g;this._resultTimeoutMs=b;this._invokeCommandHandler=function(e){try{var t=o.onCommand&&o.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:l,isExpected:!1,message:"Unknown error"}).code||e.name||l,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:a,message:e.command},isExpected:!0})}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:f,message:e&&"Name: ".concat(e.name,"; Message: ").concat(e.message||e)}})}};this._invokeNotificationHandler=function(e){try{o.onNotification&&o.onNotification(e)}catch(e){}};var L=this._port=new Promise(function(t,r){T.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=d;r(e)}});N=C.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(v,"ms"));e.code=p;r(e)},v);e.init(function(e){C.clearTimeout(N);T.attach({dispose:function(){e.close()}});k.on(e,"message",function(t){var r=t.data;if(r&&"object"==typeof r)return"acknowledge"===r.type?n._onAcknowledge(r):"command"===r.type?n._onCommand(e,r):"notification"===r.type?n._onNotification(r):"result"===r.type?n._onResult(r):void 0});e.start();t(e)},r)});this.ready=L.then(function(){},function(e){n.dispose();return Promise.reject(e)});this._signals=r}e.prototype.dispose=function(){this._scope.dispose();this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:d,message:"Messenger disposed"}})});this._signals.clear()};e.prototype.sendCommand=function(e,t){var n=this;void 0===t&&(t={});if(this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:v,message:"disposed"}});var r=++m,i=t.timeoutDelayMs,s=void 0===i?this._resultTimeoutMs:i,o=t.acknowledgeTimeoutMs,u=void 0===o?this._ackTimeoutMs:o;return this._port.then(function(t){var i=n._async,o=new Promise(function(e){n._signals.set(r,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(y(r,c))},u),resultTimeout:i.setTimeout(function(){n._onResult(y(r,h))},s),resolve:e})});t.postMessage({type:"command",id:r,data:e});return o})};e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})};e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)};e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n});this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:n})}).catch(function(e){})};e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)};e.prototype._onResult=function(e){var t=e.id,n=this._async,r=this._signals,i=r.get(t);if(i){n.clearTimeout(i.acknowledgeTimeout);n.clearTimeout(i.resultTimeout);i.resolve(e.data)}r.delete(t)};return e})();function y(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}function b(e){if(e.channelId&&e.origin)return e;var t=window.location.hash;if(!t)return e;for(var n={channelId:"",origin:""},i=0,s=t.slice(1).split("&");i<s.length;i++){var o=s[i].split("=",3),u=o[0],a=o[1];n.hasOwnProperty(u)&&(n[u]=decodeURIComponent(a))}return Object(r.e)(Object(r.e)({},n),e)}function w(e,t){void 0===t&&(t={});if(e.isRestartable)return(function(e,t){void 0===t&&(t={});var n=b(e),r=n.channelId,o=n.origin,u=void 0===o?location.origin:o,a=n.host,f=void 0===a?window.parent!==window&&window.parent||window.opener:a,l=n.overridePort,c=n.receiver,h=void 0===c?window:c,p=t.channelType,d=void 0===p?MessageChannel:p,v=t.eventGroupType,m=void 0===v?s:v,y=t.messengerType,w=void 0===y?g:y,E=new i.e,S=E.attach(new m(null));return new w({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var n=l?{port1:l,port2:void 0}:new d,i=n.port1,s=n.port2,o=!1;E.attach({dispose:function(){i.close()}});var a=!1,c=function(e){var t=e.data;if(a||!t||"object"!=typeof t||"identify-parent"!==t.type||t.channelId!==r);else{S.off(h,"message",c);var n=e.source,i=s;if(!l&&o){var f=new d,v=f.port1;i=f.port2;S.on(v,"message",p.bind(null,v));v.start()}o=!0;var m={type:"initialize",channelId:r,replyTo:i};n.postMessage(m,u,i?[i]:void 0);a=!0}},p=function(n,r){var i=r.data;if(i&&"object"==typeof i&&"activate"===i.type){S.dispose();e(n)}else t(new Error("Unexpected message during messenger initialization"));S.off(h,"message",c)};S.on(i,"message",p.bind(null,i));i.start();var v={type:"initialize",channelId:r,replyTo:s};if(l){o=!0;l.postMessage(v,[s])}else if(f){o=!0;f.postMessage(v,u,[s]);S.on(h,"message",c)}},initResources:E,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs})})(e,t);var n=b(e),r=n.channelId,o=n.origin,u=void 0===o?location.origin:o,a=n.host,f=void 0===a?window.parent!==window&&window.parent||window.opener:a,l=n.overridePort,c=n.receiver,h=void 0===c?window:c,p=t.channelType,d=void 0===p?MessageChannel:p,v=t.eventGroupType,m=void 0===v?s:v,y=t.messengerType,w=void 0===y?g:y,E=new i.e,S=E.attach(new m(null));return new w({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var n=l?{port1:l,port2:void 0}:new d,i=n.port1,s=n.port2;E.attach({dispose:function(){i.close()}});S.on(i,"message",function(n){var r=n.data;if(r&&"object"==typeof r&&"activate"===r.type){S.dispose();e(i)}else t(new Error("Unexpected message during messenger initialization"))});i.start();var o={type:"initialize",channelId:r,replyTo:s};if(l)l.postMessage(o,[s]);else if(f)f.postMessage(o,u,[s]);else{var a=function(e){var t=e.data;if(t&&"object"==typeof t&&"identify-parent"===t.type&&t.channelId===r){S.off(h,"message",a);e.source.postMessage(o,u,[s])}else;};S.on(h,"message",a)}},initResources:E,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}var E,S=(function(){function e(){this._commandHandlers=[];this._notificationHandlers=[]}Object.defineProperty(e.prototype,"ready",{get:function(){return this._messenger.ready},enumerable:!1,configurable:!0});e.prototype.sendCommand=function(e,t){return this._messenger.sendCommand(e,t)};e.prototype.sendNotification=function(e){return this._messenger.sendNotification(e)};e.prototype.addCommandHandler=function(e){var t=this;this._commandHandlers.push(e);return{dispose:function(){var n=t._commandHandlers.indexOf(e);n>-1&&t._commandHandlers.splice(n,1)}}};e.prototype.addNotificationHandler=function(e){var t=this;this._notificationHandlers.push(e);return{dispose:function(){var n=t._notificationHandlers.indexOf(e);n>-1&&t._notificationHandlers.splice(n,1)}}};e.prototype.dispose=function(){this._messenger.dispose()};e.prototype._onCommand=function(e){for(var t=0,n=this._commandHandlers;t<n.length;t++){var r=(0,n[t])(e);if(r)return r}};e.prototype._onNotificiation=function(e){for(var t=0,n=this._notificationHandlers;t<n.length;t++){(0,n[t])(e)}};return e})(),x=n(6);(function(e){e.ScriptLoaded="share_scriptsLoaded";e.CopyLinkClicked="share_copyLinkClicked";e.ShareReady="share_ready";e.ShareDismiss="share_dismiss";e.ShareSendClicked="share_sendClicked";e.ShareManageAccessClicked="share_manageAccessClicked";e.ShareUIReady="share_uiReady";e.SharePageError="share_error";e.ShareCompleted="share_completed";e.ShareOutlookClicked="share_outlookClicked";e.ShareTeamsClickedWithContext="share_teamsClickedWithContext";e.ShareAddPeopleCompleted="share_addPeopleCompleted";e.ShareReadyForRecipients="share_readyForRecipients";e.GrantAccessCompleted="share_grantAccessCompleted";e.PeoplePickerFocused="share_peoplePickerFocused";e.ShareInstantLoad="share_instantLoadReady";e.ShareStarted="share_started"})(E||(E={}));var T=(function(e){Object(r.r)(t,e);function t(t){var n=this,i=t.initTimeoutMs,s=void 0===i?4e4:i,o=t.overridePort,u=Object(r.s)(t,["initTimeoutMs","overridePort"]);(n=e.call(this)||this)._isPageLoaded=!1;n._customerPromiseLogger=u.customerPromiseLogger;n._messenger=w(Object(r.e)(Object(r.e)({},u),{initTimeoutMs:s,overridePort:o,onCommand:n._onCommand.bind(n),onNotification:n._onNotificiation.bind(n)}));return n}t.prototype.sendScriptLoaded=function(){return this._send({command:"shareCommand",name:E.ScriptLoaded})};t.prototype.sendCopyLinkShareTargetClicked=function(){return this._send({command:"shareCommand",name:E.CopyLinkClicked})};t.prototype.sendShareReady=function(){if(this._isPageLoaded)return this._send({command:"shareCommand",name:E.ShareInstantLoad});this._isPageLoaded=!0;return this._send({command:"shareCommand",name:E.ShareReady})};t.prototype.sendShareStarted=function(){return this._send({command:"shareCommand",name:E.ShareStarted})};t.prototype.sendDismiss=function(){return this._send({command:"shareCommand",name:E.ShareDismiss})};t.prototype.sendShareSendClicked=function(){return this._send({command:"shareCommand",name:E.ShareSendClicked})};t.prototype.sendShareManageAccessClicked=function(){return this._send({command:"shareCommand",name:E.ShareManageAccessClicked})};t.prototype.sendShareUIReady=function(){return this._send({command:"shareCommand",name:E.ShareUIReady})};t.prototype.sendShareError=function(e){var t,n,r,i,s={command:"shareCommand",name:E.SharePageError,error:(null===(t=e.error)||void 0===t?void 0:t.toString())||"",errorCategory:(null===(n=e.errorCategory)||void 0===n?void 0:n.toString())||"",errorMessage:(null===(r=e.errorMessage)||void 0===r?void 0:r.toString())||"",debugErrorMessage:(null===(i=e.debugErrorMessage)||void 0===i?void 0:i.toString())||""};return this._send(s)};t.prototype.sendShareCompleted=function(){return this._send({command:"shareCommand",name:E.ShareCompleted})};t.prototype.sendOutlookClicked=function(){return this._send({command:"shareCommand",name:E.ShareOutlookClicked})};t.prototype.sendTeamsClicked=function(e,t,n){var r={command:"shareCommand",name:E.ShareTeamsClickedWithContext,sharingLink:e.url,recipients:t,numRecipients:t?t.length:0,body:n};return this._send(r)};t.prototype.sendShareAddPeopleCompleted=function(e,t){void 0===t&&(t="");var n={command:"shareCommand",name:E.ShareAddPeopleCompleted,successful:e,completionMessage:t};return this._send(n)};t.prototype.sendShareReadyForRecipients=function(){return this._send({command:"shareCommand",name:E.ShareReadyForRecipients})};t.prototype.sendGrantAccessCompleted=function(e){var t={command:"shareCommand",name:E.GrantAccessCompleted,successful:e};return this._send(t)};t.prototype.sendPeoplePickerFocused=function(){return this._send({command:"shareCommand",name:E.PeoplePickerFocused})};t.prototype.sendResize=function(e){var t=e;t.command="shareCommand";return this._send(t)};t.prototype._send=function(e){var t=this;0;return this._messenger.sendCommand(e).then(function(e){return!!e}).catch(function(n){var r;null===(r=t._customerPromiseLogger)||void 0===r||r.end({resultType:x.t.Failure,errorCode:"SharingClientMessenger - send ".concat(e.name," failed"),extraData:{errorMessage:n.toString()}});return!1})};return t})(S)},,function(e,t,n){"use strict";var r=n(0),i=n(41),s=n(95),o=(function(){function e(){this._localHandlers=[]}e.init=function(){var e=this;if(!this._initialized){this._initialized=!0;this._originalBeforeUnload=window.onbeforeunload;window.onbeforeunload=window.__onbeforeunload=function(t){return e._handleBeforeUnload(t)}}};e.registerHandler=function(e){this._handlers.push(e)};e.unRegisterHandler=function(e){for(var t=0;t<this._handlers.length;t++)if(this._handlers[t]===e){this._handlers.splice(t,1);break}};e.dispose=function(){this._originalBeforeUnload?window.onbeforeunload=this._originalBeforeUnload:window.onbeforeunload=null};e._handleBeforeUnload=function(e){var t=void 0;if(!this._allowNavs){for(var n=0;n<this._handlers.length;n++)try{if(t=this._handlers[n](!0))break}catch(e){i.e.log(e)}if(!t&&this._originalBeforeUnload)try{t=this._originalBeforeUnload(e)}catch(e){i.e.log(e)}}return t||void 0};e.prototype.registerHashNavDialogCallback=function(e){this._hashNavDialogCallback=e};e.prototype.registerHashNavDialogHandler=function(e){if(this._hashNavDialogHandler)throw Error("Registering HashNavDialogHandler when one is already set");this._hashNavDialogHandler=e};e.prototype.unregisterHashNavDialogHandler=function(){this._hashNavDialogHandler=void 0};e.prototype.allowHashNav=function(t,n){var r=void 0;if(!e._isDialogOpen&&!e._allowNavs){for(var s=0;s<e._handlers.length;s++)try{if(r=e._handlers[s](!1))break}catch(e){i.e.log(e)}if(r){e._isDialogOpen=!0;this._hashNavDialogCallback(r).then(function(){e._isDialogOpen=!1;e._allowNavs=!0;e._blockNavsAgainId||(e._blockNavsAgainId=e._async.setImmediate(function(){e._allowNavs=!1;e._blockNavsAgainId=null}));t&&t()},function(){e._isDialogOpen=!1;n&&n()})}}return!r&&!e._isDialogOpen};e.prototype.blockHashNav=function(t,n){var r=this,s=null;if(this._dialogWasJustDismissed){this._dialogWasJustDismissed=!1;return!1}for(var o=0;o<e._handlers.length;o++)try{if(s=e._handlers[o](!1))break}catch(e){i.e.log(e)}if(s&&this._hashNavDialogHandler){this._hashNavDialogHandler(s,function(){r._dialogWasJustDismissed=!0;t()},n);return!0}return!1};e.prototype.registerHandler=function(t){this._localHandlers.push(t);e.registerHandler(t)};e.prototype.unRegisterHandler=function(t){for(var n=0;n<this._localHandlers.length;n++)if(this._localHandlers[n]===t){this._localHandlers.splice(n,1);break}e.unRegisterHandler(t)};e.prototype.dispose=function(){for(var t=0,n=this._localHandlers;t<n.length;t++){var r=n[t];e.unRegisterHandler(r)}};e._handlers=[];e._async=new s.e;e._initialized=!1;return e})(),u=o;o.init();var a=n(66),f=n(152),l=n(367),c=n(120),h=n(157),p=n(9);p.e.isActivated("A5E9FB38-28CC-4286-BC7C-F5ABDBF86D04","05/16/2022","Freeze view params on Navigation");function d(e){var t=null==e?void 0:e.event,n=!1,r="";if(location.href.indexOf("#")>-1){r=location.hash.substr(1);n=!0}else location.search.length&&(r=location.search.substr(1));var i=(function(e){var t="";if(e&&"popstate"===e.type&&e.state){var n=e.state,r=n.useViewParamsFromState,i=n.viewParams;r&&i&&(t=(function(e){return"string"==typeof e?e:Object(l.e)(e)})(i))}return t})(t),s=Object(f.e)(r),o=Object(f.e)(i),u=o,a=i;for(var c in s)if(o[c]!==s[c]){u=s;a=r;break}0;return{viewParams:u,viewParamsString:a,usingHashParams:n}}var v=window.history,m=window.applicationCache,g=new h.e,y=!p.e.isActivated("DE394832-0B5E-447E-B070-CFB40B970AFE","3/16/2022","Enables hashNav Dialog warnings when registered"),b=!p.e.isActivated("02FA94A5-6D40-4824-8498-54B27DDC5B87","06/30/2022","Adds support for `ignoreHistory` when doing a non-hash redirect (ex: external links)"),w=p.e.isActivated("125b1224-9f61-40e6-88c7-a51f926cb844","01/04/2023","Fix navigation when event listener is disabled"),E=(function(){function e(e){void 0===e&&(e={});this._viewParamsString="";this._dontBlockNextNav=!1;var t=e.disableHashConversion,n=void 0!==t&&t,r=e.disableNavigationEventListeners,i=void 0!==r&&r,s=e.shouldReloadOnNavigate,o=e.history;this._overrideHistory=o;this._shouldReloadOnNavigate=s;this._performHashConversion=!n;this._disableNavigationEventListeners=e.disableNavigationEventListeners;this._viewParams={};this.scope=new c.e;this._prevHash=location.hash;this._supportsHistoryApi=v&&!!v.pushState&&(!m||m.status===m.UNCACHED);this.beforeUnload=new u;this.scope.attach(this.beforeUnload);this._events=this.scope.attach(new a.t(this));this._events.declare("change");i||this.setNavEventListeners("on");this._updateUrlState()}Object.defineProperty(e.prototype,"_history",{get:function(){return!p.e.isActivated("9F9AACD8-1519-4526-A4C1-9C8CEDF1B614","7/28/2020","Use hostNavigation functions from bootOptions")&&this._overrideHistory?this._overrideHistory:history},enumerable:!1,configurable:!0});e.prototype.dispose=function(){this.setNavEventListeners("off");this.scope.dispose()};Object.defineProperty(e.prototype,"viewParams",{get:function(){return this._viewParams},enumerable:!1,configurable:!0});e.prototype.navigateTo=function(e){var t=this;if(y||this.beforeUnload.allowHashNav(function(){return t.navigateTo(e)})){var n="string"==typeof e?{url:e}:e,r=n.url,i=e.hasOwnProperty("viewParams")?e.viewParams:void 0,s=e.hasOwnProperty("directOpen")?e.directOpen:void 0,o=void 0,u=void 0;if(i&&"#"===i[0]){o=i.substr(1);u=r}else{o="#"===r[0]?r.substr(1):void 0;u=void 0}!p.e.isActivated("be269450-17b2-433b-8e52-301446d68521","10/19/2021","Open PWA navigations inside new tab except empty hash urls")&&void 0===n.frameId&&g.isPWA&&"#"!==r&&(n.frameId="_blank");if(o)n.ignoreHistory?this._replaceState(o,!1,u):this._pushState(o,u);else{var a=void 0,f=!1;if(n&&n.frameId&&"_self"!==n.frameId)try{(a=window.open(s?r:"",n.frameId))&&"_blank"===n.frameId&&(a.opener=null);a&&!s&&(!w&&this._disableNavigationEventListeners&&"#"===r?this.updateViewParams("",{ignoreHistory:n.ignoreHistory,clearOtherParams:!0}):a.location.href=r);f=!0}catch(e){}if(!a&&!f)try{b&&n.ignoreHistory?window.location.replace(r):window.location.href=r}catch(e){}}}};e.prototype.updateViewParams=function(e,t){void 0===t&&(t={});var n="string"==typeof e?Object(f.e)(e):e,i=Object(r.e)(Object(r.e)({},t.clearOtherParams?{}:this._viewParams),n);t.ignoreHistory?this._replaceState(i,t.clearPath):this._pushState(i)};e.prototype.updateViewParamsWithoutHistoryChange=function(e){var t={type:"popstate",state:{viewParams:e,useViewParamsFromState:!0}};this._updateUrlState(t)};e.prototype.reload=function(){window.location.reload()};e.prototype.setNavEventListeners=function(e){var t=("on"===e?this._events.on:this._events.off).bind(this._events);t(window,"hashchange",this._updateUrlState);t(window,"popstate",this._updateUrlState)};e.prototype._updateUrlState=function(e){var t=this,n=!1,r=window.document.location;if(y?!this.beforeUnload.blockHashNav(function(){return t._updateUrlState(e)},function(){return t._resetBeforeNavBlock()}):this._dontBlockNextNav||this.beforeUnload.allowHashNav(function(){return t._updateUrlState(e)},function(){return t._resetBeforeNavBlock()})){this._dontBlockNextNav=!1;var i=d({event:e}),s=i.viewParams,o=i.usingHashParams,u=i.viewParamsString;if(u!==this._viewParamsString){this._viewParamsString=u||"";this._viewParams=s;n=!0}e&&this._shouldReloadOnNavigate&&this._shouldReloadOnNavigate()&&window.location.reload();o&&this._performHashConversion&&this._supportsHistoryApi&&this._replaceState(u);n&&this._events.raise("change");this._prevHash=r.hash}else{n=!1;e&&e.preventDefault()}return n};e.prototype._resetBeforeNavBlock=function(){this._dontBlockNextNav=!0;if(this._supportsHistoryApi)try{history.forward()}catch(e){this._hashNav(this._prevHash)}else this._hashNav(this._prevHash)};e.prototype._pushState=function(e,t){var n=this._getViewParamsString(e);if(this._supportsHistoryApi)try{var r=this._getStateUrl(n);this._history.pushState({},"",r)}catch(e){this._hashNav(n)}else this._hashNav(n);this._updateUrlState();t&&this._setMaskUrl(t)};e.prototype._replaceState=function(e,t,n){var r=this._getViewParamsString(e);if(this._supportsHistoryApi)try{var i=this._getStateUrl(r,t);this._history.replaceState({},"",i)}catch(e){p.e.isActivated("EFD3C5E0-8069-451E-AF1F-24826B3D117C","8/18/2021","Fix infinite loop on nav when history replaceState fails")||(this._supportsHistoryApi=!1);this._hashNav(r)}else this._hashNav(r);this._updateUrlState();n&&this._setMaskUrl(n)};e.prototype._setMaskUrl=function(e){if(e&&this._supportsHistoryApi){var t={useViewParamsFromState:!0,viewParams:this._viewParams};this._history.replaceState(t,"",e)}};e.prototype._getViewParamsString=function(e){return"string"==typeof e?e:Object(l.e)(e)};e.prototype._getStateUrl=function(e,t){var n=t?"/":document.location.pathname;return"".concat(n).concat(e.length>0?"?":"").concat(e)};e.prototype._hashNav=function(e){document.location.hash=e};return e})();t.e=E},function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n(82),s=n(189),o=n(13);var u=n(42),a=n(27),f=n(77),l=n(9),c=n(28),h=n(52),p=(function(){function e(e,t){this._pageContext=t.pageContext;this._usePPEHost="true"===this._getUrlQueryParam("usePPE");this._suiteNavContext=e.suiteNavContext;this._capabilities=e.suiteNavCapabilities?e.suiteNavCapabilities:{supportsCaching:!0,supportsRealSuiteNav:!0,showO365Text:!0,disableSecondaryUserPhotoProvider:!1,collapseO365Settings:!1,enableDelayLoading:!1}}e.prototype.getCapabilities=function(){return this._capabilities};e.prototype.getReactShellBootstrapperUrl=function(){return this._usePPEHost?"https://shellppe.msocdn.com/api/shellbootstrapper/business/oneshell":"https://shellprod.msocdn.com/api/shellbootstrapper/business/oneshell"};e.prototype.getInitialRenderNavBarData=function(){return{WorkloadId:this._suiteNavContext.workloadId,CurrentMainLinkElementID:this._suiteNavContext.currentMainLinkElementID,UserID:this._parseUserID(this._pageContext.systemUserKey),UserDisplayName:this._pageContext.isSPO&&this._pageContext.isAnonymousGuestUser?void 0:this._pageContext.userDisplayName,ShellBootHost:this._usePPEHost?"https://shellppe.msocdn.com":"https://shellprod.msocdn.com",IsConsumer:!!this._suiteNavContext.isConsumer,Culture:u.e.escapeUrlForCallback(this._pageContext.currentUICultureName),IsRtl:h.e.isRightToLeft,AppBrandTheme:d(this._suiteNavContext),Language:this._pageContext.currentLanguage.toString()}};e.prototype.getCacheToken=function(){var e=this._pageContext.siteClientTag;return"string"==typeof e?e.substring(0,e.indexOf("$$")):""};e.prototype.getUserIdentifier=function(){return this._pageContext.systemUserKey};e.prototype._getUrlQueryParam=function(e){try{return new c.e(window.location.href).getQueryParameter(e)}catch(e){}};e.prototype._parseUserID=function(e){if(e){var t=e.lastIndexOf("|");return e.substring(t+1,e.indexOf("@",t))}return""};return e})();function d(e){var t={Primary:f.n?"#0078D4":"#03787c"};return e.appBrandTheme?e.appBrandTheme:t}var v=n(148),m=n(119),g=n(112);var y={ODB:60222,ODC:null,Fallback:!1},b=(function(e){Object(r.r)(t,e);function t(n,r){var i=e.call(this,{dataSourceName:"SuiteNavDataSource"},r)||this;i._suiteNavContext=n.suiteNavContext;i._suiteNavDataUpdater=n.suiteNavDataUpdater;i._suiteNavDataSourceBasic=n.suiteNavDataSourceBasic?n.suiteNavDataSourceBasic:new p(n,r);i._prefetchCache=r.prefetchCache;if(i._useDeadTabDetection()){i._signInTimeAtPageLoad=t._getSignInTime();window.addEventListener("focus",function(){if("undefined"!=typeof MastInteraction&&MastInteraction.ShowPrompt){var e=t._getSignInTime();if(e&&e>i._signInTimeAtPageLoad){MastInteraction.SignOutPage();MastInteraction.ShowPrompt("SwitchAccount")}}})}return i}t.prototype.getCapabilities=function(){return this._suiteNavDataSourceBasic.getCapabilities()};t.prototype.getReactShellBootstrapperUrl=function(){return this._suiteNavDataSourceBasic.getReactShellBootstrapperUrl()};t.prototype.getInitialRenderNavBarData=function(){return this._suiteNavDataSourceBasic.getInitialRenderNavBarData()};t.prototype.getCacheToken=function(){return this._suiteNavDataSourceBasic.getCacheToken()};t.prototype.getUserIdentifier=function(){return this._suiteNavDataSourceBasic.getUserIdentifier()};t.prototype.getWebTemplateType=function(){var e;return Number((null===(e=this._pageContext)||void 0===e?void 0:e.webTemplate)||g.t.invalid)};t.prototype.setFeedbackMetadata=function(e,t){var r,i,s=this,o=this._suiteNavContext.feedbackOptions;if(o&&o.appId){e=e||{contentLanguage:void 0,source:"OneShell",options:{telemetryGroup:{}}};var u=a.e.isFeatureEnabled({ODB:f.n?-1246:1246,ODC:null,Fallback:!1});!l.t.isActivated("88d7a955-6ccc-4b35-b8ff-342a6bb08f3b","9/27/2021","Add Lists Freemium feature area")&&this._pageContext.isSiteListsHost&&(u=!0);if(/\/_layouts\/15\/stream.aspx$/i.test(window.location.pathname)){l.t.isActivated("6758b12a-64ed-4d1e-86cd-bab1b01c14a8","10/22/2021","Enables screenshot UX for stream.aspx")||u||(u=!0);if(!l.t.isActivated("445049c8-5a35-42f6-83d3-d9aeffc41d42","07/21/2022","Set sourcePageName for Stream.aspx")){var c=null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.webGroup,h=new URLSearchParams(document.location.search).get("action");e.options.webGroup={browser:null==c?void 0:c.browser,browserVersion:null==c?void 0:c.browserVersion,sourcePageName:"action=".concat(h),sourcePageURI:null==c?void 0:c.sourcePageURI}}}/\/_layouts\/15\/videoeditor.aspx$/i.test(window.location.pathname)&&(u||(u=!0));var p=e.options;p.appId=o.appId;p.disableIncludeScreenshot=!u;p.userVoiceEnabled=o.userVoiceEnabled;p.userVoiceLink=o.userVoiceLink;if(!l.t.isActivated("A12253B9-7F27-4C11-BFC9-3E7688B5CE1E","9/14/20","Ensure appData in feedback options")){p.applicationGroup||(p.applicationGroup={});p.applicationGroup.appData||(p.applicationGroup.appData="{}")}var d=p.telemetryGroup;d.audienceGroup=this._getAudienceGroup();d.featureArea=this._getFeatureArea(null===(i=o.telemetryGroup)||void 0===i?void 0:i.featureArea);d.processSessionId=this._pageContext.CorrelationId;u&&t&&n.ee([31],762,7).then(function(e){var n=e.default||e;if(!l.t.isActivated("88d7a955-6ccc-4b35-b8ff-342a6bb08f3b","9/27/2021","Add Lists Freemium feature area")&&s._pageContext.isSiteListsHost){var r=document.body;try{window.frames.length>0&&(r=window.frames[0].document.body)}catch(e){}n(r).then(function(e){t(e.toDataURL("image/jpeg"))})}else n(document.body).then(function(e){t(e.toDataURL("image/jpeg"))})})}return e};t.prototype.loadData=function(e){var t=this;if(!e&&this._dataPromise)return this._dataPromise;var n,r=u.e.escapeUrlForCallback(this._pageContext.currentUICultureName),s=Object(i.e)(this._pageContext),o=s?u.e.escapeUrlForCallback(s):"",a=(function(e){var t=e.baseUrl,n=e.cultureName;return"".concat(t,"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?Locale=").concat(n,"&v=2&msajax=1&cv=2")})({baseUrl:o,cultureName:r}),f="".concat(o,"/_api/Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData?v=2&Locale=").concat(r),l=function(e){var n={suiteNavData:e.NavBarData,suiteNavContext:t._suiteNavContext,pageContext:t._pageContext},r=t._suiteNavDataUpdater?t._suiteNavDataUpdater.updateSuiteNavData(n):e.NavBarData,i=!(!r.HasTenantBranding||!e.TenantPrimaryColorShades&&!r.TenantLogoUrl);r.AppBrandTheme=d(t._suiteNavContext);return{data:r,jsUrl:e.JsUrl,cssUrl:e.CssUrl,hasCobranding:i,userIdentifier:t.getUserIdentifier(),cacheToken:t.getCacheToken()}},c=function(e){return t.getData(function(){return e},function(e){return JSON.parse(e)},"LoadData",null,"POST",null,null,1).then(function(t){var n=e===a?t:JSON.parse(t.d.GetSuiteNavData);return l(n)})},h=function(){return c(a).catch(function(){return c(f)})};if(this._pageContext.isSPO){var p=!1;if(this._prefetchCache){var v=this._prefetchCache.getData({url:a,body:"",qosName:"SpoSuiteLinks"});if(v){n=v.then(l,h);p=!0}}p||(n=h())}else n=c(f);this._dataPromise=n;n.catch(function(){t._dataPromise=null});return n};t.prototype.getSuiteNavContext=function(){return this._suiteNavContext};t.prototype.onCssLoad=function(e){if(e.data&&e.data.ClientData)try{var t=JSON.parse(e.data.ClientData);t&&t.IsFallbackShell&&Object(o.t)(".o365cs-base .o365cs-nav-contextMenu {    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base-visibility{  visibility: visible;}\n.o365cs-base .ms-fcl-tdr,.o365cs-base .ms-fcl-tdr-h:hover,.o365cs-base .ms-fcl-tdr-f:focus{    color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bgc-tdr,.o365cs-base .ms-bgc-tdr-h:hover,.o365cs-base .ms-bgc-tdr-f:focus{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bcl-tdr,.o365cs-base .ms-bcl-tdr-h:hover,.o365cs-base .ms-bcl-tdr-f:focus{    border-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-fcl-td,.o365cs-base .ms-fcl-td-h:hover,.o365cs-base .ms-fcl-td-f:focus{    color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bgc-td,.o365cs-base .ms-bgc-td-h:hover,.o365cs-base .ms-bgc-td-f:focus{    background-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bcl-td,.o365cs-base .ms-bcl-td-h:hover,.o365cs-base .ms-bcl-td-f:focus{    border-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-fcl-tda,.o365cs-base .ms-fcl-tda-h:hover,.o365cs-base .ms-fcl-tda-f:focus{    color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bgc-tda,.o365cs-base .ms-bgc-tda-h:hover,.o365cs-base .ms-bgc-tda-f:focus{    background-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bcl-tda,.o365cs-base .ms-bcl-tda-h:hover,.o365cs-base .ms-bcl-tda-f:focus{    border-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-fcl-tp,.o365cs-base .ms-fcl-tp-h:hover,.o365cs-base .ms-fcl-tp-f:focus{    color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bgc-tp,.o365cs-base .ms-bgc-tp-h:hover,.o365cs-base .ms-bgc-tp-f:focus,.o365cs-base.ms-bgc-tp{    background-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bcl-tp,.o365cs-base .ms-bcl-tp-h:hover,.o365cs-base .ms-bcl-tp-f:focus{    border-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-fcl-ts,.o365cs-base .ms-fcl-ts-h:hover,.o365cs-base .ms-fcl-ts-f:focus{    color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bgc-ts,.o365cs-base .ms-bgc-ts-h:hover,.o365cs-base .ms-bgc-ts-f:focus{    background-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bcl-ts,.o365cs-base .ms-bcl-ts-h:hover,.o365cs-base .ms-bcl-ts-f:focus{    border-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-fcl-tt,.o365cs-base .ms-fcl-tt-h:hover,.o365cs-base .ms-fcl-tt-f:focus{    color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bgc-tt,.o365cs-base .ms-bgc-tt-h:hover,.o365cs-base .ms-bgc-tt-f:focus{    background-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bcl-tt,.o365cs-base .ms-bcl-tt-h:hover,.o365cs-base .ms-bcl-tt-f:focus{    border-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-fcl-tl,.o365cs-base .ms-fcl-tl-h:hover,.o365cs-base .ms-fcl-tl-f:focus{    color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bgc-tl,.o365cs-base .ms-bgc-tl-h:hover,.o365cs-base .ms-bgc-tl-f:focus{    background-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bcl-tl,.o365cs-base .ms-bcl-tl-h:hover,.o365cs-base .ms-bcl-tl-f:focus{    border-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-fcl-tlr,.o365cs-base .ms-fcl-tlr-h:hover,.o365cs-base .ms-fcl-tlr-f:focus{    color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bgc-tlr,.o365cs-base .ms-bgc-tlr-h:hover,.o365cs-base .ms-bgc-tlr-f:focus{    background-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bcl-tlr,.o365cs-base .ms-bcl-tlr-h:hover,.o365cs-base .ms-bcl-tlr-f:focus{    border-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-fcl-tlra,.o365cs-base .ms-fcl-tlra-h:hover,.o365cs-base .ms-fcl-tlra-f:focus{    color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bgc-tlra,.o365cs-base .ms-bgc-tlra-h:hover,.o365cs-base .ms-bgc-tlra-f:focus{    background-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bcl-tlra,.o365cs-base .ms-bcl-tlra-h:hover,.o365cs-base .ms-bcl-tlra-f:focus{    border-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-fcl-w,.o365cs-base .ms-fcl-w-h:hover,.o365cs-base .ms-fcl-w-f:focus{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bgc-w,.o365cs-base .ms-bgc-w-h:hover,.o365cs-base .ms-bgc-w-f:focus,.o365cs-base.ms-bgc-w{    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bcl-w,.o365cs-base .ms-bcl-w-h:hover,.o365cs-base .ms-bcl-w-f:focus{    border-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-fcl-b,.o365cs-base .ms-fcl-b-h:hover,.o365cs-base .ms-fcl-b-f:focus{    color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-b.o365cs-nav-closeButton{    color: #000000;}\n.o365cs-base .ms-bgc-b,.o365cs-base .ms-bgc-b-h:hover,.o365cs-base .ms-bgc-b-f:focus,.o365cs-base.ms-bgc-b{    background-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-bcl-b,.o365cs-base .ms-bcl-b-h:hover,.o365cs-base .ms-bcl-b-f:focus{    border-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-nd,.o365cs-base .ms-fcl-nd-h:hover,.o365cs-base .ms-fcl-nd-f:focus{    color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bgc-nd,.o365cs-base .ms-bgc-nd-h:hover,.o365cs-base .ms-bgc-nd-f:focus{    background-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bcl-nd,.o365cs-base .ms-bcl-nd-h:hover,.o365cs-base .ms-bcl-nd-f:focus{    border-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-fcl-np,.o365cs-base .ms-fcl-np-h:hover,.o365cs-base .ms-fcl-np-f:focus{    color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bgc-np,.o365cs-base .ms-bgc-np-h:hover,.o365cs-base .ms-bgc-np-f:focus{    background-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bcl-np,.o365cs-base .ms-bcl-np-h:hover,.o365cs-base .ms-bcl-np-f:focus{    border-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-fcl-ns,.o365cs-base .ms-fcl-ns-h:hover,.o365cs-base .ms-fcl-ns-f:focus{    color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-ns.o365cs-nav-moduleLabel{    color: #666666;}\n.o365cs-base .ms-bgc-ns,.o365cs-base .ms-bgc-ns-h:hover,.o365cs-base .ms-bgc-ns-f:focus{    background-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-bcl-ns,.o365cs-base .ms-bcl-ns-h:hover,.o365cs-base .ms-bcl-ns-f:focus{    border-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-nsa,.o365cs-base .ms-fcl-nsa-h:hover,.o365cs-base .ms-fcl-nsa-f:focus{    color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bgc-nsa,.o365cs-base .ms-bgc-nsa-h:hover,.o365cs-base .ms-bgc-nsa-f:focus{    background-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bcl-nsa,.o365cs-base .ms-bcl-nsa-h:hover,.o365cs-base .ms-bcl-nsa-f:focus{    border-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-fcl-nt,.o365cs-base .ms-fcl-nt-h:hover,.o365cs-base .ms-fcl-nt-f:focus{    color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bgc-nt,.o365cs-base .ms-bgc-nt-h:hover,.o365cs-base .ms-bgc-nt-f:focus{    background-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bcl-nt,.o365cs-base .ms-bcl-nt-h:hover,.o365cs-base .ms-bcl-nt-f:focus{    border-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-fcl-nta,.o365cs-base .ms-fcl-nta-h:hover,.o365cs-base .ms-fcl-nta-f:focus{    color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bgc-nta,.o365cs-base .ms-bgc-nta-h:hover,.o365cs-base .ms-bgc-nta-f:focus{    background-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bcl-nta,.o365cs-base .ms-bcl-nta-h:hover,.o365cs-base .ms-bcl-nta-f:focus{    border-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-fcl-nl,.o365cs-base .ms-fcl-nl-h:hover,.o365cs-base .ms-fcl-nl-f:focus{    color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bgc-nl,.o365cs-base .ms-bgc-nl-h:hover,.o365cs-base .ms-bgc-nl-f:focus{    background-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bcl-nl,.o365cs-base .ms-bcl-nl-h:hover,.o365cs-base .ms-bcl-nl-f:focus{    border-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-fcl-nlr,.o365cs-base .ms-fcl-nlr-h:hover,.o365cs-base .ms-fcl-nlr-f:focus{    color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bgc-nlr,.o365cs-base .ms-bgc-nlr-h:hover,.o365cs-base .ms-bgc-nlr-f:focus,.o365cs-base.ms-bgc-nlr{    background-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bcl-nlr,.o365cs-base .ms-bcl-nlr-h:hover,.o365cs-base .ms-bcl-nlr-f:focus{    border-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-fcl-nlra,.o365cs-base .ms-fcl-nlra-h:hover,.o365cs-base .ms-fcl-nlra-f:focus{    color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bgc-nlra,.o365cs-base .ms-bgc-nlra-h:hover,.o365cs-base .ms-bgc-nlra-f:focus,.o365cs-base.ms-bgc-nlra{    background-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bcl-nlra,.o365cs-base .ms-bcl-nlra-h:hover,.o365cs-base .ms-bcl-nlra-f:focus{    border-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .o365cs-topnavLinkBackground-2{    background-color: transparent;}\n.o365cs-base .o365cs-topnavText,.o365cs-base .o365cs-topnavText:hover{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base .o365cs-appLauncherBackground{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-nav-header16 .o365cs-navMenuButton{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .o365cs-navMenuButton{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base.o365cs-topnavBGImage{    background-position: center top;    background-repeat: repeat-x;    background-image: none;}\n.o365cs-base.o365cs-topnavBGColor-2{    background-color: '[theme:suiteBarBackground, default:#000000]';}\n")}catch(e){}};t.prototype.updateDataForCurrentPage=function(e){if(!this._suiteNavDataUpdater)return e;var t={suiteNavData:e,suiteNavContext:this._suiteNavContext,pageContext:this._pageContext};return this._suiteNavDataUpdater.updateSuiteNavData(t)};t.prototype._getAudienceGroup=function(){var e,t=this._pageContext;"prodbubble"===t.env&&"MSIT_SPDF_1_Content"===t.farmLabel?e="Dogfood":"prodbubble"===t.env?e="Microsoft":("prod"===t.env||"dprod"===t.env||!l.t.isActivated("88d7a955-6ccc-4b35-b8ff-342a6bb08f3b","9/27/2021","Add Lists Freemium feature area")&&t.isSiteListsHost)&&(e="Production");return e};t.prototype._getFeatureArea=function(e){if(!l.t.isActivated("a00248de-2fc2-41a8-8671-f8fec416a811","10/22/2021","Allow apps to provide own feature area")&&e)return e;var t=this._pageContext;return e=!l.t.isActivated("88d7a955-6ccc-4b35-b8ff-342a6bb08f3b","9/27/2021","Add Lists Freemium feature area")&&t.isSiteListsHost?"Lists Freemium":t.listBaseTemplate===m.t.genericList?"List":t.listBaseTemplate===m.t.documentLibrary?"Libraries":t.listBaseTemplate===m.t.webPageLibrary?"Modern Pages and News Authoring (Floodgate)":a.e.isFeatureEnabled({ODB:1120,ODC:null,Fallback:!1})&&this.getWebTemplateType()===g.t.contentCenter?"Syntex In-product Feedback":"Site"};t.prototype._useDeadTabDetection=function(){return!l.t.isActivated("8FE233B6-3394-4918-A449-B5808E8B40BD","9/8/21","Dead tab detection")&&a.e.isFeatureEnabled(y)};t._getCookieValue=function(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return(null==t?void 0:t.pop())||""};t._getSignInTime=function(){var e=t._getCookieValue("SIMI");return e?Number(JSON.parse(atob(e)).st):0};t.siteSettingsPermissions=[s.e.enumeratePermissions,s.e.manageWeb,s.e.manageSubwebs,s.e.addAndCustomizePages,s.e.applyThemeAndBorder,s.e.manageAlerts,s.e.manageLists,s.e.viewUsageData];return t})(v.e)},function(e,t,n){"use strict";n.r(t);var r,i=n(82),s=n(112),o=n(122),u=n(68),a=n(53),f=[.537,.349,.216,.184,.145,.082,.043,.027],l=[.537,.45,.349,.216,.184,.145,.082,.043],c=[.88,.77,.66,.55,.44,.33,.22,.11],h=[.11,.22,.33,.44,.55,.66,.77,.88],p=[.96,.84,.7,.4,.12],d=[.1,.24,.44];(function(e){e[e.Unshaded=0]="Unshaded";e[e.Shade1=1]="Shade1";e[e.Shade2=2]="Shade2";e[e.Shade3=3]="Shade3";e[e.Shade4=4]="Shade4";e[e.Shade5=5]="Shade5";e[e.Shade6=6]="Shade6";e[e.Shade7=7]="Shade7";e[e.Shade8=8]="Shade8"})(r||(r={}));function v(e,t){return{h:e.h,s:e.s,v:e.v-e.v*t}}function m(e,t){return{h:e.h,s:e.s-e.s*t,v:e.v+(100-e.v)*t}}function g(e,t,n){if(!e||t===r.Unshaded||!(function(e){return"number"==typeof e&&e>=r.Unshaded&&e<=r.Shade8})(t))return e;var i=m,s=v;if(n){i=v;s=m}var o=(function(e){var t,n,r=NaN,i=e.R,s=e.G,o=e.B,u=Math.max(i,s,o),a=Math.min(i,s,o),f=u-a;0===f?r=0:i===u?r=(s-o)/f%6:s===u?r=(o-i)/f+2:o===u&&(r=(i-s)/f+4);(r=Math.round(60*r))<0&&(r+=360);t=Math.round(100*(0===u?0:f/u));n=Math.round(u/255*100);return{h:r,s:t,v:n}})(e),u=(function(e){var t=e.h,n=e.s,r=e.v,i=(2-(n/=100))*(r/=100),s=n*r;return{h:t,s:100*(s=(s/=i<=1?i:2-i)||0),l:100*(i/=2)}})(o),g=t-1;return(function(e){var t=e.h,n=e.s,r=e.v,i=[],s=(r/=100)*(n/=100),o=t/60,u=s*(1-Math.abs(o%2-1)),f=r-s;switch(Math.floor(o)){case 0:i=[s,u,0];break;case 1:i=[u,s,0];break;case 2:i=[0,s,u];break;case 3:i=[0,u,s];break;case 4:i=[u,0,s];break;case 5:i=[s,0,u]}return a.e.fromRgba(Math.round(255*(i[0]+f)),Math.round(255*(i[1]+f)),Math.round(255*(i[2]+f)))})(o=(function(e){return 255===e.R&&255===e.G&&255===e.B})(e)?v(o,f[g]):(function(e){return 0===e.R&&0===e.G&&0===e.B})(e)?m(o,l[g]):u.l/100>.8?s(o,h[g]):u.l/100<.2?i(o,c[g]):g<p.length?i(o,p[g]):s(o,d[g-p.length]))}var y=(function(){function e(){}e.generateFabricColors=function(t,n){void 0===n&&(n=!1);var i={themeDarker:r.Shade8,themeDark:r.Shade7,themeDarkAlt:r.Shade6,themeLight:r.Shade3,themeLighter:r.Shade2,themeLighterAlt:r.Shade1,themePrimary:r.Unshaded,themeAccent:r.Unshaded,themeSecondary:r.Shade5,themeTertiary:r.Shade4},s=e._getDefaultThemeTokenMap(),o=a.e.fromRgba(t.R,t.G,t.B);for(var u in i){var f=i[u];s[u]=g(o,f,n)}var l=s.themeAccent;s.themeAccentTranslucent10=l?a.e.fromRgba(l.R,l.G,l.B,.1*a.e.maxComponent):null;if(n){var c={black:"#fff",blackTranslucent40:"#66ffffff",neutralDark:"#f4f4f4",neutralPrimary:"#fff",neutralPrimaryTranslucent50:"#7fffffff",neutralPrimaryAlt:"#dadada",neutralSecondary:"#d0d0d0",neutralTertiary:"#c8c8c8",neutralTertiaryAlt:"#6d6d6d",neutralQuaternary:"#4f4f4f",neutralQuaternaryAlt:"#484848",cmdbarSelected:"#4f4f4f",cmdbarSelectedHover:"#484848",neutralLight:"#3f3f3f",neutralLighter:"#313131",neutralLighterAlt:"#282828",white:"#1f1f1f",whiteTranslucent40:"#661f1f1f",error:"#f00",errorBackground:"#7e3333"};for(var h in c)c.hasOwnProperty(h)&&(s[h]=a.e.fromHtmlColor(c[h]))}return s};e._getDefaultThemeTokenMap=function(){return{backgroundOverlay:null,themeDarker:null,themeDark:null,themeDarkAlt:null,themePrimary:null,themeSecondary:null,themeTertiary:null,themeLight:null,themeLighter:null,themeLighterAlt:null,black:null,cmdbarSelected:null,cmdbarSelectedHover:null,neutralDark:null,neutralPrimary:null,neutralPrimaryAlt:null,neutralPrimaryTranslucent50:null,neutralSecondary:null,neutralSecondaryAlt:null,neutralTertiary:null,neutralTertiaryAlt:null,neutralQuaternary:null,neutralQuaternaryAlt:null,neutralLight:null,neutralLighter:null,neutralLighterAlt:null,white:null,blackTranslucent40:null,whiteTranslucent40:null,yellow:null,yellowLight:null,orange:null,orangeLight:null,redDark:null,red:null,magentaDark:null,magenta:null,magentaLight:null,purpleDark:null,purple:null,purpleLight:null,blueDark:null,blueMid:null,blue:null,blueLight:null,tealDark:null,teal:null,tealLight:null,greenDark:null,green:null,greenLight:null,error:null,errorBackground:null,success:null,successBackground:null,alert:null,alertBackground:null,infoBackground:null,info:null,orangeLighter:null}};return e})(),b=n(42),w=(function(){function e(){}e.makeWebThemeRestUrl=function(e,t,n){var r=e;r&&"/"===r[r.length-1]&&(r=r.substring(0,r.length-1));r=b.e.escapeUrlForCallback(r);var i=b.e.escapeUrlForCallback(r)+"/_api/SP.Web.GetContextWebThemeData?noImages=true&lcid="+b.e.encodeURIComponent(t);n&&(i+="&ThemeOverride="+b.e.encodeURIComponent(n));return i};e.processWebThemeRestResponse=function(t){var n,r=JSON.parse(t);r&&r.d&&r.d.GetContextWebThemeData&&(n=JSON.parse(r.d.GetContextWebThemeData));return e.processRawThemeData(n)};e.processRawThemeData=function(t){if(t){var n,r=e.coerceToColor,i=e.SetColorIfMissing,s=t.Palette?t.Palette.Colors:{};n=e.convertColorsToRgba(s);var o=y.generateFabricColors(n.ContentAccent1,t.IsInverted),u=r(n.PageBackground)||r(t.IsInverted?"#1b1a19":"#ffffff"),f=r(n.BackgroundOverlay)||null,l=Math.round(.4*a.e.maxComponent);for(var c in o)i(n,c,o[c]);i(n,"white",u);i(n,"primaryBackground",a.e.clone(u));i(n,"primaryText",o.primaryText||r("#333"));i(n,"whiteTranslucent40",u&&a.e.fromRgba(u.R,u.G,u.B,l));i(n,"backgroundOverlay",f);i(n,"suiteBarBackground",r(n.SuiteBarBackground)||null);i(n,"suiteBarText",r(n.SuiteBarText)||null);i(n,"suiteBarDisabledText",r(n.SuiteBarDisabledText)||null);i(n,"topBarBackground",r(n.TopBarBackground)||null);i(n,"topBarText",r(n.TopBarText)||null);i(n,"topBarHoverText",r(n.TopBarHoverText)||null);i(n,"dialogBorder",r(n.DialogBorder)||null);return{backgroundImageUri:t.BackgroundImageUri,cacheToken:t.ThemeCacheToken,isDefault:t.IsDefault,isInverted:t.IsInverted,palette:n,version:t.Version}}return{backgroundImageUri:"",cacheToken:"",isDefault:!0,isInverted:!1,palette:{},version:""}};e.convertColorsToRgba=function(t){var n={};for(var r in t)if(t.hasOwnProperty(r)){var i=e.coerceToColor(t[r]);i&&(n[r]=i)}return n};e.coerceToColor=function(t){var n;t?"string"==typeof t||t instanceof String?n=a.e.fromHtmlColor(String(t)):"DefaultColor"in t?n=e.coerceToColor(t.DefaultColor):"R"in t&&"G"in t&&"B"in t&&(n=a.e.fromRgba(t.R,t.G,t.B,t.A)):n=null;return n};e.SetColorIfMissing=function(e,t,n){e[t]||(e[t]=n)};return e})(),E=n(77).n?"#0078d4":"#03787c",S=(function(){function e(e){this._pageContext=e;this._dataRequestor=new o.e({qosName:"WebThemeDataSource"},{pageContext:e})}e.prototype.getCacheToken=function(){var e="",t=this._pageContext;if(t){var n=Number(t.webTemplate),r=n!==s.t.mySite&&n!==s.t.mySiteHost?t.groupColor:E;e=t.themedCssFolderUrl||r}return e};e.prototype.loadTheme=function(e){if(!e&&this._dataPromise)return this._dataPromise;if(!this.getCacheToken())return this._dataPromise=u.t.resolve();this._dataPromise=this._pageContext.themedCssFolderUrl?this.loadServerTheme():this.loadGeneratedTheme();return this._dataPromise};e.prototype.needsRequestDigest=function(e){return!1};e.prototype.loadGeneratedTheme=function(){var e=this._pageContext.groupColor||E,t=a.e.fromHtmlColor(e);if(t){var n={backgroundImageUri:null,cacheToken:e,isDefault:!1,isInverted:!1,palette:y.generateFabricColors(t),version:"1"};return u.t.resolve(n)}return u.t.resolve()};e.prototype.loadServerTheme=function(){var e=this,t=Object(i.e)(this._pageContext),n=this._pageContext.currentUICultureName,r=this._pageContext.themedCssFolderUrl,s=this.getCacheToken()===r&&r||void 0,o=w.makeWebThemeRestUrl(t,n,s),u=this._dataRequestor.getData({url:o,parseResponse:function(t){e._data=w.processWebThemeRestResponse(t);return e._data},qosName:"WebThemeDataSource.LoadData",method:"GET"});u.done(null,function(){e._dataPromise=null});return u};return e})();t.default=S},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(0),i=n(48),s=n(9),o=n(60),u=n(28),a=n(193),f=n(304);var l=n(157);var c=(function(e){Object(r.r)(t,e);function t(t){var n=t.contextProvided,i=Object(r.s)(t,["contextProvided"]),s=new l.e,o=s.osName,u=s.osVersion,a=Object(r.e)({OSName:o,OSVersion:u,UserAgent:navigator.userAgent},n);return e.call(this,Object(r.e)({context:a,logStartEvents:!0},i))||this}return t})((function(e){Object(r.r)(t,e);function t(t){var n=t.context,i=void 0===n?{}:n,s=Object(f.e)();return e.call(this,Object(r.e)(Object(r.e)({language:window.navigator.language},t),{context:Object(r.e)(Object(r.e)({},s),i)}))||this}return t})(a.e));function h(e){var t,n=e.pageContext,a=e.customerContext,f=Object(r.s)(e,["pageContext","customerContext"]),l=n.CorrelationId,h=n.systemUserKey,p=n.userLoginName,d=n.farmName,v=n.farmLabel,m=n.siteSubscriptionId,g=n.SideBySideToken,y=n.ariaCollectorUrl,b=n.isAnonymousGuestUser;if(s.t.isActivated("0d905643-decb-4b91-8c6d-87348745d166"))t=l;else{var w=new u.e(window.location.href).getQueryParameter("sessionId");t=i.e.isValidGuid(w)?w:l}var E=Object(r.e)({UserId:h,FarmName:d,FarmLabel:v,AccountType:p?o.e[o.e.Business]:o.e[o.e.BusinessAnonymous],TenantID:m,ServerGU:g,Session:t,SessionId:t},a);return new c(Object(r.e)({contextProvided:E,disableCookies:b,ariaLogConfiguration:{collectorUrl:y}},f))}},function(e,t,n){"use strict";var r,i=n(0),s=n(203),o=n(55),u=n(242),a=n(335),f=n(465),l=n(202);(function(e){e[e.NONE=0]="NONE";e[e.VIEW=1]="VIEW";e[e.EDIT=2]="EDIT";e[e.OWNER=3]="OWNER";e[e.REVIEW=6]="REVIEW"})(r||(r={}));var c=n(115),h=n(5),p=n(370),d=n(50),v=n(372),m=n(114),g=n(104),y=n(23),b=n(29),w=n(240),E=n(48),S=n(68),x=n(35),T=n(66),N=n(1),C=n(276),k=n(9),L=n(6),A=n(10),O=n(76),M=n(20),_=n(15),D=n(70),P=n(96),H=n(106),B=n(192),j=n(8),F=n(31),I=n(47),q=n(21),R=n(83),U=n(91),z=n(164),W=n(28),X=(function(){function e(e,t){var n=this;this._listeners=null;this.stopSharing=function(){for(var e=n._storeContents.sharingInformation.sharingLinks,t=n._storeContents.sharingInformation.sharingPrincipals,r=0,i=e;r<i.length;r++){var s=i[r];n.unshareLink(s.sharingLinkKind,s.shareId)}n._removePrincipals(t)};var r=e.item,i=e.sharingInformation,s=e.policyTipInfo,o=e.outlookAvailability,u=e.companyName,a=e.defaultRecipients,f=e.accessChecked,l=void 0===f||f,c=e.mode,p=e.isListItem,d=e.prefetchGSI,v=e.waitSharingAPIsDuration;this._item=r;this._mode=c;this._sharingContextInformation=e.sharingContextInformation;this._clientId=this._sharingContextInformation&&Object(h.t)(this._sharingContextInformation.clientId);this._sharingProvider=t.sharingProvider;this._suiteNavProvider=t.suiteNavProvider||void 0;this._graphPeoplePickerHelper=t.graphPeoplePickerHelper;this._substratePeoplePickerHelper=t.substratePeoplePickerHelper;this._peoplePickerProvider=t.peoplePickerProvider;this._policyTipProvider=t.policyTipProvider||void 0;this._permissions=this._sharingContextInformation&&this._sharingContextInformation.rawInvite&&this._sharingContextInformation.rawInvite.value;this._sharingService=e.sharingService;this._firstShareLinkRequest=!0;this._listeners=[];this._groupsMemberCountCache=[];this._sharingInformationInvalidated=!1;this._groupMembersCountHash={};this._isListItem=p;this._prefetchGSI=d;this._waitSharingAPIsDuration=v;this._sharingContextInformation&&this._sharingContextInformation.experimentContext&&Object(F.e)(this._sharingContextInformation.experimentContext);var g=this._sharingContextInformation?this._sharingContextInformation.scenarioId:"";this._telemetryExtraData={mode:this._mode,clientId:this._clientId,scenarioId:g};this._engagementHelper=new D.e(e.telemetryManager,this._telemetryExtraData);this._storeContents={sharingInformation:i,sharingLinkCreated:null,companyName:u||this._sharingContextInformation&&this._sharingContextInformation.organizationName||N.Ae,groupsMemberCount:0,policyTipInfo:s||{info:null,actionResult:null},permissionsMap:{},invitedUsers:[],defaultLink:null,defaultRecipients:null,outlookAvailability:o||m.e.none,grantAccessResult:null,addPeopleResult:null,accessRequestCreated:!1,isValidatingDefaultRecipients:!1,filteredPrincipals:{},documentInformation:null,sharingInfoBarInformation:null};i&&i.userPhotoCdnBaseUrl&&Object(O.e)(i.userPhotoCdnBaseUrl);if(a&&0!==a.length)this._resolveDefaultRecipients(a,l,c);else{this._eventGroup=new T.t(this);this._eventGroup.on(window,"message",function(e){if(e&&e.data)try{var t=JSON.parse(e.data);if("atMention_defaultRecipients"===t.name){var r=t.recipientIds;n._resolveDefaultRecipients(r,l,c)}}catch(e){}})}j.T()||this._configureLinkIfShareId()}e.prototype.getWaitSharingAPIsDuration=function(){return this._waitSharingAPIsDuration};e.prototype.getAuthToken=function(){var e;return null===(e=this._sharingContextInformation)||void 0===e?void 0:e.authToken};e.prototype.getScenarioId=function(){var e;return null===(e=this._sharingContextInformation)||void 0===e?void 0:e.scenarioId};e.prototype.isConsumer=function(){return!1};e.prototype.isConsumerLists=function(){return!!(window&&window._spPageContextInfo&&window._spPageContextInfo.isSiteListsHost)};e.prototype.isListItem=function(){return this._isListItem};e.prototype.getEngagementHelper=function(){return this._engagementHelper};e.prototype.addListener=function(e){this._listeners.push(e)};e.prototype.removeListeners=function(){this._listeners=[]};e.prototype.getInitialLinkSettings=function(e){return null};e.prototype.getSharingInformation=function(){return this._storeContents.sharingInformation};e.prototype.shouldDisableGraphForPeopleSearch=function(){return this._storeContents&&this._storeContents.sharingInformation&&(this._storeContents.sharingInformation.enforceIBSegmentFiltering||this._storeContents.sharingInformation.enforceSPOSearch)};e.prototype.isPeopleSharingLinksEnabled=function(){if(this._storeContents.sharingInformation){var e=this._storeContents.sharingInformation.sharingAbilities;return!(!e||!e.peopleSharingLinkAbilities)&&(!!e&&(e.peopleSharingLinkAbilities.canManageEditLink.enabled||e.peopleSharingLinkAbilities.canManageReadLink.enabled))}return!1};e.prototype.showManageAccess=function(){return!0};e.prototype.fetchSharingInformation=function(e,t){var n=this;if(!this._storeContents.sharingInformation||this._sharingInformationInvalidated||e&&!this._storeContents.sharingInformation.hasPermissionsInformation||t){var r=(new Date).getTime(),i=!!this._sharingContextInformation||e;this._prefetchGSI&&this._checkPrefetchSupportExpansion(i,t)?this._raceGSI(i,t,r):this._sharingProvider.getSharingInformation(this._item,i,!0,null,t).then(function(e){n._setGSIResponse(e,r)},function(e){n._setGSIError(e,r)})}else{this._getSharingInformationStats={name:"GetSharingInformationProvided",resultType:L.t.Success,duration:0};this._configureLinkIfShareId();this._emitChange({type:d.t.FetchSharingInformation})}};e.prototype.fetchMemberCount=function(e){var t=this;this._groupMembersCountHash[e.email]||this._peoplePickerProvider.getPickerEntityInformation(e).then(function(n){var r=n.totalMemberCount;t._groupMembersCountHash[e.email]=r;t._emitChange()}).catch(function(n){t._groupMembersCountHash[e.email]=null;t._emitChange()})};e.prototype.getMembersCounts=function(){return this._groupMembersCountHash};e.prototype.shareLink=function(e){var t=this,n=new L.e({name:"shareLinkInvestigation"}),r=this._firstShareLinkRequest;this._firstShareLinkRequest=!1;Object(I.s)("sharelink.start");var l=e.settings,c=e.recipients,h=e.emailMessage,p=e.emailSubject,m=e.copyLinkCommand,g=e.allRecipientsHaveAccess,b=e.shareId,w=e.inviteesToRemove,E=e.shareType;if(e.copyLinkCommand&&_.h(this._clientId)&&this._mode===s.e.copy&&!this._sharingContextInformation.shareId&&this._sharingService&&(this._sharingContextInformation.itemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.serverRelativeItemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.uniqueId)&&r){this._getDefaultLink();n.end({resultType:L.t.Success,extraData:Object(i.e)({sharingLinkPath:0},this._telemetryExtraData)})}else{var S=0,T=0,C=!1,k=(c=c||[]).map(function(e){e.entityType===y.e.externalUser?T++:S++;e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"===e.rawPersonData.EntityData.PrincipalType&&(C=!0);return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});k=this._dedupeRecipients(k);if(b&&b.length>0||l.shareId&&l.shareId.length>0){n.end({resultType:L.t.Success,extraData:Object(i.e)({sharingLinkPath:1},this._telemetryExtraData)});this._shareLink(l,k,h,p,m,r,b,w)}else{if(this.isPeopleSharingLinksEnabled()&&(this._doesPSLSupportNewExternalUsers()||!C)&&l.audience!==o.e.existing&&!this._storeContents.sharingInformation.requiresAccessApproval){n.end({resultType:L.t.Success,extraData:Object(i.e)({sharingLinkPath:2,settings:l},this._telemetryExtraData)});this._shareLink(l,k,h,p,m,r,b,w)}else if(l.sharingLinkKind!==u.e.direct&&l.sharingLinkKind!==u.e.flexible){n.end({resultType:L.t.Success,extraData:Object(i.e)({sharingLinkPath:3,settings:l},this._telemetryExtraData)});this._shareLink(l,k,h,p,m,r,b,w)}else{var A=void 0;A=l.sharingRole?this._getRoleString(l.sharingRole):this._getRoleValue(l.isEdit);var O={items:[this._item],roleValue:A,sendEmail:void 0!==h,message:h,subject:p,requireSignIn:!0,propagateSharing:!0},M=this._storeContents.sharingInformation.directLink,D=(null==l?void 0:l.audience)==o.e.existing&&(E===a.e.copy||E===a.e.outlook||E===a.e.mobileShareToTeams||E===a.e.nonOutlook||E===a.e.moreApps||E===a.e.webShareToTeams);if(0===c.length||l.audience==o.e.existing&&(this._mode===s.e.copy||this._mode==s.e.linkSettings)||D){n.end({resultType:L.t.Success,extraData:Object(i.e)({sharingLinkPath:4,useDirectLinkForShareTarget:D,recipientsLength:c.length},this._telemetryExtraData)});this._invokeShareStatsEvent({name:"NoExtraCallReturnCanonical",duration:0,resultType:L.t.Success});Object(I.s)("sharelink.existing");this._handleSharedLink(M,m)}else{for(var P=!0,H=0,B=c;H<B.length;H++){var j=B[H];this._storeContents.permissionsMap[j.email]!==v.e.hasAccess&&this._storeContents.permissionsMap[j.userId]!==v.e.hasAccess&&(P=!1)}if(P||g){n.end({resultType:L.t.Success,extraData:Object(i.e)({sharingLinkPath:5,useDirectLinkForShareTarget:D,recipientsLength:c.length,allUsersArePermissioned:P,allRecipientsHaveAccess:g},this._telemetryExtraData)});var F=(new Date).getTime();Object(I.s)("sharelink.emailWithoutPermissioning.start");this._sharingProvider.emailWithoutPermissioning(k,this._item,h,p).done(function(e){Object(I.s)("sharelink.emailWithoutPermissioning.end");var n=e.statusCode;if(0===n){t._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-F,resultType:L.t.Success});t._handleSharedLink(M,m)}else{var r=f.t.generic,s=N.fn;if(-8===n){r=f.t.objectNotSupported;s=N.nu}else if(-13===n){r=f.t.invalidEmail;s=x.n(N.Sn,e.invalidEmails.join(", "))}else if(-7===n){r=f.t.generic;s=e.errorMessage}t._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-F,resultType:L.t.Failure,error:r});t._storeContents.sharingInformation=Object(i.e)(Object(i.e)({},t._storeContents.sharingInformation),{error:r,errorCategory:f.e.shareLink,errorMessage:s});t._emitChange({type:d.t.ShareLink})}})}else{var q=(new Date).getTime();Object(I.s)("sharelink.share.start");n.end({resultType:L.t.Success,extraData:Object(i.e)({sharingLinkPath:6,useDirectLinkForShareTarget:D,recipientsLength:c.length,allUsersArePermissioned:P,allRecipientsHaveAccess:g},this._telemetryExtraData)});this._sharingProvider.share(k,O,!0).done(function(e){Object(I.s)("sharelink.share.end");var n=e.statusCode;if(0===n){var r=M;0===S&&1===T&&e.invitationLink?r=Object(i.e)(Object(i.e)({},M),{url:e.invitationLink}):0===S&&T>1&&e.invitationLink&&(r=Object(i.e)(Object(i.e)({},M),{url:t._removeEmailQueryParamFromInvitationLink(e.invitationLink)}));l.audience===o.e.customLabeledSpecificPeople&&(r=Object(i.e)(Object(i.e)({},r),{audience:o.e.customLabeledSpecificPeople}));t._invokeShareStatsEvent({name:"ShareObject",resultType:L.t.Success,duration:(new Date).getTime()-q});t._handleSharedLink(r,m)}else if(1===n){t._storeContents.accessRequestCreated=!0;t._invokeShareStatsEvent({name:"ShareObject",resultType:L.t.Success,duration:(new Date).getTime()-q});t._handleSharedLink(M,m)}else{var s=f.t.generic,u=N.fn;if(-8===n){s=f.t.objectNotSupported;u=N.nu}else if(-13===n){s=f.t.invalidEmail;u=x.n(N.Sn,e.invalidEmails.join(", "))}else if(-7===n){s=f.t.generic;u=e.errorMessage}t._storeContents.sharingInformation=Object(i.e)(Object(i.e)({},t._storeContents.sharingInformation),{error:s,errorCategory:f.e.shareObject,errorMessage:u});t._invokeShareStatsEvent({name:"ShareObject",resultType:L.t.Failure,duration:(new Date).getTime()-q,error:s});t._emitChange({type:d.t.ShareLink})}})}}}m&&this._storeContents.defaultLink&&this._storeContents.defaultLink.audience!==l.audience&&this._cleanupDefaultLink()}}};e.prototype.unshareLink=function(e,t){var n=this,r={item:this._item,kind:e,shareId:t};this._sharingProvider.unshareLink(r).then(function(e){if(!0===e){n._removeLinkByShareId(t);n.updatePermissionsInfoOnLinkChange(t,l.e.none);n._updateIsShared();n._emitChange({type:d.t.UnshareLink})}}).then(function(){n._sharingInformationInvalidated=!0;n.fetchSharingInformation(!0)})};e.prototype.getSharingLinkCreated=function(){return this._storeContents.sharingLinkCreated};e.prototype.getLinksCount=function(){return this.getActiveLinks().length};e.prototype.getAllPrincipals=function(){var e=this._storeContents.sharingInformation.sharingPrincipals,t=this.getActiveLinks();this._addPrincipals(e);for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i.principals.length||i.invitees.length){this._addPrincipals(i.principals);i.isActive&&(!i.expiration||i.expiration.getTime()>Date.now())&&this._addPrincipals(i.invitees)}}return this._storeContents.filteredPrincipals};e.prototype.parsePermissions=function(){for(var e=[],t=[],n=[],r=this.getSharingInformation(),s=r.permissionsInformation.links.results,o=r.permissionsInformation.principals.results,u=r.permissionsInformation.siteAdmins.results,a=r.webUrl,f=0,l=s;f<l.length;f++)for(var c=l[f],h=void 0,p=0,d=c.linkMembers.results;p<d.length;p++){var v=d[p];h=Object(i.e)(Object(i.e)({},v),{primaryText:v.name,secondaryText:v.jobTitle,type:v.principalType,imageUrl:v.imageUrl||v.loginName?Object(O.t)(a)(v.loginName):"",role:v.role||this._getRoleFromLink(c)});n.push(v.loginName);this._buildPrincipalAccessMap({addedIds:e,principals:t,sharingPrincipal:h,link:c})}for(var m=0,g=o;m<g.length;m++){v=g[m],h=Object(i.e)(Object(i.e)({},v.principal),{primaryText:v.principal.name,secondaryText:v.principal.jobTitle,type:v.principal.principalType,imageUrl:v.principal.loginName?Object(O.t)(a)(v.principal.loginName):"",role:v.role});n.push(v.principal.loginName);this._buildPrincipalAccessMap({addedIds:e,principals:t,sharingPrincipal:h,link:void 0,isDirectAccess:!0})}for(var y=0,b=u;y<b.length;y++){var w=b[y];if(-1===n.indexOf(w.principal.loginName)){var E=Object(i.e)(Object(i.e)({},w.principal),{primaryText:w.principal.name,secondaryText:w.principal.jobTitle,type:w.principal.principalType,imageUrl:w.principal.loginName?Object(O.t)(a)(w.principal.loginName):"",role:w.role});this._buildPrincipalAccessMap({addedIds:e,principals:t,sharingPrincipal:E})}}this._storeContents.sharingInformation=Object(i.e)(Object(i.e)({},this._storeContents.sharingInformation),{sharingPrincipals:t})};e.prototype.getSensitivityLabels=function(e){var t=new L.e({name:"Sharing.sensitivityLabelGraphAPI"});return n.ee([2],764).then(function(n){return new n.SensitivityLabelsDataSource({getOAuthToken:e},{pageContext:window._spPageContextInfo}).getSensitivityLabels().then(function(e){t.end({resultType:L.t.Success});return e}).catch(function(e){t.end({resultType:L.t.Failure,resultCode:Object(U.r)(e),extraData:Object(U.n)(e)});return S.t.resolve(null)})})};e.prototype.getOptInSendNavIdInShareLink=function(){return this._sharingContextInformation&&this._sharingContextInformation.optInSendNavIdInShareLink};e.prototype.onDocumentInformation=function(e){this._storeContents.documentInformation=e;this._emitChange()};e.prototype.getDocumentInformation=function(){return this._storeContents.documentInformation};e.prototype.onReceivingSharingInfoBarInformation=function(e){e&&(this._storeContents.sharingInfoBarInformation=e);this._emitChange()};e.prototype.getSharingInfoBarInformation=function(){return this._storeContents.sharingInfoBarInformation};e.prototype._buildPrincipalAccessMap=function(e){var t,n,r,s,o=e.addedIds,u=e.principals,a=e.sharingPrincipal,f=e.link,l=e.isDirectAccess;if(f){s=f.linkDetails.ShareId;r=this._getRoleFromLink(f);n=f.linkDetails.ShareId}else if(l){s=a.id.toString();r=this._getRoleForPrincipal(a)||a.role;n=a.id.toString()}else{s=a.id.toString();r=this._getRoleForPrincipal(a)||a.role;n=a.loginName}var c={id:s,role:r,isSPO:!0,rawPermission:{shareId:s,scope:null===(t=null==f?void 0:f.linkDetails)||void 0===t?void 0:t.Scope}};if(-1===o.indexOf(a.id)){var h=new Map;h.set(n,c);a=Object(i.e)(Object(i.e)({},a),{accessMap:h})}else{u.filter(function(e){return e.id===a.id})[0].accessMap.set(n,c)}if(a){u.push(a);o.push(a.id)}};e.prototype._getRoleFromLink=function(e){switch(e.linkDetails.LinkKind){case u.e.organizationEdit:case u.e.anonymousEdit:return l.e.edit;case u.e.organizationView:case u.e.anonymousView:return l.e.view;case u.e.flexible:default:return this._getRoleFromLinkDetails(e.linkDetails)}};e.prototype._getRoleForPrincipal=function(e){switch(e.sharingLinkKind){case u.e.organizationEdit:case u.e.anonymousEdit:return l.e.edit;case u.e.organizationView:case u.e.anonymousView:return l.e.view;default:return l.e.none}};e.prototype._getRoleFromLinkDetails=function(e){return e.IsManageListLink?l.e.manageList:e.IsReviewLink?l.e.review:e.IsEditLink?l.e.edit:l.e.view};e.prototype.parsePrincipals=function(){var e=this.getAllPrincipals(),t=[],n=[],r=[],i=[],s=[];for(var o in e){var u=e[o],a=u.role===l.e.owner;if(u.type===b.e.user){a?i.push(u):t.push(u);r.push({alias:o})}else u.type!==b.e.securityGroup&&u.type!==b.e.sharePointGroup||(a?s.push(u):n.push(u))}this._engagementHelper.manageAccessV3NumberOfSharingPrincipals({numberOfUsers:t.length,numberOfGroups:n.length});return{users:i.concat(t),groups:s.concat(n)}};e.prototype.getActiveLinks=function(){return this._storeContents.sharingInformation.sharingLinks.filter(function(e){return e.isActive&&e.sharingLinkKind!==u.e.direct&&(!e.expiration||e.expiration.getTime()>Date.now())&&!(e.isAddressBarLink&&!0===e.isUnhealthy)})};e.prototype.updatePermissions=function(e,t){var n=this;this._sharingProvider.updatePermissions2(e,this._item,t).done(function(t){var s=n._storeContents.sharingInformation.sharingPrincipals;if(t.role===r.NONE){if(j.C()&&F.n()){var o=n._storeContents.sharingInformation.permissionsInformation.principals.results;n._storeContents.sharingInformation.permissionsInformation.principals.results=o.filter(function(t){return t.principal.id!==e.id});n._storeContents.sharingInformation.sharingPrincipals=s.map(function(t){var r;if(t.id===e.id)if(t.accessMap){var i=t.id.toString();null===(r=t.accessMap)||void 0===r||r.delete(i);t.role=Object(A.m)(t);n._removePrincipalById(t.loginName)}else s.pop();return t})}else n._storeContents.sharingInformation.sharingPrincipals=s.filter(function(t){t.id===e.id&&n._removePrincipalById(t.loginName);return t.id!==e.id});n._updateIsShared();n._studyEmitChangeUsage("updatePermissions0");n._emitChange()}else if(j.C()&&F.n()){n._storeContents.sharingInformation.sharingPrincipals=s.map(function(n){var s,o,u,a,f,c;if(n.id===e.id){var h=void 0,p=void 0;(h=null===(s=n.accessMap)||void 0===s?void 0:s.get(n.loginName))?p=n.loginName:(h=null===(o=n.accessMap)||void 0===o?void 0:o.get(n.id.toString()))&&(p=n.id.toString());switch(t.role){case r.VIEW:n.role=l.e.view;null===(u=n.accessMap)||void 0===u||u.set(p,Object(i.e)(Object(i.e)({},h),{role:l.e.view}));break;case r.EDIT:n.role=l.e.edit;null===(a=n.accessMap)||void 0===a||a.set(p,Object(i.e)(Object(i.e)({},h),{role:l.e.edit}));break;case r.OWNER:n.role=l.e.owner;null===(f=n.accessMap)||void 0===f||f.set(p,Object(i.e)(Object(i.e)({},h),{role:l.e.owner}));break;case r.REVIEW:n.role=l.e.review;null===(c=n.accessMap)||void 0===c||c.set(p,Object(i.e)(Object(i.e)({},h),{role:l.e.review}))}}return n});n._storeContents.sharingInformation.permissionsInformation.principals.results.map(function(n){if(n.principal.id===e.id)switch(t.role){case r.VIEW:n.role=l.e.view;break;case r.EDIT:n.role=l.e.edit;break;case r.OWNER:n.role=l.e.owner;break;case r.REVIEW:n.role=l.e.review}return n});n._studyEmitChangeUsage("updatePermissions1");n._emitChange()}else for(var u=0,a=s;u<a.length;u++){var f=a[u];if(f.id===e.id){switch(t.role){case r.VIEW:f.role=l.e.view;break;case r.EDIT:f.role=l.e.edit;break;case r.OWNER:f.role=l.e.owner;break;case r.REVIEW:f.role=l.e.review}n._studyEmitChangeUsage("updatePermissions1");n._emitChange()}}})};e.prototype.grantDirectAccess=function(e,t){var n=this,r=this._storeContents.sharingInformation.sharingPrincipals.filter(function(t){return t.id===parseInt(e)})[0],s=this._getRoleString(t),o={items:[this._item],roleValue:s,requireSignIn:!0,propagateSharing:!0},u=Object(i.e)(Object(i.e)({},r),{userId:r.email,name:r.loginName,email:r.email,rawData:{Key:r.email,isResolved:!1},rawPersonData:{Key:r.email,isResolved:!1},isResolved:!1});this._sharingProvider.share([u],o,!0).then(function(s){switch(s.statusCode){case 0:var o=n._storeContents.sharingInformation.sharingPrincipals;n._storeContents.addPeopleResult=d.e.CompletedSuccessfully;n._storeContents.sharingInformation.permissionsInformation.principals.results.push({role:t,principal:Object(i.e)(Object(i.e)({},r),{isActive:!0,principalType:r.type,userId:"",jobTitle:r.secondaryText,name:r.primaryText,email:r.email,id:parseInt(e)})});var u={id:e,role:t,isSPO:!0,rawPermission:{scope:void 0}};r.accessMap.set(e,u);n._storeContents.sharingInformation.sharingPrincipals=o.map(function(t){return t.id===parseInt(e)?r:t});break;case 1:n._storeContents.addPeopleResult=d.e.AccessRequestsQueued;break;default:n._storeContents.addPeopleResult=d.e.Error}n._emitChange()},function(){n._storeContents.addPeopleResult=!1;n._emitChange()})};e.prototype.updatePermissionsInfoOnLinkChange=function(e,t){this._storeContents.sharingInformation.sharingPrincipals;var n=this._storeContents.sharingInformation.permissionsInformation.links.results;switch(t){case l.e.none:this._storeContents.sharingInformation.permissionsInformation.links.results=n.filter(function(t){return t.linkDetails.ShareId!==e});break;case l.e.view:this._storeContents.sharingInformation.permissionsInformation.links.results=n.map(function(t){t.linkDetails.ShareId===e&&(t.linkDetails.IsEditLink=!1);return t});break;case l.e.edit:this._storeContents.sharingInformation.permissionsInformation.links.results=n.map(function(t){t.linkDetails.ShareId===e&&(t.linkDetails.IsEditLink=!0);return t});break;case l.e.review:this._storeContents.sharingInformation.permissionsInformation.links.results=n.map(function(t){t.linkDetails.ShareId===e&&(t.linkDetails.IsReviewLink=!0);return t})}t!==l.e.none&&this._updateAccessMap(e,t);this._updateIsShared();this._emitChange()};e.prototype.updatePermissionById=function(e,t){var n=this.getSharingInformation().sharingPrincipals.filter(function(t){return t.id===parseInt(e)})[0];this.updatePermissions(n,t);return S.t.resolve()};e.prototype.addPeople=function(e,t,n,r){var i=this,s=this._getRoleString(t),o={items:[this._item],roleValue:s,sendEmail:n,message:r,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(e,o,!0).then(function(e){switch(e.statusCode){case 0:i._storeContents.addPeopleResult=d.e.CompletedSuccessfully;break;case 1:i._storeContents.addPeopleResult=d.e.AccessRequestsQueued;break;default:i._storeContents.addPeopleResult=d.e.Error}i._emitChange()},function(){i._storeContents.addPeopleResult=!1;i._emitChange()})};e.prototype.fetchSuiteNavInformation=function(){var e=this;if(this._suiteNavProvider)this._suiteNavProvider.loadData().then(function(t){var n=t.CompanyDisplayName||e._storeContents.companyName,r=t?JSON.parse(t.ClientData):{HasEXOLicense:!1};e._storeContents.companyName=n;e._storeContents.outlookAvailability=r.HasEXOLicense?m.e.available:m.e.none;e._emitChange()});else{this._storeContents.outlookAvailability=m.e.none;this._emitChange()}};e.prototype.getCompanyName=function(){return this._storeContents.companyName};e.prototype.getOutlookAvailability=function(){return this._storeContents.outlookAvailability};e.prototype.navigateToOwa=function(e,t){Object(R.e)()?window.sessionStorage.setItem("OWA_sharingLinkUrl",this._getOwaUrl(e,t)):window.open(this._getOwaUrl(e,t),"_blank")};e.prototype.getNavId=function(){return this._sharingContextInformation&&this._sharingContextInformation.navId};e.prototype.getContextualSharingInformation=function(){return this._sharingContextInformation&&this._sharingContextInformation.contextualSharingInformation};e.prototype.getInvitationId=function(){var e,t;return j.b()&&null!==(t=null===(e=this._sharingContextInformation)||void 0===e?void 0:e.invitationId)&&void 0!==t?t:""};e.prototype.fetchGroupsMemberCount=function(e){for(var t=this,n=0,r=function(e){var r={userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData,principalType:e.principalType};if(e.principalType===b.e.securityGroup){var s=i._groupsMemberCountCache[e.userId];void 0!==s?n+=s:i._peoplePickerProvider.getPickerEntityInformation(r).then(function(r){var i=r.totalMemberCount;t._groupsMemberCountCache[e.userId]=i;n+=i;t._storeContents.groupsMemberCount=n;t._emitChange()}).catch(function(n){t._groupsMemberCountCache[e.userId]=null;t._emitChange()})}},i=this,s=0,o=e;s<o.length;s++){r(o[s])}this._storeContents.groupsMemberCount=n;this._emitChange()};e.prototype.getGroupsMemberCount=function(){return this._storeContents.groupsMemberCount};e.prototype.fetchPolicyTipInformation=function(){var e=this;if(this._policyTipProvider){if(this._storeContents.policyTipInfo.info){this._emitChange();return}var t=this._storeContents.sharingInformation;if(!t)return;if(!this._item)return;var n=!this._isPolicyTipFlagSet(this._item.policyTip,w.e.blockSharing),r=t.sharingAbilities;if(r){if((r&&r.directSharingAbilities&&r.directSharingAbilities.canAddExternalPrincipal.disabledReason)!==c.e.documentIsProtectedByDlp&&n)return}else if(n)return;this._policyTipProvider.getPolicyTip(this._item).then(function(t){if(t){e._storeContents.policyTipInfo.info=t;e._emitChange()}})}};e.prototype.getPolicyTipInformation=function(){return this._storeContents.policyTipInfo};e.prototype.updatePolicy=function(e,t){var n=this;if(this._policyTipProvider){var r={item:this._item,action:e};t&&(r.justification=t);this._policyTipProvider.updatePolicy(r).then(function(e){n._storeContents.policyTipInfo.actionResult=e;n._sharingInformationInvalidated=!0;n.fetchSharingInformation(!0);n._emitChange()})}};e.prototype.checkUserAccess=function(e){var t=this,n=new L.e({name:"Sharing.checkUserAccessAPI"});if(0!==e.length){for(var r=[],s=0,o=e;s<o.length;s++){var u=o[s];r.push(u)}return this._sharingProvider.checkPermissions(r,this._item).then(function(e){for(var r=function(e){var n=t._storeContents.sharingInformation.sharingPrincipals.filter(function(t){return t.loginName===e.inputEntity})[0],r=t._storeContents.sharingInformation.sharingPrincipals.filter(function(e){return e.role===l.e.owner}).length>=1;if(Object(A.s)(e.role,n.role)){var i=r&&e.role===l.e.owner?n.role:e.role,s={id:e.inputEntity,role:i,isSPO:!0,rawPermission:{shareId:e.inputEntity}};n.role=i;n.accessMap.set(s.id,s);n.hasGSIAndCheckAccessPerms=!0}},i=0,s=e;i<s.length;i++){r(s[i])}n.end({resultType:L.t.Success})}).catch(function(e){t._storeContents.sharingInformation=Object(i.e)(Object(i.e)({},t._storeContents.sharingInformation),{error:e,errorMessage:N.Ce});n.end({resultType:L.t.Failure,extraData:e})})}};e.prototype.checkPermissions=function(e,t){var n=this;if(0!==e.length){var r=[];this._recipients=[];for(var i=0,s=e;i<s.length;i++){var o=s[i];r.push({alias:k.t.isActivated("00bdc590-2d96-4d10-bb1c-66fb6cb59dfd")?o.email:o.userId||o.email});this._recipients.push(o.email)}t=t||this._storeContents.invitedUsers;this._invitedUsers=[];for(var u=0,a=t;u<a.length;u++){var f=a[u];r.push({alias:f.email});this._invitedUsers.push(f.email)}var l=r.map(function(e){return e.alias});this._sharingProvider.checkPermissions(r,this._item).then(function(e){n._storeContents.permissionsMap={};for(var t=0,r=e;t<r.length;t++){var i=r[t];n._invitedUsers.indexOf(i.inputEntity)>-1?n._storeContents.permissionsMap[i.inputEntity]=i.hasAccess?v.e.hasAccess:v.e.pending:(n._recipients.indexOf(i.inputEntity)>-1||l.indexOf(i.inputEntity)>-1)&&(n._storeContents.permissionsMap[i.inputEntity]=i.hasAccess?v.e.hasAccess:v.e.none)}n._emitChange()})}else{this._storeContents.permissionsMap={};this._emitChange()}};e.prototype.getPermissionsMap=function(){return this._storeContents.permissionsMap};e.prototype.getDefaultRecipients=function(){return this._storeContents.defaultRecipients};e.prototype.consumeDefaultRecipients=function(){this._storeContents.defaultRecipients={isConsumed:!0,recipients:this._storeContents.defaultRecipients.recipients}};e.prototype.grantAccess=function(e,t){var n=this;void 0===t&&(t=!0);var r=(e=e||[]).map(function(e){return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});r=this._dedupeRecipients(r);var s={items:[this._item],roleValue:this._getRoleValue(t),sendEmail:!1,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(r,s,!0).done(function(e){n._storeContents=Object(i.e)(Object(i.e)({},n._storeContents),{grantAccessResult:0===e.statusCode});n._emitChange()})};e.prototype.getGrantAccessResult=function(){return this._storeContents.grantAccessResult};e.prototype.getAddPeopleResult=function(){return this._storeContents.addPeopleResult};e.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}};e.prototype.hasAccessRequestBeenCreated=function(){return this._storeContents.accessRequestCreated};e.prototype.isValidatingDefaultRecipients=function(){return this._storeContents.isValidatingDefaultRecipients};e.prototype.setAddressBarLinkCapability=function(e){var t=this;return this._sharingProvider.setAddressBarLinkCapability(this._item,e).done(function(e){e&&t.fetchSharingInformation(!0,!0)})};e.prototype._addPrincipals=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t],i=r.loginName||r.email;this._storeContents.filteredPrincipals[i]||(this._storeContents.filteredPrincipals[i]=r)}};e.prototype._removePrincipals=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t],i=r.loginName||r.email;this._removePrincipalById(i)}};e.prototype._removePrincipalById=function(e){this._storeContents.filteredPrincipals[e]&&delete this._storeContents.filteredPrincipals[e]};e.prototype._doesPSLSupportNewExternalUsers=function(){if(this._storeContents.sharingInformation){var e=this._storeContents.sharingInformation.sharingAbilities;return!(!e||!e.peopleSharingLinkAbilities)&&e.peopleSharingLinkAbilities.canAddNewExternalPrincipals.enabled}return!1};e.prototype.resetPeoplePickerError=function(){if(this._storeContents.sharingInformation.peoplePickerError){this._storeContents.sharingInformation.peoplePickerError=void 0;this._emitChange()}};e.prototype.getSharingClickTime=function(){var e;return null===(e=this._sharingContextInformation)||void 0===e?void 0:e.clickTime};e.prototype.isPasswordModificationAllowed=function(){return!0};e.prototype.isExpirationDateModificationAllowed=function(){return!0};e.prototype.isPremiumExperienceAllowed=function(){return!0};e.prototype.isReportProblemSupported=function(){return!1};e.prototype.shouldInterruptCopyLink=function(e){return new S.t(function(e,t){e(!1)})};e.prototype.isPreventDownloadAllowed=function(){return!0};e.prototype.isBundleShare=function(){return!1};e.prototype.getSupportedAudienceOptions=function(){return[o.e.anyone,o.e.customLabeledSpecificPeople,o.e.existing,o.e.organization,o.e.specificPeople,o.e.specificPeopleFlex]};e.prototype.isOwner=function(){return this._storeContents.sharingInformation.userRole===l.e.owner};e.prototype.isSpecificPeopleExpirationAllowed=function(){return!1};e.prototype.showAudienceLearnMore=function(){return!0};e.prototype.showEmailsInSuggestions=function(){return!1};e.prototype.getFamily=function(){return null};e.prototype.getFamilyMembers=function(){return null};e.prototype.getCurrentUserId=function(){return null};e.prototype.isShared=function(){return this.getSharingInformation().isShared};e.prototype.getSharedObjectType=function(){return this.getSharingInformation().sharedObjectType};e.prototype.getItemInformationForLogging=function(){var e,t,n=!0,r=this.getSharingInformation();if(r.fileExtension){this._itemType=Object(B.e)(r.fileExtension);e=r.fileExtension}else if(r.sharedObjectType)this._itemType=P.e[r.sharedObjectType];else if(r.item){this._itemType=Object(B.t)(r.item);e=r.item.extension;n=r.item.itemType===H.e.File}n&&this._itemType&&"other"!==this._itemType&&(t=e);return{itemType:this._itemType,extension:t}};e.prototype.getSharingInformationAPIStats=function(){return this._getSharingInformationStats};e.prototype.getShareLinkAPIStats=function(){return this._getShareLinkStats};e.prototype._cleanupDefaultLink=function(){var e=this._storeContents.defaultLink;if(e){this.unshareLink(e.sharingLinkKind,e.shareId);this._storeContents.defaultLink=void 0}};e.prototype._emitChange=function(e){if(this._storeContents&&this._storeContents.sharingInformation){var t=this._storeContents.sharingInformation,n=this.getItemInformationForLogging(),r=n.itemType,i=n.extension;this._engagementHelper.setEngagementExtraData({webTemplateId:t.webTemplateId,itemUniqueId:t.itemUniqueId,itemType:r,extension:i})}for(var s=0,o=this._listeners;s<o.length;s++){(0,o[s])(e)}};e.prototype._studyEmitChangeUsage=function(e){new L.e({name:"emitChangeInvestigation"}).end({resultType:L.t.Success,extraData:Object(i.e)({emitChangePath:e},this._telemetryExtraData)})};e.prototype.getPermissionsViewSettings=function(){return{groupPivotHeader:C.A,manageGroupLink:"",itemStopSharingSupported:!0,supportedGroupTypes:[b.e.securityGroup,b.e.sharePointGroup]}};e.prototype.init3s=function(){this._fetchSubstrateToken()};e.prototype._fetchGraphToken=function(){var e=this,t=this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t?this._graphPeoplePickerHelper.getGraphToken().then(function(n){t=!!n;e._storeContents.sharingInformation.isGraphAvailable=t}):this._storeContents.sharingInformation.isGraphAvailable=!1};e.prototype._fetchSubstrateToken=function(){var e=this,t=this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();t?this._substratePeoplePickerHelper.getSubstrateToken().then(function(n){e._substratePeoplePickerHelper.init(n);t=!!n;e._storeContents.sharingInformation.isTsAvailable=t}):this._storeContents.sharingInformation.isTsAvailable=!1};e.prototype._fetchAdditionalAuthenticationTokens=function(){if(this._storeContents.sharingInformation){this._fetchGraphToken();this._fetchSubstrateToken()}};e.prototype._handleSharedLink=function(e,t){e.createdViaCopyLinkCommand=t||!1;var n=new W.e(e.url);if(this._sharingContextInformation&&this._sharingContextInformation.navId&&this._sharingContextInformation.optInSendNavIdInShareLink&&!n.getQueryParameter("nav")&&!j.t()){n.setQueryParameter("nav",this._sharingContextInformation.navId);e.url=n.toString()}this._sharingInformationInvalidated=!0;this.fetchSharingInformation(!0);this._storeContents.sharingLinkCreated=e;this._updateIsShared();this._studyEmitChangeUsage("handleSharedLink");this._emitChange({type:d.t.ShareLink})};e.prototype._getRoleValue=function(e){return e?g.e:g.r};e.prototype._getRoleString=function(e){return e===l.e.review?"roletype:Reviewer":e===l.e.edit?g.e:e===l.e.owner?g.n:e===l.e.manageList?g.t:g.r};e.prototype._configureLinkIfShareId=function(){var e=this,t=this._sharingContextInformation&&this._sharingContextInformation.shareId;if(t&&this._mode===s.e.copy){if("00000000-0000-0000-0000-000000000000"===t)this._storeContents.sharingLinkCreated=this._storeContents.sharingInformation.directLink;else{var n=this._storeContents.sharingInformation.sharingLinks.filter(function(t){return t.isActive&&t.shareId===e._sharingContextInformation.shareId})[0];this._storeContents.sharingLinkCreated=n||this._storeContents.sharingInformation.directLink}this._storeContents.sharingLinkCreated.createdViaCopyLinkCommand=!0}};e.prototype._removeLinkByShareId=function(e){var t=this;this._storeContents.sharingInformation.sharingLinks=this._storeContents.sharingInformation.sharingLinks.map(function(n){if(e===n.shareId){n.expiration=null;n.isActive=!1;n.shareId=E.e.Empty;n.url=null;t._removePrincipals(n.principals);t._removePrincipals(n.invitees);n.principals=[]}return n})};e.prototype._updateIsShared=function(){var e=this._storeContents.sharingInformation;if(e){for(var t=e.sharingLinks,n=e.sharingPrincipals,r=!1,i=0,s=t;i<s.length;i++){var o=s[i];o.isActive&&o.sharingLinkKind!==u.e.direct&&(r=!0)}r||(r=n.length>0);this._storeContents.sharingInformation.isShared=r}};e.prototype._getOwaUrl=function(e,t){var n,r,i="https://outlook.office.com/owa/",s=null===(r=null===(n=this._storeContents)||void 0===n?void 0:n.sharingInformation)||void 0===r?void 0:r.outlookEndpointHostUrl;s&&(i="https://".concat(s,"/owa/"));var o=encodeURIComponent(t);return"".concat(i,"?body=").concat(o,"&to=").concat(e.join(";"),"&path=/mail/action/compose")};e.prototype._resolveDefaultRecipients=function(e,t,n){var r=this,o=e||[],u=S.t.resolve();this._storeContents.isValidatingDefaultRecipients=e.length>0;if(!t){o=[];for(var a=[],f=0,l=e;f<l.length;f++){var c=l[f];a.push({alias:c})}u=this._sharingProvider.checkPermissions(a,this._item).then(function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];r.hasAccess||o.push(r.inputEntity)}})}u.then(function(){if(0!==o.length){for(var e=[],t=[],u={principalSource:15,principalType:13,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:1,allowSharePointGroups:!1,forceResolve:!0},a=0,f=o;a<f.length;a++){var l=f[a];e.push(r._peoplePickerProvider.resolve(l,u).then(function(e){t.push(e)}))}S.t.all(e).then(function(){r._storeContents.defaultRecipients={isConsumed:!1,recipients:t};r._storeContents.isValidatingDefaultRecipients=!1;r._studyEmitChangeUsage("resolveDefaultRecipients1");r._emitChange()},function(){r._storeContents.defaultRecipients={isConsumed:!1,recipients:[]};r._storeContents.isValidatingDefaultRecipients=!1;r._emitChange()})}else if(n===s.e.atMention){r._storeContents=Object(i.e)(Object(i.e)({},r._storeContents),{grantAccessResult:!0});r._studyEmitChangeUsage("resolveDefaultRecipients0");r._emitChange()}})};e.prototype._removeEmailQueryParamFromInvitationLink=function(e){var t=e.split("?");if(t.length>1){for(var n=[],r=0,i=t[1].split("&");r<i.length;r++){var s=i[r];-1===s.indexOf("email=")&&n.push(s)}var o=n.join("&");return"".concat(t[0],"?").concat(o)}return e};e.prototype._shareLink=function(e,t,n,r,a,c,v,m){var g=this;Object(I.s)("sharelink._shareLink.start");var y={emailData:n,emailSubject:r,items:[this._item],recipients:t,settings:{createLink:!0,sharingLinkKind:e.sharingLinkKind,expiration:e.expiration,updatePassword:e.updatePassword,password:e.password,shareId:v,inviteesToRemove:m,role:e.sharingRole}};y.settings.role||(y.settings.role=e.isEdit?l.e.edit:l.e.view);if(e.shareId&&e.shareId.length>0){y.settings.shareId=e.shareId;e.fetchLinkOnly&&(y.settings.createLink=!1)}var b=(new Date).getTime(),w=new L.e({name:"SharingShareLink.".concat(s.e[this._mode],".").concat(h.e[this._clientId]||"unknown")});this._getShareLinkStats={name:"ShareLinkInit",resultType:L.t.Success,duration:0};if((e.updatePassword||e.hasPassword&&e.shareId&&e.shareId.length>0)&&e.audience===o.e.anyone){y.settings.sharingLinkKind=u.e.flexible;y.settings.allowAnonymousAccess=!0}if(e.audience===o.e.anyone)if(e.trackLinkUsers){y.settings.allowAnonymousAccess=!1;y.settings.restrictShareMembership=!1;y.settings.trackLinkUsers=!0;y.settings.scope=p.e.anyone;y.settings.sharingLinkKind=u.e.flexible}else{y.settings.allowAnonymousAccess=!0;y.settings.restrictShareMembership=!1;y.settings.trackLinkUsers=!1;y.settings.scope=p.e.anyone}else if(e.audience===o.e.organization){y.settings.allowAnonymousAccess=!1;y.settings.restrictShareMembership=!1;y.settings.scope=p.e.organization}if(e.preventDownload){y.settings.role=l.e.restrictedview;e.sharingRole=l.e.restrictedview;y.settings.sharingLinkKind=u.e.flexible}if(e.audience===o.e.specificPeopleFlex||e.audience===o.e.customLabeledSpecificPeople){y.settings.restrictShareMembership=!0;y.settings.scope=p.e.specificPeople}var E=this.getDefaultRecipients();e.audience===o.e.customLabeledSpecificPeople&&E&&(y.recipients=E.recipients);if(e.isCreateOnlyLink){y.settings.role=l.e.submit;y.settings.description=e.description}if(this._sharingContextInformation&&this._sharingContextInformation.navId&&this._sharingContextInformation.optInSendNavIdInShareLink&&(!Object(z.t)(this._sharingContextInformation.navId)||this._sharingContextInformation.navId.length>1024)){this._storeContents.sharingInformation=Object(i.e)(Object(i.e)({},this._storeContents.sharingInformation),{error:f.t.invalidItem,errorCategory:f.e.shareLink,errorMessage:N.fr});w.end({resultType:L.t.Failure});this._getShareLinkStats={name:"ShareLink",resultType:L.t.Failure,duration:(new Date).getTime()-b,error:f.t.invalidItem};this._invokeShareStatsEvent(this._getShareLinkStats);this._emitChange({type:d.t.ShareLink})}else this._sharingProvider.shareLink(y).done(function(t){Object(I.s)("sharelink._shareLink.end");if(t.error){var n=t.error;g._storeContents.sharingInformation=Object(i.e)(Object(i.e)({},g._storeContents.sharingInformation),{error:n,errorCategory:f.e.shareLink,debugErrorMessage:n.message&&n.message.value,errorMessage:N.fn});try{429===n.status&&(g._storeContents.sharingInformation.errorMessage=N.Bo)}catch(e){}w.end({resultType:L.t.Failure});g._getShareLinkStats={name:"ShareLink",resultType:L.t.Failure,duration:(new Date).getTime()-b,error:t.error};g._invokeShareStatsEvent(g._getShareLinkStats);g._emitChange({type:d.t.ShareLink})}else{w.end({resultType:L.t.Success});g._getShareLinkStats={name:"ShareLink",resultType:L.t.Success,duration:(new Date).getTime()-b};g._invokeShareStatsEvent(g._getShareLinkStats);var r=t.link;e.audience===o.e.customLabeledSpecificPeople&&(r.audience=o.e.customLabeledSpecificPeople);r.sharingLinkKind===g._storeContents.sharingInformation.defaultSharingLink.sharingLinkKind&&c&&a&&0===g._storeContents.sharingInformation.sharingLinks.filter(function(e){return e.shareId===r.shareId}).length&&(g._storeContents.defaultLink=r);if(v){m&&g._removePrincipals(m);g._sharingInformationInvalidated=!0;g.fetchSharingInformation(!0);g._emitChange({type:d.t.ShareLink})}else g._handleSharedLink(r,a)}})};e.prototype._invokeShareStatsEvent=function(e){var t=new L.e,n=this._getSharingInformationStats&&this._getSharingInformationStats.resultType;e&&(n=e.resultType);var r={mode:s.e[this._mode],clientId:h.e[this._clientId]||"unknown",getData:JSON.stringify(this._getSharingInformationStats),setData:JSON.stringify(e)};t.end({name:"SharingStats",resultType:n,extraData:r})};e.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};e.prototype._getDefaultLink=function(){var e,t,n=this,r=new L.e({name:"SharingGetDefaultLink"}),i=this._sharingContextInformation.itemUrl;if(!i&&this._sharingContextInformation.serverRelativeItemUrl){var s=new M.e(this._sharingContextInformation.webAbsoluteUrl);i="".concat(s.authority).concat(this._sharingContextInformation.serverRelativeItemUrl)}var o=[];this._sharingContextInformation.defaultRecipients&&this._sharingContextInformation.defaultRecipients.length>0&&(o=this._sharingContextInformation.defaultRecipients.map(function(e){return{email:e}}));var u=this._sharingContextInformation.uniqueId;u||(u=null===(t=null===(e=this._storeContents)||void 0===e?void 0:e.sharingInformation)||void 0===t?void 0:t.itemUniqueId);var a=this._permissions?S.t.resolve(this._permissions):u?this._sharingService.getDefaultLinkByUniqueId(u||"",o,!0):this._sharingService.getDefaultLink(i,o,!0);Object(I.s)("sharelink.getDefaultLink.start");a.then(function(e){Object(I.s)("sharelink.getDefaultLink.end");var t=e[0],i=t.link,s=t.roles&&t.roles.indexOf("write")>=0;r.end({resultType:L.t.Success});var o=Object(A.k)(i.scope),u=Object(A.O)(o);n._handleSharedLink({allowsAnonymousAccess:"anonymous"===i.scope,audience:o,expiration:t.expirationDateTime,isActive:!0,isEdit:s,principals:[],shareId:t.id,sharingLinkKind:Object(A.L)(i.scope,s),sharingScope:u,url:i.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:""},!0)},function(e){r.end({resultType:L.t.Failure,extraData:{error:e}});var t="";try{t=JSON.stringify(e)}catch(e){}n._storeContents.sharingInformation={error:e,errorCategory:f.e.invite,errorMessage:N.fn,debugErrorMessage:t,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0};n._emitChange()})};e.prototype._dedupeRecipients=function(e){var t=[],n={};e.forEach(function(e){n[e.userId]=e});Object.keys(n).forEach(function(e){t.push(n[e])});return t};e.prototype._raceGSI=function(e,t,n){var r=this,i=this._sharingProvider.getSharingInformation(this._item,e,!0,null,t),s=this._prefetchGSI;S.t.race([s,i]).then(function(e){r._setGSIResponse(e,n)},function(e){r._setGSIError(e,n)})};e.prototype._checkPrefetchSupportExpansion=function(e,t){var n=window.g_expand;return!(!n||n.length<1)&&(!(n.indexOf("pickerSettings")<0)&&(!(n.indexOf("sharingLinkTemplates")<0)&&(!(e&&n.indexOf("permissionsInformation")<0)&&!(t&&n.indexOf("addressBarLinkSettings")<0))))};e.prototype._setGSIResponse=function(e,t){this._getSharingInformationStats={name:"GetSharingInformation",resultType:L.t.Success,duration:(new Date).getTime()-t,GSIsource:e.getSharingInformationSources};if(!this._storeContents.sharingInformation||!this._storeContents.sharingInformation.error){this._storeContents.sharingInformation=e;j.C()&&F.n()&&void 0!==this.getSharingInformation()&&this.parsePermissions();this._fetchAdditionalAuthenticationTokens();this.fetchPolicyTipInformation();this._configureLinkIfShareId();Object(O.e)(e.userPhotoCdnBaseUrl);this._emitChange({type:d.t.FetchSharingInformation})}};e.prototype._setGSIError=function(e,t){var n=Object(q.t)(null,q.e.api,e);this._getSharingInformationStats={name:"GetSharingInformation",resultType:L.t.Failure,duration:(new Date).getTime()-t,error:n.error};this._invokeShareStatsEvent();this._storeContents.sharingInformation=n;this._emitChange({type:d.t.FetchSharingInformation})};e.prototype._updateAccessMap=function(e,t){var n=this._storeContents.sharingInformation.sharingPrincipals;this._storeContents.sharingInformation.sharingPrincipals=n.map(function(n){var r,s,o;(null===(r=n.accessMap)||void 0===r?void 0:r.get(e))&&(null===(s=n.accessMap)||void 0===s||s.set(e,Object(i.e)(Object(i.e)({},null===(o=n.accessMap)||void 0===o?void 0:o.get(e)),{role:t})));return n})};return e})();t.e=X},,,function(e,t,n){"use strict";var r;(function(e){e[e.share=0]="share";e[e.copy=1]="copy";e[e.outlook=2]="outlook";e[e.nonOutlook=3]="nonOutlook";e[e.moreApps=4]="moreApps";e[e.mobileShareToTeams=5]="mobileShareToTeams";e[e.webShareToTeams=6]="webShareToTeams"})(r||(r={}));t.e=r}],Array(31),[function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0);function i(e,t,n,r){var i="",s=0;if(!e)return"";var o=e.length;for(s=0;s<o;s++){var u=e.charCodeAt(s),a=e.charAt(s);if(t&&("#"===a||"?"===a)){i+=e.substr(s);break}if(n&&"&"===a)i+=a;else if(u<=127)r||u>=97&&u<=122||u>=65&&u<=90||u>=48&&u<=57||t&&u>=32&&u<=95&&" \"%<>'&".indexOf(a)<0?i+=a:u<=15?i+="%0"+u.toString(16).toUpperCase():u<=127&&(i+="%"+u.toString(16).toUpperCase());else if(u<=2047){i+="%"+(192|u>>6).toString(16).toUpperCase();i+="%"+(128|63&u).toString(16).toUpperCase()}else if(55296!=(64512&u)){i+="%"+(224|u>>12).toString(16).toUpperCase();i+="%"+(128|(4032&u)>>6).toString(16).toUpperCase();i+="%"+(128|63&u).toString(16).toUpperCase()}else if(s<e.length-1){u=(1023&u)<<10;s++;u|=1023&e.charCodeAt(s);i+="%"+(240|(u+=65536)>>18).toString(16).toUpperCase();i+="%"+(128|(258048&u)>>12).toString(16).toUpperCase();i+="%"+(128|(4032&u)>>6).toString(16).toUpperCase();i+="%"+(128|63&u).toString(16).toUpperCase()}}return i}function s(e,t,n){var s="",o=!0;t&&(e=Object(r.e)(Object(r.e)({},t),e));for(var u in e){var a=e[u];if(!n||"object"!=typeof a&&a||"object"==typeof a&&a&&a.uriValue||"number"==typeof a||"boolean"==typeof a){o?o=!1:s+="&";var f=void 0;f="object"==typeof a&&a&&a.uriValue?a.uriValue:i("".concat(a));s+="".concat(u,"=").concat(f)}}return s}},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(168),i=(function(){function e(){this._initialized=!1;this._ignoreSWOffline=!1}e.prototype.onChange=function(e){var t=this;this._ensureInitialized();this._listeners.push(e);return function(){var n=t._listeners.indexOf(e);-1!==n&&t._listeners.splice(n,1)}};e.prototype.dispose=function(){this._events.dispose()};Object.defineProperty(e.prototype,"offline",{get:function(){return this._ignoreSWOffline?!navigator.onLine:!navigator.onLine||this._swOffline()},enumerable:!1,configurable:!0});e.prototype._ensureInitialized=function(){if(!this._initialized){this._initialized=!0;this._listeners=[];this._events=new r.e(window);this._events.on(window,"online",this._onStateChange.bind(this,"online"));this._events.on(window,"offline",this._onStateChange.bind(this,"offline"));this._events.on(window,"swonline",this._onStateChange.bind(this,"swonline"));this._events.on(window,"swoffline",this._onStateChange.bind(this,"swoffline"))}};e.prototype._onStateChange=function(e){this._swOffline()&&"online"===e&&(this._ignoreSWOffline=!0);var t=this.offline;this._listeners&&this._listeners.forEach(function(e){try{e(t)}catch(e){}})};e.prototype._swOffline=function(){return!(!window.__swstats||void 0===window.__swstats.offline)&&window.__swstats.offline};return e})()},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={uninitialized:-1,anyone:0,organization:1,specificPeople:2,existing:3}},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={none:1,pending:2,hasAccess:3}}],Array(23),[function(e,t,n){"use strict";n.d(t,"t",function(){return f});n.d(t,"e",function(){return l});var r=n(0),i=n(136),s=n(4),o=n(26),u=n(67),a=n(151),f="Missing Perf Goal",l=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;(null==t?void 0:t.perfGoalInMs)&&n.setTimeout(null==t?void 0:t.perfGoalInMs,{resultType:o.e.Failure,errorCode:f});return n}t.prototype.end=function(t){t&&t.extraData&&this.data.extraData&&(t=Object(r.e)(Object(r.e)({},t),{extraData:Object(r.e)(Object(r.e)({},this.data.extraData),t.extraData)}));t&&t.errorCode!==f&&(t=this._assessPerf(t));return e.prototype.end.call(this,t)};t.prototype._assessPerf=function(e){if(!this.endTime){var t=e.perfGoalInMs||this.data.perfGoalInMs;if(t&&e.resultType!==o.e.Failure){t<u.e.getTime()-this.startTime&&(e=Object(r.e)(Object(r.e)({},e),{resultType:o.e.Failure,errorCode:f,extraData:e.errorCode?Object(r.e)(Object(r.e)({},e.extraData),{innerErrorCode:e.errorCode}):void 0}))}}return e};return t})(Object(i.e)({eventName:"CustomerPromise,",shortEventName:"CustomerPromise"},{scenario:{isKey:!0,isPrefixingDisabled:!0,type:s.e.String},errorCode:{isPrefixingDisabled:!0,type:s.e.String},resultType:{typeRef:o.e,isPrefixingDisabled:!0,type:s.e.Enum},resultCategory:{isPrefixingDisabled:!0,type:s.e.String},extraData:s.e.Object,httpStatus:{isPrefixingDisabled:!0,type:s.e.Number},perfGoalInMs:{isPrefixingDisabled:!0,type:s.e.Number},duration:{isPrefixingDisabled:!0,type:s.e.Number},pillar:{isPrefixingDisabled:!0,type:s.e.String},veto:{isPrefixingDisabled:!0,type:s.e.String}})).withManager(Object(a.e)())},,,,function(e,t,n){"use strict";var r=n(138),i=function(e,t){this.width=0;this.height=0;this.width=e;this.height=t},s=(function(){function e(t,n,i,s){this.x=0;this.y=0;this.width=0;this.height=0;if(0===arguments.length){this.x=0;this.y=0;this.width=0;this.height=0}else if(t instanceof e){var o=t;this.x=o.x;this.y=o.y;this.width=o.width;this.height=o.height}else if(t instanceof r.e){var u=t,a=n;this.x=u.x;this.y=u.y;this.width=a.width;this.height=a.height}else if("object"==typeof t&&"number"==typeof t.left&&"number"==typeof t.top&&"number"==typeof t.width&&"number"==typeof t.height){var f=t;this.x=f.left;this.y=f.top;this.width=f.width;this.height=f.height}else{this.x=t;this.y=n;this.width=i;this.height=s}}e.prototype.clip=function(t){var n=new e(this);if(n.x<t.x){n.width-=t.x-n.x;n.x=t.x}n.getRight()>t.getRight()&&(n.width-=n.getRight()-t.getRight());if(n.y<t.y){n.height-=t.y-n.y;n.y=t.y}n.getBottom()>t.getBottom()&&(n.height-=n.getBottom()-t.getBottom());return n};e.prototype.contains=function(e){if(e instanceof r.e){var t=e;return t.x>=this.x&&t.y>=this.y&&t.x<=this.getRight()&&t.y<=this.getBottom()}var n=e,i=n.getPoint(),s=new r.e(n.getRight(),n.getBottom());return this.contains(i)&&this.contains(s)};e.prototype.getCenter=function(){return new r.e(this.x+this.width/2,this.y+this.height/2)};e.prototype.getLeft=function(){return this.x};e.prototype.getTop=function(){return this.y};e.prototype.getRight=function(){return this.x+this.width};e.prototype.getBottom=function(){return this.y+this.height};e.prototype.getPoint=function(){return new r.e(this.x,this.y)};e.prototype.getSize=function(){return new i(this.width,this.height)};e.prototype.inflate=function(t,n){var r,i;if("object"==typeof t){var s=t;r=s.width;i=s.height}else{r=t;i=n}return new e(this.x-r/2,this.y-i/2,this.width+r,this.height+i)};e.prototype.nudge=function(t){var n=new e(this);n.x<t.x?n.x=t.x:n.getRight()>t.getRight()&&(n.x=t.getRight()-n.width);n.y<t.y?n.y=t.y:n.getBottom()>t.getBottom()&&(n.y=t.getBottom()-n.height);return n};e.prototype.translate=function(t,n){var i;if(t instanceof r.e){var s=t;i=this.translate(s.x,s.y)}else{var o=t,u=n;i=new e(this.x+o,this.y+u,this.width,this.height)}return i};e.prototype.union=function(t){var n=Math.min(this.x,t.x),r=Math.min(this.y,t.y);return new e(n,r,Math.max(this.x+this.width,t.x+t.width)-n,Math.max(this.y+this.height,t.y+t.height)-r)};e.prototype.fit=function(t,n){var r=t;r=this.width&&this.height&&(n?this.width>r.width||this.height>r.height:this.width>r.width&&this.height>r.height)?this._scaleTo(t,n):this;var i=(t.width-r.width)/2,s=(t.height-r.height)/2;return new e(i+this.x,s+this.y,r.width,r.height)};e.prototype._scaleTo=function(t,n){var r=t.width/t.height,i=this.width/this.height,s=0,o=0;if((n?i:r)<(n?r:i)){o=t.height;s=i*t.height}else{s=t.width;o=t.width/i}return new e(this.x,this.y,s,o)};return e})();t.e=s},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return Qe});var r=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:active){.od-Share{border:3px solid}}.od-Share{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';border-radius:2px;min-height:130px}.od-Share.od-SimplifiedShare{border-radius:12px}.od-Share.od-Share--hasActivity{position:relative}.od-Share.od-Share--hasActivity:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-Share.od-Share--permissionsPivot{overflow:unset!important}[dir=ltr] .od-Share .ms-Button+.ms-Button{margin-left:13px}[dir=rtl] .od-Share .ms-Button+.ms-Button{margin-right:13px}.od-Share a{color:"},{theme:"link",defaultValue:"#0078d4"},{rawString:";text-decoration:none}.od-Share a:focus,.od-Share a:hover{color:"},{theme:"linkHovered",defaultValue:"#004578"},{rawString:";text-decoration:underline}.od-Share a:focus{outline:1px solid transparent}.od-Share button:not(.ms-Button):not(.od-Share-noFocusBorder):focus{outline:1px solid;outline-color:"},{theme:"black",defaultValue:"#000"},{rawString:'}.od-Share .od-Share-noFocusBorder:focus{outline:0;border:none}.od-Share .ms-Button--default{outline:transparent;position:relative}.od-Share .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share .ms-Button--default:focus:after{content:"";position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:'}@media screen and (-ms-high-contrast:active){.od-Share .ms-Button{outline:transparent;position:relative}.od-Share .ms-Button::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share .ms-Button:focus:after{content:"";position:absolute;top:-4px;right:-4px;bottom:-4px;left:-4px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}}.od-Share ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-Share .ms-Icon--ExcelLogo:before{color:#217346}.od-Share .ms-Icon--OneNoteLogo:before{color:#5c2d91}.od-Share .ms-Icon--PowerPointLogo:before{color:#d24726}.od-Share .ms-Icon--WordLogo:before{color:#2b579a}.od-Share .ms-Icon--PDF:before{color:#d24726}.od-Share.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-Share.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-Share .icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b;color:#0b6a0b;border-color:#0b6a0b;background-color:#f1f6f1}.od-Share .icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c;color:#004e8c;border-color:#004e8c;background-color:#f0f5f8}.od-Share .icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939;color:#201f1e;border-color:#201f1e;background-color:RGBA(#201f1e,.06)}.od-Share .icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e;color:#a4262c;border-color:#a4262c;background-color:RGBA(#a4262c,.06)}.od-Share .ms-Tooltip{pointer-events:none}.od-Share .ms-Spinner{position:absolute;top:50%;left:50%}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-Share .ms-Button{overflow:visible}}#od-Share-backButton-tooltip{position:relative}button.od-Share-backButton{z-index:1;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:16px;padding:0;position:inherit;left:inherit}button.od-Share-backButton#od-ShareToTeams-backButton{top:-40px}[dir=rtl] button.od-Share-backButton{transform:scale(-1,1)}button.od-Share-backButton:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}button.od-Share-backButton.absolute{position:absolute;top:8px}[dir=ltr] button.od-Share-backButton.absolute{left:8px}[dir=rtl] button.od-Share-backButton.absolute{right:8px}button.od-Share-backButton.priorView{top:14px}[dir=ltr] button.od-Share-backButton.priorView{left:16px}[dir=rtl] button.od-Share-backButton.priorView{right:16px}.od-Share-shareMainDiv{position:relative}.od-Share-spinnerHolder{align-items:center;display:flex;height:130px;justify-content:center}.od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.teams .ms-Checkbox-checkbox{border-radius:4px}.teams .ms-Button.ms-Button--default,.teams .ms-Button.ms-Button--primary{border-radius:3px;min-width:96px}.teams .ms-Button--default{box-shadow:0 2px 2px 0 rgba(37,36,36,.15);border:1px solid rgba(37,36,36,.15)}.teams .ms-Button--primary{box-shadow:0 2px 2px 0 rgba(98,100,167,.4)}.teams .ms-Button--primary.is-disabled{box-shadow:none;border:none}"}]);var s,o=n(202),u=n(242),a=n(335),f=n(203),l=n(55),c=n(5),h=n(465),p={view:1,edit:2,restrictedView:7},d=n(370),v=n(224),m=n(497),g=n(105),y=n("react-lib"),b=n("prop-types-lib"),w=n(46),E=n(23),S=n(15),x=n(491),T=n(214),N=n(419),C=n(10),k=n(28),L=n(1),A=n(74),O=n(22),M=n(66),_=n(14),D=n(58);(function(e){e[e.Family=0]="Family";e[e.FamilyMember=1]="FamilyMember"})(s||(s={}));var P=n(39),H=n(70),B=n(8),j=n(31),F=n(146),I=n(48),q=n(188),R=n(88),U=n(50),z=n(96),W=n(140),X=n(396),V=n(230),$=n(102),J=n(3),K=n(231),Q=n(43),G=(function(e){Object(r.r)(t,e);function t(t,n){var r=e.call(this,t)||this;r._initialLinkShown=!1;r._onLinkSettingsCancelClick=function(){r.setState({shouldCopyLinkToClipboard:!1},function(){r.props.onLinkPermissionsCancelClicked()})};r._onLinkSettingsApplyClicked=function(e){r.setState({shouldCopyLinkToClipboard:!0},function(){r.props.onLinkPermissionsApplyClicked(e)})};r._onCopyButtonClicked=function(e){r.setState({shouldCopyLinkToClipboard:!0},function(){r.props.onLinkPermissionsApplyClicked(e,!0)})};r._shareClickTime=n.shareClickTime;r._sharingClientMessenger=n.sharingClientMessenger;r.state={shouldCopyLinkToClipboard:!0};return r}t.prototype.render=function(){0;var e=this.props,t=e.sharingInformation,n=e.viewState,i=e.clientId,s=e.companyName,o=e.currentSettings,u=e.onShareHintClick,l=e.customLabeledAudienceConfig,c=e.displayUrl;switch(n){case J.e.linkSuccess:case J.e.copyLinkShortcut:var h={clientId:i,companyName:s,currentSettings:o,sharingInformation:t,onShareHintClick:u,linkRecipients:null,customLabeledAudienceConfig:l};if(!this._initialLinkShown){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():O.m(this._shareClickTime,this.props.clientId,f.e.copy,this.props.scenarioId,this.props.correlationId);this._initialLinkShown=!0}return n==J.e.linkSuccess?y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.a,Object(r.e)({},Object(R.e)(this.props),{shareType:a.e.copy,itemName:t.item.name,linkUrl:c,sharingHintProps:h,shouldCopyLinkToClipboard:this.state.shouldCopyLinkToClipboard,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,onRenderComplete:this.props.onShareNotificationRenderComplete,shouldWaitForSharingInfoBarInformation:this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:this.props.sharingInfoBarMessageTypeId}))):y.createElement(K.e,{singleComponent:!0,clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:this.props.currentSettings,sharingInformation:this.props.sharingInformation,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,hostOptions:this.props.hostOptions,onShareHintClick:this.props.onShareHintClick,onSendLinkClicked:this._onCopyButtonClicked.bind(this,this.props.currentSettings)});case J.e.modifyPermissions:return y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.i,Object(r.e)({},this.props,{doesCreate:!0,onCancel:this._onLinkSettingsCancelClick,onSelectedPermissionsChange:this._onLinkSettingsApplyClicked,showExistingAccessOption:!0,copyLinkShortcut:!0,onSelectedPeopleChange:function(){}})));default:return y.createElement("div",{className:"od-Share-spinnerHolder"},y.createElement(m.e,{className:"od-Share-spinner",label:L.Oe,type:g.t.large}))}};t.contextTypes={shareClickTime:b.number,sharingClientMessenger:b.object.isRequired};return t})(y.Component),Y=n(21),Z=n(83),ee=n(208),te=n(192),ne=n(164),re=n(30);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.ShareMain{display:flex;flex-direction:column;padding:24px;gap:10px}@media screen and (max-width:511px){.ShareMain{padding:16px}}.ShareMain-flex-row{width:100%;display:flex;flex-direction:row;align-items:center}.ShareMain-flex-row.space-between{justify-content:space-between}.ShareMain-flex-grow{display:flex;flex-grow:1}.ShareMain-flex-grow.flex-start{justify-content:flex-start}.ShareMain-action-footer{display:flex;flex-direction:row}.ShareMain-action-footer.flex-end{justify-content:flex-end}.ShareMain-sharedWithSection{width:8.75rem}@media screen and (max-width:375px){.ShareMain-sharedWithSection{width:6.75rem}}@media screen and (max-width:360px){.ShareMain-sharedWithSection{width:5.75rem}}.ShareMain-notShared i{font-size:.9375rem;height:1.625rem;width:1.625rem;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-radius:50%;text-align:center;color:#707070;line-height:1.625rem}.ms-ContextualMenu-linkContent i{display:inline-flex}.ShareMain-button i{font-size:.875rem}.ms-Tooltip-subtext{font-size:.75rem}"}]);var ie=n(382),se=n(318),oe=n(35),ue=n(109),ae=n(310),fe=n(492);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.SendLink-flex-column{display:flex;flex-direction:column;width:100%}.SendLink-flex-row{display:flex;flex-direction:row;width:100%}.SendLink-container{display:flex;flex-direction:column}.SendLink-messageBox-textfield{width:100%}.SendLink-messageBox-textfield .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}@supports (font:-apple-system-caption1){.SendLink-messageBox-textfield .ms-TextField-field::placeholder{font:-apple-system-caption1;height:auto}}.SendLink-field{font-size:.875rem;padding:10px 10px 10px 37px}.SendLink-fieldGroup{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-bottom:unset;border-radius:4px;height:80px}.SendLink-fieldGroup:after{border:unset}.SendLink-fieldGroup:hover{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-radius:4px}.SendLink-field{padding:10px 8px 6px 35px}.SendLink-fieldGroup{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-radius:4px}.SendLink-fieldGroup:after{border:unset}.SendLink-fieldGroup:hover{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-radius:4px}.SendLink-people-picker-container{width:100%;height:100%;max-height:126px;overflow:auto}.SendLink-permissions-button-container{align-self:center;height:100%}.SendLink-permissions-button:hover{background-color:transparent}.SendLink-relative{position:relative;width:100%}.SendLink-border{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-radius:4px;box-sizing:border-box;position:relative;width:100%}.SendLink-to{font-size:.875rem;font-weight:600;padding:12px 6px 12px 12px;white-space:nowrap}.SendLink-label{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin-top:6px;color:#707070;font-size:.875rem}.SendLink-label:focus-visible{outline:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}.SendLink-animation{box-sizing:border-box;border-bottom-left-radius:200px;border-bottom-right-radius:200px;border-bottom-width:2px;border-bottom-style:solid;box-sizing:border-box;-webkit-clip-path:inset(calc(100% - 2px) 0px 0px);clip-path:inset(calc(100% - 2px) 0px 0px);animation-name:animate-underline;animation-duration:.25s;width:100%;position:absolute;height:4px;z-index:1;bottom:0}@keyframes animate-underline{from{transform:scaleX(0)}to{transform:scaleX(1);transition-property:transform;transition-duration:.2s;transition-delay:cubic-bezier(0.1, 0.9, 0.2, 1)}}.SendLink-underline{box-sizing:border-box;border-bottom:1px solid "},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:";border-bottom-left-radius:200px;border-bottom-right-radius:200px;box-sizing:border-box;-webkit-clip-path:inset(calc(100% - 2px) 0px 0px);clip-path:inset(calc(100% - 2px) 0px 0px);width:100%;position:absolute;height:4px;bottom:0}.SendLink-underline.focused{border-bottom:2px solid "},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.SendLink-roleSelector-divider{background-color:#d1d1d1;align-self:center;width:1px}.SendLink-messageBox{position:relative;padding-top:12px}.SendLink-icon{position:absolute;padding-left:11px;padding-top:10px;bottom:unset;right:unset}.SendLink-primary{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.SendLink-warning{border-color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}.SendLink-error{border-color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}.SendLink-composeIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.SendLink-icon{padding-left:13px;padding-top:13px;bottom:unset;right:unset;font-size:.875rem}.SendLink-primary{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.SendLink-warning{border-color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}.SendLink-error{border-color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}"}]);var le=n(212),ce=n(184),he=n(241);pe.contextTypes={sharingStore:b.object.isRequired};function pe(e,t){var n=e.clientId,r=e.currentSettings,i=e.engagementExtraData,s=e.errorMessage,o=e.groupsMemberCount,u=e.linkRecipients,a=e.messageText,l=e.permissionsMap,c=e.permissionsLabel,h=e.sharingInformation,p=e.onInputChange,d=e.onRoleChange,v=e.onSelectedPeopleChange,m=e.onSendLinkMessageChange,g=t.sharingStore,b=y.useState(!1),E=b[0],S=b[1],x=y.useState(0),T=x[0],N=x[1],C=y.useState(!1),k=C[0],A=C[1],O=y.useRef(null),M=y.useRef(null),_=w.n(u),D=w.r(u,o),P=y.useMemo(function(){return be(r,s)},[s,r,u]);y.useEffect(function(){M.current&&N(M.current.clientHeight)},[u]);y.useEffect(function(){s&&S(!0)},[s]);var H=Object(ue.e)(function(e){return ye(e,g,i)}),B=Object(ue.e)(function(e){return me(m,e)});return y.createElement("div",{className:"SendLink-container"},y.createElement("div",{ref:O,className:"SendLink-flex-column SendLink-relative"},y.createElement("div",{className:"SendLink-flex-row SendLink-border"},y.createElement("div",{style:{height:T}},y.createElement("div",{className:"SendLink-to"},L.Cu)),y.createElement("div",{className:"SendLink-people-picker-container",ref:M},y.createElement(le.e,{clientId:n,defaultSelectedItems:u,disableGraph:g.shouldDisableGraphForPeopleSearch(),inputTextPlaceholder:0===u.length?L.m:L.y,oversharingExternalsWarning:_,oversharingGroupsWarning:D,peoplePickerRef:O,permissionsMap:l,pickerSettings:h.peoplePickerSettings,sharingInformation:h,sharingLinkKind:r.sharingLinkKind,onChange:v,onInputChange:p||null,onResolvedSuggestions:H,setPeoplePickerFocused:S,error:s,mode:f.e.share})),y.createElement("div",{className:"SendLink-roleSelector-divider",style:{height:T-10}}),y.createElement("div",{className:"SendLink-permissions-button-container",style:{height:T}},y.createElement(ce.e,{ariaLabel:L.Pn,menuPermissionOptions:ge(h,r),sharingRole:r.sharingRole,mode:f.e.share,clientId:n,onRoleChange:d,roleSelectorAs:ce.e}))),y.createElement(we,{focused:E,color:P,error:s})),s&&y.createElement(he.e,{className:"od-Simplified-Share-PeoplePickerErrorIcon",error:s,iconName:"Error",textColorType:P}),y.createElement("div",{className:"SendLink-messageBox"},y.createElement(fe.e,{className:"SendLink-messageBox-textfield",multiline:!0,resizable:!1,placeholder:L.Gn,ariaLabel:L.Gn,defaultValue:a,onGetErrorMessage:B,iconProps:ve,styles:de,onFocus:function(){A(!0)},onBlur:function(){return A(!1)}}),y.createElement(we,{focused:k,color:"primary"})),y.createElement("div",{className:"SendLink-label",tabIndex:0},c,"."))}var de={fieldGroup:["SendLink-fieldGroup"],field:["SendLink-field"]},ve={iconName:"Handwriting",className:"SendLink-composeIcon",styles:{root:["SendLink-icon"]}},me=function(e,t){e(t);return""},ge=function(e,t){return Object(A.t)({sharingInformation:e,audience:t.audience,mode:f.e.share})},ye=function(e,t,n){t.getEngagementHelper().peoplePickerLinkedinSuggestions(n,e);return e},be=function(e,t){return t?e.audience===l.e.specificPeople||e.audience===l.e.specificPeopleFlex?"error":"warning":"primary"},we=function(e){var t=e.focused,n=e.color,r=e.error;return y.createElement(y.Fragment,null,y.createElement("div",{className:t?"SendLink-animation SendLink-".concat(n):void 0}),y.createElement("div",{className:"SendLink-underline ".concat(t&&"focused"," ").concat(r&&"SendLink-".concat(n))}))},Ee=n(166);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.Footer-button{border-radius:4px;min-width:5.9375rem}[dir=rtl] .Footer-button{transform:scale(-1,1)}.Footer-button.Footer-button-copy{font-size:.875rem;font-weight:600;margin-right:12px}.Footer-button.Footer-button-copy.enabled{color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";background-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:";border-color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.Footer-button.Footer-button-copy.enabled:hover{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.Footer-button .Footer-button-icon.Footer-button-icon-hidden{visibility:hidden}.Footer-button .Footer-button-label.Footer-button-label-hidden{visibility:hidden}.Footer-button .Footer-send-button-spinner{top:0;left:0;position:unset}.Footer-button .Footer-copy-button-spinner{top:15%;left:45%;visibility:hidden}.Footer-button .Footer-copy-button-spinner.Footer-button-spinner-visible{visibility:visible}.Footer-button .Footer-button-text{font-size:.875rem;font-weight:600}.Footer-button .Footer-tooltip{max-width:250px;font-size:.75rem}.Footer-button .Footer-button-send-icon{font-size:1rem}"}]);var Se=n(200),xe=n(309),Te=n(92);function Ne(e){var t=y.useRef(),n=Object(ue.e)(function(){e.onShareTargetClicked(a.e.copy);setTimeout(function(){e.setCopyToastStatus(Te.e.closed)},3e3);setTimeout(function(){var e;null===(e=t.current)||void 0===e||e.dismiss()},3500)}),r=Object(ue.e)(function(){e.setCopyToastStatus(Te.e.closed);e.showLinkSettings()}),i=Object(ue.e)(function(){return e.setCopyToastStatus(Te.e.closed)}),s={iconName:"Link",className:"Footer-button-icon"},o="Footer-button-label",u="Footer-copy-button-spinner";if(e.copyLinkToastStatus===Te.e.inProgress){s.className+=" Footer-button-icon-hidden";o+=" Footer-button-label-hidden";u+=" Footer-button-spinner-visible"}var f=L.He,c=e.isSharingByCopyDisabled||(e.currentSettings.audience===l.e.specificPeople||e.currentSettings.audience===l.e.specificPeopleFlex)&&0===e.linkRecipients.length&&!!e.errorMessage;return y.createElement(ie.e,{content:f,delay:Se.e.long,componentRef:t},y.createElement(xe.e,{id:Ce,className:"Footer-button Footer-button-copy ".concat(!c&&" enabled"),iconProps:s,onClick:n,disabled:c},y.createElement("span",{className:o},L.We),y.createElement(m.e,{className:u,size:g.e.medium})),y.createElement(y.Suspense,{fallback:null},y.createElement(Q.p,{target:"#".concat(Ce),onDismiss:i,permissionsLabel:e.permissionsLabel,status:e.copyLinkToastStatus,onActionButtonClick:r})))}var Ce="copy-button";ke.contextTypes={sharingStore:b.object.isRequired};function ke(e,t){var n=e.engagementExtraData,r=e.createPeopleSharingLinks,i=e.currentSettings,s=e.errorMessage,o=e.isDisabled,u=e.linkRecipients,a=e.messageText,f=(e.permissionsLabel,e.permissionsMap),l=e.shareType,c=e.sharingInformation,h=e.unresolvedPeoplePickerText,p=e.showSendButtonSpinner,d=e.onSendLinkClicked,v=e.setErrorMessage,b=e.setIsDisabled,w=t.sharingStore,E=y.useState(!0);E[0],E[1];y.useEffect(function(){b(Oe(i,s,u,a,f,c))},[i,s,u,a,f,c]);var S=Object(ue.e)(function(){w.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked",n);Me(s,r,i,u,l,h,v)?d(a):b(!0)}),x=y.createElement("div",{className:"Footer-button-text"},L.To),T=Le;if(p&&!s){x=y.createElement(m.e,{className:"Footer-send-button-spinner",size:g.e.medium});T=void 0}var N="".concat(L.Tu);return y.createElement(ie.e,{id:"Send-button-tooltip-description",content:N,styles:Ae,delay:Se.e.long,directionalHint:re.e.topRightEdge},y.createElement(xe.e,{primary:!0,className:"Footer-button",iconProps:T,disabled:o,onClick:S,ariaLabel:L.To,"aria-describedby":"Send-button-tooltip-description"},x))}var Le={iconName:"Send",className:"Footer-button-send-icon"},Ae={root:["Footer-tooltip"]},Oe=function(e,t,n,r,i,s){var o=!1;if(e.audience===l.e.existing&&n)for(var u=0,a=n;u<a.length;u++){var f=a[u];if(void 0===i[f.email]&&void 0===i[f.userId]){o=!0;break}}return!!t||Object(C.B)(s)||o||Object(C.p)(r)>v.e},Me=function(e,t,n,r,i,s,o){if(!e){if(i!==a.e.share&&!t&&n.audience===l.e.specificPeople){for(var u=!1,f=!1,c=0,h=r;c<h.length;c++){var p=h[c];u||(u=p.isExternal&&!p.providerName);f||(f=!p.isExternal||p.isExternal&&!!p.providerName)}if(u&&f){o(y.createElement("span",{role:"alert","aria-live":"assertive"},L.Yn));return!1}}var d=n.audience===l.e.specificPeopleFlex||n.audience===l.e.specificPeople||i===a.e.share;if(s){o(y.createElement("span",{role:"alert","aria-live":"assertive"},L.Gu));return!1}if(0===r.length&&d){n.audience===l.e.specificPeopleFlex||(n.audience,l.e.specificPeople),o(y.createElement("span",{role:"alert","aria-live":"assertive"},L.Xi));return!1}return!0}},_e=n(207),De=n(213),Pe=n(76),He=n(114),Be=j.i(),je=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/outlook_48x1.svg"),Fe=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/teams_48x1.svg");Object(_.j)({icons:{outlookSVG:y.createElement("img",{src:je}),teamsSVG:y.createElement("img",{src:Fe})}});var Ie=n(225);qe.contextTypes={platformDetection:b.object.isRequired,shareClickTime:b.number,sharingClientMessenger:b.object,sharingStore:b.object.isRequired,onDismiss:b.func.isRequired};function qe(e,t){var n=e.clientId,r=e.copyLinkToastStatus,i=e.correlationId,s=e.createPeopleSharingLinks,o=e.currentSettings,u=e.engagementExtraData,l=e.groupsMemberCount,c=e.item,h=e.linkRecipients,p=e.messageText,d=e.permissionsMap,v=e.permissionsLabel,m=e.sharingInformation,g=e.outlookAvailability,b=e.fullscreenIframeMode,w=e.showSendButtonSpinner,E=e.scenarioId,x=e.renderBackButton,T=e.getGraphToken,N=e.onAudienceChange,C=e.onRoleChange,k=e.onShareTargetClicked,A=e.onSelectedPeopleChange,M=e.onSendLinkClicked,_=e.onSendLinkMessageChange,D=e.onViewPolicyTipClicked,P=e.showLinkSettings,H=e.showPermissionsList,B=e.setCopyToastStatus,j=e.returnToPreviousView,F=t.platformDetection,I=t.shareClickTime,q=t.sharingClientMessenger,R=t.sharingStore,U=t.onDismiss,z=y.useState([]),W=z[0],X=z[1],V=y.useState(null),$=V[0],J=V[1],K=y.useState(!1),Q=K[0],G=K[1],Y=y.useState(!1),Z=Y[0],ee=Y[1],te=y.useState(!1),ne=te[0],ie=te[1],se=y.useState(!1),oe=se[0],fe=se[1];y.useEffect(function(){q?q.sendShareReady():O.m(I,n,f.e.share,E,i)},[]);y.useEffect(function(){Je(o,h,d,m,D,J,fe)},[o,h,d,m]);var le=Object(ue.e)(function(e){return We(o,u,e,d,m,R,A,D,X,J,ee,fe)}),ce=Object(ue.e)(function(e){return $e(e,G)}),he=Object(ue.e)(function(e){return Ke(o,h,e,k,J)}),de=(function(e,t,n,r,i){var s=[];if((function(e,t){return S.g(e)&&t===He.e.available?He.e.available:Object(O.r)()})(n,r)===He.e.available){var o=S.o(n)?"font:OutlookLogo":"outlookSVG",u="".concat(L.Po," ").concat(L.Zr);s.push({key:"outlook",text:u,iconProps:{iconName:o},onClick:function(){return i(a.e.outlook)}})}else if(r===He.e.other){u="".concat(L.Po," ").concat(L.Er);s.push({key:"nonOutlook",text:u,iconProps:{iconName:"font:Mail"},onClick:function(){return i(a.e.nonOutlook)}})}if(Object(O.h)()){u="".concat(L.Po," ").concat(L.Xu);s.push({key:"outlook",text:u,iconProps:{iconName:"font:TeamsLogo"},onClick:function(){return i(a.e.mobileShareToTeams)}})}else if(t&&Be&&!e.isIE){o="teamsSVG",u="".concat(L.Po," ").concat(L.Xu);s.push({key:"webTeams",text:u,iconProps:{iconName:o},onClick:function(){return i(a.e.webShareToTeams)}});if(Object(O.f)()){var f="".concat(L.rr);s.push({key:"moreApps",text:f,iconProps:{iconName:"font:More"},onClick:function(){return i(a.e.moreApps)}})}}return{items:s,directionalHint:re.e.bottomRightEdge}})(F,b,n,g,k),ve=S.m(n),me=$;Z&&(me=null);return y.createElement("div",{className:"ShareMain"},y.createElement("div",null,y.createElement(ae.e,{mainHeaderText:Re(c.name),renderBackButton:x,onBackButtonClicked:j,actions:Ue(U,P,de,ve,ne)}),m.sensitivityLabelInformation&&y.createElement(Ie.e,{sensitivityLabelInformation:m.sensitivityLabelInformation,getGraphToken:T,engagementExtraData:u})),ze(m)&&y.createElement(pe,{clientId:n,currentSettings:o,engagementExtraData:u,errorMessage:me,groupsMemberCount:l,linkRecipients:h,messageText:p,permissionsMap:d,permissionsLabel:v,sharingInformation:m,onInputChange:ce,onRoleChange:C,onSelectedPeopleChange:le,onSendLinkMessageChange:_}),y.createElement("div",{className:"ShareMain-flex-row"},y.createElement("div",{className:"ShareMain-flex-grow space-between"},Ve(m,R,H)),y.createElement("div",{className:"ShareMain-action-footer flex-end"},y.createElement(Ne,{currentSettings:o,copyLinkToastStatus:r,errorMessage:$,linkRecipients:h,permissionsLabel:v,showLinkSettings:P,onShareTargetClicked:he,setCopyToastStatus:B,isSharingByCopyDisabled:oe}),y.createElement(ke,{engagementExtraData:u,currentSettings:o,createPeopleSharingLinks:s,linkRecipients:h,errorMessage:$,messageText:p,permissionsLabel:v,permissionsMap:d,shareType:a.e.share,sharingInformation:m,unresolvedPeoplePickerText:Q,showSendButtonSpinner:w,onSendLinkClicked:M,setErrorMessage:J,isDisabled:ne,setIsDisabled:ie}))),Xe(W,Z,N,J,ee,fe))}var Re=function(e){return Object(oe.n)(L.Nu,e)},Ue=function(e,t,n,r,i){return y.createElement(y.Fragment,null,y.createElement(Ee.e,{iconProps:{iconName:"Settings"},ariaLabel:L.jn,onClick:function(){t()},tooltipContent:L.jn,directionalHint:re.e.bottomAutoEdge}),n.items.length>0&&y.createElement(Ee.e,{menuIconProps:{iconName:"More"},ariaLabel:L.ir,tooltipContent:L.ir,menuProps:n,directionalHint:re.e.bottomAutoEdge,disabled:i}),r&&y.createElement(Ee.e,{iconProps:{iconName:"Clear"},ariaLabel:L.Le,onClick:function(t){t.stopPropagation();t.preventDefault();e()},tooltipContent:L.Le,directionalHint:re.e.bottomAutoEdge}))},ze=function(e){return!e.blockPeoplePickerAndSharing||Object(C.B)(e)},We=function(e,t,n,r,i,s,o,u,a,f,l,c){var h=w.u({selectedItems:n,sharingLinkKind:e.sharingLinkKind,canAddExternalPrincipal:i.canAddExternalPrincipal,sharingInformation:i,viewPolicyTipCallback:u,permissionsMap:r,audience:e.audience,setSharingByCopyIsDisabled:c,scope:e.sharingScope}),p=n.filter(function(e){return e.isExternal}),v=e.sharingScope===d.e.organization,m=i.canAddExternalPrincipal;if(v&&m&&p.length){l(!0);a(p);s.getEngagementHelper().externalSharingCslError(t)}f(h);o(n)},Xe=function(e,t,n,r,i,s){if(!t||!e.length)return null;return y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.t,{confirmationCode:_e.e.shareDialogExternalSharing,participant:null,participants:e,onApply:function(){i(!1);r(null);n(l.e.specificPeopleFlex,u.e.flexible,d.e.specificPeople);s(!1)},onCancel:function(){i(!1)}}))},Ve=function(e,t,n){var r=Object(C.C)(e,t.isConsumer()),i=r.shared,s=r.activeLinks,o=r.sharingPrincipals,u=t&&!t.isConsumer(),a=i?y.createElement("div",{className:"ShareMain-sharedWithSection"},y.createElement(De.e,{getPhotoUrl:Object(Pe.t)(e.webUrl),onClick:function(){n()},sharingLinks:s,sharingPrincipals:o,personaSizeInPixels:20,renderOverlap:!0})):y.createElement("div",{className:"ShareMain-notShared"},y.createElement(ie.e,{content:L.xr},y.createElement(se.e,{"aria-label":L.xr,iconName:"Lock"})));return u?a:null},$e=function(e,t){t(""!==e)},Je=function(e,t,n,r,i,s,o){if(t.length>0||r.errorCategory==h.e.shareLink){var u=w.u({selectedItems:t,sharingLinkKind:e.sharingLinkKind,canAddExternalPrincipal:r.canAddExternalPrincipal,sharingInformation:r,viewPolicyTipCallback:i,permissionsMap:n,audience:e.audience,setSharingByCopyIsDisabled:o,scope:e.sharingScope});u||r.errorCategory!=h.e.shareLink||(u=y.createElement("span",null,r.errorMessage));s(u)}else o(!1)},Ke=function(e,t,n,r,i){e.audience!==l.e.specificPeople&&e.audience!==l.e.specificPeopleFlex||0!==t.length?r(n,!0):i(y.createElement("span",{role:"alert","aria-live":"assertive"},L.Xi))},Qe=(function(e){Object(r.r)(t,e);function t(t,n){var i=e.call(this,t)||this;i._viewStates=[];i._shareMainControl=Object(y.createRef)();i._topLevelDivRef=y.createRef();i._copyLinkOnCancelClicked=function(){i._returnToPreviousView()};i._copyLinkOnApplyClicked=function(e,t){var n={currentSettings:e,linkRecipients:e.specificPeople,viewState:i.state.viewState};B.s()&&t&&(n.viewState=J.e.spinner);i.setState(n,function(){i._store.getEngagementHelper().linkSettingsApplyClicked(i._engagementExtraData);i._onCopyLinkClicked({copyLinkShortcut:!0})})};i._closeButtonOnBlur=function(){i.setState({isCloseButtonOnFocus:!1})};i._closeButtonOnFocus=function(){i.setState({isCloseButtonOnFocus:!0})};i._onAudienceChange=function(e,t,n){i.setState({currentSettings:Object(r.e)(Object(r.e)({},i.state.currentSettings),{audience:e,sharingLinkKind:t,sharingScope:n})})};i._onRoleChange=function(e){var t=Object(C.P)(e),n=e===o.e.view,s=e===o.e.review,a=e==o.e.manageList;if(!(t||n||s||a))throw new Error("Role not implemented: "+o.e[e]);var f=i.state.currentSettings,l=s||a?u.e.flexible:Object(C.w)(f.audience,t);f.sharingRole!==e&&i._store.getEngagementHelper().SharingRoleChangedFromCompactRoleSelector({isEdit:t,isReview:s});i.setState(Object(r.e)(Object(r.e)({},i.state),{currentSettings:Object(r.e)(Object(r.e)({},f),{sharingRole:e,isEdit:t,isReview:s,sharingLinkKind:l})}))};i._onShareTargetClicked=function(e,t){var n;switch(e){case a.e.outlook:n="outlookClicked";break;case a.e.webShareToTeams:n="webShareToTeamsClicked";break;case a.e.mobileShareToTeams:n="mobileShareToTeamsClicked";break;case a.e.nonOutlook:n="nonOutlookClicked";break;case a.e.copy:n="copyButtonClicked";break;case a.e.moreApps:n="moreAppsClicked"}if(e!==a.e.copy){var s=new X.e({scenario:Object(W.e)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:n}});if(B.n()){var o=Object(Y.n)(i.props.clientId);if(o){var u=new X.e({scenario:"".concat(o,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:n}});i._shareLinkCustomerPromise=[s,u]}else i._shareLinkCustomerPromise=[s]}else i._shareLinkCustomerPromise=[s]}i._store.getEngagementHelper().log("ShareV3.shareTargetClicked",Object(r.e)(Object(r.e)({},i._engagementExtraData),{shareType:e}));if(e!==a.e.share)if(e!==a.e.copy)e!==a.e.webShareToTeams?i.setState({shareType:e,shareTargetClicked:!0},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!1,shareType:e})}):i._onRedirectTeamsClicked();else{i._sharingClientMessenger?i._sharingClientMessenger.sendCopyLinkShareTargetClicked():O.t();i._onCopyLinkClicked({copyLinkShortcut:t})}};i._onLinkPermissionsApplyClicked=function(e){i._store.getEngagementHelper().linkSettingsApplyClicked(i._engagementExtraData);i._onSelectedPermissionsChange(e);if(i.props.mode===f.e.linkSettings){var t=new X.e({scenario:Object(W.e)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"linkSettingChangesApply"}});if(B.n()){var n=Object(Y.n)(i.props.clientId);if(n){var r=new X.e({scenario:"".concat(n,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"linkSettingChangesApply"}});i._shareLinkCustomerPromise=[t,r]}else i._shareLinkCustomerPromise=[t]}else i._shareLinkCustomerPromise=[t];i.setState({shareType:a.e.share,applyLinkSettingsClicked:!0},function(){var e=i.state.linkRecipients;if(S.h(i.props.clientId)){var t=i.state.currentSettings.sharingLinkKind;t!==u.e.organizationEdit&&t!==u.e.organizationView||(e=e.filter(function(e){return!e.isExternal}))}i._store.shareLink({settings:i.state.currentSettings,recipients:e,copyLinkCommand:!1})})}};i.setCopyToastStatus=function(e){i.setState({copyLinkToastStatus:e})};i._onLinkPermissionsCancelClicked=function(){i.props.mode===f.e.linkSettings&&(i._sharingClientMessenger?i._sharingClientMessenger.sendDismiss():O.i());i._returnToPreviousView()};i._returnToPreviousView=function(){if(i._viewStates&&i._viewStates.length){i.setState({viewState:i._viewStates.pop(),showTeamsDialog:!1},function(){var e,t;null===(t=null===(e=i._shareMainControl)||void 0===e?void 0:e.current)||void 0===t||t.shouldShowActivityIndicator(!1)});i.state.viewState===J.e.modifyPermissions&&i._store.getEngagementHelper().linkSettingsCancelClicked(i._engagementExtraData)}};i._hideElementsInManageAccess=function(e){i.props.hideElementsInManageAccess&&i.props.hideElementsInManageAccess(e)};i._onSelectedPeopleChange=function(e){var t=i.state.permissionsMap;i.state.currentSettings.audience===l.e.existing&&i._store.checkPermissions(e);i._store.resetPeoplePickerError();i.setState({linkRecipients:e,permissionsMap:t},function(){i._store.fetchGroupsMemberCount(e)})};i._onSendLinkClicked=function(e,t){var n=i.state.linkRecipients,r=new X.e({scenario:Object(W.e)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"sendLink"}});if(B.n()){var s=Object(Y.n)(i.props.clientId);if(s){var o=new X.e({scenario:"".concat(s,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"sendLink"}});i._shareLinkCustomerPromise=[r,o]}else i._shareLinkCustomerPromise=[r]}else i._shareLinkCustomerPromise=[r];i.setState({shareType:a.e.share,recipientsCount:n.length,externalRecipientsCount:w.e(n),linkedinRecipientsCount:w.t(n),hasMessage:!!e,hasSubject:!!t,messageLength:e?e.length:0,shareTargetClicked:!0,showSendButtonSpinner:!0},function(){i._sharingClientMessenger?i._sharingClientMessenger.sendShareSendClicked():O.w();i._store.shareLink({settings:i.state.currentSettings,recipients:n,emailMessage:e,emailSubject:t})})};i._onViewPolicyTipClicked=function(){i._viewStates.push(i.state.viewState);i.state.viewState!==J.e.policyDetails&&i.setState({viewState:J.e.policyDetails})};i._onSendLinkMessageChange=function(e){i.state.messageText!==e&&i.setState({messageText:e})};i._onSendLinkSubjectChange=function(e){i.state.subjectText!==e&&i.setState({subjectText:e})};i._getLabelProps=function(){return{clientId:i.props.clientId,companyName:i.state.companyName,currentSettings:i.state.currentSettings,customLabeledAudienceConfig:i.props.customLabeledAudienceConfig,sharingInformation:i.state.sharingInformation}};i._onInterruptUseNew=function(){i._store.getEngagementHelper().copyLinkInterruptEditLinkChosen(i._engagementExtraData);i.setState({shareType:a.e.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1,currentSettings:Object(r.e)(Object(r.e)({},i.state.currentSettings),{updatePassword:!0})},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!1})})};i._onInterruptUseExisting=function(){i._store.getEngagementHelper().copyLinkInterruptExistingLinkChosen(i._engagementExtraData);i.setState({shareType:a.e.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1,currentSettings:Object(r.e)(Object(r.e)({},i.state.currentSettings),{updatePassword:!1,password:null})},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!0})})};i._onInterruptCancel=function(){i._store.getEngagementHelper().copyLinkInterruptCancelled(i._engagementExtraData);i.setState({showCopyLinkInterrupt:!1});i._shareMainControl.current.shouldShowActivityIndicator(!1)};i._enterManageAccessView=function(){i._usePermissionsPivot?i.setState({viewState:J.e.permissionsPivot}):i.setState({viewState:J.e.permissionsList})};i._enterShareView=function(){i._store.getEngagementHelper().manageAccessLinkSectionShareClicked(i._engagementExtraData);B.N()||i._viewStates.push(i.state.viewState);i.setState({viewState:J.e.default})};i._enterGrantAccessView=function(){i._store.getEngagementHelper().manageAccessGrantAccessClicked(i._engagementExtraData);i.setState({viewState:J.e.addPeople})};i._showModifyPermissions=function(e,t){i._viewStates.push(i.state.viewState);i.setState({viewState:J.e.modifyPermissions,copyLinkShortcut:t},function(){i._store.getEngagementHelper().linkSettingsOpened(i._engagementExtraData,e)})};i._showPermissionsList=function(){i._viewStates.push(i.state.viewState);i._store.getEngagementHelper().manageAccessOpened(i._engagementExtraData);var e=i.props,t=e.invokeManageAccess,n=e.onManageAccessClicked,r=n&&!t;t?i._sharingClientMessenger?i._sharingClientMessenger.sendShareManageAccessClicked():O.u():r?n():i.setState({viewState:i._usePermissionsPivot||i._showSimplifiedDialog?J.e.permissionsPivot:J.e.permissionsList,showHeaderInManagedAccess:!0})};i._dismiss=n.onDismiss;i._resize=n.resize;i._store=n.sharingStore;i._shareClickTime=n.shareClickTime;i._sharingClientMessenger=n.sharingClientMessenger;i._isPeopleSharingLinksEnabled=!1;i._rumoneLogger=new V.e;i._usePermissionsPivot=B.k()||j.n()&&B.C()&&!i._store.isConsumer();i._platformDetection=n.platformDetection;i._showSimplifiedDialog=1===j.s()&&!i._platformDetection.isIE&&!i._platformDetection.isMobile&&!i.props.showItemInsights;var s=O.a(),h=t.theme;h||(h=O.s());(h&&i.props.clientId!==c.e.wac||s)&&i._loadTheme(s?Object(C.l)():h);i._sizeConstraints={maxHeight:S.o(i.props.clientId)?"none":i.props.maxHeight||"none",maxWidth:i.props.maxWidth||"none",overflowY:i._showSimplifiedDialog?"hidden":"auto",overflowX:"hidden"};var p,d=Object(ee.e)(location.search.substring(1)),v=d.migratedhosting&&"true"===d.migratedhosting.toLowerCase();i._engagementExtraData={isSimplifiedShareDialog:i._showSimplifiedDialog,clientId:t.clientId,scenarioId:t.scenarioId,correlationId:i._correlationId,hostSessionId:t.hostSessionId||"",mode:t.mode||(t.copyLinkShortcut?f.e.copy:f.e.share),isMigratedhosting:v,withSummary:!!i.props.summaryText,withSummaryFailed:!!i.props.summaryText&&-1!==i.props.summaryText.indexOf("Something went wrong with retrieving a summary")};B.T()?(p={companyName:null,currentSettings:null,sharingInformation:null,sharingLinkCreated:null,viewState:J.e.default,readyToCopy:!1,shareType:a.e.share,groupsMemberCount:0,policyTipInformation:null,linkRecipients:[],shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:{},messageText:t.messageText||"",summaryText:t.summaryText||"",subjectText:t.subjectText||"",isLoadingDefaultRecipients:i._store.isValidatingDefaultRecipients(),isCloseButtonOnFocus:!1,showCopyLinkInterrupt:!1,showTeamsDialog:!1,copyLinkToastStatus:Te.e.closed,showSendButtonSpinner:!0}).viewState=J.e.spinner:p=i._generateInitialStateFromStore();i.state=p;i._baseProps=Object(R.e)(t);i._correlationId=i.props.correlationId||I.e.generate();i._baseProps.correlationId=i._correlationId;i._resizeTracker=new F.e(n.resize);i._store.getEngagementHelper().log(H.r.Opening,i._engagementExtraData);return i}t.prototype.componentWillUnmount=function(){this._store.removeListeners&&this._store.removeListeners()};t.prototype.componentDidMount=function(){var e,t=this;try{var n=this._store,i=void 0;try{i=Object(q.e)(Object(q.n)(n.getAuthToken()));this._engagementExtraData.appId=i}catch(e){}if(!this._isOpenEventLogged){var s=Object(r.e)({},this._engagementExtraData),o=this._store.getNavId();if(o){s.isNavIdBase64=Object(ne.t)(o);s.navIdLength=o.length}this._store.getEngagementHelper().log(H.r.Opened,s);this._isOpenEventLogged=!0}new M.t(this).on(window,"keydown",function(e){e&&e.keyCode===P.e.escape&&t._handleEscKeyPress(e)});n.addListener(this._sharingStoreListener.bind(this));if(B.T()){var u=this.props.mode===f.e.manageAccess;n.fetchSuiteNavInformation();n.fetchSharingInformation(!0,u)}else if(this.props.copyLinkShortcut&&this.state.sharingInformation&&this.state.currentSettings&&!this.props.shareId&&!this.state.sharingInformation.error&&!this._copyLinkShortcutInvoked&&!this.state.sharingLinkCreated){this._copyLinkShortcutInvoked=!0;B.s()||this._onCopyLinkClicked({copyLinkShortcut:!0,initializedSettings:this.state.currentSettings,shareTargetClicked:!1})}n.fetchPolicyTipInformation();if(this.props.useVroomCreateDefaultLink&&!this._copyLinkShortcutInvoked&&this.props.mode===f.e.copy&&!this.props.shareId&&S.h(this.props.clientId)){this._copyLinkShortcutInvoked=!0;this._store.shareLink({settings:this.state.currentSettings,recipients:this.state.linkRecipients,copyLinkCommand:!0});this.setState({shareType:a.e.copy,shareTargetClicked:!0})}this._resizeIfNeeded();if(this.state.sharingInformation){var l=this.props.mode,h=this.state.viewState;if(this.state.viewState===J.e.default||this.state.viewState===J.e.copyLinkShortcut||this.state.viewState===J.e.linkSettings&&this.props.mode===f.e.linkSettings){setTimeout(function(){t._writeShareDataToRumoneLogger({mode:l,viewState:h})},0);this._isInitialPageLoadDataLogged=!0}this.state.viewState===J.e.linkSuccess&&this.props.mode===f.e.copy&&(this._isInitialPageLoadDataLogged=!0);null===(e=this.props.shareLoadingCustomerPromise)||void 0===e||e.forEach(function(e){return Object(Y.i)({customerPromise:e,engagementExtraData:t._engagementExtraData,sharingStore:t._store})})}var p=n.getSharingInformation();p.peoplePickerSettings||(p.peoplePickerSettings={});B._()&&(this.props.clientId===c.e.wac||this.props.clientId===c.e.word)&&Object(te.n)(p.fileExtension)&&(p.peoplePickerSettings.useNew3Ssearch=!0)}catch(e){this._setGenericErrorState(Y.e.generic,e)}};t.prototype.componentDidUpdate=function(){this._resizeIfNeeded();this.state.sharingInformation&&this._logRumone()};t.prototype.render=function(){var e,t,n=this;0;var i,s,o=this.props.copyLinkShortcut,a=this.state,f=a.sharingInformation,c=a.currentSettings,h=a.showActivityIndicator,p=a.sharingLinkCreated,d="od-Share ".concat(this._showSimplifiedDialog&&"od-SimplifiedShare"),v=!1;if(f&&c&&o&&(B.s()||p)&&this.state.viewState!==J.e.error&&this.state.viewState!==J.e.policyDetails){v=!0;i=this._renderPostCopyShortcutView()}else switch(this.state.viewState){case J.e.error:i=this._renderError(f);null===(e=this._shareLinkCustomerPromise)||void 0===e||e.forEach(function(e){return Object(Y.r)({customerPromise:e,rawErrorMessage:f.rawError||"generic share link failure",engagementExtraData:n._engagementExtraData,errorType:f.rawError?Y.e.api:Y.e.generic,sharingStore:n._store})});this._shareLinkCustomerPromise=void 0;break;case J.e.default:case J.e.shareToTeams:d+=h?" od-Share--hasActivity":"";v=!0;i=this._renderShareMain(this.state.sharingInformation,this.state.currentSettings);break;case J.e.modifyPermissions:v=!0;i=y.createElement(y.Fragment,null,this._renderModifyPermissions(J.e.modifyPermissions),this._renderActivityIndicator());break;case J.e.linkSuccess:null===(t=this._shareLinkCustomerPromise)||void 0===t||t.forEach(function(e){return Object(Y.i)({customerPromise:e,engagementExtraData:n._engagementExtraData,sharingStore:n._store})});this._shareLinkCustomerPromise=void 0;i=this._renderNotification();break;case J.e.permissionsList:v=!0;i=this._renderPermissionsList();break;case J.e.permissionsPivot:v=!0;i=this._renderPermissionsPivot();break;case J.e.policyDetails:i=y.createElement(y.Fragment,null,this._renderBackButtonForPolicyDetails(),this._renderPolicyDetails());break;case J.e.atMention:d="";i=this._renderAtMention();break;case J.e.linkSettings:d+=h?" od-Share--hasActivity":"";v=!0;i=y.createElement(y.Fragment,null,this._renderModifyPermissions(J.e.linkSettings));break;case J.e.notify:c.sharingLinkKind=u.e.direct;c.audience=l.e.existing;this._engagementExtraData=Object(r.e)(Object(r.e)({},this._engagementExtraData),{appMap:f.item.appmap});d="";i=y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.u,Object(r.e)({},this._baseProps,{currentSettings:c,sharingInformation:f,engagementExtraData:this._engagementExtraData,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig})));break;case J.e.addPeople:v=!0;i=this._renderAddPeople();break;case J.e.spinner:i=y.createElement("div",{className:"od-Share-spinnerHolder"},y.createElement(m.e,{className:"od-Share-spinner",label:L.Oe,size:g.e.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}}))}s=v||d?y.createElement("div",{className:d,style:v?this._sizeConstraints:void 0},i):i;var b=S.h(this.props.clientId)?" teams":"";return y.createElement(x.e,null,y.createElement("div",{ref:this._topLevelDivRef,role:"presentation",className:b+" isFluent"},s))};t.prototype._sharingStoreListener=function(e){var t,n,i=this,s=this._store;try{if(this.state.viewState===J.e.error)return;if(this.props.mode===f.e.copy&&e&&e.type===U.t.UnshareLink)return;B.C()&&j.n()&&s.parsePermissions&&void 0!==s.getSharingInformation()&&!s.isConsumer()&&s.parsePermissions();var o=s.getSharingInformation(),u=s.getSharingLinkCreated(),a=s.getCompanyName(),l=s.getGroupsMemberCount(),c=s.getPolicyTipInformation(),p=s.getPermissionsMap(),d=s.getDefaultRecipients();this._outlookAvailability=s.getOutlookAvailability();this._isPeopleSharingLinksEnabled=s.isPeopleSharingLinksEnabled();if(!o)return;o.webTemplateId&&(this._engagementExtraData.webTemplateId=o.webTemplateId);o.itemUniqueId&&(this._engagementExtraData.itemUniqueId=o.itemUniqueId);if(o.isStubFile){this._store.getEngagementHelper().shareErrorFileIsUploading(this._engagementExtraData);s.fetchSharingInformation(!0,!0)}var v=this._store.getItemInformationForLogging(),m=v.itemType,g=v.extension;this._engagementExtraData.itemType=m;this._engagementExtraData.extension=g;this._sanitizeSharingContextInfo(o);var y=this._getSettings(o),b=Object(r.e)({},this.state);if(this.state.viewState===J.e.spinner){b.viewState=this._getInitialViewState(o,y,u);b.viewState!==J.e.spinner&&(this._sharingClientMessenger?this._sharingClientMessenger.sendShareUIReady():O.N())}if((null==o?void 0:o.error)||(null==o?void 0:o.isStubFile)){if(o&&o.error&&(o.errorCategory===h.e.shareLink||o.errorCategory===h.e.shareObject||o.errorCategory===h.e.createLink||o.errorCategory===h.e.invite)){null===(t=this._shareLinkCustomerPromise)||void 0===t||t.forEach(function(e){return Object(Y.r)({customerPromise:e,rawErrorMessage:o.error,engagementExtraData:i._engagementExtraData,errorType:o.error?Y.e.api:Y.e.generic,sharingStore:i._store})});this._shareLinkCustomerPromise=void 0}else null===(n=this.props.shareLoadingCustomerPromise)||void 0===n||n.forEach(function(e){return Object(Y.r)({customerPromise:e,rawErrorMessage:(null==o?void 0:o.isStubFile)?new Error("Is stub file"):null==o?void 0:o.rawError,engagementExtraData:i._engagementExtraData,errorType:Y.e.api,sharingStore:i._store})});this._flushAriaAndReportError(o);o.errorCategory===h.e.shareLink&&this.props.mode!==f.e.copy&&b.viewState!==J.e.copyLinkShortcut?b.viewState=J.e.default:b.viewState=J.e.error;B.v()&&w.s(o.error)&&o.errorCategory===h.e.invite&&(b.viewState=this.state.viewState);b.sharingInformation=o}else if((e&&e.type===U.t.ShareLink||this.props.shareId)&&u&&(this.state.shareTargetClicked||this.props.copyLinkShortcut||this.state.applyLinkSettingsClicked)){var E=this._handleCreatedShareLink({settings:y,sharingInformation:o,sharingLinkCreated:u,viewState:b.viewState});b=Object(r.e)(Object(r.e)({},b),E)}else{if(this.props.copyLinkShortcut&&o&&!this.props.shareId&&!o.error&&!this._copyLinkShortcutInvoked){this._copyLinkShortcutInvoked=!0;B.s()||this._onCopyLinkClicked({copyLinkShortcut:!0,initializedSettings:y,shareTargetClicked:!1})}b=Object(r.e)(Object(r.e)({},b),{sharingInformation:o,companyName:a,groupsMemberCount:l,currentSettings:y,policyTipInformation:c,isLoadingDefaultRecipients:s.isValidatingDefaultRecipients(),showActivityIndicator:!1,permissionsMap:p});if(d&&!d.isConsumed){b.linkRecipients=d.recipients;this._store.consumeDefaultRecipients()}}if(B.R()&&!this.state.summaryText&&!b.summaryText){var S=s.getDocumentInformation();if(S&&S.documentSummary){b=Object(r.e)(Object(r.e)({},b),{summaryText:S.documentSummary});this._engagementExtraData.withSummary=!0;this._engagementExtraData.withSummaryFailed=-1!==S.documentSummary.indexOf("Something went wrong with retrieving a summary")}}if(B.U()&&this.props.shouldWaitForSharingInfoBarInformation&&!this.state.sharingInfoBarInformation&&!b.sharingInfoBarInformation){var x=s.getSharingInfoBarInformation();x&&x.sharingInfoBarMessageTypeId&&(b=Object(r.e)(Object(r.e)({},b),{sharingInfoBarInformation:x}))}this.setState(b)}catch(e){this._setGenericErrorState(Y.e.generic,e)}};t.prototype._handleCreatedShareLink=function(e){var t=e.sharingInformation,n=e.settings,i=e.sharingLinkCreated,o=e.initialState,u=e.viewState,l=this._store.getCompanyName(),c=o||this.state,h=Object(r.e)({},c);this._modifiedSharingLinkUrl=this._getModifiedSharingLinkUrl(i,c.shareType);var p=c.shareType,d=c.currentSettings,v=d?d.isEdit:n.isEdit,m=d?d.isReview:n.isReview,g=d?d.preventDownload:n.preventDownload,y=d?d.audience:n.audience,b=A.a(y,t.sharingAbilities,t.fileExtension),w=A.l(y,t.sharingAbilities,t.fileExtension),x=Object(r.e)(Object(r.e)({},this._engagementExtraData),{shareType:p,audience:i.audience,isEdit:v,isReview:w&&m,recipientsCount:c.recipientsCount,externalRecipientsCount:c.externalRecipientsCount,linkedinRecipientsCount:c.linkedinRecipientsCount,hasMessage:!!c.hasMessage,hasSubject:!!c.hasSubject,messageLength:c.messageLength,daysUntilExpiry:this._getNumberOfDaysUntilExpiry(i),sharingLinkKind:i.sharingLinkKind,isDefaultLink:t.defaultSharingLink.sharingLinkKind===i.sharingLinkKind,linkBlocksDownload:!!g,linkWithOfficeReviewMode:b&&m,shareViewState:u,hasNavId:!!this._store.getNavId(),sharingAudienceChanged:t.defaultSharingLink.audience!==i.audience,groupRecipientCount:c.linkRecipients.filter(function(e){return e.entityType===E.e.group&&null==e.familySharingTargetType}).length});if(S.y(this.props.clientId)){x.sharedToFamilyGroup=c.linkRecipients.some(function(e){return e.familySharingTargetType===s.Family});x.sharedToFamilyMember=c.linkRecipients.some(function(e){return e.familySharingTargetType===s.FamilyMember})}var T=this._store.getEngagementHelper();T.shareCompleted(x);T.logShareLinkGeneration(i,x);var N=Object(C.M)(i.sharingLinkKind);this._sharingClientMessenger?this._sharingClientMessenger.sendShareCompleted():O.x(c.shareType,N);h=Object(r.e)(Object(r.e)({},h),this._handleCreatedShareLinkForShareTypes(i,o));if(this.props.mode===f.e.linkSettings)O.p(i,l,this.props.customLabeledAudienceConfig,this.props.clientId);else{h=Object(r.e)(Object(r.e)({},h),{viewState:c.shareType===a.e.webShareToTeams?J.e.shareToTeams:J.e.linkSuccess,sharingLinkCreated:i,companyName:l,showActivityIndicator:!1,sharingInformation:t,currentSettings:this._getSettings(t)});this._showSimplifiedDialog&&this.props.mode!==f.e.copy&&p===a.e.copy&&(h=Object(r.e)(Object(r.e)({},h),{viewState:J.e.default}))}return h};t.prototype._handleCreatedShareLinkForShareTypes=function(e,t){var n,i=this,s=t||this.state,o=Object(r.e)({},s),u=s.shareType,l=this._store.getCompanyName();null===(n=this._shareLinkCustomerPromise)||void 0===n||n.forEach(function(e){return Object(Y.i)({customerPromise:e,engagementExtraData:i._engagementExtraData,sharingStore:i._store})});this._shareLinkCustomerPromise=void 0;if(u===a.e.outlook||u===a.e.nonOutlook)if(S.g(this.props.clientId)){this._store.navigateToOwa(this._getRecipientEmails(s.linkRecipients),this._modifiedSharingLinkUrl);this._sharingClientMessenger?this._sharingClientMessenger.sendOutlookClicked():O.d();this._dismiss()}else O.S(this._getRecipientEmails(this.state.linkRecipients),this.state.linkRecipients.length,this.state.messageText,this._modifiedSharingLinkUrl);else if(u===a.e.mobileShareToTeams){this._dismiss();this._sharingClientMessenger?this._sharingClientMessenger.sendTeamsClicked(e,this._getRecipientEmails(s.linkRecipients),s.messageText):O.T(e,this._getRecipientEmails(s.linkRecipients),s.messageText)}else if(u===a.e.moreApps)try{o=Object(r.e)(Object(r.e)({},o),{viewState:J.e.linkSuccess,companyName:l,sharingLinkCreated:e,showActivityIndicator:!1});window.external.SendLinkViaMoreApps(e.url)}catch(e){}else if(u===a.e.webShareToTeams){if(this._modifiedSharingLinkUrl){var c="https://teams.microsoft.com/share?href="+this._modifiedSharingLinkUrl+"&referrer=SharePoint.com";this._teamsUrl=c;o=Object(r.e)(Object(r.e)({},o),{showTeamsDialog:!0})}}else if(this._showSimplifiedDialog&&this.props.mode!==f.e.copy&&u===a.e.copy){o=Object(r.e)(Object(r.e)({},o),{companyName:l,sharingLinkCreated:e,showActivityIndicator:!1});var h={clientId:this.props.clientId,textField:null,linkUrl:this._modifiedSharingLinkUrl,itemName:this.state.sharingInformation.item.name};Object(C.u)(h).then(function(){i.setCopyToastStatus(Te.e.success)}).catch(function(e){return console.log("Error while copying link to clipboard",e)})}return o};t.prototype._generateInitialStateFromStore=function(){var e,t=this,n=this._store;B.C()&&j.n()&&n.parsePermissions&&void 0!==n.getSharingInformation()&&!n.isConsumer()&&n.parsePermissions();var i=n.getSharingInformation(),s=n.getSharingLinkCreated(),o=n.getCompanyName(),u=n.getGroupsMemberCount(),f=n.getPolicyTipInformation(),l=n.getPermissionsMap(),c=n.getDefaultRecipients();this._outlookAvailability=n.getOutlookAvailability();this._isPeopleSharingLinksEnabled=n.isPeopleSharingLinksEnabled();if(i){this._engagementExtraData.webTemplateId=i.webTemplateId;this._engagementExtraData.itemUniqueId=i.itemUniqueId;var h=this._store.getItemInformationForLogging(),p=h.itemType,d=h.extension;this._engagementExtraData.itemType=p;this._engagementExtraData.extension=d;if(i.isStubFile){this._store.getEngagementHelper().shareErrorFileIsUploading(this._engagementExtraData);n.fetchSharingInformation(!0,!0)}var v=this._getSettings(i),m=[];if(c&&!c.isConsumed){m=c.recipients||[];this._store.consumeDefaultRecipients()}var g=this._getInitialViewState(i,v,s);g!==J.e.spinner&&(this._sharingClientMessenger?this._sharingClientMessenger.sendShareUIReady():O.N());var y={companyName:o,currentSettings:v,sharingInformation:i,sharingLinkCreated:s,readyToCopy:!1,shareType:a.e.share,viewState:g,groupsMemberCount:u,policyTipInformation:f,linkRecipients:m,shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:l,messageText:this.props.messageText||"",summaryText:this.props.summaryText||"",subjectText:this.props.subjectText||"",isLoadingDefaultRecipients:this._store.isValidatingDefaultRecipients(),isCloseButtonOnFocus:!1,showCopyLinkInterrupt:!1,showTeamsDialog:!1,copyLinkToastStatus:Te.e.closed,showSendButtonSpinner:!1};if(i.error){null===(e=this.props.shareLoadingCustomerPromise)||void 0===e||e.forEach(function(e){return Object(Y.r)({customerPromise:e,rawErrorMessage:i.rawError,engagementExtraData:t._engagementExtraData,errorType:Y.e.api,sharingStore:t._store})});this._flushAriaAndReportError(i);return Object(r.e)(Object(r.e)({},y),{viewState:J.e.error,sharingInformation:i})}var b=n.getSharingLinkCreated();if(b){var w=this._handleCreatedShareLink({settings:v,sharingInformation:i,sharingLinkCreated:b,initialState:y,viewState:g});y=Object(r.e)(Object(r.e)({},y),w)}return y}return null};t.prototype._getInitialViewState=function(e,t,n){switch(this.props.mode){case f.e.share:if(e&&t)return J.e.default;break;case f.e.atMention:if(e&&t)return J.e.atMention;break;case f.e.linkSettings:if(t)return J.e.linkSettings;break;case f.e.manageAccess:if(t)return this._usePermissionsPivot?J.e.permissionsPivot:J.e.permissionsList;break;case f.e.copy:if(B.s())return J.e.copyLinkShortcut;if(e&&t&&n)return J.e.linkSuccess;break;case f.e.notify:if(e)return J.e.notify;break;case f.e.addPeople:if(e)return J.e.addPeople;break;default:throw new Error("Mode not implemented: "+this.props.mode)}return J.e.spinner};t.prototype._renderAtMention=function(){var e,t=this.props.callbacks?this.props.callbacks.onAtMentionComplete:void 0;return y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.e,Object(r.e)({},this._baseProps,{currentSettings:this.state.currentSettings,sharingInformation:this.state.sharingInformation,recipients:this.state.linkRecipients,canGrantEditPermissions:null===(e=this.props.hostOptions)||void 0===e?void 0:e.canGrantEditPermissions,onComplete:t})))};t.prototype._renderPostCopyShortcutView=function(){var e,t,n=this,i=this.state,s=i.sharingInformation,o=i.currentSettings,u=i.companyName,a=i.sharingLinkCreated,f=i.viewState,l=i.groupsMemberCount,c=a&&a.createdViaCopyLinkCommand||this._copyLinkShortcutInvoked;B.s()&&(c=!0);if(this._shareLinkCustomerPromise&&f===J.e.linkSuccess){null===(e=this._shareLinkCustomerPromise)||void 0===e||e.forEach(function(e){return Object(Y.i)({customerPromise:e,engagementExtraData:n._engagementExtraData,sharingStore:n._store})});this._shareLinkCustomerPromise=void 0}return y.createElement(G,Object(r.e)({},this._baseProps,{mode:this.props.mode,shareId:this.props.shareId,companyName:u,currentSettings:o,item:s.item,onLinkPermissionsApplyClicked:this._copyLinkOnApplyClicked,onLinkPermissionsCancelClicked:this._copyLinkOnCancelClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onShareHintClick:this._getNotificationHintClickHandler(c),sharingInformation:s,showExistingAccessOption:this.props.showExistingAccessOption,viewState:f,groupsMemberCount:l,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,displayUrl:this._modifiedSharingLinkUrl,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,hostOptions:this.props.hostOptions,onShareNotificationRenderComplete:a&&function(){n._writeShareDataToRumoneLogger({mode:n.props.mode,viewState:n.state.viewState})},shouldWaitForSharingInfoBarInformation:this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:null===(t=this.state.sharingInfoBarInformation)||void 0===t?void 0:t.sharingInfoBarMessageTypeId,onShowPermissionsListClicked:this._showPermissionsList}))};t.prototype._renderError=function(e){return y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.n,Object(r.e)({},this._baseProps,{viewState:J.e.error,sharingInformation:e,showReportProblem:this._store.isReportProblemSupported()})))};t.prototype._getSettings=function(e){var t,n=this,r=null===(t=this.state)||void 0===t?void 0:t.currentSettings,i=e&&e.error,s=e.sharingLinks&&e.sharingLinks.length&&this.props.shareId,u=A.i(e.sharingAbilities,e.sharingLinkTemplates),a=!1;if(!r&&!i){var f=e.defaultSharingLink;if(s){if(l=e.sharingLinks.filter(function(e){return e.shareId===n.props.shareId&&e.isActive})[0]){f=l;a=!0}}if(void 0!==u&&u.length>0){var l;if(l=u.filter(function(t){return t.sharingLinkKind===e.defaultSharingLink.sharingLinkKind})[0]){f=l;a=!0}else if(l=u.filter(function(t){return t.audience===e.defaultSharingLink.audience})[0]){f=l;a=!0}else{f=u[0];a=!0}}r=this._initializeCurrentSettings(f,e,this.props.copyLinkShortcut,a);if(u.length>0){r.shareId=f.shareId;r.fetchLinkOnly=!0;r.audience=f.audience;r.expiration=f.expiration;r.isEdit=f.isEdit;r.isReview=f.isReview;r.sharingRole=f.isEdit?Object(C.h)(this.props.clientId,e):f.isReview?o.e.review:o.e.view;r.trackLinkUsers=f.trackLinkUsers;r.preventDownload=f.blockDownload;r.sharingLinkKind=f.sharingLinkKind;this._engagementExtraData.isRedeemedUserResharing=!0;this._engagementExtraData.redeemedLinksCount=u.length}}return r};t.prototype._getRecipientEmails=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n].email;i&&t.push(i)}return t};t.prototype._getNumberOfDaysUntilExpiry=function(e){var t=e.expiration&&new Date(e.expiration),n=new Date;if(t){var r=(t.getTime()-n.getTime())/864e5;return Math.floor(r)}};t.prototype._handleEscKeyPress=function(e){this._viewStates.length>0?this._returnToPreviousView():this._dismiss();e.stopPropagation()};t.prototype._initializeCurrentSettings=function(e,t,n,r){if(this._store.isConsumer())return this._store.getInitialLinkSettings(e);if(t.requiresAccessApproval&&n)return{allowEditing:!0,audience:l.e.existing,expiration:null,isEdit:!0,sharingRole:Object(C.h)(this.props.clientId,t),sharingLinkKind:u.e.direct,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1,sharingScope:e.sharingScope};if(t.defaultSharingLink===e&&t.sharingAbilities)return this._initializeCurrentSettingsWithSharingAbilities(e,t,n);if(e.audience===l.e.specificPeople)if(!t.canManagePermissions||t.blockPeoplePickerAndSharing)e.audience=l.e.existing;else if(this._isPeopleSharingLinksEnabled)return{allowEditing:!0,audience:l.e.specificPeopleFlex,expiration:null,isEdit:!0,sharingRole:Object(C.h)(this.props.clientId,t),sharingLinkKind:u.e.flexible,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1,sharingScope:e.sharingScope};if(e.audience===l.e.specificPeopleFlex&&n&&!r){e.audience=l.e.existing;e.sharingLinkKind=u.e.direct}var i=e.sharingLinkKind,s=i===u.e.anonymousEdit||i===u.e.organizationEdit||i===u.e.direct||i===u.e.flexible,a=e.isEdit&&t.defaultShareLinkPermission===p.edit,f=[];this.props.shareId&&e.principals&&(f=Object(C.S)(e));return{allowEditing:s,audience:this.props.preferCustomLabeledAudience&&e.audience===l.e.specificPeopleFlex?l.e.customLabeledSpecificPeople:e.audience,expiration:e.expiration||null,isEdit:a,sharingRole:a?Object(C.h)(this.props.clientId,t):o.e.view,sharingLinkKind:e.sharingLinkKind,specificPeople:f,updatePassword:!1,password:"",preventDownload:e.blockDownload,shareId:"",trackLinkUsers:t.anyoneLinkTrackUsers,sharingScope:e.sharingScope}};t.prototype._initializeCurrentSettingsWithSharingAbilities=function(e,t,n){var r,i,s,a,f=t.sharingAbilities,c="00000000-0000-0000-0000-000000000000"===this.props.shareId,h=c?u.e.direct:t.defaultSharingLink.sharingLinkKind,v=c?d.e.existing:t.defaultSharingLink.sharingScope,m=Object(C.D)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig)?l.e.customLabeledSpecificPeople:l.e.specificPeople;if(t.defaultShareLinkToExistingAccess){m=l.e.existing;h=u.e.direct}else if(null!=v)switch(v){case d.e.anyone:m=l.e.anyone;break;case d.e.organization:m=l.e.organization;break;case d.e.specificPeople:m=l.e.specificPeopleFlex;break;case d.e.existing:default:if(c||!t.canManagePermissions||t.blockPeoplePickerAndSharing)m=l.e.existing;else if(this._isPeopleSharingLinksEnabled){m!==l.e.customLabeledSpecificPeople&&(m=l.e.specificPeopleFlex);h=u.e.flexible}else m=l.e.existing}else switch(h){case u.e.anonymousEdit:case u.e.anonymousView:m=l.e.anyone;break;case u.e.organizationEdit:case u.e.organizationView:m=l.e.organization;break;case u.e.direct:default:if(c||!t.canManagePermissions||t.blockPeoplePickerAndSharing)m=l.e.existing;else if(this._isPeopleSharingLinksEnabled){m!==l.e.customLabeledSpecificPeople&&(m=l.e.specificPeopleFlex);h=u.e.flexible}else m=l.e.existing}if(m===l.e.specificPeopleFlex&&n){m=l.e.existing;h=u.e.direct}var g=null,y=A.r(m,f).linkExpiration;(y?y.defaultExpirationInDays:null)>0&&(g=new Date((new Date).toDateString())).setDate(g.getDate()+y.defaultExpirationInDays);var b,w=A.s(m,f),E=w&&t.defaultShareLinkPermission===p.edit,S=E?Object(C.h)(this.props.clientId,t):o.e.view;(b=t.defaultShareLinkPermission===p.restrictedView)&&(S=o.e.restrictedview);var x=(null===(i=null===(r=this.props)||void 0===r?void 0:r.hostOptions)||void 0===i?void 0:i.hiddenAudienceOptions)||[],T=(null===(a=null===(s=this.props)||void 0===s?void 0:s.hostOptions)||void 0===a?void 0:a.disabledAudienceOptions)||[];m=-1===x.indexOf(m)&&-1===T.indexOf(m)?m:l.e.existing;A.o(m,f)&&(m=l.e.existing);return{allowEditing:w,audience:m,expiration:g,isEdit:E,sharingRole:S,isReview:!1,preventDownload:b,sharingLinkKind:m===l.e.existing?u.e.direct:h,specificPeople:[],updatePassword:!1,password:"",shareId:"",trackLinkUsers:t.anyoneLinkTrackUsers,sharingScope:e.sharingScope}};t.prototype._loadTheme=function(e){try{var t=e;Object(_._)(t)}catch(e){}};t.prototype._onRedirectTeamsClicked=function(){var e=this;this._store.getEngagementHelper().webShareToTeamsTargetClicked(this._engagementExtraData);this._store.getEngagementHelper().shareCompleted(this._engagementExtraData);this.setState({shareType:a.e.webShareToTeams,shareTargetClicked:!0,viewState:J.e.shareToTeams},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:a.e.webShareToTeams});e._viewStates.push(e.state.viewState)})};t.prototype._onCopyLinkClicked=function(e){var t;return Object(r.t)(this,void 0,void 0,function(){var n,i,s,o,u,f,c,h,p,d=this;return Object(r.i)(this,function(v){switch(v.label){case 0:n=e.copyLinkShortcut,i=e.initializedSettings,s=e.shareTargetClicked,o=void 0===s||s;u=Object(r.e)(Object(r.e)({sendInvitation:!1},i),null===(t=this.state)||void 0===t?void 0:t.currentSettings);this._copyTargetClickTime=Date.now();f=new X.e({scenario:Object(W.e)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"copyLink"}});if(B.n())if(c=Object(Y.n)(this.props.clientId)){h=new X.e({scenario:"".concat(c,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"copyLink"}});this._shareLinkCustomerPromise=[f,h]}else this._shareLinkCustomerPromise=[f];else this._shareLinkCustomerPromise=[f];return[4,this._store.shouldInterruptCopyLink(u.isEdit)];case 1:if(v.sent()){this._store.getEngagementHelper().copyLinkInterruptOpened(this._engagementExtraData);this.setState({showCopyLinkInterrupt:!0})}else{p=this.state.copyLinkToastStatus;this._showSimplifiedDialog&&(p=Te.e.inProgress);this.setState({shareType:a.e.copy,shareTargetClicked:o,copyLinkToastStatus:p},function(){var e=d.state.linkRecipients;d._store.isConsumer()&&d.state.currentSettings.audience!==l.e.specificPeople&&(e=[]);d._store.shareLink({settings:u,recipients:e,copyLinkCommand:n,shareType:a.e.copy})})}return[2]}})})};t.prototype._onOutlookClicked=function(){var e=this;this.setState({shareType:a.e.outlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onNonOutlookClicked=function(){var e=this;this.setState({shareType:a.e.nonOutlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onTeamsClicked=function(){var e=this;this.setState({shareType:a.e.mobileShareToTeams,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onMoreAppsClicked=function(){var e=this;this.setState({shareType:a.e.moreApps,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onSelectedPermissionsChange=function(e){var t=this.state.permissionsMap;e.audience===l.e.existing?this._store.checkPermissions(this.state.linkRecipients):t={};var n=J.e.default;this.props.mode===f.e.linkSettings?n=this.state.viewState:this._viewStates&&this._viewStates.length>0&&(n=this._viewStates.pop());this.setState({viewState:n,currentSettings:{allowEditing:e.allowEditing,trackLinkUsers:e.trackLinkUsers,audience:e.audience,expiration:e.expiration,isEdit:e.isEdit,isReview:e.isReview,sharingRole:e.sharingRole,sharingLinkKind:e.sharingLinkKind,specificPeople:e.specificPeople,updatePassword:e.updatePassword,password:e.password,hasPassword:e.hasPassword,preventDownload:e.preventDownload,shareId:e.shareId,fetchLinkOnly:e.fetchLinkOnly,requireSignIn:e.audience===l.e.specificPeople,sharingScope:e.sharingScope},permissionsMap:t})};t.prototype._renderBackButtonForPriorView=function(){if(this._viewStates.length>0)return D.t(y.createElement(N.e,{className:"od-Share-backButton absolute priorView",id:"od-Share-prevView-backButton",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:L.ne}),L.ne,{tooltipId:"od-Share-backButton-tooltip",position:re.e.bottomCenter,targetElementId:"od-Share-prevView-backButton"})};t.prototype._renderBackButtonForPolicyDetails=function(){if(this.state.viewState===J.e.policyDetails)return D.t(y.createElement(N.e,{className:"od-Share-backButton absolute",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:L.ne}),L.ne)};t.prototype._renderShareMain=function(e,t){var n;return y.createElement("div",{className:"od-Share-shareMainDiv"},!this._showSimplifiedDialog&&this._renderBackButtonForPriorView(),this._showSimplifiedDialog?y.createElement(qe,Object(r.e)({},this._baseProps,{key:"simplified-share",companyName:this.state.companyName,copyLinkToastStatus:this.state.copyLinkToastStatus,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,currentSettings:t,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,engagementExtraData:this._engagementExtraData,groupsMemberCount:this.state.groupsMemberCount,item:e.item,linkRecipients:this.state.linkRecipients,messageText:this.state.messageText,permissionsMap:this.state.permissionsMap,permissionsLabel:Object(C.g)(this._getLabelProps()),sharingInformation:e,outlookAvailability:this._outlookAvailability,fullscreenIframeMode:this.props.fullScreenIframeMode,getGraphToken:this.props.getGraphToken,onAudienceChange:this._onAudienceChange,onRoleChange:this._onRoleChange,onShareTargetClicked:this._onShareTargetClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._onSendLinkClicked,onSendLinkMessageChange:this._onSendLinkMessageChange,onViewPolicyTipClicked:this._onViewPolicyTipClicked,showLinkSettings:this._showModifyPermissions,showPermissionsList:this._showPermissionsList,setCopyToastStatus:this.setCopyToastStatus,showSendButtonSpinner:this.state.showSendButtonSpinner,returnToPreviousView:this._returnToPreviousView,renderBackButton:this._viewStates.length>0})):y.createElement(v.t,Object(r.e)({},this._baseProps,{key:"share",ref:this._shareMainControl,companyName:this.state.companyName,currentSettings:t,item:e.item,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._onSendLinkClicked,onShareHintClick:this._showModifyPermissions,onShowPermissionsListClicked:this._showPermissionsList,sharingInformation:e,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,linkRecipients:this.state.linkRecipients,permissionsMap:this.state.permissionsMap,messageText:this.state.messageText,summaryText:this.state.summaryText,subjectText:this.state.subjectText,onSendLinkMessageChange:this._onSendLinkMessageChange,onSendLinkSubjectChange:this._onSendLinkSubjectChange,onShareTargetClicked:this._onShareTargetClicked,hideShareDialogOverflowButton:this.props.hideShareDialogOverflowButton,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,outlookAvailability:this._outlookAvailability,engagementExtraData:this._engagementExtraData,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,closeButtonOnFocus:this._closeButtonOnFocus,closeButtonOnBlur:this._closeButtonOnBlur,onRoleChange:this._onRoleChange,onAudienceChange:this._onAudienceChange,fullScreenIframeMode:this.props.fullScreenIframeMode,getGraphToken:this.props.getGraphToken,hasBackButton:this.props.mode===f.e.manageAccess,showItemInsights:this.props.showItemInsights,shouldWaitForSharingInfoBarInformation:this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:null===(n=this.state.sharingInfoBarInformation)||void 0===n?void 0:n.sharingInfoBarMessageTypeId})),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!t.password}),this.state.showTeamsDialog&&this._renderTeamsDialog())};t.prototype._renderTeamsDialog=function(){return y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.l,{url:this._teamsUrl,onDismiss:this._dismiss,height:this.props.calculatedIframeHeight,onBackButtonClicked:this._returnToPreviousView.bind(this)}))};t.prototype._renderPolicyDetails=function(){return y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.f,{clientId:this.props.clientId,sharingInformation:this.state.sharingInformation,policyTipInformation:this.state.policyTipInformation}))};t.prototype._renderCopyLinkInterrupt=function(e){var t=e.updatePassword;return y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.t,{confirmationCode:t?12:13,participant:null,onApply:t?this._onInterruptUseNew:this._onInterruptUseExisting,onCancel:this._onInterruptCancel,onDiscard:t?this._onInterruptUseExisting:this._onInterruptUseNew}))};t.prototype._renderModifyPermissions=function(e){return y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.i,Object(r.e)({},this._baseProps,{shareId:this.props.shareId,mode:this.props.mode,companyName:this.state.companyName,currentSettings:this.state.currentSettings,doesCreate:!0,onCancel:this._onLinkPermissionsCancelClicked,onSelectedPermissionsChange:this.state.copyLinkShortcut?this._copyLinkOnApplyClicked:this._onLinkPermissionsApplyClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,sharingInformation:this.state.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,copyLinkShortcut:this.state.copyLinkShortcut,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onShowPermissionsListClicked:this._showPermissionsList})),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!this.state.currentSettings.password}))};t.prototype._renderNotification=function(){var e=this.state,t=e.sharingInformation,n=e.sharingLinkCreated,i={companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,clientId:this.props.clientId,onShareHintClick:this._getNotificationHintClickHandler(n.createdViaCopyLinkCommand),linkRecipients:e.shareType===a.e.share?this.state.linkRecipients:null,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig};return this._showSimplifiedDialog?y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.h,Object(r.e)({},Object(R.e)(this.props),{permissionsLabel:Object(C.g)(this._getLabelProps()),sharingHintProps:i,onSharedWithClick:this._showPermissionsList}))):y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.a,Object(r.e)({},Object(R.e)(this.props),{shareType:e.shareType,itemName:t.item.name,linkUrl:this._modifiedSharingLinkUrl,sharingHintProps:i,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,generatedFromTargetClick:e.shareTargetClicked})))};t.prototype._getNotificationHintClickHandler=function(e){return e?this._showModifyPermissions.bind(this,H.t.CopyLinkSettingsHint,e):null};t.prototype._renderPermissionsPivot=function(){var e=this;this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation||this._store.fetchSharingInformation(!0,!0);return y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.o,{engagementExtraData:this._engagementExtraData,sharingInformation:this.state.sharingInformation,clientId:this.props.clientId,onDefaultShare:function(){return e._showShare()},showCloseButton:!S.v(this.props.clientId),onDismiss:this._dismiss,store:this._store,companyName:this.state.companyName,onStopSharingClicked:this.props.onStopSharingClicked,pageContext:this.props.pageContext,advancedUrl:this.props.advancedUrl,mode:this.props.mode,backButtonClicked:this._returnToPreviousView,getGraphToken:this.props.getGraphToken,sensitivityLabelInformation:this.state.sharingInformation.sensitivityLabelInformation}))};t.prototype._showShare=function(){this._viewStates.push(this.state.viewState);this.setState({viewState:J.e.default})};t.prototype._renderPermissionsList=function(){this._store.isConsumer()?this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation||this._store.fetchSharingInformation(!0,!1):this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation&&this.state.sharingInformation.addressBarLinkSettings||this._store.fetchSharingInformation(!0,!0);var e=!1;A.u(this.state.currentSettings.audience,this.state.sharingInformation.sharingAbilities)&&(e=!0);this.state.sharingInformation&&this.state.sharingInformation.sharedObjectType===z.e.list&&B.c();B.N()&&this._viewStates.push(this.state.viewState);return y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.s,Object(r.e)({},this._baseProps,{onStopSharingClicked:this.props.onStopSharingClicked,centeredManageAccessEnabled:!0,grantAccessClicked:this._enterGrantAccessView,shareButtonClicked:this._enterShareView,showHeader:!0,advancedUrl:this.props.advancedUrl,mode:this.props.mode,companyName:this.state.companyName,sharingInformation:this.state.sharingInformation,linkRecipients:this.state.linkRecipients,groupsMemberCount:this.state.groupsMemberCount,backButtonClicked:this._returnToPreviousView,hideElementsInManageAccess:this._hideElementsInManageAccess,engagementExtraData:this._engagementExtraData,isInfectedFile:e})))};t.prototype._renderAddPeople=function(){var e=this,t=!this.props.hideShareDialogOverflowButton;return y.createElement(y.Suspense,{fallback:y.createElement(m.e,null)},y.createElement(Q.r,Object(r.e)({},this._baseProps,{backButtonClicked:this._enterManageAccessView,centeredManageAccessEnabled:!0,onManageExistingAccessClick:t?function(){return e._showPermissionsList()}:void 0,sharingInformation:this.state.sharingInformation,currentSettings:this.state.currentSettings,onViewPolicyTipClicked:this._onViewPolicyTipClicked})))};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return y.createElement(T.e,{message:L.z})};t.prototype._resizeIfNeeded=function(){j.i()&&this.state.viewState===J.e.shareToTeams||this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._getModifiedSharingLinkUrl=function(e,t){var n=e.url;if(t!==a.e.copy&&t!==a.e.outlook)return n;var r=this._getBase62Id(),i=new k.e(n);Object(Z.e)()||i.setQueryParameter("e",r);if(!this._store.getOptInSendNavIdInShareLink()){var s=this._store.getNavId();s&&i.setQueryParameter("nav",s)}if(B.b()){var o=this._store.getInvitationId();o&&i.setQueryParameter("inviteid",o)}return i.toString()};t.prototype._getBase62Id=function(){var e=new Uint8Array(6);(window.crypto||window.msCrypto).getRandomValues(e);for(var t=[],n=0;n<e.length;n++)t.push("abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e[n]%62]);return t.join("")};t.prototype._setGenericErrorState=function(e,t,n){var r,i=this,s=Object(Y.t)(this.state.sharingInformation,e,t,n);null===(r=this.props.shareLoadingCustomerPromise)||void 0===r||r.forEach(function(t){return Object(Y.r)({customerPromise:t,rawErrorMessage:s.rawError,engagementExtraData:i._engagementExtraData,errorType:e,sharingStore:i._store})});this.setState({sharingInformation:s,viewState:J.e.error});if(B.J()){window.parent.postMessage(JSON.stringify({name:"share_resetMakeVisible"}),"*")}};t.prototype._sanitizeSharingContextInfo=function(e){if(e){this._isSanitizedUrl(e.customizedExternalSharingServiceUrl)||(e.customizedExternalSharingServiceUrl="");this._isSanitizedUrl(e.fixItUrl)||(e.fixItUrl="");e.defaultSharingLink&&!this._isSanitizedUrl(e.defaultSharingLink.url)&&(e.defaultSharingLink.url="");e.directLink&&!this._isSanitizedUrl(e.directLink.url)&&(e.directLink.url="");if(e.sharingLinks)for(var t=0;t<e.sharingLinks.length;t++)e.sharingLinks[t]&&!this._isSanitizedUrl(e.sharingLinks[t].url)&&(e.sharingLinks[t].url="")}};t.prototype._isSanitizedUrl=function(e){return!e||0===e.length||0===e.toLowerCase().indexOf("http://")||0===e.toLowerCase().indexOf("https://")};t.prototype._logRumone=function(){var e,t,n=this,r=function(){n._isInitialPageLoadDataLogged=!0;var e=n.props.mode,t=n.state.viewState;setTimeout(function(){n._writeShareDataToRumoneLogger({mode:e,viewState:t})},0)},i=this.state.viewState===J.e.linkSuccess;this._showSimplifiedDialog&&this.state.copyLinkToastStatus===Te.e.success&&(i=!0);if((this.props.mode===f.e.share||this.props.mode===f.e.copy)&&this.state.shareTargetClicked&&i)e=n.props.mode,t=n.state.viewState,setTimeout(function(){n._writeCopyLinkTargetDataToRumoneLogger({mode:e,viewState:t,clickTime:n._copyTargetClickTime})});else if(this.state.viewState===J.e.linkSuccess&&this.props.mode===f.e.copy)this._isInitialPageLoadDataLogged=!0;else if(!this._isInitialPageLoadDataLogged)switch(this.props.mode){case f.e.share:this.state.viewState!==J.e.default||this.state.shareTargetClicked||r();break;case f.e.copy:this.state.viewState!==J.e.copyLinkShortcut&&this.state.viewState!==J.e.linkSuccess||this.state.shareTargetClicked||r();break;case f.e.manageAccess:this.state.viewState!==J.e.permissionsList&&this.state.viewState!==J.e.permissionsPivot||r();break;case f.e.linkSettings:this.state.viewState===J.e.linkSettings&&r();break;case f.e.atMention:this.state.linkRecipients.length>0&&r()}};t.prototype._writeShareDataToRumoneLogger=function(e){var t=e.mode,n=e.viewState,r=this.props.clickTime||this._store.getSharingClickTime()||performance.timing.navigationStart;this._writePerfData({pageTransitionType:$.e.fullPageLoad,startTime:r,mode:this.props.mode,originalMode:t,viewState:this.state.viewState,originalViewState:n,audience:this.state.currentSettings.audience})};t.prototype._writeCopyLinkTargetDataToRumoneLogger=function(e){if(this._rumoneLogger.resetRumOne()){var t=e.mode,n=e.viewState,r=e.clickTime;this._writePerfData({pageTransitionType:$.e.onePageAppNavigation,startTime:r,mode:f.e.copy,originalMode:t,viewState:this.state.viewState,originalViewState:n,audience:this.state.currentSettings.audience})}};t.prototype._writePerfData=function(e){var t=this,n=e.pageTransitionType,r=e.startTime,i=e.mode,s=e.originalMode,o=e.viewState,u=e.originalViewState,a=e.audience;if(this.props&&r&&this.props.clientId){var l=Object.keys(f.e).filter(function(e){return f.e[e]===i})[0],h=Object.keys(f.e).filter(function(e){return f.e[e]===s})[0],p=Object.keys(c.e).filter(function(e){return c.e[e]===t.props.clientId})[0],d=this._store.getSharingInformationAPIStats(),v=this._store.getShareLinkAPIStats(),m=this._store.getWaitSharingAPIsDuration?this._store.getWaitSharingAPIsDuration():null;0;var g=this._rumoneLogger.breakdownData,y={modeName:l,startTime:r,endTime:Date.now(),breakDownData:{sharingClientId:g(p),mode:g(l),audience:g(a),originalMode:g(h),viewState:g(o),originalViewState:g(u),getSharingInformationAPIStats:d?g(d):null,shareLinkAPIStats:v?g(v):null,realUserClickTime:g(r!==performance.timing.navigationStart),beforeNavigation:g(r<performance.timing.navigationStart?performance.timing.navigationStart-r:0),isInstantSecondLoad:!!this.props.isInstantSecondLoad,isLightSpeed:!0,waitSharingAPIsDuration:m}};0;this._rumoneLogger.logSharingPerformance(y,n)}};t.prototype._flushAriaAndReportError=function(e){var t=this,n=Promise.resolve();this.props.flushTelemetry&&(n=this.props.flushTelemetry());n.then(function(){setTimeout(function(){t._sharingClientMessenger?t._sharingClientMessenger.sendShareError(e):O.v(t._shareClickTime,t.props.clientId,t.props.mode,t.props.scenarioId,e,t._correlationId)},0)})};t.childContextTypes={hasTeamsLicense:b.bool};t.contextTypes={resize:b.func.isRequired,onDismiss:b.func.isRequired,sharingStore:b.object.isRequired,shareClickTime:b.number,shouldTeachingBubbleBeShown:b.func,onTeachingBubbleSeen:b.func,markTeachingBubbleAsDismissed:b.func,sharingClientMessenger:b.object,platformDetection:b.object.isRequired};return t})(y.Component)}],Array(54),[function(e,t,n){"use strict";var r=n(68),i=(function(){function e(e){var t=this;this.resolve=function(e){t._promise._completed(e)};this.reject=function(e){t._promise._error(e)};this._promise=new r.e(e)}Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0});e.prototype.getPromise=function(){return this._promise};e.prototype.cancel=function(){this._promise.cancel()};e.prototype.complete=function(e){this._promise._completed(e)};e.prototype.error=function(e){this._promise._error(e)};return e})();t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.anonymous=1]="anonymous";e[e.msa=2]="msa";e[e.aad=3]="aad"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={Network:1,Embed:3,App:4,View:5,Edit:6,Form:7,Direct:8,Organization:9,AppAccess:10,RequestAccess:11,None:100}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={Owner:0,View:1,Edit:2,Submitter:3,CoOwner:4,None:5,Review:6,Custom:7}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={generic:0,getSharingInformation:1,shareLink:2,shareObject:3,permissions:4,item:5,me:6,drive:7,invite:8,createLink:9};t.t={authFailure:1,serverFailure:2,invalidItem:3,invalidWebAbsoluteUrl:4,generic:5,objectNotSupported:6,invalidEmail:7,linkNoLongerAvailable:8}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(35);function i(e,t){void 0===t&&(t=!1);var n=new Date(e),i=n.getTimezoneOffset()<0,s=n.getFullYear()+"",o=Object(r.s)(n.getMonth()+1+"",2),u=Object(r.s)(n.getDate()+"",2),a=Object(r.s)(n.getHours()+"",2),f=Object(r.s)(n.getMinutes()+"",2),l=Object(r.s)(n.getSeconds()+"",2),c=(i?"+":"-")+Object(r.s)(i?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(r.s)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?s+"-"+o+"-"+u+"T"+a+":"+f+":"+l+c:s+o+u+"T"+a+f+l+c}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={anyone:0,organization:1,specificPeople:2}},function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r={none:0,allow:1,allowWithJustification:2},i={none:0,falsePositiveReported:1,overridden:2,falsePositiveReportedAndOverridden:3},s={override:0,reportFalsePositive:1}}],Array(19),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.default=0]="default";e[e.powerpoint=1]="powerpoint"})(r||(r={}))}])]);define("plt.odsp-common",[],{});