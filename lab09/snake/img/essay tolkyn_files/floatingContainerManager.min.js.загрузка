(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[19],{1726:function(t,e,n){var o={"./af-ZA/canvas-contextual.json":[1072,24],"./am-ET/canvas-contextual.json":[1073,26],"./ar-SA/canvas-contextual.json":[1074,28],"./as-IN/canvas-contextual.json":[1075,30],"./az-Latn-AZ/canvas-contextual.json":[1076,32],"./be-BY/canvas-contextual.json":[1077,33],"./bg-BG/canvas-contextual.json":[1078,35],"./bn-BD/canvas-contextual.json":[1079,36],"./bn-IN/canvas-contextual.json":[1080,38],"./bs-Latn-BA/canvas-contextual.json":[1081,40],"./ca-ES/canvas-contextual.json":[1082,42],"./ca-Es-VALENCIA/canvas-contextual.json":[1083,44],"./chr-Cher-US/canvas-contextual.json":[1084,45],"./cs-CZ/canvas-contextual.json":[1085,47],"./cy-GB/canvas-contextual.json":[1086,49],"./da-DK/canvas-contextual.json":[1087,51],"./de-DE/canvas-contextual.json":[1088,53],"./el-GR/canvas-contextual.json":[1089,55],"./en-GB/canvas-contextual.json":[1090,57],"./en-US/canvas-contextual.json":[1091,58],"./es-ES/canvas-contextual.json":[1092,60],"./es-MX/canvas-contextual.json":[1093,62],"./et-EE/canvas-contextual.json":[1094,64],"./eu-ES/canvas-contextual.json":[1095,66],"./fa-IR/canvas-contextual.json":[1096,68],"./fi-FI/canvas-contextual.json":[1097,70],"./fil-PH/canvas-contextual.json":[1098,72],"./fr-CA/canvas-contextual.json":[1099,74],"./fr-FR/canvas-contextual.json":[1100,76],"./ga-IE/canvas-contextual.json":[1101,78],"./gd-gb/canvas-contextual.json":[1102,80],"./gl-ES/canvas-contextual.json":[1103,82],"./gu-IN/canvas-contextual.json":[1104,84],"./ha-Latn-NG/canvas-contextual.json":[1105,85],"./he-IL/canvas-contextual.json":[1106,87],"./hi-IN/canvas-contextual.json":[1107,89],"./hr-HR/canvas-contextual.json":[1108,91],"./hu-HU/canvas-contextual.json":[1109,93],"./hy-AM/canvas-contextual.json":[1110,95],"./id-ID/canvas-contextual.json":[1111,97],"./is-IS/canvas-contextual.json":[1112,99],"./it-IT/canvas-contextual.json":[1113,101],"./ja-JP/canvas-contextual.json":[1114,103],"./ka-GE/canvas-contextual.json":[1115,105],"./kk-KZ/canvas-contextual.json":[1116,107],"./km-KH/canvas-contextual.json":[1117,109],"./kn-IN/canvas-contextual.json":[1118,111],"./ko-KR/canvas-contextual.json":[1119,113],"./kok-IN/canvas-contextual.json":[1120,115],"./ky-KG/canvas-contextual.json":[1121,116],"./lb-LU/canvas-contextual.json":[1122,118],"./lo-LA/canvas-contextual.json":[1123,120],"./lt-LT/canvas-contextual.json":[1124,122],"./lv-LV/canvas-contextual.json":[1125,124],"./mi-NZ/canvas-contextual.json":[1126,126],"./mk-MK/canvas-contextual.json":[1127,128],"./ml-IN/canvas-contextual.json":[1128,130],"./mn-MN/canvas-contextual.json":[1129,131],"./mr-IN/canvas-contextual.json":[1130,133],"./ms-MY/canvas-contextual.json":[1131,135],"./mt-MT/canvas-contextual.json":[1132,137],"./nb-NO/canvas-contextual.json":[1133,139],"./ne-NP/canvas-contextual.json":[1134,141],"./nl-NL/canvas-contextual.json":[1135,143],"./nn-NO/canvas-contextual.json":[1136,145],"./or-IN/canvas-contextual.json":[1137,147],"./pa-IN/canvas-contextual.json":[1138,149],"./pl-PL/canvas-contextual.json":[1139,151],"./prs-AF/canvas-contextual.json":[1140,152],"./pt-BR/canvas-contextual.json":[1141,154],"./pt-PT/canvas-contextual.json":[1142,156],"./qps-ploc/canvas-contextual.json":[1143,157],"./qps-ploca/canvas-contextual.json":[1144,158],"./qps-plocm/canvas-contextual.json":[1145,159],"./quz-PE/canvas-contextual.json":[1146,161],"./ro-RO/canvas-contextual.json":[1147,163],"./ru-RU/canvas-contextual.json":[1148,165],"./sd-Arab-PK/canvas-contextual.json":[1149,166],"./si-LK/canvas-contextual.json":[1150,167],"./sk-SK/canvas-contextual.json":[1151,169],"./sl-SI/canvas-contextual.json":[1152,171],"./sq-AL/canvas-contextual.json":[1153,173],"./sr-Cyrl-BA/canvas-contextual.json":[1154,175],"./sr-Cyrl-RS/canvas-contextual.json":[1155,177],"./sr-Latn-RS/canvas-contextual.json":[1156,179],"./sv-SE/canvas-contextual.json":[1157,181],"./sw-KE/canvas-contextual.json":[1158,182],"./ta-IN/canvas-contextual.json":[1159,184],"./te-IN/canvas-contextual.json":[1160,186],"./th-TH/canvas-contextual.json":[1161,188],"./tk-TM/canvas-contextual.json":[1162,189],"./tr-TR/canvas-contextual.json":[1163,191],"./tt-RU/canvas-contextual.json":[1164,193],"./ug-CN/canvas-contextual.json":[1165,195],"./uk-UA/canvas-contextual.json":[1166,197],"./ur-PK/canvas-contextual.json":[1167,199],"./uz-Latn-UZ/canvas-contextual.json":[1168,201],"./vi-VN/canvas-contextual.json":[1169,203],"./zh-CN/canvas-contextual.json":[1170,205],"./zh-TW/canvas-contextual.json":[1171,207]};function i(t){if(!n.o(o,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=o[t],i=e[0];return n.e(e[1]).then((function(){return n.t(i,3)}))}i.keys=function(){return Object.keys(o)},i.id=1726,t.exports=i},2767:function(t,e,n){"use strict";n.r(e);var o,i=n(71),a=n(5);!function(t){t[t.CommentThread=0]="CommentThread",t[t.TrackedChange=1]="TrackedChange"}(o||(o={}));var r,s,c;function d(t){switch(t){case o.CommentThread:return i.b.CommentThread;case o.TrackedChange:return i.b.TrackedChange;default:return i.b.CommentThread}}!function(t){t[t.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry"}(r||(r={})),function(t){t[t.Error=10]="Error",t[t.Warning=15]="Warning",t[t.Info=50]="Info",t[t.Verbose=100]="Verbose",t[t.Spam=200]="Spam"}(s||(s={})),function(t){t[t.containerVirtualizationEnabled=0]="containerVirtualizationEnabled"}(c||(c={}));var l,u=function(){function t(t,e,n){void 0===n&&(n=0),this.disableRepositioningAnimation=!1,this.positionFixed=!1,this.anchorLeft=0,this.shouldUpdatePositions=!1,this.aggregateHeight=0,this.possibleTopForNextContainer=0,this.renderMode=i.e.Integrated,this.constructContainerId=t,this.ulsLogger=e,this.activeContainerAnchorLeft=n}return t.prototype.getAggregateHeight=function(){return this.aggregateHeight},t.prototype.calculateNewPositions=function(t,e,n){this.disableRepositioningAnimation=!!n&&!!n.disableRepositioningAnimation,this.positionFixed=!!n&&!!n.positionFixed,this.shouldUpdatePositions=!n||!1!==n.shouldUpdatePositions;var o=t[0];if(this.anchorLeft=o&&o.anchorLeft?o.anchorLeft:0,n&&n.activeContainerInfo){var i=n.activeContainerInfo;this.updateContainerPositionsAroundActiveContainer(t,e,i)}else{var a=n?n.topOfFirstContainer:void 0;this.setRestPositionOfContainers(t,e,a)}},t.prototype.updateContainersPositions=function(t,e,n){this.calculateNewPositions(t,e,n)},t.prototype.updateContainerPositionsAroundActiveContainer=function(t,e,n){var o=e[n.containerId];if(o){var i=o.floatingContainerRef,c=this.shouldUpdatePositions&&i?i.height():o.position.height;this.shouldUpdatePositions&&i&&(i.anchorPoint().y!==o.anchorTop||i.anchorPoint().x!==this.activeContainerAnchorLeft)&&i.updateContainerPosition({anchorPoint:{x:this.activeContainerAnchorLeft,y:o.anchorTop},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(e,n.containerId,Object(a.__assign)(Object(a.__assign)({},o.position),{x:this.activeContainerAnchorLeft,y:o.anchorTop})),this.updateContainerPositionsAboveActiveContainer(t,e,o.anchorTop,n.containerPositionIndex-1),this.possibleTopForNextContainer=this.getBottomPositionOfContainer(o,o.anchorTop,c),this.updateContainerPositionsDownwards(t,e,n.containerPositionIndex+1),this.aggregateHeight=n.containerPositionIndex===t.length-1?c+o.anchorTop:this.aggregateHeight}else this.ulsLogger.sendTraceTag(595358743,r.msoulscat_Wac_Telemetry,s.Error,"Floating container info does not exist for the active container Id: ".concat(n.containerId))},t.prototype.updateContainerPositionsDownwards=function(t,e,n,o){void 0===n&&(n=0),void 0===o&&(o=!1);for(var i={},a=n;a<t.length;a+=1){if((r=t[a])&&r.contentId){if(!(s=this.getFloatingContainerInfo(r,e)))continue;i[r.contentId]=this.shouldUpdatePositions&&s.floatingContainerRef?s.floatingContainerRef.height():s.position.height}}for(a=n;a<t.length;a+=1){var r,s=this.getFloatingContainerInfo(t[a],e),c=(r=t[a])&&r.contentId;if(void 0===s||!c)return;var d=this.updateFloatingContainerPosition(t[a],e,i[c]);if(a===t.length-1&&s&&(this.aggregateHeight=i[c]+s.position.y),o&&d)return}},t.prototype.updateContainerPositionsAboveActiveContainer=function(t,e,n,o){var i=t[0]?t[0].anchorTop:void 0;this.setRestPositionOfContainers(t.slice(0,o+1),e,i);for(var r=n,s=o;s>=0;s-=1){var c=this.getFloatingContainerInfo(t[s],e);if(void 0===c||this.getBottomPositionOfContainer(c)<=r)return;var d=c.floatingContainerRef,l=r-(this.shouldUpdatePositions&&d?d.height():c.position.height)-10;this.shouldUpdatePositions&&d&&d.updateContainerPosition({anchorPoint:{x:this.anchorLeft,y:l},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(e,this.getContainerId(t[s]),Object(a.__assign)(Object(a.__assign)({},c.position),{x:this.anchorLeft,y:l})),r=l}},t.prototype.setRestPositionOfContainers=function(t,e,n){var o;if(t.length>0){var i=this.getFloatingContainerInfo(t[0],e);if(void 0===i)return;var a=null===(o=i.floatingContainerRef)||void 0===o?void 0:o.anchorPoint().y,r=this.shouldUpdatePositions&&void 0!==a&&!this.positionFixed?a:i.position.y;this.possibleTopForNextContainer=null!=n?n:Math.max(i.anchorTop,r),this.updateContainerPositionsDownwards(t,e,0)}},t.prototype.getFloatingContainerInfo=function(t,e){return e[this.getContainerId(t)]},t.prototype.getContainerId=function(t){var e=t.contentId;return this.constructContainerId({contentId:e,contentType:d(t.containerContentType),renderMode:this.renderMode})},t.prototype.updateFloatingContainerPosition=function(t,e,n){var o=this.getFloatingContainerInfo(t,e);if(void 0===o)return!1;var i=this.shouldUpdatePositions&&o.floatingContainerRef?o.floatingContainerRef.anchorPoint().y:o.position.y,r=Math.max(this.possibleTopForNextContainer,o.anchorTop);return r!==i&&(this.shouldUpdatePositions&&o.floatingContainerRef&&o.floatingContainerRef.updateContainerPosition({anchorPoint:{x:this.anchorLeft,y:r},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(e,this.getContainerId(t),Object(a.__assign)(Object(a.__assign)({},o.position),{x:this.anchorLeft,y:r}))),this.possibleTopForNextContainer=this.getBottomPositionOfContainer(o,r,n),r===i},t.prototype.getBottomPositionOfContainer=function(t,e,n){void 0===e&&(e=void 0),void 0===n&&(n=void 0);var o,i,a=t.floatingContainerRef,r=null==a?void 0:a.anchorPoint().y;return this.shouldUpdatePositions&&a&&void 0!==r?(o=r,i=a.height()):(o=t.position.y,i=t.position.height),(null!=e?e:o)+(null!=n?n:i)+10},t.prototype.updateFloatingContainerPositionInCache=function(t,e,n){t[e].position=n},t}(),p=n(2411),h=n(196);function C(){return l||(l=Object(h.a)())}var f,v=function(){function t(t){this.eventSink=t}return t.prototype.unsubscribe=function(){this.eventSink.unsubscribe(this)},t}(),g=function(){function t(){this.handlers=[]}return t.prototype.subscribe=function(t){var e=new v(this);return this.handlers.push({subscription:e,handler:t}),e},t.prototype.unsubscribe=function(t){this.handlers=this.handlers.filter((function(e){return e.subscription!==t}))},t.prototype.trigger=function(t){this.handlers.forEach((function(e){return e.handler(t,e.subscription)}))},t}(),I=function(){function t(t){this.onContainerShouldBeCreated=new g,this.motionDuration=p.b.duration4,this.posUpdateAnimationsInProgress=!1,this.containerVirtualizationEnabled=!1,this.enhancedContainerSelectorEnabled=!1,this.containerVisibilityUpdateRefactorisEnabled=!1,t&&(this.containerVirtualizationEnabled=!!t.containerVirtualizationEnabled),this.enhancedContainerSelectorEnabled=C().isChangeGateEnabled("EnhancedFloatingContainerSelector",Object(h.d)(6873658)),this.containerVisibilityUpdateRefactorisEnabled=C().isChangeGateEnabled("ContainerVisibilityUpdateRefactor",Object(h.d)(7050779))}return t.prototype.updateContainersVisibility=function(t,e,n,o,i){var a=this;if(void 0===n&&(n=!1),void 0===i&&(i=!1),e.height>0){var r={viewportTop:e.y-e.height/2,viewportBottom:e.y+1.5*e.height,containerIdToInfoMap:t,activeContainerId:o};if(!i&&!this.posUpdateAnimationsInProgress)return void this.handleContainerVirtualization(n,r);this.posUpdateAnimationsInProgress=!0,this.showContainersComingIntoViewport(r),setTimeout((function(){a.updatePositions(r,n),window.clearTimeout(a.hideContainersTimeout),a.hideContainersTimeout=window.setTimeout((function(){a.hideContainersOutsideViewport(r),a.posUpdateAnimationsInProgress=!1}),parseInt(a.motionDuration,10))}),0)}},t.prototype.handleContainerVirtualization=function(t,e){var n=this;Object.keys(e.containerIdToInfoMap).forEach((function(o){var i=n.extractContainerInfo(o,e);n.updateContainerVisibility(i,e.activeContainerId===o),n.updateContainerPosition(i,t)}))},t.prototype.showContainersComingIntoViewport=function(t){var e=this;Object.keys(t.containerIdToInfoMap).forEach((function(n){var o=e.extractContainerInfo(n,t);e.updateContainerVisibility(o,t.activeContainerId===n)}))},t.prototype.hideContainersOutsideViewport=function(t){var e=this;Object.keys(t.containerIdToInfoMap).forEach((function(n){var o=e.extractContainerInfo(n,t);e.updateContainerVisibility(o,t.activeContainerId===n)}))},t.prototype.updatePositions=function(t,e){var n=this;Object.keys(t.containerIdToInfoMap).forEach((function(o){var i=n.extractContainerInfo(o,t);n.updateContainerPosition(i,e)}))},t.prototype.updateContainerVisibility=function(t,e){if(t.containerRef&&t.containerElement)if(this.containerVisibilityUpdateRefactorisEnabled){var n=t.isContainerInViewport||e;t.containerElement.style.display=n?"block":"none",this.containerVirtualizationEnabled&&t.containerRef.updateContainerVirtualization(!n)}else(t.isContainerInViewport||e)&&"block"!==t.containerElement.style.display?(t.containerElement.style.display="block",this.containerVirtualizationEnabled&&t.containerRef.updateContainerVirtualization(!1)):t.isContainerInViewport||"none"===t.containerElement.style.display||(t.containerElement.style.display="none",this.containerVirtualizationEnabled&&t.containerRef.updateContainerVirtualization(!0))},t.prototype.updateContainerPosition=function(t,e){var n=t.containerElement;n&&(n.style.top="".concat(t.containerPosition.y,"px"),n.style.left="".concat(t.containerPosition.x,"px"),n.style.transitionDuration=e?"0ms":this.motionDuration)},t.prototype.extractContainerInfo=function(t,e){var n,o,i=e.containerIdToInfoMap[t],a=i.floatingContainerRef,r=i.position,s={containerElement:void 0,isContainerInViewport:r.y+r.height>=e.viewportTop&&r.y<=e.viewportBottom,containerRef:void 0,containerPosition:r};return a&&(s.containerRef=a,s.containerElement=this.enhancedContainerSelectorEnabled?null===(n=document.getElementById(a.parentDivId()))||void 0===n?void 0:n.querySelector("[id ^= 'floatingContainerView']"):null===(o=document.getElementById(a.parentDivId()))||void 0===o?void 0:o.firstChild),s},t}(),m=n(15),y=n(2403),b=n(284),T=n(4),x=n(31),P=n(44);!function(t){t[t.Enablement=1]="Enablement",t[t.Focus=2]="Focus",t[t.Hover=3]="Hover",t[t.Resize=4]="Resize",t[t.Visibility=5]="Visibility"}(f||(f={}));var A,R=n(246);function E(t,e){return{type:t,payload:e}}!function(t){t.ChangeRenderedContentIdentifierType="CHANGE_RENDERED_CONTENT_IDENTIFIER",t.EmptyActionType="",t.RemoveVisibilityAnimationType="REMOVE_VISIBILITY_ANIMATION",t.RepositionType="REPOSITION_FLOATING_CONTAINER",t.SetContentType="SET_CONTENT",t.UpdateContainerVirtualizationType="UPDATE_FLOATING_CONTAINER_VIRTUALIZATION",t.UpdateContainerVisibilityType="UPDATE_FLOATING_CONTAINER_VISIBILITY",t.UpdateContentMaxDimensionsType="UPDATE_CONTENT_MAX_DIMENSIONS",t.UpdateContentSetItemDetailsType="UPDATE_CONTENT_SET_ITEM_DETAILS"}(A||(A={}));var S={anchorPoint:{x:0,y:0}};function F(t,e){var n;return void 0===e&&(e=S),{anchorPoint:e.anchorPoint,contentIdentifier:t,disableRepositioningAnimation:!1,isVisible:!1,isVirtualized:!1,maxDimensions:e.maxDimensions||{},positionFixed:!1,useVisibilityAnimation:!1,accessibilityMetadata:null!==(n=e.accessibilityMetadata)&&void 0!==n?n:{}}}var j={contentId:"",contentType:i.b.Empty};function O(t,e){switch(void 0===t&&(t=F(j)),void 0===e&&(e=E(A.EmptyActionType,{})),e.type){case A.ChangeRenderedContentIdentifierType:return function(t,e){if(t.contentIdentifier.contentId===e.payload.newContentIdentifier.contentId&&t.contentIdentifier.contentType===e.payload.newContentIdentifier.contentType)return t;return Object(a.__assign)(Object(a.__assign)({},t),{contentIdentifier:e.payload.newContentIdentifier})}(t,e);case A.RemoveVisibilityAnimationType:return function(t){return Object(a.__assign)(Object(a.__assign)({},t),{useVisibilityAnimation:!1})}(t);case A.RepositionType:return function(t,e){if(t.anchorPoint.x===e.payload.anchorPoint.x&&t.anchorPoint.y===e.payload.anchorPoint.y&&t.disableRepositioningAnimation===e.payload.disableRepositioningAnimation&&t.positionFixed===e.payload.positionFixed)return t;return Object(a.__assign)(Object(a.__assign)({},t),{anchorPoint:e.payload.anchorPoint,disableRepositioningAnimation:e.payload.disableRepositioningAnimation,positionFixed:e.payload.positionFixed})}(t,e);case A.SetContentType:return function(t,e){return Object(a.__assign)(Object(a.__assign)({},t),{content:e.payload.content,isVisible:!!e.payload.content&&t.isVisible})}(t,e);case A.UpdateContentMaxDimensionsType:return function(t,e){if(t.maxDimensions.height===e.payload.maxDimensions.height&&t.maxDimensions.width===e.payload.maxDimensions.width)return t;return Object(a.__assign)(Object(a.__assign)({},t),{maxDimensions:e.payload.maxDimensions})}(t,e);case A.UpdateContentSetItemDetailsType:return function(t,e){var n,o=null===(n=t.accessibilityMetadata)||void 0===n?void 0:n.setItem,i=e.payload.setItemDetails;if(o===i)return t;if(o&&i&&o.positionInSet===i.positionInSet&&o.setSize===i.setSize&&o.level===i.level)return t;return Object(a.__assign)(Object(a.__assign)({},t),{accessibilityMetadata:Object(a.__assign)(Object(a.__assign)({},t.accessibilityMetadata),{setItem:i})})}(t,e);case A.UpdateContainerVisibilityType:return function(t,e){return Object(a.__assign)(Object(a.__assign)({},t),{isVisible:e.payload.isVisible,useVisibilityAnimation:e.payload.useVisibilityAnimation})}(t,e);case A.UpdateContainerVirtualizationType:return function(t,e){return Object(a.__assign)(Object(a.__assign)({},t),{isVirtualized:e.payload.isVirtualized})}(t,e);default:return t}}function w(t){return E(A.SetContentType,{content:t})}var _=function(t){return t.isVirtualized},D=n(45),k=n(812),M=Object(D.bb)({from:{opacity:0,visibility:"visible"},to:{opacity:1}}),V=Object(D.bb)({from:{opacity:1,visibility:"visible"},to:{opacity:0,visibility:"hidden"}}),U=Object(k.c)((function(t,e,n,o){return{floatingContainerView:Object(D.eb)({animationName:e?t?M:V:void 0,animationDuration:"".concat(300,"ms"),animationTimingFunction:p.c.decelerate,background:"transparent",position:o?"fixed":"absolute",transitionDuration:t&&!n?p.b.duration4:"0s",transitionProperty:"top, left",transitionTimingFunction:p.c.decelerate,visibility:t?"visible":"hidden"})}}));var N=n(2686),L=n(647);function z(t){return"floatingContainerView".concat(t.contentId,"Type").concat(t.contentType)}var H=function(t){function e(e){var n=t.call(this,e)||this;return n.handleResizeUpdates=function(t){t.forEach((function(t){n.props.onContainerStateChanged.trigger({stateChangeType:f.Resize,contentIdentifier:n.props.contentIdentifier,contentRect:t.contentRect})}))},n.triggerVisibilityUpdateNotification=function(){n.props.onContainerStateChanged.trigger({stateChangeType:f.Visibility,contentIdentifier:n.props.contentIdentifier,isVisible:n.props.isVisible})},n.getHostedResource=function(t){return{id:t}},n.onFocusChange=function(t,e){var o=t.relatedTarget||document.activeElement;n.parentDivRef&&o instanceof HTMLElement&&n.parentDivRef.contains(o)||n.props.onContainerStateChanged.trigger({stateChangeType:f.Focus,contentIdentifier:n.props.contentIdentifier,isFocused:e})},n.onFocusOut=function(t){n.onFocusChange(t,!1)},n.onFocusIn=function(t){n.onFocusChange(t,!0)},n.onMouseEnter=function(){n.props.onContainerStateChanged.trigger({stateChangeType:f.Hover,contentIdentifier:n.props.contentIdentifier,isHovered:!0})},n.onMouseLeave=function(){n.props.onContainerStateChanged.trigger({stateChangeType:f.Hover,contentIdentifier:n.props.contentIdentifier,isHovered:!1})},n.setContentRef=function(t){n.contentRef=t},n.setParentDivRef=function(t){t!==n.parentDivRef&&(n.parentDivRef&&(n.resizeObserver.unobserve(n.parentDivRef),n.parentDivRef.removeEventListener("focusin",n.onFocusIn,!0),n.parentDivRef.removeEventListener("focusout",n.onFocusOut,!0)),t&&(n.resizeObserver.observe(t),t.addEventListener("focusin",n.onFocusIn,!0),t.addEventListener("focusout",n.onFocusOut,!0))),n.parentDivRef=t},n.contentRef=void 0,n.parentDivRef=void 0,n.resizeObserver=new L.a((function(t){window.requestAnimationFrame((function(){n.handleResizeUpdates(t)}))})),n.setContentRef=n.setContentRef.bind(n),n.setParentDivRef=n.setParentDivRef.bind(n),n.getHostedResource=Object(N.a)(n.getHostedResource.bind(n)),n}return Object(a.__extends)(e,t),e.prototype.componentDidMount=function(){this.triggerVisibilityUpdateNotification()},e.prototype.componentDidUpdate=function(t){var e=this,n=!1;t.isVisible!==this.props.isVisible&&(this.props.useVisibilityAnimation&&!this.props.isVisible?n=!0:this.triggerVisibilityUpdateNotification()),this.props.useVisibilityAnimation&&setTimeout((function(){n&&e.triggerVisibilityUpdateNotification(),e.props.removeVisibilityAnimation()}),300)},e.prototype.height=function(){return this.parentDivRef?this.parentDivRef.clientHeight:0},e.prototype.width=function(){return this.parentDivRef?this.parentDivRef.clientWidth:0},e.prototype.setFocus=function(){this.contentRef&&this.contentRef.focus()},e.prototype.render=function(){if(!this.props.anchorPoint||void 0===this.props.anchorPoint.x||void 0===this.props.anchorPoint.y||!this.props.content)return null;var t=U(this.props.isVisible,this.props.useVisibilityAnimation,this.props.disableRepositioningAnimation,this.props.positionFixed),e=this.props.content;return T.createElement("div",{key:z(this.props.contentIdentifier),id:z(this.props.contentIdentifier),ref:this.setParentDivRef,className:t.floatingContainerView,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,style:{left:this.props.anchorPoint.x,top:this.props.anchorPoint.y}},T.createElement(e,{componentRef:this.setContentRef,resource:this.getHostedResource(this.props.contentIdentifier.contentId),maximumDimensions:this.props.maxDimensions,isVirtualized:this.props.isVirtualized,accessibilityMetadata:this.props.accessibilityMetadata}))},e}(T.Component);var B,W=Object(P.connect)((function(t){return{accessibilityMetadata:t.accessibilityMetadata,anchorPoint:t.anchorPoint,content:t.content,contentIdentifier:t.contentIdentifier,disableRepositioningAnimation:t.disableRepositioningAnimation,isVisible:t.isVisible,isVirtualized:t.isVirtualized,maxDimensions:t.maxDimensions,positionFixed:t.positionFixed,useVisibilityAnimation:t.useVisibilityAnimation}}),(function(t,e){return{removeVisibilityAnimation:function(){t(E(A.RemoveVisibilityAnimationType,{}))}}}),void 0,{forwardRef:!0})(H),G=function(){function t(t,e,n,o){var i;this.onContainerStateChanged=new g,this.floatingContainerRef=void 0,this.extensionUpdatedEventSubscription=void 0,this.unsubscribeStoreListener=function(){},this.canShow=!1,!1===o.isDraftContainer&&(this.floatingContainerCreationActivity=Object(m.j)().createActivityObject("FloatingContainerCreation",Object(m.k)(m.g.GlobalAPI),Object(m.i)())),this.store=(i=F(n,o))?Object(R.createStore)(O,i):Object(R.createStore)(O),this.extensionProvider=e,this.setContentFromExtension(),this.parentDiv=document.createElement("div"),this.parentDiv.id=o.containerId||Object(y.a)(),t.appendChild(this.parentDiv),this.observeStore=this.observeStore.bind(this),this.onUpdatedEventHandler=this.onUpdatedEventHandler.bind(this),this.setFloatingContainerRef=this.setFloatingContainerRef.bind(this),this.observeStore(n),this.render()}return t.prototype.anchorPoint=function(){return this.store.getState().anchorPoint},t.prototype.contentIdentifier=function(){return this.store.getState().contentIdentifier},t.prototype.height=function(){return this.floatingContainerRef?this.floatingContainerRef.height():0},t.prototype.width=function(){return this.floatingContainerRef?this.floatingContainerRef.width():0},t.prototype.parentDivId=function(){return this.parentDiv.id},t.prototype.observeStore=function(t){var e=this;if(Object(i.h)(this.extensionProvider)){var n=t;this.unsubscribeStoreListener=this.store.subscribe((function(){var t=e.contentIdentifier();n.contentId===t.contentId&&n.contentType===t.contentType||(n=t,e.removeExtensionUpdatedEventSubscription(),e.setContentFromExtension())}))}},t.prototype.setContentFromExtension=function(){var t=this,e=void 0;if(Object(i.h)(this.extensionProvider)){if(e=this.extensionProvider.getExtension(this.contentIdentifier().contentId),this.extensionUpdatedEventSubscription||(this.extensionUpdatedEventSubscription=e.onUpdated.subscribe((function(e){t.onUpdatedEventHandler()}))),e.priority===i.d.Disabled)return this.canShow=!1,void this.store.dispatch(w(void 0))}else e=this.extensionProvider.getExtension();this.canShow=!0,Object(b.c)().getComponent(e.componentKey).then((function(e){t.store.dispatch(w(e.component)),t.floatingContainerCreationActivity&&(t.floatingContainerCreationActivity.successTag(593872975),t.floatingContainerCreationActivity=void 0)})).catch((function(t){Object(m.j)().assertConditionTag(!1,"Error when registering component in setContentFromExtension ".concat(t),595632583)}))},t.prototype.render=function(){var t={onContainerStateChanged:this.onContainerStateChanged};x.render(T.createElement(P.Provider,{store:this.store},T.createElement(W,Object(a.__assign)({ref:this.setFloatingContainerRef},t))),this.parentDiv)},t.prototype.updateContainerPosition=function(t){var e,n,o;this.store.dispatch((e=t.anchorPoint,n=!!t.disableRepositioningAnimation,o=!!t.positionFixed,E(A.RepositionType,{anchorPoint:e,disableRepositioningAnimation:n,positionFixed:o})))},t.prototype.updateMaximumDimensions=function(t){this.store.dispatch(function(t){return E(A.UpdateContentMaxDimensionsType,{maxDimensions:t})}(t))},t.prototype.updateSetItemDetails=function(t){this.store.dispatch(function(t){return E(A.UpdateContentSetItemDetailsType,{setItemDetails:t})}(t))},t.prototype.updateContainerVirtualization=function(t){t&&!_(this.store.getState())?this.store.dispatch(E(A.UpdateContainerVirtualizationType,{isVirtualized:!0})):_(this.store.getState())&&this.store.dispatch(E(A.UpdateContainerVirtualizationType,{isVirtualized:!1}))},t.prototype.showFloatingContainer=function(t){return!!this.canShow&&(this.store.dispatch(function(t){return E(A.UpdateContainerVisibilityType,{isVisible:!0,useVisibilityAnimation:t})}(!!t)),!0)},t.prototype.hideFloatingContainer=function(t){this.store.dispatch(function(t){return E(A.UpdateContainerVisibilityType,{isVisible:!1,useVisibilityAnimation:t})}(!!t))},t.prototype.destroyFloatingContainer=function(t){var e=this;this.unsubscribeStoreListener(),this.removeExtensionUpdatedEventSubscription(),this.hideFloatingContainer(t),t?setTimeout((function(){e.cleanupDomOnDestroy()}),300):this.cleanupDomOnDestroy()},t.prototype.cleanupDomOnDestroy=function(){x.unmountComponentAtNode(this.parentDiv),this.parentDiv.parentElement&&this.parentDiv.parentElement.removeChild(this.parentDiv)},t.prototype.isShowing=function(){return this.store.getState().isVisible},t.prototype.setFocus=function(){var t=this;this.floatingContainerRef?this.floatingContainerRef.setFocus():setTimeout((function(){var e;return null===(e=t.floatingContainerRef)||void 0===e?void 0:e.setFocus()}))},t.prototype.changeRenderedContentIdentifier=function(t){this.store.dispatch(function(t){return E(A.ChangeRenderedContentIdentifierType,{newContentIdentifier:t})}(t))},t.prototype.onUpdatedEventHandler=function(){var t=this.canShow;this.setContentFromExtension(),t!==this.canShow&&this.onContainerStateChanged.trigger({stateChangeType:f.Enablement,contentIdentifier:this.contentIdentifier(),isEnabled:this.canShow})},t.prototype.removeExtensionUpdatedEventSubscription=function(){this.extensionUpdatedEventSubscription&&(this.extensionUpdatedEventSubscription.unsubscribe(),this.extensionUpdatedEventSubscription=void 0)},t.prototype.setFloatingContainerRef=function(t){this.floatingContainerRef=null!=t?t:void 0},t}(),Q=new(function(){function t(){}return t.prototype.createFloatingContainer=function(t,e,n,o){return new G(t,e,n,o)},t}()),q=n(1200);!function(t){t[t.DeselectionEnabled=0]="DeselectionEnabled",t[t.FloatingContainerVirtualizationEnabled=1]="FloatingContainerVirtualizationEnabled",t[t.ImproveJumpingFixEnabled=2]="ImproveJumpingFixEnabled",t[t.ShouldInitialize=3]="ShouldInitialize",t[t.ScrollingPerfImprovementEnabled=4]="ScrollingPerfImprovementEnabled",t[t.SynchronousContainerPositioningEnabled=5]="SynchronousContainerPositioningEnabled",t[t.TrackChangesInSidetrackEnabled=6]="TrackChangesInSidetrackEnabled",t[t.ContentNavigationApiEnabled=7]="ContentNavigationApiEnabled",t[t.ReturnToDraftFixEnabled=8]="ReturnToDraftFixEnabled"}(B||(B={}));var K,J=n(2376),Z=n(1374),Y=n(285),X=n(2805);!function(t){t[t.Focus=0]="Focus"}(K||(K={}));var $=n(164);function tt(t){return"".concat(t.contentId,"_").concat(t.contentType,"_").concat(t.renderMode)}function et(t){switch(t){case i.b.CommentThread:return o.CommentThread;case i.b.TrackedChange:return o.TrackedChange;default:return o.CommentThread}}var nt=function(t){var e=t.id,n=t.containerContent,o=t.componentRef,r=T.useState(n),s=r[0],c=r[1],d=T.useCallback((function(t){var e;switch(t.type){case"content":c(t.data);break;case"behavior":t.data.action===K.Focus&&(null===(e=p.current)||void 0===e||e.focus())}}),[]),l=Tt.getTrackChangesStore(),u=Tt.getFCContentNavigationAPI(),p=T.useRef(null),h=T.useCallback((function(){var t;null===(t=p.current)||void 0===t||t.focus()}),[]),C=T.useCallback((function(){return e}),[e]);T.useEffect((function(){return l.registerOnStoreUpdate(e,d),o&&o({focus:h,getInstanceId:C}),function(){l.removeFromStore(e)}}),[e,o,d,l,h,C]);var f=T.useMemo((function(){var t,e;return{definitionType:"TrackChangeDefinition",authorName:null!==(t=s.authorName)&&void 0!==t?t:"",authorColor:null!==(e=s.authorColor)&&void 0!==e?e:"",changeDescriptor:s.changeDescriptor,acceptDisabled:!!s.acceptDisabled,rejectDisabled:!!s.rejectDisabled,theme:s.theme}}),[s]),v=T.useMemo((function(){return l.cardStrings}),[l.cardStrings]),g=T.useMemo((function(){return l.getCardActionCallbacks(e)}),[e,l]),I=T.useMemo((function(){return{definition:f,strings:v,onAcceptHoverIn:g.onAcceptHoverIn,onRejectHoverIn:g.onRejectHoverIn,onAcceptHoverOut:g.onAcceptHoverOut,onRejectHoverOut:g.onRejectHoverOut,onAcceptClick:g.onAcceptClick,onRejectClick:g.onRejectClick,style:l.cardStyles}}),[f,v,g.onAcceptHoverIn,g.onRejectHoverIn,g.onAcceptHoverOut,g.onRejectHoverOut,g.onAcceptClick,g.onRejectClick,l]),m=T.useCallback((function(){g.onCardClick(),h()}),[g,h]),y=T.useCallback((function(){g.onCardHoverIn()}),[g]),b=T.useCallback((function(){g.onCardHoverOut()}),[g]),x=T.useCallback((function(t){var n,o="ArrowDown"===(n=t.key)||"Down"===n?$.d.Next:"ArrowUp"===n||"Up"===n?$.d.Previous:$.d.None;o!==$.d.None&&(null==u||u.selectNextOrPreviousContent({selectDirection:o,preventLooping:!1,reason:$.c.Keyboarding,restrictToCurrentContext:!0,from:{contentId:e,contentType:i.b.TrackedChange}}),t.preventDefault())}),[u,e]),P=T.useMemo((function(){var t,e=(null===(t=s.theme)||void 0===t?void 0:t.borderColor)?"1px solid ".concat(s.theme.borderColor):void 0;return Object(D.eb)({outline:"none",boxShadow:"0 0 2px rgba(0, 0, 0, 0.12), 0 2px 4px rgba(0,0,0,0.14)",borderRadius:"4px",":hover":{boxShadow:"0 0 2px rgba(0, 0, 0, 0.12), 0 4px 8px rgba(0,0,0,0.14)"},border:e,":focus":{boxShadow:"0 0 2px rgba(0, 0, 0, 0.12), 0 8px 16px rgba(0,0,0,0.14)"}})}),[s]);return T.createElement("div",{onClick:m,onMouseEnter:y,onMouseLeave:b,onKeyDown:x,tabIndex:0,ref:p,className:P},T.createElement(X.a,Object(a.__assign)({},I)))},ot=function(t){var e,n,o=Tt.getTrackChangesStore().getContainerContent(null===(e=t.resource)||void 0===e?void 0:e.id);return o?T.createElement(nt,{id:null===(n=t.resource)||void 0===n?void 0:n.id,containerContent:o,componentRef:t.componentRef}):null};var it=n(889),at=n(1539),rt={width:0,height:0,x:0,y:0};function st(t){return void 0!==t.hasBeenRendered}var ct=function(){function t(t,e,n,o,a){var r=this;this.supportedContentTypes=[i.b.CommentThread,i.b.TrackedChange],this.getContentCardIndex=function(t,e){if(!r.containerIdToInfoMap[t])return r.ULS.sendTraceTag(595883362,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[getContentCardIndex]Container with id ".concat(t," does not exist.")),-1;var n=r.containerIdToInfoMap[t].anchorTop;n=e?Math.max(n,e):n;for(var o=r.getContentCardInsertionPoint(n),i=o;i<r.contentAnchorPositions.length;i+=1)if(r.checkIfContainerIdCorrespondsToGivenPosition(t,i))return i;for(i=0;i<o;i+=1)if(r.checkIfContainerIdCorrespondsToGivenPosition(t,i))return i;return-1},this.initializeExtensionProviderCollection=function(t){r.extensionProviderCollection=r.contentExtensionHostAPIGetter().getExtensions(r.supportedContentTypes,i.c),r.updateContentTypeToExtensionProviderMap(t),r.extensionProviderCollection.onUpdated.subscribe((function(){return r.updateContentTypeToExtensionProviderMap(t)}))},this.getContentCardInsertionPoint=function(t){for(var e,n=0,o=r.contentAnchorPositions.length;n<o;){e=n+Math.floor((o-n)/2),r.contentAnchorPositions[e].anchorTop<t-4?n=e+1:o=e}return n},this.getContainerStateChangedCallback=function(t,e){return function(n,o){switch(n.stateChangeType){case f.Resize:t(n,o);break;case f.Visibility:if(n.isVisible)if(!r.commentsTTVRReported)e===r.lastCommentVisibleID&&(Object(it.e)(it.d,{component:"canvas",subComponent:"floatingComments",state:at.c}),Object(it.e)(it.d,{component:"canvas",subComponent:"floatingComments",state:at.a}),r.commentsTTVRReported=!0)}}},this.renderFloatingContainerAtAnchorPosition=function(t){var e=r.containerIdToInfoMap[t];e&&e.floatingContainerRef&&e.floatingContainerRef.showFloatingContainer(!0)},this.updateContentTypeToExtensionProviderMap=function(t){r.contentTypeToExtensionProviderMap.clear(),void 0!==r.extensionProviderCollection?(r.areCommentExtensionProvidersDefinedOnce||(r.areCommentExtensionProvidersDefinedOnce=0!==r.extensionProviderCollection.providers.filter((function(t){return t.scope.contentType===i.b.CommentThread&&t.scope.renderMode===i.e.Integrated})).length),r.extensionProviderCollection.providers.forEach((function(t){t.scope.renderMode===i.e.Integrated&&r.contentTypeToExtensionProviderMap.set(t.scope.contentType,t)})),t()):r.ULS.sendTraceTag(595886287,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"extensionProviderCollection should not be null")},this.contentExtensionHostAPIGetter=t,this.dhcContainerPanel=e,this.isCommentPaneOpen=!1,this.areCommentExtensionProvidersDefinedOnce=!1,this.viewportInfo=a||rt,this.containerIdToInfoMap={},this.contentAnchorPositions=[],this.contentTypeToExtensionProviderMap=new Map,this.floatingContainerFactory=n,this.ULS=o,this.processedContainersVisibleAtBoot=!1,this.isFirstCommentRenderDone=!1,this.lastCommentVisibleID="",this.commentsTTVRReported=!1}return t.prototype.addContentAnchorPosition=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=-1);var o=n>-1?n:this.getContentCardInsertionPoint(t.anchorTop)+e;return this.contentAnchorPositions.splice(o,0,t),o},t.prototype.getContainerIdToInfoMap=function(){return this.containerIdToInfoMap},t.prototype.getContentAnchorPositions=function(){return this.contentAnchorPositions},t.prototype.getContentAnchorPosition=function(t){var e=this.getContentCardIndex(t);if(e>-1)return this.contentAnchorPositions[e]},t.prototype.initializeAndRenderFloatingContainer=function(t,e,n,o,i){void 0===o&&(o=!0),void 0===i&&(i=!1);var a;return a=this.initializeFloatingContainerState(t,n,o,i),i&&this.renderFloatingContainerAtAnchorPosition(e),a},t.prototype.isContainerInViewPort=function(t){return t>this.viewportInfo.y-.5*this.viewportInfo.height&&t<this.viewportInfo.y+1.5*this.viewportInfo.height},t.prototype.removeContentAnchorPosition=function(t){var e=this.getContentCardIndex(t);return-1===e?(this.ULS.sendTraceTag(595736577,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[RemoveContentAnchorPosition]Content anchor position for id ".concat(t," does not exist.")),-1):(this.contentAnchorPositions.splice(e,1),e)},t.prototype.checkIfContainerIdCorrespondsToGivenPosition=function(t,e){return t===this.getContainerIdUsingPositionalIndex(e)},t.prototype.getContainerIdUsingPositionalIndex=function(t){var e=this.contentAnchorPositions[t];return tt({contentId:e.contentId,contentType:d(e.containerContentType),renderMode:i.e.Integrated})},t.prototype.createFloatingContainer=function(t,e,n,o){if(this.dhcContainerPanel)return this.floatingContainerFactory.createFloatingContainer(this.dhcContainerPanel,t,{contentId:e.contentId,contentType:d(e.containerContentType)},{anchorPoint:{x:0,y:n},isDraftContainer:o});this.ULS.sendTraceTag(595883361,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[createFloatingContainer]dhcContainerPanel is not yet set.")},t.prototype.initializeFloatingContainerState=function(t,e,n,o){if(t){var r=this.contentTypeToExtensionProviderMap.get(d(t.containerContentType));if(void 0===r)return this.ULS.sendTraceTag(595883363,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[initializeFCState]ExtensionProvider not found for contentType ".concat(t.containerContentType)),!1;var s=t.contentId;if(!s)return this.ULS.sendTraceTag(595883407,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[initializeFCState]ContentId is null or empty."),!1;var c=tt({contentId:s,contentType:d(t.containerContentType),renderMode:i.e.Integrated}),l=void 0;if(n){if(!(l=this.createFloatingContainer(r,{contentId:s,containerContentType:t.containerContentType},t.anchorTop,o)))return this.ULS.sendTraceTag(595886286,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[createFloatingContainer] Could not create fc for content id ".concat(s)),!1;l.onContainerStateChanged.subscribe(this.getContainerStateChangedCallback(e,c))}if(this.containerIdToInfoMap[c])this.containerIdToInfoMap[c].floatingContainerRef=l;else{var u=Object(a.__assign)(Object(a.__assign)({position:{height:0,width:0,x:0,y:t.anchorTop}},this.containerIdToInfoMap[c]),{anchorTop:t.anchorTop,floatingContainerRef:l,hasBeenRendered:!1});this.containerIdToInfoMap[c]=u}return!0}return!1},t}(),dt=function(){function t(t,e,n,r,s,c,l,u){var p=this;this.floatingContainerPositioner=t,this.floatingContainerVirtualizer=e,this.store=n,this.featureSettings=c,this.trackChangesStore=u,this.isInitialActiveIdSet=!1,this.inFixedMode=!1,this.firstContainerBeingRendered=!0,this.fcManagerInitialized=!1,this.pauseContainerCreation=!1,this.containerDelayTimeMs=10,this.containerCreationQueue=[],this.isContainerQueueInProgress=!1,this.containerCreationTimers={},this.containerCreationEnqueueTimes={},this.stallDetectorTimeoutId=void 0,this.stallDetectorUsed=!1,this.queueStallDetectionTimeMs=1e3,this.draftContainerId="",this.emitEvent=function(t,e){if(p.store.isCommentPaneOpen||!p.store.dhcContainerPanel||!p.store.areCommentExtensionProvidersDefinedOnce)return p.store.ULS.sendTraceTag(538022540,J.a.msoulscat_Wac_Telemetry,Z.a.Warning,"FCM not handling the event. {\n          isCommentPaneOpen: ".concat(p.store.isCommentPaneOpen,",\n          dhcContainerPanelNotDefined: ").concat(!p.store.dhcContainerPanel,",\n          extensionProvidersNotDefined: ").concat(!p.store.areCommentExtensionProvidersDefinedOnce,"\n        }")),void(e&&e.viewportInfo&&(p.store.viewportInfo=e.viewportInfo));switch(t){case 0:if(e&&e.contentAnchorPosition){var n=e.contentAnchorPosition.contentId,a=e.noOfPrecedingThreadsOnSameLine?e.noOfPrecedingThreadsOnSameLine:0;if(!n)return void p.store.ULS.sendTraceTag(595903774,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[AddContainer]ContentId is null.");var r=tt({contentId:n,contentType:d(e.contentAnchorPosition.containerContentType),renderMode:i.e.Integrated}),s=p.store.getContainerIdToInfoMap()[r];if(void 0!==p.containerCreationTimers[r])return void p.store.ULS.sendTraceTag(509634193,J.a.msoulscat_Wac_Telemetry,Z.a.Warning,"[AddContainer]Container Creation in queue.");if(s&&s.floatingContainerRef)return void p.store.ULS.sendTraceTag(595097123,J.a.msoulscat_Wac_Telemetry,Z.a.Warning,"[AddContainer]Container already exists.");var c=p.store.initializeAndRenderFloatingContainer(e.contentAnchorPosition,r,p.onContainerResize,void 0,!0);if(p.draftContainerId=n,c){p.store.addContentAnchorPosition(e.contentAnchorPosition,a);var l={contentId:n,containerContentType:e.contentAnchorPosition.containerContentType};e.shouldSetFocus&&p.emitEvent(2,{containerContentDescriptor:l})}}break;case 1:if(e&&e.containerContentDescriptor){if(!e.containerContentDescriptor.contentId)return void p.store.ULS.sendTraceTag(595903775,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[DeleteContainer]ContentId is null.");r=tt({contentId:e.containerContentDescriptor.contentId,contentType:d(e.containerContentDescriptor.containerContentType),renderMode:i.e.Integrated});if(!(s=p.store.getContainerIdToInfoMap()[r]))return void p.store.ULS.sendTraceTag(595723333,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[DeleteContainer]Container info for id ".concat(r," does not exist."));var u=s.position.y,h=p.deleteContainer(r,!!e.animateOutOnDeletion);if(-1===h)return;p.store.activeContainerId&&p.store.activeContainerId!==r?p.positionFloatingContainers(p.store.getContentAnchorPositions(),void 0,p.store.activeContainerId):p.positionFloatingContainers(p.store.getContentAnchorPositions().slice(h),u)}break;case 2:if(e&&e.containerContentDescriptor){if(!e.containerContentDescriptor.contentId)return void p.store.ULS.sendTraceTag(595903777,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[FocusContainer]ContentId is null.");var C=tt({contentId:e.containerContentDescriptor.contentId,contentType:d(e.containerContentDescriptor.containerContentType),renderMode:i.e.Integrated});if(!p.store.getContainerIdToInfoMap()[C])return p.store.ULS.sendTraceTag(595903778,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[FocusContainer]Container with id ".concat(C," does not exist")),void p.setInitialActiveContainerIdV2(e.containerContentDescriptor,null);p.store.activeContainerId!==C&&(p.clearSelection(!0),p.positionFloatingContainers(p.store.getContentAnchorPositions(),void 0,C,void 0,!0));var f=p.store.getContainerIdToInfoMap()[C].floatingContainerRef;e.shouldSetFocus&&f&&f.setFocus(),p.store.activeContainerId=C}break;case 3:if(e&&e.contentAnchorPositions){if(e.containerContentByType&&e.containerContentByType[o.TrackedChange])for(var v=e.containerContentByType[o.TrackedChange],g=0,I=Object.entries(v);g<I.length;g++){var m=I[g],y=m[0],b=m[1];p.trackChangesStore.addOrUpdateStore(y,b)}p.processContentAnchorPositionsInView(e.contentAnchorPositions)}break;case 4:e&&e.viewportInfo&&(p.store.viewportInfo=e.viewportInfo,p.featureSettings.SynchronousContainerPositioningEnabled||p.positionFloatingContainers());break;case 5:if(e&&e.infoToReplaceContent){var T=e.infoToReplaceContent.currentContentId,x=e.infoToReplaceContent.newContentId;if(!T||!x)return void p.store.ULS.sendTraceTag(595855174,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[ReplaceContainerContent]".concat(T?"NewContentId":"CurrentContentId"," is null."));var P=tt({contentId:T,contentType:d(e.infoToReplaceContent.containerContentType),renderMode:i.e.Integrated});if(!(s=p.store.getContainerIdToInfoMap()[P]))return void p.store.ULS.sendTraceTag(595855175,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[ReplaceContainerContent]ContainerInfo for id ".concat(P," does not exist"));if(!s.floatingContainerRef)return void p.store.ULS.sendTraceTag(595855176,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[ReplaceContainerContent]FloatingContainerRef with id ".concat(P," does not exist"));s.floatingContainerRef.changeRenderedContentIdentifier({contentId:x,contentType:d(e.infoToReplaceContent.containerContentType)}),p.replacementContentId=x;var A=tt({contentId:x,contentType:d(e.infoToReplaceContent.containerContentType),renderMode:i.e.Integrated}),R=p.store.getContentCardIndex(P);if(-1===R)return void p.store.ULS.sendTraceTag(595855178,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[ReplaceContainerContent]Positional index for content id ".concat(T," should not be negative"));p.store.activeContainerId=p.store.activeContainerId===P?A:p.store.activeContainerId,p.store.getContainerIdToInfoMap()[A]=s,delete p.store.getContainerIdToInfoMap()[P],p.store.getContentAnchorPositions()[R].contentId=x}break;case 6:p.positionFloatingContainers()}},this.getAreContainersEnabled=function(){return!p.store.isCommentPaneOpen&&p.store.areCommentExtensionProvidersDefinedOnce},this.getContentAnchorPosition=function(t){if(!t)return null;var e=tt({contentId:t,contentType:i.b.CommentThread,renderMode:i.e.Integrated}),n=p.store.getContentCardIndex(e);return-1!==n?p.store.getContentAnchorPositions()[n]:null},this.containerShouldBeCreatedEventHandler=function(t){var e=p.store.getContentCardIndex(t.containerId);p.store.initializeAndRenderFloatingContainer(p.store.getContentAnchorPositions()[e],t.containerId,p.onContainerResize)},this.updateCommentPaneState=function(){p.store.isCommentPaneOpen=!0,p.store.extensionProviderCollection&&(p.store.isCommentPaneOpen=0===p.store.extensionProviderCollection.providers.filter((function(t){return t.scope.contentType===i.b.CommentThread&&t.scope.renderMode===i.e.Integrated})).length),p.onCommentPaneStateChange()},this.onContainerResize=function(t){if(!p.store.isCommentPaneOpen&&t.stateChangeType===f.Resize&&0!==t.contentRect.height){var e=t.contentIdentifier,n=tt({contentId:e.contentId,contentType:e.contentType,renderMode:i.e.Integrated}),o=p.store.getContainerIdToInfoMap()[n];if(o){var a=o.position.height!==t.contentRect.height;if(p.isInitialActiveIdSet&&p.store.activeContainerId===n&&o.floatingContainerRef&&(p.onInitialActiveContainerRender?(p.onInitialActiveContainerRender(),p.onInitialActiveContainerRender=void 0):o.floatingContainerRef.setFocus()),a){if(o.position.height=t.contentRect.height,o.position.width=t.contentRect.width,p.firstContainerBeingRendered){var r=window.performance&&window.performance.now?window.performance.now():Date.now();p.store.ULS.sendTraceTag(595718473,J.a.msoulscat_Wac_Telemetry,Z.a.Info,r.toString()),wacBoot.WacSkeletalBoot.isSkeletalDeepLink()&&(Box4.FastViewExtensions.setDeepLinkComplete(),document.body.classList.remove("Deeplink"),Box4.FastViewExtensions.dismiss(),wacBoot.WacSkeletalBoot.setComponentReady("SkeletalPage")),p.firstContainerBeingRendered=!1}var s=void 0!==p.containerCreationTimers[n];if(p.featureSettings.DeselectionEnabled?p.positionContainersOnResize(n,o,s):p.positionFloatingContainers(p.store.getContentAnchorPositions(),void 0,p.store.activeContainerId,s),e.contentId&&e.contentId===p.draftContainerId){var c=p.store.isContainerInViewPort(o.anchorTop);p.store.ULS.sendTraceTag(553747984,J.a.msoulscat_Wac_Telemetry,Z.a.Info,"[ContainerResize] Draft Container created with id: ".concat(e.contentId," created and in viewport ").concat(c))}p.isInitialActiveIdSet&&p.store.activeContainerId===n&&o.floatingContainerRef&&(p.isInitialActiveIdSet=!1),o.floatingContainerRef&&o.floatingContainerRef.showFloatingContainer(s),t.contentIdentifier.contentId===p.replacementContentId&&(p.replacementContentId=void 0),s&&(delete p.containerCreationTimers[n],void 0!==p.stallDetectorUsed&&(window.clearTimeout(p.stallDetectorTimeoutId),p.stallDetectorTimeoutId=void 0,p.processContainerQueue()))}}else p.store.ULS.sendTraceTag(595646153,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[ContainerResize] ContainerInfo does not exist, id: ".concat(n,", size: ").concat(t.contentRect.height))}},this.paneClosedCallback=r,this.paneOpenedCallback=s,this.destroyAllContainersCallback=l,c.ShouldInitialize&&this.initialize(),c.TrackChangesInSidetrackEnabled&&(Object(b.c)().registerComponent("TrackedChange",ot),function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(e){return t={priority:i.d.Primary,renderMode:i.e.Integrated,instanceId:Y.a,componentDimensions:void 0},[2,Object(i.f)().registerExtension(i.b.TrackedChange,"TrackedChange",t)]}))}))}().catch((function(t){p.store.ULS.sendTraceTag(538022360,J.a.msoulscat_Wac_Telemetry,Z.a.Warning,"Failed to register TrackChange extension: ".concat(t))})))}return t.prototype.initialize=function(){this.fcManagerInitialized||(this.store.initializeExtensionProviderCollection(this.updateCommentPaneState),this.floatingContainerVirtualizer.onContainerShouldBeCreated.subscribe(this.containerShouldBeCreatedEventHandler),this.fcManagerInitialized=!0)},t.prototype.enterFixedPositionMode=function(){this.inFixedMode=!0},t.prototype.exitFixedPositionMode=function(){this.inFixedMode=!1},t.prototype.setFirstCommentRenderDone=function(){this.store.isFirstCommentRenderDone=!0},t.prototype.setContainerCreationPauseState=function(t){this.pauseContainerCreation=t,t&&(this.containerCreationEnqueueTimes={},this.isContainerQueueInProgress=!1)},t.prototype.clearSelection=function(t){if(void 0===t&&(t=!1),this.store.activeContainerId){var e=this.store.getContainerIdToInfoMap()[this.store.activeContainerId];if(this.store.activeContainerId=void 0,!e)return;if(e.position.x=0,t)return;this.positionFloatingContainers()}},t.prototype.setInitialActiveContainerId=function(t){this.isInitialActiveIdSet=!0,this.clearSelection(),t&&t.contentId&&(this.store.activeContainerId=tt({contentId:t.contentId,contentType:d(t.containerContentType),renderMode:i.e.Integrated}))},t.prototype.setInitialActiveContainerIdV2=function(t,e){this.isInitialActiveIdSet=!0,this.clearSelection(),t&&t.contentId&&(this.store.activeContainerId=tt({contentId:t.contentId,contentType:d(t.containerContentType),renderMode:i.e.Integrated}),e&&(this.onInitialActiveContainerRender=e))},t.prototype.insertContentAnchorPosition=function(t,e,n){var o=n&&Math.abs(t.anchorTop-e)<=4?this.store.getContentCardIndex(n)+1:-1;this.store.addContentAnchorPosition(t,0,o)},t.prototype.processContentAnchorPositionsInView=function(t){var e=this,n=!1,o=void 0,a=void 0,r=0;if(t.forEach((function(s,c){if(s){var l=s.contentId;if(!l)return void e.store.ULS.sendTraceTag(595903808,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[processContentAnchorPosition]ContentId is null.");var u=tt({contentId:l,contentType:d(s.containerContentType),renderMode:i.e.Integrated}),p=t.length;e.trackLastCommentRenderedInViewport(s,c,u,p);var h=e.store.getContainerIdToInfoMap()[u];if(!h){var C=e.store.initializeAndRenderFloatingContainer(s,u,e.onContainerResize,!1);return C&&!e.containerCreationQueue.includes(u)&&(e.containerCreationQueue.push(u),e.containerCreationEnqueueTimes[u]=Date.now()),void(C&&(e.insertContentAnchorPosition(s,r,o),o=u,r=s.anchorTop))}var f=e.store.getContentCardIndex(u,s.anchorTop);if(-1===f)return void e.store.ULS.sendTraceTag(595883392,J.a.msoulscat_Wac_Telemetry,Z.a.Error,"[processContentAnchorPosition]Container was supposed to be found.");var v=e.store.getContentAnchorPositions()[f],g=void 0!==a&&h.position.y>=a.position.y&&h.position.y<=a.position.y+a.position.height,I=Math.abs(v.anchorTop-s.anchorTop)>4;if(n=n||I||g,I){var m=tt({contentId:l,contentType:d(s.containerContentType),renderMode:i.e.Integrated});e.store.removeContentAnchorPosition(m),e.insertContentAnchorPosition(s,r,o)}o=u,r=s.anchorTop,h.anchorTop=s.anchorTop,a=h}})),this.updateProcessedContainersVisibleAtBootState(),!this.featureSettings.TrackChangesInSidetrackEnabled&&this.isContainerQueueInProgress||this.processContainerQueue(),n||this.inFixedMode){var s=this.store.getContentAnchorPositions().length>0?this.store.getContentAnchorPositions()[0].anchorTop:void 0;this.positionFloatingContainers(this.store.getContentAnchorPositions(),s,this.store.activeContainerId)}},t.prototype.processContainerQueue=function(){var t=this;if(0===this.containerCreationQueue.length||this.pauseContainerCreation)this.isContainerQueueInProgress=!1;else{this.isContainerQueueInProgress=!0;var e=this.containerCreationQueue.shift(),n=this.store.getContentAnchorPosition(e);if(n)if(this.store.isContainerInViewPort(n.anchorTop)){if(!this.featureSettings.TrackChangesInSidetrackEnabled||!this.containerCreationTimers[e]){var o=window.setTimeout((function(){t.containerCreationTimers[e]&&(t.containerCreationTimers[e].creationStarted=!0),t.createContainer(n,e),t.setupStallDetector(e)}),this.containerDelayTimeMs);this.containerCreationTimers[e]={timer:o,creationStarted:!1}}}else this.deleteContainer(e),this.processContainerQueue();else this.featureSettings.TrackChangesInSidetrackEnabled&&this.processContainerQueue()}},t.prototype.trackLastCommentRenderedInViewport=function(t,e,n,o){this.store.processedContainersVisibleAtBoot||(this.store.isContainerInViewPort(t.anchorTop)?this.store.lastCommentVisibleID=n:0===e&&Object(it.e)(it.d,{component:"canvas",subComponent:"floatingComments",state:"unused"})),e!==o-1||this.store.processedContainersVisibleAtBoot||(this.store.processedContainersVisibleAtBoot=!0)},t.prototype.updateProcessedContainersVisibleAtBootState=function(){this.store.isFirstCommentRenderDone&&!this.store.processedContainersVisibleAtBoot&&(this.store.processedContainersVisibleAtBoot=!0,Object(it.e)(it.d,{component:"canvas",subComponent:"floatingComments",state:"unused"}))},t.prototype.setupStallDetector=function(t){var e=this;this.stallDetectorUsed=!1,!(this.featureSettings.TrackChangesInSidetrackEnabled&&void 0!==this.stallDetectorTimeoutId)&&(this.stallDetectorTimeoutId=window.setTimeout((function(){e.stallDetectorUsed=!0,e.processContainerQueue(),e.store.ULS.sendTraceTag(593281990,J.a.msoulscat_Wac_Telemetry,Z.a.Warning,"[CommentCreationQueueStallDetector]: Container ".concat(t," creation resize call not received or took too long"))}),this.queueStallDetectionTimeMs))},t.prototype.createContainer=function(t,e){if(this.store.initializeAndRenderFloatingContainer(t,e,this.onContainerResize,!0)){if(this.containerCreationEnqueueTimes[e]){var n=Date.now();this.store.ULS.sendTraceTag(593891910,J.a.msoulscat_Wac_Telemetry,Z.a.Info,"[DelayCreationPerfMetric]TimeToCreateCommentFromEnqueue:".concat(n-this.containerCreationEnqueueTimes[e])),delete this.containerCreationEnqueueTimes[e]}}else this.deleteContainer(e),this.processContainerQueue()},t.prototype.onCommentPaneStateChange=function(){this.store.isCommentPaneOpen?(this.store.areCommentExtensionProvidersDefinedOnce&&this.destroyAllContainers(),this.paneOpenedCallback&&this.paneOpenedCallback()):this.paneClosedCallback&&this.paneClosedCallback()},t.prototype.deleteContainer=function(t,e){var n;void 0===e&&(e=!1);var o=this.store.removeContentAnchorPosition(t);if(-1===o)return-1;var i=this.store.getContainerIdToInfoMap()[t].floatingContainerRef;return i&&(i.destroyFloatingContainer(e),this.featureSettings.TrackChangesInSidetrackEnabled||(clearTimeout(null===(n=this.containerCreationTimers[t])||void 0===n?void 0:n.timer),delete this.containerCreationTimers[t],this.removeFromCreationQueue(t))),this.featureSettings.TrackChangesInSidetrackEnabled&&(void 0!==this.containerCreationTimers[t]&&(this.containerCreationTimers[t].creationStarted?(clearTimeout(this.stallDetectorTimeoutId),this.stallDetectorTimeoutId=void 0):clearTimeout(this.containerCreationTimers[t].timer),delete this.containerCreationTimers[t]),this.removeFromCreationQueue(t)),delete this.store.getContainerIdToInfoMap()[t],delete this.containerCreationEnqueueTimes[t],o},t.prototype.destroyAllContainers=function(){var t=this,e=Object.keys(this.store.getContainerIdToInfoMap());e.length>0&&this.destroyAllContainersCallback&&this.destroyAllContainersCallback(),e.forEach((function(e){t.deleteContainer(e)})),this.isContainerQueueInProgress=!1,this.containerCreationEnqueueTimes={},this.containerCreationTimers={},this.containerCreationQueue=[]},t.prototype.positionFloatingContainers=function(t,e,n,o,i){if(void 0===o&&(o=!1),void 0===i&&(i=!1),t&&t.length>0){var a=n?{containerId:n,containerPositionIndex:this.store.getContentCardIndex(n)}:void 0;this.floatingContainerPositioner.calculateNewPositions(t,this.store.getContainerIdToInfoMap(),{activeContainerInfo:a,disableRepositioningAnimation:o||this.inFixedMode,topOfFirstContainer:e,shouldUpdatePositions:!1})}var r=n;r=null!=r?r:this.store.activeContainerId,this.floatingContainerVirtualizer.updateContainersVisibility(this.store.getContainerIdToInfoMap(),this.store.viewportInfo,o||this.inFixedMode||void 0!==this.replacementContentId,this.isInitialActiveIdSet?void 0:r,i)},t.prototype.positionContainersOnResize=function(t,e,n){var o=this.store.getContentCardIndex(t),i=this.store.activeContainerId?this.store.getContentCardIndex(this.store.activeContainerId):void 0;void 0!==i&&i>=o?this.positionFloatingContainers(this.store.getContentAnchorPositions(),void 0,this.store.activeContainerId,n):(o-=!(st(e)&&e.hasBeenRendered)&&o>0?1:0,this.positionFloatingContainers(this.store.getContentAnchorPositions().slice(o),void 0,void 0,n));st(e)&&(e.hasBeenRendered=!0)},t.prototype.removeFromCreationQueue=function(t){var e=this.containerCreationQueue.indexOf(t);e>-1&&this.containerCreationQueue.splice(e,1)},t}(),lt=n(646),ut=function(){function t(t){var e,n;this.wordContentNavigationApi=t,this.directionTranslation=((e={})[lt.a.None]=0,e[lt.a.Previous]=2,e[lt.a.Next]=1,e),this.navReasonTranslation=((n={})[$.c.HostAction]=2,n[$.c.Keyboarding]=1,n)}return t.prototype.bringContentIntoView=function(t){this.wordContentNavigationApi.bringContentIntoView({contentIdentifier:{contentId:t.contentIdentifier.contentId,containerContentType:et(t.contentIdentifier.contentType)}})},t.prototype.moveFocus=function(t){var e,n;this.wordContentNavigationApi.moveFocus({resource:{contentId:null===(e=t.resource)||void 0===e?void 0:e.contentId,containerContentType:et(null===(n=t.resource)||void 0===n?void 0:n.contentType)}})},t.prototype.selectNextOrPreviousContent=function(t){this.wordContentNavigationApi.selectNextOrPreviousContent({selectDirection:this.directionTranslation[t.selectDirection],reason:this.navReasonTranslation[t.reason],preventLooping:t.preventLooping,restrictToCurrentContext:t.restrictToCurrentContext,from:t.from&&{contentId:t.from.contentId,containerContentType:et(t.from.contentType)}})},t}(),pt=function(){function t(t){this.stringLoader=t,this.trackChangeInfoById=new Map,this.storeUpdateHandlers=new Map,this.updateVersion=0,this.styles={minWidth:238,maxWidth:238,borderRadius:4}}return Object.defineProperty(t.prototype,"cardStyles",{get:function(){return this.styles},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cardStrings",{get:function(){var t;return null!==(t=this.strings)&&void 0!==t?t:{regularHeading:"Accept or reject suggestion?",acceptHoveredHeading:"Accept Suggestion",rejectHoveredHeading:"Reject Suggestion"}},enumerable:!1,configurable:!0}),t.prototype.loadStrings=function(t){var e=this;void 0===t&&(t="en-US"),this.stringLoader.loadStrings(t).then((function(t){e.strings={regularHeading:t.TrackChangeCardAcceptOrRejectSuggestionLabel,acceptHoveredHeading:t.TrackChangeCardAcceptSuggestionLabel,rejectHoveredHeading:t.TrackChangeCardRejectSuggestionLabel}})).catch((function(t){}))},t.prototype.registerOnStoreUpdate=function(t,e){this.storeUpdateHandlers.set(t,e)},t.prototype.addOrUpdateStore=function(t,e){this.trackChangeInfoById.set(t,e);var n=this.storeUpdateHandlers.get(t);n&&n({type:"content",data:e})},t.prototype.removeFromStore=function(t){this.trackChangeInfoById.delete(t),this.storeUpdateHandlers.delete(t)},t.prototype.reloadStore=function(){this.updateVersion++},t.prototype.registerTrackChangeCardActionExecuter=function(t){this.trackChangeCardActionExecuter=t},t.prototype.getCardActionCallbacks=function(t){return{onAcceptClick:this.createActionCallback("AcceptClick",t),onRejectClick:this.createActionCallback("RejectClick",t),onAcceptHoverIn:this.createActionCallback("AcceptMouseOver",t),onAcceptHoverOut:this.createActionCallback("AcceptMouseOut",t),onRejectHoverIn:this.createActionCallback("RejectMouseOver",t),onRejectHoverOut:this.createActionCallback("RejectMouseOut",t),onCardHoverIn:this.createActionCallback("CardMouseOver",t),onCardHoverOut:this.createActionCallback("CardMouseOut",t),onCardClick:this.createActionCallback("CardClick",t)}},t.prototype.getContainerContent=function(t){return this.trackChangeInfoById.get(t)},t.prototype.clearStore=function(){this.trackChangeInfoById.clear(),this.storeUpdateHandlers.clear()},t.prototype.focusTrackChangeCard=function(t){var e=this.storeUpdateHandlers.get(t);e&&e({type:"behavior",data:{action:K.Focus}})},t.prototype.createActionCallback=function(t,e){var n=this;return function(){n.trackChangeCardActionExecuter&&n.trackChangeCardActionExecuter(t,n.updateVersion,e)}},t}(),ht=n(467),Ct=n(471),ft=n(961),vt=function(){function t(){}return t.prototype.loadStrings=function(t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(a.__generator)(this,(function(o){return[2,n(1726)("./".concat(t,"/canvas-contextual.json")).then((function(t){return Object(a.__awaiter)(e,void 0,void 0,(function(){return Object(a.__generator)(this,(function(e){return[2,t]}))}))})).catch((function(t){return ft.CanvasContextual}))]}))}))},t}(),gt=n(194),It=n(2685),mt=n(160),yt=function(t,e,n,o){return n?function(t,e,n,o){var i=0,a=0,r=0,s=new Set,c=[];for(;i<t.length&&a<e.length;)t[i].contentId===e[a].contentId?(i++,a++,r++):n.has(t[i].contentId)?o.has(e[a].contentId)?s.has(e[a].contentId)?(s.delete(e[a].contentId),c.push({type:"Insert",index:r,content:e[a]}),r++,a++):(s.add(t[i].contentId),c.push({type:"Remove",index:r}),i++):(c.push({type:"Insert",index:r,content:e[a]}),a++,r++):(c.push({type:"Remove",index:r}),i++);for(;a<e.length;)c.push({type:"Insert",content:e[a],index:r}),r++,a++;for(;i<t.length;)c.push({type:"Remove",index:r}),i++;return c}(t,e,o,n):[{type:"Reload",fullContent:e,reason:gt.d.DivergentChange}]};var bt=function(){function t(t){this.wordFilterAPI=t,this.activeFilteredRange=void 0,this.filteredContentMap=new Map,this.filterMap=new Map,this.idsInFilter=new Map,this.onFilteredRangeUpdated=new mt.EventImpl((function(){})),this.onActiveFilterUpdated=new mt.EventImpl((function(){})),this.onUserFilterManagerEvent=new mt.EventImpl((function(){})),t.registerOnContentChangeCallback(this.onContentChanged.bind(this))}return t.prototype.updateFilterForFilteredRangeId=function(t,e){if(this.filterMap.has(t)){var n=this.updateOrder(t,e);n.length>0&&this.onFilteredRangeUpdated.trigger({filterId:t,payload:{changes:n}})}},t.prototype.getExistingFilteredRange=function(t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(a.__generator)(this,(function(o){return e=this.filterMap.get(t),n=this.filteredContentMap.get(t),e&&n?[2,{content:n,filter:e.filter,filterId:t,supportsFilterUpdates:e.supportsFilterUpdates}]:[2]}))}))},t.prototype.setActiveFilteredRange=function(t){var e,n;this.activeFilteredRange=t,t&&(null===(n=(e=this.wordFilterAPI).updateCurrentFilteredContent)||void 0===n||n.call(e,this.idsInFilter.get(t)))},t.prototype.getActiveFilteredRangeId=function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return[2,this.activeFilteredRange]}))}))},t.prototype.getFilteredRange=function(t){var e;return Object(a.__awaiter)(this,void 0,void 0,(function(){var n;return Object(a.__generator)(this,(function(o){return n=Object(It.a)(),this.updateOrder(n,t.hostFilter),[2,{filterId:n,content:null!==(e=this.filteredContentMap.get(n))&&void 0!==e?e:[],supportsFilterUpdates:t.supportsFilterUpdates,filter:t.hostFilter}]}))}))},t.prototype.teardownFilteredRange=function(t){this.filteredContentMap.delete(t),this.filterMap.delete(t)},t.prototype.getCapabilities=function(){return Promise.resolve({supportedContentTypes:i.b.CommentThread,supportsMentionToMeFilter:!0})},t.prototype.getHostSpecificLabels=function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return[2,{}]}))}))},t.prototype.getFilterUsers=function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return[2,[]]}))}))},t.prototype.updateOrder=function(t,e){var n,i,a,r,s,c=this,l=new Set,u=null!==(n=this.filteredContentMap.get(t))&&void 0!==n?n:[],p=null!==(a=null===(i=this.wordFilterAPI)||void 0===i?void 0:i.getAllContent().filter((function(t){if((null==t?void 0:t.contentId)&&(null==t?void 0:t.containerContentType)===o.CommentThread){var n=t.contentId;return!!c.includeCommentInOrder(e,t)&&(!l.has(n)&&(l.add(n),!0))}return!1})).map((function(t){var e;return{contentId:null!==(e=t.contentId)&&void 0!==e?e:"",contentType:d(t.containerContentType)}})))&&void 0!==a?a:[];this.filteredContentMap.set(t,p),this.filterMap.set(t,{filter:e,supportsFilterUpdates:!0});var h=this.idsInFilter.get(t);return this.idsInFilter.set(t,l),this.activeFilteredRange===t&&(null===(s=(r=this.wordFilterAPI).updateCurrentFilteredContent)||void 0===s||s.call(r,l)),yt(u,p,h,l)},t.prototype.onContentChanged=function(){var t=this;this.filterMap.forEach((function(e,n){t.updateFilterForFilteredRangeId(n,e.filter)}))},t.prototype.includeCommentInOrder=function(t,e){var n,o;if(t.CommentThread){if(e.contentId&&(null===(o=(n=this.wordFilterAPI).isDraftContent)||void 0===o?void 0:o.call(n,e.contentId)))return!0;if(t.CommentThread.resolutionStatus===gt.a.ResolvedOnly&&this.wordFilterAPI.isContentActive(e))return!1;if(t.CommentThread.resolutionStatus===gt.a.ActiveOnly&&!this.wordFilterAPI.isContentActive(e))return!1}return!(t.mentionsToCurrentUser&&!this.wordFilterAPI.isCurrentUserMentioned(e))},t}(),Tt=new(function(){function t(){var t=new vt;this.trackChangesStore=new pt(t)}return t.prototype.getFCManagerInstance=function(t){if(void 0===this.floatingContainerManagerInstance){if(!t)throw new Error("Floating Container Manager creation arguments are missing!");t.ulsLogger&&q.a.setLogger(t.ulsLogger);var e={DeselectionEnabled:!!(c=t.featureGates).deselectionEnabled,FloatingContainerVirtualizationEnabled:!!c.floatingContainerVirtualizationEnabled,ImproveJumpingFixEnabled:!!c.improveJumpingFixEnabled,ShouldInitialize:!1!==c.shouldInitialize,ScrollingPerfImprovementEnabled:!!c.scrollingPerfImprovementEnabled,SynchronousContainerPositioningEnabled:!!c.synchronousContainerPositioningEnabled,TrackChangesInSidetrackEnabled:!!c.trackChangeInSidetrackEnabled,ContentNavigationApiEnabled:!!c.contentNavigationApiEnabled,ReturnToDraftFixEnabled:!!c.returnToDraftFixEnabled};t.featureGateApiSettings&&Object(h.b)({appSettings:t.featureGateApiSettings,mapping:ht.a});var n=t.isRtl?1:-1,o=t.canvasAndFcHostOffset?n*(t.canvasAndFcHostOffset-1):0,a=new u(tt,q.a,o),r=new I({containerVirtualizationEnabled:e.FloatingContainerVirtualizationEnabled}),s=new ct(i.f,t.containerPanel,Q,q.a,t.viewportInfo);t.telemetryDetails&&Object(m.l)(Ct.a,t.telemetryDetails),this.trackChangesStore.loadStrings(t.uiCulture),this.floatingContainerManagerInstance=new dt(a,r,s,t.paneClosedCallback,t.paneOpenedCallback,e,t.destroyAllContainersCallback,this.trackChangesStore),e.ContentNavigationApiEnabled&&t.sidetrackContentNavigationApi&&this.registerContentNavigationApi(t.sidetrackContentNavigationApi),e.ContentNavigationApiEnabled&&t.contentFilterAPI&&this.registerContentFilteredRangeHostApi(t.contentFilterAPI)}var c;return this.floatingContainerManagerInstance},t.prototype.getTrackChangesStoreApi=function(){return this.trackChangesStore},t.prototype.getFCContentNavigationAPI=function(){return this.floatingContainerContentNavigationAPI},t.prototype.getTrackChangesStore=function(){return this.trackChangesStore},t.prototype.registerContentNavigationApi=function(t){Object($.h)(this.initializeAndGetContentNavigationAPI(t),Y.a)},t.prototype.initializeAndGetContentNavigationAPI=function(t){return this.floatingContainerContentNavigationAPI||(this.floatingContainerContentNavigationAPI=new ut(t)),this.floatingContainerContentNavigationAPI},t.prototype.registerContentFilteredRangeHostApi=function(t){Object(gt.g)(Y.a,this.initializeAndGetContentFilteredRangeHostApi(t))},t.prototype.initializeAndGetContentFilteredRangeHostApi=function(t){return this.contentFilteredRangeHostAPI||(this.contentFilteredRangeHostAPI=new bt(t)),this.contentFilteredRangeHostAPI},t}()),xt=Tt;n.d(e,"FactoryGlobal",(function(){return xt}))}}]);
//# sourceMappingURL=floatingContainerManager.min.js.map