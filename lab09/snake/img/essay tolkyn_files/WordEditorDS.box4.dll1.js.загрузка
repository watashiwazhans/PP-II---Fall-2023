'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1049:function(E,M,c){function m(O,L=self){L.addEventListener("message",function X(W){if(W&&W.data){var {id:V,type:Z,path:da}=Object.assign({path:[]},W.data),aa=(W.data.tuh||[]).map(n);try{const na=da.slice(0,-1).reduce((ja,ma)=>ja[ma],O),pa=da.reduce((ja,ma)=>ja[ma],O);switch(Z){case "GET":var ea=pa;break;case "SET":na[da.slice(-1)[0]]=n(W.data.value);ea=!0;break;case "APPLY":ea=pa.apply(na,aa);break;case "CONSTRUCT":const ja=
new pa(...aa);ea=Object.assign(ja,{[w]:!0});break;case "ENDPOINT":const {port1:ma,port2:Ia}=new MessageChannel;m(O,Ia);ea=y(ma,[ma]);break;case "RELEASE":ea=void 0;break;default:return}}catch(na){ea={value:na,[I]:0}}Promise.resolve(ea).catch(na=>({value:na,[I]:0})).then(na=>{const [pa,ja]=z(na);L.postMessage(Object.assign(Object.assign({},pa),{id:V}),ja);"RELEASE"===Z&&(L.removeEventListener("message",X),"MessagePort"===L.constructor.name&&L.close())})}});L.start&&L.start()}function e(O){if(O)throw Error("Proxy has been released and is not useable");
}function a(O,L=[],U=function(){}){let W=!1;const X=new Proxy(U,{get(V,Z){e(W);if(Z===F)return()=>v(O,{type:"RELEASE",path:L.map(da=>da.toString())}).then(()=>{"MessagePort"===O.constructor.name&&O.close();W=!0});if("then"===Z){if(0===L.length)return{then:()=>X};V=v(O,{type:"GET",path:L.map(da=>da.toString())}).then(n);return V.then.bind(V)}return a(O,[...L,Z])},set(V,Z,da){e(W);const [aa,ea]=z(da);return v(O,{type:"SET",path:[...L,Z].map(na=>na.toString()),value:aa},ea).then(n)},apply(V,Z,da){e(W);
V=L[L.length-1];if(V===G)return v(O,{type:"ENDPOINT"}).then(n);if("bind"===V)return a(O,L.slice(0,-1));const [aa,ea]=l(da);return v(O,{type:"APPLY",path:L.map(na=>na.toString()),tuh:aa},ea).then(n)},construct(V,Z){e(W);const [da,aa]=l(Z);return v(O,{type:"CONSTRUCT",path:L.map(ea=>ea.toString()),tuh:da},aa).then(n)}});return X}function l(O){O=O.map(z);return[O.map(L=>L[0]),Array.prototype.concat.apply([],O.map(L=>L[1]))]}function y(O,L){N.set(O,L);return O}function z(O){for(const [L,U]of J)if(U.tAh(O)){const [W,
X]=U.serialize(O);return[{type:"HANDLER",name:L,value:W},X]}return[{type:"RAW",value:O},N.get(O)||[]]}function n(O){switch(O.type){case "HANDLER":return J.get(O.name).deserialize(O.value);case "RAW":return O.value}}function v(O,L,U){return new Promise(W=>{const X=A();O.addEventListener("message",function da(Z){Z.data&&Z.data.id&&Z.data.id===X&&(O.removeEventListener("message",da),W(Z.data))});O.start&&O.start();O.postMessage(Object.assign({id:X},L),U)})}function A(){return Array(4).fill(0).map(()=>
Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}E=c(0);const w=Symbol("Comlink.proxy"),G=Symbol("Comlink.endpoint"),F=Symbol("Comlink.releaseProxy"),I=Symbol("Comlink.thrown"),K=O=>"object"===typeof O&&null!==O||"function"===typeof O,J=new Map([["proxy",{tAh:O=>K(O)&&O[w],serialize(O){const {port1:L,port2:U}=new MessageChannel;m(O,L);return[U,[U]]},deserialize(O){O.start();return a(O,[],void 0)}}],["throw",{tAh:O=>K(O)&&I in O,serialize({value:O}){return[O instanceof Error?
{WPa:!0,value:{message:O.message,name:O.name,stack:O.stack}}:{WPa:!1,value:O},[]]},deserialize(O){if(O.WPa)throw Object.assign(Error(O.value.message),O.value);throw O.value;}}]]),N=new WeakMap;c.d(M,"a",function(){return R});class R{static fTj(O){R.v$a=O;R.Znk=a(O,[],void 0)}static get Endpoint(){return R.v$a}static get gTj(){return R.Znk}}Object(E.a)(R,"WorkerUtils",null,[])},1065:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{}Object(E.a)(m,"WaterlineOverrideSettings",null,[])},
1066:function(E,M,c){E=c(0);var m=c(411),e=c(520),a=c(568),l=c(231);class y extends l.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}$k(){return 97}static Paa(G,F,I){const K=new y;K.FileId=G;K.HighWaterline=F;K.LowWaterline=I;return K}}Object(E.a)(y,"GetActivitiesRequest",l.a,[]);class z extends l.a{constructor(G,F,I){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=G;this.Waterline=F;this.Settings=I}$k(){return 107}static Paa(G,F,I){return new z(G,
F,I)}}Object(E.a)(z,"GetRelevantActivitiesRequest",l.a,[]);class n extends l.a{constructor(G,F){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=G;this.WaterlineOverrideSettings=F}$k(){return 96}static Paa(G,F){return new n(G,F)}}Object(E.a)(n,"GetWywaActivitiesRequest",l.a,[]);class v{}Object(E.a)(v,"RelevantActivitiesSettings",null,[]);class A extends l.a{constructor(){super();this.FileId=null}$k(){return 109}static Paa(G){const F=new A;F.FileId=G;return F}}Object(E.a)(A,"UpdateWaterlineRequest",
l.a,[]);c.d(M,"a",function(){return w});class w{constructor(G,F,I,K,J){this.yak=G;this.gtd=F;this.mPe=I;this.zoc=K;this.GNg=J}requestWYWAActivities(G){G=n.Paa(this.gtd(),G);return m.a.then(this.bba(G,"wywa"),F=>F)}requestActivities(G,F){G=y.Paa(this.gtd(),G,F);return m.a.then(this.bba(G,"activities"),I=>I)}a3n(){const G=A.Paa(this.gtd());return m.a.then(this.bba(G,"waterline"),F=>F)}requestRelevantActivities(G,F){F=Object.assign(new v,{FirstDocumentOpen:F,MockDataEnabled:!1});G=z.Paa(this.gtd(),G,
F);return m.a.then(this.bba(G,"relevant"),I=>I)}updateActivityState(G){return m.a.$9c(this.GNg,F=>F.CQo(G.itemIds,G.activityStatesToSet,G.activityStatesToReset,G.resetUnseenCount))}requestActivityFeed(){return m.a.$9c(this.GNg,G=>G.getActivityFeed(null))}bba(G,F){const I={"Content-Type":"application/json; charset=utf-8"};return m.a.then(m.a.$9c(this.yak,K=>K.tw(this.mPe,I,e.a.dHh(G,this.zoc),F)),K=>{if(!(K&&K.args&&K.args.data&&K.args.data.xe))return null;({group:K}=a.a.l1(K.args.data.xe));return K&&
K.Responses&&K.Responses.length?K.Responses[0]:null})}}Object(E.a)(w,"SharedActivityRepository",null,[])},1396:function(E,M,c){c.d(M,"a",function(){return e});var m;(function(a){a[a.Unknown=0]="Unknown";a[a.G7o=1]="Inference"})(m||(m={}));var e;(function(a){a[a.Unknown=0]="Unknown";a[a.U9o=1]="VoiceDictationBadge";a[a.V9o=2]="VoiceDictationPhrase"})(e||(e={}))},1499:function(E,M,c){c.r(M);c.d(M,"Box4PasteSteward",function(){return aa});E=c(0);var m=c(22),e=c(2),a=c(19),l=c(123),y=c(53),z=c(6),n=c(7),
v=c(34),A=c(74),w=c(9),G=c(103),F=c(121),I=c(8),K=c(3),J=c(86),N=c(5),R=c(209),O=c(140),L=c(36),U=c(81),W=c(40),X=c(56),V=c(28),Z=c(441),da=c(1743);class aa extends da.a{constructor(ea,na,pa,ja,ma,Ia,Ja,Ka=null,Ma=null){super(ea,Ja,Ka,Ma);this._formatting=null;this.tKa=!1;this.Mtb=null;this.jVb=-1;this.tvb=0;this.ABc=new A.a;this.$9m=4294967295;v.a(4223754,307,W.OutlineElementReader.Bh(ea));this.Stb=na;this.Stb.k1b(this);this.WL=pa;this.WL.k1b(this);this.fq=ja;this.Un=ma;this.aNe=G.ListItemReader.sh(this.Ec);
aa.Uxm();aa.Gxm();aa.qym()}get qwa(){return null!=this.zCg?this.zCg:this.zCg=m.a.instance.Na("Box4.IInternalLinkManager")}get kHd(){return this._formatting}get k3b(){return this.aNe&&!this.WL.rDa}get ABb(){return 0<this.tvb}reset(){super.reset();this._formatting=this.$of(!1)}L0e(ea){var na;v.a(4223762,307,W.OutlineElementReader.Bh(this.Ec)||U.OutlineReader.Zw(this.Ec));this.Jdc(!1);var pa=new N.GraphIterator;pa.Yc(this.Ec);ea=da.a.lg.OI(this.Ec,this.AOc(ea));this.HAd(pa,!1);v.a(4223763,307,ea===this.Ec.currentNode);
v.a(4223764,307,I.ParagraphReader.Wb(ea));-1!==this._formatting.lw&&aa.paragraphEditor.gE(ea,this._formatting.lw);if(aa.paragraphEditor.fq&&!this.$Y.Wpj&&this._formatting.textIndent&&({unit:ma,returnValue:ja}=aa.t9d(this._formatting.textIndent),pa=!1,ja||!R.a.t_)){if(0>ja){pa=!0;var ja=-1*ja}var ma=aa.d$e(ja,ma);pa?aa.paragraphEditor.fq.gob(ea,ma):aa.paragraphEditor.fq.Tca(ea,ma)}(aa.Ld.qg||J.a.instance.J(1)&&w.App.Zv.bQb)&&ea.setValue(z.a.hQa,!0);this._formatting.lineSpacing&&aa.paragraphEditor.dD(ea,
this._formatting.lineSpacing);e.AFrameworkApplication.ue("702j5362;7g13g664");this._formatting.xR&&(null===(na=e.AFrameworkApplication.K)||void 0===na?0:na.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(n.ULS.sendTraceTag(509092556,307,50,"Setting before and after Spacing from margin top and bottom which we got from pasted HTML"),aa.paragraphEditor.aob(ea,this._formatting.xR.afterSpacing),aa.paragraphEditor.bob(ea,this._formatting.xR.beforeSpacing));
if(this._formatting.ykc){na=[];pa=[];ma=[];ja=this._formatting.ykc.split(" ");let Ka=1,Ma=0;for(let sa=0;sa<ja.length;sa++){var Ia=aa.K5k(ja[sa]),Ja=aa.J5k(ja[sa]);if(-1!==Ia)Ka=Ia;else if(-1!==Ja)Ma=Ja;else{({unit:Ia,returnValue:Ja}=aa.t9d(ja[sa]));Ia=aa.d$e(Ja,Ia);if(0<=Ia&&Ia<=this.$9m)na.push(Ia),pa.push(Ka),ma.push(Ma);else{v.b(555103310,307,15,"Invalid custom tab value. tabStops: "+this._formatting.ykc+" index: "+sa);break}Ka=1;Ma=0}}0<na.length&&aa.paragraphEditor.Oqk(ea,na,pa,ma)}this._formatting.paragraph=
ea;this.tKa=!0}HAd(ea,na){v.a(8128518,307,!na);this.JU&&(0<this.JU&&this.fq.ZIc(ea,this.JU),0>this.JU&&this.fq.VRa(ea,this.JU,0));ea&&this.Un.Dge(ea,this.ABb);this.JU=0}I$c(ea){this.ABc.add(ea)}a7e(){this.JU=0}tca(ea,na=null){v.a(4223772,307,I.ParagraphReader.uh(this.Ec));const pa=this.Ec.currentNode;this._formatting.ukg(pa);if(!this.$Y.Dkg(this.Ec,na,!1)){var ja=pa.pa.last,ma=V.a.fw(pa);this.tKa&&(ja.formatting=this._formatting.GQ.Ef(ja),pa.Xl(),this.tKa=!1);ea=this.$Y.xwf(ea,na);this.$Y.zHa(this.Ec.currentNode,
this._formatting.zca,na);this.characterPropertiesEditor.replaceTextRange(ma,ea,void 0,void 0,K.a.paste)}}sca(ea){this.$Y.EZd&&this.$Y.wYd(ea)?(this.qF(),this.$D(ea)):(v.a(4223773,307,I.ParagraphReader.uh(this.Ec)),ea=V.a.fw(this.Ec.currentNode),this.characterPropertiesEditor.Uga(ea,na=>new Z.a(na)))}imb(){this.$Y.Ewf(this.Ec)}qxa(ea){if(aa.Ipl(ea)){const na=this.Ec.currentNode;I.ParagraphReader.Wb(na)&&(na.Bfc=ea.Vif)}else this.Stb.qxa(ea)}nGa(ea){this._formatting=ea;this.tKa=!0}tRa(ea){v.a(4223774,
307,I.ParagraphReader.uh(this.Ec));v.a(4223775,307,!this.Mtb);v.a(4223776,307,0>this.jVb);this.Mtb=ea;this.jVb=I.ParagraphReader.textLength(this.Ec.currentNode)}sRa(){v.a(4223777,307,I.ParagraphReader.uh(this.Ec));v.a(4223778,307,!!this.Mtb);v.a(4223779,307,0<=this.jVb);let ea=V.a.createTextRange(this.Ec.currentNode,this.jVb,I.ParagraphReader.textLength(this.Ec.currentNode)),na="",pa="";this.qwa&&({y4f:na,lDb:pa}=this.qwa.wkg(F.HyperlinkReader.dPa(this.Mtb))).returnValue&&(this.Mtb=na,pa&&(this.characterPropertiesEditor.replaceTextRange(ea,
pa),ea=V.a.createTextRange(this.Ec.currentNode,this.jVb,I.ParagraphReader.textLength(this.Ec.currentNode))));aa.hyperlinkEditor.hG(ea,this.Mtb,!1);this.tKa=!0;this.Mtb=null;this.jVb=-1}$D(ea){this.L0e(ea);this._formatting.ime(this.Ec.currentNode);this.$Y.zHa(this.Ec.currentNode,this._formatting.zca,ea)}qF(){v.a(4223808,307,I.ParagraphReader.uh(this.Ec));aa.hyperlinkEditor.dul(this.Ec.currentNode);L.OutlineElementNavigator.Vd(this.Ec)}dmb(){}cmb(){}yRa(){}B4a(){}uxa(){v.a(4223809,307,W.OutlineElementReader.Bh(this.Ec)||
U.OutlineReader.Zw(this.Ec));let ea=!1;this.ABb||(ea=this.k3b||!0);ea||(this.JU+=1);this.tvb++}sxa(){this.tvb--;let ea=!1;this.ABb||(ea=this.k3b||!0,this.Un.W9i(this.ABc));ea||--this.JU}sGa(ea){v.a(4223810,307,W.OutlineElementReader.Bh(this.Ec)||U.OutlineReader.Zw(this.Ec));v.a(4223811,307,!!ea.listStyleType);this.Un.Cge(this.jYm(ea))}txa(){v.a(4223813,307,W.OutlineElementReader.Bh(this.Ec))}D4a(ea){this.Stb.D4a(ea)}b9(ea){this.WL.b9(ea)}Z8(){this.WL.Z8()}G4(ea){this.WL.G4(ea)}a9(){this.WL.a9()}Y8(ea){this.WL.Y8(ea)}X8(){this.WL.X8()}static get paragraphEditor(){return null!=
aa.cFg?aa.cFg:aa.cFg=m.a.instance.resolve("Box4.IParagraphEditor")}static get hyperlinkEditor(){return null!=aa.AAg?aa.AAg:aa.AAg=m.a.instance.resolve("Box4.IHyperlinkEditor")}static get Ld(){return null!=aa.qIg?aa.qIg:aa.qIg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get hJj(){return null!=aa.fJg?aa.fJg:aa.fJg=m.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get tkc(){return aa.tTe}static set tkc(ea){aa.tTe=ea}static get Vn(){return O.a.getInstance()}static Uxm(){aa.Q4a[1]=
X.StyleReader.wordStyleIdHeading1;aa.Q4a[2]=X.StyleReader.wordStyleIdHeading2;aa.Q4a[3]=X.StyleReader.wordStyleIdHeading3;aa.Q4a[4]=X.StyleReader.i8a;aa.Q4a[5]=X.StyleReader.j8a;aa.Q4a[6]=X.StyleReader.k8a;aa.Q4a[7]=null}static Gxm(){aa.Vwa.unspecified=0;aa.Vwa.defaultUnordered=1;aa.Vwa.defaultOrdered=1;aa.Vwa.none=0;aa.Vwa.disc=1;aa.Vwa.circle=2;aa.Vwa.square=3;aa.Vwa.decimal=1;aa.Vwa.lowerAlpha=2;aa.Vwa.lowerRoman=3;aa.Vwa.upperAlpha=4;aa.Vwa.upperRoman=5}static qym(){aa.tTe=aa.hJj.Mr()}static K5k(ea){let na=
-1;if(!ea)return na;ea=ea.toLowerCase();switch(ea){case "left":na=1;break;case "center":na=3;break;case "right":na=4;break;case "decimal":na=6;break;case "bar":na=7}return na}static J5k(ea){let na=-1;if(!ea)return na;ea=ea.toLowerCase();switch(ea){case "blank":na=0;break;case "dotted":na=1;break;case "dashed":na=2;break;case "lined":na=3}return na}static SAb(ea){const na=a.a.substring(ea,0,2),pa=a.a.substring(ea,2,4);return a.a.substring(ea,4,6)+pa+na}static t9d(ea){let na=0;const pa=ea.length;var ja=
a.a.substring(ea,0,pa-2);ja=parseFloat(ja);ea=a.a.substr(ea,pa-2,2);switch(ea){case "in":na=3;break;case "px":na=7;break;case "cm":na=1;break;case "pt":na=5;break;default:n.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",ea),ja=0}return{returnValue:ja,unit:na}}static d$e(ea,na){let pa=0;switch(na){case 3:pa=l.a.Dv(ea);break;case 7:pa=y.a.Ay(ea,0);break;case 1:pa=l.a.d6e(ea);break;case 5:pa=l.a.Dv(l.a.oZf(ea));break;default:n.ULS.sendTraceTag(8208451,
307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",ea,na)}return pa}static Ipl(ea){return!!ea&&!!ea.Vif&&""!==ea.Vif}}aa.Q4a=Array(8);aa.Vwa={};aa.tTe=null;Object(E.a)(aa,"Box4PasteSteward",da.a,[])},1524:function(E,M,c){E=c(0);var m=c(2),e=c(1998),a=c(7);const l=(z,n)=>{const v={};let A=null;switch(z){case 0:A="HtmlProcessor";var w=n.a;null!=w&&(v.SessionID=w);var G=n.b.toString();null!=G&&(v.Elements=G);var F=n.c.toString();null!=F&&(v.PrunedElements=
F);var I=n.d.toString();null!=I&&(v.TransparentElements=I);var K=n.e.toString();null!=K&&(v.VoidElements=K);var J=n.f.toString();null!=J&&(v.UnknownElements=J);break;case 1:A="WordConverter";var N=n.a;null!=N&&(v.SessionID=N);var R=n.b.toString();null!=R&&(v.BulletsConverted=R);var O=n.c.toString();null!=O&&(v.NumberedConverted=O);break;case 2:A="FormattingSteward";var L=n.a;null!=L&&(v.SourceApp=L);var U=n.b;null!=U&&(v.Browser=U);var W=n.c;null!=W&&(v.OperationId=W);var X=n.d.toString();null!=X&&
(v.Lang=X);var V=n.e.toString();null!=V&&(v.TextDir=V);var Z=n.f.toString();null!=Z&&(v.Bold=Z);var da=n.g.toString();null!=da&&(v.Math=da);var aa=n.h.toString();null!=aa&&(v.Italics=aa);var ea=n.i.toString();null!=ea&&(v.Underline=ea);var na=n.j.toString();null!=na&&(v.Strikethrough=na);var pa=n.k.toString();null!=pa&&(v.Subscript=pa);var ja=n.l.toString();null!=ja&&(v.Superscript=ja);var ma=n.m.toString();null!=ma&&(v.Fontsize=ma);var Ia=n.n.toString();null!=Ia&&(v.Fontface=Ia);var Ja=n.o.toString();
null!=Ja&&(v.GrowFontsize=Ja);var Ka=n.p.toString();null!=Ka&&(v.ShrinkFontsize=Ka);var Ma=n.q.toString();null!=Ma&&(v.FontColor=Ma);var sa=n.r.toString();null!=sa&&(v.FontHighlight=sa);var xa=n.s.toString();null!=xa&&(v.ParagraphStyle=xa);var ia=n.t.toString();null!=ia&&(v.TextAlign=ia);var ha=n.u.toString();null!=ha&&(v.TextIndent=ha);var ua=n.v.toString();null!=ua&&(v.MarginLeft=ua);var ya=n.w.toString();null!=ya&&(v.ParagraphSpaceBefore=ya);var ra=n.x.toString();null!=ra&&(v.ParagraphSpaceAfter=
ra);var La=n.y.toString();null!=La&&(v.LineSpace=La);var oa=n.z.toString();null!=oa&&(v.CellShadingColor=oa);var Ca=n.ba.toString();null!=Ca&&(v.StyleDefinition=Ca);var Aa=n.bb.toString();null!=Aa&&(v.TabStops=Aa);break;case 3:A="SemanticEvents";var db=n.a;null!=db&&(v.SessionID=db);var eb=n.b.toString();null!=eb&&(v.Text=eb);var ib=n.c.toString();null!=ib&&(v.LineBreak=ib);var lb=n.d.toString();null!=lb&&(v.Image=lb);var Ya=n.e.toString();null!=Ya&&(v.File=Ya);var Fa=n.f.toString();null!=Fa&&(v.FormattingChange=
Fa);var $a=n.g.toString();null!=$a&&(v.Anchor=$a);var Db=n.h.toString();null!=Db&&(v.Paragraph=Db);var gc=n.i.toString();null!=gc&&(v.Math=gc);var Eb=n.j.toString();null!=Eb&&(v.List=Eb);var kb=n.k.toString();null!=kb&&(v.ListItem=kb);var bb=n.l.toString();null!=bb&&(v.RenderAugmentation=bb);var Gb=n.m.toString();null!=Gb&&(v.Span=Gb);break;case 4:A="SemanticTableEvents";var Sa=n.a;null!=Sa&&(v.SessionID=Sa);var Pa=n.b.toString();null!=Pa&&(v.Tables=Pa);var Ab=n.c.toString();null!=Ab&&(v.TableRow=
Ab);var nb=n.d.toString();null!=nb&&(v.TableCell=nb);var Rb=n.e.toString();null!=Rb&&(v.TablePart=Rb);break;case 5:A="HtmlEvents";var Mb=n.a;null!=Mb&&(v.OperationId=Mb);var oc=n.b;null!=oc&&(v.SourceApp=oc);var xb=n.c;null!=xb&&(v.Browser=xb);var cc=null==n.d?null:n.d.toString();null!=cc&&(v.Text=cc);var Ob=null==n.e?null:n.e.toString();null!=Ob&&(v.A=Ob);var Ub=null==n.f?null:n.f.toString();null!=Ub&&(v.Abbr=Ub);var pb=null==n.g?null:n.g.toString();null!=pb&&(v.Acronym=pb);var Zb=null==n.h?null:
n.h.toString();null!=Zb&&(v.Address=Zb);var Wa=null==n.i?null:n.i.toString();null!=Wa&&(v.Applet=Wa);var Lb=null==n.j?null:n.j.toString();null!=Lb&&(v.Area=Lb);var qc=null==n.k?null:n.k.toString();null!=qc&&(v.B=qc);var Ra=null==n.l?null:n.l.toString();null!=Ra&&(v.Base=Ra);var yb=null==n.m?null:n.m.toString();null!=yb&&(v.Basefont=yb);var Bb=null==n.n?null:n.n.toString();null!=Bb&&(v.Bdo=Bb);var cb=null==n.o?null:n.o.toString();null!=cb&&(v.Big=cb);var Xa=null==n.p?null:n.p.toString();null!=Xa&&
(v.Blockquote=Xa);var hb=null==n.q?null:n.q.toString();null!=hb&&(v.Body=hb);var Cb=null==n.r?null:n.r.toString();null!=Cb&&(v.Br=Cb);var ob=null==n.s?null:n.s.toString();null!=ob&&(v.Button=ob);var ab=null==n.t?null:n.t.toString();null!=ab&&(v.Caption=ab);var Ib=null==n.u?null:n.u.toString();null!=Ib&&(v.Center=Ib);var Yb=null==n.v?null:n.v.toString();null!=Yb&&(v.Cite=Yb);var ub=null==n.w?null:n.w.toString();null!=ub&&(v.Code=ub);var Ac=null==n.x?null:n.x.toString();null!=Ac&&(v.Col=Ac);var Pc=
null==n.y?null:n.y.toString();null!=Pc&&(v.Colgroup=Pc);var Mc=null==n.z?null:n.z.toString();null!=Mc&&(v.Dd=Mc);var Ed=null==n.ba?null:n.ba.toString();null!=Ed&&(v.Del=Ed);var ne=null==n.bb?null:n.bb.toString();null!=ne&&(v.Dfn=ne);var Ie=null==n.bc?null:n.bc.toString();null!=Ie&&(v.Dir=Ie);var cd=null==n.bd?null:n.bd.toString();null!=cd&&(v.Div=cd);var Ic=null==n.be?null:n.be.toString();null!=Ic&&(v.Dl=Ic);var Rc=null==n.bf?null:n.bf.toString();null!=Rc&&(v.Dt=Rc);var xc=null==n.bg?null:n.bg.toString();
null!=xc&&(v.Em=xc);var Ae=null==n.bh?null:n.bh.toString();null!=Ae&&(v.Fieldset=Ae);var Ue=null==n.bi?null:n.bi.toString();null!=Ue&&(v.Font=Ue);var Xe=null==n.bj?null:n.bj.toString();null!=Xe&&(v.Form=Xe);var ef=null==n.bk?null:n.bk.toString();null!=ef&&(v.Frame=ef);var Se=null==n.bl?null:n.bl.toString();null!=Se&&(v.Frameset=Se);var pc=null==n.bm?null:n.bm.toString();null!=pc&&(v.H=pc);var id=null==n.bn?null:n.bn.toString();null!=id&&(v.Head=id);var Xc=null==n.bo?null:n.bo.toString();null!=Xc&&
(v.Hr=Xc);var he=null==n.bp?null:n.bp.toString();null!=he&&(v.Html=he);var $d=null==n.bq?null:n.bq.toString();null!=$d&&(v.I=$d);var Ud=null==n.br?null:n.br.toString();null!=Ud&&(v.Iframe=Ud);var Jf=null==n.bs?null:n.bs.toString();null!=Jf&&(v.Img=Jf);var hh=null==n.bt?null:n.bt.toString();null!=hh&&(v.Input=hh);var Qi=null==n.bu?null:n.bu.toString();null!=Qi&&(v.Ins=Qi);var Lg=null==n.bv?null:n.bv.toString();null!=Lg&&(v.Isindex=Lg);var bc=null==n.bw?null:n.bw.toString();null!=bc&&(v.Kbd=bc);var vc=
null==n.bx?null:n.bx.toString();null!=vc&&(v.Label=vc);var Vc=null==n.by?null:n.by.toString();null!=Vc&&(v.Legend=Vc);var yd=null==n.bz?null:n.bz.toString();null!=yd&&(v.Li=yd);var ee=null==n.ca?null:n.ca.toString();null!=ee&&(v.Link=ee);var Qe=null==n.cb?null:n.cb.toString();null!=Qe&&(v.Map=Qe);var ue=null==n.cc?null:n.cc.toString();null!=ue&&(v.Math=ue);var ve=null==n.cd?null:n.cd.toString();null!=ve&&(v.Menu=ve);var xf=null==n.ce?null:n.ce.toString();null!=xf&&(v.Meta=xf);var bf=null==n.cf?null:
n.cf.toString();null!=bf&&(v.Noframes=bf);var Df=null==n.cg?null:n.cg.toString();null!=Df&&(v.Noscript=Df);var nf=null==n.ch?null:n.ch.toString();null!=nf&&(v.Object=nf);var Yf=null==n.ci?null:n.ci.toString();null!=Yf&&(v.Ol=Yf);var Kf=null==n.cj?null:n.cj.toString();null!=Kf&&(v.Optgroup=Kf);var wb=null==n.ck?null:n.ck.toString();null!=wb&&(v.Option=wb);var Tb=null==n.cl?null:n.cl.toString();null!=Tb&&(v.P=Tb);var Wc=null==n.cm?null:n.cm.toString();null!=Wc&&(v.Param=Wc);var Gd=null==n.cn?null:n.cn.toString();
null!=Gd&&(v.Pre=Gd);var Ye=null==n.co?null:n.co.toString();null!=Ye&&(v.Q=Ye);var od=null==n.cp?null:n.cp.toString();null!=od&&(v.S=od);var vf=null==n.cq?null:n.cq.toString();null!=vf&&(v.Samp=vf);var df=null==n.cr?null:n.cr.toString();null!=df&&(v.Script=df);var dh=null==n.cs?null:n.cs.toString();null!=dh&&(v.Select=dh);var Ki=null==n.ct?null:n.ct.toString();null!=Ki&&(v.Small=Ki);var Zh=null==n.cu?null:n.cu.toString();null!=Zh&&(v.Span=Zh);var rh=null==n.cv?null:n.cv.toString();null!=rh&&(v.Strike=
rh);var bm=null==n.cw?null:n.cw.toString();null!=bm&&(v.Strong=bm);var Bf=null==n.cx?null:n.cx.toString();null!=Bf&&(v.Style=Bf);var ig=null==n.cy?null:n.cy.toString();null!=ig&&(v.Sub=ig);var md=null==n.cz?null:n.cz.toString();null!=md&&(v.Sup=md);var td=null==n.da?null:n.da.toString();null!=td&&(v.Tables=td);var wd=null==n.db?null:n.db.toString();null!=wd&&(v.Tbody=wd);var pm=null==n.dc?null:n.dc.toString();null!=pm&&(v.Td=pm);var ai=null==n.dd?null:n.dd.toString();null!=ai&&(v.Textarea=ai);var Zg=
null==n.de?null:n.de.toString();null!=Zg&&(v.Tfoot=Zg);var Tk=null==n.df?null:n.df.toString();null!=Tk&&(v.Th=Tk);var el=null==n.dg?null:n.dg.toString();null!=el&&(v.Thead=el);var zl=null==n.dh?null:n.dh.toString();null!=zl&&(v.Title=zl);var ei=null==n.di?null:n.di.toString();null!=ei&&(v.Tr=ei);var fi=null==n.dj?null:n.dj.toString();null!=fi&&(v.Tt=fi);var Lj=null==n.dk?null:n.dk.toString();null!=Lj&&(v.U=Lj);var cm=null==n.dl?null:n.dl.toString();null!=cm&&(v.Ul=cm);var Rg=null==n.dm?null:n.dm.toString();
null!=Rg&&(v.Var=Rg);var Xf=null==n.dn?null:n.dn.toString();null!=Xf&&(v.Unknown=Xf);break;case 6:A="List";var Si=n.a;null!=Si&&(v.SessionID=Si);var Sl=n.b.toString();null!=Sl&&(v.MaxListLevel=Sl)}v.Table=A;return Sys.Serialization.JavaScriptSerializer.serialize(v)};c.d(M,"a",function(){return y});class y{static get ooa(){null==y.oub&&(y.oub=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("UsageEditorLoggingIsDisabled"));return y.oub}static get dyi(){null==y.vFe&&(y.vFe=!!m.AFrameworkApplication.K&&
m.AFrameworkApplication.K.$("WordUsageEditorLoggingIsEnabled"));return y.vFe}static h0(z){a.ULS.sendTraceTag(524038472,307,50,z)}static F9h(z){const n={};n.a=z;n.b=0;n.c=0;n.d=0;n.e=0;n.f=0;return n}static Q1m(z){y.ooa||y.h0(l(0,z))}static V4h(z){const n={};n._sessionID=z;return n}static zvf(z){const n={};n.a=z;n.b=0;n.c=0;return n}static z6m(z){y.ooa||y.h0(l(1,z))}static E9h(z,n){const v={};v.c=e.a[z];v.a=n;return v}static P1m(z,n){y.dyi&&z&&(z.b=n,y.h0(l(5,z)))}static Bfi(z){const n={};n.a=z;n.b=
0;n.c=0;n.d=0;n.e=0;n.f=0;n.g=0;n.h=0;n.i=0;n.j=0;n.k=0;n.l=0;n.m=0;return n}static $4m(z){y.ooa||y.h0(l(3,z))}static Cfi(z){const n={};n.a=z;n.b=0;n.c=0;n.d=0;n.e=0;return n}static a5m(z){y.ooa||y.h0(l(4,z))}static dqf(z,n){const v={};v.b=e.a[z];v.c=n;v.d=0;v.e=0;v.f=0;v.g=0;v.h=0;v.i=0;v.j=0;v.k=0;v.l=0;v.m=0;v.n=0;v.o=0;v.p=0;v.q=0;v.r=0;v.s=0;v.t=0;v.w=0;v.x=0;v.y=0;v.z=0;v.u=0;v.v=0;v.ba=0;v.bb=0;return v}static t1m(z,n){y.dyi&&z&&(z.a=n,y.h0(l(2,z)))}static x0l(z){const n={};n.a=z;n.b=-1;return n}static w2m(z){!y.ooa&&
z&&0<=z.b&&y.h0(l(6,z))}}y.oub=null;y.vFe=null;Object(E.a)(y,"UsageEditor",null,[])},1542:function(E,M,c){c.d(M,"a",function(){return a});E=c(0);var m=c(2),e=c(5);class a{static get zpb(){return!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("WordDesignerTelemetryPerConstructIsEnabled")}static jhb(l,y=!1){const z=e.GraphIterator.$a(l);z.yd();return(y?z.Rb(4):z.Oga(4))?4:e.GraphIterator.$a(l).zb(36)?16:e.GraphIterator.$a(l).zb(14)?2:e.GraphIterator.$a(l).zb(38)?32:1}}Object(E.a)(a,"ConstructTypeHelper",
null,[])},1557:function(E,M,c){c.d(M,"a",function(){return Ja});E=c(0);var m=c(22),e=c(53),a=c(123),l=c(2);M=c(82);var y=c(6),z=c(15),n=c(7),v=c(110),A=c(73),w=c(705),G=c(186),F=c(32),I=c(5),K=c(204),J=c(81),N=c(27),R=c(75),O=c(21),L=c(334),U=c(1499),W=c(224),X=c(257),V=c(703),Z=c(12),da=c(43),aa=c(36),ea=c(114),na=c(40),pa=c(271),ja=c(143),ma=c(560),Ia=c(44);class Ja{static get jsm(){return Ja.Z4j}static get ssm(){return Ja.c5j}static get qsm(){return Ja.b5j}static get Wg(){return null!=Ja.ixg?Ja.ixg:
Ja.ixg=W.ContextSetEditor.instance}static get wk(){return null!=Ja.fHg?Ja.fHg:Ja.fHg=m.a.instance.resolve("Box4.ITableEditor")}static get eD(){return null!=Ja.YGg?Ja.YGg:Ja.YGg=m.a.instance.Na("Box4.Styles.ITableCellspacingReader")}static HGn(Ka,Ma){const sa=Ka.currentNode;O.forEachCell(Ka,Ma.rowSpan,Ma.colSpan,(xa,ia,ha)=>{const ua=xa.currentNode;ua!==sa&&(ua.gg=!0,Ja.DQh(xa),!ha&&1<=Ma.colSpan&&(ua.colSpan=Ma.colSpan),Ja.nkj(xa,Ma.gja,ia,ha,Ma.rowSpan,Ma.colSpan))})}static oHn(Ka,Ma){O.forEachCell(Ka,
Ma.rowSpan,Ma.colSpan,sa=>{Ja.lEk(sa);Ja.DQh(sa)})}static lEk(Ka){Ka=Ka.currentNode;Ka.gg=!0;Ka.n4=!0;Ka.Iob=!0}static DQh(Ka){Ka&&(Ka.Rb(1),Object(v.a)(w.a,Ka.currentNode)&&Ka.wg())}static bFk(Ka,Ma,sa){0<Ma&&(Ka=Object(A.a)(G.TableCellNode,Ka.currentNode))&&(Ka.width=sa?Ma:e.a.Tl(Ma,0))}static oDk(Ka,Ma,sa){if(Ka=Object(A.a)(L.TableNode,Ka.currentNode))0<Ma&&(Ka.$d=e.a.Ay(Ma,0)),0<sa&&(Ka.eu=e.a.Ay(sa,0))}static $Ek(Ka,Ma){void 0!==Ma&&null!==Ma&&Ka.currentNode.properties.setValue(y.a.Aqa,Ja.ssm[Ma+
""])}static kEk(Ka,Ma){void 0!==Ma&&null!==Ma&&""!==Ma&&(Ma=parseInt(U.Box4PasteSteward.SAb(Ma),16),Ka.currentNode.properties.setValue(z.a.vH,Ma))}static Uyk(Ka){if(Ka){if(n.ULS.sendTraceTag(520890260,3022,50,"Adjusting column width after paste."),Object(Ia.a)("AdjustingColumnWidthAfterPaste",!0),16==Ka.type){var Ma=new I.GraphIterator;Ma.set(Ka);if(Ma.zb(14)){var sa=R.a(Ma),xa=N.TableCellReader.AO(Ka);if(Ma.hd(14)){Ka=Ma.currentNode;var ia=F.TableReader.tga(Ma);if(ia){var ha=Array.clone(ia);Ma=F.TableReader.xQd(Ma);
var ua=0,ya=0;for(var ra=0;ra<ia.length;ra++)ra>=sa&&ra<sa+xa?Ma[ra]>ia[ra]&&(ua+=Ma[ra]-ia[ra],ha[ra]=Ma[ra]):ya+=ia[ra]>Ma[ra]?ia[ra]-Ma[ra]:0;(null==ya||0>=ya||isNaN(ya))&&n.ULS.sendTraceTag(521187336,3022,50,"spaceAvailableToShrink is invalid");(null==ua||0>=ua||isNaN(ua))&&n.ULS.sendTraceTag(521187335,3022,50,"spaceToShrink is invalid");if(ya<ua)for(sa=0;sa<ia.length;sa++)ha[sa]=Ma[sa];else for(ra=0;ra<ia.length;ra++)if((ra<sa||ra>=sa+xa)&&ia[ra]>Ma[ra]){const La=(ia[ra]-Ma[ra])/ya;ha[ra]-=La*
ua;(null==ha[ra]||0>=ha[ra]||isNaN(ha[ra]))&&n.ULS.sendTraceTag(521187334,3022,50,"Getting negative column width for scale {0}",La)}sa=ja.a.hda+(Ja.eD?Ja.eD.Mva(Ka):0);for(ia=0;ia<ha.length;ia++)if(null==ha[ia]||0>=ha[ia]||isNaN(ha[ia]))n.ULS.sendTraceTag(521187333,3022,50,"Column width can not be negative."),ha[ia]=e.a.Tl(sa,0);Ka.eG=ha}else n.ULS.sendTraceTag(510253120,3022,50,"Column width should not be null")}}}}else n.ULS.sendTraceTag(537997910,3022,15,"Table cell should not be null")}static ggm(Ka){var Ma=
new I.GraphIterator;Ma.Yc(Ka);if((Ka=K.OutlineNavigator.X7f(Ma))&&J.OutlineReader.Zw(Ma)){Ma=Ka.Lf(y.a.Ao);const sa=Ka.Lf(y.a.marginLeft);Ka=Ka.Lf(y.a.marginRight);return Ma-sa-Ka}return 0}static fPm(Ka){return!(void 0===Ka||null===Ka||1===Ka)}static xic(Ka,Ma,sa,xa,ia){if(void 0===Ma||null===Ma||""!==Ma){switch(Ma){case "thin":Ma=a.a.j$d(.25);break;case "initial":case "medium":Ma=a.a.j$d(.5);break;case "thick":Ma=a.a.j$d(1);break;default:Ma=Ja.Pbm(Ma,sa,xa)}ia.currentNode.properties.setValue(Ka,
Ma)}}static wic(Ka,Ma,sa){void 0!==Ma&&null!==Ma&&Ma&&sa.currentNode.properties.setValue(Ka,Ja.qsm[Ma+""])}static heo(Ka,Ma,sa){void 0!==Ma&&null!==Ma&&""!==Ma&&(Ma=parseInt(U.Box4PasteSteward.SAb(Ma),16),sa.currentNode.properties.setValue(Ka,Ma))}static Pbm(Ka,Ma,sa){let xa=0;const ia=({unit:Ka}=U.Box4PasteSteward.t9d(Ka)).returnValue;switch(Ka){case 5:xa=a.a.j$d(ia);break;case 1:xa=a.a.bTk(ia);break;case 3:xa=a.a.ipi(ia);break;case 7:xa=e.a.fBn(ia,sa)}if(6===Ma||7===Ma||10===Ma)xa/=3;return Math.round(xa)}static Qbm(Ka,
Ma){let sa=0;const xa=({unit:Ka}=U.Box4PasteSteward.t9d(Ka)).returnValue;switch(Ka){case 5:sa=a.a.Nxa(xa);break;case 1:sa=a.a.c6e(xa);break;case 3:sa=a.a.hwa(xa);break;case 7:sa=e.a.Tl(xa,Ma)}return sa}static Kfe(Ka,Ma,sa,xa,ia,ha,ua){if(ia&&(!ua||16===ia.We||ua||14!==ia.We)&&12!==sa){if(ua)switch(xa){case 5:xa=y.a.zqa;var ya=y.a.Xa;var ra=y.a.Wa;var La=0;break;case 4:xa=y.a.yqa;ya=y.a.rb;ra=y.a.qb;La=1;break;case 0:xa=y.a.wqa;ya=y.a.Va;ra=y.a.Ua;La=0;break;case 3:xa=y.a.xqa;ya=y.a.pb;ra=y.a.ob;La=
1;break;default:return}else switch(xa){case 5:xa=y.a.yPb;ya=y.a.rpb;ra=y.a.Ekc;La=0;break;case 4:xa=y.a.xPb;ya=y.a.qpb;ra=y.a.Dkc;La=1;break;case 0:xa=y.a.vPb;ya=y.a.opb;ra=y.a.Bkc;La=0;break;case 3:xa=y.a.wPb;ya=y.a.ppb;ra=y.a.Ckc;La=1;break;default:return}void 0!==ia.currentNode&&null!==ia.currentNode&&(Ja.fPm(sa)?(Ja.heo(xa,Ka,ia),Ja.wic(ya,sa,ia),Ja.xic(ra,Ma,sa,La,ia)):ha||ua||ia.currentNode.properties.setValue(ya,"nil"))}}static nkj(Ka,Ma,sa,xa,ia,ha){xa||(Ja.uth(Ma,Ka,!1,!1),Ja.l1e(Ma,Ka,!0,
!1));xa===ha-1&&Ja.l1e(Ma,Ka,!0,!1);sa||Ja.Wth(Ma,Ka,!0,!1);sa===ia-1&&Ja.$sh(Ma,Ka,!0,!1)}static Zsh(Ka,Ma,sa,xa){Ka&&(Ja.Wth(Ka,Ma,sa,xa),Ja.l1e(Ka,Ma,sa,xa),Ja.$sh(Ka,Ma,sa,xa),Ja.uth(Ka,Ma,sa,xa))}static Wth(Ka,Ma,sa,xa){Ja.Kfe(Ka.borderTopColor,Ka.borderTopWidth,Ka.borderTopStyle,5,Ma,sa,xa)}static l1e(Ka,Ma,sa,xa){Ja.Kfe(Ka.borderRightColor,Ka.borderRightWidth,Ka.borderRightStyle,4,Ma,sa,xa)}static $sh(Ka,Ma,sa,xa){Ja.Kfe(Ka.borderBottomColor,Ka.borderBottomWidth,Ka.borderBottomStyle,0,Ma,sa,
xa)}static uth(Ka,Ma,sa,xa){Ja.Kfe(Ka.borderLeftColor,Ka.borderLeftWidth,Ka.borderLeftStyle,3,Ma,sa,xa)}static Lfe(Ka,Ma,sa){if(sa&&16===sa.We&&""!==Ka){switch(Ma){case 3:Ma=y.a.XHa;var xa=0;break;case 2:Ma=y.a.KR;xa=1;break;case 0:Ma=y.a.VHa;xa=0;break;case 1:Ma=y.a.qP;xa=1;break;default:return}(Ka=Ja.Qbm(Ka,xa))&&sa.currentNode.properties.setValue(Ma,Ka)}}static KCk(Ka,Ma){Ma&&(Ja.TEk(Ma,Ka),Ja.dEk(Ma,Ka),Ja.RCk(Ma,Ka),Ja.zDk(Ma,Ka))}static TEk(Ka,Ma){Ja.Lfe(Ka.WSk,3,Ma)}static dEk(Ka,Ma){Ja.Lfe(Ka.VSk,
2,Ma)}static RCk(Ka,Ma){Ja.Lfe(Ka.TSk,0,Ma)}static zDk(Ka,Ma){Ja.Lfe(Ka.USk,1,Ma)}static WCk(Ka,Ma,sa,xa){var ia=0;const ha=Array(Ka.length);var ua=0;xa&&(ua=(ua=a.a.lad(Ja.ggm(Ma)))?ua:1);for(xa=0;xa<Ka.length;xa++)ha[xa]=0<ua?ua/100*Ka[xa]:e.a.Tl(Ka[xa],0),ia+=ha[xa];Ka=sa.getValue(z.a.Bz);xa=new I.GraphIterator;xa.Yc(Ma);Ma=0;if(N.TableCellReader.Y_(xa)){if(Ka=O.returnToContainingCell(xa))Ma=Ka.width;ua=R.a(xa);xa=O.returnToContainingTable(xa);if(-1!==ua&&ua<=xa.eG.length){let ya=0;for(let ra=
ua;ra<ua+Ka.colSpan&&ra<xa.eG.length;ra++)ya+=xa.eG[ra];Ma=Math.min(Ma,ya);Ma===ya&&(Ma-=e.a.Tl(Ja.nen,0))}}else if(Ka)for(ua=0;ua<Ka.length;ua++)Ma+=Ka[ua];if(0<Ma&&ia>Ma&&ia)for(ia=Ma/ia,Ma=0;Ma<ha.length;Ma++)ha[Ma]*=ia;sa.setValue(z.a.Bz,ha)}static eEk(Ka,Ma){Ka.currentNode.setValue(y.a.a1,e.a.Tl(Ma,1))}static Tko(Ka){var Ma,sa;n.ULS.sendTraceTag(520890259,3022,50,"Setting selection info and bound");Object(Ia.a)("SettingTableSelectionBounds",!0);var xa=Ka.hb,ia=Ka.sg;Ka=Ja.Wg.IQ(ia,16);if(ia=
Ja.Wg.jT(ia,14))if(ia=ia.node,!ia||14!==ia.type)n.ULS.sendTraceTag(537507990,306,15,"Table node must be present");else if(!Ka)n.ULS.sendTraceTag(537507991,306,15,"Cell context must be present");else{if(!((null===(sa=null===(Ma=null===xa||void 0===xa?void 0:xa.kb)||void 0===Ma?void 0:Ma.Me)||void 0===sa?0:sa.Qa)&&xa.kb.Me.Qa.contextId===Z.a.Z0&&X.TableBorderSelectionCache.gPa()&&0<X.TableBorderSelectionCache.gPa().length)){X.TableBorderSelectionCache.iSc(ia);Ma=X.TableBorderSelectionCache.z9;Ma.leftMostColumnSelected=
Number.MAX_SAFE_INTEGER;Ma.rightMostColumnSelected=Number.MIN_SAFE_INTEGER;Ma.topMostRowSelected=Number.MAX_SAFE_INTEGER;Ma.bottomMostRowSelected=Number.MIN_SAFE_INTEGER;for(sa=0;sa<Ka.length;sa++){if(Ka.getContext(sa).contextId!==Z.a.tableCell)return;xa=Ka.getContext(sa).node;if(!N.TableCellReader.Qr(xa)){var ha=new I.GraphIterator;ha.set(xa);if(ha.zb(14)&&O.getContainingTable(ha)===ia){ha.hd(14);ha=N.TableCellReader.bEa(ha,xa);if(!ha)return;Array.add(X.TableBorderSelectionCache.gPa(),new V.a(xa,
ha.rowIndex,ha.wo,xa.rowSpan,xa.colSpan));Ma.leftMostColumnSelected=Math.min(Ma.leftMostColumnSelected,ha.wo);Ma.rightMostColumnSelected=Math.max(Ma.rightMostColumnSelected,ha.wo);Ma.topMostRowSelected=Math.min(Ma.topMostRowSelected,ha.rowIndex);Ma.bottomMostRowSelected=Math.max(Ma.bottomMostRowSelected,ha.rowIndex)}}}X.TableBorderSelectionCache.z9=Ma}}else n.ULS.sendTraceTag(537145810,306,15,"IP in table should be there")}static Pfj(Ka){var Ma;if(Ka&&14===Ka.type){n.ULS.sendTraceTag(520890258,3022,
50,"Scaling Column Width");Object(Ia.a)("ScalingColumnWidthForCCP",!0);var sa=new I.GraphIterator;sa.set(Ka);if(sa.yd()&&F.TableReader.Yw(sa)){var xa=Ka.eG,ia=F.TableReader.xQd(sa),ha=O.returnToContainingCell(sa),ua=O.getContainingTable(sa);if(ha&&ua){var ya=R.a(sa),ra=N.TableCellReader.AO(ha);if(sa.hd(14)){var La=F.TableReader.tga(sa);sa=0;for(let oa=ya;oa<ya+ra;oa++)sa+=La[oa];ya=ja.a.vM(ha,ua,y.a.qP,y.a.za,0);ha=ja.a.vM(ha,ua,y.a.KR,y.a.Aa,0);sa-=e.a.Tl(ya+ha,0);(null==sa||0>=sa||isNaN(sa))&&n.ULS.sendTraceTag(521187332,
3022,50,"Containing cell width is invalid for cell margins {0} & {1}",ya,ha);ha=0;for(ua=0;ua<xa.length;ua++)ha+=xa[ua];ua=sa/ha;(null==ua||0>=ua||isNaN(ua))&&n.ULS.sendTraceTag(521187331,3022,50,"scale is invalid");ya=0;for(ra=0;ra<xa.length;ra++)La=xa[ra],xa[ra]*=ua,xa[ra]<ia[ra]&&(xa[ra]=ia[ra],1>ua&&(null===(Ma=l.AFrameworkApplication.K)||void 0===Ma?0:Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1))&&(ua=(sa-ia[ra])/(ha-La))),ya+=xa[ra];ya>sa&&(xa=
Array.clone(ia));Ma=ja.a.hda+(Ja.eD?Ja.eD.Mva(Ka):0);for(ia=0;ia<xa.length;ia++)if(null==xa[ia]||0>=xa[ia]||isNaN(xa[ia]))n.ULS.sendTraceTag(521187330,3022,50,"Column width is invalid for inner table"),xa[ia]=e.a.Tl(Ma,0);Ma=new da.GraphTransaction(4);Ma.Cb(Ka);Ka.eG=xa;Ma.dispose()}}}else n.ULS.sendTraceTag(512291460,3022,50,"Table is not a nested table.")}else n.ULS.sendTraceTag(524932511,3022,15,"Table node should not be null")}static N1n(Ka){if(!Ka||!F.TableReader.wGf(Ka)||1!=Ka.xq())return n.ULS.sendTraceTag(525361986,
3022,50,"Outline iterator should contain a single table"),null;n.ULS.sendTraceTag(525361987,3022,50,"Pasting table over cell selection");Object(Ia.a)("ReplaceTableContentForExternalPaste",!0);let Ma=new I.GraphIterator;Ma.set(Ka.currentNode);Ma.zb(14);aa.OutlineElementNavigator.Ge(Ma);const sa=new I.GraphIterator;sa.set(Ka.currentNode);sa.zb(14);if(!sa.hd(14)||!Ma||14!=Ma.currentNode.type)return null;if(Ka=O.getContainingTableCell(Ma))if(Ka=N.TableCellReader.bEa(sa,Ka)){if(X.TableBorderSelectionCache.NPc())var xa=
this.bam();else{xa=F.TableReader.eg(Ma.currentNode)-(F.TableReader.eg(sa.currentNode)-Ka.rowIndex);var ia=F.TableReader.Yg(Ma.currentNode)-(F.TableReader.Yg(sa.currentNode)-Ka.wo);this.Atk(sa,xa,ia);xa=new pa.a(Ka.wo,F.TableReader.Yg(sa.currentNode)-1,Ka.rowIndex,F.TableReader.eg(sa.currentNode)-1)}if(!xa)return null;ia=xa.bottomMostRowSelected-xa.topMostRowSelected+1;var ha=xa.rightMostColumnSelected-xa.leftMostColumnSelected+1;ia=Math.min(ia,F.TableReader.eg(Ma.currentNode));ha=Math.min(ha,F.TableReader.Yg(Ma.currentNode));
for(let ua=0;ua<ia;ua++){O.moveToCell(sa,ua+xa.topMostRowSelected,xa.leftMostColumnSelected);O.moveToCell(Ma,ua,0);for(let ya=0;ya<ha;ya++)ua==Ka.rowIndex-xa.topMostRowSelected&&ya==Ka.wo-xa.leftMostColumnSelected||this.sOi(Ma,sa),O.moveToNextColumn(sa),O.moveToNextColumn(Ma);sa.At(14);Ma.At(14)}O.moveToCell(sa,Ka.rowIndex,Ka.wo);Ka.rowIndex-xa.topMostRowSelected<F.TableReader.eg(Ma.currentNode)&&Ka.wo-xa.leftMostColumnSelected<F.TableReader.Yg(Ma.currentNode)?O.moveToCell(Ma,Ka.rowIndex-xa.topMostRowSelected,
Ka.wo-xa.leftMostColumnSelected):Ma=null;this.sOi(Ma,sa);sa.At(14);O.moveToCell(sa,xa.topMostRowSelected,xa.leftMostColumnSelected);sa.Qd();return sa.currentNode}}static zzn(Ka){if(Ka&&F.TableReader.wGf(Ka)&&1==Ka.xq()){n.ULS.sendTraceTag(520890257,3022,50,"Pasting table below table");Object(Ia.a)("PasteTableBelowTable",!0);var Ma=new I.GraphIterator;Ma.set(Ka.currentNode);Ka=ea.a.$a(Ka.currentNode);Ma.Dp()&&Ka.Dp()&&(aa.OutlineElementNavigator.p0(Ka,!1,!0),na.OutlineElementReader.Bh(Ka)&&1==Ka.xq()&&
(aa.OutlineElementNavigator.Ge(Ma),aa.OutlineElementNavigator.Ge(Ka),Ma&&Ka&&Ma.currentNode!=Ka.currentNode&&F.TableReader.isTable(Ma)&&F.TableReader.isTable(Ka)&&this.Wan(Ma,Ka)&&(n.ULS.sendTraceTag(525361989,3022,50,"Pasting table below table"),Ma.wg(),Ma.wg())))}else n.ULS.sendTraceTag(525361988,3022,50,"Outline iterator should contain a single table")}static sOi(Ka,Ma){if(Ma&&N.TableCellReader.isTableCell(Ma)){var sa=Ma.xq();if(Ka&&N.TableCellReader.isTableCell(Ka)&&Ka.rA())for(;Ka.rA();)Ka.Qd(),
Ma.Hf(Ka.currentNode,Ka.role),Ka.wg();else sa--;for(;0<sa--;)Ma.Qd(),Ma.wg()}}static Wan(Ka,Ma){if(!F.TableReader.isTable(Ka)||!F.TableReader.isTable(Ma))return!1;var sa=F.TableReader.Yg(Ka.currentNode),xa=F.TableReader.Yg(Ma.currentNode);if(sa!=xa)return n.ULS.sendTraceTag(525361990,3022,50,"Number of columns in source and target table should be same"),!1;sa=F.TableReader.eg(Ka.currentNode);xa=F.TableReader.eg(Ma.currentNode);const ia=new da.GraphTransaction(4);ia.Cb(Ma.currentNode);Ma.currentNode.setValue(z.a.Oya,
sa+xa);for(ia.dispose();Ka.rA();){Ka.Qd();Ma.Hf(Ka.currentNode,1);sa=new I.GraphIterator;sa.set(Ka.currentNode);Ka.wg();sa.Qd();do sa.currentNode&&16==sa.currentNode.type&&(sa.currentNode.UE=Ma.currentNode);while(sa.qt())}return!0}static Atk(Ka,Ma,sa){n.ULS.sendTraceTag(512291459,307,50,"Adding rows and columns for content replace in CCP.");Object(Ia.a)("AddRowAndColumnForExternalCCP",!0);Ja.wAa=ma.a.K7b;0<Ma&&(O.moveToLastRow(Ka),n.ULS.sendTraceTag(523896290,307,50,"Begin insert rows: "+Ma),this.wk.insertRows(Ka,
!1,Ma,this.wAa),n.ULS.sendTraceTag(523896291,307,50,"Completed inserting rows."),Ka.hd(14));0<sa&&(n.ULS.sendTraceTag(523896320,307,50,"Begin insert columns: "+sa),this.wk.insertColumns(Ka,F.TableReader.Yg(Ka.currentNode),!1,sa,this.wAa),n.ULS.sendTraceTag(523896321,307,50,"Completed inserting columns."))}static bam(){return X.TableBorderSelectionCache?X.TableBorderSelectionCache.z9:null}}Ja.nen=8;Ja.zfn="Normal Table";Ja.lPh="Table Grid";Ja.wAa=null;Ja.Z4j=M.a.v5("MsoNormalTable","Normal Table",
"MsoTableGrid",Ja.lPh,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4",
"MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1",
"Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5",
"Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful",
"MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1",
"MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3",
"List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6",
"List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3",
"List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5",
"MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6",
"MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6");Ja.c5j=M.a.v5("0","center","1","top","2","center","3",
"bottom");Ja.b5j=M.a.v5("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(E.a)(Ja,"Box4TableStewardHelper",null,[])},1561:function(E,M,c){c.d(M,"a",function(){return W});E=c(0);var m=c(74),e=c(177),a=c(22),l=c(171),y=c(2),z=c(238),n=c(6),v=c(84),A=c(60),w=c(9),G=c(43),F=c(589),I=c(224),K=c(234),J=c(8),N=c(246),R=c(18),O=c(12),L=c(280),U=c(3);class W{static get Wg(){return I.ContextSetEditor.instance}static get Vf(){return K.a.instance}static get Ic(){return e.a.instance}static Vw(){return W.Sm||
(W.Sm=a.a.instance.Sa("Box4.IExternalSelectionManager"))}static get HA(){return null!=W.eFg?W.eFg:W.eFg=a.a.instance.resolve("Box4.IParagraphIndentationReader")}static zem(){this.QN||(this.QN=new m.a,this.QN.add(U.a.LA),this.QN.add(U.a.font),this.QN.add(U.a.GY),this.QN.add(U.a.Yta),this.QN.add(U.a.bold),this.QN.add(U.a.setItalic),this.QN.add(U.a.superscript),this.QN.add(U.a.subscript),this.QN.add(U.a.DZa),this.QN.add(U.a.Wta),this.QN.add(U.a.HCa),this.QN.add(U.a.f6e),this.QN.add(U.a.ICa),this.QN.add(U.a.CZa),
this.QN.add(U.a.G_),this.QN.add(U.a.U0),this.QN.add(U.a.clearFormatting),this.QN.add(U.a.veb),this.QN.add(U.a.dGc));return this.QN}static N$b(X){return W.zem().contains(X)?!0:!1}static Wv(X,V,Z,da,aa){var ea=!0;if(!V.view.qe)return 2;var na=V.view,pa=na.mb;pa&&pa.hb.kb||(W.Ic.Yb(v.a.kf,{["Reason"]:A.a.noSelection}),ea=!1);W.Wg.aDa(R.ImageReader.jUc,na.mb.sg)&&(W.Ic.Yb(v.a.kf,{["Reason"]:A.a.n9e}),ea=!1);if(W.Wg.aDa(R.ImageReader.u2a,na.mb.sg))return W.Ic.Yb(v.a.kf,{["Reason"]:A.a.bHc}),8;var ja=!W.N$b(X);
W.Vf.S$b(na.mb.sg,ja)&&(W.Ic.Yb(v.a.kf,{["Reason"]:A.a.VE}),ea=!1);W.Wg.aDa(R.ImageReader.rYd,na.mb.sg)&&(W.Ic.Yb(v.a.kf,{["Reason"]:A.a.i9e}),ea=!1);W.Wg.aDa(L.c,na.mb.sg)&&(W.Ic.Yb(v.a.kf,{["Reason"]:A.a.j9e}),ea=!1);W.Wg.aDa(N.a.fDf,na.mb.sg)&&(W.Ic.Yb(v.a.kf,{["Reason"]:A.a.h9e}),ea=!1);W.Wg.pza(J.ParagraphReader.mU,na.mb.sg)&&(W.Ic.Yb(v.a.kf,{["Reason"]:A.a.dO}),ea=!1);W.Vw()&&W.Vw().instance&&W.Vw().instance.qU(na.mb.sg)&&(W.Ic.Yb(v.a.kf,{["Reason"]:A.a.externalSelection}),ea=!1);var ma=null;
pa&&pa.hb.kb&&(ma=pa.hb.kb);if(1===Z||!ea||!ma)return ea?32:8;ea=X===U.a.Ccc||X===U.a.i2b||X===U.a.Bhc||X===U.a.E6b;na=X===U.a.ILb||X===U.a.OBb||X===U.a.Ugc;ja=X===U.a.aTa||X===U.a.bTa||X===U.a.dD;const Ia=new G.GraphTransaction(15);Ia.Cb(ma.Qa.node);ma=new m.a;let Ja=!1;if(ea||na||ja)l.a.mark(7121),V=W.Wg.b2h(V.$j);else{l.a.mark(7119);V=F.OutlineElementGeneralizer.gna(pa.hb,!0);if(!V)return W.Ic.Yb(v.a.Xma,{["Reason"]:A.a.kLd}),Ia.dispose(),8;pa=X===U.a.d2a||X===U.a.Lib;V.Ww&&pa&&(Ja=W.Qom(ma,V))}(X===
U.a.leftJustify||X===U.a.Ccc||X===U.a.centerJustify||X===U.a.i2b||X===U.a.rightJustify||X===U.a.Bhc||X===U.a.fullJustify||X===U.a.E6b)&&V.Ww&&1<V.length&&W.Rom(V)&&(aa||(aa={}),Object.getType(aa)===Object&&(aa.InContextSet=!0));y.AFrameworkApplication.va.Nf(V,X,Z,!0,da,aa);Ja&&W.Gfn(ma,V,aa);Ia.dispose();w.App.ya.updateCommandUI();ea||na||ja?l.a.mark(7122):l.a.mark(7120);return 32}static Qom(X,V){if(!V.Ww)return!1;let Z=!1,da=!1;for(let ea=0;ea<V.length;ea++)if(V.getContext(ea).al){var aa=V.getContext(ea).node;
aa&&(aa=W.HA.Ahb(aa),2===aa.specialIndentType?(Z=!0,X.add(ea)):1!==aa.specialIndentType&&aa.specialIndentType||(da=!0))}return da&&Z}static Gfn(X,V,Z){if(V.Ww)for(let aa=0;aa<X.count;aa++){var da=V.getContext(X.J(aa));if(!da.al)continue;da=da.node;const ea=W.HA.Ahb(da);2!==ea.specialIndentType||z.a.vwa(Z.value,ea.xB)||da.setValue(n.a.$d,ea.xB-ea.bda)}}static Scg(X,V){let Z=!0;V.contextId!==O.a.paragraph?Z=!1:W.Vf.e3a(V)?(W.Ic.Yb(v.a.en,{["Reason"]:A.a.VE}),Z=!1):W.Vw()&&W.Vw().instance&&W.Vw().instance.qU(V)?
(W.Ic.Yb(v.a.en,{["Reason"]:A.a.externalSelection}),Z=!1):V.al&&(V=V.node,J.ParagraphReader.Wb(V)&&V.rQ&&(W.Ic.Yb(v.a.en,{["Reason"]:A.a.dO}),Z=!1));return{returnValue:1!==X&&Z,fy:Z?32:8}}static Rom(X){if(!X.Ww)return!1;let V=1;for(let da=0;da<X.length;da++){var Z=X.getContext(da);if(Z&&Z.al&&Z.contextId===O.a.paragraph&&(Z=Z.node))if(Z=J.ParagraphReader.Cx(Z),!da)V=Z;else if(Z!==V)return!0}return!1}}W.Sm=null;W.QN=null;Object(E.a)(W,"FormattingActionHelper",null,[])},1564:function(E,M,c){c.d(M,"a",
function(){return e});c.d(M,"b",function(){return a});var m=c(2);const e=l=>{switch(l){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=()=>{var l;return null===(l=m.AFrameworkApplication.K)||void 0===l?
void 0:l.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1576:function(E,M,c){c.r(M);E=c(0);var m=c(2),e=c(126),a=c(22),l=c(53),y=c(354),z=c(43),n=c(5);class v{mdf(Bb,cb,Xa){return 1===Xa?32:v.Bil(cb.node)}static Bil(Bb){const cb=new n.GraphIterator;cb.set(Bb);cb.Dp();Bb=new z.GraphTransaction(7);Bb.hu(cb);cb.wg();Bb.dispose();return 32}}Object(E.a)(v,"DeleteOutlineLevelContentStrategy",null,[]);var A=c(145),w=c(147),G=c(79),F=c(224),I=c(17),K=c(23),J=c(8),N=
c(101),R=c(36),O=c(204),L=c(81),U=c(28);class W{constructor(Bb){this.Jm=null;this.yla=Bb}get tzb(){return null!=this.Uvg?this.Uvg:this.Uvg=a.a.instance.Na("Box4.IAutoCorrectRules")}get MW(){return null!=this.Wvg?this.Wvg:this.Wvg=a.a.instance.Na("Box4.IAutoCorrectScheduler")}get MM(){return null!=this.JEg?this.JEg:this.JEg=a.a.instance.Na("Box4.Pages.IPageContentEditor")}get iL(){return null!=this.gEg?this.gEg:this.gEg=a.a.instance.Na("Box4.IOutlineEditor")}get Ug(){return this.Jm||(this.Jm=this.yla())}PEi(Bb,
cb,Xa){if(this.iL&&W.pp){var hb=F.ContextSetEditor.Zqf(cb);Bb=hb.node;I.SelectionEditor.Fk(hb)&&(hb=U.a.Rc(Bb,J.ParagraphReader.textLength(Bb)));var Cb=N.FormattingReader.language(N.FormattingReader.Kr(hb));hb=n.GraphIterator.$a(Xa.ed);W.fh.e5c(hb);var ob=Bb=null;if(hb)for(let ab=hb.Rb(1);ab&&!ob;ab=hb.xi(1))L.OutlineReader.Gwa(ab)&&(ob=ab);if(hb&&!ob){if(!this.MM||!this.iL)return;Bb=new z.GraphTransaction(7);Bb.hu(hb);ob=this.MM.KGd(hb);this.iL.h7(hb,!0);Cb&&(R.OutlineElementNavigator.Ge(hb),hb=
U.a.Rc(hb.currentNode,0),W.pp.vge(N.FormattingReader.Kr(hb),Cb))}Cb=K.SelectionFactory.fo(ob,!0);Xa.mb.setSelection(Cb);I.SelectionEditor.gf(cb)&&(Xa=n.GraphIterator.$a(cb.node),Xa.Dp(),O.OutlineNavigator.X7f(Xa),this.tzb&&this.MW&&L.OutlineReader.wA(Xa,cb,!0)&&(cb=this.tzb.Njf(cb,-1,!1,G.a.ww))&&this.MW.bgj(cb));this.Ug&&this.Ug.kF();Bb&&Bb.dispose()}}static get pp(){return null!=W.Szg?W.Szg:W.Szg=a.a.instance.Na("Box4.IFormattingEditor")}static get instance(){return null!=W.xCg?W.xCg:W.xCg=W.Rl()}static Rl(){return new W(()=>
a.a.instance.Na("Box4.IUndoManager"))}static get fh(){return w.PageNavigator.instance}}Object(E.a)(W,"TitleViewEditor",null,[]);var X=c(46),V=c(465),Z=c(634),da=c(21),aa=c(12),ea=c(280),na=c(3);class pa{constructor(){this.F_j=new v;this.mdf=(Bb,cb,Xa,hb,Cb)=>this.F_j.mdf(Bb,cb,Xa,hb,Cb)}Tb(Bb){const cb=this.fQh.wdf.bind(this.fQh),Xa=this.mdf,hb=this.WPh.Gil.bind(this.WPh);this.R3f(Bb,cb,Xa,hb);Bb.qa(na.a.backspace,aa.a.Tc,hb);Bb.qa(na.a.backspace,aa.a.Hd,hb);Bb.qa(na.a.backspace,aa.a.endOfParagraph,
e.ActionManager.AQ);Bb.qa(na.a.backspace,aa.a.outline,Xa);Bb.qa(na.a.backspace,aa.a.view,cb);Bb.Vc(na.a.backspace,1124);Bb.qa(na.a.Jua,aa.a.Tc,e.ActionManager.AQ);Bb.qa(na.a.Jua,aa.a.Hd,hb);Bb.qa(na.a.Jua,aa.a.endOfParagraph,e.ActionManager.AQ);Bb.qa(na.a.Jua,aa.a.outline,Xa);Bb.qa(na.a.Jua,aa.a.view,cb);Bb.fb(na.a.fHd,aa.a.view,cb,1124);Bb.qa(na.a.zH,aa.a.Tc,hb);Bb.qa(na.a.zH,aa.a.Hd,hb);Bb.qa(na.a.zH,aa.a.endOfParagraph,e.ActionManager.AQ);Bb.qa(na.a.zH,aa.a.outline,Xa);Bb.qa(na.a.zH,aa.a.view,
cb);Bb.Vc(na.a.zH,1124);Bb.fb(na.a.Hbf,aa.a.view,cb,1124);Bb.fb(na.a.Bma,aa.a.view,pa.Bma,1028)}R3f(){}static get fh(){return w.PageNavigator.instance}static get lg(){return null!=pa.jEg?pa.jEg:pa.jEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get MM(){return null!=pa.GEg?pa.GEg:pa.GEg=a.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get iL(){return null!=pa.fEg?pa.fEg:pa.fEg=a.a.instance.resolve("Box4.IOutlineEditor")}static get Xb(){return null!=pa.Zyg?pa.Zyg:pa.Zyg=a.a.instance.Na("Box4.IFeatureHelper")}static Bma(Bb,
cb,Xa,hb,Cb){hb=cb.view;if(!hb.mb||!hb.mb.hb.kb||I.SelectionEditor.km(hb.mb.hb.kb))return 8;if(1===Xa)return 32;Xa=hb.mb.hb;const ob=Xa.kb;var ab=ob.Qa,Ib=null,Yb=!1;if(Xa.nJ){if(ab.contextId===aa.a.outline&&1===Xa.length){for(Bb=n.GraphIterator.$a(ab.node);Bb.Qd();)Bb.wg();pa.iL.h7(Bb,!0);R.OutlineElementNavigator.Ge(Bb);Bb=K.SelectionFactory.te(Bb.currentNode,0);hb.mb.setSelection(Bb);return 32}var ub=ab.node;Ib=null;if(ea.c(ab)){var Ac=ub.De(hb.ic);Ac&&(Ac=Ac.Zip)&&0<=Ac.width&&0<=Ac.height&&(Ib=
new V.a(l.a.Tl(Ac.x,0),l.a.Tl(Ac.y,1)));Ib||(Ib=Z.a(ub))}else Ib=Z.a(ab.node);ab=n.GraphIterator.$a(ab.node);ab.Dp();pa.fh.e5c(ab);ub=pa.MM.KGd(ab);Z.b(ub,Ib.x,Ib.y);pa.iL.h7(ab,!0);Ib=K.SelectionFactory.fo(ub,!0)}else if(1===Xa.length){Yb=Xa.last;ab=X.a.cBb(Yb);if(pa.Xb&&pa.Xb.isFeatureEnabled(24)&&F.ContextSetEditor.instance.Jeg(ab).returnValue)return 2;Yb=Yb.Qc;Yb=!Xa.kw&&(I.SelectionEditor.Fk(Yb)||J.ParagraphReader.lm(Yb)||I.SelectionEditor.w8(Yb))}Yb&&(Yb=I.SelectionEditor.Cj(ob,!1,!1,void 0,
!1),hb.mb.setSelection(Yb),m.AFrameworkApplication.va.Nf(cb,na.a.newLine,2,!1,null,Cb),Ib=hb.mb.hb.kb,hb.mb.setSelection(ob));Cb||(Cb=new y.DictionaryPropertySet);Cb.setValue(A.a.GJc,!0);m.AFrameworkApplication.va.Nf(cb,na.a.zH,2,!0,null,Cb);if(Ib&&Ib.Qa.isValid)return hb.mb.setSelection(Ib),32;Xa.nJ&&W.instance.PEi(Bb,cb.$j,hb);I.SelectionEditor.km(hb.mb.hb.kb)||m.AFrameworkApplication.va.Nf(cb,na.a.newLine,2,!1,null,Cb);return 32}static Ail(Bb,cb){if(1===cb)return 32;cb=new z.GraphTransaction(7);
cb.Cb(Bb);pa.lg.ZGa(Bb);cb.dispose();return 32}}Object(E.a)(pa,"ADeleteActor",null,[]);var ja=c(9),ma=c(234),Ia=c(256),Ja=c(1495),Ka=c(58),Ma=c(19),sa=c(110),xa=c(73),ia=c(116),ha=c(691),ua=c(48);class ya{get Vf(){return ma.a.instance}Gil(Bb,cb,Xa,hb,Cb){hb=null===Cb||void 0===Cb?void 0:Cb.gbd;if(1===Xa)return 32;var ob=Bb===na.a.backspace;if(this.Vf.kh){if(this.Vf.Qwi(cb)&&ya.Bfa&&(Xa=cb.clone(),Xa.Sb+=1,--Xa.Eb,this.Vf.Bbc(Xa)))return ya.Bfa.L8i([Xa]),32;if(this.Vf.lEf(cb,ob))return 2}if(ya.Vw()&&
ya.Vw().instance&&ya.Vw().instance.qU(cb))return 4;var ab=cb.node;let Ib=cb.cpBegin;Xa=cb.cpEnd;let Yb=cb.Eb,ub=cb.Sb;const Ac=J.ParagraphReader.text(ab),Pc=Ac.length;let Mc=!1;if(Ib===Xa){if(ob&&!Ib||!ob&&Ib===Pc)return 2;ob?({cp:Ib,returnValue:Mc}=this.Vf.qOi(ab,Ib),Mc||({cp:Ib,ama:Yb,returnValue:Mc}=this.Vf.pOi(cb,Ib,Yb)),Mc||(Ib--,Ma.a.mz(Ac,Ib)&&Ib--),Bb=na.a.C2e):({cp:Xa,returnValue:Mc}=this.Vf.$cn(ab,Xa),Mc||({cp:Xa,ama:ub,returnValue:Mc}=this.Vf.Zcn(cb,Xa,ub)),Mc||(Xa++,Ma.a.mz(Ac,Xa)&&Xa++),
Bb=na.a.FPh)}cb=Ib===Xa?U.a.Rc(ab,Ib):U.a.createTextRange(ab,Ib,Xa);Mc&&this.Vf.kh&&(ob?cb.Eb=Yb:cb.Sb=ub);if(!this.Vf.Bbc(cb))return 2;this.G_b(ab);ob=new z.GraphTransaction(15);ob.fk=Bb;ob.Cb(ab);ab=Object(sa.a)(ha.a,Cb)&&Cb.w0a;if(!ya.Ld.qg||ab||ua.a.pr&&ya.FCa.c_d(X.a.instance.hb.kb))this.XPh(cb,hb);else{ab=ya.Ld.kZa();try{const Ed=ya.Ch.K8c(cb);let ne;if(({type:ne}=Ed.GSd()).returnValue){const Ie=Object(xa.a)(138,Cb);Ie&&Ie.ia(ia.a.sCf,!1)||!ua.a.pr&&4===ne?ya.Ld.V4a=ne:ya.Ld.Js(ne)}Cb=0;for(let Ie=
Ed.length-1;0<=Ie;--Ie){let cd;const Ic=({F_d:cd}=Ed.getContext(Ie)).returnValue;cd?(ya.hyperlinkEditor.Alb(Ic,null),Cb+=ya.lj.vob(Ic,2),ya.lj.jGd=Xa+Cb):this.XPh(Ic,hb)}}finally{ab&&ab.dispose()}}ob.dispose();return 32}G_b(){}static get Ld(){return null!=ya.ZHg?ya.ZHg:ya.ZHg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get lj(){return null!=ya.KHg?ya.KHg:ya.KHg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ch(){return null!=
ya.uIg?ya.uIg:ya.uIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get hyperlinkEditor(){return null!=ya.BAg?ya.BAg:ya.BAg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static Vw(){return ya.Sm||(ya.Sm=a.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Bfa(){ya.qtb||(ya.qtb=a.a.instance.Sa("Box4.ContentControl.IContentControlOperator"));return ya.qtb.instance}static get FCa(){return null!=ya.hwg?ya.hwg:ya.hwg=a.a.instance.resolve("Box4.IContentControlViewElementManager")}}
ya.Sm=null;ya.qtb=null;Object(E.a)(ya,"ADeleteParagraphContentStrategy",null,[]);var ra=c(169),La=c(800),oa=c(216),Ca=c(227),Aa=c(78),db=c(74),eb=c(77);class ib extends ya{constructor(){super()}get characterPropertiesEditor(){return null!=this.owg?this.owg:this.owg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Rq(){return null!=this.ewg?this.ewg:this.ewg=a.a.instance.Sa("Box4.ContentControlConfigSettings")}get Ddc(){return null!=this.TDg?this.TDg:this.TDg=a.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get aX(){return null!=
this.Nwg?this.Nwg:this.Nwg=a.a.instance.resolve("Box4.IContentControlChpHelper")}get rOa(){return null!=this.lzg?this.lzg:this.lzg=a.a.instance.resolve("Box4.IFieldEditor")}XPh(Bb,cb){this.Shl(Bb,cb)}izk(Bb,cb,Xa,hb){this.Rq.instance&&this.Rq.instance.kh&&(Bb.cpBegin===cb.cpBegin?Bb.Eb=cb.Eb:Xa&&(Bb.Eb=Xa.Jb&&Xa.Jb.length?0:-1),Bb.Sb=hb)}G_b(Bb){const {DeleteActor:cb}=c(1576);cb.G_b(Bb)}Shl(Bb,cb){var Xa=Bb.node;const hb=Ca.b([new ra.a(Bb.cpBegin,Bb.cpEnd)],this.Kfm(Bb));var Cb=new eb.a,ob=[];ib.JZk(Xa,
hb,Cb,ob);for(const ab of Cb.keys)1<Cb.J(ab)&&La.a.LRi(Ka.a.If(ab));this.BXn(Xa,ob);this.Ddc.fGc(Xa);Xa=Bb.Sb;Cb=!!this.Rq.instance&&this.Rq.instance.kh;for(ob=hb.length-1;0<=ob;ob--)Xa=this.deleteRange(Bb,hb[ob],Xa,Cb,cb)}Kfm(Bb){const cb=[],Xa=Bb.node;var hb=Aa.f(Xa,ab=>ab.$la);for(var Cb of hb)hb=Cb.Ib.cp,cb.push(new ra.a(hb,hb+1));Cb=[];oa.a.Y7?this.rOa&&(Cb=this.rOa.a8h(Xa,Bb)):Cb=J.ParagraphReader.TOa(Xa);for(var ob of Cb)this.PMm(ob,Bb)&&cb.push(ob);ob=!!this.Rq.instance&&this.Rq.instance.joa;
this.Rq.instance&&this.Rq.instance.kh||!ob||!Xa.Qs||(ib.UHh&&ib.UHh.AWn(Bb),this.aX&&cb.push(...this.aX.vof(Xa).toArray()));return Ca.a(cb)}PMm(Bb,cb){return oa.a.Y7?this.rOa?!this.rOa.jvi(Bb,cb):!1:!Bb.IK||!ib.$Cf(Bb,cb)}BXn(Bb,cb){const Xa=new db.a;for(const hb of cb)for(cb=0;cb<hb.length;){cb=this.b$h(hb,cb,0);if(-1===cb)break;let Cb=this.b$h(hb,cb+1,3);if(-1===Cb)break;if(hb.J(cb).IK)for(;Cb>=cb;){const ob=hb.J(Cb);Xa.add(ob.re);hb.remove(ob);Cb--}cb=Cb+1}Bb.Npa(Xa)}b$h(Bb,cb,Xa){for(;cb<Bb.length;cb++){const hb=
Bb.J(cb);if(1===hb.pF&&hb.yg===Xa)return cb}return-1}deleteRange(Bb,cb,Xa,hb,Cb){const ob=cb.begin,ab=cb.end;cb=null;hb&&(cb=Bb.node.pa.Oh(ob));ob<ab&&(hb=U.a.createTextRange(Bb.node,ob,ab),this.izk(hb,Bb,cb,Xa),this.characterPropertiesEditor.replaceTextRange(hb,"",void 0,void 0,na.a.EEc,!1,Cb));return Xa=cb&&cb.Jb&&cb.Jb.length?cb.Jb.length:-1}static get UHh(){return null!=ib.Wwg?ib.Wwg:ib.Wwg=a.a.instance.Na("WordEditor.ContentControl.IContentControlOperator")}static $Cf(Bb,cb){return Bb.begin>=
cb.cpBegin&&Bb.end<=cb.cpEnd}static JZk(Bb,cb,Xa,hb){let Cb=0;Bb=Bb.pa;for(const ob of cb)for(;Cb<Bb.length;){cb=Bb.J(Cb);if(cb.cp>=ob.begin&&cb.cp<ob.end&&(cb.$c&&cb.$c.v3k&&hb.push(cb.$c),cb.Eh))for(let ab=0;ab<cb.Eh.length;ab++){const Ib=cb.Eh.J(ab).hn.toString();Xa.nb(Ib)?Xa.Z(Ib,Xa.J(Ib)+1):Xa.Z(Ib,1)}++Cb}}}Object(E.a)(ib,"DeleteParagraphContentStrategy",ya,[]);class lb{static get PJ(){return Ia.a.instance}static bjl(Bb,cb,Xa){if(1===Xa)return 32;Bb=cb.node;return lb.PJ.qCd(Bb)?pa.Ail(Bb,Xa):
32}}Object(E.a)(lb,"DeleteUnsupportedObjectStrategy",null,[]);var Ya=c(171),Fa=c(308),$a=c(177),Db=c(372),gc=c(7),Eb=c(1027),kb=c(40),bb=c(114),Gb=c(1601),Sa=c(400),Pa=c(524),Ab=c(589),nb=c(838),Rb=c(165),Mb=c(138),oc=c(202),xb=c(502),cc=c(32),Ob=c(124);class Ub{constructor(Bb,cb,Xa,hb,Cb){this.V_o=Bb;this.x9=Xa;this.vd=hb;this.actionId=cb;this.gbd=Cb}}Object(E.a)(Ub,"DeleteActionData",null,[]);var pb=c(1007),Zb=c(140),Wa=c(858);class Lb{constructor(Bb,cb,Xa,hb,Cb,ob,ab,Ib,Yb,ub){this.YPh=Bb;this.Vf=
cb;this.PJ=Xa;this.hyperlinkEditor=hb;this.L_=Cb;this.Gk=ob;this.SZi=ab;this.characterPropertiesEditor=Ib;this.Ld=Yb;this.FCa=ub}IJo(Bb){return!I.SelectionEditor.ml(Bb)&&!I.SelectionEditor.Mba(Bb)}tam(Bb,cb,Xa){var hb;let Cb,ob,ab;if(!cb&&Bb&&Bb.hy&&(hb=Bb.Qa)&&I.SelectionEditor.gf(hb)&&this.Gk.Wb(hb.node)&&(Cb=hb.node.pa.Oh(hb.cpBegin))&&Cb.Om&&(ob=this.tOl(Cb))&&ob.hyperlink.BG&&(ab=this.ham(Bb,ob.cp)))return ab;if(!Bb)return null;if(ua.a.Pj&&(hb=this.vNo(Bb,cb)))return hb;if(!Xa)return Bb;cb=I.SelectionEditor.UDa(Bb,
!cb,{JA:!1,us:!0,BC:!0,jE:!0});return K.SelectionFactory.jA(Bb,cb.Qa,!1)}tOl(Bb){const cb=Bb.paragraph.pa;let Xa=null;Bb=Bb.cp;for(let hb=0;hb<cb.length;hb++){const Cb=cb.J(hb);if(Cb.cp>=Bb)break;Cb.Om&&(Xa=null);Cb.hyperlink&&(Xa=Cb)}return Xa}kam(Bb,cb){var Xa=Bb.Qa.node;if(cb){if(cb=I.SelectionEditor.mTa(Bb.Qa.node,Bb.Qa.cpBegin,!0),Bb=K.SelectionFactory.jA(Bb,U.a.Rc(Bb.Qa.node,cb),!1),Xa=Xa.pa.Oh(cb),Xa.Z3||Xa.WX)Bb.Qa.Eb=0}else if(cb=I.SelectionEditor.mTa(Bb.Qa.node,Bb.Qa.cpBegin,!1),Bb=K.SelectionFactory.jA(Bb,
U.a.Rc(Bb.Qa.node,cb),!1),Xa=Xa.pa.Oh(cb),Xa.Z3||Xa.WX)Bb.Qa.Eb=Xa.vw+Xa.bN;Bb.pac=!0;return Bb}vNo(Bb,cb){var Xa=Bb.Qa;let hb=null;if(!Bb.hy||!Xa||!I.SelectionEditor.gf(Xa))return null;if(this.Gk.Wb(Xa.node)&&(hb=cb?Xa.node.pa.Oh(Xa.cpBegin):Xa.node.pa.thb(Xa.cpBegin-1))&&hb.bR)return this.kam(Bb,cb);Xa=n.GraphIterator.$a(Bb.Qa.node);if(!Xa.zb(8))return null;R.OutlineElementNavigator.Vd(Xa);let Cb=!1;const ob=[];if(cb?hb&&hb.Sh:0===Bb.Qa.cpBegin){do(Bb=cb?R.OutlineElementNavigator.Ur(Xa,!0,!0,!1):
R.OutlineElementNavigator.p0(Xa,!0,!0,!1))&&(null===Bb||void 0===Bb?0:Bb.EPa)?(ob.push(U.a.create(R.OutlineElementNavigator.Ge(Xa))),R.OutlineElementNavigator.Vd(Xa)):Cb=!0;while(!Cb);if(0<ob.length)return cb=new Rb.Selection(cb?ob:ob.reverse(),cb),cb.pac=!0,cb}return null}ham(Bb,cb){var Xa=I.SelectionEditor.VDa(Bb,{JA:!1,us:!1,BC:!0,jE:!0});if(!Xa||!Xa.hy||Xa.Qa.node!==Bb.Qa.node)return null;Xa=Xa.Qa;if(Xa.cpBegin!==Xa.cpEnd)return null;const hb=this.Gk.text(Xa.node);for(let Cb=Xa.cpBegin-1;Cb>=
cb;Cb--)if(!Ma.a.Ev(hb.charCodeAt(Cb)))return K.SelectionFactory.jA(Bb,U.a.Rc(Xa.node,Cb+1),!1);return K.SelectionFactory.jA(Bb,U.a.Rc(Xa.node,cb),!1)}wdf(Bb,cb,Xa,hb,Cb){var ob,ab;if(1===Xa)return 32;(Xa=null===(ab=null===(ob=cb.view)||void 0===ob?void 0:ob.mb)||void 0===ab?void 0:ab.sg)&&F.ContextSetEditor.instance.AOh(Xa).filter(J.ParagraphReader.mU).forEach(Ib=>{var Yb;return null===(Yb=J.ParagraphReader.VOa(Ib.node))||void 0===Yb?void 0:Yb.hhe("delete_selection")});ab=!1;Bb===na.a.Hbf?(Bb=na.a.zH,
ab=!0):Bb===na.a.fHd?(Bb=na.a.backspace,ab=!0):Bb===na.a.Jua&&(cb=new Pa.a(ja.App.ya.gb.wc));if(!cb.view.qe)return 2;Mb.GrippersManager.instance.VB(!1);ob=Bb===na.a.zH;Xa=oc.a.v8h(cb);if(ab&&this.Vf.kh&&Xa&&I.SelectionEditor.km(Xa)&&this.Vf.lEf(Xa.Qa,!ob,!0))return 2;ab=this.tam(Xa,ob,ab);return this.djl(Bb,cb,hb,Cb,ab,ob)}djl(Bb,cb,Xa,hb,Cb,ob){var ab;const Ib=cb.view,Yb=Ib.mb;var ub=hb,Ac=hb;Bb===na.a.Jua&&(Ac=ub=null,Cb=new Rb.Selection(hb,!0));if(!Cb)return 32;const Pc=this.$oo(ub,ob);if(this.Vf.kh&&
Lb.Bfa&&1===Yb.hb.length&&I.SelectionEditor.km(Cb)&&Cb.hy&&Lb.Bfa.O$n(Cb.Qa,ob))return 32;let Mc;ob?Ya.a.mark(Mc=5009):Ya.a.mark(Mc=5011);ub=new z.GraphTransaction(15);ub.fk=Bb;ub.Cb(Ib.ed);let Ed=null,ne=({u9n:Ed}=this.rQl(Bb,hb,Yb,Cb,Ed)).returnValue;var Ie=null;({Lie:Ie}=F.ContextSetEditor.instance.Jeg(ne)).returnValue&&(ne=Ie);if(!ne)return ub.dispose(),32;Ie=!1;m.AFrameworkApplication.ue("b1jb9393;09icj321");if(null===(ab=m.AFrameworkApplication.K)||void 0===ab?0:ab.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",
!1))ab=ne.node,Ie=null===ab||void 0===ab?void 0:ab.Qs;const cd=new Ub(cb,Bb,Xa,Ac,Ie);this.Vf.kh&&Lb.Bfa&&(Ac=F.ContextSetEditor.instance.$N(ne),Lb.Bfa.L8i(Ac));this.Mzj(ne);const Ic=this.yNd(ne,Cb,ob);let Rc=null;ob?Rc=new nb.a(Cb):Ic&&(Rc=new nb.a(Ic));let xc=!1;Ac=Lb.Jk;if(I.SelectionEditor.gf(ne)){const Ae=pb.a.P7b(Ib.ed,Pc);Ac.ie(()=>{this.Nhl(cb,Xa,hb,ne,ob,Rc,Cb,Ae,Yb,Pc,cd,Ic)},"DVS:DAIPC")}else!this.Ld.qg||ua.a.pr&&this.FCa.c_d(Cb)?Ac.ie(()=>{xc=this.f0i(Bb,Ib.ed,ne,Yb,Pc,cd,Rc,Ed)},"DVS:PUD"):
(Ac.ie(()=>{this.HJo(Bb,Ib.ed,ne,ob,Cb,Yb,Pc,cd,Rc)},"DVS:TCDC"),xc=!0);this.kDl(Yb);this.Kcj(ne);ub.dispose();Ya.a.mark(Mc+1);return Bb===na.a.Jua?xc?32:8:32}f0i(Bb,cb,Xa,hb,Cb,ob,ab,Ib){cb=pb.a.P7b(cb,Cb);this.IJo(Xa)&&cb.t7a(Xa);Bb=Lb.Ic.zp(Bb);Bb.properties.Z("CountOfParagraphsDeleted",this.Gk.s$e(Xa).toString());Xa=this.knl(Xa,hb,Cb,cb,ob,ab,Ib);Bb.end();return Xa}HJo(Bb,cb,Xa,hb,Cb,ob,ab,Ib,Yb){var ub=0,Ac=null;const Pc=F.ContextSetEditor.instance.$N(Xa),Mc=Pc[Pc.length-1];if(Mc.contextId===
aa.a.paragraph||Mc.contextId===aa.a.endOfParagraph){var Ed=n.GraphIterator.$a(Mc.node);Ed.yd();R.OutlineElementNavigator.Vd(Ed);R.OutlineElementNavigator.Ur(Ed,!0,!1)&&(Ac=R.OutlineElementNavigator.Ge(Ed))&&(ub=this.Gk.textLength(Ac))}else ub=this.Gk.textLength(Mc.node)-Mc.cpEnd;Ed=Object(xa.a)(138,Ib.vd);if(Ed=!!Ed&&Ed.ia(ia.a.sCf,!1))this.d0i(Bb,cb,Xa,ob,ab,Ib,Yb,!1,Ed);else{Ed=this.Ld.kZa();try{this.d0i(Bb,cb,Xa,ob,ab,Ib,Yb,!0)}finally{Ed&&Ed.dispose()}}if(ua.a.Pj&&Cb.pac)ub=this.yNd(Xa,Cb,hb),
this.Gk.Wb(ub.Qa.node)&&X.a.instance.setSelection(ub);else{if(hb){if(Xa.Ww){Bb=Pc.length-1;do Cb=Pc[Bb],Bb--;while(!Cb.node.isConnected&&0<=Bb)}else Cb=Xa;if(!this.Gk.Wb(Cb.node))return;switch(Mc.contextId){case aa.a.paragraph:case aa.a.endOfParagraph:ub=Ac&&Ac.isConnected?0:ub;break;case aa.a.Tc:case aa.a.Hd:break;default:ub=0}ub=K.SelectionFactory.te(Cb.node,this.Gk.textLength(Cb.node)-ub);Cb.Aj===ub.Qa.cpBegin&&(ub.Qa.Eb=Cb.Eb)}else{ub=Cb.Qa.node;if(!this.Gk.Wb(ub))return;Ac=Cb.Qa.contextId===
aa.a.paragraph?0:Cb.Qa.contextId===aa.a.endOfParagraph?this.Gk.textLength(ub):Cb.Qa.cpBegin;ub=K.SelectionFactory.te(ub,Ac)}X.a.instance.setSelection(ub)}}d0i(Bb,cb,Xa,hb,Cb,ob,ab,Ib,Yb=!1){Xa=this.EHl(hb,Xa);Xa=Lb.Ch.K8c(Xa);({type:Ac}=Xa.GSd()).returnValue&&(Ib&&4!==Ac?this.Ld.Js(Ac):ua.a.pr||(this.Ld.V4a=Ac));for(Ib=Xa.length-1;0<=Ib;--Ib){var ub=void 0;var Ac=({F_d:ub}=Xa.getContext(Ib)).returnValue;ub?(ub=Yb&&Ac.contextId===aa.a.endOfParagraph&&Ib===Xa.length-1,this.hyperlinkEditor.Alb(Ac,2),
ub||Lb.lj.vob(Ac,2)):this.f0i(Bb,cb,Ac,hb,Cb,ob,ab,null)}}EHl(Bb,cb){if(Object(sa.a)(Sa.a,cb)){Bb=Ab.OutlineElementGeneralizer.gna(Bb.hb,!0);for(let Xa=0;Xa<Bb.length;Xa++)if(Bb.getContext(Xa).contextId===aa.a.table)return Bb}return cb}rQl(Bb,cb,Xa,hb,Cb){Bb===na.a.Jua?(Bb=Fa.a.iDa(cb),Cb=xb.SelectionReferenceFactory.instance.hBb()):(Cb=null,Bb=1===Xa.hb.length?X.a.cBb(hb):Xa.sg);return{returnValue:Bb,u9n:Cb}}iRk(Bb){return!Bb.al||Bb.contextId!==aa.a.paragraph||!this.Gk.Wb(Bb.node)||this.Ld.qg||this.Vf.DZd(Bb)?
!1:!0}Mzj(Bb){if(Bb.Ww)for(let cb=0;cb<Bb.length;cb++)this.Mzj(Bb.getContext(cb));else this.iRk(Bb)&&(Bb.node.rCd=!0)}Kcj(Bb){if(Bb.Ww)for(let cb=0;cb<Bb.length;cb++)this.Kcj(Bb.getContext(cb));else Bb.al&&(Bb=Bb.node)&&this.Gk.Wb(Bb)&&(Bb.rCd=!1)}yNd(Bb,cb,Xa){if(Bb.al&&I.SelectionEditor.gf(Bb)&&!Xa){const hb=Bb.node;let Cb=Bb.cpBegin,ob=-1;if(({cp:Cb}=this.Vf.qOi(hb,Cb)).returnValue)return K.SelectionFactory.te(hb,Cb);if(({cp:Cb,ama:ob}=this.Vf.pOi(Bb,Cb,ob)).returnValue)return cb=K.SelectionFactory.te(hb,
Cb),cb.Qa.Eb=ob,cb.Qa.Sb=ob,cb}cb=ua.a.Pj?I.SelectionEditor.UDa(cb,!Xa,{JA:!cb.pac||cb.hy,us:!1,BC:!1,jE:!0,Xta:I.SelectionEditor.km(cb)}):I.SelectionEditor.UDa(cb,!Xa,{JA:!0,us:!1,BC:!1,jE:!0});this.Vf.kh&&I.SelectionEditor.ml(Bb)&&(cb.Qa.Sb=cb.Qa.Eb=Xa?Bb.Sb:Bb.Eb);return cb}Nhl(Bb,cb,Xa,hb,Cb,ob,ab,Ib,Yb,ub,Ac,Pc){const Mc=Lb.Jk;!I.SelectionEditor.wA(hb.node,hb,Cb)||this.Vf.kh&&this.Vf.Qwi(hb)?Mc.ie(()=>{this.sil(hb,Cb,ob,ab,Ib,Yb,ub,Ac)},"DVS:IPM"):Mc.ie(()=>{const {response:Ed,IY:ne}=this.ril(Bb,
cb,Xa,hb,Cb,ab,Ib,Yb,Ac,Pc);Lb.oQi(Ib,32===Ed);ne&&Lb.Qpa(Yb,ob)},"DVS:ISE")}Slm(Bb,cb){Zb.a.bY&&(cb.vd||(cb.vd=new y.DictionaryPropertySet),cb.vd.setValue(ia.a.Ooa,"delete"),cb.vd.setValue(ia.a.vha,"backspace"));var Xa=Bb.CK;const hb=Lb.Gd.wX(Xa),Cb=Gb.a.VVm;if(null===Cb||void 0===Cb?0:Cb.ZOm(Xa,hb)){Zb.a.bY&&cb.vd.setValue(ia.a.vha,"backspace-autocorrect");Xa=Cb.xAj+" ";const ob=U.a.Rc(Bb,0);this.characterPropertiesEditor.replaceTextRange(ob,Xa);Bb=K.SelectionFactory.te(Bb,Xa.length);X.a.instance.setSelection(Bb);
gc.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",Cb.xAj)}return m.AFrameworkApplication.va.Nf(cb.V_o,hb.nz?na.a.rL:na.a.iD,2,!1,cb.x9,cb.vd)}qlm(Bb,cb,Xa,hb,Cb){let ob=!1;0<this.SZi.O3(Bb).Ft&&(Cb=m.AFrameworkApplication.va.Nf(cb,na.a.Ugc,2,!1,Xa,hb),ob=!0);return{fU:ob,response:Cb}}xlm(Bb,cb,Xa,hb,Cb){let ob=!1;0<this.SZi.vG(Bb).Ft&&(Cb=m.AFrameworkApplication.va.Nf(cb,na.a.S3c,2,!1,Xa,hb),ob=!0);return{fU:ob,response:Cb}}Amm(Bb,cb,Xa,hb,Cb){let ob=!1;Lb.fq.bAb(Bb)&&
(Cb=m.AFrameworkApplication.va.Nf(cb,na.a.IG,2,!1,Xa,hb),ob=!0);return{fU:ob,response:Cb}}akm(Bb,cb,Xa,hb,Cb,ob,ab,Ib,Yb,ub){const Ac=new bb.a;Ac.Yc(cb);let Pc=!1;if(R.OutlineElementNavigator.cGa(Ac,!1,!Bb,!1)){ub=!0;Yb=32;Pc=!0;(new n.GraphIterator).Yc(Ac);R.OutlineElementNavigator.Ge(Ac);const Ed=Ac.currentNode;J.ParagraphReader.lua(Ed)&&J.ParagraphReader.VOa(Ed).hhe("delete_ip");var Mc=new n.GraphIterator;Mc.set(ab);(Mc=this.Gk.isEmpty(Mc))&&Cb&&I.SelectionEditor.w8(Cb.Qa)?(Xa.t7a(ob),R.OutlineElementNavigator.Ge(cb),
Lb.lg.ZGa(cb.currentNode)):Ed.mJ?(Xa.t7a(ob),R.OutlineElementNavigator.Vd(Ac),Ac.wg()):Bb&&Mc?this.Vf.gzi(ab)&&!({IY:ub}=this.U2i(Bb,ab,Ed,Cb,ub)).returnValue&&(Xa.t7a(ob),Lb.Un.Hca(cb),this.YPh.XDn(ab),cb.wg()):cc.TableReader.isTable(Ac)?(Xa.t7a(ob),Bb&&(da.moveToFirstRow(Ac),da.moveToFirstColumn(Ac),O.OutlineNavigator.T8(Ac),R.OutlineElementNavigator.Ge(Ac),Ib.setSelection((new nb.a(K.SelectionFactory.te(Ac.currentNode,0))).restore())),Yb=2,ub=!1):this.Gk.Wb(Ed)&&(1==this.Gk.textLength(Ed)&&(Ib=
Aa.e(Ed),1==Ib.length&&8==Ib[0].Dh&&(Ib=U.a.createTextRange(Ed,0,1),this.characterPropertiesEditor.replaceTextRange(Ib,"",void 0,void 0,na.a.EEc))),({IY:ub}=this.U2i(Bb,ab,Ed,Cb,ub)).returnValue||(hb.actionId==na.a.backspace&&Xa.Clc(ab),this.YPh.Ohl(Bb,Xa,ob,cb,ab,Ac)))}return{fU:Pc,response:Yb,IY:ub}}U2i(Bb,cb,Xa,hb,Cb){if(this.Ld.qg){if(Lb.nua){const ob=Object(sa.a)(Ob.AParagraphNode,Xa)?Lb.nua.SUc(Xa):!1,ab=Object(sa.a)(Ob.AParagraphNode,cb)?Lb.nua.SUc(cb):!1;if(ob!==ab)return{returnValue:!1,IY:Cb};
if(!ua.a.pr&&ab)return this.Vf.kh&&Lb.xFk(cb,Xa,Bb)&&this.Ld.Js(4),{returnValue:!1,IY:Cb}}Bb=Bb?cb:Xa;if(!Object(sa.a)(Ob.AParagraphNode,Bb))return{returnValue:!1,IY:Cb};cb=Bb.pa.last;Xa=m.AFrameworkApplication.userName;if(!cb.Zi||cb.Zi.authorName!==Xa)return Lb.lj.lOb(Bb,2),hb&&(X.a.instance.setSelection(hb),Cb=!1),{returnValue:!0,IY:Cb}}return{returnValue:!1,IY:Cb}}Llm(Bb,cb,Xa,hb,Cb,ob,ab,Ib){kb.OutlineElementReader.NIm(cb,Bb)||({response:ab,IY:Ib}=Lb.bol(Xa,hb,Bb,ob,Cb,ab,Ib));return{fU:!1,response:ab,
IY:Ib}}ril(Bb,cb,Xa,hb,Cb,ob,ab,Ib,Yb,ub){let Ac=!1,Pc=2;const Mc=hb.node;let Ed=void 0,ne=!1;const Ie=Lb.Jk;if(!Cb){if(Mc.CK)return Ie.ie(()=>{Pc=this.Slm(Mc,Yb)},"DVS:HLOE"),{response:Pc,IY:Ac};Ie.ie(()=>{({response:Pc,fU:ne}=this.qlm(Mc,Bb,cb,Xa,Pc))},"DVS:HIOD");if(ne)return{response:Pc,IY:Ac};Ie.ie(()=>{({response:Pc,fU:ne}=this.xlm(Mc,Bb,cb,Xa,Pc))},"DVS:HWPF");if(ne)return{response:Pc,IY:Ac};Ed=this.J$h(Mc);Ie.ie(()=>{({response:Pc,fU:ne}=this.Amm(Ed,Bb,cb,Xa,Pc))},"DVS:HPOB");if(ne)return{response:Pc,
IY:Ac}}null!==Ed&&void 0!==Ed?Ed:Ed=this.J$h(Mc);Ie.ie(()=>{({response:Pc,fU:ne,IY:Ac}=this.akm(Cb,Ed,ab,Yb,ub,hb,Mc,Ib,Pc,Ac))},"DVS:HAOE");if(ne)return{response:Pc,IY:Ac};Ie.ie(()=>{({response:Pc,fU:ne,IY:Ac}=this.Llm(Cb,Ed,cb,Xa,ab,ob,Pc,Ac))},"DVS:HFLOE");return{response:Pc,IY:Ac}}jpo(Bb){return I.SelectionEditor.ml(Bb)||this.PJ.tCi(Bb)||I.SelectionEditor.Mba(Bb)}$oo(Bb,cb){return Bb&&Bb.hasProperty(A.a.GJc)?!Bb.ia(A.a.GJc,!1):!cb}static get Gd(){return null!=Lb.BDg?Lb.BDg:Lb.BDg=a.a.instance.resolve("Box4.List.IListReader")}static get Un(){return null!=
Lb.sDg?Lb.sDg:Lb.sDg=a.a.instance.resolve("Box4.List.IListEditor")}static get lg(){return null!=Lb.rEg?Lb.rEg:Lb.rEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get fq(){return Eb.a.BEb}static get lj(){return null!=Lb.OHg?Lb.OHg:Lb.OHg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ch(){return null!=Lb.xIg?Lb.xIg:Lb.xIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Ic(){return $a.a.instance}static get Bfa(){Lb.qtb||
(Lb.qtb=a.a.instance.Sa("Box4.ContentControl.IContentControlOperator"));return Lb.qtb.instance}static get nua(){return null!=Lb.$wg?Lb.$wg:Lb.$wg=a.a.instance.Na("Box4.IContentControlReader")}static get Jk(){return Db.a.instance}kDl(Bb){if(1===Bb.hb.length&&(Bb=Bb.hb.J(0),I.SelectionEditor.km(Bb))){var cb=Bb.Qa;Bb=cb.node;cb=cb.cpBegin;var Xa=this.Gk.text(Bb);cb<Xa.length&&0<cb&&" "===Xa.charAt(cb-1)&&" "===Xa.charAt(cb)&&this.characterPropertiesEditor.replaceTextRange(U.a.createTextRange(Bb,cb-1,
cb),"\u00a0")}}UHk(Bb,cb){if(!cb.hyperlink.Djb){const Xa=new z.GraphTransaction(15);try{Xa.Cb(Bb.node),this.L_.CR(Bb,cb)}finally{Xa&&Xa.dispose()}cb.hyperlink.BG&&this.Ld.Js(2)}}static bol(Bb,cb,Xa,hb,Cb,ob,ab){if(Xa=I.SelectionEditor.UDa(hb,!Xa,{JA:!1,us:!1,BC:!1,jE:!0})){hb=K.SelectionFactory.jA(hb,Xa.Qa);ob=32;for(Xa=0;Xa<hb.length;++Xa){Cb.t7a(hb.J(Xa));const Ib=m.AFrameworkApplication.va.Nf(hb.J(Xa),na.a.zH,2,!0,Bb,cb);2!==Ib&&(ob=Ib)}32===ob&&(ab=!0)}return{response:ob,IY:ab}}knl(Bb,cb,Xa,hb,
Cb,ob,ab){let Ib=!1;this.kpo(Bb)?(Ib=Lb.Vef(Bb,!0,cb,Xa,hb,Cb))&&Lb.IIa(ob,cb,ab):this.jpo(Bb)?(Ib=Lb.Vef(Bb,!1,cb,Xa,hb,Cb))&&Lb.IIa(ob,cb,ab):(hb.normalize(),Lb.IIa(ob,cb,ab));return Ib}static IIa(Bb,cb,Xa){Xa&&Xa.Qpa()||Lb.Qpa(cb,Bb)}static Vef(Bb,cb,Xa,hb,Cb,ob){var ab;hb||L.OutlineReader.kQa(Bb)||(Xa=Lb.fad(Xa))&&Cb.Blo(Xa);m.AFrameworkApplication.ue("b1jb9393;09icj321");if(null===(ab=m.AFrameworkApplication.K)||void 0===ab?0:ab.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",
!1))ob.vd?ob.vd.gbd=ob.gbd:ob.vd={gbd:ob.gbd};ab=Bb instanceof Sa.a?Bb.getContext(0).node:Bb.node;ab=Lb.z4l(ab);Bb=32===m.AFrameworkApplication.va.Nf(Bb,ob.actionId,2,cb,ob.x9,ob.vd);Lb.oQi(Cb,Bb,ab);return Bb}static get pp(){return null!=Lb.Vzg?Lb.Vzg:Lb.Vzg=a.a.instance.resolve("Box4.IFormattingEditor")}static get yTa(){return null!=Lb.DGg?Lb.DGg:Lb.DGg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static z4l(Bb){const cb=new Wa.a;if(Bb){let Xa=null;Bb=K.SelectionFactory.fo(Bb,!0);if(!Bb)gc.ULS.sendTraceTag(509645905,
315,10,"Unexpected null selection.");else for(let hb=0;hb<Bb.length;hb++)if(N.FormattingReader.k9e(Bb.J(hb))){Xa=Bb.J(hb);break}Xa&&((Bb=N.FormattingReader.Kr(Xa))&&Bb.cache&&Bb.cache.BB&&(Bb=Bb.Ef(null),Lb.pp.S4(Bb)),Bb&&(cb.formatting=Bb.Fj,cb.languageId=N.FormattingReader.language(Bb)),cb.Yqa=Lb.yTa.Lo(Xa.node))}return cb}static oQi(Bb,cb,Xa){cb?Bb.normalize(Xa):Bb.cancel()}static Qpa(Bb,cb){cb&&Lb.Jk.ie(()=>{const Xa=cb.restore();Xa&&Bb.setSelection(Xa)},"DVS:RS")}sil(Bb,cb,Xa,hb,Cb,ob,ab,Ib){let Yb;
!cb&&({hyperlink:Yb}=this.L_.Aac(Bb)).returnValue?(Xa=new nb.a(hb),this.UHk(Bb,Yb),Cb.normalize(),Lb.Qpa(ob,Xa)):Lb.Vef(Bb,!1,ob,ab,Cb,Ib)&&(cb&&this.Ld.qg?(cb=Lb.lj.jGd)?(ob.setSelection(K.SelectionFactory.te(Bb.node,cb)),Lb.lj.jGd=null):Lb.Qpa(ob,Xa):Lb.Qpa(ob,Xa))}static xFk(Bb,cb,Xa){Xa?(Xa=Bb,Bb=cb):Xa=cb;cb=Lb.nua.$ac(Xa,!1);Bb=Lb.nua.$ac(Bb,!0);return!(cb&&Bb)}kpo(Bb){return Bb.Ww||L.OutlineReader.kQa(Bb)||this.Gk.lm(Bb)}static fad(Bb){return(Bb=Ab.OutlineElementGeneralizer.gna(Bb.hb,!0))&&
1===Bb.length&&(Bb=Bb.getContext(0).node,cc.TableReader.eY(Bb))?Bb:null}J$h(Bb){const cb=new n.GraphIterator;cb.set(Bb);cb.yd();R.OutlineElementNavigator.Vd(cb);return cb}}Lb.qtb=null;Object(E.a)(Lb,"ADeleteViewStrategy",null,[]);class qc{Ohl(Bb,cb,Xa,hb,Cb,ob){const ab=ob.currentNode;R.OutlineElementNavigator.Vd(ob);Bb?(cb.Clc(ob.currentNode),qc.Vf.$xi(Xa,Cb,ab,!1)||qc.lg.merge(hb,ob,!1,!1)):qc.Vf.$xi(Xa,ab,Cb,!0)||qc.lg.merge(ob,hb,!1,!1)}XDn(Bb){Bb&&J.ParagraphReader.Wb(Bb)&&(Ja.a.M3c(Bb),qc.Hql.H_e(Bb))}static get lg(){return null!=
qc.mEg?qc.mEg:qc.mEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get Hql(){return null!=qc.Mxg?qc.Mxg:qc.Mxg=a.a.instance.resolve("Box4.IDynamicRangeEditor")}static get Vf(){return ma.a.instance}}Object(E.a)(qc,"DeleteParagraphNodeStrategy",null,[595]);class Ra extends Lb{constructor(Bb,cb,Xa,hb,Cb,ob,ab,Ib,Yb){super(new qc,Bb,cb,Xa,hb,Cb,ob,ab,Ib,Yb)}}Object(E.a)(Ra,"DeleteViewStrategy",Lb,[]);c.d(M,"DeleteActor",function(){return yb});class yb extends pa{constructor(Bb,cb,Xa,hb,Cb,
ob,ab,Ib,Yb,ub,Ac,Pc){super();this.deleteParagraph=(Mc,Ed)=>{Mc=Ed.node;Ja.a.M3c(Mc);this.Sye.H_e(Mc);this.nn&&this.nn.instance&&this.nn.instance.bVi(Mc);Mc.Qs&&(this.Zl.zWn(Mc,!this.kh),this.kh&&this.YVg.instance&&this.YVg.instance.bEj(Mc));return 0};this.cId=(Mc,Ed,ne)=>{2==ne&&(Mc=m.AFrameworkApplication.breadcrumbFolderUrl,Mc&&0!=Mc.length||(Mc=m.AFrameworkApplication.breadcrumbBrandUrl),ja.App.Igb(Mc));return 32};this.Mhl=(Mc,Ed,ne)=>{({DeleteActor:Mc}=c(1576));if(1===ne)return 32;ne=ja.App.ya.Fq.Zf("ModelUpdate",
"DeleteAnchoredObject");Ed=Ed.node;const Ie=new n.GraphIterator;Ie.set(Ed);Ie.zb(12);const cd=Ie.Xn(12);if(ma.a.instance.QUc(cd))return 2;Mc.G_b(cd);Mc=new z.GraphTransaction(7);Mc.Cb(Ed);Ie.wg();Mc.dispose();ne.stop();return 32};this.G_j=new ib;this.H_j=new Ra(ma.a.instance,Ia.a.instance,ob,ab,Ib,Yb,ub,Ac,Pc);this.Zl=Bb;this.ktc=cb;this.YVg=Xa;this.Sye=hb;this.nn=Cb}get kh(){return this.ktc.instance?this.ktc.instance.kh:!1}get fQh(){return this.H_j}get WPh(){return this.G_j}R3f(Bb,cb,Xa,hb){const Cb=
lb.bjl,ob=this.Mhl;Bb.qa(na.a.backspace,aa.a.anchoredObject,ob);Bb.qa(na.a.backspace,aa.a.unsupportedObject,Cb);Bb.qa(na.a.zH,aa.a.anchoredObject,ob);Bb.qa(na.a.zH,aa.a.unsupportedObject,Cb);Bb.qa(na.a.backspace,aa.a.paragraph,this.deleteParagraph);Bb.qa(na.a.zH,aa.a.paragraph,this.deleteParagraph);Bb.qa(na.a.Jua,aa.a.paragraph,this.deleteParagraph);Bb.qa(na.a.cId,aa.a.view,this.cId);Bb.Vc(na.a.Jua,64);super.R3f(Bb,cb,Xa,hb)}static G_b(Bb){var cb;(null===(cb=ja.App.rd)||void 0===cb?0:cb.Yo)&&ja.App.rd.kq.rH(Bb)}}
Object(E.a)(yb,"DeleteActor",pa,[])},1577:function(E,M,c){c.r(M);E=c(0);var m=c(7),e=c(1428),a=c(1590),l=c(909),y=c(1526);class z{constructor(sa){this.gak=sa}initialize(){return Promise.resolve(0)}W1d(){return Promise.resolve(0)}PY(){m.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new y.a,{IsSuccess:!0,Token:this.gak}))}tme(){return Promise.resolve(Object.assign(new y.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",
ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}ike(){return!1}nPc(){return"MockAuthTokenStrategy"}}Object(E.a)(z,"MockAuthTokenStrategy",null,[324]);var n=c(1639);class v{static get(sa,xa,ia){if(!ia)return sa;let ha=0;return Promise.race([sa,new Promise(ua=>{ha=window.setTimeout(()=>{ua(xa)},ia)})]).then(ua=>{window.clearTimeout(ha);return Promise.resolve(ua)}).catch(()=>{window.clearTimeout(ha);return Promise.resolve(xa)})}}Object(E.a)(v,"PromiseWithTimeout",
null,[]);var A=c(2),w=c(742);class G{constructor(sa,xa,ia,ha,ua){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=sa;this.scope=xa;this.silentLogin=ia;this.options=ha;this.correlationId=ua}}Object(E.a)(G,"TokenRequestParameters",null,[331]);var F=c(20),I=c(22);class K{constructor(){this.clh=null;let sa=A.AFrameworkApplication.K.jb(A.AFrameworkApplication.qja),xa=A.AFrameworkApplication.K.jb(A.AFrameworkApplication.Gme);this.sZb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",
sa&&""!==sa?sa:"Unspecified",xa&&""!==xa?xa:"Unspecified")}initialize(){return new Promise(sa=>{I.a.instance.Sa("Common.App.WopiIdentity.IWopiIdentity").execute(xa=>{this.clh=xa;sa(0)})})}ge(sa){const xa=["HTTPS:","API:"];let ia=!1;const ha=sa.toLocaleUpperCase();for(const ua of xa)if(ha.startsWith(ua)){ia=!0;break}return ia||this.IJm(sa)?sa+"/.default":sa}IJm(sa){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(sa)}W1d(){return Promise.resolve(0)}PY(sa,
xa,ia,ha,ua,ya,ra){if(F.a.uQa){ua=w.OAuthManagerSettings.v0o;if(!ua)return xa=Object.assign(new y.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(xa);if(!Array.contains(ua,sa))return xa=Object.assign(new y.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+sa}),Promise.resolve(xa)}sa=this.ge(ia);ia=new G(ia,sa,!ha,null,A.AFrameworkApplication.userSessionId);return this.clh.getAccessToken(ia,xa,ra).then(La=>Object.assign(new y.a,
{IsSuccess:!0,Token:La.accessToken}),La=>Object.assign(new y.a,{IsSuccess:!1,ErrorCode:La}))}tme(){return Promise.resolve(Object.assign(new y.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}ike(){return!1}nPc(){return this.sZb}}Object(E.a)(K,"ParentFrameTokenStrategy",null,[324]);var J=c(55),N=c(745),R=c(74);class O{constructor(){this.reject=this.resolve=null;this.startTime=0;this.A3i=
this.Pvh=null}}Object(E.a)(O,"PromiseWrapper",null,[]);class L{constructor(sa=0){this.Ux=0;this.Dyc=!1;this.Zx=new R.a;this._timeout=sa}enqueue(sa){return new Promise((xa,ia)=>{this.Zx.add(Object.assign(new O,{A3i:sa,resolve:xa,reject:ia}));this.process()})}process(){if(this.Dyc||this.Ux===this.Zx.count)return!1;const sa=this.Zx.J(this.Ux++);try{this.Dyc=!0,sa.A3i().then(xa=>{this.Dyc=!1;this.F8e(sa,xa,null,!0)}).catch(xa=>{this.Dyc=!1;this.F8e(sa,null,xa,!1)})}catch(xa){this.Dyc=!1,this.F8e(sa,null,
xa,!1)}return!0}F8e(sa,xa,ia,ha){if(ha){const ua=()=>{sa.resolve(xa);this.process()};0<this._timeout?window.setTimeout(()=>{ua()},this._timeout):ua()}else{const ua=()=>{sa.reject(ia);this.process()};0<this._timeout?window.setTimeout(()=>{ua()},this._timeout):ua()}}}Object(E.a)(L,"PromiseQueue",null,[]);class U{constructor(){this.correlationId=this.resolve=null}}Object(E.a)(U,"ResolveWithCorrelation",null,[]);var W=c(73),X=c(174),V=c(941),Z=c(85);class da extends X.a{constructor(sa,xa,ia,ha,ua,ya){super(!1,
!1,!0);this.JRg=this.aAa=null;this.Vsa=sa;this.Hek=ia;this.Kq=ha;this.cmk=ua;this.fub=ya;this.kH=document.createElement("iframe");this.kH.id="SharedAuthInteractiveFrame";this.kH.setAttribute("name","SharedAuthInteractiveFrame");this.kH.setAttribute("title","SharedAuthInteractiveFrame");this.kH.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.kH.style.border="0";this.kH.style.height="48px";this.kH.style.width="190px";$addHandler(this.kH,"error",Object(J.a)(this,
this.dsn,"onSharedAuthFrameError"));sa=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.Vsa,xa,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",A.AFrameworkApplication.userType);this.kH.src=sa;this.Q_j=new Promise(ra=>{this.JRg=ra});this.KRg=!1}iTa(){this.aAa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.Hek,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:A.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(J.a)(this,
this.z9k,"createFrame"),["resolveDialogStyles"]:this.JRg}};this.Ad=5;this.Wh(CommonUIStrings.l_SignIn,Object(J.a)(this,this.doo,"sharedAuthConsentDialogHandler"),this.aAa)}hGj(sa=!1,xa=5){this.aAa&&this.aAa.bodyControls&&(!0!==Object(W.a)(Object,this.aAa.bodyControls).frameLoaded&&(Object(W.a)(Object,this.aAa.bodyControls).frameLoaded=!0),sa!==Object(W.a)(Object,this.aAa.bodyControls).frameLoadSuccess&&(Object(W.a)(Object,this.aAa.bodyControls).frameLoadSuccess=sa),xa!==this.aAa.dialogButtonsOption&&
(this.aAa.dialogButtonsOption=null,this.Ad=xa),this.update(this.aAa))}qvo(sa,xa){const ia=new V.a(Z.a.hoo);ia.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:A.AFrameworkApplication.isRtl,["messageCorrelationId"]:sa,["dialogStyles"]:xa};this.Kq.PSa(ia,this.kH.contentWindow,this.Vsa)}d1h(){this.hGj(!1,6)}get Pnj(){return this.kH}get kll(){return this.Q_j.then(sa=>{this.KRg=!0;return sa})}get lll(){return this.KRg}dsn(){this.d1h()}z9k(){return this.kH}doo(sa){0===
sa&&(this.cmk.reject(Object.assign(new y.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.fub(null))}}Object(E.a)(da,"SharedAuthConsentDialog",X.a,[332]);var aa=c(957),ea=c(83),na=c(151),pa=c(39),ja=c(136),ma=c(119);class Ia{constructor(){this.kH=null;this.skd=0;this.OWb=this.a_b=this.$se=this.fub=this.iaa=this.ejh=null;this.Kq=new aa.a(null,null);this.sZb="SharedAuthTokenStrategy Unloaded";this.Vsa=w.OAuthManagerSettings.foo;this.jfh=w.OAuthManagerSettings.eoo;
this.mTg=w.OAuthManagerSettings.enableConsoleLogging;this.Y0j=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.kjk=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.Vmk=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.Lbb={};this.p6j=new L(1500)}nPc(){return this.sZb}initialize(){var {OAuthManager:sa}=c(1577);
if("loadFrame"in this.Lbb)return this.Lbb.loadFrame.Pvh;if(!this.Vsa)return ea.Health.instance.recordKpiFailure(sa.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),m.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);sa=this.Kje("loadFrame");this.skd=pa.a.$e();var xa=this.Vsa+this.jfh+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+A.AFrameworkApplication.userSessionId+"&WacUserType="+A.AFrameworkApplication.userType;
this.Vmk&&(xa+="&webworker=1");this.kH=document.createElement("iframe");this.Izf(this.kH);this.kH.style.cssText="height:0;width:0;display:none;";this.kH.id="SharedAuthFrame";this.kH.setAttribute("name","SharedAuthFrame");this.kH.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.kH.setAttribute("title","SharedAuthFrame");this.kH.src=xa;document.body.appendChild(this.kH);xa=pa.a.$e()-this.skd;m.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",
xa,this.kH.src);return sa}W1d(sa){this.$se=sa;const xa=new V.a(Z.a.Snj);xa.Values=this.vvh(sa);sa=this.Kje("initFrame");this.Kq.PSa(xa,this.kH.contentWindow,this.Vsa);m.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return sa}PY(sa,xa,ia,ha,ua,ya){const ra=new V.a(Z.a.ioo),La=this.Hei();ra.Values=this.vBj(sa,xa,ia,ha,ua,ya,La);sa=this.Kje(La);ha&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",
!1)?this.p6j.enqueue(()=>new Promise(oa=>{this.xMo(ya,ra,oa,La)})):(this.Kq.PSa(ra,this.kH.contentWindow,this.Vsa),m.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",xa));return sa}xMo(sa,xa,ia,ha){const ua=this.Lbb[ha];ua&&(this.a_b=xa,this.fub=Object.assign(new U,{resolve:ia,correlationId:ha}),this.iaa=new da(this.Vsa,this.jfh,sa,this.Kq,ua,ia),this.iaa.iTa())}Hei(){return ja.a.create().toString()}vBj(sa,xa,ia,ha,ua,ya,ra){const La={};La.appName=
sa;La.appId=xa;La.target=ia;La.withPopup=ha;La.claims=ua;La.promptMessage=ya;La.messageCorrelationId=ra;return La}Izf(sa){$addHandler(sa,"load",Object(J.a)(this,this.hnn,"onIFrameLoaded"));$addHandler(sa,"error",Object(J.a)(this,this.Ulb,"onIFrameError"));this.Kq.taa(this.Vsa);this.Kq.yv(Z.a.Vnj);this.Kq.NB(Z.a.Vnj,Object(J.a)(this,this.Frn,"onScriptLoaded"));this.Kq.yv(Z.a.Unj);this.Kq.NB(Z.a.Unj,Object(J.a)(this,this.Ern,"onScriptInitialized"));this.Kq.yv(Z.a.Qnj);this.Kq.NB(Z.a.Qnj,Object(J.a)(this,
this.Jmn,"onGetTokenResponse"));this.Kq.yv(Z.a.Wnj);this.Kq.NB(Z.a.Wnj,Object(J.a)(this,this.non,"onLoginResponse"));this.Kq.yv(Z.a.Tnj);this.Kq.NB(Z.a.Tnj,Object(J.a)(this,this.Hnn,"onInteractiveFlowReady"));this.Kq.yv(Z.a.Rnj);this.Kq.NB(Z.a.Rnj,Object(J.a)(this,this.Tmn,"onHideDialog"));this.Kq.yv(Z.a.Onj);this.Kq.NB(Z.a.Onj,Object(J.a)(this,this.YSf,"onCloseDialog"))}Kje(sa){const xa=new O;xa.startTime=pa.a.$e();const ia=new Promise((ha,ua)=>{xa.resolve=ha;xa.reject=ua});xa.Pvh=ia;this.Lbb[sa]=
xa;return ia}hnn(){const sa=pa.a.$e()-this.skd;m.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",sa)}Ulb(sa){const {OAuthManager:xa}=c(1577),ia=pa.a.$e()-this.skd,ha=Object.assign(new ma.a,{durationMs:ia});ea.Health.instance.recordKpiFailure(xa.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,ha);m.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ia,this.mTg?JSON.stringify(sa):"")}Frn(sa){const {OAuthManager:xa}=c(1577),
ia=this.Lbb.loadFrame;var ha=pa.a.$e()-ia.startTime,ua=sa.Values.AuthLibrary.toString();sa=sa.Values.Success.toString();m.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",sa,ua,ha);ua&&(this.sZb="SharedAuthTokenStrategy "+ua);ua=Boolean.parse(sa);ua||(sa=na.a.fG(),void 0!==sa&&null!==sa&&(sa.set("AuthLibrary",this.nPc()),ha=Object.assign(new ma.a,{durationMs:ha,extendedProperties:sa}),ea.Health.instance.recordKpiFailure(xa.kpiName,
"SharedAuthStrategyInitFailed",!1,!0,ha)));ia.resolve(ua?0:1)}Ern(sa){if(sa.Values.interactive&&this.a_b&&this.a_b.Values.messageCorrelationId){const ia=this.a_b.Values.messageCorrelationId.toString();if(sa.Values.interactive&&this.iaa){this.iaa.kll.then(ha=>{this.Kq.PSa(this.a_b,this.iaa.Pnj.contentWindow,this.Vsa);this.iaa.qvo(ia,ha);this.iaa.hGj(!0);this.a_b=null});return}}sa=this.Lbb.initFrame;const xa=pa.a.$e()-sa.startTime;m.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",
xa);sa.resolve(0)}Jmn(sa){if(sa.Values.messageCorrelationId&&sa.Values.messageCorrelationId.toString()){var xa=sa.Values.messageCorrelationId.toString(),ia=this.Lbb[xa];if(ia){var ha=pa.a.$e()-ia.startTime;m.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",ha);sa.Values.isSuccess&&sa.Values.isSuccess?ia.resolve(sa.Values.response):ia.reject(sa.Values.response);this.UBj(xa)}else m.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else m.ULS.sendTraceTag(573112904,
3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}Hnn(){if(this.iaa.lll)this.iaa.d1h();else if(this.$se&&this.iaa){const sa=new V.a(Z.a.Snj);sa.Values=this.vvh(this.$se,!0);this.Kq.PSa(sa,this.iaa.Pnj.contentWindow,this.Vsa)}}Tmn(){this.iaa&&this.iaa.bVd()}YSf(sa){sa.Values.cancelled&&sa.Values.cancelled&&sa.Values.messageCorrelationId&&this.UBj(sa.Values.messageCorrelationId.toString());this.iaa&&this.iaa.hide()}vvh(sa,xa=!1){const ia={};ia.appIds=this.qLl();
ia.upn=sa.loginHint;ia.authority=sa.authority;ia.authorityType=Object(e.a)(l.a,sa.authorityType);ia.tenantId=sa.tenantId;ia.correlationId=A.AFrameworkApplication.userSessionId;ia.enableConsoleLogging=this.mTg;ia.enablePopupFlash=this.Y0j;ia.skipUpnCheck=this.kjk;ia.interactive=xa;return ia}qLl(){const sa=[],xa=w.OAuthManagerSettings.A0e;for(let ha in xa){var ia=xa[ha];Array.contains(sa,ia)||Array.add(sa,ia)}return sa}tme(sa,xa,ia,ha,ua,ya){const ra=new V.a(Z.a.goo),La=this.Hei();ra.Values=this.vBj(sa,
xa,ia,ha,ua,ya,La);this.ejh=ra;sa=this.Kje(La);m.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",xa);this.$so();return sa}ike(){return!0}$so(){this.OWb||(this.OWb=new N.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.OWb.id=16,this.OWb.oZd=!1,this.OWb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{m.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");
this.Kq.PSa(this.ejh,this.kH.contentWindow,this.Vsa)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),A.AFrameworkApplication.ta.Nb.Fla(this.OWb,!0)||m.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}non(sa){if(sa.Values.messageCorrelationId&&sa.Values.messageCorrelationId.toString()){var xa=this.Lbb[sa.Values.messageCorrelationId.toString()];if(xa){var ia=pa.a.$e()-xa.startTime;m.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",
ia);sa.Values.isSuccess&&sa.Values.isSuccess?xa.resolve(sa.Values.response):xa.reject(sa.Values.response)}else m.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else m.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}UBj(sa){this.fub&&this.fub.correlationId===sa&&(this.fub.resolve(null),this.fub=null)}}Object(E.a)(Ia,"SharedAuthTokenStrategy",null,[324]);
class Ja{constructor(sa){this.N6=sa;this.sZb="UnsupportedAuthTokenStrategy Reason="+a.a[this.N6]}initialize(){return Promise.resolve(0)}W1d(){return Promise.resolve(0)}PY(){return Promise.resolve(Object.assign(new y.a,{IsSuccess:!1,ErrorCode:a.a[this.N6],ErrorMessage:"Unable to get a token. Reason: ["+a.a[this.N6]+"]"}))}tme(){return Promise.resolve(Object.assign(new y.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}ike(){return!1}nPc(){return this.sZb}}
Object(E.a)(Ja,"UnsupportedAuthTokenStrategy",null,[324]);var Ka=c(1489);c.d(M,"OAuthManager",function(){return Ma});class Ma{constructor(sa=null){this.f$=0;this.g$=null;this.Qwb=0;this.w1g=!!window.location.search.match(RegExp("wdpa=1","gi"));const xa=pa.a.$e();this.W5j=this.okl(sa).then(ia=>ia?this.ovm():(m.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.QK(),Math.floor(pa.a.$e()-xa)),ia=na.a.fG(),void 0!==ia&&
null!==ia&&(ia.set("AuthLibrary",this.QK()),ia=Object.assign(new ma.a,{durationMs:Math.floor(pa.a.$e()-xa),extendedProperties:ia}),ea.Health.instance.recordKpiFailure(Ma.kpiName,"StrategyPickFailed",!1,!0,ia)),Promise.resolve(1))).then(ia=>0!==ia?Promise.resolve(ia):this.QYm())}pkl(){if(this.w1g)this.f$=5,this.g$=new Ja(this.f$);else{var sa=w.OAuthManagerSettings.ecn;sa&&0<sa.length?(this.f$=1,this.g$=new z(sa)):A.AFrameworkApplication.K.$("IsO365ConsumerHost")||A.AFrameworkApplication.K.$("IsO365CommercialHost")?
A.AFrameworkApplication.K.$("IsAnonymousUser")?(this.f$=2,this.g$=new Ja(this.f$)):(sa=n.a.getAuthContext().loginHint)&&sa.length?w.OAuthManagerSettings.fRc?(this.f$=1,this.g$=new K):(this.f$=1,this.g$=new Ia):(this.f$=3,this.g$=new Ja(this.f$)):(this.f$=4,this.g$=new Ja(this.f$))}}QK(){return this.g$?this.g$.nPc()||"Unknown":"None"}okl(sa=null){m.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const xa=pa.a.$e();return A.AFrameworkApplication.K.wWl().then(ia=>{ia?(this.pkl(),sa&&(this.g$=
sa),m.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",w.OAuthManagerSettings.clientVersion,w.OAuthManagerSettings.appVersion,w.OAuthManagerSettings.Vol,this.QK(),Math.floor(pa.a.$e()-xa))):m.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(pa.a.$e()-xa));return Promise.resolve(ia)},()=>
{m.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(pa.a.$e()-xa));return Promise.resolve(!1)})}ovm(){m.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.QK());const sa=pa.a.$e();return v.get(this.g$.initialize(),2,w.OAuthManagerSettings.K0f).then(xa=>{if(0===xa)m.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.QK(),Math.floor(pa.a.$e()-sa));
else if(1===xa){m.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.QK(),Math.floor(pa.a.$e()-sa));var ia=na.a.fG();void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.QK()),ia=Object.assign(new ma.a,{durationMs:Math.floor(pa.a.$e()-sa),extendedProperties:ia}),ea.Health.instance.recordKpiFailure(Ma.kpiName,"StrategyInitFailed",!1,!0,ia))}else 2===xa&&(m.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.QK(),Math.floor(pa.a.$e()-sa)),ia=na.a.fG(),void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.QK()),ia=Object.assign(new ma.a,{durationMs:Math.floor(pa.a.$e()-sa),extendedProperties:ia}),ea.Health.instance.recordKpiFailure(Ma.kpiName,"StrategyInitTimedOut",!1,!0,ia)));return Promise.resolve(xa)},()=>{m.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.QK(),Math.floor(pa.a.$e()-sa));return Promise.resolve(1)})}QYm(){m.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.QK());const sa=pa.a.$e();return v.get(this.g$.W1d(n.a.getAuthContext()),2,w.OAuthManagerSettings.K0f).then(xa=>{if(0===xa)m.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.QK(),Math.floor(pa.a.$e()-sa));else if(1===xa){m.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.QK(),Math.floor(pa.a.$e()-sa));var ia=na.a.fG();void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.QK()),ia=Object.assign(new ma.a,
{durationMs:Math.floor(pa.a.$e()-sa),extendedProperties:ia}),ea.Health.instance.recordKpiFailure(Ma.kpiName,"StrategyLoadFailed",!1,!0,ia))}else 2===xa&&(m.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.QK(),Math.floor(pa.a.$e()-sa)),ia=na.a.fG(),void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.QK()),ia=Object.assign(new ma.a,{durationMs:Math.floor(pa.a.$e()-sa),extendedProperties:ia}),ea.Health.instance.recordKpiFailure(Ma.kpiName,
"StrategyLoadTimedOut",!1,!0,ia)));return Promise.resolve(xa)},()=>{m.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.QK(),Math.floor(pa.a.$e()-sa));return Promise.resolve(1)})}PY(sa,xa,ia=null){return this.Slc(sa,xa,!1,null,"",ia)}wBj(sa,xa,ia,ha,ua=null){return this.Slc(sa,xa,!0,ia,ha,ua)}Slc(sa,xa,ia,ha,ua,ya,ra=0){ra+=1;m.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
sa,this.rNb(sa,xa),this.QK(),ra);var La=na.a.fG();void 0!==La&&null!==La&&(La.set("AuthLibrary",this.QK()),La.set("AppName",sa),La.set("Target",this.rNb(sa,xa)),ea.Health.instance.recordKpiUsage(Ma.kpiName,0,"WacOAuthFC",La));if(!w.OAuthManagerSettings.isEnabled||this.w1g){var oa;return this.kKf((oa=new y.a,oa.IsSuccess=!1,oa.Token=null,oa.ErrorCode="NotEnabled",oa.ErrorMessage="OAuthManager is disabled.",oa),sa)}const Ca=w.OAuthManagerSettings.A0e[sa];if(void 0===Ca||null===Ca){m.ULS.sendTraceTag(41961345,
3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",sa);var Aa;return this.kKf((Aa=new y.a,Aa.IsSuccess=!1,Aa.Token=null,Aa.ErrorCode="DisallowedApp",Aa.ErrorMessage="Disallowed appName: "+sa,Aa),sa)}const db=pa.a.$e();let eb=db;const ib=this;La=this.W5j.then($a=>{eb=pa.a.$e();return ib.hDm(sa,Ca,xa,ia,ha,ua,ya,$a)});oa=ia?0:w.OAuthManagerSettings.K0f;let lb;Aa=(lb=new y.a,lb.IsSuccess=!1,lb.Token=null,lb.ErrorCode="authTokenStrategy_timeout",
lb.ErrorMessage="Auth Strategy timed out after ["+oa+"] ms when fetching token",lb);let Ya=this,Fa=this;return v.get(La,Aa,oa).then($a=>ra<=Ma.u$m&&($a.ErrorCode===Ma.ryj||$a.ErrorCode===Ma.EBo)?(m.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",ra,Math.floor(pa.a.$e()-db)),Ya.Slc(sa,xa,ia,ha,ua,ya,ra)):$a.ErrorCode===Ma.fDi&&!ia&&(m.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",
ra,Ma.aVh),Ma.ysl&&Ya.g$.ike()&&Ya.g$.tme(sa,Ca,xa,ia,ha,ua).then(Db=>Promise.resolve(Ya.I2d(Db,sa,xa,Ca,db,eb))).catch(()=>{let Db;const gc=(Db=new y.a,Db.IsSuccess=!1,Db.Token=null,Db.ErrorCode="authTokenStrategy_failure",Db.ErrorMessage="LoginPopup failed, GetToken could not be called",Db);return Promise.resolve(Ya.I2d(gc,sa,xa,Ca,db,eb))}),Ma.aVh)?Ya.Slc(sa,xa,!0,ha,ua,ya,ra):Promise.resolve(Ya.I2d($a,sa,xa,Ca,db,eb))).catch(()=>{let $a;const Db=($a=new y.a,$a.IsSuccess=!1,$a.Token=null,$a.ErrorCode=
"authTokenStrategy_failure",$a.ErrorMessage="Auth Strategy failed with an unknown error",$a);return Promise.resolve(Fa.I2d(Db,sa,xa,Ca,db,eb))})}hDm(sa,xa,ia,ha,ua,ya,ra,La){return 1===La||2===La?this.kKf(Object.assign(new y.a,{IsSuccess:!1,Token:null,ErrorCode:1===La?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),sa):this.g$.PY(sa,xa,ia,ha,ua,ya,ra).then(oa=>Promise.resolve(this.pQi(oa,!0,sa))).catch(oa=>Promise.resolve(this.pQi(oa,!1,sa)))}I2d(sa,xa,ia,ha,ua,ya){const ra=
{},La=pa.a.$e()-ya;ra.IsSuccess=sa.IsSuccess;ra.ErrorCode=sa.IsSuccess?"Success":sa.ErrorCode||"";ra.ErrorMessage=sa.IsSuccess?"Success":this.rNb(xa,sa.ErrorMessage||"");ra.Target=this.rNb(xa,ia||"");ra.TimeInMS=Math.floor(La);ra.LoadTimeInMS=Math.floor(ya-ua);ra.AuthLibrary=this.QK();ra.AppName=xa;ra.AuthorityType=Object(e.a)(l.a,n.a.JNd());ra.UserType=this.xgm(n.a.getAuthContext());ra.IsAuthSupportedInSession=a.a[this.f$];ra.RequestCount=++this.Qwb;ra.AppId=ha;m.ULS.sendTraceTag(593863640,3E3,50,
JSON.stringify(ra));sa.IsSuccess||(ia=na.a.fG(),void 0!==ia&&null!==ia&&(ia.set("AppName",xa),ia.set("AuthLibrary",this.QK()),ia.set("ErrorCode",sa.ErrorCode),ia.set("ErrorMessage",this.rNb(xa,sa.ErrorMessage)),xa=Object.assign(new ma.a,{durationMs:La,extendedProperties:ia}),ea.Health.instance.recordKpiFailure(Ma.kpiName,"TryGetTokenFailure",!1,!0,xa)));return sa}kKf(sa,xa){m.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",xa,this.rNb(xa,
sa.ErrorMessage));const ia=na.a.fG();void 0!==ia&&null!==ia&&(ia.set("AppName",xa),ia.set("AuthLibrary",this.QK()),ia.set("ErrorCode",sa.ErrorCode),ia.set("ErrorMessage",this.rNb(xa,sa.ErrorMessage)),xa=Object.assign(new ma.a,{extendedProperties:ia}),ea.Health.instance.recordKpiFailure(Ma.kpiName,"FailureBeforeGetToken",!1,!0,xa));return Promise.resolve(sa)}Fwi(sa){return sa===Ka.a.nle}rNb(sa,xa){return this.Fwi(sa)&&xa?"REDACTED":xa}xgm(sa){return A.AFrameworkApplication.K.$("IsAnonymousUser")?"anonymous":
!sa.loginHint||1>sa.loginHint.length?"empty":-1<sa.loginHint.indexOf("guest#")?"guest":-1<sa.loginHint.indexOf("ext#")?"external":0>sa.upn.indexOf("@")?"no-at":"supported"}pEm(){return 1===this.f$}pQi(sa,xa,ia){let ha=null,ua=null,ya=null,ra=null;sa?sa.ErrorCode||sa.ErrorMessage?(ua=sa.ErrorCode?sa.ErrorCode:Ma.ZWh,ya=sa.ErrorMessage?sa.ErrorMessage:"No message"):sa.Token?xa?ha=sa.Token:(ua=Ma.rWn,ya="A rejected promise returned a token."):(ua=Ma.ZWh,ya=JSON.stringify(sa)):(ua=Ma.cfn,ya="No result came from Auth Token Strategy");
sa&&sa.Telemetry&&!this.Fwi(ia)&&(ra=sa.Telemetry,m.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(ra)));if(ua===Ma.Acn||ua===Ma.IIo)ua=Ma.ryj,ya="Auth Library Timed Out";ua===Ma.UGk&&-1<ya.indexOf(Ma.jok)&&(ua=Ma.fDi);if(ua||ya)ha=null;return Object.assign(new y.a,{IsSuccess:!!ha,Token:ha,ErrorCode:ua,ErrorMessage:ya,Telemetry:ra})}static get aVh(){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get ysl(){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",
!1)}}Ma.IIo="token_renewal_error";Ma.ZWh="Exception";Ma.cfn="NoResult";Ma.rWn="RejectToken";Ma.Acn="monitor_window_timeout";Ma.ryj="Timeout";Ma.EBo="authTokenStrategy_timeout";Ma.UGk="login_required";Ma.jok="AADSTS50058";Ma.fDi="Cookies Disabled";Ma.kpiName="OAuthManager";Ma.u$m=2;Object(E.a)(Ma,"OAuthManager",null,[281])},1580:function(E,M,c){E=c(0);class m{constructor(z,n,v,A){this.DZj=z;this.tgk=n;this.rgk=v;this.ugk=A}get EFd(){return this.DZj}get Yde(){return this.tgk}get Wde(){return this.rgk}get resultType(){return this.ugk}}
Object(E.a)(m,"SearchContext",null,[1145]);class e{TGd(z,n,v,A){var w=v-n;let G;if(100<=w)w=n,G=v;else{w=Math.max(0,n+Math.ceil(w/2)-50);G=Math.min(z.length,w+100);w=Math.max(0,G-100);let I;if(w&&" "!==z.charAt(w-1)){I=Math.min(n,w+10);for(var F=w;F<I;++F)if(" "===z.charAt(F)){w=F+1;break}}if(G!==z.length&&" "!==z.charAt(G))for(I=Math.max(v,G-10),F=G-1;F>=I;--F)if(" "===z.charAt(F)){G=F;break}}z=z.substring(w,G);return new m(z,n-w,v-w,A)}UGd(z){return this.TGd(z.ici(),z.begin,z.end,"")}}Object(E.a)(e,
"SearchContextFactory",null,[1128]);var a=c(124),l=c(1564);c.d(M,"a",function(){return y});class y extends e{constructor(){super()}UGd(z){let n=z.begin,v=z.end;const A=({begin:n,end:v}=y.p5l(z,n,v)).returnValue;z=l.a(z.type);return this.TGd(A,n,v,z)}static get instance(){return null!=y.zBg?y.zBg:y.zBg=new y}static p5l(z,n,v){z=z.ici();return y.v9i(z,n,v)}static v9i(z,n,v){const A=a.AParagraphNode.OU(z);if(A.length<z.length){z=z.substring(0,n);const w=a.AParagraphNode.OU(z);z=z.length-w.length;n-=
z;v-=z}return{returnValue:A,begin:n,end:v}}}Object(E.a)(y,"EditorSearchContextFactory",e,[])},1582:function(E,M,c){E=c(0);var m=c(2),e=c(22),a=c(327),l=c(709),y=c(23),z=c(9),n=c(134),v=c(46),A=c(538),w=c(204),G=c(245),F=c(81),I=c(28),K=c(8),J=c(3),N=c(6),R=c(588),O=c(1045);class L{create(){return new O.a}}Object(E.a)(L,"FootnoteEndnoteContainerNodeFactory",null,[298]);var U=c(528);c.d(M,"a",function(){return W});class W{constructor(X,V,Z,da,aa,ea,na,pa,ja){this.dxd=null;W.ga=X;this.tE=Z;this.BMe=
da;this.eZj=ea;this.Wc=na;this.ib=aa;this.tak=pa;this.p_j=ja;W.Jh=V}C4d(X,V){this.Wtl(X);X.Rb(7);this.tE.Dwi(X,V)||X.vf(7)}Wtl(X){if(this.BMe.Zyi(X)){var V=!1,Z=!1;if(X.Rb(7)){do{const da=X.currentNode;if(37===da.type)switch(da.getValue(N.a.G3)){case 0:Z=!0;break;case 1:V=!0}}while(X.xi(7))}Z||this.knh(X,0);V||this.knh(X,1)}}knh(X,V){const Z=this.eZj.create(1074135124);Z.setValue(N.a.G3,V);X.Hf(Z,7)}cao(X){X&&this.Zgj(X.cna)}Zgj(X){X&&(X=y.SelectionFactory.te(X.Ib.paragraph,X.Ib.cp+1),this.ib.setSelection(X))}aen(X){let V=
this.tak(X);void 0!==V&&null!==V?this.tE.koa(V)&&(V=this.tE.Jci(V)):V=X;return this.p_j(V)}Uvo(){this.dxd?W.Jh.notificationBar.removeEntry(this.dxd):this.dxd=W.Jh.notificationBar.rma(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);W.Jh.notificationBar.aA(this.dxd)}kDk(X,V){X=this.Wc.jEa(X,37,37);let Z=!1;if(X.Qd()){do{const da=X.currentNode;this.tE.mGf(da)?this.kth(da,V):Z=!0}while(X.Rj())}Z&&this.Uvo()}kth(X,V){R.e(X,Z=>{W.nGl(Z,V);return!0},12)}xom(X,V){X=
this.tE.WNc(X,V);return X?(X=this.Wc.Uf(X))?X.rA():!1:!1}l8h(X,V){X=this.tE.WNc(X,V);X=this.Wc.Uf(X);if(X.Qd()){do if(V=X.currentNode,1===V.getValue(N.a.dna))return V;while(X.Rj())}return null}static XNc(){return new W(m.AFrameworkApplication.va,z.App.ya,U.a.instance,n.PageReader.instance,v.a.instance,new L,new A.a,w.OutlineNavigator.Wdn,G.WordSectionNavigator.Ocf)}static get instance(){return null!=W.JBg?W.JBg:W.JBg=W.XNc()}static get paragraphEditor(){return null!=W.aFg?W.aFg:W.aFg=e.a.instance.resolve("Box4.IParagraphEditor")}static nGl(X,
V){V.kib?W.paragraphEditor.fq.Tca(X,F.OutlineReader.rX(X)):W.paragraphEditor.fq.Tca(X,0);X=I.a.createTextRange(X,0,K.ParagraphReader.textLength(X));W.ga.Nf(X,J.a.font,2,!0,new a.a,new l.a(V.fontName));W.ga.Nf(X,J.a.LA,2,!0,new a.a,new l.a(V.fontSize))}}W.ga=null;W.Jh=null;Object(E.a)(W,"FootnoteEndnoteEditor",null,[353])},1590:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);var m;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";
e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported";e[e.perfAutomation=5]="perfAutomation"})(m||(m={}));Object(E.b)("SupportStatus",m)},1600:function(E,M,c){c.d(M,"a",function(){return K});E=c(0);var m=c(354),e=c(58),a=c(22),l=c(145),y=c(7),z=c(110),n=c(73),v=c(12),A=c(101),w=c(524),G=c(124),F=c(121),I=c(8);class K{constructor(J,N,R,O,L,U=null,W="",X=!0,V=!1){this.n0a=this.vje=this.Gnb=this.I3i=this.xde=null;this.mUc=!1;this.hzf=null;this.ERf=0;
this.dle=null;this.context=J;this.je=J.view;this.ux=N;this.vd=L;this.tR=R;this.x9=O;this.Iia=this.failed=!1;this.F8d=null;this.I2a=this.Tac=!1;this.Jwo=K.J9e(J);this.browserName=W;this.BHj=X;this.YVc=V;this.kUa=!1;this.m3b=0;if(J=Object(z.a)(138,L)?L:null){this.I3i=new m.DictionaryPropertySet;this.I3i.Qw(J);R=J.ia(l.a.Z0c,e.a.nil);this.oGc=R!=e.a.nil?R.toString():e.a.create().toString();if(J.ia(l.a.L_i,!1)){this.Tac=!0;this.I2a=J.ia(l.a.I2a,!1);this.F8d=U;for(U=this.je.mb.sg;U.Ww;)U=U.getContext(0);
if(L=Object(n.a)(G.AParagraphNode,U.node)){R=0;O=I.ParagraphReader.textLength(L);switch(U.contextId){case v.a.Hd:R=U.cpBegin;O=U.cpEnd;break;case v.a.endOfParagraph:R=O}this.xde=A.FormattingReader.hPd(U.node,R,U.Eb);y.ULS.shipAssertTag(6305503,307,!!this.xde);L=F.HyperlinkReader.hOc(L);for(const Z of L)Z.cpEnd<=R||Z.cpBegin>=O||K.hyperlinkEditor.CR(U.node,Z.hyperlink)}}this.Iia=J.ia(l.a.Iia,!1);this.kUa=J.ia(l.a.kUa,!1);this.Gnb=J.ia(l.a.Gnb,null)}else this.oGc=e.a.create().toString();N&64&&(this.Iia=
!0)}static get hyperlinkEditor(){return null!=K.sAg?K.sAg:K.sAg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static J9e(J){if(J){if(J.Ww){for(let N=0;N<J.length;N++)if(K.J9e(J.getContext(N)))return!0;return!1}if(Object(z.a)(w.a,J))return K.J9e(J.$j);if(I.ParagraphReader.Wb(J.node)&&J.node.eO)return!0}return!1}}Object(E.a)(K,"ClipboardActionArguments",null,[])},1601:function(E,M,c){c.d(M,"a",function(){return l});E=c(0);var m=c(7),e=c(209),a=c(103);class l{static get VVm(){return l.Gnd}static w7k(y,
z,n){try{l.Gnd=l.oal(y,z,n)}catch(v){l.Gnd=null,m.ULS.fE(539787540,393,10,v,"Error in creating autoTriggerTextContext: {0}",v instanceof Error?v.message:"Unknown Error")}}static Hcj(){l.Gnd=null}static oal(y,z,n){if(!a.ListItemReader.sh(z))throw m.ULS.sendTraceTag(539787541,393,10,"Given iterator should be at a ListOutlineElement"),Error("Given iterator should be at a ListOutlineElement");const v=e.a.i0l(z);if(null===v||void 0===v||!v.id)throw m.ULS.sendTraceTag(539787542,393,10,"No list node with id found under outline element"),
Error("No list node with id found under outline element");z=n.hw(z);if(!z)throw m.ULS.sendTraceTag(539787543,393,10,"No listInfo found for given iterator"),Error("No listInfo found for given iterator");return new l(y,v.id,z)}constructor(y,z,n){this.xAj=y;this.yYm=z;this.D4f={listType:n.listType,listStyle:n.listStyle,xJf:n.Cu}}ZOm(y,z){return z&&y&&this.yYm===y.id&&z.listType===this.D4f.listType&&z.listStyle===this.D4f.listStyle&&z.Cu===this.D4f.xJf}}l.Gnd=null;Object(E.a)(l,"AutoTriggerTextContext",
null,[])},1602:function(E,M,c){c.d(M,"a",function(){return N});E=c(0);var m=c(22),e=c(58),a=c(43),l=c(633),y=c(134),z=c(538),n=c(147),v=c(9),A=c(107),w=c(6),G=c(870),F=c(759),I=c(528),K=c(1529),J=c(1582);class N{constructor(R,O,L,U,W,X){this.tE=R;this.sKa=L;this.BMe=U;this.kxe=W;this.Wc=X}lAm(R,O,L){const U=this.H$h(O,R.node),W=R.node.Kc;if(!W)return null;const X=new a.GraphTransaction(15);X.Cb(R.node);X.fk=L;L=this.mAm(U,O);N.nAm(L,W,R,O);X.dispose();return L}H$h(R,O){const L=this.Wc.xk();L.set(O);
L.zb(7);L.hd(7);this.sKa.C4d(L,R);return L}mAm(R,O){const L=F.a.createNode();L.properties.setValue(w.a.G3,O);R.Hf(L,8);this.kxe.C8k(L,O);return L}static get characterPropertiesEditor(){return null!=N.nwg?N.nwg:N.nwg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get $R(){return N.zW||(N.zW=new l.WACStyleSet)}static set $R(R){N.zW=R}static XNc(){const {FootnoteEndnoteDefaultContentInserter:R}=c(1674);return new N(I.a.instance,K.a.instance,J.a.instance,y.PageReader.instance,R.instance,
new z.a)}static get instance(){return null!=N.oCg?N.oCg:N.oCg=N.XNc()}static get fh(){return N.Tz||(N.Tz=n.PageNavigator.instance)}static set fh(R){N.Tz=R}static nAm(R,O,L,U){v.App.rd.Yo&&v.App.rd.kq.rH(L.node);const W=new A.a;W.setValue(w.a.r6b,R.id);W.setValue(w.a.G3,U);const X=O.Ju(W,e.a.create());N.characterPropertiesEditor.Uga(L,V=>G.a.getInstance(V,X,R.id),N.T4h(L.node,U))}static T4h(R,O){let L=null;(R=N.fh.Ts(R))&&(R=N.$R.LO(R))&&(L=R.Ova(O?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:
Box4Intl.Box4Strings.L_StyleWordEndnoteReference));return L}}N.zW=null;N.Tz=null;Object(E.a)(N,"FootnoteEndnoteInserter",null,[405])},1608:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{static q1n(e,a){m.bMe=e;m.gPe=a}static n1n(e,a){m.ePe=e;m.qYa=a}static Gei(){return m.ePe===m.qYa?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,m.qYa,m.bMe,m.gPe):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,m.ePe,m.qYa,m.bMe,m.gPe)}}m.ePe=0;m.qYa=0;m.bMe=
null;m.gPe=null;Object(E.a)(m,"ReplaceAllContext",null,[])},1631:function(E,M,c){c.r(M);E=c(0);var m=c(2006),e=c(58),a=c(2),l=c(307),y=c(22),z=c(1930),n=c(9),v=c(7),A=c(243),w=c(2008),G=c(13),F=c(16),I=c(1580);class K{constructor(Ob="",Ub="",pb=!1,Zb=!1){this.sMm=pb;this.SPm=Zb;this.actionId=Ob;this.MHa=Ub}}Object(E.a)(K,"SearchEntryPointContext",null,[]);class J{constructor(Ob){this.Eea=null;this.Gs=!1;this.mN=Ob}initialize(){this.c_();this.wz();this.u7(0)}wz(){this.Eea.wz()}dispose(){this.mN=null}ePc(){return!1}get jG(){return this.Eea?
this.Eea.jG:0}u7(Ob){this.Eea.u7(Ob)}get isVisible(){return this.Gs}mZe(Ob){this.Eea&&this.Eea.$$o(Ob)}u$i(Ob){this.Eea&&this.Eea.Yip(Ob)}wGj(Ob){this.Eea&&this.Eea.rmp(Ob)}zDh(){this.Eea&&this.Eea.kbp()}efe(Ob){this.Eea&&this.Eea.efe(Ob)}}Object(E.a)(J,"FindReplacePane",null,[419,9]);var N=c(65),R=c(1393),O=c(1059),L=c(166),U=c(176),W=c(1046),X=c(92),V=c(106),Z=c(83),da=c(44),aa=c(25),ea=c(397),na=c(1492),pa=c(330),ja=c(1026),ma=c(695),Ia=c(77),Ja=c(1077);class Ka{constructor(Ob){this.Erk=(Ub,pb)=>
{this.exd.nb(Ub)?this.exd.Z(Ub,pb):this.exd.add(Ub,pb);(Ub=this.bLl(Ub))&&this.Xsi(pb,Ub,this.rIh(pa.a.getTypeName()))};this.exd=new Ia.a;this.tV=new Ia.a;this.annotationType=na.RoleDetectionAnnotation.getTypeName();Ob.rSn(this.Erk)}UD(Ob,Ub){let pb;const Zb=Ob.parentPath.substr(Ob.parentPath.lastIndexOf("\\")+1),Wa=Ob.content;if(!Wa||this.yPm(Wa))""!==Zb&&({value:pb}=this.exd.Dc(Zb,pb)).returnValue&&this.Xsi(pb,Ob,this.rIh(Ub)),Ub===pa.a.getTypeName()?(Ub=null,({value:Ub}=this.tV.Dc(Zb,Ub)).returnValue?
this.tV.Z(Zb,Ob):this.tV.add(Zb,Ob)):Ub===ja.a.getTypeName()&&this.tV.remove(Zb)}Xsi(Ob,Ub,pb){const Zb=this.w_l(Ub);Ub=this.cLl(Ub);0<Ub&&Ob(pb,Zb,Ub)}cLl(Ob){try{return Number.parseInvariant(Ob.id.substr(2))}catch(Ub){v.ULS.sendTraceTag(554747009,367,10,Ub.toString())}return-1}bLl(Ob){let Ub;return({value:Ub}=this.tV.Dc(Ob,Ub)).returnValue?Ub:null}y1c(Ob){if(Ob)for(const Ub of Ob)this.UD(Ub,"AugLoop_Core_AddOperation")}w_l(Ob){if(Ob=Ob.content)switch(Ob.roleType){case na.RoleType.Heading1:return 1;
case na.RoleType.Heading2:return 2;case na.RoleType.Heading3:return 3;case na.RoleType.Heading4:return 4;case na.RoleType.Heading5:return 5;case na.RoleType.Heading6:return 6;case na.RoleType.Heading7:return 7;case na.RoleType.Heading8:return 8;case na.RoleType.Heading9:return 9}return-1}yPm(Ob){Ob=Ob.roleType;return Ob===na.RoleType.Heading1||Ob===na.RoleType.Heading2||Ob===na.RoleType.Heading3||Ob===na.RoleType.Heading4||Ob===na.RoleType.Heading5||Ob===na.RoleType.Heading6||Ob===na.RoleType.Heading7||
Ob===na.RoleType.Heading8||Ob===na.RoleType.Heading9}rIh(Ob){if(Ob===pa.a.getTypeName()||Ob===ma.a.getTypeName())return Ja.a.WYe;if(Ob===ja.a.getTypeName())return Ja.a.fId;throw Error.create("Invalid operation type");}}Object(E.a)(Ka,"RoleDetectionAnnotationHandler",null,[251]);var Ma=c(132),sa=c(61),xa=c(1137),ia=c(46),ha=c(74),ua=c(55),ya=c(192),ra=c(147),La=c(649);class oa extends ya.a{constructor(Ob,Ub){super(Ob,Ub,n.App.oda);this.l0d=null;this.oib=this.q1b=0;this.headingsReady=!1;this.$Ra=this.Ldb=
0;this.bKi=!1;this.e7g=this.MXg=this.TTg=null}get W_d(){return!0}get BXh(){return this.TTg}get T4d(){return this.e7g}IIj(){this.headingsReady&&(this.MXg.style.display="none",this.oib||this.q1b?(this.BXh.style.display="none",this.container.style.display="block"):(this.container.style.display="none",this.BXh.style.display="block"))}get r8(){return super.r8|240}static Vaf(Ob,Ub,pb){var Zb=n.App.ya.gb.Uc;if(Zb&&(Zb=ra.PageNavigator.instance.IO(Zb))){const Wa=new oa(new La.a,y.a.instance.resolve("Box4.IHtmlViewRootFactory"));
Wa.oib=0;Wa.q1b=0;Wa.l0d=null;Wa.Bzb(Ob);Wa.TTg=Ub;Wa.MXg=pb;Wa.LE(Zb);Wa.headingsReady=!0;Wa.IIj();Wa.e7g=null;return Wa}return null}}Object(E.a)(oa,"WordNavigationPaneHeadingsView",ya.a,[437,61,62,9]);class Ca{constructor(Ob){this.tV=new Ia.a;this.q8g=Ob}UD(Ob,Ub){Ub===pa.a.getTypeName()?(Ub=null,({value:Ub}=this.tV.Dc(Ob.id,Ub)).returnValue?this.tV.Z(Ob.id,Ob):this.tV.add(Ob.id,Ob)):Ub===ja.a.getTypeName()&&this.tV.remove(Ob.id);this.q8g&&this.q8g()}y1c(Ob){if(Ob)for(const Ub of Ob)this.UD(Ub,
pa.a.getTypeName())}O6b(){var Ob;const Ub=[];if(0<(null===(Ob=this.tV)||void 0===Ob?void 0:Ob.count))for(const pb of this.tV.values)Ub.push(pb);return Ub}}Object(E.a)(Ca,"ContractEntityAnnotationHandler",null,[251]);var Aa=c(3);class db{constructor(Ob){this.ga=Ob}ekn(){this.cancelSearch()}hmn(Ob){this.ga.Qb(F.a.USd,2,Ob)}wpn(){this.cancelSearch()}cancelSearch(){this.ga.processAction(Aa.a.dAb,2)}Hrn(){this.ga.processAction(Aa.a.findOnPage,2)}onSearchQueryChanged(Ob){this.ga.Qb(Aa.a.ULd,2,Ob)}qtn(){this.ga.processAction(F.a.replace,
2)}stn(){this.ga.processAction(F.a.replaceAll,2)}mtn(){this.ga.processAction(G.a.Sjf,2)}ntn(){this.ga.processAction(G.a.gkf,2)}ptn(){this.ga.processAction(Aa.a.U$d,2)}otn(){this.ga.processAction(Aa.a.h5d,2)}vgc(Ob){this.ga.Qb(F.a.vgc,2,Ob)}}Object(E.a)(db,"FindReplaceActions",null,[436]);var eb=c(272);class ib{}ib.rP=eb.a.Cgb;ib.kfc=0;ib.Hua="FindReplaceTaskPaneData";ib.LR=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(E.a)(ib,"FindReplaceConstants",null,[]);var lb=c(755);class Ya{pBj(Ob){var Ub,
pb,Zb;return ea.a.Ehb(null===(Zb=null===(pb=null===(Ub=n.App.ya)||void 0===Ub?void 0:Ub.gb)||void 0===pb?void 0:pb.Uc)||void 0===Zb?void 0:Zb.od,Ob)}clearSelection(){if(this.RHe){const Ob=this.pBj(this.RHe);Ob&&Ob.rfa()}this.RHe=this.jeh=null}U$n(Ob){this.clearSelection();if(Ob){const Ub=this.pBj(Ob.parentPath);if(Ub){const pb=Ob.content;pb&&(this.jeh=Ob.id,Ub.Nia([new lb.a(pb.range.start,pb.range.start+pb.range.length)]),Ub.TLf(0,1));this.RHe=Ob.parentPath}}}}Object(E.a)(Ya,"RangeAnnotationContentSelector",
null,[]);var Fa=c(1608);class $a{constructor(Ob){this.F9j=Ob}get Jj(){return this.F9j.value}b3l(Ob){Ob=this.Jj.i1a(Ob);return this.TIm(Ob)?null:Ob}TIm(Ob){return Ob.id===this.Jj.WDa.id}static get instance(){return null!=$a.dBg?$a.dBg:$a.dBg=$a.YE()}static YE(){const Ob=new A.a(()=>z.FindManager.instance.Jj);return new $a(Ob)}}Object(E.a)($a,"SearchResultOrder",null,[]);var Db=c(8),gc=c(202);class Eb{constructor(Ob){this.mIe=Ob}get P0(){return this.mIe.value}getSelectedText(){var Ob=this.P0.E3;if(Ob){const Ub=
Ob.cpBegin,pb=Ob.cpEnd-Ub;if(0<pb&&(Ob=Ob.node,Db.ParagraphReader.Wb(Ob)))return Ob.characterData.substr(Ub,pb)}return null}static getInstance(){return Eb.Rl()}static Rl(){const Ob=new A.a(()=>gc.a.instance);return new Eb(Ob)}}Object(E.a)(Eb,"SelectionHelper",null,[]);var kb=c(31),bb=c(119),Gb=c(368),Sa=c(851),Pa=c(237),Ab=c(369),nb=c(1840),Rb=c(332);class Mb extends ya.a{constructor(Ob,Ub,pb){super(Ob,Ub,n.App.oda);this.n5a=pb;this.Wli=!1}get W_d(){return!0}get r8(){return super.r8|248}static Vaf(Ob){var Ub=
n.App.ya.gb.Uc;const pb=Rb.a.instance.Mc(3);return Ub&&(Ub=ra.PageNavigator.instance.IO(Ub))?(Ob=new Mb(new La.a,y.a.instance.resolve("Box4.IHtmlViewRootFactory"),Ob),pb.p7c(Ob.ic),Ob.LE(Ub),pb.dispose(),Ob.Wli=!0,Ob):null}}Object(E.a)(Mb,"WordNavigationPaneReactHeadingsView",ya.a,[61,62,9]);class oc extends J{constructor(Ob,Ub,pb,Zb,Wa,Lb,qc,Ra,yb,Bb,cb,Xa,hb){var Cb,ob,ab;super(Ob);this.etb=ib.rP;this.Pkk="FindReplaceTaskPaneProps";this.Ub=N.FocusManager.instance();this.fVa=this.aMa=this.zZ=this.rTe=
null;this.qSb=a.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled");this.ied=a.AFrameworkApplication.K.$("AutoDetectedHeadingsIsEnabled");this.Yod=(null===(Cb=a.AFrameworkApplication.K)||void 0===Cb?void 0:Cb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactHeadings",!1))||(null===(ob=a.AFrameworkApplication.K)||void 0===ob?void 0:ob.$("NavPaneReactHeadings"));this.rak=null===(ab=a.AFrameworkApplication.K)||void 0===ab?void 0:ab.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",
!1);this.eFj=()=>{this.isVisible&&this.mHd===w.a.intelligentPlaceholder&&this.Cm()};this.cB=new R.a;this.GWg=Ub;this.NJa=w.a.headings;this.ECc=m.a.initial;this.Vra=new ha.a;this.QP="";this.Qsc={matchCase:!1,matchWholeWord:!1};this.fPe="";this.TQe=null;this.R2=pb;this.Vfh=!1;this.lcb=Zb;this.ib=Wa;this.Hak=Lb;this.OBa=qc;this.sI=Ra;this.Spd=!0;this.E6=this.D6=!1;this.Te=yb;this.gH=Bb;this.Hb=cb;this.rV=Xa;this.CPg=hb;this.Use&&this.OBa.cWn(()=>{this.Cm()})}get $Te(){return 1}get Use(){return this.qSb&&
this.ied&&!!this.Te}get Vse(){return this.qSb&&this.rak&&!!this.Te}get headingsReady(){return this.Yod?this.gH.headingsReady:this.Zjd?this.Zjd.headingsReady:!1}set headingsReady(Ob){this.Yod?this.gH.headingsReady=Ob:this.Zjd&&(this.Zjd.headingsReady=Ob)}get mHd(){return this.NJa}Tqj(){this.NJa=w.a.headings;this.Cm()}rto(){this.NJa=w.a.contracts;this.Cm()}Kqj(){this.NJa=w.a.find;da.a("NavigationPaneFind");this.Cm()}Crj(){this.NJa=w.a.replace;this.Cm()}erj(){this.NJa=w.a.intelligentPlaceholder;this.Cm()}e8c(Ob){this.Vfh=
Ob;this.Cm()}ePc(){return this.mHd===w.a.replace}get jG(){return this.ECc}u7(Ob){this.ECc=Ob;this.Cm()}mZe(Ob){this.Htk(Ob);this.Cm()}Htk(Ob){const Ub=this.Hak(Ob[Ob.length-1]);if(Ub){let pb=-1;for(let Zb=0;Zb<this.Vra.count;Zb++)if(Ub.id===this.Vra.J(Zb).id){pb=Zb;break}-1===pb?v.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.Vra.PC(pb,this.QIh(Ob))}else this.Vra.addRange(this.QIh(Ob))}u$i(Ob){for(const Ub of Ob)for(Ob=this.Vra.count-1;0<=Ob;Ob--)if(this.Vra.J(Ob).id===
Ub.id){this.Vra.removeAt(Ob);break}this.Cm()}wGj(Ob){for(const Ub of Ob)for(Ob=this.Vra.count-1;0<=Ob;Ob--)if(this.Vra.J(Ob).id===Ub.id){this.Vra.Z(Ob,this.PIh(Ub));break}this.Cm()}zDh(){this.Vra.clear();this.TQe=null;this.Cm()}efe(Ob){this.TQe=Ob?Ob.id:null;this.Cm()}QIh(Ob){if(!Ob)return new ha.a;const Ub=new ha.a;for(const pb of Ob)Ub.add(this.PIh(pb));return Ub}PIh(Ob){const Ub=this.lcb.UGd(Ob);return{id:Ob.id,searchBeginIndex:Ub.Yde,searchEndIndex:Ub.Wde,searchResult:Ub.EFd}}pne(){}LWo(){var Ob=
{};this.mN.vgc(Ob);Ob=Ob[O.a.Value];this.rTe=aa.c(Ob)?"":Ob;this.Cm()}SOa(){return this.QP}NEb(){return this.fPe}nag(Ob){this.QP=Ob;this.Cm()}clearSearch(){}initialize(){this.Aud=window.performance.now();const Ob=this.Ub.ge(this.etb);Ob.parent=L.AFrame.rp;Ob.OH=!0;this.c_();this.u7(m.a.initial)}nP(){this.isVisible?(v.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),U.UISurfaces.zu().then(Ob=>{Ob.setSelectedTaskPane(this.etb,this.$Te);this.E9();this.Spd&&
this.Wlj(!0);return null}).catch(Ob=>{oc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Ob)})):(this.l8c(),this.Spd&&this.Wlj(!1))}Wlj(Ob){const Ub=this.GWg();Ub?this.QP=Ub:Ob&&this.QP||(this.QP="");this.mN.onSearchQueryChanged(this.QP)}Nna(){U.UISurfaces.zu().then(Ob=>{Ob.hideTaskPane(this.etb,this.$Te);return null}).catch(Ob=>{oc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Ob)})}c_(){this.R2.KNa();this.zZ=this.R2.M3b(this.Ub);this.qrk()}l8c(){U.UISurfaces.zu().then(Ob=>
{this.Aud=window.performance.now();Ob.showTaskPane(this.etb,this.eA());Ob=[Object.assign(new kb.a,{name:"Tab",string:this.NJa})];const Ub=window.performance.now()-this.Aud;da.a("NavigationPaneOpen",!0,Ub,Ob);return null}).catch(Ob=>{oc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Ob)})}Cm(){U.UISurfaces.zu().then(Ob=>{Ob.updateTaskPane(this.etb,this.eA());return null}).catch(Ob=>{oc.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],Ob)})}eA(){const Ob=
{activeTab:w.a.initial};this.cB.mob(Ob);return Object.assign(new W.a,{title:ib.LR,hideHeader:!1,width:320,location:this.$Te,contentProps:Ob,onOpen:()=>{this.Gs=!0;this.AVn();this.ESn();this.Spd&&this.E9();n.App.ya.updateCommandUI();n.App.ya.UYa(this.eFj)},onClose:()=>{try{const Ub=window.performance.now();this.Uca();this.Gs=!1;this.jPo();this.NPo();this.mN.wpn();this.rTe="";this.ECc=m.a.initial;n.App.ya.Zgc(this.eFj);n.App.ya.updateCommandUI();const pb=window.performance.now()-Ub;da.a("NavigationPaneClose",
!0,pb)}catch(Ub){oc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Ub)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0})}AVn(){this.Use&&!this.aMa&&ea.a.kl().then(()=>{this.aMa=new Ka(this.OBa);this.Te.lb(this.aMa,this.aMa.annotationType);this.Te.getAnnotationsByType(this.aMa.annotationType).then(Ob=>{this.aMa.y1c(Ob)})})}NPo(){this.Use&&this.aMa&&(this.Te.rc(this.aMa,this.aMa.annotationType),this.aMa=null)}NKo(){if(this.Vse){var Ob=new nb.ContractEntitySignal;
Ob=Object.assign(new Sa.a,{parentPath:["Signal",Pa.a.getTypeNameFor(Ob)],items:[Object.assign(new Ab.a,{body:Ob})]});this.rV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Gb.a,{operation:Ob}))}}ESn(){this.Vse&&!this.fVa&&ea.a.kl().then(()=>{this.fVa=new Ca(this.Cm);this.Te.lb(this.fVa,nb.ContractEntityAnnotation.getTypeName());this.NKo();this.Te.getAnnotationsByType(nb.ContractEntityAnnotation.getTypeName()).then(Ob=>{this.fVa.y1c(Ob)})})}jPo(){this.Vse&&this.fVa&&(this.Te.rc(this.fVa,
nb.ContractEntityAnnotation.getTypeName()),this.fVa=null)}qrk(){this.cB.lL(this.YUl());this.cB.lL(this.$Ul());this.cB.lL(this.xXl());this.cB.lL(this.vQl());this.cB.lL(this.rZl());this.cB.lL(this.zJl());this.cB.lL(this.onLinkExecute());this.cB.lL(this.onPivotTabExecute());this.cB.lL(this.Tam());this.cB.lL(this.Ldm());this.cB.lL(this.XYl());this.cB.lL(this.Cem());this.cB.lL(this.e9l())}Cem(){return Ob=>{Ob.autoDetectedHeadingsToggleDisabled=this.OBa?!this.OBa.pHk():!0}}Ldm(){return Ob=>{Ob.type=this.Pkk}}onLinkExecute(){return Ob=>
{Ob.onLinkExecute=()=>{this.mN.Hrn()}}}onPivotTabExecute(){return Ob=>{Ob.onPivotTabExecute=Ub=>{switch(Ub){case w.a.headings:this.Tqj();break;case w.a.replace:this.Crj();break;case w.a.contracts:this.rto();break;case w.a.intelligentPlaceholder:this.erj();break;default:this.Kqj()}aa.b(this.QP)&&(this.QP=this.GWg(),this.QP||(this.QP=""),aa.b(this.QP)||(this.mN.onSearchQueryChanged(this.QP),this.Cm()))}}}Tam(){return Ob=>{Ob.showOutOfSyncNotification=this.Vfh}}$Ul(){return Ob=>{Ob.findSearchBoxContent=
{onSearchQueryChanged:Ub=>{this.QP=Ub;this.Cm();this.mN.onSearchQueryChanged(Ub)},findOptions:this.Qsc,matchCase:this.D6,matchWholeWord:this.E6,findSearchText:this.QP,onClearButtonExecute:()=>{void 0!==this.QP&&null!==this.QP&&""!==this.QP&&(this.QP="",this.ib.setSelection(null),this.mN.ekn())},onMatchCaseExecute:()=>{this.Qsc.matchCase=!this.Qsc.matchCase;this.D6=!this.D6;this.Cm();this.mN.mtn()},onMatchWholeWordExecute:()=>{this.Qsc.matchWholeWord=!this.Qsc.matchWholeWord;this.E6=!this.E6;this.Cm();
this.mN.ntn()},onMenuClose:()=>{if(this.zZ)this.zZ.onMenuClose()},onMenuOpen:()=>{if(this.zZ)this.zZ.onMenuOpen()}}}}zJl(){return Ob=>{Ob.activeTab=this.mHd}}XYl(){return Ob=>{Ob.autoDetectedHeadingsToggleState=this.OBa?this.OBa.s2e:!1;this.gH.bLc=Ob.autoDetectedHeadingsToggleState;!Ob.autoDetectedHeadingsToggleState&&this.OBa&&this.OBa.rlc(!1)}}YUl(){return Ob=>{const Ub={onReplaceAllExecute:()=>{this.mN.stn()},onReplaceExecute:()=>{this.mN.qtn()},onReplaceQueryChanged:pb=>{this.fPe=pb;this.Cm()},
replaceSearchText:this.fPe};Ob.findReplaceContent={searchResults:this.Vra.toArray(),replaceSearchBoxContent:Ub,onNextSearchResultExecute:()=>{this.mN.otn()},onPrevSearchResultExecute:()=>{this.mN.ptn()},onSearchResultSelected:pb=>{const {FindReplaceUIManager:Zb}=c(1631);this.mN.hmn(pb);Zb.GJi(1)},selectedResultId:this.TQe,summaryLabel:this.rTe,explanationText:this.oUl(this.ECc),haveTooManySearchResults:this.ECc===m.a.tooManyResults}}}oUl(Ob){switch(Ob){case m.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;
case m.a.noMatchesFound:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case m.a.replaceAllComplete:return Fa.a.Gei();case m.a.tooManyResults:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;default:return""}}e9l(){return Ob=>{Ob.replaceFollowUpsWithCommentsIsEnabled=!0}}rZl(){return Ob=>{var Ub=this.sI.oKl();const pb=[];for(const Zb of Ub)Ub=this.sI.CNd(Zb.Kc,Zb.id),pb.push({id:Zb.id.toString(),intelligentPlaceholderAnchorText:Ub});Ob.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:pb,
onIntelligentPlaceholderInputExecute:Zb=>{this.QP=Zb;this.NJa=w.a.find;this.Cm();this.mN.onSearchQueryChanged(Zb)},onSearchResultSelected:Zb=>{this.Cm();Zb=e.a.If(Zb);this.sI.dao(Zb)}}}}xXl(){return Ob=>{let Ub=()=>{};this.OBa&&(Ub=Object(ua.a)(this.OBa,this.OBa.rlc,"toggleAutoDetectedHeadings"));Ob.headingsContent={onHeaderInputExecute:pb=>{this.QP=pb;this.NJa=w.a.find;this.Cm();da.a("NavigationPaneFind");this.mN.onSearchQueryChanged(pb)},renderHeadingContent:(pb,Zb,Wa)=>{this.Hb.Vb(new X.a(0,1,
100,()=>{var Lb=window.performance.now()-this.Aud;if(this.Yod){var qc=this.gH.i9;this.headingsReady=!0;this.Cm();Wa.style.display="none";qc.first&&(pb.style.display="block");this.Hb.Vb(new X.a(1,1,0,()=>{Mb.Vaf(this)}))}else this.Zjd=oa.Vaf(pb,Zb,Wa),this.Cm();qc=window.performance.now()-this.Aud;da.a("NavigationPaneHeadingsLoaded",!0,qc,[Object.assign(new kb.a,{name:"NavPaneReactHeadings",bool:this.Yod})]);Lb=[Object.assign(new kb.a,{name:"HeadingFetchStart",double:Lb}),Object.assign(new kb.a,{name:"HeadingFetchFinished",
double:qc})];da.a("NavigationPaneHeadingsLoadDetails",!0,void 0,Lb)}))},autoDetectedHeadingsToggle:Ub,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,headingsList:this.gH.i9,onHeadingChevronClick:pb=>{this.gH.Lwl(pb);this.Cm()},onClickHeading:pb=>{if(this.Hb.Fv){v.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",pb);const Zb=window.performance.now();this.Hb.Vb(new X.a(0,1,0,()=>{this.gH.onClickHeading(pb);
this.Cm();const Wa=window.performance.now()-Zb;da.a("NavigationPaneAsyncOnClickHeadingItem",!0,Wa)}))}else this.gH.onClickHeading(pb),this.Cm()},onClickBookmark:pb=>{if(this.Hb.Fv){v.ULS.sendTraceTag(512328289,312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",pb);const Zb=window.performance.now();this.Hb.Vb(new X.a(0,1,0,()=>{this.gH.onClickBookmark(pb);this.Cm();const Wa=window.performance.now()-Zb;da.a("NavigationPaneAsyncOnClickHeadingItem",!0,Wa)}))}else this.gH.onClickBookmark(pb),
this.Cm()},onShareHeadingClick:pb=>{this.gH.onShareHeadingClick(pb)},bookmarkIconUrl:Ma.a.ug("BookmarkDefault.png")}}}uQl(){var Ob,Ub=null===(Ob=this.fVa)||void 0===Ob?void 0:Ob.O6b();if(Ub){Ob=Array(Ub.length);let pb=0;for(const Zb of Ub)(Ub=Zb.content)&&(Ob[pb++]={id:Zb.id,type:Ub.type,value:Ub.value});return Ob}return null}vQl(){return Ob=>{Ob.contractsContent={onHeaderInputExecute:Ub=>{this.QP=Ub;this.NJa=w.a.find;this.Cm();da.a("NavigationPaneFind");this.mN.onSearchQueryChanged(Ub)},contractEntities:this.uQl(),
selectedEntityId:this.CPg.jeh,onEntitySelected:Ub=>{var pb;const Zb=null===(pb=this.fVa)||void 0===pb?void 0:pb.O6b();if(Zb)for(const Wa of Zb)if(Wa.id===Ub){this.CPg.U$n(Wa);break}this.Cm()}}}}llj(Ob){this.Spd=Ob}VUo(Ob){this.Hb.Vb(new X.a(0,1,0,()=>{this.gH.vmg(Ob)&&this.Cm()}))}Ukm(Ob){this.Hb.Vb(new X.a(0,1,0,()=>{const Ub=this.gH.LLb;this.gH.yil(Ob)?this.Cm():0===this.gH.LLb&&0<Ub&&this.Cm()}))}Flg(Ob,Ub){this.Hb.Vb(new X.a(0,1,0,()=>{const pb=this.gH.LLb;this.gH.Flg(Ob,Ub)?this.Cm():0<this.gH.LLb&&
0===pb&&this.Cm()}))}Qhl(Ob){this.Hb.Vb(new X.a(0,1,0,()=>{const Ub=this.gH.LLb;this.gH.Rhl(Ob)?this.Cm():0===this.gH.LLb&&0<Ub&&this.Cm()}))}$lo(Ob){this.gH.oIo(Ob);this.Cm()}emg(Ob){this.gH.emg(Ob)&&this.Cm()}kdf(Ob){this.gH.kdf(Ob)&&this.Cm()}RIn(){return 0<this.gH.LLb}E9(){this.Ub.mg(this.etb);v.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}Uca(){if(this.l3a()){var Ob;(Ob=sa.InteractiveViewManager.instance.Bd)?(Ob=Ob.$I,v.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):
(Ob=this.Ub.wT,v.ULS.sendTraceTag(40469192,312,50,"Taskpane now hidden with focus on default scope."));this.Ub.mg(Ob)}}l3a(){return!!this.Ub.currentScope&&this.Ub.currentScope.name===this.etb}static getInstance(){return oc.Rl()}static Rl(){return new oc(new db(a.AFrameworkApplication.va),Object(ua.a)(Eb.getInstance(),Eb.getInstance().getSelectedText,"getSelectedText"),xa.a.instance,I.a.instance,ia.a.instance,Object(ua.a)($a.instance,$a.instance.b3l,"getNextSearchResult"),y.a.instance.Na("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),
y.a.instance.Na("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),y.a.instance.Na("Box4.AugmentationLoop.IAnnotationStorage"),y.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),V.a.instance,y.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),new Ya)}static recordQosError(Ob,Ub,pb){const Zb=Object.assign(new bb.a,{extendedProperties:new Map});pb&&Zb.extendedProperties.set("exception",pb);Z.Health.instance.recordQosError(Ob,Ub,!1,!0,!1,!1,Zb)}}Object(E.a)(oc,
"ReactFindReplacePane",J,[418,419,9]);var xb=c(1564);c.d(M,"FindReplaceUIManager",function(){return cc});class cc{constructor(Ob,Ub,pb=null,Zb=null,Wa=null,Lb=null){this.xgd=this.p2=0;this.E6=this.D6=this.Qxb=!1;this.gm=this.E7g=this.Gja=null;this.uFa=this.gGe=!1;this.gj=Ob;this.Rp=pb;this.lcb=Zb;this.m4g=Wa;this.he=Lb;cc.M1b=new K}get CFf(){return this.gGe}set CFf(Ob){Ob!==this.gGe&&(this.gGe=Ob,this.lCh())}jhe(Ob){this.p2=Ob;this.update();this.p2||this.jG!==m.a.searchComplete&&this.jG!==m.a.tooManyResults?
0<this.p2&&this.jG===m.a.noMatchesFound?this.u7(m.a.searchComplete):this.p2>cc.Yyj&&this.jG!==m.a.tooManyResults&&(v.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.u7(m.a.tooManyResults)):this.u7(m.a.noMatchesFound)}Ffe(Ob){this.xgd=Ob;this.uFa&&this.update();this.m4g&&!this.m4g.value.t4c&&this.L$f()}reset(){}ekf(){this.he&&(this.gm=this.he.Zf("UserAction","Find"));if(this.uFa||!this.jG)this.uFa=!1,v.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.u7(m.a.searching)}a6b(){var Ob;
this.uFa=!0;let Ub=this.p2?m.a.searchComplete:m.a.noMatchesFound;if(this.jG!==m.a.tooManyResults&&z.FindManager.instance){const pb=z.FindManager.instance.Jj;0<pb.lja&&(pb.lja>cc.Yyj?Ub=m.a.tooManyResults:this.XVo(pb))}this.u7(Ub);this.update();this.gm&&(this.gm.stop(),this.gm=null);cc.Egj=e.a.create().toString();cc.GJi(0,this.b4b,this.SOa().length,this.p2);Object(xb.b)()&&(null===(Ob=this.gj)||void 0===Ob?0:Ob.isVisible)&&(Ob={},a.AFrameworkApplication.va.Qb(G.a.vbe,2,Ob),Ob[l.a.On]&&a.AFrameworkApplication.va.Qb(G.a.bXd,
2,{CommandValueId:{query:this.SOa(),matchCase:this.D6,matchWholeWordOnly:this.E6,totalResultLimit:-1}}))}XVo(Ob){const Ub=Ob.WDa;let pb=Ub;const Zb=[];do Zb[Zb.length]=pb,pb=Ob.i1a(pb);while(Ub!==pb);this.gj.mZe(Zb);this.Gja&&this.gj.efe(this.Gja)}update(){this.gj&&this.gj.LWo()}get jG(){return this.gj.jG}get b4b(){return this.gj.mHd}pob(Ob){this.CFf=Ob}lCh(){if(this.CFf)switch(this.jG){case m.a.searchComplete:case m.a.noMatchesFound:case m.a.tooManyResults:this.gj.e8c(!0)}else this.gj.e8c(!1)}u7(Ob){if(this.gj.isVisible){switch(Ob){case m.a.noMatchesFound:case m.a.searchComplete:this.jG===
m.a.tooManyResults&&(Ob=m.a.tooManyResults)}this.gj&&(this.gj.u7(Ob),this.lCh());this.update();this.L$f()}}uOa(Ob,Ub){const pb=this.uFa&&this.jG!==m.a.tooManyResults;switch(Ob){case 0:pb&&this.gj.mZe(Ub);break;case 1:pb&&this.gj.u$i(Ub);break;case 4:pb&&this.gj.wGj(Ub);break;case 2:this.gj.zDh();break;case 3:this.Gja=Ub[0],pb&&0<this.p2&&this.gj.efe(this.Gja)}}get matchCase(){return this.D6}set matchCase(Ob){this.D6!==Ob&&(this.D6=Ob,this.EEj())}get matchWholeWord(){return this.E6}set matchWholeWord(Ob){this.E6!==
Ob&&(this.E6=Ob,this.EEj())}EEj(){this.gj.pne()}SOa(){return this.gj.SOa()}NEb(){return this.gj.NEb()}nag(Ob){this.gj.nag(Ob)}clearSearch(){this.gj.clearSearch()}get Drj(){return 0<this.p2&&this.jG!==m.a.replaceAllInProgress&&this.jG!==m.a.replaceAllComplete}Tdo(Ob){let Ub="";Ob?Ub=0<this.p2?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.SOa(),this.NEb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.SOa(),this.NEb()):
Ob||0<this.p2&&(Ub=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.L$f(Ub)}dispose(){this.gj.dispose()}ePc(){return this.gj.ePc()}Hio(Ob,Ub=!0){Ob!==this.b4b&&(Ob===w.a.headings?(v.ULS.sendTraceTag(9056651,367,50,""),this.gj.Tqj()):Ob===w.a.find?this.gj.Kqj():Ob===w.a.replace?this.gj.Crj():Ob===w.a.intelligentPlaceholder&&(Ub||this.gj.llj(Ub),this.gj.erj()))}VB(Ob,Ub=!0){this.gj.llj(Ub);Ob?(this.Qxb||this.Rzf(),this.gj.nP(),this.p2||this.jG===m.a.noMatchesFound?a.AFrameworkApplication.K&&
a.AFrameworkApplication.K.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.gj.u7(m.a.searchComplete):this.u7(m.a.initial)):this.gj.Nna()}Rzf(){this.Qxb||(this.gj.initialize(),this.Qxb=!0)}L$f(Ob=""){var Ub=this.s9l();Ub&&(Ob=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Ob,Ub));this.lcb&&Ub&&this.Gja&&this.jG!==m.a.tooManyResults&&this.jG!==m.a.replaceAllInProgress&&(Ub=this.lcb.UGd(this.Gja),Ob=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
Ob,Ub.EFd));(Ub=this.nUl())&&(Ob=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Ob,Ub));this.Rp&&Ob&&this.E7g!==Ob&&(this.E7g=Ob,this.Rp.sendNotification(Ob,!0))}s9l(){let Ob="";switch(this.jG){case m.a.startSearch:Ob=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case m.a.searchComplete:Ob=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.xgd,this.p2);break;case m.a.tooManyResults:this.uFa&&(Ob=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,
this.xgd,this.p2));break;case m.a.noMatchesFound:Ob=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case m.a.replaceAllInProgress:Ob=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case m.a.replaceAllComplete:Ob=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return Ob}nUl(){let Ob="";switch(this.jG){case m.a.initial:Ob=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,
this.SUl());break;case m.a.noMatchesFound:Ob=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;case m.a.replaceAllComplete:Ob=Fa.a.Gei();break;case m.a.tooManyResults:Ob=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return Ob}SUl(){let Ob="";this.D6&&this.E6?Ob=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.D6?Ob=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,
WordEditorIntl.WordEditorStrings.l_MatchCase):this.E6&&(Ob=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return Ob}static getInstance(Ob){return cc.Rl(Ob)}static Rl(Ob){const Ub=oc.getInstance();return new cc(Ub,Ob,y.a.instance.resolve("Common.Utils.IAriaNotifier"),I.a.instance,new A.a(()=>z.FindManager.instance.NMb),n.App.ya.Fq)}static GJi(Ob,Ub=-1,pb=-1,Zb=-1){v.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:Ob,["SearchComplete.ResultsCount"]:Zb,
["SearchOpsCorrelation"]:cc.Egj,["ActionId"]:cc.M1b.actionId,["SourceControlId"]:cc.M1b.MHa,["IsNavPanOpenedAlready"]:cc.M1b.sMm,["IsSearchFromNavPane"]:cc.M1b.SPm,["CurrentTab"]:Ub,["QueryLength"]:pb})}static VOk(Ob,Ub,pb){Ub=void 0!==Ub&&null!==Ub?void 0===Ub.SourceControlId||null===Ub.SourceControlId?"Unknown":Ub.SourceControlId:Ob===F.a.Lob?"FindKeyboardShorcut":Ob===F.a.Nob?"ReplaceKeyboardShorcut":"Unknown";switch(Ob){case F.a.Cjc:Ob="ShowHeadingsPane";break;case F.a.Lob:Ob="ShowFindPane";break;
case F.a.Nob:Ob="ShowReplacePane";break;case F.a.Fjc:Ob="ShowIntelligentPlaceholderPane";break;case F.a.n7a:Ob="ToggleNavigationPane";break;default:Ob="Unknown"}cc.M1b=new K(Ob,Ub,pb,!0)}}cc.Yyj=100;cc.Egj=null;cc.M1b=null;Object(E.a)(cc,"FindReplaceUIManager",null,[383,275,9])},1632:function(E,M,c){c.r(M);E=c(0);var m=c(166),e=c(97),a=c(79),l=c(2),y=c(22),z=c(65),n=c(1080),v=c(131),A=c(9),w=c(7),G=c(16),F=c(272),I=c(467),K=c(1529),J=c(1801),N=c(26),R=c(331),O=c(11),L=c(443),U=c(17),W=c(263),X=c(46),
V=c(528),Z=c(1675);class da{constructor(Ya,Fa,$a,Db,gc,Eb,kb){this.q7g=this.Hah=this.JVg=this.rI=this.H8a=this.JRb=this.LAe=this.Fwe=this.nye=this.OV=this.lea=this.uea=null;this.dne=()=>{const bb=this.Nsa.r7b(this.rI),Gb=this.Nsa.eWl(this.rI);this.Fwe.innerText=bb.toString();this.LAe.innerText=Gb.toString();J.a.MNb(this.uea,1===bb?!1:!0);J.a.MNb(this.lea,bb===Gb?!1:!0)};this.hgo=()=>{const bb=this.Ub.getRegion(F.a.u0a);let Gb;if(this.OV&&!this.OV.disabled)Gb=this.OV;else if(this.uea.disabled){if(this.lea.disabled)return;
Gb=this.lea}else Gb=this.uea;Gb.focus();bb.Zj.Gy(Gb)};this.Epa=(bb,Gb)=>{(bb=Gb.nl.kb)&&this.OV&&J.a.MNb(this.OV,U.SelectionEditor.km(bb)?!0:!1)};this.p7e=()=>{if(!this.lea.disabled){const bb=this.Nsa.wjb(this.rI)?G.a.O4d:G.a.N4d;this.ga.processAction(bb,2)}return!0};this.q7e=()=>{if(!this.uea.disabled){const bb=this.Nsa.wjb(this.rI)?G.a.Q4d:G.a.P4d;this.ga.processAction(bb,2)}return!0};this.o7e=()=>{this.OV&&!this.OV.disabled&&this.ga.processAction(G.a.tEi,2);return!0};this.Ub=Ya;this.ga=Db;this.hg=
gc;this.ae=Eb;this.ib=kb;this.Nsa=$a;this.E7=document.createElement("div");this.E7.classList.add("FootnoteEndnoteActionBarControl");this.E7.style.zIndex=String(W.a.yJd);this.E7.style.position="relative";this.Irc=document.createElement("div");this.Irc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.E7.appendChild(this.Irc);this.d7k();this.E7.appendChild(this.JRb);this.E7.appendChild(this.H8a);this.sZ=e.KeyInputManager.kc(a.a.t1,0);this.nxm();this.mxm()}cga(Ya){w.ULS.shipAssertTag(4520065,
308,this.Nsa.koa(Ya));if(this.rI!==Ya){this.rI=Ya;this.dne();Ya=this.Nsa.wjb(this.rI);this.x9k(Ya);this.rI.Vph(this.dne);let Fa="",$a="";const Db=this.Nsa.r7b(this.rI);-1!==Db&&(Fa=(Db-1).toString(),$a=(Db+1).toString());Ya?(this.lea.title=this.lea.disabled?WordEditorIntl.WordEditorStrings.L_NextFootnote:String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,$a),this.uea.title=this.uea.disabled?WordEditorIntl.WordEditorStrings.L_PrevFootnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,
Fa)):(this.lea.title=this.lea.disabled?WordEditorIntl.WordEditorStrings.L_NextEndnote:String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,$a),this.uea.title=this.uea.disabled?WordEditorIntl.WordEditorStrings.L_PrevEndnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,Fa));this.XGa()}}TBb(){this.rI&&(this.OV&&this.OV.parentNode===this.JRb&&this.JRb.removeChild(this.OV),this.tja(),this.rI.g_n(this.dne),this.rI=null)}dispose(){this.Ub.ge(F.a.u0a).ir(this.sZ)}x9k(Ya){3===
this.ga.mode&&(Ya=Ya?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.OV=this.x$e("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",Ya,null),N.a.gr(this.OV,N.a.dfa,Ya),this.JRb.appendChild(this.OV))}d7k(){this.JRb=document.createElement("div");this.JRb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.H8a=document.createElement("div");this.H8a.classList.add("FootnoteEndnoteActionBarButtonHolder",
"FootnoteEndnoteActionBarRightDiv");this.uea=this.x$e("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.H8a.appendChild(this.uea);this.Fwe=L.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");this.H8a.appendChild(this.Fwe);this.nye=L.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.nye.innerText=" / ";this.H8a.appendChild(this.nye);this.LAe=L.b("span","FootnoteEndnoteActionBarTotalCount",
"FootnoteEndnoteActionBar");this.H8a.appendChild(this.LAe);this.lea=this.x$e("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.H8a.appendChild(this.lea)}x$e(Ya,Fa,$a,Db){Ya=J.a.i_a(Ya,Fa,$a,Db,void 0===Db||null===Db);Ya.setAttribute(N.a.qh,N.a.e3);return Ya}nxm(){const Ya=this.Ub.ge(F.a.u0a);Ya.parent=v.AppFrame.rp;Ya.bindAction(this.sZ,G.a.y3);Ya.Uea(this.hgo)}mxm(){var Ya=new R.DOMFocusListing(()=>this.E7);Ya.Mpa=!1;Ya.Wm(2);Ya.Wm(1);Ya=this.Ub.Ozb(this.E7,
this.Ub.ge(F.a.u0a),Ya);Ya.mSa();Ya.jR=!0}XGa(){this.OV&&(this.hg.lb(O.a.click,this.OV,this.o7e),this.JVg=this.ae.lnb(this.OV,this.o7e,a.a.zs));this.hg.lb(O.a.click,this.uea,this.q7e);this.Hah=this.ae.lnb(this.uea,this.q7e,a.a.zs);this.hg.lb(O.a.click,this.lea,this.p7e);this.q7g=this.ae.lnb(this.lea,this.p7e,a.a.zs);this.ib.Lw(this.Epa)}tja(){this.OV&&(this.hg.rc(O.a.click,this.OV,this.o7e),this.ae.$pb(this.OV,this.JVg));this.hg.rc(O.a.click,this.uea,this.q7e);this.ae.$pb(this.uea,this.Hah);this.hg.rc(O.a.click,
this.lea,this.p7e);this.ae.$pb(this.lea,this.q7g);this.ib.CY(this.Epa)}static $Vl(){return da.aWl()}static aWl(){return new da(z.FocusManager.instance(),Z.a.instance,V.a.instance,l.AFrameworkApplication.va,A.App.ya.fD,A.App.ya.gD,X.a.instance)}}Object(E.a)(da,"FootnoteEndnoteActionBarControl",null,[412]);var aa=c(230),ea=c(13),na=c(1582),pa=c(1763);class ja{constructor(Ya,Fa,$a,Db,gc,Eb,kb,bb,Gb,Sa,Pa,Ab){this.uE=null;this.xS=!1;this.Qv=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.zXb=
Ya;this.$4b=Fa;this.Znc=$a;this.nck=Db;this.qLe=gc;this.em=Eb;this.R$a=kb;this.hg=bb;this.p$g=Gb;this.e0j=Pa;this.Cr=this.zXb.ownerDocument.createElement("div");this.Cr.id="FootnoteEndnoteControlOverlay";this.Cr.className="EditingSurfaceOverlay";this.jI=this.wQl();this.Q0(!1);this.zXb.appendChild(this.Cr);this.zXb.appendChild(this.jI);this.$4b.bind();this.fi=null;this.ga=Ab;this.sKa=Sa}W3n(){const Ya=this.p$g();Ya&&Ya.Vi&&(Ya.Onb=0,Ya.Pzd())}DDj(Ya){if(this.CEc){const Fa=this.CEc.cna;Fa&&(Fa.mDf=
Ya)}}get Xw(){return this.xS}get CEc(){return this.uE}get dialog(){return this.fi}get xo(){return null!=this.bAg?this.bAg:this.bAg=y.a.instance.Sa("Common.IZoomManager")}caf(){this.fi=pa.a.iWl()}M4c(){this.fi=null}show(Ya=!0){this.xS||(this.DDj(!0),this.e0j(),this.Q0(!0),this.wz(),Ya&&this.setFocus())}setFocus(){this.xS&&(this.$4b.setInitialSelection(),this.nck())}update(){this.xS&&(this.uE.isConnected?this.Znc.dne():this.dismiss())}dismiss(Ya=!1,Fa=!1){this.xS&&(this.DDj(!1),this.X9(),this.W3n(),
this.Q0(!1),this.qLe(Fa),this.fi&&(this.ga.processAction(ea.a.gJc,2),this.fi=null),!Ya&&this.uE&&this.uE.isConnected&&this.sKa.cao(this.uE),this.TBb())}G2n(Ya){const Fa=null!==this.xo.instance?this.xo.instance.ij:1;this.jI.style.width=Ya.tHh*Fa+"px";this.Qv.style.width=Ya.lHc*Fa+"px";this.jI.style.marginLeft=Ya.X2b*Fa+"px";this.em?this.Qv.style.marginRight=Ya.F9e*Fa+"px":this.Qv.style.marginLeft=Ya.g3b*Fa+"px";if(Ya=this.p$g())Ya=Ya.mL,this.jI.style.bottom=Ya.offsetHeight-Ya.clientHeight+"px"}cga(Ya){w.ULS.shipAssertTag(4520073,
308,this.R$a.koa(Ya));this.uE!==Ya&&(this.uE=Ya,this.$4b.cga(Ya),this.Znc.cga(this.uE))}dispose(){this.dismiss();this.$4b.dispose();this.Znc.dispose()}wz(){this.hg&&this.hg.lb(O.a.click,this.Cr,this.onClick)}X9(){this.hg&&this.hg.rc(O.a.click,this.Cr,this.onClick)}wQl(){let Ya;Ya=document.createElement("div");Ya.classList.add("FootnoteEndnoteControl");this.Qv=document.createElement("div");this.Qv.classList.add("FootnoteEndnoteContent");this.Qv.appendChild(this.$4b.E7);this.Qv.appendChild(this.Znc.E7);
Ya.appendChild(this.Qv);return Ya}Q0(Ya){Ya=(this.xS=Ya)?"":"none";this.Cr.style.display=Ya;this.jI.style.display=Ya}TBb(){this.uE&&(this.$4b.TBb(),this.Znc.TBb(),this.uE=null)}static QQd(){const Ya=A.App.ya.gb.wc;return Ya&&Ya.Vi?Ya:null}static dWl(Ya,Fa,$a,Db,gc){return new ja(Ya,Fa,$a,Db,gc,l.AFrameworkApplication.isRtl,V.a.instance,aa.a.instance,ja.QQd,na.a.instance,ja.dnl,l.AFrameworkApplication.va)}static dnl(){l.AFrameworkApplication.va.Qb(ea.a.sib,2,!0)}}Object(E.a)(ja,"FootnoteEndnoteControl",
null,[411]);var ma=c(809),Ia=c(5),Ja=c(204),Ka=c(36),Ma=c(8),sa=c(23),xa=c(78),ia=c(1674),ha=c(348),ua=c(969),ya=c(576),ra=c(1442),La=c(61),oa=c(110);class Ca extends ha.a{constructor(Ya,Fa,$a,Db,gc,Eb,kb,bb,Gb,Sa,Pa,Ab,nb,Rb,Mb,oc,xb){super(F.a.lga,$a,Db,gc,kb,bb,Gb,Sa,Pa,Ab,nb,Rb,Mb,oc,xb);this.FPg=Ya;this.HXa=Eb;this.HXa.L9c=this;Fa(this);this.features.Ygg=!0}get Ewi(){return!0}uvf(){const Ya=this.FPg.nmf(this);return ua.ViewReference.eF(this,Ya)}Qef(Ya){Object(oa.a)(Ca,Ya)||this.FPg.Nef()}jPc(){return ya.a.PNi}onResize(){super.onResize();
this.HXa.kWh()}LE(Ya,Fa=null){super.LE(Ya,Fa);this.HXa.XVh(this.ed.hj)}detach(){this.HXa.jWh();super.detach()}YMd(){this.onResize()}static g_a(){const {FootnoteEndnoteControlManager:Ya}=c(1632);return new Ca(Ya.instance,ra.a.U8e,A.App.ya.gb,La.InteractiveViewManager.instance,()=>y.a.instance.resolve("Box4.IUndoManager"),y.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),l.AFrameworkApplication.va,y.a.instance.resolve("Box4.IHtmlViewRootFactory"),y.a.instance.resolve("Box4.IInteractiveEventNotifier"),
y.a.instance.Sa("Box4.ITextMetricsAdapter"),y.a.instance.resolve("Box4.IRotatingCoordinateConverter"),y.a.instance.Sa("Common.IZoomManager"),y.a.instance.Na("Box4.IContentControlViewElementManager"),y.a.instance.Na("Box4.CpConversionManagerImpl"),y.a.instance.Na("Box4.ContentControlConfigSettings"),y.a.instance.Na("Box4.IContentControlReader"),y.a.instance.Na("Box4.IContentControlBoundaryNavigator"))}}Object(E.a)(Ca,"FootnoteEndnoteEditView",ha.a,[]);class Aa{constructor(Ya,Fa,$a,Db=!1){this.ktb=
null;this.XEe=this.AMg=!1;this.BFl=()=>{const gc=String.format("{0} {1}",this.XEe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.su.sendNotification(gc,!0)};this.Ub=Ya;this.Nsa=Fa;this.Wda=$a();this.qld=Db;this.E7=document.createElement("div");this.E7.classList.add("FootnoteEndnoteEditControl");this.Irc=
document.createElement("div");this.Irc.classList.add("FootnoteEndnoteEditControlDividerElement");this.syb=(new ma.a(this.E7,"WACViewPanel_FootnoteEndnoteEditControl")).dI;this.E7.appendChild(this.Irc);this.E7.appendChild(this.syb)}get su(){return null!=this.Lvg?this.Lvg:this.Lvg=y.a.instance.resolve("Common.Utils.IAriaNotifier")}cga(Ya){w.ULS.shipAssertTag(4520077,308,this.Nsa.koa(Ya));this.ktb!==Ya&&(this.ktb=Ya,this.i2e(this.ktb),this.XEe=this.Nsa.wjb(this.ktb),this.qld?(this.Wda.PNb(N.a.RAd),this.Ub.ge(F.a.lga).d7(this.BFl)):
this.Wda.Sjj(this.XEe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,N.a.RAd))}TBb(){const Ya=V.a.instance.wjb(this.ktb)?"Footnote":"Endnote";w.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:Ya,["CalloutHeight"]:this.E7.scrollHeight});this.Dfb();this.ktb=null}bind(){this.AMg||(this.Wda.Bzb(this.syb),this.AMg=!0)}setInitialSelection(){const Ya=this.aam();Ya?this.Wda.setSelection(Ya):this.Wda.b7c()}dispose(){this.Dfb()}i2e(Ya){this.Dfb();
this.Wda.LE(Ya,Ya.hj)}Dfb(){this.Wda.detach()}aam(){let Ya=0;var Fa=null,$a=Ia.GraphIterator.$a(this.ktb);Ja.OutlineNavigator.T8($a);if(($a=Ka.OutlineElementNavigator.Ge($a))&&Ma.ParagraphReader.Wb($a)){if(Fa=Aa.a_l($a)){Ya=Fa.Ib.cp+1;Fa=ia.FootnoteEndnoteDefaultContentInserter.jPh;const Db=Fa.length;Ya+Db<=Ma.ParagraphReader.textLength($a)&&$a.characterData.substr(Ya,Db)===Fa&&(Ya+=Db)}Fa=sa.SelectionFactory.te($a,Ya)}return Fa}static fWl(){return Aa.gWl()}static gWl(){return new Aa(z.FocusManager.instance(),
V.a.instance,()=>Ca.g_a(),l.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static a_l(Ya){Ya=xa.i(Ya,10);return 0<Ya.length?Ya[Ya.length-1]:null}}Object(E.a)(Aa,"FootnoteEndnoteEditControl",null,[410]);var db=c(1171);class eb{constructor(Ya,Fa){this.jBa=Ya;this.em=Fa}r8b(Ya,Fa){Ya=this.jBa.r8b(Ya);var $a=Fa.clientWidth;const Db=Fa.scrollLeft,gc=Ya.tHh;let Eb=Ya.X2b,kb=Ya.X2b,bb=eb.bNf,Gb=eb.cNf,Sa=gc,Pa=Ya.lHc;this.em?Gb=Ya.F9e-kb:bb=Ya.g3b-Eb;$a<gc&&(Eb=Math.max(Eb-
Db,0),Sa=$a-Eb,this.em?($a=Fa.scrollWidth-Db-$a,kb=Fa.scrollWidth-Ya.X2b-gc,Gb=Math.max(Ya.F9e-$a-kb,eb.cNf),Pa=Sa-Gb-eb.bNf):(bb=Math.max(Ya.g3b-Db-Eb,eb.bNf),Pa=Sa-bb-eb.cNf));return new db.a(Eb,Sa,bb,Gb,Pa)}}eb.bNf=25;eb.cNf=50;Object(E.a)(eb,"FootnoteEndnoteViewPositionProvider",null,[]);class ib{constructor(Ya,Fa=0,$a=0){this.clientWidth=Ya;this.scrollLeft=Fa;this.scrollWidth=$a?$a:Ya}}Object(E.a)(ib,"PageViewScrollContainerSizeInfo",null,[]);c.d(M,"FootnoteEndnoteControlManager",function(){return lb});
class lb{constructor(Ya,Fa,$a,Db,gc,Eb,kb,bb){this.qE=null;this.E9=()=>{this.$o.CI(F.a.lga);this.$o.CI(F.a.u0a);this.$o.Rw(m.AFrame.Pn);this.Ub.aDc(F.a.lga);this.Ub.mg(F.a.lga)};this.pgo=Gb=>{this.$o.Rw(F.a.lga);this.$o.Rw(F.a.u0a);this.$o.CI(m.AFrame.Pn);this.Ub.GIc(F.a.lga);(Gb||this.Ub.currentScope&&(this.Ub.currentScope.name===F.a.lga||this.Ub.currentScope.name===F.a.u0a))&&this.Ub.mg(m.AFrame.Pn)};this.Ub=Ya;this.$o=Fa;this.k3j=$a;this.l3j=Db;this.j3j=gc;this.jBa=Eb;this.Yra=kb;this.CZ=bb;this.sZ=
e.KeyInputManager.kc(a.a.t1,0);this.Kzf();this.dT()}get control(){return this.qE}get dialog(){return this.control.dialog}get Qui(){return this.control.Xw}caf(){this.control.caf()}M4c(){this.control.M4c()}bind(Ya){this.T2k(Ya)}Pdg(Ya){if(this.control.CEc!==Ya.$Za)this.control.dismiss();else if(this.Qui)return;this.E4b();this.control.cga(Ya.$Za);this.control.show(Ya.Ahe)}E4b(){if(this.CZ){const Ya=new n.a(!0);this.CZ.SGa(Ya)}}FY(){this.control.setFocus()}Aad(){this.control.update()}Nef(Ya,Fa=!1){this.E4b();
this.control.dismiss(Ya,Fa)}E2n(Ya){const Fa=lb.QQd().mL;Ya=this.jBa.r8b(Ya,new ib(Fa.clientWidth,Fa.scrollLeft,Fa.scrollWidth));this.control.G2n(Ya)}dispose(){this.control.dispose();this.Ub.ge(F.a.lga).ir(this.sZ)}nmf(Ya){w.ULS.shipAssertTag(4520074,308,!!this.control);w.ULS.shipAssertTag(4520075,308,!!this.control.CEc);return this.omf(this.control.CEc.id,Ya)}T2k(Ya){const Fa=this.l3j(),$a=this.j3j();this.qE=this.k3j(Ya,Fa,$a,this.E9,this.pgo)}Kzf(){const Ya=this.Ub.ge(F.a.lga);Ya.parent=3===l.AFrameworkApplication.va.mode?
v.AppFrame.$E:v.AppFrame.Igc;this.Ub.CYe(F.a.lga);Ya.bindAction(this.sZ,G.a.y3)}dT(){this.$o.dT(F.a.lga);this.$o.dT(F.a.u0a)}omf(Ya,Fa){return()=>{const $a=lb.QQd().ed.Kc.Db(Ya);this.Yra.y5b();if(!$a.isConnected)return w.ULS.sendTraceTag(4520076,308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.Pdg(new I.a($a,!0));return Fa}}static Rl(){const Ya=new eb(y.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),l.AFrameworkApplication.isRtl);return new lb(z.FocusManager.instance(),
A.App.ya.jx,ja.dWl,Aa.fWl,da.$Vl,Ya,K.a.instance,y.a.instance.resolve("Box4.IPasteFloatieEventSource"),y.a.instance.resolve("Common.IAppSettingsManager"))}static QQd(){const Ya=A.App.ya.gb.wc;return Ya&&Ya.Vi?Ya:null}static get instance(){return null!=lb.fCg?lb.fCg:lb.fCg=lb.Rl()}}Object(E.a)(lb,"FootnoteEndnoteControlManager",null,[354])},1652:function(E,M,c){c.d(M,"a",function(){return A});E=c(0);var m=c(7),e=c(55),a=c(166),l=c(2),y=c(11),z=c(161),n=c(127),v=c(22);class A{constructor(w,G){this.Jt=
null;this.osd=!1;this.cbb=0;this.V2g="";this.iue={};this.VJe=w;this.Ub=G;this.M8g=Object(e.a)(this,this.HUf,"onModalMouseWheel");this.Q1g=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.zoa;this.Fw=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.pJ}onMenuOpen(){0<this.cbb?this.cbb++:(this.cbb++,l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(e.a)(this,
this.Q3i,"pushTransientFocusScope"),0)}):this.Q3i(),this.showModal())}Q3i(){this.Ub&&this.Ub.kL(a.AFrame.Ipa,!0)}oNl(){const w=n.f(),G=appChrome.selectors.getShyState();return String.format("{0}{1}",w,this.Q1g&&G.isActive&&1===G.state?"_ShyRibbon":"")}Pem(w){var G=0;if(this.Fw){if(this.iue[w])return this.iue[w];(G=document.getElementById("BusinessBar"))||m.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");G=G?G.offsetTop:0;this.iue[w]=
G}return G}showModal(){if(!this.Jt)if(this.Jt=this.createElement("div"),this.Jt.setAttribute("id","ReactModalDiv"),this.Jt.style.position="absolute",this.Jt.style.bottom="0px",this.Jt.style.left="0px",this.Jt.style.right="0px",this.Jt.style.backgroundColor="white",this.Jt.style.opacity="0.0",this.Fw){var w=document.getElementById("regionComposerRoot");w&&w.appendChild(this.Jt)}else this.VJe.appendChild(this.Jt);w=this.oNl();if(w!==this.V2g){const G=this.Pem(w),F=appChrome.selectors.getShyState();
this.Q1g&&F.isActive&&1===F.state&&n.a("getRibbonHeight")?this.Jt.style.top=String.format("{0}px",G+appChrome.api.getRibbonHeight(n.f())):this.Jt.style.top=String.format("{0}px",G);this.V2g=w}this.Jt.style.display="block";this.Jt.style.visibility="visible";this.Jt.style.zIndex="1000";this.osd||(window.addEventListener("wheel",this.M8g,!0),this.kZd()?z.a.instance.lb(y.a.QM,this.Jt,Object(e.a)(this,this.f7d,"onModalPointerUp")):z.a.instance.lb(y.a.pointerDown,this.Jt,Object(e.a)(this,this.e7d,"onModalPointerDown")),
this.osd=!0)}onMenuClose(){this.cbb--;0<this.cbb||(0>this.cbb?this.cbb=0:this.hni())}XSf(){this.cbb=0;this.vJc();this.hni()}createElement(w){w=document.createElement(w);w.setAttribute("unselectable","on");return w}gni(){this.Ub&&this.Ub.currentScope&&this.Ub.currentScope.name===a.AFrame.Ipa&&!l.AFrameworkApplication.nc.Fv&&this.Ub.yR(a.AFrame.Ipa,!1);this.Jt&&(this.Jt.style.zIndex="-1",this.Jt.style.visibility="hidden",this.Jt.style.display="none");this.osd&&(window.removeEventListener("wheel",this.M8g,
!0),this.kZd()?z.a.instance.rc(y.a.QM,this.Jt,Object(e.a)(this,this.f7d,"onModalPointerUp")):z.a.instance.rc(y.a.pointerDown,this.Jt,Object(e.a)(this,this.e7d,"onModalPointerDown")),this.osd=!1)}hni(){this.kZd()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.gni()},0)}):this.gni()}e7d(){this.D4b();this.ORh();this.XSf();this.m6a();return!0}f7d(){this.D4b();this.ORh();this.XSf();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.m6a()},0)});return!0}m6a(){4===l.AFrameworkApplication.ta.Nb.Sl&&
l.AFrameworkApplication.K.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?l.AFrameworkApplication.ta.m6a():this.Ub.mg(a.AFrame.Pn)}HUf(w){w.stopPropagation()}D4b(){const w=v.a.instance.Na("Common.IReactContextualUILauncher");w&&w.D4b()}vJc(){const w=v.a.instance.Na("Common.IReactContextualUILauncher");w&&w.vJc()}ORh(){l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.nQa&&(this.kZd()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}kZd(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(E.a)(A,"ReactModalDiv",null,[])},1657:function(E,M,c){c.d(M,"a",function(){return e});c.d(M,"b",function(){return a});c.d(M,"c",function(){return l});var m=c(2);const e=(y,z)=>{const n=RegExp("mailto:(.*)").exec(y.url);z.email=n&&2===n.length?n[1]:y.url;z.resolveState=y.Xv.charAt(35)===c(1751).ACommentFormatTranslator.tGk?1:0},a=(y,z)=>{z.contentId=y.Xv},l=(y,z,n)=>{z.contentId=y.Xv;z.isCurrentUser=n.email===m.AFrameworkApplication.K.jb("UserPrincipalName")}},1658:function(E,M,c){c.d(M,
"a",function(){return a});E=c(0);var m=c(1035),e=c(6);class a{constructor(l,y){this.tN=this.Hxc=null;this.eb=l;this.w9a=y}get key(){return"COMMENT"}get Pw(){return WordEditorIntl.WordEditorStrings.L_Comment}get u3(){return this.tN}reset(l){this.tN=l.node}rIa(l){let y=null;if(this.Hxc&&this.Wui(l,this.u3,this.Hxc))return y=Object.assign(new m.a,{KG:this.key,contentObject:this.Hxc}),{returnValue:!0,RF:y};this.Hxc=null;const z=this.w9a.waf(this.u3);if(this.w9a.RBf(z)){let n=z.Qd();for(;n;){if(this.Wui(l,
this.u3,n))return this.Hxc=n,y=Object.assign(new m.a,{KG:this.key,contentObject:n,description:this.lhb()}),{returnValue:!0,RF:y};n=z.Rj()}}return{returnValue:!1,RF:y}}Wui(l,y,z){if(this.Spj(z))return!1;const n=this.w9a.v8b(z,!0),v=this.w9a.v8b(z,!1);return n&&v&&this.eb.RUc(y,n,v)&&(y=this.w9a.xva(n,z.id,!0))&&(n!==this.u3||y.Ib.cp<=l)&&(z=this.w9a.xva(v,z.id,!1))&&(v!==this.u3||z.Ib.cp>l||z.Ib.cp>=l)?!0:!1}Spj(l){return l.ia(e.a.CG,!1)}lhb(){return null}}Object(E.a)(a,"CommentDetailsProvider",null,
[416,417])},1664:function(E,M,c){c.d(M,"a",function(){return e});E=c(0);M=c(153);var m=c(100);class e extends M.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new m.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(E.a)(e,"DocumentTypeClassifierAnnotation",M.a,[])},1668:function(E,M,c){c.d(M,"a",function(){return A});
E=c(0);var m=c(2),e=c(353),a=c(83),l=c(7),y=c(55),z=c(84),n=c(60),v=c(339);class A{constructor(w,G,F,I,K,J){this.VMe=null;this.Aah=0;this.J2=!1;this.qd=I;this.Se=G;this.U5=K;this.TCe=F;this.Gpc=m.AFrameworkApplication.Cdg();this.Vue=w.appSettings.ChromeClipboardAccessOperationTimeout;this.nI=0;this.cYj=J;this.v1j=w.$("EnableExternalPasteSupportOnMobileIsEnabled");this.$h=e.a.getInstance(v.a.AZa);this.J2=w.$("ShouldLogCcpExtendedHealthKpis")}get NRa(){return this.U5.NRa}process(w,G){if(!this.nI)return this.wzn(G);
if(1===this.nI)return this.prepareForPaste(w,G);if(2===this.nI)return this.nI=3,this.VMe(w,G);3===this.nI&&this.U5.$lj(w,G);return!1}wzn(w){let G=!0;this.v1j&&(G=!(w.ux&1));this.Se.h4&&G||w.ux&512?(this.VMe=w.ux&2?Object(y.a)(this.U5,this.U5.paste,"paste"):Object(y.a)(this.U5,this.U5.y_i,"pasteInternal"),this.nI=2):(this.Gpc?(this.nI=1,this.Aah=Date.now()):this.nI=2,this.VMe=Object(y.a)(this.U5,this.U5.paste,"paste"));v.a.V3m(w);return!0}prepareForPaste(w,G){w=!0;if(this.TCe.value.J1i())this.nI=2;
else{const F=Date.now()-this.Aah;F>this.Vue&&(l.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",F),this.qd.Yb(z.a.Xma,{["Reason"]:n.a.jYi}),G.tR&&(G.tR.fail("Prepare for paste timed out",!1),this.J2?this.$h.logKpiFailure({kpiName:v.a.iNa,errorName:"PreparePasteTimedOut",optionalVeto:{name:v.a.Jmb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):a.Health.instance.recordQosError("PreparePasteTimedOut",[v.a.Jmb],!1,!0,!0,!1,null)),G.failed=!0,w=!1,this.cYj.l4n())}return w}}
Object(E.a)(A,"ClipboardOperationPasteProcessor",null,[475])},1669:function(E,M,c){c.d(M,"a",function(){return X});E=c(0);M=c(293);var m=c(353),e=c(83),a=c(2),l=c(44),y=c(145),z=c(7),n=c(110),v=c(73),A=c(1428),w=c(55),G=c(86),F=c(3),I=c(84),K=c(60),J=c(1082),N=c(17),R=c(46),O=c(1600),L=c(1670),U=c(339),W=c(119);class X extends M.a{constructor(V,Z,da,aa,ea,na,pa,ja,ma,Ia,Ja,Ka,Ma,sa,xa,ia,ha,ua,ya,ra,La,oa,Ca,Aa,db,eb,ib,lb=!0){super();this.Qja=this.Iw=null;this.BL=this.Sz=0;this.Jcb=this.UQe=this.O$=
this.mh=null;this.x6=!1;this.MS=!0;this.sXg=!1;this.init(V);this.Al("ClipboardOperation");this.Oib(ma,Z,ea,na,pa);this.qd=Ia;this.Ie=Ja;this.Se=Ka;this.Hc=Ma;this.xOg=sa;this.zOg=xa;this.yOg=ia;this.hve=ha;this.TSb=ua;this.ive=ya;this.Gpc=ja;this.tpc=ra;this.mMa=La;this.Tmk=lb;this.xD=oa;this.Ud=Ca;this.Jm=Aa;this.CZ=db;this._context=aa;this.Jea=eb;this.ZYb=ib;this.$h=m.a.getInstance(U.a.AZa);pa&&Object(n.a)(138,pa)&&(this.O$=Object(v.a)(485,pa.ia(y.a.bua,null)));this.O$||(this.O$=this.Jea.W8c());
this.Vqb=void 0===da||null===da?"NotAvailable":Object(A.a)(L.a,da);this.O$.oCk(this.Vqb.split(", "));V=this._context;if(this.ZYb){if(!X.qAh(V,this.hve,this.qd,this.O$,lb)){this.mr=8;this.finish();return}this.mh=V.view;this.x6=3===this.mh.jIb;this.Sz=0;this.BL=da;this.Jcb=ha.NRa}else{if(!V.view.qe){this.qd.Yb(I.a.kf,{["Reason"]:K.a.MJb});this.O$.fail("Not in interactive view",!0);this.mr=8;this.finish();return}this.mh=V.view;if(!this.mh.mb){this.qd.Yb(I.a.kf,{["Reason"]:K.a.noSelection});this.O$.fail("No selection manager",
!0);this.mr=8;this.finish();return}this.x6=3===this.mh.jIb;this.Sz=0;this.BL=da;this.Jcb=ha.NRa;if(lb&&!(this.Jcb&&this.Jcb.kb&&this.Jcb.length)){this.qd.Yb(I.a.kf,{["Reason"]:K.a.noSelection});this.O$.fail("No selection when one required",!0);this.mr=8;this.finish();return}}ha=N.SelectionEditor.km(this.Jcb.kb);ha=!(this.BL&16&&ha);ha=ya.uFm(da,this.sg)&&ha;1!==this.behavior&&ha||(ha||this.O$.fail("Clipboard operation disabled for selection",!0),this.mr=ha?32:8,this.gqa());!this.sXg&&this.Se.ti&&
(l.b("IPadCCP"),this.sXg=!0)}get sg(){this.UQe||(this.UQe=R.a.G1b(this.Jcb));return this.UQe}Gca(){super.Gca();this.Jcb=null}run(){this.Sz||this.setup();1===this.Sz&&this.process();2===this.Sz&&this.teardownSync();3===this.Sz&&this.teardownAsync();4===this.Sz&&this.finish()}setup(){if(this.BL&256&&this.Gpc){this.sC||this.TSb.tVk(this,this.BL,this.Vqb);this.sC.run();if(this.sC.inProgress)return;this.MS=this.sC.kpa;this.ADd();if(!this.MS){this.O$.fail("No access to system clipboard",!0);this.mr=8;this.Sz=
4;this.r2d();return}}else z.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.BL,this.Vqb,this.Se.bG,this.actionId);this.BL&32&&!this.Ie.bYd(this.mh.mb.sg)?(z.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.qd.Yb(I.a.kf,{["Reason"]:K.a.ocf}),this.O$.fail("Cut not allowed",!0),this.tpc.show(),this.mr=8,this.Sz=4):(this.BL&16||this.BL&32)&&G.a.instance.J(1)&&this.xD.d_d(this.mh.mb.hb.kb)?(this.O$.fail("Selected content deleted in coauthoring",!0),this.Ud.OOb(),
this.mr=8,this.Sz=4):(this.BL&4096&&(this.CZ.Egc(Object.assign(new J.a,{RTc:!0,yY:this.Vqb})),this.Jm.undo()),this.ive.dEn(this.BL),this.mh.ed?(this.Iw=this.Hc.Mc(15),this.Iw.fk=this.actionId,this.Iw.Cb(this.mh.ed),this.Sz=1):(this.O$.fail("Interactive view has null target node",!0),this.mr=8,this.Sz=4))}process(){if(!this.sC){z.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.BL,this.Vqb,this.Se.bG);z.ULS.shipAssertTag(6305507,307,!this.Qja);this.Qja=new O.a(this._context,
this.BL,this.O$,this.x9,this.AL,void 0,this.Se.bG,this.Tmk,this.x6);let V;V=this.BL&65536?Object(w.a)(this.xOg,this.xOg.process,"process"):this.BL&64?Object(w.a)(this.zOg,this.zOg.process,"process"):this.BL&1?Object(w.a)(this.hve,this.hve.process,"process"):Object(w.a)(this.yOg,this.yOg.process,"process");this.BL&16&&this.mh.mb.Tya.a1h();this.mMa.create(this,V,this.Qja).Al("ClipboardAction")}z.ULS.shipAssertTag(6305536,307,!!this.sC);this.sC.run();this.sC.inProgress||(this.ADd(),this.Sz=this.Ig?2:
3)}teardownSync(){this.Qja.Tac&&(this.Iw.fk=F.a.typing);this.Qja.mUc&&this.Iw.VFa(this.Qja.hzf,this.Qja.ERf);this.Iw.dispose();this.mr=this.Qja.failed?8:32;this.Sz=4}teardownAsync(){if(this.sC){if(this.sC.run(),this.sC.inProgress)return}else if(this.Qja.Tac&&(this.Iw.fk=F.a.typing),this.Iw.tHa(this),this.Qja.mUc&&this.Iw.VFa(this.Qja.hzf,this.Qja.ERf),this.Iw.dispose(),this.WXe)return;this.mr=this.Qja.failed?8:32;this.Sz=4}finish(){this.CZ.Egc(Object.assign(new J.a,{RTc:!1}));this.gqa();32===this.response?
z.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.BL,this.Vqb,this.Se.bG):z.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.BL,this.Vqb,this.Se.bG);this.Jea.aga(this.O$);(X.EOn||X.$cg)&&this.o0m()}r2d(){const V=!!(this.BL&1),Z=this._context.view;Z&&U.a.r2d(V,Z.mb,this.Se.bG)}o0m(){if(!(this.BL&4||this.BL&64)){var V=new Map;V.set("isCopy",
String.format("{0}",!!(this.BL&16)));V.set("isIPad",String.format("{0}",this.Se.ti));X.$cg?(V.set("SkipAria","false"),V.set("ErrorLevel","info"),this.$h.logKpiUsage({kpiName:U.a.QCd,kpiType:0,optionalProperties:{extendedProperties:V},blockFutureEmissionDurationInMs:0})):e.Health.instance.recordKpiUsage(U.a.QCd,0,U.a.RCd,V);this.MS||(X.$cg?(V.set("SkipAria","false"),V.set("ErrorLevel","info"),this.$h.logKpiFailure({kpiName:U.a.QCd,errorName:U.a.xBh,optionalProperties:{isIntentional:!0,isInternal:!0,
additionalValues:{extendedProperties:V}},blockFutureEmissionDurationInMs:0})):(V=Object.assign(new W.a,{extendedProperties:V}),e.Health.instance.recordKpiFailure(U.a.QCd,U.a.xBh,!0,!0,V)))}}static get EOn(){null==X.LOe&&(X.LOe=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("RecordCcpErrorDialogKpiIsEnabled"));return X.LOe}static get $cg(){null==X.J2&&(X.J2=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis"));return X.J2}static c3f(V,Z,da,aa){V&&V.Yb(I.a.kf,
{["Reason"]:da});Z&&Z.fail(aa,!0)}static qAh(V,Z,da=null,aa=null,ea=!0){return V.view.qe?V.view.mb?!ea||Z.NRa&&Z.NRa.kb&&Z.NRa.length?!0:(X.c3f(da,aa,K.a.noSelection,"Paste target is invalid"),!1):(X.c3f(da,aa,K.a.noSelection,"No selection manager"),!1):(X.c3f(da,aa,K.a.MJb,"Not in interactive view"),!1)}}X.LOe=null;X.J2=null;Object(E.a)(X,"ClipboardOperation",M.a,[])},1670:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);var m;(function(e){e[e.paste=1]="paste";e[e.textOnly=2]="textOnly";e[e.overtype=
4]="overtype";e[e.copy=16]="copy";e[e.deleteSelection=32]="deleteSelection";e[e.move=64]="move";e[e.useSystemClipboard=256]="useSystemClipboard";e[e.forceInternalClipboard=512]="forceInternalClipboard";e[e.reformatPastedContent=4096]="reformatPastedContent";e[e.pasteAsPlainText=8192]="pasteAsPlainText";e[e.showPlaceholderGlossary=65536]="showPlaceholderGlossary";e[e.reformatPastedContentWithDesignerPaste=131072]="reformatPastedContentWithDesignerPaste";e[e.noSpacesAdjustment=262144]="noSpacesAdjustment"})(m||
(m={}));Object(E.b)("ClipboardActionFlags",m)},1673:function(E,M,c){var m=this&&this.lE||(Object.create?function(a,l,y,z){void 0===z&&(z=y);var n=Object.getOwnPropertyDescriptor(l,y);if(!n||("get"in n?!l.bC:n.writable||n.configurable))n={enumerable:!0,get:function(){return l[y]}};Object.defineProperty(a,z,n)}:function(a,l,y,z){void 0===z&&(z=y);a[z]=l[y]}),e=this&&this.__exportStar||function(a,l){for(var y in a)"default"===y||Object.prototype.hasOwnProperty.call(l,y)||m(l,a,y)};Object.defineProperty(M,
"__esModule",{value:!0});e(c(1831),M);e(c(1832),M);E.exports.IntentIds||Object.defineProperty(E.exports,"IntentIds",{enumerable:!0,get:function(){return E.exports.IntentIds}});E.exports.ObjectSchemaType||Object.defineProperty(E.exports,"ObjectSchemaType",{enumerable:!0,get:function(){return E.exports.ObjectSchemaType}});E.exports.ObjectSemantic||Object.defineProperty(E.exports,"ObjectSemantic",{enumerable:!0,get:function(){return E.exports.ObjectSemantic}});E.exports.SearchSuggestionAnnotation||Object.defineProperty(E.exports,
"SearchSuggestionAnnotation",{enumerable:!0,get:function(){return E.exports.SearchSuggestionAnnotation}});E.exports.SearchSuggestionSignal||Object.defineProperty(E.exports,"SearchSuggestionSignal",{enumerable:!0,get:function(){return E.exports.SearchSuggestionSignal}});E.exports.SequenceType||Object.defineProperty(E.exports,"SequenceType",{enumerable:!0,get:function(){return E.exports.SequenceType}})},1674:function(E,M,c){c.r(M);c.d(M,"FootnoteEndnoteDefaultContentInserter",function(){return I});
E=c(0);var m=c(22),e=c(58),a=c(2),l=c(36),y=c(538),z=c(28),n=c(6),v=c(15),A=c(55),w=c(1181),G=c(876),F=c(1602);class I{constructor(K,J,N,R,O=null){this.Wc=K;this.VXj=J;this.em=N;I.nh=R;this.cQg=O||I.t$k}get iL(){return null!=this.cEg?this.cEg:this.cEg=m.a.instance.resolve("Box4.IOutlineEditor")}C8k(K,J){var N=this.Wc.xk();N.set(K);this.iL.Uib(N,null,!0);I.nh.dOb(N.currentNode,this.em);K=l.OutlineElementNavigator.Ge(N);I.r5.Xge(J?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,
K);N=this.cQg(N.currentNode);I.characterPropertiesEditor.replaceTextRange(N,I.jPh);this.oAm(K,J)}oAm(K,J){var N=this.VXj(131073);N.setValue(n.a.Ys,1===J?36:35);N.setValue(n.a.$la,!0);N.setValue(v.a.T9,!0);const R=K.Kc.Ju(N,e.a.create());N=this.cQg(K);I.characterPropertiesEditor.Uga(N,O=>G.a.getInstance(O,R,!0),F.a.T4h(K,J))}static Rl(){return new I(new y.a,Object(A.a)(w.a.instance,w.a.instance.createInstance,"createInstance"),a.AFrameworkApplication.isRtl,m.a.instance.resolve("Box4.IOutlineElementEditor"))}static get r5(){return null!=
I.xGg?I.xGg:I.xGg=m.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get characterPropertiesEditor(){return null!=I.uwg?I.uwg:I.uwg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=I.uCg?I.uCg:I.uCg=I.Rl()}static t$k(K){return z.a.Rc(K,0)}}I.jPh=" ";I.nh=null;Object(E.a)(I,"FootnoteEndnoteDefaultContentInserter",null,[431])},1675:function(E,M,c){c.d(M,"a",function(){return y});E=c(0);var m=c(538),e=c(528),a=c(1529),l=c(1602);class y{constructor(z,
n){this.Yra=n}$Sd(z,n,v){return(z=this.Yra.nbi(z.node,v?z.cpBegin:z.cpEnd,n))?z.Q3():null}Vji(z,n){return(z=this.Yra.x7l(z.node,z.cpBegin,n))?z.Q3():null}static XNc(){return new y(e.a.instance,a.a.instance,new m.a,l.a.instance)}static get instance(){return null!=y.RBg?y.RBg:y.RBg=y.XNc()}}Object(E.a)(y,"FootnoteEndnoteNavigator",null,[403])},1687:function(E,M,c){c.d(M,"a",function(){return y});E=c(0);var m=c(1745),e=c(2),a=c(50),l=c(22);class y{constructor(z,n,v,A,w,G){this.Asa=z;this.Bsa=n;this.WCe=
v;this.aZ=A;this.ghd=w;this.kSb=G}get Uqj(){return!this.Bsa&&!this.WCe}get iRi(){return 2===this.kSb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get FWh(){return CommonUIStrings.l_OICErrorMessageNoOffice}get doi(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get pib(){return CommonUIStrings.l_OICErrorHelpLink}get Umi(){return"OICFailure"}get icon(){return 3}get lyd(){return 2===this.kSb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:
CommonUIStrings.l_OICErrorC2RInstallButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}tNn(z){this.tRi(z)}wXm(z){this.tRi(z)}tRi(z){let n=10;1===z?(l.a.instance.resolve("Common.IOfficeTrialExperience").CIf(this.kSb),n=3):2===z&&((!this.WCe||this.WCe(this.aZ))&&this.Bsa&&m.a.instance.Kal(this.Bsa,this.Asa,this.aZ),n=5);(0===z||1===z)&&this.Asa&&this.Asa(this.aZ);e.AFrameworkApplication.B4c(a.a.YXi,this.ghd,n);this.dispose()}dispose(){this.aZ=this.Bsa=this.Asa=null}}Object(E.a)(y,
"AOICErrorDialogWithTrial",null,[9])},1743:function(E,M,c){E=c(0);var m=c(2),e=c(20),a=c(22),l=c(741),y=c(1524),z=c(34);class n{constructor(oa,Ca=null){this.Iak=oa;this.xW=Ca||y.a.dqf(e.a.Jzb,"")}get xy(){return this.Iak}get Gc(){return this.xW}Kag(oa){this.Gc.d++;return this.xy.Kag(oa)}Yic(oa){this.Gc.e++;return this.xy.Yic(oa)}nL(oa){this.Gc.f++;return this.xy.nL(oa)}iob(oa){this.Gc.h++;return this.xy.iob(oa)}e5(oa){this.Gc.i++;return this.xy.e5(oa)}Ria(oa){this.Gc.j++;return this.xy.Ria(oa)}BHa(oa){this.Gc.k++;
return this.xy.BHa(oa)}iqa(oa){this.Gc.l++;return this.xy.iqa(oa)}fge(oa){this.Gc.m++;return this.xy.fge(oa)}USa(oa,Ca=!1){this.Gc.n++;return this.xy.USa(oa,Ca)}bwf(){this.Gc.o++;return this.xy.bwf()}Keg(){this.Gc.p++;return this.xy.Keg()}Mv(oa){this.Gc.q++;return this.xy.Mv(oa)}zya(oa){this.Gc.r++;return this.xy.zya(oa)}Mic(oa){this.Gc.g++;return this.xy.Mic(oa)}j7c(oa){return this.xy.j7c(oa)}lob(oa){this.Gc.s++;return this.xy.lob(oa)}Oge(oa){this.Gc.s++;return this.xy.Oge(oa)}gbf(oa){this.Gc.ba++;
return this.xy.gbf(oa)}Nfe(oa){this.Gc.s++;return this.xy.Nfe(oa)}job(oa){this.Gc.s++;return this.xy.job(oa)}iOb(oa){this.Gc.t++;return this.xy.iOb(oa)}che(oa){this.Gc.u++;return this.xy.che(oa)}Oia(oa){this.Gc.v++;return this.xy.Oia(oa)}Bbg(oa){this.Gc.bb++;return this.xy.Bbg(oa)}zHa(oa){return this.xy.zHa(oa)}D9(oa){this.Gc.z++;return this.xy.D9(oa)}k7f(){return this.xy.k7f()}Wca(oa,Ca){this.Gc.w++;this.Gc.x++;return this.xy.Wca(oa,Ca)}dD(oa){this.Gc.y++;return this.xy.dD(oa)}clearFormatting(){return this.xy.clearFormatting()}clone(){return new n(this.xy.clone(),
this.Gc)}}Object(E.a)(n,"FormattingStewardUsageCollector",null,[503]);class v extends n{constructor(oa,Ca=null){super(oa,Ca)}get V8(){return this.xy}get lw(){return this.V8.lw}set lw(oa){this.V8.lw=oa}get textIndent(){return this.V8.textIndent}get marginLeft(){return this.V8.marginLeft}get ykc(){return this.V8.ykc}get xR(){return this.V8.xR}get lineSpacing(){return this.V8.lineSpacing}get l5(){return this.V8.l5}get leftIndent(){return this.V8.leftIndent}get zca(){return this.V8.zca}get paragraph(){return this.V8.paragraph}set paragraph(oa){this.V8.paragraph=
oa}get GQ(){return this.V8.GQ}get Ikc(){return this.V8.Ikc}ime(oa){return this.V8.ime(oa)}ukg(oa){return this.V8.ukg(oa)}clone(){const oa=this.xy.clone();return new v(oa,this.Gc)}}Object(E.a)(v,"FormattingStewardUsageCollector",n,[516,503]);var A=c(8),w=c(209),G=c(374),F=c(858),I=c(36),K=c(204),J=c(81),N=c(40),R=c(58),O=c(354),L=c(137),U=c(19),W=c(83),X=c(53),V=c(15),Z=c(6),da=c(42),aa=c(119),ea=c(585),na=c(355),pa=c(139),ja=c(56),ma=c(99),Ia=c(183),Ja=c(1594),Ka=c(149),Ma=c(28),sa=c(1386),xa=c(875);
class ia{constructor(oa,Ca,Aa,db,eb,ib,lb,Ya,Fa,$a,Db=null){var gc;this.oE=this._paragraph=null;this.Jqd=0;this.QNg=this.Kqd=null;this.L$=0;this.bwb=this.Ikc=this.leftIndent=this.l5=this.ewc=this.xR=this._tabStops=this._marginLeft=this._textIndent=null;this.paragraph=oa;this.ve=Ca;this.Qu=Aa;this.Sy=db;this.eK=eb;this.UUb=ib;this.oka=lb;this.DTb=Ya;this.MVa=Fa;this.itb=$a;Db?(z.a(4223818,307,!!Db.oE),this.oE=Db.oE.ema(this.paragraph),this.Jqd=Db.vfc,this.Kqd=Db.WXf,Db.xR&&(this.xR=new sa.a,this.xR.afterSpacing.value=
Db.xR.afterSpacing.value,this.xR.beforeSpacing.value=Db.xR.beforeSpacing.value,null===(gc=m.AFrameworkApplication.K)||void 0===gc?0:gc.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(this.xR.afterSpacing.unit=Db.xR.afterSpacing.unit,this.xR.beforeSpacing.unit=Db.xR.beforeSpacing.unit),Db.lineSpacing&&(this.ewc=Db.lineSpacing.clone()),this.L$=Db.L$,this.Ikc=Db.Ikc.clone(),this._textIndent=Db.textIndent,this._marginLeft=Db.marginLeft,this._tabStops=Db.ykc,
this.l5=Db.l5,this.leftIndent=Db.leftIndent,Db.zca&&(this.bwb=Db.zca)):(this.oE=new Ia.a(this.paragraph,0),this.oE.formatting=new Ka.a(this.oE,R.a.nil),Ca=Ma.a.fw(oa),Ca=this.eK.Kr(Ca),this.kfo(Ca),this.Eso(oa)?(this.UUb.Fgo(this.oE.formatting,Ca),oa.hasProperty(V.a.Hh)?this.L$=oa.getValue(V.a.Hh):this.L$=0):this.L$=-1,this.Jqd=0,this.xR=this.Kqd=null,this.itb&&(this.xR=this.UUb.sEa(oa),this.ewc=this.UUb.pEb(oa),this.l5=this.UUb.u8b(oa),this.leftIndent=this.UUb.ZT(oa)),this.Ikc=new O.DictionaryPropertySet)}get paragraph(){return this._paragraph}set paragraph(oa){z.a(4223816,
307,!!oa&&A.ParagraphReader.Wb(oa));this._paragraph=oa}get GQ(){return this.oE.formatting}get vfc(){return this.Jqd}get WXf(){return this.Kqd}get aw(){return this.QNg}get lw(){return this.L$}set lw(oa){z.a(4223817,307,1===oa||2===oa||3===oa||6===oa);this.L$=oa}get textIndent(){return this._textIndent}get marginLeft(){return this._marginLeft}get ykc(){return this._tabStops}get lineSpacing(){return this.ewc}get zca(){return this.bwb}get sc(){return this.Sy}kfo(oa){const Ca=this.eK.language(oa);Ca&&
this.ve.Lag(this.oE.formatting,Ca,0,oa.cache.jHb,!1)}Eso(oa){oa=this.sc.kg(this.sc.Lo(oa));return oa===ja.StyleReader.acd||oa===ja.StyleReader.wordStyleIdNormal||oa===ja.StyleReader.hRb||oa===ja.StyleReader.styleIdNormal}Kag(oa){(oa=l.a.og(oa))&&this.ve.vge(this.oE.formatting,oa.LCID);return!0}Yic(){return!1}nL(oa){this.ve.nL(this.oE.formatting,oa);return!0}iob(oa){this.ve.setItalic(this.oE.formatting,oa);return!0}e5(oa){this.ve.e5(this.oE.formatting,oa);return!0}Ria(oa){this.ve.Ria(this.oE.formatting,
oa);return!0}BHa(oa){this.ve.BHa(this.oE.formatting,oa);return!0}iqa(oa){this.ve.iqa(this.oE.formatting,oa);return!0}fge(oa){if(0>=oa)return!1;this.ve.LA(this.oE.formatting,oa);return!0}USa(oa,Ca){if(!oa||""===oa)return!1;if(({x0h:Aa}=L.FontUtils.bCj(oa)).returnValue)return this.ve.Mia(this.oE.formatting,Aa.fontName),!0;var Aa=!1;const db=L.FontUtils.oRa(oa);Ca&&this.ekb(db,this.oka)&&(this.oka.sma(oa),Aa=!0);if(this.ekb(db,this.DTb)||this.ekb(db,this.MVa))Aa=!0;Aa&&this.ve.Mia(this.oE.formatting,
db);return Aa}ekb(oa,Ca){return!!Ca&&Ca.isEnabled&&Ca.ekb(oa)}bwf(){this.ve.ski(this.oE.formatting);return!0}Keg(){this.ve.Wrj(this.oE.formatting);return!0}Mv(oa){var {Box4PasteSteward:Ca}=c(1499);if(null===oa||""===oa)return!1;oa=Ca.SAb(oa);Ca=null;this.zca&&this.zca.hasOwnProperty(Z.a.listLevel.id.toString())&&(Ca=this.zca[Z.a.listLevel.id.toString()]);this.ve.Mv(this.oE.formatting,oa,Ca);return!0}zya(oa){const {Box4PasteSteward:Ca}=c(1499);if(!oa||""===oa||!ia.Fim().contains(oa))return!1;this.ve.zya(this.oE.formatting,
Ca.SAb(oa));return!0}Mic(oa){this.ve.Mic(this.oE.formatting,oa);return!0}j7c(oa){let Ca=0;switch(U.a.Tg(oa)){case "small-caps":Ca=1;break;case "uppercase":Ca=2}this.ve.Wl(this.oE.formatting,da.a.capitalization,Ca);return!0}D9(oa){const {Box4PasteSteward:Ca}=c(1499);if(!oa||""===oa)return!1;this.Ikc.setValue(V.a.vH,parseInt(Ca.SAb(oa),16));return!0}job(oa){return 0>=oa?!1:this.Oge(this.sc.vgi(oa))}lob(oa){this.clearFormatting();this.Jqd=oa;return!0}gbf(oa){var {Box4PasteSteward:Ca}=c(1499),Aa=new Map;
Aa.set("Source","CreateStyleCCP_FormattingSteward");W.Health.instance.recordKpiUsage(pa.a.eKj,0,pa.a.qB,Aa);Aa=ma.a.bcm(oa);oa=[];oa.push(Aa);(oa=ma.a.Ryd(oa,this.paragraph))?(Ca.tkc=this.sc.Mr(),z.b(593078085,3017,50,"Custom style created via paste.")):(Ca=new Map,Ca.set("Source","CreateStyleCCP_FormattingSteward"),Ca.set("IsStyleNull",(!Aa).toString()),Ca=Object.assign(new aa.a,{extendedProperties:Ca}),W.Health.instance.recordKpiFailure(pa.a.eKj,"UnableToCreateStyle",!1,!0,Ca));return oa}Oge(oa){const {Box4PasteSteward:Ca}=
c(1499);return oa&&0<oa.length&&Ca.tkc&&Ca.tkc.Fi(oa)?(this.Kqd=oa,!0):!1}Nfe(oa){const {Box4PasteSteward:Ca}=c(1499);return oa&&0<oa.length&&Ca.tkc&&Ca.tkc.Fi(oa)?(this.QNg=oa,!0):!1}ukg(oa){if(this.aw){oa=this.sc.JC(oa);if(!oa)return z.a(41968715,307,!1),!1;(oa=oa.Fi(this.aw))&&this.ve.A6a(this.oE.formatting,oa);return!0}return!1}Wca(oa,Ca){this.xR=new sa.a;this.xR.beforeSpacing=this.pjo(oa);this.xR.afterSpacing=this.ojo(Ca);return!0}pjo(oa){return new xa.a(4,oa)}ojo(oa){return new xa.a(4,oa)}dD(oa){if(!oa)return!1;
const Ca=parseFloat(U.a.substring(oa,0,U.a.Tg(oa).indexOf("px")));if(!isNaN(Ca))return this.ewc=new xa.a(3,X.a.Ay(Ca,1)),!0;oa=parseFloat(U.a.substring(oa,0,U.a.Tg(oa).indexOf("%")));return isNaN(oa)?!1:(this.ewc=new xa.a(2,oa/100),!0)}iOb(oa){let Ca=0;if(!oa||""===oa)return!1;switch(oa){case "left":Ca=1;break;case "center":Ca=2;break;case "right":Ca=3;break;case "justify":Ca=6}if(!Ca)return!1;this.lw=Ca;return!0}che(oa){this._textIndent=oa;return!0}Oia(oa){this._marginLeft=oa;return!0}Bbg(oa){this._tabStops=
oa;return!0}zHa(oa){this.bwb=JSON.parse(oa);return this.zca?!0:!1}clearFormatting(){this.oE.formatting=new Ka.a(this.oE,R.a.nil);return!0}k7f(){this.L$=0;return!0}ime(oa){var {Box4PasteSteward:Ca}=c(1499);if(0<this.vfc&&Ca.Q4a[this.vfc]){z.a(4223819,307,1<=this.vfc);z.a(4223820,307,7>=this.vfc);Ca=this.sc.JC(oa);if(!Ca)return z.a(4223821,307,!1),!1;Ca=Ca.Fi(c(1499).Box4PasteSteward.Q4a[this.vfc]);this.Qu.HJ(Ca,oa,!1);return!0}if(this.WXf){Ca=this.sc.JC(oa);if(!Ca)return z.a(41968716,307,!1),!1;Ca=
Ca.Fi(this.WXf);this.Qu.HJ(Ca,oa,!1);return!0}return!1}clone(){return new ia(this.paragraph,this.ve,this.Qu,this.Sy,this.eK,this.UUb,this.oka,this.DTb,this.MVa,this.itb,this)}static Fim(){ia.QZ||(ia.QZ=new ea.a(na.a.ei()),ia.QZ.add(Ja.a.yellow),ia.QZ.add(Ja.a.GXm),ia.QZ.add(Ja.a.hFk),ia.QZ.add(Ja.a.mHl),ia.QZ.add(Ja.a.blue),ia.QZ.add(Ja.a.red),ia.QZ.add(Ja.a.fen),ia.QZ.add(Ja.a.teal),ia.QZ.add(Ja.a.green),ia.QZ.add(Ja.a.purple),ia.QZ.add(Ja.a.t9m),ia.QZ.add(Ja.a.Whn),ia.QZ.add(Ja.a.gray),ia.QZ.add(Ja.a.fxo),
ia.QZ.add(Ja.a.black));return ia.QZ}}ia.QZ=null;Object(E.a)(ia,"FormattingSteward",null,[516,503]);class ha{Dkg(){return!1}xwf(oa){return oa}Ewf(){}zHa(){}Cge(){}wYd(){return!1}get EZd(){return!1}dD(){}Wca(){}Vge(){}get Wpj(){return!1}}Object(E.a)(ha,"NoOpPasteStewardBridge",null,[515]);var ua=c(74);class ya{constructor(oa,Ca){this.Yfn=oa;this.Zfn=Ca||"Normal"}}Object(E.a)(ya,"NoteTagInfoBox4",null,[]);const ra=oa=>{const Ca=new ua.a;for(const Aa of oa)oa=new ya(Aa.Yfn,Aa.Zfn),Ca.add(oa);return Ca};
c.d(M,"a",function(){return La});class La{constructor(oa,Ca,Aa=null,db=null){this.VEl=m.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.U$g=0;this.Ec=oa;this.z6=Ca;this.$Y=db||new ha;this.Gc=Aa||y.a.dqf(e.a.Jzb,"")}get characterPropertiesEditor(){return null!=this.mwg?this.mwg:this.mwg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get fontService(){return null!=this.tzg?this.tzg:this.tzg=a.a.instance.Na("Box4.IFontService")}get tDa(){return null!=this.rxg?this.rxg:
this.rxg=a.a.instance.Na("Box4.CustomFontService")}get Xrl(){return null!=this.Sxg?this.Sxg:this.Sxg=a.a.instance.Na("Box4.IEmbeddedFontService")}reset(){}get NIc(){return this.$of(!1)}$of(oa){z.a(4223770,307,N.OutlineElementReader.Bh(this.Ec));const Ca=I.OutlineElementNavigator.Ge(this.Ec);I.OutlineElementNavigator.Vd(this.Ec);z.a(4223771,307,!!Ca&&A.ParagraphReader.Wb(Ca));oa=new ia(Ca,La.pp,La.XG,La.sc,La.b8,La.CGl,this.fontService,this.tDa,this.Xrl,this.VEl,void 0,oa);return new v(oa,this.Gc)}tca(){}sca(){}imb(){}qxa(){}nGa(){}tRa(){}sRa(){}$D(){}qF(){}dmb(){}cmb(){}yRa(){}B4a(){}uxa(){}sxa(){}sGa(){}txa(){}D4a(){}Jdc(oa){N.OutlineElementReader.Bh(this.Ec)?
(La.lg.aoa(this.Ec,!0),I.OutlineElementNavigator.Ur(this.Ec,!1,!1)):J.OutlineReader.Zw(this.Ec)?K.OutlineNavigator.T8(this.Ec)?oa?(this.Ec.wg(),La.iL.h7(this.Ec,!1)):La.lg.EMb(this.Ec):La.iL.h7(this.Ec,!1):z.a(8128524,307,!1,"Unexpected node type {0} encountered",this.Ec.We)}AOc(oa){let Ca=null;if(oa&&oa.f9&&oa.cultureName)try{Ca=Object.assign(new F.a,{languageId:l.a.og(oa.cultureName).LCID})}catch(Aa){z.a(8128526,307,!1,"Setting up culture {0} encountered {1}",oa.cultureName,Aa)}Ca||null==this.z6||
(Ca=Object.assign(new F.a,{languageId:this.z6}));return Ca}get JU(){return this.U$g}set JU(oa){this.U$g=oa}HAd(){}I$c(){}a7e(){}get k3b(){return!1}get ABb(){return!1}jYm(oa){let Ca=1;if(oa.Sxi){var Aa=0;switch(oa.listStyleType){case 1:Ca=0;break;case 7:Ca=1;break;case 8:Ca=2;break;case 9:Ca=3;break;case 10:Ca=4;break;case 11:Ca=5}}else switch(Aa=1,oa.listStyleType){case 1:Ca=0;break;case 3:Ca=1;break;case 4:Ca=2;break;case 5:Ca=3}let db;Aa=(db=w.a.t_)?G.a.uT(Aa,Ca,ra(oa.mpa),oa.listId,oa.listLevel,
oa.levelText,oa.font):G.a.uT(Aa,Ca,ra(oa.mpa));3!==oa.Sr&&(Aa.B5=oa.Sr);oa.Sxi&&!oa.Nti&&(Aa.OB=db&&0<oa.listId&&0<=oa.listLevel&&!oa.yfc?oa.akc:oa.Tel);!Aa.nz||3!==Aa.listStyle&&5!==Aa.listStyle||(Aa.lw="right");(oa=oa.sJf)&&Aa.propertySet.Qw(oa);Aa.B6b=!0;this.$Y.Cge(this.Ec);return Aa}b9(){}Z8(){}G4(){}a9(){}Y8(){}X8(){}static get lg(){return null!=La.tEg?La.tEg:La.tEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get iL(){return null!=La.iEg?La.iEg:La.iEg=a.a.instance.resolve("Box4.IOutlineEditor")}static get pp(){return null!=
La.Uzg?La.Uzg:La.Uzg=a.a.instance.resolve("Box4.IFormattingEditor")}static get XG(){return null!=La.dJg?La.dJg:La.dJg=a.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get sc(){return null!=La.HJg?La.HJg:La.HJg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get b8(){return null!=La.Yzg?La.Yzg:La.Yzg=a.a.instance.resolve("Box4.IFormattingReader")}static get CGl(){return null!=La.Zzg?La.Zzg:La.Zzg=a.a.instance.resolve("Box4.Actors.IFormattingStewardBridge")}}La.Gf=null;Object(E.a)(La,
"Box4PasteStewardBase",null,[493,494,484])},1745:function(E,M,c){E=c(0);var m=c(55),e=c(7),a=c(2),l=c(50),y=c(459),z=c(22);class n{constructor(R,O,L,U){this.hJe=null;this.ghd=U;this.Asa=R;this.Bsa=O;this.aZ=L;this.Afh=this.hJb.sqo;R=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.v$j=R[0];this.u$j=R[1]}get hJb(){return this.hJe||(this.hJe=z.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get pib(){return CommonUIStrings.l_OICErrorHelpLink}get M7c(){return this.Afh}get qLi(){return this.v$j}get pLi(){return this.u$j}get oLi(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.Afh?
3:2}get RKc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get mFd(){return!!this.Bsa}get SKc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}K2f(R){this.VZc(R)}gJf(R){this.VZc(R)}VZc(R){let O=10;this.Bsa&&1===R&&(this.Bsa(this.aZ),O=1);this.Asa&&this.Asa(this.aZ);this.UM(O)}RJb(){y.Redirect.showHelp("OICFailure");this.UM(2)}URf(){this.hJb.vEi();this.UM(4)}UM(R){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.ghd,R);a.AFrameworkApplication.B4c(l.a.WXi,this.ghd,R)}dispose(){this.aZ=this.Asa=this.Bsa=null}}Object(E.a)(n,"AOICErrorDialog",null,[9]);var v=c(38),A=c(175);class w extends n{constructor(R,O,L,U){super(R,O,L,U);this.abb=this.JF=null;R=document.createElement("span");R.id="errorMessageText";R.innerText=this.errorMessage;R.appendChild(document.createElement("br"));R.appendChild(document.createElement("br"));this.JF=document.createElement("a");this.JF.href="#";this.JF.innerText=this.pib;R.appendChild(this.JF);
v.a.addHandler(this.JF,"click",Object(m.a)(this,this.RJb,"oicErrorHelpLinkHandler"));O=new A.StandardDialog;O.vg=this.id;this.M7c?(L=document.createElement("span"),U=document.createElement("span"),L.innerText=this.qLi,U.innerText=this.pLi,this.abb=document.createElement("a"),this.abb.href="#",this.abb.innerText=this.oLi,R.appendChild(document.createElement("br")),R.appendChild(L),R.appendChild(this.abb),R.appendChild(U),v.a.addHandler(this.abb,"click",Object(m.a)(this,this.URf,"oicErrorMacOfferLinkHandler"))):
this.mFd&&(R.appendChild(document.createElement("br")),R.appendChild(document.createElement("br")),L=document.createElement("span"),L.innerText=this.RKc,R.appendChild(L));this.mFd?(O.Ad=1,O.Ee(1,this.SKc)):O.Ad=0;O.Gu(this.dialogTitle,null,this.icon,Object(m.a)(this,this.gJf,"legacyOICErrorDialogHandler"),R);O.Z4("errorMessageText")}dispose(){this.JF&&(v.a.removeHandler(this.JF,"click",Object(m.a)(this,this.RJb,"oicErrorHelpLinkHandler")),this.JF=null);this.abb&&(v.a.removeHandler(this.abb,"click",
Object(m.a)(this,this.URf,"oicErrorMacOfferLinkHandler")),this.abb=null);super.dispose()}}Object(E.a)(w,"OICErrorDialog",n,[]);class G{constructor(R,O,L){this.Asa=O;this.Bsa=R;this.aZ=L}get id(){return"OICErrorDialogWithDownload"}get GWh(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get pib(){return CommonUIStrings.l_OICErrorHelpLink}get RKc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get SKc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}K2f(R){this.VZc(R)}gJf(R){this.VZc(R)}VZc(R){let O=
10;1===R&&(this.Bsa(this.aZ),O=1);this.Asa&&this.Asa(this.aZ);this.UM(O)}RJb(){y.Redirect.showHelp("OICFailure");this.UM(2)}UM(R){a.AFrameworkApplication.B4c(l.a.XXi,3,R)}dispose(){this.aZ=this.Bsa=this.Asa=null}}Object(E.a)(G,"AOICErrorDialogWithDownload",null,[9]);class F extends G{constructor(R,O,L){super(R,O,L);this.JF=null;R=document.createElement("span");R.id="errorMessageText";R.innerText=this.GWh;R.appendChild(document.createElement("br"));R.appendChild(document.createElement("br"));this.JF=
document.createElement("a");this.JF.href="#";this.JF.innerText=this.pib;R.appendChild(this.JF);v.a.addHandler(this.JF,"click",Object(m.a)(this,this.RJb,"oicErrorHelpLinkHandler"));R.appendChild(document.createElement("br"));R.appendChild(document.createElement("br"));O=document.createElement("span");O.innerText=this.RKc;R.appendChild(O);O=new A.StandardDialog;O.vg=this.id;O.Ad=1;O.Ee(1,this.SKc);O.Gu(this.dialogTitle,null,this.icon,Object(m.a)(this,this.gJf,"legacyOICErrorDialogHandler"),R);O.Z4("errorMessageText")}dispose(){this.JF&&
(v.a.removeHandler(this.JF,"click",Object(m.a)(this,this.RJb,"oicErrorHelpLinkHandler")),this.JF=null);super.dispose()}}Object(E.a)(F,"OICErrorDialogWithDownload",G,[]);var I=c(174);class K extends n{constructor(R,O,L,U){super(R,O,L,U);O={["errorMessage"]:this.errorMessage};O.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.pib,["onExecute"]:W=>{this.RJb(W)}};this.M7c?(O.macOfficePreLinkText=this.qLi,O.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.oLi,
["onExecute"]:W=>{this.URf(W)}},O.macOfficePostText=this.pLi):this.mFd&&(O.errorFileDownloadOffer=this.RKc);R=new I.a(!1,!1,!0);this.mFd?(R.Ad=1,R.Ee(1,this.SKc)):R.Ad=0;R.vg=this.id;O={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:O};R.Wh(this.dialogTitle,Object(m.a)(this,this.K2f,"reactOICErrorDialogHandler"),O)}}Object(E.a)(K,"ReactOICErrorDialog",n,[]);class J extends G{constructor(R,O,L){super(R,O,L);O={["errorMessage"]:this.GWh,["errorFileDownloadOffer"]:this.RKc};O.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.pib,["onExecute"]:U=>{this.RJb(U)}};R=new I.a(!1,!1,!0);R.Ad=1;R.Ee(1,this.SKc);R.vg=this.id;O={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:O};R.Wh(this.dialogTitle,Object(m.a)(this,this.K2f,"reactOICErrorDialogHandler"),O)}}Object(E.a)(J,"ReactOICErrorDialogWithDownload",G,[]);c.d(M,"a",function(){return N});class N{constructor(){this.VKa=!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Nb.nF}Jal(R,O,L){this.VKa?new K(R,O,null,L):new w(R,O,null,
L)}Kal(R,O,L){this.VKa?new J(R,O,L):new F(R,O,L)}Lal(R,O,L,U,W){const {ReactOICErrorDialogWithTrial:X}=c(1846),{OICErrorDialogWithTrial:V}=c(1847);this.VKa?new X(R,O,L,null,U,W):new V(R,O,L,null,U,W)}static get instance(){return N._instance||(N._instance=new N)}}N._instance=null;Object(E.a)(N,"OICErrorDialogFactory",null,[1009])},1746:function(E,M,c){c.r(M);E=c(0);var m=c(307),e=c(1824),a=c(943),l=c(354),y=c(2),z=c(58),n=c(353),v=c(22),A=c(126),w=c(97),G=c(79),F=c(1430),I=c(177),K=c(39),J=c(20),N=
c(266),R=c(145),O=c(7),L=c(243),U=c(110),W=c(73),X=c(304),V=c(12),Z=c(28),da=c(3),aa=c(9),ea=c(131),na=c(524),pa=c(46),ja=c(1669),ma=c(1668),Ia=c(339),Ja=c(293);class Ka extends Ja.a{constructor(oa,Ca,Aa,db,eb,ib){super();this.init(oa);this.Al("DummyClipboardOperation");this.Oib(y.AFrameworkApplication.va,Ca,db,eb,ib);this._context=Aa;this.mr=8;this.gqa()}run(){this.uab=!0;this.A6c(this._context);this.d5a();this.mr=32}}Object(E.a)(Ka,"DummyClipboardOperation",Ja.a,[]);Ja=c(1559);class Ma extends Ja.a{constructor(oa,
Ca,Aa,db,eb){super(oa,Ca,eb);this.hk=Aa;this.ARe=db}Vlc(oa){let Ca;if(this.WS&&!oa)return O.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,Sua:null};Ca=null;if(this.ARe&&!this.WS){const Aa=this.properties.ia(R.a.E_i,"");Aa&&(Ca=this.hk.Gmb(Aa))}Ca||(Ca=this.hk.Gmb(oa));return{returnValue:!0,Sua:Ca}}}Object(E.a)(Ma,"HtmlStringImportStrategy",Ja.a,[]);var sa=c(1825);class xa extends sa.a{constructor(oa,Ca,Aa,db,eb){super(oa,Ca,Aa,db,eb)}ddi(){return this.properties.ia(R.a.YKb,
"")}Vlc(oa){y.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordUseClipboardDataHelperInMultiLineImportSettings");if(this.Nfh){if(this.hk)return oa=this.hk.jYf(oa,!0),{returnValue:!0,Sua:oa};O.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.Vlc(oa)}pXc(oa){oa=super.pXc(oa);return oa.length&&" "!==oa?oa:"\u00a0"}}Object(E.a)(xa,"MultiLinePlainTextImportStrategy",sa.a,[]);class ia extends Ja.a{constructor(oa,Ca,Aa){super(oa,Ca,Aa)}Vlc(oa){({ClipboardActor:Ca}=
c(1746));if(this.WS&&!oa)return O.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,Sua:null};var Ca=Ca.xzn;Ca.innerText=oa;return{returnValue:!0,Sua:Ca}}}Object(E.a)(ia,"PlainTextImportStrategy",Ja.a,[]);var ha=c(84),ua=c(60);class ya{constructor(oa){this.m4=this.fFf=!1;this.Hea=oa}J1i(){this.fFf||(this.fFf=!0,this.m4=!1,this.Hea.prepareForPaste(()=>{this.m4=!0}));return this.m4}jBj(){this.fFf=!1;const oa=this.Hea.paste();return oa?oa.hasChildNodes()?{returnValue:!0,xFd:oa}:
(O.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),ya.Ic.Yb(ha.a.n1,{["Reason"]:ua.a.Kif}),{returnValue:!1,xFd:oa}):(O.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),ya.Ic.Yb(ha.a.ICb,{["Reason"]:ua.a.ohg}),{returnValue:!1,xFd:oa})}static get Ic(){return I.a.instance}}Object(E.a)(ya,"SystemClipboardImportStrategy",null,[478]);var ra=c(246);c.d(M,"ClipboardActor",function(){return La});class La{get TDi(){return this.aLa}set TDi(oa){this.aLa=oa}constructor(oa,Ca,Aa,db,eb,ib,
lb,Ya,Fa,$a,Db,gc,Eb,kb,bb,Gb,Sa,Pa){this.Med=null;this.aLa=0;this.Jjd=this.sCc=!1;this.vrb=m.a.On;this.j8c=()=>{const Ab=Array(1);Ab.push("PasteRecoveryFloatie");var nb=this.Kdk.UOa();nb=Object.assign(new e.a,{x:nb.x,y:nb.y});this.EL.showFloatie(nb,Ab,1);return 32};this.HFb=()=>{this.EL.W_&&this.EL.Tw();return 32};this.w4i=(Ab,nb,Rb,Mb,oc)=>{if(1===Rb)return 32;oc[a.a.On]=!1;return 32};this.pql=(Ab,nb,Rb,Mb,oc,xb)=>{O.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var cc=xb.DataTransfer;
xb=cc.getData("text/html");cc=cc.getData("text/plain");let Ob=!1;const Ub=new l.DictionaryPropertySet;0<xb.length?(O.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),Ub.setValue(R.a.gP,xb),Ob=!0):0<cc.length&&(O.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Ub.setValue(R.a.YKb,cc),Ob=!0);if(Ob){const pb=this.Lz.J(nb);return this.UDd.create(Ab,nb,pb,new L.a(()=>this.dJc(pb,Ub)),Rb,Mb,oc,Ub)}return null};this.W1f=(Ab,nb,Rb,Mb,oc)=>{if(nb=
"object"===typeof oc?oc:null)this.$Yb?this.leo(Ab,this.aLa,nb):Ab===da.a.dbe?(Ab=this.aLa!==da.a.reformatPastedContent&&this.aLa!==da.a.hSa&&this.aLa!==da.a.$xa,nb[this.vrb]=this.aLa===da.a.reformatPastedContent||Ab):Ab===da.a.ebe?nb[this.vrb]=this.aLa===da.a.hSa:Ab===da.a.S1f&&(nb[this.vrb]=this.aLa===da.a.$xa);return 32};this.XW=(Ab,nb,Rb,Mb,oc,xb)=>{if((y.AFrameworkApplication.protectFile||y.AFrameworkApplication.JG)&&!y.AFrameworkApplication.qCb||ra.a.fha(Rb)&&ra.a.hac())return new Ka(Ab,nb,Rb,
Mb,oc,xb);let cc=this.Lz.J(nb);1!==Mb&&cc&1&&(this.aLa=nb);if(1!==Mb){var Ob=Object(U.a)(138,xb)?xb:null;xb?(cc&1&&(this.Med=Ob),Ob=Ob?Ob.ia(R.a.yY,0):0,nb===da.a.paste&&Ob===da.a.xZa?cc=this.Lz.J(da.a.b_):nb===da.a.k9&&Ob===da.a.Yzb&&(cc=this.Lz.J(da.a.H9d))):!xb&&cc&4096&&(xb=this.Med,Ob=Object(U.a)(138,xb)?xb:null)&&(Ob=Ob.ia(R.a.Z0c,z.a.nil),O.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",Ob))}return this.UDd.create(Ab,nb,cc,new L.a(()=>this.dJc(cc,xb)),
Rb,Mb,oc,xb)};this.cGn=(Ab,nb,Rb,Mb,oc)=>this.i5e(Ab,nb,Rb,oc);this.bGn=(Ab,nb,Rb,Mb,oc)=>this.i5e(Ab,nb,Rb,oc);this.aGn=(Ab,nb,Rb,Mb,oc)=>this.i5e(Ab,nb,Rb,oc);this.x4d=(Ab,nb,Rb,Mb,oc,xb)=>{xb=Z.a.Rc(pa.a.instance.hb.kb.Qa.node,xb);return this.XW(Ab,nb,Rb,Mb,oc,xb)};this.gYj=oa;this.Hea=Ca;this.qd=Aa;this.hk=db;this.ga=ib;this.jfd=$a;this.TSb=Db;this.Ae=gc;this.fg=Eb;this.Ub=Fa;this.ZYb=kb;this.$Yb=bb;this.Kdk=Gb;this.EL=Sa;this.UFe=Pa;this.$h=n.a.getInstance(Ia.a.AZa);Ya&&(this.sCc=Ya.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),
this.Jjd=this.$Yb&&Ya.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.Lz=new X.a;this.Lz.Z(da.a.paste,257);this.Lz.Z(da.a.k9,8449);this.Lz.Z(da.a.b_,1);this.Lz.Z(da.a.i2a,1);this.Lz.Z(da.a.jzb,1);this.Lz.Z(da.a.jCa,1);this.Lz.Z(da.a.QWd,513);this.Lz.Z(da.a.reformatPastedContent,4097);this.Lz.Z(da.a.hSa,12289);this.Lz.Z(da.a.$xa,131073);this.Lz.Z(da.a.nYf,7);this.Lz.Z(da.a.G9d,1);this.Lz.Z(da.a.H9d,8193);this.Lz.Z(da.a.copy,272);this.Lz.Z(da.a.YEc,16);this.Lz.Z(da.a.cut,304);this.Lz.Z(da.a.g4e,
48);this.Lz.Z(da.a.w4d,64);this.Lz.Z(da.a.x4d,64);this.Lz.Z(da.a.showPlaceholderGlossary,65536);this.Lz.Z(da.a.Vff,1);this.Jjd&&this.Lz.Z(da.a.Mmb,this.Lz.J(da.a.H9d))}get ETa(){return null!=this.SGg?this.SGg:this.SGg=v.a.instance.Na("Box4.Clipboard.ISystemClipboardAccessManager")}get telemetry(){return null!=this.mHg?this.mHg:this.mHg=v.a.instance.Na("Common.Utils.Telemetry.ITelemetry")}get UDd(){return this.gYj.value}get PDo(){return this.Hea}Tb(){this.ga.fb(da.a.HJn,V.a.application,this.w4i,97);
this.ga.fb(da.a.IJn,V.a.application,this.w4i,97);this.ga.fb(da.a.dbe,V.a.application,this.W1f,97);this.ga.fb(da.a.ebe,V.a.application,this.W1f,97);this.ga.fb(da.a.S1f,V.a.application,this.W1f,97);this.ga.cT(da.a.g4e,V.a.view,this.XW,1028);this.ga.ldb(da.a.YEc,V.a.view,this.XW);this.ga.cT(da.a.Vff,V.a.view,this.pql,1028);this.ga.cT(da.a.b_,V.a.view,this.XW,1028);this.ga.cT(da.a.i2a,V.a.view,this.XW,1028);this.ga.cT(da.a.jzb,V.a.view,this.XW,1028);this.ga.cT(da.a.jCa,V.a.view,this.XW,1028);this.ZYb&&
this.ga.fb(da.a.xZa,V.a.view,this.aGn,1028);this.$Yb&&this.ga.fb(da.a.Yzb,V.a.view,this.bGn,1028);this.ga.cT(da.a.paste,V.a.view,this.XW,1028);this.ga.cT(da.a.k9,V.a.view,this.XW,1028);this.ga.cT(da.a.H9d,V.a.view,this.XW,1028);this.ga.cT(da.a.G9d,V.a.view,this.XW,1028);this.ga.cT(da.a.nYf,V.a.view,this.XW,1028);this.ga.cT(da.a.reformatPastedContent,V.a.view,this.XW,1028);this.ga.cT(da.a.hSa,V.a.view,this.XW,1028);this.ga.qa(da.a.SMb,V.a.view,A.ActionManager.Of);this.ga.qa(da.a.K_i,V.a.view,A.ActionManager.Of);
this.ga.qa(da.a.H_i,V.a.view,A.ActionManager.Of);this.ga.qa(da.a.I_i,V.a.view,A.ActionManager.Of);this.ga.qa(da.a.J_i,V.a.view,A.ActionManager.Of);this.ga.qa(da.a.G_i,V.a.view,A.ActionManager.Of);this.ga.ldb(da.a.w4d,V.a.view,this.XW);this.ga.ldb(da.a.x4d,V.a.view,this.x4d);this.ga.ldb(da.a.QWd,V.a.view,this.XW);this.ga.ldb(da.a.showPlaceholderGlossary,V.a.view,this.XW);this.Jjd&&(this.ga.fb(da.a.uFc,V.a.view,this.cGn,1028),this.ga.cT(da.a.Mmb,V.a.view,this.XW,1028));this.ga.qa(da.a.ANh,V.a.view,
A.ActionManager.Of);this.ga.qa(da.a.eOh,V.a.view,A.ActionManager.Of);this.UFe&&(this.ga.fb(da.a.j8c,V.a.view,this.j8c,96),this.ga.fb(da.a.HFb,V.a.view,this.HFb,96))}R4(){if(this.Ub){const oa=this.Ub.ge(ea.AppFrame.$E);this.Jjd&&oa.bindAction(w.KeyInputManager.kc(G.a.Qqb,w.KeyInputManager.Rh|4),da.a.uFc)}else O.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}leo(oa,Ca,Aa){switch(Ca){case da.a.hSa:case da.a.k9:case da.a.Mmb:Ca=da.a.ebe;break;case da.a.$xa:Ca=
da.a.S1f;break;default:Ca=da.a.dbe}Aa[this.vrb]=oa===Ca}q6l(){const oa=Object(U.a)(138,this.Med)?this.Med:null;return oa?oa.ia(R.a.Z0c,z.a.nil):z.a.nil}i5e(oa,Ca,Aa,db){if(1===Aa){if(!Object(U.a)(na.a,Ca)||!this.jfd||ra.a.fha(Ca)&&ra.a.hac())return 8;Aa=new L.a(()=>this.dJc(this.Lz.J(da.a.b_),db));const eb=this.jfd.create(Aa,Object(W.a)(138,db));Aa=new ma.a(y.AFrameworkApplication.K,F.a.instance,Aa,I.a.instance,eb,this.TSb);return ja.a.qAh(Ca,Aa)?32:8}if(2===Aa){if(this.tpo(aa.App.JYa))return this.xZa(oa);
aa.App.Ngc(()=>{this.xZa(oa)});return 32}return 2}xZa(oa){if(!this.Ae)return O.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),8;var Ca=this.Ae.qhb();if(!Ca)return O.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;Ca=Ca.Qn;if(!Ca)return O.ULS.sendTraceTag(592454659,307,10,"No document"),8;O.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",oa);this.$h.logKpiUsage({kpiName:Ia.a.iNa});this.fg.psl(oa);oa=K.a.BCb(Ca,"paste");Ca=this.fg.Wll();O.ULS.sendTraceTag(573388233,
307,50,"PasteEventHandled: {0}",Ca);if(oa)return O.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),this.$h.logKpiSuccess({kpiName:Ia.a.iNa}),32;this.jlm();O.ULS.sendTraceTag(592454662,307,10,"execCommand failed");this.$h.logKpiFailure({kpiName:Ia.a.iNa,errorName:"ExecCommandFailed"});return 8}jlm(){this.ETa&&(this.ETa.POb(),Ia.a.r2d(!0,pa.a.instance,J.a.bG));if(this.telemetry){const oa=this.telemetry.W8c();oa.P0b("CallExecCommandPasteOperation");oa.fail("call to execCommand('paste') failed",
!0);this.telemetry.aga(oa)}}tpo(oa){let Ca=!1;this.Ub?this.Ub.currentScope?Ca=!this.Ub.GCf(this.Ub.currentScope.name):O.ULS.sendTraceTag(573388235,307,10,"No CurrentScope"):O.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(Ca){O.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Ub.currentScope.name);if(1>oa)return O.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Ub.Wkf();return!1}return!0}dJc(oa,Ca){return oa&256?new ya(this.PDo):oa&2?oa&4096?new Ma(Ca,
this.qd,this.hk,aa.App.instance.fUc,aa.App.instance.gTa):new ia(Ca,this.qd,aa.App.instance.gTa):Ca.hasProperty(R.a.YKb)?new xa(Ca,this.qd,this.hk,this.sCc,aa.App.instance.gTa):new Ma(Ca,this.qd,this.hk,aa.App.instance.fUc,aa.App.instance.gTa)}static get xzn(){return N.a.ORd("Box4PasteScratchPad")}pAh(oa,Ca,Aa,db){return!y.AFrameworkApplication.protectFile&&!y.AFrameworkApplication.JG||y.AFrameworkApplication.qCb?(oa=this.XW(null,oa?da.a.cut:da.a.copy,Ca,1,Aa,db))?oa.response:8:8}}Object(E.a)(La,"ClipboardActor",
null,[])},1751:function(E,M,c){c.r(M);E=c(0);var m=c(19),e=c(2E3),a=c(1802);class l extends a.a{constructor(){super();this.isCurrentUser=!1}}Object(E.a)(l,"IsMeAtMentionOptionalAttributes",a.a,[]);class y{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(E.a)(y,"DeltaAttributes",null,[]);var z=c(1595),n=c(8),v=c(68),A=c(15),w=c(7),G=c(1657);c.d(M,"ACommentFormatTranslator",
function(){return F});class F{constructor(I){this.ih=I}pCk(I,K){const J=n.ParagraphReader.text(K);let N=null,R=null,O=null,L=0;var U=0,W=!1;let X="";for(K.pa||J&&J.length&&"\n"!==J||w.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");L<K.pa.length;){const Z=K.pa.J(L),da=Z.cp;var V=Z.formatting?Z.formatting.wn:null;X+=m.a.substring(J,W?U+1:U,da);Z.Om&&N&&(U=new e.a,U.fullName=X.startsWith("@")?X.substr(1):X,G.a(N,U),W=new l,G.c(N,W,U),I.cAf(X,U,W,!0),X=
"",N=null);Z.Om&&R&&(U=O||new y,U.link=R.url,I.dri(X,U),X="",R=null);N&&R||""===X||(this.ih.yzb&&O?(I.wri(X,O),O=null):I.Wga(X),X="");Z.hyperlink&&(Z.hyperlink.Xv?N=Z.hyperlink:Z.hyperlink.url&&(R=Z.hyperlink));this.ih.yzb&&V&&(O=new y,O.weight=V.ia(A.a.bold,!1)?z.a.aNf:0,O.italic=V.ia(A.a.italic,!1),O.underline=V.ia(A.a.underline,!1),O.strikethrough=V.ia(A.a.strikethrough,!1),V.hasProperty(A.a.highlight)&&(U=V.getValue(A.a.highlight),O.highlight=v.a.XE(U)),V.hasProperty(A.a.fontColor)&&(V=V.getValue(A.a.fontColor),
O.color=v.a.XE(V)));U=da;W=!!Z.blob;L++}}}F.sGk="_@_";F.tGk="Z";Object(E.a)(F,"ACommentFormatTranslator",null,[547])},1763:function(E,M,c){E=c(0);var m=c(174),e=c(19),a=c(26),l=c(22),y=c(2),z=c(160),n=c(157);class v{static get Xg(){return m.a.lA(v.Lm,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}v.Lm="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(E.a)(v,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var A=c(16),w=c(3);c.d(M,"a",function(){return G});class G extends m.a{constructor(F,I,K){super();this.lXg=!1;this.NV=null;this.yFl=J=>{switch(J){case 1:this.ga.processAction(A.a.K0h,2);break;case 2:this.ga.processAction(A.a.L0h,2);break;case 0:this.ga.processAction(A.a.M0h,2)}};this.pu=I;this.pS=!1;this.PUb=G.fFl;this.Jh=F;this.ga=K;this.vg="FootnoteEndnoteFormattingOptionsDialog";this.Ad=2;this.Xg=v.Xg;this.Ee(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.Ee(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.Wh(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.yFl,null);this.kib=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.NV}set fontName(F){this.NV=F;if(F=document.getElementById("FontSizeComboBox"))F.focus(),this.Jh.updateCommandUI()}get fontSize(){return this.PUb}get kib(){return this.lXg}set kib(F){this.lXg=F;this.BBn()}W8(){this.TBd("FontStyleComboBox",
"FontPlaceholder",A.a.MMd.toString(),A.a.g4i.toString(),A.a.q1c.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.TBd("FontSizeComboBox","FontPlaceholder",A.a.NMd.toString(),w.a.m2c.toString(),A.a.r1c.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const F=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
e.a.MX(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),I=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',e.a.MX(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.cFc("NoStyle","IndentPlaceholderStyles",
A.a.O0h.toString(),A.a.h4i.toString(),F,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.cFc("FirstLineIndent","IndentPlaceholderStyles",A.a.N0h.toString(),A.a.y1f.toString(),I,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}TBd(F,I,K,J,N,R,O){K=z.c(F,K,!0,!0,J,N,e.a.Af(R),!0,O);this.wGd(F,I,K,"Medium")}cFc(F,I,K,J,N,R,O){K=z.f(F,K,J,e.a.Af(N),e.a.Af(R),O);this.wGd(F,I,K,"Large",R)}wGd(F,I,K,J,N=null){I=document.getElementById(I);
this.pu.OYa(F,K);K=this.pu.ODb(F,J);N&&a.a.tAd(K,String.format("{0}Label",F),N);I.appendChild(K);this.pu.ypa(F)}BBn(){this.pu.ypa("NoStyle");this.pu.ypa("FirstLineIndent")}dispose(){this.pS||(this.pu.BY("FontStyleComboBox"),this.pu.BY("FontSizeComboBox"),this.pu.BY("NoStyle"),this.pu.BY("FirstLineIndent"),this.pS=!0);this.Jh.updateCommandUI();super.dispose()}static get OTa(){return l.a.instance.resolve("Common.IStandaloneRootController").Zca}static jWl(){return new G(n.App.Ln,G.OTa,y.AFrameworkApplication.va)}static iWl(){return G.jWl()}}
G.fFl=-1;Object(E.a)(G,"FootnoteEndnoteFormattingOptionsDialog",m.a,[])},1791:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(e,a){this.ji=this.Jnd=0;this.IWg=a;this.Hkk=e}qlb(){return this.Jnd-this.ji>=this.Hkk}reset(){this.ji=this.Jnd=this.IWg()}update(){this.Jnd=this.IWg()}}Object(E.a)(m,"TimeBasedTaskYieldStrategy",null,[590])},1802:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.contentId=""}}Object(E.a)(m,"AtMentionOptionalAttributes",
null,[])},1831:function(E,M){Object.defineProperty(M,"__esModule",{value:!0});M.ObjectSchemaType=M.ObjectSemantic=M.SequenceType=M.IntentIds=void 0;(function(c){c.Logging="Logging";c.ZeroTermMenu="ZeroTermMenu";c.Floatie="Floatie"})(M.IntentIds||(M.IntentIds={}));(function(c){c.CommandId="CommandId";c.ControlId="ControlId"})(M.SequenceType||(M.SequenceType={}));(function(c){c.CommandIdHistory="CommandIdHistory";c.ControlIdHistory="ControlIdHistory";c.FilteredCommandIdHistory="FilteredCommandIdHistory";
c.CanvasContext="CanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.GenericSuggestions="GenericSuggestions"})(M.ObjectSemantic||(M.ObjectSemantic={}));(function(c){c.CommandExecutionSequence="CommandExecutionSequence";c.WordCanvasContext="WordCanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.RankedSuggestion="RankedSuggestion"})(M.ObjectSchemaType||(M.ObjectSchemaType={}))},1832:function(E,M,c){Object.defineProperty(M,"__esModule",
{value:!0});M.SearchSuggestionAnnotation=M.SearchSuggestionSignal=void 0;const m=c(211);class e{constructor(l){m.SchemaObject.assign(e,this,l)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[e.getTypeName()])}}M.SearchSuggestionSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=
l}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}M.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1840:function(E,M,c){var m=this&&this.lE||(Object.create?function(a,l,y,z){void 0===z&&(z=y);var n=Object.getOwnPropertyDescriptor(l,y);if(!n||("get"in n?!l.bC:n.writable||n.configurable))n={enumerable:!0,
get:function(){return l[y]}};Object.defineProperty(a,z,n)}:function(a,l,y,z){void 0===z&&(z=y);a[z]=l[y]}),e=this&&this.__exportStar||function(a,l){for(var y in a)"default"===y||Object.prototype.hasOwnProperty.call(l,y)||m(l,a,y)};Object.defineProperty(M,"__esModule",{value:!0});e(c(1841),M);e(c(1842),M);e(c(1843),M);e(c(1844),M);E.exports.ContractEntityAnnotation||Object.defineProperty(E.exports,"ContractEntityAnnotation",{enumerable:!0,get:function(){return E.exports.ContractEntityAnnotation}});
E.exports.ContractEntitySignal||Object.defineProperty(E.exports,"ContractEntitySignal",{enumerable:!0,get:function(){return E.exports.ContractEntitySignal}})},1841:function(E,M){Object.defineProperty(M,"__esModule",{value:!0})},1842:function(E,M){Object.defineProperty(M,"__esModule",{value:!0})},1843:function(E,M,c){Object.defineProperty(M,"__esModule",{value:!0});M.ContractEntityAnnotation=void 0;const m=c(211);class e{constructor(a){m.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=
a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}M.ContractEntityAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1844:function(E,M,c){Object.defineProperty(M,"__esModule",{value:!0});M.ContractEntitySignal=void 0;const m=c(211);class e{constructor(a){m.SchemaObject.assign(e,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])}}M.ContractEntitySignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1846:function(E,M,c){c.r(M);c.d(M,"ReactOICErrorDialogWithTrial",function(){return l});E=c(0);var m=c(55);M=c(1687);var e=c(459),a=c(174);class l extends M.a{constructor(y,z,n,v,A,w){super(y,z,n,v,A,w);z={["errorMessage"]:this.FWh,["offerString"]:this.iRi};y=new a.a(!1,!1,!0);this.Uqj?(y.Ad=1,z.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.pib,["onExecute"]:()=>{e.Redirect.showHelp(this.Umi)}}):
(y.Ad=4,y.Ee(2,this.doi));y.Ee(1,this.lyd);y.vg=this.id;z={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:z};y.Wh(this.dialogTitle,Object(m.a)(this,this.tNn,"reactOICErrorDialogWithTrialHandler"),z)}}Object(E.a)(l,"ReactOICErrorDialogWithTrial",M.a,[])},1847:function(E,M,c){c.r(M);c.d(M,"OICErrorDialogWithTrial",function(){return a});E=c(0);var m=c(55);M=c(1687);var e=c(175);class a extends M.a{constructor(l,y,z,n,v,A){super(l,y,z,n,v,A);l=document.createElement("span");l.innerText=this.FWh;
l.appendChild(document.createElement("br"));l.appendChild(document.createElement("br"));y=document.createElement("span");y.innerText=this.iRi;l.appendChild(y);y=new e.StandardDialog;this.Uqj?(y.Ad=1,y.IYe(this.pib,this.Umi)):(y.Ad=4,y.Ee(2,this.doi));y.Ee(1,this.lyd);y.vg=this.id;y.Gu(this.dialogTitle,null,this.icon,Object(m.a)(this,this.wXm,"legacyOICErrorDialogWithTrialHandler"),l)}}Object(E.a)(a,"OICErrorDialogWithTrial",M.a,[])},1849:function(E,M,c){var m=this&&this.lE||(Object.create?function(a,
l,y,z){void 0===z&&(z=y);Object.defineProperty(a,z,{enumerable:!0,get:function(){return l[y]}})}:function(a,l,y,z){void 0===z&&(z=y);a[z]=l[y]}),e=this&&this.__exportStar||function(a,l){for(var y in a)"default"===y||Object.prototype.hasOwnProperty.call(l,y)||m(l,a,y)};Object.defineProperty(M,"__esModule",{value:!0});e(c(1850),M);e(c(1851),M);E.exports.SearchProviderAnnotation||Object.defineProperty(E.exports,"SearchProviderAnnotation",{enumerable:!0,get:function(){return E.exports.SearchProviderAnnotation}});
E.exports.SearchProviderSignal||Object.defineProperty(E.exports,"SearchProviderSignal",{enumerable:!0,get:function(){return E.exports.SearchProviderSignal}})},1850:function(E,M){Object.defineProperty(M,"__esModule",{value:!0})},1851:function(E,M,c){Object.defineProperty(M,"__esModule",{value:!0});M.SearchProviderAnnotation=M.SearchProviderSignal=void 0;const m=c(211);class e{constructor(l){m.SchemaObject.assign(e,this,l)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,
[e.getTypeName()])}}M.SearchProviderSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}M.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1852:function(E,
M,c){var m=this&&this.lE||(Object.create?function(a,l,y,z){void 0===z&&(z=y);var n=Object.getOwnPropertyDescriptor(l,y);if(!n||("get"in n?!l.bC:n.writable||n.configurable))n={enumerable:!0,get:function(){return l[y]}};Object.defineProperty(a,z,n)}:function(a,l,y,z){void 0===z&&(z=y);a[z]=l[y]}),e=this&&this.__exportStar||function(a,l){for(var y in a)"default"===y||Object.prototype.hasOwnProperty.call(l,y)||m(l,a,y)};Object.defineProperty(M,"__esModule",{value:!0});e(c(1853),M);e(c(1854),M);E.exports.Result||
Object.defineProperty(E.exports,"Result",{enumerable:!0,get:function(){return E.exports.Result}});E.exports.TextExtractiveSummaryAnnotation||Object.defineProperty(E.exports,"TextExtractiveSummaryAnnotation",{enumerable:!0,get:function(){return E.exports.TextExtractiveSummaryAnnotation}})},1853:function(E,M){Object.defineProperty(M,"__esModule",{value:!0});M.Result=void 0;E=M.Result||(M.Result={});E.BlockedByPostfilter="BlockedByPostfilter";E.BlockedByPostfilterProcessError="BlockedByPostfilterProcessError";
E.BlockedByPrefilter="BlockedByPrefilter";E.BlockedByQualityCheck="BlockedByQualityCheck";E.InvalidRequestForm="InvalidRequestForm";E.Success="Success";E.UnknownError="UnknownError"},1854:function(E,M,c){Object.defineProperty(M,"__esModule",{value:!0});M.TextExtractiveSummaryAnnotation=M.ExtractiveSummarizationArray=M.ExtractiveSummarization=void 0;const m=c(211);class e{constructor(y){m.SchemaObject.assign(e,this,y)}static getTypeName(){return"AugLoop_TextExtractiveSummarization_ExtractiveSummarization"}static getBaseTypes(){return[]}static typeGuard(y){return m.SchemaObject.matchesTypesFor(y,
[e.getTypeName()])}}M.ExtractiveSummarization=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(y){m.SchemaObject.assign(a,this,y)}static getTypeName(){return"AugLoop_TextExtractiveSummarization_ExtractiveSummarizationArray"}static getBaseTypes(){return[]}static typeGuard(y){return m.SchemaObject.matchesTypesFor(y,[a.getTypeName()])}}M.ExtractiveSummarizationArray=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(y){m.SchemaObject.assign(l,this,y)}get metadata(){return this.M_}set metadata(y){this.M_=
y}static getTypeName(){return"AugLoop_TextExtractiveSummarization_TextExtractiveSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(y){return m.SchemaObject.matchesTypesFor(y,[l.getTypeName()])}}M.TextExtractiveSummaryAnnotation=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},1926:function(E,M,c){function m(ka){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");ka?
N.VUn():N.main();Si.main(ka);ai.main(ka);A.a.instance.Fc(new Hf,0,ka);A.a.instance.Fc(new Og,0,ka);mj(ka);En(ka)}var e=c(0),a=c(7),l=c(1577),y=c(1590),z=c(2),n=c(83),v=c(742),A=c(179),w=c(35),G=c(39),F=c(20),I=c(82),K=c(22),J=c(119);class N{get name(){return"Common.App.OAuth.OAuthPackage"}xc(ka){ka.register(281,"Common.App.OAuth.IOAuthManager").singleInstance().Rd(()=>new l.OAuthManager)}init(){const ka=K.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.tNo(ka)}tNo(ka){const Va=z.AFrameworkApplication.K.jb("FileSource");
if(z.AFrameworkApplication.K.$("IsO365ConsumerHost")||z.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===Va){var vb=v.OAuthManagerSettings.p$e;if(vb&&vb.IsEnabled){var Wb=vb.Application,nc=v.OAuthManagerSettings.authority;if(void 0!==Wb&&null!==Wb&&Wb.length&&void 0!==nc&&null!==nc&&nc.length){var Qc=y.a[ka.f$],Hd=F.a.bG,xd=ka.QK();try{var Id=new Map;void 0!==Id&&null!==Id?(Id.set("SupportStatus",Qc),Id.set("Browser",Hd),Id.set("AuthStrategy",xd)):Id=null}catch(mf){Id=null}n.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT",
"WacOAuthFC",Id);var Ve=G.a.$e();ka.PY("Core",Wb).then(mf=>{const fg=Math.floor(G.a.$e()-Ve);Qc=y.a[ka.f$];Hd=F.a.bG;xd=ka.QK();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',fg,mf.IsSuccess,Qc,mf.ErrorCode,Va,Hd,xd);Id&&(Id.set("SupportStatus",Qc),Id.set("Browser",Hd),Id.set("AuthStrategy",xd));var Dg=Object.assign(new J.a,{durationMs:fg,
extendedProperties:Id});if(mf.IsSuccess){if(n.Health.instance.recordKpiSuccess("WacCorePFT",Dg),mf="Bearer "+mf.Token,z.AFrameworkApplication.Ne.zog=mf,Dg=vb.Endpoint){var Zf=G.a.$e();z.AFrameworkApplication.Ne.c0b(Dg,1,null,{["Authorization"]:mf},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Ci=>{var og=Math.floor(G.a.$e()-Zf),cl=null;Ci.zo?Ci="Canceled":Ci.Ci?Ci="Faulted":(cl=Ci.result,Ci=cl.succeeded?"Completed":"Failed");og={["TaskResult"]:Ci,["BrowserTokenDurationMS"]:fg,
["BrowserValidationDurationMS"]:og};cl&&(og.HttpStatus=cl.args.data.Qe,cl.succeeded&&(cl=w.a(cl.args.data.xe),og.ServerValidationDurationMS=cl.ElapsedMilliseconds,og.ServerValidationResult=cl.ValidatedToken,og.KMSI=cl.KMSI,og.Scopes=cl.Scopes,og.TokenExpirationS=Math.floor(parseInt(cl.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,3E3,"Completed"===Ci?50:15,I.a.toJSON(og))})}}else n.Health.instance.recordKpiFailure("WacCorePFT",mf.ErrorCode,!1,!1,Dg)}).catch(mf=>{var fg=Math.floor(G.a.$e()-
Ve);fg=Object.assign(new J.a,{durationMs:fg,extendedProperties:Id});n.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+mf.toString(),!1,!1,fg)})}}}}dispose(){}static main(){A.a.instance.Fc(new N)}static VUn(){A.a.instance.Fc(new N,0,!0)}}Object(e.a)(N,"OAuthPackage",null,[1,2]);var R=c(372),O=c(365),L=c(19);class U{constructor(){this.ztd=new O.a}fNo(ka,Va){if(!ka)return a.ULS.sendTraceTag(40478031,306,10,"SDX AssetId is null."),!1;ka=L.a.Tg(ka);if(this.ztd.nb(ka))return a.ULS.sendTraceTag(40478032,
306,10,"ISdxPaneSuppressionHandler already registered for SDX AssetId: {0}.",ka),!1;this.ztd.Z(ka,Va);return!0}j5l(ka){if(!ka)return a.ULS.sendTraceTag(40478033,306,10,"SDX AssetId is null."),null;ka=L.a.Tg(ka);return this.ztd.nb(ka)?this.ztd.J(ka):(a.ULS.sendTraceTag(40478034,306,10,"ISdxPaneSuppressionHandler does not exist for SDX AssetId: {0}.",ka),null)}}Object(e.a)(U,"SdxPaneSuppressionManager",null,[]);var W=c(243),X=c(251),V=c(9);class Z{constructor(ka){this.FKe=0;this.Uak=ka}qlb(){return this.FKe>=
this.Uak}reset(){this.FKe=0}update(){this.FKe++}}Object(e.a)(Z,"NodeCountBasedTaskYieldStrategy",null,[590]);var da=c(1791);class aa{constructor(){this.s6c=new Set}xMb(ka){this.s6c.add(ka)}BPo(ka){this.s6c.delete(ka)}Vrn(){return()=>{this.s6c.forEach(ka=>{ka.onSessionClose()})}}Wrn(){return()=>{this.s6c.forEach(ka=>{ka.onSessionConnect()})}}Xrn(){return()=>{this.s6c.forEach(ka=>{ka.onSessionDisconnect()})}}}Object(e.a)(aa,"AlSessionLifeEventNotifier",null,[553]);var ea=c(1381),na=c(80),pa=c(92),ja=
c(58),ma=c(6),Ia=c(1492),Ja=c(153),Ka=c(330),Ma=c(1026),sa=c(695),xa=c(237),ia=c(408),ha=c(670),ua=c(415),ya=c(402);class ra{constructor(){this.token=null}}Object(e.a)(ra,"ReleaseAnnotationParameters",null,[]);class La{constructor(){this.value=this.id=this.parentPath=null}}Object(e.a)(La,"SetAnnotationMetadataParameters",null,[]);class oa{constructor(){this.id=this.parentPath=null;this.value=0}}Object(e.a)(oa,"SetAnnotationStateParameters",null,[]);var Ca=c(585),Aa=c(355),db=c(74),eb=c(77),ib=c(588),
lb=c(1199),Ya=c(305),Fa=c(743),$a=c(8),Db=c(397);class gc extends Sys.EventArgs{constructor(ka,Va){super();this.annotation=ka;this.xdb=Va}}Object(e.a)(gc,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var Eb=c(999);class kb{constructor(ka){this.x0e=this.annotations=null;if(!ka)a.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.annotations=null;else if(ka.items&&0<ka.items.length){const Va=kb.aRd(ka.parentPath);this.annotations=Array(ka.items.length);let vb=0;for(const Wb of ka.items){const nc=
Object.assign(new Eb.a,{id:Wb.id,parentPath:Va,content:Wb.body,annotationType:xa.a.getTypeNameFor(Wb.body),parentRevId:ka.parentRevId});this.annotations[vb++]=nc}this.x0e=xa.a.getTypeNameFor(ka)}}static aRd(ka){return ka?ka.join("\\"):""}}Object(e.a)(kb,"AnnotationOperation",null,[]);class bb extends Sys.EventArgs{constructor(ka,Va){super();this.annotationType=ka;this.activated=Va}}Object(e.a)(bb,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class Gb extends Sys.EventArgs{constructor(ka,Va){super();
this.annotation=ka;this.opType=Va}}Object(e.a)(Gb,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class Sa{constructor(){this.newState=this.oldState=0;this.handlers=new db.a}}Object(e.a)(Sa,"AnnotationResultStateUpdateData",null,[]);var Pa=c(603),Ab=c(993);class nb{constructor(){this.u0e=this.gBk=this.v0e=null}}Object(e.a)(nb,"AnnotationCallbacks",null,[]);class Rb{constructor(ka,Va,vb,Wb,nc,Qc){this.B_b=null;this.vyc=new O.a(0);this.OCc=new O.a;this.Ydd=new O.a;this.crd=new Pa.a;this.dVf=null;this.ri=
ka;this.SKa=Va;this.KF=vb;this.cC=Wb;this.vI=nc;this.ld=Qc}W0o(ka,Va,vb,Wb){this.cC.y$b(ka)&&this.ri.ie(()=>{if(!this.B_b){this.B_b=new O.a;var nc=$a.ParagraphReader.jw(Db.a.getRootNode(),!0,!0);for(const Qc of nc)Qc&&(nc=Qc.ia(ma.a.Lc,0))&&(this.B_b.add(nc,Qc.id),this.vyc.Z(Qc.id.toString(),nc))}this.SKa.cVf(ka,(Qc,Hd)=>{if(Qc){var xd=this.cC.Dai(ka);Qc.contentDescriptor.Gv===xd&&((xd=this.HWl(Qc))?Qc.wdb?(xd=this.C$e(Qc,xd))&&(Hd?vb(Hd,Qc.contentDescriptor):Va(xd,Qc.contentDescriptor)):Wb(Qc.contentDescriptor):
this.qhl(Qc,Object.assign(new nb,{v0e:Va,gBk:vb,u0e:Wb})))}})},"PAS:FEPAOT")}HWl(ka){if(3===ka.contentDescriptor.Gv){let Va;return({value:Va}=this.B_b.Dc(ka.contentDescriptor.paragraphId)).returnValue?Va:null}if(4===ka.contentDescriptor.Gv)return ja.a.nil;a.ULS.sendTraceTag(592525442,Rb.Ei,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}EJm(ka,Va){if(3===ka.contentDescriptor.Gv)return Va=this.vI.value.Db(Va).getValue(ma.a.qj),ka.contentDescriptor.qj===Va;if(4===
ka.contentDescriptor.Gv&&Va===ja.a.nil)return!0;a.ULS.sendTraceTag(592525443,Rb.Ei,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}qhl(ka,Va){if(3===ka.contentDescriptor.Gv){const vb=ka.contentDescriptor.paragraphId;this.OCc.nb(vb)||this.OCc.add(vb,new db.a);this.OCc.J(vb).add(Wb=>{12===Wb.type&&this.B_b.add(vb,Wb.id);ka.wdb?(Wb=this.C$e(ka,Wb.id))&&Va.v0e(Wb,ka.contentDescriptor):Va.u0e(ka.contentDescriptor)})}else if(4===ka.contentDescriptor.Gv)if(ka.wdb){const vb=this.C$e(ka,
ja.a.nil);vb&&Va.v0e(vb,ka.contentDescriptor)}else Va.u0e(ka.contentDescriptor);else a.ULS.sendTraceTag(592525444,Rb.Ei,15,"DelayCallbackForAnnotation: Unsupported content type")}C$e(ka,Va){if(this.EJm(ka,Va)){if(Va=this.cC.qfn(ka.wdb,ka.contentDescriptor,Va.toString()))return this.Ydd.Z(Va.id,ka.x5a),Va}else this.ld.isFeatureEnabled(89)&&this.KF.qDc(ka);return null}ZFj(ka,Va){const vb=this.cC.pOd(ka);vb&&(Va===Ma.a.getTypeName()?this.LLo(ka,vb):this.yLo(ka,vb))}LLo(ka,Va){this.cC.y$b(ka.annotationType)&&
(this.KF.oSa(this.vI.value,Va,ka.annotationType),this.Ydd.remove(ka.id))}yLo(ka,Va){if(this.cC.y$b(ka.annotationType)){Va=Object.assign(new Ab.a,{wdb:this.cC.kBk(ka),contentDescriptor:Va,annotationType:ka.annotationType});Va=this.KF.addAnnotation(this.vI.value,Va);this.Ydd.Z(ka.id,Va);const vb=this.cC.cji(ka.annotationType);vb&&this.crd.contains(vb)&&(this.ri.ie(()=>{var Wb=$a.ParagraphReader.jw(Db.a.getRootNode(),!0,!0);if(Wb&&0<Wb.count){const nc=new db.a;for(const Qc of Wb)(Wb=Rb.XQd(Qc))&&nc.add(Wb);
0<nc.count&&this.KF.ioh(this.vI.value,vb,nc.toArray())}},"PAS:TAOCPA"),this.crd.remove(vb))}}bmb(ka){if(this.B_b)if(ka){var Va=ka.ia(ma.a.Lc,0);if(Va&&(this.vyc.Z(ka.id.toString(),Va),({value:Va}=this.OCc.Dc(Va)).returnValue))for(const vb of Va)vb(ka)}else a.ULS.sendTraceTag(592525445,Rb.Ei,10,"OnParagraphNodeConnected: Invalid node")}dVi(ka,Va){if(ka){var vb=ka.id.toString();ka=ka.ia(ma.a.Lc,0);var Wb=0;({value:Wb}=this.vyc.Dc(vb)).returnValue&&(3===Va?(this.OCc.remove(Wb),this.vyc.remove(vb)):2===
Va?this.vyc.Z(vb,ka):a.ULS.sendTraceTag(592525447,Rb.Ei,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,Rb.Ei,10,"UpdatePersistedAnnotations: Invalid node")}Z8l(ka){let Va;return({value:Va}=this.Ydd.Dc(ka)).returnValue?Va:ja.a.nil}DXo(ka,Va,vb){ka?Va?this.SKa.hdi(ka,Wb=>{if(Wb){const Hd=Rb.XQd(Va,vb);if(Hd){var nc=Array(Wb.length),Qc=!1;for(let xd=0;xd<Wb.length;xd++)if(Qc||Hd!==Wb[xd])nc[xd]=Wb[xd];else{const Id=Rb.XQd(Va);if(!Id)return;
Qc=!0;nc[xd]=Id;Wb[xd]=Id}Qc&&this.KF.ioh(this.vI.value,ka,nc)}}}):a.ULS.sendTraceTag(588863697,Rb.Ei,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,Rb.Ei,10,"UpdateWorkflowParagraphVersion: null workflowType")}zjo(ka){ka?this.crd.add(ka):a.ULS.sendTraceTag(588863698,Rb.Ei,10,"SetPendingWorkflow: null workflowType")}rXk(ka){ka?this.crd.remove(ka):a.ULS.sendTraceTag(588105731,Rb.Ei,10,"ClearPendingWorkflow: null workflowType")}static XQd(ka,Va=0){if(!ka)return null;
Va||(Va=ka.ia(ma.a.qj,0));ka=$a.ParagraphReader.LQ(ka);if(Va&&ka)return String.format("{0}{1}{2}",ka,Rb.fyn,Va);a.ULS.sendTraceTag(588091606,Rb.Ei,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",Va?"valid":"0",ka?"valid":"0");return null}}Rb.Ei=389;Rb.fyn="-";Object(e.a)(Rb,"PersistedAnnotationStorage",null,[587]);class Mb{constructor(){this.config=this.token=null}}Object(e.a)(Mb,"UpdateAnnotationConfigParameters",null,[]);var oc=c(120),xb=c(1179),cc=c(335),Ob=c(1392),Ub=c(853),
pb=c(202),Zb=c(1086);class Wa{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd,Id,Ve,mf,fg=null,Dg){this.ccb=Dg;this.ra=new na.a;this.Cza=new eb.a;this.L5=new eb.a;this.lD=new eb.a;this.Ase=new eb.a;this.irc=new Ca.a(Aa.a.ei());this.dMe=new db.a;this.eSb=new eb.a;this.wse=new eb.a;this.Zdd=new eb.a;this.fSb=new eb.a;this.xoc=new eb.a;this.$dd=new eb.a;this.ngd=new eb.a;this.ipd=[];this.jpd=[];this.Ewc=null;this.Vak=new Ca.a(Aa.a.ei());this.yse=new Map;this.frc=new Map;this.Hpc=null;this.Jja=new eb.a;this.yIc=
null;this.K$g=this.UZg=0;this.QXa=null;this.Jel=()=>{if(this.ipd.length||this.jpd.length)try{0<this.ipd.length&&this.V8m(),0<this.jpd.length&&this.WOo()}finally{this.EXk()}else this.Hb.Ve(this.Ewc),this.Ewc=null};this.AXk=()=>{const Zf=new db.a;for(const Ci of this.lD.values)if(Zf.add(Ci),Zf.count===Wa.ebk)break;for(const Ci of Zf)this.MBb(Ci),this.ENb(Ci,Ma.a.getTypeName());this.lD.count||(this.Hb.Ve(this.Hpc),this.Hpc=null)};this.q_c=(Zf,Ci)=>{for(const og of Ci.Hj)Zf=og.intent,!Zf.type&&this.Zoo(Zf.intent,
og.cpBegin,og.cpEnd,og.AIb)&&this.MBb(Zf.intent)};this.N6j=ka.$("AugLoopAnnotationsAttachingIsEnabled");this.uhk=ka.GC("SendReleaseMessageAnnotationList")||[];this.ld=Ve;this.hJa=fg;this.SKa=Qc;this.KF=Hd;this.Fm=vb;this.cC=xd;this.W$=Id;this.vI=Wb;this.ri=Va;this.Hb=nc;K.a.instance.resolve("Box4.ICharacterPropertiesEditor").XZe(this.q_c);this.ur=mf;this.WUj=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",!1);this.C6j=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1);this.o8j=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContext",!1);this.Z0g=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContextLogs",!1);this.ccb&&this.rmm();this.Ry=pb.a.instance}get D8i(){return this.fSb}set D8i(ka){this.fSb=ka}lb(ka,Va){a.ULS.sendTraceTag(41521862,Wa.Ei,50,"New registration for annotation type: {0}.",Va);this.addHandler(ka,Va);this.RXe(Va).catch(vb=>{a.ULS.sendTraceTag(594396739,Wa.Ei,10,"Failed to activate annotation type {0}: {1}",
Va,vb.toString())})}addHandler(ka,Va){if(ka&&Va&&""!==Va){var vb=null;({value:vb}=this.fSb.Dc(Va,vb)).returnValue?vb.add(ka):(vb=new db.a,vb.add(ka),this.fSb.add(Va,vb))}else a.ULS.sendTraceTag(41521861,Wa.Ei,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!ka,!Va,""===Va)}rc(ka,Va){a.ULS.sendTraceTag(41521863,Wa.Ei,50,"Unregister handler for annotation type: {0}.",Va);let vb=null;({value:vb}=this.fSb.Dc(Va,vb)).returnValue&&(vb.remove(ka),
vb.count||(a.ULS.sendTraceTag(41521864,Wa.Ei,50,"Unregister all handlers for annotation type: {0}.",Va),this.fSb.remove(Va),this.Pin(Va)))}mmj(ka){this.yIc||(this.yIc=this.ur.Mc(2),this.yIc.Cb(ka))}EXk(){var ka;null===(ka=this.yIc)||void 0===ka?void 0:ka.dispose();this.yIc=null}dKh(){this.Ewc||(this.Ewc=new pa.a(4,2,100,this.Jel,141),this.Hb.Vb(this.Ewc))}V8m(){let ka;ka=Array.dequeue(this.ipd);const Va=Db.a.wEb(this.vI.value,ka);if(Va)if(Va.hj){this.mmj(Va);var vb=null;if(({value:vb}=this.xoc.Dc(ka,
vb)).returnValue){this.xoc.remove(ka);for(const Wb of vb)this.W8m(Va,Wb)}else a.ULS.sendTraceTag(50663568,Wa.Ei,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.Vak.add(ka);else a.ULS.sendTraceTag(50436127,Wa.Ei,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}W8m(ka,Va){var vb=Va.content.range;vb=new lb.a(0,vb.start,vb.start+vb.length,ja.a.create(),Va,Wb=>{this.Ase.Z(Va.id,Wb.toString())});this.Fm.$Qa(ka,vb);this.ra.l8&&this.ra.raiseEvent(Wa.iec,new Gb(Va,
Ka.a.getTypeName()))}NLi(ka){const Va=Db.a.v1a(ka.parentPath);let vb=null;({value:vb}=this.xoc.Dc(Va,vb)).returnValue||(vb=new db.a,this.xoc.add(Va,vb),this.ipd.push(Va));vb.add(ka);this.dKh()}Y8m(ka,Va){this.ri.ie(()=>{let vb;if(({value:vb}=this.L5.Dc(ka,vb)).returnValue){var Wb=this.Apj(ka);for(const nc of vb){let Qc;({value:Qc}=this.lD.Dc(nc,Qc)).returnValue&&Va(Qc)&&Wa.AGb(Qc)&&(this.NLi(Qc),Wb&&this.ra.raiseEvent(Wa.iec,new Gb(Qc,Ma.a.getTypeName())))}}},"AS:MIFAT")}XOo(ka,Va){this.ri.ie(()=>
{let vb;if(({value:vb}=this.L5.Dc(ka,vb)).returnValue)for(const Wb of vb){let nc;({value:nc}=this.lD.Dc(Wb,nc)).returnValue&&Va(nc)&&Wa.AGb(nc)&&this.jlg(nc)}},"AS:UIFAT")}Win(ka){var Va=Db.a.sM(ka);let vb=null;if(({value:vb}=this.Cza.Dc(Va,vb)).returnValue){Va=0;for(var Wb=new db.a;vb.count>Va;){var nc=vb.J(Va),Qc=null;({value:Qc}=this.lD.Dc(nc,Qc)).returnValue&&Wa.AGb(Qc)?this.cC.F7c(ka,Qc)?this.MBb(Qc,!this.ld.isFeatureEnabled(89)):(nc=Qc.content.range,Qc=new lb.a(0,nc.start,nc.start+nc.length,
ja.a.create(),Qc),Wb.add(Qc),Va++):Va++}0<Wb.count&&this.Fm.w3d(ka,Wb)}}WOo(){let ka="";ka=Array.dequeue(this.jpd);const Va=Db.a.wEb(this.vI.value,ka);if(Va&&12===Va.type){this.mmj(Va);var vb=null;({value:vb}=this.$dd.Dc(ka,vb)).returnValue?(this.Fm.sad(Wb=>vb.contains(Wb.intent),Va,0),this.$dd.remove(ka)):a.ULS.sendTraceTag(50663570,Wa.Ei,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")}else a.ULS.sendTraceTag(50436128,Wa.Ei,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}jlg(ka){let Va;
({value:Va}=this.Ase.Dc(ka.id,Va)).returnValue||(Va=Db.a.v1a(ka.parentPath));this.Ase.remove(ka.id);var vb=null;({value:vb}=this.$dd.Dc(Va,vb)).returnValue||(vb=new db.a,this.$dd.add(Va,vb),this.jpd.push(Va));vb.add(ka);this.dKh();vb=null;({value:vb}=this.xoc.Dc(Va,vb)).returnValue&&vb.remove(ka)}psk(ka){const Va=ka.id;var vb=ka.annotationType;const Wb=ka.parentPath;if(this.cC.Ljb(ka)){var nc=Db.a.Ehb(this.vI.value,Wb);if(nc&&(nc=nc.ia(ma.a.qj,0).toString(),ka.parentRevId&&nc!==ka.parentRevId))return!1}nc=
null;({value:nc}=this.L5.Dc(vb,nc)).returnValue||(nc=new db.a,this.L5.add(vb,nc));nc.add(Va);vb=null;({value:vb}=this.Cza.Dc(Wb,vb)).returnValue||(vb=new db.a,this.Cza.add(Wb,vb));vb.add(Va);this.lD.add(Va,ka);this.V0o(ka);return!0}V0o(ka){const Va=this.cC.k3h(ka);if(0===Va.length)this.URh(ka);else{let vb=!1;this.SKa.Jpn(Va,ka.annotationType,(Wb,nc)=>{this.lD.nb(ka.id)?(nc=this.cC.dkb(ka,Db.a.fLl(ka)),!Wb&&nc?this.rmg(ka,10,!1):Wb&&this.rmg(ka,Wb),vb||(this.URh(ka),vb=!0)):nc.hTa=!0})}}URh(ka){const Va=
Wa.AGb(ka);Va&&this.NLi(ka);!Va&&this.ra.l8&&this.ra.raiseEvent(Wa.iec,new Gb(ka,Ka.a.getTypeName()))}vDj(ka,Va,vb,Wb){let nc=!0;this.ri.ie(()=>{if(Wb.startsWith(Db.a.ZBb)){var Qc=ka.id,Hd=null;if(Va===Ma.a.getTypeName())this.MBb(ka);else if(({value:Hd}=this.lD.Dc(Qc,Hd)).returnValue)a.ULS.sendTraceTag(41418891,Wa.Ei,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",Qc,ka.annotationType),this.lD.Z(Qc,ka);else if(!this.psk(ka)){nc=!1;return}vb&&Va===Ka.a.getTypeName()&&
Wb!==Db.a.ZBb&&this.dMe.add(ka.annotationType)}this.ENb(ka,Va)},"AS:UAS");return nc}Seo(ka){if(ka)for(const Va of ka)this.ENb(Va,sa.a.getTypeName()),ka=Va.content,this.ngd.nb(ka.categoryName)?this.ngd.Z(ka.categoryName,Va):this.ngd.add(ka.categoryName,Va);else a.ULS.sendTraceTag(592802119,Wa.Ei,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}Xvk(ka){this.ra.addHandler(Wa.iec,ka)}Fph(ka){this.ra.addHandler(Wa.URi,ka)}x$b(ka){return this.eSb.nb(ka)}Wvk(ka){this.ra.addHandler(Wa.R5d,
ka)}VZn(ka){this.ra.removeHandler(Wa.R5d,ka)}Apj(ka){return!Db.a.jf(ka)&&Fa.a(ka)&&this.ra.l8}MBb(ka,Va=!0){if(this.lD.nb(ka.id)){var vb=this.lD.J(ka.id);this.lD.remove(ka.id);var Wb=null;({value:Wb}=this.Cza.Dc(ka.parentPath,Wb)).returnValue?(Wb.remove(ka.id),Wa.AGb(vb)&&this.jlg(vb)):a.ULS.sendTraceTag(50734169,Wa.Ei,15,"DeleteAnnotationFromStorage: No annotations in given parent path");Wb=null;({value:Wb}=this.L5.Dc(ka.annotationType,Wb)).returnValue?Wb.remove(ka.id):a.ULS.sendTraceTag(50734170,
Wa.Ei,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.Apj(ka.annotationType)?this.ra.raiseEvent(Wa.iec,new Gb(vb,Ma.a.getTypeName())):this.ENb(ka,Ma.a.getTypeName());Va&&this.W$.ZFj(vb,Ma.a.getTypeName())}}anf(ka,Va,vb=!1){const Wb=new db.a;var nc;if(!({value:nc}=this.L5.Dc(ka,nc)).returnValue)return Wb;for(const Qc of nc)this.lD.nb(Qc)?(ka=this.lD.J(Qc),(nc=this.cC.pOd(ka))&&(Va.equals(nc)||vb&&Va.overlaps(nc))&&Wb.add(ka)):a.ULS.sendTraceTag(577843217,
Wa.Ei,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",Qc);return Wb}ZHd(ka){let Va=null;if(({value:Va}=this.L5.Dc(ka,Va)).returnValue){ka=Va.toArray();for(const vb of ka){let Wb;({value:Wb}=this.lD.Dc(vb,Wb)).returnValue&&this.MBb(Wb)}}}zGm(ka){return xa.a.getTypeNameFor(ka)===cc.a.getTypeName()}Xui(ka){var Va,vb;return(null===(vb=null===(Va=this.ccb)||void 0===Va?void 0:Va.zai)||void 0===vb?void 0:vb.call(Va))===xb.a.xnc&&ka&&0===ka.priority?this.ccb.T9c(ka.context.substr(ka.startInContext,
ka.range.length)):!1}k3i(ka,Va){this.ri.ie(()=>{a.ULS.M9(Wa.Ei,100)&&a.ULS.sendTraceTag(41418894,Wa.Ei,100,"Operation of type {0} with path {1} received",xa.a.getTypeNameFor(ka),ka.parentPath.join("\\"));try{const vb=new kb(ka);for(const Wb of vb.annotations)if(Wb.annotationType===Ub.FlagResultAnnotation.getTypeName()){const nc=Wb.content.results.map(Qc=>{var Hd;const xd=null===(Hd=Qc.M_)||void 0===Hd?void 0:Hd.seq;Hd=void 0===xd?Wb.id:Wb.id+"_"+xd;return{id:Hd,body:{...Qc,id:Hd},source:"",revId:"",
contextId:"",sourceTimestamp:Date.now()}});this.k3i({items:nc,parentPath:ka.parentPath,parentRevId:ka.parentRevId,H_:ka.H_},Va)}else vb.x0e===Ka.a.getTypeName()&&this.Mro(Wb)?(z.AFrameworkApplication.ue("g8469255;j5hhe441"),this.Z0g&&(this.QXa||(this.QXa=Zb.a.inf()),this.UZg++,this.QXa.Omh("AnnotationSkippedDueToInvalidContextCount",this.UZg.toString()))):this.fwf(Wb,Va,vb.x0e,!0)}catch(vb){a.ULS.sendTraceTag(41418898,Wa.Ei,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",
vb.message,vb.stack)}},"AS:PO")}Mro(ka){var Va;z.AFrameworkApplication.ue("01dfc961;05c12706");if(this.o8j&&Fa.a(ka.annotationType)){var vb;let nc=vb=null;if(this.Ry){vb=this.Ry.E3;var Wb=null===vb||void 0===vb?void 0:vb.node;vb=Db.a.v1a(ka.parentPath);if(Db.a.wEb(this.vI.value,vb)!==Wb)return!1;ka=ka.content;vb=ka.context.substring(ka.startInContext,ka.startInContext+ka.range.length);nc=null===(Va=null===Wb||void 0===Wb?void 0:Wb.characterData)||void 0===Va?void 0:Va.substring(ka.range.start,ka.range.start+
ka.range.length);this.Z0g&&ka&&0===ka.priority&&(Va=0<ka.range.start?Wb.characterData.charAt(ka.range.start-1):null,Wb=ka.range.start+ka.range.length<Wb.characterData.length?Wb.characterData.charAt(ka.range.start+ka.range.length):null,"en-us"==ka.language.toLocaleLowerCase()&&nc&&vb&&nc===vb&&(Va&&Va.match("[A-Za-z0-9]")||Wb&&Wb.match("[A-Za-z0-9]"))&&(this.QXa||(this.QXa=Zb.a.inf()),this.K$g++,this.QXa.Omh("partialWordAnnotationsCount",this.K$g.toString())))}return nc&&vb&&nc!==vb?!0:!1}return!1}fwf(ka,
Va,vb,Wb){if(this.zGm(ka.content)&&this.Xui(ka.content))this.bza(ka,70);else{var nc=ka.parentPath;vb!==Ma.a.getTypeName()&&Wb||this.p9i(ka);Wb&&vb===Ka.a.getTypeName()&&Fa.a(ka.annotationType)&&ka.content.isHotCritique&&this.C6j?this.frc.set(ka.id,{annotation:ka,time:Date.now()}):(Wb=ka.annotationType,Db.a.jf(Wb)||Wb!==ia.a.getTypeName()?!Db.a.jf(Wb)&&Fa.a(Wb)&&ka.content&&0==ka.content.priority&&oc.a.k4?(ka=Db.a.v1a(nc))&&ka==oc.a.yJl()&&a.ULS.sendTraceTag(539870169,Wa.Ei,10,"Skipping the Spelling Error Annotation as Text Prediction is visible"):
vb!==Ma.a.getTypeName()&&this.irc.contains(nc)?a.ULS.sendTraceTag(41418897,Wa.Ei,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",nc,ka.id):this.tDj(ka,nc,vb,Va):a.ULS.sendTraceTag(595342670,Wa.Ei,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",nc))}}aXn(ka){if(ka&&ka.annotationType&&this.cC.y$b(ka.annotationType)){var Va;if(({value:Va}=this.L5.Dc(ka.annotationType,Va)).returnValue&&(ka=this.cC.pOd(ka)))for(const vb of Va){let Wb;
({value:Wb}=this.lD.Dc(vb,Wb)).returnValue&&(Va=this.cC.pOd(Wb))&&(ka.equals(Va)||ka.overlaps(Va))&&this.MBb(Wb)}}}ENb(ka,Va){this.ri.ie(()=>{let vb=null;if(({value:vb}=this.D8i.Dc(ka.annotationType,vb)).returnValue)for(const Wb of vb)Wb.UD(ka,Va)},"AS:SATH")}zXk(){a.ULS.sendTraceTag(50860999,Wa.Ei,50,"ClearStorage: Initiated Clearing Storage");this.Hpc||(this.Hpc=new pa.a(4,2,100,this.AXk,142),this.Hb.Vb(this.Hpc))}activateAnnotation(ka,Va){let vb;if(({value:vb}=this.Zdd.Dc(ka,vb)).returnValue){if(vb.contains(Va))return Promise.resolve(null);
vb.add(Va)}else{let Wb;this.Zdd.add(ka,(Wb=new db.a,Wb.add(Va),Wb))}return this.RXe(ka)}RXe(ka){a.ULS.sendTraceTag(41521865,Wa.Ei,50,"ActivateAnnotation: Activating annotation type {0}.",ka);if(this.eSb.nb(ka))return Promise.resolve(null);var Va=null;if(({value:Va}=this.wse.Dc(ka,Va)).returnValue)return Va;this.ipk(ka);Va=null;this.hJa&&(Va=this.hJa());if(Va){const vb=new ya.a;vb.annotationType=ka;this.WUj&&(this.Jja.nb(ka)||this.Jja.Z(ka,new Sa),vb.stateUpdateHandler=(Wb,nc)=>{this.Jja.J(ka).oldState=
Wb;this.Jja.J(ka).newState=nc;for(const Qc of this.Jja.J(ka).handlers)Qc(ka,Wb,nc)});Va=Va.activateAnnotation(vb);this.wse.add(ka,Va);return Va.then(Wb=>{this.wse.remove(ka);this.eSb.add(ka,Wb.token);this.uDj(Wb.token,ka);this.ra.raiseEvent(Wa.R5d,new bb(ka,!0));this.pmm(ka);return Wb})}return Promise.reject(Error.create("Error during annotation activation"))}pmm(ka){const Va=this.cC.cji(ka);Va&&this.SKa.hdi(Va,vb=>{if(this.W$.dVf){var Wb=$a.ParagraphReader.jw(Db.a.getRootNode(),!0,!0);if(Wb&&0<Wb.count){let nc=
0;for(const Qc of Wb){Wb=Rb.XQd(Qc);if(!Wb)continue;let Hd=!1;for(;nc<vb.length;){if(Wb===vb[nc]){Hd=!0;break}nc++}if(!Hd){this.W$.dVf(Va);break}nc++}}}})}ipk(ka){this.W$.W0o(ka,(Va,vb)=>{0<this.anf(ka,vb,!0).count||this.vDj(Va,Ka.a.getTypeName(),!0,Va.parentPath)},(Va,vb)=>{if(3!==vb.Gv)a.ULS.sendTraceTag(591541786,Wa.Ei,15,"Annotation moved to unsupported location type: {0}",vb.Gv);else if(Va.Gv!==vb.Gv)a.ULS.sendTraceTag(591541787,Wa.Ei,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",
Va.Gv,vb.Gv);else{Va=this.anf(ka,Va);for(const nc of Va){const Qc=nc.content;Va=Db.a.Ehb(this.vI.value,nc.parentPath);if(!Va){a.ULS.sendTraceTag(591541788,Wa.Ei,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.Fm.sad(Hd=>Hd.intent===Qc,Va,0))break;var Wb=vb.Gta;Wb=new lb.a(0,Wb,Wb+vb.Fta,null,Qc);this.Fm.$Qa(Va,Wb)}}},Va=>{for(const vb of this.anf(ka,Va))this.MBb(vb,!1)})}releaseAnnotation(ka,Va){let vb;if(({value:vb}=this.Zdd.Dc(ka,vb)).returnValue){vb.contains(Va)&&
vb.remove(Va);if(0<vb.count)return Promise.resolve(!1);this.Zdd.remove(ka)}a.ULS.sendTraceTag(593790408,Wa.Ei,50,"ReleaseAnnotation: Releasing annotation type {0}.",ka);return this.cij(ka)}Pin(ka){var Va=null;if(({value:Va}=this.L5.Dc(ka,Va)).returnValue){a.ULS.sendTraceTag(41418899,Wa.Ei,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",ka);for(const vb of Va)if(Va=null,({value:Va}=this.lD.Dc(vb,Va)).returnValue){const Wb=Va.parentPath;let nc=null;({value:nc}=this.Cza.Dc(Wb,
nc)).returnValue&&(nc.remove(vb),nc.count||this.Cza.remove(Wb));this.lD.remove(vb);Wa.AGb(Va)&&this.jlg(Va)}this.L5.remove(ka)}Array.contains(this.uhk,ka)&&this.cij(ka)}cij(ka){let Va=null,vb=null;this.hJa&&(vb=this.hJa());if(vb){if(({value:Va}=this.eSb.Dc(ka,Va)).returnValue){const Wb=new ra;Wb.token=Va;this.eSb.remove(ka);this.ra.raiseEvent(Wa.R5d,new bb(ka,!1));return vb.releaseAnnotation(Wb)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}cFi(){this.ri.ie(()=>
{if(this.N6j){var ka=Db.a.getRootNode();if(ka){var Va=new eb.a;ib.e(ka,vb=>{var Wb=Db.a.sM(vb),nc=null;if(({value:nc}=this.Cza.Dc(Wb,nc)).returnValue)for(const Qc of nc)Wb=null,({value:Wb}=this.lD.Dc(Qc,Wb)).returnValue&&(Wb.parent=vb,Wb.vUc=!0,Wb.WKb=2,Va.nb(Wb.annotationType)||Va.Z(Wb.annotationType,new db.a),Va.J(Wb.annotationType).add(Qc),nc=null,({value:nc}=this.L5.Dc(Wb.annotationType,nc)).returnValue&&nc.remove(Wb.id));return!0},12);for(const vb of this.L5.keys)if(ka=null,({value:ka}=this.L5.Dc(vb,
ka)).returnValue)for(const Wb of ka)if(ka=null,({value:ka}=this.lD.Dc(Wb,ka)).returnValue){let nc=null;ka.parentPath===Db.a.ZBb?(ka.WKb=1,ka.parent=null):({value:nc}=this.lD.Dc(ka.parentPath,nc)).returnValue?(ka.WKb=3,ka.parent=nc):(ka.WKb=0,ka.parent=null,a.ULS.sendTraceTag(41554060,Wa.Ei,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",ka.id));ka.vUc=!0;Va.nb(ka.annotationType)||Va.Z(ka.annotationType,new db.a);Va.J(ka.annotationType).add(Wb)}else a.ULS.sendTraceTag(41997840,
Wa.Ei,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",Wb);else a.ULS.sendTraceTag(41997841,Wa.Ei,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",vb);this.L5=Va;this.dMe.clear()}else a.ULS.sendTraceTag(41554058,Wa.Ei,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,Wa.Ei,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}jBk(ka){this.k3i(ka,!0)}Tsn(ka,
Va){this.ri.ie(()=>{const vb=Va?Va+String.format("\\{0}",ka.id):Db.a.sM(ka);a.ULS.sendTraceTag(41418900,Wa.Ei,50,"OnTileDeleted: Tile delete event received for tile {0}.",vb);this.irc.contains(vb)||this.irc.add(vb);var Wb=null;if(({value:Wb}=this.Cza.Dc(vb,Wb)).returnValue){a.ULS.sendTraceTag(41418901,Wa.Ei,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",Wb.count,vb);for(const nc of Wb)Wb=null,({value:Wb}=this.lD.Dc(nc,Wb)).returnValue&&(this.ENb(Wb,Ma.a.getTypeName()),this.ra.l8&&
this.ra.raiseEvent(Wa.iec,new Gb(Wb,Ma.a.getTypeName())),this.lD.remove(nc));this.Cza.remove(vb)}},"AS:OTD")}Ssn(ka){ka=Db.a.sM(ka);this.irc.remove(ka)&&a.ULS.sendTraceTag(41418902,Wa.Ei,50,"OnTileAdded: Deleted tile {0} was re-added.",ka)}IVo(ka){if(ka){a.ULS.sendTraceTag(50436131,Wa.Ei,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",ka.count);var Va=new eb.a;for(var vb of ka)ka=null,({value:ka}=Va.Dc(vb.parentPath,ka)).returnValue||(ka=new eb.a,Va.add(vb.parentPath,ka)),ka.Z(vb.id,
vb);for(const Wb of Va){Va=Db.a.Ehb(this.vI.value,Wb.key);if(!Va){a.ULS.sendTraceTag(50436160,Wa.Ei,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}vb=new Ya.a([0]);for(let nc=0,Qc=Va.pa.length;nc<Qc;nc++)ka=Va.pa.J(nc),ka.Hj&&vb.iUa(ka.Hj,void 0,(Hd,xd)=>{if(xd){var Id=null,Ve=xd.intent;Ve&&({value:Id}=Wb.value.Dc(Ve.id,Id)).returnValue&&(Ve=new ha.a,Ve.start=xd.Ib.cp,Ve.length=Hd.Ib.cp-Ve.start,Id.content.range=Ve,Id.dxa=!1)}})}}else a.ULS.sendTraceTag(50436130,Wa.Ei,
10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(ka){a.ULS.sendTraceTag(593049729,Wa.Ei,50,"GetAnnotationsByType: Method called for type {0}.",ka);return this.RXe(ka).then(()=>{const Va=new db.a;this.ri.ie(()=>{if(Db.a.jf(ka)||ka!==ia.a.getTypeName()){this.dMe.contains(ka)&&this.cFi();var vb=null;if(({value:vb}=this.L5.Dc(ka,vb)).returnValue){a.ULS.sendTraceTag(41418903,Wa.Ei,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",ka);var Wb=new db.a;for(const nc of vb)vb=
null,({value:vb}=this.lD.Dc(nc,vb)).returnValue&&(vb.dxa&&Wb.add(vb),Va.add(vb));Wb&&0<Wb.count&&Wa.AGb(Wb.J(0))&&this.IVo(Wb)}}else for(Wb of this.ngd.values)Va.add(Wb);Va.count||a.ULS.sendTraceTag(41418904,Wa.Ei,50,"GetAnnotationsByType: No annotations found for type {0}!",ka)},"AS:GABT");return Va},Va=>{a.ULS.sendTraceTag(41418905,Wa.Ei,10,"Exception occurred while fetching annotations of type {0}: {1}",ka,Va);return null})}qga(ka){let Va=null;return({value:Va}=this.lD.Dc(ka,Va)).returnValue?Va:
null}y3h(ka){let Va=null;if(this.Cza.nb(ka))for(const vb of this.Cza.J(ka))if(ka=this.qga(vb))Va||(Va=new db.a),Va.add(ka);return Va}FIb(ka){return(ka=this.qga(ka))?(ka.vUc||this.cFi(),ka):null}bza(ka,Va){this.plo(ka,Va);this.rmg(ka,Va);this.ENb(ka,sa.a.getTypeName())}OQo(ka,Va){this.CUo(ka,Va);this.Bio(ka,Db.a.eLl(ka));this.ENb(ka,sa.a.getTypeName())}PQo(ka,Va){ka=this.cC.k3h(ka);for(const vb of ka)this.KF.dmg(this.vI.value,vb,Va)}plo(ka,Va){let vb=null;this.hJa&&(vb=this.hJa());vb&&(ka=this.gLl(ka,
Va))&&vb.setAnnotationState(ka)}rmg(ka,Va,vb=!0){if(ka&&Wa.Sti(ka)){var Wb=this.qga(ka.id);!ka.content||Wb&&ka.content===Wb.content||Db.a.setAnnotationState(ka,Va);Wb&&Wb.content&&Db.a.setAnnotationState(Wb,Va);vb&&this.ra.l8&&(70===Va||60===Va)&&this.ra.raiseEvent(Wa.URi,new gc(ka,Va))}}gLl(ka,Va){let vb=null;ka&&(vb=Object.assign(new oa,{id:ka.id,value:Va}),Db.a.jf(ka.parentPath)||(vb.parentPath=ka.parentPath.split("\\")));return vb}Bio(ka,Va){const vb=this.hJa?this.hJa():null;vb&&(ka=this.dLl(ka,
Va))&&vb.setAnnotationMetadata(ka)}CUo(ka,Va){if(ka&&Wa.Sti(ka)){var vb=this.qga(ka.id);!ka.content||vb&&ka.content==vb.content||Db.a.Nij(ka,Va);vb&&vb.content&&Db.a.Nij(vb,Va)}}dLl(ka,Va){if(!ka)return null;const vb=new La;vb.id=ka.id;vb.value=Va;Db.a.jf(ka.parentPath)||(vb.parentPath=ka.parentPath.split("\\"));return vb}Zoo(ka,Va,vb,Wb){const nc=ka.content;if(this.cC.Ljb(ka)&&nc){const Qc=nc.range.start+nc.range.length;if(0<Wb&&Qc<=vb||0>Wb&&Qc<=vb+Wb)return!1;if(0<Wb&&nc.range.start>=Va||0>Wb&&
nc.range.start>=vb)return nc.range.start+=Wb,!1}return!this.ld.isFeatureEnabled(62)&&nc&&nc.M_?(ka=this.cC.dkb(ka,60),!(60===nc.M_.state&&ka)):!0}Tmh(ka,Va){this.Jja.nb(Va)||this.Jja.Z(Va,new Sa);this.Jja.J(Va).handlers.add(ka);ka(Va,this.Jja.J(Va).oldState,this.Jja.J(Va).newState)}Y8i(ka,Va){this.Jja.nb(Va)&&this.Jja.J(Va).handlers.contains(ka)&&this.Jja.J(Va).handlers.remove(ka)}static Sti(ka){ka=xa.a.getBaseTypesFor(ka.content);return Array.contains(ka,Ja.a.getTypeName())}static AGb(ka){if(void 0===
ka.content||null===ka.content||""===Db.a.v1a(ka.parentPath))return!1;const Va=xa.a.getBaseTypesFor(ka.content);return Array.contains(Va,ua.a.getTypeName())&&ka.annotationType!==Ia.RoleDetectionAnnotation.getTypeName()}NQo(ka){ka?(this.yse.AugLoop_Text_Critique=ka,ka=this.x$b("AugLoop_Text_Critique")?this.eSb.J("AugLoop_Text_Critique"):null,this.uDj(ka,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,Wa.Ei,50,"Annotation configuration could not be updated for annotation type: {0}.","AugLoop_Text_Critique")}uDj(ka,
Va){if(ka&&this.yse[Va]){const vb=new Mb;vb.token=ka;vb.config=this.yse[Va];this.hJa&&(this.hJa().updateAnnotationConfig(vb),a.ULS.sendTraceTag(540615553,Wa.Ei,50,"Annotation configuration has been updated for annotation type: {0}.",Va))}}p9i(ka){let Va=null;({value:Va}=this.lD.Dc(ka.id,Va)).returnValue&&(ka.annotationType=Va.annotationType);this.frc.has(ka.id)&&this.frc.delete(ka.id)}tDj(ka,Va,vb,Wb){this.aXn(ka);this.vDj(ka,vb,Wb,Va)&&this.W$.ZFj(ka,vb)}oSa(ka){const Va=ka.parentPath,vb=Ma.a.getTypeName();
this.p9i(ka);this.bza(ka,70);this.irc.contains(Va)||this.tDj(ka,Va,vb,!0)}D0l(ka){const Va=new db.a;ka=this.L5.Dc(ka).value;if(null===ka)return Va;for(const vb of ka)ka=this.lD.Dc(vb).value,null!==ka&&Va.push(ka);return Va}async rmm(){await Object(Ob.b)();this.j9i()}j9i(){const ka=this.D0l(cc.a.getTypeName());for(const Va of ka)this.Xui(Va.content)&&this.oSa(Va)}}Wa.Ei=389;Wa.iec="OnAnnotationOperation";Wa.URi="OnAnnotationLocalStateChange";Wa.R5d="OnAnnotationActivationChange";Wa.ebk=20;Object(e.a)(Wa,
"AnnotationStorage",null,[588]);class Lb{constructor(){this.afe=null;this.O7c=!1}}Object(e.a)(Lb,"AugmentationLoopStateManager",null,[586]);var qc=c(197),Ra=c(568),yb=c(73),Bb=c(102),cb=c(590),Xa=c(231);class hb extends Xa.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=
!1}$k(){return 102}static construct(ka,Va,vb,Wb,nc,Qc){const Hd=new hb;Hd.ExpectedEndRevisionId=ka;Hd.OriginString=Va;Hd.Authorization=vb;Hd.AugLoopSeedUrl=Wb;Hd.FileId=nc;Hd.SeedBatchesInParallelIsEnabled=Qc;Hd.AddDocumentKindTypeToPathIsEnabled=!0;Hd.CheckOnDemandNodeVersionEnabled=!0;Hd.AddSubDocumentKindTypeToPathIsEnabled=!0;return Hd}}Object(e.a)(hb,"FullFileAugLoopSeedingRequest",Xa.a,[]);class Cb{constructor(){this.authToken=this.url=this.qYi=null}}Object(e.a)(Cb,"ReseedingTaskInfo",null,
[]);class ob{constructor(ka,Va,vb,Wb,nc,Qc){this.p$=null;this.VVg=!1;this.MTb=null;this.vPe=0;this.Q1c=(Hd,xd)=>{Hd=xd.Faa;this.MTb&&Bb.AT(Hd,Id=>Id===this.MTb)&&(xd.httpStatusCode!==qc.a.Hy||xd.QH||2!==xd.dZf?xd.httpStatusCode!==qc.a.Hy||xd.QH||1!==xd.dZf?this.Hdj(()=>{a.ULS.sendTraceTag(50861003,ob.Ei,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",xd.httpStatusCode,
xd.QH,xd.dZf,xd.St)}):(this.MN.O7c=!1,this.p$.HMb(this.Q1c),this.Te.zXk(),a.ULS.sendTraceTag(50861002,ob.Ei,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),Hd=Object(yb.a)(Cb,this.MTb),this.L4i(xd.B6n,Hd.qYi,Hd.url,Hd.authToken)):this.Hdj(()=>{a.ULS.sendTraceTag(50861001,ob.Ei,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.Izl=Hd=>{if(void 0===Hd||null===Hd||void 0===Hd.data||null===Hd.data||void 0===Hd.data.xe||null===Hd.data.xe)a.ULS.sendTraceTag(41445393,
ob.Ei,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(Hd.data.Qe!==qc.a.Hy)a.ULS.sendTraceTag(41445394,ob.Ei,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",Hd.data.Qe);else try{let xd;({group:xd}=Ra.a.l1(Hd.data.xe)).returnValue?xd.Responses&&xd.Responses.length?(Hd=null,xd&&xd.Responses&&xd.Responses.length&&(Hd=xd.Responses[0])?(this.w2.dUa(Hd),Hd.StatusCode?a.ULS.sendTraceTag(41445398,ob.Ei,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",
Hd.StatusCode):a.ULS.sendTraceTag(41445399,ob.Ei,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",Hd.LastSeededRevisionId)):a.ULS.sendTraceTag(41445397,ob.Ei,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):a.ULS.sendTraceTag(41445396,ob.Ei,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):
a.ULS.sendTraceTag(41445395,ob.Ei,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(xd){a.ULS.sendTraceTag(41445400,ob.Ei,10,"FileSeedingSuccessCallback: {0}",xd.message)}};this.Hzl=Hd=>{void 0===Hd||null===Hd||void 0===Hd.data||null===Hd.data||void 0===Hd.data.xe||null===Hd.data.xe?a.ULS.sendTraceTag(41445401,ob.Ei,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):a.ULS.sendTraceTag(41445402,ob.Ei,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",
Hd.data.Qe)};this.RVj=ka.$("AugLoopServerSideSeedingIsEnabled");this.PVj=ka.$("AugLoopReseedingIsEnabled");this.QVj=ka.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.W5g=ka.mc("MaxReseedingRetries",1);this.Wf=Va;this.lkd=vb;this.MN=Wb;this.w2=nc;this.Te=Qc;V.App.ya&&V.App.ya.gb&&V.App.ya.gb.Uc&&V.App.ya.gb.Uc.contentReplicator&&(this.p$=V.App.ya.gb.Uc.contentReplicator)}Kym(ka,Va,vb){if(this.RVj){var Wb=this.MN.afe;Wb&&Wb.trim().length?this.VVg?this.PVj&&(a.ULS.sendTraceTag(50861E3,ob.Ei,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),
this.vPe=0,this.p$?(this.MN.O7c=!0,this.p$.m0b(this.Q1c),this.MTb=Object.assign(new Cb,{qYi:ka,url:Va,authToken:vb}),this.p$.cF(null,null,this.MTb)):a.ULS.sendTraceTag(592814793,ob.Ei,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,ob.Ei,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.L4i(Wb,ka,Va,vb),this.VVg=!0):a.ULS.sendTraceTag(41445391,ob.Ei,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,
ob.Ei,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}Hdj(ka){this.vPe<this.W5g?(a.ULS.sendTraceTag(594384E3,ob.Ei,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",++this.vPe,this.W5g),this.p$.cF(null,null,this.MTb)):(this.MN.O7c=!1,this.p$.HMb(this.Q1c),ka())}L4i(ka,Va,vb,Wb){const nc=hb.construct(ka,Va,Wb,vb,z.AFrameworkApplication.rootQuerySignature,this.QVj);
a.ULS.sendTraceTag(595178454,ob.Ei,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.lkd.eGb.execute(()=>{this.Itk(nc)})}Itk(ka){a.ULS.sendTraceTag(595178453,ob.Ei,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");this.Wf.sj(V.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,cb.b(ka),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.Izl,this.Hzl,ka);a.ULS.sendTraceTag(42016906,
ob.Ei,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}ob.Ei=389;Object(e.a)(ob,"FullFileAugLoopSeedingService",null,[]);class ab{constructor(){}}Object(e.a)(ab,"RuntimeManagerInitializationTracker",null,[]);var Ib=c(936);class Yb{getAugLoopRuntimeManager(){return Ib.a.getAugLoopRuntimeManager()}}Object(e.a)(Yb,"AlFactoryWrapper",null,[585]);class ub{kl(){return Db.a.kl()}}Object(e.a)(ub,"UtilsWrapper",null,[584]);var Ac=c(741),Pc=c(53),Mc=c(15),Ed=c(42),ne=c(145),Ie=c(1997),
cd=c(5),Ic=c(101),Rc=c(214),xc=c(28),Ae=c(351),Ue=c(391),Xe=c(93),ef=c(48);class Se{constructor(ka,Va,vb,Wb,nc){this.Ma=ka;this.Gf=vb;this.Uo=Wb;this.we=nc;this.ioa=this.Ma.$("WordDesignerCaptionDetectionEnabled")}Ego(ka,Va){ka.listType=this.v0l(Va);ka.outlineLevel=$a.ParagraphReader.vna(Va);ka.indentation=Se.Iqf(this.Uo.ZT(Va));ka.alignment=Se.Nmf($a.ParagraphReader.Cx(Va));ka.isInsideTable=this.isInsideTable(Va);ka.isInsideTOC=Va.vr;ka.rightIndentation=Se.Iqf(this.Uo.q1a(Va));var vb=this.Uo.u8b(Va);
ka.specialIndentType=Se.obm(vb);ka.specialIndentBy=Se.Iqf(vb);ka.listType!==Ie.e.NoList&&this.jio(Va,ka);this.jlo(Va,ka);vb=[];this.ioa&&(vb=this.TFn(Va));ka.formattedRanges=this.qWl(Va,vb);this.ioa&&null!=vb&&(ka.objectReferences=0<vb.length?vb:void 0)}qWl(ka,Va){var vb=ka.pa?ka.pa.length:0,Wb=Ic.FormattingReader.Kr(xc.a.create(ka));let nc=Xe.a.kG,Qc=0,Hd=Xe.a.lM/2;Wb&&(Hd=Ic.FormattingReader.Rn(Wb,Mc.a.fontSize,Xe.a.lM)/2,nc=Ic.FormattingReader.Rn(Wb,Mc.a.font,Xe.a.kG),Qc=Ic.FormattingReader.language(Wb));
Wb="Normal";var xd=this.we.Lo(ka);xd&&(Wb=xd.getValue(Ed.a.ka)||"Normal",xd.hasProperty(Mc.a.font)&&(nc=xd.getValue(Mc.a.font)));if(vb){--vb;xd=[];let Ci=null,og=void 0,cl=null;this.ioa&&ka.hasProperty(Mc.a.Gn)&&(cl=ka.getValue(Mc.a.Gn));const ik=ka.properties.ia(ma.a.Ofa,null);for(let uj=0;uj<vb;uj++){var Id=ka.pa.J(uj),Ve=ka.Kc,mf=null;this.ioa&&(mf=Se.Huf(ka,cl,uj));Id.tf&&(Ci=Se.jSo(Ve,Id.tf,Ci));Id.hyperlink&&Id.hyperlink.url?og=Id.hyperlink.url:Id.Om&&(og=void 0);var fg=ka.pa.J(uj+1).cp-1;Ve=
Id.cp;fg=fg-Id.cp+1;let ti=!1,Yo=!1,wh=!1,cn=Hd,Tm=0,nl=0,Um=Wb,ak=void 0,Vl=Qc,sk=nc,po;if(Id.formatting){var Dg=Id.formatting;ti=Ic.FormattingReader.Rn(Dg,Mc.a.bold,!1);Yo=Ic.FormattingReader.Rn(Dg,Mc.a.italic,!1);wh=Ic.FormattingReader.Rn(Dg,Mc.a.underline,!1);cn=Ic.FormattingReader.Rn(Dg,Mc.a.fontSize,2*Hd)/2;Tm=Ic.FormattingReader.Rn(Dg,Ed.a.capitalization,0);nl=Ic.FormattingReader.Rn(Dg,Mc.a.fontColor,0);Vl=Ic.FormattingReader.language(Dg)||Qc;sk=Ic.FormattingReader.Rn(Dg,Mc.a.font,nc);Um=Wb;
var Zf=Dg.wn;Zf&&(Zf=Zf.ia(Ed.a.aw,null))&&!Zf.equals(ja.a.nil)&&Dg.paragraph.Kc&&(Dg=Dg.paragraph.Kc.Db(Zf))&&(Um=(new Rc.a(Dg)).getValue(Ed.a.ka))}this.ioa&&(po=this.fsf(mf),null!=po&&this.Voh(Va,mf,po,xd.length,Ie.b.Inline));Ci&&(ak=0<Ci.count);Id={isDeleted:this.ZGm(ik,Id,uj,og),fontFamily:sk,fontWeight:ti?Ie.d.Bold:Ie.d.Normal,fontSize:cn,italic:Yo,underline:wh?Ie.h.SingleLine:Ie.h.None,capitalization:Se.MIh(Tm),color:nl,styleName:Um,isFollowUp:ak,languageId:Se.CIh(Vl),start:Ve,length:fg,link:og,
isReference:Se.isReference(Id)?!0:void 0,objectType:null!==po&&void 0!==po?po:void 0};mf=0<xd.length?xd[xd.length-1]:void 0;Se.zRk(mf,Id)?mf.length+=Id.length:xd.push(Id)}return xd}return[{fontFamily:nc,fontWeight:Ie.d.Normal,fontSize:Hd,italic:!1,underline:Ie.h.None,capitalization:Se.MIh(0),color:0,styleName:Wb,isFollowUp:void 0,languageId:Se.CIh(Qc),start:0,length:ka.characterData.length}]}ZGm(ka,Va,vb,Wb){if(this.zB()){if(Va.blob||Va.formatting&&Va.formatting.cache&&Va.formatting.cache.jHb||Wb)return!0;
if(ka&&vb<ka.length)return ka[vb]}return ef.a.Pj&&Va.bR?!0:Va.ii?!0:!1}zB(){return!!z.AFrameworkApplication.K&&z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static zRk(ka,Va){return!!ka&&!!Va&&ka.start+ka.length===Va.start&&ka.isDeleted===Va.isDeleted&&ka.fontFamily===Va.fontFamily&&ka.fontWeight===Va.fontWeight&&ka.fontSize===Va.fontSize&&ka.italic===Va.italic&&ka.underline===Va.underline&&ka.capitalization===Va.capitalization&&ka.color===
Va.color&&ka.highlightColor===Va.highlightColor&&ka.styleName===Va.styleName&&void 0===ka.link&&void 0===Va.link&&ka.languageId===Va.languageId&&!ka.isReference&&!Va.isReference&&!ka.isFollowUp&&!Va.isFollowUp&&void 0===ka.objectType&&void 0===Va.objectType}v0l(ka){const Va=new cd.GraphIterator;Va.set(ka);Va.zb(11);Va.hd(11);return(ka=this.Gf.hw(Va))?Se.N5k(ka.listType):Ie.e.NoList}jio(ka,Va){var vb=this.Gf.HC(ka);vb&&(vb.hasProperty(ma.a.listID)&&(Va.listId=vb.getValue(ma.a.listID).toString()),vb=
this.mai(ka,Mc.a.font),ka=this.mai(ka,Mc.a.fontSize),vb&&(Va.bulletAndNumberFontFamily=vb),ka&&(Va.bulletAndNumberFontSize=ka))}isInsideTable(ka){const Va=new cd.GraphIterator;Va.set(ka);return Va.zb(14)}jlo(ka,Va){Va.spacingBeforeParagraph=this.bgi(ka,ma.a.N4,ma.a.wY,ma.a.Ki);Va.spacingAfterParagraph=this.bgi(ka,ma.a.M4,ma.a.vY,ma.a.sa);Va.lineSpacing=this.pEb(ka)}bgi(ka,Va,vb,Wb){if($a.ParagraphReader.Rn(ka,Va,!1))return 0;Va=$a.ParagraphReader.Rn(ka,vb,-1);if(0<=Va)return Va*Ae.a.QKb/100;ka=$a.ParagraphReader.Rn(ka,
Wb,-1);return 0<=ka?ka/20:0}mai(ka,Va){ka=this.xTl(ka);if(null!=ka&&null!=ka.cache)return ka.cache.getValue(Va)}xTl(ka){var Va;ka=null===(Va=ka.pa)||void 0===Va?void 0:Va.last;return null!=ka&&ka.Sh?ka.formatting:(a.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),null)}pEb(ka){const Va=$a.ParagraphReader.Rn(ka,ma.a.xa,Ae.a.xa);ka=$a.ParagraphReader.Rn(ka,ma.a.ua,Ae.a.lineSpacing);switch(Va){case 0:return ka/240;case 1:return ka/20;default:return 0}}static jSo(ka,
Va,vb){for(let Wb=0;Wb<Va.length;Wb++){const nc=Va.J(Wb),Qc=nc.Wj,Hd=ka.Db(Qc);Hd&&Hd.ia(ma.a.CG,!1)&&(vb||(vb=new Ca.a(new Ue.a)),nc.Nc?vb.add(Qc):vb.remove(Qc))}return vb}static CIh(ka){return(ka=Ac.a.og(ka))&&ka.name?ka.name.toLowerCase():void 0}static Iqf(ka){return ka?2===ka.unit?Math.floor(Pc.a.kAb(ka.value)/20):Math.floor(ka.value/20):0}static obm(ka){if(!ka)return Ie.g.Initial;switch(ka.specialIndentType){case 1:return Ie.g.FirstLine;case 2:return Ie.g.Hanging;default:return Ie.g.Initial}}static MIh(ka){switch(ka){case 2:return Ie.c.AllCaps;
case 1:return Ie.c.SmallCaps;default:return Ie.c.NoCaps}}static Nmf(ka){switch(ka){case 1:return Ie.a.Left;case 3:return Ie.a.Right;case 2:return Ie.a.Center;case 6:return Ie.a.Justified;case 0:return Ie.a.None;default:return Ie.a.Other}}static N5k(ka){switch(ka){case 15:return Ie.e.Any;case 1:return Ie.e.Bullet;case 42:return Ie.e.Invalid;case 13:return Ie.e.Lim;case 14:return Ie.e.Nil;case 16:return Ie.e.NoList;case 0:return Ie.e.Numbered;default:return Ie.e.Invalid}}static isReference(ka){return ka.blob&&
(7===ka.blob.Dh||10===ka.blob.Dh)||ka.Eh&&0<ka.Eh.length||ka.tf&&0<ka.tf.length||ka.Jb&&0<ka.Jb.length?!0:!1}static Huf(ka,Va,vb){return null==Va?null:Va[vb]&&!Va[vb].equals(ja.a.nil)&&ka.Kc?ka.Kc.Db(Va[vb]):null}fsf(ka){if(null==ka)return null;if(ka.hasProperty(ma.a.Ys)){var Va=ka.getValue(ma.a.Ys);if(Se.D0i.has(Va))return Se.D0i.get(Va)}if(ka.hasProperty(ma.a.r6b)&&null!=ka.getValue(ma.a.r6b))return Ie.f.FootnoteEndnote;if(ka.hasProperty(ma.a.pageBreak)&&ka.getValue(ma.a.pageBreak))return Ie.f.PageBreak;
if(ka.hasProperty(ma.a.QHb)&&ka.getValue(ma.a.QHb))return Ie.f.Tab;Va=!1;ka.hasProperty(ne.a.b4)?Va=ka.getValue(ne.a.b4):ka.hasProperty(ma.a.gha)&&(Va=ka.getValue(ma.a.gha));return Va&&ka.hasProperty(ma.a.imageType)&&1==ka.getValue(ma.a.imageType)?Ie.f.Image:null}static OJm(ka){return ka.hasProperty(ma.a.i9b)&&0<=ka.getValue(ma.a.i9b)?!0:!1}oBi(ka){return Se.ICo.has(ka)}PLh(ka,Va,vb,Wb){return null==ka||null==Va?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),
null):Wb===Ie.b.Inline&&null==vb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):Wb===Ie.b.Floating&&null!=vb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>vb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):Se.OJm(ka)?null:this.oBi(Va)?{referencedPath:["session",
"doc","main",ka.id.toString()],formattedRangeIndex:vb,anchorMode:null!==Wb&&void 0!==Wb?Wb:Ie.b.Unspecified,anchoredObjectType:Wb==Ie.b.Floating?Va:void 0}:null}Voh(ka,Va,vb,Wb,nc){Va=this.PLh(Va,vb,Wb,nc);null!=Va&&null!=ka&&ka.push(Va)}TFn(ka){const Va=[];if(null==ka)return a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),Va;let vb=null;ka.hasProperty(ma.a.f7)&&(vb=ka.getValue(ma.a.f7));if(null!=vb)for(let Wb=0;Wb<vb.length;++Wb){const nc=Se.Huf(ka,
vb,Wb),Qc=this.fsf(nc);null!=Qc&&this.Voh(Va,nc,Qc,null,Ie.b.Floating)}return Va}EHh(ka){if(null==ka||!ka.hasProperty(Mc.a.Gn))return!1;const Va=ka.getValue(Mc.a.Gn);for(let Wb=0;Wb<Va.length;Wb++){var vb=Se.Huf(ka,Va,Wb);vb=this.fsf(vb);if(this.oBi(vb))return!0}return!1}}Se.D0i=new Map([[5,Ie.f.Image],[11,Ie.f.TextBox],[7,Ie.f.Chart],[6,Ie.f.SmartArt],[10,Ie.f.Drawing],[2,Ie.f.EquationObject],[4,Ie.f.Ink],[19,Ie.f.PageBreak],[23,Ie.f.FootnoteEndnote],[24,Ie.f.FootnoteEndnote],[35,Ie.f.FootnoteEndnoteReferenceMark],
[36,Ie.f.FootnoteEndnoteReferenceMark],[0,Ie.f.Other]]);Se.ICo=new Set([Ie.f.Image,Ie.f.TextBox,Ie.f.Chart,Ie.f.SmartArt,Ie.f.Drawing,Ie.f.Ink]);Object(e.a)(Se,"FormattingExtractor",null,[582]);var pc=c(1205);class id extends Sys.EventArgs{constructor(ka){super();this.d9b=ka}}Object(e.a)(id,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class Xc extends Sys.EventArgs{constructor(ka){super();this.x8=ka}}Object(e.a)(Xc,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class he{constructor(ka,Va,vb){this.BZc=
ka;this.graphNode=Va;this.fullPath=vb}}Object(e.a)(he,"NodeEvent",null,[607]);class $d{constructor(){this.yEe=this.iCe=!1;this.Jub=null;this.ra=new na.a;this.N$=new O.a(0);this.M$a=new pc.a(Aa.a.ei());this.vvb=new pc.a(Aa.a.ei());this.hpd=[]}uph(ka){this.ra.addHandler("IsCollectingNodeEventsChangedKey",ka)}gXk(){this.N$=new O.a(0);this.d9b=!1}get d9b(){return this.iCe}set d9b(ka){this.iCe!==ka&&(this.iCe=ka,this.ra.raiseEvent("HasNodeEventsChangedKey",new id(ka),this))}get x8(){return this.yEe}set x8(ka){this.yEe!==
ka&&(this.yEe=ka,this.ra.raiseEvent("IsCollectingNodeEventsChangedKey",new Xc(ka),this))}uNb(ka,Va){this.M$a.nb(ka)||this.M$a.Z(ka,Va)}b9n(ka,Va){this.vvb.Z(ka,Va)}YKl(ka){let Va=null;this.vvb.nb(ka)&&(Va=this.vvb.J(ka),this.vvb.remove(ka));return Va}mce(ka,Va){if(ka)if(this.x8){var vb=3!==Va&&4!==Va&&5!==Va||!this.M$a.nb(String.format("{0}",ka.id))?Db.a.sM(ka):this.M$a.J(String.format("{0}",ka.id));if(({value:Wb}=this.N$.Dc(vb)).returnValue)if(Wb||3!==Va)if(5===Wb&&3===Va){if(ka=vb.split("\\").pop(),
this.vvb.nb(ka)){var Wb=this.vvb.J(ka);Wb===vb?(this.$Kf(vb,Va),this.N$.add(vb,Va)):(this.vvb.Z(ka,vb),this.M$a.Z(ka,Wb),this.ZJi(vb),this.N$.remove(vb),this.$Kf(vb,Va),this.N$.add(Wb,5))}}else Wb&&(4!==Wb||0!==Va&&3!==Va&&5!==Va)&&(this.$Kf(vb,Va),this.N$.add(vb,Va));else this.ZJi(vb),this.N$.remove(vb);else this.B6m(vb,Va),this.hpd.push(ka),this.N$.add(vb,Va);this.d9b=0<this.N$.count}else a.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,
389,15,"node is null.")}B6m(ka,Va){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",ka,Va)}$Kf(ka,Va){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",ka,Va)}ZJi(ka){a.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",ka)}h3k(){let ka=null;var Va=!1;let vb=null;for(;this.hpd.length&&!Va;){vb=Array.dequeue(this.hpd);if(!vb)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),
null;this.M$a.nb(String.format("{0}",vb.id))?(ka=this.M$a.J(String.format("{0}",vb.id)),this.M$a.remove(String.format("{0}",vb.id)),this.hpd.push(vb)):ka=Db.a.sM(vb);Va=this.N$.nb(ka)}if(!Va)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.gXk(),null;Va=this.N$.J(ka);this.N$.remove(ka);this.d9b=0<this.N$.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",ka,Va);return new he(Va,vb,ka)}sQn(ka){this.Jub=ka}i3k(){if(!this.Jub)return null;
for(var ka=0;ka<this.Jub.length;ka++){var Va=this.Jub.J(ka);Va=Db.a.sM(Va.node);if(this.N$.nb(Va))return null}ka=this.Jub;this.Jub=null;return ka}xXk(){this.Jub=null}Czo(){this.x8=!0}oIm(ka){return this.N$.nb(ka.id.toString())}}Object(e.a)($d,"NodeEventsCollection",null,[581]);var Ud=c(1464),Jf=c(1391),hh=c(286),Qi=c(109);class Lg extends Jf.a{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd,Id,Ve,mf){super();this.Bkd=new Ud.a;this.x$a=!1;this.Vrc=null;this.Tha=(fg,Dg)=>{(fg=Dg.node)&&this.E6a(fg)&&(a.ULS.sendTraceTag(40253400,
389,100,"New paragraph Connect event."),Db.a.Jqo(fg,this.Mka.x8,this.qSb,this.jhk)&&(this.Mka.mce(fg,0),this.yEj(fg)));this.Mka.x8&&this.W$.bmb(fg)};this.dSi=(fg,Dg)=>{fg=Dg.node;this.Mka.uNb(String.format("{0}",fg.id),Db.a.sM(fg))};this.wKb=(fg,Dg)=>{(fg=Dg.node)&&this.E6a(fg)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.Mka.x8&&this.Mka.mce(fg,3));this.Mka.x8&&this.W$.dVi(fg,3)};this.sY=(fg,Dg)=>{fg=Dg.node;Dg=Dg.property;fg&&this.mVj.has(Dg)&&this.E6a(fg)&&(a.ULS.sendTraceTag(40253402,
389,100,"New paragraph Modified event."),this.Mka.x8&&(this.Mka.mce(fg,2),Dg===ma.a.qj&&this.yEj(fg)));this.Mka.x8&&Dg===ma.a.Lc&&this.W$.dVi(fg,2)};this.eSi=(fg,Dg)=>{(fg=Dg.node)&&$a.ParagraphReader.Wb(fg)&&!this.zrc.has(fg)&&!this.uze.has(fg)&&(this.zrc.add(fg),this.pY())};this.fVi=(fg,Dg)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(fg=Dg.node)&&this.Te.Win(fg)};this.ZQf=()=>{this.Q7c()?this.SM():this.x$a&&!this.Mka.x8&&this.aza()};this.lC=Va;this.Mka=vb;this.jhk=Qi.b(Wb.afe);
this.qSb=ka.$("AugLoopOperationsAreEnabled");this.Te=nc;this.W$=Qc;this.cC=Hd;this.Hb=xd;this.Fm=Id;this.KF=Ve;this.zrc=new Set;this.uze=new Set;mf.aqa(this,7);this.mVj=new Set([Mc.a.mo,Mc.a.bold,Mc.a.italic,Mc.a.underline,Mc.a.font,Mc.a.fontSize,Mc.a.fontColor,Ed.a.capitalization,Mc.a.Hh,Mc.a.Gn,ma.a.N4,ma.a.wY,ma.a.Ki,ma.a.M4,ma.a.vY,ma.a.sa,ma.a.xa,ma.a.ua,ma.a.listID,ma.a.NM,ma.a.$d,ma.a.dia,ma.a.eu,ma.a.qj])}get index(){return 7}get K_c(){return this.Vrc}set K_c(ka){this.Vrc=ka;this.W$.dVf=ka?
()=>{this.Vrc()}:null}init(){this.Q7c()&&this.SM();this.Mka.uph(this.ZQf)}SM(){this.lC?(this.x$a=!0,this.lC.Ot(this.Tha),this.lC.eT(this.dSi),this.lC.Kw(this.wKb),this.lC.Fo(this.sY),this.lC.bqh(this.fVi),this.lC.iwk(this.eSi)):a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}aza(){this.lC?(this.x$a=!1,this.lC.PU(this.Tha),this.lC.Ica(this.dSi),this.lC.yia(this.wKb),this.lC.QU(this.sY),this.lC.laj(this.fVi),this.lC.a_n(this.eSi)):a.ULS.sendTraceTag(39403913,
389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}BVd(ka){ka&&this.Bkd.add(ka.id,ka.ia(ma.a.qj,0))}yEj(ka){this.Bkd.nb(ka.id)?(this.W$.DXo(ea.a.Tie,ka,this.Bkd.J(ka.id)),this.Bkd.remove(ka.id)):(this.W$.rXk(ea.a.Tie),this.K_c&&this.K_c())}E6a(ka){const Va=V.App.ya.gb.wc;return!!Va&&Va.fv&&!!Va.ed&&!!Va.ed.Kc&&!!ka&&!!ka.Kc&&ka.Kc.id===Va.ed.Kc.id}run(){if(0!==this.zrc.size){var ka=[];for(const Va of this.zrc)ka.push(Va),this.uze.add(Va),100<=ka.length&&(this.AVh(ka),ka=
[]);0<ka.length&&this.AVh(ka);this.zrc.clear()}}AVh(ka){const Va=new pa.a(4,1,500,()=>{for(const vb of ka)this.uze.delete(vb),this.updateAnnotationRangeData(vb)},158);this.Hb.Vb(Va)}updateAnnotationRangeData(ka){var Va=this.Fm.ZOa(ka,0,Wb=>this.oso(Wb.intent));if(0<Va.count)for(const Wb of Va){Va=this.W$.Z8l(Wb.intent.id);var vb=ka.Mma;const nc=$a.ParagraphReader.LQ(ka);Wb.end<Wb.begin||(vb=hh.a.fIc(nc,vb,Wb.begin,Wb.end-Wb.begin,Wb.begin,Wb.end-Wb.begin,ka),this.KF.F4f(ka.Kc,Va,vb))}}oso(ka){return!!ka&&
this.cC.Ljb(ka)&&!!ka.content}Q7c(){return!this.x$a&&this.Mka.x8}}Object(e.a)(Lg,"ParagraphNodeEventHandler",Jf.a,[577]);var bc=c(1005),vc=c(396),Vc=c(449),yd=c(100);class ee extends Vc.a{constructor(){super();this.H_=Object.assign(new yd.a,{T_:ee.getTypeName(),B_:ee.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(e.a)(ee,"DeltaUpdateOperation",Vc.a,[]);var Qe=c(369);class ue{constructor(){this.referencedPath=
null}}Object(e.a)(ue,"ItemReference",null,[]);class ve extends Qe.a{constructor(){super();this.op=this.deltas=this.delta=this.parentPath=null}}Object(e.a)(ve,"ItemWithPath",Qe.a,[]);var xf=c(978);class bf extends xf.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new yd.a,{T_:bf.getTypeName(),B_:bf.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(e.a)(bf,
"MoveOperation",xf.a,[]);var Df=c(439);class nf extends Df.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new yd.a,{T_:nf.getTypeName(),B_:nf.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(nf,"SelectionSignal",Df.a,[]);class Yf extends nf{constructor(){super();this.content=null;this.H_=Object.assign(new yd.a,{T_:Yf.getTypeName(),B_:Yf.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal",
"AugLoop_Signals_Signal"]}}Object(e.a)(Yf,"SelectionContentSignal",nf,[]);class Kf{constructor(){this.range=this.tileReference=null}}Object(e.a)(Kf,"TextTileRange",null,[]);var wb=c(1651),Tb=c(368),Wc=c(133),Gd=c(36),Ye=c(17);class od{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd){this._augLoopRuntimeManager=this.Nid=null;this.JRe=!1;this.ela=this.THe=this.Qtd=null;this.ICl=()=>{if(V.App.lostSession||vc.SessionStatusManager.instance&&vc.SessionStatusManager.instance.jo)z.AFrameworkApplication.ue("a596e684;c81e6109"),
z.AFrameworkApplication.K&&z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CloseALSession",!1)&&(Ib.a.getAugLoopRuntimeManager().closeSession(),a.ULS.sendTraceTag(512623445,389,10,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Hb.Ve(this.Nid));this.ri.ie(()=>{var Id;const Ve=pb.a.instance.E3;this.zB()&&this.h3n();for(this.FBc.reset();this.TWa.d9b&&!this.FBc.qlb();){let Dg;Dg=this.TWa.h3k();if(!Dg||!Dg.graphNode){a.ULS.sendTraceTag(41719901,389,15,
"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.FBc.update();continue}if(!this.pqo(Dg)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",Dg.graphNode.id);this.FBc.update();continue}const Zf=Dg.graphNode.id.toString();var mf=-1,fg=!0;Ve&&Ye.SelectionEditor.gf(Ve)&&Zf==Ve.node.id.toString()&&(mf=Ve.cpBegin,fg=!1);let Ci=null;if(this.dxb.contains(Zf))switch(Dg.BZc){case 3:this.dxb.remove(Zf);Ci=3;break;default:Ci=
Dg.BZc}else switch(Dg.BZc){case 0:case 1:this.dxb.add(Zf);Ci=0;break;case 2:this.dxb.add(Zf);Ci=0;break;case 3:this.dxb.remove(Zf);Ci=3;break;default:Ci=Dg.BZc}if(null!=Ci){mf=this.fci(Dg.graphNode,Dg.fullPath,Ci,mf,fg);if(4==Ci||5==Ci){if(mf.prevParentPath.join()!==mf.parentPath.join()){fg=Object.assign(new Ma.a,{parentPath:mf.prevParentPath,items:mf.items});const og=Object.assign(new Ka.a,{parentPath:mf.parentPath,items:mf.items,prevId:mf.prevId,nextId:mf.nextId});Zf!==mf.prevId&&Zf!==mf.nextId||
a.ULS.sendTraceTag(512231646,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",Ci,Zf,mf.prevId,mf.nextId,Dg.graphNode.type);this._augLoopRuntimeManager.submitOperation(Object.assign(new Tb.a,{operation:fg}));this._augLoopRuntimeManager.submitOperation(Object.assign(new Tb.a,{operation:og}));Dg.graphNode.type===Wc.a.table&&this.Nhj(Dg.graphNode,mf.parentPath).forEach(cl=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new Tb.a,
{operation:cl}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new Tb.a,{operation:mf}));if(this.wed&&this.ela&&this.ela[0]==Zf)switch(Ci){case 3:this.ela=null;break;case 0:case 1:case 2:case 4:case 5:this.ela[1]=null===(Id=this.xvb.yEb(Dg.graphNode))||void 0===Id?void 0:Id.tNc(Dg.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",xa.a.getTypeNameFor(mf),Zf);switch(Ci){case 0:case 4:case 5:this.Te.Ssn(Dg.graphNode);
break;case 3:this.Te.Tsn(Dg.graphNode,mf.parentPath.join("\\"))}}this.FBc.update()}(Id=this.TWa.i3k())&&this.Nbj(Id)},"TV:FPEFO")};this.Epa=(Id,Ve)=>{var mf;if(Ve.nl&&Ve.nl.length){if(this.wed)if(Id=Db.a.o3l(Ve.nl),!Id)this.ela=null;else if(!this.ela||this.ela[0]!=Id.id.toString()){const fg=this.TWa.oIm(Id)?null:null===(mf=this.xvb.yEb(Id))||void 0===mf?void 0:mf.tNc(Id);this.ela=[Id.id.toString(),fg]}this.JRe&&this.TWa.sQn(Ve.nl.kb)}};this.Ma=ka;this.TWa=Va;this.Hb=vb;this.FBc=Wb;this.OVj=this.Ma.$("AugLoopOperationsAreEnabled");
this.dxb=new Ca.a(Aa.a.ei());this.Te=nc;this.ri=Qc;this.xvb=Hd;this.ib=xd;this.wed=this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.ib.Lw(this.Epa);Db.a.kl().then(()=>{this._augLoopRuntimeManager=Ib.a.getAugLoopRuntimeManager();z.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacBox4AugLoopTimeBasedYieldTraversalSettings");this.Ma.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new wb.a,
{handler:Id=>{this.Te.jBk(Id)}}));this.OVj&&this.TWa.Czo();this.tAo()}).catch(()=>{})}h3n(){const ka=this.Te.frc.entries();for(let Va=0;Va<this.Te.frc.size;Va++){const vb=ka.next();2E3<=Date.now()-vb.value[1].time&&this.Te.fwf(vb.value[1].annotation,!0,Ka.a.getTypeName(),!1)}}pqo(ka){return 3===ka.BZc||Db.a.aqj(ka.graphNode)}tAo(){!this.Nid&&this.TWa.x8&&(this.Nid=new pa.a(4,2,this.Ma.mc("NodeEventsFiringInterval",500),this.ICl,131),this.Hb.Vb(this.Nid))}Nhj(ka,Va){var vb,Wb=[];const nc=cd.GraphIterator.$a(ka),
Qc=nc.xq();for(var Hd=0;Hd<Qc;Hd++){let xd=nc.yG(Hd);xd.type===Wc.a.outlineElement&&(xd=Gd.OutlineElementNavigator.Ge(nc));const Id=xd.id.toString(),Ve=null===(vb=this.xvb.yEb(xd))||void 0===vb?void 0:vb.RAb(xd);Wb.push(Object.assign(new Qe.a,{body:Ve,id:Id,revId:Db.a.Nuf(xd)}));nc.hd(ka.type)}Va.push(ka.id.toString());vb=[];vb.push(Object.assign(new Ka.a,{parentPath:Va.slice(),items:Wb,prevId:null}));for(Wb=0;Wb<Qc;Wb++)Hd=nc.yG(Wb),Hd.type===Wc.a.outlineElement&&(Hd=Gd.OutlineElementNavigator.Ge(nc)),
0<nc.xq()&&(vb=vb.concat(this.Nhj(Hd,Va))),nc.hd(ka.type);Va.pop();return vb}cPa(ka){return ka.split("\\").slice(0,-1)}fci(ka,Va,vb,Wb=-1,nc=!0){var Qc;let Hd=null,xd=null;const Id=ka.id.toString();var Ve=null;3!==vb&&(Ve=Db.a.RNk(ka));if(Ve)for(let mf=0;mf<Ve.length;mf++)if(Ve[mf]===Id){xd=mf+1<Ve.length?Ve[mf+1]:null;Hd=mf?Ve[mf-1]:null;break}Id!==Hd&&Id!==xd||a.ULS.sendTraceTag(512231645,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",
vb,Id,Hd,xd,ka.type);Ve=null===(Qc=this.xvb.yEb(ka))||void 0===Qc?void 0:Qc.RAb(ka,Wb,nc);Wb=[Object.assign(new Qe.a,{body:Ve,id:Id,revId:Db.a.Nuf(ka)})];switch(vb){case 0:case 1:return Object.assign(new Ka.a,{parentPath:this.cPa(Va),items:Wb,prevId:Hd,nextId:xd});case 4:return Object.assign(new bf,{parentPath:this.cPa(Db.a.sM(ka)),prevParentPath:this.cPa(Va),items:Wb,prevId:Hd,nextId:xd});case 5:return vb=this.TWa.YKl(Id),Object.assign(new bf,{parentPath:this.cPa(null!==vb&&void 0!==vb?vb:Db.a.sM(ka)),
prevParentPath:this.cPa(Va),items:Wb,prevId:Hd,nextId:xd});case 2:return Object.assign(new sa.a,{parentPath:this.cPa(Va),items:Wb});case 3:return Object.assign(new Ma.a,{parentPath:this.cPa(Va),items:Wb});default:return a.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",vb,Id),Object.assign(new xf.a,{parentPath:this.cPa(Va),items:Wb,prevId:Hd,nextId:xd})}}efm(ka){return this.ela&&this.ela[0]===ka?this.ela[1]:null}wco(ka){var Va;if(!this.wed)return a.ULS.sendTraceTag(545552581,
389,10,"sendTile: autoreplace is not enabled"),!1;if(!Db.a.aqj(ka))return!1;const vb=ka.id.toString();var Wb=this.dxb.contains(vb)?2:0;Wb=this.fci(ka,Db.a.sM(ka),Wb);this._augLoopRuntimeManager.submitOperation(Object.assign(new Tb.a,{operation:Wb}));this.dxb.add(vb);this.ela=[vb,null===(Va=this.xvb.yEb(ka))||void 0===Va?void 0:Va.tNc(ka)];return!0}mbo(ka,Va){var vb;if(this.wed){var Wb=ka.id.toString(),nc=this.cPa(Db.a.sM(ka));Va=[Object.assign(new ve,{id:Wb,revId:Db.a.Nuf(ka),parentPath:nc,delta:Va})];
nc=Object.assign(new ee,{parentPath:nc,items:Va});this._augLoopRuntimeManager.submitOperation(Object.assign(new Tb.a,{operation:nc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",Wb);this.ela=[Wb,null===(vb=this.xvb.yEb(ka))||void 0===vb?void 0:vb.tNc(ka)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}IFk(ka,Va){if(ka.tileReference.referencedPath.length!==Va.tileReference.referencedPath.length||ka.range.start!==Va.range.start||ka.range.length!==
Va.range.length)return!1;for(let vb=0;vb<ka.tileReference.referencedPath.length;vb++)if(ka.tileReference.referencedPath[vb]!==Va.tileReference.referencedPath[vb])return!1;return!0}DFk(ka,Va){if(ka.selectedRanges.length!==Va.selectedRanges.length||ka.content!==Va.content)return!1;for(let vb=0;vb<ka.selectedRanges.length;vb++)if(!this.IFk(ka.selectedRanges[vb],Va.selectedRanges[vb]))return!1;return!0}Nbj(ka){var Va;if(ka){var vb=new db.a,Wb="";for(let Hd=0;Hd<ka.length;Hd++){var nc=ka.J(Hd),Qc=(null===
(Va=this.xvb.yEb(nc.node))||void 0===Va?void 0:Va.RAb(nc.node)).content;Wb+=Qc;Qc=nc.cpBegin<Qc.length?nc.cpBegin:-1;Qc=Object.assign(new ha.a,{start:Qc,length:nc.cpEnd-nc.cpBegin});const xd=nc.node.id.toString();nc=this.cPa(Db.a.sM(nc.node));nc.push(xd);vb.add(Object.assign(new Kf,{range:Qc,tileReference:Object.assign(new ue,{referencedPath:nc})}))}ka=Object.assign(new Yf,{selectedRanges:vb.toArray(),content:Wb});this.THe&&this.DFk(ka,this.THe)||(Va=this.Qtd?this.Qtd:ja.a.create().toString(),vb=
[Object.assign(new Qe.a,{body:ka,id:Va})],this.Qtd?Va=Object.assign(new sa.a,{parentPath:["session","doc"],items:vb}):(this.Qtd=Va,Va=Object.assign(new Ka.a,{parentPath:["session","doc"],items:vb})),this._augLoopRuntimeManager.submitOperation(Object.assign(new Tb.a,{operation:Va})),this.THe=ka)}}clo(ka){(this.JRe=ka)?this.Nbj(this.ib.hb.kb):this.TWa.xXk()}zB(){return!!z.AFrameworkApplication.K&&z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}
Object(e.a)(od,"TileView",null,[579]);var vf=c(41),df=c(88);class dh{constructor(ka){df.a.assign(dh,this,ka)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(ka){return df.a.matchesTypesFor(ka,[dh.getTypeName()])}}dh.H_={T_:dh.getTypeName(),B_:dh.getBaseTypes()};class Ki{constructor(ka){df.a.assign(Ki,this,ka)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(ka){return df.a.matchesTypesFor(ka,[Ki.getTypeName()])}}
Ki.H_={T_:Ki.getTypeName(),B_:Ki.getBaseTypes()};class Zh{constructor(ka){df.a.assign(Zh,this,ka)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(ka){return df.a.matchesTypesFor(ka,[Zh.getTypeName()])}}Zh.H_={T_:Zh.getTypeName(),B_:Zh.getBaseTypes()};class rh{constructor(ka){df.a.assign(rh,this,ka)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(ka){return df.a.matchesTypesFor(ka,
[rh.getTypeName()])}}rh.H_={T_:rh.getTypeName(),B_:rh.getBaseTypes()};class bm{constructor(ka){df.a.assign(bm,this,ka)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable","AugLoop_Table_Table"]}static typeGuard(ka){return df.a.matchesTypesFor(ka,[bm.getTypeName()])}}bm.H_={T_:bm.getTypeName(),B_:bm.getBaseTypes()};var Bf;(function(ka){ka[ka.Top=0]="Top";ka[ka.Center=1]="Center";ka[ka.Bottom=2]="Bottom"})(Bf||(Bf={}));var ig;(function(ka){ka[ka.none=
0]="none";ka[ka.firstRow=32]="firstRow";ka[ka.lastRow=64]="lastRow";ka[ka.firstCol=128]="firstCol";ka[ka.lastCol=256]="lastCol";ka[ka.noHBand=512]="noHBand";ka[ka.noVBand=1024]="noVBand";ka[ka.nwCell=160]="nwCell";ka[ka.neCell=288]="neCell";ka[ka.swCell=192]="swCell";ka[ka.seCell=320]="seCell";ka[ka.defaultLook=1184]="defaultLook"})(ig||(ig={}));Object(e.b)("TableLookFlags",ig);class md{RAb(ka){if(ka)switch(ka.type){case 14:return this.$cl(ka);case 15:return new dh;case 16:return this.Zcl(ka)}else a.ULS.sendTraceTag(524149331,
389,10,"ConvertNodeToTile: Node can't be null.")}$cl(ka){var Va=ka.eG||[];let vb=0;for(let Wb=0;Wb<Va.length;Wb++)vb+=Va[Wb];Va=Va.map((Wb,nc)=>({columnId:nc.toString(),widthPercent:0!=vb?100*Wb/vb:0}));return new rh({columnDefs:Va,tableLook:ka.properties.ia(ma.a.tableLook,ig.defaultLook),complexTable:ka.properties.ia(ma.a.complexTable,!1),floatingTable:ka.properties.ia(ma.a.xwi,!1)})}Zcl(ka){return new Ki({rowspan:ka.properties.ia(ma.a.rowSpan,1),colspan:ka.properties.ia(ma.a.colSpan,1),borderInfo:{topBorder:{color:ka.properties.ia(ma.a.yPb,
0),size:ka.properties.ia(ma.a.Ekc,4),style:ka.properties.ia(ma.a.rpb,"single")},leftBorder:{color:ka.properties.ia(ma.a.wPb,0),size:ka.properties.ia(ma.a.Ckc,4),style:ka.properties.ia(ma.a.ppb,"single")},rightBorder:{color:ka.properties.ia(ma.a.xPb,0),size:ka.properties.ia(ma.a.Dkc,4),style:ka.properties.ia(ma.a.qpb,"single")},bottomBorder:{color:ka.properties.ia(ma.a.vPb,0),size:ka.properties.ia(ma.a.Bkc,4),style:ka.properties.ia(ma.a.opb,"single")}},verticalAlignment:ka.properties.ia(ma.a.Aqa,Bf.Top),
ghostCell:ka.properties.ia(ma.a.ghostCell,!1),renderCell:ka.properties.ia(ma.a.renderCell,!1),skippedCell:ka.properties.ia(ma.a.skippedCell,!1),fillColor:ka.properties.ia(Mc.a.vH,0),verticalMerge:ka.properties.ia(vf.a.vMerge,null)})}tNc(ka){return null===ka||void 0===ka?void 0:ka.properties}}Object(e.a)(md,"TableElementNodeToTileConverter",null,[578]);class td{constructor(ka,Va,vb){this.Mo=Va;this.Nya=vb;this.HKd=!1;this.Vrc=null;this.$Wi=(Wb,nc)=>{this.Yxa(nc.node,0)};this.WWi=(Wb,nc)=>{Wb=nc.node;
this.Nya.uNb(Wb.id.toString(),Db.a.sM(Wb))};this.aXi=(Wb,nc)=>{this.Yxa(nc.node,3)};this.Z7d=(Wb,nc)=>{this.Yxa(nc.node,2)};this.cXi=(Wb,nc)=>{this.Yxa(nc.node,0)};this.dXi=(Wb,nc)=>{this.Yxa(nc.node,3)};this.bXi=(Wb,nc)=>{Wb=nc.node;this.Nya.uNb(Wb.id.toString(),Db.a.sM(Wb))};this.$7d=(Wb,nc)=>{this.Yxa(nc.node,2)};this.YWi=(Wb,nc)=>{this.Yxa(nc.node,0)};this.XWi=(Wb,nc)=>{Wb=nc.node;this.Nya.uNb(Wb.id.toString(),Db.a.sM(Wb))};this.ZWi=(Wb,nc)=>{this.Yxa(nc.node,3)};this.X7d=(Wb,nc)=>{var Qc;Wb=
nc.node;if(nc.property===ma.a.ghostCell){if(nc=Wb.gg?Wb:null===(Qc=Wb.bxa)||void 0===Qc?void 0:Qc.controlCell){Qc=cd.GraphIterator.$a(nc);var Hd=Qc.xq();for(var xd=0;xd<Hd;xd++){Qc.yG(xd);var Id=Gd.OutlineElementNavigator.Ge(Qc);this.Nya.uNb(Id.id.toString(),String.format("{0}\\{1}",Db.a.sM(nc),Id.id));this.Yxa(Id,4);Qc.hd(16)}}}else if(nc.property===Mc.a.ff){nc=cd.GraphIterator.$a(Wb);Qc=nc.xq();let Ve=null;Hd=[];for(xd=0;xd<Qc;xd++){nc.yG(xd);Id=Gd.OutlineElementNavigator.Ge(nc);this.Nya.b9n(Id.id.toString(),
String.format("{0}\\{1}",Db.a.sM(Wb),Id.id));if(14!==Id.type){if(Ve=Db.a.sM(Id))this.Nya.uNb(Id.id.toString(),Ve),this.Yxa(Id,5)}else Hd.push(Id);nc.hd(16)}Ve&&Hd.forEach(mf=>{this.Nya.uNb(mf.id.toString(),String.format("{0}\\{1}",Ve.split("\\").slice(0,-1).join("\\"),mf.id));this.Yxa(mf,5)})}this.Yxa(Wb,2)};this.ZQf=()=>{this.Q7c()?this.SM():this.HKd&&!this.Nya.x8&&this.aza()};this.qSb=ka.$("AugLoopOperationsAreEnabled")}get K_c(){return this.Vrc}init(){this.Q7c()&&this.SM();this.Nya.uph(this.ZQf)}SM(){const {Mwj:ka,
Fke:Va,Awj:vb}=this.P7h();if(ka&&Va&&vb){this.HKd=!0;var Wb=this.WWi,nc=this.aXi,Qc=this.Z7d;ka.Ot(this.$Wi);ka.eT(Wb);ka.Kw(nc);ka.Fo(Qc);Wb=this.bXi;nc=this.dXi;Qc=this.$7d;Va.Ot(this.cXi);Va.eT(Wb);Va.Kw(nc);Va.Fo(Qc);Wb=this.XWi;nc=this.ZWi;Qc=this.X7d;vb.Ot(this.YWi);vb.eT(Wb);vb.Kw(nc);vb.Fo(Qc)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}aza(){const {Mwj:ka,Fke:Va,Awj:vb}=this.P7h();if(ka&&Va&&vb){this.HKd=!1;var Wb=this.WWi,nc=
this.aXi,Qc=this.Z7d;ka.PU(this.$Wi);ka.Ica(Wb);ka.yia(nc);ka.QU(Qc);Wb=this.bXi;nc=this.dXi;Qc=this.$7d;Va.PU(this.cXi);Va.Ica(Wb);Va.yia(nc);Va.QU(Qc);Wb=this.XWi;nc=this.ZWi;Qc=this.X7d;vb.PU(this.YWi);vb.Ica(Wb);vb.yia(nc);vb.QU(Qc)}else a.ULS.sendTraceTag(524149330,389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}Yxa(ka,Va){ka&&this.E6a(ka)&&this.Nya.x8&&this.qSb&&this.Nya.mce(ka,Va)}P7h(){return{Mwj:this.Mo.Ze(14),Fke:this.Mo.Ze(15),Awj:this.Mo.Ze(16)}}E6a(ka){const Va=
V.App.ya.gb.wc;return!!Va&&Va.fv&&!!Va.ed&&!!Va.ed.Kc&&!!ka&&!!ka.Kc&&ka.Kc.id===Va.ed.Kc.id}Q7c(){return!this.HKd&&!!this.Nya.x8}}Object(e.a)(td,"TableNodeEventHandler",null,[577]);class wd{constructor(ka,Va){this.UZi=ka;this.rEo=Va}yEb(ka){return ka?14===ka.type||15===ka.type||16===ka.type?this.rEo:12===ka.type?this.UZi:null:null}}Object(e.a)(wd,"NodeToTileConverterHolder",null,[575]);var pm=c(332);class ai{get name(){return"Box4.AugmentationLoop"}xc(ka){this.W=ka;const Va=this.W.resolve("Common.IAppSettingsManager"),
vb=Va.$("AugLoopTaskUseTimeBasedYieldStrategy"),Wb=new $d,nc=vb?new da.a(Va.mc("AugLoopTaskAllowedRunTimeBeforeYielding",10),G.a.$e):new Z(Va.mc("AugLoopTaskNodesToRunBeforeYielding",10));this.W.ha("Common.ICpuMeter",()=>R.a.instance).singleInstance();this.W.ha("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new Lb).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").singleInstance();this.W.ha("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new Lg(Va,V.App.Lj.Bl.Ze(12),Wb,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),
this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),z.AFrameworkApplication.nc,this.W.resolve("Box4.Intent.IIntentRangeEditor"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").singleInstance();Db.a.Ehe()&&this.W.ha("Box4.AugmentationLoop.TableNodeEventHandler",
()=>new td(Va,V.App.Lj.Bl,Wb)).singleInstance();this.W.ha("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new U).singleInstance();this.W.ha("Box4.AugmentationLoop.IFormattingExtractor",()=>new Se(this.W.resolve("Common.IAppSettingsManager"),this.W.Na("Box4.IFeatureHelper"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IParagraphIndentationReader"),this.W.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();this.W.ha("Box4.AugmentationLoop.IAnnotationPolicies",()=>
new ea.a(new W.a(()=>V.App.ya.gb.Uc.od),this.W.resolve("Box4.Intent.IIntentRangeEditor"))).singleInstance();this.W.ha("Box4.AugmentationLoop.IPersistedAnnotationStorage",()=>new Rb(this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.IIntelligenceReader"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),new W.a(()=>V.App.ya.gb.Uc.od),ka.resolve("Box4.IFeatureHelper"))).singleInstance();const Qc=this.W.resolve("IRoamingDictionary");this.W.ha("Box4.AugmentationLoop.IAnnotationStorage",
()=>new Wa(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.Intent.IIntentRangeEditor"),new W.a(()=>V.App.ya.gb.Uc.od),z.AFrameworkApplication.nc,this.W.Na("Box4.IIntelligenceReader"),this.W.Na("Box4.IIntelligenceEditor"),this.W.Na("Box4.AugmentationLoop.IAnnotationPolicies"),this.W.Na("Box4.AugmentationLoop.IPersistedAnnotationStorage"),ka.resolve("Box4.IFeatureHelper"),pm.a.instance,()=>{try{return Ib.a.getAugLoopRuntimeManager()}catch(Hd){return a.ULS.sendTraceTag(50935320,
389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",Hd),null}},Qc)).singleInstance();this.W.ha("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new wd(new bc.a(this.W.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new md)).singleInstance();this.W.ha("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",()=>new od(Va,Wb,z.AFrameworkApplication.nc,nc,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),this.W.resolve("Box4.ISelectionManager"))).singleInstance();a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.W.ha("Box4.AugmentationLoop.IUtilsWrapper",()=>new ub).singleInstance();this.W.ha("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new Yb).singleInstance()}init(){if(z.AFrameworkApplication.K&&z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CloseALSession",
!1)&&z.AFrameworkApplication.ZF.BootFailed)a.ULS.sendTraceTag(512624089,389,10,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(z.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const ka=new ob(this.W.resolve("Common.IAppSettingsManager"),z.AFrameworkApplication.Ne,V.App.nda,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),X.a.instance,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage")),
Va=new aa;this.W.register(553,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").singleInstance().eZo(()=>Va);z.AFrameworkApplication.ue("b8afb343;bjdjj400");z.AFrameworkApplication.ue("72af9564;82jf1647");const vb=Db.a.OYm(this.W.resolve("Common.IDynamicScriptLoaderProvider").Kz,this.W.resolve("Common.App.OAuth.IOAuthManager"),ka,this.W.resolve("Common.ISharedDependencyLoader"),Va);this.W.ha("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new ab(vb)).singleInstance();this.W.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();
Db.a.Ehe()&&this.W.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();this.W.resolve("Box4.IIntelligenceReader").init();this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(ka){A.a.instance.Fc(new ai,0,ka);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(e.a)(ai,"Box4AugmentationLoopPackage",null,[1,2]);var Zg=c(602),Tk=c(43),el=c(12),zl=c(406),ei=c(1132);class fi{constructor(ka,
Va,vb,Wb=null,nc=null,Qc=null){this.gO=new ei.a(Va,Wb,nc,Qc);this.Ib=ka;this.Nc=vb}get type(){return this.gO.type}get id(){return this.gO.id}get intent(){return this.gO.intent}Ef(ka){return new fi(ka,this.type,this.Nc,this.id,this.intent,this.gO.oxa)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.gO,this.Nc)}}Object(e.a)(fi,"IntentObject",null,[153]);var Lj=c(471),cm=c(150),Rg=c(244);class Xf{constructor(){this.Psc=new cm.a}Zyd(ka,Va,vb,Wb,nc=null,Qc=null,Hd=null){ka=ka.s_(Va,
ka.pa.GLo(Va));ka.Hj||(ka.Hj=new Lj.a(ka));ka.Hj.add(new fi(ka,vb,Wb,nc,Qc,Hd));ka.isFromErrorRangeSplit=!0}O9i(ka){return ka.Ib&&ka.Ib.Hj&&ka.Ib.Hj.d4c(Va=>Va===ka,[ka.type])?!0:!1}P9i(ka,Va){if(ka.type===Va.type&&ka.Nc&&!Va.Nc&&ka.Ib&&ka.Ib.Hj&&ka.Ib.Hj.contains(ka)&&Va.Ib&&Va.Ib.Hj&&Va.Ib.Hj.contains(Va)){var vb=[ka.type];ka.Ib.Hj.d4c(Wb=>Wb===ka,vb);Va.Ib.Hj.d4c(Wb=>Wb===Va,vb)}}YZo(ka,Va,vb){if(!Va)return!1;vb=new Ya.a([vb]);for(let Wb=0;Wb<ka.length;Wb++){const nc=ka.J(Wb);if(!nc.Hj)continue;
let Qc=!0;vb.iUa(nc.Hj,void 0,Hd=>{Hd.id&&Va.equals(Hd.id)&&(Qc=!1)});if(!Qc)return!1}return!0}$Dn(ka,Va,vb,Wb){let nc=null,Qc=null;Va=new Ya.a([Va]);const Hd=ka.pa;for(let xd=0;xd<Hd.length;xd++){const Id=Hd.J(xd);if(!Id.Hj)continue;let Ve=!0;Va.iUa(Id.Hj,void 0,(mf,fg)=>{if(fg){var Dg=fg.Ib.cp<vb,Zf=mf.Ib.cp>Wb;Dg&&mf.Ib.cp<=vb||fg.Ib.cp>=Wb&&Zf||(Dg&&Zf?Ve=!1:Dg?nc=mf:Zf?Qc=fg:this.P9i(fg,mf))}});if(!Ve)return!1}if(nc){if(!this.O9i(nc))return!1;this.Zyd(ka,vb,nc.type,nc.Nc,nc.id,nc.intent,nc.gO.oxa)}if(Qc){if(!this.O9i(Qc))return!1;
this.Zyd(ka,Wb,Qc.type,Qc.Nc,Qc.id,Qc.intent,Qc.gO.oxa)}return!0}adg(ka){let Va;return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:Va}=this.Psc.Dc(ka.type,Va)).returnValue?Va.adg(ka):!0}X8m(ka,Va){if(this.adg(Va)){var vb=Va.id,Wb=Va.type,nc=Va.begin,Qc=Va.end;if(({cpEnd:Qc}=Xf.vIj(ka,nc,Qc)).returnValue){if(zl.a(Wb)){if(!this.YZo(ka.pa,vb,Wb))return}else if(!this.$Dn(ka,Wb,nc,Qc))return;this.Zyd(ka,nc,Wb,!0,vb,Va.intent,Va.gO.oxa);this.Zyd(ka,
Qc,Wb,!1,vb,Va.intent,Va.gO.oxa)}}}e1c(ka,Va){V.App.ya.thf(ka,()=>{const vb=new Tk.GraphTransaction(2);try{vb.Cb(ka);const Wb=ka.MY();try{const nc=ka.o_();try{Va()}finally{nc&&nc.dispose()}}finally{Wb&&Wb.dispose()}}finally{vb&&vb.dispose()}})}$Qa(ka,Va){this.e1c(ka,()=>{this.X8m(ka,Va)})}Z8m(ka,Va){if(Va.count){var vb=new Pa.a,Wb=new Rg.a;for(var nc of Va){var Qc=nc.value;zl.a(nc.key)||Qc.Sc((xd,Id)=>xd.begin!==Id.begin?xd.begin-Id.begin:xd.end-Id.end);if(Xf.b_o(Qc))for(var Hd of Qc)Qc=Hd.end,({cpEnd:Qc}=
Xf.vIj(ka,Hd.begin,Qc)).returnValue&&(Qc=Qc!==Hd.end?new lb.a(Hd.type,Hd.begin,Qc,Hd.id,Hd.intent,Hd.gO.oxa):Hd,vb.add(Qc.begin),vb.add(Qc.end),Xf.Vrk(Wb,Qc))}ka.dKd(vb);ka=ka.pa;for(vb=0;vb<ka.length;vb++){nc=ka.J(vb);if(Hd=nc.Hj)for(const Id of Va.keys)Hd.I$i(Id);let xd;({value:xd}=Wb.Dc(nc.cp,xd)).returnValue||(xd=null);if(xd){Hd||(Hd=nc.Hj=new Lj.a(nc));for(const Id of xd)Hd.add(Id.Ef(nc))}nc.isFromErrorRangeSplit=!0}}}w3d(ka,Va){const vb=new cm.a;for(const Wb of Va){let nc;({value:nc}=vb.Dc(Wb.type,
nc)).returnValue||(nc=new db.a,vb.Z(Wb.type,nc));nc.add(Wb)}this.e1c(ka,()=>{this.Z8m(ka,vb)})}YOo(ka,Va,vb){ka=ka.pa;const Wb=new Ya.a([8]);Va===vb&&(vb+=1);for(let nc=0;nc<ka.length;nc++){const Qc=ka.J(nc);Qc.Hj&&Wb.iUa(Qc.Hj,void 0,(Hd,xd)=>{xd&&Math.max(xd.Ib.cp,Va)<Math.min(Hd.Ib.cp,vb)&&this.P9i(xd,Hd)})}}klg(ka,Va,vb){this.e1c(ka,()=>{this.YOo(ka,Va,vb)})}$Oo(ka,Va){ka=ka.pa;for(let vb=0;vb<ka.length;vb++){const Wb=ka.J(vb);Wb.Hj&&Wb.Hj.I$i(Va)}}$Ta(ka,Va){this.e1c(ka,()=>{this.$Oo(ka,Va)})}ZOo(ka,
Va,vb){let Wb=!1;Va=Va.pa;vb=[vb];for(let nc=0;nc<Va.length;nc++){const Qc=Va.J(nc);Qc.Hj&&(Wb=Qc.Hj.d4c(ka,vb)||Wb)}return Wb}sad(ka,Va,vb){let Wb=!1;this.e1c(Va,()=>{Wb=this.ZOo(ka,Va,vb)});return Wb}PPd(ka,Va,vb,Wb){return!ka||0>vb||Wb>ka.characterData.length||vb>Wb?new db.a:this.ZOa(ka,Va,nc=>Math.max(nc.begin,vb)<=Math.min(nc.end,Wb))}ZOa(ka,Va,vb){return Xf.uZl(ka,Va,vb)}static uZl(ka,Va,vb){const Wb=new db.a;ka=ka.pa;Va=new Ya.a([Va]);if(!ka)return Wb;for(let nc=0;nc<ka.length;nc++){const Qc=
ka.J(nc);Qc.Hj&&Va.iUa(Qc.Hj,void 0,(Hd,xd)=>{xd&&(Hd=new lb.a(xd.type,xd.Ib.cp,Hd.Ib.cp,xd.id,xd.intent,xd.gO.oxa),vb(Hd)&&Wb.add(Hd))})}return Wb}oOc(ka,Va){const vb=new db.a;if(!Xf.LSm(ka.contextId))return vb;let Wb;const nc=ka.node;ka.contextId!==el.a.paragraph?(Wb=ka.cpBegin,ka=ka.cpEnd):(Wb=0,ka=nc.characterData.length);vb.addRange(this.PPd(nc,Va,Wb,ka));return vb}lUn(ka){this.Psc.nb(0)||this.Psc.Z(0,ka)}static vIj(ka,Va,vb){ka=$a.ParagraphReader.textLength(ka);if(Va>=ka)return{returnValue:!1,
cpEnd:vb};vb>ka&&(vb=ka);return{returnValue:!0,cpEnd:vb}}static b_o(ka){if(!ka.count)return!0;const Va=new Zg.a,vb=ka.J(0).type,Wb=zl.a(vb);let nc=-1;for(const Qc of ka){if(Qc.type!==vb||(zl.c(Qc.type)?Qc.begin>Qc.end:Qc.begin>=Qc.end))return!1;if(Wb){ka=Qc.id;if(!ka||ka.equals(ja.a.nil)||Va.contains(ka))return!1;Va.add(ka)}else if(-1===nc)nc=Qc.end;else if(nc>Qc.begin)return!1}return!0}static Vrk(ka,Va){let vb;({value:vb}=ka.Dc(Va.begin,vb)).returnValue||(vb=new db.a,ka.Z(Va.begin,vb));vb.add(new fi(null,
Va.type,!0,Va.id,Va.intent,Va.gO.oxa));({value:vb}=ka.Dc(Va.end,vb)).returnValue||(vb=new db.a,ka.Z(Va.end,vb));vb.add(new fi(null,Va.type,!1,Va.id,Va.intent,Va.gO.oxa))}static LSm(ka){return ka===el.a.Hd||ka===el.a.Tc||ka===el.a.paragraph}}Object(e.a)(Xf,"IntentRangeEditor",null,[580]);class Si{constructor(){this.W=null}get name(){return"Box4.Intent"}xc(ka){this.W=ka;this.W.ha("Box4.Intent.IntentRangeEditor",()=>new Xf).as("Box4.Intent.IIntentRangeEditor").singleInstance()}init(){this.W.resolve("Box4.IProofingManager")}dispose(){}static main(ka){A.a.instance.Fc(new Si,
0,ka);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}Object(e.a)(Si,"PackageManager",null,[1,2]);var Sl=c(1019),Om=c(110),sg=c(1395);class Dk{constructor(ka){this.m7m=ka;this.i7m=[]}get handler(){return this.m7m}get Vma(){return this.i7m}}Object(e.a)(Dk,"RegisteredListener",null,[]);class yj{constructor(ka,Va){this.type=0;this.payload=null;this.type=ka;this.payload=Va}}Object(e.a)(yj,"OfficeSharedCommentsEvent",null,[858]);class Qj{constructor(){this.eventType=0;this.newViewContainer=
null;this.viewContainerVisibilityState=1}}Object(e.a)(Qj,"ViewContainerEvent",null,[858]);var tg=c(575);class Gh{constructor(ka){this.xLf=!1;this.Uoa=new db.a;this.j3d=ka}ITn(ka){ka=new Dk(ka);this.Uoa.add(ka)}TCj(ka){for(let Va=0;Va<this.Uoa.count;++Va)if(this.Uoa.J(Va).handler===ka){this.Uoa.removeAt(Va);break}}LSa(ka=!1){const Va=()=>{if(z.AFrameworkApplication.Lk)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let nc=0;nc<this.Uoa.count;++nc){const Qc=
this.Uoa.J(nc);for(;0<Qc.Vma.length;){var vb=Array.dequeue(Qc.Vma);if(Object(Om.a)(Qj,vb)){var Wb=Qc.handler;Wb(vb)}else Object(Om.a)(yj,vb)&&(Wb=Qc.handler,Wb(vb.type,vb.payload))}}};ka?Va():this.xLf||(this.xLf=!0,tg.a.Z2(this.j3d,()=>{Va();this.xLf=!1},sg.a.tEl))}}Object(e.a)(Gh,"GenericEventHost",null,[]);class zj{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=
this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(e.a)(zj,"BasicEventPayload",null,[895]);class pj{constructor(ka){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ka}}Object(e.a)(pj,"CommentContextDetails",null,[]);class Il{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=
0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(e.a)(Il,"ContextChangeWithSelectedThreadIndex",null,[895]);class Tl{constructor(){this.tasks=this.comments=null}}Object(e.a)(Tl,"LoadCommentsNoVirtualization",null,[895]);class Qg extends Gh{constructor(ka){super(ka);this.idh=0}oko(){this.idh=1656}sUn(ka,Va,vb,Wb,nc,Qc){ka=new Dk(ka);Qc&&Array.enqueue(ka.Vma,this.V7k(Qc,this.idh));Qc=Va?Va.length:0;Array.enqueue(ka.Vma,this.oKh(Qc,vb,Wb,0));Qc&&Array.enqueue(ka.Vma,this.qLh(Va,
nc));this.Uoa.add(ka);this.LSa()}qQb(ka){this.TCj(ka)}hbo(ka,Va,vb,Wb=0){this.pGb(this.oKh(ka,Va,vb,Wb));this.LSa()}ibo(ka,Va,vb){this.pGb(this.t8k(ka,Va,vb));this.LSa()}Gbo(ka,Va){this.pGb(this.qLh(ka,Va));this.LSa()}selectComment(ka){this.pGb(this.oMh(ka,6));this.LSa()}highlightComment(ka){this.pGb(this.oMh(ka,7));this.LSa()}wmg(ka,Va){this.pGb(this.Bal(ka,Va));this.LSa()}MZf(ka,Va){this.pGb(this.Ccl(ka,Va));this.LSa()}V7k(ka,Va=0){const vb=new zj;vb.modelCapabilityFlags=ka;vb.richTextCapabilityFlags=
Va;return new yj(12,vb)}oKh(ka,Va,vb,Wb){const nc=new zj;nc.numberOfComments=ka;nc.numberOfThreads=Va;nc.contextDetails=Object.assign(new pj(vb),{nextPopulatedContextDetails:Wb});nc.contextDrafts=null;nc.rehydrationDrafts=null;return new yj(0,nc)}t8k(ka,Va,vb){const Wb=new zj;Wb.comments=ka;Wb.numberOfThreads=Va;Wb.tasks=vb;return new yj(2,Wb)}qLh(ka,Va){const vb=new Tl;vb.comments=ka;vb.tasks=Va;return new yj(1,vb)}oMh(ka,Va){const vb=new zj;vb.commentId="";ka&&(vb.commentId=ka);return new yj(Va,
vb)}Bal(ka,Va){const vb=new zj;vb.changes=[];vb.contextDetails=Object.assign(new pj(Va),{nextPopulatedContextDetails:ka});return new yj(10,vb)}Ccl(ka,Va){const vb=new zj;vb.commentId=ka;vb.smartReplies=Va;return new yj(15,vb)}pGb(ka){for(let Va=0;Va<this.Uoa.count;++Va)Array.enqueue(this.Uoa.J(Va).Vma,ka)}}Object(e.a)(Qg,"OfficeSharedCommentsEventHost",Gh,[883]);var An=c(230),Xj=c(188),Gk=c(273);class dm{constructor(){this.sRe=this.oKg=!1;this.BI=this.kn=this.zZg=this.L4g=this.Dxd=this.CXb=this.Qhh=
this.VOg=this.Kz=this.GAc=null}initialize(ka,Va,vb,Wb=null,nc=null,Qc=null,Hd=null,xd=null,Id=null,Ve=null){this.Kz=ka;this.VOg=Va;this.Qhh=vb;this.CXb=Wb;this.Dxd=nc;this.L4g=Qc;this.zZg=Hd;this.kn=xd;this.oKg=!0;this.BI=Id;this.GAc=Ve}EWd(ka=null,Va=null){if(!this.oKg)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((vb,Wb)=>{Wb(tg.a.ED(-2130915313))});if(this.sRe)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),
new Promise(()=>{});this.GAc||(z.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?this.GAc=appResourceLoader.loadChunk("sharedComments"):this.GAc=this.Kz.loadScript("sharedComments"));return this.GAc.then(()=>{ka&&ka();this.sRe||(this.BI&&this.BI.execute(vb=>{vb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),Va&&Va(),sharedComments.instantiate(this.VOg,this.Qhh,this.CXb,this.Dxd,this.L4g,this.zZg,this.kn));this.sRe=!0})}}Object(e.a)(dm,
"CommentActivationManager",null,[927]);class Pm extends Gh{constructor(ka){super(ka)}gWn(ka){this.ITn(ka)}VPo(ka){this.TCj(ka)}Ymj(ka){ka=this.p8k(ka);for(let Va=0;Va<this.Uoa.count;++Va)Array.enqueue(this.Uoa.J(Va).Vma,ka);this.LSa(!0)}p8k(ka){const Va=new Qj;Va.eventType=3;Va.viewContainerVisibilityState=ka;return Va}REl(){const ka=this.Hdl();for(let Va=0;Va<this.Uoa.count;++Va)Array.enqueue(this.Uoa.J(Va).Vma,ka);this.LSa(!0)}Hdl(){const ka=new Qj;ka.eventType=2;return ka}}Object(e.a)(Pm,"ViewContainerEventHost",
Gh,[850]);var qm=c(55);class eg{constructor(){this.actionBehavior=this.actionType=0}}Object(e.a)(eg,"CommentUIActionPayload",null,[]);var Hk=c(304);class Qm{constructor(ka,Va){this.ga=ka;this.Uqb=Va;this.boc=new Hk.a;for(let vb of this.Uqb)this.boc.Z(vb.value.canvasActionId,vb.key),ka=vb.value,ka.delayActionsUntilRegistration||this.qa(ka)}qa(ka){ka.withFlags?this.ga.fb(ka.canvasActionId,ka.canvasContextId,Object(qm.a)(this,this.lmh,"actionHandler"),97):this.ga.qa(ka.canvasActionId,ka.canvasContextId,
Object(qm.a)(this,this.lmh,"actionHandler"))}jSa(ka,Va){this.Uqb.nb(ka)&&(this.Uqb.J(ka).delayActionsUntilRegistration&&this.qa(this.Uqb.J(ka)),this.Uqb.J(ka).registeredCallback=Va)}lmh(ka,Va,vb,Wb,nc){if(this.boc.nb(ka)){var Qc=this.boc.J(ka);if(!this.Uqb.nb(Qc))return 8;const Hd=this.Uqb.J(Qc);if(Hd.preCallback){const xd=Hd.preCallback(ka,Va,vb,Wb,nc);if(2!==xd)return xd}if(!Hd.registeredCallback)return 1===vb?8:2;Qc=Object.assign(new eg,{actionType:Qc});1===vb&&(Qc.actionBehavior=1);Qc=Hd.registeredCallback(Qc);
return Hd.postCallback?Hd.postCallback(Qc,ka,Va,vb,Wb,nc):Qc?32:8}return 2}}Object(e.a)(Qm,"OfficeSharedCommentsActionHost",null,[885]);var Uf=c(1798),Jd=c(65),kl=c(130),Ik=c(1448),tf=c(13),hd=c(27),lg=c(538),Bn=c(1137),Rj=c(131),ge=c(306),Uc=c(46),ql=c(21),Cg=c(1037),yg=c(1030),Bh=c(1556),ug=c(166),Ee=c(11),pf=c(37),sj=c(694),Nn=c(466),Sg=c(16),Rf=c(2003);class $k{constructor(ka){this.RV=ka;this.Hfc=new O.a;this.U1a=new O.a;this.yxm();this.jrm=[new Rf.a(pf.a.JFh,pf.a.b0k),new Rf.a(pf.a.CEd,pf.a.a0k),
new Rf.a(pf.a.AFh,pf.a.Q_k),new Rf.a(pf.a.uEd,pf.a.P_k),new Rf.a(pf.a.KFh,pf.a.d0k),new Rf.a(pf.a.DEd,pf.a.c0k)]}nSa(ka){this.RV.nSa(ka);this.oXn(ka)}LEf(ka,Va){return!!ka&&!!ka.objectId&&Va.contains(ja.a.If(ka.objectId))}wQa(ka){ka=Object(yb.a)(627,ka);return!!ka&&!!ka.objectId}oXn(ka){for(const Va of this.jrm)ka.classList.remove(Va.className,Va.bQc);ka.classList.remove(pf.a.mZf,pf.a.FEd,pf.a.BFh,pf.a.EEd,$k.urg)}yxm(){const ka=new O.a,Va=new O.a;ka.add(0,null);ka.add(1,pf.a.CEd);ka.add(2,pf.a.JFh);
ka.add(3,pf.a.FEd);Va.add(0,null);Va.add(1,pf.a.uEd);Va.add(2,pf.a.AFh);Va.add(3,pf.a.BFh);this.U1a.Z(1,ka);this.U1a.Z(2,Va);this.U1a.Z(3,Va);this.Hfc.add(0,null);this.Hfc.add(1,pf.a.DEd);this.Hfc.add(2,pf.a.KFh);this.Hfc.add(3,pf.a.EEd)}}$k.urg="CommentImportant";Object(e.a)($k,"CommentHighlightUtils",null,[]);class gi{constructor(){this.FJd=0;this.AAb=null}}Object(e.a)(gi,"CommentGuidsInElementInfo",null,[]);class ym{constructor(){this.Yli=!1;this.jma=this.HKb=null;this.QRa=this.LFb=0}}Object(e.a)(ym,
"HighlightInfoForElement",null,[]);class jn{constructor(){this.vpi=this.xpi=this.wpi=-1;this.qni=[];this.I2b=[];this.WRc=this.XRc=-1;this.tui=!1}}Object(e.a)(jn,"HighlightInfoForElementsInPara",null,[]);class ii{constructor(){this.hlg=this.IUf=null}}Object(e.a)(ii,"OnAnchorMouseOutData",null,[]);var Hh=c(1486);class qk{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd){this.Bve=ka;this.k$=Va;this.rk=vb;this.b2=Wb;this.ga=nc;this.Hb=Qc;this.rj=Hd;this.YWa=this.$i=null;this.rkn=Id=>{if(!this.$i||this.b2.MYd)return!0;
if(Id=Id.Oo){if(this.$i.KA&&Id[0].toString()===this.$i.KA.objectId)return!0;this.YWa&&Id[0].equals(this.YWa.hlg[0])?this.Hb.Ve(this.YWa.IUf):(this.YWa&&(this.Hb.Ve(this.YWa.IUf),this.ga.Qb(tf.a.GEd,2,this.YWa.hlg)),this.$i.lp.uui(Id[0])&&!this.rj.Zm||this.ga.Qb(tf.a.k8e,2,Id));this.YWa=null}return!0};this.qkn=Id=>{if(this.b2.MYd)return!0;const Ve=Id.Oo;Ve&&(Id=new pa.a(2,1,0,()=>{this.ga.Qb(tf.a.GEd,2,Ve);this.YWa=null}),this.Hb.Vb(Id),this.YWa=Object.assign(new ii,{IUf:Id,hlg:Ve}));return!0};this.BSi=
Id=>{const Ve=new pa.a(2,1,0,()=>{if(this.$i&&!this.$i.lp.ny){var mf=Id.Oo;if(!mf)mf=V.App.ya.Bp.currentScope,this.$i.KA&&(!mf||mf.name!==ug.AFrame.qM&&mf.name!==ug.AFrame.Gr)&&this.$i.clearSelection();else if(!this.$i.KA||mf.toString()!==this.$i.KA.objectId)if(mf=this.$i.lp.w_(mf.toString()))mf=Object.assign(new Ik.a,{commentId:mf.id,GR:!1,C9:1}),this.ga.Qb(Sg.a.selectComment,2,mf)}});this.Hb.Vb(Ve);return!1};xd.execute(Id=>{this.$i=Id})}Yxh(ka,Va,vb,Wb){const nc=new jn,Qc=[],Hd=this.k$.wQa(Va)?
Va.objectId:null;for(let Ve=0,mf=ka.length;Ve<mf;Ve++){var xd=ka[Ve],Id=Hh.g(xd);const fg=Hh.d(xd);xd=new Zg.a;const Dg=new ym;if(Id){const Zf=new Nn.a(Hh.c);Id=this.bZh(Id,Hd,Zf);0<Id.length&&(this.wTo(Id,vb,xd,Dg,Hd,Wb),Qc.push(Object.assign(new gi,{FJd:Ve,AAb:Zf})))}fg&&(Id=this.bZh(fg,Hd),0<Id.length&&(this.yTo(Id,vb,xd,Dg,nc,Hd,Wb,Ve),this.RRo(Qc,Id,Ve,Dg)));0<vb.count&&this.zTo(Va,vb,Dg,Wb);this.PRo(Qc,Dg);nc.qni.push(Dg)}return nc}pth(ka,Va,vb){let Wb=!1;for(let nc=0,Qc=ka.length;nc<Qc;nc++){const Hd=
ka[nc],xd=Va.qni[nc],Id=sj.a(Hd);if(1!==Id&&2!==Id&&3!==Id)continue;const Ve=3===Id||2===Id&&-1!==Hd.className.indexOf(pf.a.CPa);this.k$.nSa(Hd);this.Usk(Hd,xd,Ve,Wb);this.Grk(Hd,nc,Id,xd,Va,vb);this.Hrk(Hd,nc,Va,xd);Wb=Ve}}bZh(ka,Va,vb=null){const Wb=[];for(let nc=0;nc<ka.length;nc++)this.Bve.xoj(ka[nc],ka[nc].toString()===Va)&&(Wb.push(ka[nc]),vb&&vb.add(ka[nc]));return Wb}wTo(ka,Va,vb,Wb,nc,Qc){var Hd;let xd=!1,Id=!1;for(const mf of ka){Va.add(mf);vb.add(mf);var Ve=mf.toString();Ve===nc?(Ve=Qc?
1:2,Wb.QRa=Ve,Wb.LFb=Ve):this.LEf(this.$i.KA,Va)&&(Ve===(null===(Hd=this.$i.KA)||void 0===Hd?void 0:Hd.objectId)&&(Id=!0),xd=!0)}0<ka.length&&!Wb.QRa&&(Wb.QRa=Id?1:3,Wb.LFb=xd?1:3)}yTo(ka,Va,vb,Wb,nc,Qc,Hd,xd){var Id,Ve;const mf=new Nn.a(Hh.c);Hd=Hd?1:2;let fg=!1;for(const Dg of ka){const Zf=Dg.toString();Va.contains(Dg)||(Zf===Qc?nc.vpi=xd:(nc.wpi=xd,Wb.QRa=3,(null===(Id=this.$i.KA)||void 0===Id?void 0:Id.objectId)===Zf&&(nc.xpi=xd,Wb.QRa=1)),mf.add(Dg));Zf===(null===(Ve=this.$i.KA)||void 0===Ve?
void 0:Ve.objectId)&&(fg=!0);Va.remove(Dg);vb.contains(Dg)&&this.xTo(Wb,Dg,Zf,Qc,Hd);Zf===Qc&&(Wb.QRa=Hd)}0<ka.length&&!Wb.QRa&&(Wb.QRa=fg?1:3);0<mf.count&&nc.I2b.push(Object.assign(new gi,{FJd:xd,AAb:mf}))}RRo(ka,Va,vb,Wb){0!==ka.length&&(Va.forEach(nc=>{for(let Qc=ka.length-1;0<=Qc;Qc--){const Hd=ka[Qc];if(Hd.AAb.contains(nc)){Hd.FJd===vb&&(Wb.jma?Wb.jma.push(nc):Wb.jma=[nc]);Hd.AAb.remove(nc);break}}}),ka=ka.filter(nc=>0<nc.AAb.count))}zTo(ka,Va,vb,Wb){var nc,Qc;this.LEf(ka,Va)?vb.LFb=Wb?1:2:vb.LFb||
(vb.LFb=null!=(null===(nc=this.$i.KA)||void 0===nc?void 0:nc.objectId)&&Va.contains(ja.a.If(null===(Qc=this.$i.KA)||void 0===Qc?void 0:Qc.objectId))?1:3);vb.HKb||(vb.HKb=[]);for(const Hd of Va)vb.HKb.push(Hd)}PRo(ka,Va){if(0<ka.length){Va.jma||(Va.jma=[]);for(const vb of ka[ka.length-1].AAb)Va.jma.push(vb)}}xTo(ka,Va,vb,Wb,nc){ka.Yli=!0;ka.HKb||(ka.HKb=[]);ka.HKb.push(Va);vb===Wb&&(ka.LFb=nc)}LEf(ka,Va){return!!ka&&!!ka.objectId&&Va.contains(ja.a.If(ka.objectId))}Usk(ka,Va,vb,Wb){!Va.QRa||vb||Wb||
((vb=this.k$.Hfc.J(Va.QRa))&&ka.classList.add(vb),Va.Yli&&ka.classList.add(pf.a.mZf))}Grk(ka,Va,vb,Wb,nc,Qc){Wb=this.k$.U1a.J(vb).J(Wb.LFb);Va<nc.vpi?Wb=Qc?this.k$.U1a.J(vb).J(1):this.k$.U1a.J(vb).J(2):Va<nc.wpi&&!Wb&&(Wb=Va<nc.xpi?this.k$.U1a.J(vb).J(1):this.k$.U1a.J(vb).J(3));Wb&&(Va=nc.tui,ka.classList.add(Wb),Va&&ka.classList.add($k.urg))}Hrk(ka,Va,vb,Wb){Wb.jma||(Wb.jma=this.pPl(Va,vb)||Wb.HKb);Va=null;Wb.jma&&0<Wb.jma.length&&(this.rk.lb(Ee.a.o0,ka,this.rkn,Wb.jma),this.rk.lb(Ee.a.cxa,ka,this.qkn,
Wb.jma),Va=Wb.jma[0]);this.rk.lb(Ee.a.click,ka,this.BSi,Va);this.rk.lb(Ee.a.NJ,ka,this.BSi,Va)}pPl(ka,Va){for(;0<Va.I2b.length&&Va.I2b[0].FJd===ka;)Va.I2b.splice(0,1);if(0<Va.I2b.length){ka=[];for(const vb of Va.I2b[0].AAb)ka.push(vb);return ka}return null}}Object(e.a)(qk,"AllMarkupModeHighlightChangeHandler",null,[622]);var Vf=c(1458);class Sj extends Vf.a{constructor(ka){super(100,25);this.$nc=new O.a(0);this.AUj=6E4;this.pEl=()=>{const Va=this.$nc.keys;if(Va.length){var vb="";for(let Wb=0;Wb<Va.length;Wb++)vb+=
Va.J(Wb)+":"+this.$nc.J(Va.J(Wb))+";";this.Kpa(vb);this.$nc=new O.a(0)}};this.drb=new db.a;this.drb.add(1);this.drb.add(6);this.drb.add(2);this.drb.add(4);this.drb.add(10);this.drb.add(11);this.ih=ka;ka.d3f&&window.setInterval(this.pEl,this.AUj)}VGa(ka){this.ih.LNo&&this.ih.d3f&&(this.drb.contains(ka)?this.rOn(ka):this.Kpa(ka+""))}rOn(ka){this.$nc.Z(ka,this.$nc.jz(ka,0)+1)}}Object(e.a)(Sj,"CommentActionInTypingRecorder",Vf.a,[633]);var fe=c(1595),cj=c(238);class im{static BYn(ka){ka&&ka.atmention&&
delete ka.atmention.isCurrentUser;return ka}}Object(e.a)(im,"DeltaFormatHelpers",null,[]);class vg{constructor(){this.optional=this.attributes=null}}Object(e.a)(vg,"Operation",null,[]);class Wf extends vg{constructor(){super();this.insert=null}}Object(e.a)(Wf,"DeltaOperation",vg,[]);class $g{constructor(){this.ops=null}}Object(e.a)($g,"Delta",null,[]);var Ti=c(136),Rm=c(183),Rd=c(149),Mo=c(56),Bd=c(68),ll=c(121),$f=c(488),mg=c(1181),Za=c(1751);class Hb extends Za.ACommentFormatTranslator{constructor(ka,
Va){super(ka);this.we=Va}ljg(ka){const Va=new fe.a;for(let vb=0;vb<ka.length;vb++){const Wb=ka[vb];Wb.NGb=!0;this.pCk(Va,Wb);Va.Wga("\n")}return[Va.GNc()]}bIo(ka,Va){ka=fe.a.QDb(ka[0]);ka=this.yEn(ka);const vb=new db.a;let Wb=0,nc=null,Qc=null;for(;Wb<ka.ops.length;){const Hd=ka.ops[Wb];nc||(nc=mg.a.instance.createInstance(393230),nc.NGb=!0,nc.Zg(ma.a.Lc,cj.a.vF()),Va(nc),nc.pa.clear(),nc.dqa(""));"\n"===Hd.insert?(Qc=this.FJf(nc,Qc),this.Mmo(nc),vb.add(nc),nc=null):Qc=this.RZm(nc,Hd,Qc);Wb++}return vb.toArray()}Mmo(ka){const Va=
ka.Gzh();for(let vb=0;vb<Va;vb++)ka.ze.iq.Z(vb,Hb.Jen),ka.ze.Vs.Z(vb,Hb.DQf)}FJf(ka,Va){var vb=ka.cKd();vb.cp===ka.characterData.length?vb.Sh=!0:(vb=Object.assign(new Rm.a(ka,ka.characterData.length),{Sh:!0}),ka.pa.add(vb));vb=ka.pa.last;if(Va){Va=!!Va.Xv;const Wb=this.cHh(ka,vb,!Va,Va,null);vb.formatting=Wb;Va&&(ka=this.aHh(ka,vb),vb.jU=ka.Fj);vb.Om=!0;Va=null}vb.cp||vb.formatting||(vb.formatting=new Rd.a(vb,ja.a.nil));return Va}RZm(ka,Va,vb){const Wb=ka.cKd(),nc=!!Va.attributes&&!!Va.attributes.link,
Qc=!!Va.attributes&&!!Va.attributes.atmention,Hd=this.cHh(ka,Wb,nc,Qc,Va);Wb.formatting=Hd;vb&&(vb.Xv&&(vb=this.aHh(ka,Wb),Wb.jU=vb.Fj),Wb.Om=!0,vb=null);if(nc||Qc)this.rZm(Wb,ka,Va),vb=Wb.hyperlink;ka.dqa(ka.characterData+Va.insert);return vb}aHh(ka,Va){Va=new Rd.a(Va,ja.a.create());let vb=this.NGd();vb.setValue(ma.a.NHb,!0);vb=ka.Kc.BR(vb);Va.Fj=vb.id;return Va}cHh(ka,Va,vb,Wb,nc){Va=new Rd.a(Va,ja.a.create());let Qc=mg.a.instance.createInstance(1179649);if(vb||Wb)Qc.setValue(Mc.a.BB,!0),Qc.setValue(Mc.a.g4,
!0),vb&&this.xeo(ka,Qc);this.ih.yzb&&nc&&nc.attributes&&this.pko(nc.attributes,Qc);Qc=ka.Kc.BR(Qc);Va.Fj=Qc.id;return Va}xeo(ka,Va){(ka=this.we.JC(ka))&&(ka=ka.Fi(Mo.StyleReader.gRb))&&Va.setValue(Ed.a.aw,ka.id)}pko(ka,Va){this.ZNb(ka.weight>=fe.a.aNf,Va,Mc.a.bold,!0);this.ZNb(ka.italic,Va,Mc.a.italic,!0);this.ZNb(ka.underline,Va,Mc.a.underline,!0);this.ZNb(ka.underline,Va,Mc.a.underlineType,Xe.a.mQb);this.ZNb(ka.strikethrough,Va,Mc.a.strikethrough,!0);if(Bd.a.lWc(ka.highlight)){var vb=Bd.a.GEa(ka.highlight);
this.ZNb(!!ka.highlight,Va,Mc.a.highlight,Bd.a.V4(vb))}Bd.a.lWc(ka.color)&&(vb=Bd.a.GEa(ka.color),this.ZNb(!!ka.color,Va,Mc.a.fontColor,Bd.a.V4(vb)))}ZNb(ka,Va,vb,Wb){ka&&Va.setValue(vb,Wb)}rZm(ka,Va,vb){if(vb.attributes&&vb.attributes.atmention){var Wb=ll.HyperlinkReader.dPa(vb.attributes.atmention.email);vb=vb.optional&&vb.optional.atmention&&vb.optional.atmention.contentId?vb.optional.atmention.contentId:Hb.jIl(1===vb.attributes.atmention.resolveState);Wb=new $f.a(ka,Wb,!0,void 0,void 0,void 0,
vb);this.l7k(Wb,Va.Kc);ka.hyperlink=Wb}else Va=ll.HyperlinkReader.dPa(vb.attributes.link),Wb=this.S9k(ka.paragraph.pa.first),ka.hyperlink=new $f.a(ka,Va,!1,Wb.Fj)}S9k(ka){let Va=this.gMh();Va=ka.paragraph.Kc.BR(Va);ka=new Rd.a(ka,ja.a.nil);ka.Fj=Va.id;return ka}l7k(ka,Va){var vb=String.format(' HYPERLINK "{0}"',ka.url),Wb=ka.Xv;const nc=this.NGd();nc.setValue(ma.a.Ys,15);nc.setValue(ma.a.Xv,Wb);nc.setValue(ma.a.tQa,!0);nc.setValue(ma.a.fieldInstruction,vb);ka.zta(Va.BR(nc).id);Wb=this.NGd();Wb.setValue(ma.a.Ys,
47);Wb.setValue(ma.a.fieldInstruction,vb);ka.zta(Va.BR(Wb).id);vb=this.NGd();vb.setValue(ma.a.Ys,16);ka.zta(Va.BR(vb).id)}gMh(){const ka=mg.a.instance.createInstance(1179649);ka.setValue(Mc.a.BB,!0);ka.setValue(Mc.a.g4,!0);ka.setValue(Mc.a.isHidden,!0);return ka}NGd(){const ka=this.gMh();ka.setValue(Mc.a.T9,!0);return ka}yEn(ka){const Va=new db.a;for(let vb=0;vb<ka.ops.length;vb++){const Wb=ka.ops[vb];Wb.optional=im.BYn(Wb.optional);if(-1!==Wb.insert.indexOf("\n")&&"\n"!==Wb.insert){const nc=Wb.insert.split("\n");
for(let Qc=0;Qc<nc.length;Qc++)if(vb!==ka.ops.length-1||Qc!==nc.length-1||nc[Qc])Va.add(Object.assign(new Wf,{insert:nc[Qc],attributes:Wb.attributes,optional:Wb.optional})),Qc!==nc.length-1&&Va.add(Object.assign(new Wf,{insert:"\n"}))}else Va.add(Wb)}return Object.assign(new $g,{ops:Va.toArray()})}static jIl(ka){return Za.ACommentFormatTranslator.sGk+Ti.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(ka?"Z":"")}}Hb.Jen=0;Hb.DQf=0;Object(e.a)(Hb,"CommentDeltaFormatTranslator",Za.ACommentFormatTranslator,
[]);var $b=c(1658),zc=c(1537);class Jc{get userPrincipalName(){return this.K.jb("UserPrincipalName")}constructor(ka,Va,vb){this.Dj=ka;this.K=Va;this.BK=vb}KD(ka){return this.Dj.KD(ka)}IFm(ka){ka=this.Dj.KD(ka);return ka?!ka.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}HTc(ka){return this.Dj.HTc(ka)}isCurrentUserMentioned(ka){var Va,vb;ka=this.Dj.ePl(ka);for(const Wb of ka){if(!Wb.text||0===Wb.text.length)continue;ka=fe.a.QDb(Wb.text[0]);let nc=0;for(;ka.ops&&
nc<ka.ops.length;){const Qc=null===(vb=null===(Va=ka.ops[nc])||void 0===Va?void 0:Va.attributes)||void 0===vb?void 0:vb.atmention;if(Qc&&Qc.email===this.userPrincipalName)return!0;nc++}}return!1}t_c(){this.BK.s9("OnContentFilterUpdate")}}Object(e.a)(Jc,"CommentFilterActor",null,[632]);var pd=c(97),Qd=c(1999),ye=c(884),Le=c(593);class Af{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd,Id){this.Zh=ka;this.Hb=Va;this.ri=vb;this.IUa=Wb;this.rj=nc;this.P1=Qc;this.xh=Hd;this.mT=xd;this.$M=Id;this.htb=null;this.DUe=
0;this.Rmd=!1;this.xrd=0;this.AQb=this.v8c=this.$Ng=this.nvc=this.tyb=!1;this.updateViewportInfo=()=>{this.mT.Adg()&&this.xh.updateViewportInfo(this.Rmd,this.tWf)};this.Ilb=()=>{this.xh.Dla.soa()&&(this.z3c(this.xh.Dla.wc),this.xh.Dla.Xgc(this.Ilb))};this.tWf=()=>{this.Q7a();this.mT.sWf()};this.lgg=()=>{!this.tyb&&this.mT.Tcg()&&(this.xrd=this.HWe.scrollTop,this.tyb=!0,this.IUa.VGa(2))};this.B3f=(Ve,mf)=>{this.tyb&&(Ve=this.HWe.scrollTop,Ve-this.xrd?(this.nvc||mf.zoe||this.updatePosition(),this.nvc||
1!==mf.zoe||this.Q7a(),this.M_e(Ve),this.mT.nVf()):this.nvc=this.tyb=!1)};this.HWe=this.xh.zda;this.fia=Le.a.K8d;this.at=this.xh.at;this.xh.RGh()}get qYd(){return this.mT.WFf()}get fia(){return this.xh.fia}set fia(ka){this.xh.fia=ka}get iuh(){return"1"===this.at.sF.style.opacity}Inj(ka){this.v8c||(this.v8c=!0,this.xh.h1i(),this.htb=ka(this.at.WEa,this.xh.x$i,()=>{this.updatePosition()}),this.xh.OIi(this.htb),this.mT.initialize(this.htb,this),this.xh.initialize(this.htb,this.mT.Klb),this.xh.W7i(),
this.xh.Cnj(),this.xh.Dnj(),this.xh.Hnj(this.mT.X2e,this.mT.J7d,this.mT.I7d),this.n4f())}v7c(){}zhe(){return this.xh.Boj()}setInitialActiveContainerId(ka,Va,vb=null){this.xh.setInitialActiveContainerId(ka,0,vb)}updatePosition(){if(!this.AQb&&this.qYd&&this.Zh.Y8b()){var ka=G.a.$e()-this.DUe<Le.a.dGj;ka||this.Rmd||this.Q7a(ka)}}b2e(){this.Q7a()}MSa(ka,Va,vb){this.$M.sKc&&this.P1.s9("OnFloatingCommentsVisibilityChange",!0);this.xh.MSa(ka,Va,vb)}deleteContainer(ka,Va,vb=!1){this.xh.deleteContainer(ka,
Va,()=>{this.Zh.Xwf()||this.xh.dVd();this.mT.sTf()},vb)}addContainer(ka,Va,vb){this.xh.addContainer(ka,Va,vb,this.xh.mf,this.mT.COc,this.mT.cSf)}O_i(ka){this.AQb=!0;ka();this.AQb=!1}r4c(ka,Va,vb){this.xh.r4c(ka,Va,vb)}t2b(){this.xh.t2b()}zGj(){const ka="1"===this.at.sF.style.opacity;switch(!0){case ka&&!this.Zh.Xwf():this.xh.dVd();break;case !ka&&this.Zh.Xwf():this.xh.SOb()}}zjg(ka=!0){this.mT.vdg&&this.xh.Tyj(ka)}static j7h(ka,Va=null){const vb=new eb.a;for(const Wb of ka)Wb.Df||Wb.Tq!==Qd.a.beingCreated&&
(!Va||Va(Wb))&&Af.wqk(vb,Wb.objectId,Wb);return vb}static wqk(ka,Va,vb){let Wb;({value:Wb}=ka.Dc(Va,Wb)).returnValue||(Wb=[],ka.Z(Va,Wb));Wb.push(vb)}z3c(ka){ka&&(ka.Hla(()=>{this.updateViewportInfo()}),this.xrd=this.HWe.scrollTop,ka.oqh(this.lgg),ka.pqh(this.B3f))}n4f(){this.xh.mf?this.z3c(this.xh.mf):this.xh.Dla?this.xh.Dla.k0b(this.Ilb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}M_e(ka){this.at.sF.style.top=ka-this.xrd+"px";this.nvc=!1}Q7a(ka=
!1){ka=new pa.a(0,1,0,()=>{this.sff()},129,void 0,!ka);this.Hb.Vb(ka);this.Rmd=!0;this.nvc=this.tyb;this.IUa.VGa(10)}Isf(ka){return this.xh.o_a({contentAnchorPositions:ka.contentAnchorPositions})}sff(){this.Rmd=!1;if(this.at.WEa&&this.htb&&this.Zh.Y8b()){this.xh.sKd();var ka=0;this.ri.ie(()=>{ka=this.xh.GOd()},"FCM:UP:GET");var Va=null,vb=null;this.ri.ie(()=>{const Wb=this.mT.L5h(ka,this.xh.mf);Va=Wb.P0k;vb=this.Isf(Wb)},"FCM:UP:GP");this.ri.ie(()=>{this.tyb?(this.xh.KUh(vb),this.tyb=!1):this.htb.emitEvent(3,
vb);this.P1.Sbe()},"FCM:UP:RC");this.htb.setFirstCommentRenderDone();"0"===this.at.sF.style.opacity&&0<Va.count&&!this.rj.Zm&&this.rj.c8c&&this.ri.ie(()=>{this.xh.SOb()},"FCM:UP:SFC");!this.$Ng&&0<Va.count&&(tg.a.Z2(this.Hb,this.xh.pJi,sg.a.oJi),this.$Ng=!0);this.DUe=G.a.$e();this.IUa.VGa(6)}else this.DUe=G.a.$e()}}Object(e.a)(Af,"FloatingCommentManager",null,[29,613]);var dc=c(112),of=c(1459),Mj;(function(ka){ka[ka.rkp=0]="singleHint";ka[ka.Xgp=1]="multiHint";ka[ka.fjp=2]="resolvedHint";ka[ka.Ygp=
3]="multiResolvedHint";ka[ka.entryPoint=4]="entryPoint";ka[ka.unknown=void 0]="unknown"})(Mj||(Mj={}));Object(e.b)("CommentIconType",Mj);var bi=c(127),rl=c(1100);const jj={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[Mj.unknown]:""},be={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter","OfficeIconColors_mCommentMultiHintIconBorder"],
[2]:["OfficeIconColors_mCommentResolvedHintIconCenter","OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter","OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[Mj.unknown]:[]},fh=(ka,Va)=>{switch(ka){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(Va){case 3:return rl.a.QFh;
case 2:return rl.a.RFh;case 1:return rl.a.SFh}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(Va){case 3:return rl.a.NFh;case 2:return rl.a.OFh;case 1:return rl.a.PFh}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(Va){case 3:return rl.a.TFh;case 2:return rl.a.UFh;
case 1:return rl.a.VFh}}},zg=(ka,Va)=>{bi.a("renderIcon")&&appChrome.api.renderIcon(ka,Va)};class em{}em.sni=16;em.urm=1;em.lzf=20;em.SKj=2;Object(e.a)(em,"CommentIconConstants",null,[]);class fo{constructor(){this.vEd=0;this.mEc=!1}}Object(e.a)(fo,"CommentHintCensus",null,[]);class Da{constructor(ka,Va,vb,Wb,nc){this.YOg=ka;this.E_b=vb;this.a0j=Wb;this.xfa=nc;this.FMa=-1;this.Ave=new Set(Va)}get y(){if(-1!==this.FMa)return this.FMa;const ka=Sys.UI.DomElement.getBounds(this.YOg),Va=this.YOg.getClientRects();
return this.FMa=0<Va.length&&Va[0]?this.a0j?ka.y/this.E_b+em.SKj:Math.floor(Va[0].height)/(2*this.E_b)+ka.y/this.E_b-em.sni/2:0}get BEd(){return Array.from(this.Ave)}uuk(ka){this.Ave=new Set([...this.Ave,...ka])}}Object(e.a)(Da,"HintInfo",null,[637]);class jb extends of.a{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd,Id,Ve,mf,fg,Dg,Zf){super();this.ih=ka;this.hg=Va;this.rk=vb;this.pE=Wb;this.ga=nc;this.Zh=Ve;this.ura=mf;this.IUa=fg;this.rj=Dg;this.AYj=Zf;this.wfd=new Map;this.Ltb=this.fxb=null;this.vlc={iIa:-1,
RQf:-1}}Dob(ka){let Va=!1;V.App.jKj&&ka.oc.Vi?R.a.instance.ie(()=>{Va=Hh.m(ka,!0)},"CHA:SCIVE"):R.a.instance.ie(()=>{Va=Hh.l(ka.htmlElement,!0)},"CHA:SCI");return Va}cfb(ka){const Va=this.zoom,vb=ka.I4,Wb=ka.kwa;let nc=0;for(let xd=0;xd<ka.Jba.length;xd++)if(0<ka.Jba[xd].width){nc=xd;break}const Qc=ka.geb(1,em.lzf,Va,nc);this.IUa.VGa(1);let Hd=[];Wb.forEach((xd,Id)=>{const Ve=ka.Jba[Id].y/Va;xd=this.g$k(this.JXl(xd,Id),mf=>this.U9k(vb,mf,mf.y-Ve,Qc),()=>jb.Wal(vb));Hd=Hd.concat(xd)});return Hd}g$k(ka,
Va,vb){vb=vb();const Wb=[];for(const nc of ka){ka=Va(nc);for(const Hd of nc.BEd)this.wfd.set(Hd.toString(),ka);const Qc=this.Obi(nc.BEd);this.TEj(Qc,ka);null==vb.xfa&&(vb.xfa=nc.xfa);vb.appendChild(ka);Wb.push(ka)}this.r9b(this.Ltb);this.vib(this.fxb);return[vb]}Hpl(ka,Va){ka=null===ka||void 0===ka?void 0:ka.querySelectorAll("."+jb.BYi);return 0<(null===ka||void 0===ka?void 0:ka.length)&&ka[0]&&(ka=Array.from(ka[0].querySelectorAll(jb.e0k)))?this.s$n(ka,Va):!1}s$n(ka,Va){let vb=0,Wb=ka.length-1,nc;
for(;Wb>=vb;){nc=Math.floor((Wb-vb)/2+vb);const Qc=ka[nc];if(Qc.offsetTop>=Va-2&&Qc.offsetTop<=Va+2)return!0;Qc.offsetTop>Va+2?Wb=nc-1:vb=nc+1}return!1}Obi(ka){var Va,vb;let Wb=0,nc=0;for(const Qc of ka)if(this.Zh.XEf(Qc)){if(this.ih.contentFilterApiEnabled&&this.rj.Zm&&(ka=this.Zh.w_(Qc.toString()),null===(vb=(Va=this.AYj).isContentInFilteredContent)||void 0===vb||!vb.call(Va,ka.id)))continue;this.Zh.uui(Qc)?nc+=1:Wb+=1}Va=new fo;Va.vEd=Wb+nc;Va.mEc=0===Wb;return Va}imc(ka){if(ka=this.wfd.get(ka.objectId)){var Va=
Hh.g(ka);Va=this.Obi(Va);this.TEj(Va,ka)}}TEj(ka,Va){let vb,Wb;if(this.ih.contentFilterApiEnabled&&0===ka.vEd)Va.style.display="none";else if(1===ka.vEd?(vb=ka.mEc?2:0,Wb=ka.mEc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):1<=ka.vEd&&(vb=ka.mEc?3:1,Wb=ka.mEc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),Va.style.display=
"block",ka=Va.firstElementChild)this.$go(ka,vb),ka.title=Wb+". "+ka.title,zg(jj[vb],ka)}$go(ka,Va){ka.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;dc.a.ql(ka,jb.WFh,Va)}JXl(ka,Va){ka=this.V9k(ka,Va);ka.sort((vb,Wb)=>vb.y-Wb.y);return this.Ian(ka)}V9k(ka,Va){const vb=[],Wb=this.ih.Uq,nc=this.zoom;ka=Hh.f(ka,!0);for(let Qc=0,Hd=ka.length;Qc<Hd;Qc++){const xd=ka[Qc],Id=Hh.g(xd);Id&&vb.push(new Da(xd,Id,nc,Wb,Va))}return vb}Ian(ka){let Va=null;const vb=[];for(let Wb=0;Wb<
ka.length;Wb++)Va&&Math.abs(ka[Wb].y-Va.y)<em.sni+em.urm?Va.uuk(ka[Wb].BEd):(Va=ka[Wb],vb.push(Va));return vb}U9k(ka,Va,vb,Wb){const nc=ka.eh.ownerDocument,Qc=nc.createElement("div");Qc.className=jb.LFh;Qc.style.top=vb+"px";Qc.style.left=Wb+"px";Qc.style.right="auto";Qc.style.zIndex="40";dc.a.ql(Qc,pf.a.KGc,Va.BEd);Va=nc.createElement("span");this.mmg(Va,Qc);zg(jj[0],Va);this.wF(Va,ka);return Qc}mmg(ka,Va){ka.title=CommonUIStrings.l_CommentHintTooltip;ka.setAttribute("role","button");Va.appendChild(ka)}wF(ka,
Va){this.hg.dE(Ee.a.click,ka,this.Umn.bind(this),Va);this.hg.lb(Ee.a.mB,ka,this.Xmn.bind(this));this.rk.lb(Ee.a.o0,ka,this.Zmn.bind(this));this.rk.lb(Ee.a.eL,ka,this.Ymn.bind(this));this.pE.lb(ka,this.Wmn.bind(this))}static Wal(ka){ka=ka.eh.ownerDocument.createElement("div");ka.className=jb.BYi;return ka}Wmn(){return!0}Xmn(){return!0}Umn(ka){const Va=Hh.g(ka.Mw.parentNode);ka.eventName===Ee.a.NJ&&(this.ura.Y6e(),this.MDh());this.ga.Qb(tf.a.MFh,2,Va);return!0}Zmn(ka){this.lEa(this.Ltb)!==ka.Mw&&(ka=
Hh.g(ka.Mw.parentNode),this.ga.Qb(tf.a.k8e,2,ka));return!0}Ymn(){this.ga.processAction(tf.a.GEd,2);return!0}r9b(ka){this.MDh();this.Ltb=ka;this.mDk()}mDk(){this.nDk(this.lEa(this.Ltb),this.lEa(this.fxb))}vib(ka){this.UWk();this.fxb=ka;if(ka=this.lEa(this.fxb)){const Va=this.zPd(ka);this.kge(ka,Va,1)}}lEa(ka){if(!ka)return null;let Va=null;if(ka=this.Zh.w_(ka))if(ka=ka.Df?this.Zh.KD(ka.Df):ka)Va=ka.objectId;return Va&&this.wfd.has(Va)?this.wfd.get(Va).firstChild:null}MDh(){this.WWk(this.lEa(this.Ltb),
this.lEa(this.fxb))}WWk(ka,Va){if(ka){const vb=this.zPd(ka);this.kge(ka,vb,ka===Va?1:3);this.Ltb=null}}nDk(ka,Va){ka&&(ka.title=0<this.vlc.RQf&&1<this.vlc.iIa?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.vlc.RQf,this.vlc.iIa):CommonUIStrings.l_CommentHintTooltip,Va!==ka&&(Va=this.zPd(ka),this.kge(ka,Va,2)))}UWk(){const ka=this.lEa(this.Ltb),Va=this.lEa(this.fxb);if(Va){const vb=this.zPd(Va);this.kge(Va,vb,ka===Va?2:3);this.fxb=null}}kge(ka,Va,vb){this.VJm()?
this.Rgo(ka,vb):this.Oio(ka,Va,vb)}Rgo(ka,Va){ka=null===ka||void 0===ka?void 0:ka.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===ka||void 0===ka?void 0:ka.length)&&(ka[0].style.fill=2===Va||1===Va?"Highlight":"ButtonText")}Oio(ka,Va,vb){Va=be[Va];for(let nc=0;nc<Va.length;nc++){var Wb=Va[nc];const Qc=fh(Wb,vb);if(!this.EGm(Qc)){a.ULS.sendTraceTag(512262488,327,15,`The following CSS variable is undefined: ${Qc}.`);break}Wb=null===ka||void 0===ka?void 0:ka.querySelectorAll("."+Wb);0<(null===
Wb||void 0===Wb?void 0:Wb.length)&&(Wb[0].style.fill=`var(${Qc})`)}}VJm(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}zPd(ka){return dc.a.Db(ka,jb.WFh)}EGm(ka){var Va;const vb=document.getElementById(Rj.AppFrame.MJc);return!(null===(Va=null===vb||void 0===vb?void 0:vb.style)||void 0===Va||!Va.getPropertyValue(ka))}}jb.LFh="clip16x16 HintContainer";jb.e0k=".clip16x16.HintContainer";jb.BYi="OutlineElementHintMargin";jb.WFh="CommentIconType";Object(e.a)(jb,
"CommentHintActor",of.a,[628]);var ic=c(1004);class Lc extends ic.a{get vdg(){return this.I_()}get vff(){return this.I4o.Rfi()}constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd,Id,Ve){super();this.ai=ka;this.hs=Va;this.Dj=vb;this.taskManager=Wb;this.vyd=nc;this.BK=Qc;this.xh=Hd;this.getSelectedText=xd;this.I4o=Id;this.xg=Ve;this.e_c=()=>{};this.C6d=()=>{};this.tLg=!1;this.hTk={[0]:()=>this.IPh(),[1]:()=>this.Njc.b2e(),[2]:()=>this.IPh()};this.sWf=()=>{this.vyd.VGa(11)};this.X2e=mf=>{if(this.hs.yzb)for(const fg of Hh.t)mf.bindAction(pd.KeyInputManager.AG(fg),
Sg.a.K4e)};this.J7d=()=>{this.C6d()};this.I7d=(mf,fg)=>{if(mf.name!==ug.AFrame.Gr&&fg){var Dg=this.Dj.$s?this.Dj.$s.id:"";this.ai.aKb||(this.ai.aKb=tg.a.Z2(this.taskManager,()=>{this.e_c(Dg)}))}};this.FWi=()=>{};this.Klb=()=>{this.wqj()};this.cSf=(mf,fg)=>{0===fg&&(this.BK.Sbe(),this.vyd.VGa(0))};this.sTf=()=>{this.vyd.VGa(5)};this.COc=mf=>{let fg=0;const Dg=this.Dj.xO();for(let Zf=0;Zf<Dg.length;Zf++){if(Dg[Zf].Df||Dg[Zf].done)continue;if((Dg[Zf].Tq===Qd.a.beingCreated?Dg[Zf].gz.draftId:Dg[Zf].id)===
mf.contentId)break;const Ci=this.Bx.getContentAnchorPosition(Dg[Zf].id);!Ci||4<Math.abs(mf.anchorTop-Ci.anchorTop)||fg++}return fg};this.ORi=()=>{this.BK.Sbe()};this.nVf=()=>{this.vyd.VGa(2)};this.wqj=()=>{if(!this.tLg&&this.xh.zda){const mf=this.xh.zda.getElementsByClassName(jb.LFh);for(let fg=0;fg<mf.length;fg++)mf[fg].style.opacity="1";this.tLg=!0}}}initialize(ka,Va){this.Bx=ka;this.Njc=Va;this.y3c();this.hs.sKc&&this.IUn()}qgo(ka,Va){this.C6d=ka;this.e_c=Va}X5h(ka,Va){return{bZa:this.RPl(ka,Va),
containerContentByType:{}}}L5h(ka,Va){const vb=Af.j7h(this.Dj.xO(),this.Dj.$ga),Wb=[],nc=Hh.e(!0);var Qc=this.Dj.xO();Va=this.zGn(Va,Qc,vb);!Va.u_f&&Va.contentAnchorPosition&&(Wb.push(Va.contentAnchorPosition),Va.contentAnchorPosition=null);for(Qc=0;Qc<nc.length;Qc++){const Hd=nc[Qc],xd=Hh.g(Hd);if(xd)for(let Id=0;Id<xd.length;Id++){const Ve=this.getContentAnchorPosition(ka,vb,Hd,xd[Id]);Ve&&(Wb.push(Ve),Va.u_f&&Va.contentAnchorPosition&&Ve.contentId===Va.u_f.id&&(Wb.push(Va.contentAnchorPosition),
Va.contentAnchorPosition=null))}}Va.contentAnchorPosition&&Wb.splice(0,0,Va.contentAnchorPosition);return{P0k:vb,contentAnchorPositions:Wb}}WFf(){var ka;return!(null===(ka=this.Bx)||void 0===ka||!ka.getAreContainersEnabled())}I_(){return this.Dj.Y8b()}Tcg(){return this.I_()}V7c(){return this.I_()}Adg(){return this.Bx&&this.xh.zda&&this.I_()}xIo(){this.BK.s9("OnFloatingCommentsVisibilityChange",this.ai.c8c);this.ai.c8c?this.xh.SOb():this.xh.dVd()}uWi(ka){0!==ka&&this.e_c(this.Dj.$s?this.Dj.$s.id:"")}getContentAnchorPosition(ka,
Va,vb,Wb){let nc=null;return({value:nc}=Va.Dc(Wb.toString(),nc)).returnValue?(Va=nc[0])&&!Va.Df?{...(new ye.a),anchorTop:(Le.a.LNc(vb)-ka)/this.xh.Waa,anchorLeft:0,containerContentType:0,contentId:Va.id}:null:null}zGn(ka,Va,vb){var Wb,nc;const Qc={};"CREATE"===(null===(nc=null===(Wb=this.Dj.ny)||void 0===Wb?void 0:Wb.gz)||void 0===nc?void 0:nc.sessionType)&&(Wb=this.xh.zda.querySelectorAll(Hh.b),ka=this.xh.t3h((0<Wb.length?Wb[0]:null)||this.getSelectedText(),this.Dj.ny.gz.draftId,0,ka),Qc.u_f=this.a6l(Va,
vb),Qc.contentAnchorPosition=ka);return Qc}a6l(ka,Va){var vb=Array.indexOf(ka,this.Dj.ny);for(--vb;-1<vb;vb--)if(Va.nb(ka[vb].objectId))return ka[vb]}RPl(ka,Va){return this.L5h(ka,Va).contentAnchorPositions}y3c(){this.BK.u9("OnAfterTrackChangeMarkupViewChange",(ka,Va)=>{if(Va)this.hTk[Va.Ej]()})}IUn(){this.BK.u9("OnFloatingCommentsToggle",this.xIo.bind(this))}IPh(){const ka=Hh.i();if(0!==ka.length){var Va=Af.j7h(this.Dj.xO()),vb=this.Dj.KK;for(let Wb=0;Wb<ka.length;Wb++){const nc=Hh.g(ka[Wb]);for(let Qc=
0;Qc<nc.length;Qc++){let Hd;({value:Hd}=Va.Dc(nc[Qc].toString(),Hd)).returnValue&&(Hd.forEach(xd=>{var Id;xd&&!xd.Df&&(this.Njc.deleteContainer(xd.id,0,!1),(null===(Id=vb.KA)||void 0===Id?void 0:Id.id)===xd.id&&vb.clearSelection())}),this.xg.mg(ug.AFrame.Pn))}}}}}Object(e.a)(Lc,"CommentFloatingContainerActor",ic.a,[631]);var ad=c(1461),ce=c(2004),fc=c(194);class kf extends ad.a{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd,Id){super();this.M9j=ka;this.w9a=Va;this.Bve=vb;this.ri=nc;this.k$=xd;this.P1=Id;this.$i=
null;this.Ej=1;Wb.execute(Ve=>{this.$i=Ve});this.o2=[];this.Zpc=new fc.ScriptSharpLegacyMap;this.xSn(Qc,Hd);this.y3c()}get uj(){return this.M9j.value}get commentEditor(){return this.w9a}get Cba(){return!!this.$i}get wib(){return 0}get V1a(){return this.o2}get aYg(){return this.Zpc.nb(this.Ej)?this.Zpc.J(this.Ej):this.Zpc.J(0)}wQa(ka){return this.k$.wQa(ka)}m1a(ka,Va){if(ka=Object(yb.a)(627,ka))for(const vb of this.OGn(ka))Va.add(vb)}uGa(ka,Va){this.Cba&&this.ri.ie(()=>{this.Apn(ka,Va)},"CHA:OPHC")}Apn(ka,
Va){if(this.$i.lp.Y8b()){var vb=this.Au.kDa,Wb=new Ca.a(new Ue.a),nc=Va.OGa("*"),Qc=this.tPl(vb),Hd=!!vb&&!vb.action||!!Qc&&Qc===this.$i.KA,xd;this.ri.ie(()=>{this.Bve.c4l(ka.id,Wb,null===Qc||void 0===Qc?void 0:Qc.objectId)},"OPHC:GOI");this.ri.ie(()=>{xd=this.aYg.Yxh(nc,Qc,Wb,Hd);xd.tui=this.rui(vb)&&0===vb.action},"OPHC:BHI");this.ri.ie(()=>{this.aYg.pth(nc,xd,Hd)},"OPHC:AH")}}tPl(ka){let Va=null;!this.rui(ka)||0!==ka.action&&2!==ka.action||(Va=this.Au.kDa.sA);return Va||this.$i.KA}OGn(ka){if(!ka)return[];
ka=this.uj.Db(ja.a.If(ka.objectId));return this.commentEditor.UQd(ka,null)}V8i(){return!1}BF(ka,Va,vb){this.Cba&&(ka=Object.assign(new ce.a,{action:ka,type:0,sA:Va,BJ:vb}),this.Au.BF(ka))}Y6e(){this.Cba&&(this.BF(3,this.$i.x9b,this.$i.x9b),this.$i.x9b=null)}xSn(ka,Va){this.Zpc.add(1,ka);this.Zpc.add(0,Va)}y3c(){this.P1.u9("OnBeforeTrackChangeMarkupViewChange",(ka,Va)=>{Va&&Va.BQf!==this.Ej&&(this.Ej=Va.BQf)})}rui(ka){return ka&&0===ka.type}}Object(e.a)(kf,"CommentHighlightActor",ad.a,[630,550]);var Tc=
c(1023),Mg=c(361),yf=c(497),ng=c(1495);class ji{constructor(ka,Va){this.B0k=ka;this.WRf=Va}}Object(e.a)(ji,"CommentEndParaIdBeforeChangeInfo",null,[]);var kj=c(1596);class fl{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd){this.TIf=ka;this.ai=Va;this.Dj=vb;this.BK=Wb;this.Mo=nc;this.Jk=Qc;this.Y_k=Hd;this.hs=xd;this.Irb=null;this.AGn=(Id,Ve)=>{(Id=Ve.commentNode)&&!Hh.s(Id)&&(Ve=this.Dj.dof(Id),ja.a.Zp(Ve.X8c,Ve.vKc)||this.sEj(Ve,Id)||this.yCh(Ve.SCa,Ve.xNa,Id)||this.xmg(Id))};this.hjn=(Id,Ve)=>{Ve.property===
ma.a.dva&&(Id=Hh.h(Ve.node,ja.a.nil),this.Irb=new ji(Ve.node.id,Id))};this.tkn=(Id,Ve)=>{Id=Ve.node;if(Ve.property===ma.a.dva&&Id){var mf=Hh.k(Id,ja.a.nil);Ve=Hh.h(Id,ja.a.nil);var fg=this.Irb?this.od.Db(this.Irb.WRf):null;!Hh.s(Id)&&mf&&!mf.equals(Ve)&&this.Irb&&Id.id.equals(this.Irb.B0k)&&!mf.equals(this.Irb.WRf)&&fg&&fg.isConnected&&this.VYe(this.Irb.WRf,Id.id);Ve&&this.ai.Nx.nb(Ve)&&(mf=this.ai.Nx.J(Ve),mf.N1a&&(a.ULS.shipAssertTag(572835481,327,!!mf.JM,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),
mf.JM&&mf.JM.contains(Id.id)&&(mf.JM.remove(Id.id),mf.JM.count||(mf.N1a=!1),this.ai.FU.nb(Id.id)?this.ai.FU.J(Id.id).remove(Ve):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.C_c=(Id,Ve)=>{Id=Ve.node.id;this.ai.Nx.nb(Id)&&this.FYn(Id)};this.Tin=(Id,Ve)=>{Ve&&Ve.node&&this.YUa.nb(Ve.node)&&(Id=this.YUa.J(Ve.node).J8d,this.YUa.nb(Id)||(Id=this.YUa.J(Ve.node),this.yCh(Id.Ubf?Id.currentNode:Id.J8d,Id.Ubf?Id.J8d:Id.currentNode,Id.commentNode)||
this.xmg(Id.commentNode)),this.YUa.remove(Ve.node))};this.wkn=(Id,Ve)=>{const mf=Id.Wj;if(!Ve&&this.Obb.nb(mf)){var fg;(fg=this.Obb).Z(mf,fg.J(mf)&(Id.Nc?-2:-3));this.Obb.J(mf)||(this.xmg(this.od.Db(mf)),this.Obb.remove(mf))}};this.YUa=new yf.a(new Tc.a);this.Obb=new pc.a(Hh.c);this.BK.u9("OnCommentNodeAdded",this.AGn);this.hs.contentFilterApiEnabled?(this.BK.u9("OnCommentPaneOpen",this.tCm.bind(this)),this.BK.u9("OnCommentPaneClose",this.sCm.bind(this)),this.BK.u9("OnContentFilterUpdate",this.t_c.bind(this))):
["OnCommentPaneOpen","OnCommentPaneClose"].forEach(Id=>{this.BK.u9(Id,this.qCm.bind(this))});this.hs.sKc&&this.BK.u9("OnFloatingCommentsVisibilityChange",this.rCm.bind(this));ka=this.Mo.Ze(12);ka.Kw(this.C_c);ka.Ot(this.Tin);this.Mo.Ze(40).ADc(this.hjn);this.Mo.Ze(40).Fo(this.tkn);Mg.a.kSa(this.wkn)}get ax(){return this.TIf.value}get od(){return this.ax.od}c4l(ka,Va,vb){if(this.Wxn(ka))for(const Wb of this.ai.Nx.J(ka).JM)!this.xoj(Wb,vb===Wb.toString())||Va.add(Wb)}xoj(ka,Va){const vb=this.od.Db(ka),
Wb=Hh.s(vb);if(!vb||Wb)return!1;ka=this.Dj.w_(ka.toString());return!ka||this.hs.contentFilterApiEnabled&&this.ai.Zm&&!this.Y_k.isContentInFilteredContent(ka.id)||!this.ai.Zm&&!this.Dj.$ga(ka)&&!Va?!1:!0}Wxn(ka){return this.Dxn(ka)}xmg(ka){if(ka){var Va=ng.a.UQd(ka,null),vb=new Pa.a;for(let Wb=1;Wb<Va.length-1;Wb++)this.VYe(Va[Wb].id,ka.id),vb.add(Va[Wb]);sj.b(vb)}}rCm(){const ka=new Pa.a;for(const Va of this.Dj.xO())!Va.Df&&Va.Tq!==Qd.a.beingCreated&&this.Dj.$ga(Va)&&this.Dj.Ane(Va,ka);sj.b(ka)}Dxn(ka){if(!this.ai.dY)return!1;
let Va=null;if(({value:Va}=this.ai.Nx.Dc(ka,Va)).returnValue)return Va.N1a;let vb=!1;this.Jk.ie(()=>{const Wb=Hh.e();for(let nc=0;nc<Wb.length;nc++)vb=this.bVo(Wb[nc],ka,vb);vb||(this.ai.Nx.add(ka,new kj.a),this.ai.Nx.J(ka).N1a=!1)},"CHORA:PHOC");return vb}bVo(ka,Va,vb){ka=Hh.g(ka);if(!ka)return vb;for(let Wb=0;Wb<ka.length;Wb++){const nc=this.od.Db(ka[Wb]);nc&&!Hh.s(nc)&&(vb=vb||this.HTk(nc,Va))}return vb}HTk(ka,Va){var vb=this.Dj.dof(ka);if(this.sEj(vb,ka))return!1;var Wb=vb.X8c;const nc=vb.vKc;
vb=vb.SCa;if(Wb!==ja.a.nil&&(Wb.equals(nc)||Wb.equals(Va)))return!1;for(Wb=$a.ParagraphReader.ig(vb,!1);Wb&&!Wb.id.equals(nc);){if(Wb.id.equals(Va))return this.VYe(Va,ka.id),!0;Wb=$a.ParagraphReader.ig(Wb,!1)}return!1}VYe(ka,Va){this.ai.FU.nb(Va)||this.ai.FU.add(Va,new Ca.a(new Ue.a));this.ai.FU.J(Va).add(ka);this.ai.Nx.nb(ka)?this.ai.Nx.J(ka).JM||(this.ai.Nx.J(ka).JM=new Ca.a(new Ue.a)):this.ai.Nx.add(ka,new kj.a(!0));this.ai.Nx.J(ka).N1a=!0;this.ai.Nx.J(ka).JM.add(Va)}FYn(ka){if(this.ai.Nx.J(ka).JM)for(const Va of this.ai.Nx.J(ka).JM)this.ai.FU.nb(Va)?
this.ai.FU.J(Va).remove(ka):a.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.ai.Nx.remove(ka)}qCm(){const ka=new Pa.a;for(const Va of this.Dj.xO())Va.Df||Va.Tq===Qd.a.beingCreated||this.Dj.$ga(Va)||this.Dj.Ane(Va,ka);sj.b(ka)}tCm(){this.XAf("OnCommentPaneOpen")}t_c(){this.XAf("OnContentFilterUpdate")}sCm(){this.XAf("OnCommentPaneClose")}XAf(ka){const Va=new Pa.a;for(const vb of this.Dj.xO())vb.Df||vb.Tq===Qd.a.beingCreated||this.Dj.KK.oAh(ka,vb)||
this.Dj.Ane(vb,Va);sj.b(Va)}sEj(ka,Va){let vb=!1;if(!ka.uje||!ka.VJd){vb=!0;if(!ka.SCa||!ka.xNa)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!ka.SCa,!ka.xNa),!0;ka.uje||this.YUa.nb(ka.SCa)||this.YUa.add(ka.SCa,{commentNode:Va,currentNode:ka.SCa,J8d:ka.xNa,Ubf:!0});ka.VJd||this.YUa.nb(ka.xNa)||this.YUa.add(ka.xNa,{commentNode:Va,currentNode:ka.xNa,J8d:ka.SCa,Ubf:!1})}return vb}yCh(ka,Va,vb){ka=ng.a.xva(ka,vb.id,!0);Va=ng.a.xva(Va,vb.id,!1);let Wb;ka||({value:Wb}=
this.Obb.Dc(vb.id,Wb),this.Obb.Z(vb.id,Wb&1));Va||({value:Wb}=this.Obb.Dc(vb.id,Wb),this.Obb.Z(vb.id,Wb&2));return!ka||!Va}}Object(e.a)(fl,"CommentHighlightOnRestActor",null,[629]);var dj=c(536),yk=c(414),kn=c(627);class Ei{constructor(ka,Va){this.syb=ka;this.jka=Va}getViewContainer(){return this.syb}registerForViewContainerEvents(ka){this.jka.gWn(ka)}unregisterForViewContainerEvents(ka){this.jka.VPo(ka)}}Object(e.a)(Ei,"ViewContainerProvider",null,[849]);class al{constructor(ka,Va,vb,Wb){this.isRightToLeft=
!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ka;this.appLocale=Va;this.uiCulture=vb;this.dataCulture=Wb}}Object(e.a)(al,"LocalizationDetails",null,[]);var ph=c(1134),qf=c(1507);class lj{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd,Id,Ve,mf,fg,Dg,Zf,Ci,og,cl,ik,uj,ti,Yo,wh,cn,Tm,nl,Um,ak,Vl,sk,po,Hp){this.Sq=ka;this.Dj=Va;this.L2b=vb;this.g_=Wb;this.hs=nc;this.ai=Qc;this.rMd=Hd;this.s9b=xd;this.Dq=Id;this.pc=Ve;this.dynamicScriptLoader=mf;this.M6n=fg;this.xg=Dg;this.s8e=Zf;this.o8e=
Ci;this.smh=og;this.T_o=cl;this.V0=ik;this.BK=uj;this.s8n=ti;this.vxl=Yo;this.pRi=wh;this.U_o=cn;this.BAb=Tm;this.mT=nl;this.xh=Um;this.$M=ak;this.D9e=Vl;this.K4a=sk;this.HEd=po;this.g4k=Hp;this.gld=this.kXa=null;this.uZg=!1;this.zLe=[];this.hdh=this.vZg=!1;this.initialize=(Bm,jk)=>{this.ywm(jk)};this.Gfl=Bm=>Bd.a.a$e(Bm);this.xkn=()=>{this.rqi()};this.HVl=(Bm,jk,dp)=>{Bm={...(new ph.a),containerPanel:Bm,paneOpenedCallback:jk,paneClosedCallback:dp,ulsLogger:new dj.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,
isRtl:z.AFrameworkApplication.isRtl,viewportInfo:this.xh.Uof(),destroyAllContainersCallback:()=>{this.ai.Zm||a.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.hs.sMd,synchronousContainerPositioningEnabled:!1,trackChangeInSidetrackEnabled:this.hs.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!this.hs.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,
contentNavigationApiEnabled:this.hs.contentNavigationApiEnabled,contentFilterApiEnabled:this.hs.contentFilterApiEnabled,returnToDraftFixEnabled:!0}};this.hs.contentNavigationApiEnabled&&(Bm.sidetrackContentNavigationApi=this.D9e,Bm.featureGateApiSettings=this.mT.vff,Bm.telemetryDetails=this.pRi,this.hs.contentFilterApiEnabled&&(Bm.contentFilterAPI=this.g4k));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(Bm)};this.mmn=Bm=>{2!==this.Sq.mode&&3!==this.Sq.mode&&this.Dj.$s&&Bm===this.Dj.$s.id&&
this.Sq.clearSelection();V.App.ya.updateCommandUI(!0)};this.DSi=(Bm,jk)=>{this.vx("onCSCStart",window.performance.now());this.jdb&&!Bm&&(this.xun(),this.vx("openInFishbowl",!0));this.L2b.ndb&&this.hs.LBb&&this.pc.processAction(tf.a.newComment,2);jk&&jk();this.vx("onCSCEnd",window.performance.now())};this.BK.u9("OnCommentInit",this.initialize);this.BK.u9("OnCommentRenderedOnce",this.xkn);this.mT.qgo(()=>{},this.mmn)}get $Ja(){return this.Sq}get jdb(){return this.ai.jdb}vx(ka,Va){this.K4a.vx(Sl.a.comments,
ka,Va,!0)}ywm(ka){if(this.ai.dY)ka&&ka.hGa&&ka.hGa();else if(this.uZg)(null===ka||void 0===ka?0:ka.hGa)&&this.zLe.push(ka.hGa);else{var Va=this.hs.Z8b;this.vx("hasCommentOnBoot",Va);Va?this.BAb.logKpiUsage(qf.a.K2b,0):yk.a.Ydc("canvas","floatingComments");this.uZg=!0;this.vx("initInProgress",!0);this.Dj.initialize(this.Sq);this.L2b.initialize(this.Sq,null);this.L2b.Enj(this.Sq);this.s9b.sxm(this.g_.Wko);this.vx("InitAMSetup",window.performance.now());kn.a.Ap(this.vxl).continueWith(vb=>{(this.kXa=
vb.result)||a.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.s8e.initialize(this.kXa);this.$Ja.g8e.initialize(this.$Ja,this.Dj,this.kXa,this.s8e);this.smh.initialize(this.dynamicScriptLoader,this.$Ja.g8e,this.pRi,this.kXa,new Ei(this.T_o,this.U_o),this.Bai(),"",this.s8e.Rfi(),this.V0,V.App.qhe);this.vx("AMInitialized",window.performance.now());this.hs.contentNavigationApiEnabled?(V.App.XCb?V.App.XCb:this.xh.LFi()).then(()=>{this.vx("FCMLoaded",
window.performance.now());this.v7c();this.EWd(ka)}):this.EWd(ka)})}}xDn(){var ka;null===(ka=sharedComments.setDarkModeColorHandler)||void 0===ka?void 0:ka.call(sharedComments,this.Gfl)}EWd(ka){this.gld=this.smh.EWd(void 0,this.xDn.bind(this));this.lSc(ka);this.ai.dY=!0;this.hs.Xeg&&this.o8e.initialize()}lSc(ka){if(!this.ai.ZFb){this.vx("InitCSStart",window.performance.now());var Va=this.Dq.Zf("Task","InitiateCommentingSession");this.BAb.logKpiUsage(qf.a.XFh,0);try{const vb=this.Dq.Zf("Task","InitiateCommentingSession-UpdateModel");
this.HEd.Qwm();vb.stop();this.vx("initAtBoot",window.performance.now());this.hs.Uq&&this.Dj.Y8b()&&a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",G.a.$e()));kl.a.get_instance().XH(12);a.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.ai.ZFb=!0;this.gld.then(()=>{this.vx("SCLoaded",window.performance.now());this.xh.jxm();this.vx("FCMInitiated",window.performance.now());if(this.hs.Uq){let nc=!1;if(this.jdb){var Wb=
this.g_.iOd(this.jdb);Wb?(z.AFrameworkApplication.ue("3ge3g205;cha3g788"),Wb=this.g_.jOd(Wb,0),Wb)?this.Dj.$ga(Wb)||(nc=!0,this.yun(Wb)):(nc=!0,this.n4a()):nc=!0}Wb=ka?ka.uTi:null;this.hs.contentNavigationApiEnabled?this.DSi(nc,Wb):this.lZm(nc,Wb)}ka&&ka.hGa&&ka.hGa();for(const nc of this.zLe)nc();this.vZg&&this.rqi();this.zLe=[]})}catch(vb){a.ULS.fE(539567713,327,10,vb,`Comments Initialization Failed: ${vb}`),this.BAb.logKpiFailure(qf.a.XFh,"CommentsInitializationFailed",{isInternal:!0},{name:qf.a.J2b,
isInternal:!0})}finally{Va.stop(),this.vx("InitCSEnd",window.performance.now())}this.pc.processAction(tf.a.zFh,2)}}yun(ka){this.pc.processAction(tf.a.NY,2);this.mT.wqj();tg.a.Z2(z.AFrameworkApplication.nc,()=>{this.g_.selectComment(ka,{...(new Ik.a),GR:!0,C9:1});this.xg.mg(ug.AFrame.Gr);a.ULS.sendTraceTag(574734912,327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-z.AFrameworkApplication.QW)},sg.a.Z$n);this.BAb.Hv(tf.a.j8e);z.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordLinkToCommentSettings")}n4a(){this.pc.processAction(tf.a.n4a,
2)}lZm(ka,Va){(V.App.XCb?V.App.XCb:this.xh.LFi()).then(()=>{this.vx("FCMLoaded",window.performance.now());this.v7c();this.DSi(ka,Va)}).catch(vb=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+vb.toString())})}v7c(){this.$M.trackChangeInSidetrackEnabled?(this.rMd.v7c(),this.vx("STSet",window.performance.now())):this.rMd.Inj(this.HVl)}rqi(){this.hdh||(this.ai.dY&&this.gld?(this.gld.then(()=>{const ka=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();
this.s8n.execute(Va=>{ka.registerSafelinksNavigator(Va.Ulc.bind(Va))});this.M6n.execute(Va=>{Va.ASn(ka)})}),this.hdh=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.vZg=!0))}Bai(){return new al(z.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,z.AFrameworkApplication.uiCulture,z.AFrameworkApplication.dataCulture)}xun(){this.g_.Sgj(this.jdb,{...(new Ik.a),qdg:!1,CTc:!0});this.BAb.Hv(tf.a.j8e)}}Object(e.a)(lj,"CommentInitActor",
null,[]);class Ph{constructor(ka,Va,vb,Wb,nc){this.hg=ka;this.pE=Va;this.ga=vb;this.BYj=Wb;this.mj=nc;this.foe=this.NVa=null}get zoom(){let ka=1;this.mj&&this.mj.instance&&(ka=this.mj.instance.ij);return 0<ka?ka:1}Yyl(ka,Va){if(!this.foe||!ka.kwa||Va>=ka.kwa.length)return null;const vb=this.zoom,Wb=ka.I4,nc=ka.geb(1,em.lzf,vb,Va);return this.c9k(ka.kwa[Va],Wb,(this.foe.y-ka.Jba[Va].y)/vb+em.SKj,nc)}c9k(ka,Va,vb,Wb){if(this.NVa)return(Va=this.NVa.parentElement)&&Va.removeChild(this.NVa),this.wjj(ka,
this.NVa,vb,Wb),this.NVa;const nc=Va.eh.ownerDocument,Qc=nc.createElement("div");Qc.className=Ph.V_k;this.wjj(ka,Qc,vb,Wb);ka=nc.createElement("span");this.mmg(ka,Qc);zg(jj[4],ka);this.PTn(ka,Va);return this.NVa=Qc}mmg(ka,Va){ka.title=CommonUIStrings.l_CommentNewCommentButton;ka.setAttribute("role","button");Va.appendChild(ka)}PTn(ka,Va){this.hg.dE(Ee.a.click,ka,this.Uln.bind(this),Va);this.hg.lb(Ee.a.mB,ka,this.Wln.bind(this));this.pE.lb(ka,this.Vln.bind(this))}YUd(){if(this.NVa){const ka=this.NVa.parentElement;
ka&&ka.removeChild(this.NVa)}}wjj(ka,Va,vb,Wb){this.BYj.Hpl(ka,vb)?Va.style.left=Wb+em.lzf+"px":Va.style.left=Wb+"px";Va.style.top=vb+"px";Va.style.right="auto";Va.style.display="block";Va.style.position="absolute";Va.style.overflow="hidden";Va.style.cursor="default";Va.style.zIndex="40"}Wln(){return!0}Uln(ka){this.ga.zD=30;this.ga.processAction(tf.a.newComment,2);ka=ka.Mw;zg(jj[4],ka);ka=ka.parentElement;(null===ka||void 0===ka?0:ka.parentElement)&&ka.parentElement.removeChild(ka);return!0}Vln(){return!0}}
Ph.V_k="clip16x16 EntryPointContainer";Object(e.a)(Ph,"CommentMarginEntryPointActor",null,[]);var ze=c(417),Be=c(76),hf=c(223),pe=c(33),jm=c(116);class rk{constructor(ka,Va,vb,Wb,nc,Qc,Hd){this.TIf=ka;this.ZWm=Va;this.lp=vb;this.ai=Wb;this.hs=nc;this.m8e=Qc;this.BAb=Hd;this.t3i=new Set;this.NIb=new Set;this.f0c=new hf.a;this.M2b=new Map;this.bGh=K.a.instance.Ue("Box4.CommentParagraphMapping");this.CAb=new Set;this.tfa=this.hOd()}get ax(){return this.TIf.value}get od(){return this.ax.od}get VCa(){return this.ZWm.value}hOd(){const ka=
new cd.GraphIterator;ka.set(this.ax);this.VCa.j4a(ka);return ka}Qwm(){this.ai.ZFb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",pe.Debug.B0a());this.hs.contentNavigationApiEnabled||(this.hs.Z8b&&this.Owm(),this.lp.EUi())}Ajn(){this.Fdj();this.CAb.forEach(ka=>{this.Vug(ka)});this.CAb.clear();this.lp.EUi()}Vug(ka){if(ze.a.isEnabled){a.ULS.sendTraceTag(512235650,327,15,`Missing Start or End mapping info for Comment ${ka}`);
var Va=this.M2b.get(ka).bkc,vb=this.M2b.get(ka).s5b;Va===ja.a.nil||vb===ja.a.nil?a.ULS.sendTraceTag(512235652,327,15,`start ${Va} or end ${vb} has invalid value`):(this.bGh.value.SZa.set(ka,Va),this.bGh.value.RZa.set(ka,vb),a.ULS.sendTraceTag(512235651,327,50,`Start ${Va} and End ${vb} mapping info for Comment ${ka} added on Comment Model load`))}}vzm(ka){const Va=[];for(const vb of ka)ka=vb.Wj.toString(),this.XDj(ka,vb.paragraph.id,vb.Nc),vb.Nc&&(this.t3i.has(ka)?a.ULS.sendTraceTag(523334301,327,
50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",vb.Wj):(this.t3i.add(ka),(ka=this.yqk(vb))&&Va.push(ka)));return Va}XDj(ka,Va,vb){ze.a.isEnabled&&(this.M2b.has(ka)||this.M2b.set(ka,{bkc:ja.a.nil,s5b:ja.a.nil}),vb?this.M2b.get(ka).bkc=Va:this.M2b.get(ka).s5b=Va)}yqk(ka){var Va=this.od.Db(ka.Wj);this.tfa.Gi(Va);if(40!==this.tfa.We||!Va)return a.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",
!Va,!ka.Wj),this.tfa=39===this.tfa.We?this.tfa:this.hOd(),null;Va=this.lp.tGd(this.tfa);let vb;if(({index:vb}=this.lp.pme(Va)).returnValue)if(this.lp.rYe(Va,vb),this.NIb.add(Va.objectId),Hh.p(Va)||this.CAb.add(Va.objectId),Va.Df)this.wkf(Va);else return{contentId:Va.id,containerContentType:0,n9:{xd:ka.Ib.cp,IM:ka.paragraph.Cl}};else this.f0c.add(Va);return null}wkf(ka){if(ka.Df){var Va=this.lp.KD(ka.Df);if(Va&&Va.Df){const vb=this.lp.KD(Va.Df);vb&&(vb.Df?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):
(ka.Df=Va.Df,a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${ka.objectId} parentObjectId: ${Va.objectId}`)))}}}Owm(){const ka=new O.a(0),Va=Be.a.Vo(this.lp.UIa),vb=new Set;this.hs.Wvn&&!ze.a.isEnabled&&this.Gsk(Va,ka);const Wb=this.hOd(),nc=new Set,Qc=new Set,Hd=new Tk.GraphTransaction(2);try{if(Hd.hu(Wb),Wb.Nr(1)){for(;Va.moveNext();){if(!$a.ParagraphReader.uh(Va.iterator))continue;const Id=Va.iterator.currentNode,Ve=$a.ParagraphReader.EDb(Id);ze.a.isEnabled&&
this.b9m(Id,Ve,ka);vb.add(Id.id.toString());this.N2i(Ve,Qc,Wb,nc)}this.Fdj();const xd=this.uPl(vb);0<xd.length&&this.c6n(xd,vb,Wb,Qc);this.CAb.forEach(Id=>{this.Vug(Id)});this.CAb.clear()}}finally{Hd&&Hd.dispose()}0==this.NIb.size&&this.hs.Z8b&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");zc.a.W2m(nc,Qc,this.od)}N2i(ka,Va,vb,Wb){for(const nc of ka){ka=this.hs.Uq?!nc.Nc:nc.Nc;const Qc=nc.Wj.toString();this.XDj(Qc,nc.paragraph.id,nc.Nc);ka?Va.has(Qc)||
Wb.add(Qc):Va.has(Qc)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",nc.Wj):(Va.add(Qc),this.zqk(nc,vb))}}c6n(ka,Va,vb,Wb){const nc=this.m5l(ka);zc.a.GUk(nc);const Qc=new Set,Hd=new Set;nc.forEach(Id=>{Va.has(Id.id.toString())||Hd.has(Id.id.toString())||(Hd.add(Id.id.toString()),Id=$a.ParagraphReader.EDb(Id),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${Id.length} CommentRangeObjects`),this.N2i(Id,Wb,vb,Qc))});const xd=[];ka.forEach(Id=>{this.NIb.has(Id)||
xd.push(Id)});0<xd.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${xd.length} Failed To Load on Retry: ${xd.join(",")}`),this.BAb.logKpiFailure(qf.a.K2b,"CommentsFailedToLoadOnRetry",{isInternal:!0},{name:qf.a.J2b,isInternal:!0}))}m5l(ka){const Va=[];ka.forEach(vb=>{if(vb=this.m8e.J5h(vb))vb=Hh.k(vb),(vb=this.od.Db(vb))&&vb.hj&&Va.push(vb)});return Va}zqk(ka,Va){const vb=this.od.Db(ka.Wj);Va.Gi(vb);40===Va.We&&vb?(ka=this.lp.tGd(Va),({index:Va}=this.lp.pme(ka)).returnValue?(this.lp.rYe(ka,
Va),this.NIb.add(ka.objectId),Hh.p(ka)||this.CAb.add(ka.objectId),ka.Df&&this.wkf(ka)):this.f0c.add(ka)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",!vb,!ka.Wj),39===Va.We||this.hOd())}uPl(ka){const Va=[],vb=this.m8e.oPl();if(this.NIb.size===vb.length)return Va;vb.forEach(Wb=>{!this.NIb.has(Wb)&&zc.a.ZSm(Wb,ka,this.m8e,this.od)&&Va.push(Wb)});return Va}Fdj(){for(let ka=0;ka<this.f0c.length;ka++){const Va=this.f0c.J(ka);
let vb;({index:vb}=this.lp.pme(Va)).returnValue?(this.lp.rYe(Va,vb),Hh.p(Va)||this.CAb.add(Va.objectId),this.NIb.add(Va.objectId),Va.Df&&this.wkf(Va)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ObjectId: {2}, ParentId: {3}",Va.mPa,Va.U_a,Va.objectId,Va.Df))}this.f0c.clear()}Gsk(ka,Va){ka.oo(vb=>{if(11===vb.We){var Wb=vb.currentNode;const nc=Wb.ia(jm.a.v8e,null),Qc=Wb.ia(jm.a.t8e,null);vb=!!nc&&0<nc.length;const Hd=
!!Qc&&0<Qc.length;vb&&nc.forEach(Id=>{const Ve=this.od.Db(Id);Ve&&!Hh.s(Ve)&&Va.add(Id,0)});Hd&&Qc.forEach(Id=>{Va.nb(Id)&&Va.remove(Id)});(Wb=Wb.ia(Mc.a.FK,null))&&Wb.forEach(Id=>{const Ve=this.od.Db(Id);$a.ParagraphReader.Wb(Ve)&&!this.ai.Nx.nb(Id)&&this.ai.Nx.add(Id,new kj.a)});const xd=Va.keys;for(let Id=0;Id<xd.length;Id++){Wb&&0<Va.J(xd.J(Id))&&(this.ai.FU.nb(xd.J(Id))||this.ai.FU.add(xd.J(Id),new Ca.a(new Ue.a)),Wb.forEach(mf=>{const fg=this.od.Db(mf);$a.ParagraphReader.Wb(fg)&&(this.ai.Nx.J(mf).JM||
(this.ai.Nx.J(mf).JM=new Ca.a(new Ue.a)),this.ai.FU.J(xd.J(Id)).add(mf),this.ai.Nx.J(mf).N1a=!0,this.ai.Nx.J(mf).JM.add(xd.J(Id)))}));let Ve;Va.Z(Ve=Va.keys.J(Id),Va.J(Ve)+1)}return vb||Hd}return!0},null)}b9m(ka,Va,vb){ka&&(this.TRj(Va,vb),this.ai.Nx.nb(ka.id)||this.ai.Nx.add(ka.id,new kj.a),vb.forEach((Wb,nc)=>{0<nc&&(this.ai.FU.nb(Wb)||this.ai.FU.add(Wb,new Ca.a(new Ue.a)),this.ai.Nx.J(ka.id).JM||(this.ai.Nx.J(ka.id).JM=new Ca.a(new Ue.a)),this.ai.FU.J(Wb).add(ka.id),this.ai.Nx.J(ka.id).N1a=!0,
this.ai.Nx.J(ka.id).JM.add(Wb));vb.Z(Wb,nc+1);return!0}))}TRj(ka,Va){ka.forEach(vb=>{if(vb.Nc){const Wb=this.od.Db(vb.Wj);Wb&&!Hh.s(Wb)&&Va.Z(vb.Wj,0)}else Va.nb(vb.Wj)&&Va.remove(vb.Wj)})}}Object(e.a)(rk,"CommentModelBootLoader",null,[626]);var af=c(1033);class Cf{constructor(ka){this.ZFh=ka;this.Tsc=null;this.z6g=void 0;this.A6g=null;this.Bxc=new Map;this.Qye=new Map}XVn(){af.a.kSa(this.ORo.bind(this))}ORo(ka,Va){const vb=ka.id.toString();var Wb=ka.getValue(ma.a.ZE).toString();Va?(this.Bxc.delete(vb),
this.Qye.delete(Wb)):(this.Bxc.set(vb,ka),this.Qye.set(Wb,ka));0===this.Bxc.size&&this.Tsc&&(ka=+new Date-+this.Tsc,this.Tsc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${ka}`));Va||this.z6g!==Wb||(Va=+new Date-+this.A6g,a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${Va}`),Wb=new J.a,Wb.durationMs=Va,this.ZFh.logKpiFailure(qf.a.xEd,"CommentFoundAfterDeeplinkAttempt",
{isInternal:!0,additionalValues:Wb},{name:qf.a.FFh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:Wb}));this.Tsc||(this.Tsc=new Date)}set ccn(ka){this.z6g=ka;this.A6g=new Date;if(ka=this.mPl(ka))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${ka.id} present but failed to load`),ka=new J.a,this.ZFh.logKpiFailure(qf.a.xEd,"CommentPresentButFailedToLoad",{isInternal:!0},{name:qf.a.FFh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ka})}oPl(){return[...this.Bxc.keys()]}mPl(ka){return this.Qye.get(ka)}J5h(ka){return this.Bxc.get(ka)}}
Object(e.a)(Cf,"CommentNodeTracker",null,[]);class Hi{get contentType(){return 0}constructor(ka,Va,vb,Wb,nc){this.b8f=ka;this.lp=Va;this.g_=vb;this.KK=Wb;this.ai=nc;this.b8f.t8i(this)}Wgj(ka,Va,vb){0===Va?(Va=this.lp.HTc(ka),this.g_.selectComment(Va?this.lp.ny:this.lp.KD(ka),Object.assign(new Ik.a,{GR:vb||Va,C9:1}))):this.KK.clearSelection()}cpj(ka){return this.ai.Zm||this.lp.HTc(ka.contentId)?!0:this.lp.$ga(this.lp.KD(ka.contentId))}}Object(e.a)(Hi,"CommentReviewSuggestionContentActor",null,[625]);
class Cn{get Ovj(){return this.Rgg}constructor(ka,Va){this.HEd=ka;this.hs=Va;this.Rgg=new Set([12])}initialize(){}SFi(ka){if(!$a.ParagraphReader.Wb(ka.node))return[];ka=$a.ParagraphReader.EDb(ka.node);return this.HEd.vzm(ka)}kSi(){this.HEd.Ajn()}Gli(){return this.hs.Lwo?this.hs.Z8b:!0}}Object(e.a)(Cn,"CommentReviewSuggestionContentProvider",null,[624]);var zh=c(67),zr=c(126),Hj=c(246),yo=c(1558);class Xd{constructor(){this.commentId=null;this.wVc=!1}}Object(e.a)(Xd,"CommentToSelectOnPaneLoadData",
null,[]);class Gf{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd,Id,Ve,mf,fg,Dg,Zf,Ci){this.Sq=ka;this.lp=Va;this.UCa=vb;this.g_=Wb;this.BK=nc;this.ai=Qc;this.rMd=Hd;this.hs=xd;this.L2b=Id;this.C3a=Ve;this.pc=mf;this.UIf=fg;this.xg=Dg;this.Jk=Zf;this.y0k=Ci;this.pc.qa(tf.a.NOb,zh.a.frame,this.Sq.NOb.bind(this.Sq));this.pc.qa(tf.a.jJd,zh.a.frame,this.jJd.bind(this));this.pc.qa(tf.a.h8e,zh.a.frame,this.pkn.bind(this));this.pc.qa(tf.a.J_k,zh.a.frame,this.okn.bind(this));this.pc.qa(tf.a.tPi,zh.a.frame,this.Son.bind(this));
this.pc.qa(tf.a.QRh,zh.a.frame,this.Bln.bind(this));this.pc.qa(tf.a.MFh,zh.a.frame,this.Vmn.bind(this));this.pc.fb(tf.a.k8e,zh.a.frame,this.XCk.bind(this),64);this.pc.fb(tf.a.GEd,zh.a.frame,this.pXn.bind(this),64);this.pc.qa(Sg.a.selectComment,zh.a.frame,this.g_.W$n.bind(this.g_));this.hs.FXm&&this.pc.qa(Sg.a.M0d,zh.a.frame,this.M0d.bind(this));this.pnh(Sg.a.TIc,!1);this.pnh(Sg.a.edf,!0);this.pc.fb(Sg.a.IEd,zh.a.frame,this.IEd.bind(this),64);this.hs.sKc&&this.pc.qa(Sg.a.Myj,zh.a.frame,this.btn.bind(this));
this.pc.qa(Sg.a.yIi,zh.a.frame,zr.ActionManager.Of);this.hs.yzb&&this.pc.qa(Sg.a.K4e,zh.a.frame,this.xOk.bind(this));this.pc.qa(Sg.a.HPh,zh.a.frame,(og,cl)=>Hj.a.fha(cl.$j)&&Hj.a.hac()?8:32)}get Dj(){return this.lp}get mode(){return this.Sq.mode}get KA(){return this.Sq.KA}get hA(){return this.hs.Uq}get uj(){return this.C3a.value}get mb(){return this.UIf.value}get KK(){return this.Sq}jJd(ka,Va,vb,Wb,nc){return nc?nc?(ka=this.g_.iOd(nc.NavigationId))&&this.g_.jOd(ka,1)?32:8:(a.ULS.sendTraceTag(540160449,
327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}pkn(ka,Va,vb,Wb,nc){nc&&this.BK.s9("OnCommentInit",{...(new yo.a),hGa:()=>{var Qc=this.g_.iOd(nc.NavigationId);if(Qc){var Hd=this.g_.jOd(Qc,1);Hd?this.L2b.isVisible?(this.W5c(Hd,1),this.xg.cD(ug.AFrame.Gr)):this.Dj.$ga(Hd)?(Qc=Hh.r(Hd),this.g_.selectComment(Hd,{...(new Ik.a),GR:!Qc,C9:1}),this.xg.cD(ug.AFrame.qM)):(this.ai.Zm||this.pc.processAction(tf.a.NY,
2),tg.a.Z2(z.AFrameworkApplication.nc,()=>{this.W5c(Hd,1)},sg.a.W5c)):this.pc.processAction(tf.a.n4a,2)}}});return 32}okn(ka,Va,vb,Wb,nc){nc?(ka=this.Dj.qNc(nc))?this.KK.mec(ka.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.KK.mec(null);return 32}Son(ka,Va,vb,Wb,nc){if(nc){if(this.ai.ZFb){for(ka=0;ka<nc.length;ka++)this.Dj.rjj(nc[ka]);this.Sq.vMb()}else this.Dj.Auk(nc);this.i3m(nc)}return 32}Bln(ka,Va,vb,Wb,nc){if(nc)if(this.ai.ZFb){for(ka=
0;ka<nc.length;ka++)this.Dj.rjj(nc[ka],!0);this.Sq.vMb()}else this.Dj.fXk();return 32}Vmn(ka,Va,vb,Wb,nc){this.hA||this.ai.Zm||this.pc.processAction(tf.a.NY,2);if(nc){ka=null;if(!this.KA||2!==this.mode&&3!==this.mode){if(!nc)return 8;if(this.hA)ka=this.HAl(nc);else for(Va=0;Va<nc.length&&(ka=this.Dj.w_(nc[Va].toString()),this.rMd.qYd&&(!ka||ka.done));Va++);}else ka=this.KA;this.W5c(ka,1);ka&&this.ai.dY&&this.xg.mg(this.hA&&!this.ai.Zm?ug.AFrame.qM:ug.AFrame.Gr)}else a.ULS.sendTraceTag(5017933,327,
10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}XCk(ka,Va,vb,Wb,nc){var Qc;if(!nc)return 32;if(nc&&0<nc.length){Va=ka=vb=0;Wb=!1;for(let Hd=0;Hd<nc.length;Hd++)nc[Hd].toString()===(null===(Qc=this.KA)||void 0===Qc?void 0:Qc.objectId)?(Wb=!0,ka++):this.lp.XEf(nc[Hd])&&(Wb&&0===vb&&(vb=Hd,Va=ka),ka++);(Qc=this.lp.w_(nc[vb].toString()))?(this.UCa.vlc.RQf=Va+1,this.UCa.vlc.iIa=ka,this.KK.mec(Qc.id)):(nc=nc[vb],this.uj.Db(nc)?a.ULS.sendTraceTag(540148256,327,10,`Comment Node with ObjectId ${nc} has no corresponding comment in Model`):
a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",nc.toString()))}return 32}pXn(){this.KK.mec(null);return 32}pnh(ka,Va){this.pc.qa(ka,zh.a.frame,(vb,Wb,nc)=>this.fln(nc,Va))}btn(ka,Va,vb){if(this.ai.Zm)return 32;2===vb&&(this.ai.c8c=!this.ai.c8c,this.BK.s9("OnFloatingCommentsToggle"));return 32}M0d(ka,Va,vb){2===vb&&(ka=this.Dj.ur.Mc(7),ka.Cb(this.Dj.UIa),Va=new fe.a,Va.Wga(`${String.fromCodePoint(128077)} \n`),this.lp.dBb(Uc.a.instance.hb.kb,
void 0,Va),this.y0k.YUd(),ka.dispose());return 32}fln(ka,Va=!1){if(2===ka)ka=this.Dj.ur.Mc(15),ka.Cb(this.Dj.UIa),this.Jk.ie(()=>{this.TIc(Va)},"ECM:DAC"),ka.dispose();else if(1===ka&&!this.Dj.Y8b())return 2;return 32}TIc(ka=!1){this.Sq.mode=1;const Va=this.Dj.xO();for(const vb of Va)vb.Tq===Qd.a.beingCreated||ka&&!vb.done||vb.Df||this.Sq.deleteComment(vb);this.xg.mg(ug.AFrame.Pn);0<(ka?this.Dj.xO().filter(vb=>vb.done):this.Dj.xO()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",
ka):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",ka)}IEd(ka,Va,vb){if(2===vb)if(ka=this.xg.currentScope.name,ka!==ug.AFrame.Gr&&ka!==ug.AFrame.qM){!this.hA||this.ai.Zm?(this.ai.Zm||this.pc.processAction(tf.a.NY,2),this.xg.mg(ug.AFrame.Gr)):this.xg.mg(ug.AFrame.qM);var Wb=this.mb.hb.kb;if(!Wb||!Wb.Qa)return 2;ka=Wb.Qa.cpBegin;Va=Wb.Qa.node;Wb=!!this.KA&&(Ye.SelectionEditor.km(Wb)||Wb.JH)&&Hh.q(this.KA,Va,this.uj,ka);ka=!!this.KA&&(2===this.mode||
3===this.mode);if(Wb||ka)return this.KK.Ygj(this.KA.id,!0),32;Wb=this.hA&&!this.ai.Zm?this.Dj.K5h(!0,!0):null;this.KK.eao(Wb)}else this.Dj.$s&&(this.Sq.s9b.Rgj(this.Dj.$s,!0),this.Sq.s9b.vib(null===(Wb=this.Dj.$s)||void 0===Wb?void 0:Wb.objectId)),this.xg.mg(ug.AFrame.Pn);return 32}xOk(){return 4}i3m(ka){const Va=new Set;for(let vb=0;vb<ka.length;vb++){const Wb=this.Dj.qNc(ka[vb]);Wb&&Va.add(Wb.Df?Wb.Df:Wb.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",Va.size.toString())}W5c(ka,
Va){ka?this.L2b&&!this.ai.dY?this.ai.Heb=Object.assign(new Xd,{commentId:ka.id,wVc:!1}):this.g_.selectComment(ka,Object.assign(new Ik.a,{GR:!!Va,C9:Va})):a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}HAl(ka){let Va=null,vb=!1;for(let Wb=0;Wb<ka.length;Wb++){const nc=ka[Wb].toString();if(this.Dj.XEf(ka[Wb])){Va||(Va=nc);if(vb&&this.Dj.$s.objectId!==nc)return this.Dj.w_(nc);vb=vb||!!this.Dj.$s&&this.Dj.$s.objectId===nc}}return Va?this.Dj.w_(Va):null}}Object(e.a)(Gf,
"CommentsActionManager",null,[]);var re=c(232),Of=c(47),Pb=c(176),gk=c(1800),Al=c(513),Yj=c(31),No;(function(ka){ka[ka.tbp=0]="commentDeeplink";ka[ka.catchUpActivity=1]="catchUpActivity"})(No||(No={}));Object(e.b)("DeeplinkSource",No);class Xo{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd,Id,Ve,mf,fg,Dg){this.ga=ka;this.Zh=Va;this.tv=vb;this.Cve=Wb;this.UP=nc;this.hfh=Qc;this.Ub=Hd;this.rj=xd;this.ih=Id;this.Oub=Ve;this.Eve=mf;this.XJ=fg;this.hSe=!1;this.Wko=Zf=>{if(this.ih.Uq&&!this.rj.Zm){const Ci=new pa.a(0,
1,0,()=>{this.djj(Zf)},136,void 0,!0);z.AFrameworkApplication.nc.Vb(Ci)}else this.djj(Zf)};Dg.execute(Zf=>{this.xE=Zf})}get lp(){return this.Zh}get mb(){return this.Oub.value}LUh(ka){let Va=ka.Tq===Qd.a.beingCreated?ka.gz.draftId:ka.id,vb=null;ka.Df&&(Va=ka.Df,vb=()=>{this.hfh.selectComment(ka.id)});this.UP.setInitialActiveContainerId(Va,0,vb)}W$n(ka,Va,vb,Wb,nc){if(!nc.commentId)return 2;ka=this.Zh.KD(nc.commentId);if(!ka)return 2;this.Tnb(ka,nc);return 32}Vgj(ka,Va){var vb,Wb;if(ka){var nc=(null===
(Wb=null===(vb=this.Zh.ny)||void 0===vb?void 0:vb.gz)||void 0===Wb?void 0:Wb.draftId)===ka?this.Zh.ny:this.Zh.KD(ka);this.selectComment(nc,Va)}}selectComment(ka,Va){ka&&this.Tnb(ka,Va)}Sgj(ka,Va){var vb=this.iOd(ka);vb&&((vb=this.jOd(vb,0))?Va.qdg?(this.rj.Heb=Object.assign(new Xd,{commentId:vb.id,wVc:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):(this.Tnb(vb,Object.assign(new Ik.a,{commentId:vb.id,C9:1,GR:!0,CTc:!0})),this.ih.Uq&&void 0!==ka&&null!==
ka&&this.LUh(vb),tg.a.Z2(z.AFrameworkApplication.nc,()=>{this.Ub.mg(this.ih.Uq&&!this.rj.Zm?ug.AFrame.qM:ug.AFrame.Gr)},sg.a.sgo),re.a.instance.rf(Of.a.COh,(new Date).getTime()),ka=this.ih.Uq?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",ka+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,ka,(new Date).getTime()-z.AFrameworkApplication.QW)):this.ga.processAction(tf.a.n4a,2))}iOd(ka){let Va=null;var vb=null;if(L.a.Qac(ka))Va=ka;else if(({Wu:vb}=
w.d(ka)).returnValue&&(ka=vb))return Al.a.comment in ka&&(Va=ka[Al.a.comment]),Va;Va||(vb=vb?Object.keys(vb):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",vb?vb.join(","):"Not Json."));return Va?Va.toString():null}jOd(ka,Va){const vb=this.Zh.qNc(ka),Wb=0===Va;Wb&&this.XJ.logKpiUsage(qf.a.xEd,0);if(!vb){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",ka,Va);const nc=new Yj.a;nc.name="DeepLinkSource";nc.string=
No[Va];this.XJ.logActivity("CommentDeeplinkNotFound",{dataFields:[nc]});Wb&&(Va=new J.a,Va.extendedProperties=new Map([["ErrorLevel","warning"]]),this.XJ.logKpiFailure(qf.a.xEd,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:Va}),this.Eve.ccn=ka)}return vb}djj(ka){this.hSe=!0;this.mb.setSelection(ka);this.hSe=!1}Tnb(ka,Va){if(ka){this.rj.aKb&&(z.AFrameworkApplication.nc.Ve(this.rj.aKb),this.rj.aKb=null);var vb=this.Zh.$s,Wb=this.lp.Fsf(ka),nc=2===Va.C9,Qc={};nc&&(Qc.TriggeredByFindReplace=
!0);if(this.rj.Zm)nc&&(Qc.PaneAlreadyOpen=!0),Pb.UISurfaces.zu().then(Hd=>{Hd.setSelectedTaskPane(gk.a.JEd);return null});else if(ka.Tq!==Qd.a.beingCreated&&!this.lp.$ga(ka))this.rj.dY?this.ga.processAction(Sg.a.NY,2):this.rj.Heb=Object.assign(new Xd,{commentId:ka.id,wVc:Va.CTc}),nc&&(Qc.OpeningPaneToSelect=!0);else if(this.ih.Uq){const Hd=Wb.Tq===Qd.a.beingCreated;Hd?this.UP.MSa(Wb.gz.draftId,0,Va.GR):this.UP.MSa(Wb.id,0,Va.GR);!Hd&&nc&&(Qc.SelectingDHC=!0)}tg.a.Z2(z.AFrameworkApplication.nc,()=>
{this.rj.dY&&(Va.GR&&this.Ub.mg(this.ih.Uq&&!this.rj.Zm?ug.AFrame.qM:ug.AFrame.Gr),Va.CTc&&this.lp.$ga(ka)||!Va.GR&&!Va.C9||this.hfh.selectComment(ka.id))},sg.a.pag);nc=this.lp.Fsf(vb);this.ih.iua&&this.xE&&nc&&nc.id!==Wb.id&&this.xE.fireEvent(9,{comment:nc});this.Zh.selectComment(ka);this.ih.iua&&this.xE&&ka.Tq===Qd.a.normal&&!ka.Df&&this.xE.fireEvent(8,{comment:ka});this.Cve.highlightComment(ka,!0);this.tv.BF(0,Wb,vb);V.App.ya.updateCommandUI(!0);0<Object.keys(Qc).length&&this.XJ.Hv(Sg.a.selectComment,
{customData:Qc})}}}Object(e.a)(Xo,"CommentSelectionActor",null,[623]);class op extends Df.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new yd.a,{T_:op.getTypeName(),B_:op.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(op,"CommentSmartReplySignal",Df.a,[]);class Gp extends Ja.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=
0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new yd.a,{T_:Gp.getTypeName(),B_:Gp.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(e.a)(Gp,"SmartReply",Ja.a,[]);var go=c(851);class zo{constructor(ka){this.tra=ka}E3b(ka,Va){return Object.assign(new go.a,{parentPath:["Signal",op.getTypeName()],items:[Object.assign(new Qe.a,{body:Object.assign(new op,{commentId:ka,comment:Va})})]})}MZf(ka){const Va=
new db.a;if(ka&&ka.CommentId&&ka.ResultSets&&0<ka.ResultSets.length&&ka.ResultSets[0].Documents&&0<ka.ResultSets[0].Documents.length){for(const vb of ka.ResultSets[0].Documents)Va.add(vb.Caption);0<Va.count&&this.tra.MZf(ka.CommentId,Va.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return Gp.getTypeName()}}Object(e.a)(zo,"BaseCommentSmartReplyProvider",null,[963]);class tb extends zo{constructor(ka,Va,vb,Wb){super(ka);this.Te=Va;this.Zz=
vb;this.SVj=Wb}initialize(){this.Zz.kl().then(()=>{this.Te.lb(this,zo.prototype.getTypeName.call(this))})}invoke(ka,Va){this.Zz.kl().then(()=>{this.SVj.getAugLoopRuntimeManager().submitOperation(Object.assign(new Tb.a,{operation:this.E3b(ka,Va)}))})}UD(ka,Va){ka&&xa.a.getTypeNameFor(ka.content)===this.getTypeName()&&Va===Ka.a.getTypeName()?this.MZf(ka.content):a.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(e.a)(tb,"CommentSmartReplyProvider",zo,[251]);var Bc=
c(38),qd=c(134),xe=c(157),Ge=c(500);class gf{constructor(ka,Va,vb,Wb,nc,Qc){this.Ma=ka;this.ld=Va;this.qx=vb;this.kIe=Wb;this.Eve=nc;this.$M=Qc;this.Utb=!1;this.Eve.XVn();this.zYj=this.G3l();this.d3f&&(Bc.a.addHandler(window.self,Ee.a.erh,()=>{this.Utb=!0}),Bc.a.addHandler(window.self,Ee.a.frh,()=>{this.Utb=!1}))}get ax(){return this.qx?this.qx.value:null}get VCa(){return this.kIe.value}get LNo(){return this.Utb}get Z8b(){return 0<this.zYj}get Uq(){return this.$M.Uq}get Fml(){return!0}get wHk(){return Object(Ge.c)()?
!1:this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoPopulateShareTUIComment",!1)}get GPb(){return this.ld.isFeatureEnabled(116)&&!xe.App.LUc}get obo(){return this.ld.isFeatureEnabled(36)&&this.Ma.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get K_k(){return this.Ma.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get d3f(){return this.Ma.$("RecordCommentActionsInTypingIsEnabled")}get ZPi(){return this.Ma.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get LBb(){return this.Uq&&
!this.Z8b&&!this.Ma.jb("BootActivityNavigationId")&&F.a.Xt}get yzb(){return this.ld.isFeatureEnabled(7)}get uGk(){return this.Ma.$("AtMentionUserFloodGateCampaignIsEnabled")}get $_k(){return this.Ma.$("CommentFriendlyTimestampsIsEnabled")}get yml(){return this.Ma.jb("DisabledChangeGatesInSharedComments")}get sMd(){return this.$M.sMd}get WOb(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",!1)}get Xeg(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",
!1)}get zY(){return this.Ma.jb("PresenceUserId")}get removePersonalInformation(){return xe.App.Zoe&&!!qd.PageReader.instance&&qd.PageReader.instance.Fga(V.App.ya.gb.Uc).removePersonalInformation}get cgb(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",!1)}get MYm(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.SharedCommentsLivePersonaCardForWeb",!1)}get nFo(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1)}get sKc(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.HideCommentsByDefaultEnabled",!1)}get R0k(){return this.Ma.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get F0k(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReactionsFPSEnabled",!1)}get FXm(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1)}get contentNavigationApiEnabled(){return this.$M.contentNavigationApiEnabled}get Wvn(){return this.ld.isFeatureEnabled(87)}get iua(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",
!1)}get contentFilterApiEnabled(){return this.$M.contentFilterApiEnabled}get Z_k(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentFilterHintIconFix",!0)}get Lwo(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipParaTraversalIfNoComments",!1)}G3l(){if(this.ax&&this.VCa){const ka=new cd.GraphIterator;ka.set(this.ax);this.VCa.j4a(ka);let Va=0;39===ka.We&&(Va=ka.xq());return Va}return-1}}Object(e.a)(gf,"CommentsSettings",null,[]);var uf=c(1593),ff=c(1357);
class qj{constructor(ka){this.k$=ka}Yxh(ka,Va,vb){const Wb=new jn;Va=this.k$.wQa(Va)?Va.objectId:null;if(!Va)return Wb;Va=ja.a.If(Va);if(vb.contains(Va))return Wb.XRc=0,Wb.WRc=ka.length,Wb;for(let Qc=0,Hd=ka.length;Qc<Hd;Qc++){var nc=ka[Qc];vb=Hh.g(nc);nc=Hh.d(nc);vb&&ff.a.xHh(vb,Va)&&(Wb.XRc=Qc);if(nc&&ff.a.xHh(nc,Va)){Wb.WRc=Qc;break}}return Wb}pth(ka,Va,vb){const Wb=-1===Va.XRc&&-1===Va.WRc,nc=-1<Va.XRc?Va.XRc:-1;Va=-1<Va.WRc?Va.WRc:ka.length;const Qc=!Wb&&nc===Va;var Hd=!1;for(let xd=0;xd<ka.length;xd++){const Id=
ka[xd],Ve=sj.a(Id);if(1!==Ve&&2!==Ve&&3!==Ve)continue;this.k$.nSa(Id);if(Wb||xd<nc||xd>Va)continue;const mf=3===Ve||2===Ve&&-1!==Id.className.indexOf(pf.a.CPa),fg=vb?1:2;this.XDk(xd,nc,Va,fg,mf,Hd,Id,Qc);if(xd!==Va||Qc)(Hd=this.k$.U1a.J(Ve).J(fg))&&Id.classList.add(Hd),Hd=mf}}XDk(ka,Va,vb,Wb,nc,Qc,Hd,xd){ka!==Va&&ka!==vb||nc||Qc||((ka=this.k$.Hfc.J(Wb))&&Hd.classList.add(ka),xd&&Hd.classList.add(pf.a.mZf))}}Object(e.a)(qj,"DefaultHighlightChangeHandler",null,[622]);var wg;(function(ka){ka[ka.success=
0]="success";ka[ka.noSelection=1]="noSelection";ka[ka.invalidContent=2]="invalidContent"})(wg||(wg={}));Object(e.b)("AnchorCreationResult",wg);var sh=c(61),lc=c(23),Li=c(276),ld=c(234),ej=c(1195);class bl{}Object(e.a)(bl,"EditorAnchorInfo",null,[636]);class jd{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd){this.dXm=ka;this.UIf=Va;this.Dj=vb;this.e2a=Wb;this.UCa=nc;this.yo=Qc;this.BK=Hd;this.hs=xd;this.Zeh=null;this.e2a.u5a(this.UCa);this.hs.contentFilterApiEnabled&&(this.BK.u9("OnCommentPaneOpen",this.HTo.bind(this)),
this.BK.u9("OnCommentPaneClose",this.GTo.bind(this)),this.BK.u9("OnContentFilterUpdate",this.t_c.bind(this)))}get mb(){return this.UIf.value}get uj(){return this.dXm.value}initialize(){}sxm(ka){this.Zeh=ka}dispose(){}vib(ka){this.UCa.vib(ka)}r9b(ka){this.UCa.r9b(ka)}highlightComment(ka){this.Rgj(ka,!1);this.UCa.vib(ka.objectId)}imc(ka){this.UCa.imc(ka)}lEa(ka){return this.UCa.lEa(ka)}t_c(){this.Lqe("OnContentFilterUpdate")}HTo(){this.Lqe("OnCommentPaneOpen")}GTo(){this.Lqe("OnCommentPaneClose")}Lqe(ka){const Va=
[],vb=new Set;for(const nc of this.Dj.xO())if(!nc.Df&&nc.Tq!==Qd.a.beingCreated&&!this.Dj.KK.oAh(ka,nc)){var Wb=this.A4l(nc);vb.has(Wb.id.toString())||(vb.add(Wb.id.toString()),(Wb=Wb.De(sh.InteractiveViewManager.instance.Bd.ic))&&Va.push(Wb))}Va.forEach(nc=>{this.e2a.jmc(nc)})}A4l(ka){var Va,vb;const Wb=null===(Va=this.uj)||void 0===Va?void 0:Va.Db(ka.objectId);if(!Wb)return null;ka=Hh.k(Wb);Va=null===(vb=this.uj)||void 0===vb?void 0:vb.Db(ka);return zc.a.pci(Va)}Rgj(ka,Va){if(!ka.Tq){var vb=this.uj.Db(ja.a.If(ka.objectId)),
Wb=ng.a.mba(vb,this.uj,!0);vb=ng.a.mba(vb,this.uj,!1);if(Wb&&vb){const nc=Wb.Ib.paragraph;Wb=Wb.Ib.cp;if(this.jQm(nc,Wb))V.App.ya.updateCommandUI(!0);else{Wb=lc.SelectionFactory.te(nc,Wb);vb=xc.a.Rc(vb.Ib.paragraph,vb.Ib.cp);if(jd.Vf.A8(Wb.Qa)||jd.Vf.A8(vb))ka.fQa=!0,ka.g4a();ka=Va?lc.SelectionFactory.jA(Wb,vb):Wb;this.Zeh(ka)}}}}TWk(){this.UCa.r9b(null);this.UCa.vib(null)}j7k(){const ka=new bl;return{returnValue:wg.success,anchor:ka}}jQm(ka,Va){if(ka&&Object(Om.a)(ej.PageView,this.yo.Bd)){var vb=
ka.De(this.yo.Bd.ic);ka=document.getElementById(Rj.AppFrame.rUa);if(vb&&ka){Va=Li.a.Pq(vb,Va);if(!Va)return!1;Va=Va.y;vb=Sys.UI.DomElement.getBounds(ka).y;ka=ka.offsetHeight;if(Va>=vb&&Va<=vb+ka)return!0}}return!1}static get Vf(){return ld.a.instance}static getInstance(){return jd.Rl()}static Rl(){return jd._instance||(jd._instance=new jd(new W.a(()=>V.App.ya.gb.Uc.od),new W.a(()=>Uc.a.instance),K.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),K.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,
K.a.instance.resolve("WordEditor.Comments.CommentHintActor"),sh.InteractiveViewManager.instance,K.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),K.a.instance.resolve("WordEditor.Comments.CommentsSettings")))}}jd._instance=null;Object(e.a)(jd,"EditorCommentHintManager",null,[620,621,9]);var th=c(2001),vd=c(350),rj=c(1143);class fj extends Uf.a{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd,Id,Ve,mf,fg,Dg,Zf,Ci,og,cl,ik,uj,ti,Yo,wh,cn,Tm,nl,Um){super(Hd);this.ni=Va;this.Oub=xd;this.g8e=Ve;this.ura=
mf;this.aqc=fg;this.UP=Dg;this.ih=Zf;this.Rp=Ci;this.cTb=og;this.rj=cl;this.P1=ik;this.he=ti;this.XJ=Yo;this.mT=cn;this.zEd=Tm;this.WIo=Um;this.Lmi=this.Tgh=this.fWa=null;this.Ilb=()=>{this.$qa.soa()&&(this.l8i(this.$qa.wc),this.$qa.Xgc(this.Ilb))};this.VYc=ak=>{2===ak.mode?this.mD=1:1===ak.mode&&(this.mD=0);this.Zh.ny&&0===this.mD?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",this.Zh.ny.gz.sessionType):this.rj.dY&&(this.hA||
this.Q1.isVisible)&&this.vMb()};this.yin=()=>{this.rj.ZFb?this.mode=0:this.mD=0};this.wGa=(ak,Vl)=>{var sk;ak=Vl.nl.kb;if((this.hA||this.wca&&this.wca.isVisible)&&!this.cTb.hSe&&ak){Vl=Ye.SelectionEditor.km(ak);var po=ak.JH;null!==(sk=this.Lmi)&&void 0!==sk&&sk.aba||(this.lp||a.ULS.sendTraceTag(509698397,327,15,"onSelectionChange: CommentModel Not Set."),sk=this.lp&&this.lp.mjb(this.ga,!1),1!==this.mode||Vl&&!po||!sk?this.aqc.YUd():this.$$k(ak));2!==this.mode&&3!==this.mode&&this.ih.K_k&&this.aMo(ak,
Vl,po)}};this.CUk=()=>{if(this.Dj&&this.Dj.ny&&!V.App.oBf){var ak=this.Dj.ny;ak.gz.sessionType!==th.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${ak.Tq} present on app shutdown`),(ak=zc.a.qTl(ak))&&this.XJ.logKpiFailure(ak,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:qf.a.J2b,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.Hin=()=>{if(this.rj.dY){var ak=()=>!0;this.hA&&!this.rj.Zm&&(ak=Vl=>this.lp.$ga(Vl));ak=this.lp.Lnf(ak);this.vMb(ak)}};this.ga=
Hd;this.mD=1===this.ga.mode?0:1;this.Q1=nc;this.Zh=Wb;this.B$=Qc;this.Ub=Id;this.XUn();vb.t5a(this.ura);this.mb.Lw(this.wGa);ka.CWR(()=>ka.result.OA.QMa(this.yin));z.AFrameworkApplication.ta&&z.AFrameworkApplication.ta.TYa(this.VYc);this.P1.u9("OnAfterTrackChangeMarkupViewChange",this.Hin);z.AFrameworkApplication.$H&&z.AFrameworkApplication.$H(this.CUk);nl.execute(ak=>{this.xE=ak});wh.execute(ak=>{ak.O4k.execute(Vl=>{this.Lmi=Vl})})}XUn(){this.$qa&&(this.$qa.soa()?this.l8i(this.$qa.wc):this.$qa.k0b(this.Ilb))}l8i(ka){ka.Hla(()=>
{this.mAo()})}get $qa(){var ka;return null===(ka=xe.App.Ln)||void 0===ka?void 0:ka.gb}get mb(){return this.Oub.value}get Dj(){return this.Zh}get lp(){return this.Zh}get hA(){return this.ih.Uq}get FPi(){return!0}get Jhj(){return!0}get x9b(){return this.fWa}set x9b(ka){this.fWa=ka}get mode(){return super.mode}set mode(ka){ka!==this.mD&&(super.mode=ka,this.g4a())}get KA(){return this.model&&this.model.$s?this.model.$s.Df?this.model.KD(this.model.$s.Df):this.model.$s:null}get uj(){return this.ni.value}get xqj(){return!1}get removePersonalInformation(){return this.ih.removePersonalInformation}vMb(ka=
null,Va=null){const vb=this.lp,Wb=!this.mD,nc=this.wca.W_k,Qc=vb.GQd();nc.wmg(Qc?5:1,Wb);ka=this.ih.WOb&&ka?ka:vb.fof(this.ih.WOb&&this.hA&&!this.rj.Zm);nc.ibo(ka,Qc,vb.aVa);this.amg();Va&&a.ULS.sendTraceTag(572281362,327,50,Va)}u_c(ka,Va,vb=!1){this.rj.Zm?this.UP.zGj():Va?this.UP.deleteContainer(ka.Tq===Qd.a.beingCreated?ka.gz.draftId:ka.id,0,vb):this.aNn(ka)}aNn(ka){const {eHo:Va}=this.Zh.NYl(ka),vb=this.B$.lEa(ka.objectId);vb&&this.UP.addContainer(ka.id,vb.parentElement,0,Va)}bhj(ka){const Va=
this.KA;this.Y5c();this.ura.BF(0,this.Zh.$s,Va);this.hA&&this.Zh.$s&&!this.rj.Zm&&this.UP.MSa(this.Zh.$s.id,0,1===ka)}fao(){const ka=this.KA;this.Z5c();this.ura.BF(0,this.Zh.$s,ka);this.hA&&this.Zh.$s&&!this.rj.Zm&&this.UP.MSa(this.Zh.$s.id,0,!1)}imc(ka){this.B$.imc(ka)}Zrl(ka,Va){this.UP.addContainer(ka,null,0,Va)}Mzn(ka){this.UP.O_i(ka)}asl(ka,Va){this.UP.r4c(ka,Va,0)}USo(){this.UP.b2e()}Ugj(ka){if(ka&&(2!==this.mode||ka.Tq===Qd.a.beingCreated)){var Va=this.Zh.$s;Va!==ka&&(this.Zh.selectComment(ka),
this.Q1.isVisible?this.rj.dY?(this.Q1.selectComment(ka,1),this.jka.selectComment(ka.id)):this.rj.Heb=Object.assign(new Xd,{commentId:ka.id,wVc:!1}):this.hA&&!ka.done&&(this.Ygj(ka.id,!1),this.jka.selectComment(ka.id)),!this.Q1.isVisible&&this.hA&&ka.done||(this.s9b.vib(ka.objectId),this.ura.BF(0,this.KA,Va)))}}lSc(){}ehf(){this.rj.ZFb=!1}Qyb(ka){this.ih.ZPi&&this.Zh.$s&&this.clearSelection();super.Qyb(ka);this.XJ.logKpiUsage(qf.a.r8e,0);this.amg();if(this.hA){const Va=this.Zh.nem(ka.draftId);this.Zrl(ka.draftId,
Va)}}addReply(ka,Va){this.XJ.logKpiUsage(qf.a.LEd,0);super.addReply(ka,Va)}jua(ka){this.hA&&null!=ka.gz&&this.Zh.r9i(ka.gz.draftId);super.jua(ka);this.B$.vib(ka.objectId);a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",Hh.a(ka));this.XJ.logKpiUsage(qf.a.DFh,0);this.HUk(ka);zc.a.C_o(ka,this.uj,this.XJ);this.XJ.Hv(Sg.a.CFh,{succeeded:!0,customData:{actionType:ka.Df?th.a.reply:th.a.create}})}Jeb(ka){super.Jeb(ka);this.XJ.Hv(Sg.a.CFh,{succeeded:!0,customData:{actionType:th.a.edit}})}HUk(ka){if(ka.Df){var Va=
this.Zh.Fsf(ka);if(Va.TDc&&Va.UDc){var vb=this.uj.Db(ja.a.If(Va.UDc));Va=Va.UDc===Va.TDc?null:this.uj.Db(ja.a.If(Va.TDc));zc.a.Mrg(vb,ka,!0);zc.a.Mrg(Va,ka,!1)}}}UIc(ka){super.UIc(ka);this.KA&&this.KA.id===ka.id&&(super.clearSelection(),this.hA&&this.UP.t2b());if(this.hA)if(Hh.r(ka)){var Va=[];let vb=null;for(const Wb of this.model.xO())Wb!==ka&&(Wb.Df===ka.Df&&Va.push(Wb),Wb.id===ka.Df&&(vb=Wb));vb&&vb.id&&vb.objectId&&!vb.done&&this.lp.CG(vb.objectId)&&!this.lp.B0i(vb.objectId)&&!Va.length&&this.u_c(vb,
!0)}else Va=ka.Tq===Qd.a.beingCreated,ka.done||this.u_c(ka,!0),Va&&this.Zh.r9i(ka.gz.draftId)}editComment(ka,Va){1===this.mode&&ka&&(this.Zh.bKc(ka,Va),th.a.edit===Va.sessionType&&this.XJ.logKpiUsage(qf.a.IFh,0),this.ih.GPb&&3!==th.a.Nqf(Va.sessionType)&&this.cTb.selectComment(ka,Object.assign(new Ik.a,{GR:!1,C9:0})))}bfe(ka){this.hA&&!this.rj.Zm||super.bfe(ka)}deleteComment(ka){ka.Tq!==Qd.a.beingCreated&&this.lp.UPh(ja.a.If(ka.objectId));this.fWa&&this.fWa.id===ka.id&&(this.Zh.$s&&this.fWa.id===
this.Zh.$s.id?this.fWa=null:this.ura.Y6e());!this.Zh.$s||this.Zh.$s.id!==ka.id&&this.Zh.$s.Df!==ka.id?this.Zh.$s&&this.ura.BF(0,this.Zh.$s,null):void 0===ka.Df||null===ka.Df?this.clearSelection():this.Zh.selectComment(this.Zh.KD(ka.Df));ka.fQa&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",Hh.a(ka));super.deleteComment(ka);a.ULS.sendTraceTag(50426377,327,50,`${Hh.a(ka)} deleted by user action. DurableId: ${ka.U_a}`)}iAb(ka,Va){super.iAb(ka,Va);this.hA&&
!this.rj.Zm&&Va&&(this.Zh.$s&&this.Zh.$s.id===ka.id&&this.clearSelection(),this.x9b&&this.x9b.id===ka.id&&this.ura.Y6e())}eao(ka=null){(ka=this.lp.kPl(ka))?this.cTb.selectComment(ka,Object.assign(new Ik.a,{GR:!0,C9:1})):this.bhj(1)}$$k(ka){var Va,vb=this.$qa.wc;if(vb){var Wb=ka.Qa.node,nc=null===(Va=this.WIo.instance)||void 0===Va?void 0:Va.CPc(Wb);if(nc)for(const Qc of vb.FOa(nc))if(Qc&&Qc instanceof vd.a&&(Va=Qc,vb=rj.a.TLh(Va),this.aqc.foe=this.hzl(Wb,ka),nc=this.IPk(vb),null!==nc)){if(ka=this.aqc.Yyl(vb,
nc))vb.kwa[nc].appendChild(ka),Va.Cz(ka);break}}}hzl(ka,Va){let vb;for(const Wb of ka.WG)if(Wb&&Wb){vb=Wb;break}ka=Va.Qa.Aj;Va=!(null===vb||void 0===vb||!vb.Tn)&&0<vb.Tn.length;return 0>ka||!Va||null===vb||void 0===vb||!vb.eop?null:Li.a.a_(ka,vb,!1,!1)}IPk(ka){var Va;const vb=null===(Va=this.aqc.foe)||void 0===Va?void 0:Va.y;for(const [Wb,nc]of ka.Jba.entries())if(ka=vb-nc.y,-2<=ka&&ka<nc.height+2)return Wb;return null}g4a(){V.App.gib=2===this.mode||3===this.mode;1!==this.mode&&this.aqc.YUd()}aMo(ka,
Va,vb){const Wb=this.Ub.currentScope;let nc=null;if(Va||vb){Va=ka.Qa.cpBegin;ka=ka.Qa.node;if(this.KA&&Hh.q(this.KA,ka,this.uj,Va))return;nc=this.q2l(ka,Va)}nc?!this.hA||this.rj.Zm?tg.a.Z2(z.AFrameworkApplication.nc,()=>{this.Ugj(nc)},sg.a.Y$n):this.Ugj(nc):!this.Zh.$s||Wb&&Wb.name===ug.AFrame.qM||this.clearSelection()}q2l(ka,Va){let vb=null;const Wb=this.model.xO();for(let nc=Wb.length-1;0<=nc;nc--){const Qc=Wb[nc];if(Qc.objectId&&!(Qc.Df||this.hA&&!this.wca.isVisible&&Qc.done)&&Hh.q(Qc,ka,this.uj,
Va)){vb=Qc;break}}return vb}selectComment(ka,Va=1){this.cTb.Vgj(ka,Object.assign(new Ik.a,{GR:1===Va,C9:Va}))}Ygj(ka,Va){const vb=this.Zh.KD(ka);vb?this.hA&&!Hh.r(vb)&&vb.Tq!==Qd.a.beingCreated&&this.UP.MSa(ka,0,Va):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const ka=this.model.$s;this.ih.iua&&this.xE&&ka&&this.xE.fireEvent(9,{comment:ka});super.clearSelection();this.ura.BF(1,ka,ka);this.hA&&ka&&this.UP.t2b()}NPm(){var ka;return 500>(null===(ka=this.Tgh)||
void 0===ka?void 0:ka.si)}mec(ka,Va=1){if(!this.ih.ZPi||!this.Zh.ny){var vb=this.Zh.KD(ka),Wb=null;vb||(Wb=this.fWa);var nc=this.NPm(),Qc=!1;1===Va&&this.jka&&(nc?Qc=!0:this.jka.highlightComment(ka));ka?vb?nc?Qc=!0:this.B$.r9b(vb.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.B$.r9b(null);vb?nc?Qc=!0:(this.fWa=vb,this.ura.BF(2,vb,Wb)):(this.fWa=null,this.ura.BF(3,null,Wb));Qc&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}mAo(){this.he&&
(this.Tgh=this.he.Zf("UserAction","StartScrollDetectionStopwatch"))}notify(ka,Va){this.Rp.sendNotification(ka,Va)}amg(){this.zEd.onContentChanged()}oAh(ka,Va){var vb,Wb;switch(ka){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.Gwo(Va);case "OnContentFilterUpdate":return!(null===(Wb=(vb=this.zEd).isContentInFilterUpdateDiff)||void 0===Wb?0:Wb.call(vb,Va.id));default:return!0}}Gwo(ka){return this.ih.Z_k?!ka.done&&this.lp.$ga(ka)===this.zEd.isContentInFilteredContent(ka.id):this.lp.$ga(ka)===
this.zEd.isContentInFilteredContent(ka.id)}static getInstance(){return fj.Rl()}static Rl(){fj.Lg||(fj.Lg=new fj(V.App.Gna(),new W.a(()=>V.App.ya.gb.Uc.od),K.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,K.a.instance.resolve("Common.Comments.ICommentModel"),K.a.instance.resolve("Common.Comments.ICommentPane"),jd.getInstance(),z.AFrameworkApplication.va,new W.a(()=>Uc.a.instance),Jd.FocusManager.instance(),K.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),
K.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),K.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),K.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),K.a.instance.resolve("WordEditor.Comments.CommentsSettings"),K.a.instance.resolve("Common.Utils.IAriaNotifier"),K.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),K.a.instance.resolve("WordEditor.Comments.CommentsState"),K.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),
xe.App.Ln.gb.wc,V.App.ya.Fq,K.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),K.a.instance.Sa("WordEditor.HeaderFooter.HeaderFooterControlOwner"),K.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),K.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),K.a.instance.Sa("WordEditor.Extension.RichApiEventManager"),K.a.instance.Sa("WordEditor.Indicator.TopLevelOutlineElementCache")),fj.Lg.qOb=!0);return fj.Lg}}fj.Lg=null;Object(e.a)(fj,
"EditorCommentManager",Uf.a,[617,618,619,9]);var Mh=c(1739);class Ef{constructor(ka,Va,vb,Wb){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=ka;this.body=Va;this.confirmButton=vb;this.cancelButton=Wb}}Object(e.a)(Ef,"ViewContainerModalDialogStrings",null,[]);var hk=c(307);c(1467);class $h{constructor(ka,Va){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=
ka;this.canvasContextId=Va}}Object(e.a)($h,"CommentUIAction",null,[]);var km=c(1046);class de{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd,Id,Ve,mf,fg,Dg,Zf,Ci,og,cl){this.ga=ka;this.hg=Va;this.ae=vb;this.Ub=Wb;this.$o=nc;this.Jh=Qc;this.R2=Hd;this.tra=xd;this.Dxd=Id;this.FWe=Ve;this.Hb=mf;this.UP=fg;this.ih=Dg;this.rj=Zf;this.cTb=Ci;this.P1=og;this.gka=cl;this.Cve=this.$i=null;this.cfh=this.xKg=!1;this.izc=null;this.iuo=(ik,uj,ti)=>2!==ti||this.rj.dY?1===ti?32:2:(this.P1.s9("OnCommentInit",Object.assign(new yo.a,
{hGa:()=>{this.ga.processAction(tf.a.NY,2)}})),32);this.Mpi=(ik,uj,ti)=>1!==ti||this.rj.dY?2:8;this.tpk=(ik,uj,ti)=>{if(1===ti)return!this.mjb()||this.ndb?8:this.rj.dY?2:32;if(!this.rj.dY)return this.ndb=!0,this.P1.s9("OnCommentInit",Object.assign(new yo.a,{hGa:()=>{this.Uq||this.rj.Zm||this.ga.processAction(tf.a.NY,2)}})),32;this.Uq||this.rj.Zm||this.ga.processAction(tf.a.NY,2);(this.Uq||this.rj.Zm)&&this.Ub.mg(this.rj.Zm?ug.AFrame.Gr:ug.AFrame.qM);return 2};this.Ihl=(ik,uj,ti)=>1===ti&&vc.SessionStatusManager.instance.wj?
8:2;this.fml=(ik,uj,ti,Yo)=>1!==Yo||(this.Uq||this.isVisible)&&this.$i.model.$s?ik||this.$i.model.$s?32:8:8;this.sib=(ik,uj,ti,Yo,wh)=>{if(1===ti||!this.rj.Zm)return 32;if(!this.Uq&&2===ti&&(2===this.$i.mode||3===this.$i.mode))return wh=new Ef(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),this.Dxd.invokeModalConfirmationDialog(()=>{this.Fkn(ik,uj,ti,Yo)},()=>{this.Kjn()},wh),32;this.$Ud();
if(this.Uq)return 32;wh&&this.JUh();return 32};this.eMb=(ik,uj,ti,Yo,wh)=>{if(1===ti)return 32;wh[hk.a.On]=this.isVisible;return 32};this.boc=this.f7k()}get isVisible(){return this.rj.Zm}get ndb(){return this.xKg}set ndb(ka){this.xKg=ka}get joo(){return"SharedCommentsTaskPaneProps"}get F0c(){return null}get uPi(){return null}get bF(){return this.$o}get wca(){return null}get W_k(){return this.tra}get Uq(){try{return this.ih.Uq}catch(ka){return!1}}Bai(){return new al(z.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,
z.AFrameworkApplication.uiCulture,z.AFrameworkApplication.dataCulture)}f7k(){const ka=new cm.a,Va=new $h(tf.a.newComment,zh.a.frame);Va.preCallback=this.tpk;const vb=new $h(Sg.a.MQf,zh.a.frame),Wb=new $h(Sg.a.x_f,zh.a.frame),nc=new $h(Sg.a.deleteComment,zh.a.frame);nc.preCallback=this.Ihl;nc.postCallback=this.fml;this.Uq&&(vb.preCallback=this.Mpi,Wb.preCallback=this.Mpi);const Qc=new $h(tf.a.NY,zh.a.frame);Qc.preCallback=this.iuo;ka.Z(6,Qc);ka.Z(0,Va);ka.Z(1,vb);ka.Z(2,Wb);ka.Z(3,nc);return ka}Enj(ka){this.cfh||
(this.Nkk=this.zRd(),this.R2.KNa(),this.wno(),this.sno(ka),this.cfh=!0)}sno(ka){this.$i=ka;this.Cve=ka.s9b;this.$i.PWh=this.tra}initialize(ka){this.Enj(ka);this.Tb()}Nzf(){this.izc&&this.Ub.mg(ug.AFrame.Gr);this.ndb&&!this.Uq?(this.ga.processAction(tf.a.newComment,2),this.ndb=!1):this.rj.Heb&&tg.a.Z2(z.AFrameworkApplication.nc,()=>{const ka=this.rj.Heb.commentId,Va=this.rj.Heb.wVc;this.ga.Qb(Sg.a.selectComment,2,Object.assign(new Ik.a,{commentId:ka,C9:1,GR:!0,CTc:Va}));Va&&(tg.a.Z2(z.AFrameworkApplication.nc,
()=>{this.Ub.mg(ug.AFrame.Gr)},sg.a.pag),re.a.instance.rf(Of.a.COh,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-z.AFrameworkApplication.QW);this.rj.Heb=null},sg.a.X$n)}dispose(){}h5(){}selectComment(){this.isVisible||this.Uq||this.frj();this.Jh.updateCommandUI(!0)}Tb(){this.ga.qa(tf.a.sib,zh.a.frame,this.sib);this.ga.fb(tf.a.eMb,zh.a.frame,this.eMb,96)}g4a(){-1!==this.$i.mode&&(this.$i.mode||this.JUh())}JUh(){const ka=
this.$i,Va=ka.lp,vb=Va.GQd(),Wb=Va.fof(this.ih.WOb&&this.ih.Uq&&!this.rj.Zm);this.tra.hbo(Wb.length,vb,!ka.mode,vb?5:1);this.tra.Gbo(Wb,Va.aVa)}wno(){const ka=this.Ub.ge(ug.AFrame.Gr);ka.parent=ug.AFrame.rp;ka.OH=!0;ka.$4c=!0;ka.jUa=!0;ka.RYa((Va,vb)=>{Le.a.nAh(vb.name)&&(this.rj.aKb=tg.a.Z2(this.Hb,()=>{vb.name!==ug.AFrame.qM&&2!==this.$i.mode&&3!==this.$i.mode&&(this.$i.clearSelection(),this.Jh.updateCommandUI(!0));this.rj.aKb=null},sg.a.ukn))});this.$o.dT(ug.AFrame.Gr);if(this.ih.yzb)for(const Va of Hh.t)ka.bindAction(pd.KeyInputManager.AG(Va),
Sg.a.K4e)}fgo(){this.izc&&this.FWe.REl()}kCh(){this.r2j&&this.fgo()}Fkn(ka,Va,vb,Wb){const nc=this.$i,Qc=nc.lp.ny;Qc&&Qc.gz?nc.g8e.endCommentSession(Qc.gz.draftId):a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.sib(ka,Va,vb,Wb,!0);tg.a.Z2(this.Hb,()=>{this.Jh.updateCommandUI(!0)},sg.a.X6n)}Kjn(){this.izc&&this.Ub.mg(ug.AFrame.Gr);this.Jh.updateCommandUI(!0)}UGa(ka){ka.ir(this.Ub.nW);ka.ir(this.Ub.oW)}NOb(ka,Va,vb){if(1===vb)return 32;this.frj();return 32}frj(){this.isVisible||
(this.rj.dY?(this.enl(),this.rj.Zm=!0,this.P1.Sbe(),this.Ub.aDc(ug.AFrame.Gr),this.Uq&&this.ih.WOb&&this.$i.vMb(this.$i.model.Lnf(()=>!0)),this.r2j=!0,Pb.UISurfaces.zu().then(ka=>{ka.showTaskPane(gk.a.JEd,this.Nkk);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.$i.mec(null),this.Jh.updateCommandUI(!0),this.UGa(this.Ub.ge(ug.AFrame.Gr)),this.P1.s9("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):this.P1.s9("OnCommentInit",
Object.assign(new yo.a,{hGa:()=>{this.rj.Zm||this.ga.processAction(tf.a.NY,2)}})))}enl(){this.ga.Qb(Sg.a.y3,2,null);this.ga.Qb(Sg.a.zT,2,null)}mjb(){return this.gka.mjb(this.ga,!1)}Qyb(){}show(){this.isVisible||this.ga.processAction(tf.a.NY,2)}editComment(){return 2}$Ud(){this.$i.paneClosing();this.rj.Zm=!1;if(this.Uq&&this.ih.WOb){const Va=this.$i.model;this.$i.vMb(Va.Lnf(vb=>Va.$ga(vb)))}var ka=Jd.FocusManager.instance();ka.currentScope&&ka.currentScope.name===ug.AFrame.Gr&&ka.mg(this.Uq&&(2===
this.$i.mode||3===this.$i.mode||this.$i.Dj.$s)?ug.AFrame.qM:ka.wT);this.$o.Rw(ug.AFrame.Gr);this.Ub.GIc(ug.AFrame.Gr);Pb.UISurfaces.zu().then(Va=>{Va.hideTaskPane(gk.a.JEd,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.Uq&&(ka=this.$i.model.$s)&&this.WRo(ka);this.P1.s9("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}WRo(ka){ka.done?this.$i.clearSelection():this.cTb.LUh(ka)}Ksn(ka=null){this.FWe.Ymj(3);this.Nzf();
if(ka){this.kCh();Bc.a.Z3f(ka,[Ee.a.contextMenu]);const Va=this.Ub.ge(ug.AFrame.Gr);this.hg.S_b(ug.AFrame.Gr,ka,Va.jUa)}}rqn(ka){this.$o.CI(ug.AFrame.Gr);1!==ka&&tg.a.Z2(z.AFrameworkApplication.nc,()=>{this.Ub.cD(ug.AFrame.Gr)},sg.a.pag)}onTaskPaneClose(){this.rj.dY&&this.FWe.Ymj(1)}zRd(){const ka={type:this.joo,Pdp:this.kCh};return Object.assign(new km.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:ka,hideHeader:!1,width:300,location:2,onOpen:Va=>{this.izc=Va;this.Ksn(Va);this.UP.zjg(!0)},
onClose:()=>{this.izc=null;this.ga.Qb(tf.a.sib,2,!0);this.Jh.updateCommandUI(!0);this.onTaskPaneClose();this.UP.zjg(!1)},onShow:Va=>{this.rqn(Va)}})}NY(){return 32}}Object(e.a)(de,"OfficeSharedCommentPane",null,[9,611,612]);var ke=c(1656),Cc=c(175);class Rh{constructor(ka,Va){this.containerType="full-pane";this.identifier=null;this.ga=ka;this.identifier=Va}openView(){this.ga.processAction(tf.a.NOb,2)}closeView(){this.ga.Qb(tf.a.sib,2,!0)}invokeModalConfirmationDialog(ka,Va,vb){const Wb=new Cc.StandardDialog;
vb&&vb.title&&vb.body&&vb.confirmButton&&vb.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),vb=new Ef("","","",""));Wb.Ad=1;Wb.Ee(1,vb.confirmButton);Wb.Ee(0,vb.cancelButton);Wb.Gu(vb.title,vb.body,1,nc=>{1===nc?ka():Va()})}}Object(e.a)(Rh,"ViewContainerAPI",null,[602,603]);class Bi{constructor(ka,Va,vb){this.wJo=ka;this.ai=Va;this.lIa=vb;this.kd=new na.a;this.wJo.execute(Wb=>{this.lIa.Ace("OnBeforeTrackChangeMarkupViewChange",(nc,
Qc)=>{Qc&&Qc.BQf!==Wb.Ej&&this.kd.raiseEvent("OnBeforeTrackChangeMarkupViewChange",Qc)});this.lIa.Ace("OnAfterTrackChangeMarkupViewChangeEventKey",(nc,Qc)=>{Qc&&Qc.Ej===Wb.Ej&&(uf.a.Ej=Wb.Ej,this.kd.raiseEvent("OnAfterTrackChangeMarkupViewChange",Qc))})})}u9(ka,Va){this.kd.addHandler(ka,Va)}s9(ka,Va){this.kd.raiseEvent(ka,Va)}Sbe(){this.ai.E2f||(this.ai.E2f=!0,this.kd.raiseEvent("OnCommentRenderedOnce"))}}Object(e.a)(Bi,"WordCommentEventsActor",null,[]);var sn=c(1797);class uh{constructor(){this.insertIndex=
0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(e.a)(uh,"InitCommentSessionResult",null,[]);class Wh extends uh{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(e.a)(Wh,"BeginDraftingHostResult",uh,[]);var Dn=c(2041),Lk=c(2002),pp=c(1031);class fm{constructor(ka,Va,vb,Wb,nc,Qc,Hd,xd,Id,Ve,mf,fg,Dg,Zf,Ci){this.taskManager=ka;this.tra=Va;this.TTj=vb;this.CKo=Wb;this.o8e=nc;this.hs=Qc;this.it=Hd;this.xg=xd;this.V0=Id;
this.pc=Ve;this.Jk=mf;this.g_=fg;this.ai=Dg;this.z0k=Zf;this.x0k=Ci;this.CXb=this.G6=this.Hm=null;this.IYj="WordWebCommitNewCommentActivity";this.JYj="WordWebCommitTaskActivity";this.FYj="WordWebCommentReactionActivity";this.$Og=null}get gka(){return this.G6}iEn(ka){var Va;const vb=this.gka.ny,Wb=this.G6.xO();if(Wb&&vb){const nc=pp.a.vgb(null!==(Va=vb.authorId)&&void 0!==Va?Va:"");Va=new sn.a(vb.authorId,vb.e1b,vb.author,null!==nc&&void 0!==nc?nc:"",!0);ka.author=Va;ka.insertIndex=Array.indexOf(Wb,
vb);ka.authorName=vb.author;ka.authorIdentity="";return null}return tg.a.ED(-2130915320)}initialize(ka,Va,vb,Wb){this.Hm=ka;this.G6=Va;this.CXb=vb;this.$Og=Wb}beginDraftingAsync(ka){if(!ka)return new Promise((Wb,nc)=>{nc(tg.a.ED(-2130915327))});const Va=new Wh,vb=th.a.Nqf(ka.sessionType);return void 0===vb||null===vb?new Promise((Wb,nc)=>{nc(tg.a.ED(-2130915317))}):new Promise((Wb,nc)=>{tg.a.Z2(this.taskManager,()=>{if(1!==this.Hm.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",
this.Hm.mode),nc(tg.a.ED(-2130915325));else{this.IBh();try{switch(vb){case 0:if(!this.Hm.wca.mjb()){nc(tg.a.ED(-2130915326));return}this.z0k.YUd();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${ka.draftId}`);this.Hm.Qyb(ka);break;case 1:if(!ka.threadId||""===ka.threadId){nc(tg.a.ED(-2130915324));return}if(this.hs.Xeg){const xd=this.G6.KD(ka.threadId);if(xd){const Id=this.G6.F5h(xd,!1),Ve=Dn.a.FDb(xd,Id,xd.authorId===this.hs.zY);Ve&&this.o8e.invoke(ka.threadId,Ve)}else a.ULS.sendTraceTag(579170962,
327,10,"Smart reply provider not invoked since comment is null",this.Hm.mode)}this.Hm.addReply(ka.threadId,ka);break;case 3:if(!ka.threadId||""===ka.threadId){nc(tg.a.ED(-2130915324));return}var Qc=this.G6.KD(ka.threadId);if(!Qc){nc(tg.a.ED(-2130915323));return}this.Hm.editComment(Qc,ka);break;case 2:if(!ka.commentId||""===ka.commentId){nc(tg.a.ED(-2130915324));return}const Hd=this.G6.KD(ka.commentId);if(!Hd){nc(tg.a.ED(-2130915323));return}this.Hm.editComment(Hd,ka)}}catch(Hd){nc(Hd);this.zcj();
a.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${Hd} on Session ${vb}`);return}(Qc=this.iEn(Va))?nc(Qc):Wb(Va);this.zcj()}},sg.a.beginDraftingAsync)})}commit(ka,Va,vb){const Wb=this.gka.ny;if(!Wb)throw tg.a.ED(-2130915320);var nc=Wb.gz;if(!nc)throw tg.a.ED(-2130915320);const Qc=th.a.Nqf(nc.sessionType);if(void 0===Qc||null===Qc)throw tg.a.ED(-2130915317);if(ka!==nc.draftId)throw tg.a.ED(-2130915327);let Hd=!1,xd=!1;nc=!1;switch(Qc){case 3:if(!vb)throw tg.a.ED(-2130915327);break;case 0:this.Jk.ie(()=>
{if(!this.Hm.wca.mjb())throw tg.a.ED(-2130915326);Wb.text=[Va];this.Hm.hA&&!this.ai.Zm?this.Hm.Mzn(()=>{this.Hm.jua(Wb);this.Hm.asl(ka,Wb.id)}):this.Hm.jua(Wb);xd=vb&&null!=vb.Task;Hd=this.Hm.hA;tg.a.Z2(this.taskManager,()=>{this.Tnb(Wb.id)},sg.a.Tnb)},"WESCA:C:C");break;case 1:this.Jk.ie(()=>{Wb.text=[Va];this.Hm.jua(Wb);xd=vb&&null!=vb.Task;Hd=this.Hm.hA},"WESCA:C:R");break;case 2:this.Jk.ie(()=>{Wb.text=[Va];this.Hm.Jeb(Wb);this.S2i(Sg.a.f0m)},"WESCA:C:E");break;default:throw tg.a.ED(-2130915322);
}vb&&(vb.Resolve&&(this.tjj(Wb,vb.Resolve.isResolved),vb.Resolve.isResolved&&!this.ai.Zm&&this.Hm.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),vb.Task&&this.Hm.Z0k(Wb,vb.Task),vb.Reaction&&(nc=this.hs.F0k,vb.Reaction.isActive?this.Hm.Lyd(Wb,vb.Reaction.reactionType):this.Hm.Pce(Wb,vb.Reaction.reactionType)));this.hs.R0k&&xd&&this.V0.execute(Id=>Id.logActivity(this.JYj,"CommentsTasksFpsIsEnabled"));Hd&&this.V0.execute(Id=>{Id.logActivity(this.IYj,"CommentsFpsIsEnabled")});nc&&this.V0.execute(Id=>
{Id.logActivity(this.FYj,"CommentReactionsFpsIsEnabled")});return Wb.id}endCommentSession(ka){const Va=this.gka.ny;if(Va){if(Va.gz&&Va.gz.draftId!==ka)throw tg.a.ED(-2130915327);if(Va.Tq===Qd.a.beingCreated)this.Hm.deleteComment(Va),!this.Hm.hA||Va.Df||this.ai.Zm||this.xg.mg(ug.AFrame.Pn);else{if(3!==this.Hm.mode){a.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");return}Va.Tq=Qd.a.normal;Va.KSa=Lk.a.succeeded;Va.gz=null;this.Hm.E5e()}}this.it&&
this.it.updateCommandUI(!0);this.gka.GQd()||this.tra.wmg(1,!this.Hm.mode)}deleteComment(ka){(ka=this.G6.KD(ka))?(this.Hm.deleteComment(ka),this.Hm.hA&&!this.ai.Zm?ka.Df||this.xg.mg(ug.AFrame.Pn):this.xg.cD(ug.AFrame.Gr),this.CKo.mdg(ka)&&this.S2i(Sg.a.yIi)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(ka){this.Tnb(ka,0)}highlightComment(ka){this.Hm.mec(ka,0)}setThreadResolvedState(ka,Va){(ka=this.G6.KD(ka))&&this.tjj(ka,Va)}tjj(ka,Va){if(ka.Df&&""!==
ka.Df)throw tg.a.ED(-2130915321);this.Hm.iAb(ka,Va);Va&&!this.ai.Zm&&this.xg.mg(ug.AFrame.Pn)}presentLinkToComment(ka){var Va=this.G6.KD(ka);Va?(Va=this.gka.JOd(Va))?(ka={["nav"]:btoa(`{"${Al.a.comment}":${Va}}`),["mode"]:"copy"},this.x0k.Hv(Sg.a.presentLinkToComment),this.pc.Qb(tf.a.Z7,2,ka,{["ControlId"]:"CopyLinkToComment"})):a.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",ka):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",
ka)}selectFirstThreadInNextCommentContext(){this.Hm.bhj(0)}selectLastThreadInPreviousCommentContext(){this.Hm.fao()}registerForCommentEvents(ka){const Va=this.gka.fof(this.hs.WOb&&this.hs.Uq&&!this.ai.Zm),vb=this.gka.aVa,Wb=this.gka.GQd(),nc=!this.Hm.mode;this.tra.oko();this.$Og.H1l().then(Qc=>{this.tra.sUn(ka,Va,Wb,nc,vb,Qc);this.tra.wmg(Wb?5:1,nc);this.it&&this.it.updateCommandUI(!0)})}unregisterForCommentEvents(ka){this.tra.qQb(ka)}registerForAction(ka,Va){this.TTj.jSa(ka,Va)}unregisterForAction(){}checkAtMentionCapability(){return this.CXb?
this.CXb.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(ka=>{ka(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}IBh(){const ka=this.Hm.hA&&!this.ai.Zm?ug.AFrame.qM:ug.AFrame.Gr;if(ka===ug.AFrame.Gr){if(!this.ai.Zm)return;Pb.UISurfaces.zu().then(Va=>{Va.setSelectedTaskPane(gk.a.JEd);return null})}this.xg.cD(ka)}Tnb(ka,Va=1){this.IBh();
this.g_.Vgj(ka,Object.assign(new Ik.a,{C9:Va,GR:1===Va}))}zcj(){this.Hm.wca.ndb&&(this.Hm.wca.ndb=!1)}S2i(ka){this.pc.processAction(ka,2)}}Object(e.a)(fm,"WordEditorSharedCommentAPI",null,[600,601]);class Ag{constructor(ka,Va,vb,Wb,nc,Qc,Hd=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ka;this.parentId=Va;this.commentBody=vb;this.author=Wb;this.date=nc;this.commentFlags=Qc;this.usersByReactionType=Hd}}
Object(e.a)(Ag,"OfficeSharedCommentModel",null,[]);c(1640);class We{constructor(ka,Va){this.Ma=ka;this.C3a=Va;this.Kmh="AD";this.$pc=new O.a;this.qWe=new O.a;this.XGk=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.XOg=new Zg.a}get userPrincipalName(){return this.Ma.jb("UserPrincipalName")}get Z4a(){return this.Ma.jb("PresenceProvider")}get zY(){return this.Ma.jb("PresenceUserId")}get uj(){return this.C3a.value}lQi(ka){const Va=this.XGk.exec(ka);return Va?Va[1]:ka}Qfi(ka,Va=!1){let vb=0;ka.done&&(vb=ka.Df&&
""!==ka.Df?vb|4:vb|8);ka.OHh&&(vb|=2);Va&&(vb|=1);this.mdg(ka)&&(vb|=16);ka.yEf&&(vb|=32);this.mpm(ka)||(vb|=128);return vb}mpm(ka){return ka?(ka=this.uj.Db(ka.objectId))?ka.hasProperty(ma.a.z7):!1:!1}mdg(ka){if(!ka)return!1;if(void 0===ka.authorId||null===ka.authorId||""===ka.authorId)return this.LKf(ka.id,ka.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.zY||null===this.zY||""===this.zY)return this.LKf(ka.id,ka.objectId,"PresenceUserId null or empty"),!1;if(this.zY==ka.authorId&&
ka.e1b==this.Z4a)return!1;const Va=this.fLd(ka.authorId),vb=this.fLd(this.zY);if(this.Z4a===this.Kmh&&Va&&vb&&Va[0]!=this.userPrincipalName&&Va[1]!=vb[1])return!0;this.LKf(ka.id,ka.objectId,"Unknown");return!1}isCurrentUser(ka){if(!ka||void 0===ka.authorId||null===ka.authorId||""===ka.authorId||void 0===this.zY||null===this.zY||""===this.zY)return!1;if(this.zY==ka.authorId&&ka.e1b==this.Z4a)return!0;ka=this.fLd(ka.authorId);const Va=this.fLd(this.zY);return this.Z4a===this.Kmh&&ka&&Va?ka[0]==this.userPrincipalName||
ka[1]==Va[1]:!1}fLd(ka){if(void 0===ka||null===ka)return null;ka=ka.split("::");return 3===ka.length?ka.slice(1,3):null}LKf(ka,Va,vb){ka&&!this.XOg.contains(ka)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${Va}; reason: ${vb}`),this.XOg.add(ka))}I1h(ka,Va){var vb;if(!ka)return null;const Wb=ka.ZZd;let nc=!1;1===Va&&(nc=!0);Va=ka.author?this.lQi(ka.author):"";const Qc=pp.a.vgb(null!==(vb=ka.authorId)&&void 0!==vb?vb:"");vb=new sn.a(ka.authorId?ka.authorId:"",ka.e1b,
Va,null!==Qc&&void 0!==Qc?Qc:"",this.isCurrentUser(ka));return new Ag(ka.id?ka.id:"",ka.Df?ka.Df:"",ka.text&&ka.text.length?ka.text[0]:null,vb,ka.date||Wb?ka.date:new Date,this.Qfi(ka,nc),this.Sfi(ka.usersByReactionType))}hHl(ka,Va,vb){const Wb=[],nc=new O.a;if(!ka)return Wb;for(const Qc of ka)Qc.Tq!==Qd.a.beingCreated&&vb(Qc)&&(Qc.id&&this.$pc.nb(Qc.id)?(ka=this.$pc.J(Qc.id),ka=this.qal(Qc,ka,Va),Wb.push(ka),nc.Z(Qc.id,ka)):Qc.id?(ka=this.I1h(Qc,Va),Wb.push(ka),nc.Z(Qc.id,ka)):a.ULS.sendTraceTag(50667679,
327,10,"CommentId should not be null"));this.$pc=nc;return Wb}nNl(ka,Va,vb){const Wb=[];for(const nc of ka)nc.Tq!==Qd.a.beingCreated&&vb(nc)&&(nc.id&&this.$pc.nb(nc.id)?Wb.push(this.$pc.J(nc.id)):nc.id&&Wb.push(this.I1h(nc,Va)));return Wb}qal(ka,Va,vb){var Wb=ka.ZZd,nc=1===vb;vb=ka.Df?ka.Df:"";const Qc=ka.text&&ka.text.length?ka.text[0]:null,Hd=ka.author?this.lQi(ka.author):"",xd=ka.authorId?ka.authorId:"",Id=ka.e1b?ka.e1b:"",Ve=pp.a.vgb(xd);Wb=ka.date||Wb?ka.date:new Date;nc=this.Qfi(ka,nc);const mf=
this.isCurrentUser(ka),fg=this.Sfi(ka.usersByReactionType);return Va.parentId===vb&&Va.commentBody===Qc&&Va.author.DisplayName===Hd&&Va.author.UserId===xd&&Va.author.Provider===Id&&Va.author.IsCurrentUser===mf&&Va.date===Wb&&Va.commentFlags===nc&&this.zFk(Va.usersByReactionType,fg)?Va:(Va=new sn.a(xd,Id,Hd,null!==Ve&&void 0!==Ve?Ve:"",mf),new Ag(ka.id,vb,Qc,Va,Wb,nc,fg))}zFk(ka,Va){if(!ka&&!Va)return!0;if(!Va||!ka)return!1;var vb=Object.keys(ka);if(vb.length!==Object.keys(Va).length)return!1;for(const Wb of vb){if(!(Wb in
Va))return!1;vb=ka[Wb];const nc=Va[Wb];if(vb.length!==nc.length)return!1;for(let Qc=0;Qc<vb.length;Qc++)if(!this.nFk(vb[Qc],nc[Qc]))return!1}return!0}nFk(ka,Va){return ka||Va?ka&&Va&&ka.UserId===Va.UserId&&ka.Provider===Va.Provider&&ka.Email===Va.Email&&ka.DisplayName===Va.DisplayName&&ka.IsCurrentUser===Va.IsCurrentUser?!0:!1:!0}Sfi(ka){if(!ka)return null;const Va={},vb=this.Ma.jb("PresenceUserId");for(const nc of Object.keys(ka)){const Qc=[];var Wb=ka[nc];for(const Hd of Wb){Wb=Hd.UserId===vb;let xd;
this.qWe.nb(Hd.UserId)?(xd=this.qWe.J(Hd.UserId),xd.IsCurrentUser=Wb):(xd=new sn.a(Hd.UserId,Hd.Provider,Hd.DisplayName,Hd.Email,Wb),this.qWe.add(Hd.UserId,xd));Qc.push(xd)}Va[nc]=Qc}return Va}}Object(e.a)(We,"WordEditorSharedCommentModelTranslator",null,[599]);class Re{constructor(){this.kn=null;this.oed=this.Fah=this.CLg=this.Phh=this.Fkh=this.o7g=this.Gch=!1}Rfi(){this.kn||(a.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.emj());
return this.kn}H1l(){return new Promise((ka,Va)=>{this.oed?ka(this.abi()):this.Sij().then(()=>{ka(this.abi())}).catch(vb=>{Va(vb)})})}abi(){this.oed||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ka;ka=33;this.CLg&&(ka|=2);this.Gch&&(ka|=8);this.Fkh&&(ka|=16);this.o7g&&(ka|=4);this.Phh&&(ka|=64);this.Fah&&(ka|=128);return ka}}Object(e.a)(Re,"OfficeSharedCommentsAppCapabilities",null,
[884]);class sf extends Re{constructor(ka){super();this.kXa=null;this.ih=ka;this.ylo();this.emj()}ylo(){this.Phh=this.ih.GPb;this.Fkh=!1;this.Fah=this.o7g=this.Gch=!0}initialize(ka){this.kXa=ka;this.Sij()}emj(){this.kn={};this.kn.LivePersonaPicker="true";this.kn.PersonaColor="true";this.kn.DiscreteHostedComments=this.ih.Fml.toString();this.kn.NewCommentButton="true";this.kn.DisabledChangeGates="WebThemeIntegrationHighContrastFixes,"+this.ih.yml;this.kn.CommentsFluentUI="true";this.kn.CommentTasks=
this.ih.GPb.toString();this.kn.CommentTasksFromReply=this.kn.CommentTasks;this.kn.CommentsFluentUIV2="true";this.kn.CommentFriendlyTimestamps=this.ih.$_k.toString();this.kn.AtMentionFloodgateSurvey=this.ih.uGk.toString();this.kn.HyperlinksInComments="true";this.kn.NewModelState="true";this.kn.LogDraftCommentIdPair="true";this.kn.RichTextFormattingInWeb=this.ih.yzb.toString();this.kn.NoDiscardOnFocusLoss="true";this.kn.NewResolvedCardDesignInWeb="true";this.kn.RichContentEditIntegration="true";this.kn.HyperlinksWithDisplayText=
"true";this.kn.SmartReplies=this.ih.Xeg.toString();this.kn.NewBorderAndFocusLookInWeb="true";this.kn.LinkToComment="true";this.kn.TaskPaneWithNewInfrastructure="true";this.kn.CommentReactions="true";this.kn.WebThemeIntegration="true";this.kn.NewSelectionInteractions="true";this.kn.QuillInitializationTelemetry="true";this.kn.PersonaIconImageForWeb="true";this.kn.HighlightsAndFontColorInWebComments="true";this.kn.TruncationUIWithReadMoreText="true";this.kn.CtrlEnterTip="true";this.kn.AtMentionHintMessage=
"true";this.kn.LivePersonaCardForWeb=this.ih.MYm.toString();this.kn.TaskHistoryRecordIDs=this.ih.nFo.toString();this.kn.ContentNavigation=this.ih.contentNavigationApiEnabled.toString()}Sij(){return new Promise((ka,Va)=>{this.kXa?this.kXa.atMentionsEnabledAsync().then(vb=>{this.CLg=vb;this.oed=!0;ka(this.oed)}):(a.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),Va(tg.a.ED(-2130915320)))})}}
Object(e.a)(sf,"WordSharedCommentsAppCapabilities",Re,[597]);class zi{constructor(){this._initialized=!1;this.Q0k={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:qf.a.hjf,vetoPillar:7};this.uFo={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:ke.a.hjf,vetoPillar:7}}get K4a(){return null!=this.yEg?this.yEg:this.yEg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}TZ(ka){this.K4a.TZ(Sl.a.comments,ka,!0)}get name(){return"WordEditor.Comments"}xc(ka){this.W=
ka;this.TZ("CPConfigStart");ka.ha("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new Cg.a(n.Health.instance,new yg.a,this.Q0k)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").singleInstance();ka.ha("WordEditor.Comments.ITasksUsageAndHealthLogger",()=>new Cg.a(n.Health.instance,new yg.a,this.uFo)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").singleInstance();ka.ha("WordEditor.Comments.CommentNodeTracker",()=>new Cf(this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").singleInstance();
ka.ha("WordEditor.Comments.CommentsSettings",()=>new gf(z.AFrameworkApplication.K,this.W.resolve("Box4.IFeatureHelper"),new W.a(()=>V.App.ya.gb.Uc),new W.a(()=>Bh.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").singleInstance();ka.ha("WordEditor.Comments.CommentsState",()=>new uf.a).singleInstance();ka.ha("WordEditor.Comments.WordCommentEventsActor",()=>new Bi(ka.Sa("Box4.TrackChange.ITrackChangeManager"),
ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).singleInstance();ka.ha("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new We(z.AFrameworkApplication.K,new W.a(()=>V.App.ya.gb.Uc.od))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").singleInstance();ka.ha("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new Hb(ka.resolve("WordEditor.Comments.CommentsSettings"),ka.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Comments.ICommentFormatTranslator").singleInstance();
ka.ha("Common.Comments.OfficeSharedCommentsEventHost",()=>new Qg(z.AFrameworkApplication.nc)).as("Common.Comments.IOfficeSharedCommentsEventHost").singleInstance();ka.ha("WordEditor.Comments.CommentActionInTypingRecorder",()=>new Sj(this.W.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").singleInstance();ka.ha("WordEditor.Comments.EditorCommentModel",Mh.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").singleInstance();
ka.ha("WordEditor.Comments.ICommentModelBootLoader",()=>new rk(new W.a(()=>V.App.ya.gb.Uc),new W.a(()=>Bh.a.instance),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.Comments.CommentsSettings"),ka.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));ka.ha("WordEditor.Comments.ICommentFilterActor",()=>new Jc(ka.resolve("WordEditor.Comments.IEditorCommentModel"),
z.AFrameworkApplication.K,ka.resolve("WordEditor.Comments.WordCommentEventsActor"))).singleInstance();ka.resolve("WordEditor.Comments.ICommentFilterActor");ka.ha("WordEditor.Comments.CommentHighlightOnRestActor",()=>new fl(new W.a(()=>V.App.ya.gb.Uc),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.WordCommentEventsActor"),ka.resolve("Box4.INotebookManager").Bl,R.a.instance,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),
ka.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").singleInstance();ka.ha("WordEditor.Comments.CommentHighlightUtils",()=>new $k(ka.resolve("Box4.Highlight.IHighlightManager"))).singleInstance();ka.ha("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new qj(ka.resolve("WordEditor.Comments.CommentHighlightUtils"))).singleInstance();ka.ha("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new qk(ka.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),
ka.resolve("WordEditor.Comments.CommentHighlightUtils"),z.AFrameworkApplication.ta.f1,z.AFrameworkApplication.ta.eIa,z.AFrameworkApplication.va,z.AFrameworkApplication.nc,ka.resolve("WordEditor.Comments.CommentsState"),ka.Sa("WordEditor.Comments.IEditorCommentManager"))).singleInstance();ka.ha("WordEditor.Comments.CommentHighlightActor",()=>new kf(new W.a(()=>V.App.ya.gb.Uc.od),ka.resolve("WordEditor.CommentsInteractive.ICommentEditor"),ka.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),
ka.Sa("WordEditor.Comments.IEditorCommentManager"),R.a.instance,ka.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),ka.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),ka.resolve("WordEditor.Comments.CommentHighlightUtils"),ka.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").singleInstance();ka.ha("WordEditor.Comments.CommentHintActor",()=>new jb(ka.resolve("WordEditor.Comments.CommentsSettings"),An.a.instance,Xj.a.instance,
Gk.a.instance,z.AFrameworkApplication.va,hd.TableCellReader.wLm,ql.moveToLastRenderedCellOfTheRow,new lg.a,ka.Sa("Box4.ContentControlConfigSettings"),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.ICommentHighlightActor"),ka.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").singleInstance();
ka.ha("WordEditor.Comments.CommentMarginEntryPointActor",()=>new Ph(An.a.instance,Gk.a.instance,z.AFrameworkApplication.va,ka.resolve("WordEditor.Comments.ICommentHintActor"),ka.Sa("Common.IZoomManager"))).singleInstance();ka.ha("WordEditor.Comments.ViewContainerAPI",()=>new Rh(z.AFrameworkApplication.va,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").singleInstance();ka.ha("Common.Comments.CommentActivationManager",()=>new dm).as("Common.Comments.ICommentActivationManager").singleInstance();
ka.ha("Common.Comments.ViewContainerEventHost",()=>new Pm(z.AFrameworkApplication.nc,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").singleInstance();ka.ha("WordEditor.Comments.CommentSmartReplyProvider",()=>new tb(this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").singleInstance();
ka.ha("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new sf(ka.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").singleInstance();this.TZ("CPConfigEnd")}init(){this.TZ("CPInitStart");this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>{try{this.fn(),this.TZ("CPInitEnd")}catch(ka){throw a.ULS.fE(524300632,327,10,ka,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",ka),this.K4a.vx(Sl.a.comments,
"CPInitException",ka,!0),ka;}})}fn(){const ka=this.W.resolve("WordEditor.Comments.CommentsSettings");this.TZ("onAfterGFNLoadedStart");this.W.ha("WordEditor.Comments.OfficeSharedCommentPane",()=>new de(z.AFrameworkApplication.va,z.AFrameworkApplication.ta.fD,z.AFrameworkApplication.ta.gD,z.AFrameworkApplication.ta.Bp,z.AFrameworkApplication.ta.jx,V.App.ya,Bn.a.instance,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.resolve("Common.Comments.IViewContainerEventHost"),
z.AFrameworkApplication.nc,this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ka,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").singleInstance();this.W.ha("Common.Comments.OfficeSharedCommentsActionHost",()=>new Qm(z.AFrameworkApplication.va,
this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane").boc)).as("Common.Comments.IOfficeSharedCommentsActionHost").singleInstance();this.W.ha("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new fm(z.AFrameworkApplication.nc,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.W.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),
ka,V.App.ya,z.AFrameworkApplication.ta.Bp,this.W.Sa("Common.ISystemInitiatedFeedback"),z.AFrameworkApplication.va,R.a.instance,this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").singleInstance();Uf.a.factory=fj.getInstance;this.W.ha("WordEditor.Comments.EditorCommentManager",
fj.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").singleInstance();this.W.ha("WordEditor.Comments.CommentFloatingContainerActor",()=>new Lc(this.W.resolve("WordEditor.Comments.CommentsState"),ka,this.W.resolve("WordEditor.Comments.IEditorCommentModel"),z.AFrameworkApplication.nc,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),
()=>document.querySelector(`#${Rj.AppFrame.rUa} .${ge.a.m4b}`),this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),z.AFrameworkApplication.ta.Bp)).as("WordEditor.Comments.ICommentFloatingContainerActor").singleInstance();const Va=this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"),vb=Va.trackChangeInSidetrackEnabled;vb&&this.W.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").$7i(this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));this.W.ha("WordEditor.Comments.FloatingCommentManager",
()=>new Af(this.W.resolve("WordEditor.Comments.IEditorCommentModel"),z.AFrameworkApplication.nc,R.a.instance,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),Va)).singleInstance();this.W.ha("WordEditor.Comments.IFloatingCommentManager",()=>vb?
this.W.resolve("WordEditor.Sidetrack.SidetrackManager"):this.W.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").singleInstance();this.W.ha("WordEditor.Comments.CommentSelectionActor",()=>new Xo(z.AFrameworkApplication.va,this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.ICommentHighlightActor"),jd.getInstance(),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
z.AFrameworkApplication.ta.Bp,this.W.resolve("WordEditor.Comments.CommentsState"),ka,new W.a(()=>Uc.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.Sa("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").singleInstance();this.W.ha("WordEditor.Comments.CommentInitActor",()=>new lj(this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),
this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),ka,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),jd.getInstance(),V.App.ya.Fq,z.AFrameworkApplication.va,this.W.resolve("Common.IDynamicScriptLoaderProvider").Kz,this.W.Sa("WordEditor.Comments.ICommentRibbonCommandHandler"),z.AFrameworkApplication.ta.Bp,this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),
this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),this.W.resolve("Common.Comments.ICommentActivationManager"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.Sa("Common.ISystemInitiatedFeedback"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.Sa("Common.App.SafeLinks.ISafeLinksManager"),this.W.Sa("Common.App.People.IExternalPeopleAPI"),this.W.resolve("Common.OfficeSharedCommentsTelemetry"),this.W.resolve("Common.Comments.IViewContainerEventHost"),
this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),Va,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.W.resolve("Box4.IPackageBootPerfLogger"),this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).singleInstance();this.W.ha("WordEditor.Comments.CommentsActionManager",
()=>new Gf(this.W.resolve("WordEditor.Comments.EditorCommentManager"),this.W.resolve("WordEditor.Comments.EditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentHintActor"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ka,this.W.resolve("Common.Comments.ICommentPane"),new W.a(()=>V.App.ya.gb.Uc.od),z.AFrameworkApplication.va,
new W.a(()=>Uc.a.instance),Jd.FocusManager.instance(),R.a.instance,this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"))).as("WordEditor.Comments.CommentsActionManager").singleInstance();this.W.resolve("WordEditor.Comments.CommentInitActor");ka.contentNavigationApiEnabled&&(this.W.ha("WordEditor.Comments.CommentContentProvider",()=>new Cn(this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.Comments.CommentsSettings"))).singleInstance(),this.W.ha("WordEditor.Comments.CommentContentActor",
()=>new Hi(this.W.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.CommentsState"))).singleInstance(),this.W.resolve("WordEditor.Comments.CommentContentProvider"),this.W.resolve("WordEditor.Comments.CommentContentActor"));const Wb=ka.Uq,nc=this.W.resolve("WordEditor.Comments.EditorCommentManager");
this.W.resolve("WordEditor.Comments.CommentsActionManager");nc&&Wb&&(this.W.resolve("WordEditor.Comments.CommentsState").jdb=zi.k4h(),ka.LBb||this.W.resolve("WordEditor.Comments.WordCommentEventsActor").s9("OnCommentInit"));zc.a.Q3m();ka.Z8b&&V.App.ya.gb.CVh();Uf.a.instance&&(ka.LBb||kl.a.get_instance().Dk(4,()=>{this.vkn(Wb)},11).continueWith(()=>{this.Nwm()}),this._initialized=!0);this.wSn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}Nwm(){this.W.resolve("WordEditor.Comments.WordCommentEventsActor").s9("OnCommentInit")}vkn(ka){ka||
this.Oim()}Oim(){const ka=zi.k4h();ka&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-z.AFrameworkApplication.QW),this.W.resolve("WordEditor.Comments.WordCommentEventsActor").s9("OnCommentInit",Object.assign(new yo.a,{hGa:()=>{Uf.a.instance.wca.isVisible||z.AFrameworkApplication.va.processAction(tf.a.NY,2);this.W.resolve("WordEditor.Comments.ICommentSelectionActor").Sgj(ka,Object.assign(new Ik.a,{qdg:!0}))}})),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").Hv(tf.a.j8e))}wSn(ka,
Va,vb){ka&&ka.execute(Wb=>{Wb.Q4(new $b.a(Va,vb))})}dispose(){this._initialized&&(Uf.a.instance&&Uf.a.instance.dispose(),this._initialized=!1)}static k4h(){return z.AFrameworkApplication.K.jb("BootActivityNavigationId")}}Object(e.a)(zi,"PackageManager",null,[1,2]);const En=ka=>{const Va=K.a.instance.Sa("Box4.IPackageBootPerfLogger"),vb=window.performance.now();Va.execute(Wb=>{Wb.vx(Sl.a.comments,"CPMain",vb,!0)});A.a.instance.Fc(new zi,0,ka)};var zk=c(1931);class Ao{isComment(ka){return ng.a.isComment(ka)}KXd(ka){return ng.a.KXd(ka)}RBf(ka){return ng.a.RBf(ka)}gTf(ka,
Va){ng.a.gTf(ka,Va)}kTf(ka,Va){ng.a.kTf(ka,Va)}waf(ka){return ng.a.waf(ka)}j4a(ka){return Bh.a.instance.j4a(ka)}deleteComment(ka,Va){ng.a.deleteComment(ka,Va)}bId(ka,Va){ng.a.bId(ka,Va)}snb(ka){ng.a.snb(ka)}mba(ka,Va,vb){return ng.a.mba(ka,Va,vb)}xva(ka,Va,vb){return ng.a.xva(ka,Va,vb)}v8b(ka,Va){return ng.a.v8b(ka,Va)}pNc(ka,Va,vb,Wb=null){return ng.a.pNc(ka,Va,vb,Wb)}P_b(ka,Va,vb,Wb){ng.a.P_b(ka,Va,vb,Wb)}Kyd(ka,Va,vb,Wb){return ng.a.Kyd(ka,Va,vb,Wb)}get MGb(){return ng.a.MGb}set MGb(ka){ng.a.MGb=
ka}vKb(ka,Va){ng.a.vKb(ka,Va)}M3c(ka){ng.a.M3c(ka)}O4f(ka){ng.a.O4f(ka)}UQd(ka,Va){return ng.a.UQd(ka,Va)}hTf(ka,Va){ng.a.hTf(ka,Va)}jTf(ka,Va){ng.a.jTf(ka,Va)}g6d(ka,Va,vb,Wb,nc,Qc){ng.a.g6d(ka,Va,vb,Wb,nc,Qc)}yhf(ka,Va){ng.a.yhf(ka,Va)}J1c(ka,Va,vb,Wb){return ng.a.J1c(ka,Va,vb,Wb)}O1c(ka,Va,vb,Wb){return ng.a.O1c(ka,Va,vb,Wb)}}Object(e.a)(Ao,"CommentEditorProxy",null,[596]);class $n{constructor(){this.W=null}get zPb(){return null!=this.$Gg?this.$Gg:this.$Gg=(()=>this.W.Sa("WordEditor.ITableEditor"))()}get K4a(){return null!=
this.zEg?this.zEg:this.zEg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}TZ(ka){this.K4a.TZ(Sl.a.comments,ka,!0)}get name(){return"WordEditor.CommentsInteractive"}xc(ka){this.W=ka;this.TZ("CIPConfigStart");ka.ha("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new Ao).as("WordEditor.CommentsInteractive.ICommentEditor").singleInstance();this.TZ("CIPConfigEnd")}init(){this.TZ("CIPInitStart");this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>{this.fn();this.TZ("CIPInitEnd")})}fn(){this.Arm()}dispose(){}Arm(){Mg.a.kSa(ng.a.kTf);
zk.a.d_e(ng.a.hTf);zk.a.Azd(ng.a.jTf);zk.a.pwk(ng.a.skn);this.zPb.execute(Va=>{Va.e_e(ng.a.vKb)});const ka=V.App.Lj.Bl;ka.Ze(39).Fo(ng.a.gTf);zk.a.wvk(ng.a.wjn);zk.a.nvk(ng.a.Iin);ze.a.isEnabled&&ka.Ze(12).Kw(ng.a.LPj)}}Object(e.a)($n,"PackageManager",null,[1,2]);const mj=ka=>{const Va=K.a.instance.Sa("Box4.IPackageBootPerfLogger"),vb=window.performance.now();Va.execute(Wb=>{Wb.vx(Sl.a.comments,"CIPMain",vb,!0)});A.a.instance.Fc(new $n,0,ka)};var kc=c(2040),zm=c(147),Oc=c(1655);class Fn{constructor(ka,
Va,vb,Wb,nc,Qc,Hd){this.tMa=ka;this.naa=Va;this.S6=vb;this.Wc=Wb;this.E3j=nc;this.KKe=Qc;this.avb=Hd;Oc.a.owk((xd,Id)=>{this.luk(Id.graphNode,Id.L_k)});Oc.a.Swk((xd,Id)=>{this.x6k(Id.graphNode,Id.JYk)})}TPd(){var ka=this.E3j();const Va=this.Wc.xk();Va.set(ka);if(this.naa.yNo(Va))return Va;Va.set(ka);zm.PageNavigator.instance.eP(Va);ka=this.S6.bdl(Va.currentNode);Va.Gi(ka);return Va}oSd(ka){const Va=this.TPd();let vb=null;this.naa.UMd(Va,Wb=>{this.S6.nhi(Wb)===ka&&(vb=Wb);return!vb});return vb}jhi(ka){const Va=
this.TPd();let vb=null;this.naa.UMd(Va,Wb=>{this.S6.E8b(Wb)===ka&&(vb=Wb);return!vb});return vb}hJi(ka,Va,vb){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",ka,Va,vb)}ohi(){const ka=this.TPd(),Va=[];this.naa.UMd(ka,vb=>{Va.push(this.S6.nhi(vb));return!0});return Va}ifb(ka,Va){if(!Va.length)return this.avb&&a.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const vb=this.TPd(),Wb=
Ti.a.create().toString(),nc=new hf.a;for(let Qc of Va)nc.add(Qc),this.hJi(Qc.type,Wb,Qc.completion);Va=this.tMa.r$f(nc);this.S6.ifb(vb.currentNode,Wb,ka,Va);this.KKe();return Wb}Ve(ka){(ka=this.oSd(ka))?(this.S6.Ve(ka),this.KKe()):this.avb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}E8b(ka){ka=this.oSd(ka);return ka?this.S6.E8b(ka):(this.avb&&a.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}khi(ka){return this.S6.E8b(ka)}mhi(ka){ka=
this.oSd(ka);if(!ka)return this.avb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;ka=this.S6.Itf(ka);return this.tMa.u4b(ka).toArray()}yCk(ka,Va){if(!Va.length)return this.avb&&a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const vb=this.oSd(ka);if(!vb)return this.avb&&a.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const Wb=this.S6.Itf(vb),nc=this.tMa.u4b(Wb);
for(let Qc of Va)nc.add(Qc),this.hJi(Qc.type,ka,Qc.completion);ka=this.tMa.r$f(nc);ka!==Wb&&(this.S6.alo(vb,ka),this.KKe());return!0}luk(ka,Va){if(Va=this.jhi(Va)){const vb=this.Wc.xk();vb.set(ka);this.S6.Vb(Va.clone(),this.S6.Pul(Va,vb))}}O6i(ka,Va,vb){if(Va.nb(ka))return Va.J(ka);const Wb=Ti.a.create().toString();Va.add(ka,Wb);vb&&this.avb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return Wb}x6k(ka,Va){const vb=new Rg.a;var Wb=
this.Wc.xk();Wb.set(ka);Wb.Rb(38)&&this.naa.UMd(Wb,nc=>{const Qc=this.S6.E8b(nc);void 0!==Qc&&null!==Qc&&vb.add(Qc,nc);return!0});for(let nc of Va)if(ka=null,({value:ka}=vb.Dc(nc.key,ka)).returnValue)if(nc.value===nc.key)ka=this.jhi(nc.key),this.S6.Mlo(ka,parseInt(nc.key));else{ka=this.S6.Itf(ka);if(!ka||""===ka){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}ka=this.tMa.u4b(ka);Wb=new eb.a;for(let Qc=0;Qc<ka.length;Qc++){if(ka.J(Qc).commentId){const Hd=
Number.parseInvariant(ka.J(Qc).commentId);Va.nb(Hd)?ka.J(Qc).commentId=Va.J(Hd).toString():ka.J(Qc).commentId=null}ka.J(Qc).recordId=this.O6i(ka.J(Qc).recordId,Wb,!1);-1===ka.J(Qc).type&&(ka.J(Qc).undoId=this.O6i(ka.J(Qc).undoId,Wb,!0))}this.ifb(nc.value,ka.toArray())}}static Jr(){return new Fn(K.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),K.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),K.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new lg.a,()=>V.App.ya.gb.Uc,()=>
{K.a.instance.Sa("Common.Interface.IEditNotificationManager").execute(ka=>{ka.editHappened()})},!0)}}Object(e.a)(Fn,"TaskActor",null,[610]);var Zj=c(1111);class Ul{create(){return new Zj.a}}Object(e.a)(Ul,"TaskContentNodeFactory",null,[298]);var no=c(1055);class ml{create(){return new no.a}}Object(e.a)(ml,"TaskNodeFactory",null,[298]);class Xp{constructor(ka,Va,vb,Wb,nc,Qc){this.naa=ka;this.Hc=Va;this.Wc=vb;this.Ikk=Wb;this.Lkk=nc;this.sSb=Qc}Gbl(ka,Va,vb){const Wb=this.Lkk.create(1074135162);Wb.setValue(ma.a.taskId,
ka);Wb.setValue(ma.a.DPb,Va);Wb.setValue(ma.a.Qya,vb);return Wb}G8b(ka){const Va=this.Hc.Mc(4);Va.Cb(ka);this.sSb();return Va}nhi(ka){return this.naa.THb(ka)?ka.getValue(ma.a.taskId):(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}E8b(ka){return this.naa.THb(ka)?ka.hasProperty(ma.a.DPb)?ka.getValue(ma.a.DPb):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}Itf(ka){return this.naa.THb(ka)?ka.getValue(ma.a.Qya):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),
null)}bdl(ka){if(7!==ka.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const Va=this.G8b(ka);try{const vb=this.Ikk.create(1074135161),Wb=this.Wc.xk();Wb.set(ka);Wb.X2(vb,38,Xp.jFo);return vb}finally{Va&&Va.dispose()}}ifb(ka,Va,vb,Wb){if(!this.naa.zGf(ka))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const nc=this.G8b(ka);try{const Qc=this.Gbl(Va,vb,Wb),Hd=this.Wc.xk();Hd.set(ka);Hd.X2(Qc,1,new ja.a(Ti.a.yua(vb.toString()),1));return Qc}finally{nc&&
nc.dispose()}}Ve(ka){if(this.naa.THb(ka))if(ka.anchor&&ka.anchor.aq){var Va=ka.anchor.aq.xr.node;if(this.naa.zGf(Va)){var vb=this.G8b(Va);try{const Wb=this.Wc.xk();Wb.set(Va);Wb.Gi(ka.anchor.node);Wb.wg()}finally{vb&&vb.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}alo(ka,Va){if(this.naa.THb(ka)){var vb=
this.G8b(ka);try{ka.setValue(ma.a.Qya,Va)}finally{vb&&vb.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}Mlo(ka,Va){if(this.naa.THb(ka)){var vb=this.G8b(ka);try{const Wb=ka.hasProperty(ma.a.DPb)?ka.getValue(ma.a.DPb):null;void 0===Wb||null===Wb||Wb===Va?ka.Zg(ma.a.DPb,Va):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{vb&&vb.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}Pul(ka,Va){if(!Va.Nr(38)){const vb=this.Wc.xk();
vb.set(ka);vb.zb(71);vb.hd(71);ka=ib.a(vb.currentNode,ka.Bi().Kc,!0);Va.Hf(ka,38)}return Va.Rb(38)}Vb(ka,Va){if(this.naa.zGf(Va)){var vb=this.G8b(Va);try{const Wb=this.Wc.xk();Wb.set(Va);Wb.Hf(ka,1)}finally{vb&&vb.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static Jr(){return new Xp(K.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new pm.a,new lg.a,new Ul,new ml,()=>{xe.App.Ln.gb.Uc.jF.p7(10)})}}Xp.jFo=new ja.a(Ti.a.If("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),
1);Object(e.a)(Xp,"TaskEditor",null,[609]);class Nh{constructor(ka,Va){this.qx=ka;this.Vvb=Va}THb(ka){return!!ka&&72===ka.type}ORm(ka){return!!ka&&71===ka.We}zGf(ka){return!!ka&&71===ka.type}yNo(ka){ka.set(this.qx.value);this.Vvb.eP(ka);return!!ka.Rb(38)}UMd(ka,Va){if(ka&&Va)if(this.ORm(ka))for(var vb=!0,Wb=ka.Rb(1);vb&&Wb;)this.THb(Wb)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",Wb.type),vb=Va(Wb),Wb=ka.vf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",
ka.We);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static Jr(){return new Nh(new W.a(()=>V.App.ya.gb.Uc),zm.PageNavigator.instance)}}Object(e.a)(Nh,"TaskNavigator",null,[605]);class Og{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>{this.fn()})}dispose(){}xc(ka){this.W=ka;ka.ha("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new kc.a).as("WordEditor.Tasks.ITaskHistorySerialization").singleInstance();
ka.ha("WordEditor.Tasks.TaskNavigator",()=>Nh.Jr()).as("WordEditor.Tasks.ITaskNavigator").singleInstance();ka.ha("WordEditor.Tasks.TaskEditor",()=>Xp.Jr()).as("WordEditor.Tasks.ITaskEditor").singleInstance();ka.ha("WordEditor.Tasks.TaskActor",()=>Fn.Jr()).as("WordEditor.Tasks.ITaskActor").singleInstance()}fn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(116)}}Object(e.a)(Og,"TasksPackage",null,[1,2]);var Bo=c(79),Ek=c(1652),nd=c(399),Sm=c(94);class oo{constructor(){this.onResizeMiddleContainer=
this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(e.a)(oo,"TaskPaneGroupAppProps",null,[]);var qp=c(180);class Jl{static d1k(ka,Va){Jd.FocusManager.SJ()&&(Xj.a.instance.aCa(ka,Va,!1),qp.a.instance.aCa(ka,Va,!1),z.AFrameworkApplication.ta.jx.dT(ka))}}Object(e.a)(Jl,"ReactTaskPaneManagerUtils",null,[]);var ln=c(141),Co=c(331);class bn{constructor(){this.type=
null}}Object(e.a)(bn,"SampleTaskPaneProps",null,[]);var gm=c(1653);class Do{constructor(){this.entry=null;this.show=!1}}Object(e.a)(Do,"AnimationBatchEntry",null,[]);var Km=c(292),Aj=c(1127),Tj=c(125);class Sh{constructor(){this.s$g=[];this.t$g=[];this.vla={};this.FJa=this.EJa=null;this.Svd=!1;this.zZ=null;this.atd=this.Qnd=0;this.voc=[];this.VFe=!!z.AFrameworkApplication.ta&&z.AFrameworkApplication.ta.Nb.Sjb;this.Fw=!1}initialize(){this.Svd=!1;(this.Fw=!!z.AFrameworkApplication.ta&&z.AFrameworkApplication.ta.Nb.pJ)&&
this.jbf()}lbf(ka,Va,vb,Wb){Va=this.qSd(Va);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.jbf();const nc=document.createElement("div");nc.id=Va;nc.className=Sh.C0o;nc.style.width="0";this.VFe||(this.grk(vb,Va,nc),this.vla[Va]=ka.lbf(Va,vb,Wb,nc));return nc}jbf(){this.Svd||this.Lno()}grk(ka,Va,vb){let Wb=null,nc=null;0===ka?(Wb=this.EJa,nc=this.s$g):1===ka&&(Wb=this.FJa,nc=this.t$g);if(Wb){ka=!1;for(let Qc=0;Qc<nc.length;Qc++)if(!ka)nc[Qc]===Va&&(ka=!0);else if(nc[Qc]in this.vla){this.hBm(Wb,
vb,this.vla[nc[Qc]]);return}Wb.appendChild(vb)}}hBm(ka,Va,vb){ka.insertBefore(Va,vb.element)}Rnl(ka){ka=this.qSd(ka);if(ka in this.vla){const Va=this.vla[ka];Va.element.parentNode.removeChild(Va.element);delete this.vla[ka]}}Mrj(ka){ka=this.qSd(ka);ka in this.vla&&(ka=this.vla[ka])&&!ka.isVisible&&(this.Wqj(ka,!0),this.Mqh(ka.position,!0,this.Ezh(ka,!0)),1===ka.position&&1<I.a.count(this.vla)&&this.p6m())}Wqm(ka){ka=this.qSd(ka);ka in this.vla&&(ka=this.vla[ka])&&ka.isVisible&&(this.Wqj(ka,!1),this.Mqh(ka.position,
!1,this.Ezh(ka,!1)))}M3b(ka){if(this.zZ)return this.zZ;const Va=document.createElement("div");document.body.appendChild(Va);Va&&(this.zZ=new Ek.a(Va,ka));return this.zZ}Wqj(ka,Va){ka.element&&(ka.isVisible=Va,this.voc.push(Object.assign(new Do,{entry:ka,show:Va})));0===ka.position?this.Qnd+=Va?1:-1:this.atd+=Va?1:-1;1===this.voc.length&&window.setTimeout(Object(qm.a)(this,this.gAo,"startPaneAnimation"),0);this.Fw&&ka.element&&ka.element.parentNode&&(0===ka.position&&!this.Qnd||1===ka.position&&!this.atd?
(ka.element.parentNode.style.minHeight="0px",ka.element.parentNode.style.height="0px",ka.element.parentNode.style.overflow="hidden"):(ka.element.parentNode.style.minHeight="",ka.element.parentNode.style.height="",ka.element.parentNode.style.overflow=""))}gAo(){this.$Ui();var ka=Bb.where(Bb.asEnumerable(this.voc),nc=>0===nc.entry.position),Va=Bb.where(ka,nc=>!nc.show);if(Bb.any(Va)&&Bb.Ct(Va)!==Bb.Ct(ka)){for(var vb of Va)vb.entry.element.style.width="0";ka=Bb.where(ka,nc=>nc.show)}Va=Bb.where(Bb.asEnumerable(this.voc),
nc=>1===nc.entry.position);vb=Bb.where(Va,nc=>!nc.show);if(Bb.any(vb)&&Bb.Ct(vb)!==Bb.Ct(Va)){for(var Wb of vb)Wb.entry.element.style.width="0";Va=Bb.where(Va,nc=>nc.show)}for(let nc of Bb.concat(ka,Va))ka=nc.entry,Tj.WacAirSpace.VU(ka.element,Km.a.ceg),Wb=new Aj.a(ka.element),nc.show?Wb.q0e(0,ka.width):Wb.q0e(ka.width,0),Tj.WacAirSpace.animate(Wb,null,null);this.voc.length=0}$Ui(){}Ezh(ka,Va){let vb=ka.width;ka=0===ka.position?this.Qnd:this.atd;if(Va&&1===ka||!Va&&!ka)vb+=1;return vb}Lno(){this.Svd||
(this.EJa||(this.EJa=document.createElement("div"),this.EJa.id=Sh.A0o,this.EJa.className=Sh.iJj,Sys.UI.DomElement.addCssClass(this.EJa,"alignLeft"),z.AFrameworkApplication.ta&&z.AFrameworkApplication.ta.Nb.E8&&Sys.UI.DomElement.addCssClass(this.EJa,"FlexBoxLayout"),this.VFe&&Sys.UI.DomElement.addCssClass(this.EJa,Sh.fJj),this.Qoh(0,this.EJa)),this.FJa||(this.FJa=document.createElement("div"),this.FJa.id=Sh.B0o,this.FJa.className=Sh.iJj,Sys.UI.DomElement.addCssClass(this.FJa,"alignRight"),z.AFrameworkApplication.ta&&
z.AFrameworkApplication.ta.Nb.E8&&Sys.UI.DomElement.addCssClass(this.FJa,"FlexBoxLayout"),this.VFe&&Sys.UI.DomElement.addCssClass(this.FJa,Sh.fJj),this.Qoh(1,this.FJa)),this.gXi(this.EJa,this.FJa),this.Svd=!0)}gXi(){}dCa(ka,Va){Array.add(1===ka?this.t$g:this.s$g,Va)}qSd(ka){return ka+"-Entry"}p6m(){let ka=0;for(const Va of I.a.EO(this.vla)){const vb=Object(yb.a)(949,this.vla[Va]);vb&&vb.isVisible&&1===vb.position&&ka++}2===ka?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<ka&&
a.ULS.sendTraceTag(595179605,320,50,ka+" simultaneous panes open")}}Sh.A0o="WACTaskPaneContainerLeft";Sh.B0o="WACTaskPaneContainerRight";Sh.iJj="WACTaskPaneContainer";Sh.C0o="WACTaskPaneEntry";Sh.fJj="WACReactTaskPaneContainer";Object(e.a)(Sh,"BaseTaskPaneManager",null,[950]);var Ui=c(485),tn=c(290);class kg extends Sh{constructor(ka,Va){super();this.nxc=this.mxc=this.JWe=this.IWe=0;this.Y0h=()=>{sh.InteractiveViewManager.instance.forEach(vb=>{vb.YMd()})};this.ga=ka;this.j_g=Va}Qoh(ka,Va){const vb=
V.App.ya.jD;vb.parentNode&&(ka?1===ka&&(this.Fw?((ka=Object(tn.a)("FarPane"))&&ka.appendChild(Va),Va.classList.add("regionComposer"),V.App.ya.DI.registerBoundingWindowRectsChanged("farPane",(Wb,nc)=>{"DP"===nc||3===nc?Va.classList.add("DL"):Va.classList.remove("DL")})):vb.parentNode.insertBefore(Va,vb.nextSibling)):this.Fw?((ka=Object(tn.a)("NearPane"))&&ka.appendChild(Va),Va.classList.add("regionComposer")):vb.parentNode.insertBefore(Va,vb))}Mqh(ka,Va,vb){this.Fw||(Va=Va?vb:-vb,ka?this.nxc+=Va:this.mxc+=
Va)}$Ui(){if(!this.Fw){var ka=V.App.ya.jD;Tj.WacAirSpace.VU(ka,Km.a.ceg);if(this.IWe!==this.mxc){const Va=new Ui.a(ka);Va.WAk(this.IWe,this.mxc,this.j_g);Tj.WacAirSpace.animate(Va,null,this.Y0h);this.IWe=this.mxc}this.JWe!==this.nxc&&(ka=new Ui.a(ka),ka.XAk(this.JWe,this.nxc,this.j_g),Tj.WacAirSpace.animate(ka,null,this.Y0h),this.JWe=this.nxc)}}}Object(e.a)(kg,"TaskPaneManager",Sh,[]);var tj=c(272);class Kl extends kg{get gwi(){null==this.bre&&(this.bre=z.AFrameworkApplication.K?z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",
!1):!1);return this.bre}constructor(ka,Va){super(ka,Va);this.nW=pd.KeyInputManager.kc(Bo.a.ww,0);this.oW=pd.KeyInputManager.kc(Bo.a.ww,4);this.zPe=this.Zwc=null;this.s4g="AccCheckerTaskPane";this.ra=new na.a;this.isPaneOpen=!1;this.bre=this.Sze=null;this.dCa(0,"SampleTaskPane");this.dCa(0,tj.a.Cgb);this.dCa(1,tj.a.pGk);this.dCa(1,"CustomTaskPane");this.dCa(1,tj.a.HAf);this.dCa(1,ug.AFrame.Gr);this.dCa(1,ug.AFrame.Hmh);this.dCa(1,ug.AFrame.Cmh);this.dCa(1,tj.a.dNd);this.dCa(1,tj.a.bJc);this.dCa(1,
tj.a.QKc);this.d8j=(this.hLg=!!z.AFrameworkApplication.ta&&!!z.AFrameworkApplication.ta.Nb)&&z.AFrameworkApplication.ta.Nb.tFf;this.k7j=xe.App.aIb;this.q7j=this.hLg&&z.AFrameworkApplication.ta.Nb.kVc;this.initialize();ka.fb(Sg.a.veg,el.a.application,Kl.veg,96)}get Rde(){if(!V.App.ya||!V.App.ya.jD)return null;this.zPe||(this.zPe=new Ek.a(V.App.ya.jD,Jd.FocusManager.instance()));return this.zPe}Tb(){}gXi(ka,Va){const vb=nd.a.instance,Wb=Jd.FocusManager.instance(),nc=Sm.EventHandlerManager.instance,
Qc=this;Pb.UISurfaces.zu().then(Hd=>{Qc.Zwc=Qc.M3b(Wb);let xd;Hd.renderTaskPaneGroups(ka,Va,(xd=new oo,xd.middleContainer=V.App.ya.jD,xd.onTabStripFocus=()=>{Wb.cD(tj.a.zkc)},xd.onOpen=(Id,Ve)=>{Qc.uFf(Id)&&Jl.d1k(Id,Ve);nc.AYe(Ve,"focus",Qc.kfi(Id,Wb),!0);var mf=Qc.Oxi(Id),fg=Hd.selectors.getTabbedTaskPaneCount(mf?1:2);mf=mf?tj.a.uke:tj.a.zkc;1===fg&&(vb.uaa(mf),this.isPaneOpen=!0,this.l5i({isPaneOpen:this.isPaneOpen,FPb:Ve}));Ve=Qc.Wpf(Id);if(fg=Wb.ge(Ve))fg.aHc=mf,Qc.nso(Id)&&(fg.ir(Qc.nW),fg.ir(Qc.oW)),
vb.Awi(Ve)&&vb.Rw(Ve);this.gwi&&this.bLd&&this.bLd.Tw(!0)},xd.onClose=(Id,Ve)=>{Qc.uFf(Id);const mf=Qc.Oxi(Id),fg=mf?tj.a.uke:tj.a.zkc;Hd.selectors.getTabbedTaskPaneCount(mf?1:2)||(vb.Rw(fg),this.isPaneOpen=!1,this.l5i({isPaneOpen:this.isPaneOpen,FPb:Ve}));nc.R4f(Ve,"focus",Qc.kfi(Id,Wb),!0);this.gwi&&this.bLd&&this.bLd.Tw(!0)},xd.setFocusCallback=(Id,Ve)=>{Qc.uFf(Id)&&Ve&&(Id=Wb.ge(Qc.Wpf(Id)),Id.yXk(),Id.Uea(Ve))},xd.onOverflowMenuOpen=()=>{if(Qc.Zwc)Qc.Zwc.onMenuOpen()},xd.onOverflowMenuClose=
()=>{if(Qc.Zwc)Qc.Zwc.onMenuClose()},xd.onShow=(Id,Ve)=>{2===Ve&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{Wb.mg(Id)},0)})},xd.onHide=(Id,Ve,mf)=>{mf&&1!==Ve&&Wb.mg(Wb.wT)},xd.onResizeStart=()=>{if(V.App.ya&&(V.App.ya.jD.className=Rj.AppFrame.kog,Qc.Rde))Qc.Rde.onMenuOpen()},xd.onResizeEnd=()=>{if(V.App.ya&&(ln.a.Zzi()||(V.App.ya.jD.className+=" "+V.App.ya.XAh),Qc.Rde))Qc.Rde.onMenuClose()},xd));this.Wia(tj.a.zkc,Wb,Va,Qc);this.Wia(tj.a.uke,Wb,ka,Qc);return null})}Wia(ka,Va,vb,Wb){const nc=
Va.ge(ka);nc.parent=ug.AFrame.rp;nc.OH=!0;Xj.a.instance.aCa(ka,vb,!1);qp.a.instance.aCa(ka,vb,!1);ka=new Co.DOMFocusListing(()=>vb);ka.Wm(3);ka.Wm(2);ka.Wm(4);ka.Wm(1);Va.Yla(()=>vb,nc,ka).jR=!0;nc.ir(Wb.nW);nc.ir(Wb.oW)}Wpf(ka){return ka===this.s4g?tj.a.Nlh:ka}kfi(ka,Va){return()=>{Va.cD(this.Wpf(ka))}}nso(ka){return ka===this.s4g?!1:!0}GIm(ka){return ka===tj.a.Cgb}uFf(ka){return this.GIm(ka)||ka===tj.a.Nlh||0<=ka.indexOf("AppForOfficePanel")||ka===tj.a.dNd||ka===tj.a.HAf&&this.d8j||ka===tj.a.bJc&&
this.k7j||ka===tj.a.QKc&&this.q7j||ka===gm.a.eDb?!0:!1}Oxi(ka){return ka===tj.a.Cgb||"SampleTaskPane"===ka}static Kdm(){return new Kl(z.AFrameworkApplication.va,z.AFrameworkApplication.isRtl)}static veg(ka,Va,vb,Wb,nc){if(1===vb)return 32;Pb.UISurfaces.zu().then(Qc=>{Qc.showTaskPane(nc,Object.assign(new km.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new bn,{type:"SampleTaskPaneProps"})}));return null});return 32}WYa(ka){this.ra.addHandler("onPaneToggle",ka)}i4c(ka){this.ra.removeHandler("onPaneToggle",
ka)}l5i(ka){this.ra.raiseEvent("onPaneToggle",ka)}get bLd(){this.Sze||(this.Sze=K.a.instance.Na("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.Sze}}Object(e.a)(Kl,"TaskPaneManager",kg,[606]);class Hf{constructor(){this.$S=null}get name(){return"WordEditor.TaskPaneManager"}xc(){}init(){this.$S=Kl.Kdm();this.$S.Tb();V.App.ya.h7a=this.$S}dispose(){}}Object(e.a)(Hf,"PackageManager",null,[1,2]);c.d(M,"a",function(){return m})},1931:function(E,M,c){E=c(0);var m=c(171),e=c(719),a=c(353),
l=c(22),y=c(2),z=c(80),n=c(44),v=c(41),A=c(6),w=c(15),G=c(7),F=c(74),I=c(438),K=c(86),J=c(465),N=c(5),R=c(588),O=c(193),L=c(222),U=c(18),W=c(1094),X=c(36),V=c(81),Z=c(40),da=c(764),aa=c(27),ea=c(75),na=c(21),pa=c(52);class ja{constructor(Pa,Ab,nb,Rb){this.mId=this.kId=null;this.H8c=Pa;this.Bke=Ab;this.Zsj=nb;this.$sj=Rb}}Object(E.a)(ja,"TableSimplificationInformation",null,[]);var ma=c(78),Ia=c(28),Ja=c(441),Ka=c(256),Ma=c(919),sa=c(1557),xa=c(280),ia=c(3),ha=c(9),ua=c(134),ya=c(17),ra=c(257),La=
c(32),oa=c(249),Ca=c(8),Aa=c(632),db=c(560),eb=c(339);class ib extends Sys.EventArgs{constructor(Pa){super();this.Ko=Pa}}Object(E.a)(ib,"AfterTrimCompleteOnCopyArgs",Sys.EventArgs,[]);var lb=c(1752);class Ya extends lb.a{constructor(Pa,Ab,nb,Rb){super(Pa,Ab,{});this.OSa=[];for(Pa=0;Pa<nb.length;Pa++)this.OSa.push(...nb.J(Pa).toArray());this.bDa=0;this.ly=Rb;this.Ko={}}}Object(E.a)(Ya,"BasicInternalCopyArguments",lb.a,[]);class Fa extends Sys.EventArgs{constructor(Pa,Ab){super();this.Ko=Ab;this.OSa=
[];for(Ab=0;Ab<Pa.length;Ab++)this.OSa.push(...Pa.J(Ab).toArray())}}Object(E.a)(Fa,"BeforeCopyArguments",Sys.EventArgs,[]);class $a extends Sys.EventArgs{constructor(Pa){super();this.Ko=Pa}}Object(E.a)($a,"BeforePasteArguments",Sys.EventArgs,[]);class Db extends Sys.EventArgs{constructor(Pa,Ab,nb,Rb){super();this.paragraph=Pa;this.cpBegin=Ab;this.cpEnd=nb;this.Ko=Rb}}Object(E.a)(Db,"BeforeTrimOnCopyArguments",Sys.EventArgs,[]);var gc=c(1795),Eb=c(1796);class kb{constructor(Pa,Ab,nb,Rb,Mb,oc,xb,cc,
Ob){this.Gkc=Pa;this.source=Ab;this.target=nb;this.ZWf=Rb;this.rowIndex=Mb;this.wo=oc;this.FZa=xb;this.z_i=cc;this.je=Ob}}Object(E.a)(kb,"CoreInternalTablePasteArguments",null,[]);class bb extends Sys.EventArgs{constructor(Pa,Ab,nb,Rb,Mb){super();this.operation=Pa;this.iYi=Ab;this.original=nb;this.clone=Rb;this.Ko=Mb}}Object(E.a)(bb,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var Gb=c(103);c.d(M,"a",function(){return Sa});class Sa{constructor(Pa,Ab,nb,Rb,Mb,oc,xb,cc,Ob,Ub,pb,Zb,Wa,Lb,qc){this.yW=
this.ht=null;this.DKe=!1;this.ML=this.wAa=null;this.XWk=(Ra,yb)=>{m.a.mark(5566);yb=yb.target;if(yb.Qd())return yb.wg(),!0;Ra.gi(this.YKc);return!0};this.YKc=(Ra,yb)=>{yb=new gc.a(yb,null);const Bb=new e.a(Ra,this.CHc,yb);Bb.Al("ExecuteCoreCopyToInternalClipboard");this.XFn(yb);Bb.run();Ra.gi(this.oLo);return!0};this.CHc=(Ra,yb)=>{if(!yb.source.Qd())return yb.Di&&(yb.Di.qDd=null),G.ULS.shipAssertTag(6305560,307,!1),this.$h.logKpiFailure({kpiName:eb.a.PCd,errorName:"InternalCopyFailedSourceHasNoChildren"}),
!1;Ra.gi(this.kJh);return!0};this.kJh=(Ra,yb)=>{const Bb=yb.insertAfter,cb=yb.source,Xa=yb.target,hb=cb.currentNode;var Cb=this.IXi;if(!hb.kha)return Ra.gi(this.BHc),!0;yb.Di.vOb&&(yb.vOb=!0);if(!this.FUk(yb))return yb.zja.eFa.c++,Ra.gi(this.BHc),!0;if(!yb.vOb&&(hb.H5b()&&yb.zja.eFa.c++,hb.H5b()||Cb&&!hb.Ojb(this.mv)))return Ra.gi(this.BHc),!0;if(!yb.vOb&&Cb&&!hb.xz)return cb.rA()&&(yb.Une=!0,yb=new e.a(Ra,this.CHc,new gc.a(yb,Bb)),yb.Al("RecursiveCoreCopyToInternalClipboard"),yb.run()),Ra.gi(this.BHc),
!0;Cb=Xa.currentNode.Bi().od;Cb=R.a(hb,Cb,!0);Cb.pjb=!0;this.Tqa.nce(yb.zja.kFb,Cb);Xa.HH(Cb,Bb,18===cb.parentNode.type?1:cb.role);Xa.Gi(Cb);yb.insertAfter=Cb;Ca.ParagraphReader.Wb(Cb)&&(this.jGn(Ra,this.CHc,hb,Cb,yb),this.iGn(Ra,hb,Cb));this.qWh(hb,Cb);cb.rA()&&(G.ULS.shipAssertTag(6305562,307,!yb.Une),yb=new e.a(Ra,this.CHc,new gc.a(yb,null)),yb.Al("RecursiveCoreCopyToInternalClipboard"),yb.run());Ra.gi((ob,ab)=>this.z6k(ob,ab));return!0};this.BHc=(Ra,yb)=>{yb.Une&&(yb.insertAfter=yb.qDd,yb.Une=
!1);if(!yb.source.qt()){yb.Di&&(yb.Di.qDd=yb.insertAfter);const Bb=yb.source;11!==Bb.We||Bb.N7b(-1)||this.KGn(Ra,Bb.currentNode,yb.target.currentNode,yb);return!1}Ra.gi(this.kJh);return!0};this.oLo=(Ra,yb)=>{if(yb.bDa>=yb.OSa.length)return Sa.ra.raiseEvent("AfterTrimCompleteOnCopy",new ib(yb.Ko)),Ra.gi(this.y6k),!0;Ra=yb.OSa[yb.bDa];var Bb=Ra.node,cb=Ra.cpBegin;let Xa=Ra.cpEnd;if(!ya.SelectionEditor.hv(Ra))if(!yb.bDa&&ya.SelectionEditor.Fk(Ra))Xa=cb=Ca.ParagraphReader.textLength(Bb);else if(Ca.ParagraphReader.lm(Ra))cb=
0,Xa=Ca.ParagraphReader.textLength(Bb);else if(ya.SelectionEditor.Mba(Ra)){G.ULS.shipAssertTag(6305568,307,!yb.bDa);var hb=N.GraphIterator.$a(Bb);cb=hb.zb(12);G.ULS.shipAssertTag(6305569,307,cb);Bb=hb.origin;Xa=cb=Ca.ParagraphReader.textLength(Bb)}else{if(V.OutlineReader.wZd(Ra))for(Ra=O.a.Vo(Ra.node);Ra.moveNext();)hb=Ra.currentNode,Ca.ParagraphReader.Wb(hb)&&yb.OSa.push(Ia.a.createTextRange(hb,0,Ca.ParagraphReader.textLength(hb)));yb.bDa++;return!0}hb=yb.RXf[Bb.id.toString()];G.ULS.shipAssertTag(6305570,
307,!!hb);if(!hb)return G.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:yb.bDa,["SelectedContextsLength"]:yb.OSa.length,["SelectedNodeType"]:Bb.type,["ContextId"]:Ra.contextId}),yb.bDa++,!0;Bb=ma.e(hb);let Cb,ob=!1;for(Cb=Bb.length-1;0<=Cb;Cb--)if(!Bb[Cb].DCa)if(4===Bb[Cb].Dh)Bb[Cb].Ib.blob=null,Bb[Cb].Ib.blob=new Ja.a(Bb[Cb].Ib),yb.zja.eFa.e++;else{Bb[Cb].Ib.blob=null;if(-1!==Bb[Cb].re){var ab=Bb[Cb].Ib.formatting,Ib=void 0,Yb=void 0;ab&&-1===ab.re?(Yb=Bb[Cb].re+
1,Ib=Bb[Cb].v4-1,ab.re=Bb[Cb].re):(Ib=Bb[Cb].v4,Yb=Bb[Cb].re);for(ab=0;ab<Ib;ab++)hb.ze.removeAt(Yb,16);0<Ib&&(ob=!0)}Ib="";xa.f(Bb[Cb])?(Ib=" ",yb.zja.eFa.f++):xa.g(Bb[Cb])&&(Yb=xa.b(Bb[Cb]))&&(Ib=xa.a(Yb),yb.zja.eFa.g++);Yb=Bb[Cb].Ib.cp;Yb>=cb&&Yb<Xa&&(Sa.characterPropertiesEditor.replaceTextRange(Ia.a.createTextRange(hb,Yb,Yb+1),Ib,void 0,void 0,void 0,void 0,!0),Xa=Xa-1+Ib.length,yb.zja.eFa.i++)}ob&&hb.Xl();this.PYn(hb);Sa.ra.raiseEvent("BeforeTrimOnCopy",new Db(hb,cb,Xa,yb.Ko));Bb=Ca.ParagraphReader.textLength(hb);
Xa<Bb&&Sa.characterPropertiesEditor.replaceTextRange(Ia.a.createTextRange(hb,Xa,Bb),"",void 0,void 0,void 0,void 0,!0);0<cb&&Sa.characterPropertiesEditor.replaceTextRange(Ia.a.createTextRange(hb,0,cb),"",void 0,void 0,void 0,void 0,!0);this.dkm(hb,yb.zja.eFa);Ca.ParagraphReader.textLength(hb)||yb.bDa!==yb.OSa.length-1||!ya.SelectionEditor.hv(Ra)||hb.Qs||(Ra=N.GraphIterator.$a(hb),Ra.zb(25)&&(X.OutlineElementNavigator.Vd(Ra),this.nh.N_a(Ra),yb.bDa&&(this.ht.kb.eva=!0)));yb.bDa!=yb.OSa.length-1||this.eva||
hb.Eg(v.a.O4,v.a.xca,v.a.ppa,v.a.Gxa,v.a.g9);this.Tqa.n3c(yb.zja.p9d,yb.zja.oAb,yb.zja.Rdb,hb);yb.bDa++;return!0};this.y6k=(Ra,yb)=>{this.kja.UQb(null);yb.ly.dispose();m.a.mark(5567);this.Cfn();this.yW=yb.zja;this.pIi("Copy");this.vFm&&G.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1};this.Bzn=(Ra,yb)=>{if(yb.Gkc){if(yb.Gkc.inProgress)return!0;aa.TableCellReader.isTableCell(yb.source)||yb.source.hd(16);if(this.gdn(yb))return!1}else La.TableReader.isTable(yb.target)||yb.target.hd(14),
La.TableReader.isTable(yb.source)||yb.source.hd(14),na.moveToCell(yb.target,yb.rowIndex,yb.wo),na.moveToCell(yb.source,0,0);if(aa.TableCellReader.gg(yb.source)||aa.TableCellReader.gg(yb.target))return!0;this.ozn(yb,Ra);return!0};this.DHc=(Ra,yb)=>{if(!yb.source.Qd())return Ra.gi(this.Lmb),!0;Ra.gi(this.mJh);return!0};this.mJh=(Ra,yb)=>{const Bb=yb.source,cb=yb.target,Xa=Bb.currentNode;if(!Xa.kha||!Xa.fNa||this.Uro(Bb,cb))return Ra.gi(this.q$e),!0;if(K.a.instance.J(1)&&Z.OutlineElementReader.Bh(Bb)){if(!X.OutlineElementNavigator.Ge(Bb).fNa)return X.OutlineElementNavigator.Vd(Bb),
Ra.gi(this.q$e),!0;X.OutlineElementNavigator.Vd(Bb)}G.ULS.shipAssertTag(6305608,307,!Xa.H5b());var hb=cb.currentNode.Bi().od;hb=R.a(Xa,hb,!0);hb.uRa();hb.VUc=!0;this.Y1n(Bb,cb);cb.HH(hb,yb.insertAfter,Bb.role);cb.Gi(hb);yb.insertAfter=hb;ha.App.rd.Yo&&ha.App.rd.kq.rH(hb);this.qWh(Xa,hb);yb=new e.a(Ra,this.DHc,new Eb.a(Bb,cb,null,yb.ZWf,yb.Ko));yb.Al("RecursiveCorePasteOperation");yb.run();Ra.gi(this.C6k);return!0};this.C6k=(Ra,yb)=>{const Bb=yb.target,cb=Bb.currentNode,Xa=yb.source,hb=Xa.currentNode;
let Cb=-1;yb.Ko[Sa.Lyf]&&(Cb=yb.Ko[Sa.Lyf]);Ca.ParagraphReader.Wb(cb)&&(this.WGn(Ra,this.DHc,hb,cb,yb),this.SGn(Ra,hb,cb));cb.r0();yb.Ko[W.a.tsi]?22===cb.type&&(aa.TableCellReader.Y_(Xa)||cb.setValue(A.a.listID,Number.MAX_VALUE)):this.iK.h1n(cb);if(Ca.ParagraphReader.Wb(cb)&&(yb=ma.i(cb,5),0<yb.length)){for(const ob of yb)!ob.properties.hasProperty(A.a.cLb)&&ob.properties.hasProperty(A.a.T9d)&&(yb=ob.properties.getValue(A.a.T9d),ob.properties.setValue(A.a.cLb,yb)),U.ImageReader.J$b()?U.ImageReader.VHb(ob.properties)&&
this.Oj.c9f(ob.properties,Cb):U.ImageReader.py(ob.properties)||this.Oj.c9f(ob.properties,Cb);cb.Bi().contentReplicator.forceOutbound(null,null,null)}this.pWh(Bb);this.UWo(hb,cb);La.TableReader.eY(cb)&&G.ULS.sendTraceTag(524919814,3022,50,"TablePasted");this.xU&&aa.TableCellReader.Doa(Bb)&&sa.a.Pfj(cb);Bb.uc();Ra.gi(this.q$e);return!0};this.q$e=(Ra,yb)=>{if(!yb.source.qt())return Ra.gi(this.Lmb),!0;Ra.gi(this.mJh);return!0};this.Lmb=()=>{m.a.mark(5565);return!1};this.$Wb=oc;this.Uo=xb;this.Oj=Pa;this.PTe=
Ab;this.lK=nb;this.nh=Rb;this.iK=Mb;this.Ma=cc;this.Hc=Ub;this.xxd=Ob.create(2097162);this.T3f(this.xxd);this.Nye=Ob.create(2097162);this.T3f(this.Nye);this.LWe=Ob.create(2097162);this.T3f(this.LWe);this.ewd=this.xxd;this.hZ=pb;this.O2=Zb;this.Ud=Wa;this.$h=a.a.getInstance(eb.a.AZa);this.EAc=Lb;this.zhk=Lb.substr(0,3);this.p6=qc}get paragraphEditor(){return null!=this.YEg?this.YEg:this.YEg=l.a.instance.resolve("Box4.IParagraphEditor")}get Xb(){return null!=this.Syg?this.Syg:this.Syg=l.a.instance.Na("Box4.IFeatureHelper")}get mv(){return this.ht?
this.ht.mv:0}get IAb(){return this.ht.kb.IAb}get eva(){return this.ht.kb.eva}get kja(){return this.ewd}get Kxj(){return this.LWe}get r9e(){return this.ht.nJ&&!this.DKe}enj(){this.DKe=!0}get IXi(){return!this.ht.nJ}get Tqa(){return Aa.a.instance}T3f(Pa){var Ab=new Ma.a(-1);this.$Wb.Bl.MMa(Ab);const nb=new N.GraphIterator;nb.set(Ab);y.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordNoRenderGraphTransactionInternalClipboardSettings");Ab=3;this.Ma&&this.Ma.$("NoRenderGraphTransactionInternalClipboardIsEnabled")&&
(Ab=0);Ab=this.Hc.Mc(Ab);Ab.hu(nb);nb.Hf(Pa,80);Ab.dispose()}$Fd(Pa,Ab=null){Pa=Pa.mb;this.ht=Pa.hb.clone();this.DKe=!1;Pa=N.GraphIterator.$a(Pa.h1);const nb=N.GraphIterator.$a(this.kja),Rb=this.Hc.Mc(3,ia.a.internalCopy);Rb.hu(nb);Pa.Rb(82);do Pa.currentNode.UQb(null);while(Pa.xi(82));Pa=new e.a(Ab,this.XWk,new Ya(Pa,nb,this.ht,Rb));Pa.Al("InternalCopy");Pa.Ig=!Ab||Ab.Ig;Pa.run()}z6k(Pa,Ab){var nb=Ab.source;const Rb=Ab.target;var Mb=Rb.currentNode,oc=nb.currentNode;Ca.ParagraphReader.uh(Rb)&&(Ab.RXf[oc.id.toString()]=
Mb);if(Ca.ParagraphReader.Wb(Mb)){if(0<Ca.ParagraphReader.Lgi(oc))if(0<this.Uo.vG(oc).Ft)oc.setValue(A.a.KRa,0);else{const xb=this.Uo.O3(oc).Ft;this.paragraphEditor.fq.Tca(Mb,xb)}if(!this.uTc&&this.p6.A_i){nb.uc();if(!La.TableReader.Yw(Rb)&&nb.xFa&&!this.eva)for(const xb of this.p6.TXf)Mb.removeProperty(xb);nb.Gi(oc)}}if(Ca.ParagraphReader.Wb(Mb)){for(oc=0;oc<Mb.ze.length;oc++)Mb.ze.iq.Z(oc,oa.CharacterPropertiesEditor.HM),Mb.ze.Vs.Z(oc,oa.CharacterPropertiesEditor.pR);G.ULS.shipAssertTag(6305565,
307,!!ha.App.rd);(this.Ud.qg||K.a.instance.J(1)&&ha.App.Zv.bQb)&&Mb.setValue(A.a.hQa,!0);Mb.Eg(A.a.OCb,A.a.DZi,A.a.KXf);K.a.instance.J(1)&&Ca.ParagraphReader.Wb(Mb)&&Mb.Eg(A.a.Jwa)}this.IXi&&(this.pWh(Rb),La.TableReader.isTable(Rb)&&(Mb=this.ht.kO(),Mb.moveNext(),(Mb=aa.TableCellReader.bEa(nb,Mb.current.node))||(Mb=new da.a(0,0)),nb=new ja(Mb,Rb,La.TableReader.tga(nb),La.TableReader.stf(nb)),this.PTe.value.f4n(nb)));Z.OutlineElementReader.Bh(Rb)&&!Rb.Nr(2)&&(this.nh.OI(Rb),Rb.uc());Rb.uc();Ab.Di&&
(Ab.Di.qDd=Ab.insertAfter);Pa.gi(this.BHc);return!0}FUk(Pa){const Ab=Pa.source;if(Z.OutlineElementReader.Bh(Ab)&&Ab.iib(12)){const nb=Ab.Qd();if(Ca.ParagraphReader.Wb(nb)&&nb.ia(A.a.gN,null))return Ab.uc(),Pa.vOb=!1;Ab.uc()}else if(Ca.ParagraphReader.Wb(Ab.Nn)&&Ab.Nn.ia(A.a.gN,null))return!1;return!0}iGn(Pa,Ab,nb){Ab=ma.e(Ab);nb=ma.e(nb);for(let Rb=0;Rb<Ab.length;Rb++)Ab[Rb].LSf(nb[Rb],Pa,this.CHc)}PYn(Pa){if(Pa=Pa.pa){var Ab=new F.a;for(let nb=0;nb<Pa.length;nb++){const Rb=Pa.J(nb);Rb.tj&&Ab.add(Rb)}for(const nb of Ab)nb.tj=
null}}get vFm(){return!N.GraphIterator.$a(this.kja).Qd()}EHj(){this.ewd=this.LWe}DHj(){this.ewd=this.xxd}tYo(){this.ewd=this.Nye}get BSm(){return this.kja===this.xxd}get IHm(){return this.kja===this.Nye}NDh(){const Pa=N.GraphIterator.$a(this.kja);for(;Pa.Qd();)Pa.wg()}pIi(Pa){const Ab=this.yW.eFa.b;Pa+="-"+Ab;this.yW.eFa.b=Pa;this.yW.kFb.b=Pa;this.yW.p9d.b=Pa;this.yW.oAb.b=Pa;this.yW.Rdb.b=Pa;this.Tqa.h2m(this.yW.eFa);this.Tqa.sKf(this.yW.kFb);this.Tqa.rJi(this.yW.p9d);this.Tqa.gKf(this.yW.oAb);this.Tqa.cKf(this.yW.Rdb);
this.yW.eFa.b=Ab;this.yW.kFb.b=Ab;this.yW.p9d.b=Ab;this.yW.oAb.b=Ab;this.yW.Rdb.b=Ab}w_i(Pa,Ab,nb,Rb,Mb=null,oc=null){this.pIi("Paste");Ab=N.GraphIterator.$a(Ab);const xb=N.GraphIterator.$a(this.kja);var cc=null;Mb&&(cc=new J.a(V.OutlineReader.wgl,V.OutlineReader.ehl),cc=Mb.equals(new J.a(-1,-1))?new J.a(0,0):Mb.Vje(cc));if(this.nsi())if(xb.Qd(),U.ImageReader.gv(xb.currentNode))Mb=xb.currentNode,xb.uc(),xb.HH(this.nh.gfb(),null,1),xb.Qd(),xb.HH(Mb,null,2),xb.uc(),xb.Gi(Mb),xb.wg(),this.enj();else if(L.isFloatingEmbeddedFileNode(xb.currentNode)){Mb=
xb.currentNode;xb.uc();xb.HH(this.nh.gfb(),null,1);xb.Qd();var Ob=this.nh.OI(xb);Ob=Ia.a.Rc(Ob,0);Sa.characterPropertiesEditor.replaceTextRange(Ob,"<<"+L.getEmbeddedFileName(Mb)+">>",void 0,void 0,void 0,void 0,!0);xb.uc();xb.uc();xb.Gi(Mb);xb.wg();this.enj()}this.hZ&&this.hZ.YEf(nb)||!this.XBi(xb,Ab)?(m.a.mark(5564),xb.currentNode.UQb(null),Pa={},Pa[Sa.Lyf]=Rb,Gb.ListItemReader.sh(nb)&&(Pa[W.a.tsi]=!0),nb=new Eb.a(xb,Ab,nb,cc,Pa),Rb=new e.a(oc,this.DHc,nb),Rb.Al("ExecuteCorePasteFromInternalClipboard"),
Rb.Ig=!oc||oc.Ig,this.YFn(nb),Rb.run()):(xb.currentNode.UQb(null),G.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.M1n(oc,xb,Ab,cc,Pa),G.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended."))}uBi(Pa){if(Pa&&Pa.isValid){const Ab=N.GraphIterator.$a(this.kja);return this.XBi(Ab,Pa)}return!1}XBi(Pa,Ab){if(aa.TableCellReader.Doa(Ab)&&1===Pa.xq()){Pa.Rb(1);if(Z.OutlineElementReader.Bh(Pa)){X.OutlineElementNavigator.Ge(Pa);if(La.TableReader.isTable(Pa)){La.TableReader.AB(Pa.currentNode)&&
G.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(Ab.zb(14)&&!La.TableReader.AB(na.getContainingTable(Ab))){if(G.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."),!this.xU)return!0}else if(G.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),this.uTc&&!this.xU)return!0;if(this.xU)return!0}X.OutlineElementNavigator.Vd(Pa)}Pa.uc()}return!1}M1n(Pa,Ab,nb,Rb,Mb){let oc,xb;let cc;Object(n.a)("ReplaceTableCellsFromClipboardTable",!0);nb.zb(14);
oc=pa.a.rs(nb);xb=ea.a(nb);nb.hd(14);var Ob=La.TableReader.eg(nb.currentNode);cc=La.TableReader.Yg(nb.currentNode);const Ub=La.TableReader.eg(Ab.currentNode),pb=La.TableReader.Yg(Ab.currentNode);G.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};  and target insert index: {5},{6}",Ob,cc,Ub,pb,oc,xb);if(this.xU&&ra.TableBorderSelectionCache.NPc())this.Llo(),Ob=Math.min(this.Mke+1,Ob),cc=Math.min(this.Vhg+1,cc),this.Vhg-this.hFo==cc-1&&(this.Vwj==
this.Mke?xb=0:this.Mke-this.Vwj==Ob-1&&(nb.Qd(),oc=pa.a.rs(nb),xb=ea.a(nb)));else{this.wAa=db.a.K7b;const Zb=oc+Ub-Ob;0<Zb&&(na.moveToLastRow(nb),G.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+Zb),this.PTe.value.insertRows(nb,!1,Zb,this.wAa),G.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),nb.hd(14));const Wa=xb+pb-cc;if(0<Wa){G.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+Wa);try{this.PTe.value.insertColumns(nb,cc,!1,Wa,this.wAa)}catch(Lb){throw G.ULS.sendTraceTag(19269661,
307,10,"Insert columns failed: {0}",Lb.toString()),Lb;}G.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}(0<Zb||0<Wa)&&Object(n.a)("InsertRowsAndColumnsForInternalCCP",!0)}Ob=this.WNl(Ob,cc,Ub,pb,oc,xb);G.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");Pa=new e.a(Pa,this.Bzn,new kb(null,Ab,nb,Rb,oc,xb,Ob,null,Mb));Pa.Al("ExecuteCorePasteTableInTable");Pa.Ig=!1;Pa.run()}Cfn(){if(this.uTc){for(var Pa=N.GraphIterator.$a(this.kja),Ab=Pa.currentNode;14!==Pa.We;)if(Ab=Pa.Qd(),
!Ab){G.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.qQi(Ab)}}Hfn(Pa){this.uTc&&this.qQi(Pa)}WHo(Pa){const Ab=N.GraphIterator.$a(Pa);this.lK.Uib(Ab,null,!0);Pa.gg=!1;Pa.rowSpan=1;Pa.colSpan=1}qQi(Pa){if(Pa&&14===Pa.type){G.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var Ab={},nb=La.TableReader.eg(Pa),Rb=La.TableReader.Yg(Pa),Mb=N.GraphIterator.$a(Pa);na.forEachCellInTable(Mb,(oc,xb,
cc)=>{const Ob={};oc=oc.currentNode;if(16===oc.type)if(oc.gg)Sa.DGh(xb,cc)in Ab||(this.WHo(oc),Ob.IsGhostCell="->false");else{Sa.HRn(Pa,oc,xb,cc,nb,(pb,Zb,Wa)=>{Ob.rowSpan=String.format("{0}:{1}->{2}",pb,Zb,Wa)});Sa.GRn(Pa,oc,cc,xb,Rb,(pb,Zb,Wa)=>{Ob.colSpan=String.format("{0}:{1}->{2}",pb,Zb,Wa)});const Ub=String.format("{0},{1}-{2},{3}",xb,cc,xb+oc.rowSpan,cc+oc.colSpan);for(let pb=0;pb<oc.rowSpan;pb++)for(let Zb=0;Zb<oc.colSpan;Zb++)if(pb||Zb)Ab[Sa.DGh(xb+pb,cc+Zb)]=Ub}if(0<I.a(Ob).length){if(void 0===
Ob.IsGhostCell||null===Ob.IsGhostCell){if(void 0===Ob.rowSpan||null===Ob.rowSpan)Ob.rowSpan=oc.rowSpan;if(void 0===Ob.colSpan||null===Ob.colSpan)Ob.colSpan=oc.colSpan}G.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",xb,cc,Ob)}return!0});Sa.yql(Ab)}}dkm(Pa,Ab){if(Pa&&Ca.ParagraphReader.Wb(Pa)){var nb=0,Rb=N.GraphIterator.$a(Pa);for(Rb.Rb(6);!Rb.Pr;){var Mb=Rb.currentNode;Rb.xi(6);U.ImageReader.gv(Mb)?U.ImageReader.zFf(Mb)?N.GraphIterator.$a(Mb).iib(59)?G.ULS.sendTraceTag(590455048,
307,50,"HandleAnchoredObjectsForInternalCopy: Not converting anchored image to inline."):(this.paragraphEditor.qIh(Mb,Ia.a.Rc(Pa,nb),!0),Ab.d++,nb++):(Mb=N.GraphIterator.$a(Mb),Mb.zb(12),Mb.wg(),Ab.h++):G.ULS.shipAssertTag(6305571,307,!1)}}}get uTc(){return!!this.Ma&&this.Ma.$("ComplexTableCellPasteWithFormattingIsEnabled")}WNl(Pa,Ab,nb,Rb,Mb,oc){const xb=[];let cc,Ob,Ub,pb;this.xU&&ra.TableBorderSelectionCache.NPc()?(cc=Math.min(Pa,Mb+nb),Ob=Math.min(Ab,oc+Rb),pb=Mb):(pb=0,cc=Math.max(Mb+nb,Pa));
for(;pb<cc;pb++)for(this.xU&&ra.TableBorderSelectionCache.NPc()?Ub=oc:(Ub=0,Ob=oc+Rb,pb<Mb?Ub=Ab:pb>=Mb&&pb<Math.min(Mb+nb,Pa)?Ub=oc:pb>=Mb+nb&&pb<Pa?Ub=Ab:Ob=Math.max(oc+Rb,Ab));Ub<Ob;Ub++)xb.push(Array(2)),xb[xb.length-1][0]=pb,xb[xb.length-1][1]=Ub;return xb}Y1n(Pa,Ab){if(this.uTc)if(!Ab||!Pa)G.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:Pa,["table"]:Ab});else if(16===Ab.currentNode.type&&16===Pa.parentNode.type){Ab=Ab.currentNode;Pa=Pa.parentNode;var nb={};
Ab.gg!==Pa.gg&&(Ab.gg=Pa.gg,nb.IsGhostCell=Ab.gg);Ab.n4!==Pa.n4&&(Ab.n4=Pa.n4,nb.IsSkippedCell=Ab.n4);Ab.Iob!==Pa.Iob&&(Ab.Iob=Pa.Iob,nb.ShouldRenderCell=Ab.Iob);Ab.colSpan!==Pa.colSpan&&(nb.ColSpan=String.format("{0}<={1}.",Ab.colSpan,Pa.colSpan),Ab.colSpan=Pa.colSpan);Ab.rowSpan!==Pa.rowSpan&&(nb.RowSpan=String.format("{0}<={1}.",Ab.rowSpan,Pa.rowSpan),Ab.rowSpan=Pa.rowSpan);I.a(nb)}}Uro(Pa,Ab){let nb=!1;Z.OutlineElementReader.Bh(Pa)&&(nb=Z.OutlineElementReader.rQ(Pa)&&this.NRm(Ab));return nb}NRm(Pa){if(Pa)return Pa=
Pa.We,36===Pa||38===Pa||16===Pa;throw Error.argument("IsTargetNodeInValidForIFrameContent: target iterator is null for paste.");}SGn(Pa,Ab,nb){Ab=ma.e(Ab);const Rb=ma.e(nb);for(let Mb=Ab.length-1;0<=Mb;Mb--){if(!Ab[Mb].pjc(nb)){const oc=Ia.a.createTextRange(nb,Ab[Mb].Ib.cp,Ab[Mb].Ib.cp+1);Sa.characterPropertiesEditor.replaceTextRange(oc,"",void 0,void 0,void 0,void 0,!0)}Ab[Mb].d_c(Rb[Mb],Pa,this.DHc,this.IHm)}}UWo(Pa,Ab){if(K.a.instance.J(1)&&La.TableReader.eY(Pa)){let nb=0;const Rb=La.TableReader.eg(Pa);
for(const Mb of La.TableReader.Ex(Pa,0,Rb-1))Mb.Lu&&nb++;Pa=this.Hc.Mc(4);Pa.Cb(Ab);Ab.properties.setValue(w.a.Oya,Rb-nb);Pa.dispose()}}get xU(){null==this.ML&&(y.AFrameworkApplication.ue("he991617;3eed2178"),this.ML=y.AFrameworkApplication.K?y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.ML}o5d(){return!N.GraphIterator.$a(this.kja).Qd()}nsi(){return this.r9e?1===N.GraphIterator.$a(this.kja).xq():!1}t6h(Pa){try{return this.GQl(Pa)}catch(Ab){return G.ULS.sendTraceTag(23643968,
307,10,"GetCopySourceFromDOMTree failed with exception:{0}",Ab.message),0}}GQl(Pa){let Ab=0;if(Pa&&(Ab=this.FQl(Pa),!Ab&&Pa.childNodes))for(let nb=0;nb<Pa.childNodes.length&&!(Ab=this.t6h(Pa.childNodes[nb]));nb++);return Ab}FQl(Pa){if(1===Pa.nodeType&&Pa.getAttribute){Pa=(Pa.getAttribute("class")||"").split(" ");for(const Ab of Pa)if(Ab.startsWith(this.zhk))return Ab.startsWith(this.EAc)?this.mv&&Ab===this.EAc+this.mv?3:2:1}return 0}jGn(Pa,Ab,nb,Rb,Mb){Mb.Ko||(Mb.Ko={});Sa.ra.raiseEvent("OnParagraphCopy",
new bb(Pa,Ab,nb,Rb,Mb.Ko))}KGn(Pa,Ab,nb,Rb){Rb.Ko||(Rb.Ko={});Sa.ra.raiseEvent("OnCopyComplete",new bb(Pa,null,Ab,nb,Rb.Ko))}YFn(Pa){Pa.Ko||(Pa.Ko={});Sa.ra.raiseEvent("BeforePaste",new $a(Pa.Ko))}XFn(Pa){Pa.Ko||(Pa.Ko={});Sa.ra.raiseEvent("BeforeCopy",new Fa(this.ht,Pa.Ko))}WGn(Pa,Ab,nb,Rb,Mb){Sa.ra.raiseEvent("OnParagraphPaste",new bb(Pa,Ab,nb,Rb,Mb.Ko))}pWh(Pa){aa.TableCellReader.isTableCell(Pa)&&(Pa.Rb(1)||this.lK.h7(Pa,!0),Pa.uc())}qWh(Pa,Ab){this.O2.Nwa(Ab)&&(Ab.width=Pa.width)}static d_e(Pa){Sa.ra.addHandler("OnParagraphCopy",
Pa)}static Azd(Pa){Sa.ra.addHandler("OnParagraphPaste",Pa)}static m_n(Pa){Sa.ra.removeHandler("OnParagraphPaste",Pa)}static pwk(Pa){Sa.ra.addHandler("OnCopyComplete",Pa)}static vvk(Pa){Sa.ra.addHandler("BeforePaste",Pa)}static IZn(Pa){Sa.ra.removeHandler("BeforePaste",Pa)}static tvk(Pa){Sa.ra.addHandler("BeforeCopy",Pa)}static wvk(Pa){Sa.ra.addHandler("BeforeTrimOnCopy",Pa)}static nvk(Pa){Sa.ra.addHandler("AfterTrimCompleteOnCopy",Pa)}static get characterPropertiesEditor(){return null!=Sa.vwg?Sa.vwg:
Sa.vwg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get PJ(){return Ka.a.instance}static get lf(){return ua.PageReader.instance}static yql(Pa){const Ab={};for(const nb of I.a(Pa)){const Rb=Pa[nb];Ab[Rb]=Rb in Ab?String.format("{0}|{1}",Ab[Rb],nb):nb}1<=I.a(Ab).length&&G.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",Ab)}static GRn(Pa,Ab,nb,Rb,Mb,oc){Ab.colSpan>Mb-nb&&(oc&&oc("A",Ab.colSpan,Mb-nb),Ab.colSpan=Mb-nb);Pa=Sa.ewo(Pa,Ab,Rb,nb);Ab.colSpan!==Pa&&(oc&&
oc("B",Ab.colSpan,Pa),Ab.colSpan=Pa)}static HRn(Pa,Ab,nb,Rb,Mb,oc){Ab.rowSpan>Mb-nb&&(oc&&oc("A",Ab.rowSpan,Mb-nb),Ab.rowSpan=Mb-nb);Pa=Sa.fwo(Pa,Ab,nb,Rb);Ab.rowSpan!==Pa&&(oc&&oc("B",Ab.rowSpan,Pa),Ab.rowSpan=Pa)}static ewo(Pa,Ab,nb,Rb){return Sa.Yrj(Pa,Ab.colSpan,(Mb,oc)=>{na.moveToCell(Mb,nb,Rb+oc)})}static fwo(Pa,Ab,nb,Rb){return Sa.Yrj(Pa,Ab.rowSpan,(Mb,oc)=>{na.moveToCell(Mb,nb+oc,Rb)})}static Yrj(Pa,Ab,nb){if(14!==Pa.type)throw Error.argument("tableNode is not a Table.");if(!nb)throw Error.argumentNull("MoveToCellAction");
for(let Mb=1;Mb<Ab;Mb++){var Rb=N.GraphIterator.$a(Pa);nb(Rb,Mb);Rb=Rb.currentNode;if(!Rb||16!==Rb.type||!Rb.gg)return Mb}return Ab}static DGh(Pa,Ab){return Pa+","+Ab}ozn(Pa,Ab){for(;Pa.target.Qd();)Pa.target.wg();Pa.Gkc=new e.a(Ab,Pa.z_i?Pa.z_i:this.DHc,new Eb.a(Pa.source,Pa.target,null,Pa.ZWf));Pa.Gkc.Al("ExecuteCorePasteCellContentInCell");Pa.Gkc.Ig=!1;Pa.Gkc.run()}gdn(Pa){let Ab=!1;if(this.xU&&ra.TableBorderSelectionCache.NPc()){const nb=ea.a(Pa.target),Rb=pa.a.rs(Pa.target);let Mb=this.Mke;isNullOrUndefined(Pa.FZa[Pa.FZa.length-
1])||(Mb=Math.min(Mb,Pa.FZa[Pa.FZa.length-1][0]));let oc=this.Vhg;isNullOrUndefined(Pa.FZa[Pa.FZa.length-1])||(oc=Math.min(oc,Pa.FZa[Pa.FZa.length-1][1]));aa.TableCellReader.eQa(Pa.target)||aa.TableCellReader.eQa(Pa.source)||Rb==Mb&&nb==oc?Ab=!0:(aa.TableCellReader.isTableCell(Pa.target)||Pa.target.hd(16),aa.TableCellReader.Sba(Pa.source)?(aa.TableCellReader.eQa(Pa.target)||(na.moveToNextRow(Pa.target),na.moveToColumnByIndex(Pa.target,Pa.wo),G.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")),
na.moveToNextOrPreviousCell(Pa.source,!1,!1)):aa.TableCellReader.Sba(Pa.target)||nb==oc?(na.moveToNextRow(Pa.source),na.moveToColumnByIndex(Pa.source,0),G.ULS.sendTraceTag(537519906,307,50,"Move to next row to replace cell contents"),na.moveToNextRow(Pa.target),na.moveToColumnByIndex(Pa.target,Pa.wo),G.ULS.sendTraceTag(537519907,307,50,"Move to next row to replace cell contents")):(na.moveToNextOrPreviousCell(Pa.target,!1,!1),na.moveToNextOrPreviousCell(Pa.source,!1,!1)))}else aa.TableCellReader.eQa(Pa.source)?
Ab=!0:(aa.TableCellReader.isTableCell(Pa.target)||Pa.target.hd(16),aa.TableCellReader.Sba(Pa.source)?(na.moveToNextRow(Pa.target),na.moveToColumnByIndex(Pa.target,Pa.wo),G.ULS.sendTraceTag(537716887,307,50,"Move to next row to replace cell contents")):na.moveToNextOrPreviousCell(Pa.target,!1,!1),na.moveToNextOrPreviousCell(Pa.source,!1,!1));Ab&&(this.hZ&&this.hZ.UGn(Pa.target,Pa.FZa),La.TableReader.isTable(Pa.target)||Pa.target.hd(14),this.Hfn(Pa.target.currentNode),G.ULS.sendTraceTag(7869377,307,
50,"End of internal paste table in table"));return Ab}Llo(){this.Mke=ra.TableBorderSelectionCache.z9.bottomMostRowSelected;this.Vhg=ra.TableBorderSelectionCache.z9.rightMostColumnSelected;this.hFo=ra.TableBorderSelectionCache.z9.leftMostColumnSelected;this.Vwj=ra.TableBorderSelectionCache.z9.topMostRowSelected}}Sa.ra=new z.a;Sa.Lyf="PasteConstrainingWidth";Object(E.a)(Sa,"InternalClipboard",null,[])},1941:function(E,M,c){E=c(0);var m=c(2),e=c(126),a=c(58),l=c(238),y=c(22),z=c(19),n=c(83),v=c(177),
A=c(15),w=c(42),G=c(6),F=c(7),I=c(73),K=c(44),J=c(31),N=c(304),R=c(86),O=c(12),L=c(5),U=c(101),W=c(18),X=c(36),V=c(245),Z=c(40),da=c(247),aa=c(21),ea=c(78),na=c(149),pa=c(873),ja=c(3),ma=c(84),Ia=c(60),Ja=c(9),Ka=c(93),Ma=c(43),sa=c(473),xa=c(589),ia=c(224),ha=c(17),ua=c(23),ya=c(46),ra=c(32),La=c(234),oa=c(8),Ca=c(1542),Aa=c(1561),db=c(293),eb=c(171),ib=c(65),lb=c(502),Ya=c(48);class Fa extends db.a{constructor(bb,Gb,Sa,Pa,Ab,nb,Rb,Mb){super();this.peh=this.Iw=null;this.init(bb);this.Al("FormattingViewOperation");
this.Oib(m.AFrameworkApplication.va,Gb,Pa,Ab,nb);this._context=Sa;this.F8a=0;this.Fs=!0;this.d2j=Rb;this.Sm=Mb}get eba(){return this.Sm.instance}run(){const bb=this._context.view;var Gb=null;bb.qe&&(Gb=bb.mb);if(Gb){var Sa=Gb.hb.kb,Pa=!Aa.a.N$b(this.actionId);!Sa||Fa.Vf.PFf(Sa,Pa)?(Fa.Ic.Yb(ma.a.kf,{["Reason"]:Ia.a.VE}),this.Fs=!1):this.eba&&this.eba.eac(Sa)?(Fa.Ic.Yb(ma.a.kf,{["Reason"]:Ia.a.externalSelection}),this.Fs=!1):Fa.Wg.pza(oa.ParagraphReader.mU,Gb.sg)&&(Fa.Ic.Yb(ma.a.kf,{["Reason"]:Ia.a.dO}),
this.Fs=!1)}else Fa.Ic.Yb(ma.a.kf,{["Reason"]:Ia.a.oca}),this.Fs=!1;1!==this.behavior&&this.Fs||(this.Fs&&(Sa=Gb.hb.kb,1===Gb.hb.length&&1===Sa.length&&ha.SelectionEditor.ml(Sa.Qa)&&ea.b(Sa.Qa)&&(Fa.Ic.Yb(ma.a.kf,{["Reason"]:Ia.a.dHc}),this.Fs=!1)),(Sa=this.Fs)&&this.actionId===ja.a.b5&&((Sa=Array.from(Gb.hb.kb).some(U.FormattingReader.k9e))||Fa.Ic.Yb(ma.a.kf,{["Reason"]:Ia.a.Iff})),this.mr=Sa?32:8,this.F8a=3);this.F8a||(eb.a.mark(5730),this.peh=lb.SelectionReferenceFactory.instance.hBb(),Sa=Gb.hb.kb.Qa,
this.Iw=new Ma.GraphTransaction(15),this.Iw.Cb(Sa.node),this.Iw.fk=this.actionId,this.F8a=1);if(1===this.F8a){this.sC||this.A6c(this._context.$j);if(1===this.d5a())return;this.F8a=2}if(2===this.F8a){if(this.actionId===ja.a.b5)if(Gb=Gb.sg,Gb.Ww)for(Sa=0;Sa<Gb.length;Sa++)Pa=Gb.getContext(Sa),this.aCj(Pa);else this.aCj(Gb);Ya.a.y9e&&this.CLo(this.actionId,this.vd);this.peh.Qpa(this.actionId===ja.a.GY||this.actionId===ja.a.Yta);(Gb=Object(I.a)(21,this.vd))&&!Gb.fTa||ib.FocusManager.instance().mg(bb.$I);
this.Iw.dispose();this.Iw=null;Ja.App.ya.updateCommandUI();eb.a.mark(5731);this.F8a=3;this.mr=32}3===this.F8a&&(this.d2j.process(this.actionId,this._context,this.behavior,this.response),this.gqa())}CLo(bb,Gb){const Sa={};Sa.FormattingActionId=bb;Sa.FormattingActionData=Gb;8===this.ga.Qb(ja.a.DAd,2,Sa)&&F.ULS.sendTraceTag(509110153,368,10,"Command applyFormattingToContentControls failed! ActionId '{0}', ActionData '{1}'",bb,Gb)}aCj(bb){(ha.SelectionEditor.hv(bb)||ha.SelectionEditor.Fk(bb))&&Ja.App.dN.cda(bb.node)}static get Vf(){return La.a.instance}static get Wg(){return ia.ContextSetEditor.instance}static get Ic(){return v.a.instance}}
Object(E.a)(Fa,"FormattingViewOperation",db.a,[]);var $a=c(1028),Db=c(939),gc=c(68);c.d(M,"a",function(){return kb});const Eb=new Set([ja.a.G_,ja.a.U0,ja.a.clearFormatting,ja.a.HCa,ja.a.ICa,ja.a.CZa,ja.a.Wta,ja.a.DZa]);class kb{constructor(bb,Gb,Sa=null,Pa,Ab,nb,Rb,Mb,oc,xb,cc,Ob,Ub){this.kpiName="ChangeCaseCommandUsage";this.W7="wwaengidc";this.skb=new Map;this.l5g=new Set;this.nDb=()=>new pa.a(2);this.a4i=(pb,Zb,Wa,Lb,qc)=>{Lb=!0;Zb.contextId!==O.a.view&&(Lb=!1);if(1===Wa&&!Lb)return 8;if(pb===
ja.a.n2c)pb=qc.formatting,qc=qc.$eg;else{if(!Zb.view||!Zb.view.qe)return 2;Zb=Zb.view;if(!Zb.mb||!Zb.mb.hb.kb)return 8;pb=qc;qc=Zb.mb.hb}this.Q1k(qc,pb);return 32};this.R0e=(pb,Zb,Wa,Lb,qc,Ra)=>new Fa(pb,Zb,Wa,Lb,qc,Ra,this.J2j,kb.Vw());this.zAd=(pb,Zb,Wa,Lb,qc)=>{var Ra,yb,Bb;let cb=!0,Xa=Zb;const hb=!Aa.a.N$b(pb);Zb.contextId!==O.a.Hd&&Zb.contextId!==O.a.Tc?cb=!1:(kb.Vf.A8(Xa,!1,hb)&&(kb.Ic.Yb(ma.a.en,{["Reason"]:Ia.a.VE}),cb=!1),kb.Vw()&&kb.Vw().instance&&kb.Vw().instance.qU(Xa)&&(cb=!1),cb&&ha.SelectionEditor.ml(Zb)&&
ea.b(Xa)&&(kb.Ic.Yb(ma.a.en,{["Reason"]:Ia.a.dHc}),cb=!1),oa.ParagraphReader.mU(Zb)&&(kb.Ic.Yb(ma.a.kf,{["Reason"]:Ia.a.dO}),cb=!1));if(1===Wa||!cb)return cb?32:8;if(Zb.contextId===O.a.Tc)return 2;(Zb=null===(Ra=this.Co)||void 0===Ra?void 0:Ra.gRd(Xa))&&(Xa=Zb);this.lso(pb)&&(Ra=ha.SelectionEditor.fQb(Xa),ha.SelectionEditor.gf(Ra)||(Xa=Ra));Ra="boolean"===typeof qc&&qc;Zb=!1;(null===(yb=this.asa)||void 0===yb?0:yb.annotateRange)&&(null===(Bb=this.asa)||void 0===Bb?0:Bb.uHb(Xa.node))&&(Zb=this.XZ(Xa,
pb,qc,Ra));Zb&&pb!==ja.a.b5||kb.Gqa.XZ(Xa,Cb=>{this.Bic(Cb,pb,qc,Xa.cpEnd)},Ra);Xa.node.vr&&(yb=[Object.assign(new J.a,{name:"Source",string:"CharacterFormatting"})],K.a("TOCFormatting",!0,void 0,yb));this.iFm(pb)&&this.XCd(Xa,pb);Lb&&Ca.a.zpb&&(Lb.ks|=Ca.a.jhb(Xa.node));return 32};this.l$c=(pb,Zb,Wa)=>1!==Wa&&2===Wa?(this.skb.set("Source","Shortcut"),pb=Zb.node.characterData.substr(Zb.cpBegin,Zb.cpEnd-Zb.cpBegin),kb.kGf(pb,0,pb.length)?this.XCd(Zb,ja.a.HCa):kb.$Qm(pb,pb.length)?this.XCd(Zb,ja.a.Wta):
this.XCd(Zb,ja.a.ICa)):32;this.veb=(pb,Zb,Wa)=>{let Lb=!0;pb=!Aa.a.N$b(pb);Zb.contextId!==O.a.Hd&&Zb.contextId!==O.a.Tc?Lb=!1:(kb.Vf.A8(Zb,!1,pb)&&(kb.Ic.Yb(ma.a.en,{["Reason"]:Ia.a.VE}),Lb=!1),Lb&&ha.SelectionEditor.ml(Zb)&&ea.b(Zb)&&(kb.Ic.Yb(ma.a.en,{["Reason"]:Ia.a.dHc}),Lb=!1),Lb&&oa.ParagraphReader.mU(Zb)&&(kb.Ic.Yb(ma.a.kf,{["Reason"]:Ia.a.dO}),Lb=!1));if(1===Wa||!Lb)return Lb?32:8;Zb=Zb.node;this.Is.w2b(Zb,!1);Zb.vr&&(Zb=[Object.assign(new J.a,{name:"Source",string:"ClearFormatting"})],K.a("TOCFormatting",
!0,void 0,Zb));return 32};this.dGc=(pb,Zb,Wa,Lb,qc)=>{pb={};pb[$a.a.SIa]=6168;pb[$a.a.RIa]=6169;const Ra=Zb.view;var yb=null;Ra.Vi&&(yb=Ra);var Bb=!0;let cb=32;yb&&(yb=yb.mb.hb.kb)&&(kb.Vf.PFf(yb)?(kb.Ic.Yb(ma.a.kf,{["Reason"]:Ia.a.VE}),cb=8,Bb=!1):1===Wa&&(cb=32,Bb=!1));Bb&&(Bb=new Ma.GraphTransaction(1===Wa?3:15),Bb.Cb(Ra.root),cb=$a.a.tpa(ja.a.veb,Zb,Wa,Lb,qc,pb,12),Bb.dispose());return cb};this.$0e=(pb,Zb,Wa,Lb,qc)=>{var Ra,yb=!0,Bb=32;const cb=!Aa.a.N$b(pb);Zb.contextId!==O.a.Tc?yb=!1:kb.Vf.A8(Zb,
!1,cb)&&(kb.Ic.Yb(ma.a.en,{["Reason"]:Ia.a.VE}),yb=!1);if(1===Wa||!yb)return yb?32:8;Wa=Zb.node;pb===ja.a.clearFormatting&&(kb.Un.eGc(Wa),this.Is.eEh(Wa),yb=this.Sy.JC(Wa).Fi(this.Sy.wordStyleIdNormal),this.Qu.HJ(yb,Wa,!0));Wa=kb.pj.Gtf(Zb);!Wa&&(yb=null===(Ra=this.Co)||void 0===Ra?void 0:Ra.gRd(Zb))&&(Zb=yb,Wa=ua.SelectionFactory.ho(Zb));if(Wa)Bb=ya.a.cBb(Wa),Bb=m.AFrameworkApplication.va.Nf(Bb,pb,2,!1,Lb,qc);else{Lb=Object(I.a)(21,qc);Ra=U.FormattingReader.Kr(Zb);if(!Ra)return 16;Ra=Ra.cache;switch(pb){case ja.a.font:kb.Y_h();
if(Lb&&Lb.vd){const {fontName:Xa,qda:hb,bold:Cb,italic:ob}=kb.Ypf(Lb.vd);kb.pj.ege(Xa);kb.pj.Ibg(hb);Object(sa.a)()&&(pb=1==Cb,qc=1==ob,pb||qc)&&(kb.pj.nL(pb),kb.pj.setItalic(qc))}break;case ja.a.Mv:F.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");kb.pj.Mv(qc);break;case ja.a.fqa:kb.pj.Mv(qc);this.recentColors.odb(qc)||F.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.qfa:kb.pj.qfa();break;case ja.a.GY:F.ULS.sendTraceTag(594899722,
340,50,"Font background color is selected from Standard colors.");kb.pj.zya(qc);break;case ja.a.F9:kb.pj.zya(qc);this.recentColors.odb(qc)||F.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ja.a.Yta:kb.pj.EDd();break;case ja.a.LA:kb.Y_h();kb.pj.LA(Lb.vd);break;case ja.a.G_:pb=kb.pj.xG(A.a.fontSize,Ra.fontSize);kb.pj.LA(this.ve.G_(pb));break;case ja.a.U0:pb=kb.pj.xG(A.a.fontSize,Ra.fontSize);kb.pj.LA(this.ve.U0(pb));break;case ja.a.bold:pb=
kb.pj.xG(A.a.bold,Ra.isBold);kb.pj.nL(!pb);break;case ja.a.setItalic:pb=kb.pj.xG(A.a.italic,Ra.isItalic);kb.pj.setItalic(!pb);break;case ja.a.underline:pb=kb.pj.xG(A.a.underline,Ra.isUnderline);kb.pj.e5(!pb);break;case ja.a.Uia:kb.pj.Uia(qc);break;case ja.a.superscript:pb=kb.pj.xG(A.a.superscript,Ra.isSuperscript);kb.pj.iqa(!pb);break;case ja.a.subscript:pb=kb.pj.xG(A.a.subscript,Ra.isSubscript);kb.pj.BHa(!pb);break;case ja.a.strikethrough:pb=kb.pj.xG(A.a.strikethrough,Ra.isStrikethrough);kb.pj.Ria(!pb);
break;case ja.a.ot:pb=kb.pj.xG(w.a.ot,Ra.isDoubleStrikethrough);kb.pj.Zfe(!pb);break;case ja.a.clearFormatting:kb.pj.K5a();break;case ja.a.b5:qc.hasProperty(A.a.bL)&&kb.pj.b5(qc.getValue(A.a.bL));qc.hasProperty(G.a.noProof)&&(pb=qc.getValue(G.a.noProof),kb.pj.Nio(pb));break;default:this.l5g.has(pb)||(this.l5g.add(pb),(qc=e.ActionManager.raa(pb))&&qc.length||(qc="UnknownAction"),F.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${qc} (${pb})`))}}Ja.App.ya.updateCommandUI();
return Bb};this.hT=(pb,Zb,Wa,Lb,qc)=>{Lb=kb.Ic.zp(ja.a.Ifo);var Ra=!0;Zb.contextId!==O.a.endOfParagraph&&(Ra=!1);if(1===Wa||!Ra)return Ra?32:8;Wa=Zb.node;Ra=L.GraphIterator.$a(Zb.node);Ra.yd();Ra=Ra.Oga(4);if((Ra=!!Ra&&kb.Gd.Tba(Ra))&&!Ja.App.Gcc)return 8;var yb=!oa.ParagraphReader.textLength(Wa);Lb.properties.Z("Action",pb.toString());Lb.properties.Z("ListContext",Ra.toString());Lb.properties.Z("IsEmptyParagraph",yb.toString());F.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",
pb,Ra,yb);Ra=Wa.pa.last;this.YYn(Wa,pb);var Bb=!!Ra.formatting;const cb=Wa.getValue(G.a.endOfParagraphFormatting);yb=this.Kd.c0a(Wa);Bb=!Bb&&cb&&cb.equals(a.a.nil)?new na.a(Ra,a.a.nil):yb.Ef(yb.Ib);this.Bic(yb,pb,qc,Ra.cp);R.a.instance.J(1)&&kb.lj.QNb(Wa,Ra,Zb.cpBegin,Zb.cpEnd,Bb,yb,kb.Ld.qg);Lb.end();return 32};this.Qla=(pb,Zb,Wa)=>{pb=!0;const Lb=L.GraphIterator.$a(Zb.node);Lb.yd();Zb.contextId===O.a.endOfParagraph&&Lb.Oga(4)||(kb.Ic.Yb(ma.a.en,{["Reason"]:Ia.a.wJf}),pb=!1);return kb.Gd.Tba(Lb.currentNode)?
1!==Wa&&pb?32:pb?32:8:8};this.Hpa=(pb,Zb,Wa,Lb,qc)=>{pb=!0;Zb.contextId!==O.a.paragraph&&(pb=!1);if(1===Wa&&!pb)return 8;Wa=Zb.node;-1!==qc.Hh?qc.Hh!==oa.ParagraphReader.Cx(Wa)&&(qc.Hh=0):qc.Hh=oa.ParagraphReader.Cx(Wa);pb=this.Uo.Ahb(Wa);qc.tt?(!qc.Pom&&this.Som(qc.tt,pb)&&2===qc.tt.specialIndentType&&(qc.tt.specialIndentType=0),qc.tt.bGb===pb.bGb&&l.a.vwa(qc.tt.xB,pb.xB)||(qc.tt.xB=Number.MAX_VALUE),qc.tt.cGb===pb.cGb&&l.a.vwa(qc.tt.Xna,pb.Xna)||(qc.tt.Xna=Number.MAX_VALUE)):qc.tt=pb;Zb=kb.Wg.hvh(Zb.$j);
void 0!==Zb&&null!==Zb&&(Zb=Zb.node,void 0!==Zb&&null!==Zb&&(Zb=V.WordSectionNavigator.instance.wJ(Zb),void 0!==Zb&&null!==Zb&&(Zb=kb.Sf.Vt(Zb)-(kb.Sf.gJ(Zb)+kb.Sf.VK(Zb)+Ja.App.uza),pb.VRc=Zb-pb.xB,pb.URc=Zb-pb.Xna,qc.tt.URc=Math.min(qc.tt.URc,pb.URc),qc.tt.VRc=Math.min(qc.tt.VRc,pb.VRc))));Zb=this.UV.sEa(Wa);qc.spacing?(qc.spacing.beforeSpacing=kb.Uqh(Zb.beforeSpacing,qc.spacing.beforeSpacing),qc.spacing.afterSpacing=kb.Uqh(Zb.afterSpacing,qc.spacing.afterSpacing),qc.spacing.lineSpacing.unit===
Zb.lineSpacing.unit&&l.a.vwa(qc.spacing.lineSpacing.value,Zb.lineSpacing.value)||(qc.spacing.lineSpacing.unit=0,qc.spacing.lineSpacing.value=0)):qc.spacing=Zb;Zb=new L.GraphIterator;Zb.set(Wa);Zb.zb(11);if(Wa=Zb.hd(11))qc.isRtl=Z.OutlineElementReader.$m(Wa);Wa=kb.Gd.hw(Zb);Zb=16;void 0!==Wa&&null!==Wa&&(Zb=Wa.listType);qc.listType=kb.oRl(qc.listType,Zb);qc.Hx=16===qc.listType?null:Wa;return 32};this.EJn=(pb,Zb,Wa,Lb,qc)=>{qc.isRtl=Z.OutlineElementReader.$m(X.OutlineElementNavigator.Il(Zb.node));return 32};
this.Tth=(pb,Zb,Wa)=>{if(pb===ja.a.kOb)pb=!0;else if(pb===ja.a.jOb)pb=!1;else return 2;pb&&this.FJi(Zb);if(1===Wa)return 32;this.nh.cOb(X.OutlineElementNavigator.Il(Zb.node),pb);return 32};this.uJn=(pb,Zb,Wa,Lb,qc)=>{pb=Zb.node;qc.isRtl=Z.OutlineElementReader.isRtl(X.OutlineElementNavigator.Il(pb));qc.Hh=W.ImageReader.Cx(pb);return 32};this.FKn=(pb,Zb,Wa,Lb,qc)=>{pb=Zb.node;qc.isRtl=Z.OutlineElementReader.isRtl(X.OutlineElementNavigator.Il(pb));qc.Hh=ra.TableReader.Cx(pb);-1!==qc.Hh&&qc.Hh||(qc.Hh=
qc.isRtl?3:1);return 32};this.j1e=(pb,Zb,Wa,Lb,qc)=>{let Ra;if(!({fy:Ra}=Aa.a.Scg(Wa,Zb)).returnValue)return Ra;const yb=Zb.node;switch(pb){case ja.a.jOb:this.nh.Yic(yb,!1);break;case ja.a.kOb:this.FJi(Zb);this.nh.Yic(yb,!0);break;case ja.a.b5:Ra=m.AFrameworkApplication.va.Nf(Zb.$j,pb,Wa,!0,Lb,qc),32===Ra&&oa.ParagraphReader.lm(Zb)&&kb.X1c&&kb.X1c.cda(yb)}return 32};this.QWk=(pb,Zb,Wa,Lb,qc)=>{const Ra={};Ra[$a.a.SIa]=6168;Ra[$a.a.RIa]=6169;var yb=Zb.view;const Bb=new Ma.GraphTransaction(1===Wa?3:
15);Bb.Cb(yb.root);let cb=$a.a.tpa(pb,Zb,Wa,Lb,qc,Ra,0),Xa=null;yb.Vi&&(Xa=yb);yb=!0;let hb=null;Xa&&(hb=Xa.mb.hb.kb)&&(pb=!Aa.a.N$b(pb),kb.Vf.PFf(hb,pb)?(kb.Ic.Yb(ma.a.kf,{["Reason"]:Ia.a.VE}),cb=8,yb=!1):1===Wa&&(cb=32,yb=!1),kb.Wg.pza(oa.ParagraphReader.mU,Xa.mb.sg)&&(kb.Ic.Yb(ma.a.kf,{["Reason"]:Ia.a.dO}),cb=8,yb=!1));yb&&this.eRm(hb)&&(cb=$a.a.tpa(ja.a.veb,Zb,Wa,Lb,qc,Ra,12));Bb.dispose();return cb};this.PWk=(pb,Zb,Wa)=>{pb=!0;Zb.contextId!==O.a.paragraph&&Zb.contextId!==O.a.Tc?pb=!1:kb.Vf.e3a(Zb)&&
(kb.Ic.Yb(ma.a.en,{["Reason"]:Ia.a.VE}),pb=!1);if(1===Wa||!pb)return pb?32:8;Zb=Zb.node;Wa=new Ma.GraphTransaction(15);Wa.Cb(Zb);kb.Un.eGc(Zb);this.Is.w2b(Zb,!0);this.Qu.f7e(Zb);Wa.dispose();return 2};this.tkm=(pb,Zb,Wa)=>{pb=!0;Zb.contextId!==O.a.view&&(pb=!1);if(1===Wa&&!pb)return 8;if(!Zb.view||!Zb.view.qe)return 2;Zb=Zb.view;if(!Zb.mb||!Zb.mb.hb.kb)return 8;if(kb.Wg.pza(oa.ParagraphReader.mU,Zb.mb.sg))return kb.Ic.Yb(ma.a.kf,{["Reason"]:Ia.a.dO}),8;Zb=Zb.mb.hb;for(const Lb of Zb)for(const qc of Lb)if(qc&&
qc.contextId!==O.a.Hd&&qc.contextId!==O.a.Tc&&qc.contextId!==O.a.paragraph&&qc.contextId!==O.a.endOfParagraph)return 2;return 32};this.j5a=(pb,Zb,Wa,Lb,qc)=>{pb=!0;Zb.contextId!==O.a.paragraph&&(pb=!1);if(1===Wa&&!pb)return 8;qc.tt||(Zb=Zb.node,Wa=this.Uo.Ahb(Zb),qc.tt=Wa,Zb=X.OutlineElementNavigator.Il(Zb),qc.isRtl=Zb?Z.OutlineElementReader.$m(Zb):!1);return 32};this.GKn=(pb,Zb,Wa,Lb,qc)=>{Zb=Zb.node;pb=X.OutlineElementNavigator.Il(Zb);qc.tt||(Zb=this.G5l(Zb),Zb=this.Uo.Ahb(Zb),qc.tt=Zb,qc.isRtl=
Z.OutlineElementReader.isRtl(pb));return 32};this.J2j=bb;this.asa=Gb;this.n6=Sa;this.Co=Pa;this.ve=Ab;this.Kd=nb;this.Is=Rb;this.UV=Mb;this.Qu=xb;this.Sy=oc;this.nh=cc;this.Uo=Ub}get recentColors(){return null!=this.AFg?this.AFg:this.AFg=y.a.instance.Na("Box4.UI.RecentColorsSectionHandler")}get IMd(){return!!this.n6&&this.n6.enabled}Tb(){const bb=m.AFrameworkApplication.va,Gb=this.EJn;(kb.Xb?kb.Xb.vA(42):m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled"))?
(bb.qa(ja.a.font,O.a.endOfParagraph,this.hT),bb.qa(ja.a.LA,O.a.endOfParagraph,this.hT),bb.qa(ja.a.G_,O.a.endOfParagraph,this.hT),bb.qa(ja.a.U0,O.a.endOfParagraph,this.hT),bb.qa(ja.a.Mv,O.a.endOfParagraph,this.hT),bb.qa(ja.a.fqa,O.a.endOfParagraph,this.hT),bb.qa(ja.a.qfa,O.a.endOfParagraph,this.hT),bb.qa(ja.a.GY,O.a.endOfParagraph,this.hT),bb.qa(ja.a.F9,O.a.endOfParagraph,this.hT),bb.qa(ja.a.Yta,O.a.endOfParagraph,this.hT),bb.qa(ja.a.bold,O.a.endOfParagraph,this.hT),bb.qa(ja.a.setItalic,O.a.endOfParagraph,
this.hT),bb.qa(ja.a.underline,O.a.endOfParagraph,this.hT),bb.qa(ja.a.Uia,O.a.endOfParagraph,this.hT),bb.qa(ja.a.superscript,O.a.endOfParagraph,this.hT),bb.qa(ja.a.subscript,O.a.endOfParagraph,this.hT),bb.qa(ja.a.strikethrough,O.a.endOfParagraph,this.hT),bb.qa(ja.a.ot,O.a.endOfParagraph,this.hT),bb.qa(ja.a.b5,O.a.endOfParagraph,this.hT),bb.qa(ja.a.clearFormatting,O.a.endOfParagraph,this.hT)):Ja.App.Gcc&&(bb.qa(ja.a.font,O.a.endOfParagraph,this.Qla),bb.qa(ja.a.LA,O.a.endOfParagraph,this.Qla),bb.qa(ja.a.Mv,
O.a.endOfParagraph,this.Qla),bb.qa(ja.a.fqa,O.a.endOfParagraph,this.Qla),bb.qa(ja.a.qfa,O.a.endOfParagraph,this.Qla),bb.qa(ja.a.bold,O.a.endOfParagraph,this.Qla),bb.qa(ja.a.setItalic,O.a.endOfParagraph,this.Qla),bb.qa(ja.a.superscript,O.a.endOfParagraph,this.Qla),bb.qa(ja.a.subscript,O.a.endOfParagraph,this.Qla),bb.qa(ja.a.strikethrough,O.a.endOfParagraph,this.Qla),bb.qa(ja.a.ot,O.a.endOfParagraph,this.Qla),bb.qa(ja.a.G_,O.a.endOfParagraph,this.Qla),bb.qa(ja.a.U0,O.a.endOfParagraph,this.Qla));const Sa=
Ja.App.NTa.OHc(Pa=>xa.OutlineElementGeneralizer.gna(Pa.hb,!0));bb.fb(ja.a.f6e,O.a.view,this.tkm,100);bb.fb(ja.a.l$c,O.a.Hd,this.l$c,1028);bb.qa(ja.a.g5a,O.a.view,this.a4i);bb.qa(ja.a.n2c,O.a.view,this.a4i);bb.qa(ja.a.Hpa,O.a.view,Sa);bb.qa(ja.a.Hpa,O.a.paragraph,this.Hpa);bb.qa(ja.a.Hpa,O.a.image,this.uJn);bb.qa(ja.a.Hpa,O.a.unsupportedObject,Gb);bb.qa(ja.a.Hpa,O.a.table,this.FKn);bb.qa(ja.a.j5a,O.a.view,Sa);bb.qa(ja.a.j5a,O.a.paragraph,this.j5a);bb.qa(ja.a.j5a,O.a.table,this.GKn);bb.Vc(ja.a.g5a,
99);bb.Vc(ja.a.n2c,1127);bb.Vc(ja.a.Hpa,97);bb.Vc(ja.a.j5a,97);this.aM(bb,ja.a.font);this.aM(bb,ja.a.LA);this.aM(bb,ja.a.G_);this.aM(bb,ja.a.U0);bb.ldb(ja.a.v0h,O.a.view,this.R0e);bb.Vc(ja.a.v0h,1092);this.aM(bb,ja.a.Mv);this.aM(bb,ja.a.fqa);this.aM(bb,ja.a.qfa);this.aM(bb,ja.a.GY);this.aM(bb,ja.a.F9);this.aM(bb,ja.a.CZa);this.aM(bb,ja.a.HCa);this.aM(bb,ja.a.ICa);this.aM(bb,ja.a.Wta);this.aM(bb,ja.a.DZa);this.aM(bb,ja.a.Yta);this.aM(bb,ja.a.bold);bb.JNb(ja.a.bold,this.nDb);this.aM(bb,ja.a.setItalic);
bb.JNb(ja.a.setItalic,this.nDb);this.aM(bb,ja.a.underline);bb.JNb(ja.a.underline,this.nDb);this.aM(bb,ja.a.Uia);this.aM(bb,ja.a.superscript);bb.JNb(ja.a.superscript,this.nDb);this.aM(bb,ja.a.subscript);bb.JNb(ja.a.subscript,this.nDb);this.aM(bb,ja.a.strikethrough);bb.JNb(ja.a.strikethrough,this.nDb);this.aM(bb,ja.a.ot);bb.JNb(ja.a.ot,this.nDb);bb.fb(ja.a.OPa,O.a.Hd,this.zAd,96);bb.ldb(ja.a.b5,O.a.view,this.R0e);bb.qa(ja.a.b5,O.a.paragraph,this.j1e);bb.qa(ja.a.b5,O.a.Hd,this.zAd);bb.qa(ja.a.b5,O.a.Tc,
this.$0e);bb.qa(ja.a.clearFormatting,O.a.view,this.QWk);bb.qa(ja.a.clearFormatting,O.a.paragraph,this.PWk);bb.qa(ja.a.clearFormatting,O.a.Hd,this.zAd);bb.qa(ja.a.clearFormatting,O.a.Tc,this.$0e);bb.Vc(ja.a.clearFormatting,1036);bb.qa(ja.a.veb,O.a.Hd,this.veb);bb.qa(ja.a.veb,O.a.Tc,this.veb);bb.qa(ja.a.dGc,O.a.view,this.dGc);bb.qa(ja.a.jOb,O.a.view,Aa.a.Wv);bb.qa(ja.a.jOb,O.a.paragraph,this.j1e);bb.qa(ja.a.jOb,O.a.unsupportedObject,this.Tth);bb.Vc(ja.a.jOb,1028);bb.qa(ja.a.kOb,O.a.view,Aa.a.Wv);bb.qa(ja.a.kOb,
O.a.paragraph,this.j1e);bb.qa(ja.a.kOb,O.a.unsupportedObject,this.Tth);bb.Vc(ja.a.kOb,1028)}aM(bb,Gb){bb.ldb(Gb,O.a.view,this.R0e);bb.qa(Gb,O.a.Hd,this.zAd);bb.qa(Gb,O.a.Tc,this.$0e);bb.Vc(Gb,1036)}Q1k(bb,Gb){for(const Mb of bb)for(const oc of Mb){bb=null;if(oc.contextId===O.a.Hd){if(ea.b(oc))continue;bb=[];var Sa=oc.node.pa;if(Sa){var Pa=Sa.length-1;const xb=oc.cpBegin,cc=oc.cpEnd;let Ob=!1;const Ub=oc.node.characterData;if(Ub&&""!==Ub){var Ab=Ub.substr(xb,cc-xb);Ab&&""!==Ab&&z.a.t9e(Ab,0,Ab.length)&&
(Ob=!0)}Ab=!1;for(let pb=0;pb<Pa;pb++){var nb=Sa.J(pb).cp,Rb=Sa.J(pb+1).cp;if(Sa.J(pb).formatting&&Math.max(nb,xb)<Math.min(Rb,cc)){if(Ub&&""!==Ub&&(nb=nb<xb?xb:nb,Rb=Ub.substr(nb,(Rb<cc?Rb:cc)-nb),!Ob&&z.a.t9e(Rb,0,Rb.length)))continue;Ab=!0;bb.push(Sa.J(pb).formatting)}else if(Ab)break}Sa.J(Pa).formatting&&oc.cpEnd>Sa.J(Pa).cp&&bb.push(Sa.J(Pa).formatting)}}else if(oc.contextId===O.a.paragraph&&!oa.ParagraphReader.mU(oc)){if(bb=[],Sa=oc.node.pa)for(Pa=0;Pa<Sa.length;Pa++)Sa.J(Pa).formatting&&bb.push(Sa.J(Pa).formatting)}else if(oc.contextId===
O.a.endOfParagraph)bb=[U.FormattingReader.Kr(oc)];else if(oc.contextId===O.a.Tc){this.dJn(oc,Gb);return}if(bb&&0<bb.length)for(const xb of bb)if(U.FormattingReader.Llg(Gb,xb.cache,oc))return}}dJn(bb,Gb){if(bb=U.FormattingReader.Kr(bb)){bb=bb.cache;var Sa=kb.pj.xG(A.a.bold,bb.isBold);Gb.bold=Sa?1:0;Sa=kb.pj.xG(A.a.italic,bb.isItalic);Gb.italic=Sa?1:0;Sa=kb.pj.xG(A.a.underline,bb.isUnderline);Gb.underline=Sa?1:0;Gb.underlineType=kb.pj.xG(A.a.underlineType,bb.underlineType);Sa=kb.pj.xG(A.a.superscript,
bb.isSuperscript);Gb.superscript=Sa?1:0;Sa=kb.pj.xG(A.a.subscript,bb.isSubscript);Gb.subscript=Sa?1:0;Sa=kb.pj.xG(A.a.strikethrough,bb.isStrikethrough);Gb.strikethrough=Sa?1:0;Sa=kb.pj.xG(w.a.ot,bb.isDoubleStrikethrough);Gb.ot=Sa?1:0;Sa=kb.pj.xG(A.a.font,bb.rG);Gb.fontName=Ka.a.V0a(Sa);Gb.qda=bb.He;Gb.fontSize=kb.pj.xG(A.a.fontSize,bb.fontSize);Gb.fontColor=kb.pj.xG(A.a.fontColor,bb.fontColor);Gb.highlight=kb.pj.xG(A.a.highlight,bb.highlight)}}lso(bb){return bb===ja.a.underline||bb===ja.a.Uia||bb===
ja.a.strikethrough||bb===ja.a.ot||bb===ja.a.GY}static Ypf(bb){return"string"===typeof bb?{fontName:bb,qda:-1,bold:2,italic:2}:bb}XZ(bb,Gb,Sa,Pa){var Ab;const nb=bb.cpBegin,Rb=bb.cpEnd,Mb=bb.node;var oc=U.FormattingReader.Kr(bb);let xb=nb;const cc=null===(Ab=m.AFrameworkApplication.K)||void 0===Ab?void 0:Ab.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);Ab=kb.Ld.qg;if(cc&&(Ab||Mb.Qs))return!1;if(Eb.has(Gb))for(const Ob of Mb.pa)if(!(Ob.cp<=nb)){if(Ob.cp>=Rb)break;Ob.formatting&&
Ob.formatting.cache.fontSize!=oc.cache.fontSize&&(oc=this.cqf(bb.node,oc,Gb,Sa,cc?null:Pa),this.asa.annotateRange(bb.node,cc?Mb.pa.R_a(xb):xb,cc?Mb.pa.R_a(Ob.cp):Ob.cp,oc),xb=Ob.cp,oc=Ob.formatting)}Gb=this.cqf(bb.node,oc,Gb,Sa,cc?null:Pa);this.asa.annotateRange(bb.node,cc?Mb.pa.R_a(xb):xb,cc?Mb.pa.R_a(Rb):Rb,Gb);return!0}cqf(bb,Gb,Sa,Pa,Ab){const nb={},Rb=Object(I.a)(21,Pa),Mb=Gb.cache;switch(Sa){case ja.a.bold:2===Pa.value&&(Pa.value=Mb.isBold?0:1);nb[A.a.bold.id]=1===Pa.value;break;case ja.a.setItalic:2===
Pa.value&&(Pa.value=Mb.isItalic?0:1);nb[A.a.italic.id]=1===Pa.value;break;case ja.a.underline:2===Pa.value&&(Pa.value=Mb.isUnderline?0:1);nb[A.a.underline.id]=1===Pa.value;break;case ja.a.Uia:nb[A.a.underlineType.id]=Pa.number;break;case ja.a.superscript:2===Pa.value&&(Pa.value=Mb.isSuperscript?0:1);nb[A.a.superscript.id]=1===Pa.value;1===Pa.value&&(nb[A.a.subscript.id]=!1);break;case ja.a.subscript:2===Pa.value&&(Pa.value=Mb.isSubscript?0:1);nb[A.a.subscript.id]=1===Pa.value;1===Pa.value&&(nb[A.a.superscript.id]=
!1);break;case ja.a.strikethrough:6!==m.AFrameworkApplication.va.zD?F.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):F.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===Pa.value&&(Pa.value=Mb.isStrikethrough?0:1);nb[A.a.strikethrough.id]=1===Pa.value;break;case ja.a.ot:2===Pa.value&&(Pa.value=Mb.isDoubleStrikethrough?0:1);nb[w.a.ot.id]=1===Pa.value;break;case ja.a.font:if(Rb&&Rb.vd){const {fontName:xb,qda:cc,bold:Ob,italic:Ub}=kb.Ypf(Rb.vd);
Pa=xb.substr(0,kb.dMi);this.IMd&&(nb[G.a.iT.id]=Pa,nb[G.a.xC.id]=Pa,nb[G.a.h_.id]=Pa,nb[G.a.J_.id]=Pa,nb[G.a.Ke.id]=cc,nb[G.a.Xe.id]=cc,nb[G.a.Je.id]=cc,nb[G.a.Le.id]=cc);nb[A.a.font.id]=Pa;nb[G.a.He.id]=cc;if(Object(sa.a)()){Pa=1==Ob;var oc=1==Ub;if(Pa||oc)nb[A.a.bold.id]=Pa,nb[A.a.italic.id]=oc}}break;case ja.a.Mv:Pa=Db.a.instance.RCa(bb,Pa);nb[A.a.fontColor.id]=Pa;break;case ja.a.fqa:oc=Db.a.instance.RCa(bb,Pa);nb[A.a.fontColor.id]=oc;this.recentColors.odb(Pa)||F.ULS.sendTraceTag(529006977,340,
50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.qfa:nb[A.a.fontColor.id]=gc.a.auto;break;case ja.a.GY:nb[A.a.highlight.id]=parseInt(Pa,16);break;case ja.a.F9:nb[A.a.highlight.id]=parseInt(Pa,16);this.recentColors.odb(Pa)||F.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ja.a.Yta:nb[A.a.highlight.id]=gc.a.auto;break;case ja.a.LA:nb[A.a.fontSize.id]=this.ve.V2b(Rb.vd);break;case ja.a.G_:nb[A.a.fontSize.id]=this.HYl(Mb.fontSize);
break;case ja.a.U0:nb[A.a.fontSize.id]=this.bSl(Mb.fontSize);break;case ja.a.OPa:if(Pa=null===(oc=kb.Nz)||void 0===oc?void 0:oc.OPa)for(const xb of Pa.Jl())nb[xb.id]=Pa.Lf(xb);break;case ja.a.clearFormatting:if(Pa=Gb.wn)for(const xb of Pa.Jl())nb[xb.id]=null;nb[G.a.sAb.id]=!0;break;case ja.a.HCa:case ja.a.ICa:case ja.a.CZa:case ja.a.Wta:case ja.a.DZa:Mb.oPa&&2===Mb.capitalization&&(nb[w.a.capitalization.id]=0)}null!=Ab&&(nb[m.AFrameworkApplication.Wlf]=Ab);return nb}HYl(bb){bb=this.ve.G_(bb);return this.ve.V2b(bb)}bSl(bb){bb=
this.ve.U0(bb);return this.ve.V2b(bb)}Bic(bb,Gb,Sa,Pa){var Ab=bb.cache;const nb=Object(I.a)(21,Sa);switch(Gb){case ja.a.bold:2===Sa.value&&(Sa.value=Ab.isBold?0:1);this.ve.nL(bb,1===Sa.value);break;case ja.a.setItalic:2===Sa.value&&(Sa.value=Ab.isItalic?0:1);this.ve.setItalic(bb,1===Sa.value);break;case ja.a.underline:2===Sa.value&&(Sa.value=Ab.isUnderline?0:1);this.ve.e5(bb,1===Sa.value);break;case ja.a.Uia:this.ve.Uia(bb,Sa);break;case ja.a.superscript:2===Sa.value&&(Sa.value=Ab.isSuperscript?0:
1);this.ve.iqa(bb,1===Sa.value);break;case ja.a.subscript:2===Sa.value&&(Sa.value=Ab.isSubscript?0:1);this.ve.BHa(bb,1===Sa.value);break;case ja.a.strikethrough:6!==m.AFrameworkApplication.va.zD?F.ULS.sendTraceTag(539305613,340,50,"User used strikethrough from ribbon"):F.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===Sa.value&&(Sa.value=Ab.isStrikethrough?0:1);this.ve.Ria(bb,1===Sa.value);break;case ja.a.ot:2===Sa.value&&(Sa.value=Ab.isDoubleStrikethrough?
0:1);this.ve.Zfe(bb,1===Sa.value);break;case ja.a.font:if(nb&&nb.vd){const {fontName:Rb,qda:Mb,bold:oc,italic:xb}=kb.Ypf(nb.vd);this.ve.Mia(bb,Rb.substr(0,kb.dMi));this.ve.Ibg(bb,Mb);Object(sa.a)()&&(Sa=1==oc,Pa=1==xb,Sa||Pa)&&(this.ve.nL(bb,Sa),this.ve.setItalic(bb,Pa))}break;case ja.a.Mv:F.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");this.ve.Mv(bb,Sa,null);break;case ja.a.fqa:this.ve.Mv(bb,Sa,null);this.recentColors.odb(Sa)||F.ULS.sendTraceTag(594899727,
340,50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.qfa:this.ve.qfa(bb);break;case ja.a.GY:F.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");this.ve.zya(bb,Sa);break;case ja.a.F9:this.ve.zya(bb,Sa);this.recentColors.odb(Sa)||F.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ja.a.Yta:this.ve.EDd(bb);break;case ja.a.LA:this.ve.LA(bb,nb.vd);break;case ja.a.G_:this.ve.ski(bb);
break;case ja.a.U0:this.ve.Wrj(bb);break;case ja.a.b5:Ab=Sa.ia(G.a.noProof,!1);this.ve.Lag(bb,Sa.getValue(A.a.bL),Pa,Ab);break;case ja.a.OPa:this.ve.gge(bb);break;case ja.a.clearFormatting:this.ve.pfa(bb);break;case ja.a.HCa:case ja.a.ICa:case ja.a.CZa:case ja.a.Wta:case ja.a.DZa:Ab.oPa&&2===Ab.capitalization&&this.ve.CWk(bb)}}YYn(bb,Gb){ja.a.clearFormatting===Gb&&X.OutlineElementNavigator.Il(bb).properties.removeProperty(A.a.x0)}Som(bb,Gb){return this.muh(bb,Gb)||this.muh(Gb,bb)}muh(bb,Gb){return(1===
bb.specialIndentType||!bb.specialIndentType)&&2===Gb.specialIndentType}G5l(bb){bb=L.GraphIterator.$a(bb);bb.zb(11);aa.moveToCell(bb,0,0);bb.Qd();bb.E_();return bb.currentNode}eRm(bb){return!bb||ha.SelectionEditor.km(bb)||1===bb.length&&ha.SelectionEditor.ml(bb.Qa)&&!ha.SelectionEditor.ujb(bb.Qa)?!1:!0}FJi(bb){kb.Cdh.nb(bb.contextId)||(F.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",bb.contextId),kb.Cdh.Z(bb.contextId,!0))}iFm(bb){return bb===ja.a.CZa||bb===ja.a.HCa||bb===ja.a.ICa||bb===ja.a.Wta||
bb===ja.a.DZa}XCd(bb,Gb){const Sa=bb.node,Pa=Sa.characterData.substr(bb.cpBegin,bb.cpEnd-bb.cpBegin);this.skb.set("Command",Gb.toString());n.Health.instance.recordKpiUsage(this.kpiName,1,this.W7,this.skb);Gb=kb.nGo(Pa,Gb);Sa.dqa(Sa.characterData.substr(0,bb.cpBegin)+Gb+Sa.characterData.substr(bb.cpEnd));return 32}static get pj(){return kb.Nz||(kb.Nz=y.a.instance.resolve("Box4.IInsertionPointFormatting"))}static Vw(){return kb.Sm||(kb.Sm=y.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Wg(){return ia.ContextSetEditor.instance}static get Vf(){return La.a.instance}static get Ic(){return v.a.instance}static get Xb(){return null!=
kb.Pyg?kb.Pyg:kb.Pyg=y.a.instance.Na("Box4.IFeatureHelper")}static get X1c(){return Ja.App.dN}static get Ld(){return null!=kb.nIg?kb.nIg:kb.nIg=y.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get lj(){return null!=kb.PHg?kb.PHg:kb.PHg=y.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Gqa(){return null!=kb.rHg?kb.rHg:kb.rHg=y.a.instance.resolve("Box4.TextFormattingHelper")}static get Gd(){return null!=kb.JDg?kb.JDg:kb.JDg=y.a.instance.resolve("Box4.List.IListReader")}static get Un(){return null!=
kb.vDg?kb.vDg:kb.vDg=y.a.instance.resolve("Box4.List.IListEditor")}static get Sf(){return da.a.instance}static oRl(bb,Gb){return 42===bb?Gb:bb!==Gb||16===bb?16:bb}static Uqh(bb,Gb){bb.Pui||(Gb.Pui?Gb=bb:Gb.unit===bb.unit&&l.a.vwa(Gb.value,bb.value)||(Gb.value=-1));return Gb}static nGo(bb,Gb){switch(Gb){case ja.a.HCa:return bb.toLowerCase();case ja.a.ICa:return 6!==m.AFrameworkApplication.va.zD?F.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):F.ULS.sendTraceTag(539305616,340,
50,"User changed the case from keyboard shortcut"),bb.toUpperCase();case ja.a.CZa:case ja.a.Wta:return kb.vTk(bb,Gb===ja.a.Wta);case ja.a.DZa:return kb.BIo(bb);default:return bb}}static BIo(bb){let Gb="";for(let Sa=0;Sa<bb.length;Sa++)Gb=bb.charAt(Sa)===bb.charAt(Sa).toUpperCase()?Gb+bb.charAt(Sa).toLowerCase():Gb+bb.charAt(Sa).toUpperCase();return Gb}static vTk(bb,Gb){let Sa,Pa,Ab=!0,nb=bb.length,Rb=0,Mb=kb.kGf(bb,Rb,nb);for(;0<nb;){Pa=Sa=!1;var oc=nb;let cc;var xb=void 0;for(xb=0;0<oc&&kb.NVk(bb.charAt(Rb+
xb));xb++,oc--)Pa=kb.f_d(bb.charAt(Rb+xb));for(cc=xb;0<oc&&!(Sa=kb.f_d(bb.charAt(Rb+xb)))&&" "!==bb.charAt(Rb+xb)&&"/"!==bb.charAt(Rb+xb);xb++,oc--);oc=xb-cc;if(0>=oc)break;Rb+=cc;xb=bb.substr(Rb,oc);xb=xb===xb.toUpperCase();if(Mb||!xb)bb=Ab||Pa||Gb?bb.substr(0,Rb)+bb.charAt(Rb).toUpperCase()+bb.substr(Rb+1,oc-1).toLowerCase()+bb.substr(Rb+oc):bb.substr(0,Rb)+bb.substr(Rb,oc).toLowerCase()+bb.substr(Rb+oc);nb-=oc+cc;Rb+=oc;if(Ab=Sa)Rb++,nb--,Mb=kb.kGf(bb,Rb,nb)}return bb}static kGf(bb,Gb,Sa){for(;0<
Sa&&!kb.f_d(bb.charAt(Gb));){if(bb.charAt(Gb)!==bb.charAt(Gb).toUpperCase())return!1;Gb++;Sa--}return!0}static $Qm(bb,Gb){for(var Sa=0;0<Gb&&!kb.f_d(bb.charAt(Sa));){if(bb.charAt(Sa)!==bb.charAt(Sa).toLowerCase())return!1;Sa++;Gb--}return!0}static f_d(bb){return"."===bb||"!"===bb||"?"===bb?!0:!1}static NVk(bb){return-1==="0123456789".indexOf(bb)&&bb.toUpperCase()===bb.toLowerCase()}static Y_h(){const bb=y.a.instance.Sa("Common.ISystemInitiatedFeedback");bb&&bb.execute(Gb=>{Gb.logActivity("FontsSurveyActivity",
"FontsFloodgateSurvey")})}}kb.Cdh=new N.a;kb.Nz=null;kb.Sm=null;kb.dMi=31;Object(E.a)(kb,"TextFormattingActor",null,[])},1998:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);var m;(function(e){e[e.chrome=0]="chrome";e[e.edge=1]="edge";e[e.firefox=2]="firefox";e[e.IE=3]="IE";e[e.safari=4]="safari";e[e.others=5]="others";e[e.unknown=6]="unknown";e[e.electron=7]="electron";e[e.chromiumEdge=8]="chromiumEdge";e[e.teamsElectron=9]="teamsElectron"})(m||(m={}));Object(E.b)("BrowserCode",m)},2E3:function(E,
M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(E.a)(m,"AtMentionAttributes",null,[])},2006:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);var m;(function(e){e[e.initial=0]="initial";e[e.startSearch=1]="startSearch";e[e.searching=2]="searching";e[e.searchComplete=3]="searchComplete";e[e.replaceAllInProgress=4]="replaceAllInProgress";e[e.replaceAllComplete=5]="replaceAllComplete";e[e.tooManyResults=6]="tooManyResults";
e[e.noMatchesFound=7]="noMatchesFound"})(m||(m={}));Object(E.b)("FindReplaceViewType",m)},2008:function(E,M,c){c.d(M,"a",function(){return m});var m;(function(e){e[e.initial=0]="initial";e[e.headings=1]="headings";e[e.find=2]="find";e[e.replace=3]="replace";e[e.intelligentPlaceholder=4]="intelligentPlaceholder";e[e.contracts=5]="contracts"})(m||(m={}))},2023:function(E,M,c){function m(b,k){k=Object.assign(new na.a,{name:"LinkType",string:k});e(Pb.a.Uzm,b,[k])}function e(b,k,t,D=!0){k&&k.UILocation&&
Object(bf.d)(b,D,bf.e,0,k.UILocation,0,t)}function a(b,k){const t=Fa.a.instance;return new rA(b,k,t.Ue("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value,t.Ue("WordEditor.Bookmark.FullBookmarkManager").value,t.resolve("Box4.IHyperlinkStrategy"),t.resolve("Box4.IHyperlinkEditor"),t.resolve("Box4.ICharacterPropertiesEditor"),t.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,t.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,pr.a.instance,t.Na("Box4.IInternalLinkManager"))}
function l(b,k){var t;return b===wo.none?"none":null===(t=uz[b])||void 0===t?void 0:t[k]}function y(){const b=Fa.a.instance.Na("WordEditor.Gc2Inline.IWordEditHostFactory");void 0===b&&v.ULS.sendTraceTag(509694672,322,10,"getEditHostFactory: Failed to resolve edit host factory from container.");return b}function z(){const b=Fa.a.instance.Na("WordEditor.Gc2Inline.IGc2ClassFactory");void 0===b&&v.ULS.sendTraceTag(509224267,322,10,"getGC2ClassFactory: Failed to resolve GC2 class factory from container.");
return b}c.r(M);var n=c(0),v=c(7),A=c(55),w=c(2),G=c(35),F=c(19),I=c(162),K=c(85);class J{constructor(b){this.fjg=0;this.NFb=this.ggc=this.tTa=null;this.HR=w.AFrameworkApplication.ta.Fq;this.KX=b;this.KX.yv(K.a.Hjj);this.KX.NB(K.a.Hjj,Object(A.a)(this,this.wqn,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.NFb)return v.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.NFb;this.tTa=this.HR.Zf("ComponentAttach","getCustomAuthConfig");return this.NFb=new Promise((b,
k)=>{const t={};let D=!1,P=!1,ca=0;this.fjg=window.setInterval(()=>{4>ca?(ca++,this.KX.sendMessage(K.a.getCustomAuthConfig,t)):(window.clearInterval(this.fjg),D=!0,v.ULS.sendTraceTag(588087303,344,10,G.c({["error"]:"Request timeout after 4 retries."})),k("Request timeout."))},1E3);this.ggc=(ta,Na)=>{window.clearInterval(this.fjg);D||P||(P=!0,ta?(v.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),b(ta)):(v.ULS.sendTraceTag(589050654,369,10,G.c({["error"]:Na.toString()})),k(Na)))};
this.KX.sendMessage(K.a.getCustomAuthConfig,t)})}wqn(b){try{const k=G.a(b.Values[I.a.LOk]);let t=w.AFrameworkApplication.K.jb("Application")||"";t=F.a.Tg(t);k.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+t+"%3Facctsw%3D1&prompt=select_account";k.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+t+"%3Facctsw%3D1";k.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+t+"%3Facctsw%3D1&prompt=select_account";k.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+
t+"%3Facctsw%3D1";this.tTa&&(this.tTa.stop(),this.tTa=null);this.ggc(k,"")}catch(k){v.ULS.sendTraceTag(589050655,344,10,G.c({["error"]:k.message,["stack"]:k.stack})),this.ggc(null,k.message)}}}Object(n.a)(J,"AccountSwitchingManager",null,[155]);var N=c(179);class R{get name(){return"Common.App.AccountSwitching"}xc(b){b.register(J,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").singleInstance().Rd(()=>new J(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){N.a.instance.Fc(new R)}}
Object(n.a)(R,"AccountSwitchingPackage",null,[1,2]);var O;(function(b){b[b.generalException=0]="generalException";b[b.invalidArgument=1]="invalidArgument";b[b.notAllowed=2]="notAllowed";b[b.apiNotAvailable=3]="apiNotAvailable";b[b.unresolvedPendingRequest=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.adalTimeout=6]="adalTimeout";b[b.userNotSignedIn=7]="userNotSignedIn";b[b.userAborted=8]="userAborted";b[b.silentSignInFailed=9]="silentSignInFailed";b[b.invalidResourceUrl=10]="invalidResourceUrl";
b[b.invalidGrant=11]="invalidGrant";b[b.connectionLost=12]="connectionLost";b[b.clientError=13]="clientError";b[b.serverError=14]="serverError"})(O||(O={}));Object(n.b)("ErrorCodes",O);c(1789);class L{constructor(b,k){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=k}}Object(n.a)(L,"OutstandingRequest",null,[]);class U{}U.ifn="AADSTS50058";U.invalidResourceUrl="AADSTS50001";U.bfn="AADSTS65001";U.Qfn="AADSTS70011";U.userAborted="13002";U.ICn="Popup Window is null";
U.HCn="Popup Window closed";U.adalTimeout="Token renewal operation failed due to timeout";U.JIo="tokenRevoked";Object(n.a)(U,"WopiHostErrorType",null,[]);var W=c(742),X=c(58),V=c(1788);class Z{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(n.a)(Z,"WopiIdentityInfo",null,[734]);class da{constructor(b,k,t){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=k;this.expiration=t}}Object(n.a)(da,"WopiIdentityToken",
null,[733]);var aa=c(20),ea=c(185),na=c(31),pa=c(173);class ja{constructor(b){this._initialized=!1;this.efc={};this.Jje={};this.HR=w.AFrameworkApplication.ta.Fq;this.cyf=b}uCb(b){this._initialized||(b.yv(K.a.Ufc),b.NB(K.a.Ufc,Object(A.a)(this,this.vqn,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(b,k,t=null){this.Cha(b,k);return new Promise((D,P)=>{if(this.rBf(k))if(k in this.efc)P("unresolvedPendingRequest");else{var ca=window.setTimeout(()=>{v.ULS.sendTraceTag(37856032,344,10,G.c({["error"]:"Request timeout.",
["callerId"]:k}));P("timeout")},12E4);this.Gmf(b,k,t,(ta,Na)=>{window.clearTimeout(ca);ta?D(ta):(v.ULS.sendTraceTag(37856033,369,15,G.c({["error"]:O[Na]})),P(Na))})}else v.ULS.sendTraceTag(37856034,344,10,G.c({["error"]:"Caller is not allowed."})),P("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((k,t)=>{this.rBf(b)?this.L7l((D,P)=>{D?k(D):(v.ULS.sendTraceTag(37856064,369,10,G.c({["error"]:P.toString()})),t(P))}):(v.ULS.sendTraceTag(37856065,344,10,G.c({["error"]:"Caller is not allowed."})),
t("notAllowed"))})}getAuthContext(b){return new Promise((k,t)=>{const D=this.getAuthContextSync(b);D?k(D):t("notAllowed")})}getAuthContextSync(b){if(this.rBf(b)){const k=new V.a;k.upn=w.AFrameworkApplication.K.jb("UserPrincipalName");k.userId=w.AFrameworkApplication.K.jb("LoggableUserId");k.authority=w.AFrameworkApplication.K.jb("HostAuthAuthority");k.tenantId=w.AFrameworkApplication.K.jb("TenantId");k.isAnonymous=w.AFrameworkApplication.K.$("IsAnonymousUser");k.supportsAuthToken=this.Vrm(b);b=w.AFrameworkApplication.K.jb("HostAuthType");
k.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return k}v.ULS.sendTraceTag(40751647,344,10,G.c({["error"]:"Caller is not allowed."}));return null}Vrm(b){const k=W.OAuthManagerSettings.fRc;return aa.a.uQa?k&&W.OAuthManagerSettings.exj?Array.contains(W.OAuthManagerSettings.exj,b.toLowerCase()):!1:k}Gmf(b,k,t,D){var P=[];Array.add(P,Object.assign(new na.a,{name:"CallerId",string:k}));Array.add(P,Object.assign(new na.a,{name:I.a.Gfg,string:b.correlationId}));ea.a.sendTelemetryEvent(Object.assign(new pa.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:P}));P=X.a.create().toString();const ca="getAccessToken_"+P,ta=this.HR.Zf("ComponentAttach",ca);this.Jje[ca]=ta;const Na={};Na[I.a.Hfg]=P;Na[I.a.mzo]=b.resource;Na[I.a.nzo]=b.scope;Na[I.a.Gtj]=w.AFrameworkApplication.K.jb("HostAuthType");Na[I.a.qzo]=w.AFrameworkApplication.K.jb("UserPrincipalName");Na[I.a.ozo]=b.silentLogin;Na[I.a.jzo]=b.options;Na[I.a.Gfg]=b.correlationId;Na[I.a.kzo]=k;t&&(Na[I.a.addinName]=t.AddinName,
Na[I.a.izo]=t.AddinTrustId);this.cyf.execute(qb=>{this.uCb(qb);qb.sendMessage(K.a.getAuthToken,Na)});this.efc[P]=new L(b,D)}L7l(b){const k=w.AFrameworkApplication.K.jb("UserName"),t=w.AFrameworkApplication.K.jb("UserPrincipalName"),D=w.AFrameworkApplication.K.jb("LoggableUserIdSpace"),P=new Z;P.email=t;P.displayName=k;switch(D){case "OrgIdPuid":P.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":P.authority="MicrosoftAccount";break;default:P.authority=D}b(P,null)}vqn(b){let k=
null;try{let D=b.Values[I.a.Hfg];const P=b.Values[I.a.hzo],ca=b.Values[I.a.Gtj],ta=b.Values[I.a.pzo];let Na=null,qb=null;const Jb=this.efc[D];if("undefined"!==typeof Jb&&Jb){var t=[];Array.add(t,Object.assign(new na.a,{name:I.a.Gfg,string:Jb.requestParameters.correlationId}));ea.a.sendTelemetryEvent(Object.assign(new pa.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:t}));k=Jb.requestCallback;delete this.efc[D];"undefined"!==typeof P&&P&&P.length?qb=new da(P,ca,
ta):Na=O[this.t8m(b)];t="getAccessToken_"+D;t in this.Jje&&(this.Jje[t].stop(),delete this.Jje[t]);k(qb,Na)}else v.ULS.sendTraceTag(37856066,344,10,G.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:D}))}catch(D){b=b.Values[I.a.Hfg],b in this.efc&&delete this.efc[b],this.j2d(),v.ULS.sendTraceTag(37856067,344,10,G.c({["error"]:D.message,["stack"]:D.stack})),k&&k(null,"generalException")}}rBf(b){var k=w.AFrameworkApplication.Cim();b=b.toLowerCase();for(const t of k)if(b===
t.toLowerCase())return!0;k=W.OAuthManagerSettings.A0e;for(let t in k)if(b===k[t].toLowerCase())return!0;return!1}t8m(b){b=b.Values[I.a.lzo];this.j2d();v.ULS.sendTraceTag(39068821,344,15,G.c({["error"]:b}));return b?-1<b.indexOf(U.ifn)?9:-1<b.indexOf(U.ICn)||-1<b.indexOf(U.HCn)?12:-1<b.indexOf(U.invalidResourceUrl)?10:-1<b.indexOf(U.userAborted)?8:-1<b.indexOf(U.Qfn)||-1<b.indexOf(U.bfn)||b===U.JIo?11:-1<b.indexOf(U.adalTimeout)?6:0:13}Cha(b,k){b=this.BRn(b.resource);v.ULS.sendTraceTag(39921882,344,
50,G.c({["callerId"]:k,["resource"]:b}))}j2d(){v.ULS.sendTraceTag(39068822,344,50,G.c({["userAgent"]:window.navigator.userAgent}))}BRn(b){return(b?b:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(n.a)(ja,"WopiIdentityManager",null,[703]);class ma{constructor(){this.W=null}get name(){return"Common.App.WopiIdentity"}xc(b){this.W=b;b.register(ja,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").singleInstance().Rd(()=>new ja(b.Sa("Postmessage.IHostPostmessenger")))}init(){w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.No(Object(A.a)(this,this.Lx,"onFullAppSettingsReady"))}Lx(){try{this.W.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){v.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}dispose(){}static main(){N.a.instance.Fc(new ma)}}Object(n.a)(ma,"WopiIdentityPackage",null,[1,2]);var Ia=c(497),Ja=c(355),Ka=c(73),Ma;(function(b){b[b.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";b[b.cloudPolicySettings=1]=
"cloudPolicySettings";b[b.alternateAuthToken=2]="alternateAuthToken"})(Ma||(Ma={}));Object(n.b)("ApplicationFeatureHelperRequestType",Ma);class sa{constructor(){this.message=null;this.httpStatusCode=0}}Object(n.a)(sa,"HttpRequstToPromiseRejectData",null,[]);var xa=c(83),ia=c(57),ha=c(197),ua=c(749);class ya{constructor(b,k){this.Ma=b;this.Wf=k}WHc(b,k,t,D=null,P=null,ca=null,ta=null,Na=null){const qb=Ma[t],Jb=qb+"RequestFailure";xa.Health.instance.recordKpiUsage(Jb,0,"jpittsdirects",null);return new Promise((Vb,
ac)=>{v.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",qb);const yc=null!=ta?ta:this.Ma.mc("ApplicationFeatureHelperRequestQueueTimeout",15E3),Kc=null!=Na?Na:this.Ma.mc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Wf.Tyb(b,1,null,this.pqf(t,D),ca,1,ed=>{v.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",qb);try{if(void 0===ed||null===ed||void 0===
ed.data||null===ed.data||void 0===ed.data.xe||null===ed.data.xe){xa.Health.instance.recordKpiFailure(Jb,"Invalid RequestSucceededEventArgs",!1,!0,null);let oe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",qb);ac(this.xEa(oe,ed))}else if(ed.data.Qe!==ha.a.Hy){xa.Health.instance.recordKpiFailure(Jb,"HttpStatusCode_"+ed.data.Qe.toString(),!1,!0,null);let oe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
ed.data.Qe,qb);ac(this.xEa(oe,ed))}else{void 0!==P&&null!==P&&void 0!==ed.data.vj&&null!==ed.data.vj&&P(ed.data.vj);var sd=k(ed.data.xe);if(sd)v.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",qb),Vb(sd);else{xa.Health.instance.recordKpiFailure(Jb,"Parse Failure",!1,!0,null);let oe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",qb);ac(this.xEa(oe,
ed))}}}catch(oe){xa.Health.instance.recordKpiFailure(Jb,"Unexpected Failure",!1,!0,null),sd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",oe,qb),ac(this.xEa(sd,ed))}},ed=>{if(ed.data){xa.Health.instance.recordKpiFailure(Jb,"HttpStatusCode_"+ed.data.Qe.toString(),!1,!0,null);var sd=ua.a.o8b(ed.data.xe||"No Data");sd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",
ed.data.Qe,sd,qb)}else xa.Health.instance.recordKpiFailure(Jb,"Invalid RequestFailedEventArgs",!1,!0,null),sd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",qb);ac(this.xEa(sd,ed))},void 0,void 0,yc,Kc)})}xEa(b,k){const t=new sa;t.message=b;t.httpStatusCode=k&&k.data?k.data.Qe:-1;return t}pqf(b,k){const t={};t["x-UserDataSignature"]=this.Ma.jb("UserDataSignature");t["x-LicensingIsEnabled"]=this.Ma.$("LicensingIsEnabled").toString();
t["x-CacheIsEnabled"]=this.Ma.$("LicensingRedisIsEnabled").toString();t["x-OcpsIsEnabled"]=this.Ma.$("OcpsIsEnabled").toString();t["x-LicensingAADIdIsEnabled"]=this.Ma.$("LicensingAadIdIsEnabled").toString();0===b&&(t["x-LicenseCheckOnTenantEnabled"]="true",t["x-SupportUserConsentDependentFeatures"]="true",t["x-AFHUserConsentGroupValue"]="0",t["x-UseShellServiceForUserConsentGroup"]="true",t["x-SMBUserLicensingEnabled"]="true",t["x-AFHPIPLComplianceEnabled"]=ia.a.bU(window.location.href,"wd_afhpipl")||
"false");if(k)for(let D of k.keys)t[D]=k.J(D);return t}}Object(n.a)(ya,"HttpRequestToPromiseUtility",null,[]);var ra;(function(b){b[b.loki=0]="loki";b[b.augloopACLP=1]="augloopACLP"})(ra||(ra={}));Object(n.b)("AlternateAuthSupportApp",ra);class La{constructor(){this.Token=null;this.ExpirationTime=0}}Object(n.a)(La,"WacAlternateAuthToken",null,[]);class oa{constructor(b,k){this.HIo=3E5;if(void 0===b||null===b||void 0===k||null===k)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Ma=b;this.Sdd=new Ia.a(Ja.a.ei());this.Xtc=new ya(b,k);void 0!==W.OAuthManagerSettings.cLf&&null!==W.OAuthManagerSettings.cLf&&void 0!==W.OAuthManagerSettings.R2d&&null!==W.OAuthManagerSettings.R2d&&0<W.OAuthManagerSettings.R2d&&(b=new La,b.Token=W.OAuthManagerSettings.cLf,b.ExpirationTime=W.OAuthManagerSettings.R2d,this.Sdd.Z("loki",b))}QKl(){let b=null;this.Sdd.nb(ra[0])&&(b=this.Sdd.J(ra[0]));return void 0===b||null===b||this.isTokenExpired(b)?this.azl():Promise.resolve(b.Token)}isTokenExpired(b){return b.ExpirationTime-
Date.now()<this.HIo}azl(){const b=new Ia.a(Ja.a.ei());b.Z("X-AlternateAuthApp",ra[0]);return this.Xtc.WHc(this.rhb("/afhs/AlternateAuthHelperHandler.ashx"),Object(A.a)(this,this.oyn,"parseAlternateAuthTokenResponse"),2,b).then(k=>{v.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",ra[0]);this.Sdd.Z(ra[0],k);return k.Token},k=>{k=Object(Ka.a)(sa,k);v.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",
k.message,k.httpStatusCode);return null})}oyn(b){let k=null;({Wu:k}=G.d(b));v.ULS.sendTraceTag(545821457,3004,k?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",b);return k}rhb(b){return String.format("{0}{1}?{2}",this.Ma.jb("WebServiceBase"),b,w.AFrameworkApplication.hm)}}Object(n.a)(oa,"AlternateAuthHelper",null,[680]);var Ca=c(603);class Aa{constructor(b,k,t){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=k;this.tierName=
t}}Object(n.a)(Aa,"FeatureStateChangeArgs",null,[]);var db=c(151),eb=c(201),ib=c(82),lb=c(136),Ya;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(Ya||(Ya={}));Object(n.b)("FeatureState",Ya);var Fa=c(22),$a=c(13),Db=c(119);class gc{constructor(b,k,t=null,D=null,P=null){this.zgb=this.Yka=this.zch=this.Sab=this.avd=null;this.Xtc=new ya(b,k);this.Ma=b;this.Q9j=b.mc("LicensingMaxRetryAttempts",0);this.nmd=b.$("IsO365ConsumerHost");this.DFe=b.$("IsO365CommercialHost");this.ZEe=b.$("PremiumUpsellIsEnabled");
this.LVb=!1;this.dIe=0;this.COg=t;this.qkh=D;this.ga=P;this.Rab=b.$("LicensingIsEnabled");this.Bvb=b.$("OcpsIsEnabled")&&this.DFe;this.rWe=b.$("ShowPrivacyDialog")&&!!D;this.AVb=b.$("IsAnonymousUser");this.oLd=new Promise(ca=>{ca(!1)});this.Upb=new Promise(ca=>{ca(!0)});this.ygb=new Ia.a(Ja.a.ei());this.yxd=!0;this.v4g=this.D_l();this.d3a()&&!this.AVb?(void 0!==w.AFrameworkApplication.ta&&null!==w.AFrameworkApplication.ta&&(this.avd=w.AFrameworkApplication.ta.Fq,void 0!==this.avd&&null!==this.avd&&
(this.Sab=this.avd.YQa("WebServiceCall","ApplicationFeatureHelperService"))),this.zgb=this.Fkg()):this.zgb=new Promise(ca=>{ca({})});this.zgb.catch(ca=>{ca=Object(Ka.a)(sa,ca);v.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",ca?ca.httpStatusCode.toString():"Unknown")});this.yxd&&this.isFeatureEnabled("FreemiumUpsell",!0).then(ca=>{this.LVb=ca;return null})}D_l(){const b=this.Ma.Nw("AllLicensedFeatures")?this.Ma.GC("AllLicensedFeatures"):[],k=new Ca.a;
for(let t=0;t<b.length;t++)k.add(b[t]);return k}d3a(){return this.DFe||this.nmd}Fkg(b=0,k=!1){v.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",k);const t=db.a.fG();t&&(t.set("retryAttempt",b.toString()),t.set("forceRefresh",k.toString()),t.set("isO365ConsumerHost",this.nmd.toString()),t.set("isO365CommercialHost",this.DFe.toString()),t.set("isFreemiumUpsellSettingEnabled",this.ZEe.toString()));xa.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",t);xa.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",t);void 0!==this.Sab&&null!==this.Sab&&this.Sab.start();let D=null;k&&(D=new Ia.a(Ja.a.ei()),D.Z("x-LicensingForceRefresh","true"));this.zch=new Date;return(this.Rab?this.Xtc.WHc(this.rhb("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(A.a)(this,this.syn,"parseApplicationFeatureHelperResponse"),0,D,Object(A.a)(this,this.VFn,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(P=>
{const ca=Object.assign(new Db.a,{durationMs:this.Duj()});ca.extendedProperties=t;ca.extendedProperties&&P&&(ca.extendedProperties.set("featureCount",ib.a.count(P).toString()),ca.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in P).toString()),ca.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in P).toString()),"FreemiumUpsell"in P&&ca.extendedProperties.set("isFreemiumUpsellEnabled",P.FreemiumUpsell.toString()),this.Yka&&ca.extendedProperties.set("fromCache",
(this.Yka<this.zch).toString()));xa.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",ca);return P},P=>{const ca=Object.assign(new Db.a,{durationMs:this.Duj()}),ta=Object(Ka.a)(sa,P);if(!ta)return v.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),xa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,ca),new Promise((Na,qb)=>{qb(P)});ca.extendedProperties=
t;ca.extendedProperties&&ca.extendedProperties.set("status",ta.httpStatusCode.toString());xa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,ca);return 408===ta.httpStatusCode&&++b<=this.Q9j?this.Fkg(b):new Promise((Na,qb)=>{qb(ta)})})}syn(b){(b=G.b(b))?(v.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),v.ULS.sendTraceTag(50938594,3004,50,"{0}",b)):v.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return b.Features}rhb(b){var k=String.format("{0}{1}",this.Ma.jb("WebServiceBase"),b);this.Ma.Nw("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ma.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=gc.qQd(this.Ma))&&0<b.length&&(this.yxd&&(b+="ucbf"),k=new eb.QueryStringBuilder(k),k.Ce("afhskey",b),k=k.toString());return k}isFeatureEnabled(b,k){if(!this.Bvb&&!this.rWe&&!this.Rab)return this.Upb;v.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
b);if("ConnectedServices"===b){var t=this.Bvb?this.COg.d8("ControllerConnectedServicesEnabled"):this.Upb;const ca=this.rWe?this.qkh.getSettings().then(ta=>2!==ta.MI,()=>k):this.Upb;return t.then(ta=>ta?ca:this.oLd)}if("FreemiumUpsell"===b&&(!this.ZEe||!this.nmd||this.AVb))return this.oLd;t=null;t=this.Bvb?this.COg.isFeatureEnabled(b):this.Upb;let D=null;D=this.Rab?this.yIm(b,k):this.Upb;let P=null;P=this.rWe?this.qkh.isFeatureEnabled(b):this.Upb;return t.then(ca=>ca?P.then(ta=>ta?D:this.oLd):this.oLd).then(ca=>
{this.IIi(b,ca,!0);return ca},()=>{this.IIi(b,k,!1);return k})}IIi(b,k,t){v.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,k,t)}getFeatureTier(b,k){if(!this.Rab)return new Promise(t=>{t(2)});v.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.zgb.then(t=>this.xSd(b,t,k),()=>k)}isFreemiumUpsellEnabled(){if(this.ZEe&&this.nmd&&!this.AVb){if(this.LVb&&2!==this.dIe||!this.LVb&&1!==this.dIe)v.ULS.sendTraceTag(509728161,
3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.LVb.toString()),this.dIe=this.LVb?2:1;return this.LVb}return!1}launchUpsellExperience(b,k=null){v.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",b));var t=db.a.fG();t&&(t.set("experienceId",b),k&&t.set("campaignId",k));xa.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",t);
if(t=Fa.a.instance.Na("Common.IInProductMessagingUIManager")){const D=Object(A.a)(this,this.Xkm,"handleDimeTaskComplete");t.oEi(b,D,k)}else v.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),xa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ga.Qb($a.a.jNd,2,{["experience"]:b})}cya(b,k){if(!this.Rab)return null;if(!b||!k)return v.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;const t=lb.a.create().toString();this.ygb.nb(b)||this.ygb.Z(b,new Ia.a(Ja.a.ei()));this.ygb.J(b).add(t,k);v.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",t,b));return t}Tgc(b,k){this.Rab&&(b&&this.ygb.nb(b)?k&&lb.a.isValid(k)?this.ygb.J(b).nb(k)?(v.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
k,b)),this.ygb.J(b).remove(k)):v.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",k,b)):v.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",k,b)):v.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
b)))}xSd(b,k,t){return this.yxd?b in k?k[b].LicenseTier:t:b in k?this.dzn(k[b],t):t}dzn(b,k){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return k}}Xkm(){v.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.zgb.then(b=>{this.x7i(b)}).catch(()=>{this.x7i({})})}x7i(b){v.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const k=this.Fkg(0,!0);k.then(t=>
{this.zgb=k;ib.a.count(t)>ib.a.count(b)?xa.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):xa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let D of this.ygb.keys)if(D in t){const P=this.xSd(D,t,0);D in b?this.xSd(D,b,0)!==P&&this.pRf(D,!0,P):this.pRf(D,!0,P)}else D in b&&this.pRf(D,!1,this.xSd(D,b,0))}).catch(t=>{xa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);v.ULS.sendTraceTag(594051086,
3004,10,JSON.stringify(t))})}pRf(b,k,t){v.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",b,k,t);k=new Aa(b,k,t);t=this.ygb.J(b);for(let D of t)try{D.value(k)}catch(P){v.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",b,D.key,P.message))}}xIm(b,k){if(this.Rab){const t=
this.v4g.contains(b);let D=!0,P="",ca=!1;return this.zgb.then(ta=>{b in ta?(ta=ta[b],P=Ya[ta.FeatureState],D=1!==ta.FeatureState):D=!t;this.WIi(b,t,P,ca,k,D);return D},()=>{ca=!0;t&&(D=k);this.WIi(b,t,P,ca,k,D);return D})}return this.Upb}WIi(b,k,t,D,P,ca){v.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,k,D,t,P,ca)}yIm(b,k){if(this.yxd)return this.xIm(b,k);if(this.Rab){if(this.v4g.contains(b))return this.zgb.then(t=>
b in t,()=>k);v.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",b)}return this.Upb}VFn(b){try{b&&"Date"in b&&(this.Yka=new Date(b.Date),v.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.Yka.toString()))}catch(k){v.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",k)}}Duj(){if(void 0!==this.Sab&&
null!==this.Sab){const b=this.Sab.si;this.Sab.stop();return b}return null}static qQd(b){try{if(aa.a.jke){const k=b.jb("UserDataSignature").split(".");if(1<k.length){const t=window.self.atob(k[1]),D=JSON.parse(t).LocalStorageKey;if(void 0!==D&&null!==D&&0<D.length)return D}}}catch(k){v.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",k.toString())}return null}}Object(n.a)(gc,"ApplicationFeatureHelper",null,[681]);var Eb=c(74);class kb{constructor(b,k){this.PolicySettings=
null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+k);this.ExpirationTime=b.getTime()}}Object(n.a)(kb,"CloudPolicySettingsCacheData",null,[]);var bb=c(1362),Gb=c(527),Sa=c(289);class Pa{static bsj(){return w.AFrameworkApplication.K.$("SideCarIsEnabled")?Pa.Wee&&Pa.GTc?new Promise(b=>{b(!0)}):new Promise((b,k)=>{Pa.Wee=Sa.a.create(w.AFrameworkApplication.K.jb("SideCarUrl"));Gb.a.lX(Pa.Wee);Pa.Wee.UZ((t,D)=>{(Pa.GTc=D.succeeded)?b(D.succeeded):k(D.succeeded)})}):
new Promise(b=>{b(!1)})}}Pa.GTc=!1;Pa.Wee=null;Object(n.a)(Pa,"SideCarLoader",null,[]);class Ab{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(n.a)(Ab,"CloudPolicySettingsData",null,[]);class nb{constructor(b,k){this.Hue=0;this.$Dd=null;this.Xtc=new ya(b,k);this.Ma=b;k=b.jb("HostAuthType");this.Bvb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===k||null===k)&&"aad"===k.toLowerCase();this.c8g=G.b(b.jb("OcpsDefaultSettings")||"{}");this.owc=
this.qQd();k=this.Ma.Nw("ServicesControlsMicrosoftControllerServicesList")?this.Ma.GC("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.fgd=new Ca.a;for(let t=0;t<k.length;t++)this.fgd.add(k[t]);this.Bvb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.$Dd=this.BMo():this.$Dd=this.Ekg(this.Bvb,this.rhb("/afhs/CloudPolicySettings.ashx"),Object(A.a)(this,this.wyn,"parseCloudPolicySettingsResponse"));this.$Dd.then(()=>null).catch(t=>{t=Object(Ka.a)(sa,t);v.ULS.sendTraceTag(50622685,
3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",t?t.httpStatusCode.toString():"Unknown")})}d8(b,k=!0){if(!this.Bvb){const ca=this;return new Promise(ta=>{ta(ca.GOc(b))})}let t=this,D=this;const P=this.$Dd.then(ca=>{try{let ta=null;ca.PolicySettings&&"unknown"in ca.PolicySettings&&(ta=ca.PolicySettings.unknown);if(ta){if(b in ta&&void 0!==ta[b]&&null!==ta[b])return new Promise(qb=>{qb("0"!==ta[b])});const Na=b.toLowerCase();if(Na in ta&&void 0!==ta[Na]&&null!==ta[Na])return new Promise(qb=>
{qb("0"!==ta[Na])});v.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default");return new Promise(qb=>{qb(t.GOc(b))})}return new Promise(Na=>{Na(t.GOc(b))})}catch(ta){return v.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",ta.message),t.handleError(ta.toString(),k,t.GOc(b))}},ca=>D.handleError(ca,k,D.GOc(b)));P.then(ca=>{v.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,ca);
return null});return P}isFeatureEnabled(b,k=!0){if(this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.AIm(b,k);let t=new Promise(P=>{P(!0)}),D="";this.fgd.contains(b)&&(D="ControllerConnectedServicesEnabled",t=this.d8(D,k));t.then(P=>{v.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,P,D);return null});return t}AIm(b,k=!0){let t=new Promise(P=>
{P(!0)}),D="";"mso_sendASmile"===b?D="Enabled":"Survey"===b||"FloodgateSurvey"===b?D="SurveyEnabled":this.fgd.contains(b)&&(D="ControllerConnectedServicesEnabled");""!==D&&(t=this.d8(D,k));t.then(P=>{v.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",b,P,D);return null});return t}handleError(b,k,t){return k?new Promise(D=>{D(t)}):new Promise((D,P)=>{P(b)})}Ekg(b,k,t){if(!b)return Promise.resolve(new Ab);let D=!1,P=
null;xa.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let ca=this.B$e("GetCloudPolicySettings");return(new Promise((ta,Na)=>{if(void 0!==this.owc&&null!==this.owc&&0<this.owc.length){const qb=this.fMo();if(void 0!==qb&&null!==qb){D=!0;ta(qb);return}}this.Xtc.WHc(k,t,1,null,Object(A.a)(this,this.gGn,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.Ma.mc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ma.mc("CloudPolicySettingsRequestSentTimeout",
3E4)).then(qb=>{v.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.mNo(qb);ta(qb);return qb},qb=>{Na(qb);return null})})).then(ta=>{({NA:ca,returnValue:P}=this.Fje(ca));var Na=db.a.fG();Na&&Na.set("FromCache",D.toString());Na=Object.assign(new Db.a,{durationMs:P,extendedProperties:Na});xa.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Na);return ta})}BMo(){return Pa.bsj().then(()=>{v.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");
return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}rhb(b){return String.format("{0}{1}",this.Ma.jb("WebServiceBase"),b)}wyn(b){let k=null;({Wu:k}=G.d(b));b=!!k;v.ULS.sendTraceTag(50622687,3004,b?50:10,"ParseCloudPolicySettingsResponse: Success={0}",b);return k}gGn(b){try{if(void 0!==b&&null!==b&&"CheckIn-Interval"in b){const k=parseInt(b["CheckIn-Interval"]);void 0!==k&&null!==k&&0<k&&(this.Hue=k)}}catch(k){v.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",
k)}}GOc(b){return b in this.c8g?"0"!==this.c8g[b]:!0}fMo(){try{const b=bb.a.instance.getItem(this.owc);if(void 0===b||null===b)return v.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;v.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const k=JSON.parse(b);if(void 0===k||null===k)return v.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),
null;if(void 0===k.ExpirationTime||null===k.ExpirationTime)return v.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(k.ExpirationTime)).getTime()<Date.now())return v.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const t=new Ab;t.PolicySettings=k.PolicySettings;t.ControllerConnectedServicesFeatureNames=new Eb.a;this.Ma.Nw("ServicesControlsMicrosoftControllerServicesList")&&
this.Ma.GC("ServicesControlsMicrosoftControllerServicesList");for(let D of this.fgd)t.ControllerConnectedServicesFeatureNames.add(D);v.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return t}catch(b){return v.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}mNo(b){try{if(void 0===b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)v.ULS.sendTraceTag(51662944,3004,15,
"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.Hue)v.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const k=new kb(b,this.Hue),t=JSON.stringify(k);v.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",t);bb.a.instance.setItem(this.owc,t);v.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(k){v.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",k.toString())}}qQd(){const b=gc.qQd(this.Ma);return b&&0<b.length?"OCPS"+b:null}B$e(b){const k=Fa.a.instance.Na("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==k&&null!==k?k.Zf("WebServiceCall",b):null}Fje(b){if(void 0!==b&&null!==b){const k=b.si;b.stop();return{returnValue:k,NA:null}}return{returnValue:null,NA:b}}}Object(n.a)(nb,"CloudPolicySettingsHelper",null,[678]);class Rb{constructor(){this.BTh=this.KHj=this.MI=
0;this.CTh=this.LHj=this.PAb="";this.ASe=this.lUa=2}clone(){const b=new Rb;b.MI=this.MI;b.KHj=this.KHj;b.BTh=this.BTh;b.PAb=this.PAb;b.LHj=this.LHj;b.CTh=this.CTh;b.lUa=this.lUa;b.ASe=this.src;return b}get src(){return this.ASe}serialize(b=null){const k={};if(!b||b.contains(Rb.QJb))k[Rb.QJb]=this.MI;if(!b||b.contains(Rb.RZc))k[Rb.RZc]=this.PAb;if(!b||b.contains(Rb.SZc))k[Rb.SZc]=this.lUa;return JSON.stringify(k)}static create(b,k=null){const t=new Rb;t.ASe=b;void 0!==k&&null!==k&&(Rb.QJb in k&&(t.MI=
k[Rb.QJb]),Rb.RZc in k&&(t.PAb=k[Rb.RZc]),Rb.SZc in k&&(t.lUa=k[Rb.SZc]));return t}static deserialize(b,k){try{const t=JSON.parse(b);if(void 0!==t&&null!==t)return Rb.create(k,t);v.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",b);throw Error.argument("settingsData");}catch(t){throw v.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",t.toString()),t;}}}Rb.QJb="CCS";Rb.RZc="CCSTime";Rb.SZc="OfficePrivacyRoamedNoticeShown";
Object(n.a)(Rb,"UserPrivacySettings",null,[]);var Mb=c(154);class oc{constructor(b,k){if(void 0===b||null===b||void 0===k||null===k)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ma=b;this.Wf=k;this.qRe=this.Sd=null}rhb(b){var k=String.format("{0}RoamingServiceHandler.ashx?action=",this.Ma.appSettings.RoamingServiceHandlerWebServiceBase||"");k=new Sys.StringBuilder(k);k.append(b);k.append("&");k.append(w.AFrameworkApplication.hm);return k.toString()}executeRequest(b,k,t,
D=null){return this.Wf.c0b(b,k,D,null,t,"33",!1,null,6E4)}saveSettings(b){return new Promise((k,t)=>{try{if(void 0===this.Sd||null===this.Sd||void 0===b||null===b)v.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),t("Can't determine setting changes to save");else{var D=this.Sd.MI!==b.MI;if(2===this.Sd.src&&D)this.m9n(b),k(!0);else{var P=this.bdo(b);if(void 0===P||null===P||!P.length)v.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),
t("No changes to save");else if(1===this.Sd.src)k(this.WBj(P));else if(0===this.Sd.src){v.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",P);const ca=this.executeRequest(this.rhb("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",P);ca.continueWith(()=>{if(ca.zo||ca.Ci)v.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),k(!1);else{var ta=ca.result;void 0!==ta.args&&null!==ta.args&&void 0!==ta.args.data&&
null!==ta.args.data&&ta.args.data.Qe===ha.a.Hy?(v.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),k(!0)):(v.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),k(!1))}})}}}}catch(ca){v.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",ca.toString()),k(!1)}})}bdo(b){if(void 0===this.Sd||null===this.Sd||void 0===b||null===b)throw Error.invalidOperation("User Privacy settings have not been initialized");
const k=new Eb.a;0===b.src?(this.Sd.MI!==b.MI&&(k.add(Rb.QJb),k.add(Rb.RZc)),this.Sd.lUa!==b.lUa&&k.add(Rb.SZc)):1===b.src&&this.Sd.MI!==b.MI&&k.add(Rb.QJb);return k.count?b.serialize(k):(v.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.qRe){const b=this;this.qRe=new Promise(k=>{try{b.Sd?k(b.Sd.clone()):b.wMo().then(t=>{b.Sd=t;k(b.Sd.clone());return null},()=>{b.uMo().then(t=>{b.Sd=t;k(b.Sd.clone());return null},()=>{b.vMo().then(t=>
{b.Sd=t;k(b.Sd.clone());return null},()=>{v.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Sd=new Rb;k(b.Sd.clone());return null});return null});return null})}catch(t){v.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",t.toString()),b.Sd=new Rb,k(b.Sd.clone())}})}return this.qRe}wMo(){return new Promise((b,k)=>{try{const D=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ma.$("PrivacyDialogShouldCheckRoaming")||
D){var t=this.executeRequest(this.rhb("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");t.continueWith(()=>{try{if(t.zo||t.Ci)v.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const P=t.result;if(P&&P.args&&P.args.data)if(P.args.data.Qe!==ha.a.Hy)v.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",P.args.data.Qe);else{if(P.args.data.xe){b(oc.parse(P.args.data.xe,0));v.ULS.sendTraceTag(51258447,
3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",P.args.data.xe);return}v.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else v.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");k("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(P){v.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",
P.toString()),k("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else v.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),k("Roaming should not be used")}catch(D){v.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",D.toString()),k("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}uMo(){return new Promise((b,k)=>{try{const t=Mb.a.get("WacUPToggleState");let D=null;void 0!==t&&null!==
t&&0<t.length&&(D=decodeURIComponent(t));if(void 0!==D&&null!==D&&0<D.length){const P=oc.parse(D,1);v.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",P.toString());b(P)}else{const P=Rb.create(1),ca=new Eb.a;ca.add(Rb.QJb);const ta=P.serialize(ca);this.WBj(ta)?(v.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",ta),b(P)):(v.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",
ta),k("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(t){v.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",t.toString()),k("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}vMo(){return new Promise(b=>{try{var k=-1!==window.location.href.indexOf("&wdccsoff=1");let t=Rb.create(2);k?(t.MI=2,w.AFrameworkApplication.wRh(),v.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",
t.toString())):(t.MI=1,v.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",t.toString()));b(t)}catch(t){v.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",t.toString()),k=Rb.create(2),k.MI=1,b(k)}})}m9n(b){v.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===b.MI?w.AFrameworkApplication.wRh():w.AFrameworkApplication.tsl();v.ULS.sendTraceTag(51258454,
3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}WBj(b){try{v.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const k=this.Ma.jb("PrivacyCookieDomain")||"";if(!k||!k.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");v.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return Mb.a.bnj("WacUPToggleState",b,Mb.a.cRa,k)}catch(k){return v.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",
k.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(k=>{const t=this.Ma.Nw("ServicesControlsMicrosoftControllerServicesList")?this.Ma.GC("ServicesControlsMicrosoftControllerServicesList"):[],D=new Ca.a;for(let P=0;P<t.length;P++)D.add(t[P]);return D.contains(b)?2!==k.MI:!0},()=>{v.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);return!0})}static parse(b,k){try{return v.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
b,k),Rb.deserialize(b,k)}catch(t){throw v.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",t.toString()),t;}}}Object(n.a)(oc,"UserPrivacySettingsHelper",null,[679]);class xb{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}xc(b){this.W=b;this.W.register(678,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").singleInstance().Rd(()=>new nb(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne));this.W.register(679,
"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").singleInstance().Rd(()=>new oc(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne));this.W.register(680,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").singleInstance().Rd(()=>new oa(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne));this.W.register(681,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").singleInstance().Rd(()=>new gc(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne,this.W.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),
this.W.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),w.AFrameworkApplication.va))}init(){w.AFrameworkApplication.K.No(()=>{const b=this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");w.AFrameworkApplication.K.$("LicensingIsEnabled")&&(b.isFeatureEnabled("LicensingTestFeature",!1).then(k=>{v.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",k,
w.AFrameworkApplication.K.jb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(k=>{v.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",k,w.AFrameworkApplication.K.jb("IsAnonymousUser"));return null}));this.W.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.YFo()})}dispose(){}YFo(){try{w.AFrameworkApplication.K.$("SideCarIsEnabled")&&Pa.bsj().then(b=>
{v.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){N.a.instance.Fc(new xb)}}Object(n.a)(xb,"ApplicationFeatureHelperPackage",null,[1,2]);var cc=c(169);class Ob{vQd(b,k){let t;const D=[];for(;t=k.exec(b);){const P=t.index;D.push(new cc.a(P,P+t[0].length))}return D}isEndPuncSpecialCase(b){const k=this.vQd(b,Ob.Zxo);for(const t of k)if(t.end===b.length)return!0;return!1}dLc(b){for(const k of Ob.Qwl){const t=
this.vQd(b,k);if(0<t.length&&!t[0].begin)return t[0].end-1}return 0}findBeginBoundary(b,k,t){var D=b.substring(t,k);b=this.vQd(D,Ob.tVh);for(k=b.length-1;0<=k;k--){const P=D.substring(0,b[k].end);if(!this.isEndPuncSpecialCase(P))return D=D.substring(b[k].begin,D.length),t+b[k].end+this.dLc(D)}return t}findEndBoundary(b,k,t){var D=b.substring(k,t);b=this.vQd(D,Ob.tVh);for(t=0;t<b.length;t++){const P=D.substring(0,b[t].end);if(!this.isEndPuncSpecialCase(P))return D=D.substring(b[t].begin,D.length),
k+b[t].end+this.dLc(D)}return-1}}Ob.Gif="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";Ob.Hif="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";
Ob.Iif="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";Ob.Qwl=[new RegExp(Ob.Gif,"ig"),new RegExp(Ob.Hif,"ig"),new RegExp(Ob.Iif,"ig")];Ob.hfg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Ob.kfg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";Ob.jfg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
Ob.ifg=Ob.kfg+"|"+Ob.jfg;Ob.lfg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Ob.mfg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";Ob.nfg="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
Ob.ofg="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";Ob.p$f="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
Ob.ifg+"|"+Ob.lfg+"|"+Ob.mfg+")";Ob.o$f="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
Ob.nfg+")";Ob.WQf=Ob.hfg+"|"+Ob.ofg;Ob.gfg=Ob.WQf+"|"+Ob.p$f+"|"+Ob.o$f;Ob.tVh=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");Ob.Zxo=new RegExp(Ob.gfg,"g");Object(n.a)(Ob,"ProofingSentenceSeparatorScriptSharp",null,[682]);class Ub{Gcd(b,k){const t=[];let D;for(;null!=(D=k.exec(b));){const P=D.index;t.push({begin:P,end:P+D[0].length})}return t}isEndPuncSpecialCase(b){return this.Gcd(b,Ub.cRj).some(k=>
k.end==b.length)}dLc(b){for(const k of Ub.vNj){const t=this.Gcd(b,k);if(0<t.length&&0==t[0].begin)return t[0].end-1}return 0}findBeginBoundary(b,k,t){var D=b.substring(t,k);b=this.Gcd(D,Ub.Nqg);for(k=b.length-1;0<=k;k--){const P=D.substring(0,b[k].end);if(!this.isEndPuncSpecialCase(P))return D=D.substring(b[k].begin,D.length),t+b[k].end+this.dLc(D)}return t}findEndBoundary(b,k,t){var D=b.substring(k,t);b=this.Gcd(D,Ub.Nqg);for(t=0;t<b.length;t++){const P=D.substring(0,b[t].end);if(!this.isEndPuncSpecialCase(P))return D=
D.substring(b[t].begin,D.length),k+b[t].end+this.dLc(D)}return-1}}Ub.fMj="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";Ub.YQj="[\u2639\u263a\u263b]";Ub.Ysg="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";Ub.hNj="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
Ub.OPj="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";Ub.xtg="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
Ub.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
Ub.Xsg="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";Ub.KOj="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";Ub.JOj="[\uff21-\uff3a\uff41-\uff5a]";Ub.HOj="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
Ub.GOj="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";Ub.IOj="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";Ub.Lpe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";Ub.Mqg="[\u3002\uff61]";Ub.$cd="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";Ub.CNj="[\u00bb\u2019\u201d\u203a\"']";Ub.eqe=Ub.fMj+"|"+Ub.YQj;Ub.LOj="[\u2028\u2029\n\r]";Ub.FOj="("+Ub.$cd+"|"+Ub.Ysg+"|"+Ub.xtg+"|"+Ub.Xsg+
")";Ub.EOj="("+Ub.$cd+"|"+Ub.Ysg+"|"+Ub.xtg+"|"+Ub.Symbol+"|"+Ub.Xsg+"|"+Ub.hNj+"|"+Ub.OPj+")";Ub.Gif="("+Ub.Lpe+"("+Ub.eqe+"|"+Ub.CNj+"|"+Ub.$cd+")*"+Ub.LOj+")";Ub.Hif="("+Ub.Lpe+"("+Ub.eqe+")*("+Ub.$cd+")+)";Ub.Iif="("+Ub.Mqg+"("+Ub.eqe+")*)";Ub.vNj=[new RegExp(Ub.Gif,"ig"),new RegExp(Ub.Hif,"ig"),new RegExp(Ub.Iif,"ig")];Ub.hfg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Ub.kfg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
Ub.jfg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";Ub.ifg=Ub.kfg+"|"+Ub.jfg;Ub.lfg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Ub.mfg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
Ub.nfg="(("+Ub.KOj+"|"+Ub.HOj+"|"+Ub.IOj+")[.])+|(("+Ub.GOj+")[.\ufe52\uff0e])+";Ub.ofg="("+Ub.JOj+")[.\ufe52\uff0e]";Ub.p$f=Ub.FOj+"("+Ub.ifg+"|"+Ub.lfg+"|"+Ub.mfg+")";Ub.o$f=Ub.EOj+"("+Ub.nfg+")";Ub.WQf=Ub.hfg+"|"+Ub.ofg;Ub.gfg=Ub.WQf+"|"+Ub.p$f+"|"+Ub.o$f;Ub.Nqg=new RegExp(Ub.Lpe+"|"+Ub.Mqg,"ig");Ub.cRj=new RegExp(Ub.gfg,"g");Object(n.a)(Ub,"ProofingSentenceSeparator",null,[682]);class pb{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}xc(b){this.W=b;w.AFrameworkApplication.K.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new Ub).singleInstance():b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new Ob).singleInstance()}init(){this.W.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){N.a.instance.Fc(new pb)}}Object(n.a)(pb,"Box4GrammarCheckPackage",null,[1,2]);var Zb=c(97),Wa=c(9),Lb=c(61),qc=c(1803);class Ra{constructor(){this.W=null}get name(){return"Box4.AtMentions"}xc(b){this.W=b;this.W.ha("Box4.AtMentions.IAtMentionsListener",()=>
new qc.a(this.W.resolve("Box4.IEditingDomManager"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.BackspaceDeleteEventSource"),Lb.InteractiveViewManager.instance)).singleInstance()}init(){w.AFrameworkApplication.K.No(()=>{this.W.resolve("Box4.AtMentions.IAtMentionsListener").Odb(Wa.App.ya.gb,Zb.KeyInputManager.instance)})}dispose(){this.W.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){N.a.instance.Fc(new Ra)}}Object(n.a)(Ra,"Box4AtMentionsPackage",null,[1,
2]);class yb{get name(){return"Box4.Workers"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new yb)}}Object(n.a)(yb,"Box4WorkersPackage",null,[1,2]);var Bb=c(304),cb=c(77);class Xa{constructor(){this.dJa=new cb.a}Y4(b,k){this.dJa.Z(b,k)}Mmf(b){({value:b}=this.dJa.Dc(b));return b}}Object(n.a)(Xa,"AggregationMethodsForActivityName",null,[]);var hb=c(248);class Cb{constructor(){this.Hrd=new Bb.a;this.dJa=new Bb.a}Y4(b,k,t){this.dJa.nb(b)&&this.dJa.J(b)||this.dJa.Z(b,new Xa);this.dJa.J(b).Y4(k,
t)}Mmf(b,k){return this.dJa.nb(b)&&this.dJa.J(b)?this.dJa.J(b).Mmf(k):null}YOc(b){this.Hrd.nb(b)&&this.Hrd.J(b)||this.Hrd.Z(b,new hb.a);return this.Hrd.J(b)}sOh(b,k){this.YOc(b).add(k)}}Object(n.a)(Cb,"ActivityAggregationInfo",null,[761]);var ob=c(110),ab=c(986),Ib=c(1008);class Yb extends ab.a{constructor(b,k){super(b);this.NVe=(this.bUj=k)?k.BVl():Ib.a.xmf()}get ZBa(){return this.bUj}get activityName(){return this.ZBa.name}get startTime(){return this.ZBa.startTime}get endTime(){return this.ZBa.endTime}end(){}cancel(){}plf(){}gTo(){this.A6b.Z("AM",
this.ZBa.mode.toString());this.A6b.Z("C",this.ZBa.count.toString());this.A6b.Z("DA",this.ZBa.QTh.toFixed(2));this.A6b.Z("DV",this.ZBa.Bql.toFixed(2))}Wsf(b){return this.ZBa.Wsf(b)}Atf(){return this.ZBa.Atf()}i0b(){for(let b of this.ZBa.$Ba)b.i0b()}}Object(n.a)(Yb,"AggregatedActivity",ab.a,[]);class ub{constructor(b,k){this.cse=0;this.zza=b;this.JUa=k}Kzk(b,k){this.cse=k;for(k=0;k<b.count;k++){const t=b.J(k);this.Lzk(t)}}Lzk(b){const k=Object(Ka.a)(Yb,b);if(k)if(1===this.cse)this.Jzk(k);else if(2===
this.cse){this.Mzk(k);for(let t of this.JUa.YOc(this.zza)){const D=k.ZBa.$Ba.J(0);D.properties.nb(t)&&b.properties.Z(t,D.properties.J(t))}}}Jzk(b){for(let k of this.JUa.YOc(this.zza))this.Vej(b,k)}Mzk(b){for(let k of b.Atf())this.Vej(b,k)}Vej(b,k){const t=this.JUa.Mmf(this.zza,k);if(t){const D=b.Wsf(k);b.properties.Z(k,t(D))}}}Object(n.a)(ub,"PropertyAggregationHelper",null,[]);var Ac=c(1072);class Pc{constructor(b,k,t,D,P){this.aSb=b;this.JUa=k;this.fPg=P;this.Kre=D;this.m9j=t}get Amh(){return this.m9j.value}NGc(b){if(Object(ob.a)(Ac.a,
b))b.NGc();else if(Object(ob.a)(Yb,b)&&this.Kre.wAh(b.activityName.toString())){b=Object(Ka.a)(Yb,b);b.gTo();b=b.xLi();var k=[];Array.add(k,b);b=G.c(k);v.ULS.sendTraceTag(6907266,213,50,b)}}fCa(b,k){const t=(new Date).getTime();var D=this.fPg.list.J(b);const P=({Ozk:D}=this.ZJl(D)).returnValue;this.fPg.list.Z(b,new Eb.a);k&&(D=this.H6k(D,t,this.aSb.Xji));0<D.count&&(new ub(b,this.JUa)).Kzk(D,P)}H6k(b,k,t){const D=new Eb.a;for(let P=0;P<b.count;P++){const ca=b.J(P);ca.startTime>k-t?ca.i0b():D.add(ca)}return D}ZJl(b){const k=
this.Amh.hyj(b);b=this.Amh.uHo(b);const t=this.Pzk(k,b);return{returnValue:t,Ozk:1===t?k:b}}Pzk(b,k){return b.count*this.aSb.TNi<k.count?1:2}get enabled(){return this.aSb.enabled}i0b(){}}Object(n.a)(Pc,"ActivityAggregationManager",null,[762]);class Mc{constructor(b){this.enabled=!1;this.hMi=500;this.xNi=2;this.TNi=5;this.Xji=3E4;this.nLc(b.appSettings)}nLc(b){this.enabled=Boolean.parse(b[Mc.ahf]||"false");this.hMi=parseInt(b[Mc.a$m]||"500");this.xNi=parseInt(b[Mc.Ibn]||"2");this.TNi=parseInt(b[Mc.gcn]||
"5");this.Xji=parseInt(b[Mc.Xim]||"30000")}}Mc.ahf="ActivityAggregationEnabled";Mc.a$m="ActivityAggregationMaxInterval";Mc.Ibn="ActivityAggregationMinChain";Mc.gcn="ActivityAggregationModeFactor";Mc.Xim="ActivityAggregationGraceWindow";Object(n.a)(Mc,"ActivityAggregationParams",null,[]);class Ed{constructor(b,k){this.JUa=b;this.uKg=k}hyj(b,k=1){if(!b||!b.count)return b;const t=new Eb.a;var D=null;for(let P=0;P<b.count;P++){const ca=b.J(P);if(!ca)continue;const ta=ca.activityName;D?D.BTm(ca)?D.add(ca):
(D=D.process(),t.addRange(D),D=this.uKg(ta,k),D.add(ca)):(D=this.uKg(ta,k),D.add(ca))}D&&(b=D.process(),t.addRange(b));return t}uHo(b){if(!b||!b.count)return b;const k={};var t=null;for(let P=0;P<b.count;P++){const ca=b.J(P);if(ca){if(!t){t=new Eb.a;var D=this.JUa.YOc(ca.activityName);for(let ta of D)t.add(ta)}D=this.k8l(ca,t);null!==D&&(D in k&&k[D]||(k[D]=new Eb.a),k[D].add(ca))}}b=new Eb.a;for(const P of ib.a.EO(k))t=this.hyj(k[P],2),b.addRange(t);return b}k8l(b,k){let t="";for(let D of k)t+=D,
t=b.properties.nb(D)&&void 0!==b.properties.J(D)&&null!==b.properties.J(D)?t+b.properties.J(D):t+"null";return t}}Object(n.a)(Ed,"ActivityAggregationSchemes",null,[760]);class ne{constructor(b,k,t,D,P){this.Xr=this.ji=0;this.aSb=t;this.ioc=D;this.JUa=P;this.name=b;this.Oy=k;this.$Ba=new Eb.a}get mode(){return this.Oy}get count(){return this.$Ba.count}get startTime(){return this.ji}get endTime(){return this.Xr}get QTh(){if(!this.count)return 0;let b=0;for(let k of this.$Ba)b+=k.endTime-k.startTime;
return b/this.count}get Bql(){if(!this.count)return 0;let b=0;const k=this.QTh;for(let t of this.$Ba){const D=t.endTime-t.startTime;b+=(D-k)*(D-k)}return b/this.count}add(b){this.count?this.Xr=b.endTime>this.endTime?b.endTime:this.endTime:(this.ji=b.startTime,this.Xr=b.endTime);this.$Ba.add(b)}BTm(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.aSb.hMi}process(){if(this.count>=this.aSb.xNi){const b=new Eb.a,k=this.ioc(this);b.add(k);return b}return this.$Ba}Wsf(b){const k=new Eb.a;for(let t of this.$Ba)if(t.properties.nb(b)){const D=
t.properties.J(b);k.add(D)}else k.add(null);return k}Atf(){const b=this.JUa.YOc(this.name),k=new hb.a;for(let t of this.CKl())b.contains(t)||k.add(t);return k}CKl(){const b=new hb.a;if(!this.$Ba)return b;for(let k of this.$Ba)for(let t of k.properties.keys)b.add(t);return b}BVl(){return this.$Ba.J(0).uniqueID}}Object(n.a)(ne,"ActivityCollection",null,[759]);class Ie{constructor(){this.Krb=new Bb.a}get list(){return this.Krb}add(b){const k=b.activityName;if(this.Krb.nb(k)&&this.Krb.J(k)){const t=this.KYl(this.Krb.J(k),
b);this.Krb.J(k).insert(t,b)}else this.Krb.Z(k,new Eb.a),this.Krb.J(k).add(b)}KYl(b,k){for(let t=b.count-1;0<=t;t--)if(k.startTime>b.J(t).startTime)return t+1;return 0}}Object(n.a)(Ie,"CompletedActivitiesHelper",null,[758]);class cd{constructor(){this.W=null}get name(){return"Common.App.ActivityAggregator"}init(){w.AFrameworkApplication.$H(()=>{this.W.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}xc(b){this.W=b;const k=D=>new Yb(()=>b.Na("Common.App.Activities.IActivityAggregationManager"),
D),t=(D,P)=>new ne(D,P,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),k,b.resolve("Common.IActivityAggregationInfo"));b.register(Pc,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").singleInstance().Rd(()=>new Pc(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.Ue("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),
b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(Mc,"Common.App.ActivityAggregator.ActivityAggregationParams").singleInstance().Rd(()=>new Mc(w.AFrameworkApplication.K));b.register(Cb,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").singleInstance().Rd(()=>new Cb);b.register(Ed,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").singleInstance().Rd(()=>
new Ed(b.resolve("Common.IActivityAggregationInfo"),t));b.register(Ie,"Common.App.ActivityAggregator.CompletedActivitiesHelper").singleInstance().Rd(()=>new Ie)}static main(){N.a.instance.Fc(new cd)}}Object(n.a)(cd,"ActivityAggregatorPackage",null,[1,2]);var Ic=c(525),Rc=c(11),xc=c(1373);class Ae{constructor(b){this.Uah=0;this.Eue=null;this.qfk=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get ucg(){return this.qfk.value}Tb(){this.isInitialized?this.Mgc():this.EUn(Object(A.a)(this,
this.Mgc,"registerActionsInternal"))}Mgc(){v.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(b=>{b.getChatsContainer(Object(A.a)(this,this.Wjn,"onChatContainerReady"))}).catch(b=>{v.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",b)}),this.chat.getChatsCounter().then(b=>{b.onChatsCountChange(Object(A.a)(this,this.FTk,"chatCountChanged"))}).catch(b=>{v.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",
b)}),this.chat.getKeyboard().then(b=>{b.onKeyDown(Object(A.a)(this,this.Zjn,"onChatKeyPress"))}).catch(b=>{v.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",b)}))}catch(b){v.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",b)}}FTk(b){v.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",b);if(!b)this.ucg.Vjn();else if(1===b&&!this.Uah){const k=document.getElementById(this.Eue?this.Eue:xc.a.lAb);k?this.ucg.$jn(k,Object(A.a)(this,this.eKo,"transferFocusToChat")):
v.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.Uah=b}Wjn(b){this.Eue=b}Zjn(b){b.ctrlKey&&"f6"===b.key.toLowerCase()&&this.dKo(b.shiftKey)}EUn(b){Ic.a.instance.lb(Rc.a.nDo,window.self,()=>{b();return!0})}eKo(){v.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(b=>{b.focusConversationInput()}).catch(b=>{v.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",b)})}catch(b){v.ULS.sendTraceTag(50595974,
333,10,"Failed to transfer focus to chat: {0}",b)}}dKo(b){v.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.ucg.Xjn(b)}}Object(n.a)(Ae,"ChatManager",null,[763]);var Ue=c(80);class Xe{constructor(){this.ra=new Ue.a;this.Klk=!1}oxk(b){this.ra.addHandler("OnTopRowControlsCreatedEvent",b)}$wk(b){this.ra.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get ZIo(){return this.Klk}p5i(b){this.ra.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(n.a)(Xe,
"HeaderEventSource",null,[]);var ef=c(166),Se=c(331),pc=c(79);class id{constructor(b,k,t,D,P){this.Jwd=null;this.Ub=b;this.$o=k;this.rk=t;this.Nlk=D;this.ga=P}Y7i(b,k,t,D=null){const P=this.Ub.ge(k);P.parent=t;P.OH=!0;D&&P.d7(D);this.rk.aCa(k,b,!1);this.Nlk.aCa(k,b,!1);k=new Se.DOMFocusListing(()=>b);k.Wm(2);k.Wm(1);k.Wm(8);k.Wm(5);k.Wm(3);k.Wm(6);this.Ub.Yla(()=>b,P,k).jR=!0;k=Zb.KeyInputManager.kc(pc.a.ww,0);t=Zb.KeyInputManager.kc(pc.a.ww,4);P.ir(k);P.ir(t)}onFlexPaneOpen(b){this.Y7i(b,xc.a.rdc,
xc.a.uPa);this.Ub.mg(xc.a.rdc);this.$o.uaa(xc.a.rdc)}onFlexPaneClose(){this.$o.Rw(xc.a.rdc);this.Ub.mg(xc.a.uPa)}$jn(b,k){this.Jwd||(this.Jwd=k,this.Y7i(b,xc.a.lAb,ef.AFrame.cM,Object(A.a)(this,this.Yjn,"onChatFocus")));this.Ub.mg(xc.a.lAb);this.$o.uaa(xc.a.lAb)}Yjn(){this.Jwd&&this.Jwd()}Vjn(){this.$o.Rw(xc.a.lAb);this.Ub.ZMd(ef.AFrame.Pn)}Xjn(b){this.ga.processAction(b?$a.a.Zif:$a.a.Npe,2)}}Object(n.a)(id,"ReactSharedHeaderFocusManager",null,[701]);var Xc=c(126),he=c(1043),$d=c(39),Ud=c(67);class Jf{constructor(b){this.ga=
b}Tb(){this.ga.qa($a.a.jNd,Ud.a.frame,Object(A.a)(this,this.fPi,"navigateToUpsellPage"));this.ga.qa($a.a.cHl,Ud.a.frame,Object(A.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.ga.qa($a.a.r2n,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.Gbj,Ud.a.frame,Xc.ActionManager.Of)}fPi(b,k,t,D,P){if(1===t)return 32;b=8;2===t&&(t=this.aof(P,"experience","gopremiumribbon"),P=ia.a.h8("2116536"),P=ia.a.eo(P,"ocid",he.b(w.AFrameworkApplication.ta.Nb.Sl,w.AFrameworkApplication.ta.Nb.Nha,t)),
$d.a.nm(P,"_blank",void 0,"NavigateToUpsellPage"),b=32,this.ga.processAction($a.a.Gbj,2),v.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return b}launchUpsellExperience(b,k,t,D,P){if(1===t)return 32;var ca=8;2===t&&(v.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(ca=Fa.a.instance.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(b=this.aof(P,"experience","gopremium"),P=this.aof(P,"dimeCampaignId",null),ca.launchUpsellExperience(b,P),ca=32):
(v.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),ca=this.fPi(b,k,t,D,P)));return ca}aof(b,k,t){b&&b[k]&&(t=Object(Ka.a)(String,b[k]));return t}}Object(n.a)(Jf,"UpsellActor",null,[700]);class hh{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){Fa.a.instance.resolve("Common.App.Header.IUpsellActor").Tb();Fa.a.instance.resolve("Common.App.Header.IChatManager").Tb()}dispose(){}xc(b){this.W=b;this.W.register(Xe,"Common.App.Header.HeaderEventSource").singleInstance();
this.W.register(Jf,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").singleInstance().Rd(()=>new Jf(w.AFrameworkApplication.va));this.W.register(id,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").singleInstance().Rd(()=>new id(w.AFrameworkApplication.ta.Bp,w.AFrameworkApplication.ta.jx,w.AFrameworkApplication.ta.f1,w.AFrameworkApplication.ta.gle,w.AFrameworkApplication.va));this.W.register(Ae,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").singleInstance().Rd(()=>
new Ae(this.W.Ue("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){N.a.instance.Fc(new hh)}}Object(n.a)(hh,"CommonAppHeaderPackage",null,[1,2]);var Qi=c(745);class Lg{static J3h(b,k){switch(b){case 3:return Lg.Rhm(k);case 2:return Lg.M4l(k);case 1:return Lg.kUl(k)}return""}static Rhm(b){switch(b){case 1:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static M4l(b){switch(b){case 1:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static kUl(b){switch(b){case 1:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(b,k,t){if(aa.a.ti||aa.a.yM)window.setTimeout(()=>{Lg.n7i(t,Lg.LSd())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Lg.msh(t),b,0,!1)}static eYk(b,k,t,D){k&&
D&&D();Lg.openInClient(b,k,t)}static LSd(){return aa.a.ti?1:aa.a.yM?2:aa.a.r3a?3:aa.a.el?4:0}static yhm(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static zhm(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get kEf(){return"zh-CN"===window.navigator.language}static n7i(b,k){1===k?(v.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),b=Lg.J3h(b,k),8<aa.a.W1a?$d.a.nm(b,void 0,void 0,"RedirectToAppStore"):$d.a.dDb(b)):document.hidden||(Lg.kEf?(b=w.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?(v.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),$d.a.dDb(b)):v.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(v.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(Lg.J3h(b,
k),null,null)))}static msh(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get The(){return(aa.a.r3a||aa.a.el)&&aa.a.zq}static get Lro(){return aa.a.ti||aa.a.yM}static c4h(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static Zxi(b){return(b=Lg.DZl(b))&&""!==b?Boolean.parse(b):!1}static Obg(b){Lg.Bho(b)}static DZl(b){try{return localStorage.getItem(b)}catch(k){return v.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+k.message),null}}static Bho(b){try{localStorage.setItem(b,"true")}catch(k){v.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+k.message)}}}Lg.eDh="ChromeExtensionBarDismiss";Object(n.a)(Lg,"WildFireUtilities",null,[]);var bc=c(365);class vc{constructor(){this.vse=new bc.a;this.sse=new bc.a;this.rse=new bc.a;this.tLk(this.vse);this.sLk(this.sse);this.rLk(this.rse);this.ZCe=new bc.a;
this.YCe=new bc.a;this.XCe=new bc.a;this.$Nk(this.ZCe);this.ZNk(this.YCe);this.YNk(this.XCe);this.Wue=new bc.a;this.GLk(this.Wue);this.Oyb(this.Wue);this.Oyb(this.rse);this.Oyb(this.sse);this.Oyb(this.vse);this.Oyb(this.YCe);this.Oyb(this.ZCe);this.Oyb(this.XCe)}$Rd(b,k){switch(b){case 1:return this.Him(k);case 2:return this.$Kl(k)}return Lg.The?this.Wue:null}tLk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}sLk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}rLk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}$Nk(b){b.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}GLk(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}ZNk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}YNk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}Oyb(b){b.add("Corporation","Microsoft Corporation")}Him(b){switch(b){case 3:return this.ZCe;case 2:return this.YCe;case 1:return this.XCe}return null}$Kl(b){switch(b){case 3:return this.vse;case 2:return this.sse;case 1:return this.rse}return null}static get instance(){vc._instance||
(vc._instance=new vc);return vc._instance}}vc._instance=null;Object(n.a)(vc,"WildFireStringFactory",null,[]);class Vc{constructor(b,k,t,D,P=null,ca=null){this.SLe=null;this._id=b;this.tNe=k;this.T3j=P;this.Puc=D;this.eAc=ca;this.U8a=null;this.xCc=t;this.nBc=vc.instance.$Rd(k,b)}T7k(){this.U8a=new Qi.a(this.title,this.message,null);this.U8a.addButton(this.qOk,Object(A.a)(this,this.Djn,"onButtonOneClick"),"");this.xCc&&this.U8a.Ioh(this.wOk,Object(A.a)(this,this.Ijn,"onButtonTwoClick"));this.U8a.fma=
Object(A.a)(this,this.Iml,"dismissBar");this.U8a.image=3;this.U8a.id=16;this.U8a.closeable=!0}get title(){return this.nBc.J("Headline")}get message(){return this.nBc.J("CallToAction")}get qOk(){return this.xCc?this.nBc.J("InstallButton"):this.nBc.J("UseAppButton")}get wOk(){return this.xCc?this.nBc.J("OpenAppButton"):""}Djn(){this.xCc?this.wBm():this.rYo()}Ijn(){this.xCc&&this.pun()}get Fyh(){return this.U8a}get G4a(){this.SLe||(this.SLe=this.T3j());return this.SLe}wBm(){v.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.Puc&&this.eAc&&this.eAc();Lg.n7i(this._id,this.tNe)}pun(){this.G4a&&(v.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Puc&&this.eAc&&this.eAc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Lg.msh(this._id),this.G4a,0,!1))}rYo(){Lg.The?this.mOk():(v.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),Lg.Obg("BizBarClicked"),1!==this.tNe&&2!==this.tNe||Lg.eYk(this.G4a,this.Puc,this._id,this.eAc))}mOk(){this.Puc?
v.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):v.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");$d.a.dDb(w.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}Jml(){this.Puc?v.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):v.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");Lg.Obg(Lg.eDh)}Iml(){Lg.The?this.Jml():(Lg.Obg(Lg.c4h(this._id)),v.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static pbf(){const b=w.AFrameworkApplication.ta.Nb;
new Vc(b.Sl,Lg.LSd(),8<aa.a.W1a,1===b.Nha,()=>b.sfa,b.O8f());v.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(n.a)(Vc,"WildFireBusinessBar",null,[]);class yd{get name(){return"Common.App.WildFire"}oYe(b){const k=w.AFrameworkApplication.ta.Nb;let t=!1;b&&(b.T7k(),b.Fyh&&(t=k.Fla(b.Fyh,!0)));return t}Y7k(){var b=w.AFrameworkApplication.ta.Nb;b=new Vc(b.Sl,Lg.LSd(),!1,1===b.Nha);this.oYe(b)&&v.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}pbf(b,k,t,D,P,ca){b=new Vc(b,
t,D,k,P,ca);this.oYe(b)&&v.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}Rdl(){const b=w.AFrameworkApplication.ta.Nb;var k=w.AFrameworkApplication.K;const t=b.Sl,D=1===b.Nha;if(k.$(Lg.yhm(t))){var P=Lg.LSd(),ca=8<aa.a.W1a;if(2!==t||2!==P||!D){k=k.$(Lg.zhm(t));var ta=b.O8f(),Na=()=>b.sfa;k&&!Lg.Zxi(Lg.c4h(t))&&this.pbf(t,D,P,ca,Na,ta)}}}init(){var b=w.AFrameworkApplication.K;const k=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&k;Lg.The&&b&&!Lg.Zxi(Lg.eDh)?
this.Y7k():(document.body&&Lg.Lro&&this.Rdl(),w.AFrameworkApplication.va.qa($a.a.GIf,Ud.a.frame,Object(A.a)(this,this.GIf,"launchWildFireBusinessBar")))}GIf(b,k,t,D,P){if(1===t)return 32;if(!P)return 8;this.pbf(P.app,P.mode,P.platform,P.useTwoButton,null,null);return 32}dispose(){}xc(){}static main(){N.a.instance.Fc(new yd)}}Object(n.a)(yd,"PackageManager",null,[1,2]);class ee{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(n.a)(ee,"BrowserInfo",null,[]);class Qe{constructor(){this.Version=
this.Name=null}}Object(n.a)(Qe,"PluginInfo",null,[]);class ue{static hca(){if(w.AFrameworkApplication.K.$("LogBrowserInfoIsEnabled")){var b=ue.yHl();try{const k=JSON.stringify(b);v.ULS.sendTraceTag(6903563,102,50,k)}catch(k){v.ULS.sendTraceTag(6903564,102,15,k.message)}}else v.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static R6l(){const b=window.navigator.plugins;if(!b||!b.length)return null;const k=[];for(let t=0;t<b.length;t++){const D=b[t].name,P=b[t].version;
Array.add(k,Object.assign(new Qe,{Name:D,Version:P}))}return k}static yHl(){const b=new ee,k=new Sys.StringBuilder;ue.GH(t=>{b.DocElemClientHeight=t},()=>document.documentElement.clientHeight,k);ue.GH(t=>{b.DocElemClientWidth=t},()=>document.documentElement.clientWidth,k);ue.GH(t=>{b.DocElemOffsetHeight=t},()=>document.documentElement.offsetHeight,k);ue.GH(t=>{b.DocElemOffsetWidth=t},()=>document.documentElement.offsetWidth,k);ue.GH(t=>{b.ScreenAvailHeight=t},()=>window.screen.availHeight,k);ue.GH(t=>
{b.ScreenAvailWidth=t},()=>window.screen.availWidth,k);ue.GH(t=>{b.ScreenWidth=t},()=>window.screen.width,k);ue.GH(t=>{b.ScreenHeight=t},()=>window.screen.height,k);ue.GH(t=>{b.ScreenLogicalXdpi=t},()=>window.screen.logicalXDPI,k);ue.GH(t=>{b.ScreenLogicalYdpi=t},()=>window.screen.logicalYDPI,k);ue.GH(t=>{b.ScreenDeviceXdpi=t},()=>window.screen.deviceXDPI,k);ue.GH(t=>{b.ScreenDeviceYdpi=t},()=>window.screen.deviceYDPI,k);ue.GH(t=>{b.WinInnerHeight=t},()=>window.self.innerHeight,k);ue.GH(t=>{b.WinInnerWidth=
t},()=>window.self.innerWidth,k);ue.GH(t=>{b.WinOuterHeight=t},()=>window.self.outerHeight,k);ue.GH(t=>{b.WinOuterWidth=t},()=>window.self.outerWidth,k);ue.GH(t=>{b.WinOrientation=t},()=>window.self.orientation,k);ue.GH(t=>{b.WinDevicePixelRatio=t},()=>window.self.devicePixelRatio,k);ue.GH(t=>{b.SupportsTouch=t},()=>aa.a.t9c,k);ue.GH(t=>{b.NavAppName=t},()=>window.navigator.appName,k);ue.GH(t=>{b.NavAppVersion=t},()=>window.navigator.appVersion,k);ue.GH(t=>{b.NavLanguage=t},()=>window.navigator.browserLanguage||
window.navigator.language,k);ue.GH(t=>{b.NavUserAgent=t},()=>window.navigator.userAgent,k);ue.GH(t=>{b.NavPlatform=t},()=>window.navigator.platform,k);ue.GH(t=>{b.NavPlugins=t},ue.R6l,k);ue.GH(t=>{b.CalculatedDevicePixelRatio=t},()=>ue.devicePixelRatio,k);b.Error=k.toString();return b}static get devicePixelRatio(){const b=window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static GH(b,k,t){try{const D=k();b(D)}catch(D){t.isEmpty()||t.append(" | "),t.append(D.message||
"null")}}}Object(n.a)(ue,"BrowserInfoLogger",null,[]);class ve{get name(){return"Common.App.BrowserInfoLogger"}xc(){}init(){ue.hca()}dispose(){}static main(){N.a.instance.Fc(new ve)}}Object(n.a)(ve,"BrowserInfoLoggerPackage",null,[1,2]);class xf{constructor(){this.ra=new Ue.a}rdb(b){this.ra.addHandler("OnEditHappenedEvent",b)}g4c(b){this.ra.removeHandler("OnEditHappenedEvent",b)}ELn(){this.ra.raiseEvent("OnEditHappenedEvent")}}Object(n.a)(xf,"EditNotificationEventSource",null,[]);var bf=c(44),Df=
c(92);class nf{constructor(b,k,t,D,P,ca,ta=0){this.Vye=!1;this.Uye=this.zvb=null;this.mkh=!1;this.Hb=k;this.opd=b;this.cab=t;this.Sda=D;this.kkh=P;this.E0j=ca;this.Ghd=0;this.Ljd=!1;try{0<ta&&(this.Ghd=ta,3E5>this.Ghd&&(this.Ghd=3E5),this.Hb&&!this.Uye&&(this.Uye=new Df.a(3,2,this.Ghd,Object(A.a)(this,this.k2n,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Hb.Vb(this.Uye)))}catch(Na){v.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+
Na)}}get Fng(){return this.mkh}editHappened(){this.Fng?this.Ljd=!0:(this.mkh=!0,xa.Health.instance.addQosPillar("Save"),xa.Health.instance.addQosPillar("ContentCreation"),bf.c($a.a.editDocument));this.Vye=!0;this.kkh&&this.kkh.Dmh();this.Sda&&this.Sda.ELn();w.AFrameworkApplication.Kg&&w.AFrameworkApplication.Kg.I8m();this.E0j&&!this.zvb&&(this.k6c(null),this.zvb=new Df.a(3,2,this.opd,Object(A.a)(this,this.k6c,"sendPostMessageIfNecessary"),113),this.Hb.Vb(this.zvb))}k6c(){this.Vye&&(this.cab.CWR(()=>
this.cab.result.sendMessage(K.a.editNotification,null)),v.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.Vye=!1)}k2n(){try{this.Ljd&&(bf.c($a.a.editDocument),this.Ljd=!1)}catch(b){this.Ljd=!1,v.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+b)}}}Object(n.a)(nf,"EditNotificationManager",null,[764]);class Yf{constructor(b,k,t,D,P){this.ZBe=this.zvb=null;this.cVb=this.Gre=!1;this.Hb=k;this.opd=
b;this.cab=t;this.rk=D;this.lLe=P;this.e8i(null)}e8i(){const b=document.getElementById(w.AFrameworkApplication.R0b);!this.cVb&&this.rk&&b&&(this.rk.lb(Rc.a.o0,b,Object(A.a)(this,this.vNf,"mouseActivityHandler"),null),this.cVb=!0);this.lLe(()=>{this.dispose()})}vNf(){this.cVb&&(this.rk.rc(Rc.a.o0,document.getElementById(w.AFrameworkApplication.R0b),Object(A.a)(this,this.vNf,"mouseActivityHandler")),this.cVb=!1);this.Dmh();return!1}Dmh(){this.Gre=!0;this.ZBe||(this.ZBe=new Df.a(3,2,this.opd,Object(A.a)(this,
this.e8i,"registerHandlerTask"),112),this.Hb.Vb(this.ZBe));this.zvb||(this.k6c(null),this.zvb=new Df.a(3,2,this.opd,Object(A.a)(this,this.k6c,"sendPostMessageIfNecessary"),111),this.Hb.Vb(this.zvb))}k6c(){this.Gre&&(this.cab.CWR(()=>this.cab.result.sendMessage(K.a.SYo,null)),v.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.Gre=!1)}dispose(){this.cVb&&(this.rk.rc(Rc.a.o0,document.getElementById(w.AFrameworkApplication.R0b),Object(A.a)(this,
this.vNf,"mouseActivityHandler")),this.cVb=!1)}}Object(n.a)(Yf,"UserActivityHostNotificationManager",null,[699,9]);var Kf=c(188),wb=c(106),Tb=c(627);class Wc{constructor(){this.W=null}get name(){return"Common.App.EditNotification"}init(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.No(Object(A.a)(this,this.Lx,"onFullAppSettingsReady"))}Lx(){Wc.Vql&&0<Wc.ogf&&(this.W.register(xf,"Common.App.HostNotification.EditNotificationEventSource").singleInstance(),this.W.register(Yf,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").singleInstance().Rd(()=>
new Yf(6E4,wb.a.instance,Tb.a.Ap(this.W.Sa("Postmessage.IHostPostmessenger")),Kf.a.instance,w.AFrameworkApplication.$H)),this.W.register(nf,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").singleInstance().Rd(()=>new nf(Wc.ogf,wb.a.instance,Tb.a.Ap(this.W.Sa("Postmessage.IHostPostmessenger")),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.W.Na("Common.Interface.IUserActivityHostNotificationManager"),Wc.Wql,Wc.Pql)),
this.W.resolve("Common.Interface.IEditNotificationManager"),v.ULS.shipAssertTag(38086291,209,0<Wc.ogf,"EditNotification Interval is less than or equal to 0."))}xc(b){this.W=b}dispose(){}static get ogf(){return w.AFrameworkApplication.K?parseInt(w.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get Pql(){return w.AFrameworkApplication.K?parseInt(w.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get Vql(){return!!w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.$("EditNotificationIsEnabled")}static get Wql(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("EditNotificationPostMessageIsEnabled")}static main(){N.a.instance.Fc(new Wc)}}Object(n.a)(Wc,"CommonHostNotificationPackage",null,[1,2]);class Gd{constructor(b,k,t){this.sxb=null;this.Hb=b;this.ga=k;this.kVg=t.create()}nnb(){this.sxb?v.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(v.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),
this.sxb=new Df.a(2,1,3E4,Object(A.a)(this,this.fie,"showFloatPane"),67),this.Hb.Vb(this.sxb))}fie(){this.sxb=null;v.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.kVg.display()}jSa(){this.ga.qa($a.a.fie,Ud.a.frame,Object(A.a)(this,this.Wto,"showFloatPaneHandler"))}Wto(b,k,t,D,P){return b!==$a.a.fie?2:1===t?32:2===t&&P?(v.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",P),P?this.nnb():(this.sxb?(v.ULS.sendTraceTag(23674914,
207,50,"Hide float pane via removing show task!"),this.Hb.Ve(this.sxb)):(v.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.kVg.remove(null)),this.sxb=null),32):8}}Object(n.a)(Gd,"FloatPaneActor",null,[766]);var Ye=c(96),od=c(89),vf=c(38),df=c(26);class dh{constructor(b,k,t,D,P){this.BIe=this.Ltc=this.rsd=this.DXa=this.sea=this.XUa=this.Nte=this.T$=this.qyc=this.jwc=this.kwc=this.DAe=null;this.Hb=k;this.Ma=b;this.hg=t;this.W=P;this.Eza=D}qKh(){this.T$=document.createElement("div");
this.T$.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.T$.style.width=this.sea.width+"px";(this.BIe=this.I3l(this.Eza))?(this.DXa=document.createElement("a"),this.DXa.setAttribute(df.a.qh,df.a.Yy),this.hg.lb(Rc.a.click,this.DXa,Object(A.a)(this,this.KVi,"onRedirectClick")),this.DXa.href=this.BIe,this.DXa.target="_blank",this.DXa.appendChild(this.sea),this.T$.appendChild(this.DXa)):this.T$.appendChild(this.sea);this.XUa=document.createElement("a");this.XUa.setAttribute(df.a.qh,
df.a.e3);this.XUa.className="StandardButton WACFloatPaneCloseButton";this.XUa.title=CommonUIStrings.l_Close;this.XUa.tabIndex=-1;this.Nte=od.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.Nte.setAttribute(df.a.qh,df.a.Yy);this.XUa.appendChild(this.Nte);this.hg.lb(Rc.a.click,this.XUa,Object(A.a)(this,this.onClose,"onClose"));this.T$.appendChild(this.XUa);this.qyc.appendChild(this.T$)}vYl(b){const k=this.Ma.$("O365PromotionHasStarted");
switch(b){case 2:return Ye.a.Oaa(String.format("adppt{0}.png",k?"sale":""));case 1:return Ye.a.Oaa(String.format("adxls{0}.png",k?"sale":""));case 3:return Ye.a.Oaa(String.format("addoc{0}.png",k?"sale":""))}return null}I3l(b){const k=this.Ma.jb("O365AdPaneRedirectedURL");switch(b){case 1:return String.format(k,"Excel");case 2:return String.format(k,"PowerPoint");case 3:return String.format(k,"Word")}return null}hide(b=null){this.Ltc=null;this.T$&&!this.rsd&&(b?v.ULS.sendTraceTag(23674904,207,50,
"The float pane is closed automatically."):v.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.T$.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.T$.style.height="0px",this.rsd=new Df.a(2,1,1E3,Object(A.a)(this,this.remove,"remove"),67),this.Hb.Vb(this.rsd))}remove(){this.T$&&this.qyc&&(this.DXa&&this.hg.rc(Rc.a.click,this.DXa,Object(A.a)(this,this.KVi,"onRedirectClick")),this.hg.rc(Rc.a.click,this.XUa,Object(A.a)(this,this.onClose,"onClose")),
this.qyc.removeChild(this.T$),this.T$=null);this.rsd=null}display(){if(this.DAe=this.W.Na("Common.IFloatPaneContainer"))if(this.qyc=this.DAe.container){var b=this.vYl(this.Eza);b?(v.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.sea=document.createElement("img"),this.sea.className="WACFloatPaneImage",this.kwc=Object(A.a)(this,this.kon,"onLoadImageFinish"),vf.a.addHandler(this.sea,Rc.a.load,this.kwc),this.jwc=Object(A.a)(this,this.jon,"onLoadImageError"),vf.a.addHandler(this.sea,
Rc.a.error,this.jwc),this.sea.src=b):v.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else v.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else v.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}kon(){const b=this.Ma.mc("O365AdPaneShowingDuration",60);this.qKh();this.T$.style.display="block";this.T$.style.height=this.sea.height+"px";this.Ltc=new Df.a(2,
1,1E3*b,Object(A.a)(this,this.hide,"hide"),67);this.Hb.Vb(this.Ltc);this.L9i()}jon(){v.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.L9i();this.sea=null}L9i(){this.kwc&&this.sea&&vf.a.removeHandler(this.sea,Rc.a.load,this.kwc);this.kwc=null;this.jwc&&this.sea&&vf.a.removeHandler(this.sea,Rc.a.error,this.jwc);this.jwc=null}KVi(){v.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.Ltc&&
this.Hb.Ve(this.Ltc);this.hide();return!0}dispose(){this.hide()}}Object(n.a)(dh,"FloatPane",null,[731]);class Ki{constructor(b,k,t,D,P){this.Hb=k;this.Ma=b;this.hg=t;this.W=P;this.Eza=D}create(){return new dh(this.Ma,this.Hb,this.hg,this.Eza,this.W)}}Object(n.a)(Ki,"FloatPaneFactory",null,[698]);var Zh=c(230);class rh{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get vwi(){return w.AFrameworkApplication.K.$("O365AdvertisementIsEnabled")&&w.AFrameworkApplication.K.$("IsShowAdvertisementPaneEnabled")}init(){this.vwi&&
(v.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").nnb(),v.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").jSa())}xc(b){this.W=b;this.vwi&&(this.W.register(Ki,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Rd(()=>new Ki(w.AFrameworkApplication.K,w.AFrameworkApplication.nc,Zh.a.instance,w.AFrameworkApplication.ta.Nb.Sl,
this.W)).singleInstance(),this.W.register(Gd,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Rd(()=>new Gd(w.AFrameworkApplication.nc,w.AFrameworkApplication.va,this.W.resolve("Common.App.FloatPane.IFloatPaneFactory"))).singleInstance())}dispose(){}static main(){N.a.instance.Fc(new rh)}}Object(n.a)(rh,"FloatPanePackage",null,[1,2]);var bm=c(1639);class Bf{}Object(n.a)(Bf,"LokiTokenResult",null,[]);class ig{constructor(b){this.xpd=b}xrf(){const b=this.J0l();return b?
ig.d3a?new Promise((k,t)=>{this.xpd.continueWith(()=>{this.xpd.zo||this.xpd.Ci?t(Error.create("Error downloading auth library")):this.xpd.result.PY("Loki",b).then(D=>{D=w.AFrameworkApplication.K.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.M0l():D.IsSuccess&&D.Token?Object.assign(new Bf,{isSuccess:!0,token:D.Token,errorMessage:null}):Object.assign(new Bf,{isSuccess:!1,token:null,errorMessage:JSON.stringify(D)});k(D);return D})})}):Promise.resolve(Object.assign(new Bf,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):
Promise.resolve(Object.assign(new Bf,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",bm.a.R3h())}))}M0l(){const b=w.AFrameworkApplication.K.jb("LokiUserDataSignature")||"";return Object.assign(new Bf,{isSuccess:!0,token:b,errorMessage:null})}J0l(){let b=null;const k=bm.a.JNd();2===k?b=w.AFrameworkApplication.K.jb("LokiAADAppId"):1===k&&(b=w.AFrameworkApplication.K.jb("LokiMSAAppId"));return b}static get d3a(){return w.AFrameworkApplication.K.$("IsO365CommercialHost")||
w.AFrameworkApplication.K.$("IsO365ConsumerHost")}}Object(n.a)(ig,"LokiTokenManager",null,[697]);class md{get name(){return"Common.App.LivePersonaUtils"}init(){Fa.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}xc(b){b.register(ig,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").singleInstance().Rd(()=>new ig(Tb.a.Ap(b.Sa("Common.App.OAuth.IOAuthManager"))))}static main(){N.a.instance.Fc(new md)}}Object(n.a)(md,"LivePersonaUtilsPackage",null,[1,2]);class td{constructor(b){this.nse=
b}Evi(b){if(!this.nse)return!0;b=ia.a.vqf(b);if(!b)return!1;b=b.toLowerCase();for(let k=0;k<this.nse.length;k++)if(b.endsWith(this.nse[k]))return!0;return!1}}Object(n.a)(td,"DomainAllowListManager",null,[]);class wd{constructor(b,k){this.jcf=null;this.NUe=b;this.url=k}get lng(){return ia.a.fya(this.url)}get Vr(){return this.NUe}qjg(){const b={},k=this.Vr;b.a=this.lng;b.b=this.round(k.navigationStart);b.c=this.round(k.unloadEventStart);b.d=this.round(k.unloadEventEnd);b.e=this.round(k.redirectStart);
b.f=this.round(k.redirectEnd);b.g=this.round(k.fetchStart);b.h=this.round(k.domainLookupStart);b.i=this.round(k.domainLookupEnd);b.j=this.round(k.connectStart);b.k=this.round(k.connectEnd);b.l=void 0!==k.secureConnectionStart&&null!==k.secureConnectionStart?this.round(k.secureConnectionStart):0;b.m=this.round(k.requestStart);b.n=this.round(k.responseStart);b.o=this.round(k.responseEnd);b.q=this.round(k.domInteractive);b.r=this.round(k.domContentLoadedEventStart);b.s=this.round(k.domContentLoadedEventEnd);
b.t=this.round(k.domComplete);b.u=this.round(k.loadEventStart);b.v=this.round(k.loadEventEnd);b.w=this.jcf;return b}round(b){return Math.round(1E3*b)/1E3}}Object(n.a)(wd,"PerformanceTimingEntry",null,[]);const pm=(b,k)=>{const t={};let D=null;switch(b){case 0:D="ResourceTiming";b=k.a;null!=b&&(t.Url=b);b=k.b;null!=b&&(t.InitiatorType=b);b=null==k.c?null:k.c.toString();null!=b&&(t.RedirectStart=b);b=null==k.d?null:k.d.toString();null!=b&&(t.RedirectEnd=b);b=null==k.e?null:k.e.toString();null!=b&&(t.FetchStart=
b);b=null==k.f?null:k.f.toString();null!=b&&(t.DomainLookupStart=b);b=null==k.g?null:k.g.toString();null!=b&&(t.DomainLookupEnd=b);b=null==k.h?null:k.h.toString();null!=b&&(t.ConnectStart=b);b=null==k.i?null:k.i.toString();null!=b&&(t.ConnectEnd=b);b=null==k.j?null:k.j.toString();null!=b&&(t.SecureConnectionStart=b);b=null==k.k?null:k.k.toString();null!=b&&(t.RequestStart=b);b=null==k.l?null:k.l.toString();null!=b&&(t.ResponseStart=b);b=null==k.m?null:k.m.toString();null!=b&&(t.ResponseEnd=b);b=k.n;
null!=b&&(t.CustomText=b);b=null==k.o?null:k.o.toString();null!=b&&(t.DecodedBodySize=b);b=null==k.p?null:k.p.toString();null!=b&&(t.EncodedBodySize=b);k=null==k.q?null:k.q.toString();null!=k&&(t.TransferSize=k);break;case 1:D="PerformanceTiming",b=k.a,null!=b&&(t.Url=b),b=null==k.b?null:k.b.toString(),null!=b&&(t.NavigationStart=b),b=null==k.c?null:k.c.toString(),null!=b&&(t.UnloadEventStart=b),b=null==k.d?null:k.d.toString(),null!=b&&(t.UnloadEventEnd=b),b=null==k.e?null:k.e.toString(),null!=b&&
(t.RedirectStart=b),b=null==k.f?null:k.f.toString(),null!=b&&(t.RedirectEnd=b),b=null==k.g?null:k.g.toString(),null!=b&&(t.FetchStart=b),b=null==k.h?null:k.h.toString(),null!=b&&(t.DomainLookupStart=b),b=null==k.i?null:k.i.toString(),null!=b&&(t.DomainLookupEnd=b),b=null==k.j?null:k.j.toString(),null!=b&&(t.ConnectStart=b),b=null==k.k?null:k.k.toString(),null!=b&&(t.ConnectEnd=b),b=null==k.l?null:k.l.toString(),null!=b&&(t.SecureConnectionStart=b),b=null==k.m?null:k.m.toString(),null!=b&&(t.RequestStart=
b),b=null==k.n?null:k.n.toString(),null!=b&&(t.ResponseStart=b),b=null==k.o?null:k.o.toString(),null!=b&&(t.ResponseEnd=b),b=null==k.p?null:k.p.toString(),null!=b&&(t.DomLoading=b),b=null==k.q?null:k.q.toString(),null!=b&&(t.DomInteractive=b),b=null==k.r?null:k.r.toString(),null!=b&&(t.DomContentLoadedEventStart=b),b=null==k.s?null:k.s.toString(),null!=b&&(t.DomContentLoadedEventEnd=b),b=null==k.t?null:k.t.toString(),null!=b&&(t.DomComplete=b),b=null==k.u?null:k.u.toString(),null!=b&&(t.LoadEventStart=
b),b=null==k.v?null:k.v.toString(),null!=b&&(t.LoadEventEnd=b),k=k.w,null!=k&&(t.CustomText=k)}t.Table=D;return Sys.Serialization.JavaScriptSerializer.serialize(t)};var ai=c(47),Zg=c(232),Tk=c(167);class el{constructor(b,k=null,t=null){this.Tf=b;this.kng=this;this.$2j=k||(()=>window.location.href);this.Bye=new td(t)}run(){if(el.aeb(window.performance))try{const P=this.$2j();if(el.Vlk.exec(P)&&this.Bye.Evi(P)){var b=new wd(window.performance.timing,P);Tk.a.instance.COn(b.Vr.fetchStart);Tk.a.instance.DOn(b.Vr.navigationStart);
Tk.a.instance.nY(ai.a.MGl,"connectStart","requestStart");Tk.a.instance.nY(ai.a.UGl,"requestStart","responseStart");Tk.a.instance.nY(ai.a.XGl,"responseStart","responseEnd");this.kng.UIb(1,b.qjg());this.Tf.rf(ai.a.Pgb,b.Vr.fetchStart);this.Tf.rf(ai.a.RGl,b.Vr.domainLookupStart);this.Tf.rf(ai.a.QGl,b.Vr.domainLookupEnd);this.Tf.rf(ai.a.OGl,b.Vr.connectStart);this.Tf.rf(ai.a.ZGl,b.Vr.secureConnectionStart);this.Tf.rf(ai.a.NGl,b.Vr.connectEnd);this.Tf.rf(ai.a.VGl,b.Vr.requestStart);this.Tf.rf(ai.a.Plf,
b.Vr.responseStart);this.Tf.rf(ai.a.SGl,b.Vr.responseEnd-b.Vr.responseStart);this.Tf.rf(ai.a.WGl,b.Vr.responseStart-b.Vr.requestStart);var k=0,t=0,D=0;({transferSize:k,chf:t,Gcf:D}=this.SMo(P)).returnValue&&(this.Tf.rf(ai.a.aHl,k),this.Tf.rf(ai.a.PGl,D),this.Tf.rf(ai.a.TGl,t));this.Tf.rf(ai.a.sMc,b.Vr.navigationStart)}}catch(P){v.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",P)}}SMo(b){let k,t,D;D=t=k=-1;if(void 0===window.performance.getEntriesByName||null===
window.performance.getEntriesByName)return{returnValue:!1,transferSize:k,chf:t,Gcf:D};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:k,chf:t,Gcf:D};b=b[0];var P=b.transferSize;void 0!==k&&null!==k&&(k=P);P=b.decodedBodySize;void 0!==P&&null!==P&&(D=P);b=b.encodedBodySize;void 0!==b&&null!==b&&(t=b);return{returnValue:!0,transferSize:k,chf:t,Gcf:D}}UIb(b,k){v.ULS.sendTraceTag(4551815,306,50,pm(b,k))}static get instance(){return el._instance||
(el._instance=new el(Zg.a.instance,null,w.AFrameworkApplication.K.$("PerfTimingLoggerFilterDomainsIsEnabled")?w.AFrameworkApplication.K.GC("ResourceLoggerDomainAllowList"):null))}static aeb(b){return!(void 0===b||null===b)&&!(void 0===b.timing||null===b.timing)}}el._instance=null;el.Vlk=RegExp("^https?://.*","i");Object(n.a)(el,"PerformanceTimingLogger",null,[696]);class zl{constructor(b,k){this.jcf=null;this.NUe=b;this.behavior=k;this.url=this.Vr.name}get lng(){return 2===this.behavior?this.url:
ia.a.fya(this.url)}get Vr(){return this.NUe}qjg(){const b={},k=this.Vr;b.a=this.lng;b.b=k.initiatorType;b.c=this.round(k.redirectStart);b.d=this.round(k.redirectEnd);b.e=this.round(k.fetchStart);b.f=this.round(k.domainLookupStart);b.g=this.round(k.domainLookupEnd);b.h=this.round(k.connectStart);b.i=this.round(k.connectEnd);b.j=void 0!==k.secureConnectionStart&&null!==k.secureConnectionStart?this.round(k.secureConnectionStart):0;b.k=this.round(k.requestStart);b.l=this.round(k.responseStart);b.m=this.round(k.responseEnd);
b.o=this.round(zl.h8b(k,"decodedBodySize"));b.p=this.round(zl.h8b(k,"encodedBodySize"));b.q=this.round(zl.h8b(k,"transferSize"));b.n=this.jcf;return b}round(b){return Math.round(1E3*b)/1E3}static h8b(b,k){return b[k]}}Object(n.a)(zl,"ResourceTimingEntry",null,[749]);class ei{constructor(b,k=null,t=100){this.kLg=b;this.Yud=k;this.$Rb={};this.tXj=t}ALo(b){var k=b.name.toLowerCase();const t=ia.a.PQd(k);this.Y4n(t,k)&&(t in this.$Rb?v.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
t):(k={},k.fetchstart=b.fetchStart,k.responseend=b.responseEnd,k.iscached=this.eSm(b),k.encodedsize=zl.h8b(b,"encodedBodySize"),k.decodedsize=zl.h8b(b,"decodedBodySize"),this.$Rb[t]=k))}Y4n(b,k){if(this.kLg)return Array.contains(this.kLg,b);if(this.Yud)for(b=ia.a.y_(k),k=0;k<this.Yud.length;k++)if(this.Yud[k]&&b.endsWith(this.Yud[k]))return!0;return!1}eSm(b){try{const k=zl.h8b(b,"transferSize");if(void 0!==k&&null!==k)return!k;v.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");
return b.responseEnd-b.fetchStart<this.tXj}catch(k){v.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",k.message)}return!1}bRn(){if(ib.a.jf(this.$Rb))v.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var b=w.AFrameworkApplication.flightId?w.AFrameworkApplication.flightId.split(";"):[],k=Object.assign(new Db.a,{extendedProperties:db.a.fG()});k.extendedProperties.set("Flights",
G.c(b));this.aJi(k,this.$Rb,xa.Health.instance)}}Lmf(b){let k=0,t=0,D=0,P=0;const ca=this.$Rb;for(let Na in ca){var ta=ca[Na];Na.endsWith(".js")&&(ta=Object(Ka.a)(Object,ta),ta.responseend<b&&(k+=1,t+=ta.decodedsize,P+=ta.encodedsize,D+=ta.iscached?0:ta.encodedsize))}b={};b.filesLoaded=k;b.decodedBytes=t;b.transferredBytes=D;b.encodedBytes=P;return b}aJi(b,k,t){if(k){var D=0,P=0,ca=0,ta=0,Na=0,qb=0,Jb=0,Vb=0,ac=0,yc=0,Kc=0;for(let sd in k){var ed=k[sd];try{const oe=Object(Ka.a)(Object,ed);if(!oe)continue;
const Ld=oe.iscached?Boolean.parse(oe.iscached.toString()):!1,Od=oe.fetchstart?this.parseFloat(oe.fetchstart.toString()):0,ie=(oe.responseend?this.parseFloat(oe.responseend.toString()):0)-Od,Ce=oe.encodedsize?this.parseFloat(oe.encodedsize.toString()):0,hg=oe.decodedsize?this.parseFloat(oe.decodedsize.toString()):0;D+=ie;ta+=Ce;Jb+=hg;yc++;Ld?(ca+=ie,qb+=Ce,ac+=hg,Kc++):(P+=ie,Na+=Ce,Vb+=hg)}catch(oe){v.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",
oe.message)}}b.extendedProperties.set("StaticResources",G.c(k));b.extendedProperties.set("TotalResourceDownloadLatency",D.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",P.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",ca.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",ta.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Na.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",
qb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Jb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Vb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",ac.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",yc.toString());b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Kc.toString());t.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",
null);t.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(n.a)(ei,"AppStaticResourceManager",null,[]);class fi extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(n.a)(fi,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class Lj{constructor(b,k,t=null,D=null,P=100){this.HGe=!1;this.vo=null;this.zqc=0;this.ra=new Ue.a;this.iSb=null;this.xZ=!1;this.zih=0;this.Hb=b;this.UQg=0;this.kng=this;this.Bye=new td(t);
this.pK=k;D&&(this.iSb=new ei(null,D,P))}get Jxh(){try{return!(void 0===this.pK||null===this.pK)&&!(void 0===this.pK.getEntriesByType||null===this.pK.getEntriesByType)}catch(b){return v.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get igl(){return this.UQg}get isActive(){return this.xZ}get gjg(){return this.zih}qph(b){this.ra.addHandler(Lj.Yhf,b)}R$i(b){this.ra.removeHandler(Lj.Yhf,b)}xc(b,k){const t=this.gjg!==b;this.zih=
b;this.isActive&&this.Hb&&t&&(this.Ve(),this.Vb());this.UQg=k}activate(){!this.isActive&&this.Jxh&&(this.Vb(),this.xZ=!0)}deactivate(b){this.isActive&&(this.Ve(),b&&this.flush(),this.xZ=!1)}flush(){if(this.isActive&&this.Jxh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.zqc&&v.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",b.length-this.zqc);const k=!(void 0===window.performance.clearResourceTimings||
null===window.performance.clearResourceTimings);k&&(window.performance.clearResourceTimings(),this.zqc=0);const t=[];for(let D=this.zqc;D<b.length;D++)this.Bye.Evi(b[D].name)&&(this.iSb&&this.iSb.ALo(b[D]),t.push(new zl(b[D],this.igl)));k||(this.zqc=b.length);this.ra.raiseEvent(Lj.Yhf,new fi(t));for(b=0;b<t.length;b++)0!==t[b].behavior&&2!==t[b].behavior||this.kng.UIb(0,t[b].qjg());0<t.length&&v.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",
t.length)}catch(k){v.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",k)}}UIb(b,k){v.ULS.sendTraceTag(4310804,306,50,pm(b,k))}xOn(){this.iSb.bRn()}Lmf(b){return this.iSb.Lmf(b)}Vb(){this.Hb&&0<this.gjg&&(this.vo=new Df.a(3,2,1E3*this.gjg,()=>{this.flush()},5),this.Hb.Vb(this.vo),this.HGe=!0)}Ve(){this.HGe&&(this.Hb.Ve(this.vo),this.vo=null,this.HGe=!1)}}Lj.Yhf="EntriesAvailable";Object(n.a)(Lj,"ResourceTimingLogger",null,[669,696]);class cm{constructor(){this.W=
null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve("Common.NetworkTiming.IResourceTimingLogger");el.instance.run()}dispose(){}xc(b){this.W=b;let k=null;if(w.AFrameworkApplication.K.$("ResourceLoggerFilterDomainsIsEnabled"))try{k=w.AFrameworkApplication.K.GC("ResourceLoggerDomainAllowList")}catch(P){v.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const t=[];t.push(ia.a.y_(Ye.a.n5).toLowerCase());t.push(ia.a.y_(Ye.a.z7c).toLowerCase());
const D=w.AFrameworkApplication.K.mc("AppStaticResourceMonitorCacheThresholdInMs",100);b.register(669,"Common.NetworkTiming.IResourceTimingLogger").singleInstance().Rd(()=>new Lj(w.AFrameworkApplication.nc,window.performance,k,t,D))}static main(){N.a.instance.Fc(new cm)}}Object(n.a)(cm,"ResourceTimingPackage",null,[1,2]);var Rg=c(243);class Xf{constructor(){this.Dre={}}epk(b){this.Dre[b.id.toString()]=b}ign(b){const k=this.Dre;for(let t in k)k[t].notify(b,!1);this.Dre={}}nJn(b,k){k&&this.epk(k);return this.XVi(b,
k)}Pgf(b){this.ign(b)}IUh(b,k){b.notify(k,!0)}}Object(n.a)(Xf,"AEventEmitter",null,[323]);var Si;(function(b){b[b.notStarted=0]="notStarted";b[b.waiting=1]="waiting";b[b.shouldRetry=2]="shouldRetry";b[b.complete=3]="complete"})(Si||(Si={}));Object(n.b)("EventResultState",Si);class Sl{constructor(){this._state=0}get state(){return this._state}set state(b){v.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:Si[this._state],["NewState"]:Si[b]},"ResultType",this.Oei());
this._state=b}}Object(n.a)(Sl,"AEventResult",null,[322]);class Om extends Sl{constructor(){super();this.fTe=this.Lyc=null;this.state=0;this.lEe=this.NZg=!1}get Aca(){return this.Lyc}get X6a(){return this.fTe}get CBm(){return this.NZg}Oei(){return"GetMoreInfo Result"}}Object(n.a)(Om,"GetMoreInfoResult",Sl,[744,322]);var sg=c(1364),Dk=c(1538),yj=c(1044);class Qj{constructor(b,k,t,D,P,ca,ta,Na){this.ga=b;this.Wf=k;this.Jh=t;this.Eza=D;this.Hb=P;this.pD=ca;this.r4j=ta;this.uvd=Na}ySn(){this.Pdc.qa($a.a.Yec,
Ud.a.frame,Object(A.a)(this,this.Yec,"openUrlInNewTab"));this.Pdc.qa($a.a.FWf,Ud.a.frame,Object(A.a)(this,this.FWf,"openDocumentUrl"));w.AFrameworkApplication.Tfa?this.gJi():this.Pdc.fb($a.a.bJd,Ud.a.frame,Object(A.a)(this,this.bJd,"documentLoaded"),96)}Yec(b,k,t,D,P){P&&P.MenuItemId&&(v.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:P.SourceControlId,["AppType"]:yj.a[this.gxa]}),$d.a.nm(P.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}FWf(b,
k,t,D,P){if(P&&P.MenuItemId){const ca=w.AFrameworkApplication.K.$("WacInTabOpenMRUIsEnabledForUiHost"),ta=w.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");v.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",ca,ta);if(ca&&ta){v.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:P.SourceControlId,["AppType"]:yj.a[this.gxa]});b=P.MenuItemId.toString();const Na={};Na[I.a.Kgc]="1";Na[I.a.documentUrl]=b;Na[I.a.reason]=Dk.a.open;
v.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");w.AFrameworkApplication.MO().execute(qb=>{qb.sendMessage(K.a.$Bb,Na)})}else this.Yec(b,k,t,D,P)}return 32}bJd(){this.gJi();return 32}OQa(b,k,t=""){if(k&&k.IH){const D=sg.a[k.status];k=k.IH.getTime();const P=this.eq()-k;v.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:D,["ElapsedMs"]:P,["StartTime"]:k,["Notes"]:t})}else v.ULS.sendTraceTag(5849680,202,50,
"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}gJi(){var b=w.AFrameworkApplication.K.$("QPGVCI"),k=ia.a.bU(document.URL,"wdNewAndOpenCt",b);if(k){k=parseInt(k);var t=ia.a.bU(document.URL,"wdPreviousSession",b);b=ia.a.bU(document.URL,"wdPreviousCorrelation",b);var D=w.AFrameworkApplication.K.$("NAOPLP");if(w.AFrameworkApplication.Tfa){var P=w.AFrameworkApplication.Tfa.getTime();!k||k>P?v.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",
{["ClickTimestamp"]:k,["DocumentLoadedTime"]:P,["SessionId"]:t,["Correlation"]:b}):v.ULS.sendTraceTag(5849683,202,D?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:P-k,["ClickTimestamp"]:k,["SessionId"]:t,["Correlation"]:b})}else v.ULS.sendTraceTag(5849681,202,D?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:k,["SessionId"]:t,["Correlation"]:b})}}get Pdc(){return this.ga.value}get qZc(){return this.Wf.value}get sPi(){return this.Jh.value}get gxa(){return this.Eza.value}get Y4d(){return this.Hb.value}get eq(){return this.pD}get lRa(){return this.r4j.value}get a7a(){return this.uvd.value}static get instance(){return Qj._instance||
(Qj._instance=Qj.Jr())}static Jr(){return new Qj(new Rg.a(()=>w.AFrameworkApplication.va),new Rg.a(()=>w.AFrameworkApplication.Ne),new Rg.a(()=>w.AFrameworkApplication.ta),new Rg.a(()=>w.AFrameworkApplication.ta.Nb.Sl),new Rg.a(()=>w.AFrameworkApplication.nc),()=>(new Date).getTime(),new Rg.a(()=>w.AFrameworkApplication.ta.Nb.lRa),new Rg.a(()=>w.AFrameworkApplication.a7a))}}Qj._instance=null;Object(n.a)(Qj,"NewAndOpenCommonHelpers",null,[320]);class tg{constructor(b,k,t){this.Vtd=this.vo=null;this.JPe=
0;this.Bhk=b;this.Hb=k;this.vRg=t}vzk(){this.JPe=this.shc+1}p7f(b){this.vo&&(this.Hb.Ve(this.vo),this.vo=null);b&&(this.JPe=0)}dAo(b){const k=this.FHo;0<=k?(this.vzk(),this.p7f(!1),this.vo=new Df.a(4,1,k,b,107),this.Hb.Vb(this.vo)):(this.p7f(!0),v.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.vRg}))}get shc(){return this.JPe}get FHo(){return this.shc>=this.wij.length?-1:this.wij[this.shc]}get wij(){if(!this.Vtd){const b=(this.Bhk.value||"0").split(",");this.Vtd=[];for(let k=
0;k<b.length;k++){const t=parseInt(b[k]);isNaN(t)?v.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.vRg,["Entry"]:b[k]}):Array.add(this.Vtd,t)}}return this.Vtd}}Object(n.a)(tg,"RetryHelper",null,[]);class Gh extends Xf{constructor(b,k){super();this.UAa=b;this.Nzc=new tg(k,this.YYc.Y4d,"GetMoreInfo");this.pq=new Om}P7m(){this.SLf("Document opened")}Y$k(b){return()=>{this.SLf(b,!0)}}XVi(b,k=null){v.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",
{["Trigger"]:b});3===this.pq.state?(k&&this.IUh(k,this.pq),v.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):this.SLf(b);return this.pq}SLf(b,k=!1){this.Nzc.p7f(!k);1===this.pq.state?v.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.Nzc.shc}):(v.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.Nzc.shc}),this.pq.state=1,k=String.format("{0}GetMoreInfoHandler.ashx?{1}",
this.YYc.lRa,w.AFrameworkApplication.hm),this.YYc.qZc.Tyb(k,1,null,null,[Gh.eah,Gh.Ugh],5,this.K9k(),this.J9k(b)))}K9k(){return b=>{var k=!1;let t=!1;var D=!1,P;w.AFrameworkApplication.K.$("GetMoreInfoDataFromResponseBody")&&(b.data.xe?({Wu:P}=G.d(b.data.xe)).returnValue?P?(D=!0,this.pq.fTe=P.StorageServiceDisplayName,this.pq.Lyc=Gh.MCi(P.PersonalFileStorageUrl)?P.PersonalFileStorageUrl:"",""===this.pq.Aca&&"SharePointOnlineConsumer"===w.AFrameworkApplication.K.jb("FileSource")&&(this.pq.Lyc=ia.a.fya(w.AFrameworkApplication.breadcrumbFolderUrl)),
k=""===this.pq.Aca&&""!==this.pq.X6a):v.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):v.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):v.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));D||((P=b.data.vj)?(this.pq.fTe=
(P[Gh.Ugh]||"").toString(),k=(P[Gh.eah]||"").toString(),this.pq.Lyc=Gh.MCi(k)?k:"",""===this.pq.Aca&&"SharePointOnlineConsumer"===w.AFrameworkApplication.K.jb("FileSource")?(this.pq.Lyc=ia.a.fya(w.AFrameworkApplication.breadcrumbFolderUrl),k=""===this.pq.Aca&&""!==this.pq.X6a):k=""===k&&""!==this.pq.X6a):(v.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),t=!0));D=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.Nzc.shc,t,k,D);this.YYc.OQa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,D);this.Mij(3,k,t)}}J9k(b){return k=>{this.YYc.OQa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",k.data,"Failure");this.Mij(2);this.Nzc.dAo(this.Y$k(b))}}Mij(b,k=!1,t=!1){this.pq.state=b;this.pq.NZg=k;this.pq.lEe=t;this.Pgf(this.pq)}get YYc(){return this.UAa.value}static get instance(){return Gh._instance||(Gh._instance=Gh.Jr())}static Jr(){return new Gh(new Rg.a(()=>Qj.instance),
new Rg.a(()=>w.AFrameworkApplication.W1l))}static MCi(b){if(!b)return v.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(F.a.Tg(b).startsWith("https://"))return!0;v.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}Gh.eah="PersonalFileStorageUrl";Gh.Ugh="StorageServiceDisplayName";Gh._instance=null;Object(n.a)(Gh,"GetMoreInfoActor",Xf,[]);class zj{constructor(b,k,t,D,P){this.I5j=6E4;this.fpi="inactive";this.tmh="active";
this.xZ=!0;this.Hb=b;this.y3j=k;this.pD=t;this.swd=D;this.ra=new Ue.a;P&&this.Tzo();this.T2g=this.bai()}Vmh(b){this.ra.addHandler(this.tmh,b)}zsk(b){this.ra.addHandler(this.fpi,b)}Tzo(){const b=new Df.a(5,2,this.I5j,Object(A.a)(this,this.mum,"inactiveLoop"),108);this.num.Vb(b)}mum(){const b=this.bai(),k=this.eq()-b;k>this.tle&&this.xZ&&(v.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:k}),this.xZ=!1,this.ra.raiseEvent(this.fpi));b-this.T2g>this.tle&&(this.xZ=!0,
this.ra.raiseEvent(this.tmh));this.T2g=b}get num(){return this.Hb.value}get bai(){return this.y3j}get eq(){return this.pD}get tle(){return this.swd.value}static get instance(){return zj._instance||(zj._instance=zj.Jr())}static Jr(){return new zj(new Rg.a(()=>wb.a.instance),()=>w.AFrameworkApplication.sIf.getTime(),()=>(new Date).getTime(),new Rg.a(()=>w.AFrameworkApplication.tle),!0)}}zj._instance=null;Object(n.a)(zj,"InactivityManager",null,[]);var pj=c(1659);class Il extends Sl{constructor(){super();
this.mak=this.W6g=this.V6g=null;this.state=this.Aih=0;this.lEe=!1}get UNf(){return this.V6g}get IOi(){return this.W6g}get LHo(){return this.Aih}Oei(){return"MruActor Result"}}Object(n.a)(Il,"MruResult",Sl,[321,322]);class Tl{constructor(b,k,t){this.task=null;this.fGb=b;this.maxRetries=k;this.taskManager=t;this.retryCount=this.SSc=0;this.YNe=this.EWc=null}ZNm(b,k){return b===ha.a.t6b||20===k||18===k||3===k}tPm(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===
b||16===b||23===b||26===b||27===b||28===b}get T$d(){return this.YNe}reset(){this.SSc=this.retryCount=0;this.YNe=this.EWc=null;this.task&&(this.taskManager.Ve(this.task),this.task=null)}Mym(b,k,t,D){this.YNe=String.format("{0}_{1}",t,D);if(this.retryCount>=this.maxRetries)return v.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.ZNm(t,D))return v.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.tPm(D)&&1<=this.SSc)return this.EWc=t,!1;k=
Math.max(k,this.fGb*Math.pow(2,this.SSc));if(26===D)k=Math.max(k,3E4);else if(27===D||28===D)k=Math.max(k,6E4);9===D||412===t&&(null==this.EWc||412!==this.EWc)?k=500:this.SSc+=1;this.EWc=t;this.retryCount+=1;this.task&&this.taskManager.Ve(this.task);v.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",k);this.task=new Df.a(2,1,k,b,107);this.taskManager.Vb(this.task);return!0}}Object(n.a)(Tl,"RetryManager",null,[]);var Qg=c(127);class An{constructor(){this.mruItemId=this.app=this.documentExt=
this.documentName=this.folderName=this.documentUrl=null}}Object(n.a)(An,"WriteOptions",null,[]);var Xj=c(741);class Gk extends Xf{constructor(b,k,t,D,P,ca,ta){super();this.UAa=b;this.d$j=k;this.Tbb=new Tl(w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.KM.Y4d);this.fdb=new Tl(w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",
15E3),w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.KM.Y4d);this.tfk=t;this.vlh=D;this.$nk={};this.Gka=new Il;this.W2j=P;this.Uod="";this.HL=ca;this.rTg=ta;this.jsd="";this.xfk=w.AFrameworkApplication.K.mc("WordRecentLinksCount",25)}get mpe(){return this.$nk}jWn(){this.KM.Pdc.qa($a.a.Baj,Ud.a.frame,Object(A.a)(this,this.W_n,"renameMruEntry"))}W_n(){return this.Epg("Rename")}f8m(){this.zLi("File Opened")}g8m(){this.zLi("IntervalUpdate")}zLi(b){v.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.Epg(b)}zga(b){(b=F.a.zga(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}F3h(){switch(this.KM.gxa){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}Dgm(b){var k=this.W2j();if(!k)return null;const t=new An;t.documentUrl=this.rTg.value?encodeURI(k):k;t.mruItemId=this.Uod;t.app=this.F3h();if(k=this.HL())t.folderName=k.breadcrumbFolderName,
k=k.Zy,t.documentName=F.a.cJ(k),t.documentExt=this.zga(k);b&&(t.documentName?t.documentName.length?255<=t.documentName.length?b.set("DocumentNameLength","Long"):2084<=t.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength","Null"));return JSON.stringify(t)}Epg(b,k=!1){if(4===this.KM.gxa&&!w.AFrameworkApplication.ZId)return 2;var t=db.a.fG();t&&(t.set("Trigger",b),t.set("IsRetry",k?"true":"false"),t.set("MruIdSent",this.Uod?"true":"false"),
t.set("URLEncoded",this.rTg.value?"true":"false"));xa.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",t);b=this.Dgm(t);if(!b)return k=!w.AFrameworkApplication.eRb,t&&(t.set("WebEditingIsEnabled",w.AFrameworkApplication.eRb?"true":"false"),t.set("ProtectedFile",w.AFrameworkApplication.protectFile?"true":"false")),xa.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",k,!1,Object.assign(new Db.a,{extendedProperties:t})),2;this.fdb&&!k&&this.fdb.reset();t=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",
this.KM.lRa,this.VJf);this.vlh?this.mpe["X-FileId"]=w.AFrameworkApplication.hm:t+=String.format("&{0}",w.AFrameworkApplication.hm);w.AFrameworkApplication.sessionStartInfoSettings&&(this.mpe["X-Office-AudienceGroup"]=Object(Ka.a)(String,w.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");this.mpe["X-Timeout"]=15E3;return this.KM.qZc.sj(t,2,b,this.mpe,!0,5,Object(A.a)(this,this.d5o,"writeMruV2EntryOnServerSuccessCallback"),Object(A.a)(this,this.Ydl,"createWriteMruV2EntryOnServerFailureCallback"),
null,void 0,void 0,void 0,void 0,"4")}d5o(b){this.Vki(b.data)}Vki(b){const k=db.a.fG();this.fdb&&(k&&this.fdb.T$d&&(k.set("LastError",this.fdb.T$d),k.set("NumRetries",this.fdb.retryCount.toString())),this.fdb.reset());const t=pj.c(b.xe);t&&t.diagnostics_data&&(this.Uod=t.diagnostics_data.mru_id);b=+b.oT-+b.IH;k&&k.set("RequestDuration",b.toString());xa.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Db.a,{extendedProperties:k}))}Ydl(b){if(b.data.Qe===ha.a.pIc)this.Vki(b.data);else{var k=
b.data.Qe===ha.a.nia,t=db.a.fG();this.fli(this.fdb,b,this.Cdl(),t);t&&(t.set("StatusCode",b.data.Qe.toString()),k||this.zYe(b.data,t));xa.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",b.data.Qe),k,!1,Object.assign(new Db.a,{extendedProperties:t}))}}Cdl(){return()=>{this.Epg("Retry",!0)}}e2l(){this.jYc("Polling")}d2l(){this.jYc("Retry",!0)}S7m(){this.jYc("Open")}R7m(){this.jYc("Activity")}Q7m(){this.jYc("ActivityRecentLinks",!1,!0)}jYc(b,k=!1,t=!1){v.ULS.sendTraceTag(5849674,
202,50,"Making GetMru request {0}",{["Trigger"]:b});const D=db.a.fG();D&&(D.set("Trigger",b),D.set("IsRetry",k?"true":"false"),t&&D.set("RecentLinks","true"));xa.Health.instance.recordKpiUsage("GetMru",0,"smartfio",D);this.Tbb&&!k&&this.Tbb.reset();t?this.XKh(Object(A.a)(this,this.f2l,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(A.a)(this,this.a2l,"getMruForRecentLinksFromServerFailureCallback"),!0):this.XKh(Object(A.a)(this,this.g2l,"getMruV2FromServerSuccessCallback"),Object(A.a)(this,
this.c2l,"getMruFromServerFailureCallback"))}zYe(b,k){b&&b.vj&&(b=b.vj["X-CorrelationId"])&&k.set("ServerCorrelationId",b)}A1m(b,k){b&&(k&&k.set("RequestDuration",(+b.oT-+b.IH).toString()),xa.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Db.a,{extendedProperties:k})))}g2l(b){this.ebi(b)}ebi(b,k=!1){var t="";let D=null,P=null,ca=null;const ta=pj.c(b.data.xe);ta&&(D=ta.places?ta.places.items:[],P=ta.documents?ta.documents.items:[],(ca=pj.a(ta,k))&&(t=G.c(ca)));w.AFrameworkApplication.ta&&
w.AFrameworkApplication.ta.Nb.nQa&&Qg.c()&&(k?this.jsd=t:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(t,!0)));t=db.a.fG();this.Tbb&&(t&&this.Tbb.T$d&&(t.set("LastError",this.Tbb.T$d),t.set("NumRetries",this.Tbb.retryCount.toString())),this.Tbb.reset());k&&t&&t.set("RecentLinks","true");ca||D||P?(k?this.KM.OQa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Success"):this.KM.OQa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.xne(3,ca,D,P),this.A1m(b.data,
t)):(k?this.KM.OQa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.KM.OQa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),t&&this.zYe(b.data,t),xa.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Db.a,{extendedProperties:t})),this.xne(3,null,null,null,!0));this.Pgf(this.Gka)}f2l(b){this.ebi(b,!0)}fli(b,k,t,D){let P=0,ca=0;const ta=pj.c(k.data.xe);ta&&(null!=ta.response_code&&(P=ta.response_code,
D&&D.set("MruResponseCode",P.toString()),9===P&&(this.Uod="")),ta.error_data&&null!=ta.error_data.retry_after_ms&&(ca=ta.error_data.retry_after_ms,D&&D.set("ExpectedRetryAfter",ca.toString())));b&&(k=b.Mym(t,ca,k.data.Qe,P),D&&(D.set("CurrentRetryCount",b.retryCount.toString()),D.set("RetryScheduled",k?"true":"false")))}c2l(b){this.dbi(b)}dbi(b,k=!1){const t=b.data.Qe===ha.a.nia,D=db.a.fG();D&&(D.set("StatusCode",b.data.Qe.toString()),k&&D.set("RecentLinks","true"),t||this.zYe(b.data,D));k?this.KM.OQa("MruActor.GetMruForRecentLinksFromServerFailureCallback",
b.data,"Failure"):this.KM.OQa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.xne(2);this.fli(this.Tbb,b,Object(A.a)(this,this.d2l,"getMruFromServerRetryTask"),D);xa.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",b.data.Qe),t,!1,Object.assign(new Db.a,{extendedProperties:D}));this.Pgf(this.Gka);w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nQa&&Qg.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),k?this.jsd=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}a2l(b){this.dbi(b,!0)}xne(b,k=null,t=null,D=null,P=!1){if(3!==this.Gka.state||3===b)this.Gka.V6g=k,this.Gka.W6g=t,this.Gka.mak=D,this.Gka.state=b,this.Gka.lEe=P,this.Gka.Aih=this.KM.eq()}XVi(b,k){v.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.Gka.state});k&&3===this.Gka.state&&this.IUh(k,this.Gka);return this.Gka}XKh(b,k,t=!1){this.xne(1);let D;const P={};D=t?String.format(this.KM.lRa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",
this.xfk,"OfficeSuite",this.VJf,"ClassicMru"):String.format(this.KM.lRa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.F3h(),this.VJf);this.tfk.value||(D+="&entity=docs");w.AFrameworkApplication.sessionStartInfoSettings&&(P["X-Office-AudienceGroup"]=Object(Ka.a)(String,w.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");t&&(P["X-Office-Application"]="147");this.vlh?P["X-FileId"]=w.AFrameworkApplication.hm:D+=String.format("&{0}",w.AFrameworkApplication.hm);
this.KM.qZc.sj(D,1,null,P,!0,5,b,k,null)}get KM(){return this.UAa.value}get VJf(){return this.d$j.value}static get instance(){return Gk._instance||(Gk._instance=Gk.Jr())}static Jr(){return new Gk(new Rg.a(()=>Qj.instance),new Rg.a(()=>Xj.a.og(w.AFrameworkApplication.lcid).name),new Rg.a(()=>w.AFrameworkApplication.ta.Nb.nF),w.AFrameworkApplication.K.$("MruWriteFileIdInHeader"),()=>w.AFrameworkApplication.ta.Nb.sfa,()=>w.AFrameworkApplication.ps,new Rg.a(()=>w.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled")))}}
Gk._instance=null;Object(n.a)(Gk,"MruActor",Xf,[]);class dm{constructor(){this.pCc=this.Cbh=this.W=null;this.Kh=!1}get name(){return"Common.App.NewAndOpen.Core"}xc(b){this.W=b;b.register(320,"Common.INewAndOpenCommonHelpers").singleInstance().Rd(()=>Qj.instance);b.register(323,"Common.IEventEmitter<Common.IGetMoreInfoResult>").singleInstance().Rd(()=>Gh.instance);b.register(323,"Common.IEventEmitter<Common.IMruResult>").singleInstance().Rd(()=>Gk.instance)}init(){w.AFrameworkApplication.K.No(()=>
{this.f2a()})}f2a(){this.W.resolve("Common.INewAndOpenCommonHelpers");this.W.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.W.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;Qj.instance.ySn();w.AFrameworkApplication.eGa&&(b=!0);w.AFrameworkApplication.P2f&&(Gk.instance.S7m(),0<w.AFrameworkApplication.JOi&&this.Jnh(),this.Fno(),b=!0);w.AFrameworkApplication.a7a&&b&&Gh.instance.P7m();w.AFrameworkApplication.SUo&&(b=Gk.instance,b.jWn(),b.f8m(),wb.a.instance.Vb(this.TUo))}Fno(){zj.instance.Vmh(Object(A.a)(Gk.instance,
Gk.instance.R7m,"makeGetMruRequestActivityTrigger"));zj.instance.Vmh(Object(A.a)(this,this.Jnh,"addGetMruFromServerTask"));zj.instance.zsk(Object(A.a)(this,this.til,"deleteGetMruFromServerTask"))}til(){wb.a.instance.Ve(this.KOi)}Jnh(){wb.a.instance.Vb(this.KOi)}get KOi(){return this.Cbh||(this.Cbh=new Df.a(5,2,w.AFrameworkApplication.JOi,Object(A.a)(Gk.instance,Gk.instance.e2l,"getMruFromServerTask"),109))}get TUo(){return this.pCc||(this.pCc=new Df.a(2,2,6E4*w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",
1440),Object(A.a)(Gk.instance,Gk.instance.g8m,"makeUpdateMruTask"),197))}dispose(){this.Kh||(this.Kh=!0,this.pCc&&(wb.a.instance.Ve(this.pCc),this.pCc=null))}}Object(n.a)(dm,"CorePackageManager",null,[1,2,9]);var Pm=c(1534),qm=c(146);class eg{static Jsl(b){return eg.vyh("New",b)}static Ksl(b){return eg.vyh("Open",b)}static ayh(b,k){return eg.tZa("LoadingMenuSection",eg.XZm,b,eg.eFc("lblLoading",k))}static fFc(b,k,t=null,D=null){return eg.tZa("MessageMenuSection",eg.HOi,k,eg.eFc("lblMessage",b,t,D))}static MMk(b){return eg.ayh(b,
CommonUIStrings.l_VoicedLoadingText)}static NMk(b,k){return eg.fFc(CommonUIStrings.l_NewCreationLocationMessage,b.labelText,k.Aca,k.X6a)}static LMk(b,k){return eg.fFc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,k.X6a,"\n\n"),b.labelText)}static eyh(b){return eg.fFc(CommonUIStrings.l_NewGenericErrorMessage,b.labelText)}static JMk(b,k,t){return eg.tZa("menuNewBlank",eg.Vpm,t?b.labelText:null,eg.aFc(b.Gmi,b.Hmi,b.Imi,null,b.X1a,b.wRc,k,"blank"))}static INk(){return eg.eFc("lblTemplatesLoading",
CommonUIStrings.l_VoicedLoadingText)}static tyh(){return eg.eFc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static JNk(b,k){return eg.tZa("menuNewTemplates",b,null,k)}static HMk(b,k){return eg.tZa("menuNewMoreTemplates",eg.I0h,null,eg.aFc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,b,k))}static yLk(b,k,t){let D="";t&&k&&(D=eg.tZa("BrowseMoreMenuSection",eg.I0h,null,eg.aFc("btnBrowseMore",k,k,null,null,null,b||
"1959943459",t)));return D}static eFc(b,k,t=null,D=null){let P=D;k&&0<k.length&&(P=eg.BPi.Omb(k).trimEnd(),P=0<=P.indexOf("{0}")?String.format(P,D):String.format("{0} {1}",P,D));t=t&&D?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',F.a.Af(t),F.a.Af(D),F.a.Af(P)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',F.a.Af(b||""),eg.BPi.Omb(F.a.Af(k||"")),t)}static aFc(b,k,
t,D,P,ca,ta,Na){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',F.a.Af(b||""),F.a.Af(k||""),F.a.Af(t||""),D||"32by32",F.a.Af(P||""),F.a.Af(ca||""),ta,F.a.Af(Na||""))}static vyh(b,k){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',b,k)}static tZa(b,k,t,D){t=t?String.format('Title="{0}"',
F.a.Af(t)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',F.a.Af(b||""),F.a.Af(k||""),t,D)}}eg.HOi="MenuMru";eg.XZm="MenuLoading";eg.Vpm="MenuHeader";eg.I0h="MenuFooter";eg.BPi=qm.a.uC("\n","&#10;");Object(n.a)(eg,"NewAndOpenXmlUtilities",null,[]);class Hk{constructor(){this.folderName=this.folderUrl=
this.hostName=this.hostUrl=null}}Object(n.a)(Hk,"HostInformation",null,[]);var Qm=c(189);class Uf{constructor(b,k,t,D,P,ca){this.Yvd=this.Aw=this.Oed=null;this.Bud=this.YRe=!1;this.h6g=0;this.DRe=this.ZFe=!1;this.UAa=b;this.Lsc=k;this.aWa=new Rg.a(()=>new Pm.a(t.value,Object(A.a)(this,this.tEb,"getMoreInfoEventReceived")));this.kak=D;this.jbb=P;this.Gik=ca;this.MAc=this.Qhe;2===this.q0.gxa&&(this.DRe=!0);w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)&&this.nzl()}get g7(){switch(this.q0.gxa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}nzl(){wb.a.instance.Vb(new Df.a(5,1,0,()=>{this.getTemplateListJson()}))}Tb(){const b=this.q0.Pdc;b.qa($a.a.newDocument,Ud.a.frame,Object(A.a)(this,this.newDocument,"newDocument"));b.qa($a.a.s$d,Ud.a.frame,Object(A.a)(this,this.s$d,"populateNewMenu"))}newDocument(b,k,t,D,P){if(1===t)return 32;if(2===t&&P){if(w.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&
P.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),w.AFrameworkApplication.va.processAction($a.a.MDn,2);if(P.MenuItemId&&P.SourceControlId)return"NewDocumentHome"===P.SourceControlId&&bf.a("NewDocumentFromHomeTab"),this.cIc(P.MenuItemId,P.SourceControlId)}return 8}cIc(b,k){var t=this.c5d.BLh;if(null===t)return 8;var D=w.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(w.AFrameworkApplication.jkb&&D){v.ULS.sendTraceTag(51455198,
202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const P={};P[I.a.template]=b;P[I.a.g7]=this.g7;P[I.a.lcid]=w.AFrameworkApplication.lcid.toString();P[I.a.reason]=Dk.a.Haf;P[I.a.uiCulture]=w.AFrameworkApplication.uiCulture;P[I.a.dataCulture]=w.AFrameworkApplication.dataCulture;w.AFrameworkApplication.MO().execute(ca=>{ca.sendMessage(K.a.cIc,P)})}else D=(new Date).getTime(),k=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",
t,F.a.Nj(this.eGa),F.a.Nj(b),F.a.Nj(this.g7),F.a.Nj(w.AFrameworkApplication.lcid.toString()),F.a.Nj(D.toString()),F.a.Nj(k),F.a.Nj(w.AFrameworkApplication.canary),w.AFrameworkApplication.hm),(t=w.AFrameworkApplication.K.jb("ScenarioId"))&&""!==t&&(k+="&wdscenarioid="+F.a.Nj(t)),k+="&"+w.AFrameworkApplication.SRd(),w.AFrameworkApplication.a3a&&(k+="&"+w.AFrameworkApplication.sQd()),(t=this.Aw?this.Aw.Aca:null)?k+="&DestinationUrl="+F.a.Nj(t):v.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),
$d.a.nm(k,"_blank",void 0,"CreateNewDocument");2!==this.q0.gxa&&3!==this.q0.gxa||v.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:yj.a[this.q0.gxa],["Template"]:b});w.AFrameworkApplication.K&&w.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.q0.gxa&&("blank"===b?bf.b("ConsumerTemplateNewBlank"):(b=[Object.assign(new na.a,{name:"TemplateId",string:b})],bf.b("ConsumerTemplateNew",null,0,!0,0,b)));
return 32}B5m(b){let k=Number.MAX_VALUE,t=Number.MIN_VALUE;const D=window.performance;if(D&&"undefined"!==typeof D.getEntriesByName){for(let ca=0;ca<b.length;ca++){var P=D.getEntriesByName(b[ca]);P&&0<P.length&&(P=P[0],k=Math.min(parseInt(String(P.fetchStart)),k),t=Math.max(parseInt(String(P.responseEnd)),t))}t>k&&v.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:t-k,["MinFetchStart"]:k,["MaxResponseEnd"]:t})}}s$d(b,k,t,D,P){if(1===t)return this.DRe&&
(w.AFrameworkApplication.Roa("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.DRe=!1),32;2!==t||this.ZFe||(this.h6g=(new Date).getTime(),v.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Qhe,["CachedNewMenuXmlExists"]:!!this.Oed,["ShouldCallGetMoreInfo"]:this.q0.a7a}));w.AFrameworkApplication.ue("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");w.AFrameworkApplication.ue("WordConsumerTemplates-tf;WordConsumerTemplates-cf");
return this.uCn(P)}uCn(b){b&&(this.Oed?b.PopulationXML=this.Oed:(this.q0.a7a&&!this.Aw&&this.Gen.Yj("Opened New menu",!0),b.PopulationXML=this.VIl(this.getTemplateListJson())));return 32}Xzi(){return!this.q0.a7a||!!this.Aw&&3===this.Aw.state&&!!this.Aw.X6a&&!!this.Aw.Aca}SOm(){return w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nQa?!0:this.Xzi()}getTemplateListJson(){if(!this.Qhe||!this.SOm())return null;if(this.MAc&&!this.Bud){var b="9";w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)&&(b="21");const k=w.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in k&&(b=k.NumberOfTemplatesInBackstage);let t=this.g7;"TemplateCollectionId"in k&&(t=k.TemplateCollectionId);w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",!1)&&(t="WordConsumerWAC",b="23");b=String.format(this.q0.lRa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",F.a.Nj(w.AFrameworkApplication.lcid.toString()),F.a.Nj(t),b);Boolean.parse(k.AppendOriginQueryParam||
"false")&&(b+="&org=backstage");Boolean.parse(k.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in k&&(b+="&templateTier="+k.TemplateTier);b+="&"+w.AFrameworkApplication.SRd();w.AFrameworkApplication.a3a&&(b+="&"+w.AFrameworkApplication.sQd());this.q0.qZc.sj(b,1,null,null,!1,2,D=>{this.q0.OQa("CreateNewActor.GetTemplateListJson",D.data);this.XFo(D.data.xe)},D=>{this.q0.OQa("CreateNewActor.GetTemplateListJson",D.data);this.WFo()},null,void 0,void 0,void 0,void 0,"5");this.MAc=!1}return this.Yvd}XFo(b){w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)?this.Yvd=this.lAl(b):this.Yvd=b;this.MAc=!1;this.s3c();if(w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nQa&&Qg.c()){b=w.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const k=w.AFrameworkApplication.jkb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.Yvd,!0,b&&k))}}WFo(){this.Bud=this.MAc=!0;this.s3c();w.AFrameworkApplication.ta&&
w.AFrameworkApplication.ta.Nb.nQa&&Qg.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));xa.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}lAl(b){b=JSON.parse(b);const k=new Eb.a;k.add("TM00002102");k.add("TM00002101");k.add("TM16392939");const t=Qm.a.Pog(b,D=>k.contains(D.AssetId));b=b.slice(0,9);b.splice.apply(b,[2,0].concat(t));return JSON.stringify(b)}Luf(b){var k=0;for(var t=0;t<b.length;t++)if("ST"===
b[t].ImageType){k=t;break}const D=b.length?b[k]:null;b=D?D.Url||"":"";var P;let ca=t=k=!1;if(D&&(P=D.AspectRatio))P=parseFloat(P),1>P?k=!0:1.5<P?t=!0:1===P&&(ca=!0);else switch(v.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:b}),this.q0.gxa){case 3:k=!0;break;case 2:t=!0;break;case 5:ca=!0}return{returnValue:b,Ptm:k?"95by123":t?"123by69":ca?"100by100":"123by95"}}VIl(b){b=({yhe:k}=this.KMk(b,this.c5d,this.c5d.hFc||"1056925771")).returnValue;if(k){this.Oed=b;var k=(new Date).getTime()-
this.h6g;v.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:k})}return b}tEb(b,k){v.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Aw||3!==b.state?2===b.state&&(v.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.YRe=!0,this.s3c()):(this.Aw=b,k||this.s3c(),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nQa&&Qg.c()&&Qg.d("setFileMenuHostInformation")&&(b=Object.assign(new Hk,
{hostUrl:this.Aw.Aca,hostName:this.Aw.X6a,folderUrl:w.AFrameworkApplication.breadcrumbFolderUrl,folderName:w.AFrameworkApplication.breadcrumbFolderName}),v.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b))))}KMk(b,k,t){let D;D=!1;const P=this.Xzi();let ca="";this.q0.a7a&&(this.YRe?(ca=eg.eyh(k),this.YRe=!1,v.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):
this.Aw?P?ca=eg.NMk(k,this.Aw):this.Aw.CBm?(D=!0,this.MAc=!1,ca=eg.LMk(k,this.Aw),v.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(D=!0,ca=eg.eyh(k),v.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Aw.Aca,["StorageServiceDisplayNameIsSet"]:!!this.Aw.X6a})):(ca=eg.MMk(k.labelText),v.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));
P&&(ca+=eg.JMk(k,t,!ca)+({yhe:D}=this.HNk(b,t)).returnValue);return{returnValue:eg.Jsl(ca),yhe:D}}HNk(b,k){let t;t=!1;if(!this.Qhe)return t=!0,v.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",yhe:t};let D="",P="",ca="MenuTemplate";if(this.Bud)D=eg.tyh(),this.Bud=!1,v.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const ta=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);D=this.GNk(ta,
k);v.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");w.AFrameworkApplication.CPi&&"OneDrive"===this.eGa&&(P=eg.HMk(this.Hen,w.AFrameworkApplication.CPi))}catch(ta){v.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),D=eg.tyh()}t=!0}else ca="MenuLoading",D=eg.INk(),v.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:eg.JNk(ca,D)+P,yhe:t}}GNk(b,k){let t="";
const D=[];for(let ca=0;ca<b.length;ca++){var P=b[ca];let ta="";if(P){const Na=P.Title,qb=P.AssetId;P=P.Thumbnails;qb&&Na&&P&&({Ptm:P,returnValue:ta}=this.Luf(P),t+=eg.aFc("jbtnNewTemplate"+ca,Na,null,P,null,ta,k,qb))}D[ca]=ta}b=new Df.a(4,1,5E3,()=>{this.B5m(D)},106);this.q0.Y4d.Vb(b);return t}s3c(){this.ZFe=!0;this.q0.sPi.HIa(this.c5d.gMc);this.ZFe=!1}get q0(){return this.UAa.value}get c5d(){return this.Lsc.value}get Gen(){return this.aWa.value}get Hen(){return this.kak.value}get eGa(){return this.jbb.value}get Qhe(){return this.Gik.value}}
Object(n.a)(Uf,"CreateNewActor",null,[]);class Jd{constructor(){this._initialized=!1;this.iTe={}}QD(b){this.nWh();return this.get(b)}contains(b){this.nWh();return b.toString()in this.iTe}nWh(){this._initialized||(this.auk(),this._initialized=!0)}pdb(b,k){this.iTe[b.toString()]=k}get(b){return this.iTe[b.toString()]}}Object(n.a)(Jd,"AIntlHelper",null,[]);class kl extends Jd{constructor(){super()}auk(){this.pdb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.pdb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.pdb(2,CommonUIStrings.l_Open);this.pdb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.pdb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.pdb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return kl._instance||(kl._instance=new kl)}static Zun(b){return kl.instance.QD(b)}}kl._instance=null;Object(n.a)(kl,"MruActorIntlHelper",Jd,[]);var Ik;(function(b){b[b.success=0]="success";b[b.failure=1]="failure";b[b.spinner=2]="spinner";b[b.none=3]="none"})(Ik||(Ik={}));Object(n.b)("DisplayState",
Ik);class tf{constructor(b,k,t,D,P,ca,ta,Na){this.Zte=null;this.TWe=!0;this.Ned="";this.Flk=0;this.wWb=null;this.CHe=3;this.Ma=Na;this.UAa=b;this.$sa=k;this.N1j=t;this.YWj=D;this.XWj=P;this.aWa=new Rg.a(()=>new Pm.a(ca.value,null));this.B3j=new Rg.a(()=>new Pm.a(ta.value,Object(A.a)(this,this.xdn,"mruEventResultReceived")));this.Ma.$("WacInTabOpenMRUIsEnabledForUiHost");this.Ma.$("UiHostSupportsDocRebootFeatures")}xdn(b,k){this.wWb=b;k||this.B7i()}nVn(){this.KM.Pdc.fb($a.a.KZf,Ud.a.frame,Object(A.a)(this,
this.KZf,"populateMruMenu"),96)}KZf(b,k,t,D,P){return 1!==t&&P?this.sCn(P):32}sCn(b){this.stl();this.qtl();b.PopulationXML=eg.Ksl(this.Ned+this.Zte);return 32}stl(){var b=3;let k=!1;if(this.Ned&&this.Flk===this.wWb.LHo)v.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.CHe;else{v.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var t=this.KM.eq();this.wWb=
this.wdn.Yj("File Open opened",!0);this.Ned&&2!==this.CHe&&3!==this.wWb.state?k=!0:(b=this.Aam(this.wWb),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nQa&&Qg.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0)),this.Ned=({yen:b}=this.WIl(this.wWb)).returnValue);t=this.KM.eq()-t;v.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:t})}2!==b&&(t={["DisplayState"]:Ik[b]},1!==b&&(t.IsStale=k),
v.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",t));this.CHe=b}Aam(b){let k;try{k=G.c(b.UNf)}catch(t){k=null,v.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",t)}return k}qtl(){this.TWe?(v.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.Zte=({N0o:this.TWe}=this.M7m()).returnValue):v.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");v.ULS.sendTraceTag(5849633,
202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.TWe,["NotDisplayingLink"]:!this.Zte})}WIl(b){let k;1===b.state||0===b.state?(v.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),b=2,k=eg.ayh(this.w1a(2),this.w1a(5))):3===b.state&&b.UNf?(k=this.IMk(b.UNf),b=0):(v.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),k=eg.fFc(this.w1a(1),this.w1a(2)),b=1);return{returnValue:k,yen:b}}IMk(b){let k;const t=this.JYc.hFc||
"2155708348";if(b.length){k=eg.eFc("lblRecentDocuments",this.w1a(3));let D=0;for(let P=0;P<b.length;P++){const ca=b[P];"FileName"in ca&&"DocumentUrl"in ca&&"Path"in ca&&(k+=eg.aFc("MruButton"+P,ca.FileName.toString(),ca.Path.toString(),null,this.JYc.X1a,this.JYc.wRc,t,ca.DocumentUrl.toString()),ca.IsPinned&&D++)}k=eg.tZa("RecentDocumentsMenuSection",eg.HOi,this.w1a(2),k);v.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:D})}else k=
eg.fFc(this.w1a(0),this.w1a(2)),v.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return k}M7m(){let b;b=!0;let k=this.RKk;var t=this.QKk;if(k&&t||!this.KM.a7a)b=!1;else{const D=this.yQd.Yj("File Open",!1);3===D.state&&(k=D.Aca,t=D.X6a,b=!1)}t=t?String.format(this.w1a(4),t):null;return{returnValue:eg.yLk(this.JYc.hFc,t,k),N0o:b}}B7i(){this.KM.sPi.HIa(this.JYc.gMc)}get KM(){return this.UAa.value}get w1a(){return this.$sa.value}get JYc(){return this.N1j.value}get RKk(){return this.YWj.value}get QKk(){return this.XWj.value}get yQd(){return this.aWa.value}get wdn(){return this.B3j.value}}
Object(n.a)(tf,"MruRenderer",null,[]);var hd=c(1539);class lg{constructor(b,k,t,D,P,ca,ta){this.Aw=null;this.$dh=!1;this.Ura=this.L1=0;this.Aak=b;this.XWb=k;this.apd=t;this.Lsc=D;this.jbb=P;this.UAa=ca;this.aWa=new Rg.a(()=>new Pm.a(ta.value,Object(A.a)(this,this.tEb,"getMoreInfoEventReceived")))}cIc(){!this.Aw&&this.tQf.a7a?this.yQd.Yj("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}tEb(b){if(!this.Aw&&3===b.state)this.Aw=b;else if(2===b.state){this.$dh?v.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.yQd.Yj("NewDocumentFromStream",!0),this.$dh=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.L1=(new Date).getTime();var b=this.Bzl.BLh;if(null===b)this.XWb(null);else{var k=this.apd.menuItemId,t=this.apd.MHa,D=this.apd.FBo,P=this.apd.Jzl;this.Ura="streamBase64"===D?P.length/1024:0;v.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.g7,this.Ura);var ca=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
b,F.a.Nj(this.eGa),F.a.Nj(k),F.a.Nj(this.g7),F.a.Nj(w.AFrameworkApplication.lcid.toString()),F.a.Nj(ca.toString()),F.a.Nj(t),F.a.Nj(w.AFrameworkApplication.canary),w.AFrameworkApplication.hm,F.a.Nj(D));b+="&"+w.AFrameworkApplication.SRd();w.AFrameworkApplication.a3a&&(b+="&"+w.AFrameworkApplication.sQd());(k=this.Aw?this.Aw.Aca:null)&&(b+="&DestinationUrl="+F.a.Nj(k));this.tQf.qZc.sj(b,2,P,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(A.a)(this,this.Ben,"newDocumentFromStreamSuccessHandler"),
Object(A.a)(this,this.Aen,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}Ben(b){if(b&&b.data&&b.data.xe)if(({Wu:k}=G.d(b.data.xe)).returnValue)if(b=k,b.StatusCode!==ha.a.Hy&&b.StatusCode!==ha.a.pIc)v.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.g7,this.Ura,b.StatusCode),this.XWb(null);else if(b.NewDocumentUrl&&""!==b.NewDocumentUrl){var k=(new Date).getTime()-this.L1;v.ULS.sendTraceTag(35156359,
202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.g7,this.Ura,k);this.Aak(b.NewDocumentUrl)}else v.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.g7,this.Ura),this.XWb(null);else v.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.g7,this.Ura,{["ResponseData"]:hd.a.T$c(b.data.xe)}),this.XWb(null);else v.ULS.sendTraceTag(24904473,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.g7,this.Ura),this.XWb(null)}Aen(b){b&&b.data&&v.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.g7,this.Ura,b.data.status);this.XWb(null)}get g7(){switch(this.tQf.gxa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get Bzl(){return this.Lsc.value}get eGa(){return this.jbb.value}get tQf(){return this.UAa.value}get yQd(){return this.aWa.value}}
Object(n.a)(lg,"NewDocumentFromStreamOperation",null,[]);class Bn{constructor(b,k,t,D){this.Lsc=b;this.jbb=k;this.UAa=t;this.A3j=D}create(b,k,t){return new lg(b,k,t,this.Lsc,this.jbb,this.UAa,this.A3j)}}Object(n.a)(Bn,"NewDocumentFromStreamOperationFactory",null,[724]);var Rj=c(128);class ge{get name(){return"Common.App.NewAndOpen.UX"}xc(b){b.register(Bn,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").singleInstance().Rd(()=>
new Bn(new Rg.a(()=>w.AFrameworkApplication.ta.Nb.Jpf()),new Rg.a(()=>w.AFrameworkApplication.eGa),new Rg.a(()=>b.Na("Common.INewAndOpenCommonHelpers")),new Rg.a(()=>b.Na("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){w.AFrameworkApplication.K.No(()=>{this.f2a()})}f2a(){const b=Tb.a.Ap(Fa.a.instance.Sa("Common.INewAndOpenCommonHelpers")),k=Tb.a.Ap(Fa.a.instance.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));w.AFrameworkApplication.eGa&&Rj.Task.WAA.call(null,b,k).continueWith(()=>
{const t=new Uf(new Rg.a(()=>b.result),new Rg.a(()=>w.AFrameworkApplication.ta.Nb.Jpf()),new Rg.a(()=>k.result),new Rg.a(()=>w.AFrameworkApplication.ta.Nb.Kpf().hFc||"1959943459"),new Rg.a(()=>w.AFrameworkApplication.eGa),new Rg.a(()=>w.AFrameworkApplication.xMm));t.Tb();t.s3c()});if(w.AFrameworkApplication.P2f){const t=Tb.a.Ap(Fa.a.instance.Sa("Common.IEventEmitter<Common.IMruResult>"));Rj.Task.WAA.call(null,b,k,t).continueWith(()=>{const D=new tf(new Rg.a(()=>b.result),new Rg.a(()=>kl.Zun),new Rg.a(()=>
w.AFrameworkApplication.ta.Nb.Kpf()),new Rg.a(()=>w.AFrameworkApplication.Yun),new Rg.a(()=>w.AFrameworkApplication.Xun),new Rg.a(()=>k.result),new Rg.a(()=>t.result),w.AFrameworkApplication.K);D.nVn();D.B7i()})}}dispose(){}}Object(n.a)(ge,"UXPackageManager",null,[1,2,9]);var Uc=c(175);class ql extends Uc.StandardDialog{constructor(){super();this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose)}oO(b){this.ix(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}dff(b){this.ix(b,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(n.a)(ql,"ErrorDialog",Uc.StandardDialog,[695]);var Cg=c(457);class yg{A3h(){v.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new Cg.a;b.Ag("api.onedrive.com");return b.task}}Object(n.a)(yg,"OneDriveConsumerEndpointHelper",null,[666]);var Bh=c(50);class ug{constructor(b,k,t,D){this.Hvb=this.mGa=null;this.pRe=this.rRe=!1;this.hXb=null;this.Ma=b;this.hSb=k;this.Qub=t;this.dH=D}get Urh(){return this.hSb}get K(){return this.Ma}Q7b(){this.hXb||
(this.hXb=this.Xec?Sa.a.create(this.Xec,null,null,null,!1):null);return this.hXb}setup(b){this.Hvb=b;this.rRe||this.pRe?this.rRe&&this.Hvb&&this.Hvb(!0):(b=this.Q7b())?(this.pRe=!0,b.J3a.continueWith(k=>{this.cpn(k)}),Gb.a.lX(b)):(v.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.Hvb(!1))}sUf(b){v.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.")}cpn(b){this.pRe=
!1;if(b.Ci)this.sUf(b),this.Hvb(!1);else try{this.rRe=!0,v.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Bzf(),v.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.Hvb(!0)}catch(k){v.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",k.toString()),this.Hvb(!1)}}Z8c(b){this.mGa=b;this.Qub?v.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(v.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(A.a)(this,this.tSf,"onApiReady")))}tSf(b){b?this.w0d():this.yp()}yp(){this.dH().oO(Bh.a.fun)}onSuccess(b){v.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.mGa&&this.mGa(!0,b)}dispose(){this.hXb&&this.hXb.dispose()}}Object(n.a)(ug,"AOneDriveFilePickerApiManager",null,[725,9]);class Ee extends ug{constructor(b,k,t,D,P,ca){super(k,t,D,ca);this.Tm=null;this.Wsa=b;this.Oik=P}get Xec(){return this.K.jb("OneDriveApiUrl")}start(b,k){this.Tm=
b;this.Z8c(k)}Bzf(){WL.init(1===this.Urh||2===this.Urh?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}Z8c(b){this.mGa=b;!this.Qub&&this.Wsa.eTc?(v.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(A.a)(this,this.tSf,"onApiReady"))):(v.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Oik())}w0d(){try{v.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.Tm).then(Object(A.a)(this,this.onSuccess,"onSuccess"),Object(A.a)(this,this.onFailure,"onFailure"))}catch(b){v.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.yp()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){v.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}v.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",b.error.code,
b.error.message)}else v.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.mGa&&this.mGa(!1,b);this.yp()}}Object(n.a)(Ee,"OneDriveFilePickerApiManagerV5",ug,[]);class pf extends ug{constructor(b,k,t,D,P){super(b,k,t,D);this.gkd=this.r9g=null;this.$0j=P;this.options={};this.options.clientId=this.K.jb("OneDriveApiV7ClientId");this.options.cancel=Object(A.a)(this,this.Dle,"toggleHostDivVisibility")}get Xec(){return this.K.jb("OneDriveApiV72Url")}start(b,k){this.gkd=k;const t=
this.$0j.A3h();t.continueWith(()=>{v.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.r9g=t.result;this.Z8c((D,P)=>{this.Dle();b(D,P)})},3);t.continueWith(()=>{v.ULS.sendTraceTag(24134242,352,15,t.exception.message);this.Dle()},5)}Bzf(){this.options.success=b=>{const k={};k.data=b;this.onSuccess(k)};this.options.error=b=>{const k={};k.error=b;this.onFailure(k)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.r9g;this.options.advanced.iframeParentDiv=this.gkd}w0d(){try{v.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.Dle(),OneDrive.open(this.options)}catch(b){v.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.yp()}}onFailure(b){this.mGa&&this.mGa(!1,b);this.yp()}Dle(){this.gkd.style.visibility="hidden"===this.gkd.style.visibility?"":"hidden"}}Object(n.a)(pf,"OneDriveFilePickerApiManagerV7",ug,[]);class sj extends ug{constructor(b,
k,t,D){super(b,k,t,D);this.lVj=b;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.jb("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get Xec(){return this.K.jb("OneDriveApiV72Url")}start(b,k,t,D){this.options.advanced.iframeParentDiv=t;this.options.advanced.endpointHint=D;this.options.cancel=k;this.lVj.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.Z8c(b)}Z8c(b){this.mGa=b;this.Qub?v.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(v.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(A.a)(this,this.tSf,"onApiReady")))}Bzf(){this.options.success=b=>{const k={};k.data=b;this.onSuccess(k)};this.options.error=b=>{const k={};k.error=b;this.onFailure(k)}}w0d(){try{v.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){v.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.yp()}}sUf(b){v.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.");Gb.a.ZYn(this.Xec);this.hXb=null}yp(){this.dH().dff(Bh.a.H8n)}onFailure(b){this.mGa&&this.mGa(!1,b)}}Object(n.a)(sj,"OneDriveFilePickerApiManagerV72",
ug,[]);class Nn{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(n.a)(Nn,"IExtraData",null,[]);class Sg extends sj{constructor(b,k,t,D){super(b,k,t,D);this.options.advanced.filter=b.jb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=w.AFrameworkApplication.gsh;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.jb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new Nn(w.AFrameworkApplication.userSessionId))}get Xec(){return this.K.jb("OneDriveApiV72Url")}w0d(){try{v.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",w.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){v.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.yp()}}}Object(n.a)(Sg,"OneDriveFilePickerApiOpenManagerV72",sj,[]);class Rf{constructor(b){this.Xp=null;this.Wf=b;this.HPe=3}A3h(){this.Xp=new Cg.a;v.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.Z9f();return this.Xp.task}Z9f(b=null){const k=String.format("GetMoreInfoHandler.ashx?{0}",w.AFrameworkApplication.rBb);this.Wf.Tyb(k,1,null,b,["PersonalFileStorageUrl",
"X-NewKey"],2,Object(A.a)(this,this.X1l,"getMoreInfoSucceeded"),Object(A.a)(this,this.V1l,"getMoreInfoFailed"),void 0,void 0,void 0,void 0,"21")}V1l(b){if(b.data.Qe===ha.a.nia&&"X-NewKey"in b.data.vj){v.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const k={};k["X-Key"]=b.data.vj["X-NewKey"];this.Z9f(k)}else 0<this.HPe?(v.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.HPe),this.HPe--,this.Z9f()):(v.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Xp.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}X1l(b){"PersonalFileStorageUrl"in b.data.vj&&""!==b.data.vj.PersonalFileStorageUrl?(v.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Xp.Ag(b.data.vj.PersonalFileStorageUrl)):(v.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.Xp.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(n.a)(Rf,"OneDriveForBusinessEndpointHelper",null,[666]);var $k=c(744);class gi{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}xc(b){this.W=b;this.W.register(Ee,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").singleInstance().Rd(()=>new Ee($k.a.instance,w.AFrameworkApplication.K,
w.AFrameworkApplication.R7,w.AFrameworkApplication.Noa,w.AFrameworkApplication.yeg,()=>new ql));w.AFrameworkApplication.IHb?this.W.register(666,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Rd(()=>new yg):this.W.register(666,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Rd(()=>new Rf(w.AFrameworkApplication.Ne));this.W.register(pf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").singleInstance().Rd(()=>new pf(w.AFrameworkApplication.K,
w.AFrameworkApplication.R7,w.AFrameworkApplication.Noa,()=>new ql,this.W.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.W.register(sj,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").singleInstance().Rd(()=>new sj(w.AFrameworkApplication.K,w.AFrameworkApplication.R7,w.AFrameworkApplication.Noa,()=>new ql));this.W.register(Sg,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").singleInstance().Rd(()=>new Sg(w.AFrameworkApplication.K,
w.AFrameworkApplication.R7,w.AFrameworkApplication.Noa,()=>new ql))}static main(){N.a.instance.Fc(new gi)}}Object(n.a)(gi,"PackageManager",null,[1,2]);class ym{constructor(b,k,t,D,P,ca){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=k;this.PolicyCookie=t;this.PolicyCookieTTL=D;this.WasServiceDown=P;this.AffinitizedUrl=ca}}Object(n.a)(ym,"SafeLinksData",null,
[]);class jn{constructor(b,k){this.Nke=b;this.NA=k}}Object(n.a)(jn,"SafeLinksGetUrlReputationRequestData",null,[]);class ii{constructor(b,k,t,D){this.Ma=b;this.Wf=k;this.U3j=t;ii.he=D}Ulc(b,k,t){try{var D=null;ii.he&&(D=ii.he.Zf("WebServiceCall","SafeLinksGetUrlReputation"));const P=new jn(k,D);D={};D.AffinitizedUrl=b;D.TargetUrl=k;D.PolicyCookie=t;const ca=G.c(D);this.Wf.sj(this.U3j,2,ca,null,!1,2,Object(A.a)(this,this.Lmn,"onGetUrlReputationSuccessCallback"),Object(A.a)(this,this.Kmn,"onGetUrlReputationFailureCallback"),
P,void 0,void 0,3E3,3E3,"36");return!0}catch(P){v.ULS.sendTraceTag(588788033,378,10,P.message)}return!1}Lmn(b){let k="OnGetUrlReputationSuccessCallback: ",t=10;const D=b.data.state;try{const P=G.b(b.data.xe).reputationResults[0],ca=P.navigateUrl.length,ta=D.Nke.length,Na=P.navigateUrl===D.Nke;P.navigateUrl&&0<P.navigateUrl.length&&(D.Nke=P.navigateUrl);k+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",b.data.Qe,P.verdict,
ta.toString(),ca.toString(),Na.toString());t=50}catch(P){k+=String.format("Exception {0}",P.message)}this.Mki(D,k,t)}Kmn(b){let k="OnGetUrlReputationFailureCallback: ";const t=b.data.state;try{k+=String.format("HttpStatus {0}",b.data.Qe)}catch(D){k+=String.format("Exception {0}",D.message)}this.Mki(t,k,10)}Mki(b,k,t){b.NA&&(b.NA.stop(),b.NA=null);v.ULS.sendTraceTag(588788034,378,t,k);$d.a.nm(b.Nke,void 0,"noopener,noreferrer","SafeLinksNav")}}ii.he=null;Object(n.a)(ii,"SafeLinksNavigationHelper",
null,[]);var Hh;(function(b){b[b.enabledByPolicy=0]="enabledByPolicy";b[b.disabledByPolicy=1]="disabledByPolicy";b[b.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";b[b.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(Hh||(Hh={}));Object(n.b)("SafeLinksNavigationState",Hh);class qk{constructor(b,k,t,D=!1,P=null,ca=null){this.xtb=this.wtb=0;this.ZTc=this.Ajd=!1;this.Dbb=null;this.eWb=!0;this.Xtd=null;v.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");
this.Ma=b;this.Wf=k;this.Dza=t;qk.he=ca;this.Hnk=D?this.Ma.jb("SafeLinksHandlerWebServiceBase"):this.Ma.jb("WebServiceBase");this.Zmk=this.Ma.jb("SafeLinksHashedUserId");this.T4o=this.Ma.jb("SafeLinksWorkloadIdHeaderValue");this.nod=this.Ma.mc("SafeLinksMaxGetPolicyBootRetries",2);this.ood=this.Ma.mc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.Rld=this.IPm();this.Qld=this.HPm();v.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.Rld,this.Qld);
if(this.Rld&&this.Qld){k=(b=this.dhb())?b.IsSafeLinksEnabled.toLowerCase():"";t=this.bFf();v.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",k,t);var ta=!b||"unknown"===k||b.WasServiceDown||t,Na=db.a.fG();Na&&(Na.set("shouldGetSafeLinksDataFromServer",ta.toString()),Na.set("isSafeLinksEnabledCacheValue",k.toString()));P?(this.eWb=!1,P.execute(qb=>{qb.isFeatureEnabled("MsoUrlreputation",!0).then(Jb=>{this.eWb=Jb;Na.set("isUserLicensedForSafeLinks",
this.eWb.toString());xa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Na);this.eWb&&ta&&this.LRd(!0);return null})})):(xa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Na),ta&&this.LRd(!0))}}get appName(){return this.Dza}get Ioe(){return this.Hnk}get userId(){return this.Zmk}get T6l(){const b=this.Ioe?this.Ioe+"/":"",k=new eb.QueryStringBuilder("SafeLinksHandler.ashx");k.Ce("app",this.appName);this.Ma.$("SafeLinksUseDebugHeader")&&k.Ce("action","debug");
this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&k.Ce("s2satpop","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&k.Ce("s2se03","1");return String.format("{0}{1}&{2}",b,k.toString(),w.AFrameworkApplication.hm)}get fgm(){const b=this.Ioe?this.Ioe+"/":"",k=new eb.QueryStringBuilder("SafeLinksHandler.ashx");k.Ce("app",this.appName);this.Ma.$("SafeLinksUseDebugHeader")&&k.Ce("action","debug");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",
!1)&&k.Ce("s2satpop","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&k.Ce("s2saat","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&k.Ce("s2se03","1");k.Ce("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",b,k.toString(),w.AFrameworkApplication.hm)}get cen(){qk.sQe||(qk.sQe=new ii(this.Ma,this.Wf,this.fgm,qk.he));return qk.sQe}Ulc(b){if(!b)return v.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),
!1;var k=this.cKm(b);v.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",k,this.Rld,this.Qld,this.eWb);if(!(k&&this.Rld&&this.Qld&&this.eWb))return!1;k=0;const t=({state:k}=this.mso()).returnValue;v.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",Hh[k]);const D=db.a.fG();D&&D.set("SafeLinksNavigationState",Hh[k]);xa.Health.instance.recordKpiUsage("SafeLinksNavigations",
0,"jpittsdirects",D);if(!t)return 2!==k&&3!==k||xa.Health.instance.recordKpiFailure("SafeLinksNavigations",Hh[k],!1,!0,null),!1;v.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");if(this.Kso())return this.bFf()?!1:this.cen.Ulc(this.YJl(),b,this.udi());if(!this.bFf())return this.IBj(b),!0;this.Dbb=b;v.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.ZTc=!1;this.LRd();return!0}cKm(b){b=b.toLowerCase();const k=this.Ma.GC("SafeLinksUnsupportedProtocols");
if(k)for(let t=0;t<k.length;t++)if(b.startsWith(k[t]))return!1;return!0}LRd(b=!1){var k=db.a.fG();k&&k.set("isOnBootRequest",b.toString());xa.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",k);xa.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",k);k=this.B$e("SafeLinksGetPolicy");this.Wf.sj(this.T6l,1,null,null,!0,2,Object(A.a)(this,this.q$l,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(A.a)(this,this.p$l,"getSafeLinksDataFromServer_OnFailureCallback"),
k,void 0,void 0,void 0,void 0,"23");this.ZTc=b;this.Ajd=!0;b?this.wtb++:this.xtb++}q$l(b){let k=ha.a.Ofn,t="";try{this.Ajd=this.ZTc=!1;var D=b.data.state;const yc=({NA:D}=this.Fje(D)).returnValue,Kc=Object.assign(new Db.a,{durationMs:yc});xa.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",Kc);v.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",b.data.Qe,b.data.xe.length,yc);if(b.data.Qe!==ha.a.Hy)t=
"Unexpected httpStatus: "+b.data.Qe.toString();else{D=null;try{D=G.b(b.data.xe)}catch(ed){t="Exception:"+ed.toString()+" deserializing response";return}if(D){var P=D.IsSafeLinksEnabled;if(void 0===P||null===P||0>=P.length)t="Invalid isSafeLinksEnabledString";else{v.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",P);var ca=qk.lYf(P);if(void 0===D.WebAffinitizedUrl||null===D.WebAffinitizedUrl||0>=D.WebAffinitizedUrl.length)t="Invalid WebAffinitizedUrl";else if(void 0===D.PolicyCookie||
null===D.PolicyCookie||0>=D.PolicyCookie.length)t="Invalid PolicyCookie";else if(void 0===D.PolicyCookieTTL||null===D.PolicyCookieTTL)t="Invalid PolicyCookieTTL";else{var ta=D.WebAffinitizedUrl,Na=D.PolicyCookie,qb=D.AffinitizedUrl,Jb=new Date;Jb.setMinutes(Jb.getMinutes()+(5<D.PolicyCookieTTL?D.PolicyCookieTTL-5:0));var Vb=Jb.getTime(),ac=new ym(P,ta,Na,Vb,!1,qb);this.cjj(ac);k=b.data.Qe;this.Dbb&&(ca?(this.IBj(this.Dbb),this.xtb=this.wtb=0):(v.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),
xa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),$d.a.dDb(this.Dbb)),this.Dbb=null)}}}else t="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(yc){t="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+yc.toString()}finally{k!==ha.a.Hy&&this.Lki(k,t)}}p$l(b){this.Ajd=!1;let k=500,t="";try{let D=b.data.state;const P=({NA:D}=this.Fje(D)).returnValue,ca=Object.assign(new Db.a,{durationMs:P});k=b.data.Qe;xa.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest",
"HttpStatusCode_"+k.toString(),!1,!0,ca);t="Request Failed, Status="+sg.a[b.data.status]+" Duration: "+P}catch(D){t="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+D.toString()}finally{this.Lki(k,t)}}Lki(b,k=""){try{if(v.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,k),this.wtb<this.nod&&this.xtb<this.ood)this.LRd(this.ZTc);else{this.ZTc=!1;v.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.wtb,this.xtb,b,k);k=null;const t=db.a.fG();t&&(t.set("HttpStatus",b.toString()),k=Object.assign(new Db.a,{extendedProperties:t}));xa.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,k);const D=new ym("false","","",0,!0,"");this.cjj(D);this.Dbb&&(v.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),xa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),$d.a.dDb(this.Dbb),this.Dbb=null)}}catch(t){v.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",t.toString())}}IBj(b){const k=this.udi(),t=this.qhm(),D={};D.Url=b;D.SafeLinksCookie=k;D.CorrelationId=lb.a.create().toString();D.WorkloadId=this.T4o;D.UserAgentInfo=aa.a.bG+"|"+this.appName;v.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",D.CorrelationId);$d.a.VZf($d.a.Zqa(4),t,D)}IPm(){const b=this.Ma.jb("IsSafeLinksEnabledForUser");
return b?qk.lYf(b):!1}HPm(){const b=this.Ma.GC("SafeLinksDisabledBrowsers");if(aa.a.a4){if(this.Ma.Nw("SafeLinksForTeamsIsEnabled")&&this.Ma.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,aa.a.bG))return!1;return"officecomhwa"===(this.Ma.jb(w.AFrameworkApplication.qja)||"").toLowerCase()?!1:!0}Kso(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",
!1)&&aa.a.DUc?!0:aa.a.a4}mso(){let b;b=0;const k=this.dhb(),t=k?k.IsSafeLinksEnabled:"";if(""!==t)return k.WasServiceDown?(v.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===t.toLowerCase()?(v.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:qk.lYf(t),state:b};if(this.Ajd)return b=3,v.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.wtb>=
this.nod||this.xtb>=this.ood)return b=2,v.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.wtb,this.nod,this.xtb,this.ood),{returnValue:!1,state:b};v.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.nod+this.ood-(this.wtb+this.xtb));return{returnValue:!0,state:b}}udi(){const b=
this.dhb();return b?b.PolicyCookie:""}qhm(){const b=this.dhb();return b?b.WebAffinitizedUrl:""}YJl(){const b=this.dhb();return b?b.AffinitizedUrl:""}mUl(){const b=new Date;try{const k=this.dhb();b.setTime(k?k.PolicyCookieTTL:0)}catch(k){v.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",k)}return b}bFf(){const b=this.mUl();return!!b&&b.getTime()<Date.now()}dhb(){if(!this.Xtd){const b=bb.a.instance.getItem(this.userId);if(!b||""===b)return null;this.Xtd=
JSON.parse(b)}return this.Xtd}cjj(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.Xtd=b;b.WasServiceDown||this.g5o(b)}g5o(b){b=JSON.stringify(b);bb.a.instance.setItem(this.userId,b)}B$e(b){return void 0!==qk.he&&null!==qk.he?qk.he.Zf("WebServiceCall",b):null}Fje(b){if(void 0!==b&&null!==b){const k=b.si;b.stop();return{returnValue:k,
NA:null}}return{returnValue:null,NA:b}}static lYf(b){return"false"!==b.toLowerCase()?!0:!1}}qk.he=null;qk.sQe=null;Object(n.a)(qk,"SafeLinksManager",null,[767]);const Vf=b=>{switch(b){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},Sj=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};class fe{constructor(){this.W=null}get name(){return"Common.App.SafeLinks"}xc(b){this.W=
b}init(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.No(Object(A.a)(this,this.Lx,"onFullAppSettingsReady"))}dispose(){}Lx(){w.AFrameworkApplication.K.$("WACSafeLinksIsEnabled")&&(this.W.register(qk,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").singleInstance().Rd(()=>new qk(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne,String.format("{0}-{1}",Vf(w.AFrameworkApplication.ta.Nb.Sl),Sj(w.AFrameworkApplication.ta.Nb.Nha)),!1,this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
w.AFrameworkApplication.ta.Fq)),this.W.Na("Common.App.SafeLinks.ISafeLinksManager"))}static main(){N.a.instance.Fc(new fe)}}Object(n.a)(fe,"SafeLinksPackage",null,[1,2]);var cj=c(229);class im{constructor(b){this.ra=new Ue.a;this.Jh=b}sdb(b){this.ra.addHandler(im.xya,b)}h4c(b){this.ra.removeHandler(im.xya,b)}VYa(b){this.ra.addHandler(im.STa,b)}KMb(b){this.ra.removeHandler(im.STa,b)}l_e(b){this.ra.addHandler(im.tlc,b)}Tdg(){this.ra.raiseEvent(im.xya)}jxf(){return cj.a.instance.qQa(w.AFrameworkApplication.Wy)}}
im.xya="SE";im.r6c="SEP";im.STa="SER";im.tlc="TRP";Object(n.a)(im,"NullSessionExpirationManager",null,[663,664]);class vg{constructor(){this.FAc=this.pcb=!1;const b=w.AFrameworkApplication.Wy;0>=b||(this.Wy=b,v.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Wy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:w.AFrameworkApplication.QW}),cj.a.instance.vqh(Object(A.a)(this,this.Nec,"onSessionExpiredDetected")),cj.a.instance.uqh(Object(A.a)(this,
this.O_c,"onSessionExpiringDetected")))}Nec(){cj.a.instance.vaj(Object(A.a)(this,this.Nec,"onSessionExpiredDetected"));v.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.Cwf()}O_c(){cj.a.instance.K_n(Object(A.a)(this,this.O_c,"onSessionExpiringDetected"));this.FAc||this.pcb||(v.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.FAc=!0,this.Aeg())}Cwf(){this.pcb||(w.AFrameworkApplication.UM(Bh.a.q6c),this.pcb=!0,this.Aie())}}Object(n.a)(vg,"ASessionExpirationManager",
null,[]);var Wf=c(174),$g=c(275);class Ti{constructor(b,k,t,D){this.Qig="";this.sdd=b;this.Oeh=t;this.Keh=D;this.e0g=k;b=(new Date(this.sdd)).format(w.AFrameworkApplication.voj);this.Qig=this.e0g?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}sic(b){1===b?this.Oeh&&this.Oeh(this.e0g):0===b&&w.AFrameworkApplication.va.Qb($a.a.close,2,$g.g)}dispose(){this.Keh&&this.Keh()}}Ti.id="SessionExpirationDialog";Object(n.a)(Ti,"SessionExpirationDialogSharedProperties",
null,[]);class Rm{}Rm.Xg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(n.a)(Rm,"SessionExpirationDialogHtml",null,[]);class Rd extends Wf.a{constructor(b,k,t,D){super(k);const P={};this.ZXa=new Ti(b,k,t,D);this.vg=Ti.id;w.AFrameworkApplication.sAh?(this.Ad=1,this.Ee(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.rt=!1);k||1===w.AFrameworkApplication.ta.mode?this.Ee(1,CommonUIStrings.l_SessionExpirationRefreshButton):
this.Ee(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Xg=Rm.Xg;P.WACSessionExpirationText=this.ZXa.Qig;this.Wh(CommonUIStrings.l_DefaultDialogTitle,Object(A.a)(this,this.sic,"sessionExpirationDialogHandler"),P);this.Z4(this.kj("WACSessionExpirationText"))}sic(b){this.ZXa.sic(b)}Dxf(){this.hide()}dispose(){super.dispose();this.ZXa&&this.ZXa.dispose()}}Object(n.a)(Rd,"LegacySessionExpirationDialog",Wf.a,[829]);class Mo extends Uc.StandardDialog{constructor(b,k,t,D){super(k);this.ZXa=
new Ti(b,k,t,D);this.vg=Ti.id;w.AFrameworkApplication.sAh?(this.Ad=1,this.Ee(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.rt=!1);k||1===w.AFrameworkApplication.ta.mode?this.Ee(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Ee(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Gu(CommonUIStrings.l_DefaultDialogTitle,this.ZXa.Qig,0,Object(A.a)(this,this.sic,"sessionExpirationDialogHandler"))}sic(b){this.ZXa.sic(b)}Dxf(){this.hide()}dispose(){super.dispose();this.ZXa&&this.ZXa.dispose()}}
Object(n.a)(Mo,"SessionExpirationDialog",Uc.StandardDialog,[829]);const Bd=(b,k,t,D)=>w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nF&&w.AFrameworkApplication.K.$("ReactStandardSessionExpirationDialogIsEnabled")?new Mo(b,k,t,D):new Rd(b,k,t,D);var ll=c(199);class $f extends vg{constructor(b){super();this.zud=this.bZb=!0;this.IZ=null;this.ra=new Ue.a;this.Jh=b}sdb(b){this.ra.addHandler($f.xya,b)}h4c(b){this.ra.removeHandler($f.xya,b)}VYa(b){this.ra.addHandler($f.STa,b)}KMb(b){this.ra.removeHandler($f.STa,
b)}l_e(b){this.ra.addHandler($f.tlc,b)}jxf(){return cj.a.instance.qQa(w.AFrameworkApplication.Wy)}Tdg(b){this.bZb=b}Aeg(){if(!this.IZ&&!ll.a.jM){if(this.zud){const b=Object(A.a)(this,this.H4b,"disposeCallback");this.IZ=Bd(this.Wy,!1,Object(A.a)(this,this.tic,"sessionExpirationHandler"),b)}this.ra.raiseEvent($f.r6c)}}Aie(){this.IZ&&(this.IZ.oha&&this.IZ.Dxf(),this.IZ=null);if(this.bZb){const b=Object(A.a)(this,this.H4b,"disposeCallback");this.IZ=Bd(this.Wy,!0,Object(A.a)(this,this.tic,"sessionExpirationHandler"),
b)}this.ra.raiseEvent($f.xya)}H4b(){this.IZ=null}tic(b){(b||this.Jh.sBd())&&this.Jh.refreshDocument(null)}}$f.xya="SE";$f.r6c="SEP";$f.STa="SER";$f.tlc="TRP";Object(n.a)($f,"SessionExpirationManager",vg,[663,664]);class mg{}mg.nok="Aborting";mg.Dyd="ActivityDuration";mg.error="Error";mg.fif="Errors";mg.failed="Failed";mg.UCb="FirstActivity";mg.initialized="Initialized";mg.kickedOut="KickedOut";mg.BVm="LastActivity";mg.Gdj="RetryOverride";mg.Hde="RequestGroups";mg.znb="Requests";mg.Tde="Responses";
mg.Bfe="SessionDuration";mg.status="Status";mg.success="Success";mg.pCo="Successful";mg.tokens="Tokens";mg.vZf="PollingDuration";Object(n.a)(mg,"SessionExpirationStrings",null,[]);class Za{constructor(b){this.fC={};this.Ija={};this.lXa={};this.VIi=15;this.Y1g=!1;this.Dhk=new Date;this.gnd=new Date;this.Hb=b;this.NN=new Df.a(2,2,6E4*this.VIi,Object(A.a)(this,this.OKj,"writeMeasures"),135,"SL",!1);this.Hb.Vb(this.NN);this.Jxm()}OKj(){v.ULS.sendTraceTag(41964821,217,50,v.ULS.vWc({["Aggregate"]:this.Ija,
["Current"]:this.fC}))}Jxm(){this.Ija[mg.Hde]=0;this.Ija[mg.znb]=0;this.Ija[mg.Tde]=0;this.Ija[mg.status]=mg.initialized;this.Ija[mg.UCb]=new Date;this.Ija[mg.Bfe]=0;this.Ija[mg.Dyd]=0;this.Ija[mg.Bfe]=0;this.fC[mg.Bfe]=0;this.Ija[mg.Dyd]=0;this.fC[mg.Dyd]=0}get JBn(){this.lXa[mg.vZf]=+new Date-+this.lXa[mg.UCb];return this.lXa}gzf(b,k){var t=b[k];t=t?t:0;t++;b[k]=t;this.Mag(b)}Mag(b){const k=new Date;b[mg.Dyd]=+k-+this.gnd;this.gnd=k;b[mg.Bfe]=+this.gnd-+this.Dhk;b[mg.BVm]=this.gnd}H9(b,k){this.fC[b]=
k;this.Mag(this.fC)}bag(b,k){this.fC[b]=k;this.Mag(this.fC)}S9b(b){this.gzf(this.fC,b);this.gzf(this.Ija,b);this.gzf(this.lXa,b)}flush(){this.Y1g||(this.Ija[mg.status]=this.fC[mg.status],this.OKj(this.NN),this.Hb.K0(this.NN,6E4*this.VIi))}H3n(){const b=this.fC[mg.status];b&&(this.Ija[mg.status]=b);this.fC={}}Y3n(){this.lXa={};this.lXa[mg.vZf]=0;this.lXa[mg.UCb]=new Date}stop(){v.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.Y1g=!0;this.Hb.Ve(this.NN)}}
Object(n.a)(Za,"SessionLogger",null,[659]);class Hb{constructor(b,k){this.ywd=b;this.qAa=k}get tokens(){return this.ywd}get errors(){return this.qAa}}Object(n.a)(Hb,"TokenRefreshArgs",null,[768]);var $b=c(396);class zc extends Sys.EventArgs{constructor(b,k,t,D,P,ca,ta){super();this.lXa=b;this.ABn=k;this.Hde=D;this.failed=P;this.znb=ca;this.Tde=ta}}Object(n.a)(zc,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Jc=c(34);class pd{constructor(b,k=null,t=null){this.FAc=this.pcb=!1;this.zud=this.bZb=
!0;this.ra=new Ue.a;this.HAc=this.Fvc=this.lsd=!1;this.kwb=null;this.oah=10;this.vmd=!1;this.VUe=b;this.IGe=w.AFrameworkApplication.DTm;this.Hb=wb.a.instance;v.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:w.AFrameworkApplication.Wy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:w.AFrameworkApplication.QW});this.ye=k||new Za(wb.a.instance);this.lla=t;cj.a.instance.vqh(Object(A.a)(this,this.gok,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));
cj.a.instance.uqh(Object(A.a)(this,this.BXe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));$b.SessionStatusManager.instance.h_e(Object(A.a)(this,this.BXe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));$b.SessionStatusManager.instance.Dxk(Object(A.a)(this,this.ADn,"preemptiveTokenRefresh"));this.s3g=new Date;w.AFrameworkApplication.CTm&&(cj.a.instance.K5e=Object(A.a)(this,this.CRn,"refreshAccessTokenWhenSessionExpired"));b=!1;w.AFrameworkApplication.K&&(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",
!1),this.oah=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),b=w.AFrameworkApplication.K.$("WopiTokenRefreshWhenNetworkResumed"));b?$b.SessionStatusManager.instance.h_e(Object(A.a)(this,this.hok,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):$b.SessionStatusManager.instance.h_e(Object(A.a)(this,this.BXe,
"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}sdb(b){this.ra.addHandler(pd.xya,b)}h4c(b){this.ra.removeHandler(pd.xya,b)}VYa(b){this.ra.addHandler(pd.STa,b)}KMb(b){this.ra.removeHandler(pd.STa,b)}l_e(b){this.ra.addHandler(pd.tlc,b)}jxf(){return cj.a.instance.qQa(w.AFrameworkApplication.Wy)}CRn(){this.qQc(!1);return!cj.a.instance.qQa(w.AFrameworkApplication.Wy)}gok(b,k){cj.a.instance.k_d?this.Nec(b,k):this.IGe?(this.Fvc=!1,this.qQc(!1)):(this.pcb||v.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),
this.Nec(b,k))}hok(b,k){cj.a.instance.j_d?this.O_c(b,k):(Jc.b(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.Fvc=!1,this.qQc(!0))}BXe(b,k){cj.a.instance.j_d?this.O_c(b,k):this.qQc(!0)}qQc(b){if(!this.lsd&&!this.Fvc)if(this.lla&&this.lla.jo)this.HAc=!0,this.ye.H9(mg.status,mg.kickedOut),this.ye.flush(),this.ye.stop();else if(v.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.HAc),this.HAc)this.Aie();else{this.ye.flush();
this.ye.H3n();this.ye.S9b(mg.Hde);this.lsd=!0;this.vmd||(this.ye.Y3n(),this.vmd=!0,this.u7k());const k=this.VUe.WRn(b);k.continueWith(()=>{if(this.VUe.AHn(k))this.ye.S9b(mg.pCo),this.ye.H9(mg.status,mg.success),this.zud=!1,this.IGe&&(this.bZb=!1),this.Fvc=!1,this.s3g=new Date,this.hBo(),this.ra.raiseEvent(pd.STa,new Hb(k.result.tokens,null));else{const t=k.result.errors;this.ye.S9b(mg.failed);this.ye.H9(mg.status,mg.failed);b||(this.HAc=this.VUe.XUc(t));this.HAc&&(this.ye.H9(mg.nok,JSON.stringify(t)),
v.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.Fvc=!0;this.ra.raiseEvent(pd.STa,new Hb(null,t))}this.ye.flush();this.lsd=!1})}}Nec(){this.IGe||cj.a.instance.vaj(Object(A.a)(this,this.Nec,"onSessionExpiredDetected"));v.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.Cwf(cj.a.instance.k_d)}O_c(){this.FAc||this.pcb||(v.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.FAc=!0,this.Aeg(cj.a.instance.j_d))}Cwf(b){if(!this.pcb){var k=
b?Bh.a.kdo:Bh.a.q6c;const t=Object.assign(new Db.a,{extendedProperties:new Map});t.extendedProperties.set("ErrorCode",String.format("{0}",k));w.AFrameworkApplication.UM(k,void 0,["SessionExpired"],t);b||(b=new Date,k=new Date(w.AFrameworkApplication.QW),v.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",k,b,+b-+k),864E5>+b-+k&&xa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,t),2592E5>+b-+k&&
xa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,t));this.pcb=!0;this.Aie()}}hBo(){this.vmd&&(this.Hb.Ve(this.kwb),this.vmd=!1)}u7k(){this.kwb=new Df.a(2,2,1E3*this.oah,Object(A.a)(this,this.GIo,"tokenRefreshPolling"),135);this.Hb.Vb(this.kwb)}GIo(){const b=this.ye.JBn;v.ULS.sendTraceTag(555255521,217,50,"{0}",G.c(b));this.ra.raiseEvent(pd.tlc,new zc(b,b[mg.vZf],b[mg.UCb],b[mg.Hde],b[mg.failed],b[mg.znb],b[mg.Tde]))}ADn(){3E5<+new Date-
+this.s3g?(v.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.qQc(!1)):v.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}pd.xya="SE";pd.r6c="SEP";pd.STa="SER";pd.tlc="TRP";Object(n.a)(pd,"ASessionExpirationManagerWithRefresh",null,[]);class Qd extends pd{constructor(b,k,t=null,D=null){super(k,t,D);this.IZ=null;this.Jh=b}Tdg(b){this.bZb=b}Aeg(b){if(!this.IZ&&!ll.a.jM){if(b){var k=Object(A.a)(this,this.H4b,
"disposeCallback");this.IZ=Bd(w.AFrameworkApplication.Nnb,!1,Object(A.a)(this,this.tic,"sessionExpirationHandler"),k)}else if(this.zud){if(this.lsd)return;k=Object(A.a)(this,this.H4b,"disposeCallback");this.IZ=Bd(w.AFrameworkApplication.Wy,!1,Object(A.a)(this,this.tic,"sessionExpirationHandler"),k)}v.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",pd.r6c,b);this.ra.raiseEvent(pd.r6c)}}Aie(){this.IZ&&(this.IZ.oha&&this.IZ.Dxf(),this.IZ=null);if(this.bZb){this.ye.stop();
if(this.lla&&this.lla.jo)return;const b=Object(A.a)(this,this.H4b,"disposeCallback");this.IZ=Bd(w.AFrameworkApplication.Wy,!0,Object(A.a)(this,this.tic,"sessionExpirationHandler"),b)}v.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",pd.xya);this.ra.raiseEvent(pd.xya)}H4b(){this.IZ=null}tic(b){(b||this.Jh.sBd())&&this.Jh.refreshDocument(null)}}Object(n.a)(Qd,"SessionExpirationManagerWithRefresh",pd,[663,664]);class ye{constructor(b,k,t=null,D=null){this.Zjh=!1;this._instance=null;this._frame=
b;this.Hm=k;this.ye=t||new Za(wb.a.instance);this.lla=D}create(){this.Zjh=w.AFrameworkApplication.s3a;if(!this.Zjh)return new $f(this._frame);w.AFrameworkApplication.Cn("WOPITokenRefreshIsEnabled");v.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this._instance)switch(w.AFrameworkApplication.A1o){case 1:v.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this._instance=new im(this._frame);break;case 2:v.ULS.sendTraceTag(39408091,
217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new Qd(this._frame,this.Hm,this.ye,this.lla);break;default:v.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new $f(this._frame)}v.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());return this._instance}}Object(n.a)(ye,"SessionExpirationManagerFactory",null,[662]);class Le{}Object(n.a)(Le,"Error",
null,[]);class Af{}Object(n.a)(Af,"NamedResult",null,[]);class dc extends Af{}Object(n.a)(dc,"ErrorInfo",Af,[]);var of=c(1067);class Mj{constructor(b,k,t,D=null,P=!1,ca=null,ta=!1,Na=!1){this.oBa=0;this.uMa=this.vo=null;this.ywd=new Eb.a;this.qAa=new Eb.a;this.Xp=null;this.mvc=!1;this.UBc=this.VBc=null;this.Hb=b;this.tah=k;this.tah.execute(qb=>{qb.NB(K.a.eyf,Object(A.a)(this,this.$mn,"onHostResponseReceived"))});this.D2=t;this.Gih=new of.a("WebServiceCall","TokenRefresh");this.ye=D||new Za(b);this.whk=
P;this.af=ca?ca:$b.SessionStatusManager.instance;this.oTg=ta;this.Whd=Na}$mn(b){if(b.MessageId!==K.a.eyf)Jc.b(39408099,306,15,"Unexpected message.");else{var k=new Eb.a,t=new Eb.a;this.ye.S9b(mg.Tde);var D=b.Values[I.a.Cij];if(!D||0>=D.length)Jc.b(40122317,306,15,"Found no tokens in the dictionary"),D=b.Values;Jc.b(40122318,306,100,"The Tokens array contains {0} tokens",D.length);this.ye.H9("Correlation",b.CorrelationId);var P="";for(let Na=0;Na<D.length;Na++){this.ye.bag(mg.tokens,D.length);var ca=
D[Na],ta=ca;if(!ta||!ta.Name)continue;this.ye.S9b(ta.Name);const qb=ca;if(qb&&qb.Value)Jc.b(39408128,306,100,"Received token with name: {0}",qb.Name),k.add(qb),this.ywd.add(qb),this.Whd||this.ye.H9(mg.status,mg.success),this.oTg&&this.af&&this.af.o4n();else if(ca=this.B$l(ca),Jc.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",ta.Name,JSON.stringify(ca),this.uMa),t.add(ca),this.Whd||(this.qAa.add(ca),P=JSON.stringify(ca),this.ye.H9(mg.error,JSON.stringify(ca)),
this.ye.H9(mg.status,mg.failed)),this.oTg)for(const Jb of ca.Errors)ta=this.dUl(Jb),this.af&&this.af.Huk(ta)}this.Whd?(0<t.count?this.UBc?this.UBc(new Hb(k,t)):Jc.b(512267295,306,15,"Received errors but the promise has completed"):this.VBc?this.VBc(new Hb(k,t)):Jc.b(512267294,306,15,"Received valid tokens but the promise has completed"),Jc.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",k.count,t.count,b.CorrelationId,this.uMa)):(0<t.count&&
""!==P?(D=Object.assign(new Db.a,{extendedProperties:new Map}),D.extendedProperties.set("Errors",P),D.extendedProperties.set("RetryCount",this.oBa.toString()),D.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),D.extendedProperties.set("IsTokenExpiring",this.mvc.toString()),xa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,D)):xa.Health.instance.recordKpiSuccess("WACTokenRefresh",null),Jc.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
k.count,t.count,b.CorrelationId,this.uMa),0<t.count&&!this.XUc(t)?(b=this.D2.Pei(t),b!==this.D2.thc&&(this.ye.bag(mg.Gdj,b),this.Hb.K0(this.vo,b))):(this.ye.flush(),this.vo&&(Jc.b(39408131,306,100,"Deleting task {0} from task manager",this.vo.name),this.Hb.Ve(this.vo)),this.Xp&&!this.Xp.task.isCompleted?this.Xp.Ag(new Hb(k,t)):Jc.b(512267293,306,15,"Received results but the task has completed")))}}B$l(b){if(!b)return null;const k=Object.assign(new dc,{Name:b.Name,Errors:[]});for(const t of b.Errors)b=
new Le,b.Id=t.Id,b.Details=ua.a.o8b(t.Details,500),k.Errors.push(b);return k}requestTokensOnce(){this.qcj()}qcj(){w.AFrameworkApplication.ue("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.oBa>=this.D2.K3d?(Jc.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.uMa),this.e9k(this.Xp)):(xa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.Lhj())}Lhj(){const b={};b[I.a.Cij]=this.D2.tokens;const k=lb.a.create().toString();
Jc.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.D2.tokens),this.oBa+1,k,this.uMa);this.tah.execute(t=>{t.sendMessage(K.a.F0e,b,k)});this.oBa++;this.ye.S9b(mg.znb)}e9k(b){const k=new Eb.a;for(let t=0;t<this.D2.tokens.length;t++){const D=Object.assign(new dc,{Name:this.D2.tokens[t],Errors:[Object.assign(new Le,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});k.add(D);
this.qAa.add(D)}this.Hb.Ve(this.vo);this.ye.H9(mg.fif,JSON.stringify(this.qAa));this.ye.H9(mg.status,mg.failed);b&&!b.task.isCompleted&&b.Ag(new Hb(new Eb.a,this.qAa))}WRn(b){this.Gih.start();this.mvc=b;this.uMa=lb.a.create().toString();Jc.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.uMa,this.mvc);this.oBa=0;this.qAa.clear();this.ywd.clear();this.Xp=new Cg.a;this.Whd?this.rcj(this.D2.K3d).then(k=>{this.Xp&&!this.Xp.task.isCompleted&&this.Xp.Ag(k);this.UBc=this.VBc=
null;this.ye.H9(mg.fif,JSON.stringify(this.qAa));this.ye.H9(mg.status,mg.success);this.ye.flush()}).catch(k=>{this.Xp&&!this.Xp.task.isCompleted&&this.Xp.Ag(Object(Ka.a)(768,k));this.UBc=this.VBc=null;this.ye.H9(mg.fif,JSON.stringify(this.qAa));this.ye.H9(mg.status,mg.failed);this.ye.flush()}):(this.vo=new Df.a(this.D2.priority,2,this.D2.thc,Object(A.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,K.a.F0e,!0),this.whk&&this.qcj(),this.Hb.Vb(this.vo));return this.Xp.task}rcj(b){const k=this,
t=new Promise((Na,qb)=>{k.VBc=Na;k.UBc=qb;xa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);k.Lhj()}),D=this,P=new Promise((Na,qb)=>{window.setTimeout(()=>{qb(D.MKh("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},D.D2.thc)});let ca=b;const ta=this;return new Promise((Na,qb)=>{ca--;Promise.race([t,P]).then(Jb=>{xa.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Na(Jb)}).catch(Jb=>{var Vb=ta.D2.thc;if(Object(ob.a)(768,Jb)&&(Jb=
Object(Ka.a)(768,Jb),0<Jb.errors.count)){ta.O0m(Jb.errors);ta.vnh(Jb.errors);if(ta.XUc(Jb.errors)){qb(Jb);return}const ac=ta.D2.Pei(Jb.errors);ac!==ta.D2.thc?(ta.ye.bag(mg.Gdj,ac),Vb=ac):ta.cSm(Jb.errors)&&(Vb=0)}ca?window.setTimeout(()=>{ta.rcj(ca).then(Na).catch(qb)},Vb):(Vb=ta.MKh("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),ta.vnh(Vb.errors),qb(Vb),Jc.b(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
ta.uMa))})})}vnh(b){for(let k of b)this.qAa.add(k)}cSm(b){if(!b.count)return!1;b=b.J(b.count-1);return b.Errors.length?"TIMEOUT"==b.Errors[0].Id:!1}MKh(b,k){const t=new Eb.a;for(let D=0;D<this.D2.tokens.length;D++){const P=this.f9k(this.D2.tokens[D],b,k);t.add(P)}return new Hb(new Eb.a,t)}f9k(b,k,t){return Object.assign(new dc,{Name:b,Errors:[Object.assign(new Le,{Id:k,Details:t})]})}O0m(b){if(b.count){b=b.J(b.count-1);b=JSON.stringify(b);var k=Object.assign(new Db.a,{extendedProperties:new Map});
k.extendedProperties.set("Errors",b);k.extendedProperties.set("RetryCount",this.oBa.toString());k.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());k.extendedProperties.set("IsTokenExpiring",this.mvc.toString());xa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,k);this.ye.H9(mg.error,b);this.ye.H9(mg.status,mg.failed)}}AHn(b){this.Gih.stop();const k=this.som(b.result.errors);v.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!k,this.uMa,this.mvc,this.oBa,this.qAa.count,0<b.result.errors.count?b.result.errors.J(0).Name:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Details:"");return k?!1:this.zHn(b.result.tokens)}XUc(b){return this.D2.XUc(b)}zHn(b){for(let k=0;k<b.count;k++){const t=b.J(k);if(t.Name===I.a.accessToken){const D=(new Date).getTime();t.Expiry>w.AFrameworkApplication.Wy?
(v.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:t.Expiry,["NowGetTime"]:D,["BootTime"]:w.AFrameworkApplication.QW},"PreviousAccessTokenTtl",w.AFrameworkApplication.Wy),w.AFrameworkApplication.accessToken=t.Value,w.AFrameworkApplication.Wy=Math.floor(t.Expiry),w.AFrameworkApplication.Tog=D,w.AFrameworkApplication.GMa=Math.floor(t.Expiry)):v.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:t.Expiry,
["NowGetTime"]:D,["BootTime"]:w.AFrameworkApplication.QW},"PreviousAccessTokenTtl",w.AFrameworkApplication.Wy)}}return!0}som(b){let k=!1;for(let t=0;t<b.count;t++){k=!0;const D=b.J(t);v.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",D.Name,JSON.stringify(D.Errors),this.uMa)}return k}dUl(b){let k=Bh.a.q6c;b=parseInt(b.Id);if(isNaN(b))k=Bh.a.RJj;else{switch(b){case 401:k=Bh.a.Uog;break;case 403:k=Bh.a.PJj;break;case 500:k=Bh.a.QJj;break;case 503:k=Bh.a.TJj}k===
Bh.a.q6c&&(k=500<b?Bh.a.SJj:Bh.a.OJj)}return k}}Object(n.a)(Mj,"TokenRefreshManager",null,[661]);class bi{constructor(){this.thc=w.AFrameworkApplication.D1o;this.K3d=w.AFrameworkApplication.B1o;this.tokens=w.AFrameworkApplication.Eim();this.priority=w.AFrameworkApplication.E1o;this.Qch=this.kko();this.fXe=w.AFrameworkApplication.Dim()}XUc(b){b=JSON.stringify(b);if(this.fXe&&0<this.fXe.length)for(const k of this.fXe)if(0<k.length&&0<=b.indexOf(k))return!0;return!1}Pei(b){try{if(b)for(let k of b)if(k.Errors)for(const t of k.Errors)if(t.Id in
this.Qch)return Number.parseInvariant(this.Qch[t.Id].toString())}catch(k){v.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",k.toString())}return this.thc}kko(){const b={};try{if(!w.AFrameworkApplication.TSd()||0>=w.AFrameworkApplication.TSd().length||""===w.AFrameworkApplication.TSd()[0])return b;for(const k of w.AFrameworkApplication.TSd())0<k.length&&(b[k]=w.AFrameworkApplication.C1o)}catch(k){v.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
k.toString())}return b}}Object(n.a)(bi,"TokenRefreshPolicy",null,[660]);class rl{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){w.AFrameworkApplication.K.No(()=>{this.f2a()})}f2a(){this.W.resolve("Common.ISessionExpirationManagerFactory");this.W.resolve("Common.ISessionExpirationManager");this.W.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}xc(b){this.W=b;b.register(659,"Common.App.SessionExpiration.ISessionLogger").singleInstance().Rd(()=>new Za(wb.a.instance));
b.register(660,"Common.App.SessionExpiration.ITokenRefreshPolicy").singleInstance().Rd(()=>new bi);b.register(661,"Common.App.SessionExpiration.ITokenRefreshManager").singleInstance().Rd(()=>new Mj(wb.a.instance,w.AFrameworkApplication.MO(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),w.AFrameworkApplication.K.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Na("Common.ISessionStatus"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1),w.AFrameworkApplication.K.$("WopiTokenRefreshSyncMessageWithTimeout")));b.register(662,"Common.ISessionExpirationManagerFactory").singleInstance().Rd(()=>new ye(w.AFrameworkApplication.ta,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Na("Common.ISessionStatus")));b.register(663,"Common.ISessionExpirationManagerWithDialog").singleInstance().Rd(()=>b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(664,
"Common.ISessionExpirationManager").singleInstance().Rd(()=>b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){N.a.instance.Fc(new rl)}}Object(n.a)(rl,"SessionExpirationPackage",null,[1,2]);var jj=c(747),be=c(398),fh=c(336),zg=c(205);class em extends zg.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(n.a)(em,"PersonaButtonProps",zg.a,[]);class fo{H3b(b,k){if(b&&!(1>b.length)&&k){var t=Object.assign(new fh.a,{ExternalId:"msPresenceOuter",
ControlList:[]});this.t9k(b,t.ControlList);k.push(t)}}t9k(b,k){const t=Object.assign(new jj.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new be.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(k,t);k=Object.assign(new fh.a,{Title:"",ControlList:[]});Array.add(t.Menu.MenuSectionList,k);this.pbl(b,k.ControlList)}pbl(b,k){for(let t=0;t<b.length;t++){const D=Object.assign(new em,{ExternalId:String.format("CoauthorPersona_{0}",
t),Command:"336231556",DisplayName:b[t].userName,LabelText:b[t].userName,ImageBackColor:b[t].color,PersonaId:b[t].email,IsAnonymous:b[t].isAnonymous});Array.add(k,D)}}}Object(n.a)(fo,"PresenceContextMenuSectionBuilder",null,[694]);var Da=c(98);class jb{constructor(b,k,t,D){this.Mza=this.gt=this.vo=this.fi=this.nJa=null;this.Eud=b;this.Lik=D;this.Eud.eTc&&(this.vo=new Df.a(3,2,5E3,Object(A.a)(this,this.VGk,"authenticationCheckTask"),2),w.AFrameworkApplication.nc.Vb(this.vo),this.Tb(k,t));this.Eud.qvk(()=>
{this.XJb()});this.Eud.lph(()=>{this.YJb()})}get fM(){return this.gt||(this.gt=Fa.a.instance.Na("CommonUI.IBusinessBar"))}get Gyh(){return this.Mza||(this.Mza=Fa.a.instance.Na("CommonUI.IBusinessBarEntryFactory"))}Tb(b,k){const t=w.AFrameworkApplication.va;t.fb($a.a.xvh,Ud.a.frame,b,96);t.fb($a.a.yvh,Ud.a.frame,k,96);t.qa($a.a.QAh,Ud.a.frame,Xc.ActionManager.AQ);t.qa($a.a.RAh,Ud.a.frame,Xc.ActionManager.AQ);t.qa($a.a.EIf,Ud.a.frame,Xc.ActionManager.AQ)}XJb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
w.AFrameworkApplication.va.processAction($a.a.xvh,2)}YJb(){this.HFo();w.AFrameworkApplication.va.processAction($a.a.yvh,2)}VGk(){this.Eud.authenticationCheck()}HFo(){this.fi&&(this.fi.hide(),this.fi.dispose(),this.fi=null);this.nJa&&this.fM&&(w.AFrameworkApplication.Lk||this.fM.removeEntry(this.nJa),this.nJa.dispose(),this.nJa=null)}showDialog(b){Da.a.UB(this.fi);this.fi=new Uc.StandardDialog;this.Lik||(this.fi.rt=!1,this.fi.Ad=0);this.fi.Ee(1,CommonUIStrings.l_SignIn);this.fi.$U(CommonUIStrings.l_DefaultDialogTitle,
b,Object(A.a)(this,this.Zaa,"dialogHandler"))}Zaa(b){1===b?($k.a.Q9d(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),w.AFrameworkApplication.va.processAction($a.a.EIf,2)):(this.Zso(),w.AFrameworkApplication.va.processAction($a.a.RAh,2))}Zso(){this.fM&&this.Gyh&&(this.nJa=this.Gyh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.nJa.closeable=!0,this.nJa.addButton(CommonUIStrings.l_SignIn,jb.eeb,""),this.nJa.fma=
Object(A.a)(this,this.hOk,"businessBarEntryCloseHandler"),this.fM.aA(this.nJa,!1))}hOk(){this.oml();w.AFrameworkApplication.va.processAction($a.a.QAh,2)}oml(){this.vo&&(w.AFrameworkApplication.nc.Ve(this.vo),this.vo=null)}dispose(){this.vo=this.fi=this.nJa=null}static eeb(){$k.a.Q9d();w.AFrameworkApplication.va.processAction($a.a.EIf,2)}}Object(n.a)(jb,"SignOutResponseUI",null,[9]);class ic{get name(){return"Common.App.UI"}xc(b){b.register(fo,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").singleInstance()}init(){}dispose(){Da.a.UB(ic.Wsa);
ic.Wsa=null}static main(){N.a.instance.Fc(new ic)}static $vm(b,k,t){ic.Lso()&&(ic.Wsa=new jb($k.a.instance,b,k,t))}static Lso(){return w.AFrameworkApplication.U4d&&!w.AFrameworkApplication.bha}}ic.Wsa=null;Object(n.a)(ic,"CommonAppUIPackage",null,[1,2]);class Lc{get name(){return"Common.App.DialogWithLinkToResource"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new Lc)}}Object(n.a)(Lc,"CommonAppDialogWithLinkToResourcePackage",null,[1,2]);var ad=c(65);class ce{constructor(b){this.ay=b;this.Ux=
Array.indexOf(this.ay,this.kga)}dispose(){this.ay=null}get s3(){return this.ay[this.Ux]}Gy(b){this.z6c(b,!1);return!0}w6b(b){this.z6c(b,!0)}z6c(b,k){b&&(this.s3!==b||k)&&(b.tabIndex=0,ad.FocusManager.OJ(b));Array.contains(this.ay,b)&&(this.Ux=Array.indexOf(this.ay,b))}get j2i(){let b=this.Ux;do if(b)if(0<b&&b<this.ay.length)b--;else break;else b=this.ay.length-1;while(!Se.DOMFocusListing.W_a(this.ay[b])&&b!==this.Ux);return this.ay[b]}get JPi(){let b=this.Ux;do if(b===this.ay.length-1)b=0;else if(0<=
b&&b<this.ay.length-1)b++;else break;while(!Se.DOMFocusListing.W_a(this.ay[b])&&b!==this.Ux);return this.ay[b]}get kga(){let b=0;for(;!Se.DOMFocusListing.W_a(this.ay[b])&&b<this.ay.length;)b++;return Se.DOMFocusListing.W_a(this.ay[b])?this.ay[b]:null}get kcc(){let b=this.ay.length-1;for(;!Se.DOMFocusListing.W_a(this.ay[b])&&0<b;)b--;return Se.DOMFocusListing.W_a(this.ay[b])?this.ay[b]:null}}Object(n.a)(ce,"DialogFocusListing",null,[156]);var fc=c(54);class kf extends Uc.StandardDialog{constructor(b,
k,t,D=null){super();this.tea=this.Gw=this.B$a=null;this.ay=[];this.Tqd=k;this.rk=b;this.K4j=t;this.Std=D;this.gm=new of.a("LoadResource","LoadPrintablePdf")}FDa(){this.Ad=5;this.width=40;const b=document.createElement("span");b.id=this.kj("DirectPrintHeaderContent");const k=document.createElement("span");k.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(k,"DirectPrintHeader");this.tea=document.createElement("iframe");this.tea.name="pdfObjectFrame";this.tea.title=
CommonUIStrings.l_DirectPrintDialogIFrame;this.tea.onload=Object(A.a)(this,this.sFn,"printablePdfLoaded");if(this.Std&&0<this.Std.count){var t=ia.a.Bsf(this.Tqd,this.Std);const D=ia.a.h5f(this.Tqd,this.Std);this.Gw=document.createElement("form");this.Gw.id="printPreviewPostForm";this.Gw.method="POST";this.Gw.target=this.tea.name;this.Gw.action=D;for(let P of t)t=document.createElement("input"),t.type="hidden",t.name=P.key,t.value=P.value,this.Gw.appendChild(t)}else this.tea.setAttribute("src",this.Tqd);
Sys.UI.DomElement.addCssClass(this.tea,ll.a.$7g);this.K4j?(Sys.UI.DomElement.addCssClass(this.tea,"DirectPrintPdfObjectHidden"),k.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,df.a.gr(this.tea,df.a.bA,df.a.jp)):(Sys.UI.DomElement.addCssClass(this.tea,"DirectPrintPdfObject"),this.ay.push(this.tea));b.appendChild(k);b.appendChild(document.createElement("br"));b.appendChild(this.tea);this.Gw&&b.appendChild(this.Gw);b.appendChild(document.createElement("br"));b.appendChild(this.Q2k(this.Gw?
"#":this.Tqd));this.gm.start();this.glb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.Z4(this.kj("DirectPrintHeaderContent"));this.Gw&&this.Gw.submit();this.u9k();v.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}Q2k(b){const k=document.createElement("span");var t=document.createElement("span");t.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;k.appendChild(t);w.AFrameworkApplication.K&&(2===w.AFrameworkApplication.ta.Nb.Sl&&w.AFrameworkApplication.K.$("PPTDisableDirectPrintDialogDownloadPDFLink")||
1===w.AFrameworkApplication.ta.Nb.Sl&&w.AFrameworkApplication.K.$("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===w.AFrameworkApplication.ta.Nb.Sl?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===w.AFrameworkApplication.ta.Nb.Sl&&(b.innerText=CommonUIStrings.l_InternalError_Directive,v.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.B$a=b,k.appendChild(document.createElement("br")),k.appendChild(b)):(t=
document.createElement("a"),t.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,t.href=b,t.target="_blank",t.id="PrintPDFLink",t.className="AllowBrowserClick",this.B$a=t,k.appendChild(document.createElement("br")),k.appendChild(t),this.Gw&&vf.a.addHandler(t,"click",Object(A.a)(this,this.ysn,"onSubmit")),this.rk.lb(Rc.a.click,this.B$a,Object(A.a)(this,this.GTh,"downloadPDFLinkClicked"),null));this.ay.push(this.B$a);return k}ysn(b){this.Gw&&(this.Gw.target="_blank",this.Gw.submit());b.preventDefault()}u9k(){if(0<
this.ay.length){const b=new ce(this.ay),k=ad.FocusManager.instance().Ps();k&&(this.B$a.focus(),k.Zj=b,k.jR=!0)}}GTh(){v.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}NXc(){v.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}sFn(){v.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.gm&&this.gm.stop()}dispose(){this.B$a&&(this.rk.rc(Rc.a.click,this.B$a,Object(A.a)(this,this.GTh,"downloadPDFLinkClicked")),
this.B$a=null);fc.a.gx(this.tea);this.tea=null;super.dispose()}}Object(n.a)(kf,"DirectPrintDialog",Uc.StandardDialog,[743]);class Tc{constructor(b){this.rk=b}RSl(b,k,t=null){return new kf(this.rk,b,k,t)}}Object(n.a)(Tc,"DirectPrintDialogFactory",null,[730]);class Mg{constructor(b,k){this._url=b;this.Kck=k}tSh(){this.Kck?$d.a.downloadFile(this._url):$d.a.nm(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(n.a)(Mg,"OpenUrlInTabDialogDownloadBehavior",null,
[751,9]);class yf extends Uc.StandardDialog{constructor(b,k=!0,t=!1,D=null,P=null,ca=!1){super();this.TUb=this.SUb=this.Gw=this.v2=null;var ta=this.kjg?this.kjg:CommonUIStrings.l_DefaultDialogTitle;yf.n9b=ca;this.Gye=D||new Mg(b,!0);const Na=[],qb=[];yf.vL&&(this.Nzd&&this.Nzd.forEach(ac=>{Array.add(Na,ac)}),this.Kqh&&this.Kqh.forEach(ac=>{Array.add(qb,ac)}));k?t?this.WXd?(this.Ad=12,this.Ee(1,this.buttonText),this.Ee(2,CommonUIStrings.l_DownloadACopyDialog_CopyALinkButton),this.Ee(3,CommonUIStrings.l_DialogClose)):
this.hYd?(this.Ad=12,this.Ee(1,this.buttonText),this.Ee(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),this.Ee(3,CommonUIStrings.l_DialogClose)):(this.Ad=4,this.Ee(1,this.buttonText),this.Ee(2,CommonUIStrings.l_DialogClose)):(this.Ad=6,this.Ee(0,CommonUIStrings.l_DialogClose)):this.Ad=5;ca=document.createElement("span");this.qIc&&(ca.className=this.qIc);D=document.createElement("a");D.innerText=this.Ecc;D.href=b;D.target="_blank";D.id=this.tXc;D.className=ef.AFrame.g0e;var Jb=!aa.a.a4&&
!!P&&0<P.count;if(Jb){const ac=ia.a.Bsf(b,P);P=ia.a.h5f(b,P);D.href="#";D.target="_self";this.Gw=document.createElement("form");this.Gw.id="printPreviewPostForm1";this.Gw.method="post";this.Gw.target="_blank";this.Gw.action=P;for(var Vb of ac)P=document.createElement("input"),P.type="hidden",P.name=Vb.key,P.value=Vb.value,this.Gw.appendChild(P)}else this.Gw=null;this.Gw||yf.n9b?yf.n9b||Array.add(qb,{["type"]:"AppLinkProps",["id"]:this.tXc,["text"]:this.Ecc,["onExecute"]:()=>{this.Q5i()}}):Array.add(qb,
{["type"]:"AppLinkProps",["id"]:this.tXc,["text"]:this.Ecc,["handler"]:{["href"]:Jb?"#":b,["target"]:Jb?"_self":"_blank"}});this.f4a&&Array.add(Na,this.f4a);t?(b=document.createElement("span"),b.innerText=this.f4a.replace("{0}",""),ca.appendChild(b)):this.mNi?(b=document.createElement("span"),b.id=this.kj("message"),Vb=document.createElement("span"),P=document.createElement("span"),Jb=this.f4a.split("{0}"),Vb.innerText=Jb[0],P.innerText=Jb[1],b.appendChild(Vb),b.appendChild(D),b.appendChild(P),ca.appendChild(b)):
(b=document.createElement("span"),b.innerText=this.f4a,ca.appendChild(b),ca.appendChild(document.createElement("br")),ca.appendChild(document.createElement("br")),ca.appendChild(D),yf.n9b||Array.add(Na,"{0}"));this.Gw&&ca.appendChild(this.Gw);yf.vL&&(this.Ekb&&(this.$Wc?this.ynh(this.Ekb,this.$Wc):(Array.add(Na,"{0}"),Array.add(qb,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.Ekb,["onExecute"]:()=>{}}))),this.hDc(Na,qb));this.glb(ta,null,this.qyf,null,Object(A.a)(this,this.Zaa,"dialogHandler"),
yf.vL?null:ca);this.Z4(this.kj("message"));!yf.vL&&this.$Wc&&this.Ekb&&(ta=document.createElement("div"),ta.className="WACDialogLearnMoreLinkContainer",this.v2=document.createElement("a"),this.v2.innerText=this.Ekb,this.v2.href=this.$Wc,this.v2.target="_blank",this.v2.id=this.kj("LearnMoreLinkId"),this.v2.className=ef.AFrame.g0e,ta.appendChild(this.v2),k?this.Jc.insertBefore(ta,this.Jc.lastChild):this.Jc.appendChild(ta),this.Z4(String.format("{0} {1}",this.kj("message"),this.kj("LearnMoreLinkId"))));
this.Orc=D;t?this.R0(this.ZG):this.R0(this.Orc);this.iKf();w.AFrameworkApplication.ta.f1.lb(Rc.a.click,this.Orc,Object(A.a)(this,this.FTh,"downloadLinkClicked"),null);this.v2&&w.AFrameworkApplication.ta.f1.lb(Rc.a.click,this.v2,Object(A.a)(this,this.NEi,"learnMoreLinkClicked"),null);this.IV=!1}get qyf(){return null}get kjg(){return null}get f4a(){return null}get $Wc(){return null}get Ekb(){return null}get mNi(){return!1}get buttonText(){return CommonUIStrings.l_Open}get qIc(){return null}get Nzd(){return null}get Kqh(){return null}get WXd(){return!1}get hYd(){return!1}m$e(){}FUh(){}Tla(){this.Gw&&
(this.SUb||(this.SUb=Object(A.a)(this,this.bin,"onActionButtonClicked"),this.Jq.lb(Rc.a.click,this.ZG,this.SUb)),this.TUb||(this.TUb=Object(A.a)(this,this.cin,"onActionButtonKeyUp"),this.ae.lb(Rc.a.vh,this.ZG,this.TUb)));super.Tla()}bin(b){this.fXh(b);return!0}cin(b){return this.yWc(b,Object(A.a)(this,this.fXh,"executeDismissActionButtonFromArgs"))}fXh(b){this.Gw&&this.Gw.submit();this.ACb(b.zf)}NXc(){}FTh(){this.jKf();this.Gw?this.Gw.submit():this.Gye.tSh();return!0}NEi(){return!1}dispose(){this.Gye.dispose();
this.Orc&&(w.AFrameworkApplication.ta.f1.rc(Rc.a.click,this.Orc,Object(A.a)(this,this.FTh,"downloadLinkClicked")),this.Orc=null);this.v2&&(w.AFrameworkApplication.ta.f1.rc(Rc.a.click,this.v2,Object(A.a)(this,this.NEi,"learnMoreLinkClicked")),this.v2=null);this.Jq&&this.SUb&&(this.Jq.rc(Rc.a.click,this.ZG,this.SUb),this.SUb=null);this.ae&&this.TUb&&(this.ae.rc(Rc.a.vh,this.ZG,this.TUb),this.TUb=null);super.dispose()}Q5i(){this.Gw&&(document.body.appendChild(this.Gw),this.Gw.submit(),document.body.removeChild(this.Gw))}Zaa(b){1===
b?(this.NXc(),this.Gw?yf.vL&&this.Q5i():this.Gye.tSh()):2===b&&(this.WXd?this.m$e():this.hYd&&this.FUh());this.dispose()}static get vL(){return w.AFrameworkApplication.ta.Nb.nF&&w.AFrameworkApplication.ta.Nb.Szi}static get n9b(){return yf.TXg}static set n9b(b){yf.TXg=b}}yf.TXg=!1;Object(n.a)(yf,"ADialogWithLinkToResource",Uc.StandardDialog,[]);class ng extends yf{constructor(b,k,t=null,D=!0,P=!1){super(b,!0,!(ng.kqb&&D),new Mg(b,k),t,P);ng.kqb=ng.kqb&&D;if(ng.kqb){k=document.createElement("iframe");
D=null;P=this.SQh;k.name="pdfObjectFrame";k.id="pdfObjectIFrame";if(t&&0<t.count){const ca=ia.a.Bsf(b,t);b=ia.a.h5f(b,t);D=document.createElement("form");D.id="printPreviewPostForm";D.method="POST";D.target=k.name;D.action=b;for(let ta of ca)b=document.createElement("input"),b.type="hidden",b.name=ta.key,b.value=ta.value,D.appendChild(b)}else k.src=b;P.appendChild(k);D&&(P.appendChild(D),D.submit());Sys.UI.DomElement.addCssClass(k,"DirectPrintPdfObjectHidden");df.a.gr(k,df.a.bA,df.a.jp)}}get qyf(){return"Print_32x32x32"}get kjg(){return ng.kqb?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get f4a(){return ng.kqb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get Nzd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(yf.n9b){let k=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==w.AFrameworkApplication.ta.Nb.ZNh&&(k=w.AFrameworkApplication.ta.Nb.ZNh);Array.add(b,k)}return ng.kqb?b:null}get Ecc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get tXc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get qIc(){return w.AFrameworkApplication.G_a?
"UIFontDialogTextLarge":null}iKf(){v.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}jKf(){w.AFrameworkApplication.Qm.b2a(9540);v.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}NXc(){v.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get kqb(){return!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nF&&w.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(aa.a.a4||aa.a.ut||aa.a.jj||aa.a.Wba)&&!w.AFrameworkApplication.dWc&&
w.AFrameworkApplication.K.$("ShouldHostDefaultToNativeBrowserPrintExperience")}static set kqb(b){}}Object(n.a)(ng,"PrintDialogWithLinkToPdf",yf,[]);class ji{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");this.vOm=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.aLm=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.hPb=(b.DirectPrintSupportedMimeTypes||"").split(ji.zef);this.gpb=(b.DirectPrintSupportedPlugins||"").split(ji.zef);this.aum=(b.DirectPrintImmersivePreviewPlugins||
"").split(ji.zef);this.Mvi=Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.oFm=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.SVk=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.eNf=14;this.zNi=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const k=b.split(".");2===k.length?(this.eNf=parseInt(k[0]),this.zNi=parseInt(k[1])):v.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else v.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}ji.zef=",";Object(n.a)(ji,"DirectPrintBrsSettings",null,[]);class kj{constructor(b,k){this.Sgg=b;this.gpb=k}}Object(n.a)(kj,"DirectPrintProbeResults",null,[]);class fl{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb){this.wxd=null;this.W_j=b;this.ixc=k;this.pKe=t;this.p7j=D;this.t8j=P;this.bzc=new Rg.a(Object(A.a)(this,this.Q7l,"getProbeResults"));this.qrc=ca;this.t4g=qb;this.XS=ta;this.kvc=Na;this.M8j=Jb}get zQ(){return this.W_j}start(){}PFn(){this.zQ.vOm&&
this.m4m()}BKn(){const b=Array(this.zQ.hPb.length);if(void 0!==this.ixc&&null!==this.ixc)for(let k=0;k<this.zQ.hPb.length;k++)b[k]=this.zQ.hPb[k]in this.ixc&&this.p7j(this.ixc[this.zQ.hPb[k]]);return b}CKn(){const b=Array(this.zQ.gpb.length),k=!(void 0===this.pKe||null===this.pKe);for(let t=0;t<this.zQ.gpb.length;t++){const D=this.zQ.gpb[t];b[t]=k&&D in this.pKe?!0:this.t8j(D)}return b}Acm(){const b=this.BKn(),k=Array(b.length);for(let t=0;t<b.length;t++)k[t]=b[t]?this.Qxl(this.ixc[this.zQ.hPb[t]]):
null;return k}Qxl(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}m4m(){v.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.bzc.value.Sgg,this.bzc.value.gpb)}Q7l(){var b=this.Acm();const k=this.CKn(),t={},D={};for(let P=0;P<this.zQ.hPb.length;P++)t[this.zQ.hPb[P]]=b[P];for(b=0;b<this.zQ.gpb.length;b++)D[this.zQ.gpb[b]]=k[b];return new kj(t,D)}Dso(){return this.M8j||!this.zQ.isEnabled||w.AFrameworkApplication.dWc?!1:this.CCo()}Jso(){if(null!=
this.wxd)return this.wxd;const b=fl.Lvi(this.zQ);return this.wxd=this.zQ.Mvi&&b||this.nFm()}nFm(){return aa.a.zq&&this.zQ.oFm&&aa.a.RVk>=this.zQ.SVk?!0:!1}CCo(){if(!this.kvc(this.zQ))return!1;var b=ib.a.bFb(this.bzc.value.Sgg);for(const k of b)if(void 0!==k&&null!==k)return!0;b=ib.a.bFb(this.bzc.value.gpb);for(const k of b)if(k)return!0;return!1}Dom(){const b=ib.a.bFb(this.bzc.value.Sgg);for(const k of b)if(Qm.a.contains(this.zQ.aum,k))return!0;return!1}$uo(b,k=null){w.AFrameworkApplication.ta&&w.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")?
this.t4g(b,k):this.Dso()?this.unl(b,this.Dom()&&!0,k):this.t4g(b,k)}unl(b,k,t=null){const D=this.XS.Zf("UserAction","OpenDirectPrintDialog");this.qrc.RSl(b,k,t).FDa();D.stop()}static fRm(b){try{return new ActiveXObject(b),!0}catch(k){v.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static fIm(b){return void 0===b||null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const k=new ji(w.AFrameworkApplication.K.appSettings);let t=
null;try{t=window.navigator.mimeTypes}catch(Jb){v.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let D=null;try{D=window.navigator.plugins}catch(Jb){v.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const P=fl.fIm,ca=fl.fRm;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const ta=w.AFrameworkApplication.ta.Fq,Na=fl.hRm,qb=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nF&&!w.AFrameworkApplication.K.$("PrintDialogFallbackLinkEnabled");
return new fl(k,t,D,P,ca,b,ta,Na,(Jb,Vb)=>new ng(Jb,!1,Vb,!0,qb),w.AFrameworkApplication.bha)}static hRm(b){return aa.a.zq||aa.a.ut&&b.aLm||b.Mvi&&fl.Lvi(b)?!0:!1}static Lvi(b){var k=aa.a.Z4b;if(k){var t=k.split(".");if(2===t.length)return k=parseInt(t[0]),t=parseInt(t[1]),k>b.eNf||k===b.eNf&&t>=b.zNi}return!1}}Object(n.a)(fl,"DirectPrintManager",null,[692]);class dj{constructor(){this.ysb=this.W=null}get name(){return"Common.App.DirectPrint"}xc(b){this.W=b;b.register(Tc,"Common.App.DirectPrint.DirectPrintDialogFactory").singleInstance().Rd(()=>
new Tc(w.AFrameworkApplication.ta.f1));b.register(692,"Common.App.DirectPrint.IDirectPrintManager").singleInstance().Rd(()=>fl.create(this.W))}init(){this.ysb=this.W.resolve("Common.App.DirectPrint.IDirectPrintManager");this.ysb.start()}dispose(){}}Object(n.a)(dj,"PackageManager",null,[1,2]);class yk{constructor(b,k=3E4){this.Bjg=9E5;this.Djg=1E4;this.EKi=this.ddc=null;this.sLf=0;this.sfb=Date.now;this.zSd=b;this.p7a=k;this.ENd()}Uhi(b=!0){const k=this.sfb();if(k<this.sLf+this.Bjg)return k>this.sLf+
this.Djg&&this.ENd(),this.EKi;b&&this.ENd();return null}getToken(b=!0){return(b=this.Uhi(b))?Promise.resolve(b):this.ENd()}ENd(){return this.ddc=this.ddc||new Promise(b=>{this.zSd().then(k=>{this.ddc=null;""!==k&&k&&(this.EKi=k,this.sLf=this.sfb(),b(k));b(null)}).catch(()=>{this.ddc=null;b(null)});window.setTimeout(()=>{this.ddc=null;b(null)},this.p7a)})}}Object(n.a)(yk,"OAuthCacheManager",null,[]);class kn{static qva(b){return""!==b&&b?kn.NBk[b.toLowerCase()]:""}static Gem(b,k){if(window.location.search.match(RegExp("wdpa=1",
"gi")))return Promise.resolve("");const t=Date.now();var D=kn.d3k();const P=w.AFrameworkApplication.K.jb("UserPrincipalName"),ca=kn.qva(b);v.ULS.sendTraceTag(593862986,1300,50,"Begin SSO Request for app: "+b);if(""===P||!P)return v.ULS.sendTraceTag(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===ca||!ca)return v.ULS.sendTraceTag(593862984,1300,10,"Missing AAD appId for appName: "+b),Promise.resolve("");const ta=lb.a.create().toString();D=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none",
"https://login.microsoftonline.com",ca,encodeURIComponent(k),encodeURIComponent(P),encodeURIComponent(D),ta);const Na=document.createElement("iframe");Na.style.display="none";Na.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");Na.src=D;document.body.appendChild(Na);return new Promise(qb=>{kn.zcn(Na.contentWindow).then(Jb=>{document.body.removeChild(Na);const Vb=new cb.a,ac=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let yc;for(;yc=ac.exec(Jb);)3!==yc.length&&(v.ULS.sendTraceTag(593862983,
1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",yc.length),qb("")),Vb.Z(yc[1],yc[2]);Vb.nb("access_token")?(v.ULS.sendTraceTag(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",k,b,Date.now()-t),qb(Vb.J("access_token"))):(v.ULS.sendTraceTag(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",k,b,(Date.now()-t).toString()),qb(""))}).catch(Jb=>{try{document.body.removeChild(Na)}catch(Vb){}v.ULS.sendTraceTag(593862980,
1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",k,b,JSON.stringify(Jb),(Date.now()-t).toString());qb("")})})}static d3k(){const b=window.location.protocol,k=window.location.host;var t=w.AFrameworkApplication.K.jb("OAuthManagerHostPathOverride");if(void 0===t||null===t){t=window.location.pathname;const D=t.lastIndexOf("/");t=0<=D?t.substring(0,D+1):""}return b+"//"+k+t+"WacOAuth.html"}static zcn(b){return new Promise((k,t)=>{let D=0,P=0;P=window.setInterval(()=>
{if(200<D++)window.clearInterval(P),t("Exceeded 10000ms timeout after 200 polls");else{var ca=null,ta=null;try{if(!b||b.closed){window.clearInterval(P);t("Window or Frame is closed before completion");return}ca=b.location.href;ta=b.location.hash}catch(Na){}ca&&"about:blank"!==ca&&ta&&""!==ta&&(window.clearInterval(P),k(ta))}},50)})}}kn.NBk={["smartlookup"]:"4d5c2d63-cf83-4365-853c-925fd1a64357",["search"]:"a9b49b65-0a12-430b-9540-c80b3332c127"};Object(n.a)(kn,"OAuthHelper",null,[]);class Ei{constructor(b,
k){this.token=b;this.source=k}}Object(n.a)(Ei,"TokenResult",null,[]);var al=c(111),ph=c(288);class qf{constructor(){this.Q8=null;this.wTg={};this.tokenCache=new Ia.a(Ja.a.ei())}getToken(b,k,t=!1){if(this.tokenCache.nb(k))return this.tokenCache.J(k).getToken();const D=new yk(()=>t?this.Vhi(b,k):this.zSd(b,k));this.tokenCache.Z(k,D);return D.getToken()}Dem(b,k,t=!1){if(this.tokenCache.nb(k))return this.tokenCache.J(k).Uhi();const D=new yk(()=>t?this.Vhi(b,k):this.zSd(b,k));this.tokenCache.Z(k,D);return null}zSd(b,
k){const t=Date.now();return kn.Gem(b,k).then(D=>new Ei(D,"SSOStack")).then(D=>new Promise(P=>{D.token&&""!==D.token?(v.ULS.sendTraceTag(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",b,D.source,Date.now()-t),this.Xnb("GetTokenInternal",!0,Date.now()-t,b,"","",k),P(D.token)):(v.ULS.sendTraceTag(593862978,1300,50,"{0}: SSO Token provider failed! Latency: {1}",b,Date.now()-t),this.Xnb("GetTokenInternal",!1,Date.now()-t,b,"GetTokenSilent Failed","SSO Token provider failed!",k),P(""))}))}Vhi(b,
k){if(!this.Q8)try{this.Q8=Fa.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(t){v.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+t)}return this.Q8?new Promise(t=>{const D=Date.now();this.Q8.PY(b,k).then(P=>{const ca=P.Token;!P.IsSuccess||this.fSm(ca)?(this.Xnb("GetTokenInternalImplicitJS",!1,Date.now()-D,b,P.ErrorCode,P.ErrorMessage,k),t(null)):(this.Xnb("GetTokenInternalImplicitJS",!0,Date.now()-D,b,P.ErrorCode,P.ErrorMessage,k),t(ca))}).catch(P=>{P=P?G.c(P):"";
this.Xnb("GetTokenInternalImplicitJS",!1,Date.now()-D,b,"Caught Exception",P,k);t(null)})}):new Promise(t=>{this.Xnb("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");t(null)})}Xnb(b,k,t,D,P="",ca="",ta=""){var Na="Search"===D;const qb=[];b=al.a.vga(Na?"Event":"EventName",b,2);D=al.a.vga("AppName",D,2);Array.add(qb,b);Array.add(qb,D);Na&&(D=al.a.vga("LatencyType","FetchToken",2),Array.add(qb,D));P&&""!==P&&(P=al.a.vga("ErrorCode",P,2),Array.add(qb,P));ca&&""!==ca&&(ca=
al.a.vga("ErrorMessage",ca,2),Array.add(qb,ca));ta&&""!==ta&&(ca=!(ta in this.wTg),this.wTg[ta]=ca,ca=al.a.vga("WarmUpCall",ca.toString(),1),Array.add(qb,ca),ta=al.a.vga("Service",this.Eam(ta),2),Array.add(qb,ta));Na=Na?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";k=Object.assign(new ph.a,{name:Na,samplingPolicy:2,dataFields:qb,succeeded:k,durationMs:t});ea.a.sendActivityEvent(k)}Eam(b){return b===w.AFrameworkApplication.dLf?"Loki":b===w.AFrameworkApplication.Jgg?
"Substrate":w.AFrameworkApplication.K&&b===w.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}fSm(b){return!b||!b.length}}Object(n.a)(qf,"SearchOAuthManager",null,[658]);class lj{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}xc(b){this.W=b;this.W.register(658,"Common.App.SearchCommon.ISearchOAuthManager").singleInstance().Rd(()=>new qf)}init(){}dispose(){}static main(){N.a.instance.Fc(new lj)}}Object(n.a)(lj,"SearchOAuthPackage",null,
[1,2]);var Ph=c(223),ze=c(5),Be=c(18),hf=c(17),pe=c(8);class jm{constructor(b,k,t){this.hLe=this.Lwb=this.eLe=this.Kwb=this.SHe=null;this.blm=D=>{try{this.alm(D)}catch(P){D=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",P.message,P.stack),v.ULS.sendTraceTag(5285580,334,10,D)}};this.Rp=b;this.I0j=k;this.ib=t;this.init()}init(){this.I0j.lb(this.blm);this.Kwb=new bc.a;this.eLe=new bc.a;this.Lwb=new bc.a;this.hLe=new Ph.a}Q4(b){this.Kwb.add(b.key,
b)}Pgc(b){this.Lwb.add(b.key,b)}alm(b){let k;const t=this.ib.hb.kb;({Ybf:k}=jm.yMo(t)).returnValue&&(b=jm.sQl(b,this.SHe,k),this.hGn(b,k,t),this.SHe=k)}hGn(b,k,t){b=this.bKl(b,k,t);let D;({notification:D}=jm.pMo(b)).returnValue&&this.Rp.sendNotification(D,!1)}bKl(b,k,t){const D=new bc.a;D.Z(1,new Ph.a);D.Z(0,new Ph.a);b.forEach(P=>{3===P?(jm.gdg(k.node)||this.n3n(k,t),this.D5l(D,k)):P||this.QQl(D,k);return!0});return D}n3n(b,k){this.Kwb.forEach((t,D)=>{D.reset(b,k);return!0})}QQl(b,k){let t=new bc.a;
jm.gdg(k.node)||(t=this.OQl(k.cpBegin));this.PQl(b,this.eLe,t,jm.vhj(this.SHe,k));this.eLe=t}OQl(b){const k=new bc.a;this.Kwb.forEach((t,D)=>{t=null;({RF:t}=D.rIa(b)).returnValue&&k.Z(D.key,t);return!0});return k}PQl(b,k,t,D){const P=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;k.forEach((ca,ta)=>{const Na=this.Kwb.J(ca).Pw||ta.title;let qb;({value:qb}=t.Dc(ca)).returnValue?D&&qb.contentObject!==ta.contentObject&&(Na&&b.J(1).add(Na),ca=this.Kwb.J(ca).Pw,ca=String.format(P,qb.title,ca),qb.description&&
(ca+=", "+qb.description),b.J(0).add(ca)):Na&&b.J(1).add(Na);return!0});t.forEach((ca,ta)=>{k.nb(ca)||(ca=this.Kwb.J(ca).Pw,ca=String.format(P,ta.title,ca),ta.description&&(ca+=", "+ta.description),b.J(0).add(ca));return!0})}D5l(b,k){k=this.Ubm(k.node);k=this.yZk(k);this.Vbm(b,this.hLe,k);this.hLe=k}Ubm(b){const k=new ze.GraphIterator;k.set(b);if(!k.zb(1))return null;const t=new Ph.a;for(;1!==k.We;)this.Lwb.forEach((D,P)=>{let ca;({nma:ca}=P.Rlc(k)).returnValue&&t.add(ca);return!0}),k.uc();t.reverse();
return t}yZk(b){b=b.toArray();let k=0;for(;k<b.length-1;){var t=b[k];if(t.KG===b[k+1].KG&&(this.Lwb.J(t.KG),({BZk:t}={returnValue:!1,BZk:null}).returnValue)){b.splice(k,2,t);continue}k++}return new Ph.a(b)}Vbm(b,k,t){var D;for(D=0;D<Math.min(t.length,k.length)&&t.J(D).contentId.equals(k.J(D).contentId);D++){var P=this.Lwb.J(t.J(D).KG).KDb(t.J(D),k.J(D));P&&(t.J(D).description&&(P+=", "+t.J(D).description),b.J(0).add(P))}for(P=D;P<t.length;P++){let ca=this.Lwb.J(t.J(P).KG).KDb(t.J(P),null);ca&&(t.J(P).description&&
(ca+=", "+t.J(P).description),b.J(0).add(ca))}for(t=D;t<k.length;t++)(D=this.Lwb.J(k.J(t).KG).Pw)&&b.J(1).add(D)}static sQl(b,k,t){const D=new Ph.a;(b=b||jm.Kao(k,t))?(D.add(3),D.add(0)):jm.vhj(k,t)&&D.add(0);return D}static Kao(b,k){return!b||!b.node.id.equals(k.node.id)}static vhj(b,k){return!b||!b.equals(k)}static yMo(b){let k=null;if(!b||!(hf.SelectionEditor.km(b)||(b=hf.SelectionEditor.Cj(b,!0,!1),hf.SelectionEditor.km(b)||b.Qa&&jm.gdg(b.Qa.node))))return{returnValue:!1,Ybf:k};k=b.Qa;return{returnValue:!!k,
Ybf:k}}static pMo(b){const k=new Ph.a;b.J(1).forEach(t=>{t=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,t);k.add(t);return!0});b.J(0).forEach(t=>{t=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,t);k.add(t);return!0});b=k.toArray().join(" ");return{returnValue:0<k.length,notification:b}}static gdg(b){return Be.ImageReader.gv(b)||pe.ParagraphReader.lua(b)}}Object(n.a)(jm,"AccessibilityContextManager",null,[650]);class rk{constructor(b,k){this.F1g=
!1;this.kAc=null;this.Ptd=this.mxd=!1;this.TSg=null;this.Tzd=(t,D)=>{(D.XR||D.$pa)&&this.rgn(D.XR,D.$pa)};this.Hb=b;this.rN=k}get tpm(){return!!this.kAc}lb(b){this.F1g||(this.rN.Dph(this.Tzd),this.F1g=!0);this.TSg=b}rgn(b,k){this.tpm&&this.Hb.Ve(this.kAc);this.mxd=this.mxd||b;this.Ptd=this.Ptd||k;this.kAc=new Df.a(5,1,rk.Rvl,()=>{this.TSg(this.mxd,this.Ptd);this.reset()},126);this.Hb.Vb(this.kAc)}reset(){this.kAc=null;this.Ptd=this.mxd=!1}}rk.Rvl=100;Object(n.a)(rk,"EditingViewOnAfterValidateEventsConsolidator",
null,[649]);var af=c(46);class Cf{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){Wa.App.Duh&&this.W.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}xc(b){this.W=b;b.ha("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new rk(w.AFrameworkApplication.nc,b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").singleInstance();b.ha("Box4.Accessibility.AccessibilityContextManager",
()=>new jm(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),af.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").singleInstance()}static main(){N.a.instance.Fc(new Cf)}}Object(n.a)(Cf,"Box4AccessibilityPackage",null,[1,2]);var Hi=c(177),Cn=c(1050),zh=c(1629),zr=c(888),Hj=c(171),yo=c(1515),Xd=c(43),Gf=c(23),re=c(121),Of=c(28),Pb=c(3);class gk extends yo.a{get qwa(){return null!=this.yCg?this.yCg:this.yCg=Fa.a.instance.Na("Box4.IInternalLinkManager")}get k1i(){return null!=
this.uFg?this.uFg:this.uFg=Fa.a.instance.Na("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get QC(){return!0}get commandId(){return Pb.a.eHk}Ima(b){Hj.a.mark(7012);const k=new Xd.GraphTransaction(15);k.Cb(b);var t=this.EG,D=this.l0,P=pe.ParagraphReader.text(b),ca=P.substring(t,D);const ta=({uZc:Na}=F.a.sgg(ca)).returnValue;ca!==ta&&(t+=Na,D=t+ta.length);ca=Of.a.createTextRange(b,t,D);var Na=P.substring(t,D);gk.UKm(P,t,D)&&(this.Kd.replaceTextRange(Of.a.createTextRange(b,t-1,D+1),Na,!0,!1),
--t,--D,ca=Of.a.createTextRange(b,t,D),t=Gf.SelectionFactory.te(b,D),af.a.instance.setSelection(t));t=re.HyperlinkReader.dPa(Na);gk.hyperlinkEditor.hG(ca,t,!1);P=Na="";D=!1;this.qwa&&({y4f:Na,lDb:P}=this.qwa.wkg(t)).returnValue&&(t=Na,D=!0,Na=re.HyperlinkReader.MD(ca,!1),gk.hyperlinkEditor.CR(Na[0].paragraph,Na[0].hyperlink),""!==P&&(this.Kd.replaceTextRange(ca,P,!0,!1),ca=Of.a.createTextRange(b,this.EG,this.EG+P.length),b=Gf.SelectionFactory.te(b,this.EG+this.EG+P.length),af.a.instance.setSelection(b)),
gk.hyperlinkEditor.hG(ca,t,!1));k.dispose();!D&&this.k1i&&this.k1i.YCn(ca,t);Hj.a.mark(7013)}set QC(b){super.QC=b}static get hyperlinkEditor(){return null!=gk.yAg?gk.yAg:gk.yAg=Fa.a.instance.resolve("Box4.IHyperlinkEditor")}static UKm(b,k,t){t=t!==b.length&&('"'===b.charAt(t)||"\u201d"===b.charAt(t));return!!k&&('"'===b.charAt(k-1)||"\u201c"===b.charAt(k-1))&&t}}Object(n.a)(gk,"HyperlinkAction",yo.a,[]);class Al{constructor(b){this.Kd=b}Y9k(b,k,t){return new gk(null,b,k,t,this.Kd)}}Object(n.a)(Al,
"HyperlinkActionFactory",null,[645]);var Yj=c(234);class No{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}xc(b){this.W=b;b.ha("Box4.AutoCorrect.AutoCorrectRules",()=>new zh.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),Yj.a.instance,w.AFrameworkApplication.va,w.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectOptionsInfo",
()=>new Cn.a(b.resolve("Box4.IRoamingServiceRequestManager"),w.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectScheduler",()=>new zr.a(b.resolve("Box4.IAutoCorrectRules"),af.a.instance,Hi.a.instance,w.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").singleInstance();
b.ha("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new Al(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").singleInstance()}init(){this.W.resolve("Box4.IAutoCorrectRules").$Ym();const b=w.AFrameworkApplication.K;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.W.resolve("Box4.IAutoCorrectOptionsInfo").ILl()}dispose(){}static main(){N.a.instance.Fc(new No)}}Object(n.a)(No,"Box4AutoCorrectPackage",null,[1,2]);class Xo{get name(){return"Box4.Clipboard"}init(){}dispose(){}xc(){}static main(){N.a.instance.Fc(new Xo)}}
Object(n.a)(Xo,"Box4ClipboardPackage",null,[1,2]);class op{get name(){return"Box4.ImageEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new op)}}Object(n.a)(op,"Box4ImageEditorsPackage",null,[1,2]);var Gp=c(615),go=c(869),zo=c(594),tb=c(820),Bc=c(1140);class qd{constructor(){this.ChangeStateList=this.Revision=null}static construct(b,k,t,D,P){const ca=new qd;ca.DocumentId=P;ca.UserId=t;ca.WACSessionId=D;ca.Revision=b;ca.ChangeStateList=Bc.a.pij(k);return ca}}Object(n.a)(qd,"LocalUnsavedChange",
null,[]);class xe{constructor(){this.d2d=null}vne(b){return new Promise((k,t)=>{this.uKh().then(D=>{const P=D.transaction(xe.HXc,"readwrite");P.objectStore(xe.HXc).put(b);P.oncomplete=()=>k();P.onerror=()=>t(P.error.message)}).catch(t)})}HDd(b,k,t){return new Promise((D,P)=>{this.uKh().then(ca=>{const ta=ca.transaction(xe.HXc,"readwrite");ta.objectStore(xe.HXc).delete([b,k,t]);ta.oncomplete=()=>D();ta.onerror=()=>P(ta.error.message)}).catch(P)})}static isSupported(){return"indexedDB"in window}uKh(){return new Promise((b,
k)=>{if(xe.isSupported())if(this.d2d)b(this.d2d);else{var t=window.indexedDB.open(xe.b_m,xe.c_m);t.onsuccess=()=>{this.d2d=t.result;b(t.result)};t.onerror=()=>{k(t.error.message)};t.onupgradeneeded=()=>{const D=t.result,P=D.createObjectStore(xe.HXc,{keyPath:["DocumentId","UserId","WACSessionId"]});P.createIndex("DocumentId, UserId",["DocumentId","UserId"],{unique:!1});P.createIndex("UserId",["UserId"],{unique:!1});this.d2d=D;b(D)}}else k("This browser does not support IndexedDB.")})}}xe.b_m="LocalUnsavedChangeDatabase";
xe.c_m=1;xe.HXc="LocalUnsavedChange";Object(n.a)(xe,"LocalUnsavedChangeStore",null,[]);class Ge{constructor(b,k,t,D,P,ca){this.bIi=b;this.hee=k;this.Vbi=t;this.vPd=D;this.uTk=P;this.nya=ca}initialize(){const b=go.a.ptf(this.Vbi());this.lHd=this.tIc=b;this.nya.dxk(this.bWi.bind(this));this.nya.exk(this.cWi.bind(this))}dispose(){this.nya.p_n(this.bWi.bind(this));this.nya.q_n(this.cWi.bind(this))}bWi(b,k){this.lUo(k.ISa)}cWi(b,k){this.YQo(k.ISa)}YQo(b){b.equals(this.tIc)||(this.tIc=b,b.equals(this.lHd)?
this.HDd():this.vne())}lUo(b){b.equals(this.lHd)||(this.lHd=b,b.equals(this.tIc)?this.HDd():this.vne())}R$k(){const b=new tb.a(this.lHd,this.tIc,this.Vbi(),this.vPd().rr,this.vPd().pnb,this.vPd().contextId,this.tIc.id,this.hee,zo.FolderReader.vjb(this.vPd()),!1);return qd.construct(b,this.uTk.CNc(),Ge.userId,Ge.sessionId,Ge.documentId)}vne(){const b=this.R$k();this.bIi.vne(b).then(()=>{v.ULS.sendTraceTag(509366736,306,50,"Successfully updated local unsaved change with LatestRevision: {0}",b.Revision.Id)}).catch(k=>
{v.ULS.sendTraceTag(509366735,306,10,"Failed to update local unsaved change because {0}",k)})}HDd(){this.bIi.HDd(Ge.documentId,Ge.userId,Ge.sessionId).then(()=>{v.ULS.sendTraceTag(509366734,306,50,"Successfully clear local unsaved change.")}).catch(b=>{v.ULS.sendTraceTag(509366733,306,10,"Failed to clear local unsaved change because {0}",b)})}static isSupported(){return xe.isSupported()&&null!=this.documentId&&null!=this.userId&&null!=this.sessionId}static get documentId(){return null!=Ge.Kxg?Ge.Kxg:
Ge.Kxg=w.AFrameworkApplication.sessionStartInfoSettings.ServerDocId}static get userId(){return null!=Ge.QIg?Ge.QIg:Ge.QIg=w.AFrameworkApplication.K.jb("LoggableUserId")}static get sessionId(){return null!=Ge.ZFg?Ge.ZFg:Ge.ZFg=w.AFrameworkApplication.K.jb("SessionId")}}Object(n.a)(Ge,"LocalUnsavedChangeManager",null,[648]);class gf{get name(){return"Box4.LocalUnsavedChange"}init(){this.uvi()&&Ge.isSupported()&&(this.UJf=this.container.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeManager"),this.UJf.initialize())}dispose(){this.UJf&&
this.UJf.dispose()}xc(b){this.container=b;if(this.uvi()){b.ha("Box4.LocalUnsavedChange.LocalUnsavedChangeStore",()=>new xe).singleInstance();var k=(t,D,P)=>new Gp.a(t,D,P);b.ha("Box4.LocalUnsavedChange.LocalUnsavedChangeManager",()=>new Ge(b.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeStore"),k,()=>Wa.App.ya.gb.Uc.od,()=>Wa.App.ya.gb.Uc,b.resolve("Box4.CatchUpActivity.IChangeStateManager"),b.resolve("Box4.Revision.RevisionSequenceNumberManager"))).singleInstance()}}static main(){N.a.instance.Fc(new gf)}uvi(){return w.AFrameworkApplication.K.$("DisconnectedScenarioIsEnabled")}}
Object(n.a)(gf,"LocalUnsavedChangePackage",null,[1,2]);class uf{get name(){return"Box4.NotebookLevelEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new uf)}}Object(n.a)(uf,"Box4NotebookLevelEditorsPackage",null,[1,2]);var ff=c(1527),qj=c(33),wg=c(131),sh=c(767),lc=c(12);const Li=(b,k,t,D,P)=>{if(k.contextId===lc.a.view)switch(b){case Pb.a.search:return qj.Debug.Tuh(509109570),Wa.App.eN.elj(),32;case Pb.a.findOnPage:return 1!==t&&(qj.Debug.Tuh(509109571),Wa.App.eN.Yag()),32;case Pb.a.Lcj:return Wa.App.ya.gb.wc&&
Wa.App.ya.gb.wc.Vi?(1!==t&&(sh.a.zNb?Wa.App.eN.S3n():Wa.App.eN.Yag()),b=32):b=8,b;case Pb.a.dAb:case Pb.a.JAh:return 1===t?b=sh.a.zNb?32:8:(Wa.App.eN.S3n(),b=32),b;case Pb.a.U$d:return 1!==t&&Wa.App.eN.YSd(),32;case Pb.a.l2i:return(b=$d.a.DOa(document.body.ownerDocument))&&b.id===wg.AppFrame.Bgj&&Wa.App.eN.YSd(),32;case Pb.a.h5d:return 1!==t&&Wa.App.eN.XSd(),32;case Pb.a.LPi:return(b=$d.a.DOa(document.body.ownerDocument))&&b.id===wg.AppFrame.Bgj&&Wa.App.eN.XSd(),32;case Pb.a.hkj:return Wa.App.eN.akp(),
32;case Pb.a.X4c:return Wa.App.eN.X4c(),32;case Pb.a.fyf:return 1!==t&&"string"===typeof P&&Wa.App.eN.fyf(P),32;case Pb.a.lgj:return 1!==t&&Wa.App.eN.Yag(),32;case Pb.a.mgj:return 1!==t&&Wa.App.eN.elj(),32;case Pb.a.ymh:return Wa.App.eN.Mep(),32;case Pb.a.Dgj:return Wa.App.eN.elj(),"string"===typeof P&&(Wa.App.eN.cJn(P),sh.a.zNb=!0),32;case Pb.a.ULd:return Wa.App.eN.Yag(),"string"===typeof P&&(Wa.App.eN.cJn(P),sh.a.zNb=!0),32}return 2};class ld{get name(){return"Box4.Search"}xc(b){b.ha("Box4.Search.FindManagerHelper",
()=>ff.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").singleInstance()}init(){w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableSearchActor",!1)||Gb.a.u3c(Li)}dispose(){}}Object(n.a)(ld,"PackageManager",null,[1,2]);class ej{get name(){return"Box4.TableEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new ej)}}Object(n.a)(ej,"Box4TableEditorsPackage",null,[1,2]);class bl{get name(){return"Box4.TextLevelEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new bl)}}
Object(n.a)(bl,"Box4TextLevelEditorsPackage",null,[1,2]);var jd=c(112),th=c(354),vd=c(145),rj=c(610),fj=c(1540);class Mh{constructor(b,k,t){this.Tv=this.eKa=this.qMa=null;this.mE=this.Ywe=this.vJa=0;this.Bka=this.amd=this.VVa=this.UVa=!1;this.Kkd=this.VYg=this.YYg=0;this.FAa=b;this.ga=k;this.Vm=t}XO(b){return!Wa.App.ya.gb.isEditingAllowed||$b.SessionStatusManager.instance.wj?!1:""!==this.dOc(b.zf)}hL(b){if(!this.XO(b))return!1;this.nho(b);this.mE=this.FAa.h7b();this.eko(b);this.fko();({qac:this.amd,
Mbc:this.Bka}=this.Jlj(this.Ywe));this.gko();this.qMa=b.WH;this.Tv=new Sys.UI.Point(0,0);[this.YYg,this.VYg]=this.FAa.getDimensions();v.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}DU(b){this.eKa=b.WH;this.aPk();this.Kkd=fj.b(this.Tv.x,this.Tv.y,this.YYg,this.VYg,this.amd,this.Bka,this.Kkd,w.AFrameworkApplication.K.$("SmoothImageHelperGetScaleIsEnabled"));this.FAa.Fmg(this.Kkd,this.amd,this.Bka);return!0}ZD(){this.setSize();v.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}qY(){this.FAa.o7f();
v.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}nho(b){this.FAa=jd.a.Db(b.zf,rj.a)}fko(){this.Ywe=(Math.floor((this.mE+22)/45)%8+this.vJa)%8}Jlj(b){let k,t;if(this.mE&&90!==this.mE&&180!==this.mE&&270!==this.mE&&360!==this.mE||this.YKm(b))return{qac:!0,Mbc:!0};k=t=!1;switch(b){case 1:case 5:k=!0;break;case 3:case 7:t=!0}return{qac:t,Mbc:k}}gko(){this.VVa=this.UVa=!1;switch(this.Ywe){case 0:this.VVa=this.UVa=!0;break;case 1:case 2:this.VVa=!0;break;case 7:case 6:this.UVa=!0}}YKm(b){return!(b%
2)}dOc(b){var k=b.classList.toString();-1===k.indexOf("WACImageResizeHandle")&&b.parentNode&&(k=b.parentNode.classList.toString());b=k.split(" ");for(k=0;k<b.length;k++){const t=b[k].toString();if(t.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==t)return t}return""}eko(b){switch(this.dOc(b.zf)){case "WACImageResizeHandleNW":this.vJa=0;break;case "WACImageResizeHandleN":this.vJa=1;break;case "WACImageResizeHandleNE":this.vJa=2;break;case "WACImageResizeHandleE":this.vJa=3;break;case "WACImageResizeHandleSE":this.vJa=
4;break;case "WACImageResizeHandleS":this.vJa=5;break;case "WACImageResizeHandleSW":this.vJa=6;break;case "WACImageResizeHandleW":this.vJa=7}}aPk(){var b=1;this.Vm.instance&&(b=this.Vm.instance.ij);const k=(this.eKa.x-this.qMa.x)/b;b=(this.eKa.y-this.qMa.y)/b;this.Tv.x=this.UVa?-k:k;this.Tv.y=this.VVa?-b:b}setSize(){const b=new th.DictionaryPropertySet;b.setValue(vd.a.ORc,100*this.Kkd);b.setValue(vd.a.Noi,!0);if(90===this.mE||270===this.mE){let k,t;({qac:k,Mbc:t}=this.Jlj(this.vJa));b.setValue(vd.a.Nyf,
k);b.setValue(vd.a.Oyf,t)}else b.setValue(vd.a.Nyf,this.amd),b.setValue(vd.a.Oyf,this.Bka);this.ga.Qb(Pb.a.J9b,2,b)}}Object(n.a)(Mh,"ImageResizeDragAdapter",null,[143]);var Ef=c(123),hk=c(874);class $h{constructor(b,k,t,D){this.CDe=this.eKa=this.qMa=this.jtd=null;this.fqd=this.Uxd=0;this.Fb=null;this.ga=b;this.ib=k;this.Vm=t;this.H4g=this.rBa=0;this.fd=D}XO(b){return Wa.App.ya.gb.isEditingAllowed&&!$b.SessionStatusManager.instance.wj&&b&&this.BPm(b.zf)?(this.jtd=this.ib.sg)?!0:!1:!1}pMd(){}qtf(){return null}hL(b){if(!this.XO(b))return!1;
this.FAa=jd.a.Db(b.zf,rj.a);if(!this.FAa)return!1;this.Htd=this.FAa.B9;if(!this.Htd)return!1;this.jtd=this.ib.sg;this.Fb=Be.ImageReader.Ym(this.jtd);if(!this.Fb)return!1;this.qMa=this.LOa(b);this.CDe=Sys.UI.DomElement.getBounds(this.Htd);this.Uxd=0<Be.ImageReader.FPd(this.Fb)?Be.ImageReader.FPd(this.Fb):0;this.fqd=Be.ImageReader.Fqf(this.Fb);return!0}DU(b){this.eKa=this.LOa(b);this.iPk();if(this.FAa)return this.FAa.Hne(this.rBa,this.H4g),!0;v.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");
return!1}ZD(){this.Uxd=this.rBa=fj.c(this.rBa);this.d5()}qY(){this.FAa.Hne(this.fqd,0)}BPm(b){return b.classList.contains(hk.c)||b.classList.contains(hk.b)||b.classList.contains(hk.a)||!!b.parentElement&&b.parentElement.classList.contains(hk.a)}LOa(b){return this.fd.Bd.G0a(b)}iPk(){var b=1;this.Vm&&this.Vm.instance&&(b=this.Vm.instance.ij);var k=new Sys.UI.Point(this.CDe.x+this.Htd.clientWidth/2*b,this.CDe.y+this.Htd.clientHeight/2*b);b=fj.a(this.qMa,k);k=fj.a(this.eKa,k);this.rBa=Math.round(Ef.a.gLn(k-
b));0<this.Uxd&&(this.rBa+=this.Uxd-this.fqd);this.H4g=this.rBa;this.rBa+=this.fqd}d5(){const b=new th.DictionaryPropertySet;b.setValue(vd.a.LRc,0);b.setValue(vd.a.jJ,this.rBa);this.ga.Qb(Pb.a.imageRotate,2,b)}}Object(n.a)($h,"ImageRotateDragAdapterSimplified",null,[639,143]);class km{constructor(){this.W=null}get name(){return"Box4.Images"}xc(b){this.W=b;this.W.ha("Box4.Images.ImageResizeDragAdapter",()=>new Mh(null,w.AFrameworkApplication.va,Fa.a.instance.Sa("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").singleInstance();
this.W.ha("Box4.Images.ImageRotateDragAdapterUpdated",()=>new $h(w.AFrameworkApplication.va,af.a.instance,Fa.a.instance.Sa("Common.IZoomManager"),Lb.InteractiveViewManager.instance)).as("Box4.Images.IImageRotateDragAdapter").singleInstance()}init(){this.W.resolve("Box4.Images.IImageResizeDragAdapter");this.W.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){N.a.instance.Fc(new km)}}Object(n.a)(km,"Box4ImagesPackage",null,[1,2]);var de=c(311),ke=c(116),Cc=c(6),Rh=c(681),Bi=c(453),
sn=c(568),uh=c(251),Wh=c(258),Dn=c(1753),Lk=c(1806),pp=c(1194);class fm extends Lk.a{constructor(b,k,t){super(b,k,t);this.hrd=this.Vcb=null}get HR(){return w.AFrameworkApplication.ta.Fq}UOd(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}moe(b){return fm.oza(b,this.Aii())}Aii(){return fm.vWe}oza(b,k=null){b=this.moe(b);return 0!==b?(k&&k.Uyd(),2===b&&(k=this.UOd(b),this.yp(this.M7h(b),k)),!1):
!0}tOa(b,k){v.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.oWf=k;Hj.a.mark(5576);this.hrd=this.HR.Zf("LoadResource","PictureUploadTime");this.AWd()?this.zde(b):this.S_c()}yp(b,k){const t=new Uc.StandardDialog;t.Ad=0;t.ix(b,CommonUIStrings.l_ImageUploadFailedTitle,k,null)}S_c(){v.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.S_c();this.hrd&&(this.hrd.stop(),this.hrd=null)}K6a(){this.Vcb=(new pp.a).create();this.Vcb.message=CommonUIStrings.l_ImageUploadWait;
this.Vcb.Ad=5;this.Vcb.rt=!1;this.Vcb.oL(null,null,null)}A2b(){this.Vcb&&(this.Vcb.close(),this.Vcb=null)}static Ipm(b,k){b=F.a.Tg(b);for(let t=0;t<k.length;++t)if(b.endsWith(k[t]))return!0;return!1}static oza(b,k=null){k||(k=fm.vWe);return b?fm.Ipm(b,k)?0:2:1}}fm.vWe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(n.a)(fm,"PictureUploader",Lk.a,[]);var Ag=c(353),We;(function(b){b[b.validPicture=0]="validPicture";b[b.noPictureSpecified=1]="noPictureSpecified";b[b.invalidExtension=2]="invalidExtension";
b[b.pictureTooLarge=3]="pictureTooLarge"})(We||(We={}));Object(n.b)("PictureValidationResult",We);var Re=c(53),sf=c(15),zi=c(42);class En{constructor(){this.MT=null}}Object(n.a)(En,"ImageData",null,[]);var zk=c(51),Ao=c(1754),$n=c(1597),mj=c(1634);class kc extends Wf.a{constructor(b,k=!0){super(!1,!1,kc.vL);this.XXb=null;this.GUg=!1;this.ay=[];this.ys=null;this.Xcb=b;this.Khk=k;this.A$=this.Bhh=!1;this.AYa=null;this.iAe=!1;this.Xg=this.gll;this.vg="InsertFileDialog";this.Ee(1,this.lyd);kc.vL?(this.XXb=
{["id"]:this.vg,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:Object(A.a)(this,this.Ctn,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(A.a)(this,this.xmn,"onFrameReady")},this.Wh(this.titleText,Object(A.a)(this,this.qWd,"insertDialogHandler"),this.XXb),this.IV=!0):(this.showDialog(this.titleText,Object(A.a)(this,this.qWd,"insertDialogHandler")),k&&this.rmo(),(b=this.MNd(1))&&this.ay.push(b),
(b=this.MNd(0))&&this.ay.push(b),this.vFj(),this.IV=!1)}get mHj(){return this.Xcb}validate(){this.ys.MT||v.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.ys.MT.value?!0:(kc.ix(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}xmn(b){this.Khk&&(this.ys=this.Mmj(b,this.Xcb))}Ctn(){this.ys&&this.ys.MT&&(this.GUg||(this.ys.GUn(Object(A.a)(this,this.DTf,"onFileChosen")),this.GUg=!0),this.ys.PYh())}DTf(b){this.XXb.uploadStatusLabel=b;this.C5(this.titleText,Object(A.a)(this,
this.qWd,"insertDialogHandler"),this.XXb)}qWd(b){1===b&&this.isEnabled()?kc.vL&&this.ys.MT&&!this.ys.MT.value?(this.XXb.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.C5(this.titleText,Object(A.a)(this,this.qWd,"insertDialogHandler"),this.XXb)):(this.bVd(),this.Xcb.tOa(this.ys,Object(A.a)(this,this.dispose,"dispose"))):0===b&&this.hide()}rmo(){this.iAe=!1;this.ys=this.Mmj(document.getElementById("uploadFrameContainer"),this.Xcb);w.AFrameworkApplication.K.$("InsertPictureDialogFocusLoopFixIsEnabled")&&
(this.AYa=Object(A.a)(this,this.pWf,"onUploadFrameLoad"),vf.a.addHandler(this.ys.iFrame,"load",this.AYa));this.ys.MT||v.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.W2i()}pWf(){this.W2i()}W2i(){if(this.ys&&!this.iAe){var b=this.ys.MT;b&&(vf.a.addHandler(b,Rc.a.hi,Object(A.a)(this,this.onKeyDown,"onKeyDown")),b=[b],this.ay=b.concat.apply(b,this.ay),this.vFj(),this.iAe=!0)}}dispose(){if(this.ys&&!kc.vL){const b=this.ys.MT;b&&vf.a.removeHandler(b,Rc.a.hi,Object(A.a)(this,
this.onKeyDown,"onKeyDown"));this.AYa&&vf.a.removeHandler(this.ys.iFrame,"load",this.AYa)}this.ys=null;super.dispose()}vFj(){if(0<this.ay.length){const b=new ce(this.ay),k=ad.FocusManager.instance().Ps();k&&(this.ay[0].focus(),k.Zj=b,k.jR=!0)}}onKeyDown(b){4!==ad.FocusManager.instance().$2i(b)&&b.preventDefault()}static get vL(){return w.AFrameworkApplication.ta.Nb.nF&&w.AFrameworkApplication.ta.Nb.Uzi}static ix(b){const k=document.getElementById("errorText");k.innerText=b;k.style.display="inline-block"}}
Object(n.a)(kc,"InsertFileDialog",Wf.a,[]);class zm{static get Xg(){return Wf.a.lA(zm.Lm,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}zm.Lm="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(n.a)(zm,"InsertImageDialogHtml",null,[]);class Oc extends kc{constructor(b,
k=!0){super(b,k)}get lyd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get gll(){return zm.Xg}validate(){this.ys.MT||v.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(Ka.a)(fm,this.mHj);const k=b.moe(this.ys.MT.value);return 0!==k?(b=b.UOd(k),kc.ix(b),!1):!0}}Object(n.a)(Oc,"InsertImageDialog",kc,[]);class Fn extends Oc{constructor(b){super(b)}Mmj(b,k){const t=w.AFrameworkApplication.ta.Nb.nF&&w.AFrameworkApplication.ta.Nb.Uzi;
return new mj.a(b,Object(A.a)(k,k.Tec,"onUploadFrameInitialized"),Object(A.a)(k,k.gza,"uploadResponseReceived"),w.AFrameworkApplication.K,!t)}isEnabled(){return Fn.NO.ofa(this.mHj.context)}static get NO(){return null!=Fn.JAg?Fn.JAg:Fn.JAg=Fa.a.instance.resolve("Box4.Images.IImageEditor")}}Object(n.a)(Fn,"Box4InsertImageDialog",Oc,[]);class Zj{$4k(b){return new Promise((k,t)=>{this.a5k(b).then(D=>{k(D)},D=>{t(D)})})}sIh(b){return new Promise((k,t)=>{const D=new FileReader;D.addEventListener("load",
()=>{k(D.result)},!1);D.addEventListener("error",()=>{t("FileReader exception ("+D.error.name+")")});D.readAsDataURL(b)})}a5k(b){return new Promise((k,t)=>{this.sIh(b).then(D=>{this.U9e(D,"image/jpeg").then(P=>{k(P)},P=>{t(P)})},D=>{t(D)})})}U9e(b,k){return new Promise((t,D)=>{const P=new Image;P.addEventListener("load",()=>{const ca=document.createElement("canvas"),ta=ca.getContext("2d");ca.width=P.width;ca.height=P.height;ta.drawImage(P,0,0);t(ca.toDataURL(k))});P.addEventListener("error",()=>{D("Image failed to load")});
P.src=b})}}Object(n.a)(Zj,"ImageFormatConverter",null,[]);var Ul=c(393);const no=["ImageInsertFailed"];class ml extends fm{constructor(b,k,t,D,P,ca,ta=!0){super(b,k,t);this.CAa=this.Nl=this.YG=this.Fe=null;this.vLd="wwpicturesfc";this.kpiName="ImageFileExtension";this.Avc="LocalDeviceUpload";this.rha=new Map;this.VYh=0;this.Wcb=null;this.gAe="";this.Ura=0;this.Rp=null;this.puc="";this.J5g=50;this.gWg=this.zsc=this.ZAc=this.xxc=!1;this.C$j=19922944;this.V7g=0;this.kAe=[];this.FUg=[];this.W7g=0;this.hVf=
Na=>{v.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(Na){var qb={},Jb=this.YG?this.YG.properties.Pc.toString():this.Fe.Pc.toString();qb[Bi.a.nodeId]=this.YG?this.YG.id.toString():this.Fe.id.toString();qb[Bi.a.classId]=Jb;this.Vg.hasProperty(Cc.a.imageType)&&(qb[Rh.a.imageType]=this.Vg.getValue(Cc.a.imageType));this.Vg.hasProperty(Cc.a.kU)&&(qb[Rh.a.kU]=this.Vg.getValue(Cc.a.kU));this.Vg.hasProperty(ke.a.Wfa)&&(qb[Rh.a.Wfa]=this.Vg.getValue(ke.a.Wfa));this.Vg.hasProperty(Cc.a.Tkb)&&
(qb[Rh.a.Tkb]=this.Vg.getValue(Cc.a.Tkb));$n.d(Na,this.Fe,this.Nl,qb)&&(this.l9c(Na),ml.cec++)}else v.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")};this.gmn=Na=>{if(!this.lAf){var qb=this.e8h(this.ys);qb&&(this.gAe=qb.name,this.Ura=qb.size);if(!this.oza(Na,this.ys)||!this.Ung(qb,this.ys)){qb=Object.assign(new Db.a,{extendedProperties:new Map});qb.extendedProperties.set("type",this.oza(Na,this.ys)?"Image too large":"FileType invalid");this.x2d(qb);this.t2d();return}}this.tOa(this.ys,
null)};this.Vg=D;this.Jm=P;this.ga=ca;this.$h=Ag.a.getInstance(Ul.a);this.I4g=t.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.$5g=t.mc("ImageUploadMaxByteSize",Number.MAX_VALUE);ta&&this.showDialog();Wa.App.elc.addHandler(this)}get Exi(){return this.K.$("JfifImageInsertIsEnabled")}get aP(){return this.Avc}get fileExtension(){return this.gAe}get fileSize(){return this.Ura}get lHj(){return this.Wcb}get su(){return this.Rp||(this.Rp=Fa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get lAf(){return this.aP===
this.Avc}showDialog(){$n.a(this.K)?(this.y4b=!1,this.ys=new mj.a(document.body,Object(A.a)(this,this.Tec,"onUploadFrameInitialized"),Object(A.a)(this,this.gza,"uploadResponseReceived"),this.K,!1,void 0,!0)):$n.b()||this.EJb&&aa.a.LH?(this.y4b=!1,this.ys=new mj.a(document.body,Object(A.a)(this,this.Tec,"onUploadFrameInitialized"),Object(A.a)(this,this.gza,"uploadResponseReceived"),this.K,!1)):(this.y4b=!0,this.ys=(new Fn(this)).ys)}M7h(b){switch(b){case We.noPictureSpecified:return zk.a.noPictureSpecified;
case We.invalidExtension:return zk.a.MAm;case We.pictureTooLarge:return zk.a.OJf}return Bh.a.unknown}zde(b){this.lAf||(this.Fe.Bi()?(v.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),Ao.a.instance.ing(this.Fe.Bi()),this.Fe.Bi().contentReplicator.forceOutbound(this.hVf,Object(A.a)(this,this.CLb,"processFailure"),b)):this.CLb(b,157))}iOm(){return $n.c(this.Fe)}l9c(b){b.l9c();this.Wcb=b.Wcb}gza(b){this.VYh=+new Date-+this.lHj;this.t2d();v.ULS.sendTraceTag(36783364,322,50,
"Box4PictureUploader.UploadResponseReceived");$n.e(this,b,this.Fe)}NXo(){v.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.S_c();ml.cec--;this.ga.processAction($a.a.S7a,2);this.Fe?Ao.a.instance.smc(this.Fe.Bi(),0):v.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");this.su.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}CLb(b,k){var t;if(this.f6n(b))v.ULS.sendTraceTag(16798870,352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",
this.retryCount,k.toLocaleString());else{b=Object.assign(new Db.a,{extendedProperties:new Map});b.extendedProperties.set("result",k.toLocaleString());(null===(t=w.AFrameworkApplication.K)||void 0===t?0:t.$("ShouldLogPicturesExtendedHealthKpis"))?this.$h.logKpiFailure({kpiName:Ul.c.QEa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:{name:Ul.c.H9b,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,
isSessionEndingError:!1,additionalValues:b}}):xa.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",no,!1,!0,!1,!1,b);t=this.eif(k);v.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,k.toLocaleString());b=this.Fe.FH();var D=new Xd.GraphTransaction(15,Pb.a.WQ);D.Cb(this.Fe);ml.NO.VSa(this.Vg,t);ml.NO.i5f(this.Fe,this.YG);Be.ImageReader.Bkj(this.Vg);D.dispose();this.grj(t);this.Jm.y2b(b,!1);this.S_c();ml.cec--;Ao.a.instance.smc(this.Fe.Bi(),
k)}}grj(b){const k=new Uc.StandardDialog;k.Ad=0;k.ix(zk.a.invalidImageFile,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}eif(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}dOj(){if(this.puc&&0<this.puc.length){const b=new th.DictionaryPropertySet;b.setValue(vd.a.gP,this.puc);b.setValue(vd.a.b4,!0);this.ga.Qb(Pb.a.b_,2,b)}this.Mto()}Mto(){let b="";this.gWg?b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.xxc&&
this.zsc&&this.ZAc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.xxc&&this.zsc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.xxc&&this.ZAc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.ZAc&&this.zsc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.ZAc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.zsc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.xxc&&
(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.grj(b),this.ROj())}xuk(b){this.puc+=String.format('<img src="{0}"></img>',b);this.W7g++}b2m(){this.ZAc=!0;v.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new Db.a,{extendedProperties:new Map});b.extendedProperties.set("type","Image too large");this.x2d(b)}$1m(){this.zsc=!0;v.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");const b=Object.assign(new Db.a,{extendedProperties:new Map});
b.extendedProperties.set("type","Filetype invalid");this.x2d(b)}LIi(b){this.gWg=!0;v.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}Dzo(b){const k=new Zj;if(this.moe(b.name)===We.validPicture)return k.sIh(b);if(fm.oza(b.name,mj.a.wWe)===We.validPicture)return k.$4k(b)}i5k(b){return new Promise(k=>{const t=this.Dzo(b);void 0===t&&(this.LIi("Failed starting conversion work"),k());t.then(D=>{D.length>this.C$j?this.b2m():this.xuk(D);k()},D=>{this.LIi(D);
k()})})}PSm(b){return this.moe(b.name)===We.validPicture||fm.oza(b.name,mj.a.wWe)===We.validPicture}$zm(){const b=[];if(this.ys.MT.files){this.V7g=this.ys.MT.files.length;this.ys.MT.files.length>this.J5g&&(this.xxc=!0);this.K6a();for(let k=0;k<this.ys.MT.files.length&&this.J5g;k++){const t=this.ys.MT.files[k];this.kAe.push(t.name);this.FUg.push(t.size);t&&(this.PSm(t)?b.push(this.i5k(t)):this.$1m())}}Promise.all(b).then(()=>{this.A2b();this.dOj()});return!0}OAm(){this.Nl=lb.a.create();this.Vg||(this.Vg=
new th.DictionaryPropertySet);this.I4g&&this.CAa&&this.Vg.setValue(ke.a.$Hi,this.CAa);var b=480;let k=320;const t=this.context.view.rh.editingElement.clientWidth;0<t&&t<b&&(k=Math.floor(1*t/b*k),b=t,this.Vg.setValue(ke.a.Wfa,t));this.Vg.setValue(sf.a.uha,Re.a.Tl(b,0));this.Vg.setValue(sf.a.tha,Re.a.Tl(k,1));this.Vg.setValue(zi.a.O_,1);this.Vg.setValue(vd.a.b4,!0);this.Vg.setValue(Cc.a.Tkb,Box4Intl.Box4Strings.l_Picture);b=ml.NO.vSh(this.context,this.Vg,this.Nl);if(!b)return!1;this.Fe=b.node;this.Vg=
(this.YG=b.blob)?this.YG.properties:this.Fe.properties;Wa.App.rd.Yo&&Wa.App.rd.kq.rH(this.Fe);return!0}AWd(){return this.lAf?this.$zm():this.OAm()}ROj(){var b;this.rha.set("FileExtensions",this.CPl());this.rha.set("FileSizeInBytes",this.FUg.toString());this.rha.set("Source",this.aP);this.rha.set("NumberOfImagesAttemptedToInsert",this.V7g.toString());this.rha.set("NumberOfImagesPasted",this.W7g.toString());(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?
(this.rha.set("ErrorLevel","warning"),b=Object.assign(new Db.a,{extendedProperties:this.rha}),this.$h.logKpiFailure({kpiName:Ul.c.QEa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})):xa.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.vLd,this.rha)}CPl(){let b="";for(let k=0;k<this.kAe.length;++k)b=b+this.d8h(this.kAe[k])+",";return b}tOa(b,k){this.I4g&&(this.CAa=new En,this.CAa.MT=b.MT);super.tOa(b,k)}Tec(b){this.ys=b;if(!this.y4b){if(this.Yne){if($n.a(this.K)||
this.EJb&&aa.a.LH){b.RId(this.gmn);return}const k=b.RId(null),t=this.e8h(b);t&&(this.gAe=t.name,this.Ura=t.size);if(!this.oza(k,b)||!this.Ung(t,b)){b=Object.assign(new Db.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.oza(k,this.ys)?"Image too large":"FileType invalid");this.x2d(b);this.t2d();return}}this.tOa(b,null)}}SUd(){return!!ml.cec}t2d(){var b;this.rha.set("FileExtension",this.d8h(this.fileExtension));this.rha.set("Source",this.aP);this.rha.set("FileSizeInBytes",this.fileSize.toString());
this.rha.set("RequestTimeInMs",this.VYh.toString());(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?this.$h.logKpiUsage({kpiName:Ul.c.QEa,kpiType:0,optionalProperties:{extendedProperties:this.rha}}):xa.Health.instance.recordKpiUsage(this.kpiName,0,this.vLd,this.rha)}d8h(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}Aii(){return this.Exi?mj.a.tkh:fm.vWe}e8h(b){return(b=b.MT)?b.files[0]:null}Ung(b,k){return b&&b.size>this.$5g?
(k&&k.Uyd(),b=this.UOd(We.pictureTooLarge),this.yp(this.M7h(We.pictureTooLarge),b),!1):!0}UOd(b){switch(b){case We.noPictureSpecified:return CommonUIStrings.l_ImageUploadNoFileSpecified;case We.invalidExtension:return this.Exi?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case We.pictureTooLarge:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.$5g/1E6));default:return""}}x2d(b){var k;(null===(k=w.AFrameworkApplication.K)||
void 0===k?0:k.$("ShouldLogPicturesExtendedHealthKpis"))?(k={name:Ul.c.H9b,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","info"),this.$h.logKpiFailure({kpiName:Ul.c.QEa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:k})):xa.Health.instance.recordQosError("PictureFromLocalInvalid",no,!0,!0,!1,!1,b)}static get NO(){return null!=
ml.IAg?ml.IAg:ml.IAg=Fa.a.instance.resolve("Box4.Images.IImageEditor")}}ml.cec=0;Object(n.a)(ml,"Box4PictureUploader",fm,[737,480]);var Xp=c(827),Nh=c(132);class Og{constructor(){this.Es=this.sq=this.pwb=this.pih=this.med=this.aYj=null;this.APe=0;this.Kra=this.RKe=this.Ewb=null;this.vPg=0;this.Tse=this.wea=this.lHe=null;this.p_g=!1;this.Yre=this.Ure=this.Zre=null}get assetId(){return this.med}get thumbnailUrl(){return this.pih}get iFn(){return this.pwb}get displayName(){return this.Kra}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,
this.sq,this.Es)}get Iyk(){if(this.Ure&&this.Yre&&this.Zre){const b=document.createElement("a");b.setAttribute("href",this.Zre);b.setAttribute("target","_blank");b.innerText=this.Yre;return b}return null}get Jqh(){return this.Ure}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.vPg)}get WMn(){const b=document.createElement("span");var k=0;if(this.Ewb&&0<this.Ewb.length){var t=this.Ewb.indexOf("."),D=0>t?this.Ewb:this.Ewb.substring(0,t);for(D=Number.parseInvariant(D);k<
D&&5>k;k++)b.appendChild(od.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Nh.a.ug("box42.png"),"","",!0,""));0<t&&(t=Number.parseInvariant(this.Ewb.substr(t+1)),3>t?b.appendChild(od.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Nh.a.ug("box42.png"),"","",!0,"")):8>t?b.appendChild(od.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",Nh.a.ug("box42.png"),"","",!0,"")):b.appendChild(od.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Nh.a.ug("box42.png"),
"","",!0,"")),k++)}for(;5>k;k++)b.appendChild(od.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Nh.a.ug("box42.png"),"","",!0,""));this.RKe&&(k=document.createElement("span"),k.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.RKe),b.appendChild(k));return b}get C4n(){return 0<this.APe?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.APe):""}get RGk(){if(this.p_g){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;
return b}if(this.Tse&&this.wea)return Og.G$k(this.Tse,this.wea);b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.lHe){const k=this.lHe.split(",");b=Array(k.length);for(let t=0;t<k.length;t++)b[t]=k[t].trim()}else b=[];return b}static kHl(b){const k=new Og;for(let t=0;t<b.childNodes.length;t++){const D=b.childNodes[t];if(1===D.nodeType)try{const P=D.firstChild.nodeValue;switch(D.nodeName){case "src":k.aYj=P;break;case "assetid":k.med=
P;break;case "thumb":"64x64"===D.attributes.getNamedItem("size").nodeValue?k.pih=Og.HAj(P):"192x192"===D.attributes.getNamedItem("size").nodeValue&&(k.pwb=Og.HAj(P));break;case "imagedim":if(P){const ta=P.indexOf("x");0<ta&&ta<P.length&&(k.sq=P.substr(0,ta),k.Es=P.substr(ta+1))}break;case "resolution":k.APe=Number.parseInvariant(P);break;case "rating":k.Ewb=P;break;case "numofratings":k.RKe=P;break;case "displayname":k.Kra=P;break;case "contentlength":k.vPg=Number.parseInvariant(P)/1024;break;case "subject":k.lHe=
P;break;case "provider":k.wea=P;break;case "attributionlink":k.Tse=P;break;case "iscsc":k.p_g=1===Number.parseInvariant(P);break;case "additional":const ca=D.firstChild;if(D.hasChildNodes()&&ca&&"id"===ca.nodeName&&1===Number.parseInvariant(ca.text))for(let ta=0;ta<D.childNodes.length;ta++){const Na=D.childNodes[ta];switch(Na.nodeName){case "caption":k.Ure=Na.text;break;case "value":k.Zre=Na.text;break;case "string":k.Yre=Na.text}}}}catch(P){}}return k}static G$k(b,k){const t=document.createElement("a");
t.setAttribute("href",b);t.setAttribute("target","_blank");t.innerText=k;return t}static HAj(b){let k;return b&&0<(k=b.indexOf("://"))?b.substr(k+1):b}}Object(n.a)(Og,"ClipArtSearchResult",null,[]);class Bo{static get Xg(){return Wf.a.lA(Bo.Lm,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}Bo.Lm="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(n.a)(Bo,"InsertClipartDialogHtml",null,[]);class Ek extends Wf.a{constructor(b){super();this.AAa=this.Ptb=0;this.Jah=null;this.RNe=!1;this.JXb=this.sXa=this.DN=null;this.qWi=k=>{const t=this.qW.value;t&&0<t.trim().length&&(this.search(this.qW.value),this.bqa(1,!1));k.preventDefault();k.stopPropagation()};this.Krn=k=>{(k?k.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.qWi(k),k.preventDefault(),k.stopPropagation())};this.rWi=k=>{100<=this.qW.value.length&&(k.preventDefault(),k.stopPropagation())};
this.fqn=k=>{k=Number.parseInvariant(k.target.parentNode.id.substr(4));this.g2i(k);this.oag(k)};this.onScroll=()=>{if(this.Er&&this.Er.children&&!(2>this.Er.children.length)){var k=this.Er.children[0].children[0],t=this.Er.clientHeight-(k.clientHeight-k.children[0].clientHeight+2)+this.Er.scrollTop,D=k.clientHeight+2,P=parseInt(String(this.Er.scrollTop/D));k=parseInt(String(t/D));var ca=parseInt(String(this.Er.clientWidth/D));k<t/D&&k<parseInt(String(this.DN.length/ca))&&k++;for(t=P;t<k;t++)for(D=
0;D<ca;D++){var ta=t*ca+D;P=this.DN[ta];(ta=document.getElementById("clip"+ta))&&!ta.childNodes.length&&(P=this.TMh(P),ta.appendChild(P))}}};this.Rsn=k=>{k.target.setAttribute("src",Nh.a.ug("phthumb.64x64x32.png"))};this.gqn=k=>{k.target.setAttribute("src",Nh.a.ug("phpreview.96x96x32.png"))};this.PTi=k=>{$d.a.nm(k.target.attributes.getNamedItem("href").value,k.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");k.stopPropagation();k.preventDefault()};this.gnn=k=>{(k?k.keyCode:
window.event.keyCode)===Sys.UI.Key.enter&&this.PTi(k)};this.iUi=k=>{const t=k.target.innerText;this.qW&&(this.qW.value=t);this.search(t);k.stopPropagation();k.preventDefault();this.bqa(1,!1)};this.Tnn=k=>{(k?k.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.iUi(k)};this.tWi=k=>{this.DN&&(this.B$n(this.DN[this.Ptb]),k.stopPropagation(),k.preventDefault(),this.qW.value="",this.bqa(1,!1))};this.Lrn=k=>{(k?k.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.tWi(k)};this.onKeyDown=k=>{if(k.keyCode>=
Sys.UI.Key.left&&k.keyCode<=Sys.UI.Key.down){let t=0;switch(k.keyCode){case Sys.UI.Key.up:t=-5;break;case Sys.UI.Key.down:t=5;break;case Sys.UI.Key.left:t=-1;break;case Sys.UI.Key.right:t=1}this.AAa=this.AAa+t<this.Er.children.length-1?0>this.AAa+t?0:this.AAa+t:this.Er.children.length-1;this.oag(this.AAa);k.preventDefault();k.stopPropagation()}else k.keyCode===Sys.UI.Key.enter?(k=Number.parseInvariant(k.target.id.substr(4)),0<=k&&k<this.Er.children.length&&this.ehj(k)):k.keyCode===Sys.UI.Key.tab&&
(this.AAa=k.shiftKey?Math.max(0,this.AAa-1):Math.min(this.AAa+1,this.Er.children.length-1))};this.onError=()=>{this.Er&&(this.Er.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.p3i=k=>{if(this.Er)if(k.data.Aia){var t=k.data.Aia.lastChild.childNodes;this.DN||(this.DN=[]);for(k=0;k<t.length&&100>this.DN.length;k++){var D=t[k];1===D.nodeType&&"image"===D.nodeName&&(D=Og.kHl(D),this.DN.push(D))}this.dSh();this.DN.length||(this.Er.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(k.data.xe){k=
F.a.ivj(k.data.xe);try{t=parseInt(k)}catch(P){t=14}this.Er.innerText=26===t?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.dSh=()=>{if(this.DN){fc.a.e_(this.Er);this.sXa&&(this.sXa.dispose(),this.sXa=null);this.Er.focus();this.Er.classList.remove("ClipartSearchInProgress");for(let t=0;t<this.DN.length;t++){var k=document.createElement("a");k.setAttribute("href","#");k.id="itab"+t;const D=document.createElement("span");D.id="clip"+t;D.classList.add("ClipartImageContainer");
k.appendChild(D);this.Er.appendChild(k);t<parseInt(String(this.Er.clientHeight/D.clientHeight))*parseInt(String(this.Er.clientWidth/D.clientWidth))&&(k=this.TMh(this.DN[t]),D.appendChild(k))}this.RNe&&(this.ehj(this.Ptb),this.oag(this.Ptb))}};this.qzm=k=>{1===k&&this.DN&&Ek.NO.ofa(this.uOg.context)&&(k=this.DN[this.Ptb])&&this.uOg.QHa(k)};this.uOg=b;this.Xg=Bo.Xg;this.vg="InsertClipartDialog";this.Ee(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.qzm);this.Er=document.getElementById("clipartsearchresults");this.Ctd=this.onKeyDown;vf.a.addHandler(this.Er,"keydown",this.Ctd);this.Btd=this.onScroll;vf.a.addHandler(this.Er,"scroll",this.Btd);this.qW=document.getElementById("textInput");this.awd=this.Krn;vf.a.addHandler(this.qW,"keydown",this.awd);this.bwd=this.rWi;vf.a.addHandler(this.qW,"keypress",this.bwd);this.cwd=this.rWi;vf.a.addHandler(this.qW,"paste",this.cwd);this.$oc=document.getElementById("btnSearch");this.$oc.setAttribute("src",
Nh.a.ug("search.16x16x32.png"));this.Atd=this.qWi;vf.a.addHandler(this.$oc,"click",this.Atd);this.WTb=document.getElementById("clipartpreviewimage");this.kye=document.getElementById("clipartattributedisplayname");this.j$a=document.getElementById("clipartseesimilar");this.jye=document.getElementById("clipartdimensions");this.Erc=document.getElementById("clipartadditionalvalue");this.lye=document.getElementById("clipartratingvalue");this.BVa=document.getElementById("clipartattributionvalue");this.CVa=
document.getElementById("clipartkeywords");this.hye=document.getElementById("clipartadditionalname");this.mye=document.getElementById("clipartratingname");this.iye=document.getElementById("clipartattributionname");this.TNe=this.fqn;this.BUe=this.Rsn;this.qkd=this.PTi;this.rkd=this.gnn;this.jHe=this.iUi;this.kHe=this.Tnn;this.Etd=this.tWi;this.Ftd=this.Lrn;this.qW.focus();this.bqa(1,!1)}dispose(){this.Er&&this.vDh();this.Er&&this.Ctd&&(vf.a.removeHandler(this.Er,"keydown",this.Ctd),this.Ctd=null);
this.Er&&this.Btd&&(vf.a.removeHandler(this.Er,"scroll",this.Btd),this.Btd=null);this.Er=null;this.qW&&this.awd&&(vf.a.removeHandler(this.qW,"keydown",this.awd),this.awd=null);this.qW&&this.bwd&&(vf.a.removeHandler(this.qW,"keypress",this.bwd),this.bwd=null);this.qW&&this.cwd&&(vf.a.removeHandler(this.qW,"paste",this.cwd),this.cwd=null);this.qW=null;this.$oc&&this.Atd&&(vf.a.removeHandler(this.$oc,"click",this.Atd),this.$oc=this.Atd=null);this.iye=this.mye=this.hye=this.CVa=this.BVa=this.lye=this.Erc=
this.jye=this.j$a=this.kye=this.WTb=this.Ftd=this.Etd=this.kHe=this.jHe=this.rkd=this.qkd=this.JXb=this.BUe=this.TNe=null;this.sXa&&(this.sXa.dispose(),this.sXa=null);super.dispose()}qL(){super.qL();document.getElementById(this.kj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.GNb(b,!1,this.p3i)}GNb(b,k,t){this.AAa=this.Ptb=0;this.vDh();if(this.DN&&b===this.Jah&&this.RNe===k)window.setTimeout(this.dSh,500);else{this.DN&&(Array.clear(this.DN),this.DN=null);this.Jah=b;this.RNe=
k;var D=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');D.append("<query>");D.append(F.a.Af(b));D.append("</query>");D.append("<mediatype>Illustration</mediatype>");D.append("<mediatype>Photo</mediatype>");D.append("<filetype>jpg</filetype>");D.append("<filetype>jpeg</filetype>");D.append("<filetype>gif</filetype>");D.append("<filetype>bmp</filetype>");D.append("<filetype>tif</filetype>");D.append("<filetype>tiff</filetype>");D.append("<filetype>png</filetype>");D.append("</search>");
b=w.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let P=b.length;4>P;P++)b="0"+b;w.AFrameworkApplication.Ne.sj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",Wa.App.webServiceBase,b,Rh.a.owo,k.toString()),2,D.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,t,this.onError,null)}}B$n(b){this.GNb(b.assetId,!0,this.p3i);this.DN||(this.DN=[],this.DN.push(b))}TMh(b){const k=document.createElement("img");k.classList.add("ClipartThumbImage");k.setAttribute("src",
b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;k.setAttribute("title",b);k.setAttribute("alt",b);vf.a.addHandler(k,"click",this.TNe);vf.a.addHandler(k,"error",this.BUe);return k}ajl(b){1===b.childNodes.length&&(b=b.childNodes[0],vf.a.removeHandler(b,"click",this.TNe),vf.a.removeHandler(b,"error",this.BUe))}g2i(b){const k=this.DN[b];var t=k.iFn;this.tDh();this.JXb=this.gqn;var D=document.createElement("img");D.setAttribute("src",t);if(k.displayName)t=
String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,k.displayName);else{t=new Sys.StringBuilder;for(let P=0;P<k.keywords.length&&5>P;P++)P&&t.append(", "),t.append(k.keywords[P]);t=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,t.toString())}D.setAttribute("title",t);D.setAttribute("alt",t);vf.a.addHandler(D,"error",this.JXb);this.WTb.appendChild(D);D=document.getElementById("clip"+this.Ptb);D.classList.remove("ClipartSelectedImage");D=document.getElementById("clip"+
b);D.classList.add("ClipartSelectedImage");this.Ptb=b;k.displayName&&(this.kye.innerText=k.displayName);b=document.createElement("a");b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');vf.a.addHandler(b,"click",this.Etd);vf.a.addHandler(b,"keydown",this.Ftd);this.j$a.appendChild(b);this.jye.innerText=String.format("{0} | {1} | {2}",k.dimensions,k.C4n,k.fileSize);(b=k.Iyk)&&k.Jqh?(this.Erc.parentNode.style.display="block",this.hye.innerText=k.Jqh,this.Erc.appendChild(b)):
this.Erc.parentNode.style.display="none";this.lye.appendChild(k.WMn);fc.a.e_(this.BVa);if(b=k.RGk)this.BVa.appendChild(b),"a"===b.nodeName.toLowerCase()&&(vf.a.addHandler(b,"click",this.qkd),vf.a.addHandler(b,"keydown",this.rkd));this.CVa.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<k.keywords.length;b++)D=k.keywords[b],t=document.createElement("a"),t.innerText=D,t.setAttribute("href",'""'),vf.a.addHandler(t,"click",this.jHe),vf.a.addHandler(t,"keydown",this.kHe),this.CVa.appendChild(t),
b<k.keywords.length-1&&(D=document.createElement("span"),D.innerText=", ",this.CVa.appendChild(D));this.mye.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.iye.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.bqa(1,!0)}tDh(){this.WTb&&1===this.WTb.childNodes.length&&(this.JXb&&(vf.a.removeHandler(this.WTb.childNodes[0],"error",this.JXb),this.JXb=null),fc.a.e_(this.WTb));this.BVa&&0<this.BVa.childNodes.length&&"a"===this.BVa.childNodes[0].nodeName.toLowerCase()&&(this.qkd&&vf.a.removeHandler(this.BVa.childNodes[0],
"click",this.qkd),this.rkd&&vf.a.removeHandler(this.BVa.childNodes[0],"keydown",this.rkd));this.j$a&&0<this.j$a.children.length&&"a"===this.j$a.children[0].nodeName.toLowerCase()&&(this.Etd&&vf.a.removeHandler(this.j$a.children[0],"click",this.Etd),this.Ftd&&vf.a.removeHandler(this.j$a.children[0],"keydown",this.Ftd),fc.a.e_(this.j$a));if(this.CVa){for(let b=0;b<this.CVa.childNodes.length;b++){const k=this.CVa.childNodes[b];"a"===k.nodeName.toLowerCase()&&(vf.a.removeHandler(k,"click",this.jHe),vf.a.removeHandler(k,
"keydown",this.kHe))}fc.a.e_(this.CVa)}this.kye.innerText="";this.jye.innerText="";fc.a.e_(this.Erc);fc.a.e_(this.lye);fc.a.e_(this.BVa);this.CVa.innerText="";this.hye.innerText="";this.mye.innerText="";this.iye.innerText=""}ehj(b){if(!(this.Er.children.length<=b||0>b)){var k=this.Er.children[b],t=this.Er.children[0];t=t.clientHeight-t.children[0].clientHeight+2;this.Er.scrollTop+this.Er.clientHeight<k.offsetTop+k.clientHeight?this.Er.scrollTop=k.offsetTop-3*k.clientHeight-t:this.Er.scrollTop>k.offsetTop&&
(this.Er.scrollTop=k.offsetTop-t/2);this.g2i(b)}}validate(){return!0}vDh(){if(ad.FocusManager.SJ()){var b=ad.FocusManager.instance().getRegion(this.NK);b&&b.Zj.Gy(this.qW)}else this.qW.focus();for(b=0;b<this.Er.childNodes.length;b++){const k=this.Er.childNodes[b];1===k.childNodes.length&&this.ajl(k.childNodes[0])}fc.a.e_(this.Er);this.tDh();this.bqa(1,!1);this.sXa=new Xp.a(Box4Intl.Box4Strings.l_ClipartSearching);this.sXa.VAi=!1;this.Er.appendChild(this.sXa.element);this.Er.classList.add("ClipartSearchInProgress")}oag(b){this.AAa=
b;b=this.Er.children[this.AAa];ad.FocusManager.SJ()?ad.FocusManager.instance().getRegion(this.NK).Zj.Gy(b):b.focus()}static get NO(){return Ek.Oj=Ek.Oj||Fa.a.instance.resolve("Box4.Images.IImageEditor")}}Ek.Oj=null;Object(n.a)(Ek,"InsertClipartDialog",Wf.a,[]);class nd extends ml{constructor(b,k,t,D,P,ca){super(b,k,t,D,P,ca,!1);this.Npn=ta=>{if(this.iOm()){var Na=this.Fe.Bi(),qb=Na.contentReplicator.wt.toString(),Jb=new Sys.Net.WebRequest;Jb.set_url("ClipArtUpload.ashx");Jb=new Sys.StringBuilder(Jb.getResolvedUrl());
this.FW(Jb,Rh.a.assetId,ta.assetId,!0);this.FW(Jb,Bi.a.lcid,w.AFrameworkApplication.lcid.toString());this.FW(Jb,Bi.a.nodeId,this.YG?this.YG.id.toString():this.Fe.id.toString());this.FW(Jb,Bi.a.cellId,Na.wm.toString());this.FW(Jb,Bi.a.fileId,Na.rr);this.FW(Jb,Bi.a.Qta,qb);this.FW(Jb,Bi.a.xT,this.Nl.toString());ta=this.Fe.ia(ke.a.uJ,Wh.a.yt);this.FW(Jb,Bi.a.uJ,ta.toString());this.FW(Jb,Bi.a.vqb,"1");Na.CH&&this.FW(Jb,Bi.a.CH,Na.CH);this.FW(Jb,Bi.a.classId,this.YG?this.YG.properties.Pc.toString():this.Fe.Pc.toString());
this.Vg.hasProperty(Cc.a.imageType)&&this.FW(Jb,Rh.a.imageType,this.Vg.getValue(Cc.a.imageType).toString());uh.a.instance.Guk(Jb);w.AFrameworkApplication.Ne.sj(Jb.toString(),2,"",{},!1,2,this.OXo,this.uploadFailed,null);ml.cec++}};this.OXo=ta=>{if(({group:Na}=sn.a.l1(ta.data.xe)).returnValue){var Na=Na.Responses[0];Na.xnb=ta.data.IH;Na.St=ta.data.vj?ta.data.vj[de.a.F7]:"";this.gza(Na)}else this.uploadFailed(null)};this.uploadFailed=()=>{const ta=new Dn.a;ta.StatusCode=14;this.gza(ta)};new Ek(this)}QHa(b){this.AWd()&&
this.Fe.Bi().contentReplicator.forceOutbound(this.Npn,null,b)}FW(b,k,t,D){b.append(D?"?":"&");b.append(F.a.Nj(k));b.append("=");b.append(F.a.Nj(t))}eif(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.eif(b)}}gza(b){super.gza(b);ml.cec--}}Object(n.a)(nd,"ClipartUploader",ml,[]);class Sm{constructor(b,k,t){this.rzm=(D,P,ca,ta,Na)=>{if(!this.Oj||!this.Oj.value)return v.ULS.sendTraceTag(524109267,
306,15,"ImageEditor not available"),8;D=this.Oj.value.ofa(P);return 2===ca&&D?(new nd(P,wb.a.instance,w.AFrameworkApplication.K,Na,this.Jm,this.ga),32):1===ca?D&&Wa.App.lEh?32:8:2};this.Oj=b;this.Jm=k;this.ga=t}Tb(){this.ga.fb(Pb.a.Vqi,lc.a.view,this.rzm,260)}}Object(n.a)(Sm,"ClipArtActor",null,[]);class oo{constructor(){this.W=null}get name(){return"Box4.ClipArt"}xc(b){this.W=b;b.ha("Box4.ClipArt.ClipArtActor",()=>new Sm(b.Ue("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),w.AFrameworkApplication.va)).singleInstance()}init(){this.W.resolve("Box4.ClipArt.ClipArtActor").Tb();
const b=Wa.App.ya;b&&b.updateCommandUI()}dispose(){}}Object(n.a)(oo,"ClipartPackage",null,[1,2]);class qp{constructor(b){this.PXa=this.AXa=this.TXa=this.SXa=null;this.vXg=this.cSg=this.wXg=this.l3g=this.Ah=this.K$=!1;this.pPe=this.S3g=null;this.C3g=0;this.Ma=this.N3g=null;this.Sda=b;this.nN=3;this.EVb=!0}initialize(b,k,t){this.SXa=this.ytf(b,k);this.TXa=CommonUIStrings.l_SavingStatus;this.AXa=CommonUIStrings.l_ReadOnlyStatus;this.PXa=CommonUIStrings.l_ReviewModeStatus;this.Sda&&this.Sda.execute(D=>
{D.rdb(Object(A.a)(this,this.Tad,"updateToSavingStatus"))});this.Ah=!0;this.Ma=t;this.cSg=this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}iqb(b,k){this.K$=b;this.nN=k;this.fUa(this.EVb)}fUa(b){!this.EVb&&b&&(this.N3g=new Date);this.EVb=b;this.vXg=!1;b=null;3===this.nN&&(b=this.EVb?this.SXa:this.TXa);this.lnl(b)}ytf(b,k){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):k&&k.length?String.format(CommonUIStrings.l_SavedToStatus,
k):CommonUIStrings.l_SavedStatus}Tad(){this.fUa(!1)}G1l(){switch(this.nN){case 1:return this.AXa;case 2:return this.PXa;default:return null}}F1l(){if(3!==this.nN)switch(this.nN){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.vXg?"FailedToSave":this.EVb?"Saved":"Saving"}yHm(b){return this.l3g===this.K$&&this.C3g===this.nN&&this.S3g===b}Tef(b){appChrome.getHeaderApi().then(k=>{k.updateDocumentTitleStatus(this.K$,b,this.G1l(),this.N3g,this.EVb,this.cSg?k.getHeaderSaveStatusIconProps(this.F1l()):
null);this.wXg=!0;return null});this.pPe=null}lnl(b){this.Ah&&Qg.c()&&!this.yHm(b)&&(!this.wXg&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.Tef(b):$d.a.Ide()?(this.pPe&&v.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.pPe=window.requestIdleCallback(()=>{this.Tef(b)})):window.requestAnimationFrame(()=>{this.Tef(b)}),this.l3g=this.K$,this.S3g=b,this.C3g=this.nN)}}Object(n.a)(qp,"ReactSaveStatusUIHandler",
null,[705]);class Jl{constructor(b,k){this.KX=null;this.SXa=CommonUIStrings.l_SavedStatus;this.TXa=CommonUIStrings.l_SavingStatus;this.AXa=CommonUIStrings.l_ReadOnlyStatus;this.PXa=CommonUIStrings.l_ReviewModeStatus;this.bab=k;this.Sda=b;this.nN=3;this.icb=!0}wF(){this.Sda&&this.Sda.execute(b=>{b.rdb(Object(A.a)(this,this.Tad,"updateToSavingStatus"))});this.bab.execute(b=>{this.KX=b})}iqb(b,k){this.nN=k;3===k?this.fUa(this.icb):2===k?this.Skg(this.PXa):this.Skg(this.AXa)}Tad(){this.fUa(!1)}fUa(b){this.icb=
b;this.Skg(this.icb?this.SXa:this.TXa)}Skg(b){this.KX&&this.KX.sendMessage(K.a.QNo,this.a3k(b))}a3k(b){const k={};k.StatusText=b;return k}}Object(n.a)(Jl,"SaveStatusPostMessageHandler",null,[705]);var ln=c(215),Co=c(141);class bn{constructor(b,k,t,D){this.PXa=this.AXa=this.TXa=this.SXa=null;this.hvb=0;this.HZ=this.xQe=this.jrb=this.Fse=this.OUe=null;this.ng=b;this.W$a=k;this.Sda=t;this.em=D;this.p0g=!0;this.K$=!1;this.nN=3;this.icb=!0}initialize(b,k){if(!this.ng)return!1;this.SXa=this.ytf(b,k);this.TXa=
CommonUIStrings.l_SavingStatus;this.AXa=CommonUIStrings.l_ReadOnlyStatus;this.PXa=CommonUIStrings.l_ReviewModeStatus;this.wF();return!0}ytf(b,k){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):k&&k.length?String.format(CommonUIStrings.l_SavedToStatus,k):CommonUIStrings.l_SavedStatus}wF(){this.W$a&&this.W$a.execute(b=>{b.oxk(Object(A.a)(this,this.AMh,"createStatusAndModeElements"));b.$wk(Object(A.a)(this,this.muo,"showHideSaveStatusElement"));b.ZIo&&this.AMh(null,
null)});this.Sda&&this.Sda.execute(b=>{b.rdb(Object(A.a)(this,this.Tad,"updateToSavingStatus"))})}sja(){this.HZ&&this.ng&&this.ng.$ya(this.HZ)}muo(b,k){this.iqb("true"===k,this.nN)}iqb(b,k){this.K$=b;this.nN=k;this.Fse&&(this.Fse.style.display=this.K$||3===this.nN||!this.OUe?"none":"");this.jrb&&(this.jrb.style.display=this.K$||3===this.nN?"none":"",this.jrb.innerText=1===this.nN?this.AXa:this.PXa,this.jrb.title=1===this.nN?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);
this.xQe&&(this.xQe.style.display=this.K$||1===this.nN||!this.OUe&&!this.jrb?"none":"");this.HZ&&(this.HZ.style.display=this.K$||1===this.nN?"none":"",this.fUa(this.icb),this.HZ.title=CommonUIStrings.l_SaveStatusTooltip)}AMh(b,k){b=document.getElementById(ln.CuiHelper.Wpm);k&&k.t1o||!b||""===this.SXa||""===this.TXa||""===this.AXa||""===this.PXa||(this.OUe=document.getElementById(ln.CuiHelper.d4e),this.Fse=ln.CuiHelper.qGd(b,"BreadcrumbAppModeDash","-"),this.jrb=ln.CuiHelper.qGd(b,"BreadcrumbAppModeStatus",
1===this.nN?this.AXa:this.PXa),this.BEj(this.jrb),this.xQe=ln.CuiHelper.qGd(b,"BreadcrumbSaveStatusDash","-"),this.HZ=ln.CuiHelper.qGd(b,"BreadcrumbSaveStatus",this.SXa),this.BEj(this.HZ),this.iqb(this.K$,this.nN))}Tad(){this.fUa(!1)}fUa(b){this.icb=b;this.fWo(this.icb?this.SXa:this.TXa)}fWo(b){!this.HZ||3!==this.nN&&2!==this.nN||(this.p0g&&!this.icb?(this.hvb=this.HZ.offsetWidth<this.hvb?this.hvb:this.HZ.offsetWidth,this.LQo(this.TXa),this.p0g=!1):this.HZ.innerText=b)}BEj(b){b.style.direction=this.em?
"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.em?"right":"left";b.style.display=this.K$?"none":"";b.setAttribute("Unselectable","on")}LQo(b){this.HZ&&(this.HZ.style.width="",this.HZ.innerText=b,this.hvb=this.HZ.offsetWidth<this.hvb?this.hvb:this.HZ.offsetWidth,b=Co.a.sB(this.HZ),this.HZ.style.width=this.hvb-fc.a.OM(b.paddingLeft)-fc.a.OM(b.paddingRight)+1+"px")}}Object(n.a)(bn,"SaveStatusUIHandler",null,[705]);var gm=c(94);class Do{constructor(){this.yQe=this.DOe=this.fMa=this.W=null}get name(){return"Common.App.SaveStatus"}xc(b){this.W=
b;w.AFrameworkApplication.K.$("PostMessageEmbedded")&&w.AFrameworkApplication.IX?this.W.register(Jl,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Rd(()=>new Jl(this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"),this.W.Sa("Postmessage.IHostPostmessenger"))):w.AFrameworkApplication.ta.Nb.pGf||(w.AFrameworkApplication.ta.Nb.oJ?this.W.register(qp,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Rd(()=>
new qp(this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"))):this.W.register(bn,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Rd(()=>new bn(gm.EventHandlerManager.instance,this.W.Sa("Common.App.Header.HeaderEventSource"),this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"),w.AFrameworkApplication.isRtl)))}init(){w.AFrameworkApplication.K.No(Object(A.a)(this,this.Lx,"onFullAppSettingsReady"))}Lx(){const b=
w.AFrameworkApplication.K,k=!!w.AFrameworkApplication.ta.Nb&&4===w.AFrameworkApplication.ta.Nb.Sl;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||k&&b.$("SimplifiedReactRibbonUxIsEnabled")||b.$("ExcelSaveStatusInHeaderEnabled")||b.$("VisioSaveStatusInHeaderEnabled"))w.AFrameworkApplication.K.$("PostMessageEmbedded")&&w.AFrameworkApplication.IX?(this.yQe=this.W.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.yQe.wF():w.AFrameworkApplication.ta.Nb.pGf||
b.$("PreventSaveStatusInitializationWithHiddenHeader")&&w.AFrameworkApplication.hideHeader||(w.AFrameworkApplication.ta.Nb.oJ?(this.DOe=this.W.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.DOe.initialize(b.$("IsSkyDrive"),b.jb("HostNameToIncludeInSavedStatus"),w.AFrameworkApplication.K):(this.fMa=this.W.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.fMa.initialize(b.$("IsSkyDrive"),b.jb("HostNameToIncludeInSavedStatus")))}dispose(){this.fMa&&this.fMa.sja()}}Object(n.a)(Do,
"PackageManager",null,[1,2]);var Km=c(1637);class Aj{get name(){return"Common.App.EventsCachePackage"}xc(){}init(){Km.a.instance.init()}dispose(){}static main(){N.a.instance.Fc(new Aj)}}Object(n.a)(Aj,"EventsCachePackage",null,[1,2]);var Tj=c(130),Sh=c(161),Ui=c(87),tn=c(620),kg=c(307),tj=c(442),Kl=c(285),Hf=c(25),ka=c(240),Va=c(24);class vb{constructor(b){this.v_g=!1;this.ydd=this.om=null;this.Cre=!1;this.qE=b}get control(){return this.qE}get Pd(){return this.control.Pd}get root(){return this.control.root}get TH(){return this.control.TH}get KYa(){return this.control.KYa}get uk(){return this.control.uk}get WE(){return this.control.WE}HI(){}initialize(){}Uw(b,
k,t){this.control.dol(b,k,t)}xm(){Hf.c(this.control.Fh.Command)||this.fu(this.control.Fh.Command,null,null)}fu(b,k,t){let D=0;this.root&&(D=this.root.xpa(b,k,t));this.control.enabled=0<(D&1);return D}U7a(){let b=this.control.visible;this.root.ATa&&(b=this.Pd[ka.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.Ndc=!0));return b}qmg(){const b=Va.a.Vqa(this.Pd[ka.a.labelText],this.control.Fh.LabelText);this.uge(b)}uge(b){this.control.labelText!==b&&(this.WE.forEach(k=>{k.uge(b)}),
this.control.labelText=b,this.root.l4a=!0)}FQb(){const b=Va.a.Vqa(this.Pd[ka.a.alt],this.control.Fh.Alt);this.Zic(b)}Zic(b){this.control.tooltip!==b&&(this.WE.forEach(k=>{k.Zic(b)}),this.control.tooltip=b)}wja(){const b=Va.a.Vqa(this.Pd[tn.a.Image16by16Class],this.control.Fh.Image16by16Class),k=Va.a.Vqa(this.Pd[tn.a.Image32by32Class],this.control.Fh.Image32by32Class);var t=Va.a.Vqa(this.Pd[tn.a.Image48by48Class],this.control.Fh.Image48by48Class);t=Hf.b(t)?k:t;this.fEc(this.WE.small,b);this.fEc(this.WE.medium,
b);this.fEc(this.WE.large,k);this.fEc(this.WE.jxo,b);this.fEc(this.WE.icc,t)}fEc(b,k){!b||Hf.c(b.BQ)||Hf.c(k)||b.BQ.className===k||(b.BQ.className=k)}xSo(b){if(!Hf.b(b)&&this.root.Wgg){for(const k of this.control.J8e){const t=k.DT===b;t&&(this.control.XXe=k);this.control.visible&&(k.RA=t)}this.control.visible&&(this.root.l4a=!0)}}azk(){if(this.WE.icc&&this.WE.icc.rO&&this.WE.icc.Xfb){const b=this.WE.icc.rO,k=Va.a.Vqa(this.Pd[kg.a.Description],this.control.Fh.Description);Hf.b(k)&&(b.style.position=
"relative",b.style.top=(b.parentNode.offsetHeight-b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.uk;Object(ob.a)(tj.a,b)?this.TH.dqb(b):this.root.OAb=this.control;return!1}onBlur(){const b=this.uk;this.control.KHb()&&Va.a.rw(b.Oc,"cui-ctl-menu-hovered-without-focus");this.root.OAb=null;return!1}fP(b){if(this.control.KHb()){var k=this.TH.tqa;const t=k===this.root.qJb-1;k=t?null:this.root.XC[k+1];this.D7e(!1);t||this.control===k||Va.a.rw(k.uIb,Kl.MenuLauncher.HYc);this.control.enabled&&
this.control.yu?t?this.control.FY():(Va.a.Xf(this.uk.Oc,"cui-ctl-menu-hovered-without-focus"),k.Xfa=this.control.yu):t?this.TH.setFocus(b.jg):(k.Xfa=this.TH.Oc,this.TH.Ppa())}return!1}yJ(){this.control.KHb()&&Va.a.rw(this.uk.Oc,"cui-ctl-menu-hovered-without-focus");return!1}onKeyDown(b){let k=!1;if(!Hf.c(b.Gb)&&!Hf.c(b.Gb.rawEvent)){const t=b.Gb.keyCode;b=b.Gb.rawEvent.shiftKey;t===Sys.UI.Key.enter&&(k=!0);if(Object(ob.a)(tj.a,this.uk)){const D=this.TH;if(!Hf.c(D)){const P=D.tqa,ca=0===this.root.c1,
ta=!Hf.c(this.control.jyn);if(t!==Sys.UI.Key.tab&&t!==Sys.UI.Key.left&&t!==Sys.UI.Key.right&&t!==Sys.UI.Key.up&&t!==Sys.UI.Key.down&&t!==Sys.UI.Key.esc)return k;$d.a.c7e();t!==Sys.UI.Key.tab||b?t===Sys.UI.Key.tab&&b?(D.LK(1),k=!0):t===Sys.UI.Key.left&&ca||t===Sys.UI.Key.right&&!ca?(ta?D.LK(2):0<P&&this.root.PZa(P,!0,!1),k=!0):t===Sys.UI.Key.right&&ca||t===Sys.UI.Key.left&&!ca?(ta&&D.LK(4),k=!0):t===Sys.UI.Key.up?(D.LK(5),k=!0):t===Sys.UI.Key.down?(D.LK(6),k=!0):t===Sys.UI.Key.esc&&(this.root.PZa(P,
!0,!1),k=!0):(D.LK(0),k=!0)}}}return k}zy(b){let k=!1;if(!Hf.c(b.Gb)&&!Hf.c(b.Gb.rawEvent)){const t=b.Gb.keyCode;Zb.KeyInputManager.Zli(b)||t!==Sys.UI.Key.enter&&t!==Sys.UI.Key.space||(k=this.jwf(b),k||(this.Uw(b.zf,1,b.Gb),k=!0))}return k}ZC(b){this.y8e();if(this.KYa){let k=!0;2===b.jg&&(k=b.kca===Sys.UI.MouseButton.leftButton);k&&this.uk&&this.xyd(this.uk.Oc)}(b.Gb.type.toLowerCase()!==Rc.a.vP||this.KYa)&&b.Gb.preventDefault();return!1}get SBf(){return this.v_g}rsl(){this.v_g=!0}y8e(){this.SBf&&
this.control.root.Ieb()}vxa(b){Object(ob.a)(tj.a,this.uk)&&!this.KYa&&2===b.jg&&b.kca===Sys.UI.MouseButton.leftButton?(this.Uw(b.zf,b.jg,b.Gb),b=!0):b=this.control.Iua(b);return b}onClick(b){let k=!1;Object(ob.a)(tj.a,this.uk)&&!this.KYa&&3===b.jg&&(this.Uw(b.zf,b.jg,b.Gb),k=!0);return aa.a.ti?!1:k}lmb(b){return this.O5d(b)}yGa(b){this.Iua(b);return!1}O5d(b){return Hf.c(this.om)?!1:(this.D$f($d.a.IZd(this.wmh,b.clientPoint)),!0)}xec(b){let k=!1;this.Iua(b)&&(k=!0);3!==b.jg&&(b=!0,!this.root&&vb.xRf&&
(v.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),b&&this.root.l3(),k=!0);return k}Aec(b){return this.Iua(b)}yec(b){return this.O5d(b)}zec(b){return this.Iua(b)}vec(b){return 3===b.jg?(this.root.l3(),!0):!1}wec(){return!1}get wmh(){!Hf.c(this.om)&&Hf.c(this.ydd)&&(this.ydd=$d.a.getElementBounds(this.om));return this.ydd}D$f(b){this.Cre!==b&&(this.Cre=b,this.YXe(this.Cre))}YXe(b){Hf.c(this.om)||Va.a.x5(this.om,Ui.Control.Ayd,b)}xyd(b){this.control.enabled&&(this.om=b,this.root.eDc=this.control,
this.D$f(!0),this.root.ifa(this.control,!1))}Iua(b){if(!Hf.c(this.om)){this.D$f(!1);let k=!!this.root;if(vb.xRf){const t=Xc.ActionManager.raa(parseInt(this.control.Fh.Command))||"";v.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",k,t)}k&&this.root.cba(this.control,!1);Hf.c(b)||$d.a.IZd(this.wmh,b.clientPoint)&&this.Uw(this.om,b.jg,b.Gb);k=!!this.root;vb.xRf&&v.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",k);k&&(this.root.eDc=null);this.ydd=this.om=null;return!0}return!1}LK(b){return Object(ob.a)(tj.a,
this.uk)&&2!==b&&4!==b&&!$d.a.t$b(this.control.yu)?this.FY():!1}FY(){try{if(this.control.visible){const b=this.control.yu;if(!Hf.c(b))return b.focus(),!0}}catch(b){}return!1}D7e(b){const k=this.TH;Hf.c(k)||this.root.PZa(k.tqa+1,b)}epa(){}jwf(){return!1}BX(b){let k=null;b&&b.rawEvent&&(k={},k[vb.triggerTime]=b.rawEvent.timeStamp);return k}static get xRf(){null==vb.MKe&&(vb.MKe=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return vb.MKe}}
vb.triggerTime="TriggerTime";vb.MKe=null;Object(n.a)(vb,"ControlBehavior",null,[715]);var Wb=c(180);class nc extends vb{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.Fh}HI(b){const k=b.Mm;b=b.DT;Hf.c(k)||(Ic.a.instance.lb(Rc.a.focus,k,Object(A.a)(this,this.onFocus,"onFocus")),Ic.a.instance.lb(Rc.a.blur,k,Object(A.a)(this,this.onBlur,"onBlur")),Sh.a.instance.lb(Rc.a.pointerOver,k,Object(A.a)(this,this.fP,"onPointerOver")),Sh.a.instance.lb(Rc.a.pointerOut,
k,Object(A.a)(this,this.yJ,"onPointerOut")),Zb.KeyInputManager.instance.dE(Rc.a.hi,k,Object(A.a)(this,this.onKeyDown,"onKeyDown"),b),Zb.KeyInputManager.instance.dE(Rc.a.Zt,k,Object(A.a)(this,this.FG,"onKeyPress"),b),Zb.KeyInputManager.instance.dE(Rc.a.vh,k,Object(A.a)(this,this.zy,"onKeyUp"),b),Sh.a.instance.lb(Rc.a.pointerDown,k,Object(A.a)(this,this.ZC,"onPointerDown")),Sh.a.instance.lb(Rc.a.QM,k,Object(A.a)(this,this.vxa,"onPointerUp")),Zh.a.instance.lb(Rc.a.click,k,Object(A.a)(this,this.onClick,
"onClick")),Wb.a.instance.lb(Rc.a.uP,k,Object(A.a)(this,this.lmb,"onTouchMove")),Wb.a.instance.lb(Rc.a.NJ,k,Object(A.a)(this,this.yGa,"onTouchEnd")))}Uw(b,k,t){this.control.enabled&&(b=null,this.uk&&this.uk.AUc()&&this.TH&&(b=this.root.XC[this.TH.tqa])&&!this.SBf&&(b.NSa(this.button),b=null),this.executeCommand(this.control.Fh.Command,k,!0,t),b&&b.NSa(this.button))}executeCommand(b,k,t,D){if(!Hf.c(b)){const P=this.Pd;P.CommandValueId=this.button.CDb();P.MenuItemId=this.button.Fh.MenuItemId;P.SourceControlId=
this.control.id;this.root.executeCommand(b,P,this.uk,k,t,null,this.BX(D))}}xm(){Hf.c(this.control.Fh.Command)||0<(this.fu(this.properties.Command,this.properties.QueryCommand,this.Pd)&2)&&this.U7a()&&this.cUa()}cUa(){this.qmg();this.FQb();this.wja()}onFocus(b){super.onFocus(b);this.Rfg();return!1}onBlur(b){super.onBlur(b);this.hhf();return!1}onKeyDown(b){let k=super.onKeyDown(b);Hf.c(b.Gb)||this.Ncg(b.Oo,b.Gb.keyCode)&&(k=!1);return k}FG(b){let k=!1;Hf.c(b.Gb)||Hf.c(b.Gb.rawEvent)||(this.Ncg(b.Oo,
b.Gb.rawEvent.keyCode)?(this.Uw(b.zf,b.jg,b.Gb),k=!0):b.Gb.preventDefault());return k}Ncg(b,k){if(aa.a.ut&&k===Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}zy(b){let k=!1;Hf.c(b.Gb)||this.Ncg(b.Oo,b.Gb.keyCode)||(k=super.zy(b));return k}Rfg(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}hhf(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(n.a)(nc,
"ButtonBehavior",vb,[]);var Qc=c(977);class Hd{}Hd.Color="Color";Hd.IndexColorSelected="ColorSelected";Object(n.a)(Hd,"ColorPickerCommandProperties",null,[]);class xd extends vb{constructor(b){super(b);this.uAc=this.sv=-1}get colorPicker(){return this.control}get tNa(){return this.colorPicker.YZk.tNa}get properties(){return this.colorPicker.Fh}Uw(b,k,t){if(this.control.enabled){const D=this.Pd;D.Color=xd.BQd(b)[Qc.ColorPicker.nEd];b=null;Va.a.Rr(this.properties.Stateful)&&this.uk&&this.uk.AUc()&&
this.TH&&(b=this.root.XC[this.TH.tqa]);this.root.executeCommand(this.properties.Command,D,this.uk,k,!0,null,this.BX(t));b&&b.NSa(this.colorPicker)}}xm(){var b=this.Pd;b.SourceControlId=this.properties.Id;if(0<(this.fu(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,Hd.IndexColorSelected in this.Pd&&(b=this.Pd[Hd.IndexColorSelected]),b!==this.uAc)){const k=this.tNa;0<=b&&b<k.length&&this.QDj(k[b],!0);0<=this.uAc&&this.uAc<k.length&&this.QDj(k[this.uAc],!1);this.uAc=b}}QDj(b,k){k?
Va.a.Xf(b,"cui-colorpicker-selected"):Va.a.rw(b,"cui-colorpicker-selected")}HI(b){for(let k=0;k<b.CXe.length;++k){const t=b.CXe[k];Ic.a.instance.lb(Rc.a.focus,t,Object(A.a)(this,this.RSf,"onCellFocus"));Ic.a.instance.lb(Rc.a.blur,t,Object(A.a)(this,this.Rjn,"onCellBlur"));Zb.KeyInputManager.instance.lb(Rc.a.hi,t,Object(A.a)(this,this.onKeyDown,"onKeyDown"));Zb.KeyInputManager.instance.lb(Rc.a.vh,t,Object(A.a)(this,this.zy,"onKeyUp"));Zh.a.instance.lb(Rc.a.click,t,Object(A.a)(this,this.Sjn,"onCellClick"));
Sh.a.instance.lb(Rc.a.QM,t,Object(A.a)(this,this.TSf,"onCellPointerUp"));Sh.a.instance.lb(Rc.a.pointerOver,t,Object(A.a)(this,this.SSf,"onCellPointerOver"));Sh.a.instance.lb(Rc.a.pointerDown,t,Object(A.a)(this,this.Tjn,"onCellPointerDown"))}}RSf(b){b=xd.BQd(b.zf);this.TH.dqb(this.uk);this.hne(b,!0);return!0}Rjn(b){this.hne(xd.BQd(b.zf),!1);return!0}hne(b,k){k?(this.sv=parseInt(b.getAttribute("arrayPosition")),Va.a.Xf(b,"cui-colorpicker-hoveredOver"),this.Rfg(b)):(this.sv=-1,this.hhf(b),Va.a.rw(b,
"cui-colorpicker-hoveredOver"))}Sjn(b){3===b.jg&&this.Uw(b.zf,b.jg,b.Gb);return!0}TSf(b){3!==b.jg&&this.Uw(b.zf,b.jg,b.Gb);return!0}SSf(b){this.D7e(!1);b=parseInt(xd.BQd(b.zf).getAttribute("arrayPosition"));this.F6c(b);return!0}Tjn(){return!1}Rfg(b){if(this.control.enabled){const k=this.properties.CommandPreview;if(!Hf.b(k)){const t=this.Pd;t.Color=b[Qc.ColorPicker.nEd];this.root.executeCommand(k,t,this.uk,0,!1)}}}hhf(b){if(this.control.enabled){const k=this.properties.CommandRevert;if(!Hf.b(k)){const t=
this.Pd;t.Color=b[Qc.ColorPicker.nEd];this.root.executeCommand(k,t,this.uk,0,!1)}}}LK(b){b=Ui.Control.Xkf(this.sv,this.colorPicker.width,this.tNa.length,b);if(b!==this.sv&&this.F6c(b))return!0;this.hne(this.tNa[this.sv],!1);return!1}FY(){return this.F6c(0)}F6c(b){return this.tNa&&this.tNa.length>b&&(b=this.tNa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}epa(){-1!==this.sv&&this.hne(this.tNa[this.sv],!1)}static BQd(b){return xd.o2l(b)}static o2l(b){var k=["td"];const t=k.length;if(!b)return null;
for(var D=0;D<t;D++)if(b.tagName.toLowerCase()===k[D].toLowerCase())return b;for(b=b.parentNode;b;){for(D=0;D<t;D++)if(b.tagName.toLowerCase()===k[D].toLowerCase())return b;b=b.parentNode}return null}}Object(n.a)(xd,"ColorPickerBehavior",vb,[]);var Id=c(337),Ve=c(292),mf=c(1660),fg=c(687),Dg=c(371),Zf=c(1118);class Ci{constructor(b,k){this.dlk=b;this.h_g=k}cge(b,k,t,D){if(Hf.c(b)||Hf.c(k))return null;const P=new Zf.a;const ca=D.x;var ta=D.y;const Na=D.width;var qb=D.height;let Jb;Ci.z4b(k,"flyoutWidth");
D=Ci.z4b(k,"flyoutRealHeight");const Vb=Ci.z4b(k,"viewportWidth");var ac=Ci.z4b(k,"viewportHeight"),yc=Ci.z4b(k,"viewableLeft");const Kc=Ci.z4b(k,"viewableTop"),ed=this.dlk;let sd=!1,oe=!1;const Ld=1===t,Od=4===t,ie=this.h_g;b.style.maxHeight="none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";Jb=this.FMi(b);P.XIj=ac;P.mog=Vb;if(Ld)ed?k=ca+Na:(k=ca-Jb,P.Ckb=!0),qb=ta;else{var Ce="";Na>Jb&&(Jb=Na,Ce=(Jb-2*Dg.Menu.R3d).toString());ed?k=ca:(k=ca+Na-Jb,P.Ckb=!0);qb=ta+qb;""!==Ce&&
(b.style.minWidth=Ce+"px")}ie&&(qb+=Kc,k+=yc);b.style.top=qb+"px";b.style.left=k+"px";let hg=!1;Ce=!1;Jb<=Vb?k+Jb>yc+Vb?(Ld&&ed&&ca-Jb>yc||Od&&ca-Jb>yc?(k=ca-Jb,ie&&(k+=yc),Ce=P.Ckb=!0):(k=yc+Vb-Jb,sd=!0),hg=!0):k<yc&&(Ld&&!ed&&ca+Na+Jb<yc+Vb?(k=ca+Na,ie&&(k+=yc),P.Ckb=!1,Ce=!0):(k=yc,oe=!0,P.Ckb=!0),hg=!0):ed?(k=yc,hg=!0,P.Ckb=!0):(k=yc+Vb-Jb,hg=!0,P.Ckb=!1);hg&&(b.style.left=k+"px");P.m6b=qb;qb+D<=Kc+ac&&3!==t||(P.IIf=!0,{Den:t,BEl:ta,VIm:ac,QPm:yc}=this.skf(t,qb,D,ta,Kc,ac),qb!==t&&(b.style.top=
t+"px",P.m6b=t),-1<ta&&(b.style.maxHeight=ta+"px"),ac&&(b.style.bottom="0px",b.style.height="auto"),yc&&this.O7m(b,ed,Ld,Ce,oe,sd,Vb,ca,Na));P.iMc=k;P.Ukf=Jb;P.Qkf=D;return P}skf(b,k,t,D,P,ca){let ta,Na,qb;ta=-1;qb=Na=!1;const Jb=k,Vb=P+ca-k;k=D-t;const ac=this.h_g;let yc=!1;0>k&&(k=P);ac||(D-=P);t<=D&&1!==b||(4===b||1===b?t<ca?(k=ca-t,Na=!0):(k=P,yc=qb=Na=!0):(D<Vb&&3!==b?(k=Jb,Na=!0):ta=D,qb=!0));ac&&(Na=!1,yc?ta=ca:k+=P);return{Den:k,BEl:ta,VIm:Na,QPm:qb}}O7m(b,k,t,D,P,ca,ta,Na,qb){b.style.overflowY=
"scroll";b.style.width="auto";if(k){if(ca||D)b.style.left="",b.style.right=(ca?0:ta-Na)+"px"}else P||D||(b.style.left="",b.style.right=(t?ta-Na:ta-Na-qb)+"px")}PSl(b){const k={};if(Hf.c(b))return k;k.viewportWidth=fc.a.dFb();k.viewportHeight=fc.a.CX();Hf.c(k.viewportWidth)&&(k.viewportWidth=document.documentElement.clientWidth,k.viewportHeight=document.documentElement.clientHeight);Hf.c(k.viewportWidth)&&(k.viewportWidth=document.body.clientWidth,k.viewportHeight=document.body.clientHeight);k.viewableTop=
window.pageYOffset;k.viewableLeft=window.pageXOffset;Hf.c(k.viewableTop)&&(k.viewableTop=document.documentElement.scrollTop,k.viewableLeft=document.documentElement.scrollLeft);Hf.c(k.viewableTop)&&(k.viewableTop=document.body.scrollTop,k.viewableLeft=document.body.scrollLeft);k.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*Dg.Menu.R3d:b.scrollHeight;const t=b.style.overflowY;b.style.overflowY="visible";k.flyoutWidth=this.FMi(b);b.style.overflowY=t;return k}FMi(b){return b.offsetWidth}static z4b(b,
k){return Hf.c(b)?0:b[k]}}Object(n.a)(Ci,"MenuPositioner",null,[]);var og=c(504),cl=c(601),ik=c(1120),uj=c(1119),ti=c(1116),Yo=c(1117),wh=c(1122),cn=c(384),Tm=c(975);class nl extends vb{constructor(b){super(b);this.HJe=0;this.f3g=null;this.dNe=-1;this.Jhd=null;this.uZf=this.eXg=!1;this.W$j=new Ci(0===this.root.c1,Va.a.Rr(this.root.properties.DivSyndicated))}get WMi(){return this.W$j}get Fu(){return this.control}get properties(){return this.control.Fh}get menu(){return this.Fu.menu}set menu(b){this.Fu.menu=
b}get dL(){return this.Fu.dL}set dL(b){this.Fu.dL=b}get Lvh(){Hf.c(this.Jhd)&&(this.Jhd=nl.T9k());return this.Jhd}get Epj(){let b=!this.root.Yyf;Object(ob.a)(401,this.root)&&1===this.root.qJb&&(b=!0);return b}Uw(b,k){Object(ob.a)(401,this.root)&&this.root.zhf();this.Fu.b0(k)}b0(b){if(this.Fu.enabled&&!this.dL){var k=Hi.a.instance.zp($a.a.b0);k.properties.add("Id",this.Fu.Fh.Id);k.properties.add("InputMethod",Id.a[b]);k.end();Hj.a.mark(10326);$d.a.O3d(this.Fu.Fh.Id,"MenuOpen");this.Fu.yu&&(this.Fu.Xfa=
$d.a.DOa(this.Fu.yu.ownerDocument));this.HJe=b;this.S0i(b);this.vfe();this.Fu.K7a(this.Fu.yu,!0)}}vfe(){Hf.c(this.properties.PopulateAsyncTriggerCommand)||this.eXg||(this.jgn(),this.eXg=!0)}jgn(){const b={};b[mf.a.Callback]=Object(A.a)(this,this.z7i,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.uk,0,!1)}z7i(){this.Fu.iSa()}iSa(){this.dL&&this.S0i(this.HJe,!0)}S0i(b,k=!1){var t=!0;if(Va.a.Rr(this.properties.PopulateDynamically)){t=!1;const D=this.j1c(b);
D!==this.f3g&&(t=this.JZf(D,k));t=t||!this.dL}t&&(k=w.AFrameworkApplication.ta.Fq,t=null,k&&(t=k.Zf("LoadResource","Menu Initialization")),this.VEa(b),t&&t.stop(),this.a7d())}VEa(b){if(!Hf.c(this.menu)){if(this.Fu.R4a){var k=this.Fu.uk;if(k&&k.keytip){var t=k.keytip.key.toLocaleLowerCase();this.menu.tjo(String.format("{0} {1}",this.Fu.R4a,k.keytip.Ggf),this.Fu.MRa&&""!==this.Fu.MRa?String.format("{0}-{1}",this.Fu.MRa,t):t)}}this.menu.Sma();Va.a.Xf(this.menu.Oc,this.Fu.F_e);Va.a.x5(this.menu.Oc,"cui-touch",
3===b||this.root.Rle);if(this.menu.hasItems()){this.menu.HI();k=this.uk;k.NVh();k.tRc=!0;k.Hf(this.menu);k.tRc=!1;this.menu.N0i();t=Object(ob.a)(Tm.a,this.root);var D=null,P=!1;t&&(D=this.root,P=D.C6a,D.C6a=!1);var ca=this.menu.Oc;ca.style.visibility="hidden";ca.style.position="absolute";ca.style.top="0px";ca.style.left="0px";aa.a.ut&&!aa.a.Gjb&&(ca.style.maxHeight="100px",ca.style.overflowY="scroll");document.body.appendChild(ca);this.ezk();this.OCn(ca);Sys.Browser.agent===Sys.Browser.InternetExplorer&&
this.xpk();Va.a.Xf(this.Fu.uIb,Kl.MenuLauncher.HYc);var ta=this.root.qJb;this.Spo&&this.root.ifa(this.control,!0);ca.style.zIndex=String(w.AFrameworkApplication.ta.vta);this.root.esk(this.Fu);this.menu.tqa=ta;ca.style.visibility="visible";ta=this.a5h();if(Object(ob.a)(Yo.a,this.menu)){ca.style.position="fixed";const Na=this.root.XC[0];Na&&Na.menu&&Na.menu.Oc?100!==$d.a.IOc(this.root.XC[0].menu.Oc)&&Ve.a.jeg(ca,ta,Object(A.a)(this,this.Q_e,"afterShowMenu")):Ve.a.jeg(ca,ta,Object(A.a)(this,this.Q_e,
"afterShowMenu"))}else Ve.a.jeg(ca,ta,Object(A.a)(this,this.Q_e,"afterShowMenu"));this.dL=!0;this.menu.HIf=!0;!aa.a.ti&&this.Fu.tbo&&this.menu.setFocus(b);t&&(D.C6a=P);t=this.properties.CommandMenuOpen;Hf.b(t)||this.root.executeCommand(t,null,k,b,!1)}}Hj.a.mark(10327)}a7d(){}xpk(){this.dNe=Va.a.eAb(this.dNe);this.dNe=window.setTimeout(Object(A.a)(this,this.ypk,"addAndPositionBackFrameInternal"),50)}ypk(){this.menu&&this.menu.Oc&&(document.body.appendChild(this.Lvh),this.KCn())}KCn(){const b=this.Lvh;
var k=this.menu.Oc;b.style.position="absolute";b.style.visibility="hidden";b.style.left=k.style.left;b.style.right=k.style.right;b.style.top=k.style.top;b.style.bottom=k.style.bottom;let t=k.offsetWidth;k=k.offsetHeight;aa.a.Gjb&&(t-=4,k-=4);b.style.width=t.toString()+"px";b.style.height=k.toString()+"px";b.style.visibility="visible"}get Spo(){return this.root.qJb?!1:!0}Q_e(b){b.element&&(b.element.style.filter="",b.element.style.opacity="",this.menu&&this.menu.Oc===b.element&&Object(ob.a)(ti.a,this.menu)&&
Ve.a.RAk(this.a5h()))}a5h(){const b=this.menu.children,k=[];if(Object(ob.a)(ti.a,this.menu))for(let t=0;t<b.count;t++){const D=b.J(t);Array.add(k,D.separator);for(let P=0;P<D.children.count;P++){const ca=D.children.J(P);Array.add(k,ca.Oc)}}return k}ezk(){var b=this.menu.children;for(let t=0;t<b.count;t++){const D=b.J(t).children;for(let P=0;P<D.count;P++){var k=D.J(P);if(Object(ob.a)(tj.a,k)){const ca=k;if("Menu32"===ca.DT||"Menu48"===ca.DT)k=k.control,k.behavior&&(Object(ob.a)(cl.a,k)||Object(ob.a)(uj.a,
k))&&k.behavior.azk()}}}0<b.count&&(b=b.J(0),Hf.c(b.separator)||(b.separator.style.display="none"),Hf.c(b.wle)||Va.a.Xf(b.wle,"cui-menusection-titleAtTop"))}OCn(b){if(!Hf.c(b)){b.style.top="0px";b.style.left="0px";b.style.bottom="";b.style.right="";b.style.width="";b.style.minWidth="";var k=fg.a.create();try{const t=this.WMi.PSl(b),D=this.tOc();let P=this.root.cge(b,t,this.Fu.S3d,D);P||(P=this.WMi.cge(b,t,this.Fu.S3d,D));this.root.XMi=P}finally{k&&k.dispose()}}}tOc(){const b=$d.a.getElementBounds(this.Fu.uIb);
var k=this.TH;Hf.c(k)||Hf.c(k.Oc)||(k=$d.a.getElementBounds(k.Oc),b.x=k.x+Dg.Menu.R3d,b.width=k.width-2*Dg.Menu.R3d);Object(ob.a)(cn.a,this.Fu.A0d)&&(b.height=0);return b}dua(){if(this.Fu.dL){v.ULS.sendTraceTag(6688860,207,50,"Menu closing {0}",{["Id"]:this.Fu.Fh.Id});this.menu.epa();this.$9i();this.dL=!1;this.menu.HIf=!1;this.root.cba(this.control,!0);this.Epj?w.AFrameworkApplication.ta.Z4c(this.Fu.Xfa,this.HJe):this.k5n();this.Fu.Xfa=null;var b=this.Fu.uIb;Va.a.rw(b,Kl.MenuLauncher.HYc);this.Fu.K7a(this.Fu.yu,
!1);Va.a.rw(b,"cui-ctl-menu-hovered-without-focus");this.menu.Ppa();Hf.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.uk,0,!1);this.Z9i()}}k5n(){const b=this.Fu.Xfa;if(b)try{b.focus()}catch(k){}}Z9i(){fc.a.gx(this.menu.Oc);fc.a.gx(this.Jhd);Va.a.$ya(this.menu.Oc)}j1c(b){if(this.uZf&&Va.a.Rr(this.properties.PopulateOnlyOnce)||Hf.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const k=this.Fu.bof();return 0<(this.root.xpa(this.properties.PopulateQueryCommand,
this.properties.PopulateQueryCommand,k,b)&1)?k.PopulationXML:null}JZf(b,k=!1){if(this.uZf&&Va.a.Rr(this.properties.PopulateOnlyOnce))return!0;let t=null;this.f3g=b;Hf.c(b)||(t=this.cal(b));Hf.c(t)||(this.uZf=!0);if(k){this.root.dXk(this.Fu);if(Hf.c(t)||!t.hasItems())return this.dua(),!1;this.$9i();this.Z9i()}this.wio(t);return!0}gTi(){}cal(b){b=og.Builder.RIh(b);if(!Hf.c(b)){const k=new wh.a;k.sEh=!0;k.parentId=this.control.id;let t;t=Object(ob.a)(ik.a,this.control);return this.root.aO.sZa(b,k,t)}return null}wio(b){Hf.c(b)||
(Hf.c(this.menu)||this.menu.dispose(),this.menu=b,this.gTi())}$9i(){const b=this.menu.parent;b?(b.tRc=!0,b.removeChild(this.menu.id),b.tRc=!1):v.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(b){let k=!1;Hf.c(b.Gb)||Hf.c(b.Gb.rawEvent)||Object(ob.a)(tj.a,this.uk)||!b.Gb.rawEvent.altKey||b.Gb.keyCode!==Sys.UI.Key.down||(this.Uw(b.zf,1,b.Gb),k=!0);k||(k=super.onKeyDown(b));return k}ZC(b){this.y8e();2===b.jg&&b.kca!==Sys.UI.MouseButton.leftButton||
this.Uw(b.zf,b.jg,b.Gb);b.Gb.preventDefault();return!1}jwf(b){if(!this.TH||!this.TH.inKeytipMode||!this.Fu.uUi)return!1;this.Fu.uUi(this.uk,b);return!0}static T9k(){const b=Va.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(n.a)(nl,"MenuLauncherBehavior",vb,[740,715]);var Um=c(915);class ak extends nl{constructor(b){super(b)}get Zs(){return this.XJc.properties}get XJc(){return this.control}get WNa(){return this.XJc.WNa}HI(){Sh.a.instance.lb(Rc.a.pointerDown,
this.WNa.Mm,Object(A.a)(this,this.ZC,"onPointerDown"));Zb.KeyInputManager.instance.lb(Rc.a.hi,this.WNa.Mm,Object(A.a)(this,this.onKeyDown,"onKeyDown"));Zb.KeyInputManager.instance.lb(Rc.a.vh,this.WNa.Mm,Object(A.a)(this,this.zy,"onKeyUp"))}xm(){const b=this.Pd[Um.a.SelectedItemId];if(0<(this.fu(this.Zs.Command,this.Zs.QueryCommand,this.Pd)&2)){const k=this.Pd[Um.a.SelectedItemId];Hf.c(k)||b===k||this.XJc.X5c(k)||(this.Pd[Um.a.SelectedItemId]=null)}}}Object(n.a)(ak,"DropDownBehavior",nl,[]);var Vl=
c(518),sk=c(697);class po extends ak{constructor(b){super(b);this.KVa=null;this.qKe=this.cub=this.SAa=!1;this.Cyc=null;this.Ayc=-1}get m3(){return this.control}get oQ(){return this.m3.oQ}get uH(){return this.m3.uH}get xYd(){return this.Pd[Vl.a.IsFreeForm]}set xYd(b){this.Pd[Vl.a.IsFreeForm]=b}HI(b){Sh.a.instance.lb(Rc.a.pointerDown,b.Mm,Object(A.a)(this,this.ZC,"onPointerDown"));const k=b.qr;Ic.a.instance.lb(Rc.a.focus,k,Object(A.a)(this,this.Xlb,"onInputFocus"));Ic.a.instance.lb(Rc.a.blur,k,Object(A.a)(this,
this.rxa,"onInputBlur"));Zb.KeyInputManager.instance.lb(Rc.a.hi,k,Object(A.a)(this,this.ynn,"onInputKeyDown"));Zb.KeyInputManager.instance.lb(Rc.a.Zt,k,Object(A.a)(this,this.znn,"onInputKeyPress"));Kf.a.instance.lb(Rc.a.mca,k,Object(A.a)(this,this.fUf,"onInputMouseUp"));Sh.a.instance.lb(Rc.a.pointerDown,k,Object(A.a)(this,this.Bnn,"onInputPointerDown"));Sh.a.instance.lb(Rc.a.pointerDown,b.sUh,Object(A.a)(this,this.EUf,"onMenuButtonPointerDown"))}xm(){0<(this.fu(this.uH.Command,this.uH.QueryCommand,
this.Pd)&2)&&(this.cub||this.aHj(),this.$So())}gTi(){this.m3.menuItems=null;var b;var k=b=null;if(!Hf.c(this.menu)){this.Hfe();for(let D of this.menu.children)for(let P of D.children)if(Object(ob.a)(tj.a,P)){var t=P;t=t.control;Object(ob.a)(738,t)&&(b=t,b=b.Fh.MenuItemId);Object(ob.a)(712,t)&&(k=t,k=k.u1a());Hf.c(b)||Hf.c(k)||(this.m3.menuItems[k]=b,b=k=null)}}}Bnn(b){Object(ob.a)(401,this.root)&&2===b.jg&&(this.KVa=$d.a.DOa(this.control.yu.ownerDocument),this.control.yu.focus());return!1}ZC(b){this.y8e();
let k=!1;3===b.jg&&(k=super.ZC(b),this.Hfe());k&&b.Gb.preventDefault();return!1}EUf(b){let k=!1;if(2!==b.jg||b.kca===Sys.UI.MouseButton.leftButton)this.Uw(b.zf,b.jg,b.Gb),this.Hfe(),k=!0;k&&b.Gb.preventDefault();return!1}ynn(b){let k=!1;if(!Hf.c(b.Gb)&&!Hf.c(b.Gb.rawEvent)){const t=b.Gb.keyCode;b=b.Gb.rawEvent.shiftKey;Va.a.Rr(this.uH.AutoComplete);if(t===Sys.UI.Key.enter)this.nT(),this.A7f(),Object(ob.a)(sk.Ribbon,this.root)&&this.root.p_(),k=!0;else if(t===Sys.UI.Key.tab){if(this.nT(),this.A7f(),
Object(ob.a)(sk.Ribbon,this.root)&&(k=this.root.fpe(this.uk.Oc,!b)),Object(ob.a)(401,this.root))return!0}else t===Sys.UI.Key.backspace||t===Sys.UI.Key.del?this.control.enabled?(this.H5e(),this.Cyc=null):k=!0:t===Sys.UI.Key.esc?(this.E7f(),this.A7f(),Object(ob.a)(sk.Ribbon,this.root)&&this.root.p_(),k=!0):t===Sys.UI.Key.down&&(this.b0(1),this.Hfe(),k=!0)}return k}znn(b){if(!this.control.enabled)return!0;!Hf.c(b.Gb)&&b.Gb.charCode&&this.phl();return!1}fUf(){return this.SAa?!1:this.SAa=!0}Zvl(){this.Ayc=
-1;const b=this.oQ.qr,k=b.value,t=this.mVl(k);if(t){b.value=t.key;if(b.setSelectionRange)b.setSelectionRange(k.length,b.value.length);else if(b.createTextRange){const D=b.createTextRange();D.moveStart("character",k.length);D.moveEnd("character",b.value.length);D.select()}this.Cyc=t.value}else this.Cyc=null}mVl(b){const k=this.m3.menuItems;for(let t in k){const D={key:t,value:k[t]};if(D.key.toLowerCase().startsWith(b.toLowerCase()))return D}return null}phl(){Va.a.Rr(this.uH.AutoComplete)&&-1===this.Ayc&&
(this.qKe&&(this.j1c(0),this.qKe=!1),this.Ayc=window.setTimeout(Object(A.a)(this,this.Zvl,"executeAutoComplete"),this.m3.$Gk))}H5e(){Va.a.Rr(this.uH.AutoComplete)&&(this.Ayc=Va.a.eAb(this.Ayc))}Xlb(b){if(this.dL)return this.menu.setFocus(0),!0;Object(ob.a)(401,this.root)&&(ad.FocusManager.instance().cD("ribbon"),this.root.FQc=!1);this.onFocus(b);this.cub=!0;Va.a.Xf(this.oQ.Mm,"cui-cb-focus");Va.a.Rr(this.uH.PopulateDynamically)&&(this.qKe=!0);$d.a.T5c(this.oQ.qr);Hf.c(this.menu)||this.menu.ym();return this.SAa=
!1}rxa(){this.cub=!1;this.nT();Va.a.rw(this.oQ.Mm,"cui-cb-focus");return!1}A7f(){Object(ob.a)(401,this.root)&&(void 0!==this.KVa&&null!==this.KVa&&w.AFrameworkApplication.ta.Z4c(this.KVa,2),this.KVa=null)}nT(){if(this.control.enabled){this.H5e();var b=this.oQ.qr;if(void 0===this.Pd[Vl.a.Value]||null===this.Pd[Vl.a.Value]||b.value!==this.Pd[Vl.a.Value].toString())if(this.m3.X5c(this.Cyc))this.xYd=!1,this.Pd[Vl.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.m3.b6c.CDb(),["MenuItemId"]:this.m3.b6c.Fh.MenuItemId},
this.root.executeCommand(this.uH.Command,b,this.uk,0,!1);else{if(!Va.a.Rr(this.uH.AutoComplete)){var k=this.m3.menuItems[b.value];if(!Hf.b(k)&&this.m3.X5c(k)){this.xYd=!1;this.Pd[Vl.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.m3.b6c.CDb(),["MenuItemId"]:k};this.root.executeCommand(this.uH.Command,b,this.uk,0,!1);return}}k=!Hf.b(b.value)&&""!==F.a.gya(b.value);this.m3.vrh&&k?(this.xYd=!0,this.Pd[Vl.a.Value]=b.value,this.root.executeCommand(this.uH.Command,{["IsFreeForm"]:!0,["Value"]:b.value},
this.uk,0,!1)):this.E7f()}}else this.E7f()}E7f(){this.H5e();this.Cyc=null;this.aHj()}aHj(){const b=this.Pd[Vl.a.Value]||"";b!==this.oQ.qr.value&&(this.oQ.qr.value=b);this.m3.X5c(this.m3.menuItems[b])}$So(){const b=this.Pd[Vl.a.FontStyle]||"normal";b!==this.oQ.qr.style.fontStyle&&(this.oQ.qr.style.fontStyle=b)}Hfe(){this.control.yu&&this.menu&&this.control.yu.setAttribute(df.a.Fuh,this.menu.id)}}Object(n.a)(po,"ComboBoxBehavior",ak,[]);class Hp extends nl{constructor(b){super(b)}get CFd(){return this.control}tOc(){let b=
0;this.menu&&this.menu.Oc&&2===this.menu.horizontalAlignment&&(b=this.menu.Oc.clientWidth);return new Sys.UI.Bounds(this.CFd.x-b,this.CFd.y,this.CFd.KIf,this.CFd.JIf)}}Object(n.a)(Hp,"ContextMenuLauncherBehavior",nl,[]);class Bm extends nl{constructor(b){super(b)}get xId(){return this.control}tOc(){return new Sys.UI.Bounds(this.xId.x,this.xId.y,this.xId.KIf,this.xId.JIf)}}Object(n.a)(Bm,"DialogMenuLauncherBehavior",nl,[]);var jk=c(600);class dp extends nl{constructor(b){super(b);this.tKe=!1;this.Cik=
!Va.a.cha(this.Zs.ShouldRefreshWhenDropped)}get XDa(){return this.control}get Zs(){return this.control.Fh}HI(b){b=b.Mm;Hf.c(b)||(Ic.a.instance.lb(Rc.a.focus,b,Object(A.a)(this,this.onFocus,"onFocus")),Ic.a.instance.lb(Rc.a.blur,b,Object(A.a)(this,this.onBlur,"onBlur")),Sh.a.instance.lb(Rc.a.pointerOver,b,Object(A.a)(this,this.fP,"onPointerOver")),Zb.KeyInputManager.instance.lb(Rc.a.hi,b,Object(A.a)(this,this.onKeyDown,"onKeyDown")),Zb.KeyInputManager.instance.lb(Rc.a.vh,b,Object(A.a)(this,this.zy,
"onKeyUp")),Sh.a.instance.lb(Rc.a.pointerDown,b,Object(A.a)(this,this.ZC,"onPointerDown")))}xm(){Hf.c(this.control.Fh.Command)||(this.XDa.dL&&!this.Cik?this.tKe=!0:(0<(this.fu(this.Zs.Command,this.Zs.QueryCommand,this.Pd)&2)&&this.U7a()&&this.cUa(),Va.a.Rr(this.Zs.RefreshableMenu)&&this.dL&&this.menu.DBn()))}cUa(){this.XSo();this.wja();this.ITo();this.XDa.Hyf=this.Pd[jk.a.ImageIsVisible]}XSo(){const b=Va.a.Vqa(this.Pd[jk.a.LabelText],this.Zs.LabelText),k=this.Pd[jk.a.LabelTextUserGeneratedPlaceholderReplacements];
if(this.control.labelText!==b||this.Zs.LabelTextUserGeneratedPlaceholderReplacements!==k)this.WE.medium&&this.YSo(this.WE.medium.rO,b,k),this.root.l4a=!0,this.control.labelText=b,this.Zs.LabelTextUserGeneratedPlaceholderReplacements=k}YSo(b,k,t){const D=b.lastChild;Va.a.Bjj(b,k+" ",t);k=Hf.c(D);v.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",k?"":D.nodeType.toString());k||b.appendChild(D)}ITo(){const b=this.Pd[jk.a.ImageBackColor];this.WE.forEach(k=>
{dp.VCk(k.BQ,b)})}b0(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(w.AFrameworkApplication.Roa("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),w.AFrameworkApplication.va.processAction($a.a.BId,2));"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||w.AFrameworkApplication.va.processAction($a.a.BId,2);Object(ob.a)(tj.a,this.uk)&&(this.dL||this.D7e(!0),this.control.enabled&&
this.FY());super.b0(b)}dua(){super.dua();this.tKe&&(this.tKe=!1,this.xm())}fP(b){return this.control.KHb()?(this.XDa.dL?(this.root.LAh(),Va.a.Xf(this.XDa.uIb,Kl.MenuLauncher.HYc),this.XDa.Xfa=this.control.yu):(super.fP(b),this.Uw(b.zf,b.jg,b.Gb)),!1):super.fP(b)}onKeyDown(b){let k=!1;if(!Hf.c(b.Gb)&&!Hf.c(b.Gb.rawEvent)){if(Object(ob.a)(tj.a,this.uk)){const t=b.Gb.rawEvent,D=b.Gb.keyCode,P=0===this.root.c1;t.shiftKey||t.ctrlKey||!(D===Sys.UI.Key.right&&P||D===Sys.UI.Key.left&&!P)||(k=this.jwf(b),
k||(this.Uw(b.zf,1,b.Gb),k=!0))}k||(k=super.onKeyDown(b))}return k}static VCk(b,k){Hf.c(b)||Hf.c(k)||b.style.backgroundColor===k||(b.style.backgroundColor=k)}}Object(n.a)(dp,"FlyoutAnchorBehavior",nl,[]);var Mi=c(943);class Cq extends vb{constructor(b){super(b)}get F6b(){return this.control}get properties(){return this.F6b.properties}get vfa(){return this.F6b.vfa}HI(b){b=b.lCb;Ic.a.instance.lb(Rc.a.focus,b,Object(A.a)(this,this.onFocus,"onFocus"));Ic.a.instance.lb(Rc.a.blur,b,Object(A.a)(this,this.onBlur,
"onBlur"));Sh.a.instance.lb(Rc.a.pointerOver,b,Object(A.a)(this,this.fP,"onPointerOver"));Sh.a.instance.lb(Rc.a.pointerOut,b,Object(A.a)(this,this.yJ,"onPointerOut"));Zb.KeyInputManager.instance.lb(Rc.a.hi,b,Object(A.a)(this,this.onKeyDown,"onKeyDown"));Zb.KeyInputManager.instance.lb(Rc.a.vh,b,Object(A.a)(this,this.zy,"onKeyUp"));Sh.a.instance.lb(Rc.a.pointerDown,b,Object(A.a)(this,this.ZC,"onPointerDown"));Sh.a.instance.lb(Rc.a.QM,b,Object(A.a)(this,this.vxa,"onPointerUp"));Wb.a.instance.lb(Rc.a.uP,
b,Object(A.a)(this,this.lmb,"onTouchMove"));Wb.a.instance.lb(Rc.a.NJ,b,Object(A.a)(this,this.yGa,"onTouchEnd"))}xm(){const b=this.Pd[Mi.a.On],k=this.Pd[Mi.a.IsRtl];this.GGj();if(0<(this.fu(this.properties.Command,this.properties.QueryCommand,this.Pd)&2)){var t=!Hf.c(this.Pd[Mi.a.InnerHTML])||!Hf.c(this.properties.InnerHTML),D=!Hf.c(this.properties.Image);t||D||(this.control.enabled=!1);D=this.vfa.lCb;if(!Hf.c(D)){if(t){t=Va.a.Vqa(this.Pd[Mi.a.InnerHTML],this.properties.InnerHTML);if(null===D.innerHTML||
null===t||F.a.Tg(D.innerHTML)!==F.a.Tg(t))D.innerHTML=t;""===t&&(this.control.enabled=!1)}t=D.title;const P=Va.a.Vqa(this.Pd[Mi.a.Alt],this.properties.Alt);P===t||this.control.Zcg||(D.title=P)}D=this.Pd[Mi.a.IsRtl];b===this.Pd[Mi.a.On]&&k===D||this.control.CKb()}}GGj(){const b=this.Pd;b[Mi.a.CommandValueId]=this.control.CDb();b.MenuItemId=this.control.Fh.MenuItemId;b.SourceControlId=this.properties.Id}Uw(b,k,t){if((b=this.uk)&&this.control.enabled){const D=this.root;if(w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.$("ExcelBorderMenuCompactionEnabled")&&b.AUc()&&this.TH){const P=D.XC[this.TH.tqa];P?P.NSa(this.F6b):v.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.GGj();this.Pd[Mi.a.On]||(this.Pd[Mi.a.On]=!0,this.control.CKb());"Menu"===b.DT&&Va.a.rw(this.vfa.Mm,"cui-gallerybutton-focused");D.executeCommand(this.properties.Command,this.Pd,b,k,!0,null,this.BX(t))}}onFocus(b){super.onFocus(b);Va.a.Xf(this.vfa.Mm,
"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);Va.a.rw(this.vfa.Mm,"cui-gallerybutton-focused");return!1}}Object(n.a)(Cq,"GalleryButtonBehavior",vb,[]);var un=c(1123),Bl=c(1376),nt=c(637);class ws extends vb{constructor(b){super(b);this.XWa=-1}get f$b(){return this.control}get properties(){return this.f$b.Fh}get EGc(){return this.f$b.EGc}get ayf(){var b=null;if(this.uk&&(b=this.uk.parent,!Object(ob.a)(nt.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get kGb(){return this.f$b.CWd.kGb}get h0c(){return this.f$b.CWd.h0c}Uw(b,
k,t){if(this.control.enabled){b=this.Kqf(this.V6b(b));const D=this.YNd(b);this.EGc[Bl.a.Rows]=this.IRd(b)+1;this.EGc[Bl.a.Columns]=D+1;this.root.executeCommand(this.properties.Command,this.EGc,this.uk,k,!0,null,this.BX(t))}}HI(b){var k=b.Mm;const t=b.yBh;b=b.cells;Sh.a.instance.lb(Rc.a.pointerOut,k,Object(A.a)(this,this.Vkn,"onControlPointerOut"));Wb.a.instance.lb(Rc.a.uP,k,Object(A.a)(this,this.Xkn,"onControlTouchMove"));Wb.a.instance.lb(Rc.a.NJ,k,Object(A.a)(this,this.Wkn,"onControlTouchEnd"));
for(k=0;k<b.length;++k)this.wGk(t[k],b[k])}wGk(b,k){Ic.a.instance.lb(Rc.a.focus,b,Object(A.a)(this,this.RSf,"onCellFocus"));Sh.a.instance.lb(Rc.a.pointerOver,k,Object(A.a)(this,this.SSf,"onCellPointerOver"));Sh.a.instance.lb(Rc.a.QM,k,Object(A.a)(this,this.TSf,"onCellPointerUp"));Zb.KeyInputManager.instance.lb(Rc.a.hi,k,Object(A.a)(this,this.onKeyDown,"onKeyDown"));Zb.KeyInputManager.instance.lb(Rc.a.vh,k,Object(A.a)(this,this.zy,"onKeyUp"));Wb.a.instance.lb(Rc.a.vP,k,Object(A.a)(this,this.Ujn,"onCellTouchStart"))}Kqf(b){return parseInt(b.id.substr(this.f$b.id.length+
1))}Oki(b){this.Nki(this.Kqf(b))}IRd(b){return Math.floor(b/un.a.IZc)}YNd(b){return b%un.a.IZc}Nki(b){if(b!==this.XWa){var k=this.YNd(b),t=this.IRd(b),D=-1;let P=-1;-1!==this.XWa&&(D=this.IRd(this.XWa),P=this.YNd(this.XWa));for(;D!==t||P!==k;)D<t?this.Plj(++D,P,!0):D>t?(this.Plj(D,P,!1),D--):P<k?this.ojj(++P,D,!0):P>k&&(this.ojj(P,D,!1),P--);this.ayf?this.ayf.Emj(this.L4h(t+1,k+1)):(t=(k=this.control.J8e)&&0<k.length?k[0]:null,D=this.uk,v.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",
{["CtrlComps"]:!!k,["FirstComp"]:!!t,["FirstCompPar"]:!!t&&!!t.parent,["DispComp"]:!!D,["DispCompPar"]:!!D&&!!D.parent}));this.XWa=b}}Plj(b,k,t){for(let D=0;D<=k;D++)this.gjj(b,D,t)}ojj(b,k,t){for(let D=0;D<=k;D++)this.gjj(D,b,t)}gjj(b,k,t){k=b*un.a.IZc+k;b=this.kGb[k];k=this.h0c[k];t?(b.className="cui-it-activeCell",k.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",k.className="cui-it-inactiveCellOuter")}TSf(b){this.Uw(b.zf,b.jg,b.Gb);return!0}V6b(b){for(;b.hasChildNodes();)b=
b.childNodes[0];return Hf.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}Fmj(b){const k=this.Kqf(b);b.childNodes[0].childNodes[0].title=this.L4h(this.IRd(k)+1,this.YNd(k)+1)}L4h(b,k){let t=this.properties.Alt;Hf.c(t)&&(t=this.properties.MenuSectionTitle);return t=String.format(t,k.toString(),b.toString())}ghc(){if(this.uk){for(var b=0;b<un.a.$dc;b++)this.kGb[b].className="cui-it-inactiveCell",this.h0c[b].className="cui-it-inactiveCellOuter";this.XWa=-1;b=this.properties.MenuSectionInitialTitle;
Hf.c(b)&&(b="");this.ayf.Emj(b)}}SSf(b){this.control.enabled&&(b=this.V6b(b.zf),this.F6c(b),this.kff(b));return!1}kff(b){this.Fmj(b);this.Oki(b)}RSf(b){if(!this.control.enabled)return!1;b=this.V6b(b.zf);this.Fmj(b);this.Oki(b);return!1}Vkn(b){$d.a.aFf(this.f$b.CWd.Mm,b.clientPoint)||this.ghc();return!1}Ujn(b){if(!this.control.enabled)return!1;b=this.V6b(b.zf);this.kff(b);return!0}Xkn(b){if(!this.control.enabled)return!1;b=$d.a.NOd(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=
this.V6b(b))?this.kff(b):this.ghc();return!0}Wkn(b){if(!this.control.enabled)return!1;var k=$d.a.NOd(b.clientPoint);if(!k||"table"===k.tagName.toLowerCase())return this.ghc(),!0;(k=this.V6b(k))?this.Uw(k,3,b.Gb):this.ghc();return!0}LK(b){b=Ui.Control.Xkf(this.XWa,un.a.IZc,un.a.$dc,b);if(b!==this.XWa)return this.kGb[b].firstChild.focus(),this.Nki(b),!0;this.ghc();this.XWa=-1;return!1}FY(){const b=this.kGb[0];if(Hf.c(b))return!1;b.firstChild.focus();return!0}F6c(b){if(Hf.c(b))return!1;b.firstChild.firstChild.focus();
return!0}epa(){this.ghc()}}Object(n.a)(ws,"InsertTableBehavior",vb,[]);class Mr extends nl{constructor(b){super(b)}xm(){this.control.enabled=!!this.menu}Uw(b,k,t){w.AFrameworkApplication.va.Qb($a.a.HQa,2,k,this.BX(t))}}Object(n.a)(Mr,"JewelMenuLauncherBehavior",nl,[]);var Zp=c(1059);class kq extends vb{constructor(b){super(b)}get properties(){return this.control.Fh}xm(){0<(this.fu(this.properties.Command,this.properties.QueryCommand,this.Pd)&2)&&this.U7a()&&this.cUa()}cUa(){this.$Wo();this.wja();
this.FQb()}$Wo(){const b=this.control.labelText;let k=this.Pd[Zp.a.Value];Hf.c(k)&&(k=this.properties.LabelText,Hf.c(k)&&(k=""));k!==b&&this.uge(k)}HI(b){b=b.Mm;Hf.c(b)||(Sh.a.instance.lb(Rc.a.pointerDown,b,Object(A.a)(this,this.ZC,"onPointerDown")),Sh.a.instance.lb(Rc.a.pointerOver,b,Object(A.a)(this,this.fP,"onPointerOver")),Sh.a.instance.lb(Rc.a.pointerOut,b,Object(A.a)(this,this.yJ,"onPointerOut")))}}Object(n.a)(kq,"LabelBehavior",vb,[]);var xs=c(865),lm=c(210),Ak=c(300);class Xi extends nl{constructor(b){super(b);
this.DDe=this.mve=!1;this.oVb=this.RRb=null;if(this.SVb=w.AFrameworkApplication.K.$("TellMeRedesignIsEnabled"))this.RRb=this.gu.Dia.LightImage16by16Class,this.oVb=this.gu.Dia.DarkImage16by16Class}get gu(){return this.control}p5d(b,k,t,D){k&&(this.gu.Xfa=t,w.AFrameworkApplication.ta.m6a());if(Object(ob.a)(lm.a,b)&&D){t=new xs.a;t.CommandLocation=this.root.y9;t.InvocationMethod=0;const P={};(b=b.control)&&b.Fh&&(P.CommandId=b.Fh.Command,P.ControlId=b.Fh.Id,P.CloseAllMenus=k,b.TH&&b.TH.parent&&b.TH.parent.id&&
(P.ParentControlId=b.TH.parent.id.split("-")[0]),this.root.zF&&this.root.zF.kOa(D,P,t))}}dua(){this.gu.Xfa||(this.gu.Xfa=this.gu.oy);!this.gu.Gcn&&this.SVb&&(Va.a.rw(this.gu.oy,"cui-sb-focus"),Va.a.rw(this.gu.k1,"cui-sb-focus"),Va.a.rw(this.gu.uya,this.RRb),Va.a.Xf(this.gu.uya,this.oVb));this.mve=!0;super.dua();this.mve=!1;this.w2f()}get Epj(){return!this.gu.URa}a7d(){this.gu.a7d()}Ube(){this.DDe||this.mve||(this.DDe=!0,this.gu.raiseEvent(Ak.a.r2a,null))}w2f(){this.dL||this.gu.Zzf||(this.DDe=!1,this.gu.raiseEvent(Ak.a.BGb,
null))}dUf(b){Va.a.rw(this.gu.oy,"cui-sb-focus");Va.a.rw(this.gu.k1,"cui-sb-focus");this.SVb&&!this.gu.dL&&(Va.a.rw(this.gu.uya,this.RRb),Va.a.Xf(this.gu.uya,this.oVb));this.gu.raiseEvent(Ak.a.blur,b);this.w2f();this.gu.Xfa=this.gu.oy;return!1}eUf(b){Va.a.Xf(this.gu.oy,"cui-sb-focus");Va.a.Xf(this.gu.k1,"cui-sb-focus");this.SVb&&(Va.a.rw(this.gu.uya,this.oVb),Va.a.Xf(this.gu.uya,this.RRb));this.gu.raiseEvent(Ak.a.focus,b);this.Ube();return!1}IVf(){this.SVb&&(Va.a.Xf(this.gu.k1,"cui-sb-hover"),Va.a.Xf(this.gu.oy,
"cui-sb-hover"),Va.a.rw(this.gu.uya,this.oVb),Va.a.Xf(this.gu.uya,this.RRb));return!1}HVf(){this.SVb&&(Va.a.rw(this.gu.k1,"cui-sb-hover"),Va.a.rw(this.gu.oy,"cui-sb-hover"),this.gu.dL||this.gu.Zzf||(Va.a.rw(this.gu.uya,this.RRb),Va.a.Xf(this.gu.uya,this.oVb)));return!1}}Object(n.a)(Xi,"SearchBoxBehavior",nl,[757,715]);class Nj{}Nj.Value="value";Nj.MinValue="MinValue";Nj.MaxValue="MaxValue";Nj.Text="Text";Object(n.a)(Nj,"SliderCommandProperties",null,[]);class Ii extends vb{constructor(b){super(b)}get Weg(){return this.control}get j5(){return this.Weg.j5}get properties(){return this.control.Fh}initialize(){}Uw(){}HI(b){b=
b.qr;Ic.a.instance.lb(Rc.a.focus,b,Object(A.a)(this,this.onFocus,"onFocus"));Ic.a.instance.lb(Rc.a.blur,b,Object(A.a)(this,this.onBlur,"onBlur"));Ic.a.instance.lb(Rc.a.change,b,Object(A.a)(this,this.qca,"onChange"));Ic.a.instance.lb(Rc.a.input,b,Object(A.a)(this,this.qca,"onChange"))}onFocus(b){this.j5.Mm&&Sys.UI.DomElement.addCssClass(this.j5.Mm,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.j5.Mm&&Sys.UI.DomElement.removeCssClass(this.j5.Mm,"cui-sldr-onfocus");return super.onBlur(b)}qca(){this.a1k(this.j5.qr.value);
return!0}a1k(b){this.Pd[Nj.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Pd,this.uk,0,!1)}xm(){const b=this.Pd[Nj.Value],k=this.Pd[Nj.MaxValue],t=this.Pd[Nj.Text];var D=this.fu(this.properties.Command,this.properties.QueryCommand,this.Pd);this.j5&&this.j5.qr&&(this.j5.qr.disabled=!this.control.enabled);if(0<(D&2)){D=this.Pd[Nj.Value];const P=this.Pd[Nj.MaxValue],ca=this.Pd[Nj.Text];(P!==k||D!==b||t!==ca)&&this.j5&&this.j5.qr&&(this.j5.qr.setAttribute(df.a.WAd,String.format("{0}",
P)),this.j5.qr.setAttribute("max",String.format("{0}",P)),this.j5.qr.value=D,this.j5.rO.innerText=this.Pd[Nj.Text])}}}Object(n.a)(Ii,"SliderBehavior",vb,[]);var Dh=c(1370);class rm extends vb{constructor(b){super(b);this.wpd=0;this.Tcb=null;this.Kmd=!1;this.vkh=null;this.ySe=!1;this.Bsd=this.Vqd=-1;this.SAa=!1}get spinner(){return this.control}get NG(){return this.spinner.NG}get properties(){return this.control.Fh}initialize(){const b=this.spinner.Png;this.vkh=this.OOo(b);this.wpd=b[0].min;this.Tcb=
b[0];this.Kmd=!1}Uw(){}HI(b){const k=b.qr,t=b.j5b;b=b.hKc;Ic.a.instance.lb(Rc.a.focus,k,Object(A.a)(this,this.onFocus,"onFocus"));Ic.a.instance.lb(Rc.a.blur,k,Object(A.a)(this,this.onBlur,"onBlur"));Zb.KeyInputManager.instance.lb(Rc.a.hi,k,Object(A.a)(this,this.onKeyDown,"onKeyDown"));Zb.KeyInputManager.instance.lb(Rc.a.Zt,k,Object(A.a)(this,this.FG,"onKeyPress"));Zb.KeyInputManager.instance.lb(Rc.a.vh,k,Object(A.a)(this,this.zy,"onKeyUp"));Ic.a.instance.lb(Rc.a.change,k,Object(A.a)(this,this.qca,
"onChange"));Kf.a.instance.lb(Rc.a.mca,k,Object(A.a)(this,this.fUf,"onInputMouseUp"));Sh.a.instance.lb(Rc.a.pointerDown,t,Object(A.a)(this,this.WRi,"onArrowPointerDown"));Sh.a.instance.lb(Rc.a.pointerDown,b,Object(A.a)(this,this.WRi,"onArrowPointerDown"));Sh.a.instance.lb(Rc.a.QM,t,Object(A.a)(this,this.XRi,"onArrowPointerUp"));Sh.a.instance.lb(Rc.a.QM,b,Object(A.a)(this,this.XRi,"onArrowPointerUp"));Wb.a.instance.lb(Rc.a.uP,t,Object(A.a)(this,this.ZRi,"onArrowTouchMove"));Wb.a.instance.lb(Rc.a.uP,
b,Object(A.a)(this,this.ZRi,"onArrowTouchMove"));Wb.a.instance.lb(Rc.a.NJ,t,Object(A.a)(this,this.YRi,"onArrowTouchEnd"));Wb.a.instance.lb(Rc.a.NJ,b,Object(A.a)(this,this.YRi,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);Va.a.Xf(this.NG.Mm,"cui-spn-focus");this.control.enabled&&$d.a.T5c(this.NG.qr);return this.SAa=!1}onBlur(b){super.onBlur(b);Va.a.rw(this.NG.Mm,"cui-spn-focus");return!1}onKeyDown(b){let k=!1;if(!Hf.c(b.Gb)&&!Hf.c(b.Gb.rawEvent)){const t=b.Gb.keyCode,D=b.Gb.rawEvent.shiftKey;if(t===
Sys.UI.Key.up||t===Sys.UI.Key.down)this.root.lCf(this.control)||this.luj(t===Sys.UI.Key.up,b.jg),k=!0;else if(t===Sys.UI.Key.enter)this.nT(),Object(ob.a)(sk.Ribbon,this.root)&&this.root.p_(),k=!0;else if(t===Sys.UI.Key.tab)this.nT(),Object(ob.a)(sk.Ribbon,this.root)&&(k=this.root.fpe(this.uk.Oc,!D));else if(t===Sys.UI.Key.esc)this.ihc(),Object(ob.a)(sk.Ribbon,this.root)&&this.root.p_(),k=!0;else if(t===Sys.UI.Key.backspace||t===Sys.UI.Key.del)k=!this.control.enabled}return k}FG(){return!this.control.enabled}zy(){this.Sfl();
return!1}qca(){this.nT();return!1}fUf(){return this.SAa?!1:this.SAa=!0}WRi(b){var k=!1;let t=!0;2===b.jg&&(t=b.kca===Sys.UI.MouseButton.leftButton);t&&(k=b.zf,this.luj(k===this.NG.j5b||k===this.NG.DUh||k===this.NG.CUh,b.jg),k=!0);return k}XRi(b){return this.Iua(b)}ZRi(b){return this.O5d(b)}YRi(b){return this.Iua(b)}tum(b){if(this.control.enabled){var k=!1;if(!this.Kmd){var t=this.GYl(b);t=b?t+this.Tcb.step:t-this.Tcb.step;t=Math.min(t,this.Tcb.max);t=Math.max(t,this.Tcb.min);t!==this.wpd&&(this.x8e(t,
this.Tcb),this.root.executeCommand(this.properties.Command,this.Pd,this.uk,0,!1),k=!0)}k||(k=this.properties.SpinCommand,t=this.Pd,t.Increment=b,Hf.c(k)||this.root.executeCommand(k,t,this.uk,0,!1))}}GYl(b){const k=Math.pow(10,w.AFrameworkApplication.numberFormat.w5d),t=Math.round(this.Tcb.step*k);let D=Math.round(this.wpd*k)/t;D=b?Math.floor(D):Math.ceil(D);return D*t/k}luj(b,k){if(this.control.enabled){this.nT();const t=b?this.NG.j5b:this.NG.hKc;switch(k){case 2:case 3:this.ySe=b;this.xyd(t);break;
case 1:this.ySe=b,this.dpk(t)}}}Ruj(){this.MAh();this.jSk()}wPh(){-1===this.Vqd&&(this.Vqd=window.setTimeout(Object(A.a)(this,this.m1n,"repeatSpin"),500))}MAh(){this.Vqd=Va.a.eAb(this.Vqd)}m1n(){this.MAh();-1===this.Bsd&&(this.jje(),this.Bsd=window.setInterval(Object(A.a)(this,this.jje,"spin"),50))}jSk(){this.Bsd=Va.a.fSk(this.Bsd)}jje(){this.tum(this.ySe)}dpk(b){this.root.ifa(this.control,!1);Va.a.Xf(b,Ui.Control.Ayd);this.jje();this.wPh()}Sfl(){this.root.cba(this.control,!1);this.Ruj();Va.a.rw(this.NG.j5b,
Ui.Control.Ayd);Va.a.rw(this.NG.hKc,Ui.Control.Ayd)}Jic(b){this.NG.qr.value!==b&&(this.NG.qr.value=b)}ihc(){this.Jic(this.Pd[Dh.a.Text])}Ejj(b){this.Jic(b);this.Pd[Dh.a.Text]=b;this.Kmd=!0}afo(b,k,t){this.Jic(t);this.Pd[Dh.a.Text]=t;this.Pd[Dh.a.Number]=b;this.Pd[Dh.a.UnitType]=k.type;this.wpd=b;this.Tcb=k;this.NG.qr.setAttribute(df.a.W1e,t);this.NG.qr.setAttribute(df.a.Muh,String.format("{0}",k.min));this.NG.qr.setAttribute(df.a.WAd,String.format("{0}",k.max));this.Kmd=!1}iGh(b){var k;if(({Nfn:k}=
this.MQm(b)).returnValue)this.Ejj(k);else{({number:b,G7a:k}=F.a.l_i(b,this.vkh,w.AFrameworkApplication.numberFormat));let t=this.Tme(k);0===k&&Hf.c(t)&&(t=this.Tme(this.Pd[Dh.a.UnitType]));this.x8e(b,t)}}x8e(b,k){b=this.cRf(b,k);if(isNaN(b)||Hf.c(k))this.ihc();else{const t=w.AFrameworkApplication.numberFormat;let D;D=F.a.$Da(b,k.type,t);D=D.replace(6===k.type?t.x5d:t.KYf,"");this.afo(b,k,D)}}MQm(b){let k,t=!1;k="";b=b.trim();const D=this.spinner.iIj;if(!Hf.c(D))for(let P=0;P<D.length;P++)if(D[P].toLowerCase()===
b.toLowerCase()){k=D[P];t=!0;break}return{returnValue:t,Nfn:k}}cRf(b,k){return isNaN(b)||Hf.c(k)?Number.NaN:k.cRf(b)}Tme(b){let k=null;const t=this.spinner.Png;for(let D=0;D<t.length;D++)if(t[D].type===b){k=t[D];break}return k}OOo(b){const k=b.length,t=Array(k);for(let D=0;D<k;D++)t[D]=b[D].type;return t}nT(){if(this.control.enabled){const b=this.Pd[Dh.a.Text],k=this.NG.qr.value;k!==b&&(this.iGh(k),this.Pd[Dh.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Pd,this.uk,0,!1))}else this.ihc()}xm(){var b=
this.Pd[Dh.a.Text],k=this.Pd[Dh.a.Number];const t=this.Pd[Dh.a.UnitType],D=this.Pd[Dh.a.MaxValue];if(0<(this.fu(this.properties.Command,this.properties.QueryCommand,this.Pd)&2)){const P=this.Pd[Dh.a.Text],ca=this.Pd[Dh.a.Number],ta=this.Pd[Dh.a.UnitType],Na=this.Pd[Dh.a.MaxValue];Na!==D&&(this.Tme(ta).max=Na,this.NG.qr.setAttribute(df.a.WAd,String.format("{0}",Na)));P!==b?""===P?this.Ejj(P):this.iGh(P):isNaN(ca)||ca===k&&ta===t||this.x8e(ca,this.Tme(ta));b=this.NG.Mm.title;k=Va.a.Vqa(this.Pd[Dh.a.Alt],
this.properties.Alt);k!==b&&(this.NG.qr.title=k,this.NG.j5b.title=k,this.NG.hKc.title=k)}}YXe(b){super.YXe(b);b?(this.jje(),this.wPh()):this.Ruj()}}Object(n.a)(rm,"SpinnerBehavior",vb,[717,715]);var rp=c(404),Gn=c(881);class Ll extends nl{constructor(b){super(b);this.RWb=!0;this.xrb=!1}get m5(){return this.control}get Zs(){return this.m5.properties}HI(b){const k=b.Mm,t=b.Wfb;b=b.jKc;Ic.a.instance.lb(Rc.a.focus,k,Object(A.a)(this,this.onFocus,"onFocus"));Ic.a.instance.lb(Rc.a.blur,k,Object(A.a)(this,
this.onBlur,"onBlur"));Zb.KeyInputManager.instance.lb(Rc.a.hi,k,Object(A.a)(this,this.onKeyDown,"onKeyDown"));Zb.KeyInputManager.instance.lb(Rc.a.vh,k,Object(A.a)(this,this.zy,"onKeyUp"));aa.a.Xt&&16>this.yTl()&&(Sh.a.instance.lb(Rc.a.pointerDown,k,Object(A.a)(this,this.NWi,"onSplitbuttonPointerDownPointerUp")),Sh.a.instance.lb(Rc.a.QM,k,Object(A.a)(this,this.NWi,"onSplitbuttonPointerDownPointerUp")));Sh.a.instance.lb(Rc.a.pointerOver,t,Object(A.a)(this,this.Fjn,"onButtonPointerOver"));Sh.a.instance.lb(Rc.a.pointerOut,
t,Object(A.a)(this,this.Ejn,"onButtonPointerOut"));Sh.a.instance.lb(Rc.a.pointerDown,t,Object(A.a)(this,this.mSi,"onButtonPointerDown"));Sh.a.instance.lb(Rc.a.QM,t,Object(A.a)(this,this.nSi,"onButtonPointerUp"));Wb.a.instance.lb(Rc.a.uP,t,Object(A.a)(this,this.Hjn,"onButtonTouchMove"));Wb.a.instance.lb(Rc.a.NJ,t,Object(A.a)(this,this.Gjn,"onButtonTouchEnd"));Sh.a.instance.lb(Rc.a.pointerDown,b,Object(A.a)(this,this.EUf,"onMenuButtonPointerDown"));Sh.a.instance.lb(Rc.a.pointerOver,b,Object(A.a)(this,
this.xon,"onMenuButtonPointerOver"));Sh.a.instance.lb(Rc.a.pointerOut,b,Object(A.a)(this,this.won,"onMenuButtonPointerOut"))}Uw(b,k,t){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.xrb&&(this.m5.on=!this.m5.on,b=this.Pd,b.CommandValueId=this.control.CDb(),this.root.executeCommand(this.Zs.Command,b,this.uk,k,!0,null,this.BX(t))):this.RWb&&super.Uw(b,k,t)}zy(b){const k=b.Gb.keyCode;return k===Sys.UI.Key.enter||k===Sys.UI.Key.space?(b=this.Pd,b.CommandValueId=this.control.CDb(),this.root.executeCommand(this.Zs.Command,
b,this.uk,1,!0),!0):super.zy(b)}xm(){const b=this.root.xpa(this.Zs.Command,this.Zs.QueryCommand,this.Pd),k=0<(b&1);let t=!0;t=Hf.c(this.Zs.CommandMenuOpen)?k:0<(this.root.xpa(this.Zs.CommandMenuOpen,null,null)&1);if(t!==this.RWb||k!==this.xrb||(t||k)!==this.control.enabled)this.control.enabled=t||k,k!==this.xrb&&this.Qln(k),t!==this.RWb&&this.Rln(t),this.RWb=t,this.xrb=k;if(0<(b&2)){this.wja();const D=Va.a.Vqa(this.Pd[Gn.a.LabelText],this.Zs.LabelText);this.Pd[Gn.a.ApplyLabelTextToControlOnly]?this.m5.s6b(P=>
{P.Mm.title=D;P.Wfb.removeAttribute("title");P.jKc.removeAttribute("title")}):this.m5.s6b(P=>{P.Wfb.title=D});this.Pd[Gn.a.EnsureControlRoleIsButton]&&this.m5.s6b(P=>{df.a.gr(P.Mm,df.a.qh,df.a.e3)});Hf.c(this.Pd[Gn.a.Visible])||this.U7a()&&this.cUa()}this.m5.setState(this.m5.on&&k)}cUa(){this.qmg();this.FQb();this.wja()}Rln(b){this.m5.s6b(k=>{Va.a.fob(k.jKc,b)});this.P3c();this.RWb=b}Qln(b){this.m5.s6b(k=>{Va.a.fob(k.Wfb,b)});this.P3c();this.xrb=b}P3c(){const b=this.m5.phb();Hf.c(b)||(Va.a.rw(b.childNodes[0],
"cui-ctl-split-hovered-primary"),Va.a.rw(b.childNodes[0],"cui-ctl-split-hovered-secondary"),Va.a.rw(b.childNodes[1],"cui-ctl-split-hovered-primary"),Va.a.rw(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}NWi(b){if(0!==rp.a(b.Gb))return!1;let k=!1;b.eventName===Rc.a.pointerDown?k=this.mSi(b):b.eventName===Rc.a.QM&&(k=this.nSi(b));return k}mSi(b){let k=!1;const t=b.jg;switch(t){case 3:this.Gso()?this.Uw(this.uk.Oc,t,b.Gb):this.xyd(this.m5.gSh);k=!0;break;case 2:b.kca===Sys.UI.MouseButton.leftButton&&
(this.xyd(this.m5.gSh),k=!0)}k&&b.Gb.preventDefault();return!1}Gso(){const b=this.uk.DT;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}nSi(b){return this.Iua(b)}Hjn(b){return this.O5d(b)}Gjn(b){return this.Iua(b)}onFocus(b){super.onFocus(b);this.Pxf(!0,!0);return!1}onBlur(b){super.onFocus(b);this.P3c();return!1}Fjn(){this.control.enabled&&this.xrb&&this.Pxf(!0,this.m5.on);return!1}Ejn(){this.control.enabled&&this.xrb&&this.P3c();return!1}EUf(b){let k=!1;if(2!==b.jg||b.kca===Sys.UI.MouseButton.leftButton)this.Uw(b.zf,
b.jg,b.Gb),k=!0;k&&b.Gb.preventDefault();return!1}xon(){this.control.enabled&&this.RWb&&this.Pxf(this.m5.on,!0);return!1}won(){this.P3c();return!1}Pxf(b,k){const t=this.control.phb();Hf.c(t)||(Va.a.Xf(t.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),Va.a.Xf(t.childNodes[1],k?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}yTl(){var b=aa.a.Z4b;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(n.a)(Ll,"SplitButtonBehavior",nl,[]);
var Mk=c(1375);class jg extends vb{constructor(b){super(b);this.cub=this.SAa=!1;this.m1j=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("ExcelTableRenameEnabled")}get textBox(){return this.control}get mda(){return this.textBox.mda}get aig(){return this.textBox.Fh}HI(b){b=b.qr;Ic.a.instance.lb(Rc.a.focus,b,Object(A.a)(this,this.onFocus,"onFocus"));Ic.a.instance.lb(Rc.a.blur,b,Object(A.a)(this,this.onBlur,"onBlur"));Zb.KeyInputManager.instance.lb(Rc.a.hi,b,Object(A.a)(this,this.onKeyDown,
"onKeyDown"));Zb.KeyInputManager.instance.lb(Rc.a.Zt,b,Object(A.a)(this,this.FG,"onKeyPress"));Zb.KeyInputManager.instance.lb(Rc.a.vh,b,Object(A.a)(this,this.zy,"onKeyUp"));Ic.a.instance.lb(Rc.a.change,b,Object(A.a)(this,this.qca,"onChange"));Kf.a.instance.lb(Rc.a.mca,b,Object(A.a)(this,this.zRa,"onMouseUp"))}onFocus(b){super.onFocus(b);this.cub=!0;Va.a.Xf(this.mda.Mm,"cui-tb-focus");this.control.enabled&&$d.a.T5c(this.mda.qr);return this.SAa=!1}onBlur(b){this.cub=!1;super.onBlur(b);Va.a.rw(this.mda.Mm,
"cui-tb-focus");return!1}onKeyDown(b){let k=super.onKeyDown(b);if(!Hf.c(b.Gb)&&!Hf.c(b.Gb.rawEvent)){const t=b.Gb.keyCode,D=b.Gb.rawEvent.shiftKey;t===Sys.UI.Key.tab?(this.nT(),Object(ob.a)(sk.Ribbon,this.root)&&(k=this.root.fpe(this.uk.Oc,!D))):t===Sys.UI.Key.enter?this.m1j&&(this.nT(),Object(ob.a)(sk.Ribbon,this.root)&&this.root.p_(),k=!0):t===Sys.UI.Key.esc?(this.ihc(),Object(ob.a)(sk.Ribbon,this.root)&&this.root.p_(),k=!0):t===Sys.UI.Key.backspace||t===Sys.UI.Key.del?k=!this.control.enabled:b.fua&&
(vf.a.IAh(b.Gb),k=!1)}return k}FG(){return!this.control.enabled}zy(){return!1}qca(){this.nT();return!1}zRa(){return this.mda.isEditable?this.SAa?!1:this.SAa=!0:($d.a.T5c(this.mda.qr),!0)}Jic(b){this.mda.qr.value!==b&&(this.mda.qr.value=b)}ihc(){this.Jic(this.Pd[Mk.a.Text])}nT(){if(this.control.enabled&&this.mda.isEditable){const b=this.mda.qr.value;b!==this.Pd[Mk.a.Text]&&(this.Pd[Mk.a.Text]=b,this.root.executeCommand(this.aig.Command,this.Pd,this.uk,0,!1))}else this.ihc()}xm(){const b=this.Pd[Mk.a.Text];
if(0<(this.fu(this.aig.Command,this.aig.QueryCommand,this.Pd)&2)&&!this.cub){const k=this.Pd[Mk.a.Text];k!==b&&this.Jic(k)}}}Object(n.a)(jg,"TextBoxBehavior",vb,[714,715]);var Wl=c(385);class ui extends vb{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.Fh}Uw(b,k,t){this.control.enabled&&(Va.a.cha(this.properties.TogglesWhenExecuted)||this.toggle(),this.Pd.CommandValueId=this.toggleButton.CDb(),this.Pd.MenuItemId=this.toggleButton.Fh.MenuItemId,
this.Pd.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Pd,this.uk,k,!Va.a.cha(this.properties.CloseMenuWhenExecuted),D=>{Va.a.Rr(this.properties.UpdateHtmlPostToggle)&&(32===D?this.Wyj():this.Uyj())},this.BX(t)))}Uyj(){this.Pd[kg.a.On]=!this.Pd[kg.a.On]}Wyj(){this.toggleButton.setState(this.Pd[kg.a.On]);(this.toggleButton.iza&&this.toggleButton.boe||Va.a.Rr(this.properties.UpdateHtmlPostToggle))&&this.cUa()}toggle(){this.Uyj();Va.a.Rr(this.properties.UpdateHtmlPostToggle)||
this.Wyj()}onKeyDown(b){const k=super.onKeyDown(b);if(!k&&!Hf.c(b.Gb)&&this.TH){const t=b.Gb.keyCode;t!==Sys.UI.Key.enter&&t!==Sys.UI.Key.space||b.Gb.preventDefault()}return k}xm(){Hf.c(this.properties.MenuItemId)||(this.Pd.MenuItemId=this.properties.MenuItemId);0<(this.fu(this.properties.Command,this.properties.QueryCommand,this.Pd)&2)&&this.U7a()&&this.cUa()}cUa(){this.toggleButton.setState(this.Pd[kg.a.On]);this.xSo(Va.a.Vqa(this.Pd[kg.a.DisplayMode],""));this.qmg();this.wja();this.fUo();kg.a.Alt in
this.Pd&&this.FQb()}fUo(){const b=this.WE.icc;if(b&&b.Xfb){var k=Va.a.Vqa(this.Pd[kg.a.Description],this.properties.Description);k!==b.Xfb.innerText&&(b.Xfb.innerText=k,b.rO&&!Object(ob.a)(Wl.Jewel,this.root)&&(k=!Hf.b(k),Va.a.x5(b.rO,"UIFontBold",k),Va.a.x5(b.rO,"cui-ctl-mediumlabel-nodescription",!k)))}}HI(b){b=b.Mm;Ic.a.instance.lb(Rc.a.focus,b,Object(A.a)(this,this.onFocus,"onFocus"));Ic.a.instance.lb(Rc.a.blur,b,Object(A.a)(this,this.onBlur,"onBlur"));Sh.a.instance.lb(Rc.a.pointerOver,b,Object(A.a)(this,
this.fP,"onPointerOver"));Sh.a.instance.lb(Rc.a.pointerOut,b,Object(A.a)(this,this.yJ,"onPointerOut"));Zb.KeyInputManager.instance.lb(Rc.a.hi,b,Object(A.a)(this,this.onKeyDown,"onKeyDown"));Zb.KeyInputManager.instance.lb(Rc.a.vh,b,Object(A.a)(this,this.zy,"onKeyUp"));Sh.a.instance.lb(Rc.a.pointerDown,b,Object(A.a)(this,this.ZC,"onPointerDown"));Sh.a.instance.lb(Rc.a.QM,b,Object(A.a)(this,this.vxa,"onPointerUp"));Zh.a.instance.lb(Rc.a.click,b,Object(A.a)(this,this.onClick,"onClick"));Wb.a.instance.lb(Rc.a.uP,
b,Object(A.a)(this,this.lmb,"onTouchMove"));Wb.a.instance.lb(Rc.a.NJ,b,Object(A.a)(this,this.yGa,"onTouchEnd"))}}Object(n.a)(ui,"ToggleButtonBehavior",vb,[]);class $i{constructor(b){this.HYj=b;this.Zze={["Button"]:k=>new nc(k),["FileMenuButton"]:k=>new nc(k),["ColorPicker"]:k=>new xd(k),["ComboBox"]:k=>new po(k),["ContextMenuControl"]:k=>new Hp(k),["ContextMenuLauncher"]:k=>new Hp(k),["DialogMenuLauncher"]:k=>new Bm(k),["DropDown"]:k=>new ak(k),["FlyoutAnchor"]:k=>new dp(k),["GalleryButton"]:k=>new Cq(k),
["StatefulColorFlyoutAnchor"]:k=>new dp(k),["JewelMenuLauncher"]:k=>new Mr(k),["Label"]:k=>new kq(k),["Placeholder"]:k=>new vb(k),["SearchBox"]:k=>new Xi(k),["Separator"]:k=>new vb(k),["SplitButton"]:k=>new Ll(k),["StatefulColorSplitButton"]:k=>new Ll(k),["StatefulImageSplitButton"]:k=>new Ll(k),["TextBox"]:k=>new jg(k),["ToggleButton"]:k=>new ui(k)}}$Uh(){this.Zze[Ui.Control.Eri]=b=>new ws(b)}Zgf(){this.Zze[Ui.Control.jtj]=b=>new rm(b)}XLl(b){const k=this.Zze[b.controlType];(b=k?k(b):null)&&this.HYj&&
b.rsl();return b}static get instance(){return $i._instance||($i._instance=new $i(!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("CUICommitChangeFixIsEnabled")))}}$i._instance=null;Object(n.a)($i,"ControlBehaviorFactory",null,[686]);var Hn=c(976),ao=c(148);class qo extends Kl.MenuLauncher{constructor(b,k,t,D){super(b,k,t,D);this.j4g=null;this.FMa=this.PCc=0;this.zF=null;this.awc=this.$vc=0;this.hh("Menu");this.enabled=!0}get x(){return this.PCc}get y(){return this.FMa}get JIf(){return this.$vc}get KIf(){return this.awc}get controlType(){return"DialogMenuLauncher"}o6a(){}K7a(){}bof(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.Zs.DialogMoveCommand;b.DialogCloseCommand=this.Zs.DialogCloseCommand;return b}lWm(b,k){this.PCc=b.x;this.FMa=b.y;this.$vc=b.height;this.awc=b.width;this.b0(k)}tQ(b){this.j4g=Va.a.createElement("span");return new ao.a(b,this.j4g)}get Zs(){return this.Fh}kua(b,k,t){return new qo(b,this.id,k,t)}}Object(n.a)(qo,"DialogMenuLauncher",Kl.MenuLauncher,[]);var fs=c(812);class Cm extends Hn.a{constructor(b,k){super(b,k);this.O8a=null}get aYe(){return this.O8a}get RQh(){return this.properties}get y9(){return 20}ym(){super.ym();
Hf.c(this.Oc)&&this.zC();this.Oc=Va.a.rSa(this.Oc);this.KW(this.Oc);this.dirty=!1}tO(b){if(!Object(ob.a)(fs.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}X$e(b,k,t,D){t=new Dg.Menu(this,k,t,D,null);b||(b={});b.CommandMenuOpen=this.RQh.CommandMenuOpen;b.CommandMenuClose=this.RQh.CommandMenuClose;b=new qo(this,k,b,t);this.nBb[k]=b;k=new fs.a(this,"dock"+k);k.Hf(b.uQ("Menu"));this.Hf(k);this.refresh()}Sdg(b,k,t,D){const P=this.nBb[b];if(Hf.c(P))throw Error.create('The dialog menu "'+
b+'" does not exist');P.lWm(new Sys.UI.Bounds(k,t,0,0),D);this.O8a=P.menu}E7e(b){b=this.nBb[b];Hf.c(b)||(b.dua(),this.O8a=null)}b7d(){this.O8a=null}dispose(){const b=this.nBb;for(let k in b)b[k].dispose();super.dispose()}}Object(n.a)(Cm,"DialogMenuRoot",Hn.a,[]);class Ig{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(n.a)(Ig,"RootProperties",null,[]);class kh extends Ig{constructor(){super()}}Object(n.a)(kh,"StandaloneRootProperties",Ig,[]);class ho extends kh{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(n.a)(ho,"DialogMenuRootProperties",kh,[]);class Sn{constructor(){const b=new ho;b.ImageSideArrow=w.AFrameworkApplication.Rs;b.ImageSideArrowClass=od.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=w.AFrameworkApplication.isRtl?"rtl":"ltr";this.Ed=new Cm("DialogMenuRootId",b);this.Ed.zF=this;this.Ed.refresh();w.AFrameworkApplication.va.fb($a.a.BZf,Ud.a.frame,Object(A.a)(this,this.BZf,"populateDialogMenu"),96)}get g1(){return this.Ed}kOa(b,k,t,D,P=null){b=parseInt(b);D=w.AFrameworkApplication.va;
t&&(D.zD=t.CommandLocation,D.U_=t.InvocationMethod);k=D.Qb(b,2,k,P);this.Ed.refresh();return 32===k}AFa(b){return b?32===w.AFrameworkApplication.va.processAction(parseInt(b),1):!0}fu(){this.g1.root.xm()}X$e(b,k,t){const D={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};D.DialogMoveCommand=k;D.DialogCloseCommand=t;this.g1.X$e(D,b,"","")}Sdg(b,k,t,D){this.g1.Sdg(b,k,t,D)}E7e(b){this.g1.E7e(b)}BZf(b,k,t,D,P){if(1===t)return 32;b=new Sys.StringBuilder;
b.append('<Menu Id="dialogMenu">');b.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');b.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',P.DialogMoveCommand,CommonUIStrings.l_DialogMove));b.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',P.DialogCloseCommand,CommonUIStrings.l_DialogClose));b.append("</Controls></MenuSection>");b.append("</Menu>");P.PopulationXML=b.toString();return 32}dispose(){this.Ed&&
(this.Ed.dispose(),this.Ed=null)}}Object(n.a)(Sn,"DialogMenuRootUser",null,[555,9,642]);class sl{constructor(b,k,t){this.fsb=this.Uud=this.dxc=this.vl=null;this.JDe=this.kud=!1;this.ftc=b;this.ae=k;this.Yr=t;this.RVb=w.AFrameworkApplication.isRtl}get Zyf(){return this.JDe}dvl(b){b?(this.vl=b,this.JDe=!0,this.kud=!1,this.ae.capture(Object(A.a)(this,this.QUm,"keyEventHandler"),null),this.Yr.lb(Rc.a.pointerDown,this.ftc,Object(A.a)(this,this.Kfc,"pointerDownHandler")),this.dxc||this.mal(),this.vl.appendChild(this.dxc),
this.Wwm()):v.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}Dif(){this.JDe=!1;this.Uud=this.fsb=null;this.AYn();this.A4f();this.vl=null}A4f(){this.ae.releaseCapture();this.Yr.rc(Rc.a.pointerDown,this.ftc,Object(A.a)(this,this.Kfc,"pointerDownHandler"))}Wwm(){if(this.vl.style.left.endsWith("px")&&this.vl.style.right.endsWith("px"))this.fsb=new Sys.UI.Point(Co.a.xY(this.RVb?this.vl.style.right:this.vl.style.left),Co.a.xY(this.vl.style.top));else{const b=this.RVb?this.ftc.offsetWidth-
(this.vl.offsetLeft+this.vl.offsetWidth+Co.a.xY(this.vl.style.marginRight)):this.vl.offsetLeft-Co.a.xY(this.vl.style.marginLeft),k=this.vl.offsetTop-Co.a.xY(this.vl.style.marginTop);this.lmj(b,k);this.fsb=new Sys.UI.Point(b,k)}this.Uud=this.fsb}mal(){this.dxc=od.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}AYn(){this.dxc.parentNode===this.vl&&this.vl.removeChild(this.dxc)}QUm(b){if(!this.Zyf)return!1;b.Gb.preventDefault();if(b.eventName===Rc.a.hi){const k=b.Gb.ctrlKey?
1:10;let t;switch(b.Gb.keyCode){case pc.a.H5:this.Gdc(0,-1*k);break;case pc.a.vda:this.Gdc(0,1*k);break;case pc.a.Dmc:t=this.RVb?1:-1;this.Gdc(t*k,0);break;case pc.a.oqb:t=this.RVb?-1:1;this.Gdc(t*k,0);break;case pc.a.KIa:this.iOi(this.Uud.x,this.Uud.y);this.kud=!0;break;case pc.a.zs:this.kud=!0}}b.eventName===Rc.a.vh&&this.kud&&this.Dif();return!0}Kfc(b){if(!this.Zyf)return!1;b.Gb.preventDefault();this.Dif();return!0}Gdc(b,k){this.iOi(this.fsb.x+b,this.fsb.y+k)}iOi(b,k){b=this.fzk(b,k);this.lmj(b.x,
b.y);this.fsb=b}lmj(b,k){this.RVb?this.vl.style.right=b+"px":this.vl.style.left=b+"px";this.vl.style.top=k+"px"}fzk(b,k){const t=this.RVb?Co.a.xY(this.vl.style.marginRight):Co.a.xY(this.vl.style.marginLeft),D=Co.a.xY(this.vl.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-t,b),this.ftc.offsetWidth-this.vl.offsetWidth-t),Math.min(Math.max(-D,k),this.ftc.offsetHeight-this.vl.offsetHeight-D))}}Object(n.a)(sl,"KeyMoveAdapter",null,[643]);var gr=c(1112),ro=c(559);class Nr{get name(){return"CUI.Behavior"}xc(b){w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&(b.register(642,"Common.UI.IDialogMenuRootUser").singleInstance().Rd(()=>new Sn),b.register(643,"Common.IKeyMoveAdapter").singleInstance().Rd(()=>new sl(w.AFrameworkApplication.ta.lna(),Zb.KeyInputManager.instance,Sh.a.instance)));b.register(ro.a,"CommandUI.RootManager").as("Common.IRootManager").singleInstance().Rd(()=>ro.a.instance)}init(){gr.a.P9e=$i.instance;const b=ro.a.instance.yej;for(let k=0;k<b.length;++k){const t=Object(Ka.a)(644,
b[k]);t&&t.eOa()}Tj.a.get_instance().XH(6)}dispose(){}static main(){N.a.instance.Fc(new Nr,5)}}Object(n.a)(Nr,"CuiBehaviorPackage",null,[1,2]);class hr{constructor(b){const k=new kh;k.ImageUpArrow=k.ImageDownArrow=k.ImageSideArrow=k.ImageCheckMark=k.ImageUncheckMark=k.ImageDownArrow8by8=k.ImageUpArrow8by8=b;k.ImageUpArrowClass=od.getImageClass("RibbonUpArrow_5x3x32");k.ImageDownArrowClass=od.getImageClass("SplitButtonArrow_5x3x32");k.ImageUpArrow8by8Class=od.getImageClass("RibbonUpArrow_8x8x32");
k.ImageDownArrow8by8Class=od.getImageClass("SplitButtonArrow_8x8x32");k.ImageSideArrowClass=od.getImageClass("SubmenuFlyoutArrow_13x13x32");k.ImageCheckMarkClass=od.getImageClass("CheckboxChecked_16x16x32");k.ImageUncheckMarkClass=od.getImageClass("CheckboxUnchecked_16x16x32");k.TextDirection=w.AFrameworkApplication.isRtl?"rtl":"ltr";this.Acb=Hn.a.Icl(k);this.Acb.refresh()}get Zca(){return this.Acb}dispose(){this.Acb.dispose()}}Object(n.a)(hr,"StandaloneRootController",null,[861,9]);var gs=c(1137),
gl=c(160);class Uq{constructor(b){this.Czc=b}create(b,k){const t=new Sys.StringBuilder;this.jIc(t,b,k);this.taf(t,b);return t.toString()}ffb(b,k){const t=[];this.dbf(t,b,k);this.uaf(t,b);return t}jIc(b,k,t){switch(k.errorType){case 0:b.append(this.Czc.build());break;case 1:case 2:b.append(this.r4e(k,t))}}dbf(b,k,t){switch(k.errorType){case 0:b.push(this.Czc.lyh());break;case 1:case 2:b.push(this.PLk(k,t))}}taf(b,k){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');
b.append(gl.a("btnIgrnoreSpellingError",(2===k.errorType?Pb.a.BIa:Pb.a.dwa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));b.append("</Controls></MenuSection>")}uaf(b,k){const t=Object.assign(new fh.a,{ControlList:[]});k=2===k.errorType?"UnknownSpellingError":"IgnoreSpellingError";t.ControlList.push(Object.assign(new zg.a,{ExternalId:k}));b.push(t)}r4e(b,k){b=this.CIl(b.suggestions,k);return 0<b.length?gl.g("msUnknownWord",gl.d(null,b),"Menu16"):gl.g("msUnknownWord",gl.d(null,[gl.a("btnNoSuggestions",
Pb.a.BIa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}CIl(b,k){const t=[];if(b){const D=Math.min(k.length,b.length);for(let P=0;P<D;++P)b[P]&&t.push(gl.a("btnCorrectWord"+P,k[P].toString(),b[P]))}return t}PLk(b,k){const t=Object.assign(new fh.a,{Id:"Suggestions",ControlList:[]});this.BIl(b.suggestions,k,t.ControlList);0>=t.ControlList.length&&(b=Object.assign(new zg.a,{ExternalId:"NoSuggestions"}),t.ControlList.push(b));return t}BIl(b,k,t){if(b){const D=Math.min(k.length,b.length);
for(let P=0;P<D;++P){if(!b[P])continue;const ca=Object.assign(new zg.a,{ExternalId:"btnCorrectWord"+P,Command:k[P].toString(),LabelText:b[P]});t.push(ca)}}}}Object(n.a)(Uq,"DefaultProofingContextMenuCreator",null,[]);var Fo=c(701);class vn{constructor(b,k){this.VQg=b;this.WSg=k;this.pla=[Pb.a.wpb,Pb.a.xpb,Pb.a.ypb,Pb.a.BPb,Pb.a.CPb]}create(b,k){return k?Object(ob.a)(Fo.a,k)?this.WSg.create(b,k,this.pla):this.VQg.create(k,this.pla):""}H3b(b,k){return k?Object(ob.a)(Fo.a,k)?this.WSg.ffb(b,k,this.pla):
this.VQg.ffb(k,this.pla):null}}Object(n.a)(vn,"ProofingContextMenuSectionFactory",null,[656]);class Go{build(){const b=[gl.a("btnDeleteRepeatedWord",Pb.a.xDa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return gl.g("msRepeatedWord",gl.d(null,b),"Menu16")}lyh(){const b=Object.assign(new fh.a,{ControlList:[]}),k=Object.assign(new zg.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(k);return b}}Object(n.a)(Go,"ProofingRepeatedWordSectionBuilder",null,[655]);class Vd{static get Xg(){return Wf.a.lA(Vd.Lm,
Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}Vd.Lm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(n.a)(Vd,"AutoCorrectOptionsDialogHTML",null,[]);class sp{static get Xg(){return Wf.a.lA(sp.Lm,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}sp.Lm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(n.a)(sp,"AutoCorrectOptionsDialogHTML2",null,[]);class Cl extends Wf.a{constructor(b,k){super();this.Xdo=(t,D)=>{1!==t?v.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):D.ReplaceTextAsYouType!==this.uV.tSa||D.CapitalizeFirstLetterOfSentences!==this.uV.CCd||D.ReplaceOrdianalsWithSuperscript!==this.uV.ude||D.ReplaceHyphensWithDash!==this.uV.s4c||D.ReplaceFractionsWithFractionCharacter!==this.uV.tde||this.yea&&D.ReplaceQuoteWithSmartQuote!==
this.uV.C6f?(t={},t.ReplaceTextAsYouType=D.ReplaceTextAsYouType,t.CapitalizeFirstLetterOfSentences=D.CapitalizeFirstLetterOfSentences,t.ReplaceOrdianalsWithSuperscript=D.ReplaceOrdianalsWithSuperscript,t.ReplaceHyphensWithDash=D.ReplaceHyphensWithDash,t.ReplaceFractionsWithFractionCharacter=D.ReplaceFractionsWithFractionCharacter,this.yea&&(t.ReplaceQuoteWithSmartQuote=D.ReplaceQuoteWithSmartQuote),this.uV.M8n(t),v.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:D.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:D.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:D.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:D.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:D.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.yea,["ReplaceQuoteWithSmartQuote"]:this.yea&&D.ReplaceQuoteWithSmartQuote}),Wa.App.ya.updateCommandUI(!0)):v.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes.")};this.uV=b;this.yea=k;this.vg="AutoCorrectOptionsDialog"}ieg(){v.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.Xg=this.yea?sp.Xg:Vd.Xg;const b={};b.ReplaceTextAsYouType=this.uV.tSa;b.CapitalizeFirstLetterOfSentences=this.uV.CCd;b.ReplaceOrdianalsWithSuperscript=this.uV.ude;b.ReplaceHyphensWithDash=this.uV.s4c;b.ReplaceFractionsWithFractionCharacter=this.uV.tde;this.yea&&(b.ReplaceQuoteWithSmartQuote=
this.uV.C6f);this.Wh(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.Xdo,b)}}Object(n.a)(Cl,"AutoCorrectOptionsDialog",Wf.a,[654]);class mm{static get Xg(){return Wf.a.lA(mm.Lm,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}mm.Lm="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(n.a)(mm,"AltTextDialogWithDescriptionHtml",null,[]);class In{static get Xg(){return Wf.a.lA(In.Lm,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}In.Lm="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(n.a)(In,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class mn extends Wf.a{constructor(b=!1,k=!1){super(!1,!1,b);this.jni=!1;k?(this.jni=!0,this.Xg=In.Xg):this.Xg=mm.Xg;this.vg=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}A$e(b){this.Wh(CommonUIStrings.l_AlternativeTextDialogTitle,Object(A.a)(this,this.GAk,"altTextDialogHandler"),this.epf(b));b=document.getElementById(mn.k0e)||document.getElementById(mn.eAd);b.focus();b.select()}epf(b){const k={};this.jni||(k[mn.k0e]=this.Vmf(b));
k[mn.eAd]=this.ySl(b)||"";return k}Nua(b){return b.zf.id===mn.eAd?!1:super.Nua(b)}}mn.k0e="titleText";mn.eAd="descriptionText";Object(n.a)(mn,"BaseAltTextDialogWithDescription",Wf.a,[]);var Ih=c(32);class Vm extends mn{constructor(b,k,t,D,P){super();this.wk=k;this.un=t;this.ur=D;this.Ld=P;this.upb=this.rT=null;this.A$e(b)}ySl(b){this.rT=b.node;this.upb=Ih.TableReader.Xgi(b);return Ih.TableReader.muf(this.upb)}Vmf(b){this.rT=b.node;this.upb=Ih.TableReader.Xgi(b);return Ih.TableReader.nuf(this.upb)}GAk(b,
k){if(1===b){b=Ih.TableReader.nuf(this.upb);const t=Ih.TableReader.muf(this.upb),D=k[mn.k0e];k=k[mn.eAd];this.hide();const P=this.ur.Mc(15);try{P.Cb(this.rT),this.wk.Cbg(this.upb,D),this.wk.qmj(this.upb,k)}finally{P&&P.dispose()}D===b&&k===t||this.Ld.Js(16)}this.un.Yo&&this.un.kq.rH(this.rT)}}Object(n.a)(Vm,"TableAltTextDialog",mn,[]);class Tn{constructor(b,k,t){this.Yz=b;this.Hc=k;this.Ud=t}create(b){return new Vm(b,this.Yz,Wa.App.rd,this.Hc,this.Ud)}}Object(n.a)(Tn,"TableAltTextDialogFactory",null,
[]);const Or=()=>{Wa.App.xrh=!0;return 32},Ip=(b,k,t,D,P)=>{if(1===t)return 32;if(!({point:b,Gx:k}=Zo(P)).returnValue)return 16;Wa.App.ya.wjc(b,k);return 32},io=(b,k,t,D,P)=>{if(1===t)return 32;if(!({point:b,Gx:k}=Zo(P)).returnValue)return 16;Wa.App.ya.Xia(b,k);return 32},Zo=b=>{let k=null,t=0;if(!b)return{returnValue:!1,point:k,Gx:t};b=b.split(",");if(3>b.length)return{returnValue:!1,point:k,Gx:t};k=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));t=parseInt(b[2]);return{returnValue:!0,point:k,Gx:t}};
var so=c(1807);class On extends Sys.EventArgs{constructor(b,k,t,D,P,ca=0,ta=0,Na=null){super();this.controlId=b;this.commandId=D;this.time=P;this.commandSurface=ca;this.Gx=ta;this.contentType=Na}}Object(n.a)(On,"CommandClickEventArgs",Sys.EventArgs,[]);class Us{constructor(b,k){this.csa=b.Pof();this.vqc=b;this.I8a=k}kOa(b,k,t,D=null,P=null){t&&(this.I8a.zD=t.CommandLocation,this.I8a.U_=t.InvocationMethod,this.I8a.wNa=t.CommandTabName);b=parseInt(b);let ca=this.vqc.Q7h(b,k,t);ca.$Pf&&(ca=this.vqc.Q7h(ca.ZL,
k,t));if(void 0!==ca.V_a&&null!==ca.V_a)return ca.V_a;if(ca.BFb)P=32;else{var ta=null;this.csa&&this.csa.WZf&&(ta=this.csa.WZf(ca,P));ca.lha||ca.iVc?ca.QDa?P=16:(P=this.I8a.Qb(ca.ZL,ca.dbc?2:1,ca.vd,P),2===P&&(P=32)):ca.QDa?P=this.I8a.Dpa(null,ca.ZL,ca.vd,Na=>{D&&D(Na.response)},P):(P=this.I8a.Qb(ca.ZL,2,ca.vd,P),D&&D(P));this.csa&&this.csa.RZf&&this.csa.RZf(ca,P,ta);if(k&&t&&-1!==t.InvocationMethod&&t.InvocationMethod){t=k.LegacyId;if(void 0===t||null===t)t="";ta=k.ParentMenuId;void 0!==ta&&null!==
ta||!k.MenuId||(ta=k.MenuId);let Na=k.SqmControlId;void 0!==Na&&null!==Na||!k.SourceControlId||(Na=k.SourceControlId);(void 0!==Na&&null!==Na||void 0!==ta&&null!==ta)&&so.a.vLn(new On(Na,t,ta,Xc.ActionManager.raa(b),Date.now()))}}ca.lha&&32===P&&this.csa&&this.csa.mCa&&this.csa.mCa(ca,k);ca.iVc&&32===P&&this.csa&&this.csa.eZa&&this.csa.eZa(ca,k);return 32===P||1===P}AFa(b,k=null){if(w.AFrameworkApplication.Lk||wb.a.instance.Fv)return!1;null!=k&&null!=k.UILocation&&(this.I8a.zD=k.UILocation);const t=
parseInt(b);if(!b||t===Xc.ActionManager.Rgf)return!0;b=this.vqc.G7h(t,k);b.$Pf&&(b=this.vqc.G7h(b.ZL,k));if(void 0!==b.V_a&&null!==b.V_a)return b.V_a;t===$a.a.X_b&&k&&(b.vd=k);return 32===this.I8a.Qb(b.ZL,1,b.vd)}clearCache(){this.vqc.clearCache()}}Object(n.a)(Us,"GeneralCuiUser",null,[554,555]);var tp=c(194),dl=c(99),kk=c(56),nn=c(1383);class Oo{get XG(){return null!=this.YIg?this.YIg:this.YIg=Fa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}constructor(b,k,t,D){this.mSg="DocumentProofingFailed";
this.rUe=b;this.Whh=k;this.ued=t;this.uI=D}L$l(){const b=this.uI.X7l(this.rUe);return{returnValue:this.uI.$Oa(this.rUe),$Hn:b}}eUo(b,k){const t=dl.a.Lr();if(t){var D=new tp.ScriptSharpLegacyMap;D.add(sf.a.bL,b);D.add(Cc.a.noProof,k);b=new Xd.GraphTransaction(15);b.Cb(t);this.XG.iRa(kk.StyleReader.wordStyleIdNormal,D,t)?nn.a.nAj():(v.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),nn.a.recordQosError(this.mSg,[nn.a.fzc],"Style could not be modified"));b.dispose()}else v.ULS.sendTraceTag(555775182,
375,10,"PageContentNode not found"),nn.a.recordQosError(this.mSg,[nn.a.fzc],"PageContentNode not found")}wfo(b,k){this.eUo(b,k)}Hko(b,k){if(this.Whh){var t=new th.DictionaryPropertySet;this.ued.execute(D=>{D.EKc(b)});t.setValue(sf.a.bL,b);t.setValue(Cc.a.noProof,k);k=new Xd.GraphTransaction(15);k.set(Wa.App.Lj.Bl);this.Whh.b5(t);k.dispose()}}gf(){return hf.SelectionEditor.gf(this.rUe)}}Object(n.a)(Oo,"LanguageEditor",null,[653]);var Ij=c(602),up=c(244),Xl=c(102);class Pn{constructor(b=!1,k=0){this.languages=
Pn.$fi(Xj.a.nRl());this.Lnd=new up.a;this.dSa=[];this.ZXb=new Ij.a;this.l6i=b;this.Jbh=0>=k?7:k;this.Ibh=this.KOe=0;this.oXg=!1;b&&(this.eym(),w.AFrameworkApplication.$H(()=>{this.E4m()}))}eym(){for(var b of this.languages)this.Lnd.Z(b.LCID,b);b=[];try{const D=Mb.a.get("RecentlyUsedLcids");if(D&&""!==D){const P=decodeURIComponent(D).split(",").slice(0,this.Jbh);for(const ca of P){let ta;({value:ta}=this.Lnd.Dc(parseInt(ca),ta)).returnValue&&b.push(ta)}}}catch(D){v.ULS.sendTraceTag(38385057,324,15,
"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",D.message),Array.clear(b)}if(b.length)for(var k of b){var t=k.LCID;this.ZXb.contains(t)||(this.dSa.push(k),this.ZXb.add(t))}else k=w.AFrameworkApplication.lcid,({value:t}=this.Lnd.Dc(k,t)).returnValue&&(this.dSa.push(t),this.ZXb.add(k));this.Bfj()}Bfj(){const b=Xl.toArray(Xl.select(Xl.asEnumerable(this.dSa),k=>k.LCID)).join(",");Mb.a.dTa("RecentlyUsedLcids",b,180)}WZl(b){let k,t=-1,D=null;var P=Pn.$fi(this.dSa);this.l6i&&
0<P.length&&(D=Xl.toArray(Xl.Si(Xl.asEnumerable(P),(Na,qb)=>{b===Na.LCID&&-1===t&&(t=qb);return{["key"]:qb,["text"]:Na.displayName,["value"]:Na.LCID.toString()}})));let ca=0;D&&(ca=D.length);P=ca;const ta=Xl.toArray(Xl.Si(Xl.asEnumerable(this.languages),(Na,qb)=>{b===Na.LCID&&-1===t&&(t=ca+qb);return{["key"]:ca+qb,["text"]:Na.displayName,["value"]:Na.LCID.toString()}}));k=t;return 0<ca?{returnValue:D.concat.apply(D,ta),selectedIndex:k,ztj:P}:{returnValue:ta,selectedIndex:k,ztj:P}}Dho(b,k){if(this.l6i&&
({value:t}=this.Lnd.Dc(b,t)).returnValue){k=b!==k;if(this.ZXb.contains(b))b=Array.indexOf(this.dSa,t),0<=b&&(Array.removeAt(this.dSa,b),this.dSa.push(t)),k&&this.KOe++;else{this.ZXb.add(b);this.dSa.push(t);if(this.dSa.length>this.Jbh){var t=this.dSa.shift();this.ZXb.remove(t.LCID)}k&&this.Ibh++}this.Bfj()}}E4m(){const b=this.KOe+this.Ibh;!this.oXg&&0<b&&(v.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.KOe/b),this.oXg=!0)}static $fi(b){b=Array.clone(b);b.sort((k,
t)=>k.displayName.localeCompare(t.displayName));return b}}Object(n.a)(Pn,"LanguageListHelper",null,[652]);var ep=c(190);class $p extends ep.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(n.a)($p,"NumberButtonProps",ep.a,[]);var li=c(224);class lh{static get k5(){return null!=lh.pGg?lh.pGg:lh.pGg=Fa.a.instance.Na("Box4.ISpacingCommands")}static get Wg(){return li.ContextSetEditor.instance}static get NFa(){return null!=lh.kDg?lh.kDg:lh.kDg=Fa.a.instance.Na("Box4.ILineSpacingHelper")}static get tpj(){return!!lh.k5}static Tb(){const b=
w.AFrameworkApplication.va;b.qa(Pb.a.Rfc,lc.a.view,lh.Rfc);b.Vc(Pb.a.Rfc,1124);b.qa(Pb.a.Rfc,lc.a.paragraph,lh.mUo)}static Rfc(b,k,t,D,P){if(1===t||!lh.tpj)return lh.tpj?32:8;if(!lh.myi){var ca=[];ca.push(Object.assign(new $p,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));ca.push(Object.assign(new $p,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));ca.push(Object.assign(new $p,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));ca.push(Object.assign(new $p,{ExternalId:"LineSpacing2_00",Number:2,
Type:0}));ca.push(Object.assign(new $p,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));ca.push(Object.assign(new $p,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));P.MenuItems=gl.e(ca);lh.myi=!0}v.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");k=k.view.mb;ca=null;k&&k.hb.kb&&(ca=k.hb.kb);k=lh.Wg.b2h(ca.Qa);w.AFrameworkApplication.va.Nf(k,b,t,!0,D,P);return 32}static mUo(b,k){let t=b=!0;k=lh.NFa.sEa(k.node);var D=k.beforeSpacing;let P=!1;1===D.unit&&(P=!0);if(P||0<D.value)b=!1;
k=k.afterSpacing;D=!1;1===k.unit&&(D=!0);if(D||0<k.value)t=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(lh.Wtk,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(lh.kZn,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(lh.Vtk,!t));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(lh.jZn,t));return 32}}lh.Wtk="AddSpaceBeforeParagraph";lh.Vtk="AddSpaceAfterParagraph";lh.kZn="RemoveSpaceBeforeParagraph";lh.jZn="RemoveSpaceAfterParagraph";
lh.myi=!1;Object(n.a)(lh,"LineSpacingRibbonMenu",null,[]);var bk=c(176),ir=c(1665),lq=c(1365);const vp=(b,k,t)=>{if(1===t)return 32;b=Wa.App.ya.notificationBar.rma("Automation test",!1);b.image=3;Wa.App.ya.notificationBar.aA(b);return 32},ah=(b,k,t,D,P)=>{let ca;if(!({CHj:ca}=Jp(P)).returnValue)return 16;bk.UISurfaces.tM().then(ta=>{let Na=null;var qb=Object.assign(new ir.a,{label:"OK",onExecute:()=>{Na&&ta.removeNotification(Na)}});qb=Object.assign(new lq.a,{target:"#"+wg.AppFrame.n8f,content:"Here's the text for the callout",
title:"Your title",primaryButtonProps:qb,useTeachingStyles:ca});qb=ta.callout(qb);Na=ta.addNotification(qb);return null},ta=>{v.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",ta);return null});return 32},Jp=b=>{let k=!1;if(!b)return{returnValue:!1,CHj:k};k=Boolean.parse(b);return{returnValue:!0,CHj:k}};var Yi=c(1446);let bo,Po,dn,to;class Ml{constructor(){this.O6=new Eb.a;this.E1g=!1}odb(b){const k=this.O6.indexOf(b);let t=!0;if(-1!==k){t=!1;if(!k)return t;this.O6.removeAt(k)}this.O6.insert(0,
b);v.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.O6.count&&(v.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.O6.J(10)),this.O6.removeAt(10));this.MVo();return t}Omg(b){let k="#";for(let D=0;D<this.O6.count;D++){var t="#"+this.O6.J(D).substring(4,6)+this.O6.J(D).substring(2,4)+this.O6.J(D).substring(0,2);t=Object.assign(new Yi.a,{Color:this.O6.J(D),Alt:t,DisplayColor:t});if(t.DisplayColor.toLowerCase()===b.toLowerCase()){k=
t.Color;break}}for(const D of Ml.Fbh)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(D,k))}MVo(){v.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let t=0;t<this.O6.count;t++){var k="#"+this.O6.J(t).substring(4,6)+this.O6.J(t).substring(2,4)+this.O6.J(t).substring(0,2);k=Object.assign(new Yi.a,{Color:this.O6.J(t),Alt:k,DisplayColor:k});b.push(appChrome.api.colorPickerCell(k.Color,k.DisplayColor,k.Alt))}for(const t of Ml.Fbh)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(t,
b));this.E1g||this.JUo();this.E1g=!0}JUo(){for(const b of Object.keys(Ml.i6g)){v.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const k=Ml.i6g[b],t=[];for(const D of k)t.push(appChrome.api.menuSection([D],D in Ml.JJe?Ml.JJe[D].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,t,Ml.JJe[b].toString()))}}}Ml.i6g={["FontColor"]:(to=new Eb.a,to.add("AutomaticFontColor"),to.add("ThemeFontColorPickerMCU"),to.add("ThemeFontColorPicker"),to.add("StandardFontColorPicker"),
to.add("RecentFontColorPicker"),to.add("MoreFontColors"),to),["CellShading"]:(dn=new Eb.a,dn.add("ThemeShadingColorPickerMCU"),dn.add("ThemeShadingColorPicker"),dn.add("StandardShadingColorPicker"),dn.add("RecentCellShadingColorPicker"),dn.add("ClearShadingColor"),dn.add("MoreCellShadingColors"),dn),["PictureBorders"]:(Po=new Eb.a,Po.add("ThemePictureBorderColorPickerMCU"),Po.add("ThemePictureBorderColorPicker"),Po.add("StandardPictureBorderColorPicker"),Po.add("RecentPictureBorderColorPicker"),Po.add("MorePictureBorderColors"),
Po.add("NoPictureBorder"),Po.add("PictureBorderWeightOptions"),Po.add("PictureBorderStyleOptions"),Po)};Ml.JJe={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:"Picture Border"};Ml.Fbh=(bo=new Eb.a,bo.add("RecentFontColorPicker"),bo.add("RecentCellShadingColorPicker"),bo.add("RecentPictureBorderColorPicker"),bo);Object(n.a)(Ml,"RecentColorsSectionHandler",null,[]);var mq=c(1393),Dq=c(1046);class nh{constructor(b){this.zdk=b}C4(){}A4(b){this.zdk.fgn(b)}}Object(n.a)(nh,"DataBuddyActionListener",
null,[36]);class Th{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(n.a)(Th,"DataBuddyTaskPaneProps",null,[]);class nm{constructor(b){this.isVisible=!1;this.VY=new Eb.a;this.xre=null;this.R2=b;this.cB=new mq.a;this.Ub=ad.FocusManager.instance()}initialize(){this.xre=new nh(this);this.R2.KNa();this.cB.lL(this.etk());this.cB.lL(this.hqk())}toggle(){this.isVisible?this.hide():this.show()}fgn(b){if(2===b.behavior){const k=Xc.ActionManager.raa(b.actionId)||
b.actionId.toString();k.startsWith("Query")||(this.VY.add(k+": "+nm.sJl(b.response)),this.Cm())}}hide(){bk.UISurfaces.zu().then(b=>{b.hideTaskPane(nm.WB,2);return null})}show(){bk.UISurfaces.zu().then(b=>{b.showTaskPane(nm.WB,this.eA());return null});this.isVisible&&bk.UISurfaces.zu().then(b=>{b.setSelectedTaskPane(nm.WB);return null})}etk(){return b=>{b.actions=this.VY.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}hqk(){return b=>{b.onClearClick=()=>{this.VY.clear();
this.Cm()}}}Tb(){w.AFrameworkApplication.va.AY(this.xre)}H7a(){w.AFrameworkApplication.va.qQb(this.xre)}eA(){const b=new Th;this.cB.mob(b);return Object.assign(new Dq.a,{title:"Data Buddy",hideHeader:!1,width:nm.width,location:2,contentProps:b,onOpen:()=>{this.E9();this.Tb();this.isVisible=!0;w.AFrameworkApplication.ta.updateCommandUI()},onClose:()=>{this.Uca();this.H7a();this.isVisible=!1;this.Cm();w.AFrameworkApplication.ta.updateCommandUI()},isModernPane:!0})}Cm(){bk.UISurfaces.zu().then(b=>{b.updateTaskPane(nm.WB,
this.eA());return null})}E9(){this.Ub.mg(nm.WB)}Uca(){this.l3a()&&this.Ub.mg(this.Ub.wT)}l3a(){return!!this.Ub.currentScope&&this.Ub.currentScope.name===nm.WB}static sJl(b){switch(b){case 0:return"Unattempted";case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}nm.WB="DataBuddyTaskPane";nm.width=300;Object(n.a)(nm,"Box4DataBuddyTaskPane",null,
[641]);class wn{constructor(b){this.Jh=b}EIa(b){this.Jh&&this.Jh.VG(b)}Aad(){this.Jh&&this.Jh.Pad(void 0)}}Object(n.a)(wn,"RibbonButtonUpdater",null,[640]);var tk=c(332);class sm{constructor(){this.DSe=this.W=null}get name(){return"Box4.UI"}xc(b){this.W=b;b.ha("Box4.IGeneralCuiUser",()=>new Us(b.resolve("Box4.UI.CuiActionBridge"),w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.UI.TableAltTextDialogFactory",()=>new Tn(b.resolve("Box4.ITableEditor"),new tk.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();
b.ha("Box4.UI.ILanguageEditor",()=>new Oo(af.a.instance.sg,b.Na("Box4.ITextFormattingCommands"),b.Sa("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));b.ha("CommandUI.StandaloneRootController",()=>new hr(w.AFrameworkApplication.Rs)).as("Common.IStandaloneRootController").singleInstance();b.ha("Box4.UI.IAutoCorrectOptionsDialog",()=>new Cl(b.resolve("Box4.IAutoCorrectOptionsInfo"),w.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ha("Box4.UI.LanguageListHelper",()=>
new Pn(w.AFrameworkApplication.K.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").singleInstance();b.register(Go,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").singleInstance();b.ha("Box4.UI.DefaultProofingContextMenuCreator",()=>new Uq(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).singleInstance();b.ha("Box4.UI.ProofingContextMenuSectionFactory",()=>new vn(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),
b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").singleInstance();b.ha("Box4.RibbonButtonUpdater",()=>new wn(this.W.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").singleInstance();b.ha("Box4.UI.RecentColorsSectionHandler",()=>new Ml).singleInstance();b.ha("Common.IDataBuddyTaskPane",()=>new nm(gs.a.instance)).singleInstance()}init(){var b=Wa.App.ya;const k=b.Nb;ic.$vm(Object(A.a)(k,k.XJb,"onAuthenticationLost"),Object(A.a)(k,
k.YJb,"onAuthenticationRestored"),b.VRk);b=w.AFrameworkApplication.va;b.qa(Pb.a.XEn,lc.a.application,Or);b.fb(Pb.a.pto,lc.a.application,Ip,96);b.fb(Pb.a.Xto,lc.a.application,io,96);b=w.AFrameworkApplication.va;b.fb(Pb.a.Hvo,lc.a.application,vp,96);b.fb(Pb.a.fto,lc.a.application,ah,96);lh.Tb();this.lym();this.DSe=this.W.resolve("Common.IStandaloneRootController")}lym(){this.W.Sa("Box4.IGeneralCuiUser").execute(b=>{this.W.Sa("Common.IStandaloneRootController").execute(k=>{k.Zca.zF=b})})}dispose(){this.DSe.dispose();
this.DSe=null}static main(){N.a.instance.Fc(new sm,6)}}Object(n.a)(sm,"Box4UIPackage",null,[1,2]);var Dl=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},fp=c(1822);class Uj{get name(){return"Box4.Insights"}init(){}dispose(){}xc(b){b.ha("Box4.Insights.Box4InsightsSelection",
()=>new fp.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance()}}Object(n.a)(Uj,"Box4InsightsPackage",null,[1,2]);const uk=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var tl=c(399),vk=c(536),jo=c(1791);class aq{qlb(){return!1}reset(){}update(){}}Object(n.a)(aq,"NullTaskYieldStrategy",null,[590]);var bq=c(1397);class Wm{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=
this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(n.a)(Wm,"CatchUpConfiguration",null,[]);class wp{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=
this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(n.a)(wp,"SharedControllerFactoryParameters",null,[]);var Yl=c(157),Nc=c(16);class co{constructor(b,k,t,D){this.$sn=(P,ca)=>{(this.rld=!this.rld)&&ca.$j&&ca.$j.contextId===lc.a.Tc&&this.CCh(ca.$j.node,ca.$j.Aj);return 32};this.Sx=b;this.Rp=k;this.ga=t;this.Ub=D;this.hnd=this.ind=null;this.rld=!1;this.ga.qa(Nc.a.Eyj,lc.a.view,this.$sn);this.Ub.ge(ef.AFrame.rp).bindAction(Zb.KeyInputManager.kc(pc.a.Qnc,
6),Nc.a.Eyj)}tY(b,k){this.rld&&this.Rp&&k&&k.nl&&k.nl.kb&&k.nl.kb.Qa&&k.nl.kb.Qa.node&&k.nl.kb.Qa.contextId===lc.a.Tc&&this.CCh(k.nl.kb.Qa.node,k.nl.kb.Qa.Aj)}CCh(b,k){b&&(this.eQi(b)?(this.ind&&this.ind.id.equals(b.id)||(this.Rp.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.ind=b),this.L7m(b,k)):this.hnd=this.ind=null)}eQi(b){return 0<this.Sx.uEb(b).count}L7m(b,k){if(b){var t=-1,D=null,P=null;for(let ca=0;ca<b.pa.length;ca++){const ta=b.pa.J(ca);
if(!(null==P||ta.changeStart&&ta.changeStart.equals(D))&&k>=t&&k<=ta.cp&&!D.equals(this.hnd))if(this.Sx.hHb(D)){(b=this.Sx.IMc(D,b.id))&&0<b.actors.length&&b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Rp.sendNotification(b,!1),this.hnd=D);break}else this.hnd=null;ta.changeStart&&!ta.changeStart.equals(D)&&(t=ta.cp,D=ta.changeStart);P=ta.changeStart}}}}Object(n.a)(co,
"ActivityAnnouncementManager",null,[]);var Nk=c(1366),en=c(530),Dm=c(757),Ji=c(585);class Y{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(n.a)(Y,"Activity",null,[]);var la=c(391);class mb extends Y{constructor(){super();this.zv=this.objectId=null}static SG(b){const k=new Ji.a(new la.a);if(b.zv)for(const t of b.zv)k.add(t);return k}}Object(n.a)(mb,"RevisionSetActivity",Y,[]);class ec{constructor(b,
k,t,D=!1){this.Vve=null;this.dismiss=()=>{this.xQi.then(P=>{P.removeNotification(this.Vve);return this.Vve=null})};this.UW=b;this.pc=k;this.xQi=t;this.Nac=D}TMo(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.pc.Qb($a.a.n4a,2,null);break;default:this.kgn()}else v.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}kgn(){this.xQi.then(b=>{var k=Object.assign(new lq.a,{target:'[data-unique-id~="CatchUpWithChanges"]',
showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new Nk.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});k=b.callout(k);const t=Object.assign(new en.a,{expirationOptions:Object.assign(new Dm.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.Vve=b.addNotification(k,t)})}doesContentExist(b){if(!b)return v.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!b.navigationId)return v.ULS.sendTraceTag(593049025,
3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const k={};k.NavigationId=atob(b.navigationId);if(8===this.pc.Qb($a.a.jJd,2,k))return!1;break;case 1:return this.Gol(b)}return!0}Gol(b){b=mb.SG(b);return b?0<this.UW.uPd(b).count:(v.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(n.a)(ec,"ActivityContentManager",null,[770]);var rc=c(1461),Sc=c(2003),gd=c(390),Pd=c(694);class me{constructor(){this.zv=this.JX=null}compare(b){if(!b)return!1;
if(this.JX&&b.JX){if(this.JX.count!==b.JX.count)return!1;for(const k of this.JX)if(!b.JX.contains(k))return!1}else if(!b.JX&&this.JX||!this.JX&&b.JX)return!1;if(b.zv&&this.zv){if(b.zv.count!==this.zv.count)return!1;for(const k of this.zv)if(!b.zv.contains(k))return!1}else if(!this.zv&&b.zv||!b.zv&&this.zv)return!1;return!0}}Object(n.a)(me,"ActivityHighlightableObject",null,[]);class zf extends rc.a{constructor(b,k){super();this.WNe=this.MXb=null;this.Ddd=b;this.Sx=k;this.o2=[new Sc.a(gd.a.lBh,gd.a.kBh),
new Sc.a(gd.a.iBh,gd.a.hBh),new Sc.a(gd.a.HCd,gd.a.ICd),new Sc.a(gd.a.JCd,gd.a.S5e)]}get wib(){return 1}get V1a(){return this.o2}get Cba(){return!0}m1a(b,k){if(b=Object(Ka.a)(me,b))if(b.JX)for(const t of b.JX)k.add(t);else v.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}uGa(b,k){if(this.Au.kDa){var t=this.Ddd.f6a,D=this.Ddd.yib,P=!!t&&t.compare(D),ca=this.Au.kDa,ta=ca.action,Na=this.Wpo(ca,b),qb=!1;2!==ta&&ta&&(qb=(qb=this.Au.MWc)?1===qb.type:!!t||!!D);k=k.OGa("*");
for(let Jb=0,Vb=k.length;Jb<Vb;Jb++){const ac=k[Jb],yc=this.LTl(ac,gd.a.DFc);if(yc&&yc.Rt)if(this.cYn(ac),1===ca.type)switch(ta){case 0:Na&&t.zv.contains(yc.Rt)&&this.EAd(ac,2,yc,!1);break;case 2:Na&&D.zv.contains(yc.Rt)&&this.EAd(ac,P?2:1,yc,!1);break;default:this.q9b(b,ac,yc,!1)}else qb?this.q9b(b,ac,yc,!1):this.q9b(b,ac,yc,!0)}this.MXb&&(this.MXb.classList.add(gd.a.JCd),this.WNe=this.MXb=null)}}LTl(b,k){return jd.a.Db(b,k)}Wpo(b,k){if(b&&b.sA){const t=b.sA,D=b.action;if(1===b.type&&(2===D||!D)&&
t.JX)return t.JX.contains(k);if(t.zv)for(const P of t.zv){b=this.Sx.bOc(P);for(const ca of b)if(ca===k)return!0}}return!1}q9b(b,k,t,D){const P=this.Ddd.f6a,ca=this.Ddd.yib;P&&P.zv.contains(t.Rt)&&(!P.JX||P.JX.contains(b))?this.EAd(k,2,t,D):ca&&ca.zv.contains(t.Rt)&&(!ca.JX||ca.JX.contains(b))&&this.EAd(k,1,t,D)}EAd(b,k,t,D){b&&Pd.a(b)&&(b.classList.add(this.FXl(2===k,D)),this.Sgo(b,t,D))}Sgo(b,k,t){this.MXb?-1!==k.cpEnd&&this.WNe.cpEnd!==k.cpBegin&&(this.MXb.classList.add(t?gd.a.S5e:gd.a.JCd),b.classList.add(t?
gd.a.ICd:gd.a.HCd)):b.classList.add(t?gd.a.ICd:gd.a.HCd);b.classList.add(gd.a.jBh);this.MXb=b;this.WNe=k}cYn(b){this.Au.nSa(b);this.WWn(b)}WWn(b){b.classList.remove(gd.a.HCd,gd.a.ICd,gd.a.jBh,gd.a.JCd,gd.a.S5e)}FXl(b,k){return k?b?gd.a.hBh:gd.a.kBh:b?gd.a.iBh:gd.a.lBh}}Object(n.a)(zf,"ActivityHighlightActor",rc.a,[]);var qg=c(2004),Eg=c(165);class rg{constructor(b,k,t,D,P,ca,ta,Na){this.RV=b;this.MN=k;this.Sx=t;this.nyc=P;this.ib=ca;this.Rp=Na;this.Ub=ta;this.MN.NZd=!1}vWi(b,k,t){b?this.grm(b,k,t):
this.MN.f6a&&(b=Object.assign(new qg.a,{action:1,type:1,sA:null,BJ:this.MN.f6a}),this.MN.f6a=null,this.RV.BF(b))}grm(b,k,t){if(k){b=new Ji.a(new la.a);for(P of k){var D=this.Sx.hNc(P);for(let ca=0;ca<D.length;ca++){const ta=D[ca];this.Sx.hHb(ta)&&b.add(ta)}}var P=this.Sx.uPd(b);P=this.LJh(P,b);D=this.MN.f6a;this.MN.f6a=P;P=Object.assign(new qg.a,{action:0,type:1,sA:this.MN.f6a,BJ:D});this.RV.BF(P);t&&!this.l$n(k.J(0),b)||this.Zao(k.J(0),b)}else v.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",
b.activityId)}l$n(b,k){if(!b)return v.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return v.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;k=this.SQl(b,k);return this.nyc.mHa(b.id,k)?this.setSelection(b,k)?!0:!1:(v.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}Zao(b,k){b=this.GXl(b,k);k=new Sys.StringBuilder;for(let t=
0;t<b.count;t++)k.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,t+1,b.count,b.J(t)));this.Rp.sendNotification(k.toString(),!0)}setSelection(b,k){if(!b||!pe.ParagraphReader.Wb(b))return v.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>k)return v.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.MN.NZd=!0;b=Of.a.Rc(b,k);b=new Eg.Selection([b],!0);this.ib.setSelection(b);ad.FocusManager.SJ()&&
this.Ub.mg(ef.AFrame.Pn);return!0}SQl(b,k){if(k&&0<k.count)for(let t=0;t<b.pa.length;t++){const D=b.pa.J(t);if(D.changeStart&&k.contains(D.changeStart))return D.cp}v.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}GXl(b,k){const t=new Eb.a;if(k&&0<k.count&&b){let D=-1;for(let P=0;P<b.pa.length;P++){const ca=b.pa.J(P);if(-1!==D&&ca.isChangeEnd)if(ca.changeStart&&k.contains(ca.changeStart))continue;else t.add(b.characterData.substring(D,
ca.cp)),D=-1;ca.changeStart&&k.contains(ca.changeStart)&&(D=ca.cp)}}return t}CVi(b,k){if(b)switch(b.type){case 1:if(k){b=new Ji.a(new la.a);for(var t of k){k=this.Sx.hNc(t);for(let D=0;D<k.length;D++){const P=k[D];this.Sx.hHb(P)&&b.add(P)}}}else b=mb.SG(b);k=this.Sx.uPd(b);this.MN.yib=this.LJh(k,b);t=Object.assign(new qg.a,{action:2,type:1,sA:this.MN.yib,BJ:null});this.RV.BF(t)}else this.MN.yib&&(t=Object.assign(new qg.a,{action:3,type:1,sA:null,BJ:this.MN.yib}),this.MN.yib=null,this.RV.BF(t))}LJh(b,
k){var t=null;if(b){t=new Ca.a;for(const D of b)12===D.type&&t.add(D)}b=new me;b.JX=t;b.zv=k?k:this.u2l(t);return b}u2l(b){const k=new Ji.a(new la.a);if(!b)return k;for(const t of b)for(const D of this.Sx.uEb(t))k.add(D);return k}}Object(n.a)(rg,"ActivityHighlightManager",null,[]);var eh=c(498),Eh=c(458),bh=c(1459),Uh=c(109),Zl=c(59);class Nl{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(n.a)(Nl,"CreateIndicatorTooltipParameters",null,[]);class Ck{constructor(){this.clearSticky=
!1}}Object(n.a)(Ck,"DismissIndicatorTooltipParameters",null,[]);class Tg{constructor(){this.target=null;this.isSticky=!1}}Object(n.a)(Tg,"UpdateIndicatorTooltipParameters",null,[]);class Em extends Sys.EventArgs{constructor(b,k,t){super();this.UCb=b;this.Bpi=k;this.bro=t}}Object(n.a)(Em,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class Kp{constructor(){this.Cpi=new Map;this.Dpi=new Set}QJo(b,k){this.Dpi.add(b);this.Cpi.set(b,k)}GKm(b){return $d.a.Tvi(b.htmlElement)}ghm(){const b=new Set;for(const k of this.Dpi){const t=
this.Cpi.get(k);t&&this.FKm(t)&&b.add(k)}return b}FKm(b){return b.parentElement&&$d.a.Tvi(b.parentElement)}}Object(n.a)(Kp,"IndicatorVisibilityTracker",null,[]);class Jn extends bh.a{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){super();this.ra=new Ue.a;this.aub=this.G$=null;this.Xmm=(ac,yc,Kc,ed,sd)=>{if(!sd)return v.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;yc=mb.SG(sd.Activity);ac=null;if(sd.NodeId&&(sd=Uh.b(sd.NodeId),!X.a.Zp(sd,X.a.nil)&&(sd=this.Sx.d9h(sd),
this.Lkg(sd,!1))))return 32;for(const oe of yc)if(this.Sx.hHb(oe)){sd=this.Sx.o7b(oe);if(this.Lkg(sd,!0))return 32;sd&&!ac&&(ac=sd)}if(this.Lkg(ac,!1))return 32;v.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8};this.Vmm=(ac,yc,Kc,ed,sd)=>{v.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");sd&&yc&&yc.al&&(ac=yc.node)&&((ac=this.joc.JPd(ac))?this.wyd(ac,!1,!1):v.ULS.sendTraceTag(595126289,
377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.Jvo=ac=>{(ac=this.joc.JPd(ac.customData))&&this.wyd(ac,!1,!1)};this.onMouseEnter=ac=>this.GUi(ac.Mw,!0);this.fpa=ac=>{ac=ac.Mw;if(ac===this.G$)return!0;this.u9i(ac);return!0};this.kGa=ac=>{this.aub=null;return this.GUi(ac.Mw,!1)};this.s0=()=>{this.Meg();this.GDd(!0);return!1};this.Us=()=>{this.uZi()};this.c9d=()=>{this.G$&&this.dFj(this.G$);this.aub&&this.u9i(this.aub);this.tnn()};this.uZi=()=>{this.G$?
this.dFj(this.G$):this.U6e()};this.Sx=b;this.Hre=k;this.oZg=t;this.T5j=D;this.ul=P;this.m6=null;this.Hb=ta;this.joc=Na;this.NDe=new Kp;this.ox=qb;this.mK=Jb;this.tI=Vb;this.mf&&(this.mf.Hla(this.c9d),this.mf.aqh(this.uZi));ca&&ca.execute(ac=>{ac.I0(this.Us)})}get mf(){return this.ul&&this.ul.Vi?this.ul:(v.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}hDa(b,k,t){if(this.G$){var D=Zl.a(this.G$);if(b===D)return this.G$}const P=b.eh.ownerDocument;D=eh.a.createElement(P,Eh.a.div);
D.className=gd.a.KCd;D.style.left=k+"px";D.style.top=t+"px";k=eh.a.createElement(P,Eh.a.div);k.className=this.ox?gd.a.rBh:gd.a.mBh;D.style.cursor="pointer";k.style.cursor="pointer";this.tI&&(k.style.backgroundColor=this.mK.ANl(),k.style.outlineWidth="1px",k.style.outlineStyle="solid",k.style.outlineColor=this.mK.BNl());D.appendChild(k);Kf.a.instance.lb(Rc.a.mR,D,this.onMouseEnter);Kf.a.instance.lb(Rc.a.eL,D,this.fpa);Zh.a.instance.lb(Rc.a.click,D,this.kGa);Kf.a.instance.lb(Rc.a.contextMenu,D,this.s0);
v.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.e2m(b);k=this.r3l(b);this.NDe.QJo(k,D);this.NDe.GKm(b)&&this.VTi(k);return D}Dob(b){return this.Soo(b)}cfb(b){const k=this.JPk(b),t=[];t.push(this.hDa(b.I4,k,b.Pmc[0].y-b.Jba[0].y));return t}JPk(b){let k=gd.a.fvm+(0>b.aXc?-b.aXc:0);const t=Re.a.Ni(b.leftMargin,0)/2;1>=t&&v.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");k=k>t?t:k;k=k<gd.a.nBh?gd.a.nBh:k;return w.AFrameworkApplication.isRtl?
b.Jba[0].width/this.zoom+k:-k}Foj(b){if(b&&393230===b.Pc||393251===b.Pc){const k=this.Sx.uEb(b);if(k)for(const t of k)if(b===this.Sx.o7b(t))return!0}return!1}Soo(b){for(const k of pe.ParagraphReader.jw(b.Bb,!0,!1))if(this.Foj(k))return!0;return!1}Tb(b){b.qa(Nc.a.sqj,lc.a.Tc,this.Vmm);b.qa(Nc.a.eeg,lc.a.Tc,this.Xmm)}Lkg(b,k){if(!b)return!1;const t=this.joc.JPd(b);if(t)return this.wyd(t,!1,!0),!0;if(!k){let D;this.V2c((D=new Eb.a,D.add(b),D),!1,!0,!0);k=new Df.a(3,1,0,this.Jvo,181);k.customData=b;this.Hb.Vb(k);
return!0}return!1}f$k(b,k=!1){k&&this.GDd(!0);if(b&&b.parentNode){var t=this.xuf(b);t=this.DJl(t);this.m6||(this.m6=document.createElement("Div"),document.getElementById(w.AFrameworkApplication.R0b).appendChild(this.m6));this.Hre.createActivityIndicatorTooltip(Object.assign(new Nl,{target:b,container:this.m6,activityIds:t,isSticky:k,dirHint:9}));k&&(this.G$=b)}else v.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}ftl(b){b&&
b.classList.add(gd.a.LCd)}GUi(b,k){return this.wyd(b,k,!1)}wyd(b,k,t){if(k&&b===this.G$)return!0;const D=this.xuf(b);k||this.Meg();this.f$k(b,!k);this.ftl(b.getElementsByClassName(this.ox?gd.a.rBh:gd.a.mBh)[0]);this.V2c(D,k,!0,t);this.RIi(D,k?1:2);this.T5j.M2d();k&&(this.aub=b);return!0}GDd(b=!1){this.Hre.dismissActivityIndicatorTooltips(Object.assign(new Ck,{clearSticky:b}));this.aub=null;b&&(this.G$=null)}Xrj(b){b&&b.classList.remove(gd.a.LCd)}Meg(){this.G$&&this.Xrj(this.G$.getElementsByClassName(gd.a.LCd)[0])}u9i(b){const k=
this.xuf(b);this.V2c(k,!0,!1,!1);this.Xrj(b.getElementsByClassName(gd.a.LCd)[0]);this.GDd(!1);this.aub=null}xuf(b){let k=null;(b=(b=Zl.a(b))?b.Bb:null)&&11===b.type&&(k=pe.ParagraphReader.jw(b,!0,!1));return k}U6e(){const b=!!this.aub;if(this.G$||b)this.Meg(),this.GDd(!0),this.V2c(null,!1,!1,!1),this.V2c(null,!0,!1,!1)}evk(b){this.ra.addHandler(Jn.Fmh,b)}fvk(b){this.ra.addHandler(Jn.Gmh,b)}V2c(b,k,t,D){let P=null;if(t&&b){for(const ca of b)if(t=this.Sx.hNc(ca))for(let ta=0;ta<t.length;ta++){const Na=
t[ta];if(this.Sx.hHb(Na)){P=this.Sx.IMc(Na,ca.id);break}}if(!P){v.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}k?this.ra.raiseEvent(Jn.Fmh,new Em(P,b,!1)):this.ra.raiseEvent(Jn.Gmh,new Em(P,b,D))}DJl(b){const k=[];if(b)for(const D of b){var t=this.Sx.uEb(D);for(const P of t)(t=this.Sx.IMc(P,D.id))&&k.push(t.activityId)}!k.length&&b&&b.count&&v.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");
return k}dFj(b){b&&b.parentNode?(this.Hre.updateActivityIndicatorTooltip(Object.assign(new Tg,{target:b,isSticky:!0})),this.G$=b):v.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}tnn(){const b=this.NDe.ghm();for(const k of b)this.VTi(k)}VTi(b){this.oZg.QIi(b,3)}r3l(b){return(b=pe.ParagraphReader.jw(b.Bb,!0,!1))&&b.count?b.J(0).id:null}e2m(b){b=pe.ParagraphReader.jw(b.Bb,!0,!1);this.RIi(b,0)}RIi(b,
k){b&&b.count&&this.d2m(b.J(0).id,k)}d2m(b,k){this.oZg.QIi(b,k)}}Jn.Fmh="ActivityIndicatorPreviewed";Jn.Gmh="ActivityIndicatorSelected";Object(n.a)(Jn,"ActivityIndicatorActor",bh.a,[]);var ag=c(36);class Lp{constructor(b,k,t){this.Sx=b;this.uwd=k;this.ul=t}get mf(){return this.ul&&this.ul.Vi?this.ul:(v.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}JPd(b){v.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");
const k=this.e$h(b);if(!k){v.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.Sx.uEb(b);for(const t of b)if(b=this.Sx.o7b(t),b=this.e$h(b))return b}return k}e$h(b){if(!b||12!==b.type)return v.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return v.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),
null;var k=this.uwd.CPc(b);if(!k||11!==k.type)return v.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;k=k.De(this.mf.ic);if(!k||!k.htmlElement)return v.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var t=fc.a.iNc(k.htmlElement,Lp.Emh);if(t)return t;k=k.Rjf();if(!k)return v.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),
null;k=fc.a.oOl(k,Lp.Emh);if(!k)return v.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(t=0;t<k.length;t++){const D=Zl.a(k[t]),P=ag.OutlineElementNavigator.Il(b);if(D&&D.Bb&&P&&D.Bb.id.equals(P.id))return k[t]}v.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}TYl(b){b=this.Sx.d9h(b);if(!b||12!==b.type)return v.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),
X.a.nil;b=this.JPd(b);if(!b)return v.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),X.a.nil;b=Zl.a(b);return b?b.Bb.id:(v.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),X.a.nil)}}Lp.Emh="CatchUpActivityIndicatorContainer";Object(n.a)(Lp,"ActivityIndicatorHelper",null,[]);var Pr=c(1666);class Vq{constructor(b,k,t,D,P,ca,ta){this.e2a=
b;this.pageContentNode=k;this.fYe=t;this.pc=D;this.UW=P;this.Re=ca;this.DXd=ta;this.PCi=!1;this.J8m=(Na,qb,Jb)=>{if(1===Jb)return this.fxf?32:8;2===Jb&&(this.fxf&&(this.fYe.U6e(),this.sWk()),v.ULS.sendTraceTag(38138719,377,50,G.c({["MarkAsRead invoked"]:!0})));Wa.App.ya.updateCommandUI();return 8};this.e2a.u5a(this.fYe)}initialize(){this.pc.qa(Nc.a.HLi,Ud.a.frame,this.J8m)}get fxf(){return!!this.UW.oR&&0<this.UW.oR.count||!!this.UW.Qdc&&0<this.UW.Qdc.count}get KTm(){return this.PCi}xWf(b){const k=
b&&b.wywaActivities?b.wywaActivities.length:0;if(!this.DXd||0<k||!b){const t=new Map;t.set("activityCount",k.toString());this.Re.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:t})}b?(this.fin(b.wywaActivities),this.PCi=!0):(v.ULS.shipAssertTag(36538305,377,!1),this.DXd||Object(Pr.a)(),this.Re.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}fin(b){b?(v.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),
this.ono(b),b=this.UW.zuk(b),this.pno(b)):v.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}ono(b){if(b){var k=new Eb.a;for(const t of b)switch(t.type){case 2:case 3:case 4:case 10:b=4===t.type?t.a_i:t.contentId,k.add(b),this.UW.Qdc.add(b)}0<k.count&&(v.ULS.sendTraceTag(51196435,377,50,"{0}",k.count),this.pc.Qb($a.a.tPi,2,k.toArray()))}}pno(b){const k=new Ji.a(new la.a),t=new Xd.GraphTransaction(3);try{t.Cb(this.pageContentNode);for(const D of b){const P=this.UW.o7b(D);P&&this.fYe.Foj(P)&&
(k.add(P.id),this.e2a.m$b(P,!0))}}finally{t&&t.dispose()}0<b.count&&Wa.App.ya.updateCommandUI();b={};b.highlightedNodeCount=k.count;v.ULS.sendTraceTag(36509257,377,50,"{0}",G.c(b))}sWk(){v.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.UW.Qdc.count&&(this.pc.Qb($a.a.QRh,2,this.UW.Qdc.toArray()),this.UW.Qdc.clear());const b=this.rYk(this.UW.oR);this.QWn(b)}QWn(b){v.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");
const k=new Xd.GraphTransaction(3);try{k.Cb(this.pageContentNode);for(const t of b){this.UW.oR.remove(t);for(const D of this.UW.bOc(t))this.e2a.m$b(D,!0)}this.UW.nDh()}finally{k&&k.dispose()}}rYk(b){const k=new Ji.a(new la.a);for(const t of b)k.add(t);return k}}Object(n.a)(Vq,"ActivityIndicatorManager",null,[]);class Qr{constructor(){this.yib=this.f6a=null;this.isFirstDocumentOpen=this.NZd=!1}}Object(n.a)(Qr,"ActivityStateManager",null,[769]);class Mp{constructor(b,k){this.$ed={};this.ISb=b;this.nK=
k;this.Qdc=new Eb.a}get oR(){return this.ISb.oR}uEb(b){const k=new Ji.a(new la.a);if(!b)return k;b=this.ISb.QNd(b);for(let t=0;t<b.length;t++){const D=b[t];this.hHb(D)&&k.add(D)}return k}bOc(b){return this.ISb.bOc(b)}uPd(b){const k=new Eb.a;if(b)for(const t of b)k.addRange(this.bOc(t));return k}zuk(b){const k=new Ji.a(new la.a);if(b)for(const t of b)if(1===t.type&&(b=t))for(const D of b.zv){k.add(D);this.oR.add(D);const P=D.toString();this.$ed[P]||(this.$ed[P]=new Eb.a);this.$ed[P].add(b)}this.nDh();
return k}hHb(b){return this.oR&&b?this.oR.contains(b):!1}IMc(b,k){if(b&&(b=this.$ed[b.toString()])&&0<b.count){for(const t of b)if(t.objectId.equals(k))return t;return b.J(0)}return null}o7b(b){return this.ISb.o7b(b)}nDh(){this.ISb.eWk()}hNc(b){return this.ISb.hNc(b)}d9h(b){if(!this.nK)return null;const k=this.nK.Kc;return k?k.Db(b):null}}Object(n.a)(Mp,"ChangeIdCache",null,[]);var xp=c(153),Ar=c(100);class ul extends xp.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=
null;this.H_=Object.assign(new Ar.a,{T_:ul.getTypeName(),B_:ul.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(n.a)(ul,"ChangeSummariesResponse",xp.a,[]);var Np=c(439);class $o extends Np.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new Ar.a,{T_:$o.getTypeName(),B_:$o.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(n.a)($o,"ChangeSummariesRequest",Np.a,[]);var Ga=c(330),Fb=c(369),hc=c(237),Ec=c(368);class fd{constructor(){this.Qgc=this.Q4c=null}}Object(n.a)(fd,"ActionPair",null,[]);class Md{constructor(b,k,t,D){this.Ysl=P=>{P=P.customData;const ca=this.T8i(P);ca&&(v.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.Krf(P)),ca.Qgc("Request timeout"))};this.Zz=b;this.rV=k;this.Te=t;this.Hb=D;this.PDe=null;this.fOe=
new cb.a;this.Ach=new cb.a}jCo(b){const k=Object.assign(new Ga.a,{parentPath:["Signal",$o.getTypeName()],items:[Object.assign(new Fb.a,{body:b})]});return this.initialize().then(()=>{const t=new Promise((D,P)=>{this.fOe.Z(b.requestId,Object.assign(new fd,{Q4c:D,Qgc:P}))});this.Ach.Z(b.requestId,new Date);v.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",Md.requestTimeoutMs);this.rV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ec.a,
{operation:k}));this.cko(b.requestId);return t})}initialize(){this.PDe||(this.PDe=this.Zz.kl().then(()=>{this.Te.lb(this,ul.getTypeName())}));return this.PDe}UD(b,k){if(b&&hc.a.getTypeNameFor(b.content)===ul.getTypeName())if(b=b.content){var t=this.T8i(b.correspondingRequest);t?k!==Ga.a.getTypeName()?t.Qgc("Invalid operation type"):(v.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.Krf(b.correspondingRequest)),
t.Q4c(b)):v.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.Krf(b.correspondingRequest))}else v.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else v.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}cko(b){const k=new Df.a(3,1,Md.requestTimeoutMs,
this.Ysl,176);k.jyd=0;k.customData=b;this.Hb.Vb(k)}T8i(b){if(!b)return null;let k;if(!({value:k}=this.fOe.Dc(b,k)).returnValue)return null;this.fOe.remove(b);return k}Krf(b){if(!b)return-1;let k;return({value:k}=this.Ach.Dc(b,k)).returnValue?(new Date).getTime()-k.getTime():-1}static get requestTimeoutMs(){return w.AFrameworkApplication.K.mc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(n.a)(Md,"ChangeSummariesAugloopProvider",null,[251]);class Ze{constructor(){this.activityGroups=null}}Object(n.a)(Ze,
"FeaturedActivityGroupPayload",null,[]);class te{constructor(b,k,t,D,P){this.fgk=b;this.WVj=k;this.OXj=t;this.u0j=D;this.Yqb=P}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.u0j.wwb.then(()=>this.FUl(b)):te.Sgf}ukm(b,k,t){if(!k)return v.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;uk("TranslateFeaturedActivityGroups");t=this.OXj.AKo(b,k,t.wywaActivities);v.ULS.sendTraceTag(542942800,377,
50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<b.activityChanges.length,0<k.inferences.length,0<t.length);this.Yqb.set(k.correspondingRequest,t);return Object.assign(new Ze,{activityGroups:t})}FUl(b){uk("BuildFeaturedActivityGroupRequest");const k=this.fgk.FLk();if(!k||!k.documentContent||!k.activityChanges)return v.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),
te.Sgf;if(!k.documentContent.length||!k.activityChanges.length)return te.Sgf;v.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+k.requestId);uk("SubmitFeaturedActivityGroupRequest");return this.WVj.jCo(k).then(t=>this.ukm(k,t,b))}}te.Sgf=Promise.resolve(Object.assign(new Ze,{activityGroups:[]}));Object(n.a)(te,"ChangeSummariesDataProvider",null,[691]);class Ff{constructor(b,k){this.Sx=b;this.Qkk=k}FLk(){const b=new Eb.a,
k=new Eb.a,t=new Ji.a(new la.a);var D=this.Sx.oR;if(!D||!D.count)return Ff.Vgf;D=this.Sx.uPd(D);if(!D||!D.count)return v.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),Ff.Vgf;for(const P of D)t.contains(P.id)||(t.add(P.id),this.PGn(P,b,k));return k.count&&b.count?Object.assign(new $o,{activityChanges:k.toArray(),documentContent:b.toArray(),requestId:Uh.a(X.a.create())}):Ff.Vgf}PGn(b,k,t){if(pe.ParagraphReader.Wb(b)){var D=
pe.ParagraphReader.plainText(b);if(D&&D.length){k.add(D);D=this.Sx.uEb(b);D=this.Ejm(D);for(const P of D){D=new Eb.a;const ca=this.getTextRanges(b,P);for(const ta of ca)D.add({changeEnd:ta.endIndex,changeSpanId:ta.ddo,changeStart:ta.startIndex,contentIndex:k.count-1,locationId:Uh.a(b.id)});(D=this.g7k(P,D.toArray()))&&t.add(D)}}else v.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else v.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}Ejm(b){const k=
new cb.a;for(const t of b)(b=this.idi(t))?(k.nb(b)||k.Z(b,new Ji.a(new la.a)),k.J(b).add(t)):v.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return k.values}g7k(b,k){const t=[];let D=null;for(const P of b)if(b=this.Sx.IMc(P,X.a.nil)){if(!D){const ca=this.idi(P);if(!ca||!ca.length){v.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}D=
ca}t.push(b)}else v.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return t.length?D?k.length?{activityId:t[0].activityId,changes:k,personId:D,timestamp:t[0].displayTimestamp.toISOString()}:(v.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(v.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),
null):(v.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}idi(b){b=this.Sx.IMc(b,X.a.nil);if(!b)return v.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return v.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),
null;let k=b[0].id;k&&k.length||(k=b[0].email);return k}getTextRanges(b,k){const t=new Eb.a;if(!k||!k.count||!b)return t;let D=-1,P=new Ji.a(new la.a);for(let ca=0;ca<b.pa.length;ca++){const ta=b.pa.J(ca);if(-1!==D&&ta.isChangeEnd){if(ta.changeStart&&k.contains(ta.changeStart)){P.add(ta.changeStart);continue}t.add({startIndex:D,endIndex:ta.cp,ddo:this.Qkk.oij(P)});D=-1;P=new Ji.a(new la.a)}ta.changeStart&&k.contains(ta.changeStart)&&(D=ta.cp,P.add(ta.changeStart))}return t}}Ff.Vgf=Object.assign(new $o,
{activityChanges:[],documentContent:[],requestId:Uh.a(X.a.nil)});Object(n.a)(Ff,"ChangeSummariesRequestBuilder",null,[]);class gg{constructor(){this.changes=this.content=null}}Object(n.a)(gg,"ContentChange",null,[]);class qh{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(n.a)(qh,"FeaturedActivityGroup",null,[]);class Ha{constructor(){this.end=this.start=0}}Object(n.a)(Ha,"TextRange",null,[]);class Ta{constructor(b){this.joc=b}AKo(b,k,t){if(!k)return v.ULS.sendTraceTag(588379906,
377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),Ta.LJd;if(!k.inferences)return v.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),Ta.LJd;if(!k.activityClassifications)return v.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),Ta.LJd;if(!k.inferences.length||!k.activityClassifications.length)return v.ULS.sendTraceTag(561111455,
377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),Ta.LJd;const D=[],P=new Ia.a(new la.a);for(const ca of k.inferences){const ta=this.zKo(ca,b,k,t);if(!ta)continue;const Na=this.joc.TYl(Uh.b(ta.locationId));Na.equals(X.a.nil)?D.push(ta):P.nb(Na)?P.J(Na).ranking>ta.ranking&&P.Z(Na,ta):P.add(Na,ta)}b=[...Array.from(P.values),...D];b.sort((ca,ta)=>ca.ranking-ta.ranking);return b.slice(0,Ta.X9m)}zKo(b,k,t,D){if(!b||Qm.a.jf(b.activitiesInGroup))return v.ULS.sendTraceTag(588379909,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),null;const P=new Eb.a,ca=new cb.a;let ta=null;for(const qb of b.activitiesInGroup){if(!qb){v.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>qb.activityIndex||qb.activityIndex>=t.activityClassifications.length){v.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");
continue}const Jb=t.activityClassifications[qb.activityIndex];if(!Jb||Qm.a.jf(Jb.contents))v.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Na=this.wAl(D,Jb.activityId);if(Na){P.add(Na);for(const Vb of qb.changes){if(!Vb){v.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Na=Vb.value;if(0>Na||Na>=Jb.contents.length){v.ULS.sendTraceTag(576251592,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");continue}Na=Jb.contents[Na];if(!Na){v.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const ac=k.documentContent[Na.contentIndex],yc=Object.assign(new Ha,{start:Na.changeStart,end:Na.changeEnd});if(ca.nb(ac))ca.J(ac).add(yc);else{let Kc;ca.Z(ac,(Kc=new Eb.a,Kc.add(yc),Kc))}ta||(ta=Na.locationId)}}else v.ULS.sendTraceTag(588379913,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!P.count)return v.ULS.sendTraceTag(588379914,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;k=this.ufm(ca);return k.count?Object.assign(new qh,{ranking:b.ranking.value,reasons:[1],activities:P.toArray(),contentChanges:k.toArray(),locationId:ta}):(v.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),
null)}wAl(b,k){for(const t of b)if(t&&t.activityId&&t.activityId===k)return t;return null}ufm(b){const k=new Eb.a;for(const D of b){b=D.key;const P=D.value;P.Sc((ca,ta)=>ca.start-ta.start);var t=P.J(0).start;if(t>Ta.iMi){t-=Ta.iMi;b=b.substring(t,b.length);for(const ca of P)ca.start-=t,ca.end-=t}k.add(Object.assign(new gg,{content:b,changes:P.toArray()}))}return k}}Ta.LJd=[];Ta.iMi=10;Ta.X9m=4;Object(n.a)(Ta,"ChangeSummariesResponseTranslator",null,[]);class rb{constructor(){this.Yqb=new cb.a;this.oPe=
new cb.a}set(b,k){if(k.length&&b){this.Yqb.Z(b,k);for(const t of k)if(t.activities)for(const D of t.activities)D&&D.activityId?this.oPe.Z(D.activityId,b):v.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else v.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.Yqb.nb(b)?this.Yqb.J(b):null}O6m(b){return b&&this.oPe.nb(b)?this.oPe.J(b):null}}Object(n.a)(rb,"FeaturedActivityGroupCache",null,
[]);class jc{constructor(b){this.g2d=(k,t,D,P,ca)=>{if(!ca)return v.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),8;k=ca.Activity;if(!k)return v.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;t=this.Yqb.O6m(k.activityId);if(!t)return v.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),
8;D=mb.SG(k);v.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",t,k.activityId,this.oij(D));return 32};this.Yqb=b;this.MNg=new Map}Tb(b){b.qa(Nc.a.g2d,Ud.a.frame,this.g2d)}oij(b){let k=0;const t=Array(b.count);for(const D of b)b=this.i4l(D),t[k]=Uh.a(b),k++;return t.join(",")}i4l(b){let k=this.MNg.get(b);if(k&&k!=X.a.nil)return k;k=X.a.create();this.MNg.set(b,k);return k}}Object(n.a)(jc,"FeaturedActivityGroupTelemetryActor",
null,[]);var wc=c(76);class $c extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(n.a)($c,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class Ad{constructor(b,k,t){this.JN=null;this.FKo=D=>{this.GYa.reset();D=this.lfm(D.customData);let P=null;for(;D.moveNext();){const ca=D.currentNode;if(ca&&(pe.ParagraphReader.Wb(ca)&&this.ra.raiseEvent("OPV",new $c(ca)),this.GYa.update(),this.GYa.qlb())){P=ca;break}}P?this.cph(P):this.JN(!0)};this.Hb=b;this.GYa=k;this.nK=t;this.ra=new Ue.a;this.wwb=new Promise(D=>
{this.JN=D})}Rwk(b){this.ra.addHandler("OPV",b)}DIk(){this.cph(null)}cph(b){const k=new Df.a(3,1,0,this.FKo,182);k.customData=b;this.Hb.Vb(k)}lfm(b){if(!b)return wc.a.Vo(this.nK);b=ze.GraphIterator.$a(b);b.zb(7);return wc.a.mt(b,this.nK)}}Object(n.a)(Ad,"DocumentTraverser",null,[]);class Td{constructor(b){this.pc=b}shouldShowEmptyExperienceButton(){return w.AFrameworkApplication.Q_d()}getExplanationText(){return""}getCommandName(){return WordEditorIntl.WordEditorStrings.L_FileHistory}onButtonClick(){this.pc.Qb($a.a.Hie,
2,null)}onInviteOthersButtonClick(){this.pc.Qb($a.a.Z7,2,null)}}Object(n.a)(Td,"EmptyCatchUpBehaviorManager",null,[672]);class Me{constructor(b,k){this.MEl=()=>{const t=document.getElementById("flyoutItem0");t&&(v.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),t.focus())};this.$o=b;this.Ub=k}initialize(){const b=this.Ub.ge(ef.AFrame.a2b);b.OH=!0;b.parent=ef.AFrame.rp;b.Uea(this.MEl);this.$o.dT(ef.AFrame.a2b)}enableF6Focus(){this.$o.CI(ef.AFrame.a2b)}disableF6Focus(){this.$o.Rw(ef.AFrame.a2b)}}
Object(n.a)(Me,"FlyoutFocus",null,[671]);var If=c(414);class Jh{constructor(b,k,t){this.QMg=this.gXg=this.Tuc=this.Wld=!1;this.GAe=this.Ked=null;this.nqn=(D,P,ca,ta,Na)=>{Na[kg.a.Visible]=!0;Na[kg.a.On]=this.Tuc&&this.Wld;return 32};this.atn=(D,P,ca)=>{if(1===ca)return this.Wld?(this.gXg||(this.gXg=!0,v.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.Ked)return v.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),
8;this.QMg=!0;this.Ked();return 32};this.ga=b;this.lVg=k;this.Ub=t}get Skf(){return this.GAe?this.GAe:(v.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set Skf(b){this.GAe=b}initialize(){this.Tb()}registerButtonClickedEvent(b){this.Ked&&v.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.Ked=b.buttonClickedCallback}onFlyoutInitialized(){var b;this.Wld&&v.ULS.sendTraceTag(588129367,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const k=(new Date).getTime()-this.Skf.getTime();v.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",k);this.Wld=!0;(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1))||If.a.pRa("ribbon","catchUp");bf.c($a.a.FSk,!0,void 0,void 0,void 0,k)}onFlyoutVisibilityChanged(b){this.Tuc!==b.flyoutIsVisible&&
(this.Tuc=b.flyoutIsVisible,Wa.App.ya&&Wa.App.ya.updateCommandUI(!0),this.Tuc&&this.QMg&&this.Ub.mg(ef.AFrame.a2b),this.Tuc||this.lVg&&this.lVg.X_m())}logFlightTriggers(b){b.hasFlyoutData&&w.AFrameworkApplication.ue("WoCha187;WoCha187cf")}Tb(){this.ga.qa($a.a.Iyj,Ud.a.frame,this.atn);this.ga.fb($a.a.C4i,Ud.a.frame,this.nqn,96)}}Object(n.a)(Jh,"FlyoutRibbonButton",null,[670]);var Cj=c(150);class Fg{constructor(b,k){this.oR=null;this.iXd=this.nzi=!1;this.UW=b;this.Re=k;this.cjb=new Cj.a;this.OWd=new Map;
this.cjb.Z(1,new Ji.a(new la.a));this.cjb.Z(0,new Ji.a(new la.a));this.cjb.Z(2,new Ji.a(new la.a));this.cjb.Z(3,new Ji.a(new la.a));this.OWd.set(3,"CatchUpIndicatorVisible");this.OWd.set(1,"CatchUpIndicatorPreviewed");this.OWd.set(2,"CatchUpIndicatorSelected");this.pde=0}QIi(b,k){if(this.cjb.J(k).add(b)){this.f2m(k);switch(k){case 0:v.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:v.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");
break;case 2:v.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:v.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.xCh()}}Cpn(b){this.oul();b=this.UW.uEb(b);for(const k of b)if(this.oR.remove(k)){this.pde++;break}}oul(){if(!this.oR){this.oR=new Ji.a(new la.a);for(const b of this.UW.oR)this.oR.add(b)}}jAk(){v.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.pde);this.xCh()}xCh(){this.pde&&
(this.tUk(),this.eUk())}tUk(){!this.nzi&&.5<=this.cjb.J(0).count/this.pde&&(this.nzi=!0,bf.c($a.a.HSk),v.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}eUk(){if(!this.iXd){var b="";1<=this.cjb.J(1).count&&(this.iXd=!0,b="previews");1<=this.cjb.J(2).count&&(this.iXd=!0,b="selections");this.iXd&&(bf.c($a.a.ASk),v.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}f2m(b){(b=this.OWd.get(b))&&this.Re.logKpiUsage(b,0)}}Object(n.a)(Fg,"IndicatorTelemetryActor",
null,[]);var mi=c(476);c(1065);class Dj{constructor(b,k){this.y7c=b;this.EFc=k}jhm(){return this.EFc.promise.then(b=>b.getWywaActivitiesResponse)}getActivities(b,k){return mi.b(this.y7c.requestActivities(b,k))}getRelevantActivities(b,k){return this.EFc.promise.then(t=>t.getWywaActivitiesResponse.WywaWaterline===b?Promise.resolve(t.getRelevantActivitiesResponse):mi.b(this.y7c.requestRelevantActivities(b,k)))}updateActivityState(b){return mi.b(this.y7c.updateActivityState(b))}getActivityFeed(){return this.EFc.promise.then(b=>
void 0!==b.activityFeed?Promise.resolve(b.activityFeed):mi.b(this.y7c.requestActivityFeed()))}updateWaterline(){return mi.b(this.y7c.a3n())}}Object(n.a)(Dj,"ActivityRepository",null,[]);var Ej=c(1066),wf=c(1034);class cf{constructor(b,k,t,D,P,ca=!1){this.activityContentManager=b;this.pc=k;this.vpl=t;this.Re=D;this.gvm=P;this.Nac=ca}YKf(b){const k=new Map;k.set("activityType",b.type.toString());this.Re.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:k})}lKf(b){this.Re.logKpiFailure("CatchUpNavigateToActivity",
b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}Tdn(b){try{const k=b.activity;this.YKf(b.activity);1==k.type&&this.gvm.M2d();if(!this.activityContentManager.doesContentExist(k))return this.activityContentManager.TMo(k),this.lKf("Content does not exist"),Promise.resolve(2);const t={};let D=0;switch(k.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:t.ActivityId=k.activityId;t.NavigationId=atob(k.navigationId);D=this.pc.Qb($a.a.h8e,2,t);break;case 1:t.Activity=
k,t.NodeId=b.locationId,D=this.pc.Qb(Nc.a.eeg,2,t),t.NodeId&&this.pc.Qb(Nc.a.g2d,2,t)}8==D&&this.lKf("Action failed")}catch(k){return v.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",k),this.lKf("Exception was thrown"),Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.vpl.wwb.then(()=>this.Tdn(b))}}Object(n.a)(cf,"WordActivityNavigationManager",null,[668]);var jf;(function(b){b[b.default=0]="default";b[b.D48X48=1]="D48X48";
b[b.D64X64=2]="D64X64";b[b.D96X96=3]="D96X96";b[b.D120X120=4]="D120X120";b[b.D240X240=5]="D240X240";b[b.D360X360=6]="D360X360";b[b.D432X432=7]="D432X432";b[b.D504X504=8]="D504X504";b[b.D648X648=9]="D648X648"})(jf||(jf={}));Object(n.b)("ProfilePhotoDimension",jf);var xg=c(762),Bg=c(1460);class lk{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(n.a)(lk,"ActivityFeedEntry",null,[]);const Ni=(b,k)=>k.kWc?Xl.toArray(Xl.select(Xl.asEnumerable(b),
t=>{if(!t||!t.activityFeedItemPayload)return t;const D=JSON.parse(t.activityFeedItemPayload);var P=D.actor;if(!P||P.pictureUrl)return t;const ca=P.userPrincipalName||P.email;if(!ca)return t;P=k.lBb(ca,P.provider,w.AFrameworkApplication.hm,0);if(!P)return t;D.actor.pictureUrl=P;return Object.assign(new lk,{id:t.id,type:t.type,collectionId:t.collectionId,activityState:t.activityState,activityFeedItemPayload:JSON.stringify(D),timestamp:t.timestamp})})):b,Qh=(b,k)=>{const t=new Map,D=new Map;for(const P of b){if(!P||
!P.activityFeedItemPayload)continue;b=JSON.parse(P.activityFeedItemPayload).actor;if(!b)continue;const ca=b.email||b.userPrincipalName;ca&&!D.has(ca)&&D.set(ca,new xg.a(ca,null,b.name))}D.forEach(P=>{const ca=k.M8b(P,6);t.set(P.UserId,ca)});return t};var ni=c(501);class Ok{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(n.a)(Ok,"ActivityRequestPayload",null,[]);class nq{constructor(){this.color=
this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(n.a)(nq,"Person",null,[]);class pt extends Y{constructor(){super();this.relationship=0}}Object(n.a)(pt,"TaskActivity",Y,[]);class oq extends Y{constructor(){super();this.contentId=null}}Object(n.a)(oq,"CommentActivity",Y,[]);class Rr extends oq{constructor(){super()}}Object(n.a)(Rr,"CommentReplyActivity",oq,[]);class uu extends oq{constructor(){super();this.a_i=null}}Object(n.a)(uu,"MentionActivity",oq,[]);class Op{constructor(b,
k,t,D){this.Zqb=b;this.KLa=k;this.czc=t;this.MN=D;this.MN.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.Zqb.jhm().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.Gaf("GetWYWAActivities",b);155===b.StatusCode&&(v.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.MN.isFirstDocumentOpen=!0);const k=this.hkg(b.People);return Object.assign(new Ok,{activities:this.Yle(b.Activities,k),actors:k,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,
lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,k){return this.Zqb.getActivities(b,k).then(t=>{if(!t||t.StatusCode)throw this.Gaf("GetActivities",t);const D=this.hkg(t.People);return Object.assign(new Ok,{activities:this.Yle(t.Activities,D),actors:D,hasMore:!t.RequestedRetrieved,highWaterline:t.HighWaterline,lowWaterline:t.LowWaterline})})}requestRelevantActivities(b){return this.Zqb.getRelevantActivities(b,this.MN.isFirstDocumentOpen).then(k=>
{if(!k||k.StatusCode)throw this.Gaf("GetRelevantActivities",k);const t=this.hkg(k.People),D=this.Yle(k.NewActivities,t,2);k=this.Yle(k.OutstandingActivities,t,3);for(const P of k)D.push(P);return Object.assign(new Ok,{activities:D,actors:t})})}updateActivityState(b){return this.Zqb.updateActivityState(b)}requestActivityFeed(){return this.Zqb.getActivityFeed().then(b=>({activityFeedItems:this.Nym(b),personaColorMap:this.WMk(b)}))}Yle(b,k,t=1){const D=[];if(!b)return D;for(const ta of b){var P=null;
b=[];b.push(k[ta.CreatorIndex]);switch(ta.ActivityType){case 1:P=ta;var ca=new mb;ca.zv=new Eb.a;for(const Na of P.ChangeIds)ca.zv.add(Uh.b(Na));ca.objectId=Uh.b(P.ObjectId);P=ca;break;case 2:P=ta;ca=new oq;ca.contentId=P.ContentId;ca.navigationId=P.NavigationId;P=ca;break;case 4:P=ta;ca=new uu;b.push(k[P.MentioneeIndex]);ca.a_i=P.ParentContentId;ca.navigationId=P.NavigationId;P=ca;break;case 3:case 10:P=ta;ca=new Rr;b.push(k[P.RepliedIndex]);ca.contentId=P.ContentId;ca.navigationId=P.NavigationId;
P=ca;break;case 6:case 7:case 8:case 9:P=ta,ca=new pt,b.push(k[P.MentioneeIndex]),ca.navigationId=P.NavigationId,ca.relationship=P.Relationship,P=ca}P&&(P.actors=b,P.displayTimestamp=new Date(ta.DisplayTimestamp),P.activityId=Uh.b(ta.ActivityId).toString(),P.type=ta.ActivityType,1!==t&&(P.relevancy=t),D.push(P))}return D}P5n(b,k,t){return this.czc&&this.czc.kWc?this.czc.lBb(k,t,w.AFrameworkApplication.hm,jf.default):b}hkg(b){if(!b)return null;const k=Array(b.length);for(let t=0;t<b.length;t++){if(!b[t])continue;
const D=new nq;D.id=b[t].Id;D.provider=b[t].Provider;D.displayName=b[t].DisplayName;D.email=b[t].Email;D.imageUrl=this.P5n(b[t].PictureUrl,b[t].Email,b[t].Provider);this.KLa&&(D.color=this.KLa.M8b(new xg.a(D.email,void 0,D.displayName),Bg.a.catchUpFlyout));k[t]=D}return k}Gaf(b,k){let t="null";k&&(t=ni.a[k.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,t))}Nym(b){return this.czc?Ni(b,this.czc):b}WMk(b){return this.KLa?Qh(b,this.KLa):new Map}}Object(n.a)(Op,"WordActivityRequestManager",
null,[667]);class Tu{constructor(b,k,t){this.$od=0;this.lzc=!1;this.m3g=null;this.updateWaterline=()=>{if(Wa.App.lostSession)v.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.lzc||3>=this.$od){this.lzc?this.lzc=!1:this.$od++;const D=Math.max(this.Ma.mc("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.m3g),0);v.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",D);Rj.Task.delay(D).continueWith(()=>
{this.Zqb.updateWaterline().then(()=>{this.Qee();return null}).catch(()=>{this.Qee();this.lzc=!0;this.$od=0})})}else this.Qee()};this.Ma=b;this.Zqb=t;k.Bzd(()=>{this.lzc=!0;this.m3g=new Date;this.$od=0})}start(){this.Qee()}Qee(){window.setTimeout(this.updateWaterline,6E4)}}Object(n.a)(Tu,"WordEditorActivityScheduler",null,[]);class Kx{constructor(){this.resolve=null;this.promise=new Promise(b=>{this.resolve=b})}neo(b){this.resolve(b)}}Object(n.a)(Kx,"CatchUpNetworkRequestWorkerCache",null,[]);class Uk{constructor(b,
k,t){this.cfl=b;this.K=k;this.Re=t}xWf(b){b&&b.authors&&this.Z1m(b.authors)}Z1m(b){for(const k of b)k&&k.displayName===this.cfl&&(this.Re.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),v.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",k.id===this.K.jb("PresenceUserId"),k.email===this.K.jb("UserPrincipalName")))}}Object(n.a)(Uk,
"WywaAuthorComparator",null,[]);class vu{constructor(b){this.V0=b}M2d(){this.V0&&this.V0.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(n.a)(vu,"IndicatorSurveyActor",null,[]);var Rt=c(1037),Vs=c(1030);class Sr{constructor(){this.ISk={crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get CSk(){return w.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")}get JBf(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChangeSummariesEnabled",
!1)}get Hvi(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get $ui(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",!1)}get kXd(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get DXd(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCatchUpActivitiesReadyTelemetryFixV2Enabled",
!1)}get CSm(){return w.AFrameworkApplication.K.$("IsUserFromDifferentTenant")}get Nac(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",!1)}xc(b){uk("Configure");this.container=b;b.ha("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new Kx).singleInstance()}init(){uk("Init");this.CSk&&(N.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,
4,w.AFrameworkApplication.rootQuerySignature,Wa.App.webServiceBase+"OneNote.ashx",2,this.kXd)}),uk("HotStore"),Wa.App.nda.eGb.execute(()=>{uk("ChromeReady");Tj.a.get_instance().Dk(7,()=>{uk("ScriptDownload");(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").Kz.loadScript("catchUpActivity")).catch(b=>{v.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",
b)}).then(()=>this.Qjn()).catch(b=>{v.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",b)})})}))}Qjn(){uk("CreateObjectsAndInitializeState");this.a1m();this.r7k();return this.gxm()}a1m(){v.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");v.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");v.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.JBf&&v.ULS.sendTraceTag(588130079,
3012,50,"ChangeSummaries is enabled");this.Hvi&&v.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.$ui&&v.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");v.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.CSm);this.kXd&&v.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}gxm(){this.Mxm();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").Skf=new Date;uk("InitializeCatchUpApp");return this.$1b.initialize(Object.assign(new Wm,
{featuredActivityGroupsEnabled:this.JBf,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.Hvi,customDynamicEntryPointEnabled:this.$ui,activityFeedDataEnabled:this.kXd})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}r7k(){this.container.ha("WordEditor.CatchUpActivity.ChangeIdCache",()=>new Mp(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),Yl.App.Ln.gb.wc.ed)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",
()=>new Rt.a(xa.Health.instance,new Vs.a,this.ISk)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IActivityStateManager",()=>new Qr).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityContentManager",()=>new ec(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),w.AFrameworkApplication.va,bk.UISurfaces.tM(),this.Nac)).as("Common.App.CatchUpActivity.IActivityContentManager").singleInstance();this.container.ha("WordEditor.CatchUpActivity.Network.ActivityRepository",
()=>new Dj(new Ej.a(Tb.a.Dyj(this.container.Sa("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),()=>w.AFrameworkApplication.rootQuerySignature,Wa.App.webServiceBase+"OneNote.ashx",2,Tb.a.Dyj(this.container.Sa("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityRequestManager",()=>new Op(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),
this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.Nac)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new rg(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
Yl.App.Ln.gb.wc,new wf.a(Yl.App.Ln.gb.wc),af.a.instance,ad.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new jo.a(50,$d.a.$e):new aq;return new Ad(w.AFrameworkApplication.nc,b,Yl.App.Ln.gb.wc.ed)}).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorSurveyActor",
()=>new vu(this.container.Sa("Common.ISystemInitiatedFeedback"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityNavigationManager",()=>new cf(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),w.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),this.Nac)).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new Jh(w.AFrameworkApplication.va,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),ad.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutFocus",()=>new Me(tl.a.instance,ad.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",
()=>new rb).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new Lp(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),Yl.App.Ln.gb.wc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",()=>new jc(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IChangeSummariesDataProvider",
()=>new te(new Ff(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new Md(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),w.AFrameworkApplication.nc),new Ta(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),
this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),this.Nac)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new Td(w.AFrameworkApplication.va)).as("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").singleInstance();this.$1b=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new wp,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),
activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:w.AFrameworkApplication.K.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),dataCulture:w.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.kXd?this.container.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),
flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),uiCulture:w.AFrameworkApplication.uiCulture,ulsLogger:new vk.a}));this.$1b.setWebpackPublicPath(w.AFrameworkApplication.o5);this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new zf(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WordEditorActivityScheduler",
()=>new Tu(w.AFrameworkApplication.K,bq.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new Fg(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorActor",()=>new Jn(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
this.$1b.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),Yl.App.Ln.gb.wc,this.container.Sa("Common.IZoomManager"),w.AFrameworkApplication.nc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!Wa.App.instance&&Wa.App.instance.uoa,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Wa.App.instance&&Wa.App.instance.RC)).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorManager",()=>new Vq(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,Yl.App.Ln.gb.wc.ed,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),w.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.DXd)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityAnnouncementManager",
()=>new co(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("Common.Utils.IAriaNotifier"),w.AFrameworkApplication.va,ad.FocusManager.instance())).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>new Uk(w.AFrameworkApplication.userName,w.AFrameworkApplication.K,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance()}Mxm(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),
k=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");b.t5a(k);const t=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const D=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");k=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const P=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),
ca=af.a.instance,ta=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");ca.Lw(()=>{P.NZd?P.NZd=!1:(P.f6a&&t.vWi(null,null,!1),P.yib&&t.CVi(null,null),D.U6e())});ca.Lw(Object(A.a)(k,k.tY,"onSelectionChanged"));this.$1b.getWywaEvent().addListener(Object(A.a)(b,b.xWf,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.$1b.getWywaEvent().addListener(Object(A.a)(b,b.xWf,"onWywaActivityReady"));const Na=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");
ta.Rwk((qb,Jb)=>{Jb&&Na.Cpn(Jb.node)});ta.wwb.then(()=>{Na.jAk()});this.$1b.getWywaEvent().addListener(()=>{ta.DIk()});D.evk((qb,Jb)=>{Jb&&t.CVi(Jb.UCb,Jb.Bpi)});D.fvk((qb,Jb)=>{Jb&&t.vWi(Jb.UCb,Jb.Bpi,Jb.bro)});D.Tb(w.AFrameworkApplication.va);this.JBf&&this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor").Tb(w.AFrameworkApplication.va);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();
this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();this.mvo()}mvo(){Qg.c()&&(v.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(n.a)(Sr,"WordEditorCatchUpActivityPackageManager",null,[1,2]);var jr=c(182),yp=c(397),Qo=c(1491),Tr=c(450),Ro=c(1598),zp=c(1492),St=c(1661),Uu=c(1662),Vu=c(635),cq=c(1663),
Wu=c(851),pq=c(135),dq=c(1500);class Ap{constructor(){this.zt=this.annotation=null}}Object(n.a)(Ap,"AnnotationChangedData",null,[]);class Xu{constructor(b,k,t,D,P,ca,ta,Na=!1,qb){this.annotationType=b;this.IW=k;this.Dq=t;this.Rje=D;this.sbd=P;this.gZo=ca;this.gb=ta;this.Coj=Na;this.K=qb;this.NA=null;this.qzi=!1;this.kd=new Ue.a;this.MZc=0}UF(b){this.kd.addHandler("AnnotationChangedEvent",b)}UH(b){this.kd.removeHandler("AnnotationChangedEvent",b)}register(){return this.sbd().then(()=>{0===this.MZc&&
(this.Coj&&(this.NA=this.Dq.Zf("WebServiceCall",this.annotationType)),this.IW.lb(this,this.annotationType));this.MZc++})}unregister(){return this.sbd().then(()=>(new Promise(b=>setTimeout(b,this.K.mc(pq.a.hkl,3E3)))).then(()=>{0<this.MZc&&(this.MZc--,0===this.MZc&&this.IW.rc(this,this.annotationType))}))}O6b(){return this.sbd().then(()=>this.IW.getAnnotationsByType(this.annotationType))}z3h(b){b=yp.a.sM(b);return(b=this.IW.y3h(b))&&0<b.count?b.toArray().filter(k=>hc.a.matchesTypesFor(k.content,[this.annotationType])):
[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.gZo(this.gb.Uc.od,b.parentPath):null:(v.ULS.shipAssertTag(575930380,3016,!1),null)}Zua(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new Wu.a,{parentPath:["Signal",hc.a.getTypeNameFor(b)],items:[Object.assign(new Fb.a,{body:b})]});this.Rje.submitOperation(b)}bsl(b,k){b=Object.assign(new Ga.a,{parentPath:["Signal",k],items:b});this.Rje.submitOperation(b)}UD(b,k){b?k?(this.Coj&&!this.qzi&&(this.NA.stop(),this.qzi=!0),this.kd.l8&&
(b=new dq.a(Object.assign(new Ap,{annotation:b,zt:k})),this.kd.raiseEvent("AnnotationChangedEvent",b))):v.ULS.shipAssertTag(575930382,3016,!1):v.ULS.shipAssertTag(575930381,3016,!1)}}Object(n.a)(Xu,"AnnotationManager",null,[327,251]);class Ur{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){this.XI=b;this.qee=k;this.jDb=t;this.z0a=D;this.O7=P;this.Nxj=ca;this.i1=ta;this.KPb=Na;this.P4b=qb;this.KLb=Jb;this.YEo=Vb}}Object(n.a)(Ur,"AnnotationManagerHolder",null,[326]);class Xw{constructor(b,k){this.gCa=b;this.sbd=
k}submitOperation(b){return this.sbd().then(()=>{this.gCa.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ec.a,{operation:b}))})}}Object(n.a)(Xw,"SubmitOperationHelper",null,[]);var Xm=c(866),qt=c(1664),Br=c(1063),dg=c(103),Un=c(124),Oi=c(78),Ws=c(1083);class Cr{constructor(b,k,t){this.O7=b;this.An=k;this.kZi=t;this.GDa={};this.NSh=!1;this.Olb=(D,P)=>{var ca;P.data.zt!==Ga.a.getTypeName()&&P.data.zt!==Ws.n.getTypeName()||!P.data.annotation||P.data.annotation.annotationType!==qt.a.getTypeName()||
(D=P.data.annotation.content)&&null!==(ca=D.documentTypeConfidences)&&void 0!==ca&&ca.length&&(this.MSh=D.documentTypeConfidences[0].documentTypeLabel,v.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.MSh))};this.O7.UF(this.Olb);this.O7.register();this.GDa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}KPd(){this.NSh||(this.O7.Zua(new Br.a),
v.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.NSh=!0);this.yol();this.GDa.docType=this.MSh;this.GDa.characterCount=this.characterCount;this.GDa.paragraphCount=this.A0;this.GDa.imageCount=this.UQ;this.GDa.tableCount=this.Bqa;this.GDa.listElementsCount=this.fFi;this.GDa.blobsCount=this.fwh;this.GDa.pageCount=this.kZi.DPc();this.GDa.currentPage=this.kZi.Aci();return this.GDa}yol(){this.A0=this.fwh=this.fFi=this.Bqa=this.UQ=this.characterCount=0;var b=this.An.jEa(Yl.App.Ln.gb.wc.ed,
7,7).currentNode,k=ze.GraphIterator.$a(b);for(b=wc.a.mt(k,b);b.moveNext();)if(k=b.currentNode)if(Be.ImageReader.gv(k))this.UQ++;else if(Ih.TableReader.eY(k))this.Bqa++;else if(dg.ListItemReader.sh(k))this.fFi++;else if(pe.ParagraphReader.Wb(k)){var t=Oi.e(k);for(let D=0;D<t.length;D++)5===t[D].Dh?this.UQ++:this.fwh++;t=Un.AParagraphNode.OU(k.characterData);t=t.trim();this.characterCount+=t.length;0<t.length&&!pe.ParagraphReader.z8(k)&&!pe.ParagraphReader.aY(k)&&this.A0++}}}Object(n.a)(Cr,"LoggingDocumentInfo",
null,[319]);class gp{constructor(){this.ra=new Ue.a}lxk(b){this.ra.addHandler("OnTaskPaneReviewStateChanged",b)}w_n(b){this.ra.removeHandler("OnTaskPaneReviewStateChanged",b)}kwk(b){this.ra.addHandler("BlueDotClickedEvent",b)}c_n(b){this.ra.removeHandler("BlueDotClickedEvent",b)}xwk(b){this.ra.addHandler("OnFormattingMarkedForReview",b)}zwk(b){this.ra.addHandler("OnFormattingReviewCompleted",b)}wwk(b){this.ra.addHandler("OnFormattingAccept",b)}ywk(b){this.ra.addHandler("OnFormattingReject",b)}cxk(b){this.ra.addHandler("OnReviewInvalidated",
b)}kqh(b){this.ra.addHandler("OnTraigeAction",b)}f_e(b){this.ra.addHandler("OnReviewVisibilityChanged",b)}o_n(b){this.ra.removeHandler("OnReviewVisibilityChanged",b)}hwk(b){this.ra.addHandler("OnBeforeReviewNavigation",b)}Zwk(b){this.ra.addHandler("OnRegisterEnhancement",b)}nxk(b){this.ra.addHandler("onTooltipVisibilityChanged",b)}x_n(b){this.ra.removeHandler("onTooltipVisibilityChanged",b)}Y2c(b){b?this.ra.raiseEvent("OnTaskPaneReviewStateChanged",new dq.a(b)):v.ULS.shipAssertTag(575930374,3016,
!1)}aMn(b){b?this.ra.raiseEvent("BlueDotClickedEvent",new dq.a(b)):v.ULS.shipAssertTag(575930375,3016,!1)}dMn(b){b?this.ra.raiseEvent("OnFormattingMarkedForReview",new dq.a(b)):v.ULS.shipAssertTag(575930376,3016,!1)}f5i(b){b?this.ra.raiseEvent("OnFormattingReviewCompleted",new dq.a(b)):v.ULS.shipAssertTag(573850377,3016,!1)}cMn(b){b?this.ra.raiseEvent("OnFormattingAccept",new dq.a(b)):v.ULS.shipAssertTag(575930377,3016,!1)}eMn(b){b?this.ra.raiseEvent("OnFormattingReject",new dq.a(b)):v.ULS.shipAssertTag(575930378,
3016,!1)}fMn(b){b?this.ra.raiseEvent("OnReviewInvalidated",new dq.a(b)):v.ULS.shipAssertTag(575930379,3016,!1)}y2f(b){b?this.ra.raiseEvent("OnTraigeAction",new dq.a(b)):v.ULS.shipAssertTag(573850378,3016,!1)}g5i(b){b?this.ra.raiseEvent("OnReviewVisibilityChanged",new dq.a(b)):v.ULS.shipAssertTag(573850379,3016,!1)}$Ln(b){b?this.ra.raiseEvent("OnBeforeReviewNavigation",new dq.a(b)):v.ULS.shipAssertTag(573687395,3016,!1)}Dgc(b){b?this.ra.raiseEvent("OnRegisterEnhancement",new dq.a(b)):v.ULS.shipAssertTag(555055117,
3016,!1)}z5i(b){b?this.ra.raiseEvent("onTooltipVisibilityChanged",new dq.a(b)):v.ULS.shipAssertTag(540587343,3016,!1)}}Object(n.a)(gp,"ReviewEvents",null,[304]);class Tt{constructor(b){this.Mt=b;if(!b)throw jr.a.argument("Workspace is null");}get name(){return"WordEditor.Designer.Common"}init(){}xc(b){this.W=b;b.ha("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new Xw(this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),yp.a.kl)).singleInstance();b.ha("WordEditor.Designer.IDesignerControl",
()=>new Xm.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),w.AFrameworkApplication.uiCulture)).singleInstance();b.ha("WordEditor.Designer.Common.Review.IReviewEvents",()=>new gp).singleInstance();b.ha("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new Ur(this.fDa(zp.DocumentRoleDetectionAnnotation.getTypeName()),this.fDa(zp.RoleDetectionAnnotation.getTypeName()),this.fDa(Qo.FormattingSuggestionsSummaryAnnotation.getTypeName(),!0),this.fDa(Qo.FormattingSuggestionsAnnotation.getTypeName()),
this.fDa(Tr.DocumentTypeClassifierAnnotation.getTypeName()),this.fDa(Uu.ThemeExtractorAnnotation.getTypeName()),this.fDa(Vu.ThemeGeneratorAnnotation.getTypeName()),this.fDa(St.TextToImageAnnotation.getTypeName()),this.fDa(Ro.DocumentPullQuoteAnnotation.getTypeName()),this.fDa(Ro.PullQuoteAnnotation.getTypeName()),this.fDa(cq.TableTypeAnnotation.getTypeName()))).singleInstance();b.ha("WordEditor.Designer.DocumentInfo",()=>new Cr(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").O7,
b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).singleInstance()}dispose(){}fDa(b,k=!1){return new Xu(b,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),yp.a.kl,yp.a.Ehb,this.Mt,k,this.W.resolve("Common.IAppSettingsManager"))}}Object(n.a)(Tt,"PackageManager",null,[1,2]);var $l=c(1026),qq=c(1485),wu=c(1667);class hs extends Sys.EventArgs{constructor(b,
k){super();this.node=b;this.IQf=k}}Object(n.a)(hs,"RoleChangeArgs",Sys.EventArgs,[]);class Ho{constructor(b){this.Kh=!1;this.dQ=b;this.dQ.pld++}dispose(){this.Kh||(this.Kh=!0,this.dQ.pld--)}}Object(n.a)(Ho,"InvalidationSuspension",null,[9]);class hl{constructor(){this.x9c=null;this.role=this.h4d=0;this.ozb=this.UZd=this.hha=this.Ibc=!1;this.p3d=this.lYc=this.zOa=null;this.removed=this.placeholder=!1;this.yAd=this.tbf=null;this.xAd=0}get M2a(){return!this.role||!this.zOa||!this.zOa.length}mCm(){this.ozb=
this.UZd=!0}SSm(){return!!this.role||!!this.zOa||!!this.x9c}}Object(n.a)(hl,"RoleState",null,[396]);class Vn{constructor(b,k,t,D,P){this.Ah=!1;this.WWd=null;this.XLf=new bc.a;this.XXg=0;this.f7n=(ca,ta)=>{ta.data.zt===Ga.a.getTypeName()&&(ta=ta.data.annotation,(ca=ta.content)?(ta=this.nYb.getParent(ta))&&this.S6c(ta,qq.e(ca.roleType),!1,void 0,null!=ca.listID?ca.listID:0,ca.listItemlevel,ca.listItemPrefix):v.ULS.shipAssertTag(575813856,3016,!1))};this.hpl=(ca,ta)=>{if(ta.data.zt===Ga.a.getTypeName())if(ca=
ta.data.annotation.content)for(v.ULS.sendTraceTag(556074199,3016,50,ca.confidence.toString()),this.XLf=new bc.a,ta=0;ca.listInfos&&ta<ca.listInfos.length;ta++){const Na=ca.listInfos[ta];this.XLf.Z(Na.listID,Na)}else v.ULS.shipAssertTag(556323522,3016,!1)};this.jyi=(ca,ta)=>{ca=ca.yP;if(!ca||ca.ia(Cc.a.kB,!1))return!1;ca=ca.getValue(Cc.a.la);if(!ca)return!1;ca=qq.f(ca);return 1!=ca&&ca!=ta.role};this.EGl=(ca,ta)=>{ca=ta.data.annotation;const Na=this.mjd.getParent(ca);if(Na)if(ta.data.zt===Ga.a.getTypeName()){const qb=
ta.data.annotation.content;qb?this.Vca(Na,Jb=>{this.WWd&&Jb.tbf&&this.WWd>Jb.tbf&&!Jb.ozb||Jb.role!==Jb.h4d||this.jyi(Na,Jb)?(v.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",this.WWd,Jb.ozb,Jb.role===Jb.h4d),Jb.x9c=qb.suggestions):(Jb.zOa=qb.suggestions,Jb.ozb=!1)}):v.ULS.shipAssertTag(575813859,3016,!1)}else ta.data.zt===$l.a.getTypeName()&&this.Vca(Na,qb=>{qb.zOa=null;qb.x9c=null});else v.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ca.id} parentPath: ${ca.parentPath}`)};
this.tmn=(ca,ta)=>{(ca=ta.data.paragraphNode)?this.Vca(ca,Na=>{ta.data.UHj?(Na.yAd=Na.zOa,Na.xAd=Na.role):(Na.yAd=null,Na.xAd=0);Na.hha=!0}):v.ULS.shipAssertTag(575930368,3016,!1)};this.vmn=(ca,ta)=>{(ca=ta.data.paragraphNode)?this.Vca(ca,Na=>{Na.hha=!1;Na.yAd=null;Na.xAd=0;5!==ta.data.state&&(Na.zOa=null)}):v.ULS.shipAssertTag(573850380,3016,!1)};this.rmn=(ca,ta)=>{(ca=ta.data.paragraphNode)?this.Vca(ca,Na=>{Na.hha=!0}):v.ULS.shipAssertTag(575930369,3016,!1)};this.umn=(ca,ta)=>{(ca=ta.data.paragraphNode)?
this.S6c(ca,1,!0,!0):v.ULS.shipAssertTag(575930370,3016,!1)};this.fWf=(ca,ta)=>{(ca=ta.data.paragraphNode)?this.S6c(ca,ta.data.IQf,!0,!0):v.ULS.shipAssertTag(575484484,3016,!1)};this.fjm=(ca,ta)=>{if(ta.node){var Na=ta.node;ca=this.pA(Na);27==ca.role&&v.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ca.hha&&27!==ca.role&&28!==ca.role&&this.wnj(this.jNb-1);ca.M2a||27===ca.role||28===ca.role||this.pnj(this.inconsistenciesCount-1);this.Vca(Na,qb=>{qb.removed=!0});setTimeout(()=>this.removeNode(Na),
1E4)}else v.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ca=>{let ta;({value:ta}=this.mu.Dc(ca.id));(null===ta||void 0===ta?0:ta.removed)&&this.mu.remove(ca.id)};this.ejm=(ca,ta)=>{ta.node?(ca=ta.node,this.TUc(ca)?this.Vca(ca,Na=>{Na.removed=!1}):this.Vca(ca,Na=>{Na.ozb=!1})):v.ULS.shipAssertTag(540672206,3016,!1)};this.gjm=(ca,ta)=>{ta.node?this.Vcg(ta.property,ta.node)&&(ca=ta.node,this.pld||ca.M$d?this.Vca(ca,Na=>{Na.ozb=!1}):this.Vca(ca,Na=>{Na.mCm();Na.x9c&&(Na.zOa=Na.x9c,Na.role=Na.h4d)}).hha&&
this.OXa.fMn(new wu.a(ta.node))):v.ULS.shipAssertTag(575930372,3016,!1)};this.Fqn=(ca,ta)=>{switch(ta.data.role){case 27:const Na=ta.data;this.Vca(ta.data.paragraphNode,Jb=>{Jb.role=27;Jb.Ibc=!0;Jb.placeholder=Na.placeholder});break;case 28:const qb=ta.data;this.Vca(ta.data.paragraphNode,Jb=>{Jb.role=28;Jb.Ibc=!0;Jb.placeholder=qb.placeholder;Jb.Qna=qb.Qna});break;case 2:this.Vca(ta.data.paragraphNode,Jb=>{Jb.role=2})}};this.mjd=b;this.nYb=k;this.uye=t;this.Vp=D;this.OXa=P;this.mu=new bc.a;this.ra=
new Ue.a;this.pld=this.ctd=this.Ukd=0}get JCm(){return this.pld}Cwk(b){this.ra.addHandler(Vn.UTi,b)}fxk(b){this.ra.addHandler(Vn.fWi,b)}fqh(b){this.ra.addHandler(Vn.AVf,b)}r_n(b){this.ra.removeHandler(Vn.AVf,b)}get inconsistenciesCount(){return this.Ukd}pnj(b){this.Ukd!==b&&(this.Ukd=b,this.ra.raiseEvent(Vn.UTi,new dq.a(this.Ukd)))}get jNb(){return this.ctd}wnj(b){this.ctd!==b&&(this.ctd=b,this.ra.raiseEvent(Vn.fWi,new dq.a(this.ctd)))}get Nxf(){return this.XXg}TUc(b){return this.mu.nb(b.id)}W0l(b){var k,
t;return null===(t=null===(k=this.XLf)||void 0===k?void 0:k.Dc(b))||void 0===t?void 0:t.value}Sci(b,k){var t,D,P;const ca=new Map;for(const ta of k)if(k=ta){const Na=null!==(P=null===(D=null===(t=this.mu.Dc(k.id))||void 0===t?void 0:t.value)||void 0===D?void 0:D.role)&&void 0!==P?P:1;b.has(Na)&&(ca.has(Na)?ca.get(Na).add(k):ca.set(Na,new Eb.a([k])))}return ca}pA(b){if(!b)return v.ULS.shipAssertTag(575813855,3016,!1),null;let k;return({value:k}=this.mu.Dc(b.id)).returnValue?k:Object.assign(new hl,
{role:1,Ibc:!1})}O2n(){this.WWd=new Date;return new Ho(this)}register(){this.mjd.register();this.nYb.register();this.uye.register()}unregister(){this.mjd.unregister();this.nYb.unregister();this.uye.unregister()}initialize(){if(!this.Ah){const b=this.Vp.Ze(12);b.Kw(this.fjm);b.Ot(this.ejm);b.Fo(this.gjm);this.mjd.UF(this.EGl);this.nYb.UF(this.f7n);this.uye.UF(this.hpl);this.OXa.ywk(this.umn);this.OXa.wwk(this.rmn);this.OXa.xwk(this.tmn);this.OXa.zwk(this.vmn);this.OXa.kqh(this.fWf);this.OXa.Zwk(this.Fqn);
this.Ah=!0}}Md(){}S6c(b,k,t,D=!1,P=0,ca=0,ta){let Na=0,qb=!1;this.Vca(b,Jb=>{const Vb=Jb.UZd||!Jb.role||1==Jb.role;t||(Jb.h4d=k);if(D||Vb)qb=Jb.role!==k,Na=Jb.role,Jb.role=k,Jb.Ibc=t,Jb.UZd=!1,Jb.lYc=P,Jb.p3d=ca,Jb.listItemPrefix=ta,Jb.tbf=new Date});if(qb){const Jb=k-4;Jb>this.Nxf&&8>Jb&&(this.XXg=Jb);1===k&&this.Vca(b,Vb=>{Vb.zOa=null});this.ra.raiseEvent(Vn.AVf,new dq.a(new hs(b,k,Na)))}}Vca(b,k){let t;if(({value:t}=this.mu.Dc(b.id)).returnValue){b=t.M2a;const D=t.hha;k(t);if(27!==t.role&&28!==
t.role){if(t.removed)return t;b!==t.M2a&&this.pnj(this.inconsistenciesCount+(b?1:-1));D!==t.hha&&this.wnj(this.jNb+(D?-1:1))}}else k(t=new hl),t.SSm()&&this.mu.add(b.id,t);return t}Vcg(b,k){({value:k}=this.mu.Dc(k.id));return 28===(null===k||void 0===k?void 0:k.role)?!(null===k||void 0===k?0:k.placeholder)&&b===sf.a.mo:!(null===k||void 0===k?0:k.placeholder)&&(b===sf.a.mo||b===sf.a.Gn||Array.contains(Un.AParagraphNode.Nga(),b))}}Vn.UTi="OnInconsistenciesChanged";Vn.fWi="OnRoleReviewCount";Vn.AVf=
"OnRoleChanged";Object(n.a)(Vn,"RoleLifecycleManager",null,[347,348,349]);class Xs{constructor(b,k,t,D,P){this.OXa=b;this.nYb=k;this.Te=t;this.Vp=D;this.dQ=P;this.Ah=!1;this.fWf=(ca,ta)=>{(ca=ta.data.paragraphNode)?this.pEj(ca,()=>!0,Na=>Na.userSetRole=qq.d(ta.data.IQf)):v.ULS.shipAssertTag(557057378,3016,!1)};this.ypn=(ca,ta)=>{0<this.dQ.JCm||this.Vcg(ta.property)&&this.pEj(ta.node,Na=>!(Na&&Na.isInvalidated),Na=>Na.isInvalidated=!0)}}initialize(){this.Ah||(this.OXa.kqh(this.fWf),this.Vp.Ze(12).Fo(this.ypn),
this.Ah=!0)}Md(){}pEj(b,k,t){if(b=(b=this.nYb.z3h(b))&&1===b.length&&b[0]){var D=b.content;D=D&&D.M_&&D.M_.customMetadata;k(D)&&(k=new zp.RoleDetectionCustomMetadata,k.isInvalidated=D&&D.isInvalidated,k.userSetRole=D&&D.userSetRole,t(k),this.Te.OQo(b,k))}}Vcg(b){return b===sf.a.mo||b===sf.a.Gn||Array.contains(Un.AParagraphNode.Nga(),b)}}Object(n.a)(Xs,"RoleDetectionMetadataUpdater",null,[346]);class Q{constructor(b,k){this.Rje=b;this.aCb=k;this.m_c=(t,D)=>{t=D.data;if(t.zt==Ws.a.getTypeName()||t.zt==
Ws.n.getTypeName())if(t=t.annotation&&t.annotation.content)this.runId=t.runId};this.revisionId=0}initialize(){this.aCb.UF(this.m_c)}Md(){this.aCb.UH(this.m_c)}ajn(){if(void 0===this.runId)Promise.resolve();else{var b=new zp.RoleDetectionSettings({acceptedRunId:this.runId});b=new Ws.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.Rje.submitOperation(b)}}}Object(n.a)(Q,"RoleDetectionSettingsUpdater",null,[]);class za{constructor(b,
k,t){this.zBm=b;this.IW=k;this.fe=t;this.Pri=this.initialized=!1;this.TRi=()=>{this.epj()&&(this.oqi(),this.IW.VZn(this.TRi))}}initialize(){this.initialized||(this.Nzf(),this.initialized=!0)}Md(){}Nzf(){this.epj()?this.oqi():this.IW.Wvk(this.TRi)}epj(){return!this.Pri&&(this.fe.nvi()||this.IW.x$b(zp.DocumentRoleDetectionAnnotation.getTypeName())||this.IW.x$b(zp.RoleDetectionAnnotation.getTypeName()))}oqi(){for(const b of this.zBm)b.initialize();this.Pri=!0}}Object(n.a)(za,"RLMInitializer",null,[]);
class fb{constructor(b,k,t){this.WY=b;this.Mt=k;this.fed=t;this.W=null;this.aja=()=>{this.QSc();this.Mt.unb(this.aja)};if(!b)throw jr.a.argument("AppLifecycleManager is null");if(!k)throw jr.a.argument("Workspace is null");if(!t)throw jr.a.argument("ApplicationInstance is null");}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>this.fn())}xc(b){this.W=b;b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",
()=>new Q(this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").XI)).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",()=>new Xs(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").qee,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();
b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",()=>new Vn(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").z0a,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").qee,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").XI,b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).singleInstance();
b.ha("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new za([this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance()}dispose(){}fn(){this.fed.oJ?this.WY.Dk(16,()=>this.cSc()):this.cSc()}cSc(){this.Mt.swa?this.QSc():this.Mt.Xea(this.aja)}QSc(){this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();
this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}Object(n.a)(fb,"PackageManager",null,[1,2]);class Nb{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,k){const t=new Nb;t.ContractVersion=b;t.FileName=k;t.Paragraphs=[];return t}}Object(n.a)(Nb,"DocumentSwayPreviewContent",null,[]);class tc{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static X4k(b,k,t,D){const P=
new tc;P.RawText=b;P.ParagraphFormatting=k;P.TextRuns=t;P.IsRTL=D;P.ParagraphIndex=0;return P}}Object(n.a)(tc,"ParagraphContent",null,[]);var bd=c(93),Yd=c(1190);class Fd{constructor(){this.Name=null;this.Size=0}static construct(b,k){const t=new Fd;t.Name=b;t.Size=k;return t}}Object(n.a)(Fd,"FontData",null,[]);class De{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,k,t,D,P,ca){const ta=new De;ta.IsBold=b;ta.IsUnderline=
k;ta.IsUppercase=t;ta.Font=D;ta.Alignment=P;ta.LeftIndent=ca;return ta}}Object(n.a)(De,"TextFormatting",null,[]);class Nf{constructor(){this.RunFormatting=this.RawText=null}static construct(b,k){const t=new Nf;t.RawText=b;t.RunFormatting=k;return t}}Object(n.a)(Nf,"TextRunContent",null,[]);var Je=c(101),va=c(40);class Oa{constructor(b,k){this.hTb=null;this.B9j=b;this.xN=k||""}get Xwn(){return this.B9j.value}Ixl(){var b=Date.now();const k=Nb.construct(2,this.xN);k.Paragraphs=this.xKl();b=Date.now()-
b;const t={};t.ExtractionDurationInMs=b.toString();v.ULS.sendTraceTag(25268374,382,50,"{0}",t);return k}xKl(){const b=new Eb.a;var k=0;let t=0,D=!1;var P=new ze.GraphIterator;P.set(this.Xwn);P=wc.a.Vo(P.currentNode);const ca=new bc.a(0);for(;P.moveNext()&&2100>t&&25>k;){var ta=P.currentNode;if(pe.ParagraphReader.Wb(ta)&&!pe.ParagraphReader.z8(ta)){!D&&pe.ParagraphReader.aY(ta)&&(D=!0);let Na=Un.AParagraphNode.OU(ta.characterData);Na=Na.trim();if(0<Na.length){const qb=this.yX(ta);qb.ParagraphIndex=
k;k++;t+=Na.length;b.add(qb);this.dUo(ca,pe.ParagraphReader.language(ta))}}}this.hTb=this.mRl(ca);k={};k.documentHasList=D;v.ULS.sendTraceTag(25776736,382,50,"{0}",k);return b.toArray()}mRl(b){let k=-1,t=1033;for(const D of b.keys.toArray())D&&b.J(D)>k&&(k=b.J(D),t=D);return Xj.a.og(t)}dUo(b,k){b.nb(k)?b.Z(k,b.J(k)+1):b.Z(k,1)}yX(b){const k=Un.AParagraphNode.OU(b.characterData),t=this.y5l(b),D=this.cem(b);b=this.HNm(b);return tc.X4k(k,t,D,b)}y5l(b){const k=pe.ParagraphReader.Rn(b,sf.a.bold,!1),t=
pe.ParagraphReader.Rn(b,sf.a.underline,!1);var D=pe.ParagraphReader.Rn(b,sf.a.fontSize,bd.a.lM);const P=pe.ParagraphReader.Rn(b,sf.a.font,bd.a.kG);var ca=pe.ParagraphReader.Cx(b);ca=this.Nmf(ca);const ta=!!pe.ParagraphReader.Rn(b,zi.a.capitalization,0);b=(new Yd.a).ZT(b).value/20;D=Fd.construct(P,D);return De.construct(k,t,ta,D,ca,b)}cem(b){const k=new Eb.a;for(let P=0;P<b.pa.length-1;P++){var t=b.pa.J(P),D=b.pa.J(P+1);t.formatting&&(D=Un.AParagraphNode.OU(b.characterData.substr(t.cp,D.cp-t.cp)),
t=this.dem(t.formatting),t=Nf.construct(D,t),k.add(t))}return k.toArray()}dem(b){const k=Je.FormattingReader.qPc(b,sf.a.bold,!1),t=Je.FormattingReader.qPc(b,sf.a.underline,!1);var D=Je.FormattingReader.qPc(b,sf.a.fontSize,bd.a.lM);const P=Je.FormattingReader.qPc(b,sf.a.font,bd.a.kG);D=Fd.construct(P,D);b=!!Je.FormattingReader.qPc(b,zi.a.capitalization,0);return De.construct(k,t,b,D,5,0)}Nmf(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}HNm(b){const k=
new ze.GraphIterator;k.set(b);k.zb(11);return(b=k.hd(11))?va.OutlineElementReader.$m(b):!1}}Object(n.a)(Oa,"DocumentContentExtractor",null,[272]);class Ba{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}xc(b){b.ha("WordEditor.DocumentContentExtractor.DocumentContentExtractor",()=>new Oa(new Rg.a(()=>Yl.App.Ln.gb.wc.ed),w.AFrameworkApplication.ps.Zy)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").singleInstance()}static main(){N.a.instance.Fc(new Ba)}}Object(n.a)(Ba,
"DocumentContentExtractorPackage",null,[1,2]);class wa{}wa.Xg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(n.a)(wa,"EmbedDialogHtml",null,[]);class Ua{constructor(b,k,t,D){this.$ec=b;this.Z1a=k;this.D8d=t;this.value=D}}Object(n.a)(Ua,"OptionInfo",null,[]);class zb{constructor(b,k,t){this.v9f=b;this.G9b=k;this.Z1a=t}}Object(n.a)(zb,"SectionInfo",null,[]);var Qb=c(273);
class Xb extends Wf.a{constructor(b,k=!1){super(!1,!1,k);this.Shd=476;this.mUb=288;this.Mxe=798;this.Aek=476;this.zek=288;this.T0c={};this.Rnb=[];this.LV=this.nXa=this.Nvb=this.xsb=this.dqd=this.KXb=null;this.csc=w.AFrameworkApplication.eRc;this.pwb=b;this.XLe=Object(A.a)(this,this.svn,"optionClickHandler");this.Yxc=Object(A.a)(this,this.tvn,"optionKeyHandler");this.Pse=Object(A.a)(this,this.dGk,"arrowClickHandler");this.mSb=Object(A.a)(this,this.eGk,"arrowKeyHandler");this.$vd=Object(A.a)(this,this.kGo,
"textAreaOnFocusHandler");this.b8j=k;this.Xg=wa.Xg;this.Ad=0;this.vg="EmbedDialog"}get Es(){return this.mUb}set Es(b){this.mUb=b}Arj(b){const k={["id"]:this.vg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:ia.a.hp(this.pwb,"wdPreview","1"),["initialEmbedUrl"]:this.csc,["getEmbedCode"]:Xb.E7h,
["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const t of Object.keys(b))k[t]=b[t];this.Ad=1;this.Ee(1,CommonUIStrings.l_CopyAction);this.Ee(0,CommonUIStrings.l_Close);this.Wh(CommonUIStrings.l_Embed,null,k)}zjc(){if(this.b8j)this.Arj({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.KXb=document.getElementById("embedpreviewpane");this.dqd=document.getElementById("embedoptionpane");this.KXb.style.width=String.format("{0}px",this.Aek);this.nXa=document.createElement("iframe");
this.nXa.className=Xb.yek;this.nXa.frameBorder="0";this.nXa.style.height=String.format("{0}px",this.zek);this.nXa.tabIndex=-1;this.KXb.appendChild(this.VGd(CommonUIStrings.l_Preview,this.nXa,Xb.Mah,Xb.Lah,Xb.Mah,!0));this.LV=document.createElement("textarea");this.LV.className=Xb.O0j;Sys.UI.DomElement.addCssClass(this.LV,Qb.a.h0e);this.LV.id=Xb.eTg;aa.a.ti||(this.LV.readOnly=!0);this.LV.rows=4;this.LV.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.LV.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;
this.LV.setAttribute(df.a.efa,String.format("{0} {1}",Xb.dTg,Xb.cTg));this.KXb.appendChild(this.VGd(CommonUIStrings.l_EmbedCode,this.LV,Xb.dTg));vf.a.addHandler(this.LV,"focus",this.$vd);var b=document.createElement("span");b.className=Xb.y2j;b.innerText=CommonUIStrings.l_CopyText;b.id=Xb.cTg;this.KXb.appendChild(b);this.xsb=document.createElement("div");this.xsb.className=Xb.V_j;this.dqd.appendChild(this.VGd(CommonUIStrings.l_Dimensions,this.xsb));this.Nvb=document.createElement("div");this.dqd.appendChild(this.f8k(Xb.C9g,
this.Nvb));this.Ad=0;this.Ee(1,CommonUIStrings.l_Close);this.Ulg();this.gGj();aa.a.ti||this.LV.focus()}}dispose(){if(this.T0c){var b=this.T0c;for(let k in b){const t=b[k];this.Jq.rc(Rc.a.click,t.$ec,this.XLe);this.ae.rc(Rc.a.hi,t.$ec,this.Yxc);this.ae.rc(Rc.a.vh,t.$ec,this.Yxc)}this.Yxc=this.XLe=this.T0c=null}if(this.Rnb){for(b=0;b<this.Rnb.length;++b)this.Jq.rc(Rc.a.click,this.Rnb[b].G9b,this.Pse),this.ae.rc(Rc.a.hi,this.Rnb[b].G9b,this.mSb),this.ae.rc(Rc.a.Zt,this.Rnb[b].G9b,this.mSb),this.ae.rc(Rc.a.vh,
this.Rnb[b].G9b,this.mSb);this.ae=this.Pse=this.Rnb=null}this.$vd&&this.LV&&(vf.a.removeHandler(this.LV,"focus",this.$vd),this.$vd=null);this.LV=this.nXa=this.Nvb=this.xsb=this.dqd=this.KXb=null;super.dispose()}Fca(){super.Fca();this.Jc.style.width=String.format("{0}px",this.Mxe);this.GCa()}FSo(b,k){const t=ia.a.hp(this.csc,b,k);return this.csc!==t?(this.csc=t,this.pwb=ia.a.hp(this.pwb,b,k),!0):!1}Ulg(){this.LV&&(this.LV.innerText=Xb.E7h(this.csc,this.Shd,this.mUb))}gGj(){this.nXa&&this.nXa.contentWindow.location.replace(ia.a.hp(this.pwb,
"wdPreview","1"))}one(b,k){this.FSo(b,k)&&(this.Ulg(),this.gGj())}VGd(b,k,t=null,D=null,P=null,ca=!1){const ta=document.createElement("div");ta.className=Xb.ghk;D&&(ta.id=D);P&&ta.setAttribute(df.a.efa,P);ca&&(ta.tabIndex=0);D=document.createElement("span");D.className=Xb.hhk;D.innerText=b;t&&(D.id=t);ta.appendChild(D);ta.appendChild(k);return ta}f8k(b,k){const t=this.VGd(CommonUIStrings.l_Interaction,k),D=this.ej.createElement("div");D.className=Xb.BVj;D.id=Xb.xLg+b;D.setAttribute(df.a.qh,df.a.e3);
D.tabIndex=0;t.insertBefore(D,k);b=od.createClusteredImage(16,16,Xb.CVj,Xb.DVj,!0,"");D.appendChild(b);b=b.childNodes[0];b.className=od.getImageClass(Xb.vSg);b.title=CommonUIStrings.l_Expand;D.title=CommonUIStrings.l_Expand;k.style.visibility="hidden";k=new zb(k,D,b);Array.add(this.Rnb,k);this.Jq.dE(Rc.a.click,D,this.Pse,k);this.ae.dE(Rc.a.hi,D,this.mSb,k);this.ae.dE(Rc.a.Zt,D,this.mSb,k);this.ae.dE(Rc.a.vh,D,this.mSb,k);return t}dGk(b){this.GBh(b);return!0}eGk(b){return this.yWc(b,Object(A.a)(this,
this.GBh,"changeArrowState"))}GBh(b){b=b.Oo;"visible"===b.v9f.style.visibility?(b.v9f.style.visibility="hidden",b.Z1a.className=od.getImageClass(Xb.vSg),b.Z1a.title=CommonUIStrings.l_Expand,b.G9b.title=CommonUIStrings.l_Expand):(b.v9f.style.visibility="visible",b.Z1a.className=od.getImageClass(Xb.umk),b.Z1a.title=CommonUIStrings.l_Collapse,b.G9b.title=CommonUIStrings.l_Collapse)}gKh(b,k){const t=document.createElement("div");t.className=Xb.z9g;t.id=b+Xb.A9g;var D=this.ej.createElement("div");D.tabIndex=
0;D.className=Xb.RNg;D.id=b+Xb.Epc;D.setAttribute(df.a.qh,df.a.M1e);D.setAttribute(df.a.rCa,df.a.jp);D.setAttribute(df.a.efa,b+Xb.KTb);t.appendChild(D);t.setAttribute(df.a.qh,df.a.Yy);var P=od.createClusteredImage(16,16,Xb.XNg,Xb.WNg,!0,"");D.appendChild(P);P=P.childNodes[0];P.id=b+Xb.B9g;P.className=od.getImageClass(Xb.Lue);D=new Ua(t,P,D,1);this.T0c[b]=D;this.Jq.dE(Rc.a.click,t,this.XLe,b);D=document.createElement("span");D.className=Xb.KTb;D.innerText=k;D.id=b+Xb.KTb;t.appendChild(D);this.ae.dE(Rc.a.hi,
t,this.Yxc,b);this.ae.dE(Rc.a.vh,t,this.Yxc,b);return t}svn(b){this.mYi(b);return!0}tvn(b){return this.yWc(b,Object(A.a)(this,this.mYi,"optionHandler"))}mYi(b){const k=this.T0c[b.Oo.toString()];k.value?(k.value=0,k.Z1a.className=od.getImageClass(Xb.HVe),k.D8d.setAttribute(df.a.rCa,df.a.dM)):(k.value=1,k.Z1a.className=od.getImageClass(Xb.Lue),k.D8d.setAttribute(df.a.rCa,df.a.jp));this.one(b.Oo.toString(),k.value.toString())}kGo(){this.LV.select()}static E7h(b,k,t){if(!Xb.CKe){const D=String.format('<a target="_blank" href="{0}">{1}</a>',
F.a.y9b("https://office.com"),CommonUIStrings.l_Office),P=String.format('<a target="_blank" href="{0}">{1}</a>',F.a.y9b("https://office.com/webapps"),CommonUIStrings.l_WebAppName);Xb.CKe=String.format(CommonUIStrings.l_NoFrames,D,P)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',F.a.y9b(b),k,t,Xb.CKe)}}Xb.CKe=null;Xb.Lue="CheckboxChecked_16x16x32";Xb.HVe="CheckboxUnchecked_16x16x32";Xb.umk="OutlookSearchChevronUp_16x16x32";Xb.vSg="OutlookSearchChevronDown_16x16x32";
Xb.XNg="CommentChecked";Xb.CVj="UpArrowServer";Xb.KTb="EmbedDescription";Xb.ghk="EmbedSectionHeader";Xb.hhk="EmbedSectionName UIFontBold";Xb.y2j="EmbedCodeFooter";Xb.WNg="EmbedOptionImage";Xb.yek="EmbedPreviewFrame";Xb.O0j="EmbedCodeTextArea";Xb.z9g="EmbedOption";Xb.V_j="EmbedDimensionSection";Xb.DVj="EmbedArrowIcon";Xb.BVj="WACGlyph EmbedArrowHolder";Xb.RNg="EmbedCheckBoxHolder";Xb.A9g="Option";Xb.B9g="OptionImage";Xb.eTg="EmbedCode";Xb.dTg="EmbedCodeHeader";Xb.Mah="Preview";Xb.Lah="PreviewHeader";
Xb.C9g="Options";Xb.xLg="Arrow";Xb.Epc="Check";Xb.cTg="EmbedCodeFooter";Object(n.a)(Xb,"EmbedDialog",Wf.a,[]);class Dc extends Ua{constructor(b,k,t,D,P){super(b,k,t,D);this.g2a=P}}Object(n.a)(Dc,"OptionInputInfo",Ua,[]);class Fc extends Xb{constructor(b,k){super(b,Fc.vL);this.jaa=null;this.wrc=[];this.Tud=Object(A.a)(this,this.eAo,"startOnOptionClickHandler");this.nZb=Object(A.a)(this,this.fAo,"startOnOptionKeyHandler");this.wqd=Object(A.a)(this,this.opn,"onPageNumberChanged");this.Yxe=Object(A.a)(this,
this.yln,"onDimensionChanged");this.cH=k}zjc(){if(Fc.vL){var b=Fc.CNn,k=[];k.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.cH.q2i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.cH.p7i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.cH.cuj,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.cH.duj}});this.Arj({["dimensionsOptions"]:{["isMultipleChoice"]:!1,
["defaultWidth"]:this.Shd,["defaultHeight"]:this.mUb,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.cH.HJj,["heightLabel"]:this.cH.Smi},["interactionOptions"]:k})}else super.zjc(),this.qnh(this.cH.HJj,"EmbedWidthInput",this.Shd),this.qnh(this.cH.Smi,"EmbedHeightInput",this.mUb),this.Nvb.appendChild(this.gKh("wdPrint",this.cH.q2i)),this.Nvb.appendChild(this.gKh("wdEmbedCode",this.cH.p7i)),this.cqk(this.cH.cuj),this.GCa(),ad.FocusManager.SJ()&&(b=ad.FocusManager.instance(),k=[document.getElementById(Xb.eTg),
document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(Xb.xLg+Xb.C9g),document.getElementById("wdPrint"+Xb.Epc),document.getElementById("wdEmbedCode"+Xb.Epc),document.getElementById("wdStartOn"+Xb.Epc),document.getElementById("wdStartOnText"),document.getElementById(ll.a.wdd),document.getElementById(Xb.Lah)],k=new ce(k),b.Ps().Zj=k,aa.a.ti?this.R0(document.getElementById(ll.a.wdd)):this.LV.select())}dispose(){if(!Fc.vL){if(this.wrc){for(let b=
0;b<this.wrc.length;++b)vf.a.removeHandler(this.wrc[b],"change",this.Yxe);this.wrc=this.Yxe=null}this.wqd&&(vf.a.removeHandler(this.jaa.g2a,"change",this.wqd),this.wqd=null);this.Tud&&(this.Jq.rc(Rc.a.click,this.jaa.$ec,this.Tud),this.Tud=null);this.nZb&&(this.ae.rc(Rc.a.hi,this.jaa.$ec,this.nZb),this.ae.rc(Rc.a.vh,this.jaa.$ec,this.nZb),this.nZb=null);this.jaa=null}super.dispose()}qnh(b,k,t){const D=document.createElement("label");D.className="EmbedInputPrefix";D.innerText=b;this.xsb.appendChild(D);
b=document.createElement("input");b.className=k;b.id=k;b.value=t.toString();b.type="text";b.setAttribute("data-lpignore","true");D.setAttribute("for",k);this.xsb.appendChild(b);this.wrc.push(b);vf.a.addHandler(b,"change",this.Yxe);this.xsb.appendChild(document.createElement("br"))}yln(b){"EmbedWidthInput"===b.target.id?this.Shd=this.lKd(b.target,375):this.mUb=this.lKd(b.target,250);this.Ulg()}lKd(b,k){let t=parseInt(b.value);if(isNaN(t)||t<k)t=k;b.value=t.toString();return t}opn(b){b=this.lKd(b.target,
1);1===this.jaa.value&&this.one("wdStartOn",b.toString())}cqk(b){const k=document.createElement("div");k.className=Xb.z9g+" EmbedInlineOption";k.id="wdStartOn"+Xb.A9g;const t=this.ej.createElement("div");t.tabIndex=0;t.className=Xb.RNg;t.id="wdStartOn"+Xb.Epc;t.setAttribute(df.a.qh,df.a.M1e);t.setAttribute(df.a.rCa,df.a.dM);t.setAttribute(df.a.efa,"wdStartOn"+Xb.KTb);k.appendChild(t);k.setAttribute(df.a.qh,df.a.Yy);var D=od.createClusteredImage(16,16,Xb.XNg,Xb.WNg,!0,"");t.appendChild(D);D=D.childNodes[0];
D.id="wdStartOn"+Xb.B9g;D.className=od.getImageClass(Xb.HVe);const P=document.createElement("span");P.className=Xb.KTb;P.innerText=b;P.id="wdStartOn"+Xb.KTb;k.appendChild(P);this.Nvb.appendChild(k);b=document.createElement("input");b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.cH.duj;b.setAttribute("data-lpignore","true");this.Nvb.appendChild(b);vf.a.addHandler(b,"change",this.wqd);this.jaa=new Dc(k,D,t,0,b);this.one("wdStartOn","1");this.Jq.lb(Rc.a.click,k,this.Tud);
this.ae.lb(Rc.a.hi,k,this.nZb);this.ae.lb(Rc.a.vh,k,this.nZb)}eAo(b){this.auj(b);return!0}fAo(b){return this.yWc(b,Object(A.a)(this,this.auj,"startOnOptionHandler"))}auj(){let b=1;this.jaa.value?(this.jaa.value=0,this.jaa.Z1a.className=od.getImageClass(Xb.HVe),this.jaa.D8d.setAttribute(df.a.rCa,df.a.dM)):(this.jaa.value=1,this.jaa.Z1a.className=od.getImageClass(Xb.Lue),b=this.lKd(this.jaa.g2a,1),this.jaa.D8d.setAttribute(df.a.rCa,df.a.jp));this.one("wdStartOn",b.toString())}static get vL(){return w.AFrameworkApplication.ta.Nb.nF}static CNn(b,
k,t,D=null){if("wdPrint"===k||"wdEmbedCode"===k)return ia.a.hp(b,k,t?"1":"0");if("wdStartOn"===k){let P="1";t&&D&&(D=parseInt(D),!isNaN(D)&&1<=D&&(P=D.toString()));return ia.a.hp(b,k,t?P:"1")}return b}}Object(n.a)(Fc,"WordEmbedDialog",Xb,[]);class Zc{constructor(b,k,t,D,P){this.bea=null;this.ga=b;this.bab=k;this.GP=t;this.cH=D;this.ora=P}Tb(){this.ga.qa(this.GP,Ud.a.frame,Object(A.a)(this,this.Hto,"showEmbedCode"));this.bab.execute(Object(A.a)(this,this.YTf,"onHostPostmessengerCreated"))}YTf(b){v.ULS.shipAssertTag(4994850,
332,!!b);this.bea=b;w.AFrameworkApplication.bha||(this.bea.yv(K.a.rAh),this.bea.NB(K.a.rAh,Object(A.a)(this,this.zjc,"showEmbedDialog")))}zjc(b){b=b.Values.HostEmbeddedViewUrl.toString();w.AFrameworkApplication.eRc=b;this.ora.Ogf=b;(new Fc(b,this.cH)).zjc()}Hto(b,k,t){if(2===t)if(w.AFrameworkApplication.eRc)(new Fc(this.ora.Ogf,this.cH)).zjc();else return w.AFrameworkApplication.Qm.b2a(Zc.XMj),w.AFrameworkApplication.png&&this.bea.sendMessage(K.a.xzl,null)?32:w.AFrameworkApplication.ta.CU(!0,w.AFrameworkApplication.sjf);
return 32}}Zc.XMj=10381;Object(n.a)(Zc,"EmbedActor",null,[]);class kd{}Object(n.a)(kd,"WordEmbedDialogStrings",null,[]);var rd=c(219);class Cd extends Zc{constructor(b,k){super(b,k,Nc.a.Ydg,Object.assign(new kd,{HJj:WordEditorIntl.WordEditorStrings.l_Width,Smi:WordEditorIntl.WordEditorStrings.l_Height,q2i:WordEditorIntl.WordEditorStrings.l_PrintOption,p7i:WordEditorIntl.WordEditorStrings.l_ReembedOption,cuj:WordEditorIntl.WordEditorStrings.l_StartOnOption,duj:WordEditorIntl.WordEditorStrings.l_StartPage}),
rd.WoncaApp.instance)}}Object(n.a)(Cd,"EmbedActor",Zc,[]);class we{constructor(){this.W=null}get name(){return"WordEditor.Embed"}xc(b){this.W=b;b.ha("WordEditor.Embed.EmbedActor",()=>new Cd(w.AFrameworkApplication.va,b.Sa("Postmessage.IHostPostmessenger"))).singleInstance()}init(){this.W.resolve("WordEditor.Embed.EmbedActor").Tb()}dispose(){}}Object(n.a)(we,"EmbedPackage",null,[1,2]);class se{constructor(b,k,t){this.Tv=this.eKa=this.qMa=null;this.TJa=0;this.VVb=this.PVb=this.BVb=this.dWb=this.VVa=
this.UVa=!1;this.Oj=b;this.Vm=t}XO(b){return Wa.App.ya.gb.isEditingAllowed?""!==this.dOc(b.zf):!1}hL(b){if(!this.XO(b))return!1;this.Veo(b);this.Weo();this.Xeo();this.qMa=b.WH;this.Tv=new Sys.UI.Point(0,0);v.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}DU(b){this.eKa=b.WH;this.rPk();this.Oj.aFj(this.Tv.x,this.Tv.y,this.dWb,this.BVb,this.PVb,this.VVb,!1);return!0}ZD(){this.Oj.aFj(this.Tv.x,this.Tv.y,this.dWb,this.BVb,this.PVb,this.VVb,!0);v.ULS.sendTraceTag(22381024,322,50,
"Image Crop drag succeeded")}qY(){this.Oj.kSk();v.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}Weo(){this.VVb=this.PVb=this.BVb=this.dWb=!1;switch(this.TJa){case 1:this.dWb=!0;break;case 5:this.BVb=!0;break;case 3:this.VVb=!0;break;case 7:this.PVb=!0;break;case 0:this.PVb=this.dWb=!0;break;case 2:this.VVb=this.dWb=!0;break;case 6:this.PVb=this.BVb=!0;break;case 4:this.VVb=this.BVb=!0}}Xeo(){this.VVa=this.UVa=!1;switch(this.TJa){case 0:this.VVa=this.UVa=!0;break;case 1:case 2:this.VVa=
!0;break;case 7:case 6:this.UVa=!0}}dOc(b){var k=b.className;-1===k.indexOf("WACImageCropHandle")&&b.parentNode&&(k=b.parentNode.className);b=k.split(" ");for(k=0;k<b.length;k++){const t=b[k].toString();if(t.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==t)return t}return""}Veo(b){switch(this.dOc(b.zf)){case "WACImageCropHandleNW":this.TJa=0;break;case "WACImageCropHandleN":this.TJa=1;break;case "WACImageCropHandleNE":this.TJa=2;break;case "WACImageCropHandleE":this.TJa=3;break;case "WACImageCropHandleSE":this.TJa=
4;break;case "WACImageCropHandleS":this.TJa=5;break;case "WACImageCropHandleSW":this.TJa=6;break;case "WACImageCropHandleW":this.TJa=7}}rPk(){var b=1;this.Vm.instance&&(b=this.Vm.instance.ij);const k=(this.eKa.x-this.qMa.x)/b;b=(this.eKa.y-this.qMa.y)/b;this.Tv.x=this.UVa?-k:k;this.Tv.y=this.VVa?-b:b}}Object(n.a)(se,"ImageCropDragAdapter",null,[143]);class Dd{constructor(b,k){this.ga=b;this.Vm=k}lYl(b){return new se(b,this.ga,this.Vm)}}Object(n.a)(Dd,"ImageCropDragAdapterFactory",null,[273]);var le=
c(296),Ne=c(238),qe=c(41),Pf=c(437),Lf=c(693),Pe=c(84),He=c(60),ci=c(400),Ke=c(972),ck=c(510),Fj=c(895),Yg=c(134),vj=c(359),Pk=c(246),wk=c(858),vi=c(204),Xh=c(81),mh=c(21),om=c(280),ys=c(768),uo=c(373),Vk=c(114);class Ol{constructor(b,k,t,D,P,ca,ta,Na,qb=null){this.Xb=qb;this.HSc=null;this.lK=b;this.nh=k;this.Hc=t;this.Is=D;this.Kd=P;this.ib=ca;this.Sm=ta;this.zE=Na}get VW(){return null!=this.iwg?this.iwg:this.iwg=Fa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get sc(){return null!=
this.tJg?this.tJg:this.tJg=Fa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get lf(){return Yg.PageReader.instance}fho(b,k,t){const D=this.Hc.Mc(15);D.Cb(k.node);this.VSa(b,t);D.dispose()}eho(b,k,t){const D=this.Hc.Mc(15);D.Cb(k.node);this.SNb(b,t);D.dispose()}VSa(b,k){b.setValue(sf.a.imageAltText,k)}SNb(b,k){b.setValue(Cc.a.NX,k)}mho(b,k){b.setValue(sf.a.zib,k)}Akj(b,k){var t=Be.ImageReader.mk(b);Wa.App.instance&&Wa.App.instance.c4(t)?(t=b.ia(qe.a.F5d,null),k=ys.a.Ual(k,t),b.setValue(qe.a.F5d,
k)):b.setValue(Cc.a.OX,k)}iho(b,k,t,D,P){let ca=0;var ta=0;({width:ca,height:ta}=Be.ImageReader.yhb(b));ta-=(k+t)/1E5*ta;this.xHa(b,ca-(D+P)/1E5*ca);this.wHa(b,ta);this.Skj(b);b.setValue(Cc.a.DRc,k);b.setValue(Cc.a.ARc,t);b.setValue(Cc.a.BRc,D);b.setValue(Cc.a.CRc,P)}flo(b,k,t,D){const P=this.Hc.Mc(15);P.Cb(k.node);this.Xfe(b,t,D);P.dispose()}Xfe(b,k,t){this.xHa(b,k);this.wHa(b,t);this.Skj(b);b.removeProperty(vd.a.$9d);b.removeProperty(vd.a.Y9d)}xHa(b,k){b.setValue(sf.a.uha,k);b.setValue(vd.a.PEa,
-1)}wHa(b,k){b.setValue(sf.a.tha,k);b.setValue(vd.a.OEa,-1)}gE(b,k){b.setValue(Cc.a.$Qc,k);b.setValue(sf.a.Hh,k);b.setValue(sf.a.Zq,k)}Ulo(b,k){b.setValue(Cc.a.LPb,k)}$do(b,k){b.setValue(Cc.a.U2e,k)}Ylo(b){if(!Be.ImageReader.d4(b)&&b.al){var k=b.node;if(Be.ImageReader.t8(k)){const P=this.Hc.Mc(15);P.Cb(b.node);b=ze.GraphIterator.$a(k);b.zb(12);b=b.parentNode;var t=b.properties.Lf(Cc.a.iq),D=k.properties.getValue(Cc.a.runId);k.ia(Cc.a.Lc,Wh.a.aS);const ca=b.pa,ta=[Cc.a.$Qc,sf.a.Hh,sf.a.Zq,Cc.a.U2e,
Cc.a.LPb,Cc.a.$Ya];Wa.App.instance&&Wa.App.instance.c4(Be.ImageReader.mk(k))&&ta.push(qe.a.Xvf,qe.a.Wvf);k.Eg.apply(k,ta);t=this.Hof(D,t,ca);D=Of.a.Rc(b,t);this.Is.qIh(k,D);(k=this.zE.GK(b,t,t+1))&&this.ib.setSelection(k);this.VW.cqa(b,t,t+1);P.dispose()}}}I$f(b,k){if(b.properties.hasProperty(Cc.a.f7)){const t=b.properties.Lf(Cc.a.f7);t.push(k);b.properties.setValue(Cc.a.f7,Array.clone(t))}else b.properties.setValue(Cc.a.f7,[k])}ghe(b,k,t=0,D=!1){if(b.al){var P=this.Hc.Mc(15),ca=b.node;P.Cb(ca);if(Be.ImageReader.d4(b)){const Jb=
this.Xb&&this.Xb.isFeatureEnabled(46)?new Fj.a:new ck.a;Jb.Qw(Be.ImageReader.Ym(b));var ta=ca.pa,Na=this.nBl(b.cpBegin,ta);this.oFk(b.cpEnd,ta,Na)&&v.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");ta=ta.J(Na).blob;Na=ta.re;var qb=ca.properties.Lf(Cc.a.iq);qb=this.bNn(qb);Na=qb[Na];qb=ca.ia(Cc.a.Lc,Wh.a.aS);if(ta=Object(Ka.a)(Ke.ImageBlobObject,ta))ta.sOb=!1;this.Kd.replaceTextRange(b,"");ta&&(ta.sOb=!0);Jb.properties.setValue(Cc.a.runId,Na);Jb.properties.setValue(Cc.a.Lc,
qb);b=ze.GraphIterator.$a(ca);b.zb(12);b.Hf(Jb,6);this.I$f(b.currentNode,Jb.anchor.node.id);ca=Jb}t&&this.gE(ca.properties,t);this.$do(ca.properties,D);this.Ulo(ca.properties,k);this.VW.Aic(ca);(k=this.zE.uq(ca))&&this.ib.setSelection(k);P.dispose()}}c9f(b,k){if(!(0>=k)){var t=Re.a.Tl(k,0),D=Be.ImageReader.fF(b),P=Be.ImageReader.wG(b);D>t&&(P*=t/D,this.xHa(b,t),this.wHa(b,P),v.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",k))}}oFk(b,k,t){const D=
k.length;if(t>=D||!k.J(t).tf)return!1;const P=new Ij.a;for(;t<D;t++){const ca=k.J(t);if(ca.cp>b||!ca.tf)break;for(let ta=0;ta<ca.tf.length;ta++){if(P.contains(ca.tf.J(ta).Wj))return!0;P.add(ca.tf.J(ta).Wj)}}return!1}bNn(b){for(var k=0;k<b.length&&!b[k];)k++;if(k===b.length)for(var t=0;t<b.length;)b[t]=t+1,t++;else{var D=b[k];t=k-1;for(var P=D-1;0<=t;)b[t]=P,t--,P--;P=0;for(t=k+1;t<b.length;)(k=b[t])?k<D?(D=k+P,b[t]=D):D=k:(P+=2,D++,b[t]=D),t++}return b}ckf(b,k){let t=0;for(;t<k.length&&!(b<k[t]);)t++;
return t}Hof(b,k,t){let D=0;const P=this.ckf(b,k);let ca=0;if(P===k.length)ca=t.length-1;else for(;ca<t.length;){k=t.J(ca);if(k.formatting&&k.formatting.re===P)break;ca++}ca<t.length?D=t.J(ca).cp:v.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:ca,["RunId"]:b,["CharacterPropertiesArrayLength"]:t.length});return D}nBl(b,k){let t=0;for(;t<k.length&&k.J(t).cp!==b;)t++;t===k.length&&v.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",
{["Index"]:t,["CharacterPropertiesArrayLength"]:k.length});return t}Skj(b){b.setValue(sf.a.Ewa,!0)}J$d(b,k,t,D=!1){k&&t?(k=Math.max(k,Lf.a.BNi),t=Math.max(t,Lf.a.BNi)):t=k=Lf.a.TOh;b.setValue(sf.a.uha,Re.a.Tl(k,0));b.setValue(sf.a.tha,Re.a.Tl(t,1));b.setValue(sf.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(zi.a.O_,1);b.setValue(Cc.a.gha,D)}zWd(){return null}vSh(b,k,t){let D=null;k=({IJb:D}=this.wSh(b,k,t)).returnValue;D&&b.view.mb.setSelection(D);return k}wSh(b,k,t){var D=
null;if(!this.ofa(b))return{returnValue:null,IJb:D};var P=b.view;const ca=this.Hc.Mc(15,Pb.a.rGb);ca.Cb(P.ed);k||(k=new th.DictionaryPropertySet);k.setValue(vd.a.Upl,!0);let ta=P.mb.sg;var Na=new wk.a;if(!hf.SelectionEditor.gf(ta)){if(2===w.AFrameworkApplication.va.processAction(Pb.a.Bma,2))return ca.dispose(),{returnValue:null,IJb:D};ta=P.mb.sg}else if(ta.al&&pe.ParagraphReader.Wb(ta.node)){Wa.App.rd.Yo&&Wa.App.rd.kq.rH(ta.node);P=Je.FormattingReader.Kr(ta);if(!P)return ca.dispose(),{returnValue:null,
IJb:D};P.cache.BB&&(P=P.Ef(null),Ol.pp.S4(P));Na.formatting=P.Fj;Na.languageId=Je.FormattingReader.language(P);Na.Yqa=this.sc.Lo(ta.node)}if(!ta.al)return ca.dispose(),{returnValue:null,IJb:D};if(!this.wAf(b.$j,k))return ca.dispose(),this.HSc=null,{returnValue:null,IJb:D};b=this.HSc;this.HSc=null;1===b.location?(D=b.node,k=uo.a.instance.cvf(D),ag.OutlineElementNavigator.Ur(k,!1,!1)||(vi.OutlineNavigator.eee(k),this.lK.h7(k,!0,Na)),ag.OutlineElementNavigator.Ge(k),Ih.TableReader.isTable(k)&&(Object(ob.a)(Vk.a,
k)||Object(ob.a)(vj.a,k)?(Na=new ze.GraphIterator,Na.set(k.currentNode),mh.moveToCellContent(Na,0,0),k.set(Na.currentNode)):mh.moveToCellContent(k,0,0),va.OutlineElementReader.Bh(k)?ag.OutlineElementNavigator.Ge(k):k=uo.a.instance.cvf(D)),D=pe.ParagraphReader.Qt(k.currentNode)?this.zE.te(k.currentNode,0):this.zE.uq(k.currentNode)):b.location||(Na=b.blob.Ib.cp+1,D=this.zE.GK(b.node,Na-1,Na));ca.VFa(t,1);ca.fk=Pb.a.rGb;ca.dispose();return{returnValue:b,IJb:D}}wAf(){return!1}ofa(b){b.contextId===lc.a.view&&
b.view.qe&&b.view.mb&&(b=b.view.mb.sg);if(!b)return Ol.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.noSelection}),!1;if(Ol.Vf.i_(b))return Ol.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.VE}),!1;if(Ol.Vf.iha(b))return Ol.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.iri}),!1;if(this.Sm&&this.Sm.instance&&this.Sm.instance.qU(b))return Ol.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.externalSelection}),!1;if(this.lf.Y3)return Ol.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.compatMode}),!1;if(b.al)return Xh.OutlineReader.wZd(b)?(Ol.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.q9e}),
!1):Be.ImageReader.rYd(b)?(Ol.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.i9e}),!1):om.c(b)?(Ol.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.j9e}),!1):Pk.a.fDf(b)?(Ol.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.h9e}),!1):pe.ParagraphReader.mU(b)||Be.ImageReader.XDm(b)?(Ol.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.dO}),!1):!0;if(ci.a.vEf(b)){let k=!0;for(let t=0;t<b.length;++t){const D=b.getContext(t);if(!D.al)return!1;k&&!pe.ParagraphReader.mU(D)&&(k=!1)}return k?(Ol.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.dO}),!1):!0}return!1}i5f(b,k){const t=this.Hc.Mc(7);
t.Cb(b);if(12===b.type){k=k.Ib.cp;var D=pe.ParagraphReader.textLength(b);D=Of.a.jO(k,k+1,k+1===D?!0:!1,b);this.Kd.replaceTextRange(D,"");b=Of.a.Rc(b,k);this.ib.setSelection(Gf.SelectionFactory.ho(b))}else this.nh.ZGa(b);t.dispose()}static get pp(){return null!=Ol.Qzg?Ol.Qzg:Ol.Qzg=Fa.a.instance.resolve("Box4.IFormattingEditor")}static get Vf(){return Yj.a.instance}static get Ic(){return Hi.a.instance}}Object(n.a)(Ol,"ImageEditor",null,[271]);class hp{constructor(b,k,t,D=0){this.node=b;this.blob=k;
this.location=t;this.kU=D}}Object(n.a)(hp,"InsertPictureResult",null,[]);var Ys=c(815),Eq=c(281),qi=c(1175);class tm extends Ol{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc){super(b,k,t,D,P,ca,ta,Na,Kc);this.SZj="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");this.M9a="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");
this.ZJ=this.KKa=this.jAa=null;this.Vja=Array(8);this.Hkd=this.EAa=null;this.LKa=!1;this.Gkd=this.vDe=null;this.qgd=this.Ahd=!1;this.BS=this.AS=this.zS=this.CS=this.GV=this.FV=this.EV=this.HV=this.aW=this.bW=0;this.tY=()=>{this.LKa&&this.fhf()};this.nxa=ed=>{this.LKa&&ed.Gb.keyCode!==pc.a.zs&&this.fhf(!0);return!1};this.SYg=yc;ca.Lw(this.tY);this.ae=ac;this.b2=le.a.instance;this.ga=w.AFrameworkApplication.va;this.Ud=Jb;this.qq=qb;this.ld=Kc}nge(b,k,t,D,P){b.hasProperty(vd.a.MQa)&&b.removeProperty(vd.a.MQa);
const ca=Array(4);ca[0]=k;ca[1]=t;ca[2]=D;ca[3]=P;b.setValue(Cc.a.Cca,ca)}LXn(b){b.setValue(Cc.a.REa,0);b.setValue(Cc.a.cLb,"");this.nge(b,0,0,0,0)}Dag(b,k,t,D,P){b.setValue(Cc.a.DRc,k);b.setValue(Cc.a.ARc,t);b.setValue(Cc.a.BRc,D);b.setValue(Cc.a.CRc,P)}pge(b,k,t,D){b.setValue(Cc.a.jJ,k);b.setValue(Cc.a.yQc,t);b.setValue(Cc.a.KQc,D);b.setValue(vd.a.jJ,-1)}xWd(b,k){b=b.node;const t=ze.GraphIterator.$a(b);if(pe.ParagraphReader.Wb(b)&&pe.ParagraphReader.isEmpty(t)){var D=b.properties.Lf(Cc.a.Lc);k.setValue(Cc.a.Lc,
D);k.setValue(Cc.a.runId,1);D=new qi.a;k&&D.Qw(k);t.Hf(D,6);this.I$f(b,D.anchor.node.id);this.VW.Aic(D);return new hp(D,null,3)}return null}zWd(b,k){var t=Ys.a.instance.Mcd;k&&t.Qw(k);t.setValue(Cc.a.imageType,1);let D=0;D=Ne.a.vF();t.setValue(Cc.a.kU,D);const P=b.node.Kc.Ju(t,t.id);t=this.Kd.Uga(b,ca=>new Ke.ImageBlobObject(ca,P));Eq.GraphTransactionManager.instance.ETf(b.node);if(this.Ud.qg){const ca=new Xd.GraphTransaction(15);ca.Cb(b.node);this.qq.jqa(b.node,b.cpBegin,b.cpBegin+1,1,null);ca.dispose()}this.VW.hNa&&
!k.ia(Cc.a.gha,!1)&&this.VW.cqa(b.node,b.cpBegin,b.cpBegin+1);return new hp(b.node,t,0,D)}wAf(b,k){if(!this.ofa(b))return!1;const t=this.Hc.Mc(7);t.Cb(b.node);w.AFrameworkApplication.K.$("ContentAppIsEnabled")&&k.ia(Cc.a.sti,!1)?this.HSc=this.xWd(b,k):this.HSc=this.zWd(b,k);t.dispose();return!0}Vgc(b,k,t,D){if(!t.Wb(b))return!1;t=this.Hc.Mc(7,Pb.a.ujm);t.Cb(b);var P=b.properties.ia(sf.a.zm,[]);P.push(0);for(const ca of P)if((P=D.rnf(b,ca))&&5===P.Dh&&P.id.equals(k))return this.Kd.replaceTextRange(Of.a.createTextRange(b,
ca,ca+1),""),t.dispose(),!0;t.dispose();v.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}ZWn(b,k,t,D){if(!Be.ImageReader.t8(b))return!1;k.set(b);k.zb(12);const P=k.Xn(12);if(!P)return v.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(t.QUc(P))return v.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),
!1;D(b);t=this.Hc.Mc(7);t.Cb(b);k.wg();t.dispose();return!0}D1n(b,k,t,D){return Be.ImageReader.u2a(b)?this.r1n(b,t):Be.ImageReader.d4(b)?this.G1n(b,k,t,D):null}G1n(b,k,t,D){const P=Ys.a.instance.Mcd;t&&P.Qw(t);t=0;t=Ne.a.vF();P.setValue(Cc.a.kU,t);t=b.node.Kc;b=b.node;D=D.ZMc(b,5);for(const ca of D)if(ca.id.equals(k)){this.Kd.replaceTextRange(Of.a.createTextRange(b,ca.Ib.cp,ca.Ib.cp+1),"");const ta=t.Ju(P,P.id);k=Of.a.Rc(b,ca.Ib.cp);this.Kd.Uga(k,Na=>new Ke.ImageBlobObject(Na,ta));return P}return null}r1n(b,
k){if(!Be.ImageReader.u2a(b))return null;k.setValue(Cc.a.kU,Ne.a.vF());b=b.node;var t=b.anchor.node.id;b=ze.GraphIterator.$a(b);b.zb(12);const D=b.parentNode;let P;D.properties.hasProperty(Cc.a.f7)?(P=D.properties.Lf(Cc.a.f7),t=X.a.indexOf(P,t),-1!==t&&Array.removeAt(P,t)):P=[];D.properties.setValue(Cc.a.f7,Array.clone(P));b.wg();t=this.ld&&this.ld.isFeatureEnabled(46)?new Fj.a:new ck.a;t.Qw(k);b.Hf(t,6);this.I$f(D,t.anchor.node.id);return t}m$c(b,k){this.LKa?this.fhf():this.Fzo(b,k)}oho(b,k){b.setValue(vd.a.jJ,
k)}pYl(b){let k=null,t=null;if(!b)return v.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),{returnValue:null,view:k,uj:t};if(!Lb.InteractiveViewManager.instance.Bd)return v.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:k,uj:t};const D=b.node;if(!D)return v.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),
{returnValue:null,view:k,uj:t};t=D.Kc;var P=D.De(Lb.InteractiveViewManager.instance.Bd.ic);if(!P)return v.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:k,uj:t};k=P.eh;if(b.al&&Be.ImageReader.d4(b)){b=Be.ImageReader.mEa(b);if(!b)return v.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:k,uj:t};P=b.Lva(k,P);if(!P)return v.ULS.sendTraceTag(22381058,
322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:k,uj:t};P=P.element}else if(Be.ImageReader.gv(D))P=P.htmlElement;else return v.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:k,uj:t};return{returnValue:P,view:k,uj:t}}tno(b){for(let D=0;D<this.Vja.length;D++){this.Vja[D]=b.Kk(Eh.a.span);this.Vja[D].className="WACImageCropHandles "+
this.SZj[D];if(2>=D){var k=b.Kk(Eh.a.span);k.className=this.M9a[0];var t=b.Kk(Eh.a.span);t.className=this.M9a[1];this.Vja[D].appendChild(k);this.Vja[D].appendChild(t)}else 4<D&&(k=b.Kk(Eh.a.span),k.className=this.M9a[2],t=b.Kk(Eh.a.span),t.className=this.M9a[3],this.Vja[D].appendChild(k),this.Vja[D].appendChild(t));if(!D||3===D||5===D)k=b.Kk(Eh.a.span),k.className=this.M9a[4],t=b.Kk(Eh.a.span),t.className=this.M9a[5],this.Vja[D].appendChild(k),this.Vja[D].appendChild(t);else if(2===D||4===D||7===
D)k=b.Kk(Eh.a.span),k.className=this.M9a[6],t=b.Kk(Eh.a.span),t.className=this.M9a[7],this.Vja[D].appendChild(k),this.Vja[D].appendChild(t)}}Fzo(b,k){v.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.LKa)v.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var t=null,D=null;if((this.EAa=({view:t,uj:D}=this.pYl(k)).returnValue)&&t){this.EAa.classList.add("ImageCropMode");this.jAa=t.Kk(Eh.a.div);this.jAa.className="WACImageCropMode";
this.KKa=t.Kk(Eh.a.$1a);this.KKa.className="WACImageCropBase";this.ZJ=t.Kk(Eh.a.span);this.ZJ.className="WACImageCropSrcRect";this.tno(t);this.jAa.appendChild(this.ZJ);for(t=0;t<this.Vja.length;t++)this.ZJ.appendChild(this.Vja[t]);this.jAa.appendChild(this.KKa);this.KKa.style.visibility="";this.KKa.style.display="";this.EAa.appendChild(this.jAa);this.NCn(b);D=Be.ImageReader.uEa(b,D);t=Be.ImageReader.A5(b,vd.a.lpa,null);this.KKa.src=t?t:Be.ImageReader.aEb(D);this.SYg&&this.SYg.execute(P=>{this.Hkd||
(this.Hkd=P.lYl(this))});this.Ahd||(this.b2.kP(this.EAa,this.Hkd),this.Ahd=!0);this.ae&&this.ae.lb(Rc.a.XF,Lb.InteractiveViewManager.instance.editingView.editingElement,this.nxa);this.LKa=!0;this.vDe=b;this.Gkd=k;this.qgd=!1;b=new Xd.GraphTransaction(4);b.Cb(this.Gkd.node);this.vDe.setValue(vd.a.ywa,this.LKa);b.dispose()}else v.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}NCn(b){const k=Re.a.xf(Be.ImageReader.fF(b),
0),t=Re.a.xf(Be.ImageReader.wG(b),1);var D=Be.ImageReader.pba(b);const P=Math.max(D.top,0),ca=Math.max(D.bottom,0),ta=Math.max(D.left,0);D=Math.max(D.right,0);this.bW=1E5*k/(1E5-(ta+D));this.aW=1E5*t/(1E5-(P+ca));this.HV=Math.floor(P*this.aW/1E5);this.EV=Math.floor(ca*this.aW/1E5);this.FV=Math.floor(ta*this.bW/1E5);this.GV=Math.floor(D*this.bW/1E5);this.ZJ.style.top=this.HV+"px";this.ZJ.style.bottom=this.EV+"px";this.ZJ.style.left=this.FV+"px";this.ZJ.style.right=this.GV+"px";this.KKa.style.width=
this.bW+"px";this.KKa.style.height=this.aW+"px";Be.ImageReader.py(b)&&(this.jAa.style.width=this.bW+"px",this.jAa.style.height=this.aW+"px");this.CS=this.HV;this.zS=this.EV;this.AS=this.FV;this.BS=this.GV}fhf(b=!1){v.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.LKa?(b||this.W0k(),this.KKa?fc.a.tC(this.KKa):v.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.EAa?(this.jAa?this.jAa.parentNode===this.EAa?this.EAa.removeChild(this.jAa):
v.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):v.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.EAa.classList.remove("ImageCropMode"),this.LKa=!1,b=new Xd.GraphTransaction(4),b.Cb(this.Gkd.node),this.vDe.setValue(vd.a.ywa,this.LKa),b.dispose(),this.Ahd&&(this.b2.wP(this.EAa,this.Hkd),this.Ahd=!1),this.ae&&this.ae.rc(Rc.a.XF,Lb.InteractiveViewManager.instance.editingView.editingElement,
this.nxa),this.EAa=this.jAa=null):v.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):v.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}aFj(b,k,t,D,P,ca,ta){if(t){t=Math.max(this.HV-k,0);const Na=Math.floor(this.aW)-this.EV-t;5<=Na?(this.CS=t,this.zS=this.EV):5>Na&&0<=Na||0>Na&&!this.EV?(this.CS=t-(5-Na),this.zS=this.EV):0>Na&&5>=Math.abs(Na)?(this.CS=Math.floor(this.aW)-
this.EV,this.zS=Math.max(this.EV-(t-(this.aW-this.EV))-(5-Math.abs(Na)),0)):(this.CS=Math.floor(this.aW)-this.EV,this.zS=Math.max(this.EV-(t-(this.aW-this.EV)),0));this.ZJ.style.top=this.CS+"px";this.ZJ.style.bottom=this.zS+"px";ta&&(this.HV=this.CS,this.EV=this.zS)}D&&(k=Math.max(this.EV-k,0),D=Math.floor(this.aW)-this.HV-k,5<=D?(this.zS=k,this.CS=this.HV):5>D&&0<=D||0>D&&!this.HV?(this.zS=k-(5-D),this.CS=this.HV):0>D&&5>=Math.abs(D)?(this.zS=Math.floor(this.aW)-this.HV,this.CS=Math.max(this.HV-
(k-(this.aW-this.HV))-(5-Math.abs(D)),0)):(this.zS=Math.floor(this.aW)-this.HV,this.CS=Math.max(this.HV-(k-(this.aW-this.HV)),0)),this.ZJ.style.top=this.CS+"px",this.ZJ.style.bottom=this.zS+"px",ta&&(this.HV=this.CS,this.EV=this.zS));P&&(P=Math.max(this.FV-b,0),k=Math.floor(this.bW)-this.GV-P,5<=k?(this.AS=P,this.BS=this.GV):5>k&&0<=k||0>k&&!this.GV?(this.AS=P-(5-k),this.BS=this.GV):0>k&&5>=Math.abs(k)?(this.AS=Math.floor(this.bW)-this.GV,this.BS=Math.max(this.GV-(P-(this.bW-this.GV))-(5-Math.abs(k)),
0)):(this.AS=Math.floor(this.bW)-this.GV,this.BS=Math.max(this.GV-(P-(this.bW-this.GV)),0)),this.ZJ.style.left=this.AS+"px",this.ZJ.style.right=this.BS+"px",ta&&(this.FV=this.AS,this.GV=this.BS));ca&&(b=Math.max(this.GV-b,0),ca=Math.floor(this.bW)-this.FV-b,5<=ca?(this.BS=b,this.AS=this.FV):5>ca&&0<=ca||0>ca&&!this.FV?(this.BS=b-(5-ca),this.AS=this.FV):0>ca&&5>=Math.abs(ca)?(this.BS=Math.floor(this.bW)-this.FV,this.AS=Math.max(this.FV-(b-(this.bW-this.FV))-(5-Math.abs(ca)),0)):(this.BS=Math.floor(this.bW)-
this.FV,this.AS=Math.max(this.FV-(b-(this.bW-this.FV)),0)),this.ZJ.style.left=this.AS+"px",this.ZJ.style.right=this.BS+"px",ta&&(this.FV=this.AS,this.GV=this.BS));ta&&(this.qgd=!0,Wa.App.ya.updateCommandUI())}kSk(){this.CS=this.HV;this.zS=this.EV;this.AS=this.FV;this.BS=this.GV;this.ZJ.style.top=this.CS+"px";this.ZJ.style.bottom=this.zS+"px";this.ZJ.style.left=this.AS+"px";this.ZJ.style.right=this.BS+"px"}W0k(){if(this.qgd){v.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");
var b=Math.floor(1E5*this.HV/this.aW),k=Math.floor(1E5*this.EV/this.aW),t=Math.floor(1E5*this.FV/this.bW),D=Math.floor(1E5*this.GV/this.bW),P=new th.DictionaryPropertySet;P.setValue(vd.a.Hib,b);P.setValue(vd.a.Eib,k);P.setValue(vd.a.Fib,t);P.setValue(vd.a.Gib,D);this.ga.Nf(this.Gkd,Nc.a.zoi,2,!1,null,P)}else v.ULS.sendTraceTag(23070481,322,50,"No New Cropping Properties To Commit.")}ywa(){return this.LKa}rRl(){return{top:this.CS,bottom:this.zS,left:this.AS,right:this.BS}}KTo(b,k){if(0>b)v.ULS.sendTraceTag(22552777,
322,15,"Unexpected negative value for new Crop properties.");else{switch(k){case 0:this.HV=this.CS=Math.min(Math.floor(this.aW)-this.zS-5,b);this.ZJ.style.top=this.CS+"px";break;case 1:this.EV=this.zS=Math.min(Math.floor(this.aW)-this.CS-5,b);this.ZJ.style.bottom=this.zS+"px";break;case 2:this.FV=this.AS=Math.min(Math.floor(this.bW)-this.BS-5,b);this.ZJ.style.left=this.AS+"px";break;case 3:this.GV=this.BS=Math.min(Math.floor(this.bW)-this.AS-5,b),this.ZJ.style.right=this.BS+"px"}this.qgd=!0}}}Object(n.a)(tm,
"ImageEditor",Ol,[270,271]);class is{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}xc(b){this.W=b;this.W.ha("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new Dd(w.AFrameworkApplication.va,Fa.a.instance.Sa("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").singleInstance();this.W.ha("WordEditor.ImageEditors.ImageEditor",()=>new tm(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.Sa("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),Zb.KeyInputManager.instance,b.Sa("WordEditor.IImageCropDragAdapterFactory"),b.Na("Box4.IFeatureHelper"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").singleInstance()}init(){this.W.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){N.a.instance.Fc(new is)}}
Object(n.a)(is,"WordEditorImageEditorsPackage",null,[1,2]);class Wn{}Object(n.a)(Wn,"FolderContentEditor",null,[1344]);class js{}Object(n.a)(js,"PageEditor",null,[1248]);var Wk=c(147);class rt extends js{constructor(){super()}get fh(){return Wk.PageNavigator.instance}}Object(n.a)(rt,"PageEditor",js,[]);class Zs{get name(){return"WordEditor.NotebookLevelEditors"}xc(b){b.ha("Box4.NotebookLevelEditors.FolderContentEditor",()=>new Wn).as("Box4.Folder.IFolderContentEditor").singleInstance();b.ha("WordEditor.NotebookLevelEditors.PageEditor",
()=>new rt).as("Box4.Pages.IPageEditor").singleInstance()}init(){}dispose(){}static main(){N.a.instance.Fc(new Zs)}}Object(n.a)(Zs,"WordEditorNotebookLevelEditorsPackage",null,[1,2]);class zs{get zLb(){return w.AFrameworkApplication.privacyUrl}Zta(){v.ULS.sendTraceTag(37034014,342,50,"User clicked on the Privacy statement.");$d.a.nm(this.zLb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(n.a)(zs,"PrivacyLinkHandler",null,[803]);class As{constructor(b,k){this.rLe=null;this.yhk=
b;this.xhk=k}showDialog(b){this.rLe=b;this.xhk.create().Wh(Object(A.a)(this,this.Wkm,"handleDialog"))}Wkm(b){1===b&&this.yhk.dij();this.rLe();this.rLe.prototype}}Object(n.a)(As,"SendUsYourFileController",null,[787]);class Wq extends Uc.StandardDialog{constructor(b,k,t){super();this.PXb=null;this.hg=b;this.azc=k;this.cH=t}Wh(b){this.Ad=1;this.Ee(1,this.cH.send);this.Ee(0,this.cH.hfn);v.ULS.shipAssertTag(37034013,342,!this.PXb,"privacy anchor should be null before initializing it.");const k=this.dialogContent();
this.glb(this.cH.UBk,null,"CancelRequest_32x32x32",null,b,k);this.Z4(this.kj(Wq.mij))}dialogContent(){const b=document.createElement("span");b.innerText=this.cH.QFn;const k=document.createElement("span");k.innerText=this.cH.UFo;k.style.fontWeight=this.cH.aZo;const t=document.createElement("span");t.innerText=this.cH.Ico;const D=this.b3k(),P=document.createElement("span");P.id=this.kj(Wq.mij);P.appendChild(b);P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));P.appendChild(k);
P.appendChild(document.createElement("br"));P.appendChild(t);P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));P.appendChild(D);return P}b3k(){const b=document.createElement("span"),k=document.createElement("a");k.innerText=this.cH.yFn;k.href=this.azc.zLb||"";b.appendChild(k);this.PXb=k;this.hg.lb(Rc.a.click,this.PXb,Object(A.a)(this.azc,this.azc.Zta,"clickHandler"));return b}dispose(){this.PXb&&(this.hg.rc(Rc.a.click,
this.PXb,Object(A.a)(this.azc,this.azc.Zta,"clickHandler")),this.PXb=null);super.dispose()}}Wq.mij="sendUsYourFileId";Object(n.a)(Wq,"SendUsYourFileDialog",Uc.StandardDialog,[802]);class Ut{create(){return Fa.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(n.a)(Ut,"Factory",null,[801]);var Vt=c(582);class oi extends Vt.a{constructor(){super();this.FileId=null}$k(){return 38}static construct(b){const k=new oi;k.FileId=b;return k}}Object(n.a)(oi,"CreateSendUsYourFileRequest",
Vt.a,[]);var kr=c(988);class Fq{constructor(b,k,t){this.O5=b;this.VP=k;this.l$j=t}dij(b=!1){if(this.VP){const k=oi.construct(this.VP()),t=new kr.a;t.Cq=k;t.status=1;t.GG="BootErrorReport";b=b?this.O5(null):this.O5(D=>{this.U4c(t,D)});b.EI(t);b.BT();this.l$j()}}U4c(b){5===b.statusCode&&this.dij(!0)}}Object(n.a)(Fq,"SendUsYourFileManager",null,[788]);class Wt{constructor(b,k){this.W=null;this.cH=b;this.VP=k}xc(b){this.W=b;this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.cH).singleInstance();
this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",()=>new Wq(Zh.a.instance,new zs,this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new Fq(k=>this.rga(0,k),this.VP,()=>{v.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const k=new Ut;return new As(this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),
k)}).singleInstance()}init(){this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}Object(n.a)(Wt,"SendUsYourFilePackageManager",null,[]);var Pp=c(509),Vj=c(1025),Qk;(function(b){b[b.none=0]="none";b[b.oneNote=1]="oneNote";b[b.word=2]="word";b[b.wordViewer=3]="wordViewer";b[b.powerPoint=4]="powerPoint"})(Qk||(Qk={}));Object(n.b)("AppMode",Qk);class Qp{get UBk(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get hfn(){return CommonUIStrings.l_NoThanks}get QFn(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get UFo(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get aZo(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get Ico(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get yFn(){return CommonUIStrings.l_PrivacyStatement}}
Object(n.a)(Qp,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class Io extends Wt{constructor(){super(new Qp,()=>w.AFrameworkApplication.rootQuerySignature)}rga(b,k){return new Vj.a(b,k,"SendUsYourFile.ashx",Qk.word,Wa.App.webServiceBase,Pp.a.amIAlone,Pp.a.W4c,Pp.a.H4c)}get name(){return"WordEditor.SendUsYourFile"}static main(){N.a.instance.Fc(new Io)}}Object(n.a)(Io,"PackageManager",Wt,["__INTERFACE__@1js/msoserviceplatform:IPackage","__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);
var mk=c(538),Jj=c(641),Lm=c(1823),Ym=c(115),yh=c(27),Gq=c(152),ch=c(68),Xk=c(939),Vg=c(144),Hq=c(996);class Dr{constructor(b,k,t,D,P,ca){this.V1h=b;this.gallerySectionId=k;this.oxl=t;this.eAk=D;this.commandId=P;this.queryCommandId=ca}}Object(n.a)(Dr,"BorderStyleMenuPropsArguments",null,[]);class Kn{constructor(b,k,t,D,P,ca,ta){this.u1b=b;this.jvj=k;this.width=t;this.XQi=D;this.height=P;this.aFi=ca;this.altText=ta}}Object(n.a)(Kn,"TableBorderStyleProperties",null,[]);class Qf{constructor(){this.Nwh=
[new Kn(Qf.Ssj,"","2",1,8,0,"Solid Line"),new Kn(Qf.jOh,"5,3","1",1,8,0,"Dashed Line"),new Kn(Qf.tTh,"1,1","1",1,8,0,"Dotted Line"),new Kn(Qf.vTh,"","1",2,8,3,"Double Line")];this.Owh=[new Kn(Qf.Vwh,"","1",1,8,0,"0.25pt"),new Kn(Qf.Swh,"","1",1,8,0,"0.5pt"),new Kn(Qf.Ywh,"","2",1,8,0,"0.75pt"),new Kn(Qf.Twh,"","2",1,8,0,"1pt"),new Kn(Qf.Rwh,"","3",1,8,0,"1.5pt"),new Kn(Qf.Zwh,"","4",1,8,0,"2.25pt"),new Kn(Qf.Xwh,"","4",1,8,0,"3pt"),new Kn(Qf.Qwh,"","5",1,8,0,"4.5pt"),new Kn(Qf.Wwh,"","6",1,8,0,"6pt")]}initialize(){this.f4f()}dIl(){const b=
new Dr("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.Nwh,Pb.a.sob,Pb.a.f2f);return this.v2h(b)}eIl(){const b=new Dr("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",this.Owh,Pb.a.tob,Pb.a.g2f);return this.v2h(b)}l4h(b){switch(b){case Qf.Ssj:return Vg.a.v1b;case Qf.jOh:return Vg.a.Xdb;case Qf.tTh:return Vg.a.UEc;case Qf.vTh:return Vg.a.i3;default:return Vg.a.Rta}}m4h(b){switch(b){case Qf.Vwh:return Vg.a.Uwh;case Qf.Swh:return Vg.a.A3e;case Qf.Ywh:return Vg.a.s1b;
case Qf.Twh:return Vg.a.Wdb;case Qf.Rwh:return Vg.a.Vla;case Qf.Zwh:return Vg.a.xCa;case Qf.Xwh:return Vg.a.kfa;case Qf.Qwh:return Vg.a.lZa;case Qf.Wwh:return Vg.a.wCa;default:return Vg.a.aG}}v2h(b){const k=new be.a,t=new fh.a,D=Object.assign(new Jj.a,{Id:b.V1h,ExternalId:b.gallerySectionId,ExternalGalleryId:b.oxl,Type:4,Width:1,GalleryItems:[]});for(const ca of b.eAk){var P={};const ta={};ta.width=Qf.RXm;ta.height=Qf.QXm;P.root=ta;P=Object.assign(new Lm.a,{Id:ca.u1b,ExternalId:String.format("{0}_GalleryButton",
ca.u1b),Icon:ca.u1b,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:ca.u1b,FullIconStyle:P,ShouldSetTitle:"true",Alt:ca.altText});D.GalleryItems.push(P)}t.ControlList=[];k.MenuSectionList=[];t.ControlList.push(D);k.MenuSectionList.push(t);k.UpdateDynamically=!0;return k}f4f(){const b={};for(const k of this.Nwh)b[k.u1b]=appChrome.buildBorderStyleIcon(k.jvj,k.width,k.XQi,k.height,k.aFi);for(const k of this.Owh)b[k.u1b]=appChrome.buildBorderStyleIcon(k.jvj,k.width,
k.XQi,k.height,k.aFi);appChrome.api.registerIconProvider(()=>b)}ieo(b,k,t){if(!b)return v.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==lc.a.t5)return v.ULS.sendTraceTag(577910617,306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),!1;switch(b.border){case 2:this.T0(Ym.a.YT(b),b.node,5,t,k);break;case 0:this.T0(Ym.a.YT(b),b.node,3,t,k);break;case 1:this.T0(Ym.a.YT(b),b.node,4,t,k);break;case 3:this.T0(Ym.a.YT(b),
b.node,0,t,k);break;case 7:this.T0(Ym.a.YT(b),b.node,1,t,k);break;case 8:this.T0(Ym.a.YT(b),b.node,2,t,k);break;case 6:this.T0(Ym.a.YT(b),b.node,1,t,k);this.T0(Ym.a.YT(b),b.node,2,t,k);break;case 5:this.T0(Ym.a.YT(b),b.node,3,t,k);this.T0(Ym.a.YT(b),b.node,5,t,k);this.T0(Ym.a.YT(b),b.node,4,t,k);this.T0(Ym.a.YT(b),b.node,0,t,k);break;case 4:this.T0(Ym.a.YT(b),b.node,3,t,k),this.T0(Ym.a.YT(b),b.node,5,t,k),this.T0(Ym.a.YT(b),b.node,4,t,k),this.T0(Ym.a.YT(b),b.node,0,t,k),this.T0(Ym.a.YT(b),b.node,
1,t,k),this.T0(Ym.a.YT(b),b.node,2,t,k)}return!0}R$f(b,k,t,D){if(!k)return v.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(k.contextId!==lc.a.Z0)return v.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",k.contextId),!1;var P=k.node;const ca=new ze.GraphIterator;ca.set(P);ca.zb(14);P=yh.TableCellReader.KOa(ca);switch(k.border){case 2:this.RSa(b,k.node,5,D,t,P);this.Ige(k.node,5,t);this.Gfe(b,k.C0a(),3,t,D,P);
break;case 0:this.RSa(b,k.node,3,D,t,P);this.Ige(k.node,3,t);this.Gfe(b,k.C0a(),1,t,D,P);break;case 1:this.RSa(b,k.node,4,D,t,P);this.Ige(k.node,4,t);this.Gfe(b,k.C0a(),0,t,D,P);break;case 3:this.RSa(b,k.node,0,D,t,P),this.Ige(k.node,0,t),this.Gfe(b,k.C0a(),2,t,D,P)}return!0}DKn(b,k){if(hf.SelectionEditor.RVc(b)&&k)switch(b=Object(Ka.a)(Gq.TableNodeBorderContext,b),b.border){case 2:this.HO(b.node,Qf.Go.uM(5),k);break;case 0:this.HO(b.node,Qf.Go.uM(3),k);break;case 3:this.HO(b.node,Qf.Go.uM(0),k);
break;case 1:this.HO(b.node,Qf.Go.uM(4),k);break;case 7:this.HO(b.node,Qf.Go.uM(1),k);break;case 8:this.HO(b.node,Qf.Go.uM(2),k);break;case 5:k=this.HO(b.node,Qf.Go.uM(5),k);k=this.HO(b.node,Qf.Go.uM(3),k);k=this.HO(b.node,Qf.Go.uM(0),k);this.HO(b.node,Qf.Go.uM(4),k);break;case 6:k=this.HO(b.node,Qf.Go.uM(1),k);this.HO(b.node,Qf.Go.uM(2),k);break;case 4:k=this.HO(b.node,Qf.Go.uM(5),k),k=this.HO(b.node,Qf.Go.uM(3),k),k=this.HO(b.node,Qf.Go.uM(0),k),k=this.HO(b.node,Qf.Go.uM(4),k),k=this.HO(b.node,
Qf.Go.uM(1),k),this.HO(b.node,Qf.Go.uM(2),k)}}aJn(b,k){if(hf.SelectionEditor.SVc(b)&&k)switch(b=Object(Ka.a)(Gq.TableNodeBorderContext,b),b.border){case 2:this.HO(b.node,Qf.Go.zO(5),k);break;case 0:this.HO(b.node,Qf.Go.zO(3),k);break;case 3:this.HO(b.node,Qf.Go.zO(0),k);break;case 1:this.HO(b.node,Qf.Go.zO(4),k)}}znf(b,k,t){t=null;if(!b)return v.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),t;b.properties.hasProperty(k.size)&&(t=new Hq.a,t.weight=b.properties.ia(k.size,Vg.a.aG),t.style=
b.properties.ia(k.style,Vg.a.Rta),t.color=b.properties.ia(k.color,0));return t}Q$f(b,k,t){b?t?(b.properties.setValue(k.size,t.weight),b.properties.setValue(k.style,t.style),b.properties.setValue(k.color,t.color)):v.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):v.ULS.sendTraceTag(575980877,306,15,"Node should not be null")}DMb(b,k){b?(b.properties.removeProperty(k.size),b.properties.removeProperty(k.style),b.properties.removeProperty(k.color)):v.ULS.sendTraceTag(575980879,
306,15,"Node should not be null")}T0(b,k,t,D,P){P=this.OWo(b,k,t,D,P);this.vic(k,Qf.Go.uM(t),P);switch(t){case 5:this.qSa(k,2,D,P);break;case 4:this.qSa(k,1,D,P);break;case 0:this.qSa(k,3,D,P);break;case 3:this.qSa(k,0,D,P);break;case 1:this.qSa(k,7,D,P);break;case 2:this.qSa(k,8,D,P)}}OWo(b,k,t,D,P){if(3!==D){var ca=Qf.Fg.LOd(b,k,t,3);void 0!==ca&&null!==ca&&ca!==Vg.a.$Z&&(ca=ch.a.Ahc(ca),P.color=Qf.Dpb.RCa(k,ca))}1!==D&&(ca=Qf.Fg.LOd(b,k,t,1),void 0!==ca&&null!==ca&&ca!==Vg.a.$F&&(P.weight=parseFloat(ca)*
Vg.a.t1b));2!==D&&(b=Qf.Fg.LOd(b,k,t,2),void 0!==b&&null!==b&&b!==Vg.a.$F&&(P.style=b));return P}RSa(b,k,t,D,P,ca){D&&(P=this.uRo(b,k,ca,t,D,P));this.vic(k,Qf.Go.zO(t),P)}uRo(b,k,t,D,P,ca){if(3!==P){var ta="",Na=Qf.Fg.SDb(b,k,D,!1,!0,t,3);Na&&(ta=Na.Izb);void 0!==ta&&null!==ta&&ta!==Vg.a.$Z&&(ta=ch.a.Ahc(ta),ca.color=Qf.Dpb.RCa(k,ta))}if(1!==P){ta="";if(Na=Qf.Fg.SDb(b,k,D,!1,!0,t,1))ta=Na.Izb;void 0!==ta&&null!==ta&&ta!==Vg.a.$F&&(ca.weight=parseFloat(ta)*Vg.a.t1b)}if(2!==P){P="";if(b=Qf.Fg.SDb(b,
k,D,!1,!0,t,2))P=b.Izb;void 0!==P&&null!==P&&P!==Vg.a.$F&&(ca.style=P)}return ca}wcn(b){let k=0,t=0;({Xbn:k,z$m:t}=this.A1l(b.style,k,t));b.weight<k&&(b.weight=k);b.weight>t&&(b.weight=t);return b}A1l(b,k,t){switch(b){case Vg.a.v1b:case Vg.a.Xdb:case Vg.a.UEc:k=2;t=48;break;case Vg.a.i3:k=2;t=24;break;default:k=2,t=48}return{Xbn:k,z$m:t}}Gfe(b,k,t,D,P,ca){if(k)if(D)for(let ta=0;ta<k.length;ta++)switch(t){case 2:this.RSa(b,k[ta],5,P,D,ca);break;case 0:this.RSa(b,k[ta],3,P,D,ca);break;case 1:this.RSa(b,
k[ta],4,P,D,ca);break;case 3:this.RSa(b,k[ta],0,P,D,ca)}else v.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else v.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}Ige(b,k,t){const D=new ze.GraphIterator;D.set(b);D.zb(14);const P=yh.TableCellReader.Bna(b);b=yh.TableCellReader.AO(b);mh.forEachCell(D,P,b,(ca,ta,Na)=>{ca=ca.currentNode;yh.TableCellReader.Qr(ca)&&0==Na&&0<ta&&this.vic(ca,Qf.Go.zO(k),t)})}vic(b,k,t){b?(t=this.wcn(t),b.properties.setValue(k.color,
t.color),b.properties.setValue(k.size,t.weight),b.properties.setValue(k.style,t.style)):v.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}qSa(b,k,t,D){if(b){var P=Ih.TableReader.eg(b),ca=Ih.TableReader.Yg(b),ta=new ze.GraphIterator,Na=[];for(let qb=0;qb<P;qb++)for(let Jb=0;Jb<ca;Jb++)if(ta.set(b),mh.moveToCell(ta,qb,Jb),ta&&ta.currentNode&&!yh.TableCellReader.gg(ta))switch(k){case 2:yh.TableCellReader.dha(ta)&&Na.push(Gq.TableNodeBorderContext.H7(ta.currentNode,2));break;case 0:yh.TableCellReader.eha(ta)&&
Na.push(Gq.TableNodeBorderContext.H7(ta.currentNode,0));break;case 3:yh.TableCellReader.YDf(b,ta.currentNode)&&Na.push(Gq.TableNodeBorderContext.H7(ta.currentNode,3));break;case 1:yh.TableCellReader.ZDf(b,ta.currentNode)&&Na.push(Gq.TableNodeBorderContext.H7(ta.currentNode,1));break;case 7:yh.TableCellReader.ZDf(b,ta.currentNode)||Na.push(Gq.TableNodeBorderContext.H7(ta.currentNode,1));break;case 8:yh.TableCellReader.YDf(b,ta.currentNode)||Na.push(Gq.TableNodeBorderContext.H7(ta.currentNode,3))}for(b=
0;b<Na.length;b++)switch(k=Na[b],k.border){case 2:this.L3c(k.node,Qf.Go.zO(5),t,D);this.Hce(k.C0a(),Qf.Go.zO(0),t,D);break;case 0:this.L3c(k.node,Qf.Go.zO(3),t,D);this.Hce(k.C0a(),Qf.Go.zO(4),t,D);break;case 1:this.L3c(k.node,Qf.Go.zO(4),t,D);this.Hce(k.C0a(),Qf.Go.zO(3),t,D);break;case 3:this.L3c(k.node,Qf.Go.zO(0),t,D),this.Hce(k.C0a(),Qf.Go.zO(5),t,D)}}else v.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}Hce(b,k,t,D){if(b)for(let P=0;P<b.length;P++)this.L3c(b[P],k,t,D);else v.ULS.sendTraceTag(578062292,
306,15,"Adjacent cell array should not be null")}L3c(b,k,t,D){if(b){var P=b.ia(k.color,Qf.Icf),ca=b.ia(k.size,Qf.Kcf),ta=b.ia(k.style,Qf.Jcf),Na=new Hq.a;Na.weight=D.weight;Na.style=D.style;Na.color=D.color;2!==t||P===Qf.Icf&&ca===Qf.Kcf?3!==t||ta===Qf.Jcf&&ca===Qf.Kcf?1!==t||P===Qf.Icf&&ta===Qf.Jcf?(b.properties.removeProperty(k.color),b.properties.removeProperty(k.size),b.properties.removeProperty(k.style)):(Na.color=P,Na.style=ta,this.vic(b,k,Na)):(Na.style=ta,Na.weight=ca,this.vic(b,k,Na)):(Na.color=
P,Na.weight=ca,this.vic(b,k,Na))}else v.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}HO(b,k,t){var D=b.properties.ia(k.style,Vg.a.$F);D!==Vg.a.$F&&(t.lineStyle!==Vg.a.$F?t.lineStyle!==D&&(t.lineStyle=Vg.a.yKk):t.lineStyle=D);D=b.properties.ia(k.size,Vg.a.aG);D!==Vg.a.aG&&(t.qXc!==Vg.a.aG?t.qXc!==D&&(t.qXc=Vg.a.qKk):t.qXc=D);b=b.properties.ia(k.color,0);b=ch.a.XE(b);b!==Vg.a.$Z&&(t.borderColor!==Vg.a.$Z?t.borderColor!==b&&(t.borderColor=Vg.a.iKk):t.borderColor=b);return t}static get Go(){return null!=
Qf.awg?Qf.awg:Qf.awg=Vg.a.instance}static get Fg(){return null!=Qf.OJg?Qf.OJg:Qf.OJg=Fa.a.instance.Na("WordEditor.IWACTableStyleReader")}static get Dpb(){return null!=Qf.AHg?Qf.AHg:Qf.AHg=Xk.a.instance}}Qf.RXm="110px";Qf.QXm="20px";Qf.Ssj="SolidLineStyle";Qf.jOh="DashedLineStyle";Qf.tTh="DottedLineStyle";Qf.vTh="DoubleLineStyle";Qf.Vwh="BorderPointSizeOneQuarter";Qf.Swh="BorderPointSizeOneHalf";Qf.Ywh="BorderPointSizeThreeQuarters";Qf.Twh="BorderPointSizeOne";Qf.Rwh="BorderPointSizeOneAndHalf";Qf.Zwh=
"BorderPointSizeTwoAndQuarter";Qf.Xwh="BorderPointSizeThree";Qf.Qwh="BorderPointSizeFourAndHalf";Qf.Wwh="BorderPointSizeSix";Qf.Jcf="single";Qf.Kcf=4;Qf.Icf=0;Object(n.a)(Qf,"TableBorderManager",null,[269]);var Zm=c(843),fn=c(52),lr=c(206);class st{constructor(b,k){this.Qbh=this.A7g=null;this.jNa=b;this.Y9g=k}get CYi(){return this.Y9g}get $oa(){return this.A7g}get F3f(){return this.Qbh}Glj(b,k){this.Qbh=b;this.A7g=k}fjo(b){this.Y9g=b}}Object(n.a)(st,"CellNodeAndOutlineElementInfoForInsertion",null,
[]);var Wg=c(91),mr=c(193),Iq=c(363),Qn=c(143),xn=c(247),Pl=c(588),Xt=c(75),Xq=c(468),Bs=c(1041);class Im extends Zm.a{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb=null,ac=null){super(b,k,t,ac,Vb);this.z9a=Bs.a.instance;this.ra=new Ue.a;this.W5e=[Cc.a.Ekc,Cc.a.rpb,Cc.a.yPb,Cc.a.Ckc,Cc.a.ppb,Cc.a.wPb,Cc.a.Bkc,Cc.a.opb,Cc.a.vPb,Cc.a.Dkc,Cc.a.qpb,Cc.a.xPb];this.MXj=[Cc.a.xa,Cc.a.ua,sf.a.Hh,sf.a.Zq];this.ni=D;this.Jxb=P;this.Wc=ca;this.ib=ta;this.l6=Na;this.Zl=qb;this.ktc=Jb;this.Tih=Vb;this.Olk=ac;this.QHn=
this.M0f.bind(this)}get uj(){return this.ni.value}get Ns(){return this.l6?this.l6.instance:null}e_e(b){this.ra.addHandler("OnParagraphDelete",b)}get kh(){return!!this.ktc.instance&&this.ktc.instance.kh}DSc(b,k,t,D,P){k.setValue(Cc.a.Lc,Ne.a.vF());k.setValue(Cc.a.QFm,P);Pl.b(D,k,[Cc.a.a1]);super.DSc(b,k,t,D,P)}mWd(b,k,t,D,P){const ca=this.jQc(k,t,D,P);this.TFd(ca,k,!1);return super.mWd(b,k,t,D,P)}Iyd(b,k,t,D,P){const ca=this.jQc(k,t,D,P);this.TFd(ca,k,!0);super.Iyd(b,k,t,D,P);return ca}j$e(b,k,t,D){k=
this.jQc(b,k,t,D);this.TFd(k,b,!0);return k}insertRows(b,k,t,D){const P=fn.a.rs(b),ca=new ze.GraphIterator;ca.Yc(b);const ta=ca.currentNode;ca.Rb(1);let Na;Na=k?b.KC(1):b.currentNode;const qb=b.uc();if(!qb)throw Error.create("table row insertion cannot be performed on a null tableNode");const Jb=Ih.TableReader.eg(qb),Vb=qb.qT.Fg;let ac=!1;try{qb.mya=1;const yc=this.z9a.fhb(qb,Vb.hF(qb));this.cTa(b.currentNode);this.Rqa(b);this.ssk(t,b,Na,ca,ta,k,D);const Kc=this.z9a.fhb(qb,Vb.hF(qb));this.x6a(qb,
Ih.TableReader.eg(qb)+t);ac=!0;this.UWd(qb,yc,Kc)}finally{qb.mya=0,ac||this.x6a(qb,Ih.TableReader.eg(qb)+t)}P+1!==Jb||k?!P&&k&&Im.QAf(qb,t):Im.QAf(qb,P);k=P+t+(k?0:1);k<Jb+t&&this.Ssi(qb,k);return b.currentNode}ssk(b,k,t,D,P,ca,ta){let Na=null,qb=null;for(var Jb=0;Jb<b;++Jb){var Vb=lr.a.instance.createInstance(393251);qb||(qb=Vb);Na=Vb;this.DSc(k,Vb,t,P,ca)}b=Ih.TableReader.Yg(k.currentNode);t=!0;do{t?(k.Gi(Na),t=!1):k.vf(1);P=Array(b);for(Jb=0;Jb<b;++Jb){Vb=this.MNa();const ac=this.j$e(Vb,D.currentNode,
ca,!0);let yc=null;ac.gg||(yc=ta(ac));P[Jb]=new st(Vb,yc);P[Jb].Glj(ac,null);D.vf(1)}for(Jb=0;Jb<b;++Jb)Vb=P[Jb].jNa,k.X2(Vb,1,Zm.a.zKa?Zm.a.zKa():null),yh.TableCellReader.Qr(Vb)||(this.izb(k,Vb,P[Jb].CYi),this.ZIh(P[Jb].F3f,Vb,!0));D.Oga(1)}while(k.currentNode!==qb)}insertColumns(b,k,t,D,P){let ca=b.currentNode,ta=!1,Na=Ih.TableReader.Yg(b.currentNode);const qb=Na;try{this.cTa(b.currentNode);this.Rqa(b);const Jb=ca.qT.Fg;ca.mya=1;const Vb=this.z9a.fhb(ca,Jb.hF(ca));Na=Ih.TableReader.Yg(b.currentNode);
-1===k&&(k=Na);this.qsk(b,D,t,k,P);ca=b.currentNode;Na+=D;this.$2f(b,Na,D,k);ta=!0;const ac=this.z9a.fhb(ca,Jb.hF(ca));this.UWd(ca,Vb,ac)}finally{ca.mya=0,ta||this.$2f(b,Na,D,k)}k!==qb||t?!k&&t&&Im.PAf(ca,D):Im.PAf(ca,k-1)}qsk(b,k,t,D,P){var ca=b.currentNode;D=t?D:D-1;b.Rb(1);var ta=new Eb.a;do{var Na=b.zG(D,1);b.uc();var qb=Array(k);for(let Vb=0;Vb<k;++Vb){var Jb=this.MNa();const ac=this.s3l(b,Na,t),yc=this.j$e(Jb,Na,t,!1);Jb=new st(Jb,null);Jb.Glj(yc,ac);qb[Vb]=Jb}ta.add(qb)}while(b.xi(1));t=ta.toArray();
for(D=0;D<t.length;D++)for(ta=0;ta<k;ta++)Na=t[D][ta],qb=Na.F3f,qb.gg||Na.fjo(P(qb));b.set(ca);b.Rb(1);P=0;do{for(ca=0;ca<k;++ca)D=t[P][ca],ta=D.jNa,b.nGb(ta,D.$oa,1,Zm.a.zKa?Zm.a.zKa():null),yh.TableCellReader.Qr(ta)||(this.izb(b,ta,D.CYi),this.ZIh(D.F3f,ta,!1));P++}while(b.xi(1))}UWd(b,k,t){if(k){var D=2===b.mya,P=[],ca=new ze.GraphIterator;ca.set(b);for(var ta=ca.Rb(1);ta;){for(ta=ca.Rb(1);ta;){const Na=ta.id.toString();Na in k&&k[Na]===t[Na]&&(!D||!yh.TableCellReader.eha(ca)&&!yh.TableCellReader.dha(ca))||
P.push(ta);ta=ca.xi(1)}ta=ca.xi(1)}if(0<P.length){k=new Xd.GraphTransaction(3);try{k.set(b.hj);for(const Na of P)Na.RAf()}finally{k&&k.dispose()}}}}deleteRows(b,k){const t=fn.a.rs(b),D=t+k;let P=b.uc();const ca=P.qT.Fg;let ta=!1;v.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",P.id.toString(),P.type,t,k);const Na=Ih.TableReader.eg(P);try{P.mya=2;const qb=this.z9a.fhb(P,ca.hF(P));this.cTa(b.currentNode);
this.Rqa(b);for(let Vb=D-1;Vb>=t;--Vb){b.zG(Vb,1);let ac=b.Rb(1);for(;ac;)this.g_c(ac,!0),ac=b.xi(1);this.I1a(b);v.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.We);b.wg()}P=b.currentNode;const Jb=this.z9a.fhb(P,ca.hF(P));this.x6a(P,Ih.TableReader.eg(P)-k);this.n6d(b);ta=!0;this.UWd(P,qb,Jb)}finally{P.mya=0,ta||(this.x6a(b.currentNode,Ih.TableReader.eg(b.currentNode)-k),this.n6d(b))}Na===D&&0<=t-1&&Im.QAf(P,t-1);t<Na-k&&this.Ssi(P,t)}deleteColumns(b,
k,t){b=Object(Ka.a)(ze.GraphIterator,b);let D=Object(Ka.a)(Xq.a,b.currentNode),P=Ih.TableReader.Yg(b.currentNode);const ca=D.qT.Fg;let ta=!1;v.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",D.id.toString(),D.type,k,t);const Na=P;try{D.mya=2;const qb=this.z9a.fhb(D,ca.hF(D));this.cTa(b.currentNode);this.Rqa(b);-1===k&&(k=P-t);b.Rb(1);do for(let Vb=k+t-1;Vb>=k;--Vb)b.zG(Vb,1),this.g_c(b.currentNode,
!1),this.I1a(b),b.wg();while(b.xi(1));P-=t;this.Z2f(b,P,k,t);ta=!0;D=Object(Ka.a)(Xq.a,b.currentNode);const Jb=this.z9a.fhb(D,ca.hF(D));this.UWd(D,qb,Jb);this.m6d(b)}finally{D&&(D.mya=0),ta||(this.Z2f(b,P,k,t),this.m6d(b))}Na===k+t&&0<=k-1&&Im.PAf(D,k-1)}mergeCells(b,k,t){if(b&&(1!==k||1!==t)){var D=new ze.GraphIterator;D.Yc(b);D.zb(14);this.Eaf(D,k,t);this.bRo(D,k,t);D.uc();D.uc();this.vUi(D)}}utj(b,k,t){if(b&&(1!==k||1!==t)){var D=new ze.GraphIterator;D.Yc(b);D.zb(14);this.Gcl(D,k,t);D.uc();D.uc();
this.MWi(D)}}g_c(b,k){v.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.Nkm(b,k,this.QHn)}M0f(b,k){const t=b.currentNode;t.gg=!1;this.TFd(k.currentNode,b.currentNode,!0);t.removeProperty(Cc.a.skippedCell);t.removeProperty(Cc.a.renderCell);1===t.colSpan&&1===t.rowSpan&&t.cGc();Zm.a.lK.h7(b,!0,Zm.a.mci(k.currentNode));mh.returnToCell(b);this.n6k(k,b)}nwf(b,k,t){super.nwf(b,k,t);1===k.controlCell.colSpan&&1===k.controlCell.rowSpan?k.controlCell.cGc():
!t&&k.uee&&(b.pPa?1<b.colSpan&&(k=new ze.GraphIterator,k.set(b),k.zb(15),mh.moveToNextColumn(k),k.currentNode.colSpan=b.colSpan-1):(t=new ze.GraphIterator,t.set(k.controlCell),t.zb(15),k=Xt.a(t),t=new ze.GraphIterator,t.set(b),t.zb(15),mh.moveToColumnByIndex(t,k),--t.currentNode.colSpan))}jQc(b,k,t,D){const P=super.jQc(b,k,t,D);if(b.gg&&!D){var ca=k.bxa;ca.uee&&(D=Zm.a.W6b(ca.controlCell,D),!ca.eEd&&t||ca.eEd===D-1&&!t?b.colSpan=1:(t=new ze.GraphIterator,t.set(ca.controlCell),t.zb(15),ca=Xt.a(t),
t=new ze.GraphIterator,t.set(k),t.zb(15),mh.moveToColumnByIndex(t,ca),t.currentNode.colSpan+=1))}P.ia(Cc.a.skippedCell,!1)&&(b.gg=!0,b.n4=!0,b.Iob=!0);return P}n6d(b){this.zQb(b,Cc.a.complexTable)}m6d(b){this.zQb(b,Cc.a.complexTable)}vUi(b){this.zQb(b,Cc.a.complexTable)}MWi(b){this.zQb(b,Cc.a.complexTable)}n6k(b,k){if(b&&k){let t;b=ze.GraphIterator.$a(b.currentNode);vi.OutlineNavigator.T8(b)&&(b.Rb(2),b=b.currentNode,12==b.type&&(t=b.Lf(sf.a.Hh)));t&&(b=new ze.GraphIterator,b.Yc(k),vi.OutlineNavigator.T8(b)&&
b.Rb(2)&&(k=b.currentNode,12==k.type&&k.Zg(sf.a.Hh,t)))}}TFd(b,k,t){b&&(Pl.b(b,k,this.W5e),Pl.b(b,k,[sf.a.vH]),t&&Pl.b(b,k,[Cc.a.qP,Cc.a.KR,Cc.a.XHa,Cc.a.VHa,Cc.a.Aqa,Cc.a.skippedCell,Cc.a.renderCell]))}ZIh(b,k,t){b&&(b=ze.GraphIterator.$a(b),b.yd(),b.Qd(),k=ze.GraphIterator.$a(k),k.yd(),k.Qd(),va.OutlineElementReader.Bh(b)&&ag.OutlineElementNavigator.Ge(b)&&va.OutlineElementReader.Bh(k)&&ag.OutlineElementNavigator.Ge(k)&&Pl.b(b.currentNode,k.currentNode,this.MXj),t&&(ag.OutlineElementNavigator.Vd(b),
ag.OutlineElementNavigator.Vd(k),dg.ListItemReader.sh(b)&&(t=Im.CYm.hw(b),t.OB=Wg.a.rl,{lwa:t}=Im.Un.Ola(t.propertySet,k,t))))}I1a(b){this.kh&&this.Zl.BWn(b.currentNode);for(b=mr.a.Kp(b);b.moveNext();)if(pe.ParagraphReader.Wb(b.currentNode)){const k=Oi.e(b.currentNode);for(const t of k)t.Rha();this.ra.raiseEvent("OnParagraphDelete",b.currentNode)}else dg.ListItemReader.sh(b.iterator)&&this.Ns&&this.Ns.Hca(b.iterator)}gE(b,k){let t=null;if(this.Tih.qg){const D=Object(Ka.a)(Xq.a,b);D&&(t=D.AR())}Ih.TableReader.$m(b)&&
(1===k?k=3:3===k&&(k=1));super.gE(b,k);this.Tih.qg&&this.Olk.Tia(b,t);Object(ob.a)(Xq.a,b)&&Zm.a.nh.tmj(Object(Ka.a)(Xq.a,b),(new Iq.a(1,0)).Ft)}$ag(b,k){const t=Array(k),D=this.dhi(b)/k;for(let P=0;P<k;P++)t[P]=Math.max(Re.a.Tl(Qn.a.hda,0),D);b.setValue(sf.a.Bz,t)}jlj(b){b.setValue(Cc.a.tableLayout,0)}Sqh(b,k,t,D,P){const ca=Array(t);for(var ta=0,Na=0;ta<D;++ta)ca[ta]=k[ta],Na+=ca[ta];for(;ta<t;++ta)ca[ta]=0>ta-P?k[0]:k[ta-P],Na+=ca[ta];ta=this.dhi(b.currentNode);if(Na>ta)for(Na=ta/Na,ta=0;ta<t;++ta)ca[ta]=
Math.max(Re.a.Tl(Qn.a.hda,0),ca[ta]*Na);return ca}dhi(b){var k=ze.GraphIterator.$a(b);b=Re.a.Tl(Re.a.Ni(Ih.TableReader.Rgi(k),0),0);if(k.zb(16))return mh.returnToCell(k),k=Qn.a.ylc(k.currentNode),Re.a.Tl(Re.a.Ni(k,0),0)-b;k=xn.a.v$c(k);return Re.a.Tl(Re.a.Ni(k,0),0)-b}AO(b,k,t){const D=new ze.GraphIterator;D.set(b);mh.moveToCell(D,k,t);return D.currentNode.ia(Cc.a.colSpan,1)}Cic(b){var k=Wa.App.ya.gb.ru;if(k.qe&&(k=b.De(k.ic))){var t=!1,D=Ih.TableReader.Yg(b),P=b.ia(sf.a.Bz,Array(D));for(var ca of P)if(!ca){t=
!0;break}if(t){P=Qm.a.clone(P);ca=b.ia(Cc.a.complexTable,!1);v.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",D,P,ca);t=1;var ta=0;for(let qb=0;qb<D;)if(ca&&(t=this.AO(b,0,qb)),1<t){for(var Na=0;Na<t;Na++)P[qb]||(P[qb]=this.Qai(0)),qb++;ta+=t-1}else(Na=k.qRl(qb-ta))||v.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",qb,ta),P[qb]||(P[qb]=this.Qai(Na)),qb++;b.setValue(sf.a.Bz,P)}}}Qai(b){return Re.a.Tl(Math.max(b,
Qn.a.hda),0)}cTa(b){b=ze.GraphIterator.$a(b);this.Cic(b.currentNode);b.zb(14)&&(mh.returnToContainingTable(b),this.Cic(b.currentNode))}qmj(b,k){k&&b.setValue(Cc.a.S9,k)}Cbg(b,k){k&&b.setValue(Cc.a.Akc,k)}FDh(b,k){const t=Ih.TableReader.Yg(b);Zm.a.GWk(b,k,t)}hfo(b,k,t){let D;if(!({tableNode:D}=this.Abc(b)).returnValue)return!1;if(k&&t&&k.length===t.length){if(!this.Ynl(D,k))return!1;for(let P=0;P<k.length;++P){const ca=this.Jxb.C6c(b,k[P],t[P]);if(ca)return v.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",
ca),!1}this.r4d(D);return!0}return!1}tCk(b,k){let t;if(!({tableNode:t}=this.Abc(b)).returnValue||Ih.TableReader.AB(t))return!1;var D=Object(Ka.a)(ze.GraphIterator,this.Wc.Uf(t));mh.moveToLastRow(D);var P=Ih.TableReader.eg(t);if(k&&0<k.length){this.insertRows(D,!1,k.length,()=>null);D=Ih.TableReader.eg(t);var ca=this.Wc.Uf(t);P=this.Mgi(ca,P,D-1);for(D=0;D<P.length;++D){ca=P[D];const ta=k[D];for(let Na=0;Na<ca.length;++Na){let qb;if(qb=ta&&ta[Na]?this.Jxb.C6c(b,ca[Na],ta[Na].toString()):this.Jxb.C6c(b,
ca[Na],""))return v.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",qb),!1}}}this.r4d(t);return!0}bCk(b,k){let t;if(!({tableNode:t}=this.Abc(b)).returnValue||Ih.TableReader.AB(t))return!1;var D=this.Wc.Uf(t),P=Ih.TableReader.Yg(t);if(k&&0<k.length){this.insertColumns(Object(Ka.a)(ze.GraphIterator,D),P,!1,k[1].length,()=>null);var ca=Ih.TableReader.Yg(t);D=this.Ycm(D,P,ca-1);for(P=0;P<D.length;++P){ca=k[P];const ta=D[P];for(let Na=
0;Na<ta.length;++Na){let qb;if(qb=ca&&ca[Na]?this.Jxb.C6c(b,ta[Na],ca[Na].toString()):this.Jxb.C6c(b,ta[Na],""))return v.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",qb),!1}}}this.r4d(t);return!0}Jhl(b){let k;if(!({tableNode:k}=this.Abc(b)).returnValue)return!1;let t=this.$0a(k);const D=Ih.TableReader.eg(k);var P=this.Wc.Uf(k);P=this.Mgi(P,t,D-1);for(let ca=0;ca<P.length;++ca){const ta=P[ca];for(let Na=0;Na<ta.length;++Na){const qb=
this.Jxb.I8i(b,ta[Na]);if(qb)return v.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",qb),!1}}t=t?t:1;b=this.Wc.Uf(k);b.yG(t)&&15===b.We&&this.deleteRows(Object(Ka.a)(ze.GraphIterator,b),D-t);this.r4d(k);return!0}$0a(b){let k=0;const t=this.Wc.Uf(b);let D=t.Qd();for(;D&&D.ia(Cc.a.fkb,!1);)k++,D=t.qt();return!k&&kk.StyleReader.HTa.$T(b)&32?1:k}bRo(b,k,t){var D,P;const ca=b.currentNode,ta=new ze.GraphIterator;ta.Yc(b);let Na=null,qb=
null,Jb=null;const Vb=Vg.a.instance.zO(3),ac=Vg.a.instance.zO(4),yc=Vg.a.instance.zO(5),Kc=Vg.a.instance.zO(0);mh.forEachCell(ta,k,t,(ed,sd,oe)=>{ed=ed.currentNode;sd||oe||(Na=Im.Az.znf(ed,Vb,Na));sd||oe!==t-1||(qb=Im.Az.znf(ed,ac,qb));0<sd&&!oe&&(Na?Im.Az.Q$f(ed,Vb,Na):Im.Az.DMb(ed,Vb),qb?Im.Az.Q$f(ed,ac,qb):Im.Az.DMb(ed,ac),Im.Az.DMb(ed,yc),sd!==k-1&&Im.Az.DMb(ed,Kc));oe||sd!==k-1||(Jb=Im.Az.znf(ed,Kc,Jb))});b=null===(P=null===(D=null===Wa.App||void 0===Wa.App?void 0:Wa.App.ya)||void 0===D?void 0:
D.gb)||void 0===P?void 0:P.ru;qb?(D=Gq.TableNodeBorderContext.H7(ca,1),Im.Az.R$f(Ym.a.Lp(b),D,qb,0)):Im.Az.DMb(ca,ac);D=Gq.TableNodeBorderContext.H7(ca,0);if(Na)Im.Az.R$f(Ym.a.Lp(b),D,Na,0);else for(D=Object(Ka.a)(Gq.TableNodeBorderContext,D).C0a(),P=0;P<D.length;P++)Im.Az.DMb(D[P],ac);Jb?Im.Az.Q$f(ca,Kc,Jb):Im.Az.DMb(ca,Kc)}Ynl(b,k){for(let D=0;D<k.length;++D){var t=this.Wc.Uf(k[D]);if(t.zb(14)&&(t=t.hd(14),b.id===t.id))continue;return!1}return!0}Abc(b){let k=null;if(b&&b.iu.toString()!==b.iz.toString())return{returnValue:!1,
tableNode:k};k=this.uj.Db(b.iu);return 14===k.type&&this.Jxb.Abc(b)?{returnValue:!0,tableNode:k}:{returnValue:!1,tableNode:k}}Mgi(b,k,t){const D=[];mh.forEachCellInTable(Object(Ka.a)(ze.GraphIterator,b),(P,ca,ta)=>{if(ca>=k&&ca<=t)ta||D.push([]),yh.TableCellReader.gg(P)||Array.add(D[ca-k],P.currentNode);else if(ca>t)return!1;return!0});return D}Ycm(b,k,t){const D=[];mh.forEachCellInTable(Object(Ka.a)(ze.GraphIterator,b),(P,ca,ta)=>{ta>=k&&ta<=t&&(ta===k&&D.push([]),yh.TableCellReader.gg(P)||Array.add(D[ca],
P.currentNode));return!0});return D}r4d(b){if(b&&14===b.type){b=Object(Ka.a)(ze.GraphIterator,this.Wc.Uf(b));const k=new Eb.a;pe.ParagraphReader.Jhb(b,!0,!1,k);b=Gf.SelectionFactory.te(k.J(k.count-1),0);this.ib.setSelection(b)}}static get Az(){Im.cta||(Im.cta=Fa.a.instance.Na("WordEditor.ITableBorderManager"));return Im.cta}static get CYm(){return null!=Im.xDg?Im.xDg:Im.xDg=Fa.a.instance.resolve("Box4.List.IListReader")}static get Un(){return null!=Im.rDg?Im.rDg:Im.rDg=Fa.a.instance.resolve("Box4.List.IListEditor")}Ssi(b,
k){const t=new ze.GraphIterator;t.set(b);mh.moveToFirstRow(t);mh.moveToRowByIndex(t,k);do t.currentNode.Tk(4,!0);while(mh.moveToNextRow(t))}static QAf(b,k){if(b){var t=Ih.TableReader.eg(b),D=Ih.TableReader.Yg(b);if(!(!Wa.App.ya.gb.ru.qe||0>k||k>=t))for(t=new ze.GraphIterator,t.set(b),b=0;b<D;b++){b?mh.moveToNextColumn(t):mh.moveToCell(t,k,b);if(!t||!t.currentNode||16!==t.currentNode.type)continue;let P=t.currentNode;yh.TableCellReader.Qr(P)&&(P=yh.TableCellReader.iga(P));P&&P.Tk(4,!0)}}else v.ULS.sendTraceTag(577868247,
306,15,"Can not invalidate row when there is no table node")}static PAf(b,k){if(b){var t=Ih.TableReader.eg(b),D=Ih.TableReader.Yg(b),P=new ze.GraphIterator;if(!(!Wa.App.ya.gb.ru.qe||0>k||k>=D))for(D=0;D<t;D++){P.set(b);mh.moveToCell(P,D,k);if(!P||!P.currentNode)continue;let ca=P.currentNode;yh.TableCellReader.Qr(ca)&&(ca=yh.TableCellReader.iga(ca));ca&&ca.Tk(4,!0)}}else v.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}Im.cta=null;Object(n.a)(Im,"TableEditor",
Zm.a,[267,268]);class iw{get name(){return"WordEditor.TableEditors"}xc(b){w.AFrameworkApplication.K.$("TableEditorsDelayInitializationEnabled")&&(b.ha("WordEditor.TableEditors.TableEditor",()=>new Im(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new Rg.a(()=>Wa.App.ya.gb.Uc.od),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new mk.a,af.a.instance,b.Sa("WordEditor.IFlatListEditor"),b.resolve("Box4.ContentControl.IContentControlOperator"),
b.Sa("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").singleInstance(),b.ha("WordEditor.TableEditors.TableBorderManager",()=>new Qf).as("WordEditor.ITableBorderManager").singleInstance())}init(){}dispose(){}static main(){N.a.instance.Fc(new iw)}}Object(n.a)(iw,"WordEditorTableEditorsPackage",null,[1,2]);class $s{get name(){return"WordEditor.TextLevelEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new $s)}}
Object(n.a)($s,"WordEditorTextLevelEditorsPackage",null,[1,2]);var Ey=c(1932);c(465);var Lx=c(756),Yw=c(218),Vr=c(245);class Wr{constructor(b){this.bdk=b}Zal(){const b=lr.a.instance.createInstance(393228);b.setValue(sf.a.jL,Yw.a.first);b.setValue(sf.a.rwh,0);b.setValue(sf.a.uha,Xh.OutlineReader.Ngl);(new Lx.OutlineIndentInfo(!0)).Kfj(b);return b}h7(b,k,t=null){const D=b.currentNode;if(!b.iF(1))return this.Uib(b,null,k,t);va.OutlineElementReader.aL(b)&&ag.OutlineElementNavigator.SNf(b,!0);return va.OutlineElementReader.Bh(b)?
Wr.lg.yB(b,!1,k,t):(b.d5c(D),null)}tRk(b){return Xh.OutlineReader.QEf(b.currentNode)||va.OutlineElementReader.Bh(b)||va.OutlineElementReader.aL(b)||yh.TableCellReader.isTableCell(b)}Uib(b,k=null,t=!1,D=null){if(!this.tRk(b))return null;const P=Wr.lg.gfb();this.yko(P,b);b.nGb(P,k,1,null);b.Gi(P);t&&(Wr.lg.OI(b,D),ag.OutlineElementNavigator.Vd(b));return P}yko(b,k){if(k=this.c$l(k))switch(k.type){case 11:Wr.lg.fgf(k,b,!0);break;case 8:k=Wr.lf.isRtl(k),Wr.lg.dOb(b,k)}}c$l(b){return this.bdk.d$l(b)}cOb(b,
k){b.setValue(sf.a.Zq,k?11:9)}ofo(b,k){const t=Vr.WordSectionNavigator.instance.wJ(b);return t?Xh.OutlineReader.rX(b)!==k?(t.setValue(Cc.a.Tcf,k),!0):!1:null}static get lf(){return Yg.PageReader.instance}static get lg(){return Wr.nh||(Wr.nh=Fa.a.instance.resolve("Box4.IOutlineElementEditor"))}static set lg(b){Wr.nh=b}}Wr.nh=null;Wr.ve=null;Object(n.a)(Wr,"OutlineEditor",null,[302]);const Mx=b=>{b.ha("Box4.OutlineLevelEditors.OutlineEditor",()=>new Wr(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").singleInstance();
b.ha("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new Ey.a(b.Ue("Box4.IOutlineEditor"),b.Ue("Box4.List.IListEditor"),b.Ue("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"),b.Sa("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IParagraphCollection"))).as("Box4.IOutlineElementEditor").singleInstance()};
class Nx{npj(){return{mpj:!0,JJj:!1}}}Object(n.a)(Nx,"CursorMovementValidator",null,[266]);class eq{get name(){return"Box4.OutlineLevelEditors"}xc(b){b.ha("Box4.ListEditors.CursorMovementValidator",()=>new Nx).as("Box4.List.ICursorMovementValidator").singleInstance();Mx(b)}init(){}dispose(){}static main(){N.a.instance.Fc(new eq)}}Object(n.a)(eq,"Box4OutlineLevelEditorsPackage",null,[1,2]);class Zw{constructor(b){this.tHd=null;this.oRi=b.jb("OfficeOnlineChromeExtensionId");this.wRi=b.jb("ChromeClipboardAccessExtensionId");
this.XEm=b.$("OfficeOnlineChromeExtensionIsEnabled");this.nfh=!this.YMm();this.tHd=this.uOb?this.wRi:this.oRi}C3n(){this.tHd===this.oRi&&this.Xxi&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.tHd=this.wRi;this.nfh=!0}get uOb(){return this.nfh}YMm(){if(this.XEm&&this.Xxi){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get Xxi(){let b=
!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(k){v.ULS.sendTraceTag(19452045,307,50,k.toString())}return b}}Object(n.a)(Zw,"ChromeExtensionHelper",null,[966]);var Yu=c(1430),jw=c(673),Ox=c(1384);class Fy{create(b){return new Ox.a(b)}}Object(n.a)(Fy,"Factory",null,[470]);var Pi=c(139);class $w{constructor(b,
k,t){this.Fmk=b;this.we=k;this.pYa=t}Tb(){this.pYa.fb(Pb.a.v$d,lc.a.application,this.v$d.bind(this),96);this.pYa.qa(Pb.a.pmc,lc.a.view,this.GWo.bind(this));this.pYa.fb(Pb.a.G4i,lc.a.view,this.IWo.bind(this),96)}v$d(b,k,t,D,P){if(1===t)return 32;b=Object.assign(new be.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});k=[];t=Object.assign(new fh.a,{ControlList:[]});t.ControlList.push(Object.assign(new zg.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));
k.push(t);Array.addRange(b.MenuSectionList,k);P.MenuItems=b;return 32}IWo(b,k,t,D,P){if(1===t)return 32;b=dl.a.qvj();null==b&&8;b=this.we.YK(b);P[tn.a.LabelText]=String.format(F.a.Af(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}GWo(b,k,t){b=dl.a.MHb(k);if(1===t||b)return b?8:32;t=new Map;t.set("Source","StyleContextMenuActor");t.set("Action","UpdateStyle");xa.Health.instance.recordKpiUsage(Pi.a.vza,0,Pi.a.qB,t);this.Fmk.Umg(k)?Jc.b(539842578,3018,50,"User Successfully Updated styles from UI"):
(k=new Map,k.set("Source","StyleContextMenuActor"),k.set("Action","UpdateStyle"),k=Object.assign(new Db.a,{extendedProperties:k}),xa.Health.instance.recordKpiFailure(Pi.a.vza,"UpdateStyleFailed",!1,!0,k),Jc.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(n.a)($w,"StyleContextMenuActor",null,[]);var ks=c(1027),xu=c(1499),at=c(441),yu=c(1743);class vv extends yu.a{constructor(b,k,t,D,P,ca,ta=null,Na=null){super(b,ca,ta,Na);this._formatting=
null;this.tKa=!1;this.itb=w.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.tvb=0;this.ABc=new Eb.a;Jc.a(8128527,307,va.OutlineElementReader.Bh(b));this.WL=k;this.WL.k1b(this);this.fq=t;this.Un=D;this.Gd=P;this.V3e=Na;this.aNe=dg.ListItemReader.sh(this.Ec)}get paragraphEditor(){return null!=this.XEg?this.XEg:this.XEg=Fa.a.instance.resolve("Box4.IParagraphEditor")}get kHd(){return null}get k3b(){return this.aNe&&!this.WL.rDa}get ABb(){return 0<this.tvb}tca(b,k){if(!this.$Y.Dkg(this.Ec,
k,!0)){Jc.a(8701077,307,pe.ParagraphReader.uh(this.Ec));var t=this.Ec.currentNode,D=Of.a.fw(t);this.itb&&this._formatting.GQ&&(t=t.pa.last,this.tKa&&(t.formatting=this._formatting.GQ.Ef(t),this.tKa=!1),b=this.$Y.xwf(b,k),this.$Y.zHa(this.Ec.currentNode,this._formatting.zca,k));this.characterPropertiesEditor.replaceTextRange(D,b)}}sca(){Jc.a(8701078,307,pe.ParagraphReader.uh(this.Ec));const b=Of.a.fw(this.Ec.currentNode);this.characterPropertiesEditor.Uga(b,k=>new at.a(k))}imb(){this.$Y.Ewf(this.Ec)}nGa(){this.itb&&
(this.tKa=!0)}tRa(){Jc.a(8701079,307,pe.ParagraphReader.uh(this.Ec))}sRa(){Jc.a(8701080,307,pe.ParagraphReader.uh(this.Ec))}$D(b){this.WL.rDa||(this.itb?(this.L0e(b),this._formatting.ime(this.Ec.currentNode),b&&"P"===b.f9.nVd&&this.V3e.Wca(this.Ec.currentNode,this._formatting.xR),this.$Y.zHa(this.Ec.currentNode,this._formatting.zca,b)):this.FIk(b))}qF(){this.WL.rDa||this.wKc()}yRa(){}B4a(){}uxa(){Jc.a(8701081,307,va.OutlineElementReader.Bh(this.Ec)||Xh.OutlineReader.Zw(this.Ec)||pe.ParagraphReader.uh(this.Ec)&&
this.WL.rDa);let b=!1;this.ABb||(b=this.k3b||!0);b||(this.JU+=1);this.tvb++}sxa(){this.tvb--;let b=!1;this.ABb||(b=this.k3b||!0,this.Un.W9i(this.ABc));b||--this.JU}sGa(b){Jc.a(8701082,307,va.OutlineElementReader.Bh(this.Ec)||Xh.OutlineReader.Zw(this.Ec)||pe.ParagraphReader.uh(this.Ec)&&this.WL.rDa);Jc.a(8701083,307,!!b.listStyleType)}txa(){Jc.a(8701084,307,va.OutlineElementReader.Bh(this.Ec)||pe.ParagraphReader.uh(this.Ec)&&this.WL.rDa);this.WL.rDa||Jc.a(8701085,307,this.Ec.Nr(2))}b9(b){this.WL.b9(b)}Z8(){this.WL.Z8()}I$c(b){this.ABc.add(b)}G4(b){this.WL.G4(b)}a9(){this.WL.a9()}Y8(b){this.WL.Y8(b)}X8(){this.WL.X8()}FIk(b){this.Jdc(!1);
(new ze.GraphIterator).Yc(this.Ec);b=yu.a.lg.OI(this.Ec,this.AOc(b));Jc.a(8128534,307,b===this.Ec.currentNode);Jc.a(8128535,307,pe.ParagraphReader.Wb(b))}wKc(){Jc.a(8128536,307,pe.ParagraphReader.uh(this.Ec));ag.OutlineElementNavigator.Vd(this.Ec)}reset(){this.itb&&(super.reset(),this._formatting=this.$of(!0))}L0e(b){this.Jdc(!1);(new ze.GraphIterator).Yc(this.Ec);b=yu.a.lg.OI(this.Ec,this.AOc(b));Jc.a(36577367,307,b===this.Ec.currentNode);Jc.a(36577368,307,pe.ParagraphReader.Wb(b));-1!==this._formatting.lw&&
this.paragraphEditor.gE(b,this._formatting.lw);this._formatting.lineSpacing&&this.V3e.dD(b,this._formatting.lineSpacing);this._formatting.l5&&this.V3e.Vge(b,this._formatting.l5);this.tKa=!0;this._formatting.paragraph=b}static d$e(b,k){let t=0;switch(k){case 3:t=Ef.a.Dv(b);break;case 7:t=Re.a.Ay(b,0);break;case 1:t=Ef.a.d6e(b);break;case 5:t=Ef.a.Dv(Ef.a.oZf(b));break;default:v.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",
b,k)}return t}}Object(n.a)(vv,"TextOnlyBox4PasteSteward",yu.a,[]);class wv extends vv{constructor(b,k,t,D,P,ca,ta,Na=null,qb=null){super(k,t,D,P,ca,ta,Na,qb);this.Yuc=!1;this.gub=[];this.$hh=b;k={};k.textOnlyPasteFlags=b;v.ULS.sendTraceTag(509088282,307,50,G.c(k))}reset(){super.reset();this.Yuc=!1;this.gub.length=0;this.tld=!1}$D(b){this.Yuc||(super.$D(b),this.Yuc=!0)}qF(){this.tld?this.tld=!1:this.sca(null)}sca(b){this.$hh&2||super.sca(b)}uxa(){}sxa(){}sGa(){}txa(){}b9(){}Z8(){}G4(b){this.Yuc||(super.G4(b),
this.Yuc=!0);this.gub.push(!1)}a9(){this.$hh&1&&this.sca(null);0<this.gub.length?this.gub.pop():Jc.a(509088281,307,!1)}Y8(){var b=this.gub.length-1;0<=b?this.gub[b]?(b=Of.a.fw(this.Ec.currentNode),this.characterPropertiesEditor.replaceTextRange(b,", ")):this.gub[b]=!0:Jc.a(509088280,307,!1);this.tld=!0}X8(){this.tld=!1}I$c(){}}Object(n.a)(wv,"StrictTextOnlyBox4PasteSteward",vv,[]);class ax{constructor(b,k,t,D){this.iMe=b;this.iK=k;this.Gf=t;this.$Y=D}create(b,k,t,D,P=null,ca=null,ta=null,Na=null){return 1===
b?null!==Na&&0!==Na?new wv(Na,k,D,this.iMe,this.iK,this.Gf,P,ca,this.$Y):new vv(k,D,this.iMe,this.iK,this.Gf,P,ca,this.$Y):new xu.Box4PasteSteward(k,t,D,this.iMe,this.iK,this.Gf,P,ca,this.$Y,ta)}}Object(n.a)(ax,"Box4PasteStewardFactory",null,[468]);var Px=c(186),bt=c(334),Ln=c(1557);class Bk{constructor(b,k,t){this.Iy=null;this.uvb=0;this.ML=null;this.Ec=b;this.wk=t}k1b(b){this.Iy=b}get rDa(){return 0<this.uvb}b9(b){var k;Jc.a(7869459,307,!!this.Iy);Jc.a(7869460,307,va.OutlineElementReader.Bh(this.Ec)||
Xh.OutlineReader.Zw(this.Ec));Jc.b(38563978,307,50,"Table pasting started");this.Iy.Jdc(!0);const t=new ze.GraphIterator;t.Yc(this.Ec);let D=Ln.a.jsm[b.styleId];D||(w.AFrameworkApplication.ue("gdea6103;0df65435"),(null===(k=w.AFrameworkApplication.K)||void 0===k?0:k.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))&&b.DBf?(v.ULS.sendTraceTag(509125329,3022,50,"onTableStart: Fixed default table style"),D=Ln.a.zfn):D=Ln.a.lPh);k=this.wk.qRn(this.Ec,b.rowCount,b.Deb,
D,b.tableLook,this.Iy.AOc(b),b.DBf);b.shg&&(Jc.b(573691298,3022,100,"Applying table border properties"),Ln.a.Zsh(b.shg,this.Ec,!1,!0));b.$Vd&&(Jc.b(573691299,3022,100,"Applying indentation properties"),Ln.a.oDk(this.Ec,b.$Vd.spaceBefore,b.$Vd.spaceAfter));b.fEd&&(Jc.b(573691328,3022,100,"Applying column widths"),Ln.a.WCk(b.fEd,this.Ec,Object(Ka.a)(bt.TableNode,k),b.f3a));this.Iy.HAd(t,!1);this.uvb++;dg.ListItemReader.sh(t)&&this.Iy.I$c(t.currentNode);Jc.a(7869461,307,Ih.TableReader.isTable(this.Ec))}Z8(){Jc.a(7869462,
307,!!this.Iy);Jc.a(7869463,307,fn.a.isTableRow(this.Ec));Jc.b(38563979,307,50,"Table pasting finished");this.xU&&this.Ec.At(14)&&Ln.a.Pfj(this.Ec.Nn);ag.OutlineElementNavigator.Vd(this.Ec);this.uvb--}G4(b){Jc.a(7869464,307,!!this.Iy);Jc.b(573691329,3022,100,"Table row pasting started");Ih.TableReader.isTable(this.Ec)?mh.moveToFirstRow(this.Ec):fn.a.isTableRow(this.Ec)&&mh.moveToNextRow(this.Ec);b.height&&(Jc.b(573691330,3022,100,"Applying table row height"),Ln.a.eEk(this.Ec,b.height));Jc.a(7869465,
307,fn.a.isTableRow(this.Ec))}a9(){Jc.a(7869466,307,!!this.Iy);Jc.a(7869467,307,yh.TableCellReader.isTableCell(this.Ec));mh.returnToContainingRow(this.Ec)}Y8(b){Jc.a(7869468,307,!!this.Iy);Jc.a(7869469,307,!this.Iy.JU);fn.a.isTableRow(this.Ec)?mh.moveToFirstColumn(this.Ec):yh.TableCellReader.isTableCell(this.Ec)?mh.moveToNextColumn(this.Ec):Jc.a(7869471,307,!1);if(this.Ec.currentNode){Jc.b(573691331,3022,100,"Table cell pasting started");var k=Object(Ka.a)(Px.TableCellNode,this.Ec.currentNode);Jc.a(50689760,
307,!k&&16!==this.Ec.currentNode.type||!!k&&16===this.Ec.currentNode.type);if(k){var t=new ze.GraphIterator;t.Yc(this.Ec);if(b.ubc)Jc.b(573691332,3022,100,"Processing skipped cell"),Ln.a.oHn(t,b);else{if(1<b.colSpan||1<b.rowSpan){const D=mh.returnToContainingTable(t);if(!D)return;D.setValue(Cc.a.complexTable,!0);t.Yc(this.Ec);Jc.b(573691333,3022,100,"Processing merged cell");Ln.a.HGn(t,b);k.rowSpan=b.rowSpan;k.colSpan=b.colSpan}Ln.a.kEk(this.Ec,b.shadingColor);Ln.a.$Ek(this.Ec,b.verticalAlignment);
Ln.a.KCk(this.Ec,b.xke);Ln.a.Zsh(b.gja,this.Ec,!b.colSpan&&!b.rowSpan,!1);(new ze.GraphIterator).Yc(this.Ec);mh.forEachCell(t,b.rowSpan,b.colSpan,(D,P,ca)=>{Jc.b(573691334,3022,100,"Setting ghost cell borders");Ln.a.nkj(D,b.gja,P,ca,b.rowSpan,b.colSpan)});Ln.a.bFk(this.Ec,b.width,b.f3a);Jc.a(7869472,307,Xh.OutlineReader.Zw(this.Ec))}}}}X8(){Jc.a(7869473,307,!!this.Iy);Jc.a(7869474,307,va.OutlineElementReader.Bh(this.Ec)||yh.TableCellReader.isTableCell(this.Ec));mh.returnToCell(this.Ec);Jc.a(7869475,
307,0>=this.Iy.JU);this.Iy.a7e()}get xU(){null==this.ML&&(w.AFrameworkApplication.ue("he991617;3eed2178"),this.ML=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.ML}}Object(n.a)(Bk,"Box4TableSteward",null,[483,484]);class Mm{constructor(b,k,t){this.Iy=null;this.uvb=0;this.Ec=b;this.wk=t}k1b(b){this.Iy=b}get rDa(){return 0<this.uvb}b9(){this.rDa&&(Jc.a(8787101,307,pe.ParagraphReader.uh(this.Ec)),
ag.OutlineElementNavigator.Vd(this.Ec));Jc.a(8701086,307,!!this.Iy);Jc.a(8701087,307,va.OutlineElementReader.Bh(this.Ec)||Xh.OutlineReader.Zw(this.Ec));this.uvb++}Z8(){Jc.a(8701088,307,!!this.Iy);ag.OutlineElementNavigator.Vd(this.Ec);this.uvb--;if(this.rDa){this.Iy.Jdc(!0);const b=Mm.lg.OI(this.Ec);Jc.a(8787102,307,b===this.Ec.currentNode);Jc.a(8787103,307,pe.ParagraphReader.uh(this.Ec))}}G4(b){Jc.a(8701089,307,!!this.Iy);this.Iy.Jdc(!0);const k=new ze.GraphIterator;k.Yc(this.Ec);this.Iy.HAd(k,!1);
dg.ListItemReader.sh(k)&&this.Iy.I$c(k.currentNode);b=Mm.lg.OI(this.Ec,this.Iy.AOc(b));Jc.a(8701090,307,b===this.Ec.currentNode);Jc.a(8701091,307,pe.ParagraphReader.uh(this.Ec))}a9(){Jc.a(8701120,307,!!this.Iy);Jc.a(8701121,307,pe.ParagraphReader.uh(this.Ec));ag.OutlineElementNavigator.Vd(this.Ec)}Y8(){Jc.a(8701122,307,!!this.Iy);Jc.a(8701123,307,pe.ParagraphReader.uh(this.Ec));Jc.a(8701124,307,!this.Iy.JU);var b=this.Ec.currentNode;pe.ParagraphReader.textLength(b)&&(b=Of.a.fw(b),this.Iy.characterPropertiesEditor.replaceTextRange(b,
", "))}X8(){Jc.a(8701125,307,!!this.Iy);Jc.a(8701126,307,pe.ParagraphReader.uh(this.Ec));Jc.a(8701127,307,0>=this.Iy.JU);this.Iy.a7e()}static get lg(){return null!=Mm.lEg?Mm.lEg:Mm.lEg=Fa.a.instance.resolve("Box4.IOutlineElementEditor")}}Object(n.a)(Mm,"TextOnlyBox4TableSteward",null,[483,484]);class yn{constructor(b,k,t=!1,D=!1){this.iK=b;this.Yz=k;this.Idk=t;this.Qdk=D}create(b,k){return 1===b?new Mm(k,this.iK,this.Yz):new Bk(k,this.iK,this.Yz,this.Idk,this.Qdk)}}Object(n.a)(yn,"Box4TableStewardFactory",
null,[467]);class Jq{create(){return new Vk.a}}Object(n.a)(Jq,"Factory",null,[466]);class zu{constructor(b){this.ga=b}Qcn(b){if(4===b)b=Pb.a.LFa;else if(2===b)b=Pb.a.Cia;else if(1===b)b=Pb.a.sQb;else if(3===b)b=Pb.a.S_a;else return;this.ga.processAction(b,2)}ngb(){this.ga.processAction(Pb.a.ngb,2)}}Object(n.a)(zu,"SelectionCommands",null,[465]);var Xr=c(250),ct=c(1087),iz=c(138),dt=c(632);class cA{constructor(){this.pWc=!1;this.k0o=w.AFrameworkApplication.K.jb("WordEditorVisiFontFileUri");this.m0o=
w.AFrameworkApplication.K.jb("WordEditorVisiRtlFontFileUri");this.l0o=w.AFrameworkApplication.K.jb("WordEditorVisiPilcrowFontFileUri");this.h0o=w.AFrameworkApplication.K.jb("WordEditorVisiCarriageReturnFontFileUri");this.j0o=w.AFrameworkApplication.K.jb("WordEditorVisiCarriageReturnRtlFontFileUri")}EIo(){this.pWc=!this.pWc}DIo(b){this.EIo();let k=b.getElementsByClassName("VisiFontStyle")[0],t=b.getElementsByClassName("VisiFontRtlStyle")[0],D=b.getElementsByClassName("VisiFontPilcrowStyle")[0],P=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],
ca=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];k||(k=document.createElement("Style"),k.className="VisiFontStyle",fc.a.Ey(k,""),b.appendChild(k));t||(t=document.createElement("Style"),t.className="VisiFontRtlStyle",fc.a.Ey(t,""),b.appendChild(t));D||(D=document.createElement("Style"),D.className="VisiFontPilcrowStyle",fc.a.Ey(D,""),b.appendChild(D));P||(P=document.createElement("Style"),P.className="VisiFontCarriageReturnStyle",fc.a.Ey(P,""),b.appendChild(P));ca||(ca=document.createElement("Style"),
ca.className="VisiFontCarriageReturnRtlStyle",fc.a.Ey(ca,""),b.appendChild(ca));if(this.pWc)return v.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),this.jEc(k)&&this.jEc(t)&&this.jEc(D)&&this.jEc(P)&&this.jEc(ca);v.ULS.sendTraceTag(593294046,324,50,"Formatting markers are removed");return this.c4c(k)&&this.c4c(t)&&this.c4c(D)&&this.c4c(P)&&this.c4c(ca)}jEc(b){return""===fc.a.oA(b)?("VisiFontStyle"===b.className?fc.a.Ey(b,this.UNc("WordVisi_MSFontService",this.k0o)):"VisiFontRtlStyle"===
b.className?fc.a.Ey(b,this.UNc("WordVisiRtl_MSFontService",this.m0o)):"VisiFontPilcrowStyle"===b.className?fc.a.Ey(b,this.UNc("WordVisiPilcrow_MSFontService",this.l0o)):"VisiFontCarriageReturnStyle"===b.className?fc.a.Ey(b,this.UNc("WordVisiCarriageReturn_MSFontService",this.h0o)):"VisiFontCarriageReturnRtlStyle"===b.className&&fc.a.Ey(b,this.UNc("WordVisiCarriageReturnRtl_MSFontService",this.j0o)),!0):!1}c4c(b){return""!==fc.a.oA(b)?(fc.a.Ey(b,""),!0):!1}UNc(b,k){return"@font-face { font-family: "+
b+"; src: url('"+k+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(n.a)(cA,"VisiMarkersOperation",null,[463]);var jz=c(445),Kj=c(375);class rq extends jz.a{constructor(b,k){super(b,k);this.RDe=-1;this.gtb=0;this.EAe=null;this.dZg=!1;this.TBe=[];this.omd=!1;this.h7g=!0;this.wLe=this.bkd=null;this.preventDismissOnScroll=this.O$d=this.agc=!1;this.D7=null;this.Hwd=!1;this.FQc=!0;this.Gs=!1;this.s0g=w.AFrameworkApplication.K.$("FloatieLightDismissIsEnabled");rq.Wbh||
(w.AFrameworkApplication.va.qa($a.a.showFloatie,Ud.a.frame,Xc.ActionManager.Of),rq.Wbh=!0)}get Q_h(){return this.aO}set Q_h(b){this.aO=b}get pzj(){return this.Hwd}get QRc(){return this.dZg}set QRc(b){this.dZg=b;this.gtb=0}get RA(){return!0}get cssClass(){return w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.F8?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.Gs}TSa(){for(let b of this.children)if(b.TSa())return!0;return!1}get y9(){return 9}Hf(b){this.TBe[this.TBe.length]=
b;super.Hf(b)}ym(){super.ym();Hf.c(this.Oc)&&this.zC();this.Oc=Va.a.rSa(this.Oc);this.KW(this.Oc);this.dirty=!1}xec(b){3===b.jg||this.O$d||this.Tw(b);return!1}Aec(){return!1}yec(b){3!==b.jg&&this.FQc&&!this.agc&&this.aVo(b);return!1}zec(){return!1}vec(b){3===b.jg&&this.Tw(b);return!1}wec(b){void 0!==this.D7&&null!==this.D7||this.preventDismissOnScroll||this.Tw(b);return!1}ZC(){this.zhf();return!1}b7d(){this.QRc=!0}aVo(b){if(b=Ne.a.J4b(b.clientPoint,this.EAe)){if(this.QRc){if(!this.gtb||b<this.gtb)this.gtb=
b;b-=this.gtb}b-=this.RDe;0>b&&(b=0);const k=255-4*b;0>=k&&63.75<=b?this.Tw():aa.a.setOpacity(this.Oc,Math.max(k/255,0))}else this.QRc=!1,this.gtb=0,aa.a.setOpacity(this.Oc,1)}sTo(b){let k=null;void 0!==this.bkd&&null!==this.bkd&&(k=this.bkd(b));b=null;for(const t of this.TBe){let D=!this.pzj&&t.bCi;if(!D&&void 0!==k&&null!==k)for(let P=0;P<k.length;P++)if(t.id===k[P]){D=!0;break}t.Oc.style.display=D?"none":"";t.G4b=!D;D||(b=t)}b&&(b.G4b=!1)}C8h(){const b=this.Oc.style.top,k=this.Oc.style.left;this.Oc.style.top=
"0px";this.Oc.style.left="0px";const t=this.WDb();this.Oc.style.top=b;this.Oc.style.left=k;return t}WDb(){const b=this.Oc.style.visibility,k=this.Oc.style.display;this.Oc.style.visibility="hidden";this.Oc.style.display="";const t=$d.a.getElementBounds(this.Oc);this.Oc.style.display=k;this.Oc.style.visibility=b;return t}v7i(b){3===b||this.Rle?(Sys.UI.DomElement.addCssClass(this.Oc,Kj.a.XPb),this.Hwd=!0):(Sys.UI.DomElement.removeCssClass(this.Oc,Kj.a.XPb),this.Hwd=!1);this.sTo(b)}H6a(b,k,t,D=!1){this.isVisible||
(this.D7||!this.h7g&&this.preventDismissOnScroll||(this.h7g=!1,$d.a.O3d("ShowLegacyFloatie",""),w.AFrameworkApplication.va.processAction($a.a.showFloatie,2)),this.v7i(t),this.FQc=!0,this.gtb=0,this.QRc=!1,!this.s0g||void 0!==this.D7&&null!==this.D7?(this.omd=!1,this.ifa(this,!1)):(this.omd=!0,this.EIk(this)),k=D?b:this.LCn(b,k),this.Oc.style.top=k.y.toString()+"px",this.Oc.style.left=k.x.toString()+"px",this.fu(),this.EAe=this.WDb(),this.RDe=Ne.a.J4b(b,this.EAe),aa.a.setOpacity(this.Oc,1),this.Oc.style.zIndex=
String(w.AFrameworkApplication.ta.vta),this.Oc.style.display="",this.Gs=!0)}LCn(b,k){const t=this.pzj?30:17,D=this.C8h(),P=fc.a.dFb(),ca=fc.a.CX();b=new Sys.UI.Point(b.x,b.y);1===k?b.y-=D.height:3===k?(b.y-=D.height,b.x-=D.width):2===k&&(b.x-=D.width);b.x+D.width>P&&(b.x=Math.floor(P-D.width));0>b.x&&(b.x=0);b.y=3===k||1===k?b.y-t:b.y+t;0>b.y&&(b.y=0);b.y+D.height>ca&&(b.y=ca-D.height);return b}MCn(b,k){const t=b.XMi;if(t){this.v7i(k);var D=this.C8h();this.D7=b;b=t.mog-t.iMc>D.width;var P=t.iMc+t.Ukf>
D.width,ca=t.m6b>D.height+17,ta=t.XIj-(t.m6b+t.Qkf)>D.height+17;D=new Sys.UI.Point(t.iMc,t.m6b);P||b||(P=!0,D.x=t.mog);b=t.Ckb?t.IIf?ta?P?2:0:P?3:1:ca?P?3:1:P?2:0:t.IIf?ta?b?0:2:b?1:3:ca?b?1:3:b?0:2;if(3===b||2===b)D.x=t.iMc+t.Ukf;if(2===b||0===b)D.y=t.m6b+t.Qkf;this.H6a(D,b,k);this.FQc=!1;k=this.D7.aYe.Oc;void 0!==k&&null!==k&&(k.style.zIndex=String(w.AFrameworkApplication.ta.vta))}}x3(){let b=super.x3();this.Tw()&&(b=!0);return b}Tw(b=null){if(!this.isVisible)return!1;void 0!==this.eDc&&null!==
this.eDc&&this.eDc.Iua(null);void 0!==this.D7&&null!==this.D7&&this.D7.l3();this.l3();this.s0g&&this.omd?this.Ssl(this):this.cba(this,!1);this.omd=!1;this.RDe=-1;this.D7=null;this.Oc.style.display="none";this.Gs=!1;this.wLe&&this.wLe(b);return!0}zhf(){void 0!==this.D7&&null!==this.D7&&(this.D7.LYa=null,this.D7.l3(),this.D7=null,this.g4d.style.zIndex=String(w.AFrameworkApplication.ta.YBa),this.Oc.style.zIndex=String(w.AFrameworkApplication.ta.vta))}VTn(b){this.bkd=b}HUn(b){this.wLe=b}set RA(b){super.RA=
b}}rq.Wbh=!1;Object(n.a)(rq,"Floatie",jz.a,[709,401,402]);class xv{constructor(b,k){this.rv=this.qKa=null;this.oKi=b;this.Rej=k}get S_h(){return this.qKa}Vmo(b){this.qKa=b}WDb(){return this.rv.WDb()}W_(){return this.rv?this.rv.isVisible:!1}bwh(b){this.Vmo(b)}showFloatie(b,k){this.H6a(k.location,k.Gx,k.isRtl)}H6a(b,k,t){t=t?this.Rej:this.oKi;this.kKd();this.rv&&this.rv.H6a(b,t,k)}Tw(){this.rv&&this.rv.Tw()}kKd(){this.qKa&&!this.rv&&(this.rv=Object(Ka.a)(rq,this.qKa()))}$Kd(){}}Object(n.a)(xv,"AFloatieManager",
null,[482]);class bx extends xv{constructor(){super(1,3);this.uxj=!1;this.xQh=""}H6a(b,k,t){t=t?this.Rej:this.oKi;this.kKd();this.rv&&(this.rv.isVisible&&this.rv.Tw(),this.uxj||this.rv.xm(),this.rv.H6a(b,t,k,!0))}kKd(){this.S_h&&!this.rv&&(this.rv=this.qKa())}$Kd(){if(this.rv&&this.rv.isVisible){const b=Object(Ka.a)(Ui.Control,this.rv.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.Uw(b.phb(),1,null)}}wbg(b){this.xQh=b}f0n(b){b=b.Xof("Menu16",null);Qg.a("renderIcon")&&b&&appChrome.api.renderIcon(bx.K_j,
b.firstElementChild)}omc(b,k,t){if(this.rv){const D=this.rv.controls[this.xQh];D&&(bx.P_g||(this.f0n(D),bx.P_g=!0),D.Pd[ka.a.labelText]=b,D.Pd[ka.a.alt]=k,t&&D.behavior.xm())}}}bx.P_g=!1;bx.K_j="Designer_20";Object(n.a)(bx,"PasteFloatieManager",xv,[]);var kw=c(1035);class cx{constructor(){this.Nd=null}get Pw(){return null}getTitle(){return null}c7h(){return null}reset(b){this.Nd=b.node}rIa(b){b=Oi.d(this.Nd,b);let k=null;if(!b||b.Dh!==this.Dh)return{returnValue:!1,RF:k};k=Object.assign(new kw.a,{KG:this.key,
contentObject:b,title:this.getTitle(b),description:this.c7h(b)});return{returnValue:!0,RF:k}}}Object(n.a)(cx,"BlobDetailsProvider",null,[416,417]);class lB extends cx{constructor(){super()}get key(){return"EQUATION"}get Dh(){return 11}get Pw(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(n.a)(lB,"EquationDetailsProvider",cx,[]);class mB{constructor(){this.HYg=null}get key(){return"LINK"}get Pw(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.HYg=re.HyperlinkReader.hOc(b.node)}rIa(b){let k=
null;for(const t of this.HYg)if(t.cpBegin<=b&&b<t.cpEnd)return k=Object.assign(new kw.a,{KG:this.key,contentObject:t.hyperlink}),{returnValue:!0,RF:k};return{returnValue:!1,RF:k}}}Object(n.a)(mB,"HyperlinkDetailsProvider",null,[416,417]);var nr=c(1363),Pj=c(897);class dr{constructor(){this.v2g=!1}get key(){return"IFRAMENODE"}get Pw(){return this.v2g?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}Rlc(b){let k=null;b=b?pe.ParagraphReader.VOa(b.currentNode):null;
if(!b)return{returnValue:!1,nma:k};k=Object.assign(new nr.a,{KG:this.key,contentId:b.id,contentObject:b});return{returnValue:!0,nma:k}}KDb(b,k){b=b?Object(Ka.a)(Pj.a,b.contentObject):null;k=k?Object(Ka.a)(Pj.a,k.contentObject):null;let t="";k&&b.id===k.id||(this.v2g=b.p3a,t=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,b.Pw,this.Pw));return t}}Object(n.a)(dr,"IFrameDetailsProvider",null,[481,417]);class kB extends cx{constructor(){super()}get key(){return"IMAGE"}get Dh(){return 5}reset(b,
k){super.reset(b,k);this.a8j=!hf.SelectionEditor.km(k)}get Pw(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return Be.ImageReader.uX(b.properties)}c7h(b){var k;b=Be.ImageReader.XOa(b.properties);return null!==(k=Wa.App.instance)&&void 0!==k&&k.eHf&&this.a8j?String.format(Box4Intl.Box4Strings.l_ContentSelectedNotificationFormat,b):b}}Object(n.a)(kB,"ImageDetailsProvider",cx,[]);class Zz{get key(){return"IMAGENODE"}get Pw(){return Box4Intl.Box4Strings.l_ImageContentTitle}Rlc(b){let k=
null;if(!b||!Be.ImageReader.gv(b.currentNode))return{returnValue:!1,nma:k};k=Object.assign(new nr.a,{KG:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,nma:k}}KDb(b,k){b=b.contentObject;const t=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let D="";k&&b.id===k.contentObject.id||(D=String.format(t,Be.ImageReader.uX(b.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return D}}Object(n.a)(Zz,"ImageNodeDetailsProvider",null,[481,417]);let Ts,sv;class Lr{constructor(b,
k){this.FTg=null;this.qn=k;this.lOe=b;this.key=Lr.keys.J(b);this.Pw=Lr.q4k.J(b)}reset(b){this.FTg=this.qn.N3(b.node)}rIa(b){var k=Lr.SCl(this.FTg||[],t=>this.yGm(b,t));k=this.w8k(k);return{returnValue:!!k,RF:k}}yGm(b,k){return k.begin<=b&&b<k.end&&(!k.errorDetails||this.lOe===k.errorDetails.proofingType)}w8k(b){return b?Object.assign(new kw.a,{KG:this.key,contentObject:b.errorDetails,description:this.lhb()}):null}lhb(){return w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")?
Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static SCl(b,k){for(const t of b)if(k(t))return t;return null}}Lr.keys=(sv=new Cj.a,sv.add(1,"SPELLINGERROR"),sv.add(2,"GRAMMATICALERROR"),sv.add(3,"ADVANCEDERROR"),sv);Lr.q4k=(Ts=new Cj.a,Ts.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),Ts.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),Ts.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),Ts);Object(n.a)(Lr,"ProofingDetailsProvider",null,[416,417]);
class iC{constructor(){this.tableNode=null;this.dEd=this.see=this.columns=this.rows=0}}Object(n.a)(iC,"TableInfo",null,[]);class $z{get key(){return"TABLE"}get Pw(){return Box4Intl.Box4Strings.l_TableContentTitle}Rlc(b){var k=null;if(!yh.TableCellReader.isTableCell(b))return{returnValue:!1,nma:k};k=new ze.GraphIterator;k.Yc(b);b=new iC;b.see=fn.a.rs(k)+1;b.dEd=Xt.a(k)+1;mh.returnToContainingTable(k);b.tableNode=k.currentNode;b.columns=Ih.TableReader.Yg(b.tableNode);b.rows=Ih.TableReader.eg(b.tableNode);
k=Object.assign(new nr.a,{KG:this.key,contentId:b.tableNode.id,contentObject:b});return{returnValue:!0,nma:k}}KDb(b,k){b=b.contentObject;const t=new Ph.a;k||t.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));k&&k.contentObject.dEd===b.dEd||t.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.dEd));k&&k.contentObject.see===b.see||t.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,b.see));return t.toArray().join(" ")}}
Object(n.a)($z,"TableDetailsProvider",null,[481,417]);class su{constructor(b,k){this.vKa=b;this.qn=k}get JQb(){return null!=this.GIg?this.GIg:this.GIg=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}V3f(){this.vKa.execute(b=>{b.Q4(new mB);this.JQb||(b.Q4(new Lr(1,this.qn)),b.Q4(new Lr(2,this.qn)));b.Q4(new Lr(3,this.qn));b.Q4(new lB);b.Q4(new kB);b.Pgc(new $z);b.Pgc(new Zz);b.Pgc(new dr)})}}Object(n.a)(su,"AccessibilityActor",null,[]);
class xm{constructor(b,k,t){this.qun=(D,P,ca)=>{if(1===ca)return 32;this.eWj().ieg();return 32};this.pYa=b;this.eWj=t}Tb(){this.pYa.fb(Pb.a.NXi,lc.a.view,this.qun,1028)}}Object(n.a)(xm,"AutoCorrectActor",null,[]);var pg=c(1933);class jh{constructor(){this.J3d=!0}qxa(){}D4a(){}k1b(){}bVf(){}oge(){}get Ffc(){return!1}get Dlb(){return 0}get oMi(){return!1}get xT(){return lb.a.nil}}Object(n.a)(jh,"TextOnlyBox4ImageSteward",null,[479]);class Vp{constructor(b,k,t,D,P,ca,ta=!1){this.NO=b;this.taskManager=
k;this.Ug=t;this.Rtm=D;this.notificationBar=P;this.Xb=ca;this.w_m=ta}create(b,k,t,D){return 1===b?new jh:new pg.a(k,this.NO,this.taskManager,this.Ug,this.Xb,this.Rtm,this.notificationBar,this.w_m,t,D)}}Object(n.a)(Vp,"Box4ImageStewardFactory",null,[462]);var qn=c(37);class xo{constructor(b){this.EZd=b}vNm(b){if(!b||!b.vB||1>b.vB.count)return!1;const k=[qn.a.sNh,qn.a.rNh];return!!this.XNd(b.vB,1,t=>this.hFd(t,k))}Ivi(b){return!b||!b.vB||1>b.vB.count?!1:!!this.XNd(b.vB,1,k=>this.hFd(k,[qn.a.pG]))}xKm(b){return!b||
!b.vB||1>b.vB.count?!1:!!this.XNd(b.vB,2,k=>this.hFd(k,[qn.a.kXc]))}uh(b){return!b||!b.vB||1>b.vB.count?!1:!!this.XNd(b.vB,1,k=>this.hFd(k,[qn.a.opa]))}wYd(b){if(!b||!b.vB)return!1;b=b.vB;for(let k=0;k<b.count;++k)if(!b.J(k)||0<b.J(k).QGk)return!1;return!0}Bvl(b,k){return this.Ivi(k)||this.xKm(k)?"":b}XNd(b,k,t){if(b&&0<b.count)for(let D=b.count-1;0<=D;--D){if(t(b.J(D)))return b.J(D);if(b.count-D>=k)break}return null}hFd(b,k){b=b&&b.Qni?b.Qni.split(" "):null;if(!b)return!1;for(const t of k)if(0<=
Array.indexOf(b,t))return!0;return!1}}Object(n.a)(xo,"Box4PasteStewardUtils",null,[460]);var vs=c(719);class Sw{constructor(){this.CFi={};this.sHd=-1}}Object(n.a)(Sw,"LevelLists",null,[]);class tv{constructor(b,k,t){this.W9=this.level=0;this.hYh=null;this.yfc=!1;this.level=b;this.$mc=k;this.tYi=t}}Object(n.a)(tv,"ListItemMetadata",null,[]);class bj{constructor(){this.W9=0;this.tagName="UL";this.VLc=null;this.ignore=!1;this.LZc=0}}Object(n.a)(bj,"ListMetadata",null,[]);class rn{constructor(b){this.nodes=
b;this.t3=0;this.lists={};this.Poa=[];this.occ=null;this.lDa=[];this.lDa[0]=new Sw}}Object(n.a)(rn,"WordConverterArguments",null,[]);var cp=c(1524);class zn{constructor(b=null){this.fpd=1;this.xW=b||cp.a.zvf("")}get Gc(){return this.xW}process(b,k){b&&b.querySelectorAll&&(b=b.querySelectorAll("p"))&&0<b.length&&(b=new vs.a(k,Object(A.a)(this,this.i0f,"processNodesDiscovery"),new rn(b)),b.Al("Word Converter Operation"),b.Ig=!k||k.Ig,b.run())}i0f(b,k){const t=k.nodes[k.t3];var D=zn.jrf(t);if(D){let P=
k.lDa[D.level-1];P||(P=new Sw,k.lDa[D.level-1]=P);k.occ&&zn.cPc(t)!==k.occ&&zn.x3n(k);let ca=P.CFi[D.$mc];if(!ca)ca=new bj,ca.W9=this.fpd++,ca.VLc=zn.Epf(t,5),ca.ignore=!ca.VLc||!ca.VLc.length,ca.tagName=zn.YOd(ca.VLc),P.CFi[D.$mc]=ca,k.lists[ca.W9.toString()]=ca;else if(!ca.ignore&&1===ca.LZc){const ta=zn.Epf(t,5);ca.tagName=ca.VLc===ta?"UL":"OL"}D.W9=ca.W9;ca.ignore||"OL"===ca.tagName&&0<ca.LZc&&P.sHd!==D.W9?(ca.ignore=!0,k.lDa[0].sHd=-1,k.lDa=k.lDa.slice(0,1)):(k.lDa.length>D.level&&(k.lDa=k.lDa.slice(0,
D.level)),P.sHd=D.W9,k.Poa[k.Poa.length]=D,ca.LZc++);k.occ=t}else if((D=k.occ)&&zn.cPc(t)===D&&t.tagName===D.tagName&&t.className===D.className){D.appendChild(D.ownerDocument.createElement("BR"));for(D.appendChild(D.ownerDocument.createElement("BR"));t.firstChild;)D.appendChild(t.firstChild);t.parentNode.removeChild(t)}k.t3++;if(k.nodes.length<=k.t3){if(!k.Poa.length)return!1;k.t3=0;b.gi(Object(A.a)(this,this.h0f,"processNodeConvert"))}return!0}h0f(b,k){var t=k.Poa[k.t3];b=t.tYi;const D=k.lists[t.W9.toString()];
if(!D.ignore&&(t=zn.l4l(b,t,D))){zn.bGc(b,5);const P=b.ownerDocument.createElement("LI");for(;b.firstChild;)P.appendChild(b.firstChild);t.appendChild(P);b.parentNode.removeChild(b);"UL"===D.tagName?this.Gc.b++:this.Gc.c++}k.t3++;return k.t3<k.Poa.length}static l4l(b,k,t){let D=zn.h7i(b,k.level,t);const P=jd.a.Db(D,"UniqueListId");if(P&&P!==k.W9||!P&&D.firstChild)b=b.ownerDocument.createElement(t.tagName),D.parentNode.insertBefore(b,D.nextSibling),D=b;jd.a.ql(D,"UniqueListId",k.W9);return zn.Y9e(D,
t)}static Y9e(b,k){if(k.tagName!==b.tagName){k=b.ownerDocument.createElement(k.tagName);for(jd.a.ql(k,"UniqueListId",jd.a.Db(b,"UniqueListId"));b.firstChild;)k.appendChild(b.firstChild);b.parentNode.insertBefore(k,b);b.parentNode.removeChild(b);b=k}return b}static h7i(b,k,t){let D=null,P;1===k?P=zn.cPc(b):(D=zn.h7i(b,k-1,null),P=D.lastChild);if(P&&1===P.nodeType){const ca=P.tagName.toUpperCase();if("UL"===ca||"OL"===ca)return P}t=b.ownerDocument.createElement(t?t.tagName:"UL");1===k?b.parentNode.insertBefore(t,
b):D.appendChild(t);return t}static bGc(b,k){for(let t=0;t<b.childNodes.length;t++){const D=b.childNodes[t];1===D.nodeType&&1<k&&zn.bGc(D,k-1);if(zn.PCf(D)||zn.hUc(D))b.removeChild(D),t--}}static jrf(b){if(1===b.nodeType){const k=zn.y8b(b,"mso-list");if(k&&0<k.length)try{const t=k.split(" ");if(3===t.length){const D=Number.parseInvariant(t[1].substr(5));return new tv(D,k,b)}}catch(t){}}return null}static YOd(b){return"o"!==b&&"\u00b7"!==b&&"\u00a7"!==b&&"-"!==b?"OL":"UL"}static Epf(b,k){let t=null;
for(let D=0;!t&&D<b.childNodes.length;D++){const P=b.childNodes[D];zn.hUc(P)?(t="string"===typeof P.innerText?P.innerText.trim():P.textContent.trim(),t.length||(t="o")):1===P.nodeType&&1<k&&(t=zn.Epf(P,k-1))}return t}static hUc(b){return 1===b.nodeType&&(b=zn.y8b(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static PCf(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static y8b(b,k){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(k)){b=b.split(";");
for(let t=0;t<b.length;t++){const D=b[t].split(":");if(2===D.length&&D[0].trim()===k)return D[1].trim()}}return null}static cPc(b){do b=b.previousSibling;while(b&&zn.JTc(b));return b}static JTc(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(zn.zIe,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:zn.JTc(b.firstChild):!0}static x3n(b){for(let k=0;k<b.lDa.length;k++){const t=b.lDa[k];t&&(t.sHd=-1)}}}zn.zIe=RegExp("[\n|\r]","gi");Object(n.a)(zn,
"WordConverter",null,[499]);class er{constructor(){this.W9=0;this.Icc=Array(9)}}Object(n.a)(er,"FullListMetadata",null,[]);var uv=c(1560);class Ot{constructor(){this.level=0;this.tagName="UL";this.jlb=null;this.ignore=!1;this.LZc=0;this.listStyle="BulletListStyle1";this.Poa=new uv.a;this.font=this.levelText=""}}Object(n.a)(Ot,"ListLevelMetadata",null,[]);var Tw=c(587);class nk{}nk.Kfl="data-ccp-timestamp";nk.DHd="data-clipservice-ccpid";nk.Nfl="data-shapeids";nk.Vim="docs-internal-guid-";nk.hun="SCXO";
nk.kDn="SCXP";nk.u2o="SCXW";nk.Edn="MsoListParagraphCxSpFirst";nk.Fdn="MsoListParagraphCxSpLast";nk.wcf="data-pkey";nk.xcf="data-clipservice-type";nk.ucf="data-clipservice-count";nk.vcf="data-clipservice-dc";nk.EIc="data-clipservice-client";nk.ycf="data-clipservice-version";Object(n.a)(nk,"HtmlContentMetadataConstants",null,[]);class dx{constructor(){this.y=this.x=0;this.top=this.left=null}}Object(n.a)(dx,"AbsolutePosition",null,[]);var Ri=c(850);class Pt{constructor(b,k,t="",D=0){this.px=!1;this.uYg=
this.vYg=null;let P=!1;Pt.JJm(b)&&(P=!0,this.vYg=b);Pt.aKm(k)&&(this.uYg=k);this.Y4j=t;this.MVj=D;this.px=P&&this.nVd?!0:!1}get isValid(){return this.px}get Tni(){return this.vYg}get nVd(){return this.uYg}get Qni(){return this.Y4j}get QGk(){return this.MVj}static JJm(b){return b?-1===b.indexOf(" ")&&0<b.length:!0}static aKm(b){return b?-1===b.indexOf(" ")&&0<b.length:!1}}Object(n.a)(Pt,"HtmlElementInfo",null,[]);class yr{constructor(b){this.next=null;this.data=b}}Object(n.a)(yr,"StackNode",null,[]);
class Zk{constructor(){this.Oq=null;this.aj=0}get count(){return this.aj}get isEmpty(){return!this.count||!this.Oq}push(b){b=new yr(b);b.next=this.Oq;this.Oq=b;this.aj=this.count+1}IA(){return this.count&&this.Oq?this.Oq.data:null}pop(){if(!this.count||!this.Oq)return null;const b=this.Oq;this.Oq=b.next;this.aj=this.count-1;return b.data}clear(){this.Oq=null;this.aj=0}toArray(){const b=Array(this.count);let k=this.Oq;for(let t=this.count-1;0<=t&&k;t--)b[t]=k.data,k=k.next;return b}}Object(n.a)(Zk,
"Stack",null,[]);class Di{constructor(b){this.dtc=this.Fpd=null;this.Ihd=!1;this.Wi=b}get kHd(){return this.dtc.IA()}reset(){this.Wi.reset();this.Fpd=new Zk;this.dtc=new Zk;this.dtc.push(this.Wi.NIc);this.Ihd=!1}U5d(){this.Ihd=!1}EJ(b){this.Ihd||(this.Fpd.push(null),this.Ihd=!0);this.Fpd.push(b)}onClose(){for(;;){const b=this.Fpd.pop();if(!b)break;b()}}lkj(){return!1}ygn(){this.dv(()=>!0)}dv(b){const k=this.kHd.clone();return b(k)?(this.dtc.push(k),this.Wi.nGa(k),this.EJ(Object(A.a)(this,this.smn,
"onFormattingEnd")),!0):!1}hwf(b){return b.style?this.dv(k=>this.lkj(k,b))?1:2:2}smn(){this.dtc.pop();this.Wi.nGa(this.kHd)}tca(){}N5d(){return 2}$Rf(){return 2}aSf(){return 2}eSf(){return 2}uSf(){return 3}wSf(){}T5d(){return 2}xSf(){}ySf(){}zSf(){return 2}W5d(){return 2}X5d(){return 2}NSf(){return 2}Y5d(){}PSf(){return 2}Z5d(){return 2}$5d(){return 2}c6d(){return 2}d6d(){return 2}aTf(){}bTf(){return 2}k6d(){return 2}l6d(){return 2}o6d(){return 2}p6d(){return 2}r6d(){return 2}s6d(){return 2}u6d(){return 2}w6d(){return 2}CTf(){return 2}D6d(){return 2}JTf(){return 2}LTf(){}MTf(){return 2}G6d(){return 2}H6d(){return 2}I6d(){return 2}J6d(){return 2}K6d(){return 2}L6d(){return 2}TTf(){return 3}M6d(){}ZTf(){return 2}N6d(){return 2}aUf(){return 3}Q6d(){}gUf(){}R6d(){return 2}mUf(){return 3}T6d(){return 2}V6d(){return 2}X6d(){return 2}Y6d(){return 2}yUf(){}CUf(){return 3}$6d(){return 2}onMenuOpen(){return 2}GUf(){}PUf(){return 2}QUf(){return 2}SUf(){return 3}l7d(){return 2}UUf(){return 2}m7d(){return 2}q7d(){return 2}aVf(){}x7d(){return 2}lVf(){return 2}F7d(){return 2}G7d(){return 2}FVf(){return 3}MVf(){return 2}O7d(){return 2}P7d(){return 2}R7d(){return 2}S7d(){return 2}QVf(){return 3}T7d(){return 2}W7d(){return 2}Y7d(){return 2}TVf(){return 2}Q_c(){return 2}WVf(){return 2}XVf(){return 2}a8d(){return 2}YVf(){return 2}aWf(){return 3}f8d(){return 2}g8d(){return 2}h8d(){return 2}i8d(){return 2}l8d(){return 2}static Jga(b){return b&&
-1!==b.indexOf("px")&&(b=parseInt(F.a.substring(b,0,b.indexOf("px"))),!isNaN(b))?b:0}static dei(b){if(!b||""===b)return-1;const k=F.a.Tg(b);if(-1!==k.indexOf("pt")){if(b=parseFloat(F.a.substring(b,0,k.indexOf("pt"))),!isNaN(b))return b}else if(-1!==k.indexOf("px")&&(b=parseFloat(F.a.substring(b,0,k.indexOf("px"))),!isNaN(b)))return 3*b/4;return-1}static Oai(b){b=Di.dei(b);return-1===b?0:b}static ebm(b){return Di.dei(b)}static ydi(b){return b&&""!==b?Di.Jga(b):null}static bE(b){let k=null,t=null,D=
null,P=null;b&&b.qf&&(k=Di.DO(b.qf,"id"),t=Di.DO(b.qf,"lang"),D=b.qf.tagName,b.HCk&&(P=Object.assign(new dx,{x:Di.Jga(b.qf.style.left),y:Di.Jga(b.qf.style.top),left:Di.ydi(b.qf.style.left),top:Di.ydi(b.qf.style.top)})),void 0===k&&(k=""),void 0===t&&(t=""));return new Ri.a(new Pt(k,D),b.vB,null,t,P)}static DO(b,k){return b[k]}}Object(n.a)(Di,"AHtmlTranslator",null,[502]);class By extends Ri.a{constructor(b,k,t,D=0,P=0,ca=null){super(ca?ca.f9:null,ca?ca.vB:null,ca?ca.mpa:null,ca?ca.cultureName:null,
ca?ca.VBa:null);this.width=D;this.height=P}}Object(n.a)(By,"AugmentationSemanticArgs",Ri.a,[]);class Uw{constructor(b,k,t,D,P,ca,ta){this.ccpId=b;this.pKey=k;this.type=t;this.count=D;this.dc=P;this.client=ca;this.version=ta}}Object(n.a)(Uw,"ClipServiceArgs",null,[]);var Zu;(Zu||(Zu={})).Chart="chart";Object(n.b)("ClipServiceDataType",Zu);var ex;(ex||(ex={})).ExcelOnline="XLO";Object(n.b)("ClipServiceClientApp",ex);class fx{constructor(){this.stop=this.color=null}}Object(n.a)(fx,"ColorStopPair",null,
[]);var Bp=c(1939);class Vw{constructor(){this.direction=null;this.zGc=new uv.a}Oli(){return!!this.direction&&0<this.direction.length}}Object(n.a)(Vw,"LinearGradient",null,[]);class Ix{constructor(){this.T$b=!1}}Object(n.a)(Ix,"HtmlTranslatorContext",null,[]);class fz{constructor(b=!1,k=!1,t=!1,D=!1,P=!1,ca=!0,ta=!1,Na=!0,qb=!0,Jb=!0,Vb=!1,ac=!1,yc=!1,Kc=!1,ed=!1,sd=!1,oe=!1,Ld=!1,Od=!1,ie=null,Ce=null,hg=null,Kg=null,Hl=null,wm=null,bp=null,qv=null,eB=null){this.T$b=!1;this.Ndk=b;this.Jdk=k;this.Pdk=
t;this.bik=D;this.$hk=P;this.Vhk=ca;this.Whk=ta;this.Yhk=Na;this.Zhk=qb;this.Xhk=Jb;this.mik=Vb;this.Hik=ac;this.lik=yc;this.bkk=Kc;this.fik=ed;this.b6j=sd;this.Aik=oe;this.Iik=Ld;this.IXj=Od;this.dik=ie;this.kik=Ce;this.aik=Hl;this.iik=hg;this.cik=Kg;this.hik=wm;this.jik=bp;this.eik=qv;this.gik=eB}get Kmb(){return this.Ndk}get u_i(){return this.Jdk}get Azn(){return this.Pdk}get Uoj(){return this.bik}get Toj(){return this.$hk}get Epo(){return this.Vhk}get Fpo(){return this.Whk}get Hpo(){return this.Yhk}get Ipo(){return this.Zhk}get Gpo(){return this.Xhk}get Gob(){return this.fik}get Xym(){return this.b6j}get Bpj(){return this.Aik}get fqj(){return this.Iik}get rSk(){return this.IXj}get Xoj(){return this.mik}get Oro(){return this.Hik}get Rpo(){return this.lik}get Lvj(){return this.bkk}get Voj(){return this.dik||
Object(A.a)(this,this.uhc,"returnFalse")}get Qpo(){return this.kik||Object(A.a)(this,this.uhc,"returnFalse")}get Ppo(){return this.iik||Object(A.a)(this,this.Y7f,"returnTrue")}get Kpo(){return this.cik||Object(A.a)(this,this.Y7f,"returnTrue")}get Jpo(){return this.aik||Object(A.a)(this,this.uhc,"returnFalse")}get Opo(){return this.hik||Object(A.a)(this,this.Y7f,"returnTrue")}get Woj(){return this.jik||Object(A.a)(this,this.uhc,"returnFalse")}get Lpo(){return this.eik||Object(A.a)(this,this.uhc,"returnFalse")}get Npo(){return this.gik||
Object(A.a)(this,this.uhc,"returnFalse")}Y7f(){return!0}uhc(){return!1}}Object(n.a)(fz,"HtmlTranslatorSettings",null,[500]);var Cy=c(1826);class Jx{constructor(b,k){this.spaceBefore=b;this.spaceAfter=k}}Object(n.a)(Jx,"IndentationProperties",null,[]);var es=c(1369);class tu extends Ri.a{constructor(b,k,t,D,P=null,ca=0,ta=null,Na=null,qb=!1,Jb=!1,Vb=69905,ac=null){super(ac?ac.f9:null,ac?ac.vB:null,ac?ac.mpa:null,ac?ac.cultureName:null,ac?ac.VBa:null);this.colSpan=b;this.rowSpan=k;this.width=t;this.ubc=
Jb;this.height=D;this.f3a=qb;this.shadingColor=P;this.verticalAlignment=ca;this.gja=ta;this.xke=Na;this.t7=Vb}}Object(n.a)(tu,"TableCellSemanticArgs",Ri.a,[]);class aA extends Ri.a{constructor(b,k=null){super(k?k.f9:null,k?k.vB:null,k?k.mpa:null,k?k.cultureName:null,k?k.VBa:null);this.height=b}}Object(n.a)(aA,"TableRowSemanticArgs",Ri.a,[]);class gz extends Ri.a{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb=null,Vb=-1,ac=null){super(ac?ac.f9:null,ac?ac.vB:null,ac?ac.mpa:null,ac?ac.cultureName:null,ac?ac.VBa:
null);this.fEd=null;this.rowCount=b;this.Deb=k;this.width=t;if(P)for(this.fEd=Array(P.length),b=0;b<P.length;++b)this.fEd[b]=P[b];this.DBf=ca;this.shg=Na;this.QEm=ta;this.f3a=D;this.$Vd=qb;this.styleId=Jb;this.tableLook=Vb}}Object(n.a)(gz,"TableSemanticArgs",Ri.a,[]);let Wp;class Kk extends Di{get eJm(){if(null!=this.NCg)var b=this.NCg;else{var k;w.AFrameworkApplication.ue("FontFamilyFix;FontFamilyFixCf");b=this.NCg=null===(k=w.AFrameworkApplication.K)||void 0===k?void 0:k.getBooleanFeatureGate("Microsoft.Office.WordOnline.FontFamilyFixIsEnabled",
!1)}return b}constructor(b,k=null,t=null,D=null){super(b);this.Vub=null;this.X9j=ib.a.v5("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Sio=new Set(["DIV","P"]);this.Sd=k||new fz;this._context=t||new Ix;this.KIe=D}get xFi(){return this.X9j}vai(b,k){var t;if((t=b.style?b.style.listStyleType:"")&&
""!==t&&(t=this.xFi[F.a.Tg(t)])||(t=Di.DO(b,"type"))&&""!==t&&(t=this.xFi[t]))return t;if(this.Sd.Kmb&&(t=b.tagName.toLowerCase())&&("ol"===t||"ul"===t)&&(b=b.className)&&""!==b)if("ul"===t)switch(b=Kk.FSd(b,"BulletListStyle"),b){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===t)switch(b=Kk.FSd(b,"NumberListStyle"),b){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;
case "NumberListStyle5":return 11}return k}oai(b){let k=-1,t=b.tagName.toLowerCase();if("ol"===t||"ul"===t){b=fc.a.k8h(b,"li");if(!b)return k;t="li"}if("li"===t){k=(k=this.INd(b,"data-aria-level",0))?k:-1;if(0<k)return k-1;if(b=fc.a.k8h(b,"p"))return Kk.W_l(b)-1}return k}INd(b,k,t){b=this.Sd.Kmb?b.getAttribute(k):Di.DO(b,k);b=parseInt(b);return isNaN(b)||0>b?t:b}eon(){this.Vub.pop();this.Wi.sxa()}kQc(b,k){this.dv(P=>P.Wca(0,0));const t=this.vai(b.qf,k?6:2);let D=1;k&&(D=this.INd(b.qf,"start",1));
k=!1;this.Sd.Kmb&&(k=b.qf.getAttribute("data-pasteFromRc"),(k=!!k&&"true"===k)&&b.qf.removeAttribute("data-pasteFromRc"),(aa.a.f4||aa.a.jj)&&Kk.IDd(b.qf));b=new es.a(t,D,Di.bE(b),0,-1,k,this.Sd.Kmb);this.Vub.push(b);this.Wi.uxa(b);this.EJ(Object(A.a)(this,this.eon,"onListElementClose"));return 1}Mcl(b,k,t){return(k=k.getAttribute(t))?b.gbf(k):!1}reset(){super.reset();this.Vub=new Zk}lkj(b,k){var t;let D=!1;try{var P=k.getAttribute("xml:lang")||Di.DO(k,"lang")}catch(Na){P=null}P&&""!==P&&(D=b.Kag(P)||
D);(P=Di.DO(k,"dir"))&&(D=b.Yic(P)||D);if(this.Sd.Lpo(this._context)&&k.getAttribute)for(P=0;P<Kk.lvj.length;P++)D=this.Mcl(b,k,Kk.lvj[P])||D;if(P=k.style){if(P.fontWeight){var ca=F.a.QA(P.fontWeight),ta=parseInt(ca);isNaN(ta)?"BOLD"===ca?D=b.nL(!0)||D:"NORMAL"===ca&&(D=b.nL(!1)||D):D=600<=ta?b.nL(!0)||D:b.nL(!1)||D}this.Sd.Toj&&P.fontSize&&(ca=Di.ebm(P.fontSize),0<ca&&(D=b.fge(Math.floor(2*ca))||D));(null===(t=w.AFrameworkApplication.K)||void 0===t?0:t.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",
!1))&&this.Sio.has(k.tagName)&&((null===P||void 0===P?0:P.marginTop)||(null===P||void 0===P?0:P.marginBottom))&&(t=Di.Oai(null===P||void 0===P?void 0:P.marginTop),ca=Di.Oai(null===P||void 0===P?void 0:P.marginBottom),D=b.Wca(t,ca)||D);this.Sd.Ppo(this._context)&&(this.Sd.Xoj&&k.getAttribute?(t=k.getAttribute("data-indent"))&&0<t.length&&(t=Re.a.Ni(parseInt(t),0)+"px",D=b.che(t)||D):P.textIndent&&(D=b.che(P.textIndent)||D));this.Sd.Kpo(this._context)&&P.marginLeft&&(this.Sd.Xoj&&k.getAttribute?(t=
k.getAttribute("data-margin"))&&0<t.length&&(D=b.Oia(P.marginLeft)||D):"TABLE"!==k.tagName&&(D=b.Oia(P.marginLeft)||D));if(this.Sd.Npo(this._context)&&(t=k.getAttribute("style"))&&""!==t)for(t=t.split(";"),ca=0;ca<t.length;ca++)ta=t[ca].trim(),ta.startsWith("tab-stops")&&(D=b.Bbg(ta.replace("tab-stops:",""))||D);this.Sd.Jpo(this._context)&&P.lineHeight&&(D=b.dD(P.lineHeight)||D);this.Sd.Gpo&&(t=P.textTransform?F.a.Tg(P.textTransform):null,ca=P.fontVariantCaps?F.a.Tg(P.fontVariantCaps):null,ta=P.fontVariant?
F.a.Tg(P.fontVariant):null,"uppercase"===t?D=b.j7c("uppercase")||D:"small-caps"===ca||ta&&0<=ta.indexOf("small-caps")?D=b.j7c("small-caps")||D:this.Sd.rSk&&"none"===t&&(D=b.j7c("none")||D));this.Sd.Opo(this._context)&&P.textAlign&&(D=b.iOb(F.a.Tg(P.textAlign))||D);P.fontStyle&&(t=F.a.QA(P.fontStyle),"ITALIC"===t||"OBLIQUE"===t?D=b.iob(!0)||D:"NORMAL"===t&&(D=b.iob(!1)||D));t=Kk.Xdm(k);if(P.textDecoration||t)ca=F.a.Tg(P.textDecoration||""),t=F.a.Tg(t||""),k.parentNode&&k.parentNode.tagName&&"a"===
F.a.Tg(k.parentNode.tagName)?(ta=(k.querySelector(".TextRun")||k).className)&&-1<ta.indexOf("Underlined")&&(D=b.e5(!0)||D):P.wlp||Kk.isUnderline(ca)||Kk.isUnderline(t)?D=b.e5(!0)||D:this.Sd.fqj&&(D=b.e5(!1)||D),P.vlp||Kk.Pxi(ca)||Kk.Pxi(t)?D=b.Ria(!0)||D:this.Sd.fqj&&(D=b.Ria(!1)||D);if(P.verticalAlign){t=F.a.QA(P.verticalAlign);ca=this.UNn(t);if("SUB"===t||this.Sd.Woj(this._context)&&k.className&&-1<k.className.indexOf("Subscript")||0>ca&&this.Sd.Bpj)D=b.BHa(!0)||D;else if("SUPER"===t||this.Sd.Woj(this._context)&&
k.className&&-1<k.className.indexOf("Superscript")||0<ca&&this.Sd.Bpj)D=b.iqa(!0)||D;this.Sd.Toj&&("SUB"===t||"SUPER"===t)&&k.getAttribute&&(t=parseFloat(k.getAttribute("data-fontsize")),isNaN(t)||(D=b.fge(Math.floor(2*t))||D))}t=!1;w.AFrameworkApplication.K&&(t=w.AFrameworkApplication.K.$("CopyAndPasteFontTelemetryIsEnabled"));this.Sd.Ipo&&P.fontFamily&&(this.Sd.Rpo&&k.getAttribute?(ca=k.getAttribute("data-usefontface"))&&"true"===ca&&(t&&v.ULS.sendTraceTag(524038490,307,50,"Customized fontface"),
D=this.jkj(b,P.fontFamily,D)):D=this.jkj(b,P.fontFamily,D));ca=null;this.Sd.Hpo&&P.color&&(ca=Bp.a.pua(P.color));ta=!!ca;this.Sd.Qpo(this._context)&&k.getAttribute&&(ca=k.getAttribute("data-scheme-color"),ca=null!==ca?ca:"",ta=""!==ca||!this._context.T$b||Kk.YRm(k));ta&&(D=b.Mv(ca)||D);this.Sd.Epo&&P.backgroundColor&&(k.tagName&&Kk.WEo.contains(F.a.QA(k.tagName))||(D=b.zya(Bp.a.pua(P.backgroundColor))||D));if(this.Sd.Fpo&&P.backgroundImage&&k.className&&-1<k.className.indexOf("Highlight")&&(P=Kk.Ngm(P.backgroundImage))&&
0<P.zGc.count){ca=P.zGc.J(0).color;ta=!0;for(let Na=0;Na<P.zGc.count&&(ta=ta&&ca===P.zGc.J(Na).color,ta);Na++);ta&&(t&&v.ULS.sendTraceTag(524038491,307,50,"Paste text with highlight"),D=b.zya(Bp.a.pua(ca))||D)}}this.Sd.Voj(this._context)&&k.getAttribute&&(P=k.getAttribute("data-ccp-props"))&&(D=b.zHa(P)||D);k.getAttribute&&((P=k.getAttribute("data-ccp-charstyle"))&&this.Sd.Gob&&(D=b.Nfe(P)||D),(k=k.getAttribute("data-ccp-parastyle"))&&this.Sd.Gob&&(D=b.Oge(k)||D));return D}Nro(b){if(this.Sd.Oro)for(b=
b.parentNode;b&&b.tagName;){if(b.className&&Object.getType(b.className)===String&&-1<F.a.QA(b.className).indexOf("MSOCOM"))return!0;if("DIV"===F.a.QA(b.tagName))break;b=b.parentNode}return!1}jkj(b,k,t){if(this.eJm){k=Kk.mKl(k);let P=!1;if(!k)return t;for(var D of k)if(P=b.USa(D,this.Sd.Lvj))break;return P||t}D=Kk.G8h(k);return b.USa(D,this.Sd.Lvj)||t}UNn(b){let k=0;b&&b.length&&(b=parseInt(b),isNaN(b)||(k=b));return k}tca(b,k){"\u200b"===b&&(b="\u00a0");k&&k.qf&&this.Nro(k.qf)&&(b="");this.Wi.tca(b,
Di.bE(k))}N5d(b){const k=Di.DO(b.qf,"href");return k&&""!==k?(this.Wi.tRa(k,Di.bE(b)),this.EJ(Object(A.a)(this.Wi,this.Wi.sRa,"onAnchorEnd")),1):2}T5d(){return this.dv(b=>b.nL(!0))?1:2}W5d(){return this.dv(b=>b.bwf())?1:2}X5d(b){this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,"onParagraphEnd"));return 1}Y5d(b){this.Wi.sca(Di.bE(b))}Z5d(b){this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,"onParagraphEnd"));return 1}c6d(){return this.dv(b=>b.iob(!0))?1:2}$5d(b){this.dv(k=>k.iOb("center"));
this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,"onParagraphEnd"));return 1}d6d(){return this.dv(b=>b.USa("consolas"))?1:2}l6d(){return this.dv(b=>b.Ria(!0))?1:2}k6d(b){return this.kQc(b,!1)}o6d(){return this.dv(b=>b.iob(!0))?1:2}p6d(b){return this.kQc(b,!1)}r6d(b){var k=b.qf.getAttribute("data-render-src");const t=b.qf.getAttribute("data-render-method");if(k&&""!==k&&t&&""!==t){const ta=b.qf.getAttribute("data-render-fallback");let Na=0,qb=0;if(b.qf.currentStyle){var D=b.qf.currentStyle.width,
P=b.qf.currentStyle.height;D&&-1!==D.indexOf("px")&&(D=parseInt(F.a.substring(D,0,D.indexOf("px"))),isNaN(D)||(Na=D));P&&-1!==P.indexOf("px")&&(P=parseInt(F.a.substring(P,0,P.indexOf("px"))),isNaN(P)||(qb=P))}b=new By(k,t,ta,Na,qb,Di.bE(b));this.Wi.D4a(b);return 2}this.Sd.Kmb&&(aa.a.f4||aa.a.jj)&&(k=b.qf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")),this.Sd.Kmb&&k&&k.length&&Kk.IDd(b.qf));const ca=b.qf.getAttribute("align");this.dv(ta=>ta.iOb(ca));this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,
"onParagraphEnd"));return 1}s6d(b){this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,"onParagraphEnd"));return 1}u6d(b){this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,"onParagraphEnd"));return 1}w6d(){return this.dv(b=>b.iob(!0))?1:2}D6d(b){return this.dv(k=>{var t=Kk.G8h(b.qf.getAttribute("face"));t=k.USa(t);k=k.Mv(Bp.a.pua(b.qf.getAttribute("color")));return t||k})?1:2}G6d(b){this.dv(k=>this.Sd.Gob?k.job(1):k.lob(1));this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,
"onParagraphEnd"));return 1}H6d(b){this.dv(k=>this.Sd.Gob?k.job(2):k.lob(2));this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,"onParagraphEnd"));return 1}I6d(b){this.dv(k=>this.Sd.Gob?k.job(3):k.lob(3));this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,"onParagraphEnd"));return 1}J6d(b){this.dv(k=>this.Sd.Gob?k.job(4):k.lob(4));this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,"onParagraphEnd"));return 1}K6d(b){this.dv(k=>this.Sd.Gob?k.job(5):k.lob(5));this.Wi.$D(Di.bE(b));
this.EJ(Object(A.a)(this.Wi,this.Wi.qF,"onParagraphEnd"));return 1}L6d(b){this.dv(k=>this.Sd.Gob?k.job(6):k.lob(6));this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,"onParagraphEnd"));return 1}M6d(b){this.Wi.sca(Di.bE(b))}Q6d(b){var k=b.qf;const t=k.src,D=k.alt,P=k.ugp,ca=k.getAttribute("data-external-content-url");let ta=0,Na=0;k.style&&(ta=Di.Jga(k.style.width),Na=Di.Jga(k.style.height));ta&&Na||(ta=k.width,Na=k.height);let qb=0,Jb=0;b.qf.currentStyle&&(ta||Na||(ta=Di.Jga(b.qf.currentStyle.width),
Na=Di.Jga(b.qf.currentStyle.height)),qb=Di.Jga(b.qf.currentStyle.maxWidth),Jb=Di.Jga(b.qf.currentStyle.maxHeight));let Vb=null;const ac=k.getAttribute(nk.DHd);if(ac&&(v.ULS.sendTraceTag(524038492,307,50,"Chart paste from xlo"),w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("ChartsPasteFromXLOIsEnabled"))){const yc=k.getAttribute(nk.wcf),Kc=k.getAttribute(nk.xcf),ed=k.getAttribute(nk.ucf),sd=k.getAttribute(nk.vcf),oe=k.getAttribute(nk.EIc);k=k.getAttribute(nk.ycf);yc&&sd&&(Vb=new Uw(ac,yc,
Kc,ed,sd,oe,k))}b=new Cy.a(t,D,ta,Na,Di.bE(b),qb,Jb,P,null,ca,Vb);this.Wi.qxa(b)}N6d(){return this.dv(b=>b.iob(!0))?1:2}R6d(){return this.dv(b=>b.e5(!0))?1:2}T6d(){return this.dv(b=>b.USa("consolas"))?1:2}V6d(b){this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,"onParagraphEnd"));return 1}X6d(b){this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,"onParagraphEnd"));return 1}Y6d(b){let k;const t=this.vai(b.qf,0);let D=this.INd(b.qf,"value",0);var P=!1;0<this.Vub.count?k=this.Vub.IA():
(k=new es.a(2,1,Di.bE(b)),D||(D=1));var ca=Kk.h0l(b.qf,es.a.qCj);3!==ca&&(k.Sr=ca);if(this.Sd.Kmb){P=k.listLevel;ca=k.listId;this.Sd.Uoj?(P=this.oai(b.qf),P=0>P&&0>k.listLevel&&0<this.Vub.count?k.listLevel=this.Vub.count-1:k.listLevel=0<=P?P:k.listLevel,this.KIe&&this.KIe.b<P&&(this.KIe.b=P)):0>P&&(P=k.listLevel=this.oai(b.qf));1>ca&&(ca=k.listId=this.INd(b.qf,es.a.vXc,0));b.qf.getAttribute(es.a.U0d)&&(k.levelText=b.qf.getAttribute(es.a.U0d));var ta=b.qf.getAttribute(es.a.tJf);ta&&(k.font=ta);ta=
!1;w.AFrameworkApplication.K&&(ta=w.AFrameworkApplication.K.$("FollowDestinationThemePasteIsEnabled"));if(ta){var Na=b.qf.getAttribute("data-charcodes");ta=[];if(Na&&""!==Na)if(-1<Na.indexOf(",")){Na=Na.split(",");for(var qb=0;qb<Na.length;qb++)ta.push(parseInt(Na[qb]))}else ta.push(parseInt(Na));if(ta&&0<ta.length){Na=Array(ta.length);for(qb=0;qb<ta.length;qb++)Na[qb]=ta[qb];k.q6e=Na}(ta=b.qf.getAttribute("data-buAutoNum"))&&0<ta.length&&(k.buAutoNum=parseInt(ta))}(P=0<=P&&0<ca)&&Kk.IDd(b.qf)}k.IDk(t,
D,P);k.sJf=this.J_l(b.qf);this.Wi.sGa(k.clone());this.EJ(Object(A.a)(this.Wi,this.Wi.txa,"onListItemEnd"));return 1}J_l(b){var k=b.getAttribute(es.a.gFi);if(!k)return null;b=void 0;try{b=JSON.parse(k)}catch{v.ULS.sendTraceTag(524038493,307,15,"getListDefnPropsFromElement for CCP - Cannot parse list definition properties from element attribute.")}if(!b)return null;k=new th.DictionaryPropertySet;for(const t in b)k.Umj(+t,b[t]);return k}onMenuOpen(b){return this.kQc(b,!1)}$6d(b){if(this.dv(k=>k.Mic(!0))){const k=
b.qf.getAttribute("OuterHtml");this.Wi.yRa(k,Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.B4a,"onMathEnd"))}return 1}l7d(b){return this.kQc(b,!0)}m7d(b){this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,"onParagraphEnd"));return 1}q7d(b){const k=b.qf.getAttribute("align");this.dv(t=>t.iOb(k));if(this.Sd.Kmb){const t=b.qf.parentNode;t&&t.tagName.toLowerCase().startsWith("li")&&Kk.IDd(b.qf,aa.a.f4||aa.a.jj)}this.Wi.$D(Di.bE(b));this.EJ(Object(A.a)(this.Wi,this.Wi.qF,"onParagraphEnd"));return 1}x7d(){this.dv(b=>
b.USa("consolas"));this.Wi.dmb();this.EJ(Object(A.a)(this.Wi,this.Wi.cmb,"onPreFormattedTextEnd"));return 1}F7d(){return this.dv(b=>b.Ria(!0))?1:2}G7d(){return this.dv(b=>b.USa("consolas"))?1:2}O7d(){return this.dv(b=>b.Keg())?1:2}P7d(b){var k=b.qf.attributes.getNamedItem("style"),t="";k&&k.value&&(t=k.value);k=Bp.a.Qyn(t);if(0<k&&this.Sd.Xym){for(t=0;t<k;t++)this.Wi.imb(Di.bE(b));return 3}return 2}R7d(){return this.dv(b=>b.Ria(!0))?1:2}S7d(){return this.dv(b=>b.nL(!0))?1:2}T7d(){return this.dv(b=>
b.BHa(!0))?1:2}W7d(){return this.dv(b=>b.iqa(!0))?1:2}Y7d(b){this.dv(Vb=>Vb.clearFormatting()&&Vb.k7f());Bp.a.lUd(b.qf,this);const k=Bp.a.Sii(b.qf),t=Bp.a.H4h(b.qf),D=Bp.a.gJ(b.qf),P=Bp.a.VK(b.qf),ca=!parseInt(Di.DO(b.qf,"border")),ta=Bp.a.zRm(b.qf);let Na=-1,qb="";var Jb=-1;b.qf.attributes.hasOwnProperty("style")&&-1!==(Jb=b.qf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?Na=parseInt(b.qf.attributes.getNamedItem("style").value.substr(Jb+17)):b.qf.attributes.hasOwnProperty(Tw.a.EHd.toString())&&
(Na=parseInt(b.qf.attributes.getNamedItem(Tw.a.EHd.toString()).value));Jb=-1;b.qf.attributes.hasOwnProperty("class")&&-1!==(Jb=b.qf.attributes.getNamedItem("class").value.indexOf("Mso"))?qb=b.qf.attributes.getNamedItem("class").value.substr(Jb).split(" ")[0]:b.qf.attributes.hasOwnProperty(Tw.a.FIc.toString())&&(qb=b.qf.attributes.getNamedItem(Tw.a.FIc.toString()).value);this.Wi.b9(new gz(0,0,k.value,k.aAi,null,ca,ta,t,new Jx(D.value,P.value),qb,Na,Di.bE(b)));this.EJ(Object(A.a)(this.Wi,this.Wi.Z8,
"onTableEnd"));w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");return 1}Q_c(b){const k=Bp.a.t9h(b.qf),t=Bp.a.Sii(b.qf);if(!t.value&&t.zYd&&(w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Sd.u_i))return 3;let D=parseInt(Di.DO(b.qf,"colSpan"));if(void 0===D||null===D||""===D+"")D=t.value?1:0;let P=parseInt(Di.DO(b.qf,"rowSpan"));if(void 0===P||null===P||""===P+"")P=k.value?
1:0;let ca=!1;b.qf.attributes.hasOwnProperty("style")&&(ca=-1!==b.qf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==b.qf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!ca&&b.qf.attributes.hasOwnProperty("class")&&(ca=-1!==b.qf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let ta=69905;if(b.qf.attributes.hasOwnProperty(Tw.a.tcf.toString())){var Na=parseInt(b.qf.attributes.getNamedItem(Tw.a.tcf.toString()).value);
isNaN(Na)||(ta=Na)}Na=Bp.a.pua(b.qf.style.backgroundColor);const qb=Bp.a.Qgm(b.qf);this.dv(ac=>ac.Wca(0,0));Bp.a.lUd(b.qf,this);const Jb=Bp.a.H4h(b.qf),Vb=this.Sd.Azn?Bp.a.GNl(b.qf):null;b=new tu(D,P,t.value,k.value,Na,qb,Jb,Vb,t.aAi,ca,ta,Di.bE(b));this.Wi.Y8(b);this.EJ(Object(A.a)(this.Wi,this.Wi.X8,"onTableCellEnd"));this.ygn();return 1}a8d(b){const k=this.Q_c(b);if(3===k)return k;this.dv(t=>{const D=t.nL(!0);t=t.iOb("center");return D||t});Bp.a.lUd(b.qf,this);return 1}f8d(b){Bp.a.lUd(b.qf,this);
const k=Bp.a.t9h(b.qf);if(k.zYd&&!k.value&&(w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Sd.u_i))return 3;this.Wi.G4(new aA(k.value,Di.bE(b)));this.EJ(Object(A.a)(this.Wi,this.Wi.a9,"onTableRowEnd"));return 1}g8d(){return this.dv(b=>b.USa("consolas"))?1:2}h8d(){return this.dv(b=>b.e5(!0))?1:2}i8d(b){return this.kQc(b,!1)}l8d(){return this.dv(b=>b.e5(!0))?1:2}static ETl(b){return b?b.split(",")[0]:null}static lKl(b){return b?b.split(","):
null}static EAj(b){if(!b)return null;b=F.a.v5f(b.trim(),'"');return b=F.a.v5f(b,"'")}static G8h(b){if(!b)return null;b=Kk.ETl(b);return b=Kk.EAj(b)}static mKl(b){var k;if(!b)return null;b=null===(k=Kk.lKl(b))||void 0===k?void 0:k.map(t=>Kk.EAj(t));k=null===b||void 0===b?void 0:b.filter(t=>!!t);return null!==k&&void 0!==k?k:null}static Noh(b,k){k=k.trim();var t=k.match(RegExp("^-?[0-9]+deg$"));if(t&&0<t.length){if(b.Oli())return!1;b.direction=k;return!0}if((t=k.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&
0<t.length){if(b.Oli())return!1;b.direction=k;return!0}var D=(t=k.match(RegExp("^rgb\\(.*\\)")))&&0<t.length?k.indexOf(")")+1:k.indexOf(" ");t=-1===D?k:Bp.a.pua(k.substr(0,D).trim());if(!t||""===t)return!1;k=-1===D?"":k.substr(D).trim();D=new fx;D.color=t;D.stop=k;b.zGc.add(D);return!0}static Ngm(b){try{if(!b)return null;b=b.trim();if(!b.startsWith("linear-gradient(")||!b.endsWith(")"))return null;let k=b.substr(16);k=k.substr(0,k.lastIndexOf(")"));const t=new Vw;for(;0<k.trim().length;){let D=k.indexOf(",");
const P=k.indexOf("(");if(0<P&&P<D){const ca=k.indexOf(")");if(ca<P)return null;D=k.indexOf(",",ca)}if(-1===D){if(!Kk.Noh(t,k))return null;k=""}else{const ca=k.substr(0,D);k=k.substr(D+1);if(!Kk.Noh(t,ca))return null}}return t}catch(k){return null}}static FSd(b,k){b=b.split(" ");if(0<b.length)for(let t=0;t<b.length;t++)if(0<=b[t].indexOf(k))return b[t];return""}static IDd(b,k=!1){b&&3!==b.nodeType&&(b.style.margin="",k&&Kk.EDh(b,k))}static EDh(b,k){if(b)for(b=b.firstChild;b;)3!==b.nodeType&&(b.style&&
(b.style.margin=""),k&&Kk.EDh(b,k)),b=b.nextSibling}static W_l(b){if("p"!==b.tagName.toLowerCase())return-1;if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf("mso-list")){b=b.split(";");for(let t=0;t<b.length;t++){var k=b[t].split(":");if(2===k.length&&"mso-list"===k[0].trim()&&(k=k[1].trim().split(" "),3===k.length))return Number.parseInvariant(k[1].substr(5))}}return-1}static h0l(b,k){if(!b)return 3;switch(b.getAttribute(k)){case "default":return 0;case "numbered":return 1;case "bullet":return 2;
default:return 3}}static YRm(b){return!(void 0===b.className||null===b.className)&&b.className.startsWith("TextRun")}static Xdm(b){b=b.style.textDecorationLine;return void 0===b||null===b?null:b}static Pxi(b){return 0<=b.indexOf("line-through")}static isUnderline(b){return 0<=b.indexOf("underline")}}Kk.WEo=(Wp=new Eb.a,Wp.add("TABLE"),Wp.add("THEAD"),Wp.add("TBODY"),Wp.add("TFOOT"),Wp.add("TR"),Wp.add("TH"),Wp.add("TD"),Wp);Kk.lvj=["data-ccp-charstyle-defn","data-ccp-parastyle-defn","data-ccp-charstyle-linked-defn",
"data-ccp-parastyle-linked-defn"];Object(n.a)(Kk,"DefaultHtmlTranslator",Di,[]);class jl{constructor(b=null){this.xW=b||cp.a.zvf("");this.fpd=Number.parseInvariant((new Date).format("HHmmss"))}get Gc(){return this.xW}process(b,k){if(b&&b.querySelectorAll){const ca=b.querySelectorAll("p");if(ca&&0<ca.length){for(var t=0,D=!1,P=ca[0].parentNode;5>t&&P&&P!==b;){t++;const ta=P.id.toLowerCase();if(ta&&ta.length&&-1!==ta.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(P,"WACEditing")&&Sys.UI.DomElement.containsCssClass(P,
"EditingSurfaceBody")){D=!0;break}P=P.parentNode}if(D&&P!==b){t=b.firstChild;for(D=!1;0<P.children.length&&P.children[0]!==t;)b.insertBefore(P.children[0],t),D=!0;if(D)for(;t;)P=t.nextSibling,b.removeChild(t),t=P}b=new vs.a(k,Object(A.a)(this,this.i0f,"processNodesDiscovery"),new rn(ca));b.Al("Word Converter Operation");b.Ig=!k||k.Ig;b.run()}}}i0f(b,k){const t=k.nodes[k.t3];var D=jl.jrf(t);if(D){let ca=D.$mc.replace(RegExp("level[0-9]"),"").trim();ca=ca&&ca.length?ca:D.$mc;let ta=k.lists[ca];ta||
(ta=new er,ta.W9=this.fpd++);let Na=ta.Icc[D.level-1];Na||(Na=new Ot,Na.level=D.level);var P=t.parentNode;if(P&&"li"===P.tagName.toLowerCase()){if(P=P.parentNode)!(P=P.tagName.toUpperCase())||"OL"!==P&&"UL"!==P||(Na.tagName=P)}else Na.jlb=jl.X7h(t,5),Na.jlb&&Na.jlb.length||(Na.jlb=jl.iuf(t,5)),Na.ignore=!Na.jlb||!Na.jlb.length,Na.tagName=jl.YOd(Na.jlb),"UL"===Na.tagName&&(Na.font=this.J8h(t,5));D.W9=ta.W9;Na.LZc++;Na.ignore||"li"===t.parentNode.tagName.toLowerCase()||(P=(P=jl.iuf(t,5))?P:Na.jlb)&&
P.length&&(D.hYh=P,(P=jl.nio(t,P,Na.listStyle,D.level-1))&&P.length&&(Na.listStyle=P));k.Poa[k.Poa.length]=D;Na.Poa.contains(D)||Na.Poa.add(D);if(void 0===ta.Icc[D.level-1]||null===ta.Icc[D.level-1]||ta.Icc[D.level-1]!==Na)ta.Icc[D.level-1]=Na;k.lists[ca]&&k.lists[ca]===ta||(k.lists[ca]=ta);k.occ=t}else if((D=k.occ)&&jl.cPc(t)===D&&t.tagName===D.tagName&&t.className===D.className){D.appendChild(D.ownerDocument.createElement("BR"));for(D.appendChild(D.ownerDocument.createElement("BR"));t.firstChild;)D.appendChild(t.firstChild);
t.parentNode.removeChild(t)}k.t3++;if(k.nodes.length<=k.t3){if(!k.Poa.length)return!1;k.t3=0;b.gi(Object(A.a)(this,this.h0f,"processNodeConvert"))}return!0}h0f(b,k){b=k.Poa[k.t3];var t=b.tYi,D=b.$mc.replace(RegExp("level[0-9]"),"").trim();D=D&&D.length?D:b.$mc;D=k.lists[D];var P=D.Icc[b.level-1],ca=t.parentNode.tagName.toLowerCase();if(!P.ignore&&t.parentNode&&"li"!==ca){if(ca=jl.J$k(t,P)){jl.bGc(t,5);const ta=t.ownerDocument.createElement("LI");ta.setAttribute("data-aria-level",String.format("{0}",
b.level));ta.setAttribute(es.a.vXc,String.format("{0}",D.W9));"UL"===P.tagName&&(ta.setAttribute(es.a.U0d,String.format("{0}",b.hYh)),ta.setAttribute(es.a.tJf,String.format("{0}",P.font)));for(;t.firstChild;)ta.appendChild(t.firstChild);ca.appendChild(ta);t.parentNode.removeChild(t);"UL"===P.tagName?this.Gc.b++:this.Gc.c++}}else"li"===ca&&(P=P.tagName,t=t.parentNode,b.yfc&&(b=t.parentNode)&&b.tagName.toUpperCase()===P&&b.setAttribute("data-pasteFromRc","true"),t.setAttribute(es.a.vXc,String.format("{0}",
D.W9)),"UL"===P?this.Gc.b++:this.Gc.c++);k.t3++;return k.t3<k.Poa.length}J8h(b,k){let t=null;for(let D=0;!t&&D<b.childNodes.length;D++){const P=b.childNodes[D];t=jl.SVl(P);!t&&1===P.nodeType&&1<k&&(t=this.J8h(P,k-1))}return t}static J$k(b,k){b=jl.H$k(b,k.tagName);return jl.Y9e(b,k)}static Y9e(b,k){if(k.tagName!==b.tagName){for(k=b.ownerDocument.createElement(k.tagName);b.firstChild;)k.appendChild(b.firstChild);b.parentNode.insertBefore(k,b);b.parentNode.removeChild(b);b=k}return b}static H$k(b,k){k=
b.ownerDocument.createElement(k?k:"UL");var t=b.getAttribute("start");t&&0<t.length&&(k.setAttribute("start",t),b.removeAttribute("start"));(t=b.className)&&0<t.length&&(t="OL"===k.tagName?Kk.FSd(t,"NumberListStyle"):Kk.FSd(t,"BulletListStyle"),0<t.length&&(Sys.UI.DomElement.addCssClass(k,t),Sys.UI.DomElement.removeCssClass(b,t)));b.parentNode.insertBefore(k,b);return k}static bGc(b,k){for(let t=0;t<b.childNodes.length;t++){const D=b.childNodes[t];1===D.nodeType&&1<k&&jl.bGc(D,k-1);if(jl.PCf(D)||
jl.hUc(D))b.removeChild(D),t--}}static jrf(b){if(1===b.nodeType){var k=jl.y8b(b,"mso-list");if(k&&0<k.length)try{var t=k.split(" ");if(3===t.length){const D=Number.parseInvariant(t[1].substr(5)),P=new tv(D,k,b);P.yfc=!0;return P}}catch(D){}else if((t=b.parentNode)&&"li"===t.tagName.toLocaleLowerCase()&&(k=t.getAttribute("data-"+df.a.UAd),t=t.getAttribute(es.a.vXc),k&&t&&0<k.length&&0<t.length))return b=new tv(Number.parseInvariant(k),t+" level"+k,b),b.yfc=!1,b}return null}static nio(b,k,t,D){if("p"===
b.tagName.toLowerCase()&&k&&k.length){if("UL"===jl.YOd(k))return t=jl.XMl(k),Sys.UI.DomElement.addCssClass(b,t),t;var P=k.match(RegExp("^[0-9]+"));return P&&P.length?(t="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,t),b.setAttribute("start",P[0]),t):(P=k.match(RegExp("^[a-zA-Z]+")))&&P.length&&(P=P[0],D=(k=P.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&k.length?jl.N9l(t,D):1,1!==D&&((t=jl.JFd(b,P,RegExp("^[ivxlcdm]+"),F.a.zIh,"NumberListStyle3"))||(t=jl.JFd(b,P,RegExp("^[IVXLCDM]+"),F.a.zIh,"NumberListStyle5")))||
D&&((t=jl.JFd(b,P,RegExp("^[a-z]+"),F.a.xIh,"NumberListStyle2"))||(t=jl.JFd(b,P,RegExp("^[A-Z]+"),F.a.xIh,"NumberListStyle4"))))?t:"NumberListStyle1"}return null}static XMl(b){switch(b){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static N9l(b,k){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(k%3){case 0:b=0;break;
case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static JFd(b,k,t,D,P){return(k=k.match(t))&&k.length?(D=D(k[0]),D=1>D?1:D,Sys.UI.DomElement.addCssClass(b,P),b.setAttribute("start",D+""),P):null}static YOd(b){return jl.YEm(b)?"UL":"OL"}static YEm(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static iuf(b,k){let t=null;var D;let P,ca;for(let ta=-1;!t&&ta<b.childNodes.length;ta++){const Na=-1===ta?b:b.childNodes[ta];
if(Na)if((D=Na.innerHTML)&&0<D.length){if(P=D.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=P&&(ca=D.indexOf("\x3c!--[endif]--\x3e"),0<=ca)){D=D.substring(P,ca+14);Na.innerHTML=Na.innerHTML.replace(D,"");if(D.length){b=b.ownerDocument.createElement("span");b.innerHTML=D;t=b.innerText.trim();break}t&&t.length||(t="o")}}else 0<=ta&&1===Na.nodeType&&1<k&&(t=jl.iuf(Na,k-1))}return t}static SVl(b){let k=null;1===b.nodeType&&((k=jl.I8h(b,"font-family"))||(k=jl.I8h(b,"mso-ascii-font-family")));return k}static I8h(b,
k){return(b=jl.y8b(b,k))&&0<b.length?b.trim():null}static X7h(b,k){let t=null;for(let D=0;!t&&D<b.childNodes.length;D++){const P=b.childNodes[D];jl.hUc(P)?(t="string"===typeof P.innerText?P.innerText.trim():P.textContent.trim(),t.length||(t="o"),P.parentNode.removeChild(P)):1===P.nodeType&&1<k&&(t=jl.X7h(P,k-1))}return t}static hUc(b){return 1===b.nodeType&&(b=jl.y8b(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static PCf(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static y8b(b,
k){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(k)){b=b.split(";");for(let t=0;t<b.length;t++){const D=b[t].split(":");if(2===D.length&&D[0].trim()===k)return D[1].trim()}}return null}static cPc(b){do b=b.previousSibling;while(b&&jl.JTc(b));return b}static JTc(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(jl.zIe,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:jl.JTc(b.firstChild):!0}}jl.zIe=RegExp("[\n|\r]","gi");Object(n.a)(jl,
"WacAndRichClientWordConverter",null,[499]);class Dy{constructor(b){this.t_=b.$("ExternalPasteImprovementsEnabled")&&b.$("ListMarkerIsEnabled")}create(b=null){return this.t_?new jl(b):new zn(b)}}Object(n.a)(Dy,"Box4WordConverterFactory",null,[461]);var Qt=c(1746);class Up{constructor(b,k,t,D,P){this.yTg=0;this.M0o=ca=>{let ta=!0;const Na=this.Hea.rul;null!=Na?(ca.kpa=Na,ta=!1):Date.now()-this.yTg>this.Vue&&(v.ULS.sendTraceTag(18354843,307,50,null),this.qd.Yb(Pe.a.Xma,{["Reason"]:He.a.jYi}),ta=ca.kpa=
!1);return ta};this.qd=b;this.Se=k;this.Vue=P;this.Hea=t;this.mMa=D}tVk(b,k,t){v.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",k,t,this.Se.bG);b.Ig&&this.Se.zq&&window.chrome&&v.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",k);this.Hea.LKc(!!(k&16));this.mMa.create(b,this.M0o,null).Al("ClipboardPreProcess");this.yTg=Date.now()}l4n(){this.Hea.reset()}}Object(n.a)(Up,"ClipboardOperationClipboardAccessHelper",
null,[459]);var or=c(339);class dA{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed,sd){this.pWa=null;this.ga=b;this.qd=k;this.Pz=t;this.nh=D;this.ib=P;this.Hea=ca;this.eb=ta;this.Ie=Na;this.Jn=qb;this.Wc=Jb;this.vbb=Vb;this.$Oe=ac;this.zE=yc;this.hk=ed;this.nVb=Kc?Kc.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.tmd=Kc?Kc.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.ld=sd;this.$h=Ag.a.getInstance(or.a.AZa)}get lg(){return this.nh}get Ic(){return this.qd}get ATc(){if(null==this.pWa)if(this.ld)if(this.ld.Mp.isCompleted)this.pWa=
this.ld.isFeatureEnabled(3);else return!1;else this.pWa=!1;return this.pWa}F0o(b){b.iN();return!0}bJh(b,k){b=k.ux;v.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&256){let D=!1,P;aa.a.CFa&&w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");this.ATc&&k.je&&k.je.rh&&(D=this.hk.Snh(k.je.rh.editingElement));P=this.hk.Hwf(k.je.rh.editingElement,!1);var t=k.je.rh.editingElement;this.hk.cBf(t,!1,1);this.nVb&&aa.a.CFa?(t=k.je.rh.editingElement,this.hk.z6f(t,
"data-src","data-srcurl"),b=this.Hea.copy(),this.hk.z6f(t,"data-srcurl","data-src")):this.tmd&&k.je&&k.je.rh?(t=this.hk.h6e(k.je.rh.editingElement,k.je.lB,!0),b=this.Hea.copy(),t&&this.hk.h6e(k.je.rh.editingElement,k.je.lB,!1)):(this.hk.N$i(k.je.rh.editingElement),b=this.Hea.copy());this.ATc&&D&&this.hk.mZn(k.je.rh.editingElement);P&&this.hk.Hwf(k.je.rh.editingElement,!0);t=k.je.rh.editingElement;this.hk.cBf(t,!1,0);if(!b)return v.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),b=new Map,
b.set("ErrorLevel","info"),this.$h.logKpiFailure({kpiName:or.a.PCd,errorName:"SystemClipboardCopyFailed",optionalProperties:{additionalValues:{extendedProperties:b}}}),this.Ic.Yb(Pe.a.ICb,{["Reason"]:He.a.ohg}),k.tR&&k.tR.fail("SystemClipboard did not copy",!1),k.failed=!0,!1}return!0}l$e(b,k){const t=k.je;v.ULS.shipAssertTag(18130961,307,!!(k.ux&16));k.Jwo?this.Pz.NDh():this.Pz.$Fd(t,b);return!0}RPh(b,k){var t=k.context,D=k.vd;const P=k.x9;var ca=!1;b=this.ib.hb.kb.Qc;if(this.eb.lm(b)||this.Ie.Fk(b)){const ta=
this.Wc.Uf(b.node),Na=ta.yd();v.ULS.shipAssertTag(18130962,307,Na);this.Jn.Vd(ta);this.vbb.Hjb(ta)&&(ca=!0)}D=k.ux&64?new th.DictionaryPropertySet:D||new th.DictionaryPropertySet;D.setValue(vd.a.GJc,!1);t=this.ga.Nf(t,Pb.a.zH,2,!0,P,D);8===t&&(v.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Ic.Yb(Pe.a.Xma,{["Reason"]:He.a.QPh}),k.tR&&k.tR.fail("DeleteKey failed",!1),this.$h.logKpiFailure({kpiName:or.a.V5e,errorName:"DeleteForCutFailed"}),k.failed=!0);32===t&&this.$h.logKpiSuccess({kpiName:or.a.V5e});
32===t&&ca&&(k=this.ib.hb.kb,this.Ie.km(k)&&k.Qa.node===b.node&&!this.eb.textLength(k.Qa.node)&&(k=this.Wc.Uf(k.Qa.node),b=this.Ie.ku(k),v.ULS.shipAssertTag(18130964,307,b),this.Jn.Vd(k),this.vbb.nYd(k)||(b=this.$Oe.create(),b.Yc(k),this.Jn.p0(b,!1,!1),ca=this.Jn.Ge(b),this.eb.Wb(ca)&&(this.Jn.Vd(b),this.lg.merge(b,k,!1,!1),this.ib.setSelection(this.zE.te(ca,this.eb.textLength(ca)))))));return!0}}Object(n.a)(dA,"ClipboardOperationCutCopy",null,[477]);class jC{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,
Vb,ac,yc,Kc,ed,sd){this.ga=b;this.qd=k;this.Pz=t;this.Hea=ca;this.ib=P;this.nh=D;this.eb=ta;this.Ie=Na;this.Jn=qb;this.Wc=Jb;this.vbb=Vb;this.$Oe=ac;this.zE=yc;this.Ma=Kc;this.hk=ed;this.ld=sd}create(){return new dA(this.ga,this.qd,this.Pz,this.nh,this.ib,this.Hea,this.eb,this.Ie,this.Jn,this.Wc,this.vbb,this.$Oe,this.zE,this.Ma,this.hk,this.ld)}}Object(n.a)(jC,"Factory",null,[458]);var vl=c(1669);class Pg{constructor(b,k){this.Qfd=null;this.h6k=(t,D)=>{if(!Object(ob.a)(138,D.vd))return!1;const P=
Object(Ka.a)(138,D.vd);if(!P.hasProperty(vd.a.Gvf))return!1;const ca=P.getValue(vd.a.Gvf),ta=D.je,Na=ta.mb;this.Pz.EHj();Na.pNb(()=>{Na.setSelection(ca,void 0,!0);this.Pz.$Fd(ta,t)},!0);return!0};this.Pz=b;this.U5=k;this.nI=0}process(b,k){this.nI||(this.Qfd=[this.h6k,Object(A.a)(this.U5,this.U5.tzn,"pasteGlossaryPlaceholder")]);let t=!0;this.nI<this.Qfd.length&&(t=this.Qfd[this.nI++](b,k));return t?this.nI<this.Qfd.length:!1}}Object(n.a)(Pg,"ClipboardOperationContentControlShowPlaceholderProcessor",
null,[488]);class tt{constructor(b){this.jsb=null;this.M1=b;this.nI=-1}process(b,k){-1===this.nI&&(this.wfl(b,k),this.nI=0);let t=!1;this.nI<this.jsb.length&&(t=this.jsb[this.nI++](b,k));return t?this.nI<this.jsb.length:!1}wfl(b,k){aa.a.h4||k.ux&512?(this.jsb=[Object(A.a)(this.M1,this.M1.l$e,"copyInternal")],v.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.Ig&&k.ux&256?(this.jsb=[Object(A.a)(this.M1,this.M1.F0o,"waitBeforeCopy"),Object(A.a)(this.M1,
this.M1.bJh,"copyExternal"),Object(A.a)(this.M1,this.M1.l$e,"copyInternal")],v.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.jsb=[Object(A.a)(this.M1,this.M1.bJh,"copyExternal"),Object(A.a)(this.M1,this.M1.l$e,"copyInternal")],v.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));k.ux&32&&(b=Object(A.a)(this.M1,this.M1.RPh,"deleteForCut"),
this.jsb.push(b),v.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));or.a.n0m(k)}}Object(n.a)(tt,"ClipboardOperationCutCopyProcessor",null,[487]);class ip{constructor(b,k,t,D){this.Sod=null;this.k6k=(P,ca)=>{ca=ca.je;this.Pz.tYo();this.Pz.$Fd(ca,P);return!0};this.ZYc=(P,ca)=>{ca=new Eg.Selection([ca.vd],!0);this.ib.setSelection(ca,P);return!0};this.Pz=b;this.ib=k;this.M1=t;this.U5=D;this.nI=0}process(b,k){this.nI||(this.Sod=[this.k6k,
Object(A.a)(this.M1,this.M1.RPh,"deleteForCut"),this.ZYc,Object(A.a)(this.U5,this.U5.y_i,"pasteInternal"),Object(A.a)(this.U5,this.U5.$lj,"setSelectionAfterPaste")]);let t=!0;this.nI<this.Sod.length&&(t=this.Sod[this.nI++](b,k));return t?this.nI<this.Sod.length:!1}}Object(n.a)(ip,"ClipboardOperationMoveProcessor",null,[486]);var Fm=c(1668);class gx{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed,sd,oe,Ld){this.Pz=b;this.ga=k;this.Gpc=t;this.qd=D;this.Ie=P;this.Se=ca;this.Hc=ta;this.jfd=Na;this.fYj=
qb;this.TSb=Jb;this.ive=Vb;this.tpc=ac;this.mMa=yc;this.xD=Kc;this.Ud=ed;this.Jm=sd;this.CZ=oe;this.Jea=Ld}create(b,k,t,D,P,ca,ta,Na,qb=!0){const Jb=this.jfd.create(D,Object(Ka.a)(138,Na));var Vb=this.fYj.create();const ac=new Pg(this.Pz,Jb),yc=new ip(this.Pz,af.a.instance,Vb,Jb);Vb=new tt(Vb);D=new Fm.a(w.AFrameworkApplication.K,Yu.a.instance,D,Hi.a.instance,Jb,this.TSb);return new vl.a(b,k,t,P,ca,ta,Na,this.Gpc,this.ga,this.qd,this.Ie,this.Se,this.Hc,ac,yc,Vb,D,this.TSb,this.ive,this.tpc,this.mMa,
this.xD,this.Ud,this.Jm,this.CZ,this.Jea,w.AFrameworkApplication.Gdg(),qb)}}Object(n.a)(gx,"Factory",null,[456]);var vo=c(257);class lw{constructor(b,k){this.kFb=b.kqf(k);this.v$e=b.VQl(k);this.oAb=b.Vnf(k);this.Rdb=b.snf(k)}static eF(b){return lw.Jr(b)}static Jr(b){return new lw(dt.a.instance,b)}}Object(n.a)(lw,"CpUsageHelper",null,[]);class $u{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac){this.ML=null;this.J2=!1;this.qd=b;this.Pz=k;this.yyc=t;this.nta=D;this.ib=P;this.ga=ca;this.TCe=ta;this.IVe=qb;
this.YMe=Na;this.xye=Jb;this.gve=Vb;this.Ud=ac;this.$h=Ag.a.getInstance(or.a.AZa);this.J2=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis")}get Ug(){return this.IVe.value}get Tqa(){return this.nta}get Ic(){return this.qd}get NRa(){return this.YMe.NRa}paste(b,k){const t=this.Ud.kZa();try{const D=k.je,P=k.ux;this.xU&&(this.ib&&this.ib.hb&&this.ib.hb.kb&&vo.TableBorderSelectionCache.Ymo(this.ib.hb.kb.kw||this.ib.hb.kb.SHb),Ln.a.Tko(this.ib));v.ULS.shipAssertTag(18131010,
307,!!(P&1));Object(ob.a)(138,k.vd)&&k.vd.setValue(ke.a.Wfa,D.rh.editingElement.clientWidth);this.gve.pNo(b,k);let ca;if(!({xFd:ca}=this.TCe.value.jBj()).returnValue)return this.RXc(k,"HTML import strategy failed",!1),this.J2?this.$h.logKpiFailure({kpiName:or.a.iNa,errorName:"HtmlImportStrategyFailed",optionalVeto:{name:or.a.Jmb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):xa.Health.instance.recordQosError("HtmlImportStrategyFailed",[or.a.Jmb],!1,!0,!0,!1,null),!1;this.Ug.kF();
let ta=!0,Na=null;const qb=this.xye.create(ca),Jb=k.BHj;if(!D||!D.mb)return this.RXc(k,"Fail to set selection.",!1),this.J2?this.$h.logKpiFailure({kpiName:or.a.iNa,errorName:"SetSelectionFailed",optionalVeto:{name:or.a.Jmb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):xa.Health.instance.recordQosError("SetSelectionFailed",[or.a.Jmb],!1,!0,!0,!1,null),!1;D.mb.pNb(()=>{Jb&&2===this.ga.processAction(Pb.a.Bma,2)?ta=!1:(Na=Jb?this.ib&&this.ib.hb&&this.ib.hb.kb?this.ib.hb.kb.Qa:
null:k.vd)?(v.ULS.shipAssertTag(18158338,307,hf.SelectionEditor.gf(Na)),this.cJi(Na,"paste")):v.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Jb)},this.YMe.pzi);if(!ta)return this.RXc(k,"fail to deleteForReplace.",!0),!1;if(!Na)return this.RXc(k,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Na.node||!Na.node.isConnected)return this.RXc(k,"node is null or not connected in ip context.",!0),!1;D.editingView.disable(!0,25);qb.restore();this.yyc.nzn(ca,Na,
b);return!0}finally{t&&t.dispose()}}RXc(b,k,t){b.failed=!0;b.tR&&b.tR.fail(k,t)}tzn(b,k){const t=Object(Ka.a)(138,k.vd).getValue(vd.a.Fji);v.ULS.shipAssertTag(20492440,307,hf.SelectionEditor.gf(t));if(!this.TCh(t,k))return!1;this.Ug.kF();k=(new tk.a).Mc(15);k.Cb(this.Pz.kja);this.yyc.usi(t,b);this.Pz.NDh();k.dispose();return!0}y_i(b,k){const t=this.ib.hb.kb.Qa;if(!this.TCh(t,k))return!1;this.Ug.kF();this.ga.processAction(Pb.a.Bma,2);this.cJi(t,"intPaste");this.yyc.usi(t,b);return!0}TCh(b,k){if(w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.$("AbortClipboardOperationForInvalidIpContext")){if(!b||!b.isValid)return v.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!k&&k.YVc),k.tR&&(k.tR.fail("Invalid ipContext before InternalPasteAtIp",!0),k.failed=!0),k=new Map,k.set("ErrorLevel","warning"),this.$h.logKpiFailure({kpiName:or.a.iNa,errorName:"InvalidIpContextBeforeInternalPasteAtIp",optionalProperties:{additionalValues:{extendedProperties:k}}}),!1;if(!hf.SelectionEditor.gf(b))return v.ULS.sendTraceTag(587843167,
307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",!!k&&k.YVc,b.contextId,!!b.node,!!b.node&&!!b.node.anchor),b=new Map,b.set("ErrorLevel","warning"),this.$h.logKpiFailure({kpiName:or.a.iNa,errorName:"InternalPasteIPContextIsNotInsertionPoint",optionalProperties:{additionalValues:{extendedProperties:b}}}),k.tR&&(k.tR.fail("ipContext is not insertion point in InternalPasteAtIp",!0),k.failed=!0),!1}return!0}cJi(b,k){k=lw.eF(k);
this.Tqa.UOn(k,b.node,b.cpBegin);this.Tqa.p0m(k.v$e);this.Tqa.sKf(k.kFb);this.Tqa.gKf(k.oAb);this.Tqa.cKf(k.Rdb)}$lj(b,k){if(!k.BHj)return!1;k.ux&64&&this.Pz.DHj();if(!k.n0a)return v.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Ic.Yb(Pe.a.n1,{["Reason"]:He.a.djb}),k.tR&&k.tR.fail("No selection after paste",!1),k.failed=!0,!1;this.YMe.LXo(k);this.Ug.kF();return!1}get xU(){null==this.ML&&(w.AFrameworkApplication.ue("he991617;3eed2178"),this.ML=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",
!1):!1);return this.ML}}Object(n.a)($u,"ClipboardOperationPaste",null,[476]);class YC{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){this.qd=b;this.Pz=k;this.yyc=t;this.nta=D;this.ib=P;this.ga=ca;this.IVe=Na;this.Odk=ta;this.xye=qb;this.gve=Jb;this.Ud=Vb}create(b,k){k=this.Odk.create(this.ib,k);return new $u(this.qd,this.Pz,this.yyc,this.nta,this.ib,this.ga,b,k,this.IVe,this.xye,this.gve,this.Ud)}}Object(n.a)(YC,"Factory",null,[457]);var Gy=c(1600);class yv{constructor(b,k){this.UBo=b;this.myn=k}}Object(n.a)(yv,
"ParagraphFormatStore",null,[]);class hx{constructor(b,k,t){this.ib=b;this.eb=k;this.we=t}pNo(b,k){if(k.Tac){k=b.kpa;var t=this.ib.hb.kb.Qa.node,D=null;this.eb.Wb(t)&&(D=this.we.Lo(t),t=this.eb.l1a(t),D=new yv(D,t));k=new Gy.a(k.context,k.ux,k.tR,k.x9,k.vd,D);b.kpa=k}}}Object(n.a)(hx,"ClipboardOperationPasteOvertypeStrategy",null,[455]);class ut{constructor(b){this.LIe=null;this.ib=b;b.pNb(k=>{this.LIe=k},!1)}get pzi(){return!1}LXo(b){b=this.O_e(b);this.setSelection(this.ib,b)}O_e(b){let k=b.n0a;
(b.kUa||b.Iia)&&b.vje&&(k=Gf.SelectionFactory.jA(b.vje,k.Qa));return k}setSelection(b,k){b.setSelection(k)}}Object(n.a)(ut,"AClipboardOperationPasteStrategy",null,[489]);class wj extends ut{constructor(b){super(b)}get NRa(){return this.LIe}}Object(n.a)(wj,"ClipboardOperationPasteToLiveSelectionStrategy",ut,[]);class Qx extends ut{constructor(b,k){super(b);this.NWe=null;this.$$j=k;b.pNb(t=>{this.NWe=t},!0)}get pzi(){return!0}get NRa(){return this.NWe}O_e(b){let k=super.O_e(b);b.vd.setValue(vd.a.C_i,
k);return k=this.$$j.Yai(this.LIe.kb,this.NWe.kb,k)}}Object(n.a)(Qx,"ClipboardOperationPasteToVirtualSelectionStrategy",ut,[]);class eA{constructor(b){this.MWe=b.$("EnableVirtualSelectionInSelectionManager")}create(b,k){return k&&k.ia(vd.a.kUa,!1)&&this.MWe?new Qx(b,this.e0o):new wj(b)}get e0o(){return null!=this.XIg?this.XIg:this.XIg=Fa.a.instance.Na("Box4.Actors.IVirtualSelectionMerger")}}Object(n.a)(eA,"ClipboardOperationPasteStrategyFactory",null,[454]);class kC{constructor(b,k,t,D){this.Ic=b;
this.mb=k;this.un=t;this.Vf=D}dEn(b){(b&1||b&32)&&this.un.Yo&&this.mb.H_b()}uFm(b,k){return b&1&&this.Vf.i_(k,!0)?(this.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.VE}),!1):!0}}Object(n.a)(kC,"ClipboardOperationWordStrategy",null,[]);class Yr{constructor(){}I5k(b,k){if(k)if(k=k.sheet)if(k=k.cssRules){var t=Array.clone(k);t.reverse();var D=k=0,P=0,ca=0;for(const Na of t){t=Na.style;var ta=Na.selectorText;t=t?t.cssText:null;ta=ta?ta.split(","):null;if(t&&ta&&Na.type===Na.STYLE_RULE){ca+=ta.length;for(const qb of ta){0<=
qb.indexOf("#")&&k++;0<=qb.indexOf(".")&&D++;0>qb.indexOf("#")&&0>qb.indexOf(".")&&P++;ta=null;try{ta=b.querySelectorAll(qb)}catch(Jb){v.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",qb,Jb.message)}if(ta)for(let Jb=0;Jb<ta.length;Jb++)ta[Jb].setAttribute("style",t+(ta[Jb].getAttribute("style")||""))}}}v.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",ca,k,D,P)}else this.JJi();
else this.JJi()}JJi(){v.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",aa.a.bG)}}Object(n.a)(Yr,"ExternalPasteCssConverter",null,[452]);class nB{constructor(b){this.t3=0;this.kEh=null;this.node=b}}Object(n.a)(nB,"ChartConverterArguments",null,[]);class oB{constructor(b=null){this._imgNodesConverted=0;this.xW=b||cp.a.V4h("")}get Gc(){return this.xW}process(b,k){b&&(this._imgNodesConverted=0,b.querySelectorAll&&
(b=b.querySelectorAll("div"),1===b.length&&(b=new vs.a(k,this.Bxl.bind(this),new nB(b[0])),b.Al("Chart Converter Operation"),b.Ig=!k||k.Ig,b.run())))}Bxl(b,k){var t=k.node;if(1<k.t3)return!1;if(1===t.nodeType&&"DIV"===t.tagName){const D=t.getAttribute(nk.DHd);if(D){const P=t.getAttribute(nk.wcf),ca=t.getAttribute(nk.xcf),ta=t.getAttribute(nk.ucf),Na=t.getAttribute(nk.vcf),qb=t.getAttribute(nk.EIc);t=t.getAttribute(nk.ycf);P&&Na&&ca&&"chart"===ca&&qb&&"XLO"===qb&&(k.kEh=new Uw(D,P,ca,ta,Na,qb,t))}}b.gi(this.pcn.bind(this));
return!0}pcn(b,k){var t=k.node;if(b=k.kEh)1===t.childElementCount&&1===t.firstChild.nodeType&&"IMG"===t.firstChild.tagName?(t=t.firstChild,t.setAttribute(nk.DHd,b.ccpId),t.setAttribute(nk.wcf,b.pKey),t.setAttribute(nk.xcf,b.type),t.setAttribute(nk.vcf,b.dc),t.setAttribute(nk.EIc,b.client),b.version&&t.setAttribute(nk.ycf,b.version),b.count&&t.setAttribute(nk.ucf,b.count),this._imgNodesConverted++):v.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.xW._imgNodesConverted=this._imgNodesConverted;
k.t3++;return!1}}Object(n.a)(oB,"ChartConverter",null,[]);class lC{constructor(b,k=null,t=null){this.pf=b;this.xW=k||cp.a.Bfi("");this.Bkk=t||cp.a.Cfi("")}get Gc(){return this.xW}get Ohg(){return this.Bkk}b9(b){this.Ohg.b++;this.pf.b9(b)}Z8(){this.pf.Z8()}G4(b){this.Ohg.c++;this.pf.G4(b)}a9(){this.pf.a9()}Y8(b){this.Ohg.d++;this.pf.Y8(b)}X8(){this.pf.X8()}reset(){this.pf.reset()}get NIc(){return this.pf.NIc}tca(b,k){this.Gc.b++;this.pf.tca(b,k)}sca(b){this.Gc.c++;this.pf.sca(b)}imb(b){this.Gc.b++;
this.pf.imb(b)}qxa(b){this.Gc.d++;this.pf.qxa(b)}nGa(b){this.Gc.f++;this.pf.nGa(b)}tRa(b,k){this.Gc.g++;this.pf.tRa(b,k)}sRa(){this.pf.sRa()}$D(b){this.Gc.h++;this.pf.$D(b)}qF(){this.pf.qF()}dmb(){this.pf.dmb()}cmb(){this.pf.cmb()}yRa(b,k){this.Gc.i++;this.pf.yRa(b,k)}B4a(){this.pf.B4a()}uxa(b){this.Gc.j++;this.pf.uxa(b)}sxa(){this.pf.sxa()}sGa(b){this.Gc.k++;this.pf.sGa(b)}txa(){this.pf.txa()}D4a(b){this.Gc.l++;this.pf.D4a(b)}}Object(n.a)(lC,"SemanticEventUsageCollector",null,[494,484]);class mC{constructor(b,
k=null,t=null,D=null){this.LYj="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");this.pf=b;this.xW=k||cp.a.E9h(aa.a.Jzb,"");this.Pu=t;this.vik=D?D.$("ParseStyleForHtmlTagEventIsEnabled"):!1;this.wik=D?D.$("ParseStyleForUncommonHtmlTagEventIsEnabled"):!1;this.cPg=new Ji.a(Ja.a.ei());for(const P of this.LYj)this.cPg.add(P)}get Gc(){return this.xW}get Hl(){return this.Pu}Gh(b){return b?b+1:1}reset(){this.pf.reset()}U5d(){this.pf.U5d()}hwf(b){if(b&&
this.Hl&&(b.getAttribute&&(b.getAttribute(nk.Kfl)&&(this.Hl.x1h=!0),b.getAttribute(nk.DHd)&&(this.Hl.GGl=!0),b.getAttribute(nk.EIc)&&(this.Hl.u7e=b.getAttribute(nk.EIc)),b.getAttribute(nk.Nfl)&&(this.Hl.y1h=!0)),b.id&&b.id.startsWith&&b.id.startsWith(nk.Vim)&&(this.Hl.z1h=!0),b.className&&b.className.split))for(const k of b.className.split(" ")){k.startsWith(nk.hun)&&(this.Hl.D1h=!0);k.startsWith(nk.kDn)&&(this.Hl.E1h=!0);k.startsWith(nk.u2o)&&(this.Hl.F1h=!0);if(k.startsWith(aa.a.f4e)&&k.length===
aa.a.f4e.length+1){const t=parseInt(F.a.substring(k,k.length-1,k.length));isNaN(t)||(this.Hl.zHc=t)}if(k===nk.Edn||k===nk.Fdn)this.Hl.qMc=!0}return this.pf.hwf(b)}onClose(){this.pf.onClose()}QMm(b){for(const k of b)if("\n"!==k)return!0;return!1}tca(b,k){this.Hl&&(this.Hl.IGl=!0);this.Hl&&!this.Hl.Olf&&b&&(this.Hl.Olf=this.QMm(b));this.Gc.d=this.Gh(this.Gc.d);this.pf.tca(b,k)}N5d(b){this.Hl&&(this.Hl.B1h=!0);this.Gc.e=this.Gh(this.Gc.e);this.pi(b);return this.pf.N5d(b)}$Rf(b){this.Gc.f=this.Gh(this.Gc.f);
this.pi(b);return this.pf.$Rf(b)}aSf(b){this.Gc.g=this.Gh(this.Gc.g);this.pi(b);return this.pf.aSf(b)}eSf(b){this.Gc.h=this.Gh(this.Gc.h);this.pi(b);return this.pf.eSf(b)}uSf(b){this.Gc.i=this.Gh(this.Gc.i);this.pi(b);return this.pf.uSf(b)}wSf(b){this.Gc.j=this.Gh(this.Gc.j);this.pi(b);this.pf.wSf(b)}T5d(b){this.Gc.k=this.Gh(this.Gc.k);this.pi(b);return this.pf.T5d(b)}xSf(b){this.Gc.l=this.Gh(this.Gc.l);this.pi(b);this.pf.xSf(b)}ySf(b){this.Gc.m=this.Gh(this.Gc.m);this.pi(b);this.pf.ySf(b)}zSf(b){this.Gc.n=
this.Gh(this.Gc.n);this.pi(b);return this.pf.zSf(b)}W5d(b){this.Gc.o=this.Gh(this.Gc.o);this.pi(b);return this.pf.W5d(b)}X5d(b){this.Gc.p=this.Gh(this.Gc.p);this.pi(b);return this.pf.X5d(b)}NSf(b){this.Gc.q=this.Gh(this.Gc.q);this.pi(b);return this.pf.NSf(b)}Y5d(b){this.Gc.r=this.Gh(this.Gc.r);this.pi(b);this.pf.Y5d(b)}PSf(b){this.Gc.s=this.Gh(this.Gc.s);this.pi(b);return this.pf.PSf(b)}Z5d(b){this.Gc.t=this.Gh(this.Gc.t);this.pi(b);return this.pf.Z5d(b)}$5d(b){this.Gc.u=this.Gh(this.Gc.u);this.pi(b);
return this.pf.$5d(b)}c6d(b){this.Gc.v=this.Gh(this.Gc.v);this.pi(b);return this.pf.c6d(b)}d6d(b){this.Gc.w=this.Gh(this.Gc.w);this.pi(b);return this.pf.d6d(b)}aTf(b){this.Gc.x=this.Gh(this.Gc.x);this.pi(b);this.pf.aTf(b)}bTf(b){this.Gc.y=this.Gh(this.Gc.y);this.pi(b);return this.pf.bTf(b)}k6d(b){this.Gc.z=this.Gh(this.Gc.z);this.pi(b);return this.pf.k6d(b)}l6d(b){this.Gc.ba=this.Gh(this.Gc.ba);this.pi(b);return this.pf.l6d(b)}o6d(b){this.Gc.bb=this.Gh(this.Gc.bb);this.pi(b);return this.pf.o6d(b)}p6d(b){this.Gc.bc=
this.Gh(this.Gc.bc);this.pi(b);return this.pf.p6d(b)}r6d(b){this.Gc.bd=this.Gh(this.Gc.bd);this.pi(b);return this.pf.r6d(b)}s6d(b){this.Gc.be=this.Gh(this.Gc.be);this.pi(b);return this.pf.s6d(b)}u6d(b){this.Gc.bf=this.Gh(this.Gc.bf);this.pi(b);return this.pf.u6d(b)}w6d(b){this.Gc.bg=this.Gh(this.Gc.bg);this.pi(b);return this.pf.w6d(b)}CTf(b){this.Gc.bh=this.Gh(this.Gc.bh);this.pi(b);return this.pf.CTf(b)}D6d(b){this.Gc.bi=this.Gh(this.Gc.bi);this.pi(b);return this.pf.D6d(b)}JTf(b){this.Gc.bj=this.Gh(this.Gc.bj);
this.pi(b);return this.pf.JTf(b)}LTf(b){this.Gc.bk=this.Gh(this.Gc.bk);this.pi(b);this.pf.LTf(b)}MTf(b){this.Gc.bl=this.Gh(this.Gc.bl);this.pi(b);return this.pf.MTf(b)}G6d(b){this.Gc.bm=this.Gh(this.Gc.bm);this.pi(b);return this.pf.G6d(b)}H6d(b){this.Gc.bm=this.Gh(this.Gc.bm);this.pi(b);return this.pf.H6d(b)}I6d(b){this.Gc.bm=this.Gh(this.Gc.bm);this.pi(b);return this.pf.I6d(b)}J6d(b){this.Gc.bm=this.Gh(this.Gc.bm);this.pi(b);return this.pf.J6d(b)}K6d(b){this.Gc.bm=this.Gh(this.Gc.bm);this.pi(b);
return this.pf.K6d(b)}L6d(b){this.Gc.bm=this.Gh(this.Gc.bm);this.pi(b);return this.pf.L6d(b)}TTf(b){this.Gc.bn=this.Gh(this.Gc.bn);return this.pf.TTf(b)}M6d(b){this.Gc.bo=this.Gh(this.Gc.bo);this.pi(b);this.pf.M6d(b)}ZTf(b){this.Gc.bp=this.Gh(this.Gc.bp);return this.pf.ZTf(b)}N6d(b){this.Gc.bq=this.Gh(this.Gc.bq);this.pi(b);return this.pf.N6d(b)}aUf(b){this.Gc.br=this.Gh(this.Gc.br);this.pi(b);return this.pf.aUf(b)}Q6d(b){this.Hl&&(this.Hl.A1h=!0);this.pi(b);this.Gc.bs=this.Gh(this.Gc.bs);this.pf.Q6d(b)}gUf(b){this.Gc.bt=
this.Gh(this.Gc.bt);this.pi(b);this.pf.gUf(b)}R6d(b){this.Gc.bu=this.Gh(this.Gc.bu);this.pi(b);return this.pf.R6d(b)}mUf(b){this.Gc.bv=this.Gh(this.Gc.bv);this.pi(b);return this.pf.mUf(b)}T6d(b){this.Gc.bw=this.Gh(this.Gc.bw);this.pi(b);return this.pf.T6d(b)}V6d(b){this.Gc.bx=this.Gh(this.Gc.bx);this.pi(b);return this.pf.V6d(b)}X6d(b){this.Gc.by=this.Gh(this.Gc.by);this.pi(b);return this.pf.X6d(b)}Y6d(b){this.Hl&&(this.Hl.qMc=!0);this.Gc.bz=this.Gh(this.Gc.bz);this.pi(b);return this.pf.Y6d(b)}yUf(b){this.Gc.ca=
this.Gh(this.Gc.ca);this.pi(b);this.pf.yUf(b)}CUf(b){this.Gc.cb=this.Gh(this.Gc.cb);this.pi(b);return this.pf.CUf(b)}$6d(b){this.Hl&&(this.Hl.HGl=!0);this.Gc.cc=this.Gh(this.Gc.cc);this.pi(b);return this.pf.$6d(b)}onMenuOpen(b){this.Gc.cd=this.Gh(this.Gc.cd);this.pi(b);return this.pf.onMenuOpen(b)}GUf(b){this.Gc.ce=this.Gh(this.Gc.ce);this.pf.GUf(b)}PUf(b){this.Gc.cf=this.Gh(this.Gc.cf);this.pi(b);return this.pf.PUf(b)}QUf(b){this.Gc.cg=this.Gh(this.Gc.cg);this.pi(b);return this.pf.QUf(b)}SUf(b){this.Gc.ch=
this.Gh(this.Gc.ch);this.pi(b);return this.pf.SUf(b)}l7d(b){this.Hl&&(this.Hl.qMc=!0);this.Gc.ci=this.Gh(this.Gc.ci);this.pi(b);return this.pf.l7d(b)}UUf(b){this.Gc.cj=this.Gh(this.Gc.cj);this.pi(b);return this.pf.UUf(b)}m7d(b){this.Gc.ck=this.Gh(this.Gc.ck);this.pi(b);return this.pf.m7d(b)}q7d(b){this.Gc.cl=this.Gh(this.Gc.cl);this.pi(b);return this.pf.q7d(b)}aVf(b){this.Gc.cm=this.Gh(this.Gc.cm);this.pi(b);this.pf.aVf(b)}x7d(b){this.Gc.cn=this.Gh(this.Gc.cn);this.pi(b);return this.pf.x7d(b)}lVf(b){this.Gc.co=
this.Gh(this.Gc.co);this.pi(b);return this.pf.lVf(b)}F7d(b){this.Gc.cp=this.Gh(this.Gc.cp);this.pi(b);return this.pf.F7d(b)}G7d(b){this.Gc.cq=this.Gh(this.Gc.cq);this.pi(b);return this.pf.G7d(b)}FVf(b){this.Gc.cr=this.Gh(this.Gc.cr);return this.pf.FVf(b)}MVf(b){this.Gc.cs=this.Gh(this.Gc.cs);this.pi(b);return this.pf.MVf(b)}O7d(b){this.Gc.ct=this.Gh(this.Gc.ct);this.pi(b);return this.pf.O7d(b)}P7d(b){this.Gc.cu=this.Gh(this.Gc.cu);this.pi(b);return this.pf.P7d(b)}R7d(b){this.Gc.cv=this.Gh(this.Gc.cv);
this.pi(b);return this.pf.R7d(b)}S7d(b){this.Gc.cw=this.Gh(this.Gc.cw);this.pi(b);return this.pf.S7d(b)}QVf(b){this.Gc.cx=this.Gh(this.Gc.cx);return this.pf.QVf(b)}T7d(b){this.Gc.cy=this.Gh(this.Gc.cy);this.pi(b);return this.pf.T7d(b)}W7d(b){this.Gc.cz=this.Gh(this.Gc.cz);this.pi(b);return this.pf.W7d(b)}Y7d(b){this.Hl&&(this.Hl.fna=!0);this.Gc.da=this.Gh(this.Gc.da);this.pi(b);return this.pf.Y7d(b)}TVf(b){this.Hl&&(this.Hl.fna=!0);this.Gc.db=this.Gh(this.Gc.db);this.pi(b);return this.pf.TVf(b)}Q_c(b){this.Hl&&
(this.Hl.fna=!0);this.Gc.dc=this.Gh(this.Gc.dc);this.pi(b);return this.pf.Q_c(b)}WVf(b){this.Gc.dd=this.Gh(this.Gc.dd);this.pi(b);return this.pf.WVf(b)}XVf(b){this.Gc.de=this.Gh(this.Gc.de);this.pi(b);return this.pf.XVf(b)}a8d(b){this.Hl&&(this.Hl.fna=!0);this.Gc.df=this.Gh(this.Gc.df);this.pi(b);return this.pf.a8d(b)}YVf(b){this.Hl&&(this.Hl.fna=!0);this.Gc.dg=this.Gh(this.Gc.dg);this.pi(b);return this.pf.YVf(b)}aWf(b){this.Gc.dh=this.Gh(this.Gc.dh);this.pi(b);return this.pf.aWf(b)}f8d(b){this.Hl&&
(this.Hl.fna=!0);this.Gc.di=this.Gh(this.Gc.di);this.pi(b);return this.pf.f8d(b)}g8d(b){this.Gc.dj=this.Gh(this.Gc.dj);this.pi(b);return this.pf.g8d(b)}h8d(b){this.Gc.dk=this.Gh(this.Gc.dk);this.pi(b);return this.pf.h8d(b)}i8d(b){this.Hl&&(this.Hl.qMc=!0);this.Gc.dl=this.Gh(this.Gc.dl);this.pi(b);return this.pf.i8d(b)}l8d(b){this.Gc.dm=this.Gh(this.Gc.dm);this.pi(b);return this.pf.l8d(b)}C0m(b){var k,t,D;w.AFrameworkApplication.ue("ec3e8394;h715g427");null!==(k=this.Hl)&&void 0!==k&&k.Uvi&&(k=b.cssText)&&
(b=k.match(/[0-9]+em;/g),k=k.match(/[0-9]+rem;/g),this.Hl.SQf+=null!==(t=null===b||void 0===b?void 0:b.length)&&void 0!==t?t:0,this.Hl.TQf+=null!==(D=null===k||void 0===k?void 0:k.length)&&void 0!==D?D:0)}pi(b){const k=b.qf;if(k&&this.Hl){var t=k.tagName.toLowerCase();this.C0m(k.style);if(this.vik&&this.xui(t)||this.wik&&!this.xui(t)||this.Hl.bvi)if("font"===t&&this.bzn(b),k.style&&(b=k.style))for(const D of b)D&&0<D.length&&this.Hl.XVd(k.tagName,D)}}bzn(b){if((b=b.qf)&&"font"===b.tagName.toLowerCase()&&
this.Hl){var k=b.getAttribute("face");k&&0<k.length&&this.Hl.XVd(b.tagName,"font-attr-face");(k=b.getAttribute("color"))&&0<k.length&&this.Hl.XVd(b.tagName,"font-attr-color");(k=b.getAttribute("size"))&&0<k.length&&this.Hl.XVd(b.tagName,"font-attr-size")}}xui(b){return this.cPg.contains(b)}}Object(n.a)(mC,"HtmlEventUsageCollector",null,[502]);class Hy{constructor(b,k,t=!1){this.qf=b;this.vB=k;this.HCk=t}}Object(n.a)(Hy,"TagEventParam",null,[]);class Kq{constructor(b,k=null){this.vhd=this._prunedElements=
this.wVe=this._voidElements=null;this.ud=b;this.xW=k||cp.a.F9h("");this.qmo()}get Gc(){return this.xW}Lgn(b,k,t){this.wVe[k]?this.KQi():(this.Gc.e++,(k=this.vhd[k])&&k(new Hy(b,t,!1)),this.Gc.b++)}KQi(){this.Gc.d++}Ggn(){this.Gc.c++}sgn(b,k,t){if(this.wVe[k])this.KQi();else{if(k=this.vhd[k])return this.Gc.b++,k(new Hy(b,t,!1));this.Gc.f++}return 2}qmo(){this._voidElements=ib.a.v5("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",
!0);this.wVe=ib.a.v5("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=ib.a.v5("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.ud,k=this.ud,t=this.ud,D=this.ud,P=this.ud,ca=this.ud,ta=
this.ud,Na=this.ud,qb=this.ud,Jb=this.ud,Vb=this.ud,ac=this.ud,yc=this.ud,Kc=this.ud,ed=this.ud,sd=this.ud,oe=this.ud,Ld=this.ud,Od=this.ud,ie=this.ud;this.vhd=ib.a.v5("A",Object(A.a)(this.ud,this.ud.N5d,"onAOpen"),"ABBR",Object(A.a)(this.ud,this.ud.$Rf,"onAbbrOpen"),"ACRONYM",Object(A.a)(this.ud,this.ud.aSf,"onAcronymOpen"),"ADDRESS",Object(A.a)(this.ud,this.ud.eSf,"onAddressOpen"),"APPLET",Object(A.a)(this.ud,this.ud.uSf,"onAppletOpen"),"AREA",Object(A.a)(this.ud,this.ud.wSf,"onAreaTag"),"B",Object(A.a)(this.ud,
this.ud.T5d,"onBOpen"),"BASE",Object(A.a)(this.ud,this.ud.xSf,"onBaseTag"),"BASEFONT",Object(A.a)(this.ud,this.ud.ySf,"onBasefontTag"),"BDO",Object(A.a)(this.ud,this.ud.zSf,"onBdoOpen"),"BIG",Object(A.a)(this.ud,this.ud.W5d,"onBigOpen"),"BLOCKQUOTE",Object(A.a)(this.ud,this.ud.X5d,"onBlockquoteOpen"),"BODY",Object(A.a)(this.ud,this.ud.NSf,"onBodyOpen"),"BR",Object(A.a)(this.ud,this.ud.Y5d,"onBrTag"),"BUTTON",Object(A.a)(this.ud,this.ud.PSf,"onButtonOpen"),"CAPTION",Object(A.a)(this.ud,this.ud.Z5d,
"onCaptionOpen"),"CENTER",Object(A.a)(this.ud,this.ud.$5d,"onCenterOpen"),"CITE",Object(A.a)(this.ud,this.ud.c6d,"onCiteOpen"),"CODE",Object(A.a)(this.ud,this.ud.d6d,"onCodeOpen"),"COL",Object(A.a)(this.ud,this.ud.aTf,"onColTag"),"COLGROUP",Object(A.a)(this.ud,this.ud.bTf,"onColgroupOpen"),"DD",Object(A.a)(this.ud,this.ud.k6d,"onDdOpen"),"DEL",Object(A.a)(this.ud,this.ud.l6d,"onDelOpen"),"DFN",Object(A.a)(this.ud,this.ud.o6d,"onDfnOpen"),"DIR",Object(A.a)(this.ud,this.ud.p6d,"onDirOpen"),"DIV",Object(A.a)(this.ud,
this.ud.r6d,"onDivOpen"),"DL",Object(A.a)(this.ud,this.ud.s6d,"onDlOpen"),"DT",Object(A.a)(this.ud,this.ud.u6d,"onDtOpen"),"EM",Object(A.a)(this.ud,this.ud.w6d,"onEmOpen"),"FIELDSET",Object(A.a)(this.ud,this.ud.CTf,"onFieldsetOpen"),"FONT",Object(A.a)(this.ud,this.ud.D6d,"onFontOpen"),"FORM",Object(A.a)(this.ud,this.ud.JTf,"onFormOpen"),"FRAME",Object(A.a)(this.ud,this.ud.LTf,"onFrameTag"),"FRAMESET",Object(A.a)(this.ud,this.ud.MTf,"onFramesetOpen"),"H1",Object(A.a)(this.ud,this.ud.G6d,"onH1Open"),
"H2",Object(A.a)(this.ud,this.ud.H6d,"onH2Open"),"H3",Object(A.a)(this.ud,this.ud.I6d,"onH3Open"),"H4",Object(A.a)(this.ud,this.ud.J6d,"onH4Open"),"H5",Object(A.a)(this.ud,this.ud.K6d,"onH5Open"),"H6",Object(A.a)(this.ud,this.ud.L6d,"onH6Open"),"HEAD",Object(A.a)(this.ud,this.ud.TTf,"onHeadOpen"),"HR",Object(A.a)(this.ud,this.ud.M6d,"onHrTag"),"HTML",Object(A.a)(this.ud,this.ud.ZTf,"onHtmlOpen"),"I",Object(A.a)(this.ud,this.ud.N6d,"onIOpen"),"IFRAME",Object(A.a)(this.ud,this.ud.aUf,"onIframeOpen"),
"IMG",Object(A.a)(this.ud,this.ud.Q6d,"onImgTag"),"INPUT",Object(A.a)(this.ud,this.ud.gUf,"onInputTag"),"INS",Object(A.a)(this.ud,this.ud.R6d,"onInsOpen"),"ISINDEX",Object(A.a)(this.ud,this.ud.mUf,"onIsindexOpen"),"KBD",Object(A.a)(this.ud,this.ud.T6d,"onKbdOpen"),"LABEL",Object(A.a)(this.ud,this.ud.V6d,"onLabelOpen"),"LEGEND",Object(A.a)(this.ud,this.ud.X6d,"onLegendOpen"),"LI",Object(A.a)(this.ud,this.ud.Y6d,"onLiOpen"),"LINK",Object(A.a)(this.ud,this.ud.yUf,"onLinkTag"),"MAP",Object(A.a)(this.ud,
this.ud.CUf,"onMapOpen"),"MATH",Object(A.a)(this.ud,this.ud.$6d,"onMathOpen"),"MENU",Object(A.a)(this.ud,this.ud.onMenuOpen,"onMenuOpen"),"META",Object(A.a)(this.ud,this.ud.GUf,"onMetaTag"),"NOFRAMES",Object(A.a)(this.ud,this.ud.PUf,"onNoframesOpen"),"NOSCRIPT",Object(A.a)(this.ud,this.ud.QUf,"onNoscriptOpen"),"OBJECT",Object(A.a)(this.ud,this.ud.SUf,"onObjectOpen"),"OL",Object(A.a)(this.ud,this.ud.l7d,"onOlOpen"),"OPTGROUP",Object(A.a)(this.ud,this.ud.UUf,"onOptgroupOpen"),"OPTION",Object(A.a)(this.ud,
this.ud.m7d,"onOptionOpen"),"P",Object(A.a)(this.ud,this.ud.q7d,"onPOpen"),"PARAM",Object(A.a)(this.ud,this.ud.aVf,"onParamTag"),"PRE",Object(A.a)(this.ud,this.ud.x7d,"onPreOpen"),"Q",Object(A.a)(this.ud,this.ud.lVf,"onQOpen"),"S",Object(A.a)(this.ud,this.ud.F7d,"onSOpen"),"SAMP",Object(A.a)(this.ud,this.ud.G7d,"onSampOpen"),"SCRIPT",Object(A.a)(this.ud,this.ud.FVf,"onScriptOpen"),"SELECT",Object(A.a)(this.ud,this.ud.MVf,"onSelectOpen"),"SMALL",Object(A.a)(b,b.O7d,"onSmallOpen"),"SPAN",Object(A.a)(k,
k.P7d,"onSpanOpen"),"STRIKE",Object(A.a)(t,t.R7d,"onStrikeOpen"),"STRONG",Object(A.a)(D,D.S7d,"onStrongOpen"),"STYLE",Object(A.a)(P,P.QVf,"onStyleOpen"),"SUB",Object(A.a)(ca,ca.T7d,"onSubOpen"),"SUP",Object(A.a)(ta,ta.W7d,"onSupOpen"),"TABLE",Object(A.a)(Na,Na.Y7d,"onTableOpen"),"TBODY",Object(A.a)(qb,qb.TVf,"onTbodyOpen"),"TD",Object(A.a)(Jb,Jb.Q_c,"onTdOpen"),"TEXTAREA",Object(A.a)(Vb,Vb.WVf,"onTextareaOpen"),"TFOOT",Object(A.a)(ac,ac.XVf,"onTfootOpen"),"TH",Object(A.a)(yc,yc.a8d,"onThOpen"),"THEAD",
Object(A.a)(Kc,Kc.YVf,"onTheadOpen"),"TITLE",Object(A.a)(ed,ed.aWf,"onTitleOpen"),"TR",Object(A.a)(sd,sd.f8d,"onTrOpen"),"TT",Object(A.a)(oe,oe.g8d,"onTtOpen"),"U",Object(A.a)(Ld,Ld.h8d,"onUOpen"),"UL",Object(A.a)(Od,Od.i8d,"onUlOpen"),"VAR",Object(A.a)(ie,ie.l8d,"onVarOpen"))}}Object(n.a)(Kq,"AHtmlProcessor",null,[]);class kz{constructor(b,k){this.childNodes=b.childNodes;this.vB=k;this.Ibf=0;this.ZXd=!1}}Object(n.a)(kz,"HtmlProcessorArguments",null,[]);class Yt extends Kq{constructor(b,k=null){super(b,
k);this.LFe=null}get SNm(){null==this.LFe&&(this.LFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.LFe}process(b,k=null){b&&(this.ud.reset(),this.K2i(new kz(b,new uv.a),k))}K2i(b,k){b.childNodes.length&&(b=new vs.a(k,Object(A.a)(this,this.fGn,"processChild"),b),b.Al("HTML Processing Operation"),k||(b.Ig=!0),b.run())}fGn(b,k){const t=k.childNodes[k.Ibf];if(3===t.nodeType)return this.ud.U5d(),this.ud.tca(t.nodeValue,new Hy(t,k.vB.r6h())),
Yt.Ylc(k);if(1!==t.nodeType)return Yt.Ylc(k);if(!k.ZXd){const P=F.a.QA(t.tagName);if(!Yt.$nm(t))if(this._prunedElements[P])this.Ggn();else{Yt.F8m(t);this.ud.U5d();var D=t.id;const ca=t.tagName,ta=k.vB.r6h(),Na=t.getAttribute?t.getAttribute("class"):null;D=new Pt(D,ca,Na?Na:"",t.attributes?t.attributes.length:0);D.isValid&&ta.add(D);if(this._voidElements[P])return this.Lgn(t,P,ta),Yt.Ylc(k);D=!1;switch(this.sgn(t,P,ta)){case 1:D=!0;break;case 3:return Yt.Ylc(k)}switch(this.ud.hwf(t)){case 1:D=!0}k.ZXd=
D;this.K2i(new kz(t,ta),b);if(!b.Ig)return!0}}if(k.ZXd){if(this.SNm&&!this.vhd[F.a.QA(t.tagName)])return Yt.Ylc(k);this.ud.onClose()}return Yt.Ylc(k)}static F8m(b){3!==b.nodeType&&jd.a.ql(b,"alreadyPasted",!0)}static $nm(b){return 3!==b.nodeType&&jd.a.Db(b,"alreadyPasted")}static Ylc(b){b.Ibf++;b.ZXd=!1;return b.Ibf<b.childNodes.length}}Object(n.a)(Yt,"HtmlProcessor",Kq,[]);var Rx=c(1998),zv=c(644);const Sx={["font-size"]:0,["box-sizing"]:1,["font-family"]:2,["color"]:3,["padding"]:4,["margin"]:5,
["border-bottom-width"]:6,["border-left-width"]:7,["border-top-width"]:8,["border-right-width"]:9,["border-bottom-style"]:10,["border-left-style"]:11,["border-top-style"]:12,["border-right-style"]:13,["line-height"]:14,["border-bottom-color"]:15,["border-left-color"]:16,["border-top-color"]:17,["border-right-color"]:18,["border-image-repeat"]:19,["border-image-source"]:20,["border-image-width"]:21,["border-image-outset"]:22,["border-image-slice"]:23,["margin-bottom"]:24,["font-weight"]:25,["background-color"]:26,
["font-style"]:27,["margin-top"]:28,["padding-top"]:29,["padding-right"]:30,["padding-left"]:31,["padding-bottom"]:32,["vertical-align"]:33,["margin-left"]:34,["margin-right"]:35,["white-space"]:36,["width"]:37,["position"]:38,["text-align"]:39,["display"]:40,["font-variant-ligatures"]:41,["font-variant-caps"]:42,["outline-style"]:43,["outline-width"]:44,["outline-color"]:45,["font-variant-numeric"]:46,["font-stretch"]:47,["font-variant-east-asian"]:48,["height"]:49,["background-clip"]:50,["background-repeat-x"]:51,
["background-repeat-y"]:52,["background-position-y"]:53,["background-position-x"]:54,["background-image"]:55,["background-size"]:56,["background-origin"]:57,["background-attachment"]:58,["text-indent"]:59,["overflow-x"]:60,["overflow-y"]:61,["text-decoration-color"]:62,["text-decoration-style"]:63,["letter-spacing"]:64,["text-transform"]:65,["overflow-wrap"]:66,["float"]:67,["-webkit-text-stroke-width"]:68,["word-spacing"]:69,["orphans"]:70,["widows"]:71,["top"]:72,["border-top-right-radius"]:73,
["border-top-left-radius"]:74,["border-bottom-right-radius"]:75,["border-bottom-left-radius"]:76,["text-decoration-line"]:77,["left"]:78,["unicode-bidi"]:79,["clear"]:80,["max-width"]:81,["list-style-type"]:82,["min-height"]:83,["text-shadow"]:84,["bottom"]:85,["list-style-position"]:86,["list-style-image"]:87,["right"]:88,["-webkit-font-smoothing"]:89,["visibility"]:90,["cursor"]:91,["resize"]:92,["max-height"]:93,["word-break"]:94,["font-attr-size"]:95,["font-attr-face"]:96,["user-select"]:97,["min-width"]:98,
["transition-duration"]:99,["transition-property"]:100,["transition-timing-function"]:101,["transition-delay"]:102,["clip"]:103,["transform"]:104,["opacity"]:105,["-webkit-tap-highlight-color"]:106,["align-items"]:107,["flex-direction"]:108,["font-attr-color"]:109,["direction"]:110,["flex-shrink"]:111,["box-shadow"]:112,["text-rendering"]:113,["z-index"]:114,["flex-grow"]:115,["text-size-adjust"]:116,["flex-basis"]:117,["transform-origin"]:118,["quotes"]:119,["caption-side"]:120,["border-collapse"]:121,
["counter-reset"]:122,["font-kerning"]:123,["text-overflow"]:124,["-webkit-text-stroke-color"]:125,["-webkit-user-drag"]:126,["-webkit-box-flex"]:127,["font-variant"]:128,["font-feature-settings"]:129,["-webkit-border-horizontal-spacing"]:130,["-webkit-border-vertical-spacing"]:131,["justify-content"]:132,["margin-inline-start"]:133,["speak"]:134,["caret-color"]:135,["flex-wrap"]:136,["animation-duration"]:137,["animation-name"]:138,["animation-timing-function"]:139,["animation-fill-mode"]:140,["animation-delay"]:141,
["animation-iteration-count"]:142,["animation-direction"]:143,["animation-play-state"]:144,["pointer-events"]:145,["grid-column-end"]:146,["grid-column-start"]:147,["break-inside"]:148,["counter-increment"]:149,["touch-action"]:150,["word-wrap"]:151,["hyphens"]:152,["zoom"]:153,["break-after"]:154,["content"]:155,["break-before"]:156,["margin-block-start"]:157,["margin-block-end"]:158,["padding-inline-start"]:159,["-webkit-box-align"]:160,["tab-size"]:161,["-webkit-appearance"]:162,["table-layout"]:163,
["transform-style"]:164,["-webkit-box-orient"]:165,["writing-mode"]:166,["-webkit-box-pack"]:167,["-webkit-box-direction"]:168,["order"]:169,["text-decoration"]:170,["--darkreader-inline-color"]:171,["empty-cells"]:172,["backface-visibility"]:173,["object-fit"]:174,["--transition-duration"]:175,["clip-path"]:176,["margin-inline-end"]:177,["grid-template-columns"]:178,["--darkreader-inline-bgcolor"]:179,["-webkit-print-color-adjust"]:180,["-webkit-box-decoration-break"]:181,["filter"]:182,["perspective-origin"]:183,
["fill"]:184,["align-content"]:185,["align-self"]:186,["column-count"]:187,["outline-offset"]:188,["--czi-counter-name"]:189,["--czi-counter-reset"]:190,["--czi-list-style-type"]:191,["-webkit-line-clamp"]:192,["--darkreader-inline-border-bottom"]:193,["--darkreader-inline-border-left"]:194,["--darkreader-inline-border-right"]:195,["--darkreader-inline-border-top"]:196,["--saf-0"]:197,["will-change"]:198,["grid-row-start"]:199,["padding-inline-end"]:200,["padding-block-end"]:201,["padding-block-start"]:202,
["grid-row-end"]:203,["-webkit-box-ordinal-group"]:204,["column-gap"]:205,["object-position"]:206,["image-rendering"]:207,["-webkit-user-modify"]:208,["column-width"]:209,["text-decoration-skip-ink"]:210,["line-break"]:211,["grid-template-rows"]:212,["perspective"]:213,["justify-self"]:214,["page"]:215,["--language-font-face"]:216,["mix-blend-mode"]:217,["-webkit-text-fill-color"]:218,["grid-template-areas"]:219,["--darkreader-inline-bgimage"]:220,["--darkreader-inline-outline"]:221,["-webkit-hyphenate-character"]:222,
["row-gap"]:223,["scroll-behavior"]:224,["text-align-last"]:225,["stroke"]:226,["column-fill"]:227,["--chat-message-background-color"]:228,["--message-border-radius-bottom-left"]:229,["--message-border-radius-bottom-right"]:230,["--message-border-radius-top-left"]:231,["--message-border-radius-top-right"]:232,["-webkit-mask-image"]:233,["--ehixd-mediumheight"]:234,["--ehixd-mediumpadding"]:235,["--czi-content-line-height"]:236,["--chat-default-message-background-color"]:237,["overscroll-behavior-x"]:238,
["overscroll-behavior-y"]:239,["contain"]:240,["-webkit-user-select"]:241,["border"]:242,["justify-items"]:243,["-webkit-border-image"]:244,["column-rule-color"]:245,["column-rule-style"]:246,["column-rule-width"]:247,["--avatar-size"]:248,["--chat-message-align"]:249,["--chat-message-link-color"]:250,["--chat-message-max-width"]:251,["--black"]:252,["--blacktranslucent40"]:253,["--flaggedmessage"]:254,["--headerbackground"]:255,["--headerbackgroundsearch"]:256,["--headerbadgebackground"]:257,["--headerbadgetext"]:258,
["--headerbrandtext"]:259,["--headerbuttonsbackground"]:260,["--headerbuttonsbackgroundhover"]:261,["--headerbuttonsbackgroundsearch"]:262,["--headerbuttonsbackgroundsearchhover"]:263,["--headersearchboxbackground"]:264,["--headersearchboxicon"]:265,["--headersearchbuttonbackground"]:266,["--headersearchbuttonbackgroundhover"]:267,["--headersearchbuttonicon"]:268,["--headersearchfilters"]:269,["--headersearchfiltershover"]:270,["--headersearchicon"]:271,["--headersearchplaceholdertext"]:272,["--headertexticons"]:273,
["--neutraldark"]:274,["--neutrallight"]:275,["--neutrallighter"]:276,["--neutrallighteralt"]:277,["--neutralprimary"]:278,["--neutralprimaryalt"]:279,["--neutralquaternary"]:280,["--neutralquaternaryalt"]:281,["--neutralsecondary"]:282,["--neutraltertiary"]:283,["--neutraltertiaryalt"]:284,["--reddark"]:285,["--richusercontentbackground"]:286,["--searchboxbackground"]:287,["--themedark"]:288,["--themedarkalt"]:289,["--themedarker"]:290,["--themelight"]:291,["--themelighter"]:292,["--themelighteralt"]:293,
["--themeprimary"]:294,["--themesecondary"]:295,["--themetertiary"]:296,["--white"]:297,["--whitetranslucent40"]:298,["--whitetranslucent90"]:299,["--button-width"]:300,["fill-opacity"]:301,["--mousedown-x"]:302,["--mousedown-y"]:303,["--height"]:304,["--purple"]:305,["-webkit-line-break"]:306,["grid-auto-flow"]:307,["overflow-anchor"]:308,["backdrop-filter"]:309,["--spritesheet-position"]:310,["-webkit-mask-position-x"]:311,["-webkit-mask-position-y"]:312,["No Style Present"]:313,["OTHERS"]:314},
nw={["a"]:1,["b"]:2,["big"]:3,["blockquote"]:4,["br"]:5,["caption"]:6,["center"]:7,["cite"]:8,["code"]:9,["col"]:10,["colgroup"]:11,["dd"]:12,["del"]:13,["dfn"]:14,["area"]:15,["base"]:16,["basefont"]:17,["frame"]:18,["hr"]:19,["img"]:20,["input"]:21,["link"]:22,["meta"]:23,["param"]:24,["abbr"]:25,["acronym"]:26,["address"]:27,["bdo"]:28,["body"]:29,["button"]:30,["fieldset"]:31,["form"]:32,["frameset"]:33,["html"]:34,["noframes"]:35,["noscript"]:36,["optgroup"]:37,["q"]:38,["select"]:39,["textarea"]:40,
["applet"]:41,["head"]:42,["iframe"]:43,["isindex"]:44,["map"]:45,["object"]:46,["script"]:47,["style"]:48,["title"]:49,["dir"]:50,["div"]:51,["dl"]:52,["dt"]:53,["em"]:54,["font"]:55,["h"]:56,["i"]:57,["ins"]:58,["kbd"]:59,["label"]:60,["legend"]:61,["li"]:62,["math"]:63,["menu"]:64,["ol"]:65,["option"]:66,["p"]:67,["pre"]:68,["s"]:69,["samp"]:70,["small"]:71,["span"]:72,["strike"]:73,["strong"]:74,["sub"]:75,["sup"]:76,["tables"]:77,["tbody"]:78,["td"]:79,["text"]:80,["tfoot"]:81,["th"]:82,["thead"]:83,
["tr"]:84,["tt"]:85,["u"]:86,["ul"]:87,["var"]:88,["OTHERS"]:89};class ow{constructor(){this.ux=0;this.zHc=6;this.GGl=this.x1h=!1;this.u7e=null;this.F1h=this.E1h=this.D1h=this.z1h=this.y1h=!1;this.progId=null;this.Olf=this.B1h=this.A1h=this.fna=this.qMc=this.HGl=this.IGl=!1;this.Gzn=this.XKb=0;this.NWf=this.platform=null;this.Vti=this.SGf=!1;this.TQf=this.SQf=0;this.vjk={["Excel Online"]:1,["Word Online"]:2,["PowerPoint Online"]:3,["OneNote Online"]:4,["Google Docs"]:5,["Excel"]:6,["Word"]:7,["PowerPoint"]:8,
["OneNote"]:9,["Other"]:10};this.iff=[1,3,4,2,5];this.Ntb={}}get OGm(){if(null!=this.JCg)var b=this.JCg;else{var k;b=this.JCg=null===(k=w.AFrameworkApplication.K)||void 0===k?void 0:k.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent2Enabled",!1)}return b}get bvi(){if(null!=this.ICg)var b=this.ICg;else{var k;b=this.ICg=null===(k=w.AFrameworkApplication.K)||void 0===k?void 0:k.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent1Enabled",!1)}return b}get Uvi(){if(null!=
this.MCg)var b=this.MCg;else{var k;b=this.MCg=null===(k=w.AFrameworkApplication.K)||void 0===k?void 0:k.getBooleanFeatureGate("Microsoft.Office.WordOnline.isEmRemLoggingInPasteEnabled",!1)}return b}get $ie(){if(null!==this.u7e)switch(this.u7e){case "XLO":return"Excel Online"}if(this.F1h)return"Word Online";if(this.E1h||this.y1h)return"PowerPoint Online";if(this.x1h)return"Excel Online";if(this.z1h)return"Google Docs";if(this.D1h)return"OneNote Online";switch(this.progId){case "Word.Document":return"Word";
case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}l_(b,k){const t=new na.a;t.name=b;"number"===typeof k?t.int64=k:t.bool=k;return t}rfe(b,k,t){const D=new zv.a;D.name=b;D.dataFields=k;D.dnmInterval=t;D.dnmAllowedPartA=this.iff;ea.a.sendDirectNumericEvent(D)}N1m(){const b=this.sMk();if(this.OGm){var k=[];const t=[this.l_("isUserConsumer",this.SGf),this.l_("isDocumentBlank",this.Vti),this.l_("FoundText",this.Olf),this.l_("FoundTable",
this.fna),this.l_("FoundImage",this.A1h),this.l_("FoundList",this.qMc),this.l_("FoundLink",this.B1h),this.l_("Browser",this.XKb),this.l_("SourceApp",this.vjk[this.$ie])];for(const D of t)k.push(D);this.rfe("Office.DNM.Word.Online.ExternalPasteEvent2",k,2)}this.Uvi&&(k=[this.l_("NumberOfEm",this.SQf),this.l_("NumberOfRem",this.TQf)],Object(bf.a)("NoOfTimesEmRemAppeared_PerPaste",!0,void 0,k));v.ULS.sendTraceTag(51406241,307,50,JSON.stringify(b))}sKh(b,k){var t,D;const P=[];b=this.l_("tag",null!==(t=
nw[b])&&void 0!==t?t:nw.OTHERS);k=this.l_("style",null!==(D=Sx[k])&&void 0!==D?D:Sx.OTHERS);D=this.l_("IsUserConsumer",this.SGf);P.push(b);P.push(k);P.push(D);this.rfe("Office.DNM.Word.Online.ExternalPasteEvent1",P,2)}O1m(){const b=this.Ntb;for(const t in b){var k=t;const D=b[t];if(this.bvi){0===Object.keys(D).length&&this.sKh(k,"No Style Present");for(const P of Object.keys(D))this.sKh(k,P)}D&&(D.SourceApp=this.$ie,D.Browser=Rx.a[this.XKb],D.TagName=k,D.OperationId=this.NWf,v.ULS.sendTraceTag(51406242,
307,50,JSON.stringify(D)))}}XVd(b,k){b&&b.length&&k&&k.length&&(b=b.toLowerCase(),k=k.toLowerCase(),b in this.Ntb||(this.Ntb[b]={}),this.Ntb[b][k]=this.Zbm(b,k)+1)}Zbm(b,k){if(!(b&&b.length&&k&&k.length&&this.Ntb&&b in this.Ntb))return 0;b=b.toLowerCase();k=k.toLowerCase();return(b=this.Ntb[b])&&k in b?b[k]:0}sMk(){const b={};b.ActionIdFlags=this.ux;b.SourceApp=this.$ie;b.CopySourceBrowser=this.zHc;b.PasteBrowser=this.XKb;b.IsSameBrowserPaste=this.JPm(this.zHc,this.XKb);b.IsCrossBrowserPaste=this.CGm(this.zHc,
this.XKb);b.IsUncategorizedBrowserPaste=this.sSm(this.zHc,this.XKb);b.Platform=this.platform;b.OperationId=this.NWf;return b}JPm(b,k){return 5===b||6===b?!1:b===k}CGm(b,k){return 6===b?!1:b!==k}sSm(b,k){return 5===b&&5===k}}Object(n.a)(ow,"HtmlContentMetadata",null,[]);var Tx=c(242),ls=c(1428),pB=c(1052),Lq=c(374),wl=c(140),Zt=c(1670),hi=c(48),fA=c(216);class Mn{get Fn(){return null!=this.GGg?this.GGg:this.GGg=Fa.a.instance.Na("Box4.Styles.StyleSettings")}constructor(b,k,t,D,P,ca,ta){this.W5b=ta;
this.R1g=!1;this.bzj=this.UEe=null;this.rzn=Na=>{Hj.a.mark(5568);this.nXh(Na);let qb=this.aan;if(this.nyi){const Jb=this.Upj();Jb&&(qb=this.Lmb);v.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",Jb)}Na.gi(qb);return!0};this.aan=Na=>{Hj.a.mark(5569);var qb=new ze.GraphIterator;this.SRa.restore(qb);Mn.xU||(this.SRa=null);var Jb=new ze.GraphIterator;this.alf.restore(Jb);this.alf=null;v.ULS.shipAssertTag(6305489,307,va.OutlineElementReader.Bh(qb));v.ULS.shipAssertTag(6305490,307,
va.OutlineElementReader.Bh(Jb));ag.OutlineElementNavigator.Ge(qb);var Vb=pe.ParagraphReader.uh(qb)?pe.ParagraphReader.textLength(qb.currentNode):0;ag.OutlineElementNavigator.Vd(qb);ag.OutlineElementNavigator.Ge(Jb);v.ULS.shipAssertTag(6305491,307,pe.ParagraphReader.uh(Jb));var ac=pe.ParagraphReader.textLength(Jb.currentNode);ag.OutlineElementNavigator.Vd(Jb);let yc=this.L7c;var Kc=new Vk.a;Kc.Yc(qb);ag.OutlineElementNavigator.Ur(Kc,!1,!1);var ed=Kc.currentNode===Jb.currentNode,sd=!!this.Di&&!!(this.Di.ux&
8192);let oe=!1;if(!sd&&this.Di.vd&&Object(ob.a)(th.DictionaryPropertySet,this.Di.vd)){var Ld=this.Di.vd.Lf(vd.a.YKb);sd=Ld&&""!==Ld?!0:!1}Ld=!1;this.Di.vd instanceof Tx.APropertySet&&(Ld=this.Di.vd.ia(vd.a.b4,!1));if(ed){Vb=ze.GraphIterator.$a(qb.currentNode);pe.ParagraphReader.Qt(ag.OutlineElementNavigator.Ge(Vb))||(qb=Jb);qb.currentNode.id!==Jb.currentNode.id&&(v.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",dg.ListItemReader.sh(qb),
dg.ListItemReader.sh(Jb)),sd=Mn.lg.merge(qb,Jb,!0,sd),v.ULS.shipAssertTag(6305492,307,sd));Jb=qb;var Od=!0}else{ed=!!(this.Di.ux&4);Od=this.Ld.qg&&ed&&this.Di.I2a;var ie=!!(this.Di.ux&262144);this.tYf&&this.Di&&!ed&&!ie&&(this.tYf.kli(qb,!1),this.tYf.kli(Jb,!0));ag.OutlineElementNavigator.Ge(Kc);ed=pe.ParagraphReader.uh(Kc)?pe.ParagraphReader.textLength(Kc.currentNode):0;ag.OutlineElementNavigator.Vd(Kc);hi.a.pr&&this.Di.ux&65536||this.VEk(Kc,qb,Jb);ie=new Vk.a;ie.Yc(Kc);ag.OutlineElementNavigator.Ur(ie,
!1,!1);Mn.xU&&ie.currentNode.id===Jb.currentNode.id&&(this.R1g=!0);if(this.VW.hNa||this.Mpo)if(ie.Nn.id!==Jb.Nn.id){for(;Kc.currentNode.id!==Jb.currentNode.id;)ag.OutlineElementNavigator.Ge(Kc,!1),this.VW.uHa(Of.a.create(Kc.currentNode)),Kc.uc(),ag.OutlineElementNavigator.Ur(Kc,!1,!1);Kc.Yc(qb);ag.OutlineElementNavigator.Ur(Kc,!1,!1)}else oe=!0;this.hZ&&({L7c:yc,mva:Kc}=this.hZ.m0f(qb,Jb,yc,Kc));fA.a.Y7&&this.W5b&&(Kc=this.W5b.m0f(qb,Jb,Kc));if(this.Di.xde&&(v.ULS.shipAssertTag(6305493,307,this.Di.Tac),
ie=new ze.GraphIterator,ie.Yc(Kc),ie=ag.OutlineElementNavigator.Ge(ie))){var Ce=this.Di.xde.Ef(ie.pa.J(0));ie.pa.J(0).formatting=Ce}ie=0;sd&&this.ZMe&&(ie=1);Ce=this.mqo(qb,Kc,ie);this.Di.vje=null;if(this.Di.Iia||this.Di.kUa)this.Di.vje=this.Fbm(Ce?qb.currentNode:Kc.currentNode,Ce);var hg=!1;Ce&&(hg=dg.ListItemReader.sh(qb),v.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",hg,dg.ListItemReader.sh(Jb)),this.UEe=hg=Mn.lg.merge(qb,
Kc,!0,sd,Jb,void 0,oe,Od,this.ZMe),this.nqo(qb,ie)&&this.Aan(qb,Jb,ie,sd));ie=Mn.Fzn.Wxm(qb,Kc,Jb,Vb,hg,this.MTc);var Kg=!1;if(yc){const Hl=new Vk.a;Hl.Yc(Jb);ag.OutlineElementNavigator.p0(Hl,!1,!1);Kg=dg.ListItemReader.sh(Hl);const wm=dg.ListItemReader.sh(Jb),bp=Ld;v.ULS.sendTraceTag(509661707,307,50,"preserve EOP formatting : {0}",bp);Od=Mn.lg.merge(Hl,Jb,!0,sd,void 0,!0,void 0,Od,this.ZMe,bp);v.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",
Kg,wm,Od?"True":"False, will cause IP to reset to zero.");Jb=(Kg=Od)?Hl:Jb}else Od=!1,v.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.VW.hNa&&oe&&(Ce&&!this.SIm(ie,hg)?(Kc=new ze.GraphIterator,Kc.Yc(qb),qb=ag.OutlineElementNavigator.Ge(Kc),this.VW.cqa(qb,Vb,Vb+ed)):yc&&!this.vLm(ie,Kg)?(qb=new ze.GraphIterator,qb.Yc(Kc),qb=ag.OutlineElementNavigator.Ge(qb),this.VW.cqa(qb,0,ed)):(qb=new ze.GraphIterator,qb.Yc(Kc),qb=ag.OutlineElementNavigator.Ge(qb),this.VW.uHa(Of.a.create(qb))));
this.aDn(ie);this.isProgressiveStyleEnabled&&!sd&&this.EH.XGn(ie)}v.ULS.shipAssertTag(6305494,307,Jb.isValid);sd=ag.OutlineElementNavigator.Ge(Jb);ac=Od?pe.ParagraphReader.textLength(sd)-ac:0;this.Di.n0a=Ld?Gf.SelectionFactory.GK(sd,ac-1,ac):Gf.SelectionFactory.te(sd,ac);this.Di&&this.Di.Tac&&pe.ParagraphReader.Wb(sd)&&this.Di.F8d&&((ac=this.Di.F8d.UBo)&&this.XG.HJ(ac,sd,!0),(ac=this.Di.F8d.myn)&&this.paragraphEditor.Gth(sd,ac));Na.gi(this.Lmb);return!0};this.Rko=Na=>{const qb=ze.GraphIterator.$a(this.bzj);
qb.iF(1);this.Di.n0a=Gf.SelectionFactory.fo(qb.currentNode,!1);Na.gi(this.Lmb);return!0};this.Lmb=()=>{var Na=void 0===this.Di.ux||null===this.Di.ux?"not available":Object(ls.a)(Zt.a,this.Di.ux);v.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.Di.ux,Na);v.ULS.shipAssertTag(6305497,307,!!this.Di.n0a);this.MTc?Object(bf.a)("ExternalPasteAction",!0):Object(bf.a)("InternalPasteAction",!0);Mn.xU&&this.SRa&&(Na=new ze.GraphIterator,this.SRa.restore(Na),this.SRa=null,this.onm(Na));this.transaction.dispose();
Na=this.Mt.ru;if(!Na.qe||!Na.editingView.Sj)return!1;Na.editingView.EFo();return!1};this.lFa=b;this.alf=this.SRa=null;this.Di=k;this.transaction=t;this.hZ=D;this.Mt=P;this.p6=ca}get K(){return w.AFrameworkApplication.K}get ZMe(){return!!this.K&&this.K.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get EH(){return null!=this.Bzg?this.Bzg:this.Bzg=Fa.a.instance.resolve("Box4.IFontStylesGalleryCache")}get isProgressiveStyleEnabled(){return this.Fn&&this.Fn.isProgressiveStyleEnabled}get XG(){return null!=
this.bJg?this.bJg:this.bJg=Fa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get sc(){return null!=this.EJg?this.EJg:this.EJg=Fa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get paragraphEditor(){return null!=this.dFg?this.dFg:this.dFg=Fa.a.instance.resolve("Box4.IParagraphEditor")}get Gd(){return null!=this.KDg?this.KDg:this.KDg=Fa.a.instance.resolve("Box4.List.IListReader")}get Un(){return null!=this.wDg?this.wDg:this.wDg=Fa.a.instance.resolve("Box4.List.IListEditor")}get F_(){return null!=
this.lAg?this.lAg:this.lAg=Fa.a.instance.resolve("Box4.IBox4GraphWriter")}get x8c(){return null!=this.kGg?this.kGg:this.kGg=Fa.a.instance.Na("Box4.List.ISingleLevelListEditor")}get lj(){return null!=this.THg?this.THg:this.THg=Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Ch(){return null!=this.tIg?this.tIg:this.tIg=Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Ld(){return null!=this.bIg?this.bIg:this.bIg=Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get VW(){return null!=
this.jwg?this.jwg:this.jwg=Fa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get tYf(){return null!=this.pFg?this.pFg:this.pFg=Fa.a.instance.Na("Box4.IPastedParagraphSpaceHandler")}get M_i(){return!1}oXh(){}get MTc(){return!1}B_i(b){var k=void 0===this.Di.ux||null===this.Di.ux?"not available":Object(ls.a)(Zt.a,this.Di.ux);v.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.Di.ux,k);v.ULS.shipAssertTag(6305487,307,hf.SelectionEditor.gf(this.lFa));if(this.o5d)return v.ULS.sendTraceTag(6305488,
307,50,"NothingToPaste"),this.Di.n0a=Gf.SelectionFactory.ho(this.lFa),b.gi(this.Lmb),!0;if(!this.lFa.node)return v.ULS.sendTraceTag(572330334,307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;k=new ze.GraphIterator;k.set(this.lFa.node);hf.SelectionEditor.ku(k);ag.OutlineElementNavigator.Vd(k);this.bzj=k.origin;if(this.M_i)return k.At(10),this.oXh(k,b),b.gi(this.Rko),!0;this.hZ&&this.hZ.sjn(this.lFa);if(!this.Wyo(this.lFa))return this.Di.tR&&(this.Di.tR.fail("SplitLine Failed",
!0),this.Di.failed=!0),this.Di.n0a=Gf.SelectionFactory.ho(this.lFa),b.gi(this.Lmb),!0;const t=new Vk.a;t.Yc(k);ag.OutlineElementNavigator.Ur(t,!1,!1);this.SRa=new pB.a(k);this.alf=new pB.a(t);b.gi(this.rzn);return!0}Upj(){return!1}get nyi(){return this.K.$("PptCcpFix2IsEnabled")}get Mpo(){return this.K.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}SIm(b,k){return!k&&!!b&&va.OutlineElementReader.Bh(b.mva)&&va.OutlineElementReader.Oeb(b.mva)}vLm(b,k){return!k&&!!b&&va.OutlineElementReader.Bh(b.xkb)&&
va.OutlineElementReader.Oeb(b.xkb)}aDn(b){Mn.s1i&&b&&Mn.s1i.TGn(b)}mqo(b,k,t){var D;dg.ListItemReader.sh(b)?(null===(D=this.x8c)||void 0===D?void 0:D.mzf(b),k=dg.ListItemReader.sh(k)?this.lpj:!0):va.OutlineElementReader.isEmpty(b,!0)&&!t?(Mn.lg.N_a(b),k=!1):k=!0;this.hZ&&(k=this.hZ.kVk(b,k));return k}nqo(b,k){return dg.ListItemReader.sh(b)||1===k?!0:!1}Aan(b,k,t,D){const P=dg.ListItemReader.sh(b);if(P){if(D=new Vk.a,D.Yc(b),ag.OutlineElementNavigator.Ur(D,!1,!1),D.Nn.id!==k.Nn.id){t=this.Gd.hw(b);
this.Gd.nR(b);var ca=b.currentNode.ia(Cc.a.listID,0);b.uc();var ta=this.Gd.Asj,Na=!0;for(t.OB=Wg.a.rl;D.currentNode.id!==k.currentNode.id;){if(!ta||!va.OutlineElementReader.Tro(D))if(!dg.ListItemReader.sh(D))wl.a.getInstance().Yt?(va.OutlineElementReader.IQc(D)||({lwa:t}=this.Un.Ola(t.propertySet,D,t)),this.Un.Y9()):{lwa:t}=this.Un.Ola(t.propertySet,D,t),Na=!1;else if(P){Na=this.Gd.mrf(D);var qb=this.Gd.Dx(b.currentNode,ca,Na);qb=qb?Lq.a.I7(qb,null):t;Na=Lq.a.uT(qb.listType,t.listStyle,null,0,Na,
"","");Na.Glb=b.currentNode;this.Un.yjo(Na);this.Un.Dge(D,!0);Na=!1}ag.OutlineElementNavigator.Ur(D,!1,!1)}ta&&Na&&this.Un.gHk()}}else if(1===t)for(t=new Vk.a,t.Yc(b),ag.OutlineElementNavigator.Ge(t),b=pe.ParagraphReader.uh(t)?t.currentNode:null,ca=this.sc.$tf(t),ag.OutlineElementNavigator.Vd(t),ag.OutlineElementNavigator.Ur(t,!1,!1);t.currentNode.id!==k.currentNode.id;)ag.OutlineElementNavigator.Ge(t),ta=pe.ParagraphReader.uh(t)?t.currentNode:null,ag.OutlineElementNavigator.Vd(t),ta&&b&&D&&(ca&&
this.XG.HJ(ca,ta,!0),this.p6.hNi(b,ta,P),this.p6.YFa(b,ta,1,!0)),ag.OutlineElementNavigator.Ur(t,!1,!1)}VEk(b,k,t){var D=!1;if(this.Ld.qg)if(hi.a.pr)D=!0;else{var P=!1;this.hZ&&(P=k.currentNode,P=this.hZ.VNm(P)||this.hZ.YEf(P));P?this.Ld.V4a=4:D=!0}if(D){for(;b.currentNode!==t.currentNode;){ag.OutlineElementNavigator.Ge(b,!1);D=this.Ch.K8c(Of.a.create(b.currentNode));let ca;({type:ca}=D.GSd()).returnValue&&this.Ld.Js(ca);for(P=0;P<D.length;P++){let ta;const Na=({F_d:ta}=D.getContext(P)).returnValue;
ta&&(Mn.hyperlinkEditor.Alb(Na,1),this.lj.vob(Na,1,null,!0))}b.uc();ag.OutlineElementNavigator.Ur(b,!1,!1)}b.Yc(k);ag.OutlineElementNavigator.Ur(b,!1,!1)}}Fbm(b,k){b=ze.GraphIterator.$a(b);ag.OutlineElementNavigator.Ge(b);return pe.ParagraphReader.Wb(b.currentNode)?(k=k?pe.ParagraphReader.textLength(b.currentNode):0,Gf.SelectionFactory.te(b.currentNode,k)):Ih.TableReader.eY(b.currentNode)?Gf.SelectionFactory.uq(b.currentNode):null}onm(b){if(b){if(this.MTc&&Ih.TableReader.Yw(b)&&this.R1g){if(null!=
this.UEe&&0==this.UEe){var k=new Vk.a;k.Yc(b);ag.OutlineElementNavigator.Ur(k,!1,!1);b.Yc(k)}k=Ln.a.N1n(b);const t=pe.ParagraphReader.xl(k);k&&t&&(this.Di.n0a=Gf.SelectionFactory.te(t,0),b=ze.GraphIterator.$a(k))}else Mn.RNm&&Ln.a.zzn(b);b&&Ih.TableReader.Yw(b)&&mh.returnToContainingCell(b)&&Ln.a.Uyk(b.currentNode)}else v.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}Noo(b,k){const t=new ze.GraphIterator;t.Yc(b);b=ag.OutlineElementNavigator.Ge(t);k=pe.ParagraphReader.Wb(b)&&
k===pe.ParagraphReader.textLength(b);v.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",k);return k}Wyo(b){var k;v.ULS.shipAssertTag(6305498,307,hf.SelectionEditor.gf(b));if(null===(k=this.F_)||void 0===k?0:k.splitParagraph)return!!this.F_.splitParagraph(b.node,b.cpBegin,{Eb:b.Eb,Sb:b.Sb});k=ze.GraphIterator.$a(b.node);var t=k.yd();ag.OutlineElementNavigator.Vd(k);t&&b.isValid||v.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:t,
["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.isValid});if(!va.OutlineElementReader.Bh(k)&&(v.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.K.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;t=Mn.lg.aoa(k,!0);const D=this.Noo(k,b.cpBegin);Mn.lg.N9(k,t,b,!1,!1,!0,D);return!0}static get hyperlinkEditor(){return null!=Mn.tAg?Mn.tAg:Mn.tAg=Fa.a.instance.resolve("Box4.IHyperlinkEditor")}static get lf(){return Yg.PageReader.instance}static get lg(){return null!=
Mn.pEg?Mn.pEg:Mn.pEg=Fa.a.instance.resolve("Box4.IOutlineElementEditor")}static get Vn(){return wl.a.getInstance()}static get Xb(){return null!=Mn.Kyg?Mn.Kyg:Mn.Kyg=Fa.a.instance.Na("Box4.IFeatureHelper")}static get s1i(){return null!=Mn.vFg?Mn.vFg:Mn.vFg=Fa.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get Fzn(){return null!=Mn.oFg?Mn.oFg:Mn.oFg=Fa.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}static get xU(){null==this.ML&&(w.AFrameworkApplication.ue("he991617;3eed2178"),
this.ML=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.ML}static get RNm(){null==this.KFe&&(w.AFrameworkApplication.ue("PasteTableBelowTableNewExperience;PasteTableBelowTableNewExperienceCf"),this.KFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBelowTableNewExperienceIsEnabled",!1):!1);return this.KFe}}Mn.ML=null;Mn.KFe=null;
Object(n.a)(Mn,"APasteExecutionManager",null,[]);class et{constructor(b){this.Kj=b}reset(){this.Kj.reset()}get NIc(){return this.Kj.NIc}tca(b,k){this.Kj.tca(b,k)}sca(b){this.Kj.sca(b)}imb(b){this.Kj.imb(b)}qxa(b){this.Kj.qxa(b)}nGa(b){this.Kj.nGa(b)}tRa(b,k){this.Kj.tRa(b,k)}sRa(){this.Kj.sRa()}$D(b){this.Kj.$D(b)}qF(){this.Kj.qF()}dmb(){this.Kj.dmb()}cmb(){this.Kj.cmb()}uxa(b){this.Kj.uxa(b)}sxa(){this.Kj.sxa()}sGa(b){this.Kj.sGa(b)}txa(){this.Kj.txa()}D4a(b){this.Kj.D4a(b)}b9(b){this.Kj.b9(b)}Z8(){this.Kj.Z8()}G4(b){this.Kj.G4(b)}a9(){this.Kj.a9()}Y8(b){this.Kj.Y8(b)}X8(){this.Kj.X8()}yRa(b,
k){this.Kj.yRa(b,k)}B4a(){this.Kj.B4a()}}Object(n.a)(et,"AHtmlNormalizer",null,[494,484]);class mw extends et{constructor(b){super(b);this.CJ=!1}tca(b,k){this.CJ?this.RM.oM(()=>{this.z0f(b,k)}):this.z0f(b,k)}z0f(b,k){this.Kj.tca(b,k)}sca(b){this.CJ?this.RM.oM(()=>{this.a0f(b)}):this.a0f(b)}a0f(b){this.Kj.sca(b)}qxa(b){this.CJ?this.RM.oM(()=>{this.L1c(b)}):this.L1c(b)}L1c(b){this.Kj.qxa(b)}nGa(b){this.CJ?this.RM.oM(()=>{this.$_f(b)}):this.$_f(b)}$_f(b){this.Kj.nGa(b)}tRa(b,k){this.CJ?this.RM.oM(()=>
{this.V_f(b,k)}):this.V_f(b,k)}V_f(b,k){this.Kj.tRa(b,k)}sRa(){this.CJ?this.RM.oM(Object(A.a)(this,this.U_f,"processAnchorEnd")):this.U_f()}U_f(){this.Kj.sRa()}$D(b){this.CJ?this.RM.oM(()=>{this.l0f(b)}):this.l0f(b)}l0f(b){this.Kj.$D(b)}qF(){this.CJ?this.RM.oM(Object(A.a)(this,this.k0f,"processParagraphEnd")):this.k0f()}k0f(){this.Kj.qF()}dmb(){this.CJ?this.RM.oM(Object(A.a)(this,this.o0f,"processPreFormattedTextStart")):this.o0f()}o0f(){this.Kj.dmb()}cmb(){this.CJ?this.RM.oM(Object(A.a)(this,this.n0f,
"processPreFormattedTextEnd")):this.n0f()}n0f(){this.Kj.cmb()}uxa(b){this.CJ?this.RM.oM(()=>{this.e0f(b)}):this.e0f(b)}e0f(b){this.Kj.uxa(b)}sxa(){this.CJ?this.RM.oM(Object(A.a)(this,this.b0f,"processListEnd")):this.b0f()}b0f(){this.Kj.sxa()}sGa(b){this.CJ?this.RM.oM(()=>{this.d0f(b)}):this.d0f(b)}d0f(b){this.Kj.sGa(b)}txa(){this.CJ?this.RM.oM(Object(A.a)(this,this.c0f,"processListItemEnd")):this.c0f()}c0f(){this.Kj.txa()}b9(b){this.CJ?this.RM.oM(()=>{this.y0f(b)}):this.y0f(b)}y0f(b){this.Kj.b9(b)}Z8(){this.CJ?
this.RM.oM(Object(A.a)(this,this.v0f,"processTableEnd")):this.v0f()}v0f(){this.Kj.Z8()}G4(b){this.CJ?this.RM.oM(()=>{this.x0f(b)}):this.x0f(b)}x0f(b){this.Kj.G4(b)}a9(){this.CJ?this.RM.oM(Object(A.a)(this,this.w0f,"processTableRowEnd")):this.w0f()}w0f(){this.Kj.a9()}Y8(b){this.CJ?this.RM.oM(()=>{this.u0f(b)}):this.u0f(b)}u0f(b){this.Kj.Y8(b)}X8(){this.CJ?this.RM.oM(Object(A.a)(this,this.t0f,"processTableCellEnd")):this.t0f()}t0f(){this.Kj.X8()}yRa(b,k){this.CJ?this.RM.oM(()=>{this.g0f(b,k)}):this.g0f(b,
k)}g0f(b,k){this.Kj.yRa(b,k)}B4a(){this.CJ?this.RM.oM(Object(A.a)(this,this.e3i,"processMathEnd")):this.e3i()}e3i(){this.Kj.B4a()}}Object(n.a)(mw,"AQueuingHtmlNormalizer",et,[]);var ko=c(1942);class gA{constructor(){this.vOe=new ko.a}oM(b){this.vOe.enqueue(b)}flush(b=!1){for(b&&this.Tfe();!this.vOe.isEmpty;)this.vOe.dequeue()();b&&this.Mde()}Tfe(){}Mde(){}}Object(n.a)(gA,"QueuedEventManager",null,[]);class ft extends gA{constructor(b){super();this.id=void 0;this.Wbf=null;this.SYd=!1;this.qpa="";this.RYd=
this.KZd=!1;this.Mbf=this.V3b=null;this.oZc=0;this.xUc=this.bWc=this.NGf=!1;this.table=null;this.oQf=0;this.AZ=b}get SDc(){return!!this.table}Tfe(){this.AZ.dfc.push(this.AZ.currentState);this.AZ.currentState=this}Mde(){this.AZ.currentState=this.AZ.dfc.pop()}}ft.nextId=void 0;Object(n.a)(ft,"ContentState",gA,[]);class qB{constructor(b,k,t){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.f3a=b.f3a;this.shadingColor=b.shadingColor;this.verticalAlignment=b.verticalAlignment;
this.gja=b.gja;this.xke=b.xke;this.ubc=b.ubc;this.t7=b.t7;this.contents=t;this.Jim=k}}Object(n.a)(qB,"TableCell",null,[]);var rB=c(1671),Cs=c(1672);class Gg extends gA{constructor(b,k){super();this.AZ=b;this.Ihh=new uv.a;this.Uja=new uv.a;this.KJe=[];this.ktd=[];this.OJa=-1;this.jVa=0;this.W6j=k.DBf;this.V6j=k.QEm;this.rkk=k.shg;this.sq=k.width;this.G1g=k.f3a;this.a4j=new Ri.a(new Pt(k.f9.Tni,k.f9.nVd),k.vB,k.mpa,k.cultureName,k.VBa);this.P5j=k.$Vd;this.Lvd=k.styleId;this.wkk=k.tableLook}get Kj(){return this.AZ.Kj}uEn(b){this.OJa++;
this.Ihh.add(b);this.ktd[this.OJa]=b.height;this.jVa=0}get Mel(){for(;this.jVa>=this.Uja.count;)this.Uja.add(Array(this.OJa+1));return this.Uja.J(this.jVa)}Zpk(b,k,t,D,P,ca,ta){if(0>this.OJa)return!1;for(;this.KJe[this.jVa]>=this.OJa;)this.jVa++;b=new qB(b,new Ri.a(k,t,D,P,ca),ta);this.Mel[this.OJa]=b;if(1<b.rowSpan)for(k=this.OJa+b.rowSpan-1,D=this.jVa,t=this.jVa+b.colSpan-1;D<=t;D++)this.KJe[D]>=k||(this.KJe[D]=k);this.jVa+=b.colSpan;this.ktd[this.OJa]<b.height&&(this.ktd[this.OJa]=b.height);return!0}Tfe(){this.AZ.currentState.table=
this}Mde(){this.AZ.currentState.table=null}c0h(){w.AFrameworkApplication.ue("fd8b6402;j6e17681");this.flush(!0);const b=this.OJa+1;var k=Array(b);for(var t=0;t<b;t++)k[t]=Array(this.Uja.count);t=!0;var D=0;for(var P=0;P<this.Uja.count;P++){var ca=this.Uja.J(P),ta=!0;for(var Na=0;Na<b;Na++){var qb=ca[Na];qb&&(ta=!1,k[Na][P+D]=new tu(qb.colSpan,qb.rowSpan,qb.width,qb.height,void 0,void 0,void 0,void 0,qb.f3a,qb.ubc))}ta?(this.Uja.removeAt(P),P--,++D):t=!1}if(!t){(k=this.G1g?this.AZ.Xzh(k,this.sq/100):
this.AZ.Xzh(k,1,this.sq))&&k.length!==this.Uja.count&&(k=null);this.AZ.ggb(!0);this.AZ.YDd();this.Kj.b9(new gz(b,this.Uja.count,this.sq,this.G1g,k,this.W6j,this.V6j,this.rkk,this.P5j,this.Lvd,this.wkk,this.a4j));for(k=0;k<b;k++){t=this.Ihh.J(k);this.Kj.G4(new aA(this.ktd[k],new Ri.a(t.f9,t.vB,t.mpa,t.cultureName,t.VBa)));for(t=0;t<this.Uja.count;t++){D=this.Uja.J(t)[k];var Jb=!!this.Lvd&&""!==this.Lvd&&"Custom"!==this.Lvd;P=D?D.colSpan:0;ca=D?D.rowSpan:0;D&&(P=Math.min(D.colSpan,this.Uja.count-t),
ca=Math.min(D.rowSpan,b-k));ta=D?D.width:0;Na=D?D.height:0;qb=D?D.t7:0;const Vb=D?D.f3a:!1,ac=D&&(65536&qb||!Jb)?D.shadingColor:"",yc=D?D.verticalAlignment:0,Kc=D?D.ubc:!1;Jb=D?this.AZ.z3l(D.gja,t,k,this.Uja,Jb,D.t7):new rB.a;const ed=D?D.xke:new Cs.a,sd=D?D.Jim:null;this.Kj.Y8(new tu(P,ca,ta,Na,ac,yc,Jb,ed,Vb,Kc,qb,new Ri.a(sd?sd.f9:null,sd?sd.vB:null,sd?sd.mpa:null,sd?sd.cultureName:null,sd?sd.VBa:null)));D&&!D.ubc&&(D.contents.Tfe(),D.contents.flush(),this.AZ.ggb(!1),this.AZ.YDd(),D.contents.Mde());
this.Kj.X8()}this.Kj.a9()}this.Kj.Z8();this.AZ.currentState.xUc=!1;this.AZ.fWh(!1)}}}Object(n.a)(Gg,"NormalizedTable",gA,[]);class hA{constructor(b=!1,k=!1){this.F7j=b;this.ila=k}get KKm(){return this.F7j}get R6a(){return this.ila}}Object(n.a)(hA,"HtmlNormalizerSettings",null,[501]);class Ng extends mw{constructor(b,k=null){super(b);this.DGe=null;this.dfc=new Zk;this.lVb=k||new hA}reset(){super.reset();this.currentState=new ft(this);this.dfc.clear();this.CJ=!1}get RM(){return this.currentState&&this.currentState.SDc?
this.currentState.table:this.currentState}oKd(b=!1){this.currentState.SYd||(this.YDd(),this.Kj.$D(this.currentState.Wbf),this.currentState.SYd=!0,this.currentState.xUc=!1);b||!this.currentState.V3b||this.currentState.RYd||(this.Kj.tRa(this.currentState.V3b,this.currentState.Mbf),this.currentState.RYd=!0)}KKc(){this.currentState.RYd&&(this.Kj.sRa(),this.currentState.RYd=!1)}sul(){this.currentState.SYd&&(this.Kj.qF(),this.currentState.SYd=!1,this.currentState.qpa="")}fWh(b){this.currentState.bWc&&(this.currentState.xUc?
b||(this.Kj.$D(null),this.Kj.qF(),this.Kj.txa(),this.currentState.bWc=!1):(this.Kj.txa(),this.currentState.bWc=!1,this.currentState.xUc=!0))}ggb(b){this.KKc();this.sul();this.fWh(b)}$un(b){this.Kj.uxa(new es.a(2,1,b));this.currentState.oZc++;this.currentState.NGf=!0}YDd(){!this.currentState.bWc&&this.currentState.NGf&&(this.Kj.sxa(),this.currentState.oZc--,this.currentState.NGf=!1)}z0f(b,k){b=this.Mfn(b);if(""!==b)if(this.oKd(),this.currentState.KZd)this.A0f(b,k);else{b=b.split(Ng.HOk);for(let t=
0;t<b.length-1;t++)this.A0f(b[t],k),this.Kj.imb(k);this.A0f(b[b.length-1],k)}}g0f(b,k){""!==b&&(this.oKd(),this.Kj.yRa(b,k))}a0f(b){this.lVb.R6a||this.KKc();this.oKd(!0);this.Kj.sca(b)}$_f(b){this.currentState.SDc||this.Kj.nGa(b)}L1c(b){this.currentState.V3b&&(b.href=this.currentState.V3b);super.L1c(b)}V_f(b,k){this.KKc();this.currentState.V3b=b;this.currentState.Mbf=k}U_f(){this.KKc();this.currentState.V3b=null;this.currentState.Mbf=null}l0f(b){this.currentState.Wbf=b;this.ggb(!0)}k0f(){this.currentState.Wbf=
null;this.ggb(!0)}o0f(){this.currentState.KZd=!0}n0f(){this.currentState.KZd=!1}e0f(b){this.ggb(!1);this.YDd();this.Kj.uxa(b);this.currentState.oZc++}b0f(){this.ggb(!1);this.Kj.sxa();this.currentState.oZc--}d0f(b){this.ggb(!1);this.currentState.oZc||this.$un(b);this.Kj.sGa(b);this.currentState.bWc=!0;this.currentState.xUc=!0}c0f(){this.ggb(!1)}b9(b){this.currentState.SDc||(this.CJ=!0,this.currentState.table=new Gg(this,b))}y0f(){}Z8(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=
null;this.dfc.isEmpty?(this.CJ=!1,b.c0h()):this.RM.oM(Object(A.a)(b,b.c0h,"flushTable"))}}v0f(){}G4(b){this.currentState.SDc&&this.currentState.table.uEn(b)}x0f(){}a9(){}w0f(){}Y8(b){let k=!1;if(this.currentState.SDc){const t=new ft(this);this.currentState.table.Zpk(b,new Pt(b.f9.Tni,b.f9.nVd),b.vB,b.mpa,b.cultureName,b.VBa,t)?(this.dfc.push(this.currentState),this.currentState=t):k=!0}else k=!0;k&&this.currentState.oQf++}u0f(){}X8(){0<this.currentState.oQf?this.currentState.oQf--:this.currentState=
this.dfc.pop()}t0f(){}Xzh(b,k=1,t=0){if(!b)return null;const D=b.length;if(!D)return null;const P=b[0].length;for(var ca=1;ca<D;ca++)if(b[ca].length!==P)return null;ca=Array(P+1);ca[0]=0;const ta=Array(P+1);for(var Na=0;Na<ta.length;Na++)ta[Na]=!1;const qb=new Eb.a;Na=0;for(let Vb=0;Vb<P;Vb++){for(var Jb=0;Jb<D;Jb++){const ac=b[Jb][Vb];if(ac&&0<ac.width){const yc=Math.min(Vb+ac.colSpan,P);ca[yc]=ca[Vb]+ac.width*(ac.f3a?k:1);ta[yc]=!0}}if(ta[Vb+1]){Jb=ca[Vb+1]-ca[Vb];if(0>=Jb)return null;qb.add(Jb)}else ca[Vb+
1]=ca[Vb],0<t&&this.xBi&&(qb.add(-1),Na++)}b=qb.toArray();if(0<Na&&0<t&&this.xBi)for(v.ULS.sendTraceTag(509125462,3022,50,"CalculateTableWidths: All Table Column width not set"),t=(t-ca[ca.length-1])/Na,k=0;k<b.length;k++)-1===b[k]&&(b[k]=t);return b}get xBi(){null==this.DGe&&(w.AFrameworkApplication.ue("2i46g603;2fc7g589"),this.DGe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1):!1);return this.DGe}n9m(b,
k){1&k||(b.borderTopStyle=12);16&k||(b.borderRightStyle=12);256&k||(b.borderBottomStyle=12);4096&k||(b.borderLeftStyle=12);return b}z3l(b,k,t,D,P,ca){if(!b)return null;P&&(b=this.n9m(b,ca));if(0>t||0>k||k>D.count-1)return b;0<=k-1&&t<=D.J(k-1).length-1&&1===b.borderLeftStyle&&(P=D.J(k-1)[t])&&1!==P.gja.borderRightStyle&&(b.borderLeftStyle=P.gja.borderRightStyle,b.borderLeftColor=P.gja.borderRightColor,b.borderLeftWidth=P.gja.borderRightWidth);0<=t-1&&t<=D.J(k).length-1&&1===b.borderTopStyle&&(k=D.J(k)[t-
1])&&1!==k.gja.borderBottomStyle&&(b.borderTopStyle=k.gja.borderBottomStyle,b.borderTopColor=k.gja.borderBottomColor,b.borderTopWidth=k.gja.borderBottomWidth);return b}Mfn(b){this.currentState.KZd||(b=this.lVb.KKm?b.replace(Ng.usm," "):b.replace(Ng.tsm," "));b.startsWith(" ")&&(this.currentState.qpa.endsWith(" ")||""===this.currentState.qpa)&&(b=F.a.substring(b,1,b.length));return b}A0f(b,k){""!==b&&(this.Kj.tca(b,k),this.currentState.qpa+=b)}}Ng.tsm=RegExp("[ \t\f\u200b\r\n]+","g");Ng.usm=RegExp("[ \f\u200b\r\n]+",
"g");Ng.HOk="\t";Object(n.a)(Ng,"DefaultHtmlNormalizer",mw,[]);class Ux extends Ng{constructor(b,k,t){super(b,t);this.IXg=!1;this.Stb=k}static hHm(b){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&b?(b=Ux.Ojl.exec(b))&&0<b.length:!1}L1c(b){this.Stb.Ffc&&(w.AFrameworkApplication.Noa?this.IXg||(b=new Uc.StandardDialog,b.Ad=0,b.Ee(1,CommonUIStrings.l_DialogClose),b.Gu(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,
1,null),this.IXg=!0):this.Stb.oMi?this.Stb.J3d=!0:b.src&&""!==b.src?ia.a.getOrigin(b.src)!==ia.a.getOrigin(window.location.href)||Ux.hHm(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?w.AFrameworkApplication.va.processAction(Pb.a.H_i,2):b.src.startsWith("webkit-fake-url")?w.AFrameworkApplication.va.processAction(Pb.a.G_i,2):(this.KKc(),this.oKd(!0),this.Kj.qxa(b)):w.AFrameworkApplication.va.processAction(Pb.a.J_i,2):w.AFrameworkApplication.va.processAction(Pb.a.I_i,2))}}Ux.Ojl=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");
Object(n.a)(Ux,"Box4HtmlNormalizer",Ng,[]);class ih{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){this.htmlProcessor=b;this.Pyf=k;this.DTk=t;this.YJj=D;this.DGl=P;this.Pao=ca;this.Qao=ta;this.mVd=Na;this.msm=qb;this.psm=Jb;this.IYm=Vb}}Object(n.a)(ih,"ExecutePasteArguments",null,[]);class Iy extends Mn{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed,sd,oe){super(k,t,D,Jb,ac,ed,oe);this.xka=null;this.Ffn=Ld=>{this.nkd.GDi(this.Nka)&&w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordRemoveSpacesAfterEndFragmentSettings");
this.Dik&&this.nkd.qLo(this.Nka);Ld.gi(this.zEn);return!0};this.zEn=Ld=>{if(this.Rhk){const Od=this.Nka.getElementsByTagName("style");if(Od&&0<Od.length){v.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let ie=0;ie<Od.length;ie++)this.Tze.I5k(this.Nka,Od[ie]),Od[ie]&&(Od[ie].parentNode.removeChild(Od[ie]),ie--)}}Ld.gi(this.Y5k);return!0};this.Y5k=(Ld,Od)=>{this.gXe.value.create(Od.YJj).process(this.Nka,Ld);(Od=Fa.a.instance.Na("Box4.IFeatureHelper"))&&
Od.isFeatureEnabled(11)?Ld.gi(this.b5k):Ld.gi(this.Y2i);return!0};this.b5k=(Ld,Od)=>{(new oB(Od.DTk)).process(this.Nka,Ld);Ld.gi(this.Y2i);return!0};this.Y2i=(Ld,Od)=>{Od.htmlProcessor.process(this.Nka,Ld);Ld.gi(Od.Pyf&&Od.Pyf.Ffc?this.SMb:this.rVh);return!0};this.SMb=(Ld,Od)=>{if(Od=Od.Pyf){let Ce=!1,hg=!1,Kg=!1,Hl=!1;var ie=-1;const wm=new th.DictionaryPropertySet,bp=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');Object(ob.a)(138,this.Di.vd)?(Ce=this.Di.vd.ia(Cc.a.gha,!1),ie=this.Di.vd.ia(vd.a.gP,
""),Kg=this.Di.vd.ia(vd.a.b4,!1),Hl=this.Di.vd.ia(sf.a.Ewa,!1),bp.test(ie)&&(hg=!0),ie=this.Di.vd.ia(ke.a.Wfa,-1)):this.Di.ux&256&&this.Nka&&(Ce=!0,bp.test(this.Nka.innerHTML)&&(hg=!0));wm.setValue(Cc.a.gha,Ce);wm.setValue(vd.a.hWc,hg);wm.setValue(vd.a.b4,Kg);wm.setValue(ke.a.Wfa,ie);wm.setValue(sf.a.Ewa,Hl);Od.oge(wm);Od.bVf();Od.Dlb&&(this.Di.mUc=!0,this.Di.hzf=Od.xT,this.Di.ERf=Od.Dlb,Ce&&!Kg&&bf.c(Pb.a.uxl),w.AFrameworkApplication.va.processAction(Pb.a.SMb,2))}Ld.gi(this.rVh);return!0};this.rVh=
(Ld,Od)=>{cp.a.z6m(Od.YJj);cp.a.Q1m(Od.psm);cp.a.$4m(Od.Pao);cp.a.a5m(Od.Qao);cp.a.w2m(Od.IYm);Ld="Others";Od.mVd&&(Od.mVd.N1m(),Od.mVd.O1m(),Ld=Od.mVd.$ie);cp.a.P1m(Od.msm,Ld);cp.a.t1m(Od.DGl,Ld);return!1};this.Nka=b;this.Ite=P;this.zDe=ca;this.TTe=ta;this.gXe=Na;this.Wtc=qb;this.lVb=Kc;this.Ma=Vb;this.yYg=Object.assign(new Ix,{T$b:2===this.Di.m3b||3===this.Di.m3b});this.Tze=yc;this.nkd=sd;this.XYb=Vb.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.Rhk=Vb.$("ParseStyleFromRawHtmlHeadIsEnabled");
this.Dik=Vb.$("RemoveSpacesAfterEndFragmentIsEnabled")}get o5d(){return!1}get MTc(){return!0}nXh(b){this.xka=new ze.GraphIterator;this.SRa.restore(this.xka);v.ULS.shipAssertTag(6305550,307,va.OutlineElementReader.Bh(this.xka));this.Di.tR&&this.Di.tR.P0b("external");var k=this.Di.ux&8192?1:0,t=this.zDe.value.create(k,this.xka,this.Di.oGc,this.Di.Gnb);const D=this.TTe.value.create(k,this.xka),P=cp.a.V4h(w.AFrameworkApplication.userSessionId),ca=cp.a.zvf(w.AFrameworkApplication.userSessionId),ta=cp.a.dqf(aa.a.Jzb,
this.Di.oGc),Na=cp.a.Bfi(w.AFrameworkApplication.userSessionId),qb=cp.a.Cfi(w.AFrameworkApplication.userSessionId),Jb=this.XYb?this.zxm():null,Vb=cp.a.E9h(aa.a.Jzb,this.Di.oGc),ac=cp.a.F9h(w.AFrameworkApplication.userSessionId),yc=this.Wtc.Uoj?cp.a.x0l(w.AFrameworkApplication.userSessionId):null;k=this.Ite.value.create(k,this.xka,t,D,null,ta,this.OAk,this.Di.dle);k=new lC(k,Na,qb);k=new Ux(k,t,this.lVb);k=new Kk(k,this.Wtc,this.yYg,yc);k=new mC(k,Vb,Jb,this.Ma);k=new Yt(k,ac);t=new ih(k,t,P,ca,ta,
Na,qb,Jb,Vb,ac,yc);t=new vs.a(b,this.Ffn,t);t.Al("paste and request pictures");t.Ig=!b||b.Ig;t.run()}get OAk(){return this.Nka.getElementsByTagName("a").length}zxm(){const b=new ow;b.XKb=aa.a.Jzb;this.Di&&(b.ux=this.Di.ux,b.NWf=this.Di.oGc,this.Di.vd&&(b.progId=this.Di.vd.ia(vd.a.F_i,"")));this.Nka&&this.Nka.innerHTML&&(b.Gzn=this.Nka.innerHTML.length);w.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=w.AFrameworkApplication.sessionStartInfoSettings.Platform,b.SGf=w.AFrameworkApplication.K.$("IsO365ConsumerHost"),
b.Vti=pe.ParagraphReader.Jta(Wa.App.ya.gb.wc.ed));return b}get lpj(){return!0}get L7c(){v.ULS.shipAssertTag(6305551,307,!!this.xka);if(this.Wtc.Voj(this.yYg)){let b=!1;va.OutlineElementReader.Bh(this.xka)&&(this.xka.E_(),b=!0);const k=pe.ParagraphReader.uh(this.xka)&&!this.xka.currentNode.ia(vd.a.Zvi,!1);b&&this.xka.uc();return k}return pe.ParagraphReader.uh(this.xka)}}Object(n.a)(Iy,"ExternalPasteExecutionManager",Mn,[]);class sB{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac){this.W5b=ac;this.Ite=b;
this.zDe=k;this.TTe=t;this.gXe=D;this.Wtc=P;this.hZ=ca;this.Ma=ta;this.Tze=Na;this.lVb=qb;this.p6=Jb;this.nkd=Vb}create(b,k,t,D){return new Iy(b,k,t,D,this.Ite,this.zDe,this.TTe,this.gXe,this.Wtc.value,this.hZ,this.Ma,Wa.App.ya.gb,this.Tze,this.lVb,this.p6,this.nkd,this.W5b)}}Object(n.a)(sB,"Factory",null,[453]);class ix{GDi(b){if(!b||!b.childNodes)return!1;const k=b.childNodes.length;return 2>k?!1:this.hIm(b.childNodes[k-2])&&this.yTm(b.childNodes[k-1])}qLo(b){this.GDi(b)&&(b.removeChild(b.lastChild),
v.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}KFm(b){return!!b&&8===b.nodeType}VRm(b){return!!b&&3===b.nodeType}hIm(b){return this.KFm(b)&&"EndFragment"===b.nodeValue}yTm(b){if(!this.VRm(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(n.a)(ix,"HtmlNormalizerHelper",null,[451]);var Av=c(1931),pw=c(634);class iA extends Mn{constructor(b,k,t,D,P,ca,ta,Na,qb){super(b,k,t,P,ca,Na,qb);this.Pz=D;this.wI=ta}get ul(){return this.wI.value}get o5d(){return this.Pz.o5d()}get M_i(){const b=
this.Pz;return b.r9e&&!b.nsi()}oXh(b,k){v.ULS.shipAssertTag(6305616,307,Xh.OutlineReader.Zw(b));const t=pw.a(b.currentNode);if(Xh.OutlineReader.isEmpty(b)){var D=Of.a.create(b.currentNode);b.At(8);w.AFrameworkApplication.va.Nf(D,Pb.a.zH,2,!0,null,null)}else b.At(8);(D=b.iF(1))&&b.uc();this.Pz.w_i(this.Di.je,b.currentNode,D,-1,t,k)}nXh(b){const k=new ze.GraphIterator;this.SRa.restore(k);v.ULS.shipAssertTag(6305618,307,va.OutlineElementReader.Bh(k));this.Di.tR&&this.Di.tR.P0b("internal");let t=-1;if(Object(ob.a)(138,
this.Di.vd))t=this.Di.vd.ia(ke.a.Wfa,-1);else{const D=this.RRl(k.currentNode);t=D?D.clientWidth:t}this.Pz.w_i(this.Di.je,k.parentNode,k.currentNode,t,null,b);this.nyi&&(this.SRa.restore(k),va.OutlineElementReader.Bh(k)&&this.Pz.uBi(k)&&(b=ag.OutlineElementNavigator.Ge(k)))&&(this.Di.n0a=Gf.SelectionFactory.te(b,0))}RRl(b){return b?(b=b?b.De(this.ul.ic):null)?b.htmlElement:null:null}Upj(){const b=new ze.GraphIterator;this.SRa.restore(b);return this.Pz.uBi(b)}get lpj(){return!0}get L7c(){return!this.Pz.eva&&
!this.Pz.r9e}}Object(n.a)(iA,"InternalPasteExecutionManager",Mn,[]);class Jy{constructor(b,k,t,D,P){this.W5b=P;this.Pz=b;this.hZ=k;this.wI=t;this.p6=D}create(b,k,t){return new iA(b,k,t,this.Pz,this.hZ,Wa.App.ya.gb,this.wI,this.p6,this.W5b)}}Object(n.a)(Jy,"Factory",null,[450]);var lz;(function(b){b[b.unknown=0]="unknown";b[b.differentBox4App=1]="differentBox4App";b[b.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";b[b.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(lz||(lz={}));
Object(n.b)("CopySource",lz);class So{constructor(b,k,t,D){this.Pz=b;this.RZg=k;this.u1j=t;this.Ik=D}nzn(b,k,t){v.ULS.shipAssertTag(6305620,307,!!b);v.ULS.shipAssertTag(6305621,307,hf.SelectionEditor.gf(k));v.ULS.shipAssertTag(6305622,307,!!t);v.ULS.shipAssertTag(6305623,307,Object(ob.a)(Gy.a,t.kpa));const D=t.kpa;D.m3b=this.Pz.t6h(b);this.g2m(b,D);let P=!1;hi.a.vFd&&this.Ik.iha(k,Na=>P=Na)&&(D.ux|=8192,hi.a.wFd&&(D.dle=1,P||(D.dle|=2)));const ca=this.$Km(D);var ta=new Xd.GraphTransaction(7,Pb.a.paste);
ta.Cb(k.node);k.node.FH().jF.p7(8);ca?(v.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",D.ux,D.browserName),b=this.RZg.create(k,D,ta)):(v.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",D.ux,D.m3b,D.browserName),So.X1m(b),b=this.u1j.create(b,k,D,ta));t=new vs.a(t,Object(A.a)(b,b.B_i,"pasteSetup"),null);t.Al("Paste");t.run()}$Km(b){return!this.TNm(b)&&3===b.m3b}TNm(b){return 1===(b.ux&8192?1:0)}usi(b,k){v.ULS.shipAssertTag(6305624,307,
hf.SelectionEditor.gf(b));v.ULS.shipAssertTag(6305625,307,!!k);v.ULS.shipAssertTag(6305626,307,Object(ob.a)(Gy.a,k.kpa));const t=new Xd.GraphTransaction(7,Pb.a.QWd);t.Cb(b.node);b=this.RZg.create(b,k.kpa,t);k=new vs.a(k,Object(A.a)(b,b.B_i,"pasteSetup"),null);k.Al("InternalPasteAtIp");k.run()}g2m(b,k){if(b){let t=!1,D=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?D=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(t=!0);(t||D)&&v.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",
lz[k.m3b],t,D)}}static X1m(b){b&&So.Jnk.test(b.innerText)&&v.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}So.Jnk=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(n.a)(So,"PasteCoordinator",null,[]);class Cp{constructor(b,k,t,D,P){this.mva=b;this.xkb=k;this.Ezn=t;this.Dzn=D;this.MTc=P}}Object(n.a)(Cp,"PastedContentsPostProcessorParams",null,[]);class tB{Wxm(b,k,t,D,P,ca){b=this.xVl(b,k,P);t=this.h_l(t);
if(!b||!t)return null;D=this.v6l(b,D,P);P=this.u6l(t);return new Cp(b,t,D,P,ca)}xVl(b,k,t){b=t?b:k;if(!va.OutlineElementReader.Bh(b))return null;k=new Vk.a;k.Yc(b);return k}h_l(b){if(!va.OutlineElementReader.Bh(b))return null;const k=new Vk.a;k.Yc(b);ag.OutlineElementNavigator.p0(k,!1,!1);return k}v6l(b,k,t){ag.OutlineElementNavigator.Ge(b);let D=-1;pe.ParagraphReader.uh(b)&&(D=t?k:0);ag.OutlineElementNavigator.Vd(b);return D}u6l(b){ag.OutlineElementNavigator.Ge(b);const k=pe.ParagraphReader.uh(b)?
pe.ParagraphReader.textLength(b.currentNode):-1;ag.OutlineElementNavigator.Vd(b);return k}}Object(n.a)(tB,"PastedContentsPostProcessorHelper",null,[]);var jx=c(787),Ds=c(1080),vt=c(1079);class mz{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc=null){this.rpa=b;this.j9=k;this.yo=t;this.b2i=D;this.ta=P;this.S4a=ca;this.K=ta;this.szn=Na;this.yca=qb;this.lFb=Jb;this.oua=Vb;this.mb=ac;this.mha=yc;this.qOh=100;this.Gbc=!1;this.Iwe=null;this.tFe=!1;this.Qqd=null;this.Umd=this.UKa=!1;this.bEl=(Kc,ed)=>{this.Tw(ed.sAl)};
this.Yto=(Kc,ed)=>{this.r9k(Kc,ed)};this.sY=(Kc,ed)=>{ed.property===sf.a.lastModifiedTime?(v.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.lFb.Tbf.contains(Pb.a.Emg)||this.s2f(ed)):v.ULS.sendTraceTag(520734532,307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")};this.wKb=(Kc,ed)=>{this.s2f(ed)};this.Tha=(Kc,ed)=>{ed.rCf||this.s2f(ed)};this.PUi=()=>{jx.a.instance.keyCode===pc.a.mza&&this.j9.$4i()};this.Mzo()}Mzo(){this.j9.hqh(this.Yto);
this.j9.Pph(this.bEl)}r9k(b,k){var t,D,P;(null===(D=null===(t=this.mb.hb)||void 0===t?void 0:t.kb)||void 0===D?0:D.STc)?v.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):(this.S4a.OAf(),1===this.szn.F9k(k.$0c)?v.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",k.correlationId):this.showFloatie(b,k)?(this.UKa?this.UKa=!1:this.fWn(),this.v3c(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",
Pb.a.aU(k.yY)||"Unknown",k.correlationId),v.ULS.sendTraceTag(40379588,307,50,b),bf.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new na.a,{name:"PasteCommand",int64:Pb.a.aU(k.yY)||"Unknown"}),Object.assign(new na.a,{name:"CorrelationId",string:null===(P=k.correlationId)||void 0===P?void 0:P.toString()})]),this.vQb()):v.ULS.sendTraceTag(575255108,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",k.correlationId))}Tw(b){var k;!this.tFe&&(this.UKa||(this.mha?null===(k=this.oua)||void 0===
k?0:k.W_:this.rpa.W_()))&&(b&&(this.S4a.OAf(),this.XCj(),v.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.Qqd)),this.UKa=!b,this.Xme(),this.mha?w.AFrameworkApplication.va.processAction(Pb.a.HFb,2):this.rpa.Tw())}fWn(){this.Umd||(this.Iwe=this.yo.Bd,vf.a.addHandler(this.Iwe.container,"scroll",Object(A.a)(this,this.xNb,"scrollHandler")),this.ta.VZ(Object(A.a)(this,this.zia,"resizeHandler")),this.Umd=!0)}XCj(){this.Umd&&(vf.a.removeHandler(this.Iwe.container,
"scroll",Object(A.a)(this,this.xNb,"scrollHandler")),this.ta.Jca(Object(A.a)(this,this.zia,"resizeHandler")),this.Umd=!1)}vQb(){if(this.mha)this.oua.W_&&w.AFrameworkApplication.va.processAction(Pb.a.HFb,2),w.AFrameworkApplication.va.processAction(Pb.a.j8c,2),this.Gbc=!1;else{const b=new vt.a(0,w.AFrameworkApplication.isRtl);b.location=this.S4a.UOa();this.S4a.YIm(b.location)?this.showFloatie(null,b):this.j9.SGa(new Ds.a(!1))}}zia(){this.mha?(w.AFrameworkApplication.va.processAction(Pb.a.HFb,2),this.HIc()):
this.vQb()}xNb(){this.mha?(w.AFrameworkApplication.va.processAction(Pb.a.HFb,2),this.HIc()):this.vQb()}v3c(){this.b2i.Ewk(this.PUi);this.j9.Uph(Object(A.a)(this.rpa,this.rpa.$Kd,"expandFloatie"));this.j9.dqh(Object(A.a)(this,this.D_i,"pastedFloatieStatusChange"));this.yca.Ot(this.Tha);this.yca.Kw(this.wKb);this.yca.Fo(this.sY)}Xme(){this.b2i.j_n(this.PUi);this.j9.haj(Object(A.a)(this.rpa,this.rpa.$Kd,"expandFloatie"));this.j9.paj(Object(A.a)(this,this.D_i,"pastedFloatieStatusChange"));this.yca.PU(this.Tha);
this.yca.yia(this.wKb);this.yca.QU(this.sY)}D_i(b,k){this.tFe=k.RTc;k.yY&&(this.Qqd=k.yY);k.zdg&&this.rpa.W_()&&this.vQb()}s2f(b){b.node.loading||this.j9.SGa(new Ds.a(!0))}showFloatie(b,k){k||(k=new vt.a(0,w.AFrameworkApplication.isRtl));k.location||(k.location=this.S4a.UOa());if(!k.location)return!1;this.UKa&&(this.UKa=!1,this.v3c());this.mha?w.AFrameworkApplication.va.processAction(Pb.a.j8c,2):this.rpa.showFloatie(b,k);return!0}HIc(){if(!this.Gbc){const b=new Df.a(3,1,this.qOh,()=>{this.vQb()},
215);wb.a.instance.Vb(b);this.Gbc=!0}}}Object(n.a)(mz,"PasteFloatieEventManager",null,[]);class nz{constructor(b,k){this.hk=b;this.iI=k}F9k(b){return Xl.any(Xl.where(Xl.asEnumerable(nz.ECo),k=>this.iI.sVc(k)))?(b=this.hk.Gmb(b))&&(b=b.innerText)&&0<b.trim().length?0:1:1}}nz.ECo=[Pb.a.reformatPastedContent.toString(),Pb.a.hSa.toString(),Pb.a.$xa.toString()];Object(n.a)(nz,"PasteFloatieFeatureSetBuilder",null,[]);class uB{constructor(){this.Kxa=null;this.Afc=0}}Object(n.a)(uB,"PasteFloatieAnchorData",
null,[]);class kx{constructor(b,k,t,D,P,ca=!1){this.dwb=null;this.ib=b;this.eta=k;this.fd=t;this.e3j=D;this.WMe=P;this.UFe=ca}OAf(){this.dwb=null}UOa(){const b=this.Upf(this.dwb)||this.Jzh();if(!b){let k="null",t="null";if(this.dwb&&this.dwb.Kxa){if(!this.fd.Bd)return v.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;k=Object.getType(this.dwb.Kxa).getName();const D=this.fd.Bd.Qj(this.dwb.Kxa);D&&(t=Object.getType(D).getName())}v.ULS.shipAssertTag(40641054,
307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",k,t)}return b}YIm(b){if(!b)return!1;const k=this.WMe.WDb(),t=this.e3j(this.fd.Bd.container);b=new Sys.UI.Bounds(b.x,b.y,k.width,k.height);return b.y>=t.y&&b.y+b.height<=t.y+t.height}Jzh(){if(!this.ib||!this.ib.hb||!this.ib.hb.kb)return v.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var b=this.ib.hb.kb.Qa,k=!b.cpBegin&&!b.cpEnd;let t=b.node;if(t&&k){do t=this.Jdi(t);
while(t&&Object(ob.a)(Un.AParagraphNode,t)&&!t.characterData.trim().length)}let D="";const P=Object(Ka.a)(Un.AParagraphNode,t);P&&(D=P.characterData.length===b.cpBegin||k?P.characterData.trimEnd():P.characterData.substring(0,b.cpBegin).trimEnd());k=P?D.length:b.cpBegin;b=Object.assign(new uB,{Kxa:Object(Ka.a)(70,(P?Object(Ka.a)(70,P):Object(Ka.a)(70,t))||b.node),Afc:k});return this.Upf(b)}Jdi(b){const k=new ze.GraphIterator;if(!b.anchor)return null;k.set(b);if(!k.yd())return null;k.hd(11);return k.hJ()?
k.Rb(2):null}Upf(b){if(!b||!b.Kxa)return null;this.dwb=b;const k=this.fd.Bd;if(!k)return v.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.G9h(b,k);if(!b)return null;w.AFrameworkApplication.isRtl&&this.WMe.W_()&&(b.x-=this.WMe.WDb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}G9h(b,k){k=k.De(b.Kxa);if(!k)return null;let t=null;if(Object(ob.a)(Un.AParagraphNode,b.Kxa)){const D=Object(Ka.a)(100,k);if(!D)return null;try{t=this.eta.a_(b.Afc,
D,0<b.Afc,!1,!1,!1),t.height+=this.UFe?kx.nNn:kx.eEl}catch(P){v.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",P),t=null}}else Object(ob.a)(bt.TableNode,b.Kxa)&&(t=Object(Ka.a)(106,k).ruf());t||(t=k.getBounds());return t}}kx.eEl=2;kx.nNn=60;Object(n.a)(kx,"PasteFloatiePositionProvider",null,[]);class Es{constructor(b,k){this.rrc=b;this.bYj=k}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get w1h(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get pcf(){return CommonUIStrings.l_ClipboardCut}get PLf(){return CommonUIStrings.l_ClipboardCut_Mac}get o$e(){return CommonUIStrings.l_ClipboardCopy}get OLf(){return CommonUIStrings.l_ClipboardCopy_Mac}get qYf(){return CommonUIStrings.l_ClipboardPaste}get QLf(){return CommonUIStrings.l_ClipboardPaste_Mac}get k9(){return CommonUIStrings.l_ClipboardPasteText}get RLf(){return CommonUIStrings.l_ClipboardPasteText_Mac}get v7e(){return this.bYj}get mEh(){return CommonUIStrings.l_ClipboardExtensionLink}get Aeb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}FXh(){v.ULS.sendTraceTag(8716421,
307,50,null);$d.a.nm(this.v7e,"_blank",void 0,"ClipboardAccessExtensionLink")}Lca(b,k){let t=aa.a.el;w.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(t=aa.a.ti||t);return t?String.format(k,"\u2318"):b}dispose(){this.rrc=null}J2f(b){this.hJh(b)}qXm(b){this.hJh(b)}hJh(b){this.rrc&&this.rrc(b)}}Es.id="CopyPasteShortcutDialog";Es.xxj="CopyPasteText";Object(n.a)(Es,"ACopyPasteShortcutDialog",null,[9]);class qw extends Es{constructor(b,k,t){super(b,k);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";k=document.createElement("span");k.id=Es.xxj;var D=document.createElement("span");D.innerText=this.w1h;var P=document.createElement("span");P.className="UIFontBold";P.innerText=this.Lca(this.pcf,this.PLf);const ca=document.createElement("span");ca.className="UIFontBold";ca.innerText=this.Lca(this.o$e,this.OLf);const ta=document.createElement("span");ta.className="UIFontBold";ta.innerText=this.Lca(this.qYf,this.QLf);k.appendChild(D);k.appendChild(document.createElement("br"));
k.appendChild(P);k.appendChild(ca);k.appendChild(ta);t.$("PasteTextOnlyShortcutDialogIsEnabled")&&(aa.a.zq||aa.a.jj)&&(t=document.createElement("span"),t.className="UIFontBold",t.innerText=this.Lca(this.k9,this.RLf),k.appendChild(t));b.appendChild(k);this.v7e?(v.ULS.sendTraceTag(8716420,307,50,null),t=document.createElement("span"),k=document.createElement("a"),k.href="#",k.innerText=this.mEh,vf.a.addHandler(k,"click",Object(A.a)(this,this.FXh,"extensionLinkHandler")),t.appendChild(k),P=this.Aeb.indexOf("{0}"),
-1!==P&&(D=this.Aeb.substring(0,P),P=this.Aeb.substring(P+3,this.Aeb.length),D=document.createTextNode(D),P=document.createTextNode(P),t.insertBefore(D,k),t.appendChild(P)),b.appendChild(document.createElement("br")),b.appendChild(t)):v.ULS.sendTraceTag(8716422,307,50,null);t=new Uc.StandardDialog;t.Ad=0;t.vg=Es.id;t.Gu(this.titleText,null,0,Object(A.a)(this,this.qXm,"legacyCopyPasteShortcutDialogHandler"),b);t.Z4(Es.xxj)}}Object(n.a)(qw,"CopyPasteShortcutDialog",Es,[]);class oz extends Es{constructor(b,
k){super(b,k);k={};b=this.yBm;k.extensionStartText=this.jxl;k.extensionLink=null;k.extensionEndText=null;k.shortcutsMessageText=this.woo;k.cutText=this.Lca(this.pcf,this.PLf);k.copyText=this.Lca(this.o$e,this.OLf);k.pasteText=this.Lca(this.qYf,this.QLf);4!==w.AFrameworkApplication.ta.Nb.Sl&&(k.pasteTextOnly=this.Lca(this.k9,this.RLf));k={["id"]:"CopyPasteInstallDialog",["bodyControls"]:k};const t=new Wf.a(!1,!1,!0);t.vg="CopyPasteInstallDialog";t.Ad=0;t.Ee(1,this.xBm);t.XU(1);t.Wh(b,Object(A.a)(this,
this.J2f,"reactCopyPasteShortcutDialogHandler"),k)}get woo(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get xBm(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get yBm(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get jxl(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static Hso(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(n.a)(oz,"ReactCopyPasteInstallDialog",Es,[]);class vB extends Es{constructor(b){super(b,null);this.MEi="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var k={};b=this.Zen;var t="";let D="";this.messageText&&(t=this.messageText.split(" {")[0],D=this.messageText.split("} ")[1]);k.startText=t;k.endText=D;k.cutText=this.xfl;k.copyText=this.j6k;k.pasteText=this.vzn;
k.cutShortcutText=this.Lca(this.yfl,this.A7m);k.copyShortcutText=this.Lca(this.t6k,this.z7m);k.pasteShortcutText=this.Lca(this.yzn,this.C7m);k.imageSrc=Ye.a.Oaa("NoClipboardAccessDialogImage.svg");k.imageAltText=this.imageAltText;k.primaryButtonLabel=this.oFn;this.MEi&&(v.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),k.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.Ekb,["onExecute"]:()=>{this.kXm()}});k={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:k};
t=new Wf.a(!1,!1,!0);t.Ad=0;t.vg="CopyPasteNoClipboardAccessDialog";t.Wh(b,Object(A.a)(this,this.J2f,"reactCopyPasteShortcutDialogHandler"),k)}get Zen(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get Ekb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get oFn(){return CommonUIStrings.l_DialogOk}get xfl(){return CommonUIStrings.l_CutString}get yfl(){return CommonUIStrings.l_CutShortcut}get A7m(){return CommonUIStrings.l_CutShortcut_Mac}get j6k(){return CommonUIStrings.l_CopyString}get t6k(){return CommonUIStrings.l_CopyShortcut}get z7m(){return CommonUIStrings.l_CopyShortcut_Mac}get vzn(){return CommonUIStrings.l_PasteString}get yzn(){return CommonUIStrings.l_PasteShortcut}get C7m(){return CommonUIStrings.l_PasteShortcut_Mac}kXm(){v.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");$d.a.nm(this.MEi,"_blank",void 0,"learnMoreLink")}}Object(n.a)(vB,"ReactCopyPasteNoClipboardAccessDialog",Es,[]);class wB extends Es{constructor(b,k,t){super(b,k);b={};b.forwardElementText=this.w1h;b.cutText=this.Lca(this.pcf,this.PLf);b.copyText=this.Lca(this.o$e,this.OLf);b.pasteText=this.Lca(this.qYf,this.QLf);t.$("PasteTextOnlyShortcutDialogIsEnabled")&&(aa.a.zq||aa.a.jj)&&(b.pasteTextOnly=this.Lca(this.k9,this.RLf));this.v7e?(v.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.mEh,["onExecute"]:D=>{this.FXh(D)}},t=this.Aeb.indexOf("{0}"),-1!==t&&(b.suggestionPrefixElement=this.Aeb.substring(0,t),b.suggestionSuffixElement=this.Aeb.substring(t+3,this.Aeb.length))):v.ULS.sendTraceTag(40726915,307,50,null);t={["id"]:Es.id,["bodyControls"]:b};b=new Wf.a(!1,!1,!0);b.Ad=0;b.vg=Es.id;b.Wh(this.titleText,Object(A.a)(this,this.J2f,"reactCopyPasteShortcutDialogHandler"),t)}}Object(n.a)(wB,"ReactCopyPasteShortcutDialog",
Es,[]);class rw{constructor(){this.VKa=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nF}Q$e(b,k,t=!1){v.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.VKa,t));this.VKa?t?new oz(b,k):new wB(b,k,w.AFrameworkApplication.K):new qw(b,k,w.AFrameworkApplication.K)}static get instance(){return rw._instance||(rw._instance=new rw)}}rw._instance=null;Object(n.a)(rw,"CopyPasteShortcutDialogFactory",null,[973]);class jA{constructor(b,k,t,D,
P,ca,ta,Na){this.xfh=this.K0g=this.YSe=!1;this.kkk=b;this.fd=k;this.Mt=t;this.Ub=D;this.Ae=P;this.fg=ca;this.Se=ta;Na&&(this.xfh=Na.$("ShouldLogExecCommandCopySuccess"))}get ETa(){return this.kkk}get X2a(){return this.K0g}set X2a(b){this.K0g=b;this.fg.ignoreClipboardEvents=b}LKc(b){this.ETa.LKc(b);b||this.S9c(!0)}get rul(){return this.ETa.G7f}prepareForPaste(b){this.X2a=!0;this.ETa.prepareForPaste(b,this.Thg)}reset(){this.X2a=!1}paste(){var b=null;let k=null;if(!this.ETa.fRb){(b=this.fd.Bd)&&this.Ub.mg(b.$I);
var t=this.Mt.ru;if(!t.qe||!t.editingView.Sj)return null;k=t.editingView;b=this.Ae.gw();this.X2a=!0;t.$7a()}t=null;try{k&&k.aEn(),t=b=this.ETa.$Kc(this.Thg,b)}catch(D){v.ULS.shipAssertTag(6305672,307,!1),this.yki()}this.X2a=!1;return t}copy(){var b=this.fd.Bd;b&&this.Ub.mg(b.$I);b=this.Mt.ru;if(!b.qe||1!==b.editingView.mode)return!1;this.X2a=!0;let k;try{const t=new Map;t.set("View","ContentEditableView");xa.Health.instance.recordKpiUsage(or.a.f2b,0,or.a.RCd,t);const D=this.ETa.wif(this.Thg);k=!0;
this.xfh&&v.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",D,this.Se.bG);if(!D){const P=Object.assign(new Db.a,{extendedProperties:t});xa.Health.instance.recordKpiFailure(or.a.f2b,or.a.U5e,!0,!0,P)}}catch(t){v.ULS.shipAssertTag(6305673,307,aa.a.jj),v.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",aa.a.bG),k=!1}this.X2a=!1;return k?!0:!1}S9c(){if(this.YSe)return!0;var b=this.Mt.ru;if(!b.qe||!b.editingView.Sj)return!1;
const k=b.editingView;b=this.Ae.gw();this.X2a=!0;const t=new Ox.a(b);let D=!1;try{D=this.ETa.S9c(b,()=>{k.KDd()},()=>{k.oHa()})}catch(P){}t.restore();this.X2a=!1;D?this.YSe=!0:(v.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",aa.a.bG),this.yki());return D}yki(){this.YSe=!1;if(w.AFrameworkApplication.u0o)rw.instance.Q$e(null,null);else{const b=new Uc.StandardDialog;b.Ad=0;b.$U(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,
null)}}get Thg(){const b=this.Ae.qhb();return b?b.Qn:null}}Object(n.a)(jA,"SystemClipboard",null,[449]);class ol{constructor(b,k,t){this.vxd=!1;this.Vxd=this.MS=this.B3g=this.fve=this.ifd=null;this.FCn=D=>{1===D?(v.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.Uue)),this.p_b&&(v.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.p_b)),$d.a.nm(this.LBe+this.cLe,"_blank",void 0,"ChromeCCPInstallDialog"))):D||v.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",
this.Uue))};this.Uue=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");this.LBe=b.jb("ChromeClipboardAccessExtensionLink");this.y$a=k;this.hk=t;this.cLe=b.jb("ChromeClipboardAccessExtensionId");this.Omk=b.$("UseGetClipboardDataIsEnabled");this.Lbh=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.p_b=!1;b.$("CcpInstallDialogIsEnabled")&&w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nF&&(this.p_b=oz.Hso()||b.$("IgnoreDomainCheckCcpInstallDialog"),v.ULS.sendTraceTag(587314304,
307,50,"_useInstallDialog: {0}",this.p_b));this.ysc=null}LKc(b){b?this.MS=!0:(this.MS=null,chrome.runtime&&chrome.runtime.sendMessage?(this.ysc=this.y$a.tHd,this.y$a.uOb?(this.vxd=this.Omk,this.uCh()):(this.vxd=!0,this.uCh(),v.ULS.sendTraceTag(19256732,307,50,X.a.create().toString()))):(this.POb(),this.MS=!1))}get G7f(){return this.MS}get fRb(){return this.Vxd}S9c(){return!0}wif(b){v.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(b=$d.a.BCb(b,"copy"))||v.ULS.sendTraceTag(24402116,307,10,
String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)));return b}Xnf(b){if(!b)return null;var k=b.img;const t=b.text;b=b.html;const D=this.hk.Xgj(!!k,!!t,b);let P=null;if(3===D){if(!b)return null;k=this.hk.PXh(b);(k=this.hk.WXh(k))&&(b+=k);P=this.hk.Gmb(b)}else 2===D?P=this.hk.jYf(t,!0):1===D&&(P=this.hk.Gmb(k));return P}$Kc(b,k){if(this.fRb)k=this.Xnf(this.fve),this.fve=null;else{if(!this.ifd)return k;b=document.implementation.createHTMLDocument("doc");
b.body.innerHTML=this.ifd;k=b.body;this.ifd=null}return k}prepareForPaste(b){const k=X.a.create();this.B3g=k;this.y$a.uOb?v.ULS.sendTraceTag(7377737,307,50,k.toString()):v.ULS.sendTraceTag(19256735,307,50,k.toString());const t={};t.command=this.fRb?"getClipboardData":"paste";chrome.runtime.sendMessage(this.ysc,t,D=>{k.equals(this.B3g)?this.fRb?this.fve=D:this.ifd=D:v.ULS.sendTraceTag(7385868,307,50,null);v.ULS.sendTraceTag(7377738,307,50,k.toString());chrome.runtime.lastError&&(this.rql(),this.y$a.uOb?
v.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):v.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));b()})}POb(){v.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.p_b?b=this.LBe+this.cLe:this.Uue&&(b=this.LBe+this.ysc);rw.instance.Q$e(this.FCn,b,this.p_b)}rql(){this.y$a.C3n();this.POb()}jij(b,k){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},k)}PTk(){const b=X.a.create();this.y$a.uOb?v.ULS.sendTraceTag(592491466,307,50,b.toString()):v.ULS.sendTraceTag(591984031,
307,50,b.toString());chrome.runtime.sendMessage(this.ysc,{command:"getAvailableCommands"},k=>{v.ULS.sendTraceTag(592491467,307,50,b.toString());k?Object(ob.a)(Array,k)?(v.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",k),this.Vxd=-1!==Array.indexOf(k,"getClipboardData")):(v.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",k),this.Vxd=!1):(v.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:
null),this.Vxd=!1)})}uCh(){const b=X.a.create();this.y$a.uOb?v.ULS.sendTraceTag(7726105,307,50,b.toString()):v.ULS.sendTraceTag(591984032,307,50,b.toString());this.vxd&&this.PTk();this.jij(this.ysc,k=>{v.ULS.sendTraceTag(7726106,307,50,b.toString());k&&"ping"===k?this.MS=!0:(k?"ping"!==k&&v.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",k,chrome.runtime.lastError?chrome.runtime.lastError.message:null):v.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",
chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.POb(),this.MS=!1);this.vxd&&!this.fRb&&v.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}UIi(b,k){const t={};t.OfficeOnlineExtensionInstallationStatus=b;t.OfficeClipboardExtensionInstallationStatus=k;v.ULS.sendTraceTag(51144839,307,50,JSON.stringify(t));this.Lbh&&(b&&xa.Health.instance.recordKpiSuccess(ol.i8g,null),k&&xa.Health.instance.recordKpiSuccess(ol.f8g,null))}U0m(){this.Lbh&&(xa.Health.instance.recordKpiUsage(ol.i8g,
1,ol.UTg,null),xa.Health.instance.recordKpiUsage(ol.f8g,1,ol.UTg,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.y$a.uOb;this.jij(this.cLe,k=>{this.UIi(b,!!k)})}else this.UIi(!1,!1)}}ol.i8g="OfficeOnlineExtensionInstallationStatus";ol.f8g="OfficeClipboardExtensionInstallationStatus";ol.UTg="wwccp";Object(n.a)(ol,"ChromeSystemClipboardAccessManager",null,[472]);class kA{constructor(b,k){this.MS=null;this.Se=b;this.Ma=k;this.wWj=!this.Ma.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&
this.Ma.$("BlockCopyCutOnFirefoxIsEnabled");this.Jhk=k.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}LKc(b){this.wWj&&b&&this.Se.jj?(this.POb(),this.MS=!1):this.MS=!0}get G7f(){return this.MS}get fRb(){return!1}wif(b){return $d.a.BCb(b,"copy")}$Kc(b,k){$d.a.BCb(b,"paste");return k}prepareForPaste(b){b()}S9c(b,k,t){if(this.Se.a4)return this.Jhk&&(this.MS=!1),!1;k();t();b=this.$Kc(b.ownerDocument,b);k=b.innerHTML;b.innerHTML=lb.a.create().toString();t();b=this.$Kc(b.ownerDocument,b);return this.MS=
b=k===b.innerHTML}POb(){rw.instance.Q$e(null,null)}}Object(n.a)(kA,"DefaultSystemClipboardAccessManager",null,[472]);class fq{constructor(b,k,t){this.MS=this.E$=this.BXb=this.Oka=this.iXa=this.efd=null;this.hk=k;this.rXa=t;this.G$j=b.mc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.nik=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}LKc(b){this.nik&&b&&(this.MS=!0)}get G7f(){return this.MS}get fRb(){return!1}wif(b){return b?$d.a.BCb(b,
Rc.a.copy):!1}$Kc(b,k){this.iXa&&(k=this.iXa,this.iXa=null);return k}prepareForPaste(b,k=null){if(b&&k){this.efd=b;this.BXb=k;$addHandler(this.BXb,Rc.a.paste,Object(A.a)(this,this.iVi,"onPasteEvent"));this.E$=this.Oka=null;if(this.PBj(this.BXb)){if(this.E$&&0<this.E$.length&&(!this.Oka||this.hk.Zne(this.Oka))){this.rXa.AIh(this.E$,Object(A.a)(this,this.jnn,"onImageConverted"));this.iXa&&!this.iXa.hasChildNodes()&&v.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.Oka&&
this.Oka.innerHTML&&((this.iXa=this.Uni(this.Oka.innerHTML))&&!this.iXa.hasChildNodes()&&v.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),fc.a.tC(this.Oka))}this.i_h()}else b&&b()}S9c(b){return this.MS=b=this.PBj(b.ownerDocument)}iVi(b){try{b&&b.rawEvent&&((this.Oka=b.rawEvent.target)&&this.Oka.id&&-1<this.Oka.id.indexOf("Paste")?(v.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.Oka.id),this.Oka=null):this.E$=this.iYl(b.rawEvent))}catch(k){v.ULS.sendTraceTag(22073952,
307,15,"Exception while processing context menu paste event: "+k.toString())}}jnn(b){b&&(this.rXa.spj&&(b=String.format('<img src="{0}">',b)),this.iXa=this.Uni(b));this.i_h()}i_h(){this.BXb&&($removeHandler(this.BXb,Rc.a.paste,Object(A.a)(this,this.iVi,"onPasteEvent")),this.BXb=null);this.efd&&(this.efd(),this.efd=null)}iYl(b){let k=null;(b=this.hk.o5h(b))&&({Fyf:k}=this.hk.qBj(b,this.G$j,this.rXa.fMi));return k}PBj(b){return $d.a.BCb(b,Rc.a.paste)}Uni(b){const k=document.implementation.createHTMLDocument("doc");
k.body.innerHTML=b;return k.body}POb(){}}Object(n.a)(fq,"EdgeSystemClipboardAccessManager",null,[472]);class lo{constructor(b,k,t,D){this.Ma=b;this.SXj=k;this.hk=t;this.Se=D}create(){let b=null;w.AFrameworkApplication.Cdg()&&this.Se.zq&&window.chrome?(v.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new ol(this.Ma,this.SXj,this.hk),this.Ma.$("LogChromeExtensionInstallationStatusIsEnabled")&&b.U0m()):this.Ma.$("EdgeContextMenuPasteFixIsEnabled")&&this.Se.Xt?(v.ULS.sendTraceTag(22073953,
307,50,"EdgeSystemClipboardAccessManager"),b=new fq(this.Ma,Fa.a.instance.resolve("Box4.IClipboardDataHelper"),Fa.a.instance.resolve("Box4.IProcessImageStrategy"),Fa.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(v.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new kA(this.Se,this.Ma));return b}}Object(n.a)(lo,"SystemClipboardAccessManagerFactory",null,[448]);class aj{Wvl(b){return b}}Object(n.a)(aj,"DeleteTableSegmentStrategy",null,[445]);
var $t=c(589),Er=c(1028);class pz{get fq(){return ks.a.BEb}get paragraphEditor(){return null!=this.WEg?this.WEg:this.WEg=Fa.a.instance.resolve("Box4.IParagraphEditor")}get B0(){return this.paragraphEditor.fq}get Ic(){return Hi.a.instance}get HA(){return null!=this.gFg?this.gFg:this.gFg=Fa.a.instance.resolve("Box4.IParagraphIndentationReader")}iEc(b,k,t,D,P,ca,ta){let Na=2;if(!b.qe)return 2;const qb=b.mb;if(!qb)return this.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.oca}),8;if(w.AFrameworkApplication.K.$("Box4PartialPromoteDemoteIsEnabled")){b=
this.yAh(k===Pb.a.IG,t,!0);if(1===D)return b?32:8;b&&(Na=Er.a.Dfc(k,t,D,P,ca,ta))}else Na=Er.a.Dfc(k,t,1,P,ca,ta),1!==D&&32===Na?(b.mb.K7d(),b=new Xd.GraphTransaction(15),b.Cb(t.view.ed),Na=this.yAh(k===Pb.a.IG,t,!1)?Er.a.Dfc(k,t,D,P,ca,ta):8,b.dispose()):1!==D&&8===Na&&(b.mb.K7d(),this.B1k(k,t,qb));return Na}yAh(b,k,t){k=k.view.mb;if(!k||!k.hb.kb)return this.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.MJb}),!1;if(k.hb.nJ)return this.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.q9e}),!1;k=$t.OutlineElementGeneralizer.gna(k.hb,
!1);if(!k)return this.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.kLd}),!1;let D=!1;for(let P=0;P<k.length;P++){const ca=k.getContext(P),ta=new ze.GraphIterator;ta.set(ca.node);hf.SelectionEditor.ku(ta);if(!va.OutlineElementReader.Bh(ta))if(t)continue;else return this.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.Jfb}),!1;if(b?!this.fq.bAb(ta):!this.fq.S1b(ta))if(t)continue;else return this.Ic.Yb(Pe.a.K4b,{["Reason"]:He.a.L5e}),!1;D=!0}return t?D:!0}B1k(b,k,t){const D=new Xd.GraphTransaction(15);try{D.Cb(k.view.ed);k=!0;const P=
$t.OutlineElementGeneralizer.gna(t.hb,!1);for(let ca=0;ca<P.length;ca++){const ta=P.getContext(ca),Na=new ze.GraphIterator;Na.set(ta.node);hf.SelectionEditor.ku(Na);if(!va.OutlineElementReader.Bh(Na))k=!1;else if(b===Pb.a.IG?this.fq.bAb(Na):this.fq.S1b(Na))switch(k=!1,b){case Pb.a.IG:this.fq.VRa(Na,-1,0);break;case Pb.a.mO:this.fq.ZIc(Na,1)}}if(k){const ca=t.hb.kb;for(t=0;t<ca.length;t++){const ta=ca.J(t);if(ta.al){const Na=this.HA.Ahb(ta.node),qb=Na.bda;if(b===Pb.a.IG?Na.xB>qb:Na.xB<18*qb){const Jb=
new ze.GraphIterator;Jb.set(ta.node);this.B0.Bya(Jb,1,b===Pb.a.IG?Na.xB>=2.5*qb?Na.xB-2*qb:qb:Na.xB<16*qb?Na.xB+2*qb:18*qb)}}}}}finally{D&&D.dispose()}}}Object(n.a)(pz,"IndentationActorExtension",null,[444]);var nC=c(739),xl=c(1204);class xB{constructor(b,k){this.Zn=new th.DictionaryPropertySet;this.Erd=new th.DictionaryPropertySet;this.mub=!1;this.gBa=this.Rrb=null;this.n6=b;this.vVg=k}get Bpb(){return null!=this.oHg?this.oHg:this.oHg=Fa.a.instance.Na("Box4.ITextFormattingCommands")}get pp(){return null!=
this.Ozg?this.Ozg:this.Ozg=Fa.a.instance.resolve("Box4.IFormattingEditor")}get sc(){return null!=this.xJg?this.xJg:this.xJg=Fa.a.instance.resolve("Box4.Styles.IWACStyleReader")}K5a(){this.mub||(0<this.OPa.hM()&&(this.Erd=this.Zn.clone()),this.Zn.J4f(),this.Rrb=null,this.oYn())}s6k(b){var k;const t=null!==(k=Je.FormattingReader.Kr(b))&&void 0!==k?k:Je.FormattingReader.hPd(b.node,b.cpBegin,-1);!t.cache.BB&&(b=t.wn)&&(k=new th.DictionaryPropertySet,k.Qw(b),k.Qw(this.Zn),k.hasProperty(zi.a.aw)&&(this.Rrb=
t.paragraph.Kc),this.Zn=k)}hasProperty(b){return this.Zn.hasProperty(b)}CQc(){return 0<this.Zn.hM()}get OPa(){return this.Zn}freeze(){this.mub=!0}cIa(){this.mub=!1}xG(b,k){return this.OPa.ia(b,k)}LA(b){this.Zn.setValue(sf.a.fontSize,this.pp.V2b(b));this.S0();bd.a.n3f(this.Erd,this.Zn)}fontSize(){return this.Zn.ia(sf.a.fontSize,bd.a.lM)}ege(b){this.Zn.setValue(sf.a.font,b);this.vVg&&this.vVg.execute(k=>{null==k?v.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):
k.ege(this.Zn)});this.n6&&this.n6.enabled&&(Jc.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.n6.zgo(this.Zn,b));this.S0();bd.a.n3f(this.Erd,this.Zn)}Ibg(b){this.Zn.setValue(Cc.a.He,b);this.n6&&this.n6.enabled&&(Jc.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.n6.Vlo(this.Zn,b));this.S0()}Mv(b){b=Xk.a.instance.RCa(af.a.instance.hb.kb.Qa.node,b);this.Zn.setValue(sf.a.fontColor,b);this.S0();bd.a.n3f(this.Erd,this.Zn)}qfa(){this.Zn.setValue(sf.a.fontColor,
ch.a.auto);this.S0()}fontColor(){return this.Zn.ia(sf.a.fontColor,ch.a.nil)}zya(b){this.Zn.setValue(sf.a.highlight,parseInt(b,16));this.S0()}EDd(){this.Zn.setValue(sf.a.highlight,ch.a.auto);this.S0()}isBold(){return this.Zn.ia(sf.a.bold,!1)}nL(b){this.Zn.setValue(sf.a.bold,b);this.S0()}isItalic(){return this.Zn.ia(sf.a.italic,!1)}setItalic(b){this.Zn.setValue(sf.a.italic,b);this.S0()}isUnderline(){return this.Zn.ia(sf.a.underline,!1)}e5(b){this.Zn.setValue(sf.a.underline,b);this.Zn.setValue(sf.a.underlineType,
b?bd.a.mQb:bd.a.jV);this.S0()}underlineType(){return this.Zn.ia(sf.a.underlineType,bd.a.jV)}Uia(b){b<bd.a.mQb||b>bd.a.jV||(this.Zn.setValue(sf.a.underline,b!==bd.a.jV),this.Zn.setValue(sf.a.underlineType,b),this.S0())}isSuperscript(){return this.Zn.ia(sf.a.superscript,!1)}iqa(b){this.Zn.setValue(sf.a.superscript,b);b&&this.isSuperscript()&&this.Zn.setValue(sf.a.subscript,!1);this.S0()}isSubscript(){return this.Zn.ia(sf.a.subscript,!1)}BHa(b){this.Zn.setValue(sf.a.subscript,b);b&&this.isSubscript()&&
this.Zn.setValue(sf.a.superscript,!1);this.S0()}isStrikethrough(){return this.Zn.ia(sf.a.strikethrough,!1)}Ria(b){this.Zn.setValue(sf.a.strikethrough,b);this.S0()}isDoubleStrikethrough(){return this.Zn.ia(zi.a.ot,!1)}Zfe(b){this.Zn.setValue(zi.a.ot,b);this.S0()}U4h(){return this.Zn.ia(zi.a.aw,null)}A6a(b,k){this.Zn.J4f();this.Zn.setValue(zi.a.aw,b.id);this.Rrb=k.Kc;this.S0()}b5(b){let k=sf.a.bL;const t=nC.a.I0d(b);switch(t){case 1:k=Cc.a.fcc;break;case 2:k=Cc.a.hcc}this.Zn.setValue(Cc.a.x3a,t);this.Zn.setValue(k,
b);this.S0()}language(){let b=sf.a.bL;switch(this.Zn.ia(Cc.a.x3a,0)){case 1:b=Cc.a.fcc;break;case 2:b=Cc.a.hcc}return this.Zn.ia(b,0)}Nio(b){this.Zn.setValue(Cc.a.noProof,b);this.S0()}jHb(){return this.Zn.ia(Cc.a.noProof,!1)}KMm(){return this.Zn.hasProperty(Cc.a.noProof)}rLm(){return this.Zn.hasProperty(sf.a.bL)||this.Zn.hasProperty(Cc.a.fcc)||this.Zn.hasProperty(Cc.a.hcc)}S0(){if(aa.a.wkc){var b=af.a.instance.hb.kb.Qa,k=b.node;if(k===this.gBa)this.gBa.Tk(16,!0);else{this.gBa=k;k=this.gBa.MY();try{this.gBa.s_(b.cpBegin).Awa=
!0}finally{k&&k.dispose()}}}}oYn(){if(aa.a.wkc&&this.gBa){var b=0,k=this.gBa.MY();try{for(let t=this.gBa.pa.length-1;0<=t;t--){const D=this.gBa.pa.J(t);D.Awa&&(D.Awa=!1,b++,D.isEmpty&&this.gBa.pa.removeAt(t))}}finally{k&&k.dispose()}this.gBa=null}}v4k(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.pa.Oh(b.cpBegin);return!!b&&b.Awa}b1e(b){if(this.Bpb){this.freeze();var k=new Xd.GraphTransaction(7);k.Cb(b.node);this.Bpb.gge(b);this.cIa();this.K5a();k.dispose()}}Gtf(b){const k=pe.ParagraphReader.text(b.node);
return b.cpBegin&&b.cpBegin!==k.length&&!F.a.Ev(k.charCodeAt(b.cpBegin))&&xl.a.instance.X0a(k,b.cpBegin-1)!==b.cpBegin&&hf.SelectionEditor.$jb(b)?(b=hf.SelectionEditor.C3(b,!1))?1<b.length||hf.SelectionEditor.ml(b.Qa)?b:null:null:null}}Object(n.a)(xB,"InsertionPointFormatting",null,[443]);class yB{constructor(b){this.ga=b}get pc(){return this.ga}fOk(b,k,t=null){const D=new th.DictionaryPropertySet;D.setValue(vd.a.yA,b);D.setValue(vd.a.KQa,k);t&&D.Qw(t);D.CommandSource="autobulleting";this.pc.Qb(Pb.a.iD,
2,D)}numbering(b,k,t,D,P){const ca=new th.DictionaryPropertySet;ca.setValue(vd.a.yA,b);ca.setValue(vd.a.KQa,k);ca.setValue(vd.a.H3a,t);P&&ca.setValue(ke.a.kQ,P);D&&ca.setValue(Cc.a.au,D);wl.a.bY&&(ca.setValue(ke.a.Ooa,"autocorrect"),P&&ca.setValue(ke.a.vha,P));ca.CommandSource="autonumbering";return 32===this.pc.Qb(Pb.a.rL,2,ca)}}Object(n.a)(yB,"ListCommands",null,[442]);var Vx=c(293);class sw extends Vx.a{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){super();this.TXb=this.rm=this.MJa=null;this.lGn=(ac,
yc)=>{yc=this.Ksa.Z$d(this.MJa,yc);ac.gi(this.iHl);return yc};this.iHl=(ac,yc)=>{if(this.rm.moveNext())return ac=this.rm.currentNode,12!==ac.type||ac===this.MJa.node?!0:this.Ksa.N1c(ac,yc);this.wNk();ac.gi(this.jHl);return!0};this.jHl=(ac,yc)=>{if(this.rm.moveNext()){const Kc=this.rm.currentNode;return 12!==Kc.type?!0:Kc===this.MJa.node?(ac.gi(this.mGn),!0):this.Ksa.N1c(Kc,yc)}return!1};this.mGn=(ac,yc)=>{this.Ksa.$$d(this.MJa,yc);return!1};this.init(b);this.Al(Vb);this.Oib(Na,k,D,P,ca);this.AL=ca;
this._context=t;this.ib=qb;this.Ie=Jb;this.Ksa=ta;this.Sz=0}run(){this.y6e();this.Sz||this.Ino();1===this.Sz&&this.pHn();2===this.Sz&&this.GFo();3===this.Sz&&this.FCl()}y6e(){this.ib.hb&&this.ib.hb.kb?1===this.behavior&&(this.Ksa.y6e(this._context)?this.mr=32:this.mr=2,this.Sz=3):(v.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.mr=2,this.Sz=3)}Ino(){this.YMk();this.Ksa.kcg(this.MJa)?(this.qMk(),this.Sz=1):(this.mr=8,this.Sz=3)}pHn(){this.sC||new vs.a(this,this.lGn,this.AL);
do if(this.sC.run(),this.sC.inProgress&&!this.Ig)return;while(this.sC.inProgress);this.ADd();this.Sz=2}GFo(){this.Ksa.eig(this)?this.mr=32:this.mr=8;this.Sz=3}FCl(){this.gqa()}YMk(){let b=this.ib.hb.kb;if(b=this.Ie.Cj(b,!0,!1))this.MJa=b.Qa;this.MJa&&this.MJa.node&&(this.TXb=this.Ksa.aei(this.MJa.node))}qMk(){if(!this.TXb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Vk.a;b.set(this.MJa.node);b.zb(this.TXb.type);this.rm=mr.a.mt(b,this.TXb);this.rm.oo(Object(A.a)(this.Ksa,
this.Ksa.Vjc,"spellErrorFilter"),null)}wNk(){if(!this.TXb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Vk.a;b.set(this.TXb);this.rm=mr.a.Kp(b);this.rm.oo(Object(A.a)(this.Ksa,this.Ksa.Vjc,"spellErrorFilter"),null)}}Object(n.a)(sw,"ProofingWholeDocumentOperation",Vx.a,[]);var Wx=c(276);class Au extends kh{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(n.a)(Au,"ContextMenuRootProperties",kh,[]);var Bu=c(1349);class ms{constructor(b){const k=new Au;
k.ImageSideArrow=w.AFrameworkApplication.Rs;k.ImageSideArrowClass=od.getImageClass("SubmenuFlyoutArrow_13x13x32");k.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;k.CommandMenuOpen=Pb.a.t$d.toString();this.hih=new Bu.ContextMenuRoot("ContextMenuRootName",k);b.execute(t=>{this.g1.zF=t});this.g1.refresh();w.AFrameworkApplication.va.qa($a.a.showContextMenu,Ud.a.frame,Xc.ActionManager.Of);w.AFrameworkApplication.va.qa($a.a.xjc,Ud.a.frame,Xc.ActionManager.Of)}get g1(){return this.hih}dispose(){this.g1&&
(this.g1.dispose(),this.hih=null)}showContextMenu(b,k){this.Job(b,k.clientPoint,k.jg)}q3b(b,k,t,D,P){this.g1.q3b(b,k,t,D,P)}F6a(b,k,t){$d.a.O3d(this.g1.LYa?"ShowLegacyContextMenuAndFloatie":"ShowLegacyContextMenu","");Wa.App.ya.bGl();this.fu();this.g1.F6a(b,k,t);this.g1.LYa?w.AFrameworkApplication.va.processAction($a.a.xjc,2):w.AFrameworkApplication.va.processAction($a.a.showContextMenu,2)}Job(b,k,t){this.F6a(b,new Sys.UI.Bounds(k.x,k.y,0,0),t)}fu(){this.g1.root.xm()}x3(){return this.g1.x3()}xjc(b,
k,t,D){const P=this.g1;let ca=!1;t=Object(Ka.a)(rq,t);P.LYa=t;D.Eya(b,k);P.aYe?t&&(t.MCn(P,k),ca=!0):(v.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",D.Zel()),P.LYa=null);return ca}}Object(n.a)(ms,"AContextMenuController",null,[471,9]);class Cu{}Cu.hgc="faProofing";Cu.eUh="EditorMenuSection";Object(n.a)(Cu,"ContextMenuControlId",null,[]);var Ky=c(524);class av{constructor(b){this.Ie=b}y6e(b){b=Object(Ka.a)(Ky.a,b);return!!b&&!!b.view&&b.view.qe}kcg(){return!0}Z$d(){return!0}N1c(){return!0}$$d(){}eig(){return!0}Vjc(b){if(b.Pr)return!0;
b=b.role;return 1===b||2===b||3===b||4===b||5===b}aei(b){if(!b||!this.Ie)return b;const k=new Vk.a;k.set(b);if(this.Ie.ku(k)){for(;!k.Pr;)k.uc();return k.currentNode}return b}}Object(n.a)(av,"SimpleProofingWholeDocumentCallBacks",null,[316]);class qz{constructor(b){this.value=b}}Object(n.a)(qz,"RefBool",null,[]);class Jo{constructor(){this.TKc=this.KJb=null;this.ACj=new qz(!1)}}Object(n.a)(Jo,"FindNextErrorOperationParam",null,[]);class bv{constructor(){this.Priority=0;this.Context=null;this.Length=
this.StartInContext=this.Start=0;this.Metadata=bv.ksl;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}bv.ksl=[];Object(n.a)(bv,"Critique",null,[]);class Yq{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(n.a)(Yq,
"Suggestion",null,[]);var mo=c(598);class pk extends Sys.EventArgs{constructor(b,k,t,D,P,ca){super();this.g4j=b;this.m6j=k;this.n6j=t;this.wre=D;this.Fz=P;this.J8a=ca}}Object(n.a)(pk,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var wt=c(335);class an{constructor(b,k,t){this.zze=b;this.Fm=k;this.ra=t}BIh(b){const [k,t,D]=this.Bii(b);return this.N7h(k,t,D)}AGm(b){return hc.a.getTypeNameFor(b.content)===wt.a.getTypeName()}N7h(b,k,t){if(t&&this.AGm(t)){if(this.D0b(t.content))return null;const P=
t.content;var D=new bv;D.ExplanationTitle=P.explanationTitle;D.Suggestions=this.ucm(t);D.CategoryTitle=P.categoryName;D.TypeId=P.typeId;D.CritiqueActions=P.critiqueActions;D.Priority=P.priority;t=this.zze.create(D);D=P.context;t.token=D.substring(P.range.start,P.range.start+P.range.length);t.lcid=Xj.a.og(P.language).LCID;t.originalText=D;return new mo.a(b,k,t)}return null}ucm(b){var k=b.content.suggestions;b=[];for(const t of k)k=new Yq,k.Action=t.suggestionActions,k.Text=t.text,k.Description=t.description,
b.push(k);return b}D0b(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===b||70===b}Bii(b){const k=this.Fm.oOc(b,0),t=b.cpBegin,D=b.cpEnd,P=hf.SelectionEditor.gf(b);b=pe.ParagraphReader.text(b.node,0);for(const ca of k)if(P){if(ca.begin<=t&&ca.end>=D)return[ca.begin,ca.end,ca.intent]}else if(ca.begin<=t&&ca.end>=t&&F.a.IHh(b,ca.end,D))return[ca.begin,ca.end,ca.intent];return[null,null,null]}static zB(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1)}iwf(b,k,t){const [D,P,ca]=this.Bii(b);ca&&this.ra.raiseEvent(an.tvh,new pk(b,D,P,k,ca,t))}$vk(b){this.ra.addHandler(an.tvh,b)}bzl(b,k,t){b=this.Fm.PPd(b,0,0,b.characterData.length);for(let D=0;D<b.count;D++){const P=b.J(D);if(P.intent){const ca=P.intent;if(ca.content&&(0==ca.content.priority||1==ca.content.priority)&&P.begin>=k&&(!t||t(P.intent)))return this.N7h(P.begin,P.end,P.intent)}}return null}}an.tvh="augloopProofingContextMenuActionEventKey";Object(n.a)(an,"AugLoopProofingErrorDetailHelper",
null,[]);class hw extends av{constructor(b,k,t,D){super(k);this.qn=b;this.KAc=t;this.UVj=D}Z$d(b,k){return!this.WJf(b.node,b.cpBegin,k)}N1c(b,k){return!this.WJf(b,0,k)}$$d(b,k){this.WJf(b.node,0,k);Object(Ka.a)(Jo,k)}WJf(b,k,t){t=Object(Ka.a)(Jo,t);if(pe.ParagraphReader.Wb(b)&&!b.mJ)if(Je.FormattingReader.Kr(Of.a.Rc(b,k)).cache.jHb)t.ACj.value=!0;else{if(an.zB())return k=this.UVj.bzl(b,k,this.KAc),null!=k?(t.KJb=k,t.TKc=b,!0):!1;const D=this.qn.N3(b);for(let P=0;P<D.length;P++){const ca=D[P];if(ca.begin>=
k&&!ca.errorDetails.S2a()&&(!this.KAc||this.KAc(ca.errorDetails)))return t.KJb=ca,t.TKc=b,!0}return!1}}}Object(n.a)(hw,"FindNextErrorCallbackSteps",av,[]);var np=c(303);class au{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed,sd){this.xZk=(oe,Ld,Od,ie,Ce)=>{Ld=this.ib.hb.kb;if(!Ld)return this.qd.Yb(Pe.a.kf,{["Reason"]:He.a.noSelection}),2;Ld=this.Ie.Cj(Ld,!0,!1);return this.ga.Nf(Ld.Qa,oe,Od,!1,ie,Ce)};this.Uun=(oe,Ld,Od)=>{if(1===Od)return this.ga.processAction(Pb.a.b5,1);this.f9j().ieg();return 32};
this.xDa=(oe,Ld,Od)=>{if(1===Od)return 32;Hj.a.mark(4670);Od=this.qn.ona(Ld);if(this.rme(Od))return 8;Ld=Ld.node;const ie=this.Hc.Mc(15);let Ce=Od.begin;" "===pe.ParagraphReader.text(Ld).charAt(Ce-1)&&Ce--;ie.Cb(Ld);const hg=this.Kd.replaceTextRange(Of.a.createTextRange(Ld,0<Od.begin?Od.begin-1:0,Od.end),"",!0,!1);this.ib.setSelection(Gf.SelectionFactory.te(Ld,hg+Ce));ie.dispose();Od.errorDetails.Opb(oe);Hj.a.mark(4671);return 32};this.dwa=(oe,Ld,Od)=>{if(1===Od)return 32;v.ULS.sendTraceTag(7660830,
324,50,"Ignore spelling error triggerred");if(an.zB())return this.Z8a.iwf(Ld,null,np.b.IgnoreOnce),32;Hj.a.mark(4670);Od=this.qn.ona(Ld);if(this.rme(Od))return 8;Ld=Ld.node;const ie=this.Hc.Mc(15);ie.Cb(Ld);this.qn.tnb(Ld,[Od],!0);Ld.setValue(sf.a.m9e,!0);ie.dispose();Od.errorDetails.Opb(oe);Hj.a.mark(4671);v.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.F4m(Od);this.vXa.roi(Od,Ld,!0);return 32};this.G6k=(oe,Ld,Od)=>{var ie,Ce=!this.Ik.A8(Ld);this.Sm&&this.Sm.instance&&
this.Sm.instance.qU(Ld)&&(Ce=!1);if(1===Od||!Ce)return Ce?32:8;this.ga.processAction(Pb.a.Dqa,2);Hj.a.mark(4670);Ce=this.JQl(oe);if(0>Ce)return 8;if(an.zB())return this.Z8a.iwf(Ld,Ce,np.b.Apply),32;Od=this.qn.ona(Ld);if(this.rme(Od))return 8;Ld=Ld.node;var hg=Od.errorDetails.suggestions;if(!hg)return this.qd.Yb(Pe.a.ICb,{["Reason"]:"NoSuggestionsFound"}),Hj.a.mark(4671),8;Ce=Ce<hg.length?hg[Ce]:null;if(!Ce)return this.qd.Yb(Pe.a.ICb,{["Reason"]:"RequestedSuggestionIsNull"}),Hj.a.mark(4671),8;(null===
(ie=Wa.App.rd)||void 0===ie?0:ie.Yo)&&Wa.App.rd.kq.rH(Ld);Ce=Ce.replace("  "," \u00a0");ie=this.Hc.Mc(15);ie.Cb(Ld);hg=this.Kd.replaceTextRange(Of.a.createTextRange(Ld,Od.begin,Od.end),Ce,!0,!1,Pb.a.Dqa);this.ib.setSelection(Gf.SelectionFactory.te(Ld,Od.begin+Ce.length+hg));ie.dispose();Od.errorDetails.Opb(oe);Hj.a.mark(4671);this.t_m(Od);return 32};this.dbo=(oe,Ld)=>{Ld=this.qn.ona(Ld);if(this.rme(Ld))return 8;Ld.errorDetails.Opb(oe);return 32};this.JBl=(oe,Ld,Od,ie,Ce)=>{if(!Ld.view.qe)return 2;
const hg=Ld.view;if(!this.ib.hb.kb)return this.qd.Yb(Pe.a.kf,{["Reason"]:He.a.noSelection}),2;if(1===Od)return 32;const Kg=new Jo,Hl=new hw(this.qn,this.Ie,this.KAc,this.Z8a);Ld=new sw(null,oe,Ld,Od,ie,Kg,Hl,this.ga,this.ib,this.Ie,null);Ld.Ig=!0;Ld.run();if(Ld.isCompleted&&Kg.KJb){if(Ld=Gf.SelectionFactory.te(Kg.TKc,Kg.KJb.begin),Ld=Gf.SelectionFactory.jA(Ld,Of.a.Rc(Kg.TKc,Kg.KJb.end)),!this.gbh.instance||!this.gbh.instance.IEn(Kg.KJb,Ld,hg)){this.ib.setSelection(Ld);let wm=0;Ce&&(wm=Ce.Gx);hg.Lhe=
!1;wb.a.instance.Vb(new Df.a(1,1,1,()=>{this.i$n(hg,wm,Kg.TKc,Kg.KJb)}))}}else{const wm=new Uc.StandardDialog;wm.Ad=0;Wa.App.dN.IVc?wm.Yia(CommonUIStrings.l_DefaultDialogTitle,Kg.ACj.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(wm.Yia(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),Wa.App.dN.izd(()=>{wm.oha&&(wm.hide(),this.ga.processAction(oe,2))}))}return 32};this.t$d=(oe,Ld,Od)=>
{if(1===Od)return 32;this.Mda&&this.Mda.g1&&(oe=this.Mda.g1.nvf(Cu.hgc))&&!oe.dL&&(oe.b0(0),oe.menu.LK(0));return 32};this.ga=k;this.qn=b;this.f9j=t;this.Kd=D;this.Hc=P;this.ib=ca;this.Sm=ta;this.Ie=Na;this.qhk=qb;this.Ik=Jb;this.qd=Vb;this.Z8a=sd;this.Mda=Object(Ka.a)(ms,ac);this.QVb=yc.fVc;this.gbh=Kc;this.vXa=ed;this.Vnc=new Map;this.Vnc.set(1,Pb.a.vfg);this.Vnc.set(2,Pb.a.Nvf);this.Vnc.set(3,Pb.a.tgg);this.wzc=new Map;this.wzc.set(1,Pb.a.wfg);this.wzc.set(2,Pb.a.Ovf);this.wzc.set(3,Pb.a.ugg)}Tb(){const b=
this.ga,k=this.G6k,t=this.xZk;b.fb(Pb.a.u8d,lc.a.view,this.Uun,1028);b.qa(Pb.a.xDa,lc.a.Tc,this.xDa);b.qa(Pb.a.dwa,lc.a.Tc,this.dwa);b.qa(Pb.a.wpb,lc.a.Tc,k);b.qa(Pb.a.xpb,lc.a.Tc,k);b.qa(Pb.a.ypb,lc.a.Tc,k);b.qa(Pb.a.BPb,lc.a.Tc,k);b.qa(Pb.a.CPb,lc.a.Tc,k);b.qa(Pb.a.xDa,lc.a.view,t);b.qa(Pb.a.dwa,lc.a.view,t);b.qa(Pb.a.wpb,lc.a.view,t);b.qa(Pb.a.xpb,lc.a.view,t);b.qa(Pb.a.ypb,lc.a.view,t);b.qa(Pb.a.BPb,lc.a.view,t);b.qa(Pb.a.CPb,lc.a.view,t);b.Vc(Pb.a.xDa,1028);b.Vc(Pb.a.dwa,1028);b.Vc(Pb.a.wpb,
1028);b.Vc(Pb.a.xpb,1028);b.Vc(Pb.a.ypb,1028);b.Vc(Pb.a.BPb,1028);b.Vc(Pb.a.CPb,1028);b.qa(Pb.a.Dqa,Ud.a.frame,Xc.ActionManager.Of);this.QVb&&b.fb(Pb.a.t$d,lc.a.view,this.t$d,1124);b.fb(Pb.a.vZc,lc.a.view,this.JBl,1028);b.fb(Pb.a.N0f,lc.a.Hd,this.dbo,1124);this.tUn([Pb.a.ije,Pb.a.vfg,Pb.a.wfg,Pb.a.aTd,Pb.a.Nvf,Pb.a.Ovf,Pb.a.Mje,Pb.a.tgg,Pb.a.ugg,Pb.a.E3i,Pb.a.VOi,Pb.a.htj])}tUn(b){for(let k=0;k<b.length;k++)this.ga.fb(b[k],lc.a.view,Xc.ActionManager.AQ,1028)}HVn(b){this.KAc=b}rme(b){return b?b.errorDetails?
!1:(v.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.qd.Yb(Pe.a.ICb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),Hj.a.mark(4671),!0):(v.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.qd.Yb(Pe.a.ICb,{["Reason"]:"RequestedErrorRangeNotFound"}),Hj.a.mark(4671),!0)}F4m(b){b=b.errorDetails.proofingType;if(this.wzc.has(b)){const k=this.wzc.get(b);this.ga.processAction(k,2);v.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",
k,b)}}JQl(b){switch(b){case Pb.a.wpb:return 0;case Pb.a.xpb:return 1;case Pb.a.ypb:return 2;case Pb.a.BPb:return 3;case Pb.a.CPb:return 4;default:return-1}}t_m(b){b=b.errorDetails.proofingType;if(this.Vnc.has(b)){const k=this.Vnc.get(b);this.ga.processAction(k,2);v.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",k,b)}}i$n(b,k,t,D){b.W4();(b=t.De(b.ic))?(D=Wx.a.Pq(b,w.AFrameworkApplication.isRtl?D.begin:D.end),this.qhk.Eya(new Sys.UI.Point(D.x,D.y+D.height),
k)):v.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(n.a)(au,"ProofingActor",null,[]);var cr=c(407),Aq=c(1542),jB=c(1830),tw=c(533);class Du{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){this.nkc=null;this.lEl="StyleUsageActivity";this.mEl="StylesFloodgateSurveyIsEnabled";this.XMa=(ac,yc,Kc,ed)=>{ac=this.Ybm(ac);return 0>ac||ac>this.nkc.length?2:(ac=this.nkc[ac])?w.AFrameworkApplication.va.Nf(yc,Pb.a.applyStyle,Kc,!0,ed,ac):2};this.mLb=(ac,yc,Kc,ed,sd)=>{ac=!0;yc.contextId!==
lc.a.paragraph&&yc.contextId!==lc.a.Hd&&yc.contextId!==lc.a.Tc&&(ac=!1);if(1===Kc||!ac)return ac?32:8;if(2===Kc&&!sd)return 8;yc=this.sc.JC(yc.node);sd.MenuItems=cr.a.Z1l(yc);return 32};this.yKn=(ac,yc,Kc,ed,sd)=>{ac=!0;yc.contextId!==lc.a.paragraph&&(ac=!1);if(1===Kc&&!ac)return 8;yc=yc.node;Kc=this.sc.Lo(yc);if(!Kc||!sd)return v.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",sd,yc,Kc),8;sd.xTa.Qw(Kc.yl());return 32};this.uEk=(ac,yc,Kc,ed,sd)=>{if(yc.contextId!==
lc.a.paragraph)return 8;if(this.Vf.e3a(yc,!1))return this.Ic.Yb(Pe.a.en,{["Reason"]:He.a.VE}),8;if(1===Kc)return 32;const oe=yc.node;if(pe.ParagraphReader.lua(oe)||!sd)return 8;const Ld=this.duf(sd,oe);if(!Ld)return this.Ic.Yb(Pe.a.n1,{["Reason"]:He.a.JCb}),8;if(2!==this.sc.RD(Ld))return 2;Kc=new Xd.GraphTransaction(15);this.Fn&&this.Fn.isProgressiveStyleEnabled&&this.EH.Hjc(sd);Kc.Cb(oe);this.pj.K5a();const Od=[];ac!=Pb.a.clearFormatting&&Od.push(qe.a.PIa);this.r5.HJ(Ld,oe,!1,void 0,void 0,void 0,
hi.a.Pj?new jB.a(Od,!1,!0):null);(ac=this.sc.JC(oe))&&this.sc.ke(Ld,ac)&&Jc.b(593078098,3017,50,"Custom linked style applied by user");oe.vr&&(ac=[Object.assign(new na.a,{name:"Source",string:"ApplyStyle"})],bf.a("TOCFormatting",!0,void 0,ac));Kc.dispose();sd=F.a.SW(sd);ed.ks=sd>>>16^sd&65535;ed&&Aq.a.zpb&&(ed.vC|=Aq.a.jhb(yc.node));return 32};this.zKn=(ac,yc,Kc,ed,sd)=>{ac=!0;yc.contextId!==lc.a.Hd&&(ac=!1);if(1===Kc&&!ac)return 2;yc=Je.FormattingReader.Kr(yc);yc=Je.FormattingReader.Fna(yc);if(!yc)return 2;
if(!sd)return 8;sd.xTa.Qw(yc.yl());return 32};this.vEk=(ac,yc,Kc,ed,sd)=>{if(yc.contextId!==lc.a.Hd)return 8;this.Vf.e3a(yc);if(1===Kc)return 32;ac=yc;hi.a.vFd&&(yc=this.Co.gRd(ac))&&(ac=yc);yc=ac.node;if(!sd)return 8;const oe=this.duf(sd,ac.node);if(!oe)return this.Ic.Yb(Pe.a.n1,{["Reason"]:He.a.JCb}),8;if(1!==this.sc.RD(oe))return 2;Kc=this.sc.JC(yc);if(!Kc)return this.Ic.Yb(Pe.a.n1,{["Reason"]:He.a.dYh}),8;if(!Kc.Fi(this.sc.kg(oe)))return this.Ic.Yb(Pe.a.n1,{["Reason"]:He.a.JCb}),8;const Ld=new Xd.GraphTransaction(7);
try{if(this.Fn&&this.Fn.isProgressiveStyleEnabled&&this.EH.Hjc(sd),Ld.Cb(yc),this.r5.Smg(yc,Kc),this.Gqa.XZ(ac,Od=>{this.pp.pfa(Od);this.pp.A6a(Od,oe)}),yc.vr){const Od=[Object.assign(new na.a,{name:"Source",string:"ApplyStyle"})];bf.a("TOCFormatting",!0,void 0,Od)}}finally{Ld&&Ld.dispose()}Kc&&this.sc.ke(oe,Kc)&&Jc.b(593078097,3017,50,"Custom linked style applied by user");sd=F.a.SW(sd);ed.ks=sd>>>16^sd&65535;ed&&Aq.a.zpb&&(ed.vC|=Aq.a.jhb(ac.node));return 32};this.xKn=(ac,yc,Kc,ed,sd)=>{ac=!0;yc.contextId!==
lc.a.Tc&&(ac=!1);if(1===Kc&&!ac)return 2;yc=this.r5.ccm(yc);if(!yc)return 2;if(!sd)return 8;sd.xTa.Qw(yc.yl());return 32};this.tEk=(ac,yc,Kc,ed,sd)=>{if(yc.contextId!==lc.a.Tc)return 8;if(this.Vf.e3a(yc,!1))return this.Ic.Yb(Pe.a.en,{["Reason"]:He.a.VE}),8;if(1===Kc)return 32;var oe=yc.node;if(!sd)return 8;Kc=this.duf(sd,yc.node);if(!Kc)return this.Ic.Yb(Pe.a.n1,{["Reason"]:He.a.JCb}),8;const Ld=this.sc.RD(Kc);if(1!==Ld&&2!==Ld)return 2;(yc=this.pj.Gtf(yc))?(yc=af.a.cBb(yc),ac=w.AFrameworkApplication.va.Nf(yc,
ac,2,!1,ed,sd)):(ac=new Xd.GraphTransaction(7),this.Fn&&this.Fn.isProgressiveStyleEnabled&&this.EH.Hjc(sd),ac.Cb(oe),this.r5.tlo(Kc,oe),ac.dispose(),ac=32);oe.vr&&(yc=[Object.assign(new na.a,{name:"Source",string:"ApplyStyle"})],bf.a("TOCFormatting",!0,void 0,yc));(oe=this.sc.JC(oe))&&this.sc.ke(Kc,oe)&&Jc.b(593078096,3017,50,"Custom linked style applied by user");sd=F.a.SW(sd);ed.ks=sd>>>16^sd&65535;return ac};this.AKn=(ac,yc,Kc,ed,sd)=>{const oe=this.Ebd.tpa(ac,yc,Kc,ed,sd,null,0);return 2!==oe?
oe:this.Ebd.tpa(ac,yc,Kc,ed,sd,null,12)};this.wEk=(ac,yc,Kc,ed,sd)=>{var oe;const Ld={};Ld[this.Ebd.SIa]=6168;Ld[this.Ebd.RIa]=6169;let Od=12;if(!yc.view.qe)return 2;var ie=yc.view.mb,Ce=ie?ie.sg:null;if(!Ce)return this.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.noSelection}),8;if(this.Wg.aDa(Be.ImageReader.u2a,Ce))return this.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.bHc}),8;if(this.Wg.pza(pe.ParagraphReader.mU,Ce))return this.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.dO}),8;if(this.Vf.S$b(Ce,!1))return this.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.VE}),
8;Ce=this.sc.Mr();if(sd&&Ce){const hg=Ce.Fi(sd);if(hg){(null===(oe=w.AFrameworkApplication.K)||void 0===oe?0:oe.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&tw.a.instance.A5a("Style");oe=this.sc.Fva(hg,Ce);let Kg=this.sc.RD(hg);oe&&(ie=ie.hb.J(0),ie.hy&&ie.Qa.contextId===lc.a.Hd||2===ie.length&&ie.Qa.contextId===lc.a.Hd&&ie.Qc.contextId===lc.a.endOfParagraph)&&(Kg=1,sd=oe.getValue(zi.a.ka));1===Kg?Od=0:3===Kg&&(Od=14);!this.sc.ke(hg,Ce)&&this.sc.Fd(hg)&&(ie=this.sc.kg(hg),
Jc.b(562317522,3017,50,String.format("{0}: style applied by user",ie)));this.Kqa(this.lEl,this.mEl)}}return this.Ebd.tpa(ac,yc,Kc,ed,sd,Ld,Od)};this.Qu=k;this.ve=t;this.sN=D;this.Nz=P;this.Ik=ca;this.qd=ta;this.pW=Na;this.tnk=qb;this.we=Jb;this.Co=Vb}get Fn(){return null!=this.KGg?this.KGg:this.KGg=Fa.a.instance.Na("Box4.Styles.StyleSettings")}get r5(){return this.Qu}get Wg(){return this.sN}get pj(){return this.Nz}get pp(){return this.ve}get Vf(){return this.Ik}get Ic(){return this.qd}get Gqa(){return this.pW}get Ebd(){return this.tnk}get sc(){return this.we}Tb(){const b=
w.AFrameworkApplication.va,k=Wa.App.NTa.wKh(12);b.qa(Pb.a.applyStyle,lc.a.Hd,this.vEk);b.qa(Pb.a.QGa,lc.a.Hd,this.zKn);b.qa(Pb.a.applyStyle,lc.a.Tc,this.tEk);b.qa(Pb.a.QGa,lc.a.Tc,this.xKn);b.qa(Pb.a.applyStyle,lc.a.paragraph,this.uEk);b.qa(Pb.a.applyStyle,lc.a.view,this.wEk);b.Vc(Pb.a.applyStyle,1036);b.qa(Pb.a.QGa,lc.a.view,this.AKn);b.qa(Pb.a.QGa,lc.a.paragraph,this.yKn);b.Vc(Pb.a.QGa,99);b.qa(Pb.a.mLb,lc.a.view,k);b.qa(Pb.a.mLb,lc.a.paragraph,this.mLb);b.Vc(Pb.a.mLb,1127);b.fb(Pb.a.m1e,lc.a.view,
this.XMa,4);b.fb(Pb.a.n1e,lc.a.view,this.XMa,4);b.fb(Pb.a.o1e,lc.a.view,this.XMa,4);b.fb(Pb.a.p1e,lc.a.view,this.XMa,4);b.fb(Pb.a.q1e,lc.a.view,this.XMa,4);b.fb(Pb.a.r1e,lc.a.view,this.XMa,4);b.fb(Pb.a.s1e,lc.a.view,this.XMa,4);b.fb(Pb.a.Pth,lc.a.view,this.XMa,4);b.fb(Pb.a.Qth,lc.a.view,this.XMa,4);b.fb(Pb.a.Rth,lc.a.view,this.XMa,4);this.nkc=Array(10);kk.StyleReader.kmj(this.nkc)}Ybm(b){switch(b){case Pb.a.m1e:return 0;case Pb.a.n1e:return 1;case Pb.a.o1e:return 2;case Pb.a.p1e:return 3;case Pb.a.q1e:return 4;
case Pb.a.r1e:return 5;case Pb.a.s1e:return 6;case Pb.a.Pth:return 7;case Pb.a.Qth:return 8;case Pb.a.Rth:return 9;default:return-1}}Kqa(b,k){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$(k)&&window.setTimeout(()=>{const t=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");t&&t.execute(D=>{D.logActivity(b,k)})},Du.wDa)}duf(b,k){if(b&&k&&pe.ParagraphReader.Wb(k))k=this.sc.JC(k);else return null;return k.Fi(b)}get EH(){return null!=this.Czg?this.Czg:this.Czg=Fa.a.instance.resolve("Box4.IFontStylesGalleryCache")}}
Du.wDa=5E3;Object(n.a)(Du,"StyleActor",null,[]);var gt=c(1941);class Xx{constructor(b){this.ga=b}get pc(){return this.ga}gge(b,k=!1){this.pc.Nf(b,Pb.a.OPa,2,!0,null,k)}b5(b){this.pc.Qb(Pb.a.b5,2,b)}}Object(n.a)(Xx,"TextFormattingCommands",null,[440]);class Mq{constructor(b,k,t,D){this.jVe=this.Pih=!1;this.mJo=(P,ca,ta)=>{if(2!==ta)return 2;this.Pih||(this.Pih=!0);w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");
return 32};this.yGn=(P,ca,ta,Na,qb)=>{if(2!==ta)return 2;this.Z2i(qb,!0);return 32};this.xGn=(P,ca,ta,Na,qb)=>{if(2!==ta)return 2;this.Z2i(qb,!1);return 32};this.qHn=(P,ca,ta)=>{if(2!==ta)return 2;if(!this.U$a)return 8;this.U$a.Jqm();return 32};this.sGn=(P,ca,ta)=>{if(2!==ta)return 2;if(!this.U$a)return 8;this.U$a.l5n();return 32};this.gpa=(P,ca)=>{3===ca.Gx&&hf.SelectionEditor.km(ca.nl.kb)&&(bf.c(Pb.a.hJo),w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordExtendPageHeightInTouchSettings"),
this.jVe=!0)};this.ga=b;this.Ma=k;this.U$a=t;this.ib=D}get lJo(){return this.jVe}Tb(){var b;this.ga.fb($a.a.vP,lc.a.view,this.mJo,4);this.ga&&this.Ma&&(this.Ma.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.fb(Pb.a.Tjg,lc.a.view,this.yGn,4),this.ga.fb(Pb.a.Vjg,lc.a.view,this.xGn,4)),this.ga.fb($a.a.guj,lc.a.application,this.qHn,4),this.ga.fb($a.a.khf,lc.a.application,this.sGn,4),gm.EventHandlerManager.instance.NUn(()=>{this.htn()}));(null===(b=Wa.App.ya.gb.wc)||void 0===b?0:b.qe)&&Wa.App.ya.gb.wc.Hla(()=>
{this.m$n()});this.ib&&this.ib.Lw(this.gpa)}TMn(){bf.c(Pb.a.kJo);this.jVe=!0}m$n(){const b=window.performance.now();Mq.aIe&&250>b-Mq.aIe&&1E3<b-Mq.O3g&&(bf.c(Pb.a.jJo),Mq.O3g=b);this.U$a&&Mq.Xb&&Mq.Xb.vA(117)&&this.U$a.showFloatie()}mDm(b,k){if(k){var t=null;aa.a.KJ&&b&&(t=b.getSelection());b=null;t&&"Caret"===t.type&&(b=t.getRangeAt(0))&&this.U$a&&this.U$a.qTo(b.getBoundingClientRect(),k)}}htn(){Mq.aIe=window.performance.now()}Z2i(b,k){if(b)for(b=b.firstChild;b;){if("SPAN"===b.tagName&&b.classList.contains(Mq.Ntm)){for(b=
b.firstChild;b;)this.$yk(b,k),b=b.nextSibling;break}b=b.nextSibling}}$yk(b,k){if(b.classList.contains(Mq.Koi)){const t="WACImageResizeHandleTouch"+this.ZWl(b);k?b.classList.add(Mq.Loi,t):b.classList.remove(Mq.Loi,t)}}ZWl(b){for(const k of b.className.split(" "))if(k.startsWith("WACImageResizeHandle")&&k!==Mq.Koi)return F.a.substring(k,20,k.length);return""}static get Xb(){return null!=Mq.xyg?Mq.xyg:Mq.xyg=Fa.a.instance.Na("Box4.IFeatureHelper")}}Mq.Koi="WACImageResizeHandles";Mq.Loi="WACImageResizeHandlesTouch";
Mq.Ntm="WACImgSelection";Mq.aIe=0;Mq.O3g=0;Object(n.a)(Mq,"TouchInputActor",null,[439]);class xt{get SIa(){return Er.a.SIa}get RIa(){return Er.a.RIa}get Omc(){return Er.a.Omc}tpa(b,k,t,D,P,ca,ta){return Er.a.tpa(b,k,t,D,P,ca,ta)}Dfc(b,k,t,D,P,ca){return Er.a.Dfc(b,k,t,D,P,ca)}static get instance(){xt._instance||(xt._instance=new xt);return xt._instance}}xt._instance=null;Object(n.a)(xt,"ViewActionHandlerProxy",null,[438]);class bu{constructor(b,k){this.kpiName="VisiMarkersUsage";this.W7="wwaengidc";
this.skb=new Map;this.$vo=(t,D,P,ca,ta)=>{if(1===P)return 32;if(!ta)return 2;this.skb.set("Source",Id.a[this.ga.U_]);this.OWe.pWc?this.skb.set("Action","Removed"):this.skb.set("Action","Applied");xa.Health.instance.recordKpiUsage(this.kpiName,1,this.W7,this.skb);t=document.getElementsByTagName("head")[0];if(!this.OWe.DIo(t))return v.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;Wa.App.ya.VG({ShowVisiMarkers:"ToggleButtonModel"});return 32};this.QJn=(t,D,P,ca,ta)=>{if(1===
P)return 32;ta[kg.a.On]=this.OWe.pWc;return 32};this.ga=b;this.OWe=k}Tb(){this.ga.fb(Pb.a.Iie,lc.a.application,this.$vo,1);this.ga.fb(Pb.a.y4i,lc.a.application,this.QJn,96)}}Object(n.a)(bu,"VisiMarkersActor",null,[]);var Yx=c(107);class ez{constructor(b,k,t,D,P){this.Un=b;this.zhn=k;this.lj=t;this.Ld=D;this.characterPropertiesEditor=P}get dRi(){return this.zhn.value}execute(b,k,t,D){const P=Hi.a.instance.zp(Pb.a.aio);va.OutlineElementReader.isEmpty(b,!1)?this.ywl(b):this.zwl(b,k,t,D);P.end()}ywl(b){this.dRi.t5e(b,
-1)?this.dRi.VRa(b,-1,0):this.Un.$Ga(b,{M9i:!0})}zwl(b,k,t,D){k=D(b,k,t);b=pe.ParagraphReader.xl(b.currentNode);!this.Un.XOb&&this.lSm(b)&&this.Iuk(k);this.Un.Y9();(null===b||void 0===b?0:b.pa)&&!b.pa.last.formatting&&this.characterPropertiesEditor.c0a(b)}lSm(b){return b.Mi&&!b.vz.hasProperty(Cc.a.listID)}Iuk(b){ag.OutlineElementNavigator.Ge(b);b=b.currentNode;const k=new Yx.a;b.Kc.Ju(k);this.lj.YU(b,k,this.Ld.qg)}}Object(n.a)(ez,"ListNewLineStrategy",null,[]);var lx=c(1051),cv=c(469);class zB{xc(b){b.ha("Box4.Actors.Box4PasteStewardFactory",
()=>new ax(ks.a.BEb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").singleInstance();b.ha("Box4.Actors.Box4PasteStewardUtils",()=>new xo(w.AFrameworkApplication.K.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").singleInstance();b.ha("Box4.Actors.ClipboardActor",()=>new Qt.ClipboardActor(b.Ue("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),
Hi.a.instance,b.resolve("Box4.IClipboardDataHelper"),af.a.instance,w.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),w.AFrameworkApplication.K,ad.FocusManager.instance(),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),w.AFrameworkApplication.Gdg(),w.AFrameworkApplication.kqj(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Fa.a.instance.resolve("Common.IReactContextualUILauncher"),
!!Wa.App.instance&&Wa.App.instance.mha)).singleInstance();b.ha("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new Zw(w.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Clipboard.ISystemClipboardAccessManagerFactory",()=>new lo(w.AFrameworkApplication.K,b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Box4.IClipboardDataHelper"),Yu.a.instance)).singleInstance();b.ha("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).singleInstance();
b.ha("Box4.Actors.ISystemClipboard",()=>new jA(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),Lb.InteractiveViewManager.instance,Wa.App.ya.gb,ad.FocusManager.instance(),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),Yu.a.instance,w.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IDeleteTableSegmentStrategy",()=>new aj).singleInstance();b.ha("Box4.ISelectionFactory",()=>new ct.a).singleInstance();b.ha("Box4.IRenderOrderGraphIteratorFactory",()=>
new Jq).singleInstance();b.ha("Common.IDomElementContentStateFactory",()=>new Fy).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",()=>new hx(af.a.instance,b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();b.ha("Box4.Actors.PastedContentsPostProcessorHelper",()=>new tB).singleInstance();b.ha("Box4.Actors.PasteFloatiePositionProvider",()=>new kx(af.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Lb.InteractiveViewManager.instance,
$d.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!Wa.App.instance&&Wa.App.instance.mha)).singleInstance();b.ha("Box4.Actors.PasteFloatieFeatureSetBuilder",()=>new nz(b.resolve("Box4.IClipboardDataHelper"),Wa.App.Zv.KI)).singleInstance();b.ha("Box4.Actors.PasteFloatieEventManager",()=>new mz(b.resolve("Box4.UI.PasteFloatieManager"),b.resolve("Box4.IPasteFloatieEventSource"),Lb.InteractiveViewManager.instance,jw.a.instance(),w.AFrameworkApplication.ta,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),
b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Wa.App.Lj.Bl.Ze(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),!!Wa.App.instance&&Wa.App.instance.mha)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteFactory",()=>new YC(Hi.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.PasteCoordinator"),dt.a.instance,af.a.instance,w.AFrameworkApplication.va,
b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.Ue("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();b.ha("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new jC(w.AFrameworkApplication.va,Hi.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.IOutlineElementEditor"),af.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),
b.resolve("Box4.IParagraphReader"),Xr.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),b.resolve("Box4.IRenderOrderGraphIteratorFactory"),b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),b.Na("Box4.IFeatureHelper"))).singleInstance();b.ha("Box4.Actors.IClipboardOperationClipboardAccessHelper",()=>new Up(Hi.a.instance,Yu.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),
b.resolve("Common.ISimpleOperationFactory"),w.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteStrategyFactory",()=>new eA(w.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IClipboardOperationFactory",()=>new gx(b.resolve("Box4.Actors.InternalClipboard"),w.AFrameworkApplication.va,w.AFrameworkApplication.Cdg(),Hi.a.instance,Xr.a.instance,Yu.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),b.resolve("Box4.ICannotCutDialog"),b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.IPasteFloatieEventSource"),
b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new sB(b.Ue("Box4.Actors.IBox4PasteStewardFactory"),b.Ue("Box4.Actors.IBox4ImageStewardFactory"),b.Ue("Box4.Actors.IBox4TableStewardFactory"),b.Ue("Box4.Actors.IBox4WordConverterFactory"),b.Ue("HtmlImport.IHtmlTranslatorSettings"),b.Na("Box4.IContentControlCopyPasteHelper"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.IExternalPasteCssConverter"),b.resolve("HtmlImport.IHtmlNormalizerSettings"),
b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"),b.resolve("Box4.IFieldCopyPasteHelper"))).singleInstance();b.ha("Box4.Actors.InternalClipboard",()=>new Av.a(b.resolve("Box4.Images.IImageEditor"),b.Ue("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),Wa.App.Lj,b.resolve("Box4.IParagraphIndentationReader"),w.AFrameworkApplication.K,b.resolve("Box4.Graph.IGraphNodeFactory"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.Na("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IConstantsProvider").nij,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();b.ha("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new Jy(b.resolve("Box4.Actors.InternalClipboard"),b.Na("Box4.IContentControlCopyPasteHelper"),new Rg.a(()=>Wa.App.ya.gb.wc),b.resolve("Box4.IFormattingPropertyTransitStrategy"),
b.resolve("Box4.IFieldCopyPasteHelper"))).singleInstance();b.ha("Box4.List.IListCommands",()=>new yB(w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.List.ListNewLineStrategy",()=>new ez(b.resolve("Box4.List.IListEditor"),b.Ue("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.ICharacterPropertiesEditor"))).singleInstance();b.ha("Box4.Actors.PasteCoordinator",
()=>new So(b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),Yj.a.instance)).singleInstance();b.ha("Box4.Actors.Box4ImageStewardFactory",()=>new Vp(b.resolve("Box4.Images.IImageEditor"),w.AFrameworkApplication.nc,b.resolve("Box4.IUndoManager"),b.Na("Box4.Actors.IImageStewardBridge"),Wa.App.ya.notificationBar,b.Na("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").singleInstance();
b.ha("Box4.Actors.Box4TableStewardFactory",()=>new yn(Fa.a.instance.resolve("Box4.List.IListEditor"),Fa.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").singleInstance();b.ha("Box4.Actors.ClipboardOperationWordStrategy",()=>new kC(Hi.a.instance,af.a.instance,Wa.App.rd,Yj.a.instance)).singleInstance();b.ha("Box4.Actors.Box4WordConverterFactory",
()=>new Dy(w.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").singleInstance();b.ha("Box4.Actors.IExternalPasteCssConverter",()=>new Yr(w.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IHtmlNormalizerHelper",()=>new ix).singleInstance();b.ha("Box4.ISelectionCommands",()=>new zu(w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.ITextFormattingCommands",()=>new Xx(w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.Actors.AccessibilityActor",()=>new su(b.Sa("Box4.Accessibility.IAccessibilityContextManager"),
b.resolve("Box4.Proofing.IErrorRangeEditor"))).singleInstance();b.ha("Box4.Actors.InsertionPointFormatting",()=>new xB(b.Na("Box4.IFontSlotProvider"),b.Sa("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").singleInstance();b.ha("Box4.UI.PasteFloatieManager",()=>new bx).as("Box4.UI.IFloatieManager").singleInstance();b.ha("Box4.Actors.ProofingActor",()=>new au(Fa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),w.AFrameworkApplication.va,()=>Fa.a.instance.resolve("Box4.UI.ILanguageDialog"),
Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Fa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),af.a.instance,Fa.a.instance.Sa("Box4.IExternalSelectionManager"),Xr.a.instance,Fa.a.instance.resolve("Box4.ISelectionContextMenuProvider"),Yj.a.instance,Hi.a.instance,Fa.a.instance.resolve("Box4.IContextMenuController"),Fa.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Fa.a.instance.Sa("Box4.Actors.IProofingErrorPresenter"),Fa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),
Fa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();b.ha("Box4.Actors.StyleActor",()=>new Du(Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Fa.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Fa.a.instance.resolve("Box4.IFormattingEditor"),li.ContextSetEditor.instance,Fa.a.instance.resolve("Box4.IInsertionPointFormatting"),Yj.a.instance,Hi.a.instance,Fa.a.instance.resolve("Box4.TextFormattingHelper"),xt.instance,Fa.a.instance.resolve("Box4.Styles.IWACStyleReader"),
Fa.a.instance.resolve("Box4.IContentControlChpHelper"))).singleInstance();b.ha("Box4.Actors.StyleContextMenuActor",()=>new $w(Fa.a.instance.resolve("Box4.IUpdateStyleManager"),Fa.a.instance.resolve("Box4.Styles.IWACStyleReader"),w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.Actors.TextFormattingActor",()=>new gt.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Na("Box4.IFontSlotProvider"),b.Na("Box4.IContentControlChpHelper"),
Fa.a.instance.resolve("Box4.IFormattingEditor"),Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Fa.a.instance.resolve("Box4.IParagraphEditor"),Fa.a.instance.resolve("Box4.ILineSpacingHelper"),Fa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Fa.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Fa.a.instance.resolve("Box4.IOutlineElementEditor"),Fa.a.instance.resolve("Box4.List.IListFormattingEditor"),Fa.a.instance.resolve("Box4.IParagraphIndentationReader"))).singleInstance();b.ha("Box4.Actors.AutoCorrectActor",
()=>new xm(w.AFrameworkApplication.va,Hi.a.instance,()=>Fa.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).singleInstance();b.ha("Box4.Actors.TouchInputActor",()=>new Mq(w.AFrameworkApplication.va,w.AFrameworkApplication.K,iz.GrippersManager.instance,af.a.instance)).as("Box4.ITouchInputActor").singleInstance();b.register(cA,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").singleInstance();b.ha("Box4.Actors.VisiMarkersActor",()=>new bu(w.AFrameworkApplication.va,b.resolve("Box4.IVisiMarkersOperation"))).singleInstance();
b.ha("Box4.Actors.IndentationActorExtension",()=>new pz).as("Box4.Actors.IIndentationActorExtension").singleInstance();lx.a.BZd&&b.ha("Box4.Actors.PageColorActor",()=>new lx.a(cv.a.instance,new Rg.a(()=>Wa.App.ya.gb.wc.ed),Xk.a.instance,tk.a.instance)).singleInstance()}}Object(n.a)(zB,"Box4ActorsComponentConfiguration",null,[2]);var Zx=c(222),lA=c(1081);const ZC=()=>{const b=rz;w.AFrameworkApplication.va.qa(Pb.a.Rff,lc.a.embeddedFile,b);w.AFrameworkApplication.va.qa(Pb.a.Rff,lc.a.k6b,b);w.AFrameworkApplication.va.qa(Pb.a.Qff,
lc.a.embeddedFile,mA);w.AFrameworkApplication.va.qa(Pb.a.Qff,lc.a.k6b,mA)},rz=(b,k,t)=>Wa.App.FId?8:2===t?(b=new Uc.StandardDialog,b.Ad=4,b.XU(1),b.Ee(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.Ee(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.ueg(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,uw),32):2,uw=b=>{1===b&&w.AFrameworkApplication.va.processAction(Pb.a.Qff,2)},mA=(b,k,t)=>{if(Wa.App.FId)return 8;if(1===t)return k.node.hasProperty(sf.a.embeddedFileContainer)?
32:2;if(2===t&&(k.contextId===lc.a.view&&k.view.mb&&(k=k.view.mb.sg),Zx.isEmbeddedFileOrFloatingEmbeddedFileContext(k))){b=lA.a.RUl(k.node);Mb.a.Jmo();try{AB(b)}catch(D){v.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",D)}}return 32},AB=b=>{$d.a.nm(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var Bv=c(771),nA=c(942),oA=c(984);class yt{constructor(b){this.LAa=this.yV=null;this.Xha=(k,t,D,P,ca)=>{if(1===D)return 32;w.AFrameworkApplication.va.Qb(Pb.a.g5a,2,ca);k=ca&&0<=ca.fontColor&&
16777215>=ca.fontColor?ca.fontColor:0;Wa.App.ya.Tw();(new nA.a(yt.yGc,Pb.a.fqa)).vjc(k);return 32};this.lLb=(k,t,D,P,ca)=>{if(1===D)return 32;if(2===D&&!ca)return 8;k=yt.lf.NQd(t);t=new Bv.a;D=null;32===w.AFrameworkApplication.va.Qb(Pb.a.g5a,2,t)&&t&&(D=t.fontColor);P="";D&&!t.o6b&&(P=ch.a.XE(D)||"");this.u0h.DNb=P;this.nVc&&this.recentColors.Omg(P);k=this.u0h.yMc(k,Wa.App.xAb);if(!k)return 8;ca.MenuItems=k;v.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.FJe=
b}get u0h(){this.yV||(this.yV=new oA.a(yt.yGc),this.VEa(this.yV));return this.yV}VEa(b){b.GW(1,Pb.a.qfa);b.GW(3,Pb.a.Mv);b.GW(4,Pb.a.Mv);b.GW(5,Pb.a.fqa);b.GW(6,Pb.a.Xha);b.Vyb(this.FJe,1)}Tb(){const b=w.AFrameworkApplication.va;b.qa(Pb.a.Xha,lc.a.view,this.Xha);b.qa(Pb.a.lLb,lc.a.view,this.lLb);b.Vc(Pb.a.lLb,1127)}static OVl(){return new yt(cv.a.instance)}static get instance(){return null!=yt.yBg?yt.yBg:yt.yBg=yt.OVl()}get recentColors(){return null!=this.DFg?this.DFg:this.DFg=Fa.a.instance.Na("Box4.UI.RecentColorsSectionHandler")}static get lf(){return Yg.PageReader.instance}get nVc(){null==
this.LAa&&(w.AFrameworkApplication.ue("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.LAa=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.LAa}}yt.yGc="Font";Object(n.a)(yt,"FontColorActor",null,[]);class vw{constructor(b){this.Xha=(k,t,D,P,ca)=>{if(1===D)return 32;w.AFrameworkApplication.va.Qb(Pb.a.g5a,2,ca);k=ca&&0<=ca.highlight&&16777215>=ca.highlight?ca.highlight:0;Wa.App.ya.Tw();
(new nA.a("Highlighter",Pb.a.F9)).vjc(k);return 32};this.ga=b}Tb(){this.ga.qa(Pb.a.aYi,lc.a.view,this.Xha)}static HXl(){return new vw(w.AFrameworkApplication.va)}static get instance(){return null!=vw.iCg?vw.iCg:vw.iCg=vw.HXl()}}Object(n.a)(vw,"HighlighterColorActor",null,[]);var pr=c(372),sq=c(86);class Cv{static get Xg(){return Wf.a.lA(Cv.Lm,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}Cv.Lm="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(n.a)(Cv,"InsertLinkDialogHtml",null,[]);class To extends Wf.a{constructor(b){super();this.Z6d=()=>{const k=document.getElementById("txtLink");this.bqa(1,!k||!k.value.length||re.HyperlinkReader.n3a(k.value))};this.mAf=(k,t)=>{if(this.mh.fv){var D=this.mh.mb.hb.kb;if(D)if(D.equals(this.rx)&&0!==k){k=new Xd.GraphTransaction(15);k.Cb(this.US[0].node);for(D=0;D<this.US.length;D++)this.US[D].node.FH().jF.p7(4);D=t.txtLink.trim();t=this.Khl();D=this.Wzm(D);(t||D)&&To.Ld.Js(7);this.hide();k.dispose()}else this.mh.s5()}};
this.US=b;this.mh=Lb.InteractiveViewManager.instance.Bd;this.rx=this.mh.mb.hb.kb;this.kkf=b[0].cpBegin;this.ZHf=b[b.length-1].cpEnd;this.vg="InsertMultiParagraphLinkDialog";b=this.PSo();this.showDialog("",b)}showDialog(b,k){v.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.Xg=Cv.Xg;""===k.trim()&&this.Ee(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.Wh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.mAf,{["txtLink"]:k,["txtDisplay"]:b});document.getElementById("txtLink").focus();
document.getElementById("txtDisplay").disabled=!0;To.BDf&&(b=document.getElementById("txtLink"),vf.a.addHandler(b,Rc.a.input,this.Z6d),vf.a.addHandler(b,Rc.a.change,this.Z6d))}hide(){if(To.BDf){const b=document.getElementById("txtLink");b&&(vf.a.removeHandler(b,Rc.a.change,this.Z6d),vf.a.removeHandler(b,Rc.a.input,this.Z6d))}super.hide()}Nua(b){return To.BDf?this.$Ml(this.Vqc)?super.Nua(b):!1:super.Nua(b)}PSo(){let b;var k="";const t=this.US.length,D=re.HyperlinkReader.MD(this.US[0],!1);0<D.length&&
({cpBegin:P,cpEnd:b}=To.L_.Dga(this.US[0],D[0]),P<=this.US[0].cpBegin&&(k=D[0].hyperlink.url),this.kkf=Math.min(this.kkf,P));var P=re.HyperlinkReader.MD(this.US[t-1],!1);0<P.length&&({cpBegin:P,cpEnd:b}=To.L_.Dga(this.US[t-1],P[P.length-1]),this.ZHf=Math.max(this.ZHf,b));this.QLo(this.kkf,this.ZHf);return k}QLo(b,k){const t=this.US.length;if(b!==this.US[0].cpBegin||k!==this.US[t-1].cpEnd){b=Of.a.Rc(this.US[0].node,b);b=Gf.SelectionFactory.ho(b);k=Of.a.Rc(this.US[t-1].node,k);k=Gf.SelectionFactory.jA(b,
k);b=this.Bhi(k.Qa.clone());const D=this.Bhi(k.Qc.clone());b&&D&&(this.US[0]=b,this.US[t-1]=D,this.mh.mb.setSelection(k),this.rx=k)}}Wzm(b){if(!b)return!1;b=re.HyperlinkReader.dPa(b);for(let t=0;t<this.US.length;t++){var k=this.US[t];if(To.yta&&hf.SelectionEditor.ml(k)&&(k=hf.SelectionEditor.rkg(k),!hf.SelectionEditor.ml(k)))continue;k=Of.a.createTextRange(this.US[t].node,k.cpBegin,k.cpEnd);this.tLo(k);To.hyperlinkEditor.hG(k,b,!1)}return!0}tLo(b){sq.a.instance.J(1)&&To.Ld.KAj(b)}Bhi(b){return pe.ParagraphReader.lm(b)&&
!hf.SelectionEditor.w8(b)&&pe.ParagraphReader.textLength(b.node)?Of.a.createTextRange(b.node,0,pe.ParagraphReader.textLength(b.node)):hf.SelectionEditor.ml(b)?b:null}Khl(){let b=!1;for(const k of this.US){const t=re.HyperlinkReader.MD(k,!1);t&&(b=To.L_.J9i(k,t)||b)}return b}static get L_(){return null!=To.FAg?To.FAg:To.FAg=Fa.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Ld(){return null!=To.cIg?To.cIg:To.cIg=Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get hyperlinkEditor(){return null!=
To.wAg?To.wAg:To.wAg=Fa.a.instance.resolve("Box4.IHyperlinkEditor")}static get yta(){null==To.b$&&(To.b$=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return To.b$}static get BDf(){null==To.gFe&&(To.gFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return To.gFe}}To.b$=null;To.gFe=null;Object(n.a)(To,"InsertMultiParagraphLinkDialog",Wf.a,[]);var pA;(function(b){b.Heading="Heading";b.Bookmark="Bookmark";
b.Url="Url";b.RecentLinks="RecentLinks"})(pA||(pA={}));Object(n.b)("InsertLinkUserActivitySource",pA);class Kh{constructor(b,k,t,D,P){this.linkurl=b;this.isHeading=k;this.startCp=t;this.endCp=D;this.paragraphNode=P}}Object(n.a)(Kh,"HeadingDataForLinkDialog",null,[]);class ww{constructor(b,k){this.linkurl=b;this.isHeading=k}}Object(n.a)(ww,"BookmarkDataForLinkDialog",null,[]);class tq{constructor(b,k,t,D,P,ca){this.key=b;this.name=k;this.startIndex=t;this.count=D;this.level=P;this.isCollapsed=ca}}
Object(n.a)(tq,"GroupHeaderDataForLinkDialog",null,[]);class qA{constructor(b,k){this.selectedIndex=b;this.selectedGroupId=k}}Object(n.a)(qA,"SelectedItemFromLinkDialogGroupedList",null,[]);class rA{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){this.fr=b;this.vd=k;this.Xol=t;this.bookmarkManager=D;this.L_=P;this.hyperlinkEditor=ca;this.characterPropertiesEditor=ta;this.Ld=Na;this.lj=qb;this.Jk=Jb;this.qwa=Vb;this.lDb=null;this.vvi=!1;this.mAf=(Kc,ed)=>{var sd;if(this.je.fv){var oe=re.HyperlinkReader.kPc(this.fr),
Ld=this.je.mb.hb.kb;if(Ld){Ld=Ld.Qa;pe.ParagraphReader.lm(Ld)&&(Ld=Of.a.createTextRange(Ld.node,0,pe.ParagraphReader.textLength(Ld.node)));var Od=hf.SelectionEditor.fQb(Ld);hf.SelectionEditor.ml(Od)&&(Ld=Od);if(0!==Kc&&32===w.AFrameworkApplication.va.Nf(Ld,Pb.a.insertHyperlink,1,!0,null,null)&&this.fr.equals(Ld)){Hj.a.mark(5562);(null===(sd=Wa.App.rd)||void 0===sd?0:sd.Yo)&&this.je.mb.H_b();Kc=new Xd.GraphTransaction(15);Kc.Cb(this.fr.node);this.fr.node.FH().jF.p7(4);sd=ed.txtDisplay;Ld=!1;if(null!=
ed.linkurl)if(Ld=!0,ed.isHeading){m(this.vd,"Heading");Od=ed.paragraphNode;const ie=ed.startCp,Ce=ed.endCp;ed=this.bookmarkManager.sMl(Od);this.bookmarkManager.jDc(ed,ie,Ce,Od,Od,!1)}else m(this.vd,"Bookmark"),ed=ed.linkurl;else m(this.vd,"Url"),ed=ed.txtLink.trim();this.insertLink(sd,ed,oe,Ld);Kc.fk=Pb.a.insertHyperlink;Kc.dispose();Hj.a.mark(5563);this.fr.node.hgb()}else this.je.s5()}else v.ULS.sendTraceTag(509372371,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}};
this.je=Lb.InteractiveViewManager.instance.Bd;this.fr=b;t=hf.SelectionEditor.fQb(this.fr);hf.SelectionEditor.ml(t)&&(this.fr=t);const ac=new Wf.a(!1,!1,!0);t=this.RWl();D={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:t};P=this.lDb="";P=pe.ParagraphReader.text(this.fr.node);
ta=this.fr.cpBegin;Na=this.fr.cpEnd;({J9f:P,Eif:ta,Fif:Na,nyf:ca}=this.CSl(P));if((k="object"===typeof k?k:null)&&(k.Source&&"CommandingInterface"===k.Source||k.Url&&k.DisplayText))this.insertLink(k.DisplayText,k.Url,ca);else{ca[0]&&this.Rwl(ta,Na,ca[0].paragraph);k=""===P.trim()?Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;ac.Ee(1,k);(null===P||void 0===P?0:P.startsWith(F.a.Sdb))?(k=this.R$l(P,t))?t.selectedItem=k:D.txtLink=P:D.txtLink=P;D.txtDisplay=this.lDb;1>=ca.length&&
this.L_.s3k(b,ca[0],1===ca.length)&&(this.vvi=!0,D.textDisplayDisabled=!0);var yc={["id"]:"InsertLinkDialog",["bodyControls"]:D};this.Jk.ie(()=>{ac.Wh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.mAf,yc)},"RILD:IAS")}}CSl(b){const k=re.HyperlinkReader.kPc(this.fr);let t=this.fr.cpBegin,D=this.fr.cpEnd,P="";if(!k.length)return this.lDb=b.substring(this.fr.cpBegin,this.fr.cpEnd),{returnValue:!0,J9f:P,Eif:t,Fif:D,nyf:k};if(k[0].hyperlink){let ca,ta=0,Na=Math.max(0,b.length-1),qb=0;for(let Jb=0;Jb<k.length;Jb++)k[Jb].cpBegin>=
ta&&({cpBegin:ca,cpEnd:ta}=this.L_.Dga(this.fr,k[Jb]),Na=Math.min(ca,Na),qb=Math.max(ta,qb));t=Math.min(Na,t);D=Math.max(qb,D);this.lDb=b.substring(t,D);t===Na&&(P=k[0].hyperlink.url);return{returnValue:!0,J9f:P,Eif:t,Fif:D,nyf:k}}return{returnValue:!1,J9f:P,Eif:t,Fif:D,nyf:k}}Rwl(b,k,t){if(k!==this.fr.cpEnd||b!==this.fr.cpBegin)b=Gf.SelectionFactory.GK(t,b,k),this.je.mb.setSelection(b),this.fr=hf.SelectionEditor.fQb(b.Qa.clone())}MJo(b,k,t,D,P,ca=!1){D?(D=Of.a.createTextRange(this.fr.node,this.fr.cpBegin,
this.fr.cpBegin+b.length),this.hyperlinkEditor.Qql(D,t,k),b=Gf.SelectionFactory.te(this.fr.node,this.fr.cpBegin+b.length)):(this.hyperlinkEditor.Alb(this.fr,2),this.lj.vob(this.fr,2),t=Of.a.Rc(this.fr.node,this.fr.cpEnd),this.characterPropertiesEditor.replaceTextRange(t,b,!0),D=Of.a.createTextRange(this.fr.node,this.fr.cpEnd,this.fr.cpEnd+b.length),this.hyperlinkEditor.hG(D,k,P,!1,!0,ca),b=Gf.SelectionFactory.te(this.fr.node,this.fr.cpEnd+b.length));b&&this.je.mb.setSelection(b)}insertLink(b,k,t,
D=!1){var P=null;b||(b=k,w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(k&&(!t.length||k!==t[0].hyperlink.url)&&!D){k=re.HyperlinkReader.dPa(k);var ca="";this.qwa&&({y4f:ca}=this.qwa.wkg(k)).returnValue&&(k=ca)}this.vvi||(b=this.hyperlinkEditor.S1n(b));ca=!1;if(k){P=0<t.length;const ta=pe.ParagraphReader.text(this.fr.node).substring(this.fr.cpBegin,this.fr.cpEnd)!==b,Na=this.Ld.qg;if(Na&&1===t.length&&!t[0].hyperlink.BG&&
!(t[0].cpBegin>this.fr.cpBegin&&t[0].cpEnd<=this.fr.cpEnd)){this.MJo(b,k,t[0].hyperlink,!ta,P,D);return}if(P)for(let qb=0;qb<t.length;qb++)t[qb].hyperlink.BG&&(ca=!0),this.hyperlinkEditor.CR(this.fr.node,t[qb].hyperlink,!1);ta?this.characterPropertiesEditor.replaceTextRange(this.fr,b,!ca):Na&&!ca&&this.lj.vob(this.fr,1);t=Of.a.createTextRange(this.fr.node,this.fr.cpBegin,this.fr.cpBegin+b.length);this.hyperlinkEditor.hG(t,k,P,ca,!0,D);P=Gf.SelectionFactory.te(this.fr.node,this.fr.cpBegin+b.length)}else 0<
t.length&&(b=t[0],b.hyperlink.BG&&(ca=!0),this.hyperlinkEditor.CR(b.paragraph,b.hyperlink));ca&&this.Ld.Js(ca?2:7);P&&this.je.mb.setSelection(P);Wa.App.gLo()}R$l(b,k){k=k.items;const t=b.substring(F.a.Sdb.length),D=this.bookmarkManager.Fci(t);b=-1;let P=0;for(let ca=0;ca<k.length;ca++)if(k[ca].isHeading&&0!=D.count&&k[ca].paragraphNode.id==D.J(0).id){b=ca;break}else if(!k[ca].isHeading&&k[ca].linkurl==t){b=ca;P=1;break}k=new qA(b,P);return-1!=b?k:null}RWl(){const b={};let k=[],t=0,D=0;var P=this.Xol.tXl();
P&&(t=P.count,k=k.concat(this.yXl(P)));if(P=this.bookmarkManager.ANd(!1))D=P.count,k=k.concat(this.wMl(P));b.groups=this.lXl(t,D);b.items=k;return b}lXl(b,k){const t=[],D=new tq("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);t.push(D);b=new tq("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,b,k,0,!0);t.push(b);return t}yXl(b){const k=[],t=/\uFFFC/;for(const D of b)b=D.characterData.replace(t," "),b=new Kh(b,!0,D.begin,D.end,D.paragraphNode),k.push(b);
return k}wMl(b){const k=[];for(const t of b)b=t.Lf(Cc.a.jt).toString(),b=new ww(b,!1),k.push(b);return k}}Object(n.a)(rA,"ReactInsertLinkDialog",null,[]);class rf{static get Vf(){return Yj.a.instance}static get aX(){return null!=rf.Lwg?rf.Lwg:rf.Lwg=Fa.a.instance.Na("Box4.IContentControlChpHelper")}static get L_(){return null!=rf.GAg?rf.GAg:rf.GAg=Fa.a.instance.resolve("Box4.IHyperlinkStrategy")}static Vw(){return rf.Sm||(rf.Sm=Fa.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Ld(){return null!=
rf.oIg?rf.oIg:rf.oIg=Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Ch(){return null!=rf.vIg?rf.vIg:rf.vIg=Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Wg(){return li.ContextSetEditor.instance}static get Ic(){return Hi.a.instance}static get eZc(){null==rf.Rqb&&(rf.Rqb=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return rf.Rqb}static get yta(){null==rf.b$&&(rf.b$=
w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return rf.b$}static get hyperlinkEditor(){return null!=rf.CAg?rf.CAg:rf.CAg=Fa.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=rf.ywg?rf.ywg:rf.ywg=Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get d3a(){rf.EFe||(rf.EFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("IsO365CommercialHost")||w.AFrameworkApplication.K.$("IsO365ConsumerHost"):
!1);return rf.EFe}static get pHo(){rf.sih||(rf.sih=w.AFrameworkApplication.K?w.AFrameworkApplication.K.mc("WordRecentLinksTimeInMsBetweenTwoMruCalls",6E4):6E4);return rf.sih}static Tb(){const b=w.AFrameworkApplication.va;b.qa(Pb.a.insertHyperlink,lc.a.view,rf.RFb);b.qa(Pb.a.insertHyperlink,lc.a.Tc,rf.insertLink);b.qa(Pb.a.insertHyperlink,lc.a.Hd,rf.insertLink);b.Vc(Pb.a.insertHyperlink,1028);b.qa(Pb.a.a5b,lc.a.view,rf.RFb);b.qa(Pb.a.a5b,lc.a.Tc,rf.insertLink);b.qa(Pb.a.a5b,lc.a.Hd,rf.insertLink);
b.Vc(Pb.a.a5b,1028);b.qa(Pb.a.CR,lc.a.view,rf.RFb);b.qa(Pb.a.CR,lc.a.Tc,rf.T9i);b.qa(Pb.a.CR,lc.a.Hd,rf.T9i);b.Vc(Pb.a.CR,1028);b.qa(Pb.a.cfe,lc.a.view,rf.RFb);b.qa(Pb.a.cfe,lc.a.Tc,rf.ahj);b.qa(Pb.a.cfe,lc.a.Hd,rf.ahj);b.qa(Pb.a.F4a,lc.a.view,rf.RFb);b.qa(Pb.a.F4a,lc.a.Tc,rf.dYi);b.qa(Pb.a.F4a,lc.a.Hd,rf.dYi);b.qa(Pb.a.F4a,lc.a.image,rf.GWf);b.qa(Pb.a.F4a,lc.a.YCb,rf.GWf);b.qa(Pb.a.F4a,lc.a.anchoredObject,rf.GWf);b.qa(Pb.a.hGc,lc.a.application,rf.hGc);b.qa(Pb.a.YFd,lc.a.view,rf.RFb);rf.d3a&&(b.fb($a.a.p5a,
lc.a.view,this.RFb.bind(this),1028),b.qa($a.a.p5a,lc.a.Tc,this.p5a.bind(this)),b.qa($a.a.p5a,lc.a.Hd,this.p5a.bind(this)),b.Vc($a.a.p5a,1028),b.qa($a.a.nAf,lc.a.Tc,this.p5a.bind(this)),b.qa($a.a.nAf,lc.a.Hd,this.p5a.bind(this)),b.Vc($a.a.nAf,1028),b.qa($a.a.LZf,lc.a.view,this.LZf.bind(this)),b.qa($a.a.FZf,lc.a.view,this.FZf.bind(this)),b.fb($a.a.Vib,lc.a.Tc,this.Vib.bind(this),1028),b.fb($a.a.Vib,lc.a.Hd,this.Vib.bind(this),1028))}static hGc(){return 32}static p5a(b,k,t){if(!rf.d3a)return 2;b=rf.qIj(k);
if(32!=b)return b;if(!rf.xQa(k,!0).returnValue||rf.Z2b(k))return 8;1!==t||rf.u_h||(rf.Ene(!0),rf.u_h=!0);return 32}static LZf(b,k,t,D,P){if(!rf.d3a)return 2;if(1===t)return 32;rf.lce(rf.lek,rf.mek,rf.Hbh);pr.a.instance.ie(()=>{rf.Ene();P.MenuItems=Object.assign(new be.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const ca=this.hMh();ca?(v.ULS.sendTraceTag(526242130,324,50,"Recent Links data load success in ribbon"),P.MenuItems.MenuSectionList.push(ca)):rf.W0i(P,rf.Hbh)},"HA:PRLF");
return 32}static FZf(b,k,t,D,P){if(!rf.d3a)return 2;if(1===t)return 32;rf.lce(rf.jek,rf.kek,rf.Gbh);pr.a.instance.ie(()=>{rf.Ene();P.MenuItems=Object.assign(new be.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});P.MenuItems.MenuSectionList.push(this.j$k());const ca=this.hMh(!0);ca?(v.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),P.MenuItems.MenuSectionList.push(ca)):rf.W0i(P,rf.Gbh)},"HA:PILF");return 32}static W0i(b,k){v.ULS.sendTraceTag(524911777,
324,50,"Recent Links could not load in "+k);rf.lce(rf.Mak,rf.Nak,k);b.MenuItems.MenuSectionList.push(this.Lbl());rf.Ene(!0)}static Lbl(){const b=this.Taf("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new zg.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));return b}static j$k(){const b=this.Taf("InsertLinkSection");b.ControlList.push(Object.assign(new zg.a,{ExternalId:"InsertLink"}));return b}static hMh(b=!1){if(Gk.instance.jsd){var k=
this.Taf("RecentLinksSection",b);b=JSON.parse(Gk.instance.jsd);this.isd.clear();b.forEach((t,D)=>{this.isd.set(D,[t.FileName,t.DocumentUrl]);const P=rf.J8l(t.FileName);var ca=rf.nWl(t.TimeStamp),ta=k.ControlList,Na=ta.push,qb=Object,Jb=qb.assign,Vb=new zg.a,ac=$a.a.Vib,yc=$a.a.Vib;ca=P!==t.FileName?t.FileName+"\n"+ca:ca;var Kc=t.FileName;let ed="SaveAsWordDocx_32";switch(t.App){case "Word":ed="SaveAsWordDocx_32";break;case "PowerPoint":ed="SaveAsPowerPointPptx_32";break;case "Excel":ed="SaveAsExcelXlsx_32"}Na.call(ta,
Jb.call(qb,Vb,{ExternalId:D,Command:ac,CommandValueId:yc,LabelText:P,Alt:ca,AriaDescription:Kc,ExternalImageId:ed,KeyTip:t.FileName}))});return k}}static Taf(b,k=!1){return Object.assign(new fh.a,{Title:k?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+b,ControlList:[]})}static Vib(b,k,t,D,P){if(!rf.d3a)return 2;if(!P||P.CommandValueId!=$a.a.Vib)return 32;rf.lce(rf.e6j,rf.f6j,rf.yfk);t=k;k=new Xd.GraphTransaction(15);k.fk=b;k.Cb(t.node);
D=rf.xQa(t,!0).hyperlink;t=hf.SelectionEditor.fQb(t);if(D)rf.r5f(t),b=Gf.SelectionFactory.GK(t.node,Math.min(t.cpBegin,D.cpBegin),Math.max(t.cpEnd,D.cpEnd)),af.a.instance.setSelection(b),t=b.Qa;else if(hf.SelectionEditor.gf(t)){var ca;hf.SelectionEditor.$jb(t)&&(ca=hf.SelectionEditor.C3(t,!1));ca||(ca=this.isd.get(P.SourceControlId)[0],rf.characterPropertiesEditor.replaceTextRange(t,ca,!0,void 0,b),ca=Gf.SelectionFactory.GK(t.node,t.cpBegin,t.cpBegin+ca.length));if(ca&&(af.a.instance.setSelection(ca),
t=ca.Qa,rf.Z2b(t)))return rf.Ld.OOb(!1),8}try{rf.hyperlinkEditor.hG(t,this.isd.get(P.SourceControlId)[1],0<re.HyperlinkReader.kPc(t).length);const ta=Gf.SelectionFactory.te(t.node,t.cpEnd);ta&&af.a.instance.setSelection(ta);m(P,"RecentLinks")}finally{k&&k.dispose()}v.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static RFb(b,k,t,D,P){if(rf.eZc)return rf.Dsm(b,k,t,D,P);if(!k.view.qe)return 2;var ca=k.view.mb;if(!ca||!ca.hb||!ca.hb.length)return 8;var ta=ca.hb.kb;let Na=ta.Qa.clone();
if(2===ta.length){if(ta=ta.J(1),!hf.SelectionEditor.ml(Na)||!hf.SelectionEditor.Fk(ta)||Na.node!==ta.node)return 8}else if(2<ta.length)return 8;if(ca.hb.nJ)return 8;if(rf.Wg.pza(pe.ParagraphReader.mU,ca.sg))return rf.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.dO}),8;pe.ParagraphReader.lm(Na)&&!hf.SelectionEditor.w8(Na)&&(ca=Na.node,Na=Of.a.createTextRange(ca,0,pe.ParagraphReader.textLength(ca)));return b===Pb.a.YFd?rf.gJh(k,Na,t,D):w.AFrameworkApplication.va.Nf(Na,b,t,!0,D,P)}static Dsm(b,k,t,D,P){if(!k.view.qe)return 2;
var ca=k.view.mb;if(!ca||!ca.hb||!ca.hb.length||ca.hb.nJ)return 8;var ta=ca.hb.kb;if(ca=rf.YFf(ta))ta=rf.Euf(ta.Qa.clone(),!0);else{let Na=ta.J(0).clone(),qb=1;for(;qb<ta.length&&(!pe.ParagraphReader.textLength(Na.node)||hf.SelectionEditor.Fk(Na)||rf.yta&&Oi.l(Na));)Na=ta.J(qb).clone(),qb++;ta=rf.Euf(Na,!1)}return rf.yta&&hf.SelectionEditor.ml(ta)&&Oi.l(ta)||!hf.SelectionEditor.ml(ta)&&!ca?8:b===Pb.a.YFd?rf.gJh(k,ta,t,D):w.AFrameworkApplication.va.Nf(ta,b,t,!0,D,P)}static YFf(b){if(1===b.length)return!0;
if(2===b.length){const k=b.Qa.clone();b=b.J(1);return hf.SelectionEditor.ml(k)&&hf.SelectionEditor.Fk(b)&&k.node===b.node?!0:!1}return!1}static CGh(b){let k=null;const t=[];for(let D=0;D<b.length;D++){const P=rf.Euf(b.J(D).clone(),!1);if(hf.SelectionEditor.ml(P))rf.yta&&Oi.l(P)||t.push(P);else if(!hf.SelectionEditor.Fk(P)&&!pe.ParagraphReader.lm(P))return{returnValue:!1,Ueb:k}}k=t;return{returnValue:!rf.yta||0<k.length?!0:!1,Ueb:k}}static insertLink(b,k,t,D,P){if(rf.eZc)return rf.dAm(k,t,P);D=rf.qIj(k);
if(32!==D)return D;let ca;if(!({hyperlink:ca}=rf.xQa(k,!0)).returnValue||rf.Z2b(k)||!ca&&b==Pb.a.a5b)return 8;if(1===t)return 32;if(!ca&&hf.SelectionEditor.gf(k)&&hf.SelectionEditor.$jb(k)&&(b=hf.SelectionEditor.C3(k,!1))&&(af.a.instance.setSelection(b),k=b.Qa,rf.Z2b(k)))return rf.Ld.OOb(!1),8;ca&&v.ULS.sendTraceTag(593875799,324,50,"Edit link");a(k,P);return 32}static qIj(b){return!rf.r5e()||!rf.tCd(b)||b.node.vr||af.a.instance.hb.nJ?8:hf.SelectionEditor.d4(b)||Pk.a.hDf(b)?2:32}static dAm(b,k,t){var D=
af.a.instance.hb.kb;const P=rf.YFf(D);if(P)b=[b];else if(!({Ueb:b}=rf.CGh(D)).returnValue)return 8;if(!rf.r5e())return 8;for(D=0;D<b.length;D++)if(!rf.tCd(b[D]))return 8;if(af.a.instance.hb.nJ)return 8;D=Array(b.length);let ca=null;for(let ta=0;ta<b.length;ta++)if(D[ta]=b[ta],!({hyperlink:ca}=rf.xQa(D[ta],!0)).returnValue||rf.Z2b(D[ta]))return 8;if(1===k)return 32;if(!ca&&1===D.length&&P&&hf.SelectionEditor.gf(D[0])&&hf.SelectionEditor.$jb(D[0])&&(k=hf.SelectionEditor.C3(D[0],!1))&&(af.a.instance.setSelection(k),
D[0]=k.Qa,rf.Z2b(D[0])))return rf.Ld.OOb(!1),8;P?a(D[0],t):new To(D,t);return 32}static T9i(b,k,t){if(rf.eZc)return rf.pYn(b,k,t);if(!rf.tCd(k)||hf.SelectionEditor.d4(k))return 2;let D;if(!({hyperlink:D}=rf.xQa(k,!1)).returnValue)return 2;if(2===t){t=new Xd.GraphTransaction(15);try{t.fk=b,t.Cb(D.paragraph),rf.r5f(k)}finally{t&&t.dispose()}D.hyperlink.BG&&rf.Ld.Js(2)}return 32}static pYn(b,k,t){var D=af.a.instance.hb.kb;if(rf.YFf(D))k=[k];else if(!({Ueb:k}=rf.CGh(D)).returnValue)return 8;if(!rf.r5e())return 8;
for(D=0;D<k.length;D++)if(!rf.tCd(k[D]))return 8;if(1===t&&!rf.xQa(k[0],!1).returnValue)return 2;if(2===t){for(t=0;t<k.length;t++)if(!rf.xQa(k[t],!0).returnValue)return 2;t=new Xd.GraphTransaction(15);try{const P=k[0];t.fk=b;t.Cb(P.node);for(b=0;b<k.length;b++)rf.r5f(k[b])}finally{t&&t.dispose()}rf.Ld.Js(7)}return 32}static r5f(b){const k=re.HyperlinkReader.kPc(b);let t=0;for(let D=0;D<k.length;D++)if(k[D].cpBegin>=t){const P=({cpEnd:t}=rf.L_.Dga(b,k[D])).returnValue;rf.L_.J9i(b,P)}}static ahj(b,
k,t){if(Be.ImageReader.v2a(k)||!({hyperlink:b}=rf.xQa(k,!1)).returnValue)return 2;if(2===t){const {cpBegin:D,cpEnd:P}=rf.L_.Dga(k,b);af.a.instance.setSelection(Gf.SelectionFactory.GK(b.paragraph,D,P))}return 32}static dYi(b,k,t){if(({hyperlink:b}=rf.VSm(k)).returnValue)v.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:b}=rf.xQa(k,!1)).returnValue)return 2;2===t&&Wa.App.Igb(b.hyperlink.url);return 32}static GWf(b,k,t){b=Be.ImageReader.Dga(k.node);
if(!b)return 2;2===t&&Wa.App.Igb(b);return 32}static gJh(b,k,t,D){if(Be.ImageReader.v2a(k)||!Lb.InteractiveViewManager.instance.editingView.Sj)return 2;let P;if(!({hyperlink:P}=rf.xQa(k,!1)).returnValue)return 2;if(1===t)return 32;const {cpBegin:ca,cpEnd:ta}=rf.L_.Dga(k,P);af.a.instance.setSelection(Gf.SelectionFactory.GK(P.paragraph,ca,ta));k=Lb.InteractiveViewManager.instance.PCa.ownerDocument.createElement("span");k.innerText=P.hyperlink.url;k.style.backgroundColor="rgb(255, 255, 255)";return w.AFrameworkApplication.va.Nf(b,
Pb.a.XFd,2,!0,D,k)}static xQa(b,k){if(hf.SelectionEditor.ml(b)){const t=Oi.g(b),D=Qm.a.all(t,P=>6===P.Dh);if(0<t.length&&(!rf.yta||!D)||rf.Vf.kh&&rf.aX&&0<rf.aX.nOd(b).count)return{returnValue:!1,hyperlink:null}}return rf.KSm(b,k)}static VSm(b){let k=null;return Be.ImageReader.v2a(b)&&(k=re.HyperlinkReader.A7b(b))?{returnValue:!0,hyperlink:k}:{returnValue:!1,hyperlink:k}}static KSm(b,k){let t=null;const D=re.HyperlinkReader.kPc(b);return D.length?D[0].hyperlink?(t=D[0],b.cpBegin<D[0].cpBegin?{returnValue:k,
hyperlink:t}:{returnValue:!0,hyperlink:t}):{returnValue:!1,hyperlink:t}:{returnValue:k,hyperlink:t}}static Z2b(b){if(sq.a.instance.J(1)){b=rf.Ch.ePa(b.node,b.cpBegin,b.cpEnd);for(let k=0;k<b.count;++k)if(2===b.J(k).Jd.changeType)return!0}return!1}static r5e(){return sq.a.instance.J(1)?!0:!sq.a.instance.J(1)||!Wa.App.Zv.bQb}static tCd(b){return rf.Vf.i_(b)||rf.Vf.iha(b)||rf.Vw()&&rf.Vw().instance&&rf.Vw().instance.qU(b)?!1:!0}static Euf(b,k){return pe.ParagraphReader.lm(b)&&!hf.SelectionEditor.w8(b)&&
(pe.ParagraphReader.textLength(b.node)||k)?Of.a.createTextRange(b.node,0,pe.ParagraphReader.textLength(b.node)):b}static J8l(b){return b&&b.length<=rf.k6i?b:b.substring(0,rf.k6i)+"..."}static nWl(b){try{const k=new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,k.toLocaleString(void 0,{weekday:"long"}),k.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(k){return""}}static Ene(b=!1){const k=Date.now();if(b||k-rf.RDi>rf.pHo)Gk.instance.Q7m(),rf.RDi=k}static lce(b,
k,t){const D=new Map;D.set("Source",t);D.set("Action",k);xa.Health.instance.recordKpiUsage(b,0,this.SVa,D)}}rf.Sm=null;rf.Rqb=null;rf.b$=null;rf.isd=new Map;rf.EFe=null;rf.k6i=35;rf.RDi=Date.now();rf.u_h=!1;rf.SVa="wwaengidc";rf.yfk="RecentLinks";rf.Hbh="RecentLinksRibbonOptions";rf.Gbh="RecentLinksContextMenuOptions";rf.lek="PopulateRecentLinksRibbon";rf.mek="PopulateRecentLinksRibbonAction";rf.jek="PopulateRecentLinksContextMenu";rf.kek="PopulateRecentLinksContextMenuAction";rf.Mak="PopulateRecentLinksContextMenu";
rf.Nak="PopulateRecentLinksContextMenuAction";rf.e6j="InsertRecentLinks";rf.f6j="InsertRecentLinksAction";Object(n.a)(rf,"HyperlinkActor",null,[]);class $x{}$x.qkb=Object.freeze({Rum:"WordIndentationShortcutUsage"});$x.qB="wwaengidc";Object(n.a)($x,"IndentationConstants",null,[]);class um{static get fq(){return ks.a.BEb}static get Wg(){return li.ContextSetEditor.instance}static get Vf(){return Yj.a.instance}static get Ic(){return Hi.a.instance}static get yo(){return Lb.InteractiveViewManager.instance}static Vw(){return um.Sm||
(um.Sm=Fa.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Qum(){return null!=um.NAg?um.NAg:um.NAg=Fa.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static Tb(){const b=w.AFrameworkApplication.va;b.qa(Pb.a.IG,lc.a.view,um.iEc);b.qa(Pb.a.IG,lc.a.outlineElement,um.Mth);b.Vc(Pb.a.IG,1036);b.qa(Pb.a.mO,lc.a.view,um.iEc);b.qa(Pb.a.mO,lc.a.outlineElement,um.Mth);b.Vc(Pb.a.mO,1036)}static OPn(b){const k=new Map;b=b?b.ia(ke.a.rpi,"Unknown"):"tab";k.set("actionCallSource",b);xa.Health.instance.recordKpiUsage($x.qkb.Rum,
1,$x.qB,k)}static iEc(b,k,t,D,P){const ca=k.view;if(!ca.qe)return 2;var ta=ca.mb;if(!ta)return um.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.oca}),8;ta=ta.sg;if(!ta)return um.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.noSelection}),8;if(Pk.a.fha(k))return 8;if(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&um.Vf.S$b(ta))return um.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.VE}),8;if(1===t)return 32;if(um.Wg.aDa(um.p0e,ta))return um.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.bHc}),8;if(um.Wg.pza(pe.ParagraphReader.mU,
ta))return um.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.dO}),8;if(!w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&um.Vf.S$b(ta))return um.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.VE}),8;if(um.Vw()&&um.Vw().instance&&um.Vw().instance.qU(ta))return um.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.externalSelection}),8;ta={};ta[Er.a.SIa]=5794;ta[Er.a.RIa]=5795;return um.Qum.iEc(ca,b,k,t,D,P,ta)}static Mth(b,k,t,D,P){var ca,ta;if(k.contextId!==lc.a.outlineElement)return 2;var Na=k.clone().rfg();
if(Ih.TableReader.yBi(Na)){if(um.Vf.zBi(Na))return um.Ic.Yb(Pe.a.en,{["Reason"]:He.a.VE}),8}else if(um.Vf.e3a(Na))return um.Ic.Yb(Pe.a.en,{["Reason"]:He.a.VE}),2;Na=new ze.GraphIterator;Na.set(k.node);hf.SelectionEditor.ku(Na);if(!va.OutlineElementReader.Bh(Na))return 2;let qb;switch(b){case Pb.a.IG:qb=um.fq.bAb(Na);break;case Pb.a.mO:qb=um.fq.S1b(Na);break;default:return 2}if(1===t||!qb)return qb?32:8;t=0;b===Pb.a.mO&&P&&P.ia(vd.a.Dvh,!1)&&(t|=2);if(va.OutlineElementReader.rQ(Na))return um.Ic.Yb(Pe.a.en,
{["Reason"]:He.a.dO}),2;(null===(ta=null===(ca=um.yo)||void 0===ca?void 0:ca.Bd)||void 0===ta?0:ta.rU)&&um.yo.editingView&&(um.yo.editingView.ZH=!0);switch(b){case Pb.a.IG:um.fq.VRa(Na,-1,t);break;case Pb.a.mO:um.fq.ZIc(Na,1)}D&&Aq.a.zpb&&(D.ks|=Aq.a.jhb(k.node,!0));um.OPn(P);return 32}}um.Sm=null;um.p0e=Be.ImageReader.u2a;Object(n.a)(um,"IndentationActor",null,[]);var gn=c(1561);class Fk{static get paragraphEditor(){return null!=Fk.UEg?Fk.UEg:Fk.UEg=Fa.a.instance.resolve("Box4.IParagraphEditor")}static get wk(){return null!=
Fk.gHg?Fk.gHg:Fk.gHg=Fa.a.instance.resolve("Box4.ITableEditor")}static get Vf(){return Yj.a.instance}static get Ic(){return Hi.a.instance}static Vw(){return Fk.Sm||(Fk.Sm=Fa.a.instance.Sa("Box4.IExternalSelectionManager"))}static Tb(){const b=w.AFrameworkApplication.va;b.qa(Pb.a.vxj,lc.a.view,(k,t)=>Pk.a.fha(t)?8:32);b.qa(Pb.a.leftJustify,lc.a.view,gn.a.Wv);b.qa(Pb.a.leftJustify,lc.a.paragraph,Fk.lCa);b.qa(Pb.a.leftJustify,lc.a.table,Fk.t1e);b.Vc(Pb.a.leftJustify,1036);b.qa(Pb.a.centerJustify,lc.a.view,
gn.a.Wv);b.qa(Pb.a.centerJustify,lc.a.paragraph,Fk.lCa);b.qa(Pb.a.centerJustify,lc.a.table,Fk.t1e);b.Vc(Pb.a.centerJustify,1036);b.qa(Pb.a.rightJustify,lc.a.view,gn.a.Wv);b.qa(Pb.a.rightJustify,lc.a.paragraph,Fk.lCa);b.qa(Pb.a.rightJustify,lc.a.table,Fk.t1e);b.Vc(Pb.a.rightJustify,1036);b.qa(Pb.a.fullJustify,lc.a.view,gn.a.Wv);b.qa(Pb.a.fullJustify,lc.a.paragraph,Fk.lCa);b.Vc(Pb.a.fullJustify,1036);b.qa(Pb.a.BJc,lc.a.view,gn.a.Wv);b.qa(Pb.a.BJc,lc.a.paragraph,Fk.lCa);b.Vc(Pb.a.BJc,1036);b.qa(Pb.a.gIb,
lc.a.view,gn.a.Wv);b.qa(Pb.a.gIb,lc.a.paragraph,Fk.lCa);b.Vc(Pb.a.gIb,1036);b.qa(Pb.a.k7c,lc.a.view,gn.a.Wv);b.qa(Pb.a.k7c,lc.a.paragraph,Fk.lCa);b.Vc(Pb.a.k7c,1036);b.qa(Pb.a.Ccc,lc.a.view,gn.a.Wv);b.qa(Pb.a.Ccc,lc.a.paragraph,Fk.lCa);b.Vc(Pb.a.Ccc,1036);b.qa(Pb.a.i2b,lc.a.view,gn.a.Wv);b.qa(Pb.a.i2b,lc.a.paragraph,Fk.lCa);b.Vc(Pb.a.i2b,1036);b.qa(Pb.a.Bhc,lc.a.view,gn.a.Wv);b.qa(Pb.a.Bhc,lc.a.paragraph,Fk.lCa);b.Vc(Pb.a.Bhc,1036);b.qa(Pb.a.E6b,lc.a.view,gn.a.Wv);b.qa(Pb.a.E6b,lc.a.paragraph,Fk.lCa);
b.Vc(Pb.a.E6b,1036)}static t1e(b,k,t,D){let P=!0;if(!k)return 8;Ih.TableReader.yBi(k)?Fk.Vf.zBi(k)?(Fk.Ic.Yb(Pe.a.en,{["Reason"]:He.a.VE}),P=!1):Fk.Vw()&&Fk.Vw().instance&&Fk.Vw().instance.qU(k)&&(Fk.Ic.Yb(Pe.a.en,{["Reason"]:He.a.externalSelection}),P=!1):(Fk.Ic.Yb(Pe.a.en,{["Reason"]:He.a.Jff}),P=!1);if(1===t||!P)return P?32:8;k=k.node;switch(b){case Pb.a.leftJustify:Fk.wk.gE(k,1);break;case Pb.a.centerJustify:Fk.wk.gE(k,2);break;case Pb.a.rightJustify:Fk.wk.gE(k,3)}D&&Aq.a.zpb&&(D.ks|=2);return 32}static lCa(b,
k,t,D,P){let ca=!0;k.contextId!==lc.a.paragraph?ca=!1:Fk.Vf.e3a(k)?(Fk.Ic.Yb(Pe.a.en,{["Reason"]:He.a.VE}),ca=!1):Fk.Vw()&&Fk.Vw().instance&&Fk.Vw().instance.qU(k)&&(Fk.Ic.Yb(Pe.a.en,{["Reason"]:He.a.externalSelection}),ca=!1);if(1===t||!ca)return ca?32:8;k=k.node;t=pe.ParagraphReader.Cx(k);switch(b){case Pb.a.leftJustify:case Pb.a.Ccc:Fk.paragraphEditor.gE(k,1===t&&Fk.C_d(P)?6:1);break;case Pb.a.centerJustify:case Pb.a.i2b:Fk.paragraphEditor.gE(k,2===t&&Fk.C_d(P)?1:2);break;case Pb.a.rightJustify:case Pb.a.Bhc:Fk.paragraphEditor.gE(k,
3===t&&Fk.C_d(P)?1:3);break;case Pb.a.fullJustify:case Pb.a.E6b:Fk.paragraphEditor.gE(k,6===t&&Fk.C_d(P)?1:6);break;case Pb.a.gIb:Fk.paragraphEditor.gE(k,11);break;case Pb.a.BJc:Fk.paragraphEditor.gE(k,7);break;case Pb.a.k7c:Fk.paragraphEditor.gE(k,13)}D&&Aq.a.zpb&&(D.ks|=Aq.a.jhb(k));return 32}static C_d(b){let k=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(k=b.InContextSet);return!k}}Fk.Sm=null;Object(n.a)(Fk,"JustificationActor",null,[]);const ay=()=>{const b=w.AFrameworkApplication.va;
b.qa(Pb.a.save,Ud.a.frame,sA);b.qa(Pb.a.sync,Ud.a.frame,Eu)},Eu=(b,k,t)=>{if(1===t)return 32;w.AFrameworkApplication.va.processAction(Pb.a.dAb,2);Wa.App.Lj.ske();return 32},sA=(b,k,t)=>{if(1===t)return 2===Wa.App.ya.mode?32:8;w.AFrameworkApplication.va.processAction(Pb.a.dAb,2);if(2!==Wa.App.ya.mode)return 32;Wa.App.Lj.yfj(null,null);return 32};class Dv{constructor(){this.activateRibbonTab=(b,k,t,D,P)=>{Wa.App.Zv.KI.jee(P.toString());return 32};this.BWm=(b,k,t,D,P)=>{w.AFrameworkApplication.Roa("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");
Wa.App.Zv.KI.iDi(1,P.toString());return 32};this.etn=(b,k)=>{if(k.contextId!==Ud.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Tb(){const b=w.AFrameworkApplication.va;b.qa(Pb.a.activateRibbonTab,lc.a.view,this.activateRibbonTab);b.Vc(Pb.a.activateRibbonTab,5);b.qa(Pb.a.jDi,lc.a.view,this.BWm);b.qa(Pb.a.yjg,Ud.a.frame,this.etn)}static get instance(){return null!=Dv.oBg?Dv.oBg:Dv.oBg=Dv.Rl()}static Rl(){return new Dv}}Object(n.a)(Dv,"RibbonActor",null,[]);var qr=c(560);class rr{constructor(b,
k){this.Jm=null;this.yOo=(t,D,P,ca,ta)=>{let Na;ca=D.view;if(!ca.qe)return rr.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.MJb}),8;Na=t===Pb.a.undo?this.Ug.GX:this.Ug.rPa;if(1===P)return Pk.a.fha(D)&&Pk.a.hac()?8:Na?32:8;if(!Na)return v.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",t===Pb.a.undo?"undo":"redo"),this.zJa.value.DCj(),rr.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.tOo}),2;D=new Xd.GraphTransaction(3);D.Cb(ca.ed);D.Ife();t=t===Pb.a.undo?this.Ug.undo():this.Ug.redo();D.dispose();ta&&
iz.GrippersManager.instance.GQb(ta.Gx);if(t)return 32;rr.Ic.Yb(Pe.a.K4b,{["Reason"]:He.a.WPi});return 8};this.yla=b;this.zJa=k}get Ug(){return this.Jm||(this.Jm=this.yla())}Tb(){const b=w.AFrameworkApplication.va,k=this.yOo;b.fb(Pb.a.undo,lc.a.view,k,1028);b.fb(Pb.a.redo,lc.a.view,k,1028)}static get instance(){return null!=rr.ZAg?rr.ZAg:rr.ZAg=rr.Rl()}static Rl(){const b=Fa.a.instance;return new rr(()=>b.resolve("Box4.IUndoManager"),b.Ue("Box4.ICoauthCashTelemetry"))}static get Ic(){return Hi.a.instance}}
Object(n.a)(rr,"UndoActor",null,[]);class Fs{constructor(){this.W=null}get name(){return"Box4.Actors"}xc(b){this.W=b;(new zB).xc(b)}init(){var b=this.W.resolve("Box4.Actors.ClipboardActor");lx.a.BZd&&this.W.resolve("Box4.Actors.PageColorActor").Tb();b.Tb();b.R4();ZC();yt.instance.Tb();rf.Tb();um.Tb();Fk.Tb();this.W.resolve("Box4.Actors.TouchInputActor").Tb();vw.instance.Tb();this.W.resolve("Box4.ISelectAllHandlers").Tb();ay();this.W.resolve("Box4.Actors.ProofingActor").Tb();Dv.instance.Tb();(b=this.W.Na("Box4.IFeatureHelper"))?
b.Mp.continueWith(()=>{this.r8i()}):this.r8i();qr.a.Tb(Wa.App.NTa);this.W.resolve("Box4.Actors.TextFormattingActor").Tb();rr.instance.Tb();this.W.resolve("Box4.Actors.AccessibilityActor").V3f();this.W.resolve("Box4.IClipboardCommands");this.W.resolve("Box4.Actors.PasteFloatieEventManager");Wa.App.ya.updateCommandUI()}r8i(){this.W.resolve("Box4.Actors.StyleContextMenuActor").Tb();this.W.resolve("Box4.Actors.StyleActor").Tb()}dispose(){}static main(){N.a.instance.Fc(new Fs)}}Object(n.a)(Fs,"Box4ActorsPackage",
null,[1,2]);class tA extends av{constructor(b,k,t,D){super(b);this.Uma=t;this.U5a=D;this.upg=0;this.NA=k.YQa("UserAction","WordOnlineAddToDictionary")}kcg(b){this.CKd=this.Uma.ona(b);if(!this.bUk())return!1;const k=this.CKd.errorDetails.token;this.U5a.iph(k);if(!this.U5a.T9c(k))return v.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;v.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");this.NA.start();
this.transaction=new Xd.GraphTransaction(15);this.transaction.Cb(b.node);return!0}Z$d(b){this.DLb(b.node);return!0}N1c(b){this.DLb(b);return!0}$$d(b){this.DLb(b.node)}eig(b){this.transaction.dispose();this.CKd.errorDetails.Opb(b.actionId);this.U5a.a9f("unused corelation id.");this.NA.stop();v.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.upg,this.NA.si,this.CKd.errorDetails.proofingType));return!0}Vjc(b,
k){const t=b.role;return super.Vjc(b,k)||9===t||10===t||13===t||7===t||8===t}DLb(b){if(b){var k=this.Uma.N3(b,t=>this.U5a.T9c(t.errorDetails.token));this.Uma.tnb(b,k,!0);this.upg+=k.length}}bUk(){var b,k;return null!==(k=null===(b=this.CKd)||void 0===b?void 0:b.errorDetails)&&void 0!==k&&k.token?!0:(v.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(n.a)(tA,"AddToDictionaryCallbackSteps",av,[]);class sz{constructor(b,k,t,D,P,
ca,ta){this.pc=b;this.mb=k;this.A9=t;this.Uma=D;this.Dq=P;this.U5a=ca;this.VHn=ta;this.Yjm=(Na,qb,Jb,Vb,ac,yc)=>{const Kc=new tA(this.A9,this.Dq,this.Uma,this.U5a);return new sw(Na,qb,Jb,Vb,ac,yc,Kc,this.pc,this.mb,this.A9,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Tb(){this.pc.cT(Pb.a.addToDictionary,lc.a.view,this.Yjm,1124);this.VHn.zVn(this.U5a)}}Object(n.a)(sz,"PersonalDictionaryOrchestrator",null,[]);class tz{get name(){return"Box4.PersonalDictionary"}xc(b){this.container=b;b.register(sz,
"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").singleInstance().Rd(()=>new sz(w.AFrameworkApplication.va,af.a.instance,Xr.a.instance,b.resolve("Box4.Proofing.IErrorRangeEditor"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").Tb()}dispose(){}static main(){Tj.a.get_instance().Dk(7,()=>{N.a.instance.Fc(new tz)})}}
Object(n.a)(tz,"PersonalDictionaryPackage",null,[1,2]);class sr{constructor(b,k,t,D,P,ca){this.LAa=this.t9a=this.yV=null;this.HFc=(ta,Na,qb,Jb,Vb)=>this.PAi(Na,qb,Vb,!1)?32:8;this.vH=(ta,Na,qb,Jb,Vb)=>{if(!({fy:ta}=this.Noj(Na,qb,Vb,!0)).returnValue)return ta;v.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");Vb=this.mlk.RCa(Na.node,Vb);this.lAn(Na.node,Vb);this.BP();return 32};this.rAb=(ta,Na,qb,Jb,Vb)=>{if(!({fy:ta}=this.Noj(Na,qb,Vb,!1)).returnValue)return ta;
this.hAn(Na.node);return 32};this.bJn=(ta,Na,qb,Jb,Vb)=>{if(1===qb)return 32;if(!Na||!Na.view.qe)return 2;ta=Na.view.mb;if(!ta)return 2;ta=ta.sg;if(!ta)return 2;ta=sr.Wg.IQ(ta,16);if(!ta||!ta.length)return 2;Na=null;for(qb=0;qb<ta.length;qb++){Jb=ta.getContext(qb);if(!Jb||Jb.contextId!==lc.a.tableCell)return 2;const ac={};this.eli(Jb,ac);if(ac.CellShading)if(Na&&Na!==ac.CellShading){Na=null;break}else Na=ac.CellShading;else{Na=null;break}}Vb.CellShading=Na;return 32};this.OLb=(ta,Na,qb,Jb,Vb)=>1===
qb?32:this.eli(Na,Vb);this.jLb=(ta,Na,qb,Jb,Vb)=>{if(1===qb)return 32;ta=Na.contextId===lc.a.view?this.dBa.NQd(Na):this.ssf(Na);qb={};Na=null;32===w.AFrameworkApplication.va.Qb(Pb.a.OLb,2,qb)&&qb&&(Na=qb.CellShading);qb="";Na&&(qb=ch.a.XE(Na)||"");this.Knj.DNb=qb;this.nVc&&this.recentColors.Omg(qb);ta=this.Knj.yMc(ta,Wa.App.xAb);if(!ta)return 8;Vb.MenuItems=ta;v.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.Xha=(ta,Na,qb,Jb,Vb)=>{if(1===qb)return 32;Wa.App.ya.Tw();
w.AFrameworkApplication.va.Qb(Pb.a.OLb,2,Vb);this.t9a=new nA.a("Shading",Pb.a.zic);this.t9a.vjc(Vb&&Vb.CellShading?Vb.CellShading:0);return 32};this.XSk=(ta,Na,qb,Jb,Vb)=>{if(1===qb)return 32;w.AFrameworkApplication.va.Qb(Pb.a.D9,2,Vb);this.recentColors.odb(Vb)||v.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.mlk=k;this.FJe=t;this.dBa=D;this.Ud=P;this.qq=ca}get recentColors(){return null!=this.CFg?this.CFg:this.CFg=Fa.a.instance.Na("Box4.UI.RecentColorsSectionHandler")}get Knj(){this.yV||
(this.yV=new oA.a("Shading"),this.VEa(this.yV));return this.yV}VEa(b){b.GW(2,Pb.a.rAb);b.GW(3,Pb.a.D9);b.GW(4,Pb.a.D9);b.Vyb(this.FJe,1)}Tb(){this.ga.qa(Pb.a.jLb,lc.a.view,this.jLb);this.ga.qa(Pb.a.jLb,lc.a.tableCell,this.jLb);this.ga.Vc(Pb.a.jLb,1126);this.ga.qa(Pb.a.HFc,lc.a.view,qr.a.DMc);this.ga.qa(Pb.a.HFc,lc.a.tableCell,this.HFc);this.ga.Vc(Pb.a.HFc,1028);this.ga.qa(Pb.a.D9,lc.a.view,qr.a.DMc);this.ga.qa(Pb.a.D9,lc.a.tableCell,this.vH);this.ga.Vc(Pb.a.D9,1028);this.ga.qa(Pb.a.rAb,lc.a.view,
qr.a.DMc);this.ga.qa(Pb.a.rAb,lc.a.tableCell,this.rAb);this.ga.Vc(Pb.a.rAb,1028);this.ga.qa(Pb.a.OLb,lc.a.view,this.bJn);this.ga.qa(Pb.a.OLb,lc.a.tableCell,this.OLb);this.ga.Vc(Pb.a.OLb,1124);this.ga.qa(Pb.a.zic,lc.a.view,qr.a.DMc);this.ga.qa(Pb.a.zic,lc.a.tableCell,this.XSk);this.ga.Vc(Pb.a.zic,1028);this.ga.qa(Pb.a.JWf,lc.a.view,this.Xha);this.ga.Vc(Pb.a.JWf,1028)}BP(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=
Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(k=>{k.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}Noj(b,k,t,D){return this.PAi(b,k,t,D)?{returnValue:2===k,fy:32}:(2==k&&qr.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],He.a.kyl),{returnValue:!1,fy:8})}PAi(b,k,t,D){return b.contextId!==lc.a.tableCell||2===k&&(D&&!t||!b.node)?!1:!0}lAn(b,k){const t=new Xd.GraphTransaction(15);t.Cb(b);this.smj(b);b.properties.setValue(sf.a.vH,
k);t.dispose()}hAn(b){const k=new Xd.GraphTransaction(15);k.Cb(b);this.smj(b);b.properties.removeProperty(sf.a.vH);k.dispose()}ssf(b){return b.contextId!==lc.a.tableCell?null:(b=sr.fh.Ts(b.node))?b:null}smj(b){if(this.Ud&&this.Ud.qg&&(b=Object(Ka.a)(Px.TableCellNode,b))){const k=b.AR();this.qq.i7c(b,k)}}eli(b,k){if(b.contextId!==lc.a.tableCell)return 8;(b=b.node)&&b.hasProperty(sf.a.vH)&&(k.CellShading=b.getValue(sf.a.vH));return 32}static MNl(){return new sr(w.AFrameworkApplication.va,Xk.a.instance,
cv.a.instance,Yg.PageReader.instance,Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get fh(){return Wk.PageNavigator.instance}static get Wg(){return null!=sr.jxg?sr.jxg:sr.jxg=li.ContextSetEditor.instance}static get instance(){return null!=sr.tCg?sr.tCg:sr.tCg=sr.MNl()}get nVc(){null==this.LAa&&(w.AFrameworkApplication.ue("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.LAa=
w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.LAa}}Object(n.a)(sr,"CellShadingActor",null,[]);class Ev{constructor(){this.W=null}get name(){return"Box4.CellShading"}xc(b){this.W=b}init(){const b=this.W.Na("Box4.IFeatureHelper");b?b.Mp.continueWith(()=>{this.fn()}):this.fn()}fn(){sr.instance.Tb();Wa.App.ya.updateCommandUI()}dispose(){}}Object(n.a)(Ev,"CellShadingPackage",null,[1,2]);var wo;
(function(b){b[b.none=0]="none";b[b.style1=1]="style1";b[b.style2=2]="style2";b[b.style3=3]="style3";b[b.style4=4]="style4";b[b.style5=5]="style5";b[b.bullet=6]="bullet";b[b.invalid=42]="invalid"})(wo||(wo={}));Object(n.b)("ListStyle",wo);const uz={[wo.style1]:{[1]:"disc",[0]:"decimal"},[wo.style2]:{[1]:"circle",[0]:"lower-alpha"},[wo.style3]:{[1]:"square",[0]:"lower-roman"},[wo.style4]:{[0]:"upper-alpha"},[wo.style5]:{[0]:"upper-roman"},[wo.bullet]:{[1]:"bullet"}};var xw;(function(b){b[b.number=
0]="number";b[b.bullet=1]="bullet";b[b.lim=13]="lim";b[b.nil=14]="nil";b[b.any=15]="any";b[b.noList=16]="noList";b[b.invalid=42]="invalid"})(xw||(xw={}));Object(n.b)("ListType",xw);var Gs=c(1601);class ap{constructor(b,k){this.JB=this.hXc=null;this.levelText=b;this.font=k}get P$d(){return this.levelText}get listStyle(){return 6}get lw(){return"left"}}Object(n.a)(ap,"ListMarkerBullet",null,[299]);class Oh{static get Un(){return null!=Oh.oDg?Oh.oDg:Oh.oDg=Fa.a.instance.resolve("Box4.List.IListEditor")}static get Gd(){return Oh.Gf||
(Oh.Gf=Fa.a.instance.resolve("Box4.List.IListReader"))}static set Gd(b){Oh.Gf=b}static get pj(){return null!=Oh.SAg?Oh.SAg:Oh.SAg=Fa.a.instance.resolve("Box4.IInsertionPointFormatting")}static Vw(){return Oh.Sm||(Oh.Sm=Fa.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Wg(){return li.ContextSetEditor.instance}static get Vf(){return Yj.a.instance}static get Ic(){return Hi.a.instance}static get Vn(){return wl.a.getInstance()}static get x8c(){return null!=Oh.jGg?Oh.jGg:Oh.jGg=Fa.a.instance.Na("Box4.List.ISingleLevelListEditor")}static Tb(){const b=
w.AFrameworkApplication.va;b.qa(Pb.a.iD,lc.a.view,Oh.eEc);b.qa(Pb.a.iD,lc.a.outlineElement,Oh.Ola);b.Vc(Pb.a.iD,1036);b.qa(Pb.a.rL,lc.a.view,Oh.eEc);b.qa(Pb.a.rL,lc.a.outlineElement,Oh.Ola);b.Vc(Pb.a.rL,1036);b.qa(Pb.a.nca,lc.a.view,Oh.eEc);b.qa(Pb.a.nca,lc.a.outlineElement,Oh.Ola);b.Vc(Pb.a.nca,1036);b.qa(Pb.a.g1e,lc.a.view,Xc.ActionManager.Of);b.qa(Pb.a.PDh,lc.a.view,Xc.ActionManager.Of);b.qa(Pb.a.joinList,lc.a.view,Oh.r3n);b.qa(Pb.a.Q0e,lc.a.view,Xc.ActionManager.Of);b.qa(Pb.a.h1e,lc.a.view,Xc.ActionManager.Of);
b.qa(Pb.a.hhg,lc.a.view,Xc.ActionManager.Of);b.qa(Pb.a.ewj,lc.a.view,Xc.ActionManager.Of);b.qa(Pb.a.Ime,lc.a.view,Xc.ActionManager.Of)}static r3n(){Gs.a.Hcj();return 32}static eEc(b,k,t,D,P){var ca,ta,Na;if(!k.view.qe)return 2;const qb=Oh.Ic.zp(Pb.a.eEc);D.ks=42;D.vC=42;const Jb={[Er.a.SIa]:5796,[Er.a.RIa]:5797};var Vb=k.view;if(Oh.Wg.aDa(Oh.ntm,Vb.mb.sg))return Oh.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.n9e}),qb.end(),8;if(Oh.Wg.aDa(Oh.p0e,Vb.mb.sg))return Oh.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.bHc}),qb.end(),
8;if(Oh.Wg.pza(pe.ParagraphReader.mU,Vb.mb.sg))return Oh.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.dO}),qb.end(),8;if(Oh.Vf.S$b(Vb.mb.sg))return Oh.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.VE}),qb.end(),8;if(null===(ta=null===(ca=Oh.Vw())||void 0===ca?void 0:ca.instance)||void 0===ta?0:ta.qU(k))return Oh.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.externalSelection}),qb.end(),8;if(1===t)return qb.end(),32;P||(P=new th.DictionaryPropertySet);ca=null;if(2===t){ca=new Xd.GraphTransaction(15);ca.Cb(k.view.ed);Oh.PVc=!1;ta=$t.OutlineElementGeneralizer.gna(Vb.mb.hb,
!1);if(!ta)return ca.dispose(),Oh.Ic.Yb(Pe.a.Xma,{["Reason"]:He.a.kLd}),qb.end(),8;1<ta.length&&P.setValue(vd.a.WOi,null);const ac=P.ia(vd.a.rJ,-1),yc=P.ia(vd.a.yA,-1);null===(Na=Oh.x8c)||void 0===Na?void 0:Na.vVk(ta);if(Na=Oh.Koo(ac,yc,ta))P.setValue(vd.a.yA,16),P.setValue(vd.a.KQa,0);if(!hf.SelectionEditor.gf(Vb.mb.sg)&&!Na&&0<ta.length&&ac){Vb=new ze.GraphIterator;Na=Array(ta.length);for(let Kc=0;Kc<ta.length;Kc++)Vb.set(ta.getContext(Kc).node),Na[Kc]=Oh.Gd.hw(Vb);Oh.Joo(Na,P)&&(Vb=new th.DictionaryPropertySet,
Vb.setValue(vd.a.yA,16),Vb.setValue(vd.a.KQa,0),wl.a.bY&&(Vb.setValue(ke.a.Ooa,"clean-list-before-apply-new-list-style"),Vb.setValue(ke.a.vha,P.ia(ke.a.Ooa,"unknown")+"@"+P.ia(ke.a.vha,"undefined"))),Er.a.tpa(b,k,t,D,Vb,Jb,11),w.AFrameworkApplication.va.processAction(Pb.a.ewj,2),v.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),Oh.PVc=!0)}Vb=new ze.GraphIterator;Vb.set(ta.getContext(0).node);Vb=Oh.Gd.hw(Vb);Oh.v2m(ac,yc,Vb,ta.length)}b=Er.a.tpa(b,k,t,D,P,Jb,11);
32===b&&P.ia(vd.a.Dvh,!1)&&(b=Er.a.tpa(Pb.a.mO,k,t,D,P,Jb,11));ca&&ca.dispose();qb.end();return b}static Joo(b,k){let t=null;var D=!1;for(let P=b.length-1;0<=P&&(t?(D=b[P],D=-1!==k.ia(vd.a.rJ,-3)?D?t.listType!==D.listType||t.listStyle!==D.listStyle:!0:D?t.listType!==D.listType:!0):t=b[P],!D);P--);return t&&(b=!1,D||(b=k.ia(vd.a.yA,42),k=k.ia(vd.a.rJ,-3),b=b!==t.listType||0<k),D||b)?!0:!1}static v2m(b,k,t,D){0>=D||Oh.PVc||(b?t?(t=t.listType,-1===b&&k===t?(w.AFrameworkApplication.va.processAction(Pb.a.Ime,
2),v.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<b&&(!k||1===k)&&(w.AFrameworkApplication.va.processAction(k?Pb.a.Q0e:Pb.a.h1e,2),v.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",k?"Bullet":"Numbering"))):(w.AFrameworkApplication.va.processAction(k?Pb.a.Q0e:Pb.a.h1e,2),Oh.hLo(),v.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",k?"Bullet":"Numbering")):(w.AFrameworkApplication.va.processAction(Pb.a.Ime,2),v.ULS.sendTraceTag(39715533,
393,50,"List Actions: Clean List Style - None list style")))}static Koo(b,k,t){if(-1!==b&&b||!t.length)return!1;b=new ze.GraphIterator;let D=null;for(let P=t.length-1;0<=P&&!(b.set(t.getContext(P).node),D=Oh.Gd.hw(b));P--);return D&&k===D.listType?!0:!1}static Ola(b,k,t,D,P){var ca;if(k.contextId!==lc.a.outlineElement)return 2;var ta=k.clone().rfg();if(Oh.Vf.e3a(ta))return Oh.Ic.Yb(Pe.a.en,{["Reason"]:He.a.VE}),2;const Na=new ze.GraphIterator;Na.set(k.node);hf.SelectionEditor.ku(Na);if(!va.OutlineElementReader.Bh(Na))return 2;
if(1===t)switch(b){case Pb.a.iD:return 32;case Pb.a.rL:return 32;case Pb.a.nca:return 32;default:return 2}if(va.OutlineElementReader.rQ(Na))return Oh.Ic.Yb(Pe.a.en,{["Reason"]:He.a.dO}),2;k=Oh.Gd.hw(Na);var qb;wl.a.bY&&(qb=Object.freeze(null===k||void 0===k?void 0:k.clone()));let Jb=P;if(!Jb)return 8;b===Pb.a.rL||b===Pb.a.iD||b===Pb.a.nca?(Jb=Oh.Un.MKc(b,Jb),ta=Lq.a.uT(Jb.getValue(vd.a.yA),Jb.getValue(vd.a.KQa))):ta=null;Oh.h0(b,Jb);Oh.kio(ta,Jb);let Vb=!1;b===Pb.a.iD&&Jb&&(Jb.hasProperty(Cc.a.au)&&
(ta.levelText=Jb.ia(Cc.a.au,"")),Jb.hasProperty(sf.a.font)&&(ta.font=Jb.ia(sf.a.font,"")),Jb.hasProperty(vd.a.tlf)&&(Vb=Jb.ia(vd.a.tlf,!1)));Oh.Ujo(Jb,Na);ta=Oh.Un.Ola(Jb,Na,ta,Vb);if(!ta.returnValue)return Oh.Ic.Yb(Pe.a.en,{["Reason"]:He.a.wJf}),2;ta=ta.lwa;wl.a.bY&&Oh.UPn(P,qb,ta);2===t&&(t=P.ia(vd.a.yA,-1),ta&&-1!==t&&((qb=P.ia(Cc.a.Sr,"Invalid MultiLevel Type"),b===Pb.a.rL&&v.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===P||void 0===
P?void 0:P.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,["listStyle"]:wo[null==(null===k||void 0===k?void 0:k.listStyle)?null===ta||void 0===ta?void 0:ta.listStyle:null===k||void 0===k?void 0:k.listStyle],["listType"]:xw[null==(null===k||void 0===k?void 0:k.listType)?null===ta||void 0===ta?void 0:ta.listType:null===k||void 0===k?void 0:k.listType],["cleared"]:16===(null===ta||void 0===ta?void 0:ta.listType)})),k)?ta.listType&&1!==ta.listType||Oh.PVc||(w.AFrameworkApplication.va.processAction(Pb.a.hhg,
2),v.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",t?"Bullet":"Numbering",qb)):16===ta.listType?(w.AFrameworkApplication.va.processAction(Pb.a.PDh,2),v.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",t?"Bullet":"Numbering",qb)):ta.listType&&1!==ta.listType||Oh.PVc||(w.AFrameworkApplication.va.processAction(Pb.a.g1e,2),v.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",t?"Bullet":"Numbering",qb))),(b=ad.FocusManager.instance())&&
b.currentScope&&b.currentScope.name===wg.AppFrame.Upa&&b.cD(ef.AFrame.Pn));D.ks=ta.listType;D.vC=ta.listStyle;(null===(ca=w.AFrameworkApplication.K)||void 0===ca?0:ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&tw.a.instance.A5a("List");return 32}static UPn(b,k,t){var D,P,ca,ta,Na,qb,Jb,Vb;const ac=new Map;ac.set("actionCallSource",b.ia(ke.a.Ooa,"unknown"));ac.set("actionCallSourceTrigger",b.ia(ke.a.vha,"undefined"));ac.set("fromListType",xw[null!==(D=null===k||
void 0===k?void 0:k.listType)&&void 0!==D?D:16]);ac.set("fromListStyle",wo[null!==(P=null===k||void 0===k?void 0:k.listStyle)&&void 0!==P?P:0]);ac.set("fromListMarkerType",null!==(Na=l(null!==(ca=null===k||void 0===k?void 0:k.listStyle)&&void 0!==ca?ca:0,null!==(ta=null===k||void 0===k?void 0:k.listType)&&void 0!==ta?ta:16))&&void 0!==Na?Na:"undefined");ac.set("fromLevelText",(null===k||void 0===k?0:k.Kna)?k.levelText:"undefined");ac.set("toListType",null!==(qb=xw[null===t||void 0===t?void 0:t.listType])&&
void 0!==qb?qb:"undefined");ac.set("toListStyle",null!==(Jb=wo[null===t||void 0===t?void 0:t.listStyle])&&void 0!==Jb?Jb:"undefined");ac.set("toListMarkerType",null!==(Vb=l(null===t||void 0===t?void 0:t.listStyle,null===t||void 0===t?void 0:t.listType))&&void 0!==Vb?Vb:"undefined");ac.set("toLevelText",(null===t||void 0===t?0:t.Kna)?t.levelText:"undefined");xa.Health.instance.recordKpiUsage(Wg.a.qkb.LYm,0,Wg.a.qB,ac)}static Ujo(b,k){var t=new ze.GraphIterator;t.Yc(k);(k=t.Rb(2))&&pe.ParagraphReader.Wb(k)&&
(t=af.a.instance.hb.kb)&&t.Qa&&t.Qa.node===k&&hf.SelectionEditor.e_d(t)&&(Oh.ygo(b),Oh.wgo(b))}static kio(b,k){k.hasProperty(Cc.a.Sr)&&b.Ege(k.getValue(Cc.a.Sr));k.hasProperty(ke.a.kQ)&&(b.kQ=k.getValue(ke.a.kQ));k.hasProperty(Cc.a.au)&&(b.levelText=k.getValue(Cc.a.au));b.rJ=k.ia(vd.a.rJ,-1);let t=null;b.Boa&&(t=Oh.Y_l(b,k));b.Boa&&t?Oh.Pjo(b,t):(b.Boa?v.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",
b.rJ,b.Sr,b.nz):v.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),Oh.mfo(b))}static mfo(b){if(b.nz)b.IUd&&-1===b.rJ||(b.levelText="%1.",b.propertySet.hasProperty(sf.a.x4)||b.G9(0,1));else if(1===b.listType)b.IUd&&-1===b.rJ||(b.font=Wg.a.LIc,b.levelText=Wg.a.JHd,b.propertySet.hasProperty(sf.a.x4)||b.G9(1,6));else return;b.lw="left"}static Pjo(b,k){1===b.Sr?Oh.Fio(b,k):Oh.Xgo(b,k)}static Fio(b,k){(b.JB=k.JB)?b.B5=k.JB.B5:k.JB||v.ULS.sendTraceTag(588022422,
393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",b.rJ,b.Sr,b.nz)}static Xgo(b,k){b.levelText=k.levelText;b.nz?b.G9(0,k.listStyle):(b.font=k.font,b.G9(1,1));b.lw=k.lw}static Y_l(b,k){let t=null;2===b.Sr?t=b.nz?Fa.a.instance.Na("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Fa.a.instance.Na("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.Sr&&(t=Fa.a.instance.Na("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let D=t.GIb.value;
const P=b.rJ+"";P in D||(D=t.L8,v.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",P,b.Sr,b.nz));if(!(P in D)){v.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",P,b.Sr,b.nz);if(k.hasProperty(sf.a.font))return v.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",
P,b.Sr,b.nz),b=k.ia(sf.a.font,""),new ap(F.a.fromCharCode(parseInt(P)),b);v.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",P,b.Sr,b.nz)}return D[P]}static wgo(b){Oh.pj.hasProperty(sf.a.fontColor)&&b.setValue(sf.a.fontColor,Oh.pj.fontColor())}static ygo(b){Oh.pj.hasProperty(sf.a.fontSize)&&b.setValue(sf.a.fontSize,Oh.pj.fontSize())}static h0(b,k){b=b===Pb.a.iD?0:b===Pb.a.rL?1:b===Pb.a.nca?2:-1;k=k.ia(vd.a.rJ,-1);v.ULS.sendTraceTag(22923024,
324,50,"ListType: {0}, ListStyleId: {1}",b,k)}static hLo(){const b=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");if(b){var k=w.AFrameworkApplication.K.mc("WordDefaultToEditFloodgateDelayInMilliseconds",6E4);b.execute(t=>{window.setTimeout(()=>{t.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},k)})}else v.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}Oh.ntm=Be.ImageReader.jUc;Oh.p0e=Be.ImageReader.u2a;Oh.Gf=null;
Oh.Sm=null;Oh.PVc=!1;Object(n.a)(Oh,"ListActor",null,[]);class cu{constructor(){this.GIb=new Rg.a(()=>this.yaf());this.L8={}}K2h(b){return b}}Object(n.a)(cu,"AListMarkerGalleryLoader",null,[350]);var Fu=c(1367),du=c(438);class eo extends cu{constructor(){super();this.Wub=new Ji.a(Ja.a.ei())}K2h(b){eo.lQ||this.keo();b in eo.lQ&&(b=eo.lQ[b]);return b}yaf(){const b={};b["0"]=new ap(Box4Intl.Box4Strings.L_ListStyleNone,Fu.a.Esi);b["1"]=new ap(String.fromCharCode(61623),"Symbol");b["2"]=new ap(String.fromCharCode(111),
"Courier New");b["3"]=new ap(String.fromCharCode(61607),"Wingdings");b["4"]=new ap(String.fromCharCode(9643),"Courier New");b["5"]=new ap(String.fromCharCode(61611),"Wingdings");b["6"]=new ap(String.fromCharCode(61614),"Symbol");b["7"]=new ap(String.fromCharCode(61483),"Symbol");b["8"]=new ap(String.fromCharCode(61485),"Symbol");b["9"]=new ap(String.fromCharCode(9830),"Courier New");b["10"]=new ap(String.fromCharCode(61664),"Symbol");b["11"]=new ap(String.fromCharCode(61558),"Wingdings");b["12"]=
new ap(String.fromCharCode(61656),"Wingdings");b["13"]=new ap(String.fromCharCode(61514),"Wingdings");b["14"]=new ap(String.fromCharCode(61516),"Wingdings");b["15"]=new ap(String.fromCharCode(61692),"Wingdings");b["16"]=new ap(String.fromCharCode(61691),"Wingdings");b["17"]=new ap(String.fromCharCode(61553),"Wingdings");return b}une(b){b&&b.length&&this.v4e(b)}i_f(){if(this.L8){var b=du.a(this.L8),k=b.length;for(let t=0;t<k;t++){const D=this.L8[b[t]];this.Wub.add(D.levelText+"_"+D.font)}}}v4e(b){this.i_f();
for(const k of b)if(k&&!k.nz&&k.Kna&&k.xQc&&(b=k.levelText+"_"+k.font,!this.Wub.contains(b))){const t=du.a(this.L8).length+du.a(this.GIb.value).length+"";this.L8[t]=new ap(k.levelText,k.font);this.Wub.add(b)}}keo(){eo.lQ={};eo.lQ["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;eo.lQ["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;eo.lQ["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;eo.lQ["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;eo.lQ["Wingdings 0x00ab"]=
Box4Intl.Box4Strings.L_Star;eo.lQ["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;eo.lQ["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;eo.lQ["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;eo.lQ["Courier New 0x2666"]=Box4Intl.Box4Strings.L_BlackDiamond;eo.lQ["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;eo.lQ["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;eo.lQ["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;eo.lQ["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;
eo.lQ["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;eo.lQ["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;eo.lQ["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;eo.lQ["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}eo.lQ=null;Object(n.a)(eo,"ListMarkerBulletLoader",cu,[]);class Nq{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(n.a)(Nq,"InfoAtLevel",null,[]);class mx{constructor(b){this.JB=b}get font(){return"Calibri"}get listStyle(){return 42}get lw(){return"left"}get P$d(){return this.JB?
this.cFn():this.eFn()}get hXc(){return this.JB?this.dFn():null}get levelText(){return""}pVl(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}cFn(){let b="";for(let k=0;3>k;k++)b+=this.XOc(k);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',mx.Mof(),b)}dFn(){const b=[];for(let k=0;3>k;k++)b.push(Object.assign(new Nq,{textAtLevel:this.Hdi(k),styleAtLevel:this.$bm(k)}));return b}eFn(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
mx.Nof(),Box4Intl.Box4Strings.L_ListStyleNone)}Hdi(b){b=this.JB.iXc[b];for(let k=0;9>k;k++)b=F.a.replaceAll(b,"%"+(k+1),this.pVl(this.JB.JIb[k]));return b}$bm(b){const k={};k.fontFamily=6===this.JB.JIb[b]?this.JB.ZDa[b]:this.font;return k}XOc(b){const k=this.Hdi(b),t=new Sys.StringBuilder;6===this.JB.JIb[b]&&t.append(String.format("font-family:{0};",this.JB.ZDa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,t.toString(),k)}static Mof(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Nof(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(n.a)(mx,"ListMarkerMultilevel",null,[299]);var Ly=c(1379);class uA extends cu{constructor(){super()}yaf(){const b=new Ly.a,k={};k["0"]=new mx(null);k["1"]=new mx(b.T$e());k["2"]=new mx(b.Laf("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));k["3"]=new mx(b.aKh([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return k}une(){}}Object(n.a)(uA,"ListMarkerMultilevelLoader",cu,[]);var uq=c(137);class Rp{constructor(b,k){this.JB=null;this.levelText=b;this.Snd=k}get font(){return"Calibri"}get listStyle(){return this.Snd}get lw(){switch(this.Snd){case 3:case 5:return"right";default:return"left"}}get P$d(){switch(this.Snd){case 1:return this.bgc("1",
"2","3");case 2:return this.bgc("a","b","c");case 3:return this.bgc("i","ii","iii");case 4:return this.bgc("A","B","C");case 5:return this.bgc("I","II","III");case 0:return this.fFn();default:return this.bgc("1","2","3")}}get hXc(){const b=[],k={};k.fontFamily=uq.FontUtils.eDa(this.font);switch(this.Snd){case 1:return b.push(Object.assign(new Nq,{textAtLevel:this.zX("1"),styleAtLevel:k})),b.push(Object.assign(new Nq,{textAtLevel:this.zX("2"),styleAtLevel:k})),b.push(Object.assign(new Nq,{textAtLevel:this.zX("3"),
styleAtLevel:k})),b;case 2:return b.push(Object.assign(new Nq,{textAtLevel:this.zX("a"),styleAtLevel:k})),b.push(Object.assign(new Nq,{textAtLevel:this.zX("b"),styleAtLevel:k})),b.push(Object.assign(new Nq,{textAtLevel:this.zX("c"),styleAtLevel:k})),b;case 3:return b.push(Object.assign(new Nq,{textAtLevel:this.zX("i"),styleAtLevel:k})),b.push(Object.assign(new Nq,{textAtLevel:this.zX("ii"),styleAtLevel:k})),b.push(Object.assign(new Nq,{textAtLevel:this.zX("iii"),styleAtLevel:k})),b;case 4:return b.push(Object.assign(new Nq,
{textAtLevel:this.zX("A"),styleAtLevel:k})),b.push(Object.assign(new Nq,{textAtLevel:this.zX("B"),styleAtLevel:k})),b.push(Object.assign(new Nq,{textAtLevel:this.zX("C"),styleAtLevel:k})),b;case 5:return b.push(Object.assign(new Nq,{textAtLevel:this.zX("I"),styleAtLevel:k})),b.push(Object.assign(new Nq,{textAtLevel:this.zX("II"),styleAtLevel:k})),b.push(Object.assign(new Nq,{textAtLevel:this.zX("III"),styleAtLevel:k})),b;case 0:return null;default:return b.push(Object.assign(new Nq,{textAtLevel:this.zX("1"),
styleAtLevel:k})),b.push(Object.assign(new Nq,{textAtLevel:this.zX("2"),styleAtLevel:k})),b.push(Object.assign(new Nq,{textAtLevel:this.zX("3"),styleAtLevel:k})),b}}bgc(b,k,t){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',Rp.Mof(),this.XOc(b),this.XOc(k),this.XOc(t))}fFn(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Rp.Nof(),Box4Intl.Box4Strings.L_ListStyleNone)}XOc(b){b=this.zX(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}zX(b){return F.a.replaceAll(this.levelText,"%1",b)}static Mof(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Nof(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(n.a)(Rp,"ListMarkerNumbering",null,[299]);class Fv extends cu{constructor(){super();this.Wub=new Ji.a(Ja.a.ei())}EQm(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}yaf(){const b=
{};b["0"]=new Rp(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new Rp("%1.",5);b["2"]=new Rp("%1.",4);b["3"]=new Rp("%1.",1);b["4"]=new Rp("%1.",2);b["5"]=new Rp("%1.",3);b["6"]=new Rp("%1)",5);b["7"]=new Rp("%1)",4);b["8"]=new Rp("%1)",1);b["9"]=new Rp("%1)",2);b["10"]=new Rp("%1)",3);b["11"]=new Rp("(%1)",5);b["12"]=new Rp("(%1)",4);b["13"]=new Rp("(%1)",1);b["14"]=new Rp("(%1)",2);b["15"]=new Rp("(%1)",3);return b}une(b){b&&b.length&&this.v4e(b)}i_f(){if(this.L8){var b=du.a(this.L8),k=b.length;
for(let t=0;t<k;t++){const D=this.L8[b[t]];this.Wub.add(D.levelText+"_"+D.listStyle)}}}v4e(b){this.i_f();for(const k of b)if(k&&k.nz&&k.Kna&&this.EQm(k.levelText)&&k.listStyle&&(b=Fu.a.fmf(k.levelText))){const t=b+"_"+k.listStyle;if(!this.Wub.contains(t)){const D=du.a(this.L8).length+du.a(this.GIb.value).length+"";this.L8[D]=new Rp(b,k.listStyle)}this.Wub.add(t)}}}Object(n.a)(Fv,"ListMarkerNumberingLoader",cu,[]);class Gu{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){Oh.Tb()}dispose(){}xc(b){this.W=
b;this.W.ha("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new eo).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new Fv).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new uA).singleInstance()}static main(){N.a.instance.Fc(new Gu)}}Object(n.a)(Gu,"Box4ListMarkerPackage",null,[1,2]);class by{static get Xg(){return Wf.a.lA(by.Lm,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,
"")}}by.Lm="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(n.a)(by,"DefineNewBulletDialogHtml",null,[]);class Hs extends Wf.a{constructor(b,k,t,D){super();this.gwc=this.FIe=this.uWb=this.mWb=null;this.Dvb=0;this.zEc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.$pi=!0;this.khl=P=>{if(this.mWb&&P.target!==this.mWb){const ca=this.xg.Ps();ca&&ca.Zj&&(ca.Zj.Gy(P.target),this.mWb=P.target)}this.Prn(P.target.id)};this.uYm=P=>{P=P.zf;if(!this.CCi(P))return!1;this.xg.Ps().Zj.Gy(P);P.focus();return!0};this.vYm=P=>{var ca=P.zf;if(!this.CCi(ca))return!1;
var ta=ca.id;ta=parseInt(ta.substr(ta.lastIndexOf("_")+1))-this.Dvb;if(P.Gb.ctrlKey||P.Gb.altKey||P.Gb.keyCode>=pc.a.DRb&&P.Gb.keyCode<=pc.a.ERb)return!1;const Na=P.Gb.keyCode;if(P.eventName===Rc.a.hi){P=-1;if(Na===Sys.UI.Key.enter)return this.xg.Ps().Zj.Gy(ca),ca.focus(),this.ZTi(ca.id),this.hide(),!0;Na===Sys.UI.Key.up?P=ta-17:Na===Sys.UI.Key.down?P=ta+17:Na===Sys.UI.Key.left?P=w.AFrameworkApplication.isRtl?ta+1:ta-1:Na===Sys.UI.Key.right&&(P=w.AFrameworkApplication.isRtl?ta-1:ta+1);0<=P&&(ca=this.qai(Hs.o4b+
"_"+(P+this.Dvb)))&&ca.focus()}return!0};this.jhl=P=>{1===P&&this.ZTi(this.uWb);this.hide()};this.pu=b;this.xg=k;this.ga=t;this.pS=!1;D&&(b=D.indexOf(","),-1!==b&&(D=D.substring(0,b)));this.fontName=D;this.vg="DefineNewBulletDialog";this.Xg=by.Xg;this.Ee(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ee(0,CommonUIStrings.l_DialogClose);this.Wh(Box4Intl.Box4Strings.L_SymbolSingle,this.jhl,null);this.A$=!1;this.UGa();document.getElementById(Hs.JMd).focus()}UGa(){this.xg.Ps().scope.ir(ad.FocusManager.instance().nW);
this.xg.Ps().scope.ir(ad.FocusManager.instance().oW);this.xg.Ps().scope.bindAction(ad.FocusManager.instance().nW,Pb.a.VHd);this.xg.Ps().scope.bindAction(ad.FocusManager.instance().oW,Pb.a.UHd)}W8(){this.TBd(Hs.JMd,"DefineNewBulletFontPlaceholder",Pb.a.THd.toString(),Pb.a.SLb.toString(),Pb.a.n1c.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.RLk()}qL(){super.qL();document.getElementById(this.kj("WACDialogPanel")).style.width="auto"}TBd(b,k,t,D,P,ca,ta){t=gl.c(b,t,!0,!0,D,P,F.a.Af(ca),!0,
ta);this.wGd(b,k,t,"Medium")}RLk(){const b=document.getElementById(Hs.o4b);b&&(b.innerHTML=this.Z6h(),this.c8i(b))}c8i(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let k=0;k<b.length;k++)vf.a.addHandler(b[k],Rc.a.focus,this.khl)}ZSo(){var b=document.getElementById(Hs.o4b);if(b){let k=this.fontName;const t=Fu.a.wBf(this.fontName);t&&61472!==this.Dvb||!t&&32!==this.Dvb?(b.innerHTML=this.Z6h(),this.c8i(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&k&&(k=this.toh(k),b[0].style.fontFamily=
k)}}Prn(b){this.blj(this.uWb,!1);this.uWb=b;this.blj(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.uWb){let k=parseInt(this.uWb.substr(this.uWb.lastIndexOf("_")+1));-1!==k&&(k-=61472===this.Dvb?61440:0,b.innerText=F.a.NI(k,4))}}blj(b,k){(b=this.qai(b))&&(k?b.setAttribute("selected","true"):b.removeAttribute("selected"))}qai(b){const k=document.getElementById(Hs.o4b);return k?k.querySelector("#"+b):null}Tla(){const b=document.getElementById(Hs.o4b);b&&(this.FIe||(this.FIe=this.uYm,
this.Jq.lb(Rc.a.click,b,this.FIe)),this.gwc||(this.gwc=this.vYm,this.ae.lb(Rc.a.hi,b,this.gwc),this.ae.lb(Rc.a.Zt,b,this.gwc),this.ae.lb(Rc.a.vh,b,this.gwc)));super.Tla()}CCi(b){return b.classList.contains("DefineNewBulletTableCell")}ZTi(b){if(b){b=b.split("_");const k=new th.DictionaryPropertySet;k.setValue(vd.a.rJ,parseInt(b[1]));k.setValue(sf.a.font,this.fontName);k.setValue(vd.a.yA,1);wl.a.bY&&(k.setValue(ke.a.Ooa,"command-ui"),k.setValue(ke.a.vha,"define-new-bullet-dialog"));this.ga.Qb(Pb.a.iD,
2,k)}this.xg.kL(this.NK,!0)}Z6h(){const b=new Sys.StringBuilder,k=Fu.a.wBf(this.fontName);let t=this.fontName;t=this.toh(t);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',t));k?(this.Dvb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.Dvb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}toh(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}wGd(b,k,t,D){k=document.getElementById(k);this.pu.OYa(b,t);t=this.pu.ODb(b,D);k.appendChild(t);this.pu.ypa(b)}dispose(){this.pS||(this.pu.BY(Hs.JMd),this.pS=!0);super.dispose()}}Hs.JMd="DefineNewBulletFontStyleComboBox";Hs.o4b="DefineNewBulletTableContainer";Object(n.a)(Hs,"DefineNewBulletDialog",Wf.a,[]);class nx{uOc(){return Pb.a.qYm}WOc(){return Pb.a.GZf}}Object(n.a)(nx,"ListMarkerGalleryBulletCommands",
null,[351]);class eu{uOc(){return Pb.a.sYm}WOc(){return Pb.a.mCn}}Object(n.a)(eu,"ListMarkerGalleryMultilevelCommands",null,[351]);class fu{uOc(){return Pb.a.tYm}WOc(){return Pb.a.HZf}}Object(n.a)(fu,"ListMarkerGalleryNumberingCommands",null,[351]);class yw{constructor(b,k,t,D,P){this.hAa=this.dLa=null;this.pPh=ca=>{if(!this.hAa)return 2;if(this.hAa.xg.Ps().Zj.s3.id.startsWith(Hs.o4b)){let ta=null;ca===Pb.a.VHd?ta=this.hAa.qZa:ca===Pb.a.UHd&&(ta=document.getElementById(Hs.JMd));if(!ta)return 2;this.hAa.xg.Ps().Zj.Gy(ta);
ta.focus()}else if(ca===Pb.a.VHd)this.hAa.xg.Ps().Hdc();else if(ca===Pb.a.UHd)this.hAa.xg.Ps().Fdc();else return 2;return 32};this.qFi=(ca,ta)=>{ca=null;ta.view.qe&&(ca=ta.view);return ca&&ca.mb?32:(Jc.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",ta.toString()),8)};this.jWm=(ca,ta,Na)=>{var qb;return 1===Na?32:2===Na?((null===(qb=w.AFrameworkApplication.K)||void 0===qb?0:qb.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",
!1))&&tw.a.instance.A5a("ListDefine"),ca=this.p8b(ta),ca=Je.FormattingReader.Kr(ca).cache.rG,this.hAa=new Hs(this.Bjk,ad.FocusManager.instance(),w.AFrameworkApplication.va,ca),32):8};this.n1c=(ca,ta,Na,qb,Jb)=>{if(1===Na)return 32;if(2===Na&&!Jb)return 8;if(this.hAa.$pi){for(ca=0;ca<Fu.a.zEc.length;ca++)uq.FontUtils.bCj(Fu.a.zEc[ca]);this.hAa.$pi=!1}bd.a.iWd(ta);Jb.PopulationXML=uq.FontUtils.p2h(bd.a.Rhe,bd.a.Hlf,Pb.a.THd);return 32};this.lCn=(ca,ta,Na,qb,Jb)=>{ca=ta.contextId===lc.a.outlineElement;
if(1===Na||!ca)return ca?32:8;if(2===Na&&!Jb)return 8;Jb.MenuItems=this.T9j.b0l();return 32};this.ihl=(ca,ta,Na,qb,Jb)=>{if(1===Na)return 32;if(2===Na){ca=Object(Ka.a)(21,Jb);if(!ca||!ca.vd)return 8;this.hAa.fontName=ca.vd.fontName;this.hAa.ZSo();return 32}return 8};this.ga=b;this.Gf=D.resolve("Box4.List.IListReader");this.A6=k;this.Bjk=t;switch(this.A6){case 0:b=D.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.dLa=new nx;break;case 1:b=D.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");
this.dLa=new fu;break;case 2:b=D.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.dLa=new eu;break;default:b=D.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),this.dLa=new nx}P=this.Gf?this.Gf.Q_l(P):null;b.une(P);this.T9j=new Fu.a(k,b,P,!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.HHb)}Tb(){this.ga.qa(this.dLa.WOc(),lc.a.view,Wa.App.NTa.wKh(11));this.ga.qa(this.dLa.WOc(),lc.a.outlineElement,this.lCn);this.ga.Vc(this.dLa.WOc(),1124);this.A6||(this.ga.fb(Pb.a.xIf,
lc.a.view,this.jWm,1028),this.ga.fb(Pb.a.n1c,lc.a.view,this.n1c,1124),this.ga.fb(Pb.a.THd,lc.a.view,this.ihl,1028),this.ga.fb(Pb.a.VHd,Ud.a.frame,this.pPh,64),this.ga.fb(Pb.a.UHd,Ud.a.frame,this.pPh,64));this.ga.qa(this.dLa.uOc(),lc.a.view,this.qFi);this.ga.qa(this.dLa.uOc(),lc.a.outlineElement,this.qFi);this.ga.Vc(this.dLa.uOc(),1124)}p8b(b){return this.ZNd(b).Qa}ZNd(b){let k=null;b=b.view;return b?k=hf.SelectionEditor.Cj(b.mb.hb.J(0),!1,!1):k}}Object(n.a)(yw,"ListMarkerGalleryActor",null,[261]);
class vz{constructor(){this.Fe=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(Lb.InteractiveViewManager.instance){var b=Lb.InteractiveViewManager.instance;b.editingView&&(this.Fe=b.editingView.ed,this.qUn())}}dispose(){}xc(b){this.W=b}qUn(){(new yw(w.AFrameworkApplication.va,1,this.W.resolve("Common.IStandaloneRootController").Zca,this.W,this.Fe)).Tb();(new yw(w.AFrameworkApplication.va,0,this.W.resolve("Common.IStandaloneRootController").Zca,this.W,this.Fe)).Tb();(new yw(w.AFrameworkApplication.va,
2,this.W.resolve("Common.IStandaloneRootController").Zca,this.W,this.Fe)).Tb()}static main(){N.a.instance.Fc(new vz)}}Object(n.a)(vz,"Box4ListMarkerGalleryPackage",null,[1,2]);var Gv=c(424),cy=c(485),BB=c(446),Zq=c(125);const Fi=b=>{b.element.style.top=""};var zt=c(704);class Hv{constructor(b,k,t){this.qH=!1;this.U9a=0;this.Nda=this.N9g=null;this.vl=b;this.Ekk=k;this.gt=t;this.s6=b.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.Fw=!!w.AFrameworkApplication.ta&&
w.AFrameworkApplication.ta.Nb.pJ)&&!this.gt.aff&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";aa.a.jj&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.s6}get visible(){return this.qH}set_visible(b){if(this.qH!==b)return(this.qH=b)?this.h2e():this.cJc(),b}dispose(){this.visible&&this.cJc();fc.a.e_(this.htmlElement);this.vl=this.s6=null}Fqj(b,k){const t=b.htmlElement||b.createElement();k===this.htmlElement.childNodes.length?
this.htmlElement.appendChild(t):this.htmlElement.insertBefore(t,this.htmlElement.childNodes[k]);b.Wcj();this.U9a+=b.htmlElement.clientHeight;var D=this.htmlElement.childNodes,P=b.Erh,ca=Object(A.a)(this,this.Din,"onAfterShowEntry");Zq.WacAirSpace.VU(t,"Shared_BasicClass");var ta=new BB.a(t);ta.Eta(0,1);const Na=new cy.a(t);Na.iCa(t.clientTop-30,t.clientTop);P?(Zq.WacAirSpace.llb(ta,null,null),Zq.WacAirSpace.llb(Na,null,ca)):(Zq.WacAirSpace.animate(ta,null,null),Zq.WacAirSpace.animate(Na,null,ca));
for(k+=1;k<D.length;k++)ca=D[k],Zq.WacAirSpace.VU(ca,"Shared_BasicClass"),ta=new cy.a(ca),ta.iCa(ca.clientTop-t.clientHeight,ca.clientTop),P?Zq.WacAirSpace.llb(ta,null,null):Zq.WacAirSpace.animate(ta,null,null);b.Jto();this.set_visible(!0)}cni(b){const k=b.htmlElement;if(fc.a.xac(k)){this.U9a-=b.htmlElement.clientHeight;var t=k.parentNode.children;b=b.Erh;var D=Object(A.a)(this,this.win,"onAfterHideEntry");Zq.WacAirSpace.VU(k,"Shared_BasicClass");var P=new Gv.a(k);P.Eta(1,0);b?Zq.WacAirSpace.llb(P,
null,D):Zq.WacAirSpace.animate(P,null,D);D=!1;for(P=0;P<t.length;P++){if(D){const ca=t[P];Zq.WacAirSpace.VU(ca,"Shared_BasicClass");const ta=new cy.a(ca);ta.iCa(ca.clientTop,-k.clientHeight);b?Zq.WacAirSpace.llb(ta,null,Fi):Zq.WacAirSpace.animate(ta,null,Fi)}D||t[P]!==k||(D=!0)}}}Din(b){b.element.style.top="";w.AFrameworkApplication.ta.HZc()}win(b){b.element.parentNode.removeChild(b.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);w.AFrameworkApplication.ta.HZc()}h2e(){""===this.vl.style.top.trim()&&
(this.vl.style.top=this.vl.offsetTop+"px");this.htmlElement.style.left=this.vl.style.left;this.htmlElement.style.top=this.vl.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.N9g=this.vl.style.top;this.U9a=b.height;this.Jne();w.AFrameworkApplication.ta.VZ(Object(A.a)(this,this.onResize,"onResize"));vf.a.addHandler(this.htmlElement,Rc.a.ffe,vf.a.X1b);this.Nda=Object(A.a)(this,this.cDa,"contextMenuHandler");
w.AFrameworkApplication.ta.Sya.lb(this.htmlElement,this.Nda,null);if(ad.FocusManager.SJ()){var k=ad.FocusManager.instance();b=k.ge(zt.a.dNa);b.parent=ef.AFrame.rp;const t=new Se.DOMFocusListing(()=>this.htmlElement);t.Wm(1);t.Wm(2);t.Wm(8);k.Yla(()=>this.htmlElement,b,t);k=k.getRegion(zt.a.dNa);k.mSa();k.jR=!0;k.UZa=!0;const D=w.AFrameworkApplication.ta.jx;b.PYa(()=>{D.Rw(zt.a.dNa)});D.dT(zt.a.dNa);(t.kga||w.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled"))&&D.CI(zt.a.dNa)}}cJc(){this.hqj()&&
(this.vl.style.top=this.N9g);this.htmlElement.style.visibility="hidden";w.AFrameworkApplication.ta&&(ad.FocusManager.SJ()&&ad.FocusManager.instance().B5a(zt.a.dNa),this.Nda&&(w.AFrameworkApplication.ta.Sya.rc(this.htmlElement,this.Nda),this.Nda=null));vf.a.removeHandler(this.htmlElement,Rc.a.ffe,vf.a.X1b)}Jne(){if(this.hqj()&&this.visible){var b=this.vl,k=this.U9a+this.Ekk;const t=fc.a.OM(b.style.top);Zq.WacAirSpace.VU(b,"Shared_BasicClass");b=new cy.a(b);b.iCa(t,k);Zq.WacAirSpace.animate(b,null,
null)}}hqj(){return!this.Fw&&!this.gt.aff}onResize(){const b=this.gt.entries.length,k=Sys.UI.DomElement.getBounds(this.htmlElement).height;let t;for(let D=0;D<b;++D)t=this.gt.entries[D],t.htmlElement&&t.Wcj();this.U9a=Sys.UI.DomElement.getBounds(this.htmlElement).height;k!==this.U9a&&this.Jne()}cDa(){return!0}}Object(n.a)(Hv,"BusinessBarDom",null,[1111,9]);var ht;(function(b){b[b.none=0]="none";b[b.corruptPage=1]="corruptPage";b[b.currentPageStatus=2]="currentPageStatus";b[b.documentMarkedAsFinal=
3]="documentMarkedAsFinal";b[b.documentSigned=4]="documentSigned";b[b.fileAccess=5]="fileAccess";b[b.kickoutWithDataLoss=6]="kickoutWithDataLoss";b[b.lostSession=7]="lostSession";b[b.malformedHyperlinkUris=8]="malformedHyperlinkUris";b[b.odt=9]="odt";b[b.readonlyRecommended=10]="readonlyRecommended";b[b.saveReplaySuccess=11]="saveReplaySuccess";b[b.saveReplayFailed=12]="saveReplayFailed";b[b.unsupportedObjects=13]="unsupportedObjects";b[b.word11Compat=14]="word11Compat";b[b.unsupportedBrowser=15]=
"unsupportedBrowser";b[b.applicationNotification=16]="applicationNotification";b[b.skypeDocChatFailed=17]="skypeDocChatFailed";b[b.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";b[b.sessionExpired=19]="sessionExpired";b[b.irmPolicyDescription=20]="irmPolicyDescription";b[b.policyWarningMessage=21]="policyWarningMessage";b[b.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";b[b.gdprPrivacyNotice=23]="gdprPrivacyNotice";b[b.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";
b[b.graphMergePrompt=25]="graphMergePrompt";b[b.readOnlyDocument=26]="readOnlyDocument";b[b.dictationSilence=27]="dictationSilence";b[b.autoSensitivityLabel=28]="autoSensitivityLabel";b[b.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";b[b.dictationDebugInfo=30]="dictationDebugInfo";b[b.oneNoteCovid19Message=31]="oneNoteCovid19Message";b[b.citationStylePrompt=32]="citationStylePrompt";b[b.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";b[b.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";
b[b.oneNotePagePrintReady=35]="oneNotePagePrintReady";b[b.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";b[b.mandatoryLabel=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.minorVersionLimit=39]="minorVersionLimit";b[b.testEntry1=40]="testEntry1";b[b.testEntry2=41]="testEntry2";b[b.testEntry3=42]="testEntry3";b[b.testEntry4=43]="testEntry4";b[b.testEntry5=44]="testEntry5";b[b.testEntry6=45]="testEntry6";b[b.testEntry7=46]="testEntry7"})(ht||(ht={}));Object(n.b)("BusinessBarId",
ht);class Dp{constructor(b,k=0,t=null,D=null){this.C1g=this.bSg=!1;this.NXb=null;this.VA=[];this.OUa=D||new Hv(b,k,this);this.Xxm(t)}Xxm(b){if(b){this.NXb={};b=b.ranking;for(let k=0;k<b.length;k++)this.NXb[ht[b[k]]]=k}}dispose(){this.OUa.dispose();Da.a.K8f(this.VA);this.VA=null}get htmlElement(){return this.OUa.htmlElement}get visible(){return this.OUa.visible}get aff(){return this.bSg}set aff(b){this.bSg=b}get rFf(){return this.C1g}set rFf(b){this.C1g=b}get entries(){return this.VA}set entries(b){this.VA=
b}ZX(b){for(let k=0;k<this.VA.length;k++)if(this.VA[k].id===b)return!0;return!1}aA(b,k=!1,t=null,D=null,P=null){b.fM=this;let ca=this.LYl(b.id);k&&!this.NXb&&(ca=0);ca<Dp.oJb&&(this.OUa.Fqj(b,ca),this.VA.length>=Dp.oJb&&this.OUa.cni(this.VA[Dp.oJb-1]),this.OUa.Jne());Array.insert(this.VA,ca,b);v.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",ht[b.id],void 0===b.VZa||null===b.VZa?"":b.VZa);b.errorCode&&w.AFrameworkApplication.UM(b.errorCode,t,D,P)}removeEntry(b){const k=
Array.indexOf(this.VA,b);-1!==k&&k<Dp.oJb&&(this.VA.length>Dp.oJb&&this.OUa.Fqj(this.VA[Dp.oJb],Dp.oJb),this.OUa.cni(b),this.OUa.Jne());Array.remove(this.VA,b);b.fM=null;b.dispose()}LYl(b){if(!this.NXb||0===b)return this.VA.length;b=this.NXb[ht[b]];if(void 0===b||null===b)return this.VA.length;for(let k=0;k<this.VA.length;k++)if(b<this.NXb[ht[this.VA[k].id]])return k;return this.VA.length}}Dp.oJb=2;Object(n.a)(Dp,"BusinessBar",null,[1090,9,1091]);class At{create(b,k,t){return new Qi.a(b,k,t)}}Object(n.a)(At,
"Factory",null,[1113]);class Iv{static k2k(b,k){b.register(Dp,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").singleInstance().Rd(()=>new Dp(k.value,0,b.Na("CommonUI.IBusinessBarRankProvider")));b.register(At,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").singleInstance()}}Object(n.a)(Iv,"CommonUIComponentConfiguration",null,[]);var ns=c(997);class os extends ns.a{constructor(){super()}static get instance(){return os._instance||os.Pzf()}static Pzf(){os._instance=
new os;return os._instance}}os._instance=null;Object(n.a)(os,"ReactRootManager",ns.a,[263,264]);class dv extends zg.a{constructor(){super()}get ControlType(){return 3}}Object(n.a)(dv,"CompoundButtonProps",zg.a,[]);class Bt{constructor(b,k,t,D,P,ca,ta){this.gW=k;this.Czc=b;this.R_g=k.zHm;this.QVb=k.fVc;this.jFe=ca;this.Ekd=D;this.Fkd=P;this.zkd=t;this.eK=ta;this.hab=new Cj.a;this.hab.Z(1,"SpellingIssue_16x16x32");this.hab.Z(2,"GrammarIssue_16x16x32");this.hab.Z(3,"WritingIssue_16x16x32");this.hab.Z(4,
null);this.hab.Z(0,null)}create(b,k,t){k=Object(Ka.a)(Fo.a,k);if(!k)return v.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const D=new Sys.StringBuilder;b=this.Q$h(b);this.jIc(D,k,t,b);this.taf(D,k);this.Bbl(D,k,b);return D.toString()}ffb(b,k,t){const D=Object(Ka.a)(Fo.a,k);if(!D)return v.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];k=[];b=this.Q$h(b);this.dbf(k,D,t,b);this.uaf(k,D);this.Cbl(k,D,b);for(t=0;t<k.length;t++)k[t].Id=`${Cu.eUh}_${t}`;
return k}jIc(b,k,t,D=null){k.errorType?1===k.errorType&&(this.D5b(k)||b.append(this.r4e(k,t,D))):b.append(this.Czc.build())}dbf(b,k,t,D=null){k.errorType?1===k.errorType&&(this.D5b(k)||b.push(this.OLk(k,t,D))):b.push(this.Czc.lyh())}taf(b,k){const t=new Sys.StringBuilder;this.zrj(k)?t.append(gl.a("btnIgnoreAllSpellingError",(2===k.errorType?Pb.a.BIa:Pb.a.Pna).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.D5b(k)||t.append(gl.a("btnIgrnoreSpellingError",this.L9h(k.errorType).toString(),
Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.Frj(k)&&(this.gW.wvi&&t.append(gl.a("btnDoNotCheckForThisIssue",Pb.a.XBb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),t.append(gl.a("btnGrammarOptions",Pb.a.mmb.toString(),F.a.Af(Box4Intl.Box4Strings.l_GrammarOptions),null)));t.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),b.append(t.toString()),b.append("</Controls></MenuSection>"))}uaf(b,k){const t=Object.assign(new fh.a,
{ControlList:[]});if(this.zrj(k)){var D=an.zB()?Object.assign(new zg.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:Pb.a.Pna,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new zg.a,{ExternalId:2===k.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});t.ControlList.push(D)}else this.D5b(k)||(D=Object.assign(new zg.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.L9h(k.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),t.ControlList.push(D));
this.Frj(k)&&(this.gW.wvi&&(k=Object.assign(new zg.a,{ExternalId:"DoNotCheckForThisIssue"}),t.ControlList.push(k)),k=Object.assign(new zg.a,{ExternalId:"GrammerSettingsContext"}),t.ControlList.push(k));b.push(t)}Q$h(b){if(!this.eK)return null;b=this.eK.language(this.eK.Kr(b.Qa));return Xj.a.og(b)?Xj.a.og(b).name:null}L9h(b){return 2===b?Pb.a.BIa:this.gW.kKm?Pb.a.$sm:Pb.a.dwa}Bbl(b,k,t=null){if(this.Lcg(k)){var D=F.a.Af(k.nt.CategoryTitle);D=gl.m(Cu.hgc,$a.a.Kla,this.hab.J(k.proofingType),""!==D?D:
Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[b.toString()],this.Ekd,this.Fkd);D=gl.d("cgProofingOuter",[D]);b.clear();b.append(gl.g("msProofingOuter",D,"Menu16",void 0,void 0,t,"ariaLabelledById"));v.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",k.proofingType,k.typeId)}}Cbl(b,k,t=null){if(this.Lcg(k)){var D=F.a.Af(k.nt.CategoryTitle);t=Object.assign(new jj.a,{ExternalId:String.format("{0}_{1}",Cu.hgc,k.proofingType),Command:$a.a.Kla.toString(),
Image16by16Class:this.hab.J(k.proofingType),LabelText:""!==D?D:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:t,Menu:Object.assign(new be.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.zLl(k),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});t.Menu.MenuSectionList.push(...b);Array.clear(b);D=Object.assign(new fh.a,{ControlList:[]});D.ControlList.push(t);b.push(D);v.ULS.sendTraceTag(39188234,375,
50,"Show 2-level context menu of type {0}, critique id {1}",k.proofingType,k.typeId)}}r4e(b,k,t=null){const D=this.TTl(b);var P=[];let ca=!1;var ta=b.nt.Suggestions;if(ta)if(ta=ta.slice(0,Math.min(3,ta.length)),this.R_g&&(ca=!Qm.a.any(ta,Na=>!Na||!Na.Description)),1!==ta.length||ta[0].Action){let Na=0,qb=null;ca&&(qb="font-weight: bold;");for(const Jb of ta){if(!Jb)continue;ta=null;let Vb="";const ac=F.a.Af(Jb.Text);ca&&(ta=this.u4h(Jb.Description),Vb=this.t4h(Jb.Description));P.push(gl.a("btnCorrectWord"+
Na,k[Na].toString(),ac,null,null,null,null,null,qb,null,ta,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,D,ac),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.KIh(b.token)),"ariaDescribedById",Vb));Na++}}else k=F.a.Af(ta[0].Text),P.push(gl.a("btnCorrectWord0",Pb.a.BIa.toString(),k,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,
D,k)));k="Menu16";0<P.length?ca&&(k="Menu16DescriptionEnabled"):P=[gl.a("btnNoSuggestions",Pb.a.BIa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return gl.g("msUnknownWord",gl.d(null,P),k,D,this.g1l(b),t,"ariaLabelledById")}OLk(b,k,t=null){var D=1!==b.proofingType&&0!==b.proofingType?b.nt.ExplanationTitle:"";D=Object.assign(new fh.a,{Title:D,Lang:t,ControlList:[]});let P=!1;var ca=b.nt.Suggestions;if(ca)if(ca=ca.slice(0,Math.min(3,ca.length)),this.R_g&&(P=!Qm.a.any(ca,ta=>!ta||!ta.Description)),
1!==ca.length||ca[0].Action){let ta=0;for(const Na of ca){if(!Na)continue;ca=null;let qb="";P&&(ca=this.u4h(Na.Description),qb=this.t4h(Na.Description));if(ta>=k.length)break;ca?(ca=Object.assign(new dv,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",ta,b.proofingType),Command:k[ta].toString(),LabelText:Na.Text,Description:ca,Lang:t,AriaDescription:qb}),D.ControlList.push(ca)):(ca=Object.assign(new zg.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",ta,b.proofingType),
Command:k[ta].toString(),LabelText:Na.Text,Lang:t,RoleInMenu:"menuitem"}),D.ControlList.push(ca));ta++}}else b=ca[0],b=Object.assign(new zg.a,{ExternalId:"NoSuggestion",Command:Pb.a.BIa.toString(),LabelText:b.Text}),D.ControlList.push(b);0>=D.ControlList.length&&D.ControlList.push(Object.assign(new zg.a,{ExternalId:"btnNoSuggestions",Command:Pb.a.BIa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return D}TTl(b){return F.a.Af(0!==b.proofingType?b.nt.ExplanationTitle:"")}g1l(b){return this.Lcg(b)?
null:this.hab.J(b.proofingType)}Lcg(b){return this.QVb&&2!==b.errorType&&(1!==b.errorType||!this.D5b(b))}zrj(b){return this.jFe&&!!b.errorType&&1===b.proofingType&&!this.D5b(b)}zLl(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.KIh(b.token)):""}Frj(b){return this.gW.OZd&&this.QVb&&1===b.errorType&&(2===b.proofingType||3===b.proofingType)}D5b(b){return!!b.errorType&&!!this.zkd&&this.zkd.contains(b.token,b.lcid)}u4h(b){return""===
b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):b}t4h(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}KIh(b){let k="";if(b){let t;for(t=0;t<b.length-1;t++)k=k+b.charAt(t)+",";k+=b.charAt(t)}return k}}Object(n.a)(Bt,"EditorServiceProofingContextMenuCreator",null,[]);class wz{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(n.a)(wz,
"BusinessBarRankProvider",null,[258]);class Sp{constructor(){this.W=null}get name(){return"Wonca.UI"}xc(b){this.W=b;b.ha("CommonUI.IBusinessBarRankProvider",()=>new wz).singleInstance();Iv.k2k(b,new Rg.a(()=>Wa.App.ya.Vfa));b.ha("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new Bt(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.Proofing.IIgnoreAllKeywords"),w.AFrameworkApplication.Dba,w.AFrameworkApplication.Rs,
w.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),b.resolve("Box4.IFormattingReader"))).singleInstance();b.ha("CommandUI.ReactRootManager",()=>os.instance).as("Common.IReactRootManager").singleInstance()}init(){this.W.resolve("Wonca.IRibbonUserFactory");this.W.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){N.a.instance.Fc(new Sp)}}Object(n.a)(Sp,"WoncaUIPackage",null,[1,2]);class vA{constructor(b){this.tN=this.Gxc=null;this.nn=b}get key(){return"BOOKMARK"}get Pw(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get u3(){return this.tN}reset(b){this.tN=
b.node}rIa(b){let k=null;w.AFrameworkApplication.ue("bookmarks-core-ex;bookmarks-core-ex-cf");if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)){if(this.Gxc&&this.nn.Vui(b,this.u3,this.Gxc))return k=Object.assign(new kw.a,{KG:this.key,contentObject:this.Gxc}),{returnValue:!0,RF:k};this.Gxc=null;if(!this.u3.hasBookmark)return{returnValue:!1,RF:k};const t=new ze.GraphIterator;t.set(this.u3.Bi());this.nn.bZc(t);if(this.nn.LEm(t)){let D=
t.Qd();for(;D;){if(this.nn.Vui(b,this.u3,D))return this.Gxc=D,k=Object.assign(new kw.a,{KG:this.key,contentObject:D,description:this.lhb()}),{returnValue:!0,RF:k};D=t.Rj()}}}return{returnValue:!1,RF:k}}lhb(){return null}}Object(n.a)(vA,"BookmarkDetailsProvider",null,[416,417]);class jp{constructor(b,k,t,D,P=null){this.o_g=this.Ah=!1;this.Wod=this.Bqd=null;this.jSi=(ca,ta)=>{ca=ta.node;1074135152!==ca.Pc?v.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",ca.Pc):(v.ULS.sendTraceTag(24155019,
324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.JVh(!0))};this.Tz=t;this.ri=D;this.qx=k;this.rMg=b;this.dS=P}get ax(){return this.qx.value}initialize(){this.a4f();this.Ah=!0}JVh(b=!1){if(!this.Ah)return v.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.o_g)return!0;let k=!1;this.ri.ie(()=>{this.Bqd={};this.Wod={};if(this.ax){const t=new ze.GraphIterator;t.set(this.ax);if(this.idn(t)){if(t.Rb(1)){do this.usk(t.currentNode);while(t.vf(1))
}k=this.o_g=!0}}},"BGM:EBGL");return k}tva(b){return this.JVh()?b in this.Wod?this.Wod[b]:null:null}dispose(){this.Ah?this.qPo():v.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}idn(b){if(this.Tz.eP(b))return(b=b.Rb(30))||v.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;v.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}a4f(){v.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.rMg.bqh(this.jSi)}qPo(){v.ULS.sendTraceTag(24691924,
324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.rMg.laj(this.jSi)}usk(b){var k,t,D,P;b?(this.boh(null!==(t=this.dS.Vdb.get(null===(k=b.id)||void 0===k?void 0:k.toString()))&&void 0!==t?t:X.a.nil,b),this.boh(null!==(P=this.dS.p1b.get(null===(D=b.id)||void 0===D?void 0:D.toString()))&&void 0!==P?P:X.a.nil,b),(k=b.properties.ia(Cc.a.jt,null))&&(this.Wod[k]=b)):v.ULS.sendTraceTag(24155022,324,50,"Node is null")}boh(b,k){b===X.a.nil?v.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=
b.toString(),b in this.Bqd||(this.Bqd[b]=new Eb.a),b=this.Bqd[b],b.contains(k)||b.add(k))}}Object(n.a)(jp,"BookmarkGraphManager",null,[260]);var Jv=c(800),CB=c(1109);class Ct{create(){return new CB.a}}Object(n.a)(Ct,"BookmarkContainerNodeFactory",null,[298]);class xz{constructor(b,k,t,D=null){this.zpn=(P,ca)=>{this.nn.bVi(ca)};this.ZUf=(P,ca)=>{var ta=this.jZh(ca.clone);P=ca.original.Kc;const Na=new cb.a;for(const qb of ta)ta=qb.hn.toString(),Na.nb(ta)||(Na.add(ta,!0),(ta=P.Db(qb.hn))&&!ta.anchor&&
(ta=this.nn.wDb(qb.hn)),ta?ta.anchor?this.l6k(ta,ca.clone):v.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",ta.id,ta.ia(Cc.a.Gzb,-1))):v.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.$Uf=(P,ca)=>{P=ca.clone;ca=this.jZh(P);this.nn.K3c(P,ca)};this.Yz=k;this.nn=t;this.BWj=D||new Ct}init(){Jv.a.kSn(Object(A.a)(this.nn,this.nn.gSf,"onAfterFullBookmarkRangeDeleted"));this.Yz.e_e(this.zpn);Av.a.d_e(this.ZUf);Av.a.Azd(this.$Uf)}jZh(b){const k=
new Eb.a;for(let t=0;t<b.pa.length;t++){const D=b.pa.J(t);if(D.Eh)for(let P=0;P<D.Eh.length;P++)k.add(D.Eh.J(P))}return k}l6k(b,k){var t=k.Bi().od;t=Pl.a(b,t,!0);k=ze.GraphIterator.$a(k);this.otl(k);k.Rb(30);k.X2(t,1,b.id);k.Gi(t)}otl(b){if(b.zb(25)&&b.hd(25)&&!b.Nr(30)){const k=this.BWj.create(1074135152);b.Hf(k,30)}}}Object(n.a)(xz,"BookmarksEventHandler",null,[]);var Dt=c(202),gu=c(249),My=c(447),Et=c(1164),wA=c(133),xA=c(1054);class Hu{create(){return new xA.a}}Object(n.a)(Hu,"BookmarkNodeFactory",
null,[298]);class ev{constructor(b,k){this.Daa=b;this.MWj=k}get iMb(){return this.MWj}}Object(n.a)(ev,"FoundBookmarkRangeObject",null,[297]);class yz{constructor(b,k,t,D,P,ca,ta,Na=null,qb,Jb=null){this.n2="_";this.uMg=40;this.xjk=" ";this.qx=b;this.Tz=k;this.Kd=t;this.pIe=D;this.Hc=P;this.eb=ca;this.ib=ta;this.LWj=Na||new Hu;this.dS=Jb}OOc(b,k){return b?this.dS.Vdb.get(null===k||void 0===k?void 0:k.toString()):this.dS.p1b.get(null===k||void 0===k?void 0:k.toString())}get ax(){return this.qx.value}get UIa(){return this.pIe.value}mYe(b,
k){if(!k||!k.Qa||!k.Qc)return v.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const t=k.Qa.node,D=k.Qc.node,P=Dt.a.mhb(k,!0);k=Dt.a.mhb(k,!1);return this.jDc(b,P,k,t,D)}jDc(b,k,t,D,P,ca=!1){v.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",ca));const ta=this.tva(b);if(ta)if(ca)this.c9i(ta);else return v.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!D||!P)return v.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),
!1;ca=this.Hc.Mc(15);ca.Cb(this.UIa);b=this.Ppk(b);if(!b)return!1;this.Lpk(D,k,b,P,t);ca.dispose();return!0}tva(b){v.ULS.shipAssertTag(34936482,3029,!!b);return this.mZh(k=>b===k.properties.ia(Cc.a.jt,null))}wDb(b){return b&&b!==X.a.nil?this.mZh(k=>b.equals(k.id)):(v.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}gSf(b){const k=this.wDb(b);k?(v.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),this.b9i(k),this.J3c(k)):
v.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}uva(b,k){var t;const D=null!==(t=this.OOc(k,b.id))&&void 0!==t?t:X.a.nil;if(D===X.a.nil)return v.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new ev(null,2);t=this.ax.od.Db(D);return t?t.isConnected?this.getBookmarkRange(t,b,k):(v.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new ev(null,3)):(v.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),
new ev(null,2))}bVi(b){const k=this.gCl(b);k[Symbol.iterator]().next().done||this.fdn(b,k)}K3c(b,k){const t=new Eb.a;let D=0,P=!1;for(const ca of k)ca&&ca.Ib.Eh?(D++,ca.Ib.Eh.remove(ca),0<=ca.re&&ca.re<b.ze.length&&(ca.Ib.cp||(P=!0),t.add(ca.re))):v.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.Npa(t);v.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",D,t.count));P&&!b.ze.length&&b.ze.append(gu.CharacterPropertiesEditor.HM,
1024)}ANd(b=!1){v.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",b);const k=new Eb.a,t=ze.GraphIterator.$a(this.ax);if(null!==this.bZc(t)){var D=t.xq();v.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",D);if(0<D)for(D=t.Qd();null!==D;){const P=D.ia(Cc.a.jt,"");F.a.jf(P)||(b?k.add(D):P.startsWith(this.n2)||k.add(D));D=t.Rj()}}!b&&0<k.count&&v.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",k.count);return k}bom(){return this.ax?this.t3k():!1}t3k(){v.ULS.sendTraceTag(524321506,
3029,50,"Finding bookmarks with includeHidden: {0}",!1);const b=ze.GraphIterator.$a(this.ax);if(null!==this.bZc(b)&&0<b.xq())for(var k=b.Qd();null!==k;){k=k.ia(Cc.a.jt,"");if(!F.a.jf(k)&&!k.startsWith(this.n2))return!0;k=b.Rj()}return!1}Fci(b){var k=this.tva(b);const t=new Eb.a;if(k){b=this.OOc(!0,k.id);k=this.OOc(!1,k.id);var D=this.ax.od.Db(b);D&&t.add(D);if(b.equals(k))return t;b=D;do(b=D=this.eb.ig(b,!1,!1,!0))&&t.add(D);while(D&&!D.id.equals(k))}else v.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",
b);return t}a9i(b){if(null===b)return v.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.wDb(b);return this.c9i(b)}sMl(b){let k="";const t=b.id;b=b.characterData.split(this.xjk);for(let D=0;3>D&&D<b.length;D++)k+=this.n2+b[D];k.length>this.uMg&&(k=k.substring(0,this.uMg));return this.YLj(k,t)}YLj(b,k){const t=this.ANd(!0),D=[];let P;for(let ta=0;ta<t.count;ta++){var ca=t.J(ta);P=ca.ia(Cc.a.jt,"");ca=this.OOc(!0,ca.id);P.startsWith(b)&&!k.equals(ca)&&D.push(P)}return 0<
D.length?(D.sort((ta,Na)=>ta.localeCompare(Na,void 0,{numeric:!0})),(k=D[D.length-1].substring(b.length+1))?b+this.n2+(parseInt(k)+1):b+this.n2+1):b}Hji(b){F.a.jf(b)?v.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(b=this.tva(b),null===b?v.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.uva(b,!0))?(b=Gf.SelectionFactory.te(b.Daa.paragraph,b.Daa.Ib.cp))&&this.ib.setSelection(b):v.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}c9i(b){if(!b)return v.ULS.sendTraceTag(559228888,
3029,15,"Could not find bookmark node with given id"),!1;v.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",b.id));const k=this.Hc.Mc(15);k.Cb(this.UIa);this.b9i(b);this.J3c(b);k.dispose();return!0}ROd(b,k){if(!b||0>k)return v.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;let t=null;const D=new Eb.a,P=new Eb.a;var ca=b.pa;for(var ta=0;ta<ca.length;ta++){var Na=ca.J(ta);if(Na.cp>k||Na.cp===k&&0<D.count)break;if(Na.Eh){var qb=
Na.Eh;if(2===qb.length&&qb.J(0).hn.equals(qb.J(1).hn)&&Na.cp===k){D.add(qb.J(0).hn.toString());break}for(let Jb=0,Vb=qb.length;Jb<Vb;Jb++){Na=qb.J(Jb);const ac=b.Kc.Db(Na.hn).ia(Cc.a.jt,"");F.a.jf(ac)||ac.startsWith(this.n2)||(Na.Nc?D.add(Na.hn.toString()):D.contains(Na.hn.toString())?D.remove(Na.hn.toString()):P.add(Na.hn.toString()))}}}0<D.count&&(t=b.Kc.Db(X.a.If(D.J(D.count-1))));if(!t)for(k=pe.ParagraphReader.ig(b,!0);k&&!t;){for(ca=0;ca<k.pa.length;ca++)if(ta=k.pa.J(ca),ta.Eh){ta=ta.Eh;for(let Jb=
0,Vb=ta.length;Jb<Vb;Jb++)qb=ta.J(Jb),Na=b.Kc.Db(qb.hn).ia(Cc.a.jt,""),F.a.jf(Na)||Na.startsWith(this.n2)||(qb.Nc?P.contains(qb.hn.toString())?P.remove(qb.hn.toString()):D.add(qb.hn.toString()):D.contains(qb.hn.toString())?D.remove(qb.hn.toString()):P.add(qb.hn.toString()))}0<D.count?t=k.Kc.Db(X.a.If(D.J(D.count-1))):k=pe.ParagraphReader.ig(k,!0)}return t}$Qo(b,k){if(null===b)return v.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.MEm(k)||this.Epl(k))return!1;const t=this.Hc.Mc(15);
t.Cb(this.UIa);this.ZQo(b,k);t.dispose();return!0}mZh(b){if(!this.ax)return v.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const k=new ze.GraphIterator;k.set(this.ax);if(!this.bZc(k))return v.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!k.Rb(1))return null;do{const t=k.currentNode;if(b(t))return t}while(k.vf(1));return null}getBookmarkRange(b,k,t){for(let D=0;D<b.pa.length;D++){const P=b.pa.J(D);if(P.Eh)for(let ca=0;ca<P.Eh.length;ca++){const ta=
P.Eh.J(ca);if(ta.hn.equals(k.id)&&t===ta.Nc)return new ev(ta,0)}}v.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,k.ia(Cc.a.Gzb,-1),t,k.id,b.pa.length,this.sM(b));return new ev(null,1)}bZc(b){if(this.Tz.eP(b))return b=b.Rb(30),v.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;v.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}gCl(b){const k=new cb.a;
for(let t=0;t<b.pa.length;t++){const D=b.pa.J(t);if(D.Eh)for(let P=0;P<D.Eh.length;P++){const ca=D.Eh.J(P),ta=ca.hn.toString();k.nb(ta)?(v.ULS.shipAssertTag(36218379,3029,ca.Nc!==k.J(ta).Nc),k.remove(ta)):k.add(ta,ca)}}return k.values}fdn(b,k){this.K3c(b,k);this.Kcn(b,k)}Kcn(b,k){let t=pe.ParagraphReader.ig(b,!1,!0);b=pe.ParagraphReader.ig(b,!0,!0);t||b?(t||this.Fwh(k,!0)&&v.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),b||
this.Fwh(k,!1)&&v.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),t=t||b,b=b||t,this.bOi(t,k,0,!0),this.bOi(b,k,b.pa.last.cp,!1)):v.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}Fwh(b,k){for(const t of b)if(k===t.Nc)return!0;return!1}bOi(b,k,t,D){const P=new Eb.a;t=this.Unf(b,t);for(const ca of k)ca.Nc===D&&(t?(k=this.Rpk(b,D,t,ca.hn))&&P.add(k):v.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",D));
P.count&&(b.Xl(),this.eng(b,P),v.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",P.count,D)))}Rpk(b,k,t,D){const P=this.wDb(D);return P?this.nYe(b,k,t,P):(v.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",D)),null)}nYe(b,k,t,D){var P;if(!D)return v.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!t)return v.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),
null;t.Eh||(t.Eh=new My.a(t));const ca=new Et.a(t,null,D.id,k);t.Eh.add(ca);(k?this.dS.Vdb:this.dS.p1b).set(null===(P=D.id)||void 0===P?void 0:P.toString(),b.id);return ca}eng(b,k){if(k){v.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",k.count);k.Sc((t,D)=>t.re-D.re);for(let t=0;t<k.count;t++){const D=k.J(t);D.re?b.ze.PX(D.re-1,1024):b.ze.Zna(D.re,1024);b.ze.iq.Z(D.re,gu.CharacterPropertiesEditor.HM);b.ze.Vs.Z(D.re,gu.CharacterPropertiesEditor.pR)}}else v.ULS.shipAssertTag(36218383,
3029,!1,"Null BookmarksToUpdate.")}Unf(b,k){if(!b||!b.pa||!b.pa.last)return null;v.ULS.shipAssertTag(36471766,3029,k<=b.pa.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.pa.last.cp===k){var t=b.pa.length-1;if(!b.pa.J(t).formatting)for(var D=t-1;0<=D;D--){var P=b.pa.J(D);if(P.formatting){this.Kd.LY(b,t,k,P.formatting);break}}return b.pa.last}t=null;for(D=0;D<b.pa.length;D++){P=b.pa.J(D);if(P.cp>=k){if(P.cp>k||!P.formatting)this.Kd.LY(b,D,k,t),P=b.pa.J(D);P.Eh||(P.Eh=new My.a(P));
v.ULS.shipAssertTag(36471768,3029,P!==b.pa.last);return P}P.formatting&&(t=P.formatting)}return null}Ppk(b){const k=new ze.GraphIterator;k.set(this.ax);if(!this.bZc(k))return v.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;b=this.O7k(b);k.X2(b,1,null);k.Gi(b);return b}O7k(b){const k=this.LWj.create(1074135153);k.setValue(Cc.a.jt,b);k.setValue(Cc.a.Gzb,Ne.a.vF());return k}J3c(b){if(b&&b.anchor){v.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",
b.ia(Cc.a.Gzb,-1),b.id);var k=new ze.GraphIterator;k.set(b);k.zb(64);k.wg()}}sM(b){const k=[];let t=0;for(;b.anchor.aq&&7!==b.type;)k[t]=wA.a[b.type],b=b.anchor.aq.xr.node,t++;k[t]=wA.a[b.type];return k.join(" ")}ZQo(b,k){b.setValue(Cc.a.jt,k)}b9i(b){const k=this.uva(b,!0).Daa;b=this.uva(b,!1).Daa;if(k&&b&&k.paragraph===b.paragraph){let t;this.K3c(k.paragraph,(t=new Eb.a,t.add(k),t.add(b),t))}else{if(k){let t;this.K3c(k.paragraph,(t=new Eb.a,t.add(k),t))}if(b){let t;this.K3c(b.paragraph,(t=new Eb.a,
t.add(b),t))}}}Lpk(b,k,t,D,P){if(k=this.nYe(b,!0,this.Unf(b,k),t)){b.Xl();var ca;this.eng(b,(ca=new Eb.a,ca.add(k),ca));(t=this.nYe(D,!1,this.Unf(D,P),t))?(D.Xl(),this.eng(b,(ca=new Eb.a,ca.add(t),ca))):v.ULS.sendTraceTag(520646733,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else v.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}Gci(b,k){var t;if(!b)return null;k=null!==(t=this.OOc(k,
b.id))&&void 0!==t?t:X.a.nil;return b.Kc.Db(k)?b.Kc.Db(k):null}LEm(b){return!!b&&64===b.We}NXf(b){var k;if(0===b.O9)return!1;for(let t=0;t<(null===(k=b.pa)||void 0===k?void 0:k.length);t++){const D=b.pa.J(t);if(null!=D.Eh)for(let P=0;P<D.Eh.length;P++){const ca=D.Eh.J(P),ta=b.Kc.Db(ca.hn).HOa();if(!F.a.jf(ta)&&!ta.startsWith(this.n2)&&ca.Nc)return!0}}return!1}j4h(b){var k;const t=[];if(0===b.O9)return t;for(let D=0;D<(null===(k=b.pa)||void 0===k?void 0:k.length);D++){const P=b.pa.J(D);if(null!=P.Eh)for(let ca=
0;ca<P.Eh.length;ca++){const ta=P.Eh.J(ca),Na=b.Kc.Db(ta.hn),qb=Na.HOa();F.a.jf(qb)||qb.startsWith(this.n2)||!ta.Nc||t.push(Na)}}return t}Pro(b){return b.ia(Cc.a.CG,!1)}MEm(b){return F.a.jf(b)?(v.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),!0):!1}Epl(b){return null!==this.tva(b)?(v.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}i4h(b,k,t){return this.getBookmarkRange(b,k,t).Daa}Vui(b,k,t){if(this.Pro(t)||this.UJm(t))return!1;
const D=this.Gci(t,!0),P=this.Gci(t,!1);if(D&&P&&this.eb.RUc(k,D,P)){if(k!==D&&k!==P)return!0;const ca=this.i4h(D,t,!0);if(ca&&(D!==k||ca.Ib.cp<=b)&&(t=this.i4h(P,t,!1))&&(P!==k||t.Ib.cp>=b))return!0}return!1}UJm(b){b=null===b||void 0===b?void 0:b.ia(Cc.a.jt,"");return!F.a.jf(b)&&b.startsWith(this.n2)?!0:!1}}Object(n.a)(yz,"FullBookmarkManager",null,[259]);class Zr{constructor(){this.Ate=this.Vp=this.W=null}get name(){return"WordEditor.Bookmark"}xc(b){this.W=b;this.Vp=this.W.resolve("Box4.INotebookManager").Bl;
const k=new yz(new Rg.a(()=>Wa.App.ya.gb.Uc),Wk.PageNavigator.instance,this.W.resolve("Box4.ICharacterPropertiesEditor"),new Rg.a(()=>Wa.App.ya.gb.wc.ed),tk.a.instance,this.W.resolve("Box4.IParagraphReader"),this.W.resolve("Box4.SelectionManager"),null,null,this.W.resolve("Box4.BookmarkParagraphMapping"));this.W.ha("WordEditor.Bookmark.FullBookmarkManager",()=>k).as("WordEditor.Bookmark.IBookmarkManager").singleInstance();this.W.ha("WordEditor.Bookmark.BookmarksEventHandler",()=>new xz(this.Vp.Ze(12),
this.W.resolve("WordEditor.ITableEditor"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).singleInstance();Yl.App.mKj&&(this.Ate=new jp(this.Vp.Ze(64),new Rg.a(()=>Wa.App.ya.gb.Uc),Wk.PageNavigator.instance,pr.a.instance,this.W.resolve("Box4.BookmarkParagraphMapping")),this.W.ha("WordEditor.Bookmark.BookmarkGraphManager",()=>this.Ate).as("WordEditor.Bookmark.IBookmarkGraphManager").singleInstance())}init(){this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>{this.fn()})}dispose(){this.Ate.dispose()}fn(){v.ULS.sendTraceTag(36209186,
324,50,"Registering paragraph events");this.W.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();v.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.qSn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("WordEditor.Bookmark.FullBookmarkManager"))}qSn(b,k){b&&b.execute(t=>{t.Q4(new vA(k))})}static main(){N.a.instance.Fc(new Zr)}}Object(n.a)(Zr,"BookmarkPackage",null,[1,2]);var fv=c(870),oC=c(1045),yA=c(1529),Iu=c(1391);class zA extends Iu.a{constructor(b){super();
this.vmk=b}get index(){return 3}run(){this.vmk()}IJ(){this.pY()}}Object(n.a)(zA,"FootnoteEndnoteGraphUpdateTracker",Iu.a,[]);class AA{constructor(){this.Hjd=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}xc(){}init(){AA.Xb.Mp.continueWith(()=>{this.fn()})}fn(){fv.a.Kgb=yA.a.instance;this.Txf()}dispose(){}Txf(){this.Hjd=new zA(()=>{yA.a.instance.Nu()});oC.a.xce(Object(A.a)(this.Hjd,this.Hjd.IJ,"setUpdateNeeded"));Eq.GraphTransactionManager.instance.aqa(this.Hjd,3)}static get Xb(){return Fa.a.instance.resolve("Box4.IFeatureHelper")}}
Object(n.a)(AA,"PackageManager",null,[1,2]);var zz=c(759),Az=c(200),pi=c(528),Yk=c(467),Fr=c(1632);class bg extends cx{constructor(){super()}get Pw(){return null}getTitle(b){b=b.qna();if(!b||!pi.a.instance.koa(b))return"";const k=new Sys.StringBuilder,t=pi.a.instance.P3(b);k.append(1===t?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);k.append(" ");k.append(pi.a.instance.r7b(b));return k.toString()}}Object(n.a)(bg,"FootnoteEndnoteBaseDetailsProvider",
cx,[]);class pC extends bg{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get Dh(){return 7}}Object(n.a)(pC,"FootnoteEndnoteDetailsProvider",bg,[]);var Kv=c(1582),Ny=c(1602),DB=c(1675);class EB extends bg{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get Dh(){return 10}}Object(n.a)(EB,"FootnoteEndnoteRefMarkDetailsProvider",bg,[]);class ox{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed,sd,oe,Ld){this.cri=(Od,ie,Ce,hg,Kg)=>{hg=ie.view;if(!hg.features.cke||this.oD.Qui)return 8;
const Hl=hg.mb.sg;if(!Hl)return 2;if(this.Ik.i_(Hl))return 8;hg=Od===Nc.a.insertFootnote?1:0;var wm=this.ZNd(ie);if(!wm)return v.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;ie=!0;wm=wm.Qa;Kg&&Kg.jbc&&Kg.lFa&&(wm=Kg.lFa,ie=!Kg.keepCurrentFocus);if(1===Ce&&Pk.a.fha(Hl)||!wm||!hf.SelectionEditor.gf(wm)||this.rPg.instance&&this.rPg.instance.hLm(wm)||re.HyperlinkReader.Bwa(wm,!0))return 8;if(1===Ce)return 32;2===Ce&&(Ce=this.XS.Zf("UserAction","InsertFootnoteEndnote"),Od=this.z2j.lAm(wm,
hg,Od),Kg&&Kg.jbc&&(Kg.sQi=Od),ie&&this.t8d(Od,!0,!0),Ce.stop(),this.Ud.Js(6));return 32};this.Tdc=(Od,ie,Ce)=>{const hg=ie.view;if(Od===Nc.a.I6a||Od===Nc.a.Kob){if(!hg.features.cke)return 8}else if(!hg.features.Ygg)return 8;if(!hg.mb.sg)return 2;ie=this.p8b(ie);return ie?Od!==Nc.a.I6a&&Od!==Nc.a.Kob||this.sKa.xom(ie.node,Od===Nc.a.I6a?1:0)?1===Ce?32:2===Ce&&32===this.ga.Qb(Nc.a.y3,2,!0)?(this.ga.Qb(Nc.a.dQf,2,Od),32):8:8:2};this.zFl=(Od,ie,Ce,hg,Kg)=>{if(1===Ce)return 32;if(2===Ce){Od=this.lam(ie);
if(!Od)return 8;Ce=ie=null;switch(Kg){case Nc.a.O4d:Ce=Od.Qc;ie=this.QUb.$Sd(Ce,1);break;case Nc.a.N4d:Ce=Od.Qc;ie=this.QUb.$Sd(Ce,0);break;case Nc.a.Q4d:Ce=Od.Qa;ie=this.QUb.Vji(Ce,1);break;case Nc.a.P4d:Ce=Od.Qa;ie=this.QUb.Vji(Ce,0);break;case Nc.a.I6a:Ce=Od.Qa;(ie=this.QUb.$Sd(Ce,1,!0))||(ie=this.sKa.l8h(Ce.node,1));break;case Nc.a.Kob:Ce=Od.Qa,(ie=this.QUb.$Sd(Ce,0,!0))||(ie=this.sKa.l8h(Ce.node,0))}if(ie)this.t8d(ie);else{if(!this.Mt.wc)return 8;(Kg=Oi.d(Ce.node,Ce.cpBegin))&&7===Kg.Dh&&this.sKa.Zgj(Kg)}}return 32};
this.auo=(Od,ie,Ce,hg,Kg)=>1===Ce?32:2===Ce?(v.ULS.shipAssertTag(4520066,308,!!Kg),v.ULS.shipAssertTag(4520067,308,!!Kg.$Za),Od=Kg.$Za,v.ULS.shipAssertTag(4520068,308,this.tE.koa(Od)),this.t8d(Od,Kg.Ahe)?32:8):32;this.buo=(Od,ie,Ce,hg,Kg)=>{if(1===Ce)return 32;2===Ce&&(Od=Kg.footnoteEndnoteNode,Kg=Kg.CFl)&&(this.Yra.y5b(),ie=this.tE.wjb(Od),Kg.title=this.tE.lWl(Od)+(ie?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};
this.E4a=(Od,ie,Ce,hg,Kg)=>2===Ce?(v.ULS.shipAssertTag(4520069,308,!!Kg),v.ULS.shipAssertTag(4520070,308,!!Kg.$Za),v.ULS.shipAssertTag(4520071,308,pe.ParagraphReader.Wb(Kg.$Za)),Od=this.tE.W0a(Kg.$Za),this.t8d(Od,Kg.Ahe)?32:8):32;this.igo=(Od,ie,Ce)=>{2===Ce&&this.oD.FY();return 32};this.Pml=(Od,ie,Ce,hg,Kg)=>{if(1===Ce)return 32;if(2===Ce)return void 0!==Kg&&null!==Kg?this.oD.Nef(Kg,Kg):this.oD.Nef(),32;v.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};
this.wWm=(Od,ie,Ce)=>{Od=this.p8b(ie);return Od&&hf.SelectionEditor.gf(Od)?1===Ce?32:2===Ce?(Ce=0<this.Uo.O3(Od.node).Ft,this.oD.caf(),this.oD.dialog.kib=Ce,32):8:(v.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.xFl=(Od,ie,Ce)=>1===Ce?32:2===Ce?(this.oD.dialog.kib=!1,32):8;this.mJn=(Od,ie,Ce,hg,Kg)=>this.P0h(Od,Ce,Kg);this.kJn=(Od,ie,Ce,hg,Kg)=>1===Ce?32:this.oD.dialog&&this.oD.dialog.fontName?(Kg[Vl.a.Value]=this.oD.dialog.fontName,32):this.TZj.kOa(Pb.a.SLb.toString(),
Kg,null)?32:8;this.wFl=(Od,ie,Ce)=>1===Ce?32:2===Ce?(this.oD.dialog.kib=!0,32):8;this.lJn=(Od,ie,Ce,hg,Kg)=>this.P0h(Od,Ce,Kg);this.uFl=(Od,ie,Ce)=>{if(1===Ce)return 32;if(2===Ce){Od=this.p8b(ie);if(!Od)return v.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;ie=this.tE.W0a(Od.node);this.tE.koa(ie)&&(Ce=this.Hc.Mc(15),Ce.Cb(ie),this.HEj(Od),this.sKa.kth(ie,this.oD.dialog),Ce.dispose());this.oD.M4c();return 32}return 8};this.tFl=(Od,ie,Ce)=>{if(1===Ce)return 32;if(2===Ce){Od=
this.p8b(ie);if(!Od)return v.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;ie=this.tE.W0a(Od.node);this.tE.koa(ie)&&(Ce=this.Hc.Mc(15),Ce.Cb(ie),this.HEj(Od),this.sKa.kDk(ie,this.oD.dialog),Ce.dispose());this.oD.M4c();return 32}return 8};this.vFl=(Od,ie,Ce)=>1===Ce?32:2===Ce?(this.oD.M4c(),32):8;this.rFl=(Od,ie,Ce,hg,Kg)=>{if(1===Ce)return 32;if(2===Ce){Od=Object(Ka.a)(21,Kg);if(!Od||!Od.vd)return 8;this.oD.dialog.fontName=Od.vd.fontName;return 32}return 8};this.sFl=(Od,
ie,Ce,hg,Kg)=>{if(1===Ce)return 32;if(2===Ce){Od=Object(Ka.a)(21,Kg);if(!Od||!Od.vd)return 8;this.oD.dialog.PUb=Od.vd;return 32}return 8};this.ga=b;this.Mt=k;this.TZj=t;this.fd=D;this.tE=P;this.z2j=ca;this.sKa=ta;this.Yra=Na;this.oD=qb;this.Uo=Jb;this.QUb=Vb;this.Hc=ac;this.Ik=yc;this.Hb=Kc;this.XS=ed;this.Ud=sd;this.LTj=oe;this.rPg=Ld}HEj(b){(b=Je.FormattingReader.Kr(b))?(this.oD.dialog.fontName||(this.oD.dialog.fontName=b.cache.rG),-1===this.oD.dialog.fontSize&&(this.oD.dialog.PUb=b.cache.fontSize)):
v.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}P0h(b,k,t){return 1===k&&this.oD.dialog?32:2===k&&this.oD.dialog?(t[Mi.a.On]=b===Nc.a.y1f?this.oD.dialog.kib:!this.oD.dialog.kib,32):8}Tb(){var b;(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.PageViewFootnoteEndnoteNavigationBugFix",!1))&&Wa.App.instance.poi([Nc.a.O4d,Nc.a.N4d,Nc.a.Q4d,Nc.a.P4d,Nc.a.dQf,Nc.a.I6a,Nc.a.Kob,Nc.a.y3]);this.ga.fb(Nc.a.insertFootnote,
lc.a.view,this.cri,4);this.ga.fb(Nc.a.insertEndnote,lc.a.view,this.cri,4);this.ga.qa(Nc.a.O4d,lc.a.view,this.Tdc);this.ga.qa(Nc.a.dQf,lc.a.view,this.zFl);this.ga.qa(Nc.a.N4d,lc.a.view,this.Tdc);this.ga.qa(Nc.a.Q4d,lc.a.view,this.Tdc);this.ga.qa(Nc.a.P4d,lc.a.view,this.Tdc);this.ga.qa(Nc.a.I6a,lc.a.view,this.Tdc);this.ga.qa(Nc.a.Kob,lc.a.view,this.Tdc);this.ga.qa(Nc.a.Oqj,lc.a.view,this.auo);this.ga.fb(Nc.a.N0h,lc.a.view,this.wFl,4);this.ga.fb(Nc.a.y1f,lc.a.view,this.lJn,100);this.ga.fb(Nc.a.O0h,lc.a.view,
this.xFl,4);this.ga.fb(Nc.a.h4i,lc.a.view,this.mJn,100);this.ga.qa(Nc.a.Pqj,lc.a.view,this.buo);this.ga.fb(Nc.a.E4a,lc.a.view,this.E4a,96);this.ga.fb(Nc.a.OMd,lc.a.view,this.igo,96);this.ga.qa(Nc.a.y3,lc.a.view,this.Pml);this.ga.fb(Nc.a.tEi,lc.a.view,this.wWm,4);this.ga.fb(Nc.a.K0h,lc.a.view,this.uFl,4);this.ga.fb(Nc.a.L0h,lc.a.view,this.tFl,4);this.ga.fb(Nc.a.M0h,lc.a.view,this.vFl,4);this.ga.fb(Nc.a.MMd,lc.a.view,this.rFl,4);this.ga.fb(Nc.a.g4i,lc.a.view,this.kJn,100);this.ga.fb(Nc.a.NMd,lc.a.view,
this.sFl,4);this.ga.fb(Nc.a.q1c,lc.a.view,ox.q1c,100);this.ga.fb(Nc.a.r1c,lc.a.view,ox.r1c,100)}U3f(){this.LTj.execute(b=>{b.Q4(new pC);b.Q4(new EB)})}p8b(b){b=this.ZNd(b);return b?b.Qa:(v.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}ZNd(b){let k=null;b=b.view;if(!b)return v.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),k;b=b.mb;if(!b)return v.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),k;b=b.hb;if(!b||
!b.length)return v.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),k;b=b.J(0);if(!b)return v.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),k;(k=hf.SelectionEditor.Cj(b,!1,!1))||v.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return k}lam(b){return(b=b.view)?b.mb.hb.J(0):null}t8d(b,k=!0,t=!1){if(b){this.Yra.y5b();var D=b.cna;if(D){var P=D.Ib,ca=Gf.SelectionFactory.GK(P.paragraph,P.cp,P.cp+1);P=this.Mt.wc;
if(!P)return!1;this.fd.Yca(P,ca);P.Onb=150;P.W4();b=new Yk.a(b,k);ca=Az.a.z7b(D,P);D=D.Lva(P,ca);if(!D)return v.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;t||D.element?this.oD.Pdg(b):(this.oD.Pdg(new Yk.a(b.$Za,!1)),k&&(k=new Df.a(2,1,10,()=>{this.oD.FY()}),this.Hb.Vb(k)));return!0}}return!1}static cWl(){return new ox(w.AFrameworkApplication.va,Wa.App.ya.gb,Fa.a.instance.resolve("Box4.IGeneralCuiUser"),Lb.InteractiveViewManager.instance,pi.a.instance,Ny.a.instance,Kv.a.instance,
yA.a.instance,Fr.FootnoteEndnoteControlManager.instance,Fa.a.instance.resolve("Box4.IParagraphIndentationReader"),DB.a.instance,new tk.a,Yj.a.instance,wb.a.instance,w.AFrameworkApplication.ta.Fq,Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Fa.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager"),Fa.a.instance.Sa("Box4.IContentControlReader"))}static bWl(){return ox.cWl()}static q1c(b,k,t,D,P){if(1===t)return 32;if(2===t&&!P)return 8;bd.a.iWd(k);P.PopulationXML=
uq.FontUtils.p2h(bd.a.Rhe,bd.a.Hlf,Nc.a.MMd);return 32}static r1c(b,k,t,D,P){if(1===t)return 32;if(2===t&&!P)return 8;P.PopulationXML=uq.FontUtils.q2h(Nc.a.NMd);return 32}}Object(n.a)(ox,"FootnoteEndnoteActor",null,[357]);class gv extends Iu.a{constructor(b){super();this.bWe=b}get index(){return 1}run(){this.bWe()}IJ(){this.pY()}}Object(n.a)(gv,"FootnoteEndnoteControlUpdateTracker",Iu.a,[]);var Bz=c(350);class Cz extends Bz.a{constructor(b,k,t,D,P,ca,ta,Na){super(b,k,t,D);this.Us=()=>{this.zad(this.Bb)};
this.jI=b.container;this.Qv=document.createElement("div");b.container.appendChild(this.Qv);this.LG(this.Qv);this.egk=P;this.xo.execute(qb=>{qb.I0(this.Us)});this.wKa=ca;this.mK=ta;this.tI=Na;this.wKa.execute(qb=>{qb.jcg(this.oc,this.jI)});this.tI&&(this.jI.style.backgroundColor=this.mK.V7b())}dispose(){super.dispose();this.xo.instance&&this.xo.instance.E5a(this.Us)}get xo(){return null!=this.eAg?this.eAg:this.eAg=Fa.a.instance.Sa("Common.IZoomManager")}$B(b){this.jI.classList.add("FootnoteEndnoteViewElement");
this.zad(b.currentNode)}zad(b){this.xo.instance&&(this.xo.instance.hcd(this.Qv),this.Qv.style.width=Math.round(100/this.xo.instance.ij)+"%");this.egk(b)}}Object(n.a)(Cz,"FootnoteEndnoteViewElement",Bz.a,[]);class $r{constructor(){this._initialized=!1;this.dgd=this.KAe=this.W=null;this.EFl=(b,k,t,D)=>b.Q2a?new Cz(b,k,t,D,P=>{Fr.FootnoteEndnoteControlManager.instance.E2n(P)},this.W.Sa("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),
!!Wa.App.instance&&Wa.App.instance.RC):null}get name(){return"WordEditor.FootnoteEndnote"}xc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>{this.fn()})}fn(){Vr.WordSectionNavigator.instance.gQf=Object(A.a)(Kv.a.instance,Kv.a.instance.aen,"navigateToWordSectionNodeWithFootnoteEndnote");zz.a.Zbg(this.EFl);Fr.FootnoteEndnoteControlManager.instance.bind(Wa.App.ya.jD);this.KAe=ox.bWl();this.KAe.Tb();this.KAe.U3f();Wa.App.ya.updateCommandUI();this.Txf();this._initialized=
!0}dispose(){this._initialized&&(this._initialized=!1,Fr.FootnoteEndnoteControlManager.instance.dispose())}Txf(){this.dgd=new gv(()=>{Fr.FootnoteEndnoteControlManager.instance.Aad()});oC.a.xce(Object(A.a)(this.dgd,this.dgd.IJ,"setUpdateNeeded"));Eq.GraphTransactionManager.instance.aqa(this.dgd,3)}}Object(n.a)($r,"PackageManager",null,[1,2]);class qC{constructor(b,k,t,D){this.ib=k;this.iea=D}get bookmarkManager(){return this.iea.value}ZKm(b){return Yl.App.mKj?b.startsWith(F.a.Sdb):!1}Jlm(b){try{this.Klm(b)}catch(k){v.ULS.sendTraceTag(24691935,
324,10,String.format("Error parsing bookmark url. Error: {0}",k.message))}}wkg(b){return{returnValue:!1,y4f:b,lDb:""}}Klm(b){if(this.bookmarkManager){b=b.split("/");var k=this.bookmarkManager.tva(b[b.length-1]);k&&k.anchor?(b=this.bookmarkManager.uva(k,!0).Daa,k=this.bookmarkManager.uva(k,!1).Daa,b||k?b?this.bmj(b):(v.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.bmj(k)):(v.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.mDi(!1))):(v.ULS.sendTraceTag(35992275,
324,15,"Cannot find bookmark node"),this.mDi(!0))}}mDi(b){b=Gf.SelectionFactory.fo(Wa.App.ya.gb.Uc.zof(),b);this.ib.setSelection(b)}bmj(b){b.paragraph&&b.Ib?(b=Gf.SelectionFactory.te(b.paragraph,b.Ib.cp),b.Zti=!0,this.ib.setSelection(b)):v.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(n.a)(qC,"InternalLinkManager",null,[257]);class Dz{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}xc(b){b.ha("WordEditor.InternalLinks.InternalLinkManager",
()=>new qC(new Rg.a(()=>b.Na("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IFeatureHelper"),new Rg.a(()=>b.Na("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").singleInstance()}static main(){N.a.instance.Fc(new Dz)}}Object(n.a)(Dz,"WordEditorInternalLinksPackage",null,[1,2]);class hu{constructor(b){this.$Ka=null;this.checkAndDeleteEphemeralOutline=k=>{k=k.customData;if(k.anchor){Hj.a.mark(4763);
var t=ze.GraphIterator.$a(k);if(t.zb(8)&&t.hd(8)&&t.zBj(k)===k){if(Xh.OutlineReader.isEmpty(t)){let D=!1;for(let P=0;P<af.a.instance.hb.length;P++){const ca=af.a.instance.hb.J(P);for(let ta=0;ta<ca.length;ta++)if(ca.J(ta).node===k){D=!0;break}}D||this.VPh(t)}Hj.a.mark(4764)}}};hu.lK=b}KGd(b){if(!hu.lf.CZd(b))return null;b.Rb(1)&&(b.currentNode.Tk(8,!0),b.uc());const k=hu.lK.Zal();hu.lf.isRtl(b.currentNode)?k.setValue(sf.a.Zq,11):k.setValue(sf.a.Zq,9);b.Hf(k,1);b.Gi(k);return k}Gho(b){if(this.$Ka&&
b!==this.$Ka){const k=new Df.a(2,1,0,this.checkAndDeleteEphemeralOutline,120);k.customData=this.$Ka;w.AFrameworkApplication.nc.Vb(k)}this.$Ka=b}VPh(b){this.$Ka===b.currentNode&&(this.$Ka=null);const k=new Xd.GraphTransaction(7);k.hu(b);b.wg();k.dispose()}lDh(){if(this.$Ka&&this.$Ka.anchor){const b=ze.GraphIterator.$a(this.$Ka);b.Dp()&&Xh.OutlineReader.LTc(b)&&this.VPh(b);this.$Ka=null}}static get lf(){return Yg.PageReader.instance}}hu.lK=null;Object(n.a)(hu,"PageContentEditor",null,[1249]);var dy=
c(1160),hv=c(633);class BA extends Nx{constructor(){super()}npj(b,k,t,D,P){let ca=!1,ta=!0;hf.SelectionEditor.gf(P)&&(k=dg.ListItemReader.sh(b)&&k,P=va.OutlineElementReader.wA(b,P,!1)&&!va.OutlineElementReader.wA(b,P,!0),k&&t.t5e(b,D)&&(ca=!0),Wa.App.rd.Yo&&(P||k&&!ca)&&(ta=!1));return{mpj:ta,JJj:ca}}}Object(n.a)(BA,"CursorMoveValidator",Nx,[]);class Rn{constructor(b,k,t,D,P){this.Ix=P;this.LMe=b;this.l6=D;this.Wra=k;this.nh=t}get Ld(){return null!=this.aIg?this.aIg:this.aIg=Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=
this.LHg?this.LHg:this.LHg=Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get sc(){return null!=this.CJg?this.CJg:this.CJg=Fa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Ns(){return this.l6.value}get lg(){return this.nh.value}get wq(){return this.Wra}Gjm(b){const k=window.performance.now(),t=new tp.ScriptSharpLegacyMap,D=new Ij.a,P=new tp.ScriptSharpLegacyMap;if(b&&b.Ww){var ca=null;for(let ta=0;ta<b.length;ta++){const Na=b.getContext(ta);ca=ca||Rn.fh.Ts(Na.node);
let qb;if(!({groupId:qb}=this.kMo(Na.node,ca)).returnValue)continue;let Jb;t.nb(qb)||(Jb=[],t.add(qb,Jb));Jb=t.J(qb);Jb.push(Na)}for(const ta of Xl.toArray(t.keys))b=t.J(ta),ca=new ze.GraphIterator,ca.set(b[0].node),({ndj:b,$t:ca}=this.Wra.ILo(ca)).returnValue?(t.Z(ta,b),P.add(ta,ca)):D.add(ta)}v.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-k));return{returnValue:t,Jjm:D,Ijm:P}}bAb(b){return this.IRk(b)}S1b(b){return this.hRk(b)}vCd(b,
k,t=!0){return ze.GraphIterator.dba(()=>{var D=!1;if(dg.ListItemReader.sh(b))return this.t5e(b,k,t);D||(ag.OutlineElementNavigator.Ge(b),D=pe.ParagraphReader.uh(b)||Ih.TableReader.isTable(b),ag.OutlineElementNavigator.Vd(b),D=D&&this.GRk(b,k));return D})}t5e(b,k,t=!0){return ze.GraphIterator.dba(()=>{const D=va.OutlineElementReader.oEa(b),P=Xh.OutlineReader.rX(b.currentNode);if(t?!this.yMm(b,k):!this.zMm(b,k))return!1;var ca=ze.GraphIterator.$a(b.currentNode);if(0<k&&ca.zb(14)){ca.hd(16);var ta=ca.currentNode;
const Na=yh.TableCellReader.puf(ca);ca.hd(14);const qb=ca.currentNode;ca=Qn.a.vM(ta,qb,Cc.a.qP,Cc.a.za,0);ta=Qn.a.vM(ta,qb,Cc.a.KR,Cc.a.Aa,0);ca=Re.a.Ay(ca,0);ta=Re.a.Ay(ta,0);return D+P<Na-ca-ta}return!0})}GRk(b,k){const t=va.OutlineElementReader.oEa(b);var D=va.OutlineElementReader.vG(b);if(0<k){k=Xh.OutlineReader.rX(b.currentNode);D=0;const {Ao:Na,marginLeft:qb,marginRight:Jb}=Rn.LQd(b.currentNode);var P=ze.GraphIterator.$a(b.currentNode);ag.OutlineElementNavigator.Ge(b);if(Ih.TableReader.isTable(b)){D=
Ih.TableReader.tga(b);var ca=0;for(var ta of D)ca+=ta;D=Re.a.Ay(Re.a.xf(ca,0),0)}ag.OutlineElementNavigator.Vd(b);return P.zb(14)?(P.hd(16),ta=P.currentNode,b=yh.TableCellReader.puf(P),P.hd(14),ca=P.currentNode,P=Qn.a.vM(ta,ca,Cc.a.qP,Cc.a.za,0),ta=Qn.a.vM(ta,ca,Cc.a.KR,Cc.a.Aa,0),P=Re.a.Ay(P,0),ta=Re.a.Ay(ta,0),t+k<b-P-ta-D):t+k<Na-qb-Jb-D}return 0<t-D}VRa(b,k){this.DYi(b,-1*Math.abs(k))}ZIc(b,k){this.DYi(b,Math.abs(k))}Ikl(b,k,t,D,P){let ca=Rn.wNi;if(k>=Rn.wNi){ca=k-=t;const ta=D*P,Na=Math.abs(ta),
qb=Math.abs(k)%Na;qb&&(ca=0>ca?0>D?ca+qb:ca-(Na-qb):0<D?ca-qb:ca+(Na-qb));ca+=ta;ca+=t;Rn.l9d&&(t=va.OutlineElementReader.O3(b),ca=Rn.l9d.p5h(b.currentNode,k+t,ca+t,P,ca<k)-t)}return ca}ERk(b,k,t){if(!b||!b.length)return!1;k=t?k?-1:1:this.b7h(b[0].node,k);return this.FRk(b,k,t)}Yvn(b,k,t){if(!b)return v.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return v.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),
8;if(!t)return v.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!t.length)return v.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),8;const D=b[0].node;k=this.b7h(D,k);if(!this.qcn(D,t[0],k)||!this.ncn(b,k))return 8;this.Ns.Y9();return 32}ncn(b,k){for(let t=0;t<b.length;t++){const D=new ze.GraphIterator;D.set(b[t].node);let P=null;ag.OutlineElementNavigator.Ge(D);if(pe.ParagraphReader.uh(D)){if(P=D.currentNode,
!P)return v.ULS.shipAssertTag(589592461,338,!P,"The paraNode is null for the list OE node"),!1}else if(!pe.ParagraphReader.uh(D)&&!Ih.TableReader.isTable(D))return v.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;D.uc();if(P){if(this.Eom(P)){const ca=P.LD(),ta=va.OutlineElementReader.oEa(D);this.lg.Bya(D,1,ta+k);ca&&this.lj.YU(P,ca,this.Ld.qg)}wl.a.getInstance().Yt||P.setValue(sf.a.dR,new Date)}}return!0}qcn(b,k,t){for(let D=0;D<Wg.a.Hha;D++){const P=
this.Wra.Dx(b,k,D);if(!P)return v.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",k),!1;const ca=P.getValue(Cc.a.$d);ca&&P.setValue(Cc.a.$d,ca+t)}return!0}Eom(b){return b.hasProperty(Cc.a.$d)||b.hasProperty(Cc.a.Ws)||b.hasProperty(Cc.a.GA)}hRk(b){return this.vCd(b,1,!0)}IRk(b){return this.vCd(b,-1,!0)}b7h(b,k){var t=new ze.GraphIterator;t.set(b);const D=va.OutlineElementReader.oEa(t),P=va.OutlineElementReader.vG(t),ca=va.OutlineElementReader.O3(t);t=Xh.OutlineReader.rX(b);
Rn.LQd(b);b=(P?D-P:ca)%t;return k?-1*(b?b:t):t-b>Rn.UOh?Rn.UOh:t-b}kMo(b,k){let t;const D=new ze.GraphIterator;D.set(b);b=D.Rb(4).getValue(Cc.a.listID);return({id:t}=this.Wra.Qlc(b,k)).returnValue?{returnValue:!0,groupId:t}:{returnValue:!1,groupId:t}}FRk(b,k,t){var D=!1;for(let P=0;P<b.length;P++){D=b[P];const ca=new ze.GraphIterator;ca.set(D.node);hf.SelectionEditor.ku(ca);if(!va.OutlineElementReader.Bh(ca))return Rn.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.Jfb}),!1;if(this.vCd(ca,k,t))D=!0;else return Rn.Ic.Yb(Pe.a.K4b,
{["Reason"]:He.a.L5e}),!1}return D}DYi(b,k){if(this.vCd(b,k,!0)){var t=!1;if(dg.ListItemReader.sh(b)){var D=new ze.GraphIterator;D.Yc(b);this.wq.nR(D);var P=D.currentNode;D.uc();t=!0;const {listId:ta,listLevel:Na}=dg.ListItemReader.hQd(b);var ca=this.Wbm(ta,Na+k);if(ca)ag.OutlineElementNavigator.Ge(D),pe.ParagraphReader.uh(D)&&Rn.XG.HJ(ca,D.currentNode,!1),D.uc();else{ca=null;let qb;ag.OutlineElementNavigator.Ge(D);pe.ParagraphReader.uh(D)&&(ca=D.currentNode);D.uc();qb=ca?ca.LD():null;ca||(ag.OutlineElementNavigator.Ge(D),
pe.ParagraphReader.uh(D)&&(ca=D.currentNode),D.uc());ca&&(ca.hasProperty(Cc.a.$d)&&ca.removeProperty(Cc.a.$d),ca.hasProperty(Cc.a.Ws)&&ca.removeProperty(Cc.a.Ws));wl.a.getInstance().DB||this.Ix.P7a(P,Na+k);wl.a.getInstance().Yt&&this.Ix.P7a(ca,Na+k);wl.a.getInstance().DB||P.removeProperty(Cc.a.e0);ca&&qb&&(this.lj.YU(ca,qb,this.Ld.qg),this.Ns.Y9());this.FDo(b,P)}}t||(t=va.OutlineElementReader.oEa(b),D=va.OutlineElementReader.vG(b),P=Xh.OutlineReader.rX(b.currentNode),k=this.Ikl(b,t,D,k,P),this.lg.Bya(b,
1,k))}}zMm(b,k){const t=va.OutlineElementReader.oEa(b),D=va.OutlineElementReader.vG(b),P=va.OutlineElementReader.O3(b),{Ao:ca,marginLeft:ta,marginRight:Na}=Rn.LQd(b.currentNode);if(0<k){if(b=ca-ta-Na,P&&P+k+Wa.App.uza>b||t+k+Wa.App.uza>b)return!1}else if(P&&0>t+k||0>t-D+k)return!1;return!0}yMm(b,k){var t=this.Ns.tB(b);const D=t.level+k;if(Yw.a.XVm<D||D<Yw.a.eDl)return!1;t=this.wq.Dx(b.currentNode,t.listID,D);if(!t)return v.ULS.shipAssertTag(590700875,338,!!t),!1;if(0<k&&t.hasProperty(Cc.a.$d)){k=
t.getValue(Cc.a.$d);const {Ao:P,marginLeft:ca,marginRight:ta}=Rn.LQd(b.currentNode);if(k+Wa.App.uza>P-ca-ta)return!1}return!0}Wbm(b,k){const t=this.sc.Mr();for(let D=0;D<t.hO;D++){const P=t.AEa(D);if(this.wq.bCb(P)&&P.ia(Cc.a.listID,this.Ns.J8+1)===b&&P.ia(Cc.a.listLevel,-1)===k)return P}return null}FDo(b,k){ag.OutlineElementNavigator.Ge(b);if(pe.ParagraphReader.uh(b)&&b.currentNode.hasProperty(Cc.a.$d)&&(k=this.wq.F7b(k))){if(k.hasProperty(Cc.a.Ws)){var t=k.getValue(Cc.a.Ws);this.LMe.gob(b.currentNode,
t)}k.hasProperty(Cc.a.$d)&&(t=k.getValue(Cc.a.$d),this.LMe.Bya(b,1,t));k.hasProperty(Cc.a.GA)&&(k=k.getValue(Cc.a.GA),this.LMe.Tca(b.currentNode,k))}ag.OutlineElementNavigator.Vd(b)}static get XG(){return null!=Rn.cJg?Rn.cJg:Rn.cJg=Fa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get l9d(){return null!=Rn.kFg?Rn.kFg:Rn.kFg=Fa.a.instance.Na("WordEditor.ParagraphIndentationUtility")}static get paragraphEditor(){return Rn.Is||(Rn.Is=Fa.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(b){Rn.Is=
b}static get Ic(){return Hi.a.instance}static get Sf(){return xn.a.instance}static get fh(){return Wk.PageNavigator.instance}static LQd(b){var k=Vr.WordSectionNavigator.instance.wJ(b);b=Rn.Sf.Vt(k);const t=Rn.Sf.gJ(k);k=Rn.Sf.VK(k);return{Ao:b,marginLeft:t,marginRight:k}}}Rn.UOh=Ef.a.Dv(.25);Rn.Is=null;Rn.wNi=Ef.a.Dv(-11);Object(n.a)(Rn,"OutlineElementIndentationEditor",null,[255,256]);var px=c(213),qx;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=
3]="table"})(qx||(qx={}));Object(n.b)("StyleTargetType",qx);var CA=c(214);class iv{constructor(b,k){this.zW=null;this.iK=k;this.Gf=b}get paragraphEditor(){return null!=this.TEg?this.TEg:this.TEg=Fa.a.instance.resolve("Box4.IParagraphEditor")}get EH(){return null!=this.zzg?this.zzg:this.zzg=Fa.a.instance.resolve("Box4.IFontStylesGalleryCache")}get Fn(){return null!=this.NGg?this.NGg:this.NGg=Fa.a.instance.Na("Box4.Styles.StyleSettings")}get pp(){return null!=this.Rzg?this.Rzg:this.Rzg=Fa.a.instance.resolve("Box4.IFormattingEditor")}get sc(){return null!=
this.FJg?this.FJg:this.FJg=Fa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get $R(){return this.zW||(this.zW=new hv.WACStyleSet)}set $R(b){this.zW=b}get Xb(){return null!=this.dzg?this.dzg:this.dzg=Fa.a.instance.Na("Box4.IFeatureHelper")}get Un(){return this.iK.value}get pj(){return null!=this.VAg?this.VAg:this.VAg=Fa.a.instance.Na("Box4.IInsertionPointFormatting")}get Z0d(){return this.Gf||(this.Gf=Fa.a.instance.resolve("Box4.List.IListReader"))}get characterPropertiesEditor(){return null!=
this.Awg?this.Awg:this.Awg=Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Ld(){return null!=this.sIg?this.sIg:this.sIg=Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=this.SHg?this.SHg:this.SHg=Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}ccm(b){const k=b.node;var t=this.pj?this.pj.U4h():null;if(t&&!t.equals(X.a.nil)){b=k.Kc;if(!b)return null;t=b.Db(t);if(!t||(t=new CA.a(t),1!==this.sc.RD(t)))return null}else t=
Je.FormattingReader.Kr(b),t=Je.FormattingReader.Fna(t);return t}tlo(b,k){const t=this.sc.JC(k);t&&t.Fi(this.sc.kg(b))&&(this.Smg(k,t),this.pj&&(this.pj.K5a(),this.pj.A6a(b,k)))}LCk(b,k){if(k)if(k.kDb&&0<k.kDb.length){let P=new Ca.a;for(var t of k.kDb)P.add(t);if(k.rDi){t=Je.FormattingReader.f3h(b);const ca=[];for(var D of t)D.formatting&&D.formatting.wn&&ca.push(D.formatting.wn);if(0<ca.length){D=Tx.APropertySet.z$h(ca);t=new Ca.a;for(const ta of P)(!D.hasProperty(ta)||k.IUm&&ta===qe.a.PIa)&&t.add(ta);
P=t}}this.paragraphEditor.w2b(b,!0,P)}else this.paragraphEditor.w2b(b,!0);else Jc.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}HJ(b,k,t,D=!1,P=!1,ca=!1,ta=null){if(pe.ParagraphReader.Wb(k))if(b)if(this.sc.hY(b.yl()))if(2!==this.sc.RD(b))v.ULS.shipAssertTag(593506381,324,!1);else{var Na=this.sc.JC(k);if(Na){var qb=this.sc.kg(b);if(!qb)v.ULS.shipAssertTag(593506377,324,!1);else if(Na.Fi(qb)){var Jb=null,Vb=sq.a.instance.J(1)&&!D?k.LD():
null;t||(ta&&ta.ZQk&&this.Xb&&this.Xb.isFeatureEnabled(101)?(this.LCk(k,ta),hi.a.Pj&&1==ta.kDb.length&&ta.kDb[0]==qe.a.PIa?Jb=this.Un.h6i(Jb,k):this.AUo(k,b,ta)):(Jb=this.Un.h6i(Jb,k),this.paragraphEditor.w2b(k,!0)));this.Smg(k,Na);P&&Vb&&Vb.hasProperty(zi.a.paragraphStyle)&&Vb.removeProperty(zi.a.paragraphStyle);k.properties.setValue(zi.a.paragraphStyle,b.id);hi.a.Pj&&this.Z0d.HC(k)&&this.Xb&&this.Xb.isFeatureEnabled(101)&&this.xEj(k,b,ta);k.yP=b;k.wTa=null;for(t=0;t<k.pa.length;t++)k.pa.J(t).formatting&&
k.pa.J(t).formatting.l$b();this.Z0d.bCb(b)&&(Jb||(Jb=new ze.GraphIterator,Jb.set(k),Jb.yd(),ag.OutlineElementNavigator.Vd(Jb)),dg.ListItemReader.sh(Jb)||(k.Eg(Cc.a.$d,Cc.a.NM,Cc.a.GA,Cc.a.z0,Cc.a.KRa,Cc.a.ow),this.GAd(Jb,b)));this.Fn&&this.Fn.isProgressiveStyleEnabled&&null!=this.EH&&this.EH.Hjc(qb);D||!Vb||ca||this.lj.YU(k,Vb,this.Ld.qg)}}else v.ULS.shipAssertTag(593506379,324,!1)}else v.ULS.shipAssertTag(593506382,324,!1);else v.ULS.shipAssertTag(593506383,324,!1);else v.ULS.shipAssertTag(593506384,
324,!1)}AUo(b,k,t){const D=this.Z0d.HC(b),P=this.Z0d.bCb(k);D&&(this.xEj(b,k,t),P||D.removeProperty(Cc.a.e0))}xEj(b,k,t){const D=b.Kc;if(b=this.characterPropertiesEditor.c0a(b)){var P=null==b.wn?new px.a:b.wn.clone();dl.a.HVo(P,k,t&&!t.rDi&&t.kDb?t.kDb:null);P.DFa?k=D.BR(P,!0):(D.Ju(P,null),k=P);b.Fj=k.id}else v.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}GAd(){}Xge(b,k){if(k){v.ULS.shipAssertTag(593506371,324,k.isConnected,"paragraphNode not connected");
var t=this.sc.JC(k);t?(b=t.Ova(b))?this.sc.hY(b.yl())?this.HJ(b,k,!1,void 0,void 0,void 0,null):v.ULS.shipAssertTag(593506368,324,this.sc.hY(b.yl())):v.ULS.shipAssertTag(593506369,324,!!b):v.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else v.ULS.shipAssertTag(593506372,324,!1)}f7e(b,k=!1,t=!1){const D=this.sc.JC(b).Fi(kk.StyleReader.wordStyleIdNormal);this.HJ(D,b,k,void 0,t)}Smg(b,k){(b=iv.fh.Ts(b))&&k.Uic(b)}OPh(b){var k=null;if(this.Xb&&this.Xb.isFeatureEnabled(35)){if(!b||
!b.count)return v.ULS.sendTraceTag(592221652,3018,10,"No style IDs provided for delete."),!1;if(!k&&(k=dl.a.Lr(),!k))return v.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var t=this.$R.LO(k);if(!t)return v.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var D=new Map;D.set("NumberOfStyles",b.count.toString());D.set("Source","DeleteStyleAPI");xa.Health.instance.recordKpiUsage(Pi.a.Qoe,0,Pi.a.qB,D);D=0;const ta=(new Date).getTime();
var P=null;let Na=null,qb=null,Jb=null;const Vb=this.Xb.isFeatureEnabled(34)&&!0;Vb&&(P=new Eb.a,Na=new Eb.a,qb=new Eb.a,Jb=new Eb.a);for(var ca of b){if(!ca)return v.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const ac=t.Fi(ca);if(!ac||!this.sc.ke(ac,t))return v.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!ac,!!ac&&this.sc.ke(ac,t)),!1;const yc=this.sc.RD(ac);if(2!==yc&&1!==yc)return v.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",
yc),!1;const Kc=this.sc.Fva(ac,t);let ed=0;if(Kc){if(!this.sc.ke(Kc,t))return v.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;ed=this.sc.RD(Kc);if(2!==ed&&1!==ed)return v.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",yc,ed),!1}else v.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");let sd=this.NBb(ac,t);if(!sd)return!1;D++;Vb&&(1===yc?(Na.add(ca),Jb.add(ac.id)):
(P.add(ca),qb.add(ac.id)));if(Kc){sd=this.NBb(Kc,t);if(!sd)return!1;D++;Vb&&(1===ed?(Na.add(this.sc.kg(Kc)),Jb.add(Kc.id)):(P.add(this.sc.kg(Kc)),qb.add(Kc.id)))}}cr.a.VSc();t=dl.a.buf(t);ca=new Xd.GraphTransaction(15);ca.Cb(k);Vb&&this.oZn(P,Na,qb,Jb,k);k.setValue(zi.a.dja,t);Jc.b(572302817,3018,50,String.format("Style Object Ids - {0}",t));ca.Yfe();ca.dispose();k=(new Date).getTime();P=new Map;P.set("Source","DeleteStyleAPI");P.set("NumberOfStyles",b.count.toString());P.set("TrueStyleCount",D.toString());
P.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new Db.a,{extendedProperties:P,durationMs:k-ta});xa.Health.instance.recordKpiSuccess(Pi.a.Qoe,b);return!0}return!1}oZn(b,k,t,D,P){if(b&&b.count||k&&k.count)if(P){var ca=(new Date).getTime();if(P=this.lTl(P)){for(;P.moveNext();){if(!pe.ParagraphReader.uh(P.iterator))continue;const ta=P.currentNode;this.$Yn(ta,b,t);this.aZn(ta,k,D)}t=(new Date).getTime();v.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",
t-ca));D=new Map;D.set("Source","DeleteStyleRemoveStylesReferences");D.set("NumberOfStyles",(b.count+k.count).toString());b=Object.assign(new Db.a,{extendedProperties:D,durationMs:t-ca});xa.Health.instance.recordKpiSuccess(Pi.a.Qoe,b)}}else Jc.b(577520338,3018,50,"PageContentNode not provided.");else Jc.b(577520337,3018,50,"No style IDs provided")}$Yn(b,k,t){if(k&&k.count&&b){var D=b.vz;D&&D.hasProperty(zi.a.paragraphStyle)&&t.contains(D.getValue(zi.a.paragraphStyle))&&(D.removeProperty(zi.a.paragraphStyle),
b.vz=D,b.LD()&&this.lj.YU(b,b.LD(),this.Ld.qg));(t=this.sc.Lo(b))&&(t=this.sc.kg(t))&&k.contains(t)&&this.f7e(b,!0,!0)}}aZn(b,k,t){if(b&&b.pa&&b.pa.length&&k&&k.count)for(let ta=0;ta<b.pa.length;ta++){var D=b.pa.J(ta);if(D&&D.formatting&&(D=D.formatting)&&D.Ib){var P=Je.FormattingReader.Fna(D);P&&(P=this.sc.kg(P))&&k.contains(P)&&this.pp.W6e(D);if(P=D.Ib.Wn){var ca=P.wn;ca&&(ca=ca.clone(),ca.hasProperty(zi.a.aw)&&t.contains(ca.getValue(zi.a.aw))&&this.mXn(b,ca,P,D));sq.a.instance.J(1)&&(ca=ta===b.pa.length-
1?b.characterData.length:b.pa.J(ta+1).cp,this.lj.QNb(b,D.Ib,D.Ib.cp,ca,P,D,this.Ld.qg))}}}}mXn(b,k,t,D){b&&k&&t&&D&&(b=b.Kc)&&(k.removeProperty(zi.a.aw),k.DFa?k=b.BR(k,!0):b.Ju(k,null),t.Fj=k.id,D.Ib.Wn=t)}lTl(b){if(!b)return null;b=ze.GraphIterator.$a(b);return b.Dp()?wc.a.mt(b,b.origin):null}NBb(b,k){if(!b)return v.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var t=b.yl();return this.sc.hY(t)?k.nZn(b)?!0:(t=new Map,t.set("Source","DeleteStyle"),t.set("StyleType",
qx[this.sc.RD(b)]),t.set("IsCustomStyle",this.sc.ke(b,k).toString()),t.set("IsLinkedStyle",(!!this.sc.Fva(b,k)).toString()),b=Object.assign(new Db.a,{extendedProperties:t}),xa.Health.instance.recordKpiFailure(Pi.a.Qoe,"UnableToDeleteStyle",!1,!0,b),v.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(v.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}iRa(b,k,t,D){if(this.Xb&&this.Xb.isFeatureEnabled(82)){if(!b)return v.ULS.sendTraceTag(591138959,
3018,15,"No style IDs provided for delete."),!1;if(!t&&(t=dl.a.Lr(),!t))return v.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const ca=this.$R.LO(t);if(!ca)return v.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=ca.Fi(b);if(!b)return v.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var P=this.sc.RD(b);if(2!==P&&1!==P)return v.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",
P),!1;xa.Health.instance.recordKpiUsage(Pi.a.hpg,0,Pi.a.qB,new Map([["Source","ModifyStyleAPI"]]));P=Date.now();const ta=new Xd.GraphTransaction(15);let Na,qb;try{ta.Cb(t);if(!(D&&0!=D.length||k&&0!=k.count))return!1;if(D&&0!=D.length&&(Na=dl.a.iQd(b),!ca.Vil(b,D)))return this.Xwa("ModifyStyleAPI",b,ca,P,"UnableToDeleteStyleProperties"),!1;if(k&&0!=k.count){const Kc=ca.FWo(b,k);qb=dl.a.iQd(b);if(!Kc)return this.Xwa("ModifyStyleAPI",b,ca,P,"UnableToModifyStyle"),!1}this.scn(b,t,qb,Na);cr.a.VSc();const Jb=
dl.a.buf(ca);t.setValue(zi.a.dja,Jb);Jc.b(572302818,3018,50,String.format("Style Object Ids - {0}",Jb));const Vb=Date.now(),ac=new Map([["Source","ModifyStyleAPI"]]),yc=Object.assign(new Db.a,{extendedProperties:ac,durationMs:Vb-P});xa.Health.instance.recordKpiSuccess(Pi.a.hpg,yc);return!0}finally{ta&&ta.dispose()}}return!1}scn(b,k,t,D){var P,ca;if(null!==b){var ta;D&&((ta=null===(P=this.Un)||void 0===P?void 0:P.zne(k,D,b,!0))||Jc.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));
t&&((ta=null===(ca=this.Un)||void 0===ca?void 0:ca.zne(k,t,b,!1))||Jc.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}Xwa(b,k,t,D,P){const ca=Date.now();b=new Map([["Source",b],["StyleType",qx[this.sc.RD(k)]],["IsCustomStyle",this.sc.ke(k,t).toString()],["IsLinkedStyle",(!!this.sc.Fva(k,t)).toString()]]);D=Object.assign(new Db.a,{extendedProperties:b,durationMs:ca-D});xa.Health.instance.recordKpiFailure(Pi.a.hpg,P,!1,!0,D)}static get fh(){return Wk.PageNavigator.instance}}
Object(n.a)(iv,"WACStyleEditor",null,[1141]);class DA extends iv{constructor(b,k,t){super(b,t);this.l6=k}get Ns(){return this.l6.value}GAd(b,k){this.Ns.GAd(b,k)}}Object(n.a)(DA,"WACStyleEditor",iv,[]);class FB{t6a(b,k){b.properties.setValue(Cc.a.marginTop,k)}r6a(b,k){b.properties.setValue(Cc.a.marginBottom,k)}Oia(b,k){b.properties.setValue(Cc.a.marginLeft,k)}s6a(b,k){b.properties.setValue(Cc.a.marginRight,k)}dbg(b,k){b.properties.setValue(Cc.a.Ao,k)}cbg(b,k){b.properties.setValue(Cc.a.lv,k)}Okj(b,
k){b.properties.setValue(Cc.a.DDi,k)}NNb(b,k){b.properties.setValue(qe.a.RE,k)}Eeo(b,k){b.properties.setValue(qe.a.hma,k)}Cic(b,k){b.properties.setValue(qe.a.eG,k)}Zko(b,k){b.properties.setValue(qe.a.separator,k)}}Object(n.a)(FB,"WordSectionEditor",null,[254]);class Oy{get name(){return"WordEditor.OutlineLevelEditors"}xc(b){b.ha("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new FB).as("Box4.IWordSectionEditor").singleInstance();w.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&
(b.ha("Box4.OutlineLevelEditors.PageContentEditor",()=>new hu(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").singleInstance(),b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Rn(ks.a.bPa,b.resolve("WordEditor.List.IFlatListReader"),b.Ue("Box4.IOutlineElementEditor"),b.Ue("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("Box4.IOutlineElementIndentationEditor"),b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",
()=>new Rn(ks.a.bPa,b.resolve("WordEditor.List.IFlatListReader"),b.Ue("Box4.IOutlineElementEditor"),b.Ue("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),b.ha("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new BA).as("Box4.List.ICursorMovementValidator").singleInstance(),b.ha("Box4.Styles.WACStyleReader",()=>new dy.a(b.resolve("WordEditor.ClientPagination.IClientPaginationSettings"),new hv.WACStyleSet)).as("Box4.Styles.IWACStyleReader").singleInstance(),
b.ha("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new DA(b.resolve("Box4.List.IListReader"),b.Ue("WordEditor.IFlatListEditor"),b.Ue("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").singleInstance())}init(){}dispose(){}static main(){N.a.instance.Fc(new Oy)}}Object(n.a)(Oy,"WordEditorOutlineLevelEditorsPackage",null,[1,2]);var Py=c(1192),gq=c(209);class Jm{constructor(b,k){this.Gd=b;this.nh=k;this.JLa=null}Cge(b){var k=gq.a.t_;const t=b.propertySet.ia(Cc.a.listID,0),D=b.propertySet.ia(Cc.a.listLevel,
-1);if(k&&0<t&&0<=D)this.JLa=b;else{let P=1;const ca=b.listStyle;k&&42!==ca&&0<ca&&(P=ca);this.JLa=Lq.a.uT(b.listType,P,null,t,D,void 0,"")}k=new Ly.a;switch(b.B5){case 0:this.JLa.JB=k.T$e();break;case 2:this.JLa.JB=k.aKh(k.yyh,k.xyh);break;case 1:this.JLa.JB=k.Laf(k.IRf,k.JRf)}}yjo(b){b&&(this.JLa=b)}createList(b){const k=Hi.a.instance.zp(Pb.a.createList);va.OutlineElementReader.Bh(b)||Hi.a.instance.Yb("PossiblyIncorrectListCreation",{["Reason"]:He.a.Jfb});dg.ListItemReader.sh(b)&&Hi.a.instance.Yb("PossiblyIncorrectListCreation",
{["Reason"]:He.a.y3k});const t=va.OutlineElementReader.yX(b);t&&!t.hasProperty(Cc.a.endOfParagraphFormatting)&&v.ULS.sendTraceTag(560563602,393,50,"Paragraph has null EOP formatting during creation of list node.");const D=this.L$k();b.Hf(D,4);t&&(t.CK=D);k.end();return D}L$k(){return lr.a.instance.createInstance(393234)}Hca(b){const k=Hi.a.instance.zp(Pb.a.Hca);va.OutlineElementReader.Bh(b)||Hi.a.instance.Yb("PossiblyIncorrectListRemoval",{["Reason"]:He.a.Jfb});dg.ListItemReader.sh(b)&&(wl.a.getInstance().Yt?
this.$Ga(b):this.b$i(b));k.end()}b$i(b){this.Gd.nR(b);b.wg()}Ola(b,k,t,D=!1){const P=Hi.a.instance.zp(Pb.a.SCk);this.Llj(b,t,D);const ca=b.hasProperty(vd.a.WOi);var ta=b.ia(vd.a.EXd,!1);let Na=!1;1===t.Sr&&t.Boa&&!t.rJ&&(Na=!0);const qb=t.propertySet.ia(Cc.a.au,null);qb&&qb===Box4Intl.Box4Strings.L_ListStyleNone&&(1===t.listType?Na=t.Boa&&!t.rJ:t.listType||(Na=!t.listStyle));if(ta)Na&&(t.G9(16,0),b.setValue(vd.a.yA,16),b.setValue(vd.a.KQa,0));else{ta=this.Gd.hw(k);this.$pj(t,ta,ca,Na)&&(P.properties.Z("ToggledOff",
"true"),t.G9(16,0),this.oio(b));if(!this.O9d(b,k,t,D))return P.end(),v.ULS.sendTraceTag(578331472,393,15,"Failed in performing auto correct numbering."),{returnValue:!1,lwa:t};!t.listType&&b.hasProperty(vd.a.H3a)&&(t.OB=b.getValue(vd.a.H3a),b.removeProperty(vd.a.H3a))}if(ca&&(P.properties.Z("MultipleOESelection","true"),({lwa:t}=this.Rro(k,t)).returnValue))return P.end(),v.ULS.sendTraceTag(578331473,393,15,"Multiple OE selected and OE is empty as well."),{returnValue:!1,lwa:t};this.Qyk(k,t,b,D);Gs.a.Hcj();
b.hasProperty(ke.a.kQ)&&Gs.a.w7k(b.getValue(ke.a.kQ),k,this.Gd);b.setValue(vd.a.EXd,!0);P.end();return{returnValue:!0,lwa:t}}$pj(b,k,t,D){if(D)return!0;if(k){D=b.listType===k.listType;const P=!b.listStyle&&b.OB===Wg.a.rl;let ca=b.listStyle===k.listStyle&&b.OB===k.OB;b=(!b.Boa||this.N8f(k,b))&&!t;ca=ca&&b;return D&&(P||ca)}return!1}oio(b){b.setValue(vd.a.yA,16);b.setValue(vd.a.KQa,0)}N8f(){return!0}Llj(){}O9d(){return!0}Rro(b,k){return{returnValue:16!==k.listType&&va.OutlineElementReader.isEmpty(b,
!0),lwa:k}}eGc(b){const k=Hi.a.instance.zp(Pb.a.eGc);pe.ParagraphReader.Wb(b)||Hi.a.instance.Yb("ClearingListFromNonParagraph",{["Reason"]:He.a.Iff});const t=new ze.GraphIterator;t.set(b);t.yd();t.At(12);ag.OutlineElementNavigator.Vd(t);this.$Ga(t);k.end()}merge(b,k,t){const D=Hi.a.instance.zp(Pb.a.wYm);va.OutlineElementReader.Bh(k)||Hi.a.instance.Yb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});va.OutlineElementReader.Bh(b)||Hi.a.instance.Yb("PossibleIncorrectMergeOfOEs",{["Reason"]:"DestIsNotOE"});
if(dg.ListItemReader.sh(k)){D.properties.Z("UseSourceListWithNonlistDestination",t.toString());let P;P=gq.a.t_;t&&dg.ListItemReader.sh(b)&&this.Hca(b);!dg.ListItemReader.sh(b)||t&&P?t&&(t=this.nai(k),1===t.Sr&&t.H6e(!0),this.gEc(b,t),D.properties.Z("MoveListInfoFromSrcToDestOE","true")):this.f3i(k,b);this.Hca(k);D.properties.Z("RemoveListFromSrcOE","true")}D.end();return!0}f3i(){}nai(b){return this.Gd.hw(b)}MKc(b,k){k.hasProperty(vd.a.yA)||(b===Pb.a.iD?k.setValue(vd.a.yA,1):(b===Pb.a.rL||b===Pb.a.nca)&&
k.setValue(vd.a.yA,0));k.hasProperty(vd.a.KQa)||k.setValue(vd.a.KQa,0);return k}f1b(b,k,t,D,P,ca,ta,Na){const qb=Hi.a.instance.zp(Pb.a.f1b),Jb=this.Gd.hw(k);t=Lq.a.uT(0,t,void 0,void 0,void 0,ta);t.OB=D;t.kQ=ca;Jb&&t.bxf(Jb)&&t.OB===Jb.Cu||(D=new Xd.GraphTransaction(15),D.hu(k),Na.numbering(t.listType,t.listStyle,t.OB,t.levelText,t.kQ)&&(Jm.characterPropertiesEditor.replaceTextRange(P,""),pe.ParagraphReader.Wb(b)&&gq.a.noa(b)&&(k=this.Gd.HC(b))&&Jm.characterPropertiesEditor.Ktl(b,k)),D.dispose());
qb.end()}zne(b,k,t,D=!1){if(null===t||null===b||null===k)return!1;b=this.Gd.Dx(b,k.listId,k.listLevel);if(!b)return v.ULS.sendTraceTag(523069061,393,15,"List def not exist when trying to update pStyle Property."),!1;if(D){if(b.hasProperty(zi.a.paragraphStyle)){b.getValue(zi.a.paragraphStyle)instanceof X.a||v.ULS.sendTraceTag(512267811,393,15,"StyleObject ID already in list def is not ExtendedGuid.");if(!X.a.Zp(b.getValue(zi.a.paragraphStyle),t.id))return v.ULS.sendTraceTag(523069062,393,15,"List def has different pStyle than what we are expecting to remove, thus not removing it."),
!1;b.removeProperty(zi.a.paragraphStyle);return!0}}else{t=t.id;t instanceof X.a||v.ULS.sendTraceTag(512267810,393,15,"StyleObject ID to be set on list def is not extendedGuid");if(b.hasProperty(zi.a.paragraphStyle))return v.ULS.sendTraceTag(523069063,393,15,"List def has different pStyle than what we are expecting to set, thus not setting it."),!1;b.setValue(zi.a.paragraphStyle,t);return!0}return!1}static get p6b(){return null!=Jm.vzg?Jm.vzg:Jm.vzg=Fa.a.instance.Na("Box4.IFontSlotProvider")}static get characterPropertiesEditor(){return null!=
Jm.swg?Jm.swg:Jm.swg=Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Vn(){return wl.a.getInstance()}}Object(n.a)(Jm,"ListEditor",null,[535]);var Qy=c(805),Is=c(316);class Gr{constructor(b,k,t,D,P,ca){this.Gf=P;this._pageContent=t;this.wvb=Array(Gr.Hha);this.lZb=Array(Gr.Hha);this.Bgh=Array(Gr.Hha);this.CPe=Array(Gr.Hha);this.Kch=Array(Gr.Hha);this.F2=D;this.vCc=ca;for(D=0;D<Gr.Hha;D++){var ta=this.hai(b,D,t,P);ta?(ca=ta.ia(sf.a.g0,Wg.a.rl),ta=ta.ia(Cc.a.Y4c,Wg.a.rl)):ta=ca=Wg.a.rl;
this.lZb[D]=ca!==Wg.a.rl?ca:Wg.a.RIc;this.CPe[D]=ta===Wg.a.rl?D-1:ta-1;Gr.M8(k)&&(this.Bgh[D]=Wg.a.rl,this.Kch[D]=Wg.a.rl);this.wvb[D]=this.lZb[D]}}hai(b,k,t,D){D.B3(t);return wl.a.getInstance().qTc&&this.vCc?this.Gf.trf(b,k,this.F2,t):this.Gf.vOc(b,k,t.Kc,t)}restart(b){this.wvb[b]=this.lZb[b]}MPi(b){for(var k=0;k<b;k++)this.wvb[k]===this.lZb[k]&&this.wvb[k]++;for(k=b+1;k<Gr.Hha;k++)this.CPe[k]>=b&&this.restart(k);return this.wvb[b]++}static M8(b){return!!b&&b.isFeatureEnabled(72)}}Gr.Hha=9;Object(n.a)(Gr,
"AWordList",null,[49]);class Ez{constructor(b,k,t,D){this.Vab=new tp.ScriptSharpLegacyMap;this.Gf=b;this.nK=k;this.F2=t;this.vCc=D}hw(b,k){this.Vab.nb(b)||this.Vab.Z(b,new Gr(b,k,this.nK,this.F2,this.Gf,this.vCc));return this.Vab.J(b)}PQf(b,k,t){return this.hw(b,t).MPi(k)}}Object(n.a)(Ez,"AListNumberingMap",null,[1321]);class GB extends Gr{constructor(b,k,t,D,P,ca){super(b,k,t,D,P,ca)}L4l(b,k,t,D){D.B3(t);return wl.a.getInstance().qTc&&this.vCc?this.Gf.n0l(b,k,this.F2):this.Gf.m0l(b,k,this._pageContent.Kc)}rEj(b,
k,t){var D=this.L4l(b,k,this._pageContent,this.Gf);D?(b=D.ia(sf.a.g0,Wg.a.RIc),D=D.ia(Cc.a.Y4c,Wg.a.rl),this.wvb[k]=this.Bgh[k]=this.lZb[k]=b,D!==Wg.a.rl&&(this.Kch[k]=this.CPe[k]=D-1)):t&&(D=this.hai(b,k,this._pageContent,this.Gf),b=Wg.a.RIc,D&&(b=D.ia(sf.a.g0,Wg.a.RIc)),this.wvb[k]=this.lZb[k]=b)}}Object(n.a)(GB,"WordList",Gr,[]);class ps extends Ez{constructor(b){super(b.Gd,b.pageContentNode,b.ISa,b.zHj);this.dbh=new Eb.a}O_l(b,k,t){let D;wl.a.getInstance().gY?{value:D}=this.Gf.qJ.Dc(b,D):{value:D}=
this.Gf.d0.Dc(b,D);this.Vab.nb(D)||this.Vab.Z(D,new GB(b,t,this.nK,this.F2,this.Gf,this.vCc));if(!this.dbh.contains(b))for(this.dbh.add(b);k<Wg.a.Hha;k++)this.Vab.J(D).rEj(b,k,!1);else if(!k)for(k+=1;k<Wg.a.Hha;k++)this.Vab.J(D).rEj(b,k,!0);return this.Vab.J(D)}PQf(b,k,t){return Gr.M8(t)?this.O_l(b,k,t).MPi(k):super.PQf(b,k,t)}}Object(n.a)(ps,"ListNumberingMap",Ez,[]);class Lv{constructor(){this.qRa=0;this.nJj=!1}}Object(n.a)(Lv,"LastNumber",null,[]);var rx=c(829),EA=c(609),ey=c(885);class Mv{constructor(){this.startAt=
this.ESa=0}}Object(n.a)(Mv,"WordListRestartInfo",null,[]);class Uo{constructor(b,k,t,D){this.l5d=!1;this.Ns=b;this.Fxi=t;this.v$b=D;this.fx=this.Ns.tB(k);this.outlineElement=new ze.GraphIterator;this.outlineElement.Yc(k)}static get Gd(){return Uo.Gf||(Uo.Gf=Fa.a.instance.resolve("Box4.List.IListReader"))}static set Gd(b){Uo.Gf=b}static get Vn(){return wl.a.getInstance()}static tBl(b,k,t,D=!1,P=!1){var ca=k.currentNode;let ta=null;new ze.GraphIterator;let Na=!1,qb=!1;k=k.OQb();const Jb=wc.a.Vo(k);
Jb.moveNext();for(k=Jb.iterator;k.currentNode!==ca;){let ac=qb=Na=!1;var Vb=Uo.Kpl(k);if(va.OutlineElementReader.Bh(k)&&!Vb){Vb=!1;if(k.Nr(4))if(Uo.eRi(k,t,!0,D,P))if(gq.a.t_){if(ac=!0,ta=new Uo(b,k,!1,!1),Jb.moveNext(),Jb.iterator===ca&&(Na=!0),D)break}else ta=new Uo(b,k,!1,!1),Na=!0;else va.OutlineElementReader.isEmpty(k,!1)||(Vb=!0),qb=!0;else!va.OutlineElementReader.isEmpty(k,!1)&&k.iib(12)&&(va.OutlineElementReader.rQ(k)||(Vb=!0));!D&&Vb&&ta&&(t.propertySet.hasProperty(Cc.a.listLevel)?ta.fx.level=
0:ta=null)}ac||Jb.moveNext();k=Jb.iterator}ta&&(ta.v$b=Na);if(!ta&&k.vf(1))for(ca=!0;k.currentNode;){if(va.OutlineElementReader.Bh(k)){if(k.Nr(4)&&Uo.eRi(k,t,!1,D,P)){ta=new Uo(b,k,!0,ca);break}if(!va.OutlineElementReader.isEmpty(k,!1))break}if(!k.vf(1))break;ca=!1}ta&&(ta.l5d=qb);return ta}static Kpl(b){var k=b.Rb(2);if(!k)return!1;k=pe.ParagraphReader.uh(b)&&Uo.GNm(k);b.uc();return k}static GNm(b){return Oi.a(b,8)}static eRi(b,k,t,D=!1,P=!1){Uo.Gd.nR(b);var ca=b.currentNode;b.uc();const ta=Uo.Gd.wX(ca);
(b=k.nz===ta.nz)&&k.listStyle&&1!==k.Sr&&(b=k.listStyle===ta.listStyle);b&&(k.Boa&&1!==k.Sr||k.B6b||P)&&(b=Uo.DLm(k,ta),k.nz||(b=b&&k.font===ta.font));if(1===k.Sr)if(1===ta.Sr&&ta.propertySet.hasProperty(ke.a.Qkb))b=k.B5===ta.B5;else return!1;b&&k.nz&&k.OB!==Wg.a.rl&&(b=ta.Cu,t&&(D&&1===k.OB&&1===b||b++),b=k.OB===b);b&&(D||k.B6b)&&(k=k.propertySet.ia(Cc.a.listID,0),ca=ca.ia(Cc.a.listID,0),0<k&&0<ca&&(b=k===ca));return b}static DLm(b,k){k=k.jJf;b.Boa&&(k=k.replace(RegExp("%\\d"),"%1"));return k.toLocaleLowerCase()===
b.jJf.toLocaleLowerCase()}static uBl(b,k,t){var D=k.currentNode;let P=null;const ca=new ze.GraphIterator,ta=b.Ana(D,t);var Na=!1;let qb=!1;ca.Yc(k);ca.uc();for(ca.Rb(1);ca.currentNode!==D;)qb=Na=!1,va.OutlineElementReader.Bh(ca)&&ca.Nr(4)&&(k=b.tB(ca),Uo.fRi(k,t,!0)?(P=new Uo(b,ca,!1,!1),Na=!0):(qb=!0,k.listID===t.listID&&k.level<=ta.ESa&&(P=null))),ca.vf(1);P&&(P.v$b=Na);if(!P&&ca.vf(1))for(D=!0;ca.currentNode;){if(va.OutlineElementReader.Bh(ca)&&ca.Nr(4)){Na=b.tB(ca);if(Na.listID===t.listID&&Na.level<=
ta.ESa)break;if(Uo.fRi(Na,t,!1)){P=new Uo(b,ca,!0,D);break}}if(!ca.vf(1))break;D=!1}P&&(P.l5d=qb);return P}static fRi(b,k,t){let D=b.listID===k.listID&&b.level===k.level;D&&k.Cu!==Wg.a.rl&&(b=b.Cu,t&&b++,D=k.Cu===b);return D}}Uo.Gf=null;Object(n.a)(Uo,"JoinTargetInfo",null,[]);class tr{constructor(b,k){this.fx=null;this.action=b;k&&(this.fx=k)}static Xdc(){return new tr(0)}static uFi(){return new tr(1)}static YXm(b){return new tr(3,b)}static oYm(b){return new tr(2,b)}static aYm(b){return new tr(4,
b)}}Object(n.a)(tr,"ApplyListInfoResult",null,[]);class zw{constructor(b,k,t){this.akc=t;this.yvn=k;this.u$=t-k.Cu;this.e0c=k.listID}get delta(){-1!==this.u$&&(this.u$=this.akc-this.yvn.Cu);return this.u$}set delta(b){this.u$=b}}Object(n.a)(zw,"ListTransferInfo",null,[]);class kp extends Jm{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc){super(b,t,qb);this.Ix=yc;this.fgh=!1;this.Xqc=this.Xgd=this.HTb=null;this.Mie=(Kc,ed)=>ed.listID===Kc.listID&&ed.level===Kc.level;this.hwo=(Kc,ed,sd)=>ed.listID!==
Kc.listID&&ed.listID!==sd.e0c||ed.level!==Kc.level?!1:!0;this.A9m=(Kc,ed,sd)=>ed.listID===Kc.listID||sd&&ed.listID===sd.e0c?!0:!1;this.asj=(Kc,ed,sd,oe,Ld)=>{const Od=Kc.ia(Jm.Vn.nV,-1);this.$rj(Kc,ed,Od+sd,oe,Ld)};this.$rj=(Kc,ed,sd,oe,Ld)=>{wl.a.getInstance().DB||this.Ix.eza(Kc,oe);ed=dg.ListItemReader.Ou?ed:Kc;Kc=this.sEb(ed);ed=ze.GraphIterator.$a(ed);ed.yd();ed.uc();this.JFl(ed,Kc,this.A9m,this.iCo,Ld)};this.iwo=(Kc,ed,sd,oe,Ld)=>{const {fx:Od,iterator:ie}=this.JJc(ed,()=>{wl.a.getInstance().DB||
this.Ix.eza(Kc,oe);wl.a.getInstance().Yt&&this.Ix.eza(ed,oe);var Ce=dg.ListItemReader.Ou?ed:Kc;const hg=this.sEb(Ce);Ce=ze.GraphIterator.$a(Ce);Ce.yd();Ce.uc();return{fx:hg,iterator:Ce}});this.TMd(ie,Od,this.wvj,this.Pje,Ld)};this.gCo=(Kc,ed,sd,oe,Ld)=>{this.M5i(Kc,ed,sd,oe,Ld)};this.Pje=(Kc,ed,sd,oe)=>{sd.listID=ed.listID;oe.Rb(4);const Ld=this.wq.rEb(oe.currentNode);this.JJc(Ld,()=>{this.S0b(oe.currentNode,sd,Ld);oe.uc()})};this.iCo=(Kc,ed,sd,oe)=>{dg.ListItemReader.sh(oe)&&(Kc=new ze.GraphIterator,
Kc.Yc(oe),Kc.yd(),this.Gd.nR(Kc),this.Msi(oe.currentNode,Kc.currentNode))};this.hCo=(Kc,ed,sd,oe,Ld)=>{sd.listID=ed.listID;this.M5i(Kc,ed,sd,oe,Ld);this.Pje(Kc,ed,sd,oe,Ld)};this.vvj=(Kc,ed)=>ed.listID===Kc.listID;this.fCo=(Kc,ed)=>ed.level<=Kc.level;this.wvj=(Kc,ed,sd)=>ed.listID===sd.e0c;this.Uo=P;this.Wra=b;this.Wkd=k;this.Hc=D;this.rYf={};this.R9j=ca;this.Ud=ta;this.qq=Na;this.ld=Jb;this.Sy=Vb;this.Qu=ac}get M8(){return this.Wra.jha}get XOb(){return this.fgh}set XOb(b){this.fgh=b}get wq(){return this.Wra}get r5(){return this.Qu}get sc(){return this.Sy}get $t(){return this.wq.$t}get Bq(){return this.wq.Bq}get uta(){return this.wq.uta}get J8(){return this.wq.J8}set J8(b){this.wq.J8=
b}get DQa(){return this.wq.DQa}set DQa(b){this.wq.DQa=b}get x8c(){return null!=this.iGg?this.iGg:this.iGg=Fa.a.instance.Na("Box4.List.ISingleLevelListEditor")}Qyk(b,k,t,D){v.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const P=t.ia(vd.a.EXd,!1);let ca=!1,ta=-1;!P||k.listStyle&&1!==k.Sr||(ca=!t.ia(vd.a.pHf,!1),ta=t.ia(vd.a.iJf,-1));b=this.gEc(b,k,{Fpi:ca,BXm:ta,TFl:D,propertySet:t});P||t.setValue(vd.a.pHf,2===b.action);3===b.action&&!t.hasProperty(vd.a.iJf)&&b.fx&&
t.setValue(vd.a.iJf,b.fx.level)}merge(b,k,t,D=null){const P=dg.ListItemReader.sh(b)||dg.ListItemReader.sh(k);b=super.merge(b,k,t,D);P&&this.Y9();return b}f3i(b,k){this.xSk(b,k)}xSk(b,k){b=this.Gd.mrf(b);const t=this.Gd.mrf(k);-1!==b&&-1!==t&&(b-=t,0<b?this.Wkd.value.ZIc(k,b):0>b&&this.Wkd.value.VRa(k,b,0))}b$i(b){this.Gd.nR(b);b.wg();sq.a.instance.J(1)&&this.Y9()}fKo(b,k,t,D){var P=ze.GraphIterator.$a(t);P=this.tB(P);this.gKo(P,b,k,t,D)}tB(b){b=dg.ListItemReader.Gva(b);return this.sEb(b)}ilj(b,k){this.Gd.nR(b);
const t=b.currentNode;b.uc();wl.a.getInstance().DB||this.Ix.eza(t,k);b=va.OutlineElementReader.yX(b);wl.a.getInstance().Yt&&this.Ix.eza(b,k);return this.sEb(dg.ListItemReader.Ou?b:t)}sEb(b){var k;const t=new Qy.a;dg.ListItemReader.Ou&&(b&&pe.ParagraphReader.Wb(b)||v.ULS.sendTraceTag(509141474,393,15,`Paragraph node not sent in getListRefInfoNode. Node sent: ${null===(k=null===b||void 0===b?void 0:b.constructor)||void 0===k?void 0:k.name}`));k=sq.a.instance.J(1)?dg.ListItemReader.Ou?dg.ListItemReader.R3(b)||
dg.ListItemReader.qRd(b):this.Gd.FO(b,!1,!0):dg.ListItemReader.R3(b,{PIc:0,LHd:-1});t.listID=k.listId;t.level=k.listLevel;t.e0=dg.ListItemReader.axf(b);k=this.nQd(b);t.ugo(k);t.Cu=dg.ListItemReader.Lhm(b);t.QJc=dg.ListItemReader.Jhm(b);return t}S0b(b,k,t=null,D=!1){b||Hi.a.instance.Yb("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});!wl.a.getInstance().Yt||D||t||(qj.Debug.Tuh(509364288),Jc.b(509364259,393,15,"Apply list info called without para node"));k||Hi.a.instance.Yb("CrashWhenApplyingList",
{["Reason"]:"RefInfoIsNull"});wl.a.getInstance().DB||this.Ix.zge(b,k.listID,k.level);wl.a.getInstance().Yt&&t&&!D&&this.Ix.zge(t,k.listID,k.level);!wl.a.getInstance().DB&&k.e0&&b.setValue(Cc.a.e0,!0)}uFj(b){this.wq.B3(b);b=kp.fh.Ts(b);let k=b.ia(Cc.a.Bq,null);k=k?Array.clone(k):[];b.setValue(Cc.a.Bq,k);this.wq.n$b()}nvj(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}U_l(b){b=b.view;if(!b.mb||!b.mb.hb)return null;b=$t.OutlineElementGeneralizer.gna(b.mb.hb,
!1);if(1!==b.length)return null;b=ze.GraphIterator.$a(b.getContext(0).node);if(!dg.ListItemReader.sh(b))if(14===b.Qd().type){const k=this.wq.Pim(b.currentNode);k&&b.set(k)}else Jc.b(589177753,393,15,"Encountered an OE of non list type."),b.uc();b.yd();return b}sal(b,k,t,D){const P=b.FH(),ca=new Qy.a;ca.listID=this.HLh(b);this.M8?(ca.Q0d=Jm.Vn.gY?this.ILh(b):this.zLh(b),this.Q6i(b,ca.listID,ca.Q0d)):this.S6i(b,ca.listID);ca.Vkj(k.propertySet,this.gXc(t));this.eKd(b);t=this.lai(b,k);for(let Na=0;9>
Na;Na++){const qb=new Yx.a;P.od.Ju(qb);this.R6i(b,this.M8?X.a.nil:qb.id,this.M8?qb.id:X.a.nil);this.Rqk(qb,k.nz,Na);this.koh(qb,t,Na);var ta=D.JIb[Na];ta=6===ta?Lq.a.uT(1,1):Lq.a.uT(0,ta);ta.wha&&qb.setValue(sf.a.x4,ta.wha);k.OB!==Wg.a.rl&&Na===ca.level&&qb.setValue(sf.a.g0,k.OB);D.ZDa&&D.ZDa[Na]&&qb.setValue(sf.a.font,D.ZDa[Na]);ta=D.iXc[Na];v.ULS.shipAssertTag(22127636,338,!!ta);qb.setValue(Cc.a.au,ta);qb.setValue(Cc.a.fca,D.a0d[Na]);Is.a.mhe(D.B5,qb)}return ca}ral(b,k,t){const D=b.FH(),P=new Qy.a;
P.listID=this.HLh(b);this.M8?(P.Q0d=Jm.Vn.gY?this.ILh(b):this.zLh(b),this.Q6i(b,P.listID,P.Q0d)):this.S6i(b,P.listID);P.Vkj(k.propertySet,this.gXc(t));if(!k.listStyle)switch(P.level%3){case 0:k.G9(k.listType,1);break;case 1:k.G9(k.listType,2);break;case 2:k.G9(k.listType,3)}this.eKd(b);t=this.lai(b,k);for(let ca=0;9>ca;ca++){const ta=new Yx.a;D.od.Ju(ta);this.R6i(b,this.M8?X.a.nil:ta.id,this.M8?ta.id:X.a.nil);this.Qqk(ta,k.nz,ca);this.koh(ta,t,ca);2===ca%3&&k.nz?ta.setValue(Cc.a.fca,"right"):ta.setValue(Cc.a.fca,
"left");ca===P.level&&(k.wha&&ta.setValue(sf.a.x4,k.wha),k.OB!==Wg.a.rl&&ta.setValue(sf.a.g0,k.OB),k.nz?this.Zkj(k,ta,ca):(kp.Wkj(k,ta),kp.Ykj(k,ta)),kp.Xkj(k,ta),k.B6b&&ta.GNa(k.propertySet,Cc.a.listID,Cc.a.listLevel))}return P}Zkj(b,k,t){b.Boa?(b=b.levelText,b=F.a.replaceAll(b,"%1","%"+(t+1))):b=b.cTc||b.Kna?b.levelText:"%"+(t+1)+".";v.ULS.shipAssertTag(22127638,338,!!b);k.setValue(Cc.a.au,b)}$pj(b,k,t,D){if(b.cTc)return!1;if(1===b.Sr)return D;if(D)return!0;if(k){D=b.listType===k.listType;const P=
!b.listStyle&&b.OB===Wg.a.rl;let ca=b.listStyle===k.listStyle&&b.OB===k.OB;b=(!b.Boa||this.N8f(k,b))&&!t;ca=ca&&b;return D&&(P||ca)}return!1}eKd(b){this.HTb||(this.HTb=b.ia(Cc.a.Dgl,null));this.Xgd||(this.Xgd=b.ia(Cc.a.Cgl,null));this.Xqc||(this.Xqc=b.ia(Cc.a.Egl,null))}gXc(b){720>b&&(b=0);return Math.max(0,Math.min(Math.floor(b/720),8))}IYl(b){return b?this.Uo.ZT(b).Ft-this.Uo.vG(b).Ft:-1}S6i(b,k){const t=b.ia(Cc.a.$t,null),D=t?t.length:0,P=Array(D+1);let ca=0;for(;ca<D;ca++)P[ca]=t[ca];P[ca]=k;
b.setValue(Cc.a.$t,P);this.wq.n$b()}Q6i(b,k,t){this.SYe(Cc.a.$t,b,k);if(Jm.Vn.gY){this.SYe(qe.a.p4a,b,t);var D=this.wq.kQd(b);D.add(k,t);b.setValue(qe.a.qJ,EA.b(Py.a.qlc(D)))}else this.SYe(Cc.a.uta,b,t),D=this.wq.jQd(b),D.add(k,t),b.setValue(Cc.a.d0,EA.b(Py.a.qlc(D)))}R6i(b,k,t){this.M8?(this.$nh(Cc.a.Bq,b,t),this.$nh(Cc.a.e9,b,k)):(t=(t=b.ia(Cc.a.Bq,null))?Array.clone(t):[],t.push(k),b.setValue(Cc.a.Bq,t),this.wq.n$b())}SYe(b,k,t){const D=k.ia(b,null),P=D?D.length:0,ca=Array(P+1);let ta=0;for(;ta<
P;ta++)ca[ta]=D[ta];ca[ta]=t;k.setValue(b,ca)}$nh(b,k,t){let D=k.ia(b,null);D=D?Array.clone(D):[];D.push(t);k.setValue(b,D)}Qqk(b,k,t){var D=t%3+1;const P=k?this.Xqc:this.Xgd;P&&t<P.length?b.setValue(Cc.a.Ws,P[t]):b.setValue(Cc.a.Ws,360);D=gq.a.t_?Lq.a.uT(k?0:1,this.nvj(D),null,0,t):Lq.a.uT(k?0:1,this.nvj(D));b.Qw(D.propertySet);b.setValue(Cc.a.J2e,k?-1:-2);k?b.setValue(Cc.a.au,"%"+(t+1)+"."):(b.setValue(sf.a.font,this.qSl(t)),b.setValue(Cc.a.au,String.fromCharCode(this.fSl(t))));Is.a.Lic(2,b)}Rqk(b,
k,t){const D=k?this.Xqc:this.Xgd;D&&t<D.length?b.setValue(Cc.a.Ws,D[t]):b.setValue(Cc.a.Ws,360);b.setValue(Cc.a.J2e,k?-1:-2);Is.a.Lic(1,b)}fSl(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}qSl(b){switch(b%3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}HLh(b){if(this.M8)this.J8<Wg.a.wXc&&this.wq.B3(b),this.J8=this.ibi(this.$t,this.J8,Wg.a.wXc);else{if(this.J8<Wg.a.wXc&&(this.wq.B3(b),this.$t&&this.Bq)){b=
this.$t.length;for(let k=0;k<b;k++)this.$t[k]>=this.J8&&(this.J8=this.$t[k])}this.J8+=1}return this.J8}zLh(b){this.DQa<Wg.a.fyd&&this.wq.B3(b);return this.DQa=this.ibi(this.uta,this.DQa,Wg.a.fyd)}ILh(b){var k;this.wq.B3(b);do b=Math.floor(Math.random()*(kp.f$m-kp.CNi))+kp.CNi;while(null===(k=this.wq.OJb)||void 0===k?0:k.includes(b));return b}ibi(b,k,t){if(k<t&&b){t=b.length;for(let D=0;D<t;D++)b[D]>k&&(k=b[D])}k++;return k}k1n(b,k){this.T0h(b,k,1,this.Mie,this.asj,null,!1)}j1n(b,k,t){this.KFl(b,k,
t,this.Mie,this.$rj)}gHk(){this.Y9()}Y9(b=null){var k,t;if(sq.a.instance.J(1)){var D=new ze.GraphIterator;if(b)if(8===b.type)D.set(b);else{v.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else D.set(Wa.App.ya.gb.Uc),kp.fh.Kkg(D),b=kp.fh.Ts(D.currentNode);if(D.zb(7)||D.hd(7)){D=wc.a.mt(D,D.origin);var P=new ps({Gd:this.wq,pageContentNode:b,ISa:null,zHj:!1});for(b=new ps({Gd:this.wq,pageContentNode:b,ISa:null,zHj:!1});D.moveNext();){var ca=
D.iterator;let Na;if(!wl.a.getInstance().DB){if(!ca.Nr(4)&&!ca.Nr(31))continue;this.Gd.BJb(ca);Na=ca.currentNode;ca.uc();if(!Na){v.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",ca.isValid);continue}}const qb=dg.ListItemReader.Ou?dg.ListItemReader.Gva(ca)||dg.ListItemReader.z7l(ca):Na;if(!this.M8&&!dg.ListItemReader.hFf(qb)&&this.Gd.wX(qb).listType)continue;var ta=void 0;if(dg.ListItemReader.Ou){if(!qb){v.ULS.sendTraceTag(509141473,
393,50,"Skipping updating list numbers because paraNode not found");continue}ta=dg.ListItemReader.R3(qb)}else ta=this.Gd.FO(Na,!1,!1);if(this.M8&&ta&&this.Gd.UYd(ta.listId)){v.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",ta.listId);continue}const Jb=dg.ListItemReader.Ou?qb:va.OutlineElementReader.yX(ca);Jb&&(Jb.pa?(null==Jb.pa.last&&v.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),this.M8&&this.wq.B3(ca.currentNode),
12===Jb.type&&(Jb.Mi&&Jb.vz.hasProperty(Cc.a.listID)||null===(k=Jb.pa.last)||void 0===k||!k.Zi)&&((ca=dg.ListItemReader.Ou?dg.ListItemReader.qRd(qb)||dg.ListItemReader.R3(qb):this.Gd.FO(Na,!0,!0))?this.$kj(Na,qb,b,Jm.Vn.Cnc,ca):v.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",Na.type)),!ta||null!==(t=Jb.pa.last)&&void 0!==t&&t.ii||!this.$kj(Na,qb,P,Jm.Vn.nV,ta)||(ta=Na.getValue(Jm.Vn.nV),this.M8&&this.Gd.wX(qb).listType||Na.setValue(Jm.Vn.Cda,ta))):
v.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else v.ULS.shipAssertTag(593234060,376,7===D.We,"Couldnt reach to page manifest node")}}$kj(b,k,t,D,P){D||v.ULS.shipAssertTag(571757918,393,!!D,"Prop definition is null");t=t.PQf(P.listId,P.listLevel,this.ld);P=-1;b.hasProperty(D)&&(P=b.getValue(D));return t===P||this.M8&&!dg.ListItemReader.hFf(k)&&this.Gd.wX(k).listType&&(D!==Jm.Vn.Cnc||1!==this.Gd.wX(k).listType)?!1:(b.setValue(D,t),!0)}qKm(b,k){let t=
!1,D=!0,P=0;const ca=this.tB(b),ta=b.currentNode;b=b.OQb();b=wc.a.Vo(b);for(b.oo(ey.a.AXc,null);b.moveNext();){var Na=b.iterator.currentNode;if(Na===ta)break;dg.ListItemReader.sh(Na)&&(Na=this.tB(b.iterator),Na.listID===ca.listID&&(Na.level>ca.level?(t=!0,P++):Na.level===ca.level?(D=!1,P=0):Na.level<=k.ESa&&(D=!0,P=0)))}return t&&D&&!0}JBh(b,k){this.Gd.nR(b);const t=b.currentNode;b.uc();const D=this.tB(b);D&&this.wq.zXc(t,D.listID,D.level)&&this.j1n(b.currentNode,D,k)}nai(b){const k=this.Gd.hw(b);
k.B6b=!0;this.Gd.nR(b);const t=b.currentNode.ia(Cc.a.listID,0);k.propertySet.setValue(Cc.a.listID,t);b.hd(11);return k}cIf(b,k,t){const D=new ze.GraphIterator,P=k.currentNode;let ca;var ta=Wg.a.rl;let Na=!1,qb=!1,Jb=!1,Vb=null;var ac=k.OQb();ac=wc.a.Vo(ac);for(ac.oo(ey.a.AXc,null);ac.moveNext();){D.Yc(ac.iterator);if(D.currentNode===P)break;Na=!1;D.Nr(4)&&(ca=this.tB(D),ca.listID===b.listID&&(ca.level===b.level?(this.Gd.nR(D),ta=D.currentNode,D.uc(),ta=ta.ia(Jm.Vn.nV,Wg.a.rl),Na=!0,Vb=D.vmc(1),qb=
!0):ca.level>b.level?Jb=!0:ca.level<=t.ESa&&(ta=Wg.a.rl,Jb=qb=!1)))}!qb&&Jb&&(ta=t.startAt);Na&&(Na=k.vmc(1)===Vb);b=new Lv;b.qRa=ta;b.nJj=Na;return b}f1n(b,k){var t=dg.ListItemReader.Gva(b);if(kp.bPm)this.sUo(t,k);else{b=this.sEb(t);const ca=this.Ana(t,b),ta=this.wq.d1a(t,b);var D=new ze.GraphIterator;const Na=ta.nz;let qb=ca.startAt,Jb=!1,Vb=!1;v.ULS.shipAssertTag(22127639,338,ta.Kna,"Info does not have a level Text.");D.set(t);if(D.yd()&&(t=D.GSa()))for(t=wc.a.Vo(t),t.oo(ey.a.AXc,b);t.moveNext();){D=
t.iterator.currentNode;if(!dg.ListItemReader.sh(D))continue;var P=this.tB(t.iterator);P.listID===k&&(P=this.ilj(t.iterator,b.listID));if(P.listID!==b.listID)continue;const ac=t.iterator.Rb(4);ac&&t.iterator.uc();P.level>b.level?(this.wq.zXc(ac,b.listID,P.level)&&this.Msi(D,ac),Vb=!0):(P.level<=ca.ESa?(qb=ca.startAt,Vb=Jb=!1):(P=t.iterator,this.Gd.nR(P),Jm.Vn.Yt||P.currentNode.setValue(Cc.a.au,ta.jJf),{N$n:Jb,qRa:qb}=this.i1n(Na,Vb,Jb,P,qb,D)),kp.jCm(t))}}}sUo(b,k){const t=this.sEb(b),D=new ze.GraphIterator;
D.set(b);if(D.yd()&&(b=D.GSa())){b=wc.a.Vo(b);for(b.oo(ey.a.AXc,t);b.moveNext();)dg.ListItemReader.sh(b.iterator.currentNode)&&this.tB(b.iterator).listID===k&&this.ilj(b.iterator,t.listID);v.ULS.sendTraceTag(509200585,393,50,"Single level List is inflated successfully.")}}Msi(b,k){v.ULS.shipAssertTag(22819227,338,!!b&&!!k);k.setValue(Pf.a.nFi,X.a.create().toString())}i1n(b,k,t,D,P,ca){b?(k&&!t&&P++,ag.OutlineElementNavigator.Vd(D),this.JBh(D,P),P++,t=!0,D.Rb(2),rx.a.hEf(D.currentNode)&&D.currentNode.Tk(4,
!0)):(D.currentNode.removeProperty(Jm.Vn.nV),ag.OutlineElementNavigator.Vd(D));ca.Tk(4,!0);(b=D.Xn(16))&&b.Tk(8,!0);return{N$n:t,qRa:P}}Ana(b,k){const t=Hi.a.instance.zp(Pb.a.Ana),D=new Mv;(b=this.wq.Dx(b,k.listID,k.level))?(D.ESa=b.ia(Cc.a.Y4c,k.level-1),D.startAt=b.ia(sf.a.g0,1)):Hi.a.instance.Yb("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});t.end();return D}ucl(b){const k=lr.a.instance.createInstance(1074135151);b.Hf(k,31)}gKo(b,k,t,D,P){const ca=this.createList(k);this.S0b(ca,
b,null,!0);k=this.wq.d1a(k.currentNode,b);k.listType||(ca.setValue(Jm.Vn.nV,b.Cu),ca.setValue(Jm.Vn.Cda,b.QJc),this.ibj(ca,b,t?D:P));switch(k.listType){case 0:t="Numbering";break;case 1:t="Bullet";break;default:t="Invalid List Type"}w.AFrameworkApplication.va.processAction(Pb.a.joinList,2);v.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",t);gq.a.t_&&!wl.a.getInstance().DB&&this.Ix.zge(ca,b.listID,b.level)}V9i(b){var k=this.sc.Lo(b);k?this.sc.kg(k)===kk.StyleReader.wordStyleIdListParagraph&&
(k=this.sc.JC(b),this.r5.HJ(k.Fi(kk.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.XOb)):v.ULS.shipAssertTag(8271188,315,!1)}iio(b){if(this.sc.kg(this.sc.Lo(b))===kk.StyleReader.wordStyleIdNormal){const k=this.sc.JC(b);this.r5.HJ(k.Fi(kk.StyleReader.wordStyleIdListParagraph),b,!0,!0)}b.Eg(Cc.a.$d,Cc.a.NM,Cc.a.GA,Cc.a.z0,Cc.a.Ws,Cc.a.cia);b.setValue(Cc.a.KRa,0)}nTk(b,k){const t=b.getValue(Cc.a.listID),D=b.getValue(Cc.a.listLevel);for(let ca=0;9>ca;ca++){const ta=this.wq.Dx(b,t,ca);if(!ta)return Hi.a.instance.Yb("PossiblyIncorrectListStyle",
{["Reason"]:"ListDefIsNull"}),null;var P=k.JIb[ca];P=6===P?Lq.a.uT(1,1):Lq.a.uT(0,P);P.wha&&ta.setValue(sf.a.x4,P.wha);ta.hasProperty(sf.a.font)&&ta.removeProperty(sf.a.font);k.ZDa&&k.ZDa[ca]&&ta.setValue(sf.a.font,k.ZDa[ca]);P=k.iXc[ca];v.ULS.shipAssertTag(22127641,338,!!P);ta.setValue(Cc.a.au,P);ta.setValue(Cc.a.Sr,Is.a.Ldc);Is.a.mhe(k.B5,ta);ta.setValue(Cc.a.fca,k.a0d[ca]);ta.Eg(Cc.a.Y4c,sf.a.g0);this.uFj(b)}b=new Qy.a;b.listID=t;b.level=D;return b}lTk(b,k,t,D){if(D)return this.nTk(b,D);D=b.getValue(Cc.a.listID);
const P=b.getValue(Cc.a.listLevel),ca=this.wq.Dx(b,D,P);if(!ca)return Hi.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),k&&v.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",k.listStyle,k.listType,D,P),null;k.B6b&&(ca instanceof Tx.APropertySet?ca.GNa(k.propertySet,Cc.a.listID,Cc.a.listLevel):v.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===
ca||void 0===ca?void 0:ca.constructor.name));var ta=ca.ia(Cc.a.Sr,null);ta&&ta===Is.a.Ldc&&this.kTk(b,D);if(!k.listStyle){ta=0;if(-1!==t){for(ta+=P-t;0>ta;)ta+=3;ta%=3}switch(ta){default:t=1;break;case 1:t=2;break;case 2:t=3}k.G9(k.listType,t)}k.wha&&ca.setValue(sf.a.x4,k.wha);k.nz?(this.Zkj(k,ca,P),ca.hasProperty(sf.a.font)&&ca.removeProperty(sf.a.font)):(kp.Wkj(k,ca),kp.Ykj(k,ca));kp.Xkj(k,ca);ca.Eg(Cc.a.Y4c,sf.a.g0,Cc.a.$Uc);this.uFj(b);b=new Qy.a;b.listID=D;b.level=P;return b}kTk(b,k){let t;for(let D=
0;9>D;D++){t=this.wq.Dx(b,k,D);if(!t){v.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",k,D);break}t.setValue(Cc.a.Sr,Is.a.qVd);t.removeProperty(ke.a.Qkb)}}Dge(b,k){const t=Hi.a.instance.zp(Pb.a.Dge);this.Wkd.value||Hi.a.instance.Yb("PossibleIncorrectListIndentation",{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.JLa?(t.properties.Z("PendingListInfo","true"),dg.ListItemReader.sh(b)&&(t.properties.Z("RemoveCurrentListInfo","true"),this.XOb=!0,this.$Ga(b),
this.Wkd.value.VRa(b,-1,0),this.XOb=!1),16!==this.JLa.listType&&this.gEc(b,this.JLa,{Fpi:!0,sHl:gq.a.t_}),this.JLa=null):k||(t.properties.Z("CurrentlyUnderPastedList","true"),this.$Ga(b,{M9i:!0}));t.end()}whe(b,k){var t;if(dg.ListItemReader.sh(b))return!1;b.Rb(2);var D=zh.a.HHk;const P=[!0,!1].map(ca=>pe.ParagraphReader.ig(b.currentNode,ca,void 0,!1));b.uc();for(let ca=0;ca<P.length;ca++){const ta=P[ca];if(ta&&!gq.a.noa(ta))for(const Na of D)if(Na.test(ta.characterData))return D=null===(t=Na.exec(ta.characterData))||
void 0===t?void 0:t[0],this.kQn(k,ca?"nextPara":"prevPara",D),!1}return!0}kQn(b,k,t){const D=new Map;D.set("CurrentAutoListPreventedAutoListText",b);D.set("UndoAutoListPreferenceFoundIn",k);D.set("UndoAutoListPreferenceAutoListText",t);xa.Health.instance.recordKpiUsage(Wg.a.qkb.KWn,0,Wg.a.qB,D)}gso(b,k){return b&&k}W9i(b){for(let k=0;k<b.count;k++){const t=ze.GraphIterator.$a(b.J(k));t.Dp();this.Hca(t)}b.clear()}h1n(b){dg.ListItemReader.sh(b)&&this.Y9()}h6i(b,k){b=new ze.GraphIterator;b.set(k);b.yd();
ag.OutlineElementNavigator.Vd(b);b.hib(k)||Hi.a.instance.Yb("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.$Ga(b);return b}Oho(b,k,t){this.nh.Bya(b,k,t,!0)}Who(b){b.G9(1,1)}GAd(b,k){const t=Hi.a.instance.zp(Pb.a.FDk);if(this.sc.hY(k.yl())){if(dg.ListItemReader.sh(b)&&this.$Ga(b),k=this.wq.tai(k)){t.properties.Z("EarlyReturn","False");this.wq.d1a(b.currentNode,k);var D=Uo.uBl(this,b,k),P=this.createList(b);if(D)this.joinList(b,D,!0);else{if(D=this.TMd(b,k,this.vvj,
this.gCo)){const ca=this.tB(D);if(ca.listID===k.listID&&ca.level<k.level&&this.Gd.hw(D).nz){const ta=this.Ana(D.currentNode,ca);ca.Cu===(ta.startAt===Wg.a.rl?1:ta.startAt)&&(ca.QJc=ca.Cu,this.ibj(P,ca,D.currentNode))}}D=this.Ana(P,k);b=this.cIf(k,b,D);b=b.qRa!==Wg.a.rl?b.qRa+1:D.startAt===Wg.a.rl?1:D.startAt;wl.a.getInstance().DB||this.S0b(P,k,null,!0);P.setValue(Jm.Vn.nV,b);P.setValue(Jm.Vn.Cda,b)}wl.a.getInstance().DB||P.setValue(Cc.a.e0,!0);t.end()}}else Hi.a.instance.Yb("PossiblyIncorrectListStyle",
{["Reason"]:"StyleContainerNotValid"})}ibj(b,k,t){this.wq.zXc(b,k.listID,k.level)&&this.k1n(t,k)}Bth(b,k,t,D,P=null){b=P?this.sal(b,t,D,P):this.ral(b,t,D);D=k.Rb(4);k.uc();let ca;Jm.Vn.Yt?(k&&k.currentNode&&(393229==k.currentNode.Pc?ca=va.OutlineElementReader.yX(k):Jc.b(509367497,393,15,"Expected a OE node to extract para node")),ca?this.S0b(D,b,ca):(Jc.b(509386772,393,15,"Encountered a list node but paragraph node is not present"),qj.Debug.rap(!1,"Encountered a list node but paragraph node is not present",
509367496))):this.S0b(D,b);t.listType||(k=t.OB,k===Wg.a.rl&&(k=1),D.setValue(Jm.Vn.nV,k),D.setValue(Jm.Vn.Cda,k));Jm.Vn.Yt||(t.Kna?(t=t.levelText,P||(t=t.replace("%1","%"+(b.level+1))),D.setValue(Cc.a.au,t)):(v.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),D.setValue(Cc.a.au,"")));return b}joinList(b,k,t,D=null){if(dg.ListItemReader.sh(b)){var P=b.Rb(4);b.uc();var ca=va.OutlineElementReader.yX(b);this.JJc(ca,()=>{this.S0b(P,k.fx,ca,t);if(this.wq.d1a(P,
k.fx).nz){var ta=new ze.GraphIterator;ta.set(P);ta.yd();ta.uc();const Na=this.QDl(ta,k,D);ta=this.HDl(ta,P,k,t,D,Na);this.NDl(k,t,D,Na,ta)}})}else v.ULS.sendTraceTag(587747659,393,15,"List node received is null : skipping join list action.")}QDl(b,k,t){if(k.Fxi)k=k.outlineElement;else{let D,P;t?(D=this.wvj,P=this.Pje):k.v$b?(D=this.vvj,P=this.Pje):(D=this.fCo,P=this.hCo);k=this.TMd(b,k.fx,D,P,t)}!k&&t&&(t=new ze.GraphIterator,t.Yc(b),t.TPc()&&dg.ListItemReader.sh(t)&&(k=t));return k}HDl(b,k,t,D,P,
ca){D?(P?b=P.akc:(ca=this.Ana(k,t.fx),t=this.cIf(t.fx,b,ca),b=t.qRa!==Wg.a.rl?t.qRa+1:ca.startAt===Wg.a.rl?1:ca.startAt),k.setValue(Jm.Vn.nV,b),k.setValue(Jm.Vn.Cda,b)):(b=Wg.a.rl,this.Pio(k,ca,t));return b}NDl(b,k,t,D,P){if(D){var ca=!1,ta=this.tB(D),Na=ta.level===b.fx.level,qb=!!t&&ta.listID===t.e0c;(ta.listID===b.fx.listID||qb)&&Na&&(Na=this.Ana(D.currentNode,ta),qb=Na.startAt===Wg.a.rl?1:Na.startAt,ta.Cu===qb+1&&(ca=k?P===qb:this.qKm(D,Na)));if(!ca||t)t?(k=t.delta,P=this.hwo,ca=this.iwo):(k=1,
P=this.Mie,ca=this.asj),ta=new ze.GraphIterator,ta.set(D.currentNode),ta.yd(),this.Gd.nR(ta),ta.uc(),this.T0h(D.currentNode,b.fx,k,P,ca,t)}}Pio(b,k,t){let D=null;k&&(D=this.tB(k));if(D&&D.listID===t.fx.listID&&D.level===t.fx.level){const P=this.Gd.hw(k),ca=P.Cu;b.setValue(Jm.Vn.nV,ca);b.setValue(Jm.Vn.Cda,ca);gq.a.t_&&(P.propertySet.setValue(Cc.a.listID,D.listID),P.propertySet.setValue(Cc.a.listLevel,D.level));if(!t.v$b||t.l5d)t.Fxi&&!t.l5d&&(this.Gd.nR(k),b=k.currentNode,ag.OutlineElementNavigator.Vd(k)),
b.setValue(Jm.Vn.Cda,b.getValue(Jm.Vn.nV))}else k=t.fx.Cu+1,b.setValue(Jm.Vn.nV,k),b.setValue(Jm.Vn.Cda,k)}gEc(b,k,{Fpi:t=!1,BXm:D=-1,TFl:P=!1,sHl:ca=!1}={}){return k&&16!==k.listType?ze.GraphIterator.dba(()=>{if(!va.OutlineElementReader.Bh(b))return v.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),tr.Xdc();const ta=va.OutlineElementReader.yX(b);return ta&&Oi.a(ta,8)?(v.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),
tr.Xdc()):sq.a.instance.J(1)&&(null===ta||void 0===ta?0:ta.pa.last.ii)?(v.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),tr.Xdc()):this.JJc(ta,()=>{var Na=kp.fh.Ts(b.currentNode);const qb=k.JB,Jb=this.infoAtLevel(b,k);var Vb=b.Rb(4);if(Vb)return b.uc(),Na=this.vth(Jb,Vb,D,qb),Na.fx=this.tB(b),Na;Vb=this.M$k(b);const ac=k.propertySet.ia(Cc.a.listID,-1),yc=this.N_l(ac,ca),Kc=this.IYl(ta),ed=this.GZl(k,b,Jb,ca,P,t);this.vgo(ed,Jb);ta&&this.iio(ta);return null==ed||P||
Jb.nz!==this.Gd.d1a(Vb,ed.fx).nz?this.Jpl(Jb,yc,ed,Vb)?(this.lio(Vb,Jb,yc,Kc,ta),this.vth(Jb,Vb,-1,qb)):this.GDk(Vb,Jb,b,Na,Kc,qb,yc,ac,ta):(Jb.listStyle||(ed.v$b=!0),this.HDk(yc,ed,b))})}):(k||v.ULS.sendTraceTag(509650391,393,15,"applyListInfo was called with info = "+k),this.$Ga(b))}GZl(b,k,t,D,P,ca){var ta;P=b.Glb?new Uo(this,ze.GraphIterator.$a(b.Glb),!1,!0):Uo.tBl(this,k,t,D,P);if(!P)return null;ca?(P.fx.level=this.UYl(k,t,D),this.sDl(k,P)):P.fx&&(null===(ta=b.propertySet)||void 0===ta?0:ta.hasProperty(Cc.a.listLevel))&&
(P.fx.level=b.propertySet.getValue(Cc.a.listLevel));return P}N_l(b,k){return gq.a.t_&&k&&0<b&&b+""in this.rYf?this.rYf[b+""]:-1}lio(b,k,t,D,P){var ca;wl.a.getInstance().DB||this.Ix.eza(b,t);wl.a.getInstance().Yt&&this.Ix.eza(P,t);b.properties.hasProperty(Cc.a.listLevel)||(t=(null===(ca=k.propertySet)||void 0===ca?0:ca.hasProperty(Cc.a.listLevel))?k.propertySet.Lf(Cc.a.listLevel):this.gXc(D),wl.a.getInstance().DB||this.Ix.P7a(b,t),wl.a.getInstance().Yt&&this.Ix.P7a(P,t),k.propertySet&&k.Kna&&!Jm.Vn.Yt&&
(k=k.levelText.replace("%1","%"+(t+1)),b.setValue(Cc.a.au,k)))}vth(b,k,t,D){b=this.lTk(k,b,t,D);return tr.YXm(b)}HDk(b,k,t){let D=null;gq.a.t_&&0<b&&(D=new zw(0,k.fx,-1),D.e0c=b,D.delta=-1);this.joinList(t,k,!1,D);return tr.oYm(k.fx)}GDk(b,k,t,D,P,ca,ta,Na,qb){const Jb=va.OutlineElementReader.O3(t);0<Jb&&(P+=Jb);k=this.Bth(D,t,k,P,ca);this.rUo(ta,Na,k,b,qb);return tr.aYm(k)}$Ga(b,{M9i:k=!1}={}){return ze.GraphIterator.dba(()=>{if(!va.OutlineElementReader.Bh(b))return v.ULS.sendTraceTag(509678220,
393,15,"Iterator not pointing to OE in remove list info word."),tr.Xdc();const t=va.OutlineElementReader.yX(b);if(sq.a.instance.J(1)&&(null===t||void 0===t?0:t.pa.last.ii))return v.ULS.sendTraceTag(509678219,393,15,"User tried to remove list from para with deleted EOP."),tr.Xdc();const D=b.Rb(4);return D?t?this.JJc(t,()=>{var P;this.V9i(t);this.rYn(t);t.CK=null;this.Gd.UYd(dg.ListItemReader.Ou?dg.ListItemReader.R3(t,{PIc:0}).listId:D.ia(Cc.a.listID,0))?(D.U7c=!1,b.wg(),wl.a.getInstance().Yt&&this.Ix.Hca(t)):
b.uc();k||this.lfo(b);b.Rb(4)&&(D.U7c=!1,b.wg(),wl.a.getInstance().Yt&&this.Ix.Hca(t));(this.Ud.qg&&!this.XOb||!this.Ud.qg&&t.Mi)&&(!t.Mi||(null===(P=t.vz)||void 0===P?0:P.hasProperty(Cc.a.listID)))&&this.ucl(b);return tr.uFi()}):(v.ULS.sendTraceTag(509211404,393,15,"OutlineElement has listNode but no paraNode during removeListInfo"),D.U7c=!1,b.wg(),tr.uFi()):tr.Xdc()})}lfo(b){const k=kp.fh.Ts(b.currentNode),t=va.OutlineElementReader.oEa(b),D=va.OutlineElementReader.vG(b),P=va.OutlineElementReader.O3(b);
this.eKd(k);this.nh.Bya(b,1,Math.max(0,t+(P||-1*D)-this.Xqc[0]))}JJc(b,k){let t=null;sq.a.instance.J(1)&&b&&(t=b.LD());k=k();sq.a.instance.J(1)&&!this.XOb&&(b&&t&&this.qq.YU(b,t,this.Ud.qg),this.Y9());return k}M$k(b){b.Rb(31)&&b.wg();return this.createList(b)}rYn(b){b.hasProperty(Cc.a.$d)&&b.removeProperty(Cc.a.$d);b.hasProperty(Cc.a.GA)&&b.removeProperty(Cc.a.GA);b.hasProperty(Cc.a.Ws)&&b.removeProperty(Cc.a.Ws)}infoAtLevel(b,k){if(!k)return null;const t=k.JB;if(1===k.Sr){if(k.Boa&&!k.rJ||!k.H6e(!1))return k;
b=va.OutlineElementReader.oEa(b);const D=this.gXc(b),P=t.JIb[D];b=Lq.a.I7(k.propertySet,k.propertySet);6===P?b.G9(1,1):b.G9(0,P);b.Ege("multilevel");b.levelText=t.iXc[D];t.ZDa&&t.ZDa[D]&&(b.font=t.ZDa[D]);b.lw=t.a0d[D];b.B5=t.B5;b.R0d=k.R0d}else b=k;return b}vgo(b,k){null!==b&&void 0!==b&&b.fx&&(k.levelText=b.fx.levelText,k.nz||(k.font=b.fx.font))}UYl(b,k,t){let D=va.OutlineElementReader.oEa(b);const P=va.OutlineElementReader.O3(b);0<P?D+=P:(b=va.OutlineElementReader.vG(b),0<b&&(D-=b));k=k.propertySet.ia(Cc.a.listLevel,
-1);return t&&0<=k?k:this.gXc(D)}sDl(b,k){if(!this.wq.d1a(b.currentNode,k.fx).listType){const t=this.Ana(b.currentNode,k.fx);b=this.cIf(k.fx,b,t);k.fx.QJc=k.fx.Cu=b.qRa===Wg.a.rl?t.startAt-1:b.qRa;k.v$b=b.nJj}}rUo(b,k,t,D,P){gq.a.t_&&(0>=b?this.rYf[k+""]=t.listID:(wl.a.getInstance().DB||this.Ix.eza(D,b),wl.a.getInstance().Yt&&this.Ix.eza(P,b),t.listID=b))}Jpl(b,k,t,D){if(!gq.a.t_||0>=k)return!1;const P=(ca,ta)=>ca.length!==ta.length||ca.some((Na,qb)=>Na!==ta[qb]);if(t)return k=this.Gd.d1a(D,t.fx),
b.nz!==k.nz||P(b.wha,k.wha);t=b.propertySet.ia(Cc.a.listLevel,-1);return 0<=t&&(k=this.wq.Dx(D,k,t))&&(k=k.ia(sf.a.x4,null))&&b.wha?P(k,b.wha):!1}qYn(b,k){var t,D;const P=!!k&&pe.ParagraphReader.Wb(k);let ca=0,ta=0;P&&(ca=this.Uo.ZT(dg.ListItemReader.Ou?k:this.Gd.srf(b)).Ft,ta=this.Uo.vG(k).Ft);P&&this.V9i(k);null!==(t=wl.a.getInstance())&&void 0!==t&&t.DB||(b.Rb(4),b.wg());(null===(D=wl.a.getInstance())||void 0===D?0:D.Yt)&&this.Ix.Hca(k);P&&this.nh.Bya(b,1,ca-ta)}Saa(b,k,t,D=-1,P=!1,ca=null,ta=
!1){v.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");const Na=Hi.a.instance.zp(Pb.a.Saa),qb=this.Hc.Mc(15);qb.hu(b);let Jb=null,Vb=0;({pUm:Jb,Tgn:Vb,returnValue:D}=this.VBl(b,k,D,Jb,Vb,P,ca));if(!Jb||ta&&(1===t||0>t-Jb.fx.Cu||2<t-Jb.fx.Cu))return qb.dispose(),Na.end(),!1;for(;0<Vb;)b.TPc(),Vb--;this.nUo(b,k,D,Jb);qb.dispose();Na.end();return!0}nUo(b,k,t,D){for(;b.TPc();){var P=dg.ListItemReader.Gva(b);if(P&&(P=this.sEb(P),P.listID===k.listID)){k=new zw(0,
k,t);wl.a.getInstance().Yt?this.joinList(b,D,P.e0,k):this.joinList(b,D,!0,k);break}}}VBl(b,k,t,D,P,ca=!1,ta=null){for(var Na;b.ZSd();){if(b.Nr(4)){const qb=this.tB(b),Jb=this.Gd.hw(b);if(Jb.listType!==ta.listType){P++;continue}if(ca&&Jb.listStyle!==ta.listStyle||!ca&&k.level<qb.level){P++;continue}-1===t&&(t=qb.Cu+1);D=null;if(k.level===qb.level||ca)null===(Na=this.x8c)||void 0===Na?void 0:Na.mzf(b),D=new Uo(this,b,!1,!1);ca&&qb.level!==k.level&&b.Nr(4)&&(b.Rb(4).setValue(Cc.a.listLevel,qb.level),
b.uc());break}P++}return{returnValue:t,pUm:D,Tgn:P}}o0l(b){b=dg.ListItemReader.Gva(b);return this.nQd(b)}nQd(b){let k;sq.a.instance.J(1)&&(k=dg.ListItemReader.Ou?dg.ListItemReader.R3(b)||dg.ListItemReader.qRd(b):this.Gd.FO(b,!1,!0));return this.Gd.Dx(b,k.listId,k.listLevel)}startNewList(b,k,t){v.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(k){var D=Hi.a.instance.zp(Pb.a.startNewList),P=this.Hc.Mc(15);P.hu(b);var ca=Lq.a.uT(0,k.listStyle,null,0,k.propertySet.ia(Cc.a.listLevel,
-1));if(dg.ListItemReader.Ou)({listId:ta,listLevel:Na}=dg.ListItemReader.hQd(b,{PIc:0,LHd:-1}));else{b.Rb(4);var ta=b.currentNode.ia(Cc.a.listID,0);var Na=b.currentNode.ia(Cc.a.listLevel,-1);b.uc()}ca.R0d=ta;var qb=k.propertySet.ia(Cc.a.$d,0);0<qb&&ca.propertySet.setValue(Cc.a.$d,qb);-1===ca.propertySet.ia(Cc.a.listLevel,-1)&&ca.propertySet.setValue(Cc.a.listLevel,Na);1===k.Sr&&((Na=new Ly.a,ta=k.qii(b.currentNode,ta),ta)?1===ta&&(ca.Ege(Is.a.Ldc),ca.JB=Na.Laf(Na.IRf,Na.JRf),ca.B5=ca.JB.B5):(ca.Ege(Is.a.Ldc),
ca.JB=Na.T$e(),ca.B5=ca.JB.B5));k.una()&&1>t&&(t=1);ca.OB=t;ta=new th.DictionaryPropertySet;ta=this.MKc(Pb.a.rL,ta);Na=va.OutlineElementReader.yX(b);k=this.tB(b);if(qb=this.o0l(b))ca.levelText=qb.ia(Cc.a.au,""),ca.rJ=42,ca.lw=qb.ia(Cc.a.fca,"left");this.qYn(b,Na);({lwa:ca}=this.Ola(ta,b,ca,!0));b.Rb(4);22!==b.currentNode.type&&63!==b.currentNode.type&&v.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);wl.a.getInstance().DB||this.Ix.P7a(b.currentNode,k.level);
wl.a.getInstance().Yt&&this.Ix.P7a(Na,k.level);b.uc();ca=new Uo(this,b,!1,!1);t=new zw(1,k,t);this.joinList(b,ca,!!wl.a.getInstance().Yt,t);P.dispose();D.end()}else v.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}TEf(b){if(!b)return!1;const k=b.Rb(2);k&&b.uc();return sq.a.instance.J(1)&&k&&12===k.type&&k.pa&&k.pa.last&&k.pa.last.ii?!0:!1}O9d(b,k,t,D){return this.R9j.O9d(b,k,t,D)}N8f(b,k){if(!b||!k)return!1;const t=b.propertySet.ia(Cc.a.au,null);k=k.propertySet.ia(Cc.a.au,
null);if(!t||!k)return!1;const D=b.propertySet.ia(sf.a.font,null);b=b.propertySet.ia(sf.a.font,null);return t===k&&D===b}Llj(b,k,t){t||k.listType||(k.OB=b.ia(sf.a.g0,Wg.a.rl))}lai(b,k){if(!k)return null;const t=Array(9),D=k.R0d;if(!this.KLm(k,b)||1>D)return null;for(k=0;9>k;k++){const P=this.Gd.Dx(b,D,k);if(null===P||void 0===P?0:P.hasProperty(Cc.a.$d))t[k]=P.getValue(Cc.a.$d);else return null}return t}KLm(b,k){if(!b)return!1;const t=b.propertySet.ia(Cc.a.listLevel,-1);b=b.propertySet.ia(Cc.a.$d,
-1);if(0>t||0>b)return!1;this.eKd(k);return b!==this.HTb[t]?!0:!1}koh(b,k,t){b&&b.setValue(Cc.a.$d,k?k[t]:this.HTb&&t<this.HTb.length?this.HTb[t]:720*(t+1))}T0h(b,k,t,D,P,ca=null,ta=!1){const Na=new ze.GraphIterator,qb=this.Ana(b,k);Na.set(b);Na.yd();b=mr.a.mt(Na,Na.OQb());b.oo(ey.a.AXc,null);let Jb=-1;for(;b.moveNext();){if(!dg.ListItemReader.sh(Na))continue;const Vb=this.tB(Na),ac=va.OutlineElementReader.yX(Na);this.Gd.nR(Na);const yc=Na.currentNode;Na.uc();if(D!==this.Mie||Vb.listID===k.listID){if(ta){if(-1!==
Jb&&Jb>Vb.level)break;if(-1===Jb)Jb=Vb.level;else if(Vb.level!==Jb)continue}else{if(Vb.level<=qb.ESa)break;if(!D(k,Vb,ca))continue}P(yc,ac,t,k.listID,ca)}}}KFl(b,k,t,D,P){const ca=new ze.GraphIterator,ta=this.Ana(b,k);ca.set(b);ca.yd();if(dg.ListItemReader.sh(ca)){b=this.tB(ca);var Na=va.OutlineElementReader.yX(ca);this.Gd.nR(ca);var qb=ca.currentNode;ca.uc();b.level<=ta.ESa||D(k,b,null)&&P(qb,Na,t,k.listID,null)}}JFl(b,k,t,D,P=null){const ca=new ze.GraphIterator;ca.Yc(b);D(b,k,this.tB(ca),ca,0);
this.TMd(b,k,t,D,P)}TMd(b,k,t,D,P=null){let ca=new ze.GraphIterator;const ta=this.Ana(b.currentNode,k);let Na=null,qb=0;var Jb=new ze.GraphIterator;Jb.Yc(b);Jb.zb(10);const Vb=wc.a.mt(Jb,Jb.origin);for(Vb.moveNext();Vb.moveNext();)if(Na=null,ca=Vb.iterator,1===ca.role&&(Na=Vb.currentNode,ca.Nr(4)&&(Jb=this.tB(ca),t(k,Jb,P))))if(Jb.level>k.level)D(b,k,Jb,ca,qb),qb++;else if(Jb.level===k.level||Jb.level<=ta.ESa)break;return Na?ca:null}M5i(b,k,t,D,P){b=this.Ana(b.currentNode,t);b.ESa>=k.level&&this.JBh(D,
b.startAt+P)}static get bPm(){null==kp.qsd&&(w.AFrameworkApplication.K?(w.AFrameworkApplication.ue("i75ig452;a229j208"),kp.qsd=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveRedundantRenumberingForListActions",!1)):kp.qsd=!1);return kp.qsd}static get fh(){return Wk.PageNavigator.instance}static Wkj(b,k){k.setValue(sf.a.font,b.Boa||b.cTc||b.xQc?b.font:"Symbol")}static Ykj(b,k){b=b.Boa||b.cTc||b.Kna?b.levelText:Wg.a.JHd;v.ULS.shipAssertTag(22127637,338,!!b);k.setValue(Cc.a.au,
b)}static Xkj(b,k){b=b.propertySet.ia(Cc.a.fca,"left");k.setValue(Cc.a.fca,b)}static jCm(b){b=b.iterator.parentNode;const k=ze.GraphIterator.$a(b);b&&va.OutlineElementReader.OEf(k,null)&&b.Tk(8,!0)}}kp.f$m=2147450879;kp.CNi=1;kp.qsd=null;Object(n.a)(kp,"FlatListEditorCssVersion",Jm,[534,535]);class fy{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc){this.wq=b;this.Zvn=k;this.lg=t;this.ur=D;this.HA=P;this.UXm=ca;this.Ld=ta;this.lj=Na;this.gYm=qb;this.Xb=Jb;this.sc=Vb;this.XG=ac;this.Ix=yc}create(){return new kp(this.wq,
this.Zvn,this.lg,this.ur,this.HA,this.UXm,this.Ld,this.lj,this.gYm,this.Xb,this.sc,this.XG,this.Ix)}}Object(n.a)(fy,"FlatListEditorFactory",null,[]);class iu{constructor(){this.startAt=this.listLevel=this.listId=0;this.Glb=null}}Object(n.a)(iu,"ListAutoCorrectionRefInfo",null,[]);class gy{constructor(b,k){this.r9j=b;this.Gf=k}O9d(b,k,t,D){if(!b.hasProperty(vd.a.H3a))return!0;k=ze.GraphIterator.$a(k.currentNode);hf.SelectionEditor.ku(k);let P=!0;if(!t.listType&&!D){23===k.We&&k.iF(1);D=b.ia(vd.a.H3a,
1);if(1<D){var ca=new ze.GraphIterator;ca.Yc(k);ca.zb(10);ca=wc.a.Vo(ca.origin);D=this.UBl(ca,D,t,k.currentNode);t.Glb||(P=!1)}b.setValue(vd.a.H3a,D)}return P}UBl(b,k,t,D){const P=new Eb.a;for(;b.moveNext()&&b.iterator.currentNode!==D;){const ca=b.iterator;if(!ca.Nr(4))continue;const ta=this.r9j.value.tB(ca),Na=this.Gf.hw(ca);this.SIn(P,ta);Na.listType===t.listType&&Na.listStyle===t.listStyle&&(0>k-ta.Cu||2<k-ta.Cu||P.add(Object.assign(new iu,{listId:ta.listID,listLevel:ta.level,Glb:ca.currentNode,
startAt:ta.Cu+1})))}0<P.count&&(k=P.J(P.count-1).startAt,t.Glb=P.J(P.count-1).Glb);return k}SIn(b,k){let t=0;for(;t<b.count;){const D=b.J(t);D.listId===k.listID&&D.listLevel>=k.level?b.removeAt(t):t++}}}Object(n.a)(gy,"ListAutoCorrector",null,[497]);class hy{constructor(b,k,t,D,P){this.U6a=(ca,ta,Na)=>{var qb;ca=this.$Hc(ta);if(!ca||this.Ns.TEf(ca))return 8;ta=this.Ns.tB(ca);if(1===ta.Cu||this.rUc(ta.level))return 8;ta=null===(qb=this.Gd)||void 0===qb?void 0:qb.hw(ca);if(!ta||this.Txi(ta))return 8;
if(1===Na)return 32;this.Ns.startNewList(ca,ta,1);return 32};this.T6a=(ca,ta,Na)=>{ca=this.$Hc(ta);if(!ca||this.Ns.TEf(ca))return 8;ta=this.Ns.tB(ca);if(this.rUc(ta.level))return 8;const qb=this.Gd.hw(ca);if(!qb||this.Txi(qb))return 8;if(1===Na)return 32;this.hJc.A2l(ca.currentNode,ta.Cu,this.Gd,this.Ns,this.OTa);return 32};this.Saa=(ca,ta,Na)=>{ca=this.$Hc(ta);if(!ca||this.Ns.TEf(ca))return 8;ta=this.Ns.tB(ca);if(1!==ta.Cu||this.rUc(ta.level))return 8;if(1===Na)return 32;Na=this.Gd.hw(ca);return this.Ns.Saa(ca,
ta,Na.OB,-1,!1,Na)?32:8};this.Zob=(ca,ta,Na,qb,Jb)=>{ca=this.$Hc(ta);if(!ca)return 8;ta=this.Ns.tB(ca);if(this.rUc(ta.level))return 8;if(1===Na)return 32;Na=this.Gd.hw(ca);this.Ns.startNewList(ca,Na,Jb);return 32};this.Veb=(ca,ta,Na,qb,Jb)=>{ca=this.$Hc(ta);if(!ca)return 8;ta=this.Ns.tB(ca);return this.rUc(ta.level)?8:1===Na?32:this.Ns.Saa(ca,ta,ta.Cu,Jb)?32:8};this.pc=b;this.Gd=t;this.Ns=D;this.hJc=P}rUc(b){return 0>b}Tb(){this.pc.qa(Pb.a.U6a,lc.a.outlineElement,this.U6a);this.pc.qa(Pb.a.U6a,lc.a.Tc,
this.U6a);this.pc.qa(Pb.a.U6a,lc.a.view,this.U6a);this.pc.Vc(Pb.a.U6a,12);this.pc.qa(Pb.a.T6a,lc.a.outlineElement,this.T6a);this.pc.qa(Pb.a.T6a,lc.a.Tc,this.T6a);this.pc.qa(Pb.a.T6a,lc.a.view,this.T6a);this.pc.Vc(Pb.a.T6a,12);this.pc.qa(Pb.a.Saa,lc.a.outlineElement,this.Saa);this.pc.qa(Pb.a.Saa,lc.a.Tc,this.Saa);this.pc.qa(Pb.a.Saa,lc.a.view,this.Saa);this.pc.Vc(Pb.a.Saa,12);this.pc.qa(Pb.a.Zob,lc.a.outlineElement,this.Zob);this.pc.qa(Pb.a.Zob,lc.a.Tc,this.Zob);this.pc.qa(Pb.a.Zob,lc.a.view,this.Zob);
this.pc.Vc(Pb.a.Zob,12);this.pc.qa(Pb.a.Veb,lc.a.outlineElement,this.Veb);this.pc.qa(Pb.a.Veb,lc.a.Tc,this.Veb);this.pc.qa(Pb.a.Veb,lc.a.view,this.Veb);this.pc.Vc(Pb.a.Veb,12)}get OTa(){return Fa.a.instance.resolve("Common.IStandaloneRootController").Zca}$Hc(b){return this.Ns.U_l(b)}Txi(b){return 1===(null===b||void 0===b?void 0:b.listType)}}Object(n.a)(hy,"ListContextMenuSectionActor",null,[]);var am=c(591);class Ju{static get eYm(){return Wf.a.lA(Ju.Lm,Box4Intl.Box4Strings.l_StartNewListDialog,
Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}Ju.Lm="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(n.a)(Ju,"ListSetStartValueDialogHtml",null,[]);class Js extends Wf.a{constructor(b,k,t,D,P){super();this.Gpd=this.dwe=this.Zpd=this.HSe=null;this.Zxe=!0;this.pS=!1;this.ebb=0;this.itj=[Pb.a.Pag,Pb.a.yfg,Pb.a.G1f];this.klo=(ca,ta)=>{ca=ta[Dh.a.Number];this.r$=Number.isInteger(ta[Dh.a.Number])&&ca>=this.ebb?ca:this.ebb};this.rbm=(ca,ta)=>{this.r$=this.r$>=this.ebb?this.r$:this.ebb;ta[Dh.a.Number]=this.r$;ta[Dh.a.UnitType]=0};this.mio=(ca,ta)=>{if(1===ca){var Na=ta.ListRadioStartNew,qb=ta.ListRadioContinue,
Jb=ze.GraphIterator.$a(this.Fe);Jb.yd();ta=this.Ns.tB(Jb);ca=this.Gf.hw(Jb);if(Na)this.Ns.startNewList(Jb,ca,this.r$);else if(qb)if(this.Zxe)this.Ns.Saa(Jb,ta,this.aMe,-1,!1,ca);else{Na=!0;for(qb=null;Jb.hJ();)if(Jb.Nr(4)){qb=new Uo(this.Ns,Jb,!1,!1);break}if(!qb||this.Ns.tB(Jb).Cu>=this.r$)Na=!1;Na?(Jb=ze.GraphIterator.$a(this.Fe),Jb.yd(),this.Ns.Saa(Jb,ta,this.aMe,this.r$,!1,ca)):(this.dispose(),this.vHa(CommonUIStrings.l_ErrorDialogMessage,this.dYm))}}};this.dYm=()=>{new Js(this.Fe,this.aMe,this.Gf,
this.Ns,this.Ed)};this.tsn=()=>{document.getElementById(Js.vFi).style.visibility="visible"};this.Skn=()=>{document.getElementById(Js.vFi).style.visibility="hidden"};this.vg="ListSetStartValueDialog";this.Xg=Ju.eYm;this.Fe=b;this.r$=k;this.Gf=t;this.aMe=k;this.l6=D;k=new ze.GraphIterator;b?(k.set(b),k.yd(),va.OutlineElementReader.Bh(k)||ag.OutlineElementNavigator.Vd(k),dg.ListItemReader.sh(k)&&(k.Rb(4),b=k.currentNode,22===b.type&&(this.Gf.wX(b).una()?this.ebb=1:this.ebb=0))):this.ebb=1;this.Ed=P;
this.Wh(Box4Intl.Box4Strings.l_SetNumberingValueList,this.mio,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.Zxe&&(this.HSe=document.getElementById("ListRadioStartNew"),this.Zpd=this.tsn,this.dwe=document.getElementById("ListRadioContinue"),this.Gpd=this.Skn,vf.a.addHandler(this.HSe,"click",this.Zpd),vf.a.addHandler(this.dwe,"click",this.Gpd));for(const ca of this.itj)Object(am.a)(ca,this.klo,this.rbm);this.Ed.xm()}get Ns(){return this.l6}dispose(){if(!this.pS){for(const b of this.itj)Object(am.b)(b);
this.Zxe&&(this.Zpd&&vf.a.removeHandler(this.HSe,"click",this.Zpd),this.Gpd&&vf.a.removeHandler(this.dwe,"click",this.Gpd));this.Ed.BY("ListStartSpinner");super.dispose();this.pS=!0}}AMk(){const b=gl.l("none",this.ebb+"","100","1");return gl.j(Js.wFi,Pb.a.Pag,Pb.a.G1f,Box4Intl.Box4Strings.l_SetValueTo,[b],null,Pb.a.yfg)}szb(b){const k=document.getElementById(Js.wFi);this.Ed.OYa("ListStartSpinner",b);b=this.Ed.ODb("ListStartSpinner","Medium");k.appendChild(b)}W8(){const b=this.AMk();this.szb(b)}}Js.wFi=
"SetListStartSpinnerContainer";Js.vFi="ListStartAtSpinnerBox";Object(n.a)(Js,"ListSetStartValueDialog",Wf.a,[]);class Aw{A2l(b,k,t,D,P){new Js(b,k,t,D,P)}static get instance(){return Aw._instance||(Aw._instance=new Aw)}}Aw._instance=null;Object(n.a)(Aw,"ListDialogFactory",null,[474]);class HB{constructor(b,k,t){this.l6=b;this.Gf=k;this.Hc=t}mzf(b){v.ULS.shipAssertTag(40420184,393,va.OutlineElementReader.Bh(b));if(dg.ListItemReader.sh(b)){const k=this.Gf.hw(b);k.Sr||this.hvm(b,k)}}vVk(b){for(let k=
0;k<b.length;k++){const t=new ze.GraphIterator;t.set(b.getContext(k).node);this.mzf(t)}}hvm(b,k){const t=Wk.PageNavigator.instance.Ts(b.currentNode),D=this.l6.tB(b),P=this.Hc.Mc(15);P.hu(b);k=this.l6.Bth(t,b,k,0,null);this.l6.f1n(b,D.listID);P.dispose();this.Gf.d1a(b.currentNode,k)}}Object(n.a)(HB,"SingleLevelListEditor",null,[473]);var Ry=c(308);class iy{O2i(b,k,t,D,P,ca){return b?w.AFrameworkApplication.va.Nf(b,k,t,!0,P,ca):8}}Object(n.a)(iy,"ListContextManager",null,[1299]);class Ku extends iy{constructor(b){super();
Ku.quc=b}O2i(b,k,t,D,P,ca){if(!b||!b.length)return 8;let ta;const Na=({Jjm:b,Ijm:ta}=Ku.fq.Gjm(b)).returnValue;let qb=1;for(const Vb of Na.keys){var Jb=b.contains(Vb);const ac=Na.J(Vb);Ku.fq.ERk(Na.J(Vb),this.SFc(k),Jb)?Jb?(v.ULS.sendTraceTag(575213851,393,50,"List Actions: {0} lists, with change in level",this.SFc(k)?"Promote":"Demote"),Jb=w.AFrameworkApplication.va.Nf(Ry.a.iDa(ac),k,t,D,P,ca)):(v.ULS.sendTraceTag(575213852,393,50,"List Actions: {0} lists, without change in level",this.SFc(k)?"Promote":
"Demote"),Jb=Ku.fq.Yvn(Na.J(Vb),this.SFc(k),ta.J(Vb))):(v.ULS.sendTraceTag(575213850,393,50,"List Actions: Tried to {0} lists, but unable to indent",this.SFc(k)?"Promote":"Demote"),Jb=8);qb=Xc.ActionManager.NYc(qb,Jb)}return qb}SFc(b){return b===Pb.a.IG?!0:!1}static get fq(){return Ku.quc||(Ku.quc=Fa.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}Ku.quc=null;Object(n.a)(Ku,"WordEditorListContextManager",iy,[]);class ur{get name(){return"WordEditor.ListEditors"}xc(b){w.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&
(b.ha("WordEditor.ListEditors.IListAutoCorrector",()=>new gy(b.Ue("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"))).singleInstance(),b.ha("WordEditor.IFlatListEditor",()=>(new fy(b.resolve("WordEditor.List.IFlatListReader"),b.Ue("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new tk.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.List.IListFormattingEditor"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.List.ListItemEditor"))).create()).singleInstance(),b.ha("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).singleInstance(),b.ha("Box4.List.ISingleLevelListEditor",()=>new HB(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),
b.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance(),b.ha("Box4.ListEditors.WordEditorListContextManager",()=>new Ku(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new hy(w.AFrameworkApplication.va,new mk.a,ur.Gd,ur.Ns,Aw.instance)).Tb();const b=w.AFrameworkApplication.va;b.fb(Pb.a.G1f,lc.a.view,am.d,96);b.fb(Pb.a.yfg,lc.a.view,am.c,96);b.fb(Pb.a.Pag,lc.a.view,am.c,96)}dispose(){}static get Gd(){return null!=
ur.EDg?ur.EDg:ur.EDg=Fa.a.instance.resolve("Box4.List.IListReader")}static get Ns(){return null!=ur.ozg?ur.ozg:ur.ozg=Fa.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){N.a.instance.Fc(new ur)}}Object(n.a)(ur,"WordEditorListEditorsPackage",null,[1,2]);var pl=c(1676),Nv=c(499),rC=c(2005);class Ov extends cc.a{constructor(b,k,t,D,P,ca){super(b,k);this.styleId=null;this.Ph=0;this.JQa=null;this.characterData=t;this.paragraphNode=D;this.listMarker=P;this.m8=ca}}Object(n.a)(Ov,"HeadingText",
cc.a,[]);var sx=c(347);class Xg{constructor(b,k,t,D,P,ca,ta){this.lZg=!0;this.u5g=0;this.Rjh=8;this.bia=null;this.lqm=Na=>{if(Na.Pr)return!0;Na=Na.role;return 1===Na||2===Na||4===Na};this.l9j=b;this.Tz=k;this.we=t;this.Gf=D;this.LF=P;this.O5=ca;this.oIe=ta}get ax(){return this.l9j.value}get dzf(){return this.lZg}set dzf(b){this.lZg=b}get $Ib(){return this.u5g}set $Ib(b){this.u5g=b}get HQb(){return this.Rjh}set HQb(b){this.Rjh=b}async sXl(){var b=this.oIe.value;if(!isNullOrUndefined(b)&&b.oz)return b=
await this.W4l(),this.h_f(b,!0);b=this.bia;return isNullOrUndefined(b)?null:Promise.resolve(this.h_f(b,!0))}tXl(){return this.h_f([],!1)}h_f(b,k){const t=window.performance.now(),D=this.r9h();if(!D)return null;const P=new Eb.a;let ca=0;for(;D.moveNext();){var ta=D.iterator;if(11===ta.We){const Na=this.Gf.srf(ta),qb=ag.OutlineElementNavigator.Ge(ta,!0);k&&b[ca]&&b[ca].ParaId===pe.ParagraphReader.LQ(qb)&&ca++;ag.OutlineElementNavigator.Vd(ta);if(!qb||!pe.ParagraphReader.Wb(qb)||qb.vr||""===qb.characterData||
"\ufffc"===qb.characterData)continue;const Jb=this.wPd(qb);Jb&&(Na&&(Jb.listMarker=this.LF.Rkb(Na,!1).K8,ta=this.Gf.hw(ta),1===ta.listType&&ta.xQc&&(Jb.JQa=ta.font)),k&&(b[ca-1]&&b[ca-1].ParaId===pe.ParagraphReader.LQ(qb)?Jb.Ph=ca:Jb.Ph=ca+1),P.add(Jb))}}v.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-t));return P}W4l(){const b=new Cg.a;var k=rC.a.Paa(w.AFrameworkApplication.rootQuerySignature,null);const t=new kr.a;t.Cq=k;t.status=
1;this.Ock=window.performance.now();k=this.O5.rga(0,()=>{if(2!=t.statusCode||null==t.zj||0==t.zj.length||null==t.zj[0]){const D=String.format("GetPageEndsOperation Failed with status code: {0};",t.statusCode);b.setException(Error.create(D));v.ULS.sendTraceTag(543802465,3019,10,D)}else b.Ag(t.zj[0].PageEnds),v.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.Ock))});k.EI(t);k.BT();return mi.b(b.task)}pXl(){const b=this.r9h();if(!b)return-1;
let k=0;for(;b.moveNext();){const t=b.iterator;if(11===t.We){const D=ag.OutlineElementNavigator.Ge(t,!0);ag.OutlineElementNavigator.Vd(t);D&&pe.ParagraphReader.Wb(D)&&!D.vr&&""!==D.characterData&&"\ufffc"!==D.characterData&&this.wPd(D)&&k++}}return k}r9h(){if(!this.ax)return v.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),null;var b=this.Tz.IO(this.ax);if(!b)return v.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=ze.GraphIterator.$a(b);if(!b.Dp())return v.ULS.sendTraceTag(591963594,
3019,10,"Failed to root at PageContent."),null;b=wc.a.mt(b,b.origin);b.oo(this.lqm,null);return b}wPd(b){var k;return null!==(k=this.uhm(b))&&void 0!==k?k:this.o5l(b)}uhm(b){if(!hi.a.Pj)return this.vhm(b);if(!this.zTm(b))return null;var k=Object(sx.c)(9);k=Object(sx.a)(k);k=[...pe.ParagraphReader.Ejf(b,k)];if(0===k.length)return null;const t=pe.ParagraphReader.vna(b)+1;return this.eHh(b,k,t)}o5l(b){var k,t,D,P;if(!hi.a.Pj)return this.mXl(b);var ca=Object(sx.c)(9);ca=Object(sx.a)(ca);const ta=pe.ParagraphReader.bPc(b),
Na=this.we.JC(b),{nqm:qb,aDl:Jb}=this.Kcm(ta,Na,ca);ca=null!==(P=null!==(t=null===(k=Jb.linkedStyle)||void 0===k?void 0:k.m8)&&void 0!==t?t:null===(D=Jb.aw)||void 0===D?void 0:D.m8)&&void 0!==P?P:10;return this.nHb(ca-1)?this.eHh(b,qb,ca):null}eHh(b,k,t){var D;if(!this.nHb(t-1))return null;const {PAj:P,OAj:ca}=this.rLo(b,k);return 0===P.length?null:(k=null===(D=pe.ParagraphReader.sSd(b,P))||void 0===D?void 0:D.trim())&&""!=k?new Ov(ca.xd,ca.endCp,k,b,null,t):null}Kcm(b,k,t){const D=[];let P={linkedStyle:null,
aw:null},ca=null,ta=null;for(const Na of b)if(ca=Na.chp.formatting?this.oXl(k,Na.chp):ca,b=t(Na)){if(!ta&&b){ta=ca;if(!ta)break;P=ca}else if(!this.QJm(ca,ta))break;D.push(Na)}return{nqm:D,aDl:P}}rLo(b,k){var t;let D=-1,P;for(P=0;P<k.length;P++){var ca=k[P],ta=b.characterData.substring(ca.chp.cp,ca.cpEnd),Na=null===ta||void 0===ta?void 0:ta.trimStart();if(Na){D=ca.chp.cp+(ta.length-Na.length);break}}if(-1===D)return{PAj:[],OAj:{xd:-1,endCp:-1}};ca=-1;for(ta=k.length;0<ta;ta--){Na=k[ta-1];const qb=
b.characterData.substring(Na.chp.cp,Na.cpEnd),Jb=null===qb||void 0===qb?void 0:qb.trimEnd();if(Jb){ca=Na.cpEnd-(qb.length-Jb.length);break}}return{PAj:null!==(t=k.slice(P,ta))&&void 0!==t?t:[],OAj:{xd:D,endCp:ca}}}QJm(b,k){return null==b&&null==k&&b===k?!0:null==b||null==k?!1:k.linkedStyle&&b.linkedStyle&&k.linkedStyle.m8===b.linkedStyle.m8||k.aw&&b.aw&&k.aw.YBh==b.aw.YBh?!0:!1}oXl(b,k){k=Je.FormattingReader.Fna(k.formatting);b=this.rXl(b,k);k=this.nXl(k);return b||k?{linkedStyle:b,aw:k}:null}rXl(b,
k){b=this.we.Fva(k,b);if(!b)return null;k=b.ia(Cc.a.Ji,9);return this.P7c(k)?{ngp:b.id,m8:k+1}:null}nXl(b){var k;b=this.we.kg(b);if(!b||!dl.a.L_d(b))return null;const t=null!==(k=dl.a.y7b(b))&&void 0!==k?k:"0";k=Number.parseInvariant(t);return this.nHb(k-1)?{YBh:b,m8:k}:null}vhm(b){const k=pe.ParagraphReader.vna(b);if(this.P7c(k))return new Ov(0,b.characterData.length,b.characterData,b,null,k+1);if(this.nHb(k)){var t=this.we.Lo(b);t=this.we.kg(t);if(dl.a.YHb(t))return new Ov(0,b.characterData.length,
b.characterData,b,null,k+1)}return null}mXl(b){var k;let t=k=null,D=-1;var P=-1,ca=this.we.JC(b);for(let Na=0;Na<b.pa.length;Na++)if(k=b.pa.J(Na),k.formatting){var ta=Je.FormattingReader.Fna(k.formatting);const qb=this.we.kg(ta);if(!t&&(t=qb,P=(P=dl.a.y7b(t))?Number.parseInvariant(P):0,!this.nHb(P-1)))break;ta=(ta=this.we.Fva(ta,ca))?ta.ia(Cc.a.Ji,9):9;D=-1===D?ta:D;if(!(this.P7c(ta)&&D===ta||dl.a.L_d(qb)&&t===qb))break}k=k.cp;ca=b.characterData.substring(0,k);return this.P7c(D)?new Ov(0,k,ca,b,null,
D+1):dl.a.L_d(t)?new Ov(0,k,ca,b,null,P):null}zTm(b){const k=pe.ParagraphReader.vna(b);if(!this.nHb(k))return!1;if(this.P7c(k))return!0;b=this.we.Lo(b);b=this.we.kg(b);return dl.a.YHb(b)?!0:!1}P7c(b){return this.dzf&&this.nHb(b)}nHb(b){return b>=this.$Ib&&b<=this.HQb}}Object(n.a)(Xg,"StyleBasedDocumentHeadings",null,[295]);var Nm=c(1007);class jy{constructor(){this.startTime=0}}Object(n.a)(jy,"TocCallbackData",null,[]);class qs{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){this.Vmg=(ac,yc,Kc)=>{const ed=
yc.node;if(!ed)return v.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),2;if(12!==ed.type)return v.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!ed.vr)return 2;if(1===Kc)return $b.SessionStatusManager.instance.wj?8:32;this.ld&&this.ld.isFeatureEnabled(121)?this.SBc.SSo(ed).then(sd=>{sd||this.WGj(ed)}):this.WGj(ed);return 32};this.mXo=ac=>{ac=window.performance.now()-ac.startTime;v.ULS.sendTraceTag(574408796,
3019,50,String.format("UpdateTOC Duration: {0} ms;",ac));ac=Object.assign(new Db.a,{durationMs:ac});xa.Health.instance.recordKpiSuccess(qs.DKj,ac);qs.y7a()};this.Fri=(ac,yc,Kc,ed,sd)=>{if(pe.ParagraphReader.Wb(yc.node)&&yc.node.vr)return 2;if(1===Kc)return $b.SessionStatusManager.instance.wj?8:32;if(yc.contextId!==lc.a.Tc||this.Ik.A8(yc)||!pe.ParagraphReader.Wb(yc.node))return 32;this.Ud.Js(17);(null===sd||void 0===sd?0:sd.resolve)?this.SBc.mKh(yc,sd.resolve):this.SBc.mKh(yc);return 32};this.y5f=
(ac,yc,Kc)=>{ac=yc.node;if(!ac)return v.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==ac.type)return v.ULS.sendTraceTag(39358979,324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),2;if(!ac.vr)return 2;if(1===Kc)return $b.SessionStatusManager.instance.wj?8:32;Kc=null;ac.isConnected&&(Kc=Nm.a.P7b(ac,!0),Kc.Clc(ac));yc=new ze.GraphIterator;yc.set(ac);yc.zb(8);yc.hd(8);const ed=this.Hc.Mc(15);ed.hu(yc);this.SBc.RXn(ac)?(ed.dispose(),
Kc&&Kc.normalize(),qs.y7a()):(Kc&&Kc.cancel(),ed.dispose(),v.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.xed=k;this.Wc=D;this.Hc=P;this.Ik=ca;this.SBc=ta;this.Ud=Na;this.ld=qb;this.$Vg=Jb;this.FN=Vb}Tb(){this.ga.qa(Pb.a.DQb,lc.a.paragraph,this.Vmg);this.ga.qa(Pb.a.DQb,lc.a.Hd,this.Vmg);this.ga.qa(Pb.a.DQb,lc.a.Tc,this.Vmg);this.ga.Vc(Pb.a.DQb,1028);this.ga.qa(Nc.a.AAf,lc.a.Tc,this.Fri);this.ga.Vc(Nc.a.AAf,1028);this.ga.qa(Nc.a.Z3c,lc.a.paragraph,this.y5f);
this.ga.qa(Nc.a.Z3c,lc.a.Hd,this.y5f);this.ga.qa(Nc.a.Z3c,lc.a.Tc,this.y5f);this.ga.Vc(Nc.a.Z3c,1028)}WGj(b){xa.Health.instance.recordKpiUsage(qs.DKj,1,qs.qB,null);const k=this.KLl(b),t=new jy;t.startTime=window.performance.now();this.xed.eij(k,Cc.a.Zlg,this.Yfm(this.l5l(b)),this.mXo,null,t);this.SBc.aUk()}SOj(b){if(null!=b&&b.vr)if(null==this.$Vg.instance)v.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");else{var k=this.$Vg.instance.Aci();b=this.NBl(b);var t=!1;1===this.FN.Uu&&
(t=!0);0!=b&&k!=b&&(k=[Object.assign(new na.a,{name:"TOCPageNo",string:b}),Object.assign(new na.a,{name:"HeadingPageNo",string:k}),Object.assign(new na.a,{name:"isPageView",string:t})],bf.a("TOCPageNoMismatch",!0,void 0,k))}}NBl(b){for(let k=0;k<b.pa.length;k++){const t=b.pa.J(k);if(null!=t.$c)for(let D=0;D<t.$c.length;D++){const P=t.$c.J(D);if(1===P.yg&&P.instruction.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(t.cp,b.characterData.length-t.cp))}}return 0}l5l(b){return b?b.ia(Cc.a.gN,
null):(v.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}KLl(b){return this.Wc.jEa(b,7,7).Rb(35)}Yfm(b){const k=[];k.push(b+",TOC,0");return k}static y7a(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(k=>{k.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},qs.wDa)}}qs.wDa=5E3;qs.DKj="WordUpdateTOC";qs.qB="wwaengidc";
Object(n.a)(qs,"TableOfContentsActor",null,[294]);class ky{}Object(n.a)(ky,"FieldData",null,[]);class IB extends ky{constructor(){super();this.Ipb=null}}Object(n.a)(IB,"TOCFieldData",ky,[]);class tx{constructor(b,k,t,D,P,ca=null){this.pqm=b;this.jt=k;this.Ph=t;this.ovj=D;this.listMarker=P;this.JQa=ca}}Object(n.a)(tx,"TOCHeadingData",null,[]);class ly{constructor(b,k){this.FVa=b;this.nn=k}async s9h(b){this.FVa.dzf=b.ezf;this.FVa.$Ib=b.$Ib;this.FVa.HQb=b.HQb;return this.FVa.sXl()}uMl(b){if(b=this.tMl(b))return this.nn.tva(b)}tMl(b){const k=
b.pa.length;for(let t=0;t<k;t++){const D=b.pa.J(t);if(D.hyperlink&&D.hyperlink.Zga&&D.hyperlink.url.startsWith(F.a.Sdb))return D.hyperlink.url.substr(D.hyperlink.url.indexOf("_Toc"))}return null}Kce(b){(b=this.uMl(b))&&this.nn.gSf(b.id)}Lcm(){return this.FVa.pXl()}Q1i(b,k){const t=new IB,D=new Eb.a;for(const P of b){b=this.Jcm(P,k);if(!b)return null;D.add(b)}t.Ipb=D;return t}Jcm(b,k){let t;if(k&&(t=this.M7k(b),!t))return v.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),
null;k=Un.AParagraphNode.OU(b.characterData.trim());const D=this.Aem(b.m8);return new tx(k,t,b.Ph,D,b.listMarker,b.JQa)}M7k(b){const k=String.format("{0}{1}","_Toc",Ne.a.vF());return this.nn.jDc(k,b.begin,b.end,b.paragraphNode,b.paragraphNode)?k:null}Aem(b){return String.format("toc {0}",b)}}Object(n.a)(ly,"TOCDataManager",null,[293]);class Bw{neg(){const b=Object.assign(new Uc.StandardDialog,{rt:w.AFrameworkApplication.Oba,Ad:0,HHa:!1});b.XU(1);b.Yia(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,
WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=Bw.bCg?Bw.bCg:Bw.bCg=new Bw}}Object(n.a)(Bw,"TOCDialogHelper",null,[]);var sC=c(183),tC=c(490),Fz=c(268),Gz=c(149);class Wj{constructor(b,k,t,D,P,ca,ta){this.oeg=b;this.Ajb=k;this.ezf=t;this.$Ib=D;this.HQb=P;this.Pyb=ca;this.uad=[];this.instruction=ta}toString(){return"showPageNumber:"+this.oeg+"  isHyperlink:"+this.Ajb+" includeOutlineLevels:"+this.ezf+" lowerOutlineLevel:"+this.$Ib+" upperOutlineLevel:"+
this.HQb+" addContentControl:"+this.Pyb+" unsupportedSwitches:"+this.uad.toString()}}Object(n.a)(Wj,"TOCSettings",null,[]);class ri{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed,sd,oe,Ld,Od){this.OZg="TOC";this.ojf=this.Rwe=this.SUe=null;this.m7a=b;this.nh=k;this.rD=t;this.Qu=D;this.Sy=P;this.Ik=ca;this.ib=ta;this.Kd=Na;this.Eih=qb;this.ve=Jb;this.QUe=Vb;this.So=yc;this.zI=Kc;this.Jn=ed;this.Hc=sd;this.Hb=oe;this.zd=Ld;this.eb=Od}static get HSo(){if(null!=ri.hxd)return ri.hxd;w.AFrameworkApplication.ue("i430a979-t;a1f4j306-c");
ri.hxd=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateEmptyTOCFormattingRunId",!1);return ri.hxd}get KSc(){return this.OZg}set KSc(b){this.OZg=b}get Jpb(){this.SUe||(this.SUe=this.Y6h());return this.SUe}Y6h(){return new Wj(!0,!0,!0,0,8,!0,this.YDn())}async mKh(b,k){bf.a(ri.ndl);const t=window.performance.now();if(this.eb.Wb(b.node))if(this.Ik.A8(b))v.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),
ri.QQa("IP is in locked range");else{var D=await this.m7a.s9h(this.Jpb);if(D){var P=new Df.a(2,1,0,()=>{this.pdl(b,D,this.Jpb.Ajb,t);k&&k()});this.Hb.Vb(P)}else v.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),ri.QQa("Failed to get TOC data")}else v.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),ri.QQa("Context should be paragraph")}pdl(b,k,t,D=0){let P;try{if(0==D&&(D=window.performance.now()),this.FYh(b.node)){var ca=
new ze.GraphIterator;ca.set(b.node);ca.zb(7);ca.hd(7);P=this.Hc.Mc(15);P.hu(ca);var ta=this.m7a.Q1i(k,t);ta||ri.QQa("Failed to prepare TOC Field data");var Na=ta.Ipb?ta.Ipb.count:0;if(Na){k=null;var qb;for(t=0;t<Na;t++){const yc=ta.Ipb.J(t);if(!({vBb:qb}=this.Cri(b,k,t,Na,yc,Vb?Vb.toString():void 0)).returnValue){ri.QQa("Failed to populate new TOC paragraph");return}if(0==t){var Jb=qb.currentNode;var Vb=pe.ParagraphReader.LQ(Jb)}k=qb}if(this.Jpb.Pyb&&!this.M$e(Jb.id,k.Nn.id))ri.QQa("Failed to add content control block");
else{var ac=window.performance.now()-D;bf.a(ri.mbf,!0,ac)}}else if(this.QUe.neg(),this.a9k(b)){const yc=window.performance.now()-D;bf.a(ri.mbf,!0,yc)}}else ri.QQa("Failed to fetch style set")}catch(yc){ri.QQa(String.format("{0} {1}",yc.message,yc.stack))}finally{P&&P.dispose()}}FYh(b){this.Rwe=this.Sy.JC(b);return this.Rwe?!0:(v.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static TFa(b){b=[Object.assign(new na.a,{name:ri.kXo,string:b})];bf.a(ri.Xmg,!1,void 0,b)}static UKf(b){b=
[Object.assign(new na.a,{name:ri.uZn,string:b})];bf.a(ri.F$i,!1,void 0,b)}static QQa(b){b=[Object.assign(new na.a,{name:ri.odl,string:b})];bf.a(ri.mbf,!1,void 0,b)}async SSo(b){const k=this.Kgi(b);if(null==k)ri.TFa("Cannot update TOC when firstTocPara = null");else{var t=this.Ncm(k);if(0<t.uad.length)return this.c6m(t.uad),!1;bf.a(ri.jXo);var D=window.performance.now(),P=await this.m7a.s9h(t);if(!P)return v.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),ri.TFa("Failed to fetch TOC data"),
!1;b=new Df.a(1,1,0,()=>{this.lXo(k,P,t,D)});this.Hb.Vb(b);return!0}}lXo(b,k,t,D=0){let P;try{if(null==b)ri.TFa("Attempt to update TOC when firstTocPara = null");else{0==D&&(D=window.performance.now());var ca=new ze.GraphIterator;ca.set(b);ca.zb(7);ca.hd(7);P=this.Hc.Mc(15);P.hu(ca);var ta=this.m7a.Q1i(k,t.Ajb);if(null==ta)ri.TFa("Attempt to update TOC when tocFieldData = null");else{var Na;if(({T5e:Na}=this.c$i(b,t)).response){v.ULS.sendTraceTag(559018207,3019,50,String.format("Attempting to update TOC with settings: {0}",
t.toString()));var qb=ta.Ipb?ta.Ipb.count:0;if(this.FYh(b)){var Jb;this.czi(b)&&(this.E$i(b),(b=this.eb.ig(b,!1,!0))&&(Jb=b.ia(Cc.a.Lc,null).toString()));var Vb=b.ia(Cc.a.gN,null);k=Vb;Jb=null!==Jb&&void 0!==Jb?Jb:Vb;if(qb){for(var ac=0,yc;b.vr&&k==Vb&&ac<qb;){const sd=ta.Ipb.J(ac);t.Ajb&&this.m7a.Kce(b);if(!this.NWo(b,ac,qb,sd,t)){v.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");ri.TFa("Failed to update TOC paragraph");return}b.setValue(Cc.a.gN,Jb);ac++;yc=b;b=this.eb.ig(yc,
!1,!0);if(!b){k=null;break}this.jzi(b)&&this.D$i(b);k=b.ia(Cc.a.gN,null)}k==Vb&&this.n5f(b);var Kc;if(({fIf:Kc}=this.jtk(ta,ac,qb,yc,Jb)).response)if(t.Pyb&&!this.M$e(Na,Kc.id))ri.TFa("Failed to add content control block");else{var ed=window.performance.now()-D;bf.a(ri.Xmg,!0,ed)}else ri.TFa("Failed to add new paragraph")}else this.QUe.neg(),this.gXo(b,t.Pyb,Na,t.instruction,Jb)&&(ac=window.performance.now()-D,bf.a(ri.Xmg,!0,ac))}else ri.TFa("Failed to fetch style set")}else ri.TFa("Failed to remove Content Control")}}}catch(sd){ri.TFa(String.format("{0} {1}",
sd.message,sd.stack))}finally{P&&P.dispose()}}jtk(b,k,t,D,P){let ca=new ze.GraphIterator;for(ca.set(D);k<t;){D=b.Ipb.J(k);if(!({vBb:D}=this.Cri(null,ca,k,t,D,P)).returnValue)return{fIf:ca.currentNode,response:!1};ca=D;k++}return{fIf:ca.currentNode,response:!0}}c$i(b,k){var t,D,P;let ca,ta;const Na=null===(t=null===b||void 0===b?void 0:b.pa)||void 0===t?void 0:t.first.Jb;if(Na&&0<Na.length)if(b=b.pa.first.Jb.J(0),b.Mf){t=b.contentControlNode.getValue(Cc.a.Ow);ca=hi.a.xj?this.zd.yq(b.contentControlNode.id,
!0):this.zd.Ms.get(null===(D=b.contentControlNode.id)||void 0===D?void 0:D.toString());ta=hi.a.xj?this.zd.yq(b.contentControlNode.id,!1):this.zd.kt.get(null===(P=b.contentControlNode.id)||void 0===P?void 0:P.toString());if(0!=this.So.AMb(t))return v.ULS.sendTraceTag(558952907,3019,10,"Failed to release content control"),{response:!1,T5e:ca,wBh:ta};k.Pyb=!0}else v.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),k.Pyb=!1;else k.Pyb=!1;return{response:!0,T5e:ca,wBh:ta}}gXo(b,
k,t,D,P){v.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.m7a.Kce(b);const ca=this.rOd(b);if(!this.X0i(ca,k,t,D))return ri.TFa("Failed to populate empty TOC."),!1;if(k=this.eb.ig(b,!1,!0))t=b.ia(Cc.a.gN,null),D=k.ia(Cc.a.gN,null),t==D&&this.n5f(k);b.setValue(Cc.a.gN,P);return!0}X0i(b,k,t,D){this.Kd.replaceTextRange(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.rOi(b);const P=b.pa.first;this.ve.nL(P.formatting,!0);this.Z$e(b,0,1,D);ri.HSo&&P.Ecg&&b.ze.iq.Z(P.formatting.re,
gu.CharacterPropertiesEditor.HM);return k&&t&&!this.M$e(t,b.id)?!1:!0}rOd(b){b.pa.reset();b.IZa();const k=new sC.a(b,0);k.formatting=new Gz.a(k,X.a.nil);k.Sh=!0;b.pa.add(k);return Of.a.createTextRange(b,0,b.characterData.length)}czi(b){if(pe.ParagraphReader.PQ(b)){var k=b.pa.last.$c;if(!k||!k.length)return!1;if(4<=k.length){b=0===k.J(k.length-4).yg;const t=1===k.J(k.length-3).yg&&k.J(k.length-3).instruction.trim().startsWith(this.KSc),D=2===k.J(k.length-2).yg;k=5===k.J(k.length-1).yg;return b&&t&&
D&&k}}return!1}jzi(b){if(pe.ParagraphReader.PQ(b)){var k=b.pa.first.$c;if(!k||!k.length)return!1;if(2<=k.length)return b=4===k.J(0).yg,k=3===k.J(1).yg,b&&k}return!1}E$i(b){const k=b.pa.last.$c,t=k.J(k.length-4),D=k.J(k.length-3),P=k.J(k.length-2),ca=k.J(k.length-1);k.remove(t);k.remove(D);k.remove(P);k.remove(ca);b.removeProperty(Cc.a.gN)}D$i(b){const k=b.pa.first.$c,t=k.J(0),D=k.J(1);k.remove(t);k.remove(D);b.removeProperty(Cc.a.gN)}n5f(b){if(b){var k=b.ia(Cc.a.gN,null),t=b.ia(Cc.a.Lc,null).toString(),
D=k;t==k&&this.czi(b)&&(this.E$i(b),(b=this.eb.ig(b,!1,!0))&&(D=b.ia(Cc.a.gN,null)));t=new ze.GraphIterator;t.set(b);t.zb(8);v.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var P;b&&b.vr&&D==k&&P!=b;){if(this.jzi(b)){this.D$i(b);break}this.m7a.Kce(b);this.Jn.Vd(t);D=this.Jn.Ur(t,!1,!0);this.nh.ZGa(b);if(!D)return null;P=b;t.Rb(2);D=(b=t.currentNode)?b.ia(Cc.a.gN,null):null}return b}}Ncm(b){var k=b.pa,t=k?k.length:0,D=null;b=new Wj(!0,!1,!1,0,8,!0,void 0);for(let P=
0;P<t&&(D=this.Mcm(k.J(P)),b.instruction=D,D=this.H$l(D),D[0]!==this.KSc);P++);k=D?D.length:0;for(t=1;t<k;t++)switch(D[t]){case "\\h":b.Ajb=!0;break;case "\\u":b.ezf=!0;break;case "\\o":this.hjo(D[t+1],b)&&t++;break;case "\\z":break;case "\\n":b.oeg=!1;b.uad.push(D[t]);break;default:b.uad.push(D[t])}return b}hjo(b,k){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&3===b.length?(k.$Ib=Number.parseInvariant(b[1])-1,k.HQb=Number.parseInvariant(b[2])-1,!0):!1}RXn(b){try{bf.a(ri.tZn);const k=window.performance.now(),
t=this.Kgi(b);if(null==t){ri.UKf("Attempt to remove TOC when firstTocPara = null");return}let D,P,ca;const ta=this.Y6h();if(!({T5e:D,wBh:P}=this.c$i(t,ta)).response)return ri.UKf("Failed to remove content control"),!1;if(void 0==D&&void 0==P)ca=this.n5f(t);else{ca=t.Kc.Db(D);const qb=new ze.GraphIterator;qb.set(ca);qb.zb(8);b=!1;let Jb;for(;!b&&ca&&Jb!=ca;){ca.id.equals(P)&&(b=!0);ca&&ca.vr&&this.m7a.Kce(ca);this.Jn.Vd(qb);const Vb=this.Jn.Ur(qb,!1,!0);this.nh.ZGa(ca);if(!Vb){ca=null;break}qb.Rb(2);
Jb=ca;ca=qb.currentNode}}ca&&this.ZYc(ca);const Na=window.performance.now()-k;bf.a(ri.F$i,!0,Na)}catch(k){ri.UKf(String.format("{0} {1}",k.message,k.stack))}return!0}ZYc(b){b=Of.a.Rc(b,0);b=new Eg.Selection([b],!0);this.ib.setSelection(b)}M$e(b,k){return this.So.Ela(b,k,null,ri.Qol,!0).returnValue?(v.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),!1):!0}aUk(){this.m7a.Lcm()||this.QUe.neg()}Kgi(b){if(!b.vr)return v.ULS.sendTraceTag(528320659,3019,
15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ia(Cc.a.gN,null);return this.zI.v5l(b)}c6m(b){b.length&&(b=[Object.assign(new na.a,{name:"UnsupportedSwitches",string:b.toString()})],bf.a("UnsupportedTocInstruction",void 0,void 0,b))}Mcm(b){const k=(b=b.$c)?b.length:0;for(let t=0;t<k;t++)if(1===b.J(t).yg&&b.J(t).instruction.trim().startsWith(this.KSc))return b.J(t).instruction.trim();return null}H$l(b){const k=[];if(!b)return k;b=b.split(" ");return b.length?b:k}a9k(b){b=this.JLh(b,
null,!0,void 0).returnValue;if(!b)return ri.QQa("Failed to create paragraph"),!1;const k=Of.a.Rc(b,0);if(!this.X0i(k,!0,b.id,this.Jpb.instruction))return ri.QQa("Failed to populate empty TOC"),!1;v.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}JLh(b,k,t,D){let P,ca;t&&b?(P=this.q9k(b),ca=P.currentNode,D=pe.ParagraphReader.LQ(ca).toString()):k&&(P=this.C2l(k),ca=this.nh.OI(P));if(!ca)return v.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),
{returnValue:null,vBb:P};ca.setValue(Cc.a.gN,D);return{returnValue:ca,vBb:P}}YDn(){const b=new Sys.StringBuilder(this.KSc);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}mEn(b){const k=new Sys.StringBuilder("PAGEREF ");k.append(b);this.Jpb.Ajb&&k.append(" \\h");return k.toString()}C2l(b){b.yd();this.Jn.Vd(b);return this.nh.aoa(b,!1)}q9k(b){const k=new ze.GraphIterator;k.set(b.node);k.yd();this.Jn.Vd(k);let t=this.jbi(k);const D=!b.cpBegin;if(va.OutlineElementReader.isEmpty(k,!0))return this.kri(t);
if(D)return this.nh.yB(t,!0,!1),this.nh.N9(k,t,b,!1,!1,!1),b=this.jbi(t),this.kri(b);t=this.nh.aoa(k);this.nh.N9(k,t,b,!1,!1,!0);b=this.nh.aoa(k);this.nh.dOb(b.currentNode,!1);this.nh.OI(b);this.Jn.Ge(b);return b}jbi(b){const k=new ze.GraphIterator;k.Yc(b);k.yd();return k}kri(b){this.nh.yB(b,!0,!0);this.nh.dOb(b.currentNode,!1);this.Jn.Ge(b);return b}rOi(b){const k=b.pa;1===k.length&&(k.first.Sh=!1,b.cKd().Sh=!0)}NWo(b,k,t,D,P){const ca=this.rOd(b);this.Kd.replaceTextRange(ca,"");this.a1i(b,D,P);
this.Z$e(b,k,t,P.instruction);return P.Ajb&&!this.hG(b,D.jt)?!1:!0}Cri(b,k,t,D,P,ca){k=({vBb:b}=this.JLh(b,k,0==t,ca)).returnValue;if(!k)return{returnValue:!1,vBb:b};this.a1i(k,P,this.Jpb);this.Z$e(k,t,D,this.Jpb.instruction);return this.Jpb.Ajb&&!this.hG(k,P.jt)?{returnValue:!1,vBb:b}:{returnValue:!0,vBb:b}}a1i(b,k,t){this.Pzm(b,k.pqm,k.listMarker,k.ovj,k.JQa);this.Eih.oBm(b,b.characterData.length);t.oeg&&this.IAm(b,k);this.rOi(b);this.zlo(b,k.ovj)}c0l(b,k){if(!b)return 0;const t=ri.Bem();return 4<
b.length?t.J(k)+.5*Math.floor(b.length/3):t.J(k)}Pzm(b,k,t,D,P){t&&this.eAm(b,t,D);t=Of.a.Rc(b,b.characterData.length);this.Kd.replaceTextRange(t,k);P&&(b=b.pa.Oh(0),this.ve.Mia(b.formatting,P))}eAm(b,k,t){t=this.c0l(k,t);const D=Of.a.Rc(b,0);this.Kd.replaceTextRange(D,k);this.Eih.fAm(b,k.length,t)}IAm(b,k){var t=Of.a.Rc(b,b.characterData.length);this.Kd.replaceTextRange(t,k.Ph.toString());t=b.pa.Oh(b.characterData.length-k.Ph.toString().length);k=this.mEn(k.jt);this.HPa(b,t,0,2,k);this.HPa(b,t,1,
2,k);this.HPa(b,t,2,2,k);t=b.pa.Oh(b.characterData.length);this.HPa(b,t,3,2,k)}zlo(b,k){k=this.Rwe.Fi(k);this.Qu.HJ(k,b,!0)}Z$e(b,k,t,D){const P=b.pa.first,ca=b.pa.last;k?this.HPa(b,P,4,1,D):(this.HPa(b,P,0,1,D),this.HPa(b,P,1,1,D),this.HPa(b,P,2,1,D));k===t-1?this.HPa(b,ca,3,1,D):this.HPa(b,ca,5,1,D)}HPa(b,k,t,D,P=null){t=new tC.a(k,null,t,D,!0,!1,!1,P);k.$c||(k.$c=new Fz.a(k));k.$c.add(t);b.Xl();this.Udl(t,b)}Udl(b,k){b.re?k.ze.PX(b.re-1,2):k.ze.Zna(b.re,2);k.ze.iq.Z(b.re,gu.CharacterPropertiesEditor.HM);
k.ze.Vs.Z(b.re,gu.CharacterPropertiesEditor.pR)}hG(b,k){b=Of.a.createTextRange(b,0,b.characterData.length);return this.rD.hG(b,k,!1,!1,!1,!0)?!0:(v.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static Bem(){ri.jta||(ri.jta=new cb.a,ri.jta.Z("toc 1",1),ri.jta.Z("toc 2",1.5),ri.jta.Z("toc 3",2),ri.jta.Z("toc 4",2.5),ri.jta.Z("toc 5",3),ri.jta.Z("toc 6",3.5),ri.jta.Z("toc 7",4),ri.jta.Z("toc 8",4.5),ri.jta.Z("toc 9",5));return ri.jta}}ri.jta=null;
ri.Qol="Table of Contents";ri.ndl="CreateTocClient";ri.mbf="CreateTocSuccess";ri.odl="CreateTocFailureCause";ri.jXo="UpdateTocClient";ri.Xmg="UpdateTocSuccess";ri.kXo="UpdateTocFailureCause";ri.tZn="RemoveTocClient";ri.F$i="RemoveTocSuccess";ri.uZn="RemoveTocFailureCause";ri.hxd=null;Object(n.a)(ri,"TOCField",null,[291,292]);var Cw=c(636);class Sy{constructor(b,k){this.eAa=b;this.jJa=k}oBm(b,k){if(pe.ParagraphReader.Wb(b)&&!(0>k)){var t=xn.a.O1b(b);t=new Cw.a(t,4,1,1);this.eAa.oWd(b,t);b=Of.a.Rc(b,
k);this.jJa.BWd(b)}}fAm(b,k,t){var D=bd.a.lM/2;const P=b.pa.thb(k);D=Je.FormattingReader.Rn(P.formatting,sf.a.fontSize,2*D)/2;t=new Cw.a(Ef.a.Dv(D/36)*t,1,0,1);this.eAa.oWd(b,t);b=Of.a.Rc(b,k);this.jJa.BWd(b)}}Object(n.a)(Sy,"TOCTabUtility",null,[290]);class ux{constructor(){this.W=null}get name(){return"WordEditor.TableOfContents"}xc(b){this.W=b;this.W.ha("WordEditor.AutoSaveParamsUpdateService",()=>new pl.a(this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Nv.a.FQ)).singleInstance();this.W.ha("WordEditor.TableOfContents.StyleBasedDocumentHeadings",
()=>new Xg(new Rg.a(()=>Wa.App.ya.gb.Uc),Wk.PageNavigator.instance,this.W.resolve("Box4.Styles.IWACStyleReader"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IListMarkerUtility"),new Pp.a,new Rg.a(()=>Wa.App.ya.gb.wc))).as("WordEditor.TableOfContents.IDocumentHeadings").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCDataManager",()=>new ly(this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").singleInstance();
this.W.ha("WordEditor.TableOfContents.TOCTabUtility",()=>new Sy(this.W.resolve("WordEditor.ICustomTabStopUtility"),this.W.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCField",()=>new ri(this.W.resolve("Box4.ITOCDataManager"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("Box4.Styles.IWACStyleEditor"),this.W.resolve("Box4.Styles.IWACStyleReader"),Yj.a.instance,
this.W.resolve("Box4.ISelectionManager"),this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("WordEditor.TableOfContents.ITOCTabUtility"),this.W.resolve("Box4.IFormattingEditor"),Bw.instance,this.W.resolve("Box4.IFeatureHelper"),this.W.resolve("WordEditor.ContentControl.IContentControlManager"),this.W.Na("WordEditor.ParagraphWordIdMapping"),this.W.resolve("Box4.IOutlineElementNavigator"),tk.a.instance,w.AFrameworkApplication.nc,this.W.resolve("Box4.ContentControlParagraphMapping"),b.resolve("Box4.IParagraphReader"))).as("WordEditor.TableOfContents.ITOCField").singleInstance();
this.W.ha("WordEditor.TableOfContents.TableOfContentsActor",()=>new qs(w.AFrameworkApplication.va,this.W.resolve("WordEditor.AutoSaveParamsUpdateService"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.Graph.IGraphIteratorFactory"),tk.a.instance,Yj.a.instance,this.W.resolve("WordEditor.TableOfContents.ITOCField"),this.W.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.W.resolve("Box4.IFeatureHelper"),this.W.Sa("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").singleInstance()}init(){this.W.resolve("WordEditor.TableOfContents.ITableOfContentsActor").Tb()}dispose(){}}
Object(n.a)(ux,"PackageManager",null,[1,2]);class yl{constructor(b,k,t,D,P,ca,ta,Na){this.bSa=(qb,Jb,Vb,ac,yc)=>{if(!({fy:qb}=this.Eob(Jb,Vb,yc,!0,!0)).returnValue)return qb;this.Mvd.WKh(yc,Jb.node);return 32};this.Wxa=(qb,Jb,Vb,ac,yc)=>this.rli(Jb,Vb,ac,yc,!0);this.nLb=(qb,Jb,Vb,ac,yc)=>{if(!({fy:qb}=this.Eob(Jb,Vb,yc,!1,!0)).returnValue)return qb;this.Mvd.dal(yc,Jb.node);v.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.Rla=(qb,Jb,Vb,ac,yc)=>{if(!({fy:ac}=this.Eob(Jb,Vb,yc,!1,
!0)).returnValue)return 2==Vb&&8==ac&&qr.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],He.a.JCb),ac;const Kc=Jb.node;let ed=null;(ed=qb===Pb.a.Rla?this.Mvd.ZQb(yc[kg.a.SourceControlId],Kc):this.ey.x8b(Kc,yc))?(this.N9d(Kc,()=>{this.Oxd.z6a(ed,Kc)}),this.BP(),ac=32):(qr.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],He.a.JCb),ac=8);qb===Pb.a.Rla&&32===ac&&v.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");v.ULS.shipAssertTag(0,
324,32===ac);return ac};this.Hta=(qb,Jb,Vb,ac,yc)=>this.rli(Jb,Vb,ac,yc,!1);this.Gke=(qb,Jb,Vb,ac,yc)=>Er.a.tpa(qb,Jb,Vb,ac,yc,{},14);this.tAb=(qb,Jb,Vb,ac,yc)=>{if(!({fy:qb}=this.Eob(Jb,Vb,yc,!1,!1)).returnValue)return qb;const Kc=Jb.node;this.N9d(Kc,()=>{this.Oxd.GXk(Kc)});return 32};this.ey=b;this.Mvd=k;this.ga=t;this.Oxd=D;this.Hc=P;this.Nz=ca;this.y8j=Na}Tb(){this.Mgc(Wa.App.NTa.xKh())}Mgc(b){this.ga.qa(Pb.a.bSa,lc.a.view,b);this.ga.qa(Pb.a.bSa,lc.a.table,this.bSa);this.ga.Vc(Pb.a.bSa,1127);
this.ga.qa(Pb.a.Rla,lc.a.view,this.Gke);this.ga.qa(Pb.a.Rla,lc.a.table,this.Rla);this.ga.Vc(Pb.a.Rla,1030);this.ga.qa(Pb.a.applyStyle,lc.a.table,this.Rla);this.ga.qa(Pb.a.Hta,lc.a.view,this.Gke);this.ga.qa(Pb.a.Hta,lc.a.table,this.Hta);this.ga.Vc(Pb.a.Hta,1038);this.ga.qa(Pb.a.Wxa,lc.a.view,b);this.ga.qa(Pb.a.Wxa,lc.a.table,this.Wxa);this.ga.Vc(Pb.a.Wxa,1127);this.ga.qa(Pb.a.nLb,lc.a.view,b);this.ga.qa(Pb.a.nLb,lc.a.table,this.nLb);this.ga.Vc(Pb.a.nLb,1126);this.ga.qa(Pb.a.tAb,lc.a.view,this.Gke);
this.ga.qa(Pb.a.tAb,lc.a.table,this.tAb);this.ga.Vc(Pb.a.tAb,1028)}BP(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(k=>{k.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}rli(b,k,t,D,P){if(!({fy:ca}=this.Eob(b,k,D,P,!0)).returnValue)return 2==k&&8==ca&&qr.a.recordQosError("TableStyleOptionButtonClickNoResponse",
["TableInteractionFailed"],He.a.lyl),ca;b=b.node;k=this.ey.$T(b);var ca=D[kg.a.On];const ta=yl.fdm(D.MenuItemId);P?D[kg.a.On]=yl.lro(k,ta):(this.AEk(k,ta,ca,b),t.ks=ta,t.vC=ca?0:1,v.ULS.shipAssertTag(0,324,!!ta));return 32}N9d(b,k){const t=this.Hc.Mc(15);try{t.Cb(b),this.Nz.K5a(),k()}finally{t&&t.dispose()}}Eob(b,k,t,D,P){return this.KRm(b,k,t,D,P)?{returnValue:D||2===k,fy:32}:{returnValue:!1,fy:8}}KRm(b,k,t,D,P){if(b.contextId!==lc.a.table)return!1;if(D||2===k)if(P&&!t||!Object(ob.a)(bt.TableNode,
b.node)||this.y8j(b.node))return!1;return!0}AEk(b,k,t,D){const P=(512===k||1024===k?!t:t)?b|k:b&~k;P!==b&&this.N9d(D,()=>{this.Oxd.Dya(P,D)})}static kD(){yl.Ecb[yl.VCl]=32;yl.Ecb[yl.MCl]=128;yl.Ecb[yl.MVm]=64;yl.Ecb[yl.DVm]=256;yl.Ecb[yl.fIk]=512;yl.Ecb[yl.eIk]=1024}static lro(b,k){b=!!(b&k);if(512===k||1024===k)b=!b;return b}static fdm(b){let k=0;b in yl.Ecb&&(k=yl.Ecb[b]);return k}}yl.VCl="buttonFirstRow";yl.MCl="buttonFirstColumn";yl.MVm="buttonLastRow";yl.DVm="buttonLastColumn";yl.fIk="buttonBandedRow";
yl.eIk="buttonBandedColumn";yl.Ecb={};Object(n.a)(yl,"TableStyleActor",null,[]);yl.kD();var Pv=c(765),my=c(401);class FA extends my.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(n.a)(FA,"TableGalleryButtonProps",my.a,[]);class dk extends FA{constructor(){super()}get Type(){return 6}}Object(n.a)(dk,"TableStyleGalleryButtonProps",FA,[]);class Qv{}Qv.Rfn=2147483647;Object(n.a)(Qv,"TableStyleUtil",null,[]);class it{constructor(b,k,t){this.i7e="Clear";this.GCb=
null;this.zkk=b;this.we=k;this.ey=t;this.Dba=w.AFrameworkApplication.Dba;this.Rs=w.AFrameworkApplication.Rs}b0a(){}xrk(b,k){this.b0a(b);const t=this.p3h(b),D=t.length;if(!(0>=D)){var P=Qv.Rfn,ca=null;for(let qb=0;qb<D;qb++){var ta=t[qb],Na=this.ey.tdm(ta);P!==Na&&(P=Object.assign(new fh.a,{Id:"msMoreTableStyles"+Na,Title:this.udm(Na),ControlList:[]}),ca=Object.assign(new Jj.a,{Type:6,Id:"galleryMoreTableStyles"+Na,ExternalGalleryId:"TableStylesGallery",Width:it.zgg,ElementDimensions:"Size64by48",
GalleryItems:[]}),this.GCb&&(ca.ExternalId=this.GCb[Na.toString()]),P.ControlList.push(ca),k.MenuSectionList.push(P),P=Na);Na=this.we.YK(ta);ta=it.Mhg+qb;Na=Object.assign(new dk,{Id:ta,ExternalId:ta,Command:Pb.a.Rla.toString(),QueryCommand:Pb.a.bSa.toString(),LabelText:Na?F.a.Af(Na):"",Alt:Na,VerticalCenterAlign:"true"});Na.TableCellStyles=this.hSd(ta,b);Na.TableStyles=this.tPc(ta,b);ca&&ca.GalleryItems.push(Na)}}}wrk(b){const k=Object.assign(new fh.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",
ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),t=Object.assign(new zg.a,{Id:"fseaClearTableFormatting",Command:Pb.a.tAb.toString(),LabelText:F.a.Af(this.i7e),Alt:F.a.Af(this.i7e),Image16by16:this.Rs,Image16by16Class:od.getImageClassWithCluster(this.Dba,it.FXk),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});k.ControlList.push(t);b.MenuSectionList.push(k)}WKh(b,k){this.b0a(k);const t=b[kg.a.SourceControlId];var D=this.ZQb(t,k);if(D){var P=this.ey.hF(k);P=P?this.we.kg(P):null;var ca=
this.we.YK(D);D=this.we.kg(D);b[Mi.a.Alt]=ca;b[Mi.a.On]=D===P;k=Object.assign(new dk,{Id:t,ExternalId:t,Command:Pb.a.Rla.toString(),QueryCommand:Pb.a.bSa.toString(),TableCellStyles:this.hSd(t,k),TableStyles:this.tPc(t,k),Alt:ca});b[Mi.a.GalleryButtonProps]=k}else b[Mi.a.InnerHTML]=null,b[Mi.a.Alt]=null,b[Mi.a.On]=!1,b[Mi.a.GalleryButtonProps]=null}hSd(b,k){this.b0a(k);return(b=this.ZQb(b,k))?this.zkk.N4h(b,k):null}tPc(b,k){this.b0a(k);return this.ZQb(b,k),null}dal(b,k){b.MenuItems=this.$1l(k)}$1l(b){const k=
Object.assign(new be.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.xrk(b,k);this.wrk(k);return k}ZQb(b,k){return b?b.startsWith(it.Mhg)?this.xvf(parseInt(b.substr(it.Mhg.length)),k):this.N4n(parseInt(b.substr(it.QEo.length)),k):null}}it.Mhg="buttonTableStyleMenu";it.QEo="buttonTableStyleRibbon";it.zgg=7;it.FXk="ClearTableStyle_16x16x32";Object(n.a)(it,"ATableStyleRibbonControl",null,[289]);class Ch extends it{constructor(b,k,t){super(null,k,t);this.Lhh=b}WKh(b,k){this.b0a(k);const t=b[kg.a.SourceControlId];
var D=this.ZQb(t,k);if(D){var P=this.ey.hF(k);P=P?this.we.kg(P):null;var ca=this.we.YK(D);D=this.we.kg(D);b[Mi.a.Alt]=ca;b[Mi.a.On]=D===P;k=Object.assign(new dk,{Id:t,ExternalId:t,Command:Pb.a.Rla.toString(),QueryCommand:Pb.a.bSa.toString(),TableCellStyles:this.hSd(t,k),TableStyles:this.tPc(t,k),Alt:ca});b[Mi.a.GalleryButtonProps]=k}else b[Mi.a.InnerHTML]=null,b[Mi.a.Alt]=null,b[Mi.a.On]=!1,b[Mi.a.GalleryButtonProps]=null}hSd(b,k){this.b0a(k);return(b=this.ZQb(b,k))?this.Lhh.N4h(b,k,5,5):null}tPc(b,
k){this.b0a(k);return this.ZQb(b,k),null}}Object(n.a)(Ch,"ATableStyleRibbonControlVariableSizePreviews",it,[]);var ny=c(1449),GA=c(1099);class Oq{constructor(b,k,t,D){this.JMl=(P,ca)=>this.getBorder(P,this.K1.uM(ca));this.IMl=(P,ca)=>this.getBorder(P,this.K1.zO(ca));this.Sy=b;this.Su=k;this.Kxb=t;this.K1=D;this.QWj=new Rg.a(()=>this.HMl());this.h9a=new Rg.a(()=>this.GMl())}HMl(){const b={},k=w.AFrameworkApplication.isRtl;b.top="border-top";b.left=k?"border-right":"border-left";b.bottom="border-bottom";
b.right=k?"border-left":"border-right";b.insideHorizontal="border-bottom";b.insideVertical=k?"border-left":"border-right";return b}GMl(){const b={};b[Vg.a.yCa]=Vg.a.Ydb;b[Vg.a.Ydb]=Vg.a.Ydb;b[Vg.a.mZa]=Vg.a.mZa;return b}l8k(b,k,t,D){const P=new GA.a;P.rowCount=t;P.Deb=D;P.zTa=this.Kxb.Bcm(b);P.Ha=b.ia(Cc.a.Ha,1);P.Ga=b.ia(Cc.a.Ga,1);P.tableLook=k;P.Ake=1;return P}N4h(b,k,t,D){if(!this.Sy.kg(b)||!Object(ob.a)(210,b)||!Object(ob.a)(Xq.a,k))return null;const P=this.Su.$T(k);t=this.l8k(b,P,t,D);D=[];
for(t.rowIndex=0;t.rowIndex<t.rowCount;t.rowIndex++)this.Btk(b,k,t,D);return D}tPc(){return null}q8(){}Btk(b,k,t,D){t.M9b=!t.rowIndex;for(t.cellIndex=0;t.cellIndex<t.Deb;t.cellIndex++)this.$pk(b,k,t,D)}$pk(b,k,t,D){k=this.Kxb.v1k(t,this.Kxb.jof(t),k,b);const P={};var ca=this.Su.$nf(b,k,sf.a.fontColor,!0,Ym.a.MK(),"None");P.color=ca?ca:"inherit";ca=this.Su.$nf(b,k,sf.a.vH,!0,Ym.a.MK(),"None");P["background-color"]=ca?ca:"inherit";this.buk(t,b,k,P);D.push(P)}buk(b,k,t,D){b=this.Kxb.KOa(b);this.Qyd(5,
b,k,t,D);this.Qyd(3,b,k,t,D);this.Qyd(0,b,k,t,D);this.Qyd(4,b,k,t,D)}Qyd(b,k,t,D,P){k=this.CTl(b,k,t,D);k!==Vg.a.$F&&(P[this.QWj.value[ny.a[b]]]=k)}CTl(b,k,t,D){let P=Vg.a.$F;if(({Wla:P}=this.tIa(D,b,1,k,this.IMl,P)).returnValue)return P;({Wla:P}=this.tIa(t,b,3,k,this.JMl,P));return P}tIa(b,k,t,D,P,ca){return this.K1.Poj(t,k,D)&&(ca=P(b,k))!==Vg.a.$F||!k&&({Wla:ca}=this.tIa(b,1,t,D,P,ca)).returnValue||4===k&&({Wla:ca}=this.tIa(b,2,t,D,P,ca)).returnValue?{returnValue:!0,Wla:ca}:{returnValue:ca!==Vg.a.$F,
Wla:ca}}getBorder(b,k){let t="",D,P;({borderStyle:D,borderWidth:P}=this.LMl(b,k));if(D===Vg.a.mZa)return t;t=String.format(Vg.a.FBd,P,D,this.xnf(b,k));return t.trim()}xnf(b,k){if(!k)return Vg.a.$Z;b=this.Su.rLc(b,k.color,ch.a.auto);return b!==ch.a.auto?ch.a.XE(b):Vg.a.$Z}LMl(b,k){var t=Vg.a.Rta;let D=Vg.a.aG+Vg.a.y1b;if(!k)return{borderStyle:t,borderWidth:D};t=this.Su.rLc(b,k.style,Vg.a.mZa);b=this.Su.rLc(b,k.size,Vg.a.aG);D=this.KMl(t,b)+Vg.a.y1b;t=this.BMl(t);return{borderStyle:t,borderWidth:D}}KMl(b,
k){let t=2;b===Vg.a.v1b&&k<Vg.a.Vla&&(t=1);return t}BMl(b){return this.h9a.value[b]||Vg.a.w1b}static wdm(){return new Oq(Fa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Fa.a.instance.resolve("WordEditor.IWACTableStyleReader"),Bs.a.instance,Vg.a.instance)}static get instance(){return null!=Oq.lBg?Oq.lBg:Oq.lBg=Oq.wdm()}}Object(n.a)(Oq,"TableStylePreviewGenerator",null,[311]);var vx;(function(b){b[b.tap=0]="background1";b[b.tlp=1]="text1";b[b.uap=2]="background2";b[b.ulp=3]="text2";b[b.accent1=
4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.Sdp=11]="followedHyperlink";b[b.Jbp=12]="dark1";b[b.ggp=13]="light1";b[b.Kbp=14]="dark2";b[b.hgp=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(vx||(vx={}));Object(n.b)("ThemeColor",vx);class jv{constructor(b){this.sLa=b}KKl(b,k,t){let D;({I5i:k,Qvh:D}=this.C8l(k));b=[];const P=[];for(let ta=0;16>ta;ta++){if(!(vx[ta]in t.Txb))continue;
const Na=ta,qb=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,WoncaIntl.WoncaStrings[D[Na]],this.TZl(ta));var ca=k[Na];ca=ca&4278190080|(ca&255)<<16|ca&65280|(ca&16711680)>>>16;P.push(Object.assign(new Yi.a,{Color:Na.toString(),DisplayColor:"#"+F.a.NI(ca,6),Alt:F.a.Af(qb)}));b[b.length]=ta}return{returnValue:P,UGo:b}}TZl(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;
case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}C8l(b){let k=null,t=null;b=this.sLa(b);if(!b)return{I5i:k,Qvh:t};k=b.properties.ia(Cc.a.themeColors,null);t=b.properties.getValue(Cc.a.mle).split(" ");return{I5i:k,Qvh:t}}static ydm(){return new jv(Object(A.a)(jv.fh,
jv.fh.Ts,"navigateToPageContentNode"))}static get fh(){return Wk.PageNavigator.instance}static get instance(){return null!=jv.EBg?jv.EBg:jv.EBg=jv.ydm()}}Object(n.a)(jv,"TableStyleThemeHelper",null,[310]);var Dw=c(859);class Ew{constructor(b,k){this.UTe={};this.Txb={};this.we=b;this.ey=k}Thf(b,k){const t=this.UTe[vx[k]];return t&&t.length?t:this.EIl(b,k)}d$h(b,k,t){if(k=this.Thf(k,t))for(b=this.we.kg(b),t=0;t<k.length;t++)if(this.we.kg(k[t])===b)return t;return-1}q8(){this.UTe={};this.Txb={}}EIl(b,
k){const t=[];this.Txb={};b=this.ey.Shb(b);this.uAd(t,this.Txb,0,k,b);this.uAd(t,this.Txb,1,k,b);this.uAd(t,this.Txb,2,k,b);this.uAd(t,this.Txb,3,k,b);return this.UTe[vx[k]]=t}uAd(b,k,t,D,P){const ca=P.hO;for(let ta=0;ta<ca;ta++){const Na=P.AEa(ta);if(3!==this.we.RD(Na))continue;const qb=this.ey.sdm(Na),Jb=this.ey.nSd(Na);k[vx[Jb]]=!0;qb!==t||Jb!==D&&16!==Jb||this.we.kg(Na)===Dw.a.rpg||(b[b.length]=Na)}}static ihm(){return new Ew(Fa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Fa.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static Ndl(){return Ew.ihm()}}
Object(n.a)(Ew,"WACTableStyleRibbonList",null,[309]);class Ft extends Ch{constructor(b,k,t,D,P){super(b,k,t);this.vTb=4;this.hwd=[];this.ECm=()=>{this.w_b.q8();this.Lhh.q8()};this.Akk=P;this.w_b=D;this.i7e=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.cCn()}g8k(b,k){b.MenuItems=this.MHl(k)}cCn(){this.GCb={};this.GCb["0"]="CustomTableStyles";this.GCb["1"]="PlainTableStyles";this.GCb["2"]="GridTableStyles";this.GCb["3"]="ListTableStyles"}MHl(b){const k=Object.assign(new be.a,{Id:"menuTableTheme"});
k.MenuSectionList=[];if(this.YQm(b))return k;const t=Object.assign(new fh.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),D=Object.assign(new Pv.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:Nc.a.Cdb.toString(),QueryCommand:Nc.a.dMb.toString(),Width:Ft.VGo});D.Colors=({UGo:this.hwd}=this.Akk.KKl(this.hwd,b,this.w_b)).returnValue;t.ControlList.push(D);k.MenuSectionList.push(t);return k}b0a(b){if(b=this.ey.hF(b))b=this.ey.nSd(b),16!==b&&
(this.vTb=b)}p3h(b){return this.w_b.Thf(b,this.vTb)}xvf(b,k){k=this.w_b.Thf(k,this.vTb);return 0>b||b>=k.length?null:k[b]}N4n(b,k){var t=this.ey.hF(k);t=this.w_b.d$h(t,k,this.vTb);t=-1!==t?Math.floor(t/it.zgg)*it.zgg:0;return this.xvf(t+b,k)}udm(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;
default:return""}}YQm(b){this.b0a(b);return 0>=this.p3h(b).length}eXo(b,k){if(!b||!k)return null;b=parseInt(b[Hd.Color]);var t=this.ey.hF(k);const D=this.ey.nSd(t);if(D===b)return null;if(16===D)return this.vTb=b,null;t=this.w_b.d$h(t,k,D);this.vTb=b;return this.xvf(t,k)}Okl(b){b=this.ey.hF(b);b=this.ey.nSd(b);if(16!==b)for(let k=0;k<this.hwd.length;k++)if(this.hwd[k]===b)return k;return-1}Vyb(b){b.pYe(this.ECm,2)}static xdm(){return new Ft(Oq.instance,Fa.a.instance.resolve("Box4.Styles.IWACStyleReader"),
Fa.a.instance.resolve("WordEditor.IWACTableStyleReader"),Ew.Ndl(),jv.instance)}static get instance(){return null!=Ft.hCg?Ft.hCg:Ft.hCg=Ft.xdm()}}Ft.VGo=4;Object(n.a)(Ft,"TableStyleRibbonControls",Ch,[288,289]);var Kd=c(1543);class ju extends yl{constructor(b,k,t,D,P,ca,ta,Na){super(b,k,t,D,P,ca,ta,Na);this.Sfc=(qb,Jb,Vb,ac,yc)=>{if(!({fy:qb}=this.Eob(Jb,Vb,yc,!1,!0)).returnValue)return qb;this.Nhg.g8k(yc,Jb.node);return 32};this.Cdb=(qb,Jb,Vb,ac,yc)=>{if(!({fy:qb}=this.Eob(Jb,Vb,yc,!1,!0)).returnValue)return 2==
Vb&&8==qb&&qr.a.recordQosError("TableStyleColorButtonClickNoResponse",["TableInteractionFailed"],He.a.myl),qb;const Kc=Jb.node,ed=this.Nhg.eXo(yc,Kc);ed&&this.N9d(Kc,()=>{this.Oxd.z6a(ed,Kc)});return 32};this.dMb=(qb,Jb,Vb,ac,yc)=>{if(!({fy:qb}=this.Eob(Jb,Vb,yc,!0,!0)).returnValue)return qb;yc[Hd.IndexColorSelected]=this.Nhg.Okl(Jb.node);return 32}}Mgc(b){super.Mgc(b);this.ga.qa(Nc.a.Cdb,lc.a.view,this.Gke);this.ga.qa(Nc.a.Cdb,lc.a.table,this.Cdb);this.ga.Vc(Nc.a.Cdb,1030);this.ga.qa(Nc.a.Sfc,lc.a.view,
b);this.ga.qa(Nc.a.Sfc,lc.a.table,this.Sfc);this.ga.Vc(Nc.a.Sfc,1126);this.ga.qa(Nc.a.dMb,lc.a.view,b);this.ga.qa(Nc.a.dMb,lc.a.table,this.dMb);this.ga.Vc(Nc.a.dMb,1127)}get Nhg(){return this.Mvd}static rdm(){return new ju(Fa.a.instance.resolve("WordEditor.IWACTableStyleReader"),Ft.instance,w.AFrameworkApplication.va,Kd.a.instance,new tk.a,Fa.a.instance.resolve("Box4.IInsertionPointFormatting"),Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(A.a)(Yj.a.instance,
Yj.a.instance.gkb,"isTableNodeInLockedRange"))}static get instance(){return null!=ju.sBg?ju.sBg:ju.sBg=ju.rdm()}}Object(n.a)(ju,"TableStyleActor",yl,[]);var wi=c(1603);class HA{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}xc(b){this.W=b;this.W.ha("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>Oq.instance).singleInstance();this.W.ha("Box4.TableEditors.ITableStyleEditor",()=>wi.a.instance).singleInstance();this.W.ha("Box4.TableEditors.IWACTableStyleEditor",()=>
Kd.a.instance).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>{this.fn()})}fn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(112)&&(ju.instance.Tb(),Ft.instance.Vyb(cv.a.instance),kk.StyleReader.Hke=wi.a.instance,Wa.App.ya.updateCommandUI())}dispose(){}}Object(n.a)(HA,"TableStylePackage",null,[1,2]);var Lu=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",
ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",
attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",
TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},
{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",
attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",
MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",
attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",
MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},
Hz=c(1442);class Iz{constructor(b,k){this.GKa=b;this.$za=k}JUn(b){this.GKa.zzd(b)}XCa(b){this.$za.XCa(b)}yOb(b,k){return this.$za.yOb(b,k)}xOb(b,k){return this.$za.xOb(b,k)}$le(b,k,t){this.$za.$le(b,k,t)}}Object(n.a)(Iz,"ClientPaginationHeaderFooterBridge",null,[382]);class Mu{constructor(b,k){this.am=b;this.ga=k;this.Q$=new up.a;this.R$=new up.a}XCa(b){b=ze.GraphIterator.$a(b);if(b.Dp()&&b.xq()){b.Qd();do 10===b.We&&this.DZf(b.currentNode),b.qt();while(8!==b.We)}}yOb(b,k){var t=this.SEb(k);if(!this.Q$.nb(t))return v.ULS.sendTraceTag(573400388,
3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+t),!1;k=this.Q$.J(t);v.ULS.shipAssertTag(573400389,336,this.R$.nb(t),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");t=this.R$.J(t);return this.uxf(k,b,t)}xOb(b,k){var t=this.SEb(k);if(!this.Q$.nb(t))return v.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+t),!1;k=this.Q$.J(t);
v.ULS.shipAssertTag(573400391,336,this.R$.nb(t),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");t=this.R$.J(t);return this.glf(k,b,t)}$le(b,k,t){k=this.zuf(k,t);this.ga.Qb(b?Nc.a.xoe:Nc.a.Fbd,2,k)}zuf(b,k){k=this.am.XDb(k);if(!k)return v.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;k=this.am.Lga(k);const t=1===b;b=!(b%2);return 1===k?1:2===k?t?2:1:3===k?b?3:4:t?2:b?3:4}DZf(b){if(10===
b.type){var k=new up.a,t=this.am.XDb(b);v.ULS.shipAssertTag(573400393,336,!!t,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var D=this.am.Lga(t);b=this.SEb(b);this.Nmg(b,D);this.Mmg(b,k);t=ze.GraphIterator.$a(t);if(t.xq()){t.Qd();do b=t.currentNode,D=this.am.fOc(b),b=this.am.Mmi(b),k.add(D,b),t.qt();while(36===t.We)}}}Nmg(b,k){this.R$.nb(b)?this.R$.Z(b,k):this.R$.add(b,k)}Mmg(b,k){this.Q$.nb(b)?this.Q$.Z(b,k):this.Q$.add(b,
k)}SEb(b){v.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ia(Cc.a.Hia,0)}uxf(b,k,t){const D=1===k;k=!(k%2);switch(t){case 2:if(D){if(b.nb(2))return b.J(2)}else if(b.nb(0))return b.J(0);break;case 3:if(k){if(b.nb(1))return b.J(1)}else if(b.nb(0))return b.J(0);break;case 4:if(D){if(b.nb(2))return b.J(2)}else if(k){if(b.nb(1))return b.J(1)}else if(b.nb(0))return b.J(0);break;case 1:if(b.nb(0))return b.J(0)}return!1}glf(b,k,t){const D=
1===k;k=!(k%2);switch(t){case 2:if(D){if(b.nb(5))return b.J(5)}else if(b.nb(3))return b.J(3);break;case 3:if(k){if(b.nb(4))return b.J(4)}else if(b.nb(3))return b.J(3);break;case 4:if(D){if(b.nb(5))return b.J(5)}else if(k){if(b.nb(4))return b.J(4)}else if(b.nb(3))return b.J(3);break;case 1:if(b.nb(3))return b.J(3)}return!1}}Object(n.a)(Mu,"ClientPaginationPageAdornmentContentManager",null,[381]);class Gt{constructor(b,k,t,D,P,ca){this.s2k=ta=>{1===ta&&this.qE.uE&&(ta=this.Wc.jEa(this.qE.uE,8,8),this.am.dRk(ta)?
this.uil(ta):this.gto())};this.kOo=ta=>{1===ta&&this.ga.Qb(Pb.a.openInClient,2,!1)};this.qE=b;this.am=k;this.Wc=t;this.Hc=D;this.Etc=P;this.ga=ca}vto(){const b=new Uc.StandardDialog;b.Ad=1;b.Ee(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);b.XU(0);b.Gu(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.s2k)}uil(b){b.hd(8);const k=this.Hc.Mc(15);k.set(b.Nn.hj);this.Etc.UWn(b);this.qE.dismiss();k.dispose();
v.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}gto(){const b=new Uc.StandardDialog;b.Ad=1;b.Ee(1,Box4Intl.Box4Strings.L_OpenInWord);b.Ee(0,CommonUIStrings.l_Close);b.XU(0);b.Gu(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,0,this.kOo);v.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(n.a)(Gt,"DeleteHeaderFooterDialog",null,[]);class IA{constructor(b,k,t,D,P){this.am=b;this.Wc=
k;this.Hc=t;this.Etc=D;this.ga=P}create(b){return new Gt(b,this.am,this.Wc,this.Hc,this.Etc,this.ga)}}Object(n.a)(IA,"DeleteHeaderFooterDialogFactory",null,[380]);class kv{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb){this.z$=null;this.wjg=(Vb,ac,yc,Kc,ed)=>{var sd=this.Avf(ac);return sd?1===yc?32:(yc=this.control)?(ac=this.Hc.Mc(15),ac.Cb(sd),ac.fk=Vb,yc.aba?this.ga.processAction(Nc.a.zT,2):(sd=this.lWh(sd),Kc.ks=sd?1:0,Kc=Vb!==Nc.a.Fbd,(Vb=this.oqf(Vb,ed))&&yc.yya(Vb),this.ga.Qb(Nc.a.PId,2,Kc)),ac.dispose(),
32):8:8};this.cdf=(Vb,ac,yc)=>{if(1===yc)return 32;this.E_j.create(this.control).vto();return 32};this.xJn=(Vb,ac,yc,Kc,ed)=>1===yc?32:(Vb=this.control)?(ed[kg.a.On]=Vb.aba,32):8;this.uob=(Vb,ac,yc,Kc,ed)=>{if(1===yc||!this.control.aba)return 32;ac=this.q9h(Vb,ed);yc=kv.Zii(this.control.uE);Kc=this.Hc.Mc(15);Kc.Cb(yc);Kc.fk=Vb;Vb=this.Wc.xk();Vb.set(yc);this.HKa.Rhf(Vb.currentNode,ac);this.am.zJb(Vb);this.Etc.wmj(Vb,ac);Kc.dispose();return 32};this.yya=(Vb,ac,yc,Kc,ed)=>{if(1===yc)return 32;Vb=this.oqf(Vb,
ed);this.control.aba&&this.control.yya(Vb);return 32};this.Efe=(Vb,ac,yc,Kc,ed)=>{if(1===yc)return 32;Vb=this.pfi(Vb,ed);Kc.ks=Vb;ac=this.Avf(ac);if(!ac)return 8;Kc=this.Wc.xk();Kc.set(ac);Kc.zb(8);Kc.At(8);if(!this.Qk.pdn(Kc,Vb))return 8;this.am.zJb(Kc);this.control.cga(Kc.currentNode);return 32};this.EZf=(Vb,ac,yc,Kc,ed)=>{if(1===yc)return 32;Vb=this.Ilk.ncl(this.Avf(ac));ed.PopulationXML=Vb;return 32};this.rbe=(Vb,ac,yc,Kc,ed)=>{Vb=this.q9h(Vb,ed);ac=this.control.uE;yc=this.am.Lga(ac);ed[kg.a.On]=
Vb===yc;1===Vb&&(ed[kg.a.LabelText]=this.aki(ac)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.xae=(Vb,ac,yc,Kc,ed)=>{if(1===yc||!this.control.aba)return 32;ac=this.control.uE;void 0!==ac&&null!==ac&&(ac=this.am.Lga(ac),Vb=this.oqf(Vb,ed),yc=this.control.xTb,ed[kg.a.Visible]=this.VFo(Vb,ac),ed[kg.a.On]=Vb===yc);return 32};this.NJn=(Vb,ac,yc,Kc,ed)=>{if(1===yc||!this.control.aba)return 32;Vb=this.control.uE;void 0!==
Vb&&null!==Vb&&this.yCn(Vb,ed);return 32};this.XIn=(Vb,ac,yc,Kc,ed)=>{if(1===yc||!this.control.aba)return 32;Vb=this.pfi(Vb,ed);ac=this.control.uE;yc=0;void 0!==ac&&null!==ac&&(yc=ac.getValue(Cc.a.Hia));ed[kg.a.On]=Vb===yc;return 32};this.zT=(Vb,ac,yc)=>{if(1===yc)return 32;this.control.dismiss();return 32};this.WUd=()=>32;this.PId=(Vb,ac,yc,Kc,ed)=>{if(1===yc)return 32;this.control.show(ed);return 32};this.Bkb=(Vb,ac,yc,Kc,ed)=>{if(1===yc)return 32;if(!ed)return 8;ac=ed.$Za;if(!ac||!ac.isConnected)return 8;
Vb=this.am.S4d(ac);if(!({isHeader:yc,xig:ac}=this.am.uhi(ac)).returnValue)return 8;this.control.cga(Vb);this.control.yya(ac);this.control.show(yc,ed.Ahe);return 32};this.ga=b;this.am=k;this.Etc=t;this.HKa=D;this.Qk=P;this.Wc=ca;this.Hc=ta;this.Ilk=Na;this.Z3j=qb;this.E_j=Jb}get control(){return this.z$}set control(b){this.z$=b}Tb(){this.ga.qa(Nc.a.rWd,lc.a.view,this.wjg);this.ga.fb(Nc.a.D1f,lc.a.application,this.xJn,96);this.ga.qa(Nc.a.xoe,lc.a.view,this.wjg);this.ga.qa(Nc.a.Fbd,lc.a.view,this.wjg);
this.ga.fb(Nc.a.WUd,lc.a.view,this.WUd,64);this.ga.qa(Nc.a.PId,lc.a.view,this.PId);this.ga.fb(Nc.a.zT,lc.a.application,this.zT,96);this.ga.fb(Nc.a.Bkb,lc.a.application,this.Bkb,96);this.ga.fb(Nc.a.xdo,lc.a.view,this.yya,96);this.ga.qa(Nc.a.Gij,lc.a.view,this.yya);this.ga.qa(Nc.a.Iij,lc.a.view,this.yya);this.ga.qa(Nc.a.Hij,lc.a.view,this.yya);this.ga.qa(Nc.a.Jij,lc.a.view,this.yya);this.ga.fb(Nc.a.Pgo,lc.a.view,this.uob,100);this.ga.fb(Nc.a.skj,lc.a.view,this.uob,4);this.ga.fb(Nc.a.rkj,lc.a.view,this.uob,
4);this.ga.fb(Nc.a.pkj,lc.a.view,this.uob,4);this.ga.fb(Nc.a.qkj,lc.a.view,this.uob,4);this.ga.qa(Nc.a.Efe,lc.a.view,this.Efe);this.ga.qa(Nc.a.F$f,lc.a.view,this.Efe);this.ga.fb(Nc.a.EZf,lc.a.view,this.EZf,96);this.ga.fb(Nc.a.cdf,lc.a.view,this.cdf,4);this.ga.fb(Nc.a.T3i,lc.a.view,this.xae,97);this.ga.fb(Nc.a.V3i,lc.a.view,this.xae,97);this.ga.fb(Nc.a.U3i,lc.a.view,this.xae,97);this.ga.fb(Nc.a.W3i,lc.a.view,this.xae,97);this.ga.fb(Nc.a.l4i,lc.a.view,this.rbe,97);this.ga.fb(Nc.a.k4i,lc.a.view,this.rbe,
97);this.ga.fb(Nc.a.i4i,lc.a.view,this.rbe,97);this.ga.fb(Nc.a.j4i,lc.a.view,this.rbe,97);this.ga.fb(Nc.a.rJn,lc.a.view,this.NJn,97);this.ga.fb(Nc.a.Z0f,lc.a.view,this.XIn,97)}lWh(b){const k=this.am.XDb(b),t=this.am.Lga(k);b=this.HKa.Rhf(b,t);this.control.cga(k);return b}q9h(b,k){switch(b){case Nc.a.skj:case Nc.a.l4i:b=1;break;case Nc.a.rkj:case Nc.a.k4i:b=2;break;case Nc.a.pkj:case Nc.a.i4i:b=3;break;case Nc.a.qkj:case Nc.a.j4i:b=4;break;default:b=k}return b}oqf(b,k){switch(b){case Nc.a.Gij:case Nc.a.T3i:b=
1;break;case Nc.a.Iij:case Nc.a.V3i:b=2;break;case Nc.a.Hij:case Nc.a.U3i:b=3;break;case Nc.a.Jij:case Nc.a.W3i:b=4;break;case Nc.a.xoe:case Nc.a.Fbd:b=k;break;case Nc.a.rWd:b=0;break;default:b=k}return b}pfi(b,k){return b===Nc.a.F$f||b===Nc.a.Z0f?parseInt(k.MenuItemId):k}Avf(b){return this.Qk.j8(b.$j)}VFo(b,k){switch(k){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}yCn(b,k){const t=this.aki(b);if(k[jk.a.Visible]=t)b=this.Qk.$ii(this.Z3j(b)),
b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),k[jk.a.LabelText]=b}aki(b){const k=this.Wc.xk();k.set(b);k.zb(8);k.At(8);return 1<this.Qk.Xuf(k)}static Zii(b){const k=new ze.GraphIterator;k.set(b);k.zb(10);return Vr.WordSectionNavigator.o6n(k)}}Object(n.a)(kv,"HeaderFooterActor",null,[]);var lv=c(786),Ty=c(700);class Jz{constructor(b,k,t,D,P){this.Qak=b;this.am=k;this.Qk=t;this.Wc=D;this.ga=P}YVh(b,k){this.am.zJb(b);k=this.Ztl(b,k);b.uc();return k}Rhf(b,k){b=
this.Wc.jEa(b,8,8);let t=!1;this.Qk.xOa(b,D=>{const P=this.Wc.xk();P.set(D);t=(D=this.YVh(P,k))||t;return D});return t}Ztl(b,k){if(3!==this.ga.mode)return!1;let t=!1;k=Ty.a.Udf(k);for(let D=0;D<k.length;++D)t=this.Qak.Ytl(b,k[D])||t;return t}}Jz.ahl=1;Object(n.a)(Jz,"HeaderFooterInserter",null,[374]);class Rv{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){this.Veh=this.dSg=!1;this.uE=null;this.cFe=!1;this.xTb=0;this.dKb=()=>{this.cFe=!0};this.Y5=b;b.bind(this);this.$Ve=D;this.d0j=qb;this.E8g=P;this.Ibk=
ca;this.R$a=ta;this.header=k;this.footer=t;this.header.rdl();this.Y5.wz();this.gUe=Jz.ahl;this.HKa=Na;Rv.ga=Jb;this.rN=Vb}get aba(){return this.dSg}show(b=!0,k=!0){this.aba||(this.RGj(),this.Ojj(!0),this.header.XRn(),this.d0j(),this.$zo(),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.zoa&&(Qg.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new lv.a,{state:0,disablePopover:!0}))):v.ULS.sendTraceTag(509384032,3023,15,"Showing header/footer overlay and appChrome is not ready")));
(this.Veh=k)&&this.E8g(b)}dismiss(b=!1){this.aba&&(this.Ibk(b),this.Ojj(!1),this.TBb(),this.xTb=0,this.gBo(),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.zoa&&(Qg.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new lv.a,{disablePopover:!1}))):v.ULS.sendTraceTag(509384031,3023,15,"Dismissing header/footer overlay and appChrome is not ready")))}Ojj(b){this.dSg=b;Rv.ga.processAction(Pb.a.Dlf,2);this.Y5.Q0(b);this.header.Q0(b);this.footer.Q0(b);this.$Ve()}cga(b){this.uE!==
b&&(this.uE=b,this.header.cga(b),this.footer.cga(b),this.xTb=0,this.uob(this.R$a.Lga(b)))}TBb(){this.uE&&(this.header.Dfb(),this.footer.Dfb(),this.uE=null)}update(){this.aba&&this.yQb()}yQb(){this.uE&&(this.R$a.Gpl(this.uE)&&this.R$a.$pm(this.uE)?this.RGj():this.dismiss())}RGj(){const b=this.R$a.Lga(this.uE);b!==this.gUe&&this.uob(b)}uob(b){this.gUe=b;this.yya(this.Udm(b))}Udm(b){switch(b){case 2:return 2;case 3:return 3;case 4:return 2}return 1}yya(b,k=!0){this.xTb!==b&&(this.HKa.Rhf(this.uE,this.gUe),
this.header.Fij(b),this.header.evh(wg.AppFrame.Bba),this.footer.Fij(b),this.footer.evh(wg.AppFrame.iba),this.xTb=b,this.aba&&this.Veh&&this.Gul(k))}Gul(b){this.E8g(b);b?this.header.setInitialSelection():this.footer.setInitialSelection()}dispose(){this.Y5.X9();this.header.dispose();this.footer.dispose()}$zo(){this.rN.BDc(this.dKb);this.cFe=!1}gBo(){this.rN.dde(this.dKb);this.cFe&&Rv.ga.processAction(Nc.a.WUd,2)}static Uml(){Rv.ga.Qb($a.a.sib,2,!0);Rv.ga.processAction(Nc.a.y3,2)}}Rv.ga=null;Object(n.a)(Rv,
"HeaderFooterControl",null,[414,9]);class JB{constructor(b,k,t,D,P){this.$Ve=b;this.R$a=k;this.HKa=t;this.ga=D;this.rN=P}create(b,k,t,D,P){return new Rv(b,k,t,this.$Ve,D,P,this.R$a,this.HKa,Rv.Uml,this.ga,this.rN)}}Object(n.a)(JB,"Factory",null,[377]);class Uy{constructor(){this.z$=null}get control(){return this.z$}set control(b){this.z$=b}nmf(b){return this.omf(this.control.uE,this.control.xTb,b.isHeader,b)}omf(b,k,t,D){return()=>{if(!b.isConnected)return null;this.control.cga(b);this.control.yya(k);
this.control.show(t);return D}}dismiss(){this.z$.aba&&this.z$.dismiss()}}Object(n.a)(Uy,"HeaderFooterControlLauncher",null,[]);var Kz=c(1148),wx=c(650),rs=c(272),Sv=c(809);class mv{constructor(b,k,t){this.ulc=null;const D=k?"Header":"Footer";this.Cr=b.ownerDocument.createElement("div");this.Cr.id=k?"HeaderPane":"FooterPane";this.Cr.classList.add(mv.cqm,D);this.syb=(new Sv.a(this.Cr,"WACViewPanel_"+D)).dI;this.Cr.appendChild(this.syb);b.appendChild(this.Cr);k&&(this.ulc=b.ownerDocument.createElement("div"),
this.ulc.classList.add(mv.hqm),this.Cr.appendChild(this.ulc));this.YKg=t.g5l(this.Cr)}bind(){}Q0(b){b?this.YKg.QAk():this.YKg.SAk()}bJk(b){b.Bzb(this.syb)}}mv.hqm="HeaderToolbarContainer";mv.cqm="HeaderFooterPane";Object(n.a)(mv,"PaneControlDom",null,[434]);class nv{constructor(b,k,t,D,P){this.qE=this.Lq=null;this.VUi=()=>{this.qE.dismiss(!0);if(this.zUb){const ca=new Ds.a(!0);this.zUb.SGa(ca)}return!0};this.KB=ca=>{ca.Gb.preventDefault();return!1};this.Cr=b.ownerDocument.createElement("div");this.Cr.id=
nv.mIh;this.Cr.className=nv.mIh;this.CZ=D;this.zUb=P;this.Kmi=new mv(this.Cr,!0,k);this.abl(this.Cr);this.J0h=new mv(this.Cr,!1,k);this.Q0(!1);b.appendChild(this.Cr)}abl(b){this.Lq=b.ownerDocument.createElement("div");this.Lq.id=nv.lwn;this.Lq.className=nv.jwn;this.Lq.tabIndex=0;this.Lq.setAttribute(df.a.qh,df.a.e3);this.Lq.setAttribute(df.a.dfa,WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);b.appendChild(this.Lq)}bind(b){this.qE=b}Q0(b){if(!b&&this.CZ){var k=new Ds.a(!0);this.CZ.SGa(k)}!b&&
this.zUb&&(k=new Ds.a(!0),this.zUb.SGa(k));this.Cr.style.display=b?"":"none";this.Kmi.Q0(b);this.J0h.Q0(b)}jgo(){this.Lq.focus()}wz(){Zh.a.instance.lb(Rc.a.click,this.Lq,this.VUi);Kf.a.instance.lb(Rc.a.Kx,this.Cr,this.KB)}X9(){Zh.a.instance.rc(Rc.a.click,this.Lq,this.VUi);Kf.a.instance.rc(Rc.a.Kx,this.Cr,this.KB)}}nv.mIh="HeaderFooterControl";nv.lwn="HeaderFooterOverlay";nv.jwn="EditingSurfaceOverlay HeaderFooterOverlay";Object(n.a)(nv,"HeaderFooterControlDom",null,[415]);class JA{constructor(b,k,
t,D,P,ca,ta,Na,qb,Jb){this.Y5=null;this.ra=new Ue.a;this.qE=this.ytd=null;this.VTf=Vb=>{this.E9(Vb);this.ra.raiseEvent("OnShowEventKey")};this.UTf=Vb=>{this.mf&&(this.ytd=new Kz.a(this.mf));this.Ub.GIc(wg.AppFrame.Bba);this.Ub.GIc(wg.AppFrame.iba);this.Uca(Vb);this.ra.raiseEvent("OnDismissEventKey")};this.c9d=()=>{this.ytd&&(this.ytd.dispose(),this.ytd=null)};this.Ub=b;this.$o=k;this.r$g=t;this.A4j=D;this.Adk=P;this.ga=ca;this.EPg=wx.a.create();this.zTg=Zb.KeyInputManager.kc(pc.a.zs,0);this.sZ=Zb.KeyInputManager.kc(pc.a.t1,
0);this.yjk=Zb.KeyInputManager.kc(pc.a.LIa,0);this.wI=ta;this.Ma=Na;this.CZ=qb;this.zUb=Jb;this.mf&&this.mf.Hla(this.c9d)}gqh(b){this.ra.addHandler("OnShowEventKey",b)}s_n(b){this.ra.removeHandler("OnShowEventKey",b)}zzd(b){this.ra.addHandler("OnDismissEventKey",b)}faj(b){this.ra.removeHandler("OnDismissEventKey",b)}get mf(){const b=this.wI.value;return b?b.Vi?b:(v.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(v.ULS.sendTraceTag(25474003,
317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.qE}get O4k(){return this.EPg}bind(b){this.qE=this.V2k(b);this.EPg.instance=this.qE}V2k(b){this.Y5=new nv(b,this.Adk.value,this.Ma,this.CZ,this.zUb);b=this.r$g.value.create(this.ga,this.Y5.Kmi,!0,wg.AppFrame.Bba);const k=this.r$g.value.create(this.ga,this.Y5.J0h,!1,wg.AppFrame.iba);this.qE=this.A4j.value.create(this.Y5,b,k,this.VTf,this.UTf);this.Kzf();this.dT();return this.control}Kzf(){var b=3===this.ga.mode?
wg.AppFrame.$E:wg.AppFrame.Igc;const k=this.Ub.ge(wg.AppFrame.Bba);k.parent=b;this.Ub.CYe(wg.AppFrame.Bba);const t=this.Ub.ge(wg.AppFrame.iba);t.parent=b;this.Ub.CYe(wg.AppFrame.iba);b=this.Ub.ge(rs.a.EFb);b.parent=ef.AFrame.rp;b.Uea(()=>{this.Y5.jgo()});b.bindAction(this.zTg,Nc.a.zT);b.bindAction(this.sZ,Nc.a.zT);b.bindAction(this.yjk,Nc.a.zT);k.bindAction(this.sZ,Nc.a.zT);t.bindAction(this.sZ,Nc.a.zT)}dT(){this.$o.dT(wg.AppFrame.Bba);this.$o.dT(rs.a.P1a);this.$o.dT(wg.AppFrame.iba);this.$o.dT(rs.a.EFb)}E9(b){this.$o.CI(wg.AppFrame.Bba);
this.$o.CI(rs.a.P1a);this.$o.CI(wg.AppFrame.iba);this.$o.CI(rs.a.EFb);this.$o.Rw(ef.AFrame.Pn);this.Ub.aDc(wg.AppFrame.Bba);this.Ub.aDc(wg.AppFrame.iba);b?this.Ub.mg(wg.AppFrame.Bba):this.Ub.mg(wg.AppFrame.iba)}Uca(b){this.$o.Rw(wg.AppFrame.Bba);this.$o.Rw(rs.a.P1a);this.$o.Rw(wg.AppFrame.iba);this.$o.Rw(rs.a.EFb);this.$o.CI(ef.AFrame.Pn);(b||this.Ub.currentScope&&(this.Ub.currentScope.name===wg.AppFrame.Bba||this.Ub.currentScope.name===rs.a.P1a||this.Ub.currentScope.name===wg.AppFrame.iba||this.Ub.currentScope.name===
rs.a.EFb))&&this.Ub.mg(ef.AFrame.Pn)}dispose(){const b=this.Ub.ge(rs.a.EFb);b.ir(this.zTg);b.ir(this.sZ);this.Ub.ge(wg.AppFrame.Bba).ir(this.sZ);this.Ub.ge(wg.AppFrame.iba).ir(this.sZ);this.mf&&this.mf.fde(this.c9d);this.control.dispose()}}Object(n.a)(JA,"HeaderFooterControlOwner",null,[378,379]);var KB=c(1097);class KA{constructor(b,k,t,D,P,ca){this.am=b;this.Wc=k;this.adk=t;this.em=D;this.ddk=P;this.C4j=ca}Dzm(b,k){const t=this.Wc.xk();t.set(b);this.am.AJb(t,k);this.adk(t);this.ddk(t.currentNode,
this.em);this.C4j.Ezm(t,KB.a(k))}}Object(n.a)(KA,"HeaderFooterDefaultContentInserter",null,[376]);class hq{constructor(b,k,t,D,P,ca,ta,Na){this.ZS=b;this.ukk=k;this.yue=t;this.em=D;this.cdk=P;this.Sik=ca;this.p4j=ta;hq.nh=Na}Ezm(b,k){this.ukk(b,1,3,null,!1);this.ZS.h7c(Dw.a.rpg,1696,b.currentNode);this.yue(b,0,this.em?3:1,k);this.yue(b,1,2,k);this.yue(b,2,this.em?1:3,k);this.cdk(b);this.Sik(b,!1,!0,null);this.p4j(b,k)}static get XG(){return null!=hq.$Ig?hq.$Ig:hq.$Ig=Fa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get paragraphEditor(){return null!=
hq.bFg?hq.bFg:hq.bFg=Fa.a.instance.resolve("Box4.IParagraphEditor")}static seo(b,k,t){mh.moveToCellContent(b,0,k);ag.OutlineElementNavigator.Ge(b);hq.XG.Xge(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);hq.paragraphEditor.gE(b.currentNode,t);k||hq.paragraphEditor.fq.Bya(b,1,-115);2===k&&hq.paragraphEditor.fq.TNb(b.currentNode,1,-115);mh.returnToContainingTable(b)}static Ngo(b,k){ag.OutlineElementNavigator.Ge(b);hq.XG.Xge(k?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,
b.currentNode);ag.OutlineElementNavigator.Vd(b)}static LNl(){return(b,k,t)=>{hq.seo(b,k,t)}}static VWl(){return(b,k)=>{hq.Ngo(b,k)}}static cdm(b){return(k,t,D,P,ca)=>b.jDa(k,t,D,P,ca)}static Yam(){return(b,k,t,D,P)=>hq.nh.yB(b,k,t,D,P)}}hq.nh=null;Object(n.a)(hq,"HeaderFooterDefaultTableInserter",null,[375]);class Vy{constructor(b,k,t,D){this.am=b;this.uqd=k;this.Wc=t;this.Qk=D}wmj(b,k){b.Nn.properties.setValue(Cc.a.Twf,2===k||4===k);b.zb(8);b.dbd(8).properties.setValue(Cc.a.FUd,3===k||4===k)}UWn(b){this.Qk.xOa(b,
k=>{const t=this.Wc.xk();t.set(k);this.am.zJb(t);this.wmj(t,1);this.VWn(t);return!0})}VWn(b){for(;b.Qd();)b.wg()}}Object(n.a)(Vy,"HeaderFooterEditor",null,[373]);var ku=c(1102);class LA extends Iu.a{constructor(b){super();this.bWe=b}get index(){return 0}run(){this.bWe()}Zpm(b,k){k.property===Cc.a.Twf&&this.IJ()}Gwn(b,k){k.property===Cc.a.FUd&&this.IJ()}IJ(){this.pY()}}Object(n.a)(LA,"ControlUpdateNeededTracker",Iu.a,[]);class Tv{constructor(b,k,t,D,P,ca){this.D9a=null;this.B4j=t;this.Vjd=k;this.eVb=
b;this.qdk=D;this.ELa=ca}start(){this.eVb.bind(Wa.App.ya.jD);this.Vjd.control=this.eVb.control;this.Vjd.Tb();this.B4j.control=this.eVb.control;this.qdk.value.create(this.eVb.control,Object(A.a)(this.Vjd,this.Vjd.lWh,"ensureSectionHeaderFooterAttachedToControl")).Tb();this.Crm()}Crm(){this.D9a=new LA(()=>{this.eVb.control.update()});const b=Wa.App.Lj.Bl;b.Ze(35).Fo(Object(A.a)(this.D9a,this.D9a.Zpm,"headerFooterContainerNodePropertyChanged"));b.Ze(8).Fo(Object(A.a)(this.D9a,this.D9a.Gwn,"pageContentNodePropertyChanged"));
ku.a.xce(Object(A.a)(this.D9a,this.D9a.IJ,"setUpdateNeeded"));Eq.GraphTransactionManager.instance.aqa(this.D9a,3)}dispose(){this.eVb.dispose();this.ELa.NRh()}}Object(n.a)(Tv,"HeaderFooterManager",null,[]);class ov{constructor(b,k,t,D){this.Qk=b;this.am=k;this.Pak=t;this.kxe=D}Ytl(b,k){let t=!1;const D=Ty.a.Zrf(k);b.Nr(D)||(this.Ozm(b,k),this.kxe.Dzm(b.currentNode,k),t=!0);return t}Ozm(b,k){const t=this.Pak.create(1074135123),D=b.currentNode.ia(Cc.a.Hia,0);t.properties.setValue(Cc.a.Hia,D);t.properties.setValue(Cc.a.i9b,
k);k=Ty.a.Zrf(k);b.Hf(t,k)}}Object(n.a)(ov,"HeaderFooterNodeLevelInserter",null,[372]);var Wy=c(226),Lz=c(386);class Uv extends Wy.a{constructor(b,k,t){super(b,k,"","");this.Rvb=null;this.Vmi=Uv.SOh;this.QQc=[];this.BCe=t}get RA(){return!0}get cssClass(){return"cui-herodock"}ym(){this.QRn();super.ym()}eOa(){for(const b of this.QQc)b.aKd();super.eOa()}Uyo(){let b,k,t;b=[];k=[];t=[];for(let D=0;D<this.QQc.length;D++){const P=this.QQc[D];P.visible?b.length<this.Vmi?b.push(P):Object(ob.a)(Lz.FlyoutAnchor,
P)?Array.addRange(k,P.DQl()):k.push(P):t.push(P)}return{VIo:b,hwn:k,LCm:t}}$al(b){if(!b||!b.length)return null;const k=new Dg.Menu(this.root,this.id+"OverflowMenu",null,null,null),t=new nt.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},k);for(const D of b)t.Hf(D.uQ("Menu20"));k.Hf(t);return k}QRn(){this.Oce();this.Oc=Va.a.rSa(this.Oc);this.zC();var b;({VIo:t,hwn:b,LCm:D}=this.Uyo());for(var k of t){var t=k.uQ("Medium20");t.enabled=
!0;this.O_b(t,this.children.count);this.Oc.appendChild(t.Oc);t.Sma()}if(b=this.$al(b))this.Rvb?this.Rvb.menu=b:(k=this.id+"OverflowMenuLauncher",t={},t.Image20by20=this.BCe.OverflowMenuImage20by20,t.Image20by20Class=this.BCe.OverflowMenuImage20by20Class,t.PopulateDynamically="false",t.HideDefaultArrow="true",t.Alt=this.BCe.OverflowMenuTooltip,t.Command="798637440",t.Id=k,this.Rvb=new Lz.FlyoutAnchor(this.root,k,t,b)),b=this.Rvb.uQ("Small20"),b.enabled=!0,this.O_b(b,this.children.count),this.Oc.appendChild(b.Oc),
b.Sma();if(w.AFrameworkApplication.K.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const P of D){var D=P.uQ("Medium20");this.Hf(D);D.Sma()}}dispose(){this.Rvb&&(this.Rvb.dispose(),this.Rvb=null);for(const b of this.QQc)b.dispose();this.Oce();super.dispose()}set RA(b){super.RA=b}}Uv.SOh=4;Object(n.a)(Uv,"HeroDock",Wy.a,[]);var Ht=c(599);class Xy extends Ht.a{constructor(){super();this.bke=this.cNm=this.JAo=!1;this.R9m=w.AFrameworkApplication.rEf?1:Uv.SOh}}Object(n.a)(Xy,"ToolbarBuildOptions",
Ht.a,[]);var Zi=c(45),LB=c(864),MB=c(707);class vq extends Wy.a{constructor(b,k,t){super(b,k,"","");this.soc=t.Alignment;this.JSg=t.ScalingDirection===Zi.a.xNj}ym(){this.fva();this.KW(this.Oc);super.ym()}KW(b){for(let k of this.children){k.zC();switch(this.soc){case Zi.a.Xpe:Va.a.Xf(k.Oc,"cui-toolbar-button-left");break;case Zi.a.v8a:Va.a.Xf(k.Oc,"cui-toolbar-button-center");break;case Zi.a.wRb:Va.a.Xf(k.Oc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.soc);}k.visible&&
b.appendChild(k.Oc);k.Sma()}}tO(b){if(!Object(ob.a)(lm.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");}get cssClass(){switch(this.soc){case Zi.a.Xpe:return"cui-toolbar-buttondock alignleft";case Zi.a.v8a:return"cui-toolbar-buttondock aligncenter";case Zi.a.wRb:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.soc);}}get RA(){return!0}get alignment(){return this.soc}N8b(){let b=0;if(this.alignment===Zi.a.v8a)for(let k of this.children){const t=
k;t.visible&&(b+=t.Oc.offsetWidth)}else b=this.Oc.offsetWidth;return b}YRd(){let b=null;if(this.alignment===Zi.a.v8a)for(let k of this.children){if(k.visible){b=Sys.UI.DomElement.getBounds(k.Oc);break}}else b=Sys.UI.DomElement.getBounds(this.Oc);return b?0===this.root.c1?b.x:b.x+b.width:0}SOd(){let b=null;if(this.alignment===Zi.a.v8a){if(0<this.children.count){const k=this.children.TOd(this.children.count-1);for(;k.i4a();){const t=k.get_current();if(t.visible){b=Sys.UI.DomElement.getBounds(t.Oc);
break}}}}else b=Sys.UI.DomElement.getBounds(this.Oc);return b?0===this.root.c1?b.x+b.width:b.x:0}Lhf(){for(let b of this.children){const k=b;if(!Object(ob.a)(lm.a,k)||k.control.visible)k.visible=!0}}x9n(b){const k=this.children.toArray(),t=new MB.a;let D=this.JSg?0:k.length-1;const P=this.children.count,ca=this.root.ATa;for(;this.N8b()>=b&&!(D>=P||0>D);){const ta=k[D];ca&&Object(ob.a)(lm.a,ta)&&ta.control.visible&&(t.add(ta),ta.nth());D+=this.JSg?1:-1}for(let ta of t)ta.I9i(),ta.visible=!1}set RA(b){super.RA=
b}}Object(n.a)(vq,"ButtonDock",Wy.a,[]);class di extends Tm.a{constructor(b,k,t,D,P,ca,ta=!1){super(b,k,ca);this.Ora=this.dZ=this.kla=null;this.jKe=!1;this.j3a=D;this.bke=P;this.zwd=0;Hf.c(k.Size)||(k.Size===Zi.a.Rsg||t.options.cNm?this.zwd=0:k.Size===Zi.a.IQj&&(this.zwd=1));this.Jlk=ta}get ATa(){return!0}Hf(b){super.Hf(b);Object(ob.a)(vq,b)&&!this.jKe&&(b.alignment===Zi.a.Xpe?(this.kla&&this.Zag(),this.kla=b):b.alignment===Zi.a.v8a?(this.dZ&&this.Zag(),this.dZ=b):b.alignment===Zi.a.wRb&&(this.Ora&&
this.Zag(),this.Ora=b))}Zag(){this.jKe=!0;this.Ora=this.dZ=this.kla=null}dob(b,k){b=this.wNc(b);Hf.c(b)||b.visible===k||(b.visible=k,this.refresh())}ym(){super.ym();this.w7i(!0)}w7i(b){const k=this.root.OAb;Hf.c(this.Oc)&&this.sdl();this.Oc=Va.a.rSa(this.Oc);this.RQc&&this.Oc.appendChild(this.RQc);for(let t of this.children)t.visible&&(t.zC(),this.Oc.appendChild(t.Oc),t.Sma());this.dZ&&b&&this.utl();k&&k.FY();this.dirty=!1}utl(){if(this.dZ.visible&&this.dZ.children.count&&(this.Ath(0,0),this.Fpl(this.kla,
this.dZ,this.Ora))){let b=0,k=0;const t=this.kla?this.kla.N8b():0,D=this.Ora?this.Ora.N8b():0;if(0<D||0<t)D>t?(b=0,k=D-t):(b=t-D,k=0);this.Ath(b,k)}}Fpl(b,k,t){let D=!1;0===this.root.c1?(b&&(D=b.SOd()>k.YRd()),!D&&t&&(D=k.SOd()>t.YRd())):(b&&(D=b.SOd()<k.YRd()),!D&&t&&(D=k.SOd()<t.YRd()));return D}Ath(b,k){0===this.c1?(this.dZ.Oc.style.marginLeft=b+"px",this.dZ.Oc.style.marginRight=k+"px"):(this.dZ.Oc.style.marginRight=b+"px",this.dZ.Oc.style.marginLeft=k+"px")}sdl(){this.zC()}fu(){this.ESh(()=>{jz.a.prototype.fu.call(this)})}ypa(b){b=
this.wNc(b);Hf.c(b)||this.ESh(Object(A.a)(b,b.xm,"pollForStateAndUpdate"))}ESh(b){this.Ndc=this.l4a=!1;b();if(this.l4a||this.Ndc)this.Jlk||this.refresh(),this.scale()}tO(b){if(!Object(ob.a)(Uv,b)&&!Object(ob.a)(vq,b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(ob.a)(vq,b)&&b.alignment===Zi.a.v8a)for(let k of this.children)if(k.alignment===Zi.a.v8a)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b=
"cui-toolbar-toolbar ";0===this.zwd?(b+="cui-toolbar-onerow ",w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.F8||(b+="UITextTranformUpperCase ")):1===this.zwd&&(b+="cui-toolbar-singledock ");return b+super.cssClass}get Tua(){return"div"}get y9(){return 26}get Zyj(){return this.aO}set Zyj(b){this.aO=b}U7k(b){b=b[Zi.a.xw];return new vq(this.root,b.Id,b)}zC(){super.zC();this.Oc.setAttribute("role","toolbar");this.properties.Title&&this.Oc.setAttribute("title",this.properties.Title)}HIa(b){return this.root&&
this.root.Lgc(b)?!0:!1}mgo(){this.TSa()}scale(){super.scale();if(!Va.a.Rr(this.properties.Scale)||this.jKe)return!1;Hf.c(this.kla)||(this.kla.visible=!0,this.kla.Lhf());Hf.c(this.dZ)||(this.dZ.visible=!0,this.dZ.Lhf());Hf.c(this.Ora)||(this.Ora.visible=!0,this.Ora.Lhf());this.w7i(!1);const b=this.Oc.offsetWidth,k=Hf.c(this.kla)?0:this.kla.N8b(),t=Hf.c(this.dZ)?0:this.dZ.N8b(),D=Hf.c(this.Ora)?0:this.Ora.N8b();D+t+k>=b&&(D+k>=b?(this.$mi(this.dZ),D>=b?(this.$mi(this.kla),this.b9f(this.Ora,b)):this.b9f(this.kla,
b-D)):this.b9f(this.dZ,b-D-k));this.l4a=!1;this.ym();return!1}$mi(b){b&&(b.visible=!1)}b9f(b,k){b&&b.x9n(k)}}Object(n.a)(di,"Toolbar",Tm.a,[854]);class jt extends di{constructor(b,k,t,D,P=!1){super(b,k,t,!1,!1,D,P);this.i4g=!0}get y9(){return 7}get cssClass(){return jt.KAo+" "+super.cssClass}static get KAo(){let b="cui-statusbar";w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.F8||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(n.a)(jt,"StatusBar",di,[]);var oy=c(477);class as extends oy.a{constructor(){super();
this.toolbar=null;this.n_d=!1}}Object(n.a)(as,"ToolbarBuildContext",oy.a,[]);class NB extends og.Builder{constructor(b,k,t,D){super(b,k,Rj.Task.J3(t),D);if(Hf.c(k))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}fcg(b){this.root=b}get Hjg(){return this.options}ONk(){const b=new as,k=new LB.a;k.id="toolbar";k.P2c=1;k.handler=Object(A.a)(this,this.grn,"onReturnToolbarData");k.data=b;this.Hua.Hee(k)}grn(b){this.fcg(this.QNk(b.k2c,b.mHc));this.toolbar.Zyj=
this;this.toolbar.ym();this.placeholder.appendChild(this.toolbar.Oc);Va.a.Xf(this.placeholder,"loaded");this.Tta.continueWith(()=>{this.Tta.result.bKb(this.toolbar)},11)}QNk(b,k){var t=Zi.a.Aga(b,Zi.a.tRj);Hf.c(t)&&(t=Zi.a.Aga(b,Zi.a.PQj),k.n_d=!0);if(Hf.c(t))throw Error.create("No toolbar element was present in the data");b=new Zi.a(t);t=w.AFrameworkApplication.K.$("ToolbarScalingRedundancyEliminationIsEnabled");k.n_d?this.fcg(new jt(b.attributes[Zi.a.id],b.attributes,this,this.daa,t)):this.fcg(new di(b.attributes[Zi.a.id],
b.attributes,this,this.Hjg.JAo,this.Hjg.bke,this.daa,t));this.toolbar.aua=this.options.aua;this.toolbar.Vne=!0;this.toolbar.ym();b=Zi.a.iw(Zi.a.Aga(b.node,Zi.a.fNj));k=this.qLk(b,k);for(const D of k)this.toolbar.Hf(D);return this.toolbar}qLk(b,k){const t=[];for(let D=0;D<b.length;D++)this.iQa(b[D])||Array.add(t,this.ULk(b[D],k));return t}ULk(b,k){const t=Zi.a.FOc(b);let D=null;t===Zi.a.FLj?D=this.ALk(b,k):t===Zi.a.NNj&&(D=this.rMk(b,k));return D}rMk(b,k){var t=new Zi.a(b);t=new Uv(this.root,t.attributes[Zi.a.id],
b[Zi.a.xw]);t.Vmi=this.Hjg.R9m;b=Zi.a.Aga(b,Zi.a.Hqb);b=Zi.a.iw(b);const D=[];for(let ca=0;ca<b.length;ca++){var P=b[ca];this.iQa(P)||(P=this.mfa(P,k),Array.add(D,P))}t.QQc=D;return t}ALk(b,k){new Zi.a(b);const t=this.toolbar.U7k(b);b=Zi.a.Aga(b,Zi.a.Hqb);b=Zi.a.iw(b);for(let D=0;D<b.length;D++){if(this.iQa(b[D]))continue;const P=this.PNk(b[D],k);t.Hf(P)}return t}PNk(b,k){var t=new Zi.a(b);const D=t.name;t=t.attributes[Zi.a.snc];let P;P=k.n_d?"Small14":"Small";switch(D){case Zi.a.button:return b=
this.mfa(b,k),b.uQ(Hf.b(t)?P:t);case Zi.a.XDa:return P=k.n_d?"Medium14":"Medium",b=this.mfa(b,k),b.uQ(Hf.b(t)?P:t);case Zi.a.label:return b=this.mfa(b,k),b.uQ(Hf.b(t)?P:t);case Zi.a.separator:return b=this.mfa(b,k),b.uQ("Small");case Zi.a.toggleButton:return b=this.mfa(b,k),b.uQ(Hf.b(t)?P:t);default:throw Error.create("Invalid control type.");}}}Object(n.a)(NB,"ToolbarBuilder",og.Builder,[]);var Fw=c(1454);class Nu{constructor(b,k,t,D,P,ca){this.Nlb=()=>{this.toolbar.xm()};this.jI=b;b=new ln.CuiHelper(Nh.a.oZa,
WordEditorIntl.WordEditorStrings,null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);D=new Xy;D.TG={};ca=3!==ca.mode;D.TG.HeaderToolbarControlsRight=ca;D.TG.HeaderToolbarButtonDockRight=ca;D.TG.HeaderToolbarButtonRemovePageNumbers=ca;P=new NB(D,this.jI,this,P);P.Hua=new Fw.a(Nu.iqm,b);P.ONk();this.xla=P.toolbar;t.execute(ta=>{this.toolbar.zF=ta});this.toolbar.refresh();this.toolbar.xm();this.Jh=k;k.UYa(this.Nlb)}get toolbar(){return this.xla}dispose(){this.Jh.Zgc(this.Nlb);this.toolbar&&(this.toolbar.dispose(),
this.xla=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.mgo()}Tml(){this.toolbar.x3()}bKb(){}}Nu.iqm="WordEditorHeaderToolbarData";Object(n.a)(Nu,"HeaderFooterToolbar",null,[145,409]);class MA{constructor(b,k,t,D,P){this.Jh=b;this.zwe=k;this.ld=t;this.daa=D;this.ga=P}create(b){return new Nu(b,this.Jh,this.zwe,this.ld,this.daa,this.ga)}}Object(n.a)(MA,"Factory",null,[371]);class Gw{constructor(b,k){this.Wc=b;this.Qk=k}ncl(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+
this.mcl(b)+"</Controls></MenuSection></Menu>"}FWl(b){const k=this.Wc.xk();k.set(b);k.zb(8);k.hd(8);return k}mcl(b){if(!b)return"";let k="";b=this.FWl(b);this.Qk.xOa(b,t=>{const D=this.Qk.$ii(t);t=t.getValue(Cc.a.Hia);k+=gl.k(t.toString(),t.toString(),Nc.a.F$f.toString(),Nc.a.Z0f.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,D));return!0});return k}}Object(n.a)(Gw,"HeaderFooterToolbarGenerator",null,[370]);var Mz=c(122);class Nz extends Bz.a{constructor(b,
k,t,D,P,ca,ta,Na){super(b,k,t,D);this.Us=()=>{this.zad(this.Bb)};this.jI=b.container;this.Qv=document.createElement("div");this.LG(this.Qv);this.jBa=P;this.wKa=ca;this.xo.execute(qb=>{qb.I0(this.Us)});this.mK=ta;if(this.tI=Na)this.jI.style.backgroundColor=this.mK.V7b()}dispose(){super.dispose();this.xo.instance&&this.xo.instance.E5a(this.Us)}get xo(){return null!=this.aAg?this.aAg:this.aAg=Fa.a.instance.Sa("Common.IZoomManager")}$B(b){this.jI.classList.add("HeaderFooterViewElement");this.Qv.classList.add("HeaderFooterViewContent");
this.zad(b.currentNode)}tda(b){this.Qv.parentNode&&this.Qv.parentNode===this.jI||(this.jI.appendChild(this.Qv),this.wKa.instance&&this.wKa.instance.jcg(this.oc,this.jI));super.tda(b)}xQb(b){Mz.a.ie(()=>{Mz.a.prototype.xQb.call(this,b);this.fEj();this.wKa.instance&&this.wKa.instance.mDj(this.oc,this.Qv.style.paddingLeft,this.Qv.style.paddingTop)},"HFVE:UFO")}zad(b){this.xo.instance&&this.xo.instance.hcd(this.Qv);this.fEj();b=this.jBa.r8b(b);this.Qv.style.paddingLeft=b.g3b+"px";this.Qv.style.width=
b.lHc+"px";this.wKa.instance&&this.wKa.instance.mDj(this.oc,this.Qv.style.paddingLeft,this.Qv.style.paddingTop)}fEj(){if(this.xo.instance){this.Qv.style.paddingTop="";var b=Co.a.sB(this.Qv);b.paddingTop&&(b=fc.a.OM(b.paddingTop),this.Qv.style.paddingTop=Math.round(b/this.xo.instance.ij)+"px")}}}Object(n.a)(Nz,"HeaderFooterViewElement",Bz.a,[]);class uC{constructor(b,k,t,D){this.jBa=b;this.wKa=k;this.mK=t;this.tI=D}create(b,k,t,D){return new Nz(b,k,t,D,this.jBa,this.wKa,this.mK,this.tI)}}Object(n.a)(uC,
"Factory",null,[369]);var vC=c(348),Vv=c(192),wC=c(969),xx=c(576);class yx extends vC.a{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed,sd,oe,Ld){super(k,ca,ta,Na,qb,Vv.a.Vni,Jb,Vb,ac,yc,Kc,ed,sd,oe,Ld);this.isHeader=this.isHeader=b;this.HXa=P;this.HXa.L9c=this;D(this);this.Zfd=t;this.pAa=document.createElement("div");this.pAa.setAttribute("Unselectable","on");this.pAa.setAttribute("hideselection","hideselection");this.pAa.setAttribute("style","outline:none;");this.pAa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;
this.pAa.tabIndex=0;this.features.Rpj=!0;this.features.z5e=!0}get xDf(){return!0}uvf(){const b=this.Zfd.nmf(this);return wC.ViewReference.eF(this,b)}Qef(b){Object(ob.a)(yx,b)||this.Zfd.dismiss()}get yxf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}jPc(){return xx.a.PNi}onResize(){super.onResize();this.HXa.kWh()}LE(b,k=null){this.pAa.parentNode&&this.pAa.parentNode.removeChild(this.pAa);super.LE(b,k);this.HXa.XVh(this.ed.hj)}detach(){this.HXa.jWh();super.detach();this.pAa.parentNode||
this.container.insertBefore(this.pAa,this.container.firstChild)}b7c(){this.fv?super.b7c():this.pAa.focus()}YMd(){this.onResize()}}Object(n.a)(yx,"HeaderFooterView",vC.a,[407,107,61,62,9,108,109,110,111]);class py{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed,sd){this.Zfd=b;this.wnk=k;this.vnk=t;this.Mt=D;this.fd=P;this.yla=ca;this.ga=ta;this.kWa=Na;this.fta=qb;this.Q6=Jb;this.cok=Vb;this.Ht=ac;this.Jy=yc;this.Qf=Kc;this.yh=ed;this.Rfd=sd}create(b,k){return new yx(b,k,this.Zfd,this.wnk,this.vnk(),
this.Mt,this.fd,this.yla,this.ga,this.kWa,this.fta,this.Q6,this.cok,this.Ht,this.Jy,this.Qf,this.yh,this.Rfd)}}Object(n.a)(py,"Factory",null,[368]);class Yy{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed,sd,oe,Ld){this.l$g=!1;this.qgh="SourceControlId";this.lHo=1;this.mHo=1E3;this.Uae=(Od,ie,Ce,hg,Kg)=>{if(1===Ce)return 32;this.zjd(Kg[this.qgh]);Kg[Mi.a.Text]=this.DMe.Wwn(this.zbb.aGb);return 32};this.wJn=(Od,ie,Ce,hg,Kg)=>{if(1===Ce)return 32;Kg[kg.a.On]=this.zbb.aGb;return 32};this.xum=(Od,
ie,Ce,hg,Kg)=>{if(1===Ce)return 32;this.zbb.RTo(Kg[kg.a.On]);return 32};this.f$i=(Od,ie,Ce)=>{if(1===Ce)return 32;if(this.z$){ie=Yy.fh.Ts(ie.view.ed);Ce=ze.GraphIterator.$a(ie);const hg=this.Ud.kZa();try{const Kg=this.Hc.Mc(15);try{Kg.Cb(ie),Kg.fk=Od,xn.a.instance.xOa(Ce,Hl=>{this.uXb.V3c(Hl,this.BRl,this.yho);return!0})}finally{Kg&&Kg.dispose()}}finally{hg&&hg.dispose()}}return 32};this.s1c=(Od,ie,Ce,hg,Kg)=>{if(1===Ce)return 32;Kg.MenuItems=this.tdk.value;this.l$g?this.zbb.I3n():this.l$g=!0;return 32};
this.JAm=(Od,ie,Ce,hg,Kg)=>{if(1===Ce)return 32;const Hl=this.zjd(Kg[this.qgh]);if(this.z$){ie=Yy.fh.Ts(ie.view.ed);Ce=ze.GraphIterator.$a(ie);hg=this.Hc.Mc(15);try{hg.Cb(ie);hg.fk=Od;let wm=null;const bp=this.he.Zf("UserAction","InsertPageNumber");xn.a.instance.xOa(Ce,qv=>{this.z$.aba||this.b1j(qv);wm=this.CMe.HAm(qv,Hl,this.zbb.aGb)||wm;return!0});bp.stop();if(!wm)return 8;this.huo(wm,Hl)}finally{hg&&hg.dispose()}this.Ud.Js(12)}return 32};this.Vwn=()=>32;this.Puo=(Od,ie,Ce,hg,Kg)=>{if(1===Ce)return 32;
2===Ce&&this.ELa.showCallout(Kg);return 32};this.Ouo=(Od,ie,Ce,hg,Kg,Hl)=>this.RRe.create(Od,ie,Ce,hg,Kg,Hl);this.Wml=(Od,ie,Ce)=>{if(1===Ce)return 32;this.ELa.NRh();return 32};this.bto=Od=>{w.AFrameworkApplication.va.Dpa(null,Nc.a.vrj,Od.customData,null)};this.BRl=Od=>{const ie=af.a.instance.hb.kb;let Ce=-1;for(const hg of ie)if(hg.node===Od){Ce=hg.cpBegin;break}return{returnValue:Ce,YYd:hf.SelectionEditor.km(ie)}};this.yho=(Od,ie)=>{Od=Gf.SelectionFactory.te(Od,ie);af.a.instance.setSelection(Od)};
this.ga=b;this.Hc=k;this.Hb=t;this.zbb=D;this.z$=P;this.am=ca;this.DMe=ta;this.CMe=Na;this.uXb=qb;this.ELa=Jb;this.ib=Vb;this.RRe=ac;this.he=yc;this.Ud=Kc;this.zjd=ed;this.b1j=Ld;this.tdk=new Rg.a(()=>this.zbb.a5l())}Tb(){this.ga.fb(Nc.a.s1c,lc.a.view,this.s1c,100);this.ga.fb(Nc.a.nZi,lc.a.view,this.Vwn,68);this.ga.fb(Nc.a.rri,lc.a.view,this.JAm,4);this.ga.fb(Nc.a.aGb,lc.a.view,this.xum,4);this.ga.fb(Nc.a.V3c,lc.a.view,this.f$i,4);this.ga.fb(Nc.a.NYn,lc.a.view,this.f$i,4);this.ga.fb(Nc.a.B1f,lc.a.application,
this.wJn,97);this.ga.fb(Nc.a.Uae,lc.a.application,this.Uae,97);this.ga.fb(Nc.a.urj,lc.a.view,this.Puo,4);this.ga.cT(Nc.a.vrj,lc.a.view,this.Ouo,100);this.ga.fb(Nc.a.Vml,lc.a.view,this.Wml,4)}huo(b,k){const t=b.Ib.paragraph;if(t){var D=this.am.S4d(t);D&&this.z$.cga(D)}D=this.z$.aba;this.z$.show(4>k);t&&this.Ogo(t)&&(this.Sko(b,t),this.kuk(b,D))}Ogo(b){let k;if(!({isHeader:k,xig:b}=this.am.uhi(b)).returnValue)return!1;this.z$.yya(b,k);return!0}Sko(b,k){b=Gf.SelectionFactory.te(k,b.Ib.cp);this.ib.setSelection(b)}kuk(b,
k){k=new Df.a(2,1,k?this.lHo:this.mHo,this.bto);k.customData=b;this.Hb.Vb(k)}static get fh(){return Wk.PageNavigator.instance}}Object(n.a)(Yy,"PageNumbersActor",null,[408]);class Vh{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc){this.ga=b;this.Hb=k;this.zbb=t;this.DMe=D;this.CMe=P;this.uXb=ca;this.ELa=ta;this.RRe=Na;this.am=qb;this.Ud=Jb;this.zjd=Vb;this.Emk=ac;this.Nea=yc}create(b,k){return new Yy(this.ga,new tk.a,this.Hb,this.zbb,b,this.am,this.DMe,this.CMe,this.uXb,this.ELa,af.a.instance,this.RRe,
Wa.App.ya.Fq,this.Ud,this.zjd,this.Emk,this.Nea,k)}}Object(n.a)(Vh,"Factory",null,[367]);var qy=c(1935),ry;(function(b){b[b.small=0]="small";b[b.mediumSmall=1]="mediumSmall";b[b.medium=2]="medium";b[b.large=3]="large"})(ry||(ry={}));Object(n.b)("ModalCalloutSize",ry);var Vo;(function(b){b[b.topCenter=0]="topCenter";b[b.topJustified=1]="topJustified";b[b.topLeft=2]="topLeft";b[b.topRight=3]="topRight";b[b.bottomCenter=4]="bottomCenter";b[b.bottomLeft=5]="bottomLeft";b[b.bottomRight=6]="bottomRight"})(Vo||
(Vo={}));Object(n.b)("BeakLocation",Vo);class kt{constructor(b,k,t){this.kHo=1;this.UOe=!1;this.KYb=null;this.wTn=()=>{this.ib.Lw(this.Epa);this.UOe=!0;this.KYb=null};this.Epa=(D,P)=>{if(D=P.nl.kb)1<D.length||!D.length?D=!0:(D=D.Qa,D=D.cpEnd-D.cpBegin,D=1<D||!D),D&&this.b0j()};this.Hb=b;this.ib=k;this.b0j=t}wz(){this.juk()}X9(){this.UOe?(this.ib.CY(this.Epa),this.UOe=!1):this.KYb&&(this.Hb.Ve(this.KYb),this.KYb=null)}juk(){this.KYb=new Df.a(2,1,this.kHo,this.wTn);this.Hb.Vb(this.KYb)}}Object(n.a)(kt,
"CalloutDismissManager",null,[]);class Wv{constructor(b,k,t,D){this.dismiss=()=>{this.Xw&&(this.Arc.X9(),this.UYc.dismiss())};this.UYc=b;this.Rp=D;this.Arc=new kt(k,t,this.dismiss)}get Xw(){return this.UYc.Xw}show(){if(!this.Xw){const b=document.createElement("div");b.classList.add(Wv.Uwn);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.UYc.content=b;this.UYc.show();this.Rp&&this.Rp.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.Arc.wz()}}dispose(){this.dismiss();
this.UYc.dispose()}static jal(b,k){k=qy.a.xLh($d.a.getElementBounds(b.targetElement),k,Wa.App.ya.jD,ry.small);k.hfa=Wv.Nnf(b);k.rt=!1;return k}static Nnf(b){let k=Vo.bottomCenter;Object(ob.a)(407,b.view)&&b.view.isHeader&&(k=Vo.topCenter);return k}}Wv.Uwn="PageNumbersCalloutControl";Object(n.a)(Wv,"PageNumbersCallOutControl",null,[406]);class on{constructor(b,k,t){this.GS=null;this.xS=!1;this.dismiss=()=>{this.Xw&&this.GS&&bk.UISurfaces.tM().then(D=>{this.Arc.X9();D.removeNotification(this.GS);this.xS=
!1;return null},D=>{v.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",D);return null})};this.vl=b;this.Arc=new kt(k,t,this.dismiss)}get Xw(){return this.xS}show(){this.Xw||bk.UISurfaces.tM().then(b=>{const k=b.callout(Object.assign(new lq.a,{target:this.vl,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),t=Object.assign(new en.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.xS=!0},expirationOptions:Object.assign(new Dm.a,{displayTimeoutSeconds:7,
onExpire:()=>{this.dismiss()}})});this.GS=b.addNotification(k,t);this.Arc.wz();return null},b=>{v.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(n.a)(on,"ReactPageNumbersCallOutControl",null,[406]);class xi{constructor(b,k,t){this.ib=k;this.Hb=b;this.Rp=t}create(b,k){if(w.AFrameworkApplication.ta.Nb&&w.AFrameworkApplication.ta.Nb.oQa)return new on(k.targetElement,this.Hb,this.ib);b=Wv.jal(k,b);return new Wv(b,this.Hb,this.ib,this.Rp,w.AFrameworkApplication.ta.tP)}}
Object(n.a)(xi,"Factory",null,[365]);class sy{constructor(b,k){this.qE=null;this.rdk=b;this.Ui=k}get control(){return this.qE}showCallout(b){this.control&&this.control.Xw&&this.control.dismiss();this.qE=this.nEn(b);this.control.show()}NRh(){this.control&&(this.control.dismiss(),this.qE=null)}nEn(b){const k=this.Ui.lna();this.qE=this.rdk.value.create(k,b);return this.control}}Object(n.a)(sy,"PageNumbersCalloutControlManager",null,[366]);var zx=c(753);class Hw extends my.a{constructor(){super();this.Text=
null}get Type(){return 7}}Object(n.a)(Hw,"PageNumberGalleryButtonProps",my.a,[]);const lp=(b,k,t)=>{b=b.xk();b.set(t);k.zJb(b);return b};class lu{constructor(b,k,t){this.MDe=!1;this.Nea=k;this.em=t}get aGb(){return this.MDe}a5l(){const b=Object.assign(new be.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.Trk());b.MenuSectionList.push(this.Jsk());b.MenuSectionList.push(this.ktk());return b}RTo(b){this.MDe=b;this.u7i()}I3n(){this.MDe=!1;const b={};b[lu.kpi]="CheckboxModel";
this.Nea(b);this.u7i()}Trk(){const b=Object.assign(new fh.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:F.a.Af(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),k=Object.assign(new zx.a,{Id:lu.yum,Command:Nc.a.aGb.toString(),QueryCommand:Nc.a.B1f.toString(),LabelText:F.a.Af(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:F.a.Af(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,
UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(k);return b}Jsk(){const b=Object.assign(new fh.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),k=Object.assign(new Jj.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.em){for(var t=3;1<=t;t--)k.GalleryItems.push(this.hqf(t));for(t=6;4<=t;t--)k.GalleryItems.push(this.hqf(t))}else for(t=
1;6>=t;t++)k.GalleryItems.push(this.hqf(t));b.ControlList.push(k);return b}ktk(){const b=Object.assign(new fh.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),k=Object.assign(new zg.a,{Id:"btnRemovePageNumber",Command:Nc.a.V3c.toString(),LabelText:F.a.Af(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:F.a.Af(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:w.AFrameworkApplication.Rs,Image16by16Class:od.getImageClass("WordRemovePageNumbers_16x16x32"),
KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(k);return b}hqf(b){const k=lu.qXf+b.toString();var t=Object,D=t.assign,P=new Hw,ca=Nc.a.rri.toString(),ta=Nc.a.Uae.toString(),Na=F.a,qb=Na.Af;let Jb="";switch(b){case 1:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;
break;case 5:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return D.call(t,P,{Id:k,Command:ca,QueryCommand:ta,Alt:qb.call(Na,Jb)})}u7i(){const b={};for(let k=1;6>=k;k++)b[lu.qXf+k.toString()]="PageNumberGalleryButtonModel";b[lu.kpi]="CheckboxModel";this.Nea(b)}static b5l(b){return b?parseInt(b.substr(lu.qXf.length)):1}}lu.yum="btnIncludePageCount";lu.kpi="IncludePageCount";lu.qXf="btnPageNumbersPosition";
Object(n.a)(lu,"PageNumbersControl",null,[364]);class Ks{constructor(b,k,t,D,P=null,ca=null,ta=null,Na=null){this.hXl=(qb,Jb)=>{const Vb=new Ph.a;qb=4>qb;switch(Jb){case 1:case 2:Vb.add(qb?0:3);break;case 3:case 4:Vb.add(qb?0:3),Vb.add(qb?1:4)}return Vb};this.gQl=(qb,Jb,Vb)=>{var ac=lp(this.Wc,this.am,qb);this.am.AJb(ac,Vb);let yc=this.uZj(ac,Jb);if(yc)this.uXb.H$i(yc);else{ac=lp(this.Wc,this.am,qb);this.am.AJb(ac,Vb);ac.Qd();if(va.OutlineElementReader.Bh(ac)&&(ag.OutlineElementNavigator.Ge(ac),pe.ParagraphReader.uh(ac))){ac=
ac.currentNode;const Kc=this.zhi(Jb);pe.ParagraphReader.Cx(ac)===Kc&&this.uXb.H$i(ac)&&(yc=ac)}yc||(ac=lp(this.Wc,this.am,qb),this.am.AJb(ac,Vb),this.iL.Uib(ac,null,!0),yc=ag.OutlineElementNavigator.Ge(ac),this.gE(Jb,yc))}return yc};this.hQl=(qb,Jb)=>{let Vb=null;qb.Rb(1);if(va.OutlineElementReader.Bh(qb)&&(qb.Rb(2),Ih.TableReader.isTable(qb))){var ac=qb.currentNode;if(3===Ih.TableReader.Yg(ac)){let yc=0;ac=Ih.TableReader.$m(ac);switch(Jb){case 1:case 4:yc=ac?2:0;break;case 2:case 5:yc=1;break;case 3:case 6:yc=
ac?0:2}mh.moveToCellContent(qb,0,yc);qb.currentNode&&va.OutlineElementReader.Bh(qb)&&(qb=ag.OutlineElementNavigator.Ge(qb),pe.ParagraphReader.Wb(qb)&&(Vb=qb))}}return Vb};this.MJm=(qb,Jb)=>{const Vb=lp(this.Wc,this.am,qb);qb=Vb.currentNode.ia(Cc.a.Hia,0);this.am.AJb(Vb,Jb);Jb=Vb.currentNode.ia(Cc.a.Hia,0);return qb===Jb};this.Wc=b;this.udk=k;this.uXb=t;this.am=D;this.Ftc=P||this.hXl;this.vZj=ca||this.gQl;this.uZj=ta||this.hQl;this.z7j=Na||this.MJm}get iL(){return null!=this.dEg?this.dEg:this.dEg=
Fa.a.instance.resolve("Box4.IOutlineEditor")}HAm(b,k,t){var D=lp(this.Wc,this.am,b).Nn;D=this.am.Lga(D);D=this.Ftc(k,D);let P=null;for(let ta=0;ta<D.length;ta++){var ca=D.ag(ta);this.z7j(b,ca)&&(ca=this.vZj(b,k,ca),P=this.udk.Isk(ca,t)||P)}return P}gE(b,k){Ks.r5.Xge(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,k);Ks.paragraphEditor.gE(k,this.zhi(b))}zhi(b){let k=1;switch(b){case 1:case 4:k=1;break;case 2:case 5:k=2;break;case 3:case 6:k=3}return k}static get paragraphEditor(){return null!=
Ks.$Eg?Ks.$Eg:Ks.$Eg=Fa.a.instance.resolve("Box4.IParagraphEditor")}static get r5(){return null!=Ks.yGg?Ks.yGg:Ks.yGg=Fa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(n.a)(Ks,"PageNumbersInserter",null,[363]);var ty=c(877),xC=c(886);class Hr{constructor(b,k,t=null,D=null,P=null){this.q7k=(ca,ta)=>{ca=Of.a.Rc(ca,pe.ParagraphReader.textLength(ca));const Na=ca.node.Kc;return Na?Hr.characterPropertiesEditor.Uga(ca,qb=>{qb=xC.a.getInstance(qb);this.nGd(qb,15,Na,ta);this.nGd(qb,47,Na,ta);this.nGd(qb,
16,Na);this.nGd(qb,17,Na);return qb}):null};this.kBm=(ca,ta)=>{ca=Of.a.Rc(ca,pe.ParagraphReader.textLength(ca));Hr.characterPropertiesEditor.replaceTextRange(ca,ta)};this.Hc=b;this.vqd=t||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.uwe=D||this.q7k;this.bih=P||this.kBm}Isk(b,k){const t=this.Hc.Mc(15);t.Cb(b);var D=pe.ParagraphReader.text(b),P=!1;0<D.length&&" "!==D.charAt(D.length-1)&&(P=!0);if(k){k=String.format(this.vqd,"#","$");P&&(k=" "+k);P=k.indexOf("#");D=k.indexOf("$");
v.ULS.shipAssertTag(4256717,309,-1!==P,"{0}",{["PageNumberIndex"]:P});v.ULS.shipAssertTag(4256718,309,-1!==D,"{0}",{["PageCountIndex"]:D});v.ULS.shipAssertTag(4256719,309,P!==D,"{0}",{["PageNumberIndex"]:P,["PageCountIndex"]:D});let Na;let qb;if(P<D){var ca=P;Na=D;var ta=ty.a.QNc(0);qb=ty.a.QNc(1)}else ca=D,Na=P,ta=ty.a.QNc(1),qb=ty.a.QNc(0);this.BAf(b,k,0,ca);ta=this.uwe(b,ta);this.BAf(b,k,ca+1,Na);ca=this.uwe(b,qb);this.BAf(b,k,Na+1,k.length);b=P<D?ta:ca}else P&&this.bih(b," "),b=this.uwe(b,ty.a.QNc(0));
t.dispose();return b}nGd(b,k,t,D=null){const P=new Yx.a;P.setValue(sf.a.T9,!0);P.setValue(Cc.a.OCb,1);P.setValue(Cc.a.Ys,k);switch(k){case 15:P.setValue(Cc.a.tQa,!0);P.setValue(Cc.a.fieldInstruction,D);break;case 47:P.setValue(Cc.a.fieldInstruction,D);break;case 17:P.setValue(Cc.a.NHb,!0)}k=t.Ju(P,X.a.create());this.Etk(b,k)}Etk(b,k){b.zta(k,X.a.nil,Un.AParagraphNode.yC,null)}BAf(b,k,t,D){k=k.substring(t,D);0<k.length&&this.bih(b,k)}static get characterPropertiesEditor(){return Hr.Kd||(Hr.Kd=Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(b){Hr.Kd=
b}}Hr.Kd=null;Object(n.a)(Hr,"PageNumbersNodeLevelInserter",null,[362]);class Ou{Wwn(b){return Ou.v7l(b)}static v7l(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,Ou.aZi,Ou.aZi)}}Ou.aZi="1";Object(n.a)(Ou,"PageNumbersPositionPreviewGenerator",null,[360]);class OB{constructor(){this.gPg=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");
this.PYj=this.gPg.length}xpm(b){let k=b.characterData.lastIndexOf("\ufffc");return-1!==k&&k+1===pe.ParagraphReader.textLength(b)?{returnValue:!0,v1c:k}:{returnValue:!1,v1c:-1}}fom(b){let k=b.characterData.lastIndexOf(this.gPg);return-1!==k&&k+this.PYj===pe.ParagraphReader.textLength(b)?{returnValue:!0,v1c:k}:{returnValue:!1,v1c:-1}}Xom(b){return Oi.a(b,9)?!0:!1}}Object(n.a)(OB,"PageNumbersReader",null,[361]);class PB{constructor(b,k,t,D,P,ca=null,ta=null){this.MYn=(Na,qb,Jb,Vb)=>{Na=lp(this.Wc,this.am,
Na);this.am.AJb(Na,qb);qb=mr.a.Kp(Na);for(Na=!1;qb.moveNext();){const ac=qb.currentNode;if(pe.ParagraphReader.Wb(qb.currentNode)&&Oi.a(qb.currentNode,9)){Na=!0;let yc;const Kc=({YYd:yc}=Jb(ac,yc)).returnValue;let ed=Kc;ed=this.sXn(ac,ed);ed=this.gZn(ac,ed);-1<Kc&&(ed===Kc&&yc||Vb(ac,ed))}}Na&&this.Ud.Js(12)};this.Wc=b;this.am=k;this.EMe=t;this.Ud=D;this.Ezc=P;this.Ftc=ca||Ty.a.Udf;this.Ifk=ta||this.MYn;this.vqd=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.MVg=String.format(this.vqd,
"#","$");this.R5j=this.MVg.indexOf("#");this.Q5j=this.MVg.indexOf("$");this.TAe=String.format(this.vqd,"\ufffc","\ufffc");this.FVg=this.TAe.length}V3c(b,k,t){var D=lp(this.Wc,this.am,b).Nn;D=this.am.Lga(D);D=this.Ftc(D);for(const P of D)this.Ifk(b,P,k,t)}H$i(b){if(this.EMe.Xom(b)){let k=-1;if(({v1c:k}=this.EMe.fom(b)).returnValue&&this.jCh(b,k)||({v1c:k}=this.EMe.xpm(b)).returnValue&&this.KTk(b,k))return!0}return!1}gZn(b,k){var t=b.pa.length;for(let P=0;P<t;P++){var D=b.pa.J(P);D.blob&&9===D.blob.Dh&&
(D=D.cp,t=Of.a.createTextRange(b,D,D+1),this.Ezc(t,""),t=b.pa.length,P--,k=this.Vqh(k,D,1))}return k}sXn(b,k){let t=b.characterData.indexOf(this.TAe);for(;-1!==t;)this.jCh(b,t)&&(k=this.Vqh(k,t,this.FVg)),t=b.characterData.indexOf(this.TAe);return k}KTk(b,k){const t=b.pa.Oh(k);return t&&t.blob&&9===t.blob.Dh?(b=Of.a.createTextRange(b,k,k+1),this.Ezc(b,""),!0):!1}jCh(b,k){const t=b.pa.Oh(k+this.R5j),D=b.pa.Oh(k+this.Q5j);return t&&t.blob&&9===t.blob.Dh&&D&&D.blob&&9===D.blob.Dh?(b=Of.a.createTextRange(b,
k,k+this.FVg),this.Ezc(b,""),!0):!1}Vqh(b,k,t){-1<b&&b>k&&(k=b-k,b=k>t?b-t:b-k);return b}}Object(n.a)(PB,"PageNumbersRemover",null,[359]);class NA{constructor(b,k){this.irb=this.hrb=null;this.Cr=b;this.Hb=k}QAk(){this.Cr.style.display="";this.hrb||(this.irb&&(this.Hb.Ve(this.irb),this.irb=null),this.hrb=new Df.a(0,1,10,()=>{this.Cr.classList.add("Displayed");this.hrb=null}),this.Hb.Vb(this.hrb))}SAk(){this.Cr.classList.remove("Displayed");this.irb||(this.hrb&&(this.Hb.Ve(this.hrb),this.hrb=null),
this.irb=new Df.a(0,1,200,()=>{this.Cr.style.display="none";this.irb=null}),this.Hb.Vb(this.irb))}}Object(n.a)(NA,"PaneControlAnimationHelper",null,[404]);class Zy{constructor(b){this.Hb=b}g5l(b){return new NA(b,this.Hb)}}Object(n.a)(Zy,"PaneControlAnimationHelperFactory",null,[358]);class OA{constructor(b,k,t,D,P,ca,ta,Na,qb=!1){this.fKg=this.xla=this.Wjd=null;this.bqm=()=>{this.su.sendNotification(this.fKg+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=
b;this.Y5=k;this.Y5.bind(this);this.bFe=t;this.Nsa=P;this.WUe=ta;this.Ub=Na;this.qld=qb;this.Wda=ca.value.create(t,D);this.Y5.bJk(this.Wda);this.sZ=Zb.KeyInputManager.kc(pc.a.t1,0)}get su(){return null!=this.Rvg?this.Rvg:this.Rvg=Fa.a.instance.resolve("Common.Utils.IAriaNotifier")}Q0(b){this.Y5.Q0(b);this.xla&&!b&&this.xla.Tml()}cga(b){this.Wjd!==b&&(this.Dfb(),this.Wjd=b)}Fij(b){if(this.Wjd){var k=this.Nsa.Z0a(this.Wjd,Ty.a.gXl(b,this.bFe));this.qld?(this.fKg=this.V2h(b,this.bFe),this.Wda.PNb(df.a.RAd)):
this.zQo(b);k&&this.i2e(k)}}evh(b){this.qld&&this.Ub&&(b=this.Ub.ge(b))&&b.d7(this.bqm)}V2h(b,k){let t="";switch(b){case 1:t=3!==this.ga.mode?k?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:k?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:t=3!==this.ga.mode?k?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:
WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:k?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:t=3!==this.ga.mode?k?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:k?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;
break;case 4:t=3!==this.ga.mode?k?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:k?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return t}zQo(b){this.Wda.Sjj(this.V2h(b,this.bFe),df.a.RAd)}setInitialSelection(){this.Wda.b7c()}i2e(b){this.Dfb();this.Wda.LE(b,b.hj)}Dfb(){this.Wda.detach()}rdl(){this.xla=
this.WUe.value.create(this.Y5.ulc);this.Ono(this.xla)}Ono(b){if(this.Ub){const k=this.Ub.ge(rs.a.P1a);k.parent=ef.AFrame.rp;k.Uea(()=>{b.setFocus();this.amo()});k.bindAction(this.sZ,Nc.a.zT)}}amo(){if(this.Ub){var b=this.Ub.ge(rs.a.P1a);const k=new Se.DOMFocusListing(()=>this.Y5.ulc);k.Mpa=!0;k.Wm(1);this.Ub.Ozb(this.Y5.ulc,b,k);b=this.Ub.getRegion(rs.a.P1a);b.mSa();b.jR=!0;k.kga&&k.Gy(k.kga)}}dispose(){void 0!==this.xla&&null!==this.xla&&(this.Ub.ge(rs.a.P1a).ir(this.sZ),this.xla.dispose())}XRn(){void 0!==
this.xla&&null!==this.xla&&this.xla.refresh()}}Object(n.a)(OA,"PaneControl",null,[308]);class PA{constructor(b,k,t,D){this.am=b;this.D4j=k;this.WUe=t;this.Ub=D}create(b,k,t,D){return new OA(b,k,t,D,this.am,this.D4j,this.WUe,this.Ub,w.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(n.a)(PA,"Factory",null,[285]);var yC=c(1095);class uy extends Vx.a{constructor(b,k,t,D,P,ca,ta,Na,qb){super();this.init(b);this.Al("ShowCalloutForPageNumberOperation");this.UTj=Na;
this.Oib(this.UTj,k,D,P,ca);this.Sz=0;this.ybb=ca;this.ELa=ta;this.Jh=qb;1===this.behavior&&(this.mr=32,this.gqa())}run(){var b=this.Jh.gb.ru;if(!this.Sz){var k=Az.a.z7b(this.ybb,b);this.ybb.BQc(b,k)&&this.ybb.Lva(b,k).element&&(this.Sz=1)}1===this.Sz&&(k=Az.a.z7b(this.ybb,b),k=this.ybb.Lva(b,k),b=new yC.a(k.element,b),this.ELa.showCallout(b),this.Sz=2);2===this.Sz&&(this.mr=32,this.gqa())}}Object(n.a)(uy,"ShowCalloutForPageNumberOperation",Vx.a,[]);class QA{constructor(b,k,t){this.ELa=b;this.ga=
k;this.ORb=t}create(b,k,t,D,P,ca){return new uy(b,k,t,D,P,ca,this.ELa,this.ga,this.ORb)}}Object(n.a)(QA,"Factory",null,[284]);class Ax{get iL(){return null!=this.bEg?this.bEg:this.bEg=Fa.a.instance.resolve("Box4.IOutlineEditor")}xc(b){b.ha("WordEditor.HeaderFooter.HeaderFooterManager",()=>new Tv(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.Ue("WordEditor.HeaderFooter.IPageNumbersActorFactory"),
b.resolve("WordEditor.IHeaderFooterViewElementFactory"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new py(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),Hz.a.U8e,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),Wa.App.ya.gb,Lb.InteractiveViewManager.instance,()=>b.resolve("Box4.IUndoManager"),w.AFrameworkApplication.va,b.resolve("Box4.IInteractiveEventNotifier"),
b.Sa("Box4.ITextMetricsAdapter"),b.resolve("Box4.IRotatingCoordinateConverter"),b.Sa("Common.IZoomManager"),b.Na("Box4.IContentControlViewElementManager"),b.Na("Box4.CpConversionManagerImpl"),b.Na("Box4.ContentControlConfigSettings"),b.Na("Box4.IContentControlReader"),b.Na("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new uC(b.resolve("Box4.SectionAlignedViewPositionProvider"),
b.Sa("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Wa.App.instance&&Wa.App.instance.RC)).as("WordEditor.IHeaderFooterViewElementFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new MA(Yl.App.Ln,b.Sa("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),Yl.App.Ln,w.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").singleInstance();b.ha("WordEditor.HeaderFooter.PaneControl.Factory",
()=>new PA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.Ue("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.Ue("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),ad.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new JB(()=>{Wa.App.ya.updateCommandUI()},b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),w.AFrameworkApplication.va,
b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new Vh(w.AFrameworkApplication.va,wb.a.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),
b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,lu.b5l,Object(A.a)(Wa.App.ya,Wa.App.ya.Pad,"updateRibbonControl"),Object(A.a)(Wa.App.ya,Wa.App.ya.VG,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new Uy).singleInstance();b.ha("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",
()=>new Zy(wb.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlOwner",()=>new JA(ad.FocusManager.instance(),Wa.App.ya.jx,b.Ue("WordEditor.HeaderFooter.IPaneControlFactory"),b.Ue("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.Ue("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),w.AFrameworkApplication.va,new Rg.a(()=>Wa.App.ya.gb.wc),w.AFrameworkApplication.K,b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").singleInstance();
b.ha("WordEditor.HeaderFooter.HeaderFooterEditor",()=>new Vy(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Yg.PageReader.instance,new mk.a,xn.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new Gw(new mk.a,xn.a.instance));b.ha("WordEditor.HeaderFooter.HeaderFooterActor",()=>new kv(w.AFrameworkApplication.va,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),
xn.a.instance,new mk.a,new tk.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),kv.Zii,b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new hq(Kd.a.instance,hq.cdm(b.resolve("Box4.ITableEditor")),hq.LNl(),w.AFrameworkApplication.isRtl,ag.OutlineElementNavigator.Vd,hq.Yam(),hq.VWl(),b.resolve("Box4.IOutlineElementEditor")));b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",
()=>new KA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new mk.a,k=>this.iL.Uib(k),w.AFrameworkApplication.isRtl,Object(A.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").dOb,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter")));b.ha("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new ov(xn.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).singleInstance();
b.ha("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new IA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new mk.a,new tk.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new Jz(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),xn.a.instance,new mk.a,w.AFrameworkApplication.va)).singleInstance();
b.ha("WordEditor.HeaderFooter.PageNumbersControl",()=>new lu(Object(A.a)(Wa.App.ya,Wa.App.ya.Pad,"updateRibbonControl"),Object(A.a)(Wa.App.ya,Wa.App.ya.VG,"updateRibbonControls"),w.AFrameworkApplication.isRtl)).singleInstance();b.register(Ou,"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new Hr(new tk.a,b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersInserter",
()=>new Ks(new mk.a,b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersReader",()=>new OB).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersRemover",()=>new PB(new mk.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Object(A.a)(Ax.characterPropertiesEditor,Ax.characterPropertiesEditor.replaceTextRange,"replaceTextRange"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new sy(b.Ue("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),Wa.App.ya)).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new xi(wb.a.instance,af.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").singleInstance();
b.ha("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new QA(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),w.AFrameworkApplication.va,Wa.App.ya)).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").singleInstance();b.ha("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",()=>new Mu(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),w.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").singleInstance();
b.ha("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new Iz(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").singleInstance()}static get characterPropertiesEditor(){return null!=Ax.rwg?Ax.rwg:Ax.rwg=Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(n.a)(Ax,"HeaderFooterComponentConfiguration",null,[2]);class QB{constructor(){this.Yjd=
this.W=null}get name(){return"WordEditor.HeaderFooter"}xc(b){this.W=b;(new Ax).xc(b)}init(){this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>{this.fn()})}fn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(112)&&(this.Yjd=this.W.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.Yjd.start(),this.W.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.Yjd&&this.Yjd.dispose()}static main(){N.a.instance.Fc(new QB)}}Object(n.a)(QB,"PackageManager",null,[1,
2]);var RA=c(362),RB=c(491);class SA{constructor(b,k){this.Qf=b;this.Zl=k}create(){return new RB.a(this.Qf.instance,this.Zl.instance)}}Object(n.a)(SA,"ContentControlNodeFactory",null,[298]);var zC=c(1677),Oz=c(383),AC=c(1053);class $y{create(){return new AC.a}}Object(n.a)($y,"ContentControlContainerNodeFactory",null,[298]);var lt=c(184),BC=c(389),SB=c(1108);const TA=b=>b?(b=b.ia(Cc.a.YZa,null))&&b.includes(lt.a.ePh):!1;class Ir{constructor(b,k,t,D,P,ca){this.gFb=b;this.lg=k;this.characterPropertiesEditor=
t;this.Bfa=D;this.Gqa=P;this.pp=ca;this.mTf=(ta,Na)=>{if(hi.a.akb)for(const qb of Na.lOh)TA(qb.contentControlNode)||(ta=qb.contentControlNode.ia(Cc.a.YZa,null),this.Iil(ta))}}get oCf(){return w.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled")}init(){this.Bfa.S7i(this.mTf)}Iil(b){const k=this.gFb.rOc();k&&b&&this.gFb.RPc(k,b)&&(b=new Xd.GraphTransaction(7),b.hu(k),k.wg(),b.dispose())}UHc(){const b=new SB.a;b.setValue(Cc.a.Mim,!0);var k=(k=lb.a.create())?k.toString().replace(RegExp("-",
"g"),"").toUpperCase():null;b.setValue(Cc.a.PPc,k);b.setValue(Cc.a.O3k,this.oCf);k=lb.a.create();b.setValue(Cc.a.Eji,k);return b}kNk(b){const k=b.currentNode.getValue(Cc.a.Eji);b.Hf(new BC.a,1);b.E_();b.currentNode.setValue(Cc.a.LSh,k);b.Hf(this.lg.gfb(),1);b.E_();return this.lg.OI(b)}ulo(b){var k=this.gFb.I$h();k.zb(7);if(k.uc()&&k.hPa(0,D=>8==D.type)&&(k=k.currentNode,k=(new hv.WACStyleSet).LO(k))){var t=k.Fi(lt.a.iZf);t?(b=Of.a.createTextRange(b,0,pe.ParagraphReader.textLength(b)),this.Gqa.XZ(b,
D=>{this.pp.pfa(D);this.pp.A6a(D,t)})):v.ULS.sendTraceTag(509116498,368,50,"No Placeholder Text style.")}}ual(b){var k=this.gFb.I$h();const t=this.UHc();k.Hf(t,29);k.E_();k=this.kNk(k);this.characterPropertiesEditor.replaceTextRange(Of.a.Rc(k,0),b,!1,!1);this.ulo(k);return t}yVo(b,k){var t=this.gFb.t8h(b);t&&(t=Of.a.createTextRange(t,0,pe.ParagraphReader.textLength(t)),this.characterPropertiesEditor.replaceTextRange(t,k,!1,!1),this.iUo(b))}iUo(b){const k=this.gFb.rOc();this.gFb.RPc(k,b)&&k.currentNode.setValue(sf.a.dR,
new Date)}}Object(n.a)(Ir,"GlossaryEditor",null,[506]);class mu{constructor(b,k,t,D,P){this.Bfa=b;this.QHh=k;this.KAb=t;this.AJ=D;this.lj=P;this.M3k=new $y;this.jjn=(ca,ta)=>{this.AJ.ie(()=>{if(ta){ta.Ko.selectedContentControls||(ta.Ko.selectedContentControls={});var Na=ta.Ko.selectedContentControls,qb=ta.OSa;if(qb&&qb.length){var Jb=qb[0];qb=qb[qb.length-1];Jb=this.Bfa.yof(Of.a.Rc(Jb.node,Jb.Aj),Of.a.Rc(qb.node,qb.Ip),!1);for(const Vb of Jb)hi.a.yx&&Vb.contentControlNode.ia(Cc.a.oU,!1)||(Na[Vb.contentControlNode.id.toString()]=
!0)}}},"CC:OnBeforeCopy")};this.ZUf=(ca,ta)=>{this.AJ.ie(()=>{if(ta){var Na=ta.clone,qb=ta.original;try{const Jb=ta.Ko.selectedContentControls,Vb=this.Bfa.Hnf(qb,0,qb.characterData.length,!0,!0,!1);for(const ac of Vb){const yc=ac.le.toString();Jb[yc]?ac.qp&&!this.c6k(ac.contentControlNode,Na,Jb)&&(v.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",yc)),this.P4f(Na,ac.le)):this.P4f(Na,ac.le)}}catch(Jb){v.ULS.sendTraceTag(521171974,307,
10,"onParagraphCopy operation failed: {0}",Jb.toString()),this.QHh.SWn(Na)}}},"CC:onParagraphCopy")};this.$Uf=(ca,ta)=>{this.AJ.ie(()=>{if(ta){var Na=ta.clone,qb=ta.original;try{const Jb=this.Bfa.Hnf(Na,0,qb.characterData.length);ta.Ko.ccObjectIdMapping||(ta.Ko.ccObjectIdMapping={});const Vb=ta.Ko.ccObjectIdMapping;for(let ac=0;ac<Jb.count;ac++){const yc=Jb.J(ac),Kc=yc.le.toString();if(this.VOm(yc))if(yc.Nc){const ed=qb.Bi().od.Db(Kc),sd=this.t6l(yc),oe=this.oYk(ed,sd.$Zi,sd.Oqi,Na.Bi().od);Vb[Kc]=
oe.id;this.KAb.eEj(Vb[Kc],Na.id,X.a.nil);this.lj.gdc(oe)}else this.KAb.eEj(Vb[Kc],null,Na.id);Vb[Kc]?(yc.le=Vb[Kc],yc.Yu=null):this.P4f(Na,yc.le)}}catch(Jb){v.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",Jb.toString())}}},"CC:onParagraphPaste")}}init(){Av.a.tvk(this.jjn);Av.a.d_e(this.ZUf);Av.a.Azd(this.$Uf)}DOl(b){if(!b.zb(25)||!b.hd(25))return null;if(!b.Nr(25)){const k=this.M3k.create(1074135144);b.Hf(k,25)}return b.Rb(25)}c6k(b,k,t){var D=b.ia(Cc.a.B7,null);const P=
ze.GraphIterator.$a(k);k=k.Bi().od;t=D&&t[D.toString()]?k.Db(D):this.DOl(P);if(!t)return v.ULS.sendTraceTag(521172765,368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;D=Pl.a(b,k,!0);ze.GraphIterator.$a(t).X2(D,26,b.id);54!==t.type&&D.setValue(Cc.a.B7,t.id);hi.a.yx&&Oz.a.FAf(null,D);return D}P4f(b,k){this.QHh.dil(new Eb.a([b]),k)}VOm(b){var k=b.Ib.paragraph.Kc;if(!k)return v.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",
b.le.toString())),!1;k=k.Db(b.Yu);if(!k)return v.ULS.sendTraceTag(520152149,368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.le.toString())),!1;b=k.getValue(Cc.a.Ys);return 38===b||39==b}jNl(b,k){var t,D=b.pa.J(b.pa.length-1);let P=b.characterData.length;D=(null===(t=null===D||void 0===D?void 0:D.Jb)||void 0===t?void 0:t.length)||0;b.id.equals(k.Ib.paragraph.id)&&(P=k.Ib.cp,D=k.Ib.Jb.eJ(k.le,k.Nc));return this.Bfa.Inf(b,0,P,0,D)}t6l(b){let k=null,t=b.Ib.paragraph;
const D={};for(;t;){const P=this.jNl(t,b);for(let ca=P.count-1;0<=ca;ca--){const ta=P.J(ca);if(!ta.qp)continue;const Na=ta.le.toString();if(ta.Nc){if(!D[Na])return{$Zi:ta.contentControlNode,Oqi:k}}else D[Na]=!0,k||(k=ta.contentControlNode)}t=pe.ParagraphReader.ig(t,!0,!0)}return{$Zi:null,Oqi:k}}oYk(b,k,t,D){let P;k?P=this.KAb.yva(k):(P=this.KAb.zva(),k=P.currentNode);D=Pl.a(b,D,!0);D.Zg(Cc.a.Ow,Ne.a.vF());54!==k.type&&D.setValue(Cc.a.B7,k.id);P.HH(D,t,26);hi.a.akb&&!TA(b)&&this.KAb.uYk(b,D);return D}}
Object(n.a)(mu,"ContentControlCCP",null,[]);var ss=c(713);class Pz{constructor(b,k,t,D){this.Kd=b;this.Qf=k;this.eb=t;this.zd=D}get UX(){return!!this.Qf.instance&&this.Qf.instance.UX}get OGb(){return!!this.Qf.instance&&this.Qf.instance.OGb}xta(b,k,t,D,P,ca=lt.a.JBb,ta=lt.a.j4b,Na=null,qb=lt.a.Mcf,Jb=-1){(b=this.JOc(b,t))?(b.Jb||(b.Jb=new RA.a(b)),this.Fqk(k,b.Jb,D,P,ca,ta,Na,qb,Jb)):v.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}MPh(b,k,t){if(b){new Eb.a;
for(let P=0;P<b.count;P++){var D=this.uof(b.J(P),k,!1);for(const ca of D)this.tXn(ca,t)}}}cil(b,k){this.MPh(b,k,!0)}dil(b,k){this.MPh(b,k,!1)}replaceTextRange(b,k,t,D){this.Kd.replaceTextRange(b,k,t===Pb.a.a8c,D)}JOc(b,k){var t=Of.a.Rc(b,k);this.Kd.Q6a(t);for(t=0;t<b.pa.length;t++){const D=b.pa.J(t);if(D.cp>k)break;if(D.cp===k)return D}return null}Fqk(b,k,t,D,P=lt.a.JBb,ca=lt.a.j4b,ta=null,Na=lt.a.Mcf,qb=-1){const Jb=k.Ib.paragraph;b=new ss.a(k.Ib,!0,!0,!0,null,b,D,t,P,ca,ta,Na,null,this.zd);if(!this.UX||
-1>=qb||qb>k.length)qb=k.length;k.insert(b,qb);Jb.Xl();b.re?Jb.ze.PX(b.re-1,512):Jb.ze.Zna(b.re,512);Jb.ze.iq.Z(b.re,gu.CharacterPropertiesEditor.HM);Jb.ze.Vs.Z(b.re,gu.CharacterPropertiesEditor.pR)}uof(b,k,t){const D=new Eb.a;for(let P=0;P<b.pa.length;P++){const ca=b.pa.J(P);if(ca.Jb)for(let ta=0;ta<ca.Jb.length;ta++)if(ca.Jb.J(ta).le.equals(k)&&(D.add(ca.Jb.J(ta)),t))return D}return D}wad(b,k,t){if(this.OGb&&b){var D=b.node,P=b.Aj,ca=b.Ip,ta=this.a6h(D,P,k,!0);k=this.a6h(D,ca,k,!1);t?-1!==ta&&ta++:
-1!==k&&k++;P||-1===ta||(ta=Math.max(ta,this.eb.Cv(D)));ca===this.eb.textLength(D)&&-1!==k&&(k=Math.min(k,this.eb.Zu(D)));b.Eb=ta;b.Sb=k}}a6h(b,k,t,D){return(b=(b=b.pa.Oh(k))?b.Jb:null)&&b.length?b.eJ(t,D):-1}tXn(b,k){b&&b.Ib.Jb&&(k?b.Ib.Jb.remove(b):b.Ib.Jb.Opa(b),k=b.Ib.paragraph,0<=b.re&&b.re<k.ze.length&&(b.Ib.cp||1!==k.ze.length||(k.ze.PX(0,512),k.ze.iq.Z(1,gu.CharacterPropertiesEditor.HM),k.ze.Vs.Z(1,gu.CharacterPropertiesEditor.pR)),k.ze.removeAt(b.re,512)),k.Xl())}SWn(b){const k=b.pa;if(k){var t=
new Eb.a;for(let D=0;D<k.length;D++){const P=k.J(D);if(P&&P.Jb){for(let ca=0;ca<P.Jb.length;ca++)t.add(P.Jb.J(ca).re);P.Jb=null}}b.Npa(t)}}LOo(b,k,t){if(!(0>k||0>t))for(this.Kd.Q6a(Of.a.Rc(b,k)),this.Kd.Q6a(Of.a.Rc(b,t)),k=b.pa.Ega(k),t=b.pa.Ega(t),--t;t>k;t--){const D=b.pa.J(t);D.NCf?b.pa.removeAt(t):D.formatting=null}}}Object(n.a)(Pz,"ContentControlChpManager",null,[519]);class Pu{constructor(b,k,t,D,P){this.eb=b;this.Co=k;this.yh=t;this.ld=D;this.zd=P}tnf(b){if(!b||!hf.SelectionEditor.gf(b))return null;
if(!b.cpBegin){const k=this.e4h(b.node,b.Eb,!0);if(k)return k}return b.cpBegin===this.eb.textLength(b.node)?this.e4h(b.node,b.Eb-1,!1):null}lMl(b,k){b=this.lLh(b,k);return this.tnf(b)}e4h(b,k,t){return b.pa&&b.pa.length?(b=t?b.pa.first.Jb:b.pa.last.Jb)&&0<=k&&k<b.length&&b.J(k).Mf&&b.J(k).Nc===t&&this.YBf(b.J(k))?b.J(k):null:null}Oqf(b){if(!b||!hf.SelectionEditor.hv(b))return null;var k=this.Co.oOd(b,b);b=0<k.count?k.J(k.count-1):null;return b&&!b.Mf&&this.YBf(b)?(k=1<k.count?k.J(k.count-2):null)&&
!k.Mf&&this.YBf(k)?null:b:null}YBf(b){if(!b)return!1;var k=this.Dci(b);if(!k)return!1;if(b.Nc)var t=b;else t=k,k=b;var D=this.eb.textLength(b.Ib.paragraph);if(t.Ib.cp||k.Ib.cp!==D||!t.qp||t.Mwa||!k.qp||k.Mwa)return!1;t=t.Ib.Jb;k=k.Ib.Jb;for(D=0;D<t.length&&!t.J(D).le.equals(b.le);D++)if(!t.J(D).Nc)return!1;for(t=k.length-1;0<=t&&!k.J(t).le.equals(b.le);t--)if(k.J(t).Nc)return!1;return!0}dad(b){b=this.tnf(b);this.IFd(b,!1)}fCj(b,k){b=this.lLh(b,k);this.dad(b)}uIa(b){b=this.Oqf(b);return this.IFd(b,
!0)?b:null}IEm(b,k){b=this.tnf(b);return!!b&&b.le.equals(k)}H$b(b,k,t){b=this.lMl(b,k);return!!b&&b.le.equals(t)}IDf(b,k){b=this.Oqf(b);return!!b&&b.le.equals(k)}IFd(b,k){if(!b)return!1;const t=this.Dci(b);return this.vIh(b,k)&&(!t||this.vIh(t,k))}vIh(b,k){if(!b||b.Mf===k)return!1;var t=this.Co.Ame(b.Ib.paragraph,b.Nc);const D=b.Ib.Jb;-1!==t||b.Nc||(t=D.length);const P=k===b.Nc?1:-1;t+=k?P:0;b=D.eJ(b.le,b.Nc)+P;if(t===b||0<P!==b>t)return v.ULS.shipAssertTag(24933847,368,t!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",
t,b,P),v.ULS.shipAssertTag(24933848,368,0<P===b>t,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",t,b,P),!1;for(var ca=t;ca!==b;ca+=P){var ta=D.J(ca);D.Opa(ta);ta.Mf=k;D.sBm(ta,ca);this.VTo(D.J(ca))}if(this.V_)for(D.Ib.paragraph.Xl(),ca=t;ca!==b;ca+=P)ta=D.J(ca),ta.paragraph.ze.iq.Z(ta.re,gu.CharacterPropertiesEditor.HM),ta.paragraph.ze.Vs.Z(ta.re,gu.CharacterPropertiesEditor.pR);k||this.yWo(D,t,b,P);v.ULS.sendTraceTag(24933849,368,
50,"Converted {0} content control(s) to {1}",Math.abs(b-t),k?"block":"inline");return!0}eRd(b){var k,t;return b.Nc&&(hi.a.xj?this.zd.yq(b.contentControlNode.id,!0):this.zd.Ms.get(null===(k=b.contentControlNode.id)||void 0===k?void 0:k.toString())).equals(b.Ib.paragraph.id)?38:!b.Nc&&(hi.a.xj?this.zd.yq(b.contentControlNode.id,!1):this.zd.kt.get(null===(t=b.contentControlNode.id)||void 0===t?void 0:t.toString())).equals(b.Ib.paragraph.id)?39:b.Mf&&b.Nc?40:b.Mf&&!b.Nc?41:!b.Mf&&b.Nc?38:39}VTo(b){const k=
b.Ib.paragraph.Kc;if(k){var t=k.Db(b.Yu),D=b.contentControlNode;if(t){t=t.clone();t.setValue(Cc.a.rGf,b.Mf);const P=this.eRd(b);t.setValue(Cc.a.Ys,P);k.Ju(t,null);b.Yu=t.id}D&&D.setValue(Cc.a.v8,b.Mf)}}Dci(b){if(b.Ib.cp&&b.Ib.cp!==this.eb.textLength(b.Ib.paragraph)||!b.Ib.paragraph.pa||!b.Ib.paragraph.pa.length)return null;const k=b.Nc?b.Ib.paragraph.pa.last:b.Ib.paragraph.pa.first;if(!k.Jb)return null;b=k.Jb.eJ(b.le,!b.Nc);return-1===b?null:k.Jb.J(b)}yWo(b,k,t,D){var P,ca,ta,Na,qb=b.J(k).contentControlNode;
if(qb){var Jb=b.J(k).Nc,Vb=Jb?this.zd.Ms:this.zd.kt;qb=hi.a.xj?this.zd.yq(qb.id,Jb):null!==(ca=Vb.get(null===(P=qb.id)||void 0===P?void 0:P.toString()))&&void 0!==ca?ca:X.a.nil;if(!qb.equals(X.a.nil))if(b.Ib&&b.Ib.paragraph&&b.Ib.paragraph.id.equals(qb)){for(k+=D;k!==t;k+=D){P=b.J(k).contentControlNode;if(!P)return;hi.a.xj?this.zd.kE(P.id,qb,Jb):Vb.set(null===(ta=P.id)||void 0===ta?void 0:ta.toString(),qb)}0<=t&&t<b.length&&b.J(t).Mf&&this.eGf(b.J(t))&&(b=b.J(t).contentControlNode)&&(hi.a.xj?this.zd.kE(b.id,
qb,Jb):Vb.set(null===(Na=b.id)||void 0===Na?void 0:Na.toString(),qb))}else v.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}eGf(b){return b.qp&&!b.Mwa}lLh(b,k){if(!b||!this.yh)return null;const t=k?Of.a.Rc(b,0):Of.a.fw(b);b=this.yh.Wq(b,k);t.Sb=t.Eb=b;return t}get V_(){return this.ld.isFeatureEnabled(30)}}Object(n.a)(Pu,"ContentControlConverter",null,[518]);var Xv;(function(b){b[b.n6o=0]="BoundingBox";b[b.t9o=
1]="Tags";b[b.u7o=2]="Hidden";b[b.o8o=3]="NumberOfContentControlAppearance"})(Xv||(Xv={}));Object(n.b)("ContentControlAppearance",Xv);var UA=c(1604),TB=c(1474);class UB{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){this.u$a=this.ABa=this.ksc=this.iBc=this.ypd=null;this.Kja=this.Ak=this.xyc=this._id=0;this.XTb=this.krd=this.Nvd=this._title=this.Tza=null;this.qmd=this.pmd=this.d2g=this.ssd=this.Quc=this.Muc=this.qhd=!1;this.v3g=null;this.Mf=!1;this.Sfd=null;this.ni=t;this.qx=k;this.Qg=D;this.jr=P;this.Zl=
ca;this.R1=ta;this.y$=Na;this.Pea=qb;this.Byb=Jb;this.zd=Vb;b?(this.ypd=b.id,this.Sfd=b,this.KT(!1)):this._id=Ne.a.vF()}get uj(){return this.ni.value}get id(){this.KT();return this._id}set id(b){this._id=b;this.isValid()&&(this.contentControlNode.setValue(Cc.a.Ow,this._id),this.QY())}get parentId(){this.KT();return this.xyc}set parentId(b){this.xyc=b}get title(){this.KT();return this._title}set title(b){this._title=b;this.isValid()&&(this.contentControlNode.setValue(Cc.a.Peb,this._title),this.QY(),
this.yad(k=>{k.title=this._title?this._title:lt.a.JBb}))}get tag(){this.KT();return this.Nvd}set tag(b){this.Nvd=b;this.isValid()&&(this.contentControlNode.setValue(Cc.a.Seb,this.Nvd),this.QY())}get type(){this.KT();return this.Ak}set type(b){this.Ak=b;this.isValid()&&(this.contentControlNode.setValue(Cc.a.NAb,UA.a[this.Ak]),this.QY())}get appearance(){this.KT();return this.Kja}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.Kja=b;
this.isValid()&&(this.contentControlNode.setValue(Cc.a.Qeb,Xv[this.Kja].toLowerCase()),this.QY(),this.yad(k=>{k.appearance=Xv[this.Kja].toLowerCase()}))}get color(){this.KT();return this.Tza}set color(b){if(b&&16777215>=b)this.Tza=b,this.isValid()&&(this.contentControlNode.setValue(Cc.a.gHc,this.Tza),this.QY(),this.yad(k=>{k.color=this.Tza}));else throw Error.argumentOutOfRange("The color value is out of range.");}get placeholderText(){this.KT();return this.krd}set placeholderText(b){this.krd=b=TB.a.tHc(b);
hi.a.akb&&(this.Qg.MEj(b,this.Sfd),this.QY(),this.DM&&this.Zl.Hbg(this,b,!0))}get XId(){this.KT();return this.XTb}set XId(b){this.XTb=b;this.isValid()&&(this.contentControlNode.setValue(Cc.a.b3b,this.XTb),this.QY())}get uff(){this.KT();return this.qhd}set uff(b){b&&(this.qhd=b,this.isValid()&&(this.contentControlNode.setValue(Cc.a.tFd,this.qhd),this.QY()))}get removeWhenEdited(){this.KT();return this.ssd}set removeWhenEdited(b){if(b&&!this.aha)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");
this.ssd=b;this.isValid()&&(this.contentControlNode.setValue(Cc.a.THh,this.ssd),this.QY())}get aha(){this.KT();return this.Muc}set aha(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");this.Muc=b;this.isValid()&&(this.contentControlNode.setValue(Cc.a.d3b,this.Muc),this.yad(k=>{k.IK=this.Muc}),this.QY())}get isEditable(){this.KT();return this.Quc}set isEditable(b){this.Quc=b;this.isValid()&&
(this.contentControlNode.setValue(Cc.a.LAb,this.Quc),this.yad(k=>{k.editable=this.Quc}),this.QY())}get isSupported(){this.KT();return this.d2g}get $Om(){return this.isSupported&&11!==this.type&&10!==this.type}get YBi(){this.KT();return this.XTb&&"table of contents"===this.XTb.toLowerCase()?!0:!1}get vZd(){this.KT();return this.pmd}set vZd(b){this.pmd=b;this.isValid()&&(this.contentControlNode.setValue(Cc.a.WHh,this.pmd),this.QY())}get Sac(){this.KT();return this.qmd}set Sac(b){this.qmd=b;this.isValid()&&
(this.contentControlNode.setValue(Cc.a.XHh,this.qmd),this.QY())}get DM(){return this.contentControlNode.ia(Cc.a.C7,!1)}set DM(b){this.isValid()&&this.contentControlNode.setValue(Cc.a.C7,b)}get iu(){this.KT();return this.iBc}set iu(b){this.iBc=b}get iz(){this.KT();return this.ksc}set iz(b){this.ksc=b}get objectId(){return this.ypd}set objectId(b){this.ypd=b;this.Sfd=this.uj.Db(this.ypd)}get start(){this.DGj();return this.ABa}set start(b){this.ABa=b}get end(){this.DGj();return this.u$a}set end(b){this.u$a=
b}get contentControlNode(){return this.Sfd}Ayn(b){for(let k=0;3>k;++k)if(Xv[k].toLowerCase()===b)return k;return 0}Byn(b){for(let k=0;12>k;++k)if(UA.a[k]===b)return k;return-1}QY(){const b=this.start.node;b&&b.setValue(sf.a.dR,new Date)}Lad(){var b,k,t,D;this._id=this.contentControlNode.ia(Cc.a.Ow,0);this.Kja=this.Ayn(this.contentControlNode.ia(Cc.a.Qeb,null));this.Tza=this.contentControlNode.ia(Cc.a.gHc,null);this._title=this.contentControlNode.ia(Cc.a.Peb,null);this.Nvd=this.contentControlNode.ia(Cc.a.Seb,
null);this.Mf=this.contentControlNode.ia(Cc.a.v8,!1);this.Muc=this.contentControlNode.ia(Cc.a.d3b,!1);this.Quc=this.contentControlNode.ia(Cc.a.LAb,!1);this.d2g=this.contentControlNode.ia(Cc.a.Afa,!1);this.XTb=this.contentControlNode.ia(Cc.a.b3b,null);this.qhd=this.contentControlNode.ia(Cc.a.tFd,!1);hi.a.xj?(this.iBc=this.zd.yq(this.contentControlNode.id,!0),this.ksc=this.zd.yq(this.contentControlNode.id,!1)):(this.iBc=null!==(k=this.zd.Ms.get(null===(b=this.contentControlNode.id)||void 0===b?void 0:
b.toString()))&&void 0!==k?k:X.a.nil,this.ksc=null!==(D=this.zd.kt.get(null===(t=this.contentControlNode.id)||void 0===t?void 0:t.toString()))&&void 0!==D?D:X.a.nil);this.qmd=this.contentControlNode.ia(Cc.a.XHh,!1);this.pmd=this.contentControlNode.ia(Cc.a.WHh,!1);this.ssd=this.contentControlNode.ia(Cc.a.THh,!1);this.Ak=this.Byn(this.contentControlNode.ia(Cc.a.NAb,"RichText"));b=null;try{const P=this.contentControlNode.ia(Cc.a.B7,X.a.nil);if(X.a.Zp(P,X.a.nil))this.xyc=0;else if(b=this.uj.Db(P))this.xyc=
b.ia(Cc.a.Ow,0)}catch(P){this.xyc=0}this.xVo()}xVo(){if(this.Byb){var b=this.contentControlNode.ia(Cc.a.YZa,"");if((b=this.y$.Oii(b))&&0<b.length){this.krd=this.n3h(b.Qa,b.Qc);return}}this.krd=(b=this.Qg.zva())&&b.currentNode?b.currentNode.ia(Cc.a.hHc,null):null}KT(b=!0){if(!b||this.isValid())b=this.contentControlNode.ia(sf.a.lastModifiedTime,new Date(0)),this.v3g!==b?(v.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),this.Lad(),this.v3g=b):v.ULS.sendTraceTag(520734534,
368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}xWo(b,k){var t,D;this.iBc=b;this.ksc=k;hi.a.xj?this.zd.kE(this.contentControlNode.id,b,!0):this.zd.Ms.set(null===(t=this.contentControlNode.id)||void 0===t?void 0:t.toString(),b);hi.a.xj?this.zd.kE(this.contentControlNode.id,k,!1):this.zd.kt.set(null===(D=this.contentControlNode.id)||void 0===D?void 0:D.toString(),k)}DGj(){if(this.contentControlNode){var b=this.iu,k=this.iz;if(!b||!k||b.equals(X.a.nil)||
k.equals(X.a.nil))v.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");else if(b=this.Qg.hna(b,!0),k=this.Qg.hna(k,!1),b&&k)if(b.isConnected&&k.isConnected||v.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.Mf)b=Of.a.create(b),this.jr.wad(b,this.objectId,!0),this.start=b,b=Of.a.create(k),this.jr.wad(b,this.objectId,!0),this.end=b;else{let t=k=-1;if(b.pa){for(let D=0;D<b.pa.length&&(-1===
k||-1===t);D++){const P=b.pa.J(D);if(P.Jb)for(let ca=0;ca<P.Jb.length&&(-1===k||-1===t);ca++){const ta=P.Jb.J(ca);X.a.Zp(ta.le,this.objectId)&&(ta.Nc?k=P.cp:t=P.cp)}}0<=k&&0<=t&&(b=Of.a.jO(k,t,!1,b),this.jr.wad(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var k=this.start;const t=this.end;if(!k||!t)return b;this.Mf?b=this.n3h(k,t):(k=pe.ParagraphReader.text(k.node).substring(k.cpBegin,t.cpEnd),b+=Un.AParagraphNode.OU(k));return b}isValid(){return!!this.contentControlNode&&this.contentControlNode.isConnected}bhe(b){return this.Pea?
this.Zl.Hbg(this,b)?0:2:2}clear(){return this.Pea?this.Zl.Hbg(this,"")?0:2:2}g5h(){const b=new Eb.a;var k=this.contentControlNode.ia(Cc.a.contentControlNode,[]);for(const t of k)if(!X.a.Zp(t,X.a.nil)){k=this.ni.value.Db(t);try{b.add(this.R1.ZAb(k,this.qx,this.ni,this.Qg,this.jr,this.Zl,this.y$,this.Pea,this.Byb))}catch(D){}}return b}Pmf(){const b=new Eb.a;this.e3h(this,b);return b}e3h(b,k){b=b.g5h();if(b.count)for(const t of b)k.add(t),this.e3h(t,k)}dF(b=!1){const k=new Eb.a;if(this.Mf){var t=this.Zl.UT(this.start,
this.end);for(var D of t)t=Of.a.create(D),this.jr.wad(t,this.objectId,b),k.add(t)}else D=this.start.clone(),this.jr.wad(D,this.objectId,b),k.add(D);return k}yad(b){const k=this.Zl.UT(this.start,this.end);for(let t=0;t<k.count;t++){const D=this.jr.uof(k.J(t),this.objectId,!1);if(D){for(let P=0;P<D.count;P++)b(D.J(P));k.J(t).ak()}}}n3h(b,k){const t=new Sys.StringBuilder;k=this.Zl.UT(b,k);for(const D of k)D.id.equals(b.node.id)||t.append("\r"),t.append(pe.ParagraphReader.plainText(D));return t.toString()}}
Object(n.a)(UB,"ContentControl",null,[536]);class VA{constructor(b){this.zd=b}ZAb(b,k,t,D,P,ca,ta,Na,qb){return new UB(b,k,t,D,P,ca,this,ta,Na,qb,this.zd)}}Object(n.a)(VA,"ContentControlFactory",null,[517]);class It{constructor(b,k,t,D,P){this.ni=b;this.jr=k;this.elk=t;this.pW=D;this.Ma=P}aSo(b,k,t){var D,P;if(!(hi.a.y9e&&b&&k&&t))return!1;const ca=b.contentControlNode;if(!ca)return!1;var ta=ca.ia(Cc.a.MAb,X.a.nil);ta&&!ta.equals(X.a.nil)?b=this.ni.value.Db(ta):(b=this.jr.JOc(b.start.node,0<=b.start.cpBegin?
b.start.cpBegin:0),b=null===(D=null===b||void 0===b?void 0:b.formatting)||void 0===D?void 0:D.wn,b||(b=new px.a,this.ni.value.Ju(b,null)),ca.setValue(Cc.a.MAb,b.id));D=this.ni.value.Db(b.id);ta="boolean"===typeof t&&t;const Na=null===(P=this.Ma)||void 0===P?void 0:P.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);k=this.elk.cqf(ca,D,k,t,Na?null:ta);k=this.pW.loe(k);for(const [qb,Jb]of k)b.setValue(qb,Jb);return!0}}Object(n.a)(It,"ContentControlFormattingManager",null,
[514]);var Bx=c(925);class f{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc){this.qx=b;this.ni=k;this.Wc=t;this.Vvb=D;this.lZj=P;this.lK=ca;this.nh=ta;this.eb=Na;this.Iqd=qb;this.pjd=Jb;this.zd=Vb;this.NWg=ac;this.y$=yc}get Ms(){return this.zd.Ms}get kt(){return this.zd.kt}get ax(){return this.qx.value}zva(){const b=this.Wc.xk();b.set(this.ax);this.Vvb.eP(b);if(b.Rb(25))return b;this.pjd.instance&&this.pjd.instance.joa&&v.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");
v.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}cOc(b,k,t=!1){this.x5b();const D=new Eb.a;let P;if(b){P=b.Rb(26);if(!P)return D;for(;P&&(!k(P)||(D.add(P),!t));){D.addRange(this.cOc(b,k));if(t&&0<D.count)break;P=b.vf(26)}b.uc()}return D}Y4l(){const b=this.Wc.xk();b.set(this.qx.value);this.Vvb.eP(b);return b.currentNode}mQa(b,k,t){let D;D=b.equals(k);D||(D=(b=this.hna(b,t))?b.id.equals(k):!1);return D}EOa(b,k){var t,D,P,ca;b=this.Ut(b);if(!b)return null;
let ta=null;for(;55===b.type;){let Na;Na=hi.a.xj?this.zd.yq(b.id,k):k?null!==(D=this.zd.Ms.get(null===(t=b.id)||void 0===t?void 0:t.toString()))&&void 0!==D?D:X.a.nil:null!==(ca=this.zd.kt.get(null===(P=b.id)||void 0===P?void 0:P.toString()))&&void 0!==ca?ca:X.a.nil;if(Na.equals(ta)){b=null;break}else b=this.Ut(Na);ta=Na}return b}hna(b,k){return(b=this.EOa(b,k))?pe.ParagraphReader.Wb(b)?b:k?this.eb.xl(b):this.eb.PD(b):null}KPh(b,k=!1){this.gRo(b);this.LPh(b,k)}gRo(b){var k,t,D,P,ca,ta,Na,qb,Jb=this.yva(b);
Jb=this.yva(Jb.parentNode);Jb=55===Jb.currentNode.type?Jb.currentNode.id:null;let Vb;Vb=this.Ut(hi.a.xj?this.zd.yq(b.id,!0):null!==(t=this.zd.Ms.get(null===(k=b.id)||void 0===k?void 0:k.toString()))&&void 0!==t?t:X.a.nil);for(k=this.Ut(hi.a.xj?this.zd.yq(b.id,!1):null!==(P=this.zd.kt.get(null===(D=b.id)||void 0===D?void 0:D.toString()))&&void 0!==P?P:X.a.nil);Vb&&55===Vb.type;)Vb=this.Ut(hi.a.xj?this.zd.yq(Vb.id,!0):null!==(ta=this.zd.Ms.get(null===(ca=Vb.id)||void 0===ca?void 0:ca.toString()))&&
void 0!==ta?ta:X.a.nil);for(;k&&55===k.type;)k=this.Ut(hi.a.xj?this.zd.yq(k.id,!1):null!==(qb=this.zd.kt.get(null===(Na=k.id)||void 0===Na?void 0:Na.toString()))&&void 0!==qb?qb:X.a.nil);Vb&&k&&this.dEj(Vb.id,k.id,Jb,ac=>{ac=ac.ia(Cc.a.bX,X.a.nil);return!ac||ac.equals(X.a.nil)||b.id.equals(ac)})}LPh(b,k=!1){var t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc;v.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");const ed=this.yva(b),sd=this.yva(ed.parentNode);let oe=X.a.nil,Ld=X.a.nil;
var Od=sd.currentNode.ia(Cc.a.contentControlNode,[]);const ie=new Eb.a;for(let hg=0;hg<Od.length;hg++)ie.add(Od[hg]);if(k){if(54!==sd.currentNode.type){oe=hi.a.xj?this.zd.yq(sd.currentNode.id,!0):this.zd.Ms.get(null===(t=sd.currentNode.id)||void 0===t?void 0:t.toString());Ld=hi.a.xj?this.zd.yq(sd.currentNode.id,!1):this.zd.kt.get(null===(D=sd.currentNode.id)||void 0===D?void 0:D.toString());Od=this.Ut(oe);for(t=this.Ut(Ld);Od&&55===Od.type;)oe=hi.a.xj?this.zd.yq(Od.id,!0):this.zd.Ms.get(null===(P=
Od.id)||void 0===P?void 0:P.toString()),Od=this.Ut(oe);for(;t&&55===t.type;)Ld=hi.a.xj?this.zd.yq(t.id,!1):this.zd.kt.get(null===(ca=t.id)||void 0===ca?void 0:ca.toString()),t=this.Ut(Ld)}P=this.yva(b);if(P.Rb(26)){ca=new Eb.a;for(ca.add(P.currentNode);P.vf(26);)ca.add(P.currentNode);for(var Ce of ca)this.LPh(Ce,k)}}else if(oe=hi.a.xj?this.zd.yq(b.id,!0):this.zd.Ms.get(null===(ta=b.id)||void 0===ta?void 0:ta.toString()),Ld=hi.a.xj?this.zd.yq(b.id,!1):this.zd.kt.get(null===(Na=b.id)||void 0===Na?void 0:
Na.toString()),k=this.OYl(ie,b.id),Ce=this.yva(b),Ce.Rb(26))for(P=this.yva(Ce.currentNode),ca=P.currentNode,Od=b;ca;)t=Ce.currentNode,ie.insert(k++,t.id),ca=P.vf(26),D=this.yva(t),54!==sd.currentNode.type?t.setValue(Cc.a.B7,sd.currentNode.id):t.removeProperty(Cc.a.B7),Pl.g(D,sd,Od,26),Od=D.currentNode,ca&&(Ce.set(ca),Ce.m1(this.zva().currentNode));54!==sd.currentNode.type&&(k=hi.a.xj?this.zd.yq(sd.currentNode.id,!0):null!==(Jb=this.zd.Ms.get(null===(qb=sd.currentNode.id)||void 0===qb?void 0:qb.toString()))&&
void 0!==Jb?Jb:X.a.nil,qb=hi.a.xj?this.zd.yq(sd.currentNode.id,!1):null!==(ac=this.zd.kt.get(null===(Vb=sd.currentNode.id)||void 0===Vb?void 0:Vb.toString()))&&void 0!==ac?ac:X.a.nil,k.equals(b.id)&&(hi.a.xj?this.zd.kE(sd.currentNode.id,oe,!0):this.zd.Ms.set(null===(yc=sd.currentNode.id)||void 0===yc?void 0:yc.toString(),oe)),qb.equals(b.id)&&(hi.a.xj?this.zd.kE(sd.currentNode.id,Ld,!1):this.zd.kt.set(null===(Kc=sd.currentNode.id)||void 0===Kc?void 0:Kc.toString(),Ld)));ed.wg();v.ULS.sendTraceTag(528537621,
368,50,"Disconnected nodeToDelete");this.remove(ie,b.id);Od=Array(ie.count);for(Vb=0;Vb<ie.count;Vb++)Od[Vb]=ie.J(Vb);sd.currentNode.setValue(Cc.a.contentControlNode,Od);Bx.a.SFa(b.id)}Eqk(b,k,t,D,P,ca,ta=null){var Na,qb,Jb,Vb,ac,yc,Kc,ed;let sd,oe;k?(sd=this.Ut(k.objectId),oe=this.yva(sd)):(oe=this.zva(),sd=oe.currentNode);const Ld=this.lZj.create(1074135145);ta&&Ld.properties.Qw(ta.properties);54!==sd.type&&Ld.setValue(Cc.a.B7,sd.id);ta?oe.nGb(Ld,t,26,ta.id):oe.HH(Ld,t,26);hi.a.contentControlAroundTableFix?
(this.EGj(b,Ld.id,P,!0),this.EGj(b,Ld.id,ca,!1)):(hi.a.xj?this.zd.kE(Ld.id,P,!0):this.zd.Ms.set(null===(Na=Ld.id)||void 0===Na?void 0:Na.toString(),P),hi.a.xj?this.zd.kE(Ld.id,ca,!1):this.zd.kt.set(null===(qb=Ld.id)||void 0===qb?void 0:qb.toString(),ca));b.Mf&&(k&&(t=hi.a.xj?this.zd.yq(sd.id,!0):null!==(Vb=this.zd.Ms.get(null===(Jb=sd.id)||void 0===Jb?void 0:Jb.toString()))&&void 0!==Vb?Vb:X.a.nil,Jb=hi.a.xj?this.zd.yq(sd.id,!1):null!==(yc=this.zd.kt.get(null===(ac=sd.id)||void 0===ac?void 0:ac.toString()))&&
void 0!==yc?yc:X.a.nil,t.equals(P)&&(hi.a.xj?this.zd.kE(sd.id,Ld.id,!0):this.zd.Ms.set(null===(Kc=sd.id)||void 0===Kc?void 0:Kc.toString(),Ld.id)),Jb.equals(ca)&&(hi.a.xj?this.zd.kE(sd.id,Ld.id,!1):this.zd.kt.set(null===(ed=sd.id)||void 0===ed?void 0:ed.toString(),Ld.id))),this.dEj(P,ca,Ld.id,Od=>{Od=Od.ia(Cc.a.bX,X.a.nil);const ie=k?k.objectId:null;return!Od||Od.equals(X.a.nil)||Od.equals(ie)}));P=this.yva(Ld);ca=Array(D.count);for(ac=D.count-1;0<=ac;ac--)ca[ac]=D.J(ac).objectId,yc=this.Ut(D.J(ac).objectId),
yc=this.yva(yc),yc.currentNode.setValue(Cc.a.B7,Ld.id),Pl.g(yc,P,null,26);0<ca.length&&Ld.setValue(Cc.a.contentControlNode,ca);f.Xb.isFeatureEnabled(37)&&(b.XId&&Ld.setValue(Cc.a.b3b,b.XId),b.uff&&Ld.setValue(Cc.a.tFd,!0));return Ld}EGj(b,k,t,D){12===this.Ut(t).type?this.zd.kE(k,t,D):(this.zd.Rmg(k,t,D),this.zd.kE(k,D?b.start.node.id:b.end.node.id,D))}nfo(b,k,t,D,P){b.setValue(Cc.a.v8,k);b.setValue(Cc.a.d3b,!0);b.setValue(Cc.a.LAb,!0);b.setValue(Cc.a.Ow,t);b.setValue(Cc.a.Qeb,Xv[0]);b.setValue(Cc.a.Afa,
!0);b.setValue(Cc.a.NAb,UA.a[P]);D&&b.setValue(Cc.a.Lpb,D);b.setValue(Cc.a.e3b,0)}eEj(b,k=null,t=null){k&&(hi.a.xj?this.zd.kE(b,k,!0):this.zd.Ms.set(b.toString(),k));t&&(hi.a.xj?this.zd.kE(b,t,!1):this.zd.kt.set(b.toString(),t))}ZPh(b){if(!b||!b.count||!b.J(0))return null;const k=this.Usf(b);for(let t=0;t<b.count;t++)this.nh.ZGa(b.J(t));return k}Usf(b){if(!b||!b.J(0))return null;const k=this.Wc.xk();k.set(b.J(0));k.yd();k.uc();return k.hJ()?k.currentNode:null}g6l(b){const k=this.Wc.xk();k.set(b);
k.yd();k.uc();k.uc();return k}loh(b,k,t){const D=new Eb.a;for(let P=0;P<t;P++){k=this.lK.Uib(b,k,!0,null);if(!k||!b.Qd())return null;const ca=b.currentNode;b.uc();b.uc();D.add(ca)}return D}J8b(b){const k=this.Wc.xk();k.set(b);for(k.zb(7);k.uc();)switch(k.currentNode.type){case 8:case 16:case 36:case 40:return k.currentNode.id}return null}qci(b){const k=this.Wc.xk();k.set(b);k.yd();return(b=k.GSa())?b.id:null}Uqf(b){const k=this.Wc.xk();k.set(b);return k.zb(7)?k:null}Ut(b){return this.ni.value.Db(b)}x5b(){if(!f.E_g){var b=
this.zva();b&&this.jkg(b);f.E_g=!0}}qTa(b){return this.Iqd.qTa(b)}Vyk(b,k){const t=this.Wc.xk();t.set(b.node);const D=this.Wc.xk();D.set(k.node);t.yd();D.yd();const P=this.Wc.xk();P.set(t.currentNode);const ca=this.Wc.xk();ca.set(D.currentNode);const ta=mh.returnToLowestCommonTableCell(t,D);return ta?(P.yd(),ca.yd(),{returnValue:({ll:b}=this.nAb(P,!0,ta,b)).returnValue&&({ll:k}=this.nAb(ca,!1,ta,k)).returnValue,V8c:b,uKc:k}):{returnValue:({ll:b}=this.nAb(t,!0,null,b)).returnValue&&({ll:k}=this.nAb(D,
!1,null,k)).returnValue,V8c:b,uKc:k}}nAb(b,k,t,D){let P=null,ca=b.hd(16);for(;ca!==t;){if(k&&yh.TableCellReader.swi(b)||!k&&yh.TableCellReader.$Df(b))P=b.hd(14);else return{returnValue:!1,ll:D};ca=b.hd(16)}P&&(D=Of.a.create(P));return{returnValue:!0,ll:D}}jkg(b){if(b.Rb(26)){for(this.jkg(b);b.vf(26);)this.jkg(b);b.uc()}}remove(b,k){for(let t=0;t<b.count;t++)if(b.J(t).toString()===k.toString()){b.removeAt(t);break}}yva(b){const k=this.Wc.xk();k.set(b);k.m1(this.zva().currentNode);return k}OYl(b,k){for(let t=
0;t<b.count;t++)if(b.J(t).equals(k))return t;return-1}dEj(b,k,t,D){b=this.PPl(b,k);for(k=0;k<b.count;k++)D(b.J(k))&&(t?b.J(k).setValue(Cc.a.bX,t):b.J(k).removeProperty(Cc.a.bX),this.pjd.instance&&this.pjd.instance.Eui&&b.J(k).Tk(16,!0))}PPl(b,k){const t=new Eb.a;var D=this.Ut(b);const P=this.Ut(k);if(!D||!P)return t;const ca=({dXc:ta}=this.BNd(D,P)).returnValue;D=ta[ca];if(14===D.type)t.add(D);else if(15===D.type&&1<=ca){const Na=ta[ca-1];1===Ih.TableReader.eg(Na)&&t.add(Na)}var ta=ze.GraphIterator.$a(ca>=
ta.length-1?D:ta[ca+1]);ta.zb(7);for(D=wc.a.mt(ta,D);D.moveNext()&&D.currentNode!==P;)14===D.currentNode.type&&t.add(D.currentNode);if(!X.a.Zp(k,b)&&14===P.type)for(ta=ze.GraphIterator.$a(P),D=wc.a.mt(ta,P);D.moveNext();)14===D.currentNode.type&&t.add(D.currentNode);return t}BNd(b,k){b=this.Ygb(b);k=this.Ygb(k);let t=0;for(;t<b.length&&t<k.length&&b[t]===k[t];++t);return{returnValue:0<t?t-1:t,dXc:b,o8f:k}}Ygb(b){const k=[];k.push(b);b=ze.GraphIterator.$a(b);for(b.zb(7);b.uc();)k.push(b.currentNode);
k.reverse();return k}static get Xb(){return null!=f.vyg?f.vyg:f.vyg=Fa.a.instance.Na("Box4.IFeatureHelper")}UHc(b,k,t=!1){b=this.NWg.instance.ual(b);t?(t=lt.a.Ogl,b.setValue(Cc.a.PPc,t)):t=b.ia(Cc.a.PPc,null);k.setValue(Cc.a.YZa,t)}uYk(b,k){b=b.ia(Cc.a.YZa,null);b=this.y$.t8h(b);b=pe.ParagraphReader.text(b);this.UHc(b,k)}MEj(b,k){if(k){var t=k.ia(Cc.a.YZa,null);t?TA(k)?this.UHc(b,k):this.NWg.instance.yVo(t,b):(t=this.y$.iSl())?k.setValue(Cc.a.YZa,t):this.UHc(b,k,!0)}}}f.E_g=!1;Object(n.a)(f,"ContentControlGraphManager",
null,[510]);class x{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb){this.Tve=Jb;this.nra=null;this.jNm=(Vb,ac)=>{if(this.UX)return this.kNm(Vb,ac);if(!Vb||!Vb.count)return v.ULS.sendTraceTag(17356048,368,15,"The GNC list should not be null or empty"),!1;let yc=!0;switch(ac){case 0:ac=this.SK(Vb.J(0),Vb.J(Vb.count-1),1);if((Vb=this.SK(Vb.J(0),Vb.J(Vb.count-1),3))&&0<Vb.count){if(!Vb.J(0).isSupported||!Vb.J(0).isEditable){yc=!1;break}for(Vb=Vb.J(0);Vb;)this.O3c(ac,Vb.id),Vb=this.getById(Vb.parentId)}if(ac)for(var Kc of ac)if(!Kc.isSupported||
!Kc.isEditable){yc=!1;break}break;case 1:if(Vb.J(0).contextId!==lc.a.Tc){v.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");yc=!1;break}(ac=this.SK(Vb.J(0),Vb.J(0),1))&&0<ac.count&&(yc=!1);break;case 2:if(Vb.J(0).contextId!==lc.a.Tc){v.ULS.sendTraceTag(17424994,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");yc=!1;break}(ac=this.SK(Vb.J(0),Vb.J(0),3))&&0<ac.count&&
(yc=!1);break;case 3:case 4:ac=this.QPd(Vb.J(0),!0);Kc=this.QPd(Vb.J(Vb.count-1),!1);if(!ac||!Kc){v.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");yc=!1;break}if((ac=this.SK(ac,ac,3))&&0<ac.count){yc=!1;break}if((ac=this.SK(Kc,Kc,3))&&0<ac.count){yc=!1;break}if(ac=this.Zl.SK(Vb.J(0),Vb.J(Vb.count-1),1))for(const ed of ac)if(!ed.aha){yc=!1;break}break;default:yc=!1}return yc};x.qx=b;x.ni=k;this.Qg=t;this.jr=D;this.Zl=P;this.R1=
ca;this.y$=ta;this.Qf=Na;this.Co=qb}get UPa(){return!!this.Qf.instance&&this.Qf.instance.UPa}get joa(){return!!this.Qf.instance&&this.Qf.instance.joa}get OXd(){return!!this.Qf.instance&&this.Qf.instance.OXd}get UX(){return!!this.Qf.instance&&this.Qf.instance.UX}get RXd(){return!!this.Qf.instance&&this.Qf.instance.RXd}OGb(){return!!this.Qf.instance&&this.Qf.instance.OGb}Ela(b,k,t=null,D=null,P=!1){if(!this.UPa)return{returnValue:2,id:0};b=this.Qg.hna(b,!0);k=this.Qg.hna(k,!1);if(!b||!k)return{returnValue:2,
id:0};b=Of.a.create(b);k=Of.a.create(k);return this.Zmh(b,k,t,D,P,0,!1)}Kpk(b,k,t=0,D=!1){return this.UPa&&b&&k?this.Zmh(b,k,null,null,!1,t,D):{returnValue:2,id:0}}QYa(b,k=null,t=0,D=!1){let P=0;if(!this.UPa)return{returnValue:2,id:P};const ca=this.R1.ZAb(k,x.qx,x.ni,this.Qg,this.jr,this.Zl,this.y$,this.UPa,this.OXd);ca.type=t;ca.start=b;ca.end=b;ca.iu=b.node.id;ca.iz=b.node.id;ca.Mf=!1;return this.Zl.Znh(ca,k,D)?(P=ca.id,{returnValue:0,id:P}):{returnValue:2,id:P}}Dqk(b,k=null){if(!this.UPa||!this.BJm(b))return{returnValue:2,
id:0};var t=b.J(0).contextId===lc.a.endOfParagraph?b.J(1):b.J(0);const D=b.J(b.count-1);if(this.f9e(b,lc.a.paragraph)||this.f9e(b,lc.a.endOfParagraph)){b=t.node.id;let P=D.node.id;const ca=b.equals(P);t=this.Zl.ytj(t,!0);void 0!==t&&null!==t&&(b=t,P=ca?b:P);this.Zl.ytj(D,!1);k.setValue(Cc.a.v8,!0);return this.Ela(b,P,k)}return t!==D||t.contextId!==lc.a.Hd&&t.contextId!==lc.a.Tc?{returnValue:2,id:0}:(k.setValue(Cc.a.v8,!1),this.QYa(t,k))}getById(b){if(!this.joa)return null;const k=this.Qg.cOc(this.Qg.zva(),
t=>t.getValue(Cc.a.Ow)===b,!0);return 0<k.count?this.Zl.JQ(k.J(0)):null}getByTitle(b){if(!this.joa)return null;const k=this.Qg.cOc(this.Qg.zva(),D=>D.ia(Cc.a.Peb,null)===b,!1),t=new Eb.a;for(const D of k)t.add(this.Zl.JQ(D));return t}getByTag(b){if(!this.joa)return null;const k=this.Qg.cOc(this.Qg.zva(),D=>D.ia(Cc.a.Seb,null)===b,!1),t=new Eb.a;for(const D of k)t.add(this.Zl.JQ(D));return t}SK(b,k,t,D=!1){return this.joa?this.UX?this.Zl.jna(b,k,t):this.Zl.SK(b,k,t,D):null}UT(b,k){return this.Zl.UT(b,
k)}jKl(){if(!this.joa)return null;const b=this.Qg.cOc(this.Qg.zva(),()=>!0,!1),k=new Eb.a;for(const t of b)k.add(this.Zl.JQ(t));return k}AMb(b){if(!this.UPa)return v.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),2;b=this.getById(b);return this.Zl.dya(b)?0:2}Thl(b){if(!this.UPa)return 2;b=this.getById(b);return this.Zl.deleteContentControl(b)?0:2}Uqk(b){this.Zl.S7i(b)}RIk(b){this.nra=b;this.nra.OUn(this.jNm)}cQl(b){if(!this.OGb())return null;
let k;var t=b.dF();k=this.QPd(t.J(t.count-1),!1);t=this.jr.JOc(t.J(t.count-1).node,k.cpBegin).Jb;b=this.Fdm(t,b);if(-1===b)return null;k.Eb=b;k.Sb=k.Eb;return k}kNm(b,k){if(!b||!b.count)return v.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),!1;switch(k){case 0:return this.SHm(b);case 3:case 4:case 6:return this.kPm(b,6===k);case 1:case 2:case 5:return 1!==b.count||b.J(0).contextId!==lc.a.Tc?(v.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),
!1):this.oxi(b.J(0),5===k,!1);default:return!1}}SHm(b){const k=this.Zl.jna(b.J(0),b.J(b.count-1),3);if(k&&0<k.count){var t=k.J(0);if(!t.isSupported||!t.isEditable)return!1}b=this.Zl.jna(b.J(0),b.J(b.count-1),1);for(t=0;k&&t<k.count;t++)this.O3c(b,k.J(t).id);if(b)for(const D of b)if(!D.isSupported||!D.isEditable)return!1;return!0}kPm(b,k){var t=b.J(0),D=b.J(b.count-1),P=t.Aj,ca=D.Ip;if(-1===P||-1===ca)return!1;P=this.Co.f8(t.node,P,t.Eb);ca=this.Co.f8(D.node,ca,D.Sb);var ta=-1,Na=Math.min(P.count,
ca.count);for(--Na;0<=Na;Na--){const qb=P.J(Na).le,Jb=ca.J(Na).le;if(qb.equals(Jb)){ta=Na;break}}if(-1<ta&&(Na=this.Zl.JQ(P.J(ta).contentControlNode),!Na.isEditable||!Na.isSupported||Na.DM&&!this.wHm(Na,b)))return!1;t=this.Zl.jna(t,D,1);for(D=0;D<=ta;D++)this.O3c(t,this.Zl.JQ(P.J(D).contentControlNode).id);for(D=ta+1;D<P.count;D++){Na=this.Zl.JQ(P.J(D).contentControlNode);if(!Na.isEditable||!Na.aha||!Na.isSupported||Na.DM)return!1;this.O3c(t,Na.id)}for(P=ta+1;P<ca.count;P++){ta=this.Zl.JQ(ca.J(P).contentControlNode);
if(!ta.isEditable||!ta.aha||!ta.isSupported||ta.DM)return!1;this.O3c(t,ta.id)}if(t)for(const qb of t)if(!qb.isSupported||!qb.aha)return!1;return k&&(b=this.QPd(b.J(0),!0))?this.oxi(b,!0,!0):!0}wHm(b,k){k=this.Co.c6l(k.J(0),k.J(k.count-1));return!!b&&!!k&&b.objectId.equals(k.le)}oxi(b,k,t){return(b=this.Zl.jna(b,b,3))&&0<b.count&&(b=b.J(0),!b.isSupported||!b.isEditable||!this.RXd&&k&&!b.Mf||!t&&b.DM||hi.a.kZf&&k&&1===b.type)?!1:!0}QPd(b,k){if(!b)return null;let t=null;switch(b.contextId){case lc.a.paragraph:t=
k?Of.a.Rc(b.node,0):Of.a.fw(b.node);break;case lc.a.endOfParagraph:t=Of.a.fw(b.node);break;case lc.a.Hd:t=k?Of.a.Rc(b.node,b.cpBegin):Of.a.Rc(b.node,b.cpEnd);break;case lc.a.Tc:t=b}t&&(t.Sb=t.Eb=k?b.Eb:b.Sb);return t}O3c(b,k){if(b)for(const t of b)if(t.id===k){b.remove(t);break}}Fdm(b,k){if(!b)return-1;let t=-1;for(let D=0;D<b.length;D++)if(b.J(D).le.equals(k.objectId)&&!1===b.J(D).Nc){t=D;if(k.Mf&&0<D&&b.J(D-1).Mf&&!b.J(D-1).Nc)return-1;break}return t}BJm(b){if(void 0===b||null===b)return!1;for(let k=
0;k<b.count;k++){const t=b.J(k).contextId;if(t!==lc.a.paragraph&&t!==lc.a.endOfParagraph&&t!==lc.a.Hd&&t!==lc.a.Tc||0<k&&k<b.count-1&&t===lc.a.Hd&&(b.J(k).cpBegin||b.J(k).cpEnd!==b.J(k).node.characterData.length))return!1}return b.J(0).contextId===lc.a.endOfParagraph&&1===b.count||this.f9e(b,lc.a.Tc)&&1<b.count?!1:!0}f9e(b,k){for(const t of b)if(t.contextId===k)return!0;return!1}Zmh(b,k,t=null,D=null,P=!1,ca=0,ta=!1){let Na=0;var qb=k.node;let Jb=Of.a.create(b.node);qb=Of.a.create(qb);if(hi.a.contentControlAroundTableFix){if(!({V8c:Jb,
uKc:qb}=this.Tve.UCh(Jb,qb)).success)return{returnValue:2,id:Na}}else if(!({V8c:Jb,uKc:qb}=this.Qg.Vyk(Jb,qb)).returnValue)return{returnValue:2,id:Na};const Vb=this.R1.ZAb(t,x.qx,x.ni,this.Qg,this.jr,this.Zl,this.y$,this.UPa,this.OXd);Vb.type=ca;Vb.start=b;Vb.end=k;Vb.iu=Jb.node.id;Vb.iz=qb.node.id;Vb.Mf=!0;Vb.XId=D;Vb.uff=P;return this.Zl.Znh(Vb,t,ta)?(Na=Vb.id,{returnValue:0,id:Na}):{returnValue:2,id:Na}}}x.qx=null;x.ni=null;Object(n.a)(x,"ContentControlManager",null,[509]);var H=c(626),h=c(142),
u=c(187);class B extends Sys.EventArgs{constructor(b){super();this.lOh=b}}Object(n.a)(B,"ContentControlChangeEventArgs",Sys.EventArgs,[]);class S{constructor(){this.hQi=0;this.e_i=null}}Object(n.a)(S,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",null,[]);const ba=b=>!(null===b||void 0===b?0:b.length),qa=b=>null==b?!1:[...b].some(k=>k.Nc),Qa=b=>null==b?!1:[...b].some(k=>!k.Nc);class sb{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed,sd,oe,Ld,Od,ie,Ce,hg,Kg,Hl,wm){this.lj=Hl;this.rbh=
[];this.wOe=[];this.qx=b;this.ni=k;this.Qg=t;this.jr=D;this.R1=P;this.ve=qb;this.Sy=Jb;this.ib=ca;this.zE=ta;this.dBa=Na;this.y$=Kc;this.Byb=ed;this.Pea=Vb;this.kI=ac;this.ga=yc;this.Co=sd;this.Qf=oe;this.yh=Ld;this.eb=Od;this.Hc=ie;this.Ekh=Ce;this.ld=hg;this.zd=Kg;this.kI&&(this.kI.addHandler(H.a.zMb,Object(A.a)(this,this.EWi,"onShowingPlaceholder")),this.kI.addHandler(H.a.ade,Object(A.a)(this,this.NVi,"onRemoveWhenEdited")),wm.execute(bp=>{this.xE=bp}))}get ax(){return this.qx.value}get uj(){return this.ni.value}get UX(){return!!this.Qf.instance&&
this.Qf.instance.UX}get V_(){return!!this.ld&&this.ld.isFeatureEnabled(30)}dispose(){this.kI&&(this.kI.removeHandler(H.a.zMb,Object(A.a)(this,this.EWi,"onShowingPlaceholder")),this.kI.removeHandler(H.a.ade,Object(A.a)(this,this.NVi,"onRemoveWhenEdited")))}SK(b,k,t,D=!1){if(this.UX)return this.jna(b,k,t);if(!b||!k)return null;const P=this.Qg.hna(b.node.id,!0);var ca=this.Qg.hna(k.node.id,!1);if(!P||!ca)return null;b=b.contextId===lc.a.endOfParagraph?b:Of.a.Rc(P,-1===b.cpBegin?0:b.cpBegin);k=k.contextId===
lc.a.endOfParagraph?k:Of.a.Rc(ca,-1===k.cpEnd?ca.characterData.length:k.cpEnd);ca=null;switch(t){case 0:ca=this.iUl(b,k);break;case 1:ca=this.n6l(b,k);break;case 3:ca=this.Wci(b,k,D);break;case 2:ca=this.Jem(b,k);break;case 4:ca=this.yof(b,k,!1)}return ca}jna(b,k,t){if(!b||!k||b.contextId!==lc.a.endOfParagraph&&(b=this.wIh(b,!0),!b)||k.contextId!==lc.a.endOfParagraph&&(k=this.wIh(k,!1),!k))return null;let D=null;switch(t){case 0:D=this.jUl(b,k);break;case 1:D=this.o6l(b,k);break;case 3:D=this.Xci(b,
k);break;case 2:D=this.Kem(b,k);break;case 4:D=this.yof(b,k,!0)}return D}wIh(b,k){var t=this.Qg.hna(b.node.id,k);if(!t)return null;k?(k=-1===b.cpBegin?0:b.cpBegin,b=b.Eb):(k=-1===b.cpEnd?t.characterData.length:b.cpEnd,b=b.Sb);t=Of.a.Rc(t,k);t.Eb=b;t.Sb=b;return t}iUl(b,k){const t=new Eb.a;if(b.contextId===lc.a.endOfParagraph||k.contextId===lc.a.endOfParagraph||b.equals(k))return t;const D=new Ij.a,P=this.zDb(b,b),ca=this.zDb(k,k);for(let ta=0;ta<P.count;ta++)if(P.J(ta).Nc)for(let Na=0;Na<ca.count;Na++)ca.J(Na).Nc||
P.J(ta).le.equals(ca.J(Na).le)&&(!P.J(ta).Mf||this.Qg.mQa(P.J(ta).le,b.node.id,!0)&&this.Qg.mQa(ca.J(Na).le,k.node.id,!1))&&this.Myd(t,D,P.J(ta).le);return t}jUl(b,k){const t=new Eb.a;if(b.contextId===lc.a.endOfParagraph||k.contextId===lc.a.endOfParagraph||b.equals(k)&&b.Eb===b.Sb||-1===b.Eb||-1===k.Sb)return t;var D=b.node.pa.Oh(b.cpBegin),P=k.node.pa.Oh(k.cpEnd);D&&D.Jb&&0<D.Jb.length&&b.Eb<=D.Jb.length&&P&&P.Jb&&0<P.Jb.length&&k.Sb<=P.Jb.length&&(b=b.Eb,k=k.Sb,b===D.Jb.length&&b--,0<k&&k--,D=D.Jb.J(b),
P=P.Jb.J(k),D.Nc&&!P.Nc&&X.a.Zp(D.le,P.le)&&D.qp&&P.qp&&(P=D.contentControlNode)&&t.add(this.JQ(P)));return t}n6l(b,k){const t=new Eb.a,D=new Ij.a,P=this.zDb(b,k);for(let ca=0;ca<P.count;ca++)this.Myd(t,D,P.J(ca).le);b=this.Wci(b,k,!1,!1);for(const ca of b)D.contains(ca.objectId)||(t.add(ca),D.add(ca.objectId));return t}o6l(b,k){const t=new Eb.a,D=new Ij.a,P=this.Gnf(b,k);for(let ca=0;ca<P.count;ca++)this.sYe(t,D,P.J(ca));b=this.Xci(b,k);for(const ca of b)D.contains(ca.objectId)||(t.add(ca),D.add(ca.objectId));
return t}Wci(b,k,t,D=!0){const P=new Eb.a;b.equals(k)&&(t=!1);const ca=new Ij.a;let ta=!1;b=this.zDb(null,b,!0,t);k=this.zDb(k,null,t,!0);for(t=b.count-1;0<=t;t--){for(let Na=0;Na<k.count&&!(b.J(t).le.equals(k.J(Na).le)&&(b.J(t),this.Myd(P,ca,b.J(t).le)&&(ta=!this.Qg.Ut(b.J(t).le).ia(Cc.a.B7,null),D||ta)));Na++);if(0<P.count&&(D||ta))break}return P}Xci(b,k){const t=new Eb.a,D=new Ij.a,P=b.node;var ca=k.node;const ta=k.contextId===lc.a.endOfParagraph?ca.characterData.length:k.cpEnd;b=this.Co.f8(P,
b.contextId===lc.a.endOfParagraph?P.characterData.length:b.cpBegin,b.Eb);k=this.Co.f8(ca,ta,k.Sb);ca=b.count>k.count?k.count:b.count;for(--ca;0<=ca;ca--)b.J(ca).le.equals(k.J(ca).le)&&this.sYe(t,D,b.J(ca));return t}Jem(b,k){const t=new Eb.a;let D=new Ij.a;const P=this.zDb(b,k);let ca=0,ta=null;if(b.equals(k))return t;for(b=0;b<P.count;b++)!P.J(b).Nc||P.J(b).Mf&&!this.Qg.mQa(P.J(b).le,P.J(b).Ib.paragraph.id,!0)?P.J(b).Nc||P.J(b).Mf&&!this.Qg.mQa(P.J(b).le,P.J(b).Ib.paragraph.id,!1)||(ca--,0>ca?(ca=
0,D=new Ij.a):!ca&&ta&&P.J(b).le.equals(ta)&&this.Myd(t,D,ta)):(ca||(ta=P.J(b).le),ca++);return t}Kem(b,k){const t=new Eb.a;if(b.equals(k)&&b.Eb===k.Sb)return t;let D=new Ij.a;b=this.Gnf(b,k);k=0;let P=null;for(let ca=0;ca<b.count;ca++){const ta=b.J(ca);!ta.Nc||ta.Mf&&!this.Qg.mQa(ta.le,ta.Ib.paragraph.id,!0)?ta.Nc||ta.Mf&&!this.Qg.mQa(ta.le,ta.Ib.paragraph.id,!1)||(k--,0>k?(k=0,D=new Ij.a):!k&&P&&ta.le.equals(P.le)&&this.sYe(t,D,P)):(k||(P=ta),k++)}return t}yof(b,k,t){const D=new Eb.a;b=t?this.Gnf(b,
k):this.zDb(b,k);k=0;for(t=0;t<b.count;t++){var P=b.J(t);P.qp&&(P.Nc?k++:(k--,0>k?k=0:(P=this.JQ(P.contentControlNode))&&D.add(P)))}return D}zDb(b,k,t=!0,D=!0){const P=new Eb.a,ca=this.UT(b,k);if(!ca.count)return P;let ta,Na,qb,Jb;for(let Vb=0;Vb<ca.count;Vb++){ta=0;Na=ca.J(Vb).characterData.length;qb=Jb=!0;if(b&&ca.J(Vb).id.equals(b.node.id)){if(b.contextId===lc.a.endOfParagraph)continue;0<=b.cpBegin&&(ta=b.cpBegin)}k&&ca.J(Vb).id.equals(k.node.id)&&0<=k.cpEnd&&(Na=k.cpEnd);Vb||(qb=t);Vb!==ca.count-
1||k&&k.contextId===lc.a.endOfParagraph||(Jb=D);P.addRange(this.Hnf(ca.J(Vb),ta,Na,qb,Jb))}return P}Gnf(b,k){const t=new Eb.a,D=this.UT(b,k);let P,ca,ta;for(let qb=0;qb<D.count;qb++){const Jb=D.J(qb);if(Jb.pa.length){var Na=Jb.pa.J(Jb.pa.length-1);P=0;ca=Jb.characterData.length;ta=0;Na=Na&&Na.Jb?Na.Jb.length:0;b&&Jb.id.equals(b.node.id)&&(P=b.Aj,ta=b.Eb);k&&Jb.id.equals(k.node.id)&&(ca=k.Ip,Na=k.Sb);t.addRange(this.Inf(Jb,P,ca,ta,Na))}}return t}Hnf(b,k,t,D=!0,P=!0,ca=!0){const ta=new Eb.a;b=b.pa;
for(let Na=0;Na<b.length;Na++){if(b.J(Na).cp<k)continue;if(b.J(Na).cp>t)break;const qb=b.J(Na);if(qb.Jb&&0<qb.Jb.length&&(qb.cp!==k||D)&&(qb.cp!==t||P))for(let Jb=0;Jb<qb.Jb.length;Jb++){const Vb=qb.Jb.J(Jb);(ca||Vb.Nc)&&ta.add(Vb)}}return ta}Inf(b,k,t,D,P){const ca=new Eb.a;b=b.pa;for(let ta=0;ta<b.length;ta++){if(b.J(ta).cp<k)continue;if(b.J(ta).cp>t)break;const Na=b.J(ta);if(Na.Jb&&0<Na.Jb.length){let qb=0,Jb=Na.Jb.length;Na.cp===k&&-1!==D&&(qb=D);for(Na.cp===t&&-1!==P&&(Jb=P);qb<Jb&&qb<Na.Jb.length;qb++)ca.add(Na.Jb.J(qb))}}return ca}Myd(b,
k,t){let D=null;if(k.contains(t)||!(D=this.uj.Db(t)))return!1;b.add(this.JQ(D));k.add(t);return!0}sYe(b,k,t){let D=null;!k.contains(t.le)&&(D=t.contentControlNode)&&(b.add(this.JQ(D)),k.add(t.le))}dBj(b,k){let t,D=!1;t=({J4a:k,I4a:b,I7c:D}=this.eBj(b,k,!1,D)).returnValue||D;D&&(t=t||({J4a:k,I4a:b,I7c:D}=this.eBj(k,b,!0,D)).returnValue);return{returnValue:t,J4a:k,I4a:b}}eBj(b,k,t,D){var P,ca,ta,Na;let qb,Jb;if(t)return qb=Jb=null,{returnValue:!1,J4a:Jb,I4a:qb,I7c:!1};let Vb=!1;Jb=b;qb=k;const ac=b.cpBegin,
yc=k.cpEnd;D=!1;var Kc=t?this.i3h(k):this.yKl(b);let ed=!1,sd=!1,oe=0,Ld=0;for(const Od of Kc)for(Kc=0;Kc<Od.pa.length;Kc++){const ie=Od.pa.J(Kc);!sd&&Od.id.equals(k.node.id)&&(sd=!0);if(!ed&&(Od.id.equals(k.node.id)&&-1!==yc&&ie.cp>yc||sd&&!Od.id.equals(k.node.id)))if(ed=!0,oe!==Ld)Vb=!0;else return{returnValue:!1,J4a:Jb,I4a:qb,I7c:D};if((!Od.id.equals(b.node.id)||ie.cp>=ac||-1===ac)&&ie.Jb)for(let Ce=0;Ce<ie.Jb.length;Ce++){const hg=ie.Jb.J(Ce),Kg=this.uj.Db(hg.le);if(!Kg.getValue(Cc.a.v8)||(!hg.Nc||
this.Qg.mQa(hi.a.xj?this.zd.yq(Kg.id,!0):null!==(ca=this.zd.Ms.get(null===(P=Kg.id)||void 0===P?void 0:P.toString()))&&void 0!==ca?ca:X.a.nil,Od.id,!0))&&(hg.Nc||this.Qg.mQa(hi.a.xj?this.zd.yq(Kg.id,!1):null!==(Na=this.zd.kt.get(null===(ta=Kg.id)||void 0===ta?void 0:ta.toString()))&&void 0!==Na?Na:X.a.nil,Od.id,!1))){hg.Nc?oe++:oe--;if(Vb&&oe===Ld)return{J4a:Jb,I4a:qb}=this.u8k(b.node,Od,b.cpBegin,ie.cp),{returnValue:!0,J4a:Jb,I4a:qb,I7c:D};!t&&oe<Ld&&(D=!0,Ld--)}}}return{returnValue:Vb,J4a:Jb,I4a:qb,
I7c:D}}u8k(b,k,t,D){let P;k.id.equals(b.id)?b=0<t||D<pe.ParagraphReader.textLength(k)?P=Of.a.createTextRange(k,t,D):P=Of.a.create(k):(P=0<t?Of.a.createTextRange(b,t,pe.ParagraphReader.textLength(b)):Of.a.create(b),b=D<pe.ParagraphReader.textLength(k)?Of.a.createTextRange(k,0,D):Of.a.create(k));return{J4a:P,I4a:b}}p2l(b){var k,t,D,P;const ca=b.cpBegin,ta=this.i3h(b);for(let qb=ta.count-1;0<=qb;qb--){const Jb=ta.J(qb);for(let Vb=Jb.pa.length-1;0<=Vb;Vb--){const ac=Jb.pa.J(Vb);if((!Jb.id.equals(b.node.id)||
ac.cp<=ca||-1===ca&&!ac.cp)&&ac.Jb){var Na=ac.Jb.length-1;for((ac.cp===ca||-1===ca&&!ac.cp)&&this.UX&&Jb.id.equals(b.node.id)&&(Na=b.Eb-1);0<=Na;Na--){const yc=ac.Jb.J(Na),Kc=this.uj.Db(yc.le);if(yc.Nc){if(Kc.getValue(Cc.a.v8)&&!this.Qg.mQa(hi.a.xj?this.zd.yq(Kc.id,!0):null!==(P=this.zd.Ms.get(null===(D=Kc.id)||void 0===D?void 0:D.toString()))&&void 0!==P?P:X.a.nil,Jb.id,!0))continue;return null}if(!Kc.getValue(Cc.a.v8)||this.Qg.mQa(hi.a.xj?this.zd.yq(Kc.id,!1):null!==(t=this.zd.kt.get(null===(k=
Kc.id)||void 0===k?void 0:k.toString()))&&void 0!==t?t:X.a.nil,Jb.id,!1))return this.JQ(Kc)}}}}return null}JQ(b){if(!b)return null;this.Qg.x5b();return this.R1.ZAb(b,this.qx,this.ni,this.Qg,this.jr,this,this.y$,this.Pea,this.Byb)}UT(b,k){b=this.h3h(b,k,sb.jEb(12));if(!b)return null;k=new Eb.a;for(const t of b)k.add(t);return k}wKl(b,k){const t=sb.BZl();return this.h3h(Of.a.create(b.node),Of.a.create(k.node),t)}h3h(b,k,t){if(!t||!b&&!k)return null;if(b&&k&&(b.equals(k)||b.node.id.equals(k.node.id))){var D=
b.node;if(D&&t(D)){var P;return P=new Eb.a,P.add(D),P}}D=Object.assign(new S,{hQi:35,e_i:t});b=b?b.node:null;k=k?k.node:null;P=this.u$l(b,k);if(!P)return null;k=this.Yyk(k,t,sb.Pyh,D);return this.sKl(b,k,P,t,sb.Pyh,D)}u$l(b,k){return(b=b?this.K$h(b):this.K$h(k))?b.hd(35):this.Qg.Y4l()}Yyk(b,k,t,D){if(!b)return null;k(b)||(k=this.tKl(b,k,t,D),k.count&&(b=k.J(k.count-1)));return b}sKl(b,k,t,D,P,ca){b?(b=ze.GraphIterator.$a(b),b.zb(7),t=wc.a.mt(b,t)):t=wc.a.Vo(t);P&&t.oo(P,ca);for(P=new Eb.a;t.moveNext()&&
(D(t.currentNode)&&P.add(t.currentNode),!k||!t.currentNode.id.equals(k.id)););return P}tKl(b,k,t,D){b=wc.a.Vo(b);t&&b.oo(t,D);for(t=new Eb.a;b.moveNext();)k(b.currentNode)&&t.add(b.currentNode);return t}K$h(b){b=ze.GraphIterator.$a(b);return b.zb(35)?b:null}fmi(b,k){b=this.UT(b,k);for(const t of b)if((b=this.Qg.Uqf(t))&&b.Oga(4))return!0;return!1}Znh(b,k=null,t=!1){if(!b)return!1;let D=b.start;var P=b.end;if(!hf.SelectionEditor.hv(D)&&D.contextId!==lc.a.paragraph||!hf.SelectionEditor.hv(P)&&P.contextId!==
lc.a.paragraph||!this.UX&&({J4a:D,I4a:P}=this.dBj(b.start,b.end)).returnValue||this.UX&&!({start:D,end:P}=this.rRk(D,P)).returnValue)return!1;b.start=D;b.end=P;const ca=this.$Hm(D,P);if(this.UX){var ta=this.jna(b.start,b.end,3);var Na=this.jna(b.start,b.end,2)}else ta=this.SK(b.start,b.end,3),Na=this.SK(b.start,b.end,2);const qb=ta&&0<ta.count?ta.J(0):null,Jb=Na&&0<Na.count?Na.J(0):null;if(t)return this.zTc(b,0,ta)?!0:!1;if(this.zTc(b,0,ta)){t=(t=Object(Ka.a)(UB,this.p2l(b.start)))?this.Qg.Ut(t.objectId):
null;Na=this.Qg.Eqk(b,qb,t,Na,b.iu,b.iz,k);this.lj.gdc(Na);if(b.Mf)for(P=this.UT(b.start,b.end),t=0;t<P.count;t++)if(this.UX){ta=qb?qb.objectId:null;const Vb=this.o$h(ta,P.J(t),!0);this.jr.xta(P.J(t),Na.id,0,!0,!0,void 0,void 0,void 0,void 0,Vb);ta=this.o$h(ta,P.J(t),!1);this.jr.xta(P.J(t),Na.id,P.J(t).characterData.length,!0,!1,void 0,void 0,void 0,void 0,ta)}else this.jr.xta(P.J(t),Na.id,0,!0,!0),this.jr.xta(P.J(t),Na.id,P.J(t).characterData.length,!0,!1);else this.UX?(t=-1===D.Eb?0:D.Eb,this.jr.xta(b.start.node,
Na.id,D.cpBegin,!1,!0,void 0,void 0,void 0,void 0,t),this.jr.xta(b.end.node,Na.id,P.cpEnd,!1,!1,void 0,void 0,void 0,void 0,ca?t+1:P.Sb)):(this.jr.xta(b.start.node,Na.id,b.start.cpBegin,!1,!0),this.jr.xta(b.start.node,Na.id,b.start.cpEnd,!1,!1));k||this.Qg.nfo(Na,b.Mf,b.id,this.Qg.J8b(this.Qg.Ut(b.iu)),b.type);1===b.type&&this.jr.LOo(b.start.node,D.Aj,D.Ip);b.objectId=Na.id;k=this.Qg.zva().currentNode;k.hasProperty(Cc.a.hHc)||k.setValue(Cc.a.hHc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);
!hi.a.akb||0!=b.type&&1!=b.type||b.YBi||this.Qg.MEj(WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,Na);qb&&this.WFj(qb.contentControlNode,b);Jb&&this.WFj(Na,Jb);ca&&this.ga.Qb(Pb.a.a8c,2,b.id);TB.a.RHh()&&this.xE&&this.xE.fireEvent(3,{node:Na});return!0}return!1}deleteContentControl(b){if(!this.zTc(b,3))return v.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete"),!1;if(this.lj.$$c(b.contentControlNode))return!0;b.DM&&(b.DM=!1);const k=this.ib.hb.kb;b=b.dF();const t=
new Eg.Selection(b.toArray(),!0);let D=!1;this.ib.pNb(()=>{this.ib.setSelection(t);if(32===this.ga.processAction(Pb.a.zH,2)){if(this.Ekh.instance){const P=this.Ekh.instance.Yai(k,t,this.ib.hb.kb);this.ib.FQo(new h.SelectionCollection([P],0))}D=!0}});return D}dya(b,k=!1,t=!1){if(this.zTc(b,2)){if(b.DM)return v.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(b);const D=hi.a.pr?b.contentControlNode:this.Qg.Ut(b.objectId);let P=new Eb.a;
k&&(P=b.Pmf());P.add(b);if(t||!this.lj.$$c(b.contentControlNode)){D&&D.anchor&&this.Qg.KPh(D,k);for(const ca of P)b=this.UT(ca.start,ca.end),this.jr.cil(b,ca.objectId);this.X4i(P)}v.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}v.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}Hbg(b,k,t=!1){var D;if(this.zTc(b,1)){let Jb=!1;k||(Jb=!0,{Bqo:P,returnValue:k}=this.JEb(b),P&&this.Qg.zva().currentNode.setValue(Cc.a.hHc,k));var P=b.g5h().toArray();
for(var ca=0;ca<P.length;ca++)this.dya(P[ca],!0);ca=this.Qyo(k);P=!t;if(b.Mf){var ta=this.UT(b.start,b.end);if(!ta.count)return!1;if(1===ta.count&&w.AFrameworkApplication.HD){ca=ca.join(" ");if(null===(D=w.AFrameworkApplication.K)||void 0===D?0:D.getBooleanFeatureGate("Microsoft.Office.WordOnline.rtfSupportCA",!1))ca=k;this.jr.replaceTextRange(Of.a.createTextRange(ta.J(0),0,ta.J(0).characterData.length),ca,void 0,P)}else{D=this.Qg.g6l(ta.J(0));k=ta.J(0).S6b();ta=this.Qg.ZPh(ta);D=this.Qg.loh(D,ta,
ca.length);for(ta=0;ta<D.count;ta++){this.jr.replaceTextRange(Of.a.createTextRange(D.J(ta),0,0),ca[ta],void 0,P);for(var Na=0;Na<k.count;Na++)this.jr.xta(D.J(ta),k.J(Na),0,!0,!0),this.jr.xta(D.J(ta),k.J(k.count-Na-1),D.J(ta).characterData.length,!0,!1)}b.xWo(D.J(0).id,D.J(D.count-1).id);P=this.zE.te(D.J(0),0);this.ib.setSelection(P)}}else{ta=0;1<ca.length&&v.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");k=b.start;D=k.node;
for(var qb=0;qb<D.pa.length&&k.contextId===lc.a.Hd;qb++)if(Na=D.pa.J(qb),Na.cp===k.cpBegin&&Na.blob){ta++;for(qb+=1;qb<D.pa.length;qb++)if(Na=D.pa.J(qb),Na.cp>k.cpBegin&&Na.cp<=k.cpEnd)if(Na.blob)ta++;else break;else if(Na.cp>k.cpEnd)break;break}if(0<ta&&ta+k.cpBegin<k.cpEnd)D=Of.a.createTextRange(k.node,k.cpBegin,k.cpBegin+ta),k=Of.a.createTextRange(k.node,k.cpBegin+ta,k.cpEnd),this.jr.replaceTextRange(k,ca[0],void 0,P),this.jr.replaceTextRange(D,"",void 0,P);else if(0<ta&&ta+k.cpBegin===k.cpEnd)for(this.jr.replaceTextRange(b.start,
ca[0],void 0,P),P=0;P<D.pa.length;P++){if(ca=D.pa.J(P),ca.cp===k.cpBegin){ca.blob=null;break}}else w.AFrameworkApplication.HD?(ca=ca.join(" "),this.jr.replaceTextRange(b.start,ca,void 0,P)):this.jr.replaceTextRange(b.start,ca[0],void 0,P)}this.T0b(b,Jb||t);let Vb;this.zLn((Vb=new Eb.a,Vb.add(b),Vb));return!0}return!1}T0b(b,k){const t=this.jr.JOc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(t){const D=this.Qg.Ut(b.objectId);if(k){k=this.Sy.JC(b.start.node);let P=k.Fi(lt.a.iZf);P||(P=k.Ova(lt.a.mBn));
P&&(this.ve.pfa(t.formatting),this.ve.A6a(t.formatting,P));D&&(b.DM=!0)}else D&&b.DM&&(this.n5n(b,t),b.DM=!1)}else v.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control")}n5n(b,k){b=this.Qg.Ut(b.objectId);let t=null;b&&(t=b.ia(Cc.a.MAb,X.a.nil));this.ve.pfa(k.formatting);t&&!t.equals(X.a.nil)&&(b=this.ni.value.Db(t),k.formatting=b)}JEb(b){let k=!1;b=b.placeholderText;this.XQm(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,k=!0);return{returnValue:b,
Bqo:k}}zWn(b,k=!0){this.Pea&&(k&&this.vWn(b),this.DWn(b))}AWn(b){if(this.Pea&&(b=this.SK(b,b,4)))for(const k of b)this.dya(k,!1)}Nkn(b,k){if(k&&!b.Nc&&(this.Qg.x5b(),(b=b.Ib.paragraph.Kc.Db(b.le))&&b.anchor)){this.Qg.KPh(b);b=this.R1.ZAb(b,this.qx,this.ni,this.Qg,this.jr,this,this.y$,this.Pea,this.Byb);let t;this.X4i((t=new Eb.a,t.add(b),t))}}NVi(b,k){this.Qg.x5b();b=this.Qg.Ut(k.le);const t=this.JQ(b);if(t&&t.isValid()&&t.removeWhenEdited){const D=this.Hc.Mc(7);D.Cb(b);this.dya(t,!1);k.state=2;D.dispose()}}EWi(b,
k){this.Qg.x5b();b=this.Qg.Ut(k.le);this.dGm(b)&&(b=b.ia(Cc.a.Ow,0),this.ga&&(this.ga.Qb(Pb.a.a8c,2,b),sb.Ld.$_e()))}dGm(b){return b&&b.isConnected&&!b.ia(Cc.a.C7,!1)?hi.a.pr?this.QXd(b)&&!b.Lu:this.QXd(b):!1}QXd(b){b=this.R1.ZAb(b,this.qx,this.ni,this.Qg,this.jr,this,this.y$,this.Pea,this.Byb);if(!b.isValid())return!1;if(b.Mf){if(b.iu.toString()===b.iz.toString()){var k=this.Qg.Ut(b.iu);if(!k)return v.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),
!1;if(12===k.type&&1===k.pa.length)return this.Fui(k.pa.J(0),b.objectId)}}else{k=b.start;if(!k)return v.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),!1;if(k.cpBegin===k.cpEnd)return k=this.Qg.Ut(b.iu).pa.Oh(k.cpBegin),this.Fui(k,b.objectId)}return!1}Fui(b,k){b=b?b.Jb:null;if(!b)return!1;const t=b.eJ(k,!0);return-1<t&&t+1<b.length&&b.J(t+1).le.toString()===k.toString()}S7i(b){this.wOe.push(b)}ytj(b,k){if(void 0===b||null===b||b.contextId!==
lc.a.Hd)return null;b=Of.a.Rc(b.node,k?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<pe.ParagraphReader.textLength(b.node)?this.Qg.qTa(b):null}select(b,k){if(b&&!b.equals(X.a.nil)){var t=this.Qg.Ut(b);if(t&&55===t.type){t=this.JQ(t);if(t.Mf)t=this.mMl(t);else{t=t.start;hi.a.Pj&&(t.contextId=lc.a.Hd);if(!t)return;t=this.zE.ho(t)}if(t&&t.length)return this.xjj(t.Qa,b,k,!0,!0),this.xjj(t.Qc,b,k,!1,!1),this.ib.setSelection(t),t}}}O$n(b,k){if(!hf.SelectionEditor.gf(b)||b.Eb!==b.Sb)return!1;const t=
b.Eb;return-1===t?!1:(b=this.Co.K0a(b.node,b.cpBegin,t,!k))&&k===b.Nc?(k=this.JQ(b.contentControlNode),this.select(b.le,!k.isEditable),!0):!1}mMl(b){var k=this.Qg.EOa(b.iu,!0);b=this.Qg.EOa(b.iz,!1);if(!k||!b)return null;k=this.wKl(Of.a.create(k),Of.a.create(b));if(!k||!k.count)return null;b=new Eb.a;for(let t=0;t<k.count;t++){let D;if(12===k.J(t).type)D=t===k.count-1?Of.a.createTextRange(k.J(t),0,pe.ParagraphReader.textLength(k.J(t))):Of.a.create(k.J(t)),this.yh&&(D.Eb=this.yh.Wq(D.node,!0),D.Sb=
this.yh.Wq(D.node,!1));else if(15===k.J(t).type)D=u.TableNodeContext.create(k.J(t));else continue;b.add(D)}return new Eg.Selection(b.toArray(),!0)}Meo(b){if(b&&!b.equals(X.a.nil)&&(this.Qg.x5b(),(b=this.Qg.Ut(b))&&55===b.type&&b.isConnected)){var k=b.ia(Cc.a.C7,!1);b.setValue(Cc.a.C7,!1);k&&this.ARn(b)}}ARn(b){var k,t;const D=hi.a.xj?this.zd.yq(b.id,!0):null!==(t=this.zd.Ms.get(null===(k=b.id)||void 0===k?void 0:k.toString()))&&void 0!==t?t:X.a.nil;D.equals(X.a.nil)||(k=this.Qg.hna(D,!0))&&(b=this.jr.uof(k,
b.id,!0))&&0<b.count&&(b=b.J(0),k=b.Ib,k.formatting=b.GQ?b.GQ.Ef(k):new Gz.a(k,X.a.nil))}L8i(b){if(b=this.i6h(b))for(const k of b)this.lj.Acg()&&(k.DM=!1),this.dya(k,!1)}f6h(b){const k=new Eb.a;if(b=this.i6h(b))for(const t of b)k.add(t.contentControlNode);return k}BWn(b){if(b&&(11===b.type||14===b.type||15===b.type||16===b.type)){var k=this.eb.xl(b),t=this.eb.PD(b);if(this.yh&&k&&t){b=this.yh.Wq(k,!0);const D=this.yh.Wq(t,!1);k=Of.a.create(k);t=Of.a.create(t);k.Eb=b;t.Sb=D;if(b=this.jna(k,t,4))for(const P of b)this.dya(P,
!1)}}}zKl(b){var k,t,D,P;const ca=hi.a.xj?this.zd.yq(b.id,!0,b.loading):null!==(t=this.zd.Ms.get(null===(k=b.id)||void 0===k?void 0:k.toString()))&&void 0!==t?t:X.a.nil;b=hi.a.xj?this.zd.yq(b.id,!1,b.loading):null!==(P=this.zd.kt.get(null===(D=b.id)||void 0===D?void 0:D.toString()))&&void 0!==P?P:X.a.nil;if(ca.equals(X.a.nil)||b.equals(X.a.nil))return new Eb.a;D=this.Qg.hna(ca,!0);P=this.Qg.hna(b,!1);return D&&P?this.UT(Of.a.create(D),Of.a.create(P))||new Eb.a:new Eb.a}EOa(b,k){return this.Qg.EOa(b,
k)}Bqf(b,k){if(b&&55===b.type&&(b=this.JQ(b),b=k?b.start:b.end)){const t=Of.a.Rc(b.node,k?b.Aj:b.Ip);t.Eb=t.Sb=(k?b.Eb:b.Sb)+(k?-1:1);return t}return null}$Pl(b){return(b=this.JQ(b))?b.start:null}xjj(b,k,t,D,P){if((b.contextId===lc.a.Hd||b.contextId===lc.a.Tc||b.contextId===lc.a.paragraph)&&(P=b.node.pa.Oh(P?b.Aj:b.Ip))&&P.Jb)for(let ca=0;ca<P.Jb.length;ca++){const ta=P.Jb.J(ca);if(ta.le.equals(k)&&ta.qp)if(D&&ta.Nc){b.Eb=t?ca:ca+1;break}else if(!D&&!ta.Nc){b.Sb=t?ca+1:ca;break}}}zLn(b){for(let k=
0;k<this.rbh.length;++k)(0,this.rbh[k])(this,new B(b))}X4i(b){for(let k=0;k<this.wOe.length;++k)(0,this.wOe[k])(this,new B(b))}DWn(b){b=Of.a.create(b);if(b=this.SK(b,b,4))for(const k of b)k.Mf||this.dya(k,!1)}vWn(b){if(b=b.S6b())for(let t=0;t<b.count;t++){var k=this.Qg.Ut(b.J(0));k=this.R1.ZAb(k,this.qx,this.ni,this.Qg,this.jr,this,this.y$,this.Pea,this.Byb);this.dya(k)}}yKl(b){return this.UT(b,null)}zTc(b,k,t=null){let D=!0;try{if(!b)return v.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),
!1;v.ULS.sendTraceTag(529106508,368,50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",k,b.isSupported,b.aha));if(!hi.a.pr&&this.dBa&&sq.a.instance.J(1)&&this.dBa.$Q(this.qx.value))return v.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),!1;if(this.lNm(k)&&this.mNm(k)&&!this.eGm(b))return!1;if(!t){const ta=this.b6l(b);ta&&(t=new Eb.a,t.add(ta))}var P=this.Qg.qci(b.start.node);const ca=this.Qg.qci(b.end.node);
if(P&&ca&&!P.equals(ca)||!P&&ca||P&&!ca)return!1;P=!0;if(t&&0<t.count){if(!t.J(0).isSupported)return!1;P=t.J(0).isEditable}switch(k){case 0:D=this.ADm(b,P);break;case 1:D=(this.V_||!this.QYd(b))&&b.isSupported&&b.isEditable&&this.huh(b)&&this.Iui(b);w.AFrameworkApplication.HD||(D=D&&!this.fmi(b.start,b.end));break;case 2:const ta=b.YBi?!0:b.isSupported;D=(this.V_||!this.QYd(b))&&ta&&b.aha&&P;v.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:D=b.isSupported&&b.aha&&P&&this.huh(b)&&this.Iui(b)&&
!this.fmi(b.start,b.end)}}catch(ca){v.ULS.sendTraceTag(17413646,368,15,"Exception was caught in IsContentControlValid. OperationType: "+k+", Exception: "+ca),D=!1}return D}mNm(b){return!(w.AFrameworkApplication.HD&&1===b)}lNm(b){return!(this.UX&&(!b||2===b||3===b))}ADm(b,k){if(hi.a.kZf)return this.BDm(b,k);let t=!0;if(!this.V_&&this.QYd(b))t=!1;else if(this.UX)this.UX?b.Mf||hf.SelectionEditor.hv(b.start)||b.start.contextId===lc.a.endOfParagraph?b.Mf&&(b.start.contextId!==lc.a.paragraph&&b.start.contextId!==
lc.a.endOfParagraph||b.end.contextId!==lc.a.paragraph&&b.end.contextId!==lc.a.endOfParagraph)&&(t=!1):t=!1:t=k?this.Xti(b):!1;else if(!(b.Mf||-1!==b.start.cpBegin&&-1!==b.end.cpEnd&&b.start.equals(b.end)))t=!1;else if(b.Mf&&(b.start.contextId!==lc.a.paragraph||b.end.contextId!==lc.a.paragraph||b.start.equals(b.end)&&!pe.ParagraphReader.textLength(b.start.node)))t=!1;else if(b.start.contextId===lc.a.Tc||b.end.contextId===lc.a.Tc||b.start.contextId===lc.a.endOfParagraph||b.end.contextId===lc.a.endOfParagraph)t=
!1;return t}BDm(b,k){return(this.V_||!this.QYd(b))&&this.CDm(b)&&this.DJm(b)&&k&&!this.VKm(b)&&this.Xti(b)?!0:!1}DJm(b){var k;const t=b.start,D=t.contextId,P=null===(k=b.end)||void 0===k?void 0:k.contextId;return b.Mf?D!==lc.a.paragraph&&D!==lc.a.endOfParagraph||P!==lc.a.paragraph&&P!==lc.a.endOfParagraph?!1:!0:hf.SelectionEditor.hv(t)||D===lc.a.endOfParagraph?!0:!1}i6h(b){if(!b||!b.length)return null;const k=b[0];b=b[b.length-1];this.yh&&(this.eb.lm(k)&&12===k.node.type&&(k.Eb=this.yh.Wq(k.node,
!0)),this.eb.lm(b)&&12===b.node.type&&(b.Sb=this.yh.Wq(b.node,!1)));return this.jna(k,b,4)}huh(b){b=b.Pmf();for(const k of b)if(!k.isSupported||!k.aha)return!1;return!0}eGm(b){if(this.dBj(b.start,b.end).returnValue)return!1;const k=this.SK(b.start,b.end,2);if(!k)return!0;for(const t of k)if(!t.objectId.equals(b.objectId)&&(t.Mf&&(t.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||t.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===pe.ParagraphReader.textLength(t.end.node)))||
!t.Mf&&(b.start.node.id.equals(t.start.node.id)&&(-1!==b.start.cpBegin?t.start.cpBegin===b.start.cpBegin:!t.start.cpBegin)||b.end.node.id.equals(t.end.node.id)&&(-1!==b.end.cpEnd?t.end.cpEnd===b.end.cpEnd:t.end.cpEnd===pe.ParagraphReader.textLength(b.end.node)))))return!1;return!0}Iui(b){if(b.Mf){var k=this.Qg.Ut(b.iu),t=this.Qg.Ut(b.iz);let D=null;if(12===k.type&&12===t.type){k=this.Qg.J8b(k);k=this.Qg.Ut(k);t=this.Qg.J8b(t);t=this.Qg.Ut(t);if(!k||!t)return!1;16===k.type&&16===t.type&&k.id.equals(t.id)&&
(D=k)}b=this.UT(b.start,b.end);if(!b.count)return!1;for(const P of b)if(b=this.Qg.J8b(P),b=this.Qg.Ut(b),!b||!(16!==b.type||D&&b.id.equals(D.id)))return!1}return!0}QYd(b){return b.Mf?!1:(b=b.start.node)?!b.ia(Cc.a.xjb,!0):!0}CDm(b){return 1!==b.type?!0:b.iu.equals(b.iz)&&pe.ParagraphReader.Wb(b.start.node)&&!this.hpm(b)?!0:!1}hpm(b){const k=b.start;var t=k.node;const D=t.pa;if(b.Mf){if(t.Qs||t.Pga||t.hasBookmark)return!0;for(var P of D)if(this.kmi(P))return!0;return!1}b=k.Aj;t=k.Ip;let ca=P=null;
for(const ta of D.eDi(b,t))if(!(ta.cp<b))if(ta.cp===b)P=ta;else if(ta.cp===t)ca=ta;else if(this.kmi(ta))return!0;return this.ipm(k,P,ca)?!0:!1}kmi(b){return ba(b.Jb)&&ba(b.tf)&&ba(b.Eh)&&ba(b.$c)&&null==b.hyperlink&&!b.Om&&null==b.blob?!1:!0}ipm(b,k,t){if(null==k&&null==t)return!1;const D=b.Eb;b=b.Sb;return null!=k&&(k.Jb&&D<k.Jb.length||null!=k.blob)||null!=t&&t.Jb&&0<b||null!=k&&null!=t&&(qa(k.tf)&&Qa(t.tf)||qa(k.Eh)&&Qa(t.Eh)||!ba(k.$c)&&!ba(t.$c)&&[...k.$c].some(P=>0===P.yg)&&[...t.$c].some(P=>
3===P.yg)||null!=k.hyperlink&&t.Om)?!0:!1}VKm(b){var k,t;return(null!==(t=null===(k=this.SK(b.start,b.end,3))||void 0===k?void 0:k.toArray())&&void 0!==t?t:[]).some(D=>1===D.type)?!0:!1}Xti(b){if(!b.Mf)return!0;var k=this.Qg.Ut(b.iu);b=this.Qg.Ut(b.iz);if(yh.TableCellReader.Nwa(k)||yh.TableCellReader.Nwa(b)||fn.a.Eoa(k)||fn.a.Eoa(b))return!1;k=this.Qg.J8b(k);k=this.Qg.Ut(k);b=this.Qg.J8b(b);b=this.Qg.Ut(b);return k&&b&&(16!==k.type&&16!==b.type||k.id.equals(b.id))?!0:!1}b6l(b){if(!b)return null;b=
this.Qg.Ut(b.objectId);if(!b)return null;b=b.ia(Cc.a.B7,X.a.nil);return b.equals(X.a.nil)?null:(b=this.Qg.Ut(b))?this.JQ(b):null}i3h(b){return this.UT(null,b)}Qyo(b){return(b||"").split(RegExp("\r\n|\r|\n"))}XQm(b){return b&&""!==b?!1:!0}o$h(b,k,t){k=k.pa.Oh(t?0:k.characterData.length);if(!k)return v.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!k.Jb||!k.Jb.length)return 0;if(!b)return t?0:k.Jb.length;for(let D=0;D<k.Jb.length;D++){const P=k.Jb.J(D);
if(X.a.Zp(P.le,b)&&P.Nc===t)return t?D+1:D}return t?0:k.Jb.length}rRk(b,k){var t=b.node,D=k.node,P=b.contextId===lc.a.paragraph?0:b.cpBegin,ca=k.contextId===lc.a.paragraph?pe.ParagraphReader.textLength(D):k.cpEnd;t=this.Co.f8(t,P,b.Eb);D=this.Co.f8(D,ca,k.Sb);ca=!t||!t.count;P=!D||!D.count;if(ca&&P)return{returnValue:!0,start:b,end:k};if(ca)return{returnValue:this.zme(b,D.J(D.count-1).le,!0),start:b,end:k};if(P)return{returnValue:this.zme(k,t.J(t.count-1).le,!1),start:b,end:k};if(t.count===D.count)return t=
t.J(t.count-1),D=D.J(D.count-1),{returnValue:t.le.equals(D.le),start:b,end:k};t=(ca=t.count<D.count)?D.J(D.count-1):t.J(t.count-1);return{returnValue:ca?this.zme(b,t.le,!0):this.zme(k,t.le,!1),start:b,end:k}}zme(b,k,t){var D=b.node;let P;if(t){P=b.contextId===lc.a.paragraph?0:b.cpBegin;var ca=b.Eb}else P=b.contextId===lc.a.paragraph?pe.ParagraphReader.textLength(D):b.cpEnd,ca=b.Sb;D=D.pa.Oh(P);if(-1===ca||!D||!D.Jb||!D.Jb.length)return!1;D=D.Jb;if(t)for(t=ca;t<D.length;t++){ca=D.J(t);if(!ca.Nc)break;
if(ca.le.equals(k))return b.Eb=t+1,!0}else for(t=ca-1;0<=t;t--){ca=D.J(t);if(ca.Nc)break;if(ca.le.equals(k))return b.Sb=t,!0}return!1}$Hm(b,k){return this.sFk(b,k)&&b.Eb===b.Sb&&(b.contextId===lc.a.Tc||b.contextId===lc.a.paragraph&&!b.node.characterData.length)}sFk(b,k){return b.equals(k)&&b.Eb===k.Eb&&b.Sb===k.Sb}WFj(b,k){var t,D,P,ca,ta,Na;if(b&&k.Mf){var qb=hi.a.xj?this.zd.yq(b.id,!0):null!==(D=this.zd.Ms.get(null===(t=b.id)||void 0===t?void 0:t.toString()))&&void 0!==D?D:X.a.nil;t=this.Qg.hna(k.iu,
!0);qb.equals(t?t.id:null)&&(hi.a.xj?this.zd.kE(b.id,k.objectId,!0):this.zd.Ms.set(null===(P=b.id)||void 0===P?void 0:P.toString(),k.objectId));P=hi.a.xj?this.zd.yq(b.id,!1):null!==(ta=this.zd.kt.get(null===(ca=b.id)||void 0===ca?void 0:ca.toString()))&&void 0!==ta?ta:X.a.nil;ca=this.Qg.hna(k.iz,!1);P.equals(ca?ca.id:null)&&(hi.a.xj?this.zd.kE(b.id,k.objectId,!1):this.zd.kt.set(null===(Na=b.id)||void 0===Na?void 0:Na.toString(),k.objectId))}}static get Ld(){return null!=sb.$Hg?sb.$Hg:sb.$Hg=Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static jEb(b){return k=>
k.type===b}static BZl(){return b=>12===b.type||15===b.type}static Pyh(b,k){return b.We===k.hQi||b.parentNode&&k.e_i(b.parentNode)?!1:!0}}Object(n.a)(sb,"ContentControlOperator",null,[507,9,508]);class Sb{constructor(b,k,t){this.Wc=b;this.qx=k;this.Vvb=t}Oii(b){const k=this.rOc();return k&&b&&this.RPc(k,b)?this.chm(k):null}RPc(b,k,t=!1){if(!b||!k)return!1;do{var D=b.currentNode;if(!D)break;D=D.ia(Cc.a.PPc,null);if(D===k||t&&D&&D.includes(k))return!0}while(b.vf(29));return!1}chm(b){var k=b.Rb(1);b.uc();
b=b.iF(1);if(!k||!b)return null;k=Gf.SelectionFactory.pcl(k,b);b=hf.SelectionEditor.Cj(k,!1,!1);return hi.a.akb&&!b?null:Gf.SelectionFactory.jA(k,b.Qc)}rOc(){const b=this.Wc.xk();b.set(this.qx.value);this.Vvb.eP(b);return b.Rb(28)&&b.Rb(29)?b:null}I$h(){const b=this.Wc.xk();b.set(this.qx.value);this.Vvb.eP(b);return b.Rb(28)?b:null}t8h(b){const k=this.rOc();if(!k||!b||!this.RPc(k,b,!1))return null;k.Qd();k.Qd();k.Qd();b=k.currentNode;return pe.ParagraphReader.Wb(b)?b:null}iSl(){const b=this.rOc();
return this.RPc(b,lt.a.ePh,!0)?b.currentNode.getValue(Cc.a.PPc):null}}Object(n.a)(Sb,"GlossaryNavigator",null,[505]);class uc{constructor(b,k,t,D,P,ca){this.jr=b;this.Qg=k;this.Zl=t;this.eb=D;this.oh=P;this.Pea=ca}C6c(b,k,t){if(!this.Pea)return 1;if(!({tableNode:P}=this.tGf(b)).returnValue||!this.oh.tBi(P,k)||this.I8i(b,k))return 2;var D=this.oh.j3h(k);var P=D.J(0).S6b();P&&P.count||(P=new Eb.a,P.add(b.objectId));b=this.Qg.ZPh(D);t=t.split("\n");k=Object(Ka.a)(ze.GraphIterator,this.Qg.Uqf(k));k=this.Qg.loh(k,
b,t.length);for(b=0;b<k.count;++b){D=k.J(b);this.jr.replaceTextRange(Of.a.createTextRange(D,0,0),t[b]);for(let ca=0;ca<P.count;++ca)this.jr.xta(D,P.J(ca),0,!0,!0),this.jr.xta(D,P.J(P.count-ca-1),D.characterData.length,!0,!1)}return 0}I8i(b,k){if(!this.Pea)return 1;let t;if(!({tableNode:t}=this.tGf(b)).returnValue||!this.oh.tBi(t,k))return 2;k=this.oh.j3h(k);if(0<k.count&&(k=this.Zl.SK(Of.a.create(k.J(0)),Of.a.create(k.J(k.count-1)),2)))for(const D of k)if(D.id!==b.id&&!this.Zl.dya(D,!0))return 2;
return 0}Abc(b){if(!this.Pea||!({tableNode:t}=this.tGf(b)).returnValue)return!1;b=b.Pmf();for(var k of b)if(!k.aha||!k.isSupported)return!1;if(this.oh.UFm(t))return!1;var t=Object(Ka.a)(ze.GraphIterator,this.Qg.Uqf(t));k=new Eb.a;this.eb.Jhb(t,!0,!1,k);for(const D of k)if(0<D.ia(Cc.a.OCb,0)||this.eb.l1a(D).Hx)return!1;return!0}tGf(b){let k=null;return b&&b.iu.toString()===b.iz.toString()&&b.isValid()&&b.isEditable&&b.isSupported?(k=this.Qg.Ut(b.iu))&&14===k.type?{returnValue:!0,tableNode:k}:{returnValue:!1,
tableNode:null}:{returnValue:!1,tableNode:k}}}Object(n.a)(uc,"TableContentControlEditor",null,[504]);class sc{UFm(b){let k=!1;const t=new ze.GraphIterator;t.set(b);mh.forEachCellInTable(t,D=>{if(!yh.TableCellReader.gg(D)){let P=vi.OutlineNavigator.T8(D);for(;P;){if(va.OutlineElementReader.IQc(D))return k=!0,!1;P=D.xi(1)}}return!0});return k}tBi(b,k){const t=new ze.GraphIterator;t.set(k);return yh.TableCellReader.Nwa(k)&&t.zb(14)&&t.hd(14).id===b.id?!0:!1}j3h(b){const k=new Eb.a,t=new ze.GraphIterator;
t.set(b);b=new Eb.a;pe.ParagraphReader.Jhb(t,!0,!1,b);for(const D of b)k.add(D);return k}}Object(n.a)(sc,"TableReader",null,[253]);class Gc{constructor(){this.Zl=null}get name(){return"WordEditor.ContentControl"}init(){w.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled")&&(RA.a.kSa(Object(A.a)(Fa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),Fa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").Nkn,"onContentControlRangeChanged")),this.Zl=
Fa.a.instance.Na("WordEditor.ContentControl.IContentControlOperator"),Fa.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init(),Fa.a.instance.resolve("WordEditor.ContentControl.GlossaryEditor").init())}dispose(){this.Zl&&(this.Zl.dispose(),this.Zl=null)}xc(b){b.ha("WordEditor.ContentControl.Perf.IPerfLogger",()=>new zC.a($d.a.$e)).singleInstance();b.ha("WordEditor.ContentControl.ContentControlFactory",()=>new VA(Fa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").singleInstance();
b.ha("WordEditor.ContentControlNodeFactory",()=>new SA(Fa.a.instance.Sa("Box4.ContentControlConfigSettings"),Fa.a.instance.Sa("Box4.ContentControl.IContentControlOperator"))).singleInstance();b.ha("WordEditor.ContentControl.ContentControlGraphManager",()=>new f(new Rg.a(()=>Wa.App.ya.gb.Uc),new Rg.a(()=>Wa.App.ya.gb.Uc.od),new mk.a,Wk.PageNavigator.instance,Fa.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Fa.a.instance.resolve("Box4.IOutlineEditor"),Fa.a.instance.resolve("Box4.IOutlineElementEditor"),
Fa.a.instance.resolve("Box4.IParagraphReader"),Fa.a.instance.resolve("WordEditor.IParagraphSplitHelper"),Fa.a.instance.Sa("Box4.ContentControlConfigSettings"),Fa.a.instance.resolve("Box4.ContentControlParagraphMapping"),Fa.a.instance.Sa("WordEditor.ContentControl.GlossaryEditor"),Fa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"))).as("WordEditor.ContentControl.IContentControlGraphManager").singleInstance();b.ha("WordEditor.ContentControl.GlossaryNavigator",()=>new Sb(new mk.a,
new Rg.a(()=>Wa.App.ya.gb.Uc),Wk.PageNavigator.instance)).as("WordEditor.ContentControl.IGlossaryNavigator").singleInstance();b.ha("WordEditor.ContentControl.ContentControlOperator",()=>new sb(new Rg.a(()=>Wa.App.ya.gb.Uc),new Rg.a(()=>Wa.App.ya.gb.Uc.od),Fa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Fa.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Fa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),af.a.instance,Fa.a.instance.resolve("Box4.ISelectionFactory"),
Yg.PageReader.instance,Fa.a.instance.resolve("Box4.IFormattingEditor"),Fa.a.instance.resolve("Box4.Styles.IWACStyleReader"),w.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"),Fa.a.instance.Na("Box4.IContentControlDataChangedManager"),w.AFrameworkApplication.va,Fa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),w.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Fa.a.instance.resolve("Box4.IContentControlChpHelper"),Fa.a.instance.Sa("Box4.ContentControlConfigSettings"),
Fa.a.instance.Na("Box4.IContentControlReader"),Fa.a.instance.resolve("Box4.IParagraphReader"),Fa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Fa.a.instance.Sa("Box4.Actors.IVirtualSelectionMerger"),Fa.a.instance.resolve("Box4.IFeatureHelper"),Fa.a.instance.resolve("Box4.ContentControlParagraphMapping"),Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditor"),Fa.a.instance.Sa("WordEditor.Extension.RichApiEventManager"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").singleInstance();
b.ha("WordEditor.ContentControl.ContentControlManager",()=>new x(new Rg.a(()=>Wa.App.ya.gb.Uc),new Rg.a(()=>Wa.App.ya.gb.Uc.od),Fa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Fa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Fa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Fa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Fa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),
Fa.a.instance.Sa("Box4.ContentControlConfigSettings"),Fa.a.instance.resolve("Box4.IContentControlChpHelper"),Fa.a.instance.resolve("Box4.IContentControlAroundTableChecker"))).as("WordEditor.ContentControl.IContentControlManager").singleInstance();b.ha("WordEditor.ContentControl.ContentControlChpManager",()=>new Pz(Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Fa.a.instance.Sa("Box4.ContentControlConfigSettings"),Fa.a.instance.resolve("Box4.IParagraphReader"),Fa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").singleInstance();
b.ha("WordEditor.ContentControl.GlossaryEditor",()=>new Ir(Fa.a.instance.resolve("WordEditor.ContentControl.GlossaryNavigator"),Fa.a.instance.resolve("Box4.IOutlineElementEditor"),Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Fa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Fa.a.instance.resolve("Box4.TextFormattingHelper"),Fa.a.instance.resolve("Box4.IFormattingEditor"))).as("WordEditor.ContentControl.IGlossaryEditor").singleInstance();b.ha("WordEditor.ContentControl.TableContentControlEditor",
()=>new uc(Fa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Fa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Fa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Fa.a.instance.resolve("Box4.IParagraphReader"),new sc,w.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").singleInstance();w.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&
b.ha("Box4.ContentControlConverter",()=>new Pu(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").singleInstance();b.ha("WordEditor.ContentControl.ContentControlCCP",()=>new mu(b.resolve("WordEditor.ContentControl.ContentControlOperator"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"),b.resolve("Box4.TrackChange.ITrackChangeEditor"))).singleInstance();b.ha("WordEditor.ContentControl.ContentControlFormattingManager",()=>new It(new Rg.a(()=>Wa.App.ya.gb.Uc.od),Fa.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Fa.a.instance.resolve("Box4.Actors.TextFormattingActor"),Fa.a.instance.resolve("Box4.TextFormattingHelper"),w.AFrameworkApplication.K)).as("WordEditor.ContentControl.IContentControlFormattingManager").singleInstance()}static main(){N.a.instance.Fc(new Gc)}}
Object(n.a)(Gc,"ContentControlPackage",null,[1,2]);var zd=c(1396),Zd=c(526),Te=c(1742),Yc=c(772);class Nd{constructor(b){this.contextualIntentInvocationSource=10;this.contextualIntentInvocationSource=b}}Object(n.a)(Nd,"UxManagerMenuActionTelemetryData",null,[]);class Tf extends Sys.EventArgs{constructor(b,k,t){super();this.definition=b;this.source=k;this.b1k=t}}Object(n.a)(Tf,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class gh extends Sys.EventArgs{constructor(b,k){super();this.definition=b;this.source=
k}}Object(n.a)(gh,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class lf{constructor(b,k,t,D,P,ca,ta=!1,Na=null,qb=null,Jb=null,Vb=!1,ac=null,yc=!1,Kc=!0,ed=null,sd=!1,oe=10){this.target=this.container=this.menu=null;this.isDismissed=!1;this.s_c=this.c_c=this.JXh=this.onScroll=this.onResize=this.t0=this.nxa=this.wGa=this.documentElement=this.DR=this.editingElement=null;this.isFocused=!1;this.IId=null;this.CYf=this.UCf=!1;this.Kne=null;this.B$d=0;this.paragraphNode=b;this.cpBegin=k;this.cpEnd=t;this.definition=
D;this.Xok=P;this.BQa=ca;this.UNa=ta;this.pqj=Na;this.Fma=qb;this.hostServices=Jb;this.yto=Vb;this.LYi=ac;this.Dqj=yc;this.Sml=Kc;this.JXh=ed;this.showDictationCommandUx=sd;this.source=oe}}Object(n.a)(lf,"UxManagerState",null,[]);var Ug=c(1605);class Ah{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb){this.Ub=b;this.ib=k;this.Iz=t;this.fd=D;this.ae=P;this.Hb=ca;this.Ui=ta;this.rk=Na;this.BI=qb;this.GSb=Jb;this.TRe=!1;this._state=this.f1g=null;this.shouldIgnoreFocusEvent=Vb=>{var ac;return this.fd.Bd.oz&&!this.fd.Bd.rU&&
Vb===(null===(ac=this.fd.editingView)||void 0===ac?void 0:ac.editingElement)};this.ra=new Ue.a;this.yud=new cb.a;this.wzd((Vb,ac)=>{Ah.M2m(t,ac.definition,ac.source)});this.yph((Vb,ac)=>{Ah.L2m(t,ac.definition,ac.source,ac.b1k)});this.Ub.ge(Ah.CMd).OH=!0;w.AFrameworkApplication.va.qa(Nc.a.uJc,lc.a.view,this.uJc.bind(this))}wzd(b){this.ra.addHandler(Ah.CMf,b)}G5f(b){this.ra.removeHandler(Ah.CMf,b)}XLn(b,k){this.ra.raiseEvent(Ah.CMf,new gh(b,k))}yph(b){this.ra.addHandler(Ah.BMf,b)}RZn(b){this.ra.removeHandler(Ah.BMf,
b)}WLn(b,k,t){this.ra.raiseEvent(Ah.BMf,new Tf(b,k,t))}WWo(b){var k;if(!b.isDismissed&&b.DR){var t=Ug.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(t&&t.length){t=Ug.b(t);var D=$d.a.getElementBounds(b.DR);t.width||t.height?t.x+t.width<D.x||t.x>D.x+D.width||t.y+t.height<D.y||t.y>D.y+D.height?this.dismiss():(D=b.target,D.style.left=t.x+"px",D.style.top=t.y+"px",D.style.width=t.width+"px",D.style.height=t.height+"px",null===(k=b.menu)||void 0===k?void 0:k.updatePosition(),b.menu||v.ULS.sendTraceTag(512255777,
341,50,"Menu is null so can't update position")):(v.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else v.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}P4i(b){b.isDismissed||b.Kne||(b.Kne=new Df.a(2,1,1,()=>{b.Kne=null;this.WWo(b)},147),this.Hb.Vb(b.Kne))}wGa(b,k){!b.isDismissed&&b.Sml&&0<k.GJ.length&&(this.dismiss(),v.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}oAk(b){return!!b&&
b.id===Ah.$ok}nxa(b,k){if(b.isDismissed||!k||!k.Gb)return!1;k=k.Gb;const t=k.keyCode,D=!b.isFocused&&!!b.menu,P=k.altKey||k.ctrlKey||k.shiftKey;let ca=!1;t===pc.a.t1?(this.dismiss(),v.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),ca=!0):t!==pc.a.zs&&t!==pc.a.ww||!D||P||!this.oAk(b.definition)?t!==pc.a.nqb&&t!==pc.a.Gmc||!D||P||(this.X0f(b),b.menu?(b.menu.focus(),ca=!0,v.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):v.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(b.menu.executeDefaultAction(),v.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),ca=!0);ca&&(k.preventDefault(),k.stopPropagation());return ca}c_c(b,k){if(b.isDismissed||!b.menu)return v.ULS.sendTraceTag(512255776,341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.invokeBadgeId(k);v.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}s_c(b,k){if(b.isDismissed||!b.menu)return v.ULS.sendTraceTag(512255775,
341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.executeActionFromString(k);v.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}t0(b,k){if(b.isDismissed||!k||!k.Gb||!b.menu)return v.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!k,!(null===k||void 0===
k?0:k.Gb),!b.menu),!1;const t=b.target;b=b.menu.getElementBounds();var D=k.Gb;k=D.clientX;D=D.clientY;t&&Ah.G0i(k,D,$d.a.getElementBounds(t),16)||b&&Ah.G0i(k,D,Ah.GKk(b),4)||this.dismiss();return!1}xno(b){var k=Ug.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!k||!k.length)return!1;k=Ug.a(k,"OfficeContextualTarget");if(!k)return!1;b.container=Ah.NHc();b.target=k;b.editingElement=this.fd.editingView.editingElement;b.DR=this.fd.Bd.container;b.documentElement=document.documentElement;b.wGa=(t,D)=>{this.wGa(b,
D)};b.nxa=t=>this.nxa(b,t);b.t0=t=>this.t0(b,t);b.onScroll=()=>{this.P4i(b)};b.onResize=()=>{this.P4i(b)};b.showDictationCommandUx&&(b.c_c=t=>this.c_c(b,t),b.s_c=t=>this.s_c(b,t),this.GSb&&this.GSb.execute(t=>{t.Vio(b.c_c);t.Xio(b.s_c)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.ib.Lw(b.wGa);this.Ui.VZ(b.onResize);this.ae.lb(Rc.a.XF,b.editingElement,b.nxa);b.UNa&&this.rk.lb(Rc.a.lca,b.documentElement,b.t0);vf.a.addHandler(b.DR,"scroll",b.onScroll);b.BQa||this.X0f(b);
return!0}mFb(b,k){const t=!!b.menu;this.WLn(b.definition,b.source,k);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.Ub.currentScope.name===Ah.CMd&&this.Ub.yR(Ah.CMd);b.wGa&&this.ib.CY(b.wGa);b.nxa&&b.editingElement&&this.ae.rc(Rc.a.XF,b.editingElement,b.nxa);this.GSb&&this.GSb.execute(D=>{b.showDictationCommandUx&&(D.T3n(),D.U3n());D.Lkj(!1,b.showDictationCommandUx)});b.t0&&b.documentElement&&b.UNa&&this.rk.rc(Rc.a.lca,b.documentElement,
b.t0);b.onScroll&&b.DR&&vf.a.removeHandler(b.DR,"scroll",b.onScroll);b.onResize&&this.Ui.Jca(b.onResize);b.menu=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.DR=null;b.wGa=null;b.nxa=null;b.t0=null;b.onScroll=null;b.onResize=null;b.c_c=null;b.s_c=null;t&&b.Fma&&(b.UCf?b.CYf=!0:b.Fma(b.IId))}F1a(b,k){var t;if(!k)return!1;switch(k.actionType){case np.b.Toggle:if(k.objectFulfillment===Ah.rIo)return this.TRe=!this.TRe,this.tmg(),this.qJc(b),!0;if(k.objectFulfillment===
Ah.vIo)return{value:t}=this.yud.Dc(k.suggestionGroup.type,!1),this.yud.Z(k.suggestionGroup.type,!t),this.qJc(b),!0;break;case np.b.GiveFeedback:if(Te.a.jHm(null===(t=k.suggestionGroup)||void 0===t?void 0:t.type)||Yc.a.dRm(k.objectName))break;this.focus();this.tmg();this.qJc(b);return!0;case np.b.RevealSuggestions:this.qJc(b)}b.UCf=!0;k=b.Xok.executeAction(k,b.paragraphNode,b.cpBegin,b.cpEnd);b.UCf=!1;k&&this.qJc(b);b.CYf&&(b.CYf=!1,b.Fma(b.IId),b.IId=null);return k}qJc(b){b.t0&&b.documentElement&&
b.UNa&&(this.rk.rc(Rc.a.lca,b.documentElement,b.t0),b.UNa=!1)}qro(b,k){return b.id===Zd.a.AXe?!1:!(0<=b.positionInSet&&0<b.setSize)&&!k}ZBj(b){var k;if(this.xno(b)){var t=1;w.AFrameworkApplication.K.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(t=3);var D=!1;0<(null===(k=b.definition.suggestionGroups)||void 0===k?void 0:k.length)&&(D=b.definition.suggestionGroups[0].type,D=this.yud.nb(D)?this.yud.J(D):b.yto);k=!1;w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",
!1)&&(k=!0);t={containerElement:b.container,targetElement:b.target,definition:b.definition,onAction:P=>this.F1a(b,P),onDismiss:P=>{this.mFb(b,P)},keepCurrentFocus:b.BQa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.TRe,showDescription:D,showEditorButton:b.Dqj,showEditorBranding:this.qro(b.definition,b.Dqj),hostServices:b.hostServices,maxSuggestionGroupNumber:t,renderFooterIcons:k,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.JXh,showDictationCommandUx:b.showDictationCommandUx,
editingElement:b.editingElement};b.LYi&&b.LYi(t);this.Iz.createContextualUi(t).then(P=>{this.XLn(b.definition,b.source);b.menu=P;v.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.pqj&&b.pqj();this.GSb&&9!==b.source&&this.GSb.execute(ca=>ca.Lkj(!0,b.showDictationCommandUx))}).catch(P=>{this.mFb(b,{V$o:zd.a.Unknown});v.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",P)});0<b.B$d&&v.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.B$d)}else 5<
++b.B$d?(v.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Hb.Vb(new Df.a(2,1,Math.pow(3,b.B$d),()=>{b.isDismissed||this.ZBj(b)},146))}get mF(){return!!this._state&&!this._state.isDismissed}set sge(b){this.f1g=b}get bMm(){return this.f1g}Olg(b,k){this.mF&&(this._state.cpBegin=b,this._state.cpEnd=k)}get definition(){return this.mF?this._state.definition:null}set definition(b){this.mF&&(this._state.definition=b,this._state.menu&&
this._state.menu.setDefinition(b))}focus(){this.mF&&this._state.menu&&(this._state.isFocused||this.X0f(this._state),this._state.menu.focus())}tmg(){this.mF&&this._state.menu&&this._state.menu.updatePosition()}X0f(b){this.Ub.kL(Ah.CMd,!1);b.isFocused=!0}oqa(b,k,t,D,P,ca=null,ta=null,Na=null,qb=!1,Jb=null,Vb=!1,ac=!0,yc=null,Kc=!1,ed=10){if(!k||this._state&&!this._state.isDismissed)return!1;let sd,oe;if(!({paragraphNode:oe,start:b,end:sd}=Ah.KLo(b)).returnValue)return!1;this._state=new lf(oe,b,sd,k,
t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed);this.ZBj(this._state);return!0}Gic(b){this._state&&(this._state.IId=b)}uJc(b,k,t){if(1===t)return this.mF?32:0;this.mF&&this.dismiss();return 32}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.menu)||void 0===b?void 0:b.dismiss())}static M2m(b,k,t){t=new Nd(t);b.logAction({actionType:np.b.SessionStart,engagement:np.a.Try,objectName:Ah.kxj,objectId:k.id,data:t});if(k.suggestionGroups)for(const D of k.suggestionGroups)b.logAction({actionType:np.b.Presented,
engagement:np.a.See,objectName:D.type,objectId:D.id,data:t})}static L2m(b,k,t,D){t=new Nd(t);b.logAction({actionType:np.b.SessionEnd,engagement:np.a.None,objectName:Ah.kxj,objectId:k.id,data:t},D)}static NHc(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static GKk(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static G0i(b,k,t,D){const P=t.y-D,ca=t.x+t.width+D,ta=t.y+t.height+D;return t.x-D<=b&&b<=ca&&P<=k&&k<=ta}static KLo(b){let k,t;if(!b||!pe.ParagraphReader.Wb(b.node)||
b.contextId!==lc.a.Tc&&b.contextId!==lc.a.Hd&&b.contextId!==lc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};t=b.node;b.contextId!==lc.a.paragraph?(k=b.cpBegin,b=b.cpEnd):(k=0,b=t.characterData.length);return{returnValue:!0,paragraphNode:t,start:k,end:b}}Scc(){this.BI&&this.BI.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}Ah.$ok="ActionSet";Ah.kxj="IntentGroup";Ah.CMd="CanvasContextualUxReact";Ah.rIo="Context";Ah.vIo="Description";Ah.CMf="MenuDidOpen";Ah.BMf="MenuDidClose";
Object(n.a)(Ah,"UxManager",null,[]);class Jg{constructor(){this.W=null}get name(){return"WordEditor.CanvasContextualProvider"}xc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>{this.fn()})}fn(){w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const b=w.AFrameworkApplication.K.$("EditorGoalsEnabled"),k=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0)&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",
!1);(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(63)||w.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")||w.AFrameworkApplication.K.$("RewriteIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.W.resolve("Common.IDynamicScriptLoaderProvider").Kz.loadScript("canvasContextual")).then(()=>{this.W.ha("CanvasContextual.ICanvasContextualController",
()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:w.AFrameworkApplication.uiCulture,dataCulture:w.AFrameworkApplication.dataCulture,isRightToLeft:w.AFrameworkApplication.isRtl,ulsLogger:new vk.a,dimeCallback:async()=>{this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").launchUpsellExperience("editorinword")},loadUpsellDependencies:async()=>{this.W.Sa("Common.IInProductMessagingUIManager").execute(t=>{t.MFi()})},getSoftPaywallData:()=>this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),
getPremiumPreviewCritiquesList:()=>this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),logSystemInitiatedFeedback:async t=>{this.W.Sa("Common.ISystemInitiatedFeedback").execute(D=>D.logActivity(t,null))}})).singleInstance();this.W.ha("WordEditor.CanvasContextualProvider.UxManager",()=>new Ah(ad.FocusManager.instance(),this.W.resolve("Box4.ISelectionManager"),this.W.resolve("CanvasContextual.ICanvasContextualController"),Lb.InteractiveViewManager.instance,Zb.KeyInputManager.instance,
w.AFrameworkApplication.nc,w.AFrameworkApplication.ta,w.AFrameworkApplication.ta.f1,this.W.Sa("Common.ISystemInitiatedFeedback"),this.W.Sa("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).singleInstance();this.W.resolve("CanvasContextual.ICanvasContextualController");this.W.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.W.ha("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:w.AFrameworkApplication.uiCulture,
ulsLogger:new vk.a})).singleInstance(),this.W.resolve("CanvasContextual.IEditorInitializer").init(),this.W.ha("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new vk.a})).singleInstance(),this.W.resolve("CanvasContextual.ISkittleControllerV2"),k&&(this.W.ha("CanvasContextual.IAIFeedbackSkittleController",()=>canvasContextual.FactoryGlobal.getAIFeedbackSkittleControllerInstance({ulsLogger:new vk.a})).singleInstance(),this.W.resolve("CanvasContextual.IAIFeedbackSkittleController")))}).catch(t=>
{v.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",t)})}dispose(){}static main(){N.a.instance.Fc(new Jg)}}Object(n.a)(Jg,"PackageManager",null,[1,2]);class Vi{constructor(b,k,t,D){this.aAm=(P,ca,ta)=>{P=null;ca.view.qe&&(P=ca.view);if(!P||!P.mb)return 8;if(!this.sI.NDf())return 2;if(1===ta)return 32;this.Xdk.J8k();return 32};this.ILi=(P,ca,ta)=>{let Na=null;ca.view.qe&&(Na=ca.view);if(!Na||!Na.mb)return 8;if(!this.sI.NDf())return 2;
if(1===ta)return 32;if(1!==this.sI.q8b(this.ib.hb,!0).count)return 2;ca=new Xd.GraphTransaction(15);try{if(ca.Cb(Na.ed),!this.sI.MMo(P===Nc.a.cMf))return 8}finally{ca&&ca.dispose()}return 32};this.ga=b;this.ib=k;this.sI=t;this.Xdk=D}Tb(){this.ga.qa(Nc.a.uWd,lc.a.view,this.aAm);this.ga.qa(Nc.a.cMf,lc.a.view,this.ILi);this.ga.qa(Nc.a.JLi,lc.a.view,this.ILi)}}Object(n.a)(Vi,"IntelligentPlaceholderActor",null,[]);class xh{constructor(){this.Uoc=new cb.a;this.xfd=new cb.a}Opk(b,k){let t;({value:t}=this.Uoc.Dc(b,
t)).returnValue||this.Uoc.Z(b,t=new Ca.a);t.add(k)}tqk(b,k){this.xfd.nb(b)&&v.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.xfd.Z(b,k)}Mpk(b,k,t){this.Opk(b,k);this.tqk(k,t)}vMl(b){let k;return({value:k}=this.Uoc.Dc(b,k)).returnValue?k:null}lPl(b){let k;return({value:k}=this.xfd.Dc(b,k)).returnValue?k:null}AZn(b){let k;if(({value:k}=this.Uoc.Dc(b,k)).returnValue){for(const t of k)this.xfd.remove(t);this.Uoc.remove(b)}else v.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}
Object(n.a)(xh,"IntelligentPlaceholderAtMentionManager",null,[525]);var Wi=c(1658);class ki extends Wi.a{constructor(b,k){super(b,k)}get key(){return"FOLLOW UP"}get Pw(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}Spj(b){return!b.ia(Cc.a.CG,!1)}lhb(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(n.a)(ki,"IntelligentPlaceholderDetailsProvider",Wi.a,[]);var si=c(1798),Bj=c(2E3),vh=c(1802);class Eo{constructor(){this.Wza=""}Wga(b){this.Wza+=b}wri(b){this.Wza+=
b}cAf(b){this.Wza+=b}insertImage(b){this.Wza+=b}dri(b){this.Wza+=b}}Object(n.a)(Eo,"PlainTextFormatCreator",null,[881]);var Sd=c(1595),je=c(1999);c(361);var gj=c(1657),fr=c(1495);class Yp{constructor(){this.urc=new cb.a}contains(b){return this.urc.nb(Yp.EHf(b))}add(b){this.urc.Z(Yp.EHf(b),b)}remove(b){this.urc.remove(Yp.EHf(b))}MOo(b){for(const k of b.urc)this.add(k.value)}EXh(){const b=new Eb.a;for(const k of this.urc)b.add(k.value.Wj);return b}static EHf(b){return b.Wj.toString()}}Object(n.a)(Yp,
"CommentRangeSet",null,[]);class Bq extends Sys.EventArgs{constructor(b){super();this.commentNode=b}}Object(n.a)(Bq,"OnFollowUpEventArgs",Sys.EventArgs,[]);class Am extends Bq{constructor(b,k){super(b);this.kBn=k}}Object(n.a)(Am,"OnCreateEventArgs",Bq,[]);class ot extends Bq{constructor(b,k){super(b);this.cPm=k}}Object(n.a)(ot,"OnResolveEventArgs",Bq,[]);var bA=c(217);class Ww{}Ww.cqe="MentionExperienceDegraded";Object(n.a)(Ww,"AtMentionsConstants",null,[]);class hz{constructor(b,k,t,D,P,ca,ta,Na,
qb,Jb){this.GYc=b;this.vGk=k;this.W9c=t;this.FCd=D;this.mb=P;this.yo=ca;this.LWd=ta;this.fsi=Na;this.su=qb;this.Z0b=Jb;this.ORa=null;this.Wqn=(Vb,ac,yc)=>{v.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");Vb=this.LWd.n2a(Vb,yc.displayName,yc.email,yc.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,ac),!0);Vb?v.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.Z0b.logKpiFailure("LPPWordEditorKPI",
"FailedToInsertAtMention",{isInternal:!0},{name:Ww.cqe,isInternal:!0})};this.Hpn=(Vb,ac)=>{v.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");ac&&this.Z0b.Hv(Nc.a.qSk);this.LWd.omm(Vb.id,ac)};this.Cln=()=>{this.yo.Bd.oz&&!this.yo.Bd.rU&&this.yo.editingView.hgf?this.$Ah=!0:(this.GYc.reset(),v.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))};this.hsn=()=>{v.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.Qsk()};this.Gpn=(Vb,ac,yc,Kc=
new Map)=>{Kc=Object.assign(new Db.a,{extendedProperties:Kc});this.Z0b.logKpiFailure("LPPWordEditorKPI",Vb,{isIntentional:ac,isInternal:yc,additionalValues:Kc},{name:Ww.cqe,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:ac,isInternal:yc,additionalValues:Kc})};(b=Fa.a.instance.Na("Box4.IEditStateEventManager"))&&b.addHandler(bA.a.Bta,this.q5n.bind(this))}FZd(){return!!this.ORa}q5n(){this.FZd()&&this.$Ah&&(this.ORa.updateInputText(this.FWc,!1),this.$Ah=!1)}ariaNotify(b,k){this.su.sendNotification(b,
k)}Qsk(){const b=this.yo.editingView.editingElement;if(b){var k=b.getAttribute(df.a.rEc);b.setAttribute(df.a.rEc,k?k.toString()+" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else v.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}SYn(){const b=this.yo.editingView.editingElement;if(b){var k=b.getAttribute(df.a.rEc);k?(k=k.toString().split(" "),Array.remove(k,"PeoplePickerAutomationID"),k.length?b.setAttribute(df.a.rEc,k.join(" ")):b.removeAttribute(df.a.rEc)):v.ULS.sendTraceTag(51218127,
323,50,"No aria-controls when dismissing picker?")}else v.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}bWk(){this.SYn();this.ORa&&this.ORa.updateInputText("a",!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.ORa=null;this.fsi.Ujj(!0)}wce(){this.GYc.q4f(()=>{this.bWk()});this.GYc.g4f((b,k)=>{this.FWc=b;if(this.ORa)1<this.FWc.length&&"@"===this.FWc.trimEnd()?(this.Z0b.Hv(Nc.a.pSk),this.GYc.reset()):this.ORa.updateInputText(this.FWc,!1);else if(this.Z0b.logKpiUsage("LPPWordEditorKPI",
0),this.Z0b.Hv(Nc.a.wun),(b=this.$Xl(k))&&b.height){k=b.y;const t=b.height,D=document.createElement("div");D.id="PeoplePicker";D.style.position="absolute";D.style.top=k-5+"px";D.style.left=b.x+"px";D.style.height=t+10+"px";document.body.appendChild(D);this.vGk.createPeoplePicker({editingElementId:this.yo.editingView.editingElement.id,containerElement:D,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:this.Wqn,onPermissionsReceivedCallback:this.Hpn,onDismiss:this.Cln,onShow:this.hsn,onFailure:this.Gpn}).then(P=>
{P.updateInputText(this.FWc,!1);this.ORa=P;this.fsi.Ujj(!1)})}});this.GYc.h4f(b=>{if(this.ORa)this.ORa.onKeyDown(b.Gb.rawEvent)})}$Xl(b){var k=this.mb.hb;if(!k)return null;k=k.kb;if(!k)return null;k=k.Qa;if(!k)return null;k=k.node;if(!k)return null;k=Object(Ka.a)(70,k);if(!k)return null;k=Object(Ka.a)(191,k.Qj(this.yo.Bd.ic));if(!k)return null;k=Object(Ka.a)(100,k);if(!k)return null;let t=null;try{t=this.W9c.a_(this.FCd.U6b(2,b),k,!1,!1,!1,!1)}catch(D){v.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",
D)}return t}}Object(n.a)(hz,"WordEditorAtMentionsHandler",null,[385]);var d=c(1486);class r{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed){this.ga=b;this.Wc=k;this.HLa=t;this.ib=D;this.Yp=P;this.Kd=ca;this.rD=ta;this.hld=Na;this.Ud=qb;this.qq=Jb;this.GVj=ac;this.ni=yc;this.Hc=Vb;this.ra=new Ue.a;this.ih=Kc;this.DLg=ed;fr.a.VZe((sd,oe)=>{this.CG(oe.commentNode,!0)&&this.ra.raiseEvent(r.k_c)})}Nph(b){this.ra.addHandler(r.JSi,b)}axk(b){this.ra.addHandler(r.VVi,b)}Iwk(b){this.ra.addHandler(r.von,
b)}VZe(b){this.ra.addHandler(r.k_c,b)}CG(b,k){let t=b.ia(Cc.a.CG,!1);k&&(t=t&&!b.ia(Cc.a.Maa,!1));return t}Iac(b){return this.Yp.Iac(b)}K3l(b){for(const k of b)for(const t of k)if(r.UGf(t.contextId))return t.node.Kc;return null}P$l(b,k,t){const D=new Yp,P=b.Kc;for(let ca=0;ca<b.pa.length;ca++){const ta=b.pa.J(ca);if(ta.cp>=k)break;if(ta.tf&&ta.tf.length)for(let Na=0;Na<ta.tf.length;Na++){const qb=ta.tf.J(Na);this.CG(P.Db(qb.Wj),t)&&(qb.Nc?D.add(qb):D.remove(qb))}}return D}Q$l(b,k,t,D){const P=new Yp,
ca=b.Kc;for(let ta=0;ta<b.pa.length;ta++){const Na=b.pa.J(ta);if(Na.cp>t)break;if(Na.tf&&Na.tf.length)for(let qb=0;qb<Na.tf.length;qb++){const Jb=Na.tf.J(qb);this.CG(ca.Db(Jb.Wj),D)&&(Jb.Nc?Na.cp<t&&P.add(Jb):Na.cp<=k&&P.remove(Jb))}}return P}tfi(b,k){let t;const D=b.node;b.contextId!==lc.a.paragraph?(t=b.cpBegin,b=b.cpEnd):(t=0,b=D.characterData.length);return t===b?this.P$l(D,t,k):this.Q$l(D,t,b,k)}lPc(b,k){return r.UGf(b.contextId)?this.tfi(b,k).EXh():new Eb.a}q8b(b,k){const t=new Yp;for(const D of b)for(const P of D)r.UGf(P.contextId)&&
t.MOo(this.tfi(P,k));return t.EXh()}NDf(){var b=this.ib.hb;if(!b||1!==b.length||1!==b.J(0).length)return!1;b=b.J(0).Qa.node;return pe.ParagraphReader.Wb(b)&&!pe.ParagraphReader.lua(b)&&this.Yp.mjb(this.ga,!0)?!0:!1}fri(b,k){if(!this.NDf())return null;if(this.Yp.mom())return v.ULS.sendTraceTag(592761861,323,15,"Placeholder insertion failed because of draft comment"),null;let t=!1;var D=this.ib.hb.J(0).Qa;D.contextId===lc.a.Tc?(b=b?hf.SelectionEditor.C3(D,!1):null)&&b.hy&&b.Qa.contextId===lc.a.Hd?this.ib.setSelection(b):
(this.Kd.replaceTextRange(D,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+" ",!0),this.ib.setSelection(Gf.SelectionFactory.GK(D.node,D.cpBegin,D.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):t=!0;this.ih.LBb||si.a.instance.lSc();b=this.Yp.dBb(this.ib.hb.kb);if(!b)return null;this.Iac(b)&&this.DLg.Hv($a.a.newComment,{succeeded:!0,D7a:29});var P=this.Wc.Uf(b);const ca=P.Rb(1);if(!ca||393229!==ca.Pc)return null;P=P.Rb(2);if(!P||
393230!==P.Pc)return null;this.Klg(b.Kc,b.id);this.ra.raiseEvent(r.JSi,new Am(b,k));t&&(k=D.node,D=D.contextId!==lc.a.paragraph?D.cpEnd:k.characterData.length,this.ib.setSelection(Gf.SelectionFactory.GK(k,D,D)));return b}uWd(b){return!!this.fri(!0,b)}zSc(b,k,t,D,P,ca){if(0>k)return!1;D="@"+D;const ta=D+" ",Na=new Xd.GraphTransaction(15);try{Na.Cb(b);this.Kd.replaceTextRange(Of.a.createTextRange(b,k,t),ta);this.Ud.qg&&(this.qq.l7e(b,k,k+D.length),this.qq.jqa(b,k+D.length,k+ta.length,1));const qb=this.rD.hG(Of.a.createTextRange(b,
k,k+D.length),"mailto:"+P,!1,!0,!1);if(!qb)return!1;const Jb=qb.Xv;if(!Jb)return v.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),!1;this.ib.setSelection(Gf.SelectionFactory.GK(b,k,k+D.length));const Vb=this.fri(!1,2);if(!Vb)return!1;ca&&this.hld.Mpk(ca,Jb,Vb.id);this.ib.setSelection(Gf.SelectionFactory.te(b,k+ta.length))}finally{Na&&Na.dispose()}return!0}n2a(b,k,t,D){const P=this.ib.sg;return hf.SelectionEditor.gf(P)?this.zSc(P.node,P.cpBegin-b,P.cpBegin,
k,t,D):!1}S6l(b){if(1===b.length&&b.J(0).hy&&(b=b.J(0).Qa,b.contextId===lc.a.Tc&&pe.ParagraphReader.Wb(b.node))){const k=b.node;for(let t=0;t<k.pa.length;t++){const D=k.pa.J(t);if(D.cp===b.cpBegin){b=D.lRd(!0,!0);if(0<b.length)return b[0].Wj;break}}}return null}VAb(b,k,t){return this.Yp.GHc(b,k,t).returnValue}DNd(b,k,t,D,P){let ca=!1;const ta=b.characterData;if(k>=ta.length||t>ta.length||t<k)return{returnValue:!1,AOa:ca};let Na=k,qb=null;for(let Vb=0;Vb<b.pa.length;Vb++){const ac=b.pa.J(Vb),yc=ac.cp;
if(!(yc<k)){if(ac.Om&&qb)try{const Kc=ta.substring(Na,yc),ed=new Bj.a;ed.fullName=Kc.startsWith("@")?Kc.substr(1):Kc;gj.a(qb,ed);const sd=new vh.a;gj.b(qb,sd);P&&(sd.contentId=this.GVj.hmf());D.cAf(Kc,ed,sd);ca=!0;qb=null;Na=yc}catch(Kc){var Jb=Object.assign(new Db.a,{extendedProperties:new Map});Jb.extendedProperties.set("exception",Kc.message);this.DLg.logKpiFailure("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,additionalValues:Jb},{name:Ww.cqe,isInternal:!0,additionalValues:Jb})}yc<=
t&&!qb&&(Jb=Math.min(yc,t),Jb>Na&&D.Wga(ta.substring(Na,Jb)),Na=yc);ac.hyperlink&&ac.hyperlink.BG&&(qb=ac.hyperlink);if(yc>=t)break}}return{returnValue:!0,AOa:ca}}u3h(b,k,t,D,P=-1){var ca=!1,ta=b.Db(k),Na=b.Db(d.k(ta));ta=b.Db(d.h(ta));P=0<P?P:Number.MAX_VALUE;b=this.VAb(Na,k,!0);k=this.VAb(ta,k,!1);if(-1===b||-1===k)return{returnValue:!1,AOa:ca};if(Na===ta)return this.DNd(Na,b,k,t,D);const qb=this.HLa.uua(Na,!1,!1);if(!qb)return{returnValue:!1,AOa:ca};Na=new Eb.a;let Jb=0;do Na.add(qb.Ax),Jb+=qb.Ax.characterData.length;
while(qb.Ax!==ta&&qb.zba()&&Jb<P);for(P=0;P<Na.count;P++)if(ca=Na.J(P),ta=ca.characterData,P)if(P===Na.count-1){if(!({AOa:ca}=this.DNd(ca,0,k,t,D)).returnValue)return{returnValue:!1,AOa:ca}}else{if(!({AOa:ca}=this.DNd(ca,0,ta.length,t,D)).returnValue)return{returnValue:!1,AOa:ca};t.Wga("\n")}else{if(!({AOa:ca}=this.DNd(ca,b,ta.length,t,D)).returnValue)return{returnValue:!1,AOa:ca};t.Wga("\n")}return{returnValue:!0,AOa:ca}}CNd(b,k){const t=new Eo;return this.u3h(b,k,t,!1,-1).returnValue?t.Wza:null}YKd(b,
k){var t=b.Db(k);if(!t)return null;b=b.Db(d.h(t));if(!b)return null;k=this.VAb(b,k,!1);if(-1===k)return null;t=b.characterData;if(k>=t.length||!F.a.$ba(t.charAt(k))){t=this.Hc.Mc(15);try{t.Cb(b),this.Kd.replaceTextRange(Of.a.Rc(b,k)," ")}finally{t&&t.dispose()}}return Gf.SelectionFactory.te(b,k+1)}Klg(b,k){const t=b.Db(k),D=new Sd.a;this.u3h(b,k,D,!0).returnValue&&(D.Wga("\n"),this.Yp.VDj(t,D.u$),this.ra.raiseEvent(r.ytn))}Dao(b,k){for(const t of b){if(t.contains(k))return!0;for(const D of t)for(const P of k)if(D.node===
P.node&&D.Aj>=P.Aj)return!0}return!1}JPh(b,k,t,D,P){const ca=this.ib.hb.clone(),ta=new Ky.a(Wa.App.ya.gb.wc);b=Gf.SelectionFactory.te(b,k);t=Of.a.Rc(t,D);b=Gf.SelectionFactory.jA(b,t);this.ib.setSelection(b);t=!this.Dao(ca,b);return 32===this.ga.Nf(ta,Pb.a.zH,2,!0,null,null)?(t?this.ib.HY(ca):P!==X.a.nil&&(P=this.YKd(this.ni.value,P),this.ib.setSelection(P)),!0):!1}AXn(b,k){var t=b.Db(k);const D=b.Db(d.k(t));b=b.Db(d.h(t));if(D===b){t=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;
var P=D.characterData.indexOf(t);-1!==P&&this.JPh(D,P,b,P+t.length,k)}}SPh(b,k,t){var D=b.Db(k);if(!D)return!1;const P=b.Db(d.k(D));b=b.Db(d.h(D));D=this.VAb(P,k,!0);const ca=this.VAb(b,k,!1);if(-1===D||-1===ca||!this.JPh(P,D,b,ca,X.a.nil))return!1;t&&this.aQh(k);return!0}aQh(b){this.Yp.j5f(b,!0)}MMo(b){var k=this.K3l(this.ib.hb);if(!k)return!1;const t=this.q8b(this.ib.hb,!0);if(1!==t.count)return!1;const D=k.Db(t.J(0));if(b)k=this.SPh(k,t.J(0),!1);else{const P=d.k(D),ca=d.h(D);X.a.Zp(P,ca)||v.ULS.sendTraceTag(592487139,
323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.x5k(t.J(0));k.Db(P).Tk(16,!0);k=!0}k&&(D.setValue(Cc.a.Maa,!0),this.ra.raiseEvent(r.VVi,new ot(D,b)));return k}Vvh(b,k){b=this.q8b(this.ib.hb,!1);k.Ko[r.ARh]=!!b.count}aUi(b,k){if(k.Ko[r.ARh]&&pe.ParagraphReader.Wb(k.clone)&&(k=k.clone,b=k.Kc)&&(k=Of.a.createTextRange(k,0,k.characterData.length),k=this.lPc(k,!1),k.count))for(const t of k)(k=b.Db(t))&&k.setValue(Cc.a.CG,!1)}WQl(b,k,t){let D;const P=({XFc:qb}=this.Yp.GHc(k,
t,!0)).returnValue;t=({XFc:D}=this.Yp.GHc(k,t,!1)).returnValue;let ca=null,ta=-1,Na=-1;for(;qb<D;qb++){const Jb=k.pa.J(qb);if(Jb.hyperlink&&Jb.hyperlink.BG&&Jb.hyperlink.Xv===b){ca=Jb.hyperlink;ta=Jb.cp;break}}if(!ca||ta<P)return{returnValue:!1,EJh:ta,DJh:Na};for(b=qb;b<k.pa.length;b++){var qb=k.pa.J(b);if(qb.cp>t)break;if(qb.jU){Na=qb.cp;break}}return{returnValue:-1!==Na,EJh:ta,DJh:Na}}zYn(b){var k=this.hld.lPl(b);if(k){var t=null;Wa.App.ya&&(t=Wa.App.ya.gb.Uc.od);if(t){var D=t.Db(k);k=t.Db(d.k(D));
var P=t.Db(d.h(D));if(k!==P)v.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({EJh:b,DJh:P}=this.WQl(b,k,D.id)).returnValue){var ca=new Xd.GraphTransaction(7);try{ca.Cb(k);const ta=Of.a.createTextRange(k,b,P);this.Kd.replaceTextRange(ta,"");this.Klg(t,D.id)}finally{ca&&ca.dispose()}this.ib.hb&&0<this.ib.hb.length?(t=this.ib.hb.J(0).Qa,t.node===k?v.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",t.cpBegin,b):v.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):
v.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.ib.setSelection(Gf.SelectionFactory.te(k,b))}else v.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else v.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else v.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}omm(b,k){if(!k){k=this.hld.vMl(b);if(!k){v.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");
return}for(const t of k)this.zYn(t)}this.hld.AZn(b)}oKl(){si.a.instance.lSc();const b=new Eb.a;for(const t of this.Yp.e0e)if(t.Tq!==je.a.beingCreated){var k=X.a.If(t.objectId);k=this.ni.value.Db(k);this.CG(k,!0)&&b.add(k)}return b}dao(b){b=this.Yp.Ftf(b);this.ib.setSelection(b)}x5k(b){b?this.ni.value.Db(b).setValue(Cc.a.CG,!1):v.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static UGf(b){return b===lc.a.Hd||b===lc.a.Tc||b===lc.a.paragraph}}r.ARh="DisableNestedIntelligentPlaceholder";
r.JSi="CreateIntelligentPlaceholder";r.VVi="ResolveIntelligentPlaceholder";r.ytn="UpdateIntelligentPlaceholder";r.k_c="DeleteIntelligentPlaceholder";r.von="MentionAddedToFollowUpEventKey";Object(n.a)(r,"IntelligentPlaceholderEditor",null,[521,522,523]);class C{constructor(b,k,t,D){this.nsa=!1;this.Fs=!0;this.ae=null;this.aNa=P=>{if(!this.Fs||!this.lRk(P,this.ib.hb))return!1;P.Gb.preventDefault();P.Gb.stopPropagation();this.fd.Bd&&this.fd.Bd.HKc(!1);P=this.YKd(this.ib.hb);if(!P)return!1;this.ib.setSelection(P);
return!0};this.fd=b;this.ni=k;this.ib=t;this.v6=D}Odb(b,k){this.nsa||(b.swa?(this.Pdb(k),this.nsa=!0):b.Xea(()=>{this.nsa||(this.Pdb(k),this.nsa=!0)}))}dispose(){this.ae&&this.ae.rc(Rc.a.XF,this.fd.editingView.editingElement,this.aNa)}Pdb(b){this.ae=b;this.fd.Bd.Vi&&this.ae.lb(Rc.a.XF,this.fd.editingView.editingElement,this.aNa)}lRk(b,k){if(b.Gb.keyCode!==pc.a.ww&&b.Gb.keyCode!==pc.a.zs||1!==k.length||!k.J(0).hy)return!1;var t=this.v6.q8b(k,!0);if(1!==t.count)return!1;const D=k.J(0).Qa.node;if(!pe.ParagraphReader.Wb(D))return!1;
b=this.v6.VAb(D,t.J(0),!0);t=this.v6.VAb(D,t.J(0),!1);return k.J(0).Qa.cpBegin<b||k.J(0).Qa.cpEnd>t?!1:!0}YKd(b){b=this.v6.q8b(b,!0);if(1!==b.count)return null;b=b.J(0);return this.v6.YKd(this.ni.value,b)}Ujj(b){this.Fs=b}}Object(n.a)(C,"IntelligentPlaceholderKeyboardListener",null,[520,9]);class T{constructor(b,k){this.IBm=t=>{1===t&&this.ga.processAction($a.a.newComment,2);2===t&&(this.Ldh.instance?this.Ldh.instance.Ulc("https://go.microsoft.com/fwlink/?linkid=2154656")&&F.a.uU("https://go.microsoft.com/fwlink/?linkid=2154656")&&
window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):v.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));t=[Object.assign(new na.a,{name:"DialogResult",int64:t})];bf.d(Nc.a.t0h,void 0,void 0,void 0,void 0,void 0,t)};this.ga=b;this.Ldh=k}J8k(){const b=new Uc.StandardDialog;b.Ad=11;b.Ee(1,WordEditorIntl.WordEditorStrings.L_TryIt);b.Ee(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.Gu(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,
WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,0,this.IBm);bf.a("FollowUpsPhaseOutDialogShown")}}Object(n.a)(T,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var fa=c(1464);class Ea{constructor(b,k,t,D,P,ca){this.L6=this.uNe=null;this.F4=()=>{this.L6||(this.L6=new Df.a(3,1,0,()=>{this.L6=null;this.wUd(this.ib.hb)},130),this.Hb.Vb(this.L6))};this.Hc=b;this.sI=k;this.ib=t;this.Hb=D;this.KVe=P;this.ni=ca;this.f2=new la.a;this.Bs=new fa.a;this.C$g=new Ji.a(this.f2);this.sI.Nph((ta,
Na)=>{this.Wsk(Na.commentNode)})}Wsk(b){b=b.id;const k=this.sdi(this.ni.value,b);k&&this.Bs.Z(b,k)}sdi(b,k){const t=b.Db(k);return!t||this.sI.Iac(t)?null:this.sI.CNd(b,k)}BLk(b){const k=new fa.a;var t=this.sI.q8b(b,!0);if(!t)return k;b=this.ni.value;for(const D of t)(t=this.sdi(b,D))&&k.Z(D,t);return k}j5f(b){if(this.uNe){const k=this.Hc.Mc(15);try{k.Cb(this.KVe()),this.sI.aQh(this.uNe)}finally{k&&k.dispose()}}this.uNe=b?this.sI.S6l(b):null}Qmm(b){const k=this.ni.value;if(b=b?this.BLk(b):new fa.a){var t=
new Ji.a(this.f2),D=new Ji.a(this.f2);Ea.ZTl(this.Bs,b,t,D);for(var P of t)this.Bs.Z(P,b.J(P));for(const ca of D)if(t=this.Bs.J(ca),D=this.sI.CNd(k,ca),this.Bs.remove(ca),D&&(b=P=!1,Ja.a.OPc().equals(D,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,t=!1):t=-1<D.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?P=!0:!Ja.a.OPc().equals(t,D),t||P||b)){D=this.Hc.Mc(15);try{D.Cb(this.KVe()),b?this.sI.SPh(k,ca,!0):(P&&this.sI.AXn(k,ca),
t&&this.sI.Klg(k,ca))}finally{D&&D.dispose()}}}}T5l(b){const k=new Ji.a(this.f2);for(const t of b)for(const D of t)b=D.node,pe.ParagraphReader.Wb(b)&&k.add(b.id);return k}llm(b){var k=this.ni.value;const t=b?this.T5l(b):new Ji.a(this.f2);if(t){b=new Eb.a;for(const ca of this.C$g)if(!t.contains(ca)){var D=k.Db(ca);if(D){D=D.pa;for(let ta=0;ta<D.length;ta++){const Na=D.J(ta).tf;if(Na)for(let qb=0;qb<Na.length;qb++){var P=Na.J(qb);P.Nc&&(P=k.Db(P.Wj))&&P.ia(Cc.a.nCi,!1)&&X.a.Zp(ca,d.h(P))&&this.sI.Iac(P)&&
b.add(P)}}}}this.C$g=t;if(b.count){k=this.Hc.Mc(7);try{k.Cb(this.KVe());for(const ca of b)ca.Eg(Cc.a.nCi)}finally{k&&k.dispose()}}}}wUd(b){this.j5f(b);this.Qmm(b);this.llm(b)}PAh(){this.L6&&(this.Hb.Ve(this.L6),this.L6=null)}ZJb(){if(this.L6||this.ni.rxf)this.PAh(),this.wUd(null)}wF(){this.ib.Lw(this.F4);w.AFrameworkApplication.$H(()=>{this.ZJb()})}dispose(){this.ib.CY(this.F4);this.PAh()}static ZTl(b,k,t,D){for(const P of k){const ca=P.key;b.nb(ca)||t.add(ca)}for(const P of b)b=P.key,k.nb(b)||D.add(b)}}
Object(n.a)(Ea,"IntelligentPlaceholderSelectionCache",null,[9]);var gb;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=1]="contextMenu";b[b.atMention=2]="atMention";b[b.xlp=3]="textGesture";b[b.paste=4]="paste";b[b.Q4o=5]="workItemIntent";b[b.ebp=6]="characterTrigger"})(gb||(gb={}));Object(n.b)("IntelligentPlaceholderCreation",gb);class Kb{constructor(b,k,t,D){this.nAa=b;this.Jm=k;this.DSb=t;this.qx=D}Hhe(b){return b&&b.Kc&&b.Kc.id.equals(this.qx.value.od.id)?!0:!1}ipj(b){return this.Hhe(b)&&
b.ia(Cc.a.CG,!1)?!0:!1}S3m(){this.DSb.execute(b=>{b.logAction({actionType:np.b.SessionStart,engagement:np.a.Offer,objectName:Kb.Skc})})}s2d(b,k){const t=2==k&&this.Hhe(b);if(this.ipj(b)||t){var D=b.getValue(Cc.a.ZE);this.DSb.execute(P=>{P.logAction({actionType:np.b.Created,engagement:np.a.None,objectName:Kb.Skc,objectId:D.toString(),objectFulfillment:gb[k]})})}}v0m(b){if(this.ipj(b)){var k=b.getValue(Cc.a.ZE);this.DSb.execute(t=>{t.logAction({actionType:np.b.Deleted,engagement:np.a.None,objectName:Kb.Skc,
objectId:k.toString()})})}}K4m(b,k){if(this.Hhe(b)){var t=b.getValue(Cc.a.ZE);this.DSb.execute(D=>{D.logAction({actionType:np.b.Resolved,engagement:np.a.None,objectName:Kb.Skc,objectId:t.toString(),objectFulfillment:k?"RemoveText":"KeepText"})})}}R5m(b){b===Nc.a.uWd&&this.DSb.execute(k=>{k.logAction({actionType:np.b.Deleted,engagement:np.a.None,objectName:Kb.Skc,objectFulfillment:Kb.PFo})})}K2m(b){if(this.Hhe(b)){var k=b.getValue(Cc.a.ZE);this.DSb.execute(t=>{t.logAction({actionType:np.b.Modified,
engagement:np.a.None,objectName:Kb.Skc,objectId:k.toString(),objectFulfillment:"MentionInserted"})})}}BIk(){this.S3m();this.nAa.Nph((b,k)=>{this.s2d(k.commentNode,k.kBn)});this.nAa.axk((b,k)=>{this.K4m(k.commentNode,k.cPm)});this.nAa.Iwk((b,k)=>{this.K2m(k.commentNode)});this.Jm.p0b((b,k)=>{this.R5m(k.actionId)});fr.a.VZe((b,k)=>{this.v0m(k.commentNode)})}}Kb.Skc="IntelligentPlaceholder";Kb.PFo="Undo";Object(n.a)(Kb,"IntelligentPlaceholderTelemetry",null,[]);class mc{constructor(){this.v6=this.$md=
this.Otd=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}xc(b){this.W=b;b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",()=>new T(w.AFrameworkApplication.va,b.Sa("Common.App.SafeLinks.ISafeLinksManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new xh).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",
()=>new r(w.AFrameworkApplication.va,new mk.a,b.resolve("Box4.IParagraphIteratorFactory"),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new Rg.a(()=>Wa.App.ya.gb.Uc.od),b.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",
()=>new Vi(w.AFrameworkApplication.va,b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new Ea(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.ISelectionManager"),
w.AFrameworkApplication.nc,()=>Wa.App.ya.gb.wc.ed,new Rg.a(()=>Wa.App.ya.gb.Uc.od))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new C(Lb.InteractiveViewManager.instance,new Rg.a(()=>Wa.App.ya.gb.Uc.od),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",
()=>new Kb(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.IUndoManager"),b.Sa("CanvasContextual.ICanvasContextualController"),new Rg.a(()=>Wa.App.ya.gb.Uc))).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>{this.fn()})}fn(){const b=this.W.resolve("Box4.IFeatureHelper");this.W.Sa("WordEditor.CanvasContextualProvider.UxManager");this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").Tb();
this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").BIk();this.v6=this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor");Av.a.vvk(Object(A.a)(this.v6,this.v6.Vvh,"beforeIntelligentPlaceholderPaste"));Av.a.Azd(Object(A.a)(this.v6,this.v6.aUi,"onIntelligentPlaceholderPaste"));this.Otd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache");b.isFeatureEnabled(98)||this.Otd.wF();this.$md=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener");
this.$md.Odb(Wa.App.ya.gb,Zb.KeyInputManager.instance);this.kUn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dispose(){this.Otd&&this.Otd.dispose();this.$md&&this.$md.dispose();this.v6&&(Av.a.IZn(Object(A.a)(this.v6,this.v6.Vvh,"beforeIntelligentPlaceholderPaste")),Av.a.m_n(Object(A.a)(this.v6,this.v6.aUi,"onIntelligentPlaceholderPaste")))}kUn(b,k,t){b&&b.execute(D=>{D.Q4(new ki(k,
t))})}static main(){N.a.instance.Fc(new mc)}}Object(n.a)(mc,"PackageManager",null,[1,2]);var Hc=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",
DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",
attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",
IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},
children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",
LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},dd=c(2042),ud=c(1930),Wd=c(2006);class ae{}ae.Lyo="Search_16x16x32";ae.Dyo="ClosePaneGlyph_16x16x32";Object(n.a)(ae,"SearchBoxIcons",
null,[]);var Fe=c(2009),$e=c(2010),Oe=c(2008);class Hg{constructor(){this.NUg=null}get key(){return"FIND_HIT"}get Pw(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.NUg=b.node.rna()}rIa(b){let k=null;for(const t of this.NUg)if(t.begin<=b&&b<t.end)return k=Object.assign(new kw.a,{KG:this.key,contentObject:t}),{returnValue:!0,RF:k};return{returnValue:!1,RF:k}}}Object(n.a)(Hg,"FindHitDetailsProvider",null,[416,417]);var hj=c(1631),Rk=c(1564),El=c(1608);class hm{constructor(b,
k,t,D,P,ca,ta,Na=null,qb=null){this.gm=null;this.find=(Jb,Vb,ac,yc,Kc)=>1===ac?32:void 0===Kc||null===Kc?8:Kc.length?this.Tfg(Kc):(this.F5e(Wd.a.initial),32);this.findInDocument=(Jb,Vb,ac,yc,Kc)=>this.wrj(Nc.a.Lob,Jb,Vb,ac,yc,Kc);this.BAl=(Jb,Vb,ac,yc,Kc)=>this.wrj(Nc.a.Nob,Jb,Vb,ac,yc,Kc);this.SZh=(Jb,Vb,ac)=>1===ac?32:this.Tfg(this.uo.SOa());this.l2c=(Jb,Vb,ac,yc,Kc)=>{Jb=!this.uo.jG;Kc[Gn.a.Image16by16Class]=Jb?od.getImageClass(ae.Lyo):od.getImageClass(ae.Dyo);Kc[Gn.a.LabelText]=Jb?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:
WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;Kc[Gn.a.ApplyLabelTextToControlOnly]=!0;Kc[Gn.a.EnsureControlRoleIsButton]=!0;Kc[Gn.a.On]=!1;return 32};this.GBl=(Jb,Vb,ac)=>{if(1===ac)return 32;this.Oji(!1);return 32};this.RBl=(Jb,Vb,ac)=>{if(1===ac)return 32;this.Oji(!0);return 32};this.J1f=(Jb,Vb,ac,yc,Kc)=>{Kc[tn.a.Visible]=this.uo.Drj;return 32};this.T1f=(Jb,Vb,ac,yc,Kc)=>{Kc[tn.a.Visible]=this.uo.Drj;return 32};this.USd=(Jb,Vb,ac,yc,Kc)=>{if(1===ac)return 32;this.WA.a5c.Tji(Kc);
return 32};this.cancelSearch=(Jb,Vb,ac)=>{if(1===ac)return 32;this.F5e(Wd.a.initial);return 32};this.qGc=(Jb,Vb,ac)=>{if(1===ac)return 32;this.F5e(Wd.a.initial);this.uo.VB(!1);return 32};this.clearSearch=(Jb,Vb,ac)=>{if(1===ac)return this.qFm(Jb===$a.a.YDh);this.uo.clearSearch();return 32};this.pne=(Jb,Vb,ac)=>{if(1===ac)return 32;switch(Jb){case $a.a.Sjf:this.uo.matchCase=!this.uo.matchCase;break;case $a.a.gkf:this.uo.matchWholeWord=!this.uo.matchWholeWord}return this.Tfg(this.uo.SOa())};this.Dae=
(Jb,Vb,ac,yc,Kc)=>{Kc[kg.a.On]=this.uo.matchCase;return 32};this.Fae=(Jb,Vb,ac,yc,Kc)=>{Kc[kg.a.On]=this.uo.matchWholeWord;return 32};this.u1f=(Jb,Vb,ac,yc,Kc)=>{Jb=this.uo.matchCase;Vb=this.uo.matchWholeWord;ac="";Jb&&Vb?ac=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):Jb?ac=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):
Vb&&(ac=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));Kc[Zp.a.Value]=ac;Kc[Zp.a.Visible]=Jb||Vb;return 32};this.vgc=(Jb,Vb,ac,yc,Kc)=>{Jb=this.uo.p2;Vb="";switch(this.uo.jG){case Wd.a.startSearch:Vb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case Wd.a.searching:Vb=Jb?this.ltf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case Wd.a.searchComplete:Vb=
this.ltf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case Wd.a.tooManyResults:Vb=this.ltf(this.uo.uFa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case Wd.a.noMatchesFound:Vb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case Wd.a.replaceAllInProgress:Vb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case Wd.a.replaceAllComplete:Vb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}Kc[Zp.a.Value]=
Vb;return 32};this.Eae=(Jb,Vb,ac,yc,Kc)=>{Kc&&(Kc.CommandValueId=this.uo.SOa());return 32};this.replace=(Jb,Vb,ac,yc,Kc)=>{if(1===ac)return this.xFf()?32:8;if(!this.xFf())return 8;Jb=this.uo.NEb();"string"===typeof Kc&&Kc&&(Jb=Kc);v.ULS.sendTraceTag(6033813,312,50,"Replace Called");bf.a("NavigationPaneReplace");Kc=this.Pwb.replace(Jb);this.uo.Tdo(Kc);return 32};this.replaceAll=(Jb,Vb,ac,yc,Kc)=>{if(1===ac)return this.jPm()?32:8;Jb=this.uo.NEb();"string"===typeof Kc&&Kc&&(Jb=Kc);bf.a("NavigationPaneReplace");
this.gm=this.he.Zf("UserAction","ReplaceAll");this.uo.u7(Wd.a.replaceAllInProgress);v.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");El.a.q1n(this.uo.SOa(),this.uo.NEb());this.Pwb.replaceAll(Jb,this.Uqn);return 32};this.Uqn=(Jb,Vb)=>{this.gm&&(this.gm.stop(),this.gm=null);v.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:Jb,["TotalCount"]:Vb});El.a.n1n(Jb,Vb);this.uo.u7(Wd.a.replaceAllComplete)};this.f4i=(Jb,Vb,ac,yc,Kc)=>{Vb=!1;if(!Kc)return 8;
this.uo.gj.isVisible&&(Vb=Jb===Nc.a.E2c===this.uo.ePc());Jb!==Nc.a.E2c||this.K1g||(Vb=!1);Kc[kg.a.On]=Vb;return 32};this.v1f=(Jb,Vb,ac,yc,Kc)=>{if(!Kc||!this.uo.gj.isVisible)return 32;Kc[kg.a.On]=this.uo.uFa;return 32};this.x1f=(Jb,Vb,ac,yc,Kc)=>{if(!Kc)return 32;Kc.currentFindReplaceViewType=this.uo.jG;return 32};this.DJn=(Jb,Vb,ac,yc,Kc)=>{if(1===ac)return 32;Jb=Kc[kg.a.On];Kc&&(Kc[kg.a.On]=this.uo.gj.isVisible);Jb&&!Kc[kg.a.On]&&(hm.uAj(),bf.a("NavigationPaneCrossClick"));return 32};this.n7a=(Jb,
Vb,ac,yc,Kc)=>{const ed=this.uo.gj.isVisible;v.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",ed);return ed?this.qGc(Jb,Vb,ac,yc,Kc):this.Bjc(Jb,Vb,ac,yc,Kc)};this.Bjc=(Jb,Vb,ac,yc,Kc)=>{if(1===ac)return $b.SessionStatusManager.instance.KH?32:8;if(2===ac){w.AFrameworkApplication.Roa("AutoDetectedHeadingsIsEnabled");hm.uAj();this.R4();hj.FindReplaceUIManager.VOk(Jb,Kc,this.uo.gj.isVisible);Vb=!0;Jb===Nc.a.Fjc&&void 0!==Kc&&null!==Kc&&(Vb=Kc);this.uo.VB(!0,Vb);Kc=Oe.a.initial;switch(Jb){case Nc.a.Cjc:v.ULS.sendTraceTag(42501022,
367,50,"");Kc=Oe.a.headings;break;case Nc.a.Lob:Kc=Oe.a.find;break;case Nc.a.Nob:Kc=Oe.a.replace;break;case Nc.a.Fjc:Kc=Oe.a.intelligentPlaceholder;break;case Nc.a.n7a:Kc=this.uo.b4b,Kc||(v.ULS.sendTraceTag(42501023,367,50,""),Kc=Oe.a.headings)}this.uo.Hio(Kc,Vb);return 32}return 8};this.iGa=()=>{this.uo.jG&&!this.uo.uFa&&v.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.uo=k;this.WA=t;this.Pwb=D;this.K1g=P;this.he=ta;qb&&qb(1,this.iGa,null);this.vKa=Na}R4(){}Tb(){this.ga.fb(Nc.a.i2f,
lc.a.view,this.DJn,96);this.ga.qa(Nc.a.n7a,lc.a.view,this.n7a);this.ga.qa(Nc.a.Cjc,lc.a.view,this.Bjc);this.ga.qa(Nc.a.Lob,lc.a.view,this.Bjc);this.ga.qa(Pb.a.ULd,lc.a.view,this.find);this.ga.qa($a.a.findInDocument,lc.a.view,this.findInDocument);this.ga.qa(Pb.a.findOnPage,lc.a.view,this.SZh);this.ga.fb($a.a.eJn,lc.a.view,this.l2c,97);this.ga.qa(Pb.a.h5d,lc.a.view,this.GBl);this.ga.qa(Pb.a.U$d,lc.a.view,this.RBl);this.ga.fb(Pb.a.J1f,lc.a.view,this.J1f,97);this.ga.fb(Pb.a.T1f,lc.a.view,this.T1f,97);
this.ga.qa(Nc.a.USd,lc.a.view,this.USd);this.ga.qa(Pb.a.dAb,lc.a.view,this.cancelSearch);this.ga.qa($a.a.clearSearch,lc.a.view,this.clearSearch);this.ga.qa($a.a.YDh,lc.a.application,this.clearSearch);this.ga.qa(Nc.a.qGc,lc.a.view,this.qGc);this.ga.qa($a.a.Sjf,lc.a.view,this.pne);this.ga.qa($a.a.gkf,lc.a.view,this.pne);this.ga.fb($a.a.Dae,lc.a.view,this.Dae,97);this.ga.fb($a.a.Fae,lc.a.view,this.Fae,97);this.ga.fb(Nc.a.u1f,lc.a.view,this.u1f,97);this.ga.fb(Nc.a.vgc,lc.a.view,this.vgc,97);this.ga.fb(Nc.a.v1f,
lc.a.view,this.v1f,97);this.ga.fb(Nc.a.x1f,lc.a.view,this.x1f,97);this.ga.fb(Nc.a.w1f,lc.a.view,this.f4i,97);Object(Rk.b)()&&this.ga.fb(Nc.a.Eae,lc.a.view,this.Eae,96);this.K1g&&(this.ga.fb(Nc.a.Nob,lc.a.view,this.Bjc,1028),this.ga.fb(Nc.a.E2c,lc.a.view,this.f4i,97),this.ga.fb(Nc.a.replace,lc.a.view,this.replace,1028),this.ga.fb(Nc.a.replaceAll,lc.a.view,this.replaceAll,1028),w.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)&&this.ga.fb($a.a.akf,lc.a.view,this.BAl,1028));this.ga.qa(Nc.a.Fjc,lc.a.view,this.Bjc)}U3f(){this.vKa&&this.vKa.execute(b=>{b.Q4(new Hg)})}wrj(b,k,t,D,P,ca){if(1===D)return $b.SessionStatusManager.instance.KH?32:8;if(void 0===ca||null===ca)return 8;this.Bjc(b,t,2,P,ca);b=this.uo;b.nag(ca.CommandValueId);Object(Rk.b)()&&("MatchCase"in ca&&(b.matchCase=ca.MatchCase),"MatchWholeWord"in ca&&(b.matchWholeWord=ca.MatchWholeWord));return this.SZh(k,t,D,P,ca)}Tfg(b){if(void 0===b||null===b||!b.length)return 32;
b=Fe.a.createQuery(b,this.iJn);if(void 0===b||null===b)return v.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.WA.find(b);return 32}get iJn(){let b=$e.a.none;this.uo.matchCase&&(b|=$e.a.matchCase);this.uo.matchWholeWord&&(b|=$e.a.wholeWordOnly);return b}Oji(b){this.uo.b4b!==Oe.a.headings&&this.uo.p2&&(b?this.WA.a5c.Rim():this.WA.a5c.Qji())}F5e(b){this.uo.jG&&(this.uo.uFa||v.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.WA.yZa(),this.uo.u7(b))}qFm(b){return this.uo.jG===
Wd.a.replaceAllInProgress||b&&!this.uo.jG?8:32}ltf(b){return String.format(b,this.uo.xgd,this.uo.p2)}xFf(){return this.uo.ePc()&&0<this.uo.p2}jPm(){return this.xFf()&&this.uo.uFa}static uAj(){null!=w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(k=>{k.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},hm.wDa)}static XUl(b,k,t,D){return new hm(w.AFrameworkApplication.va,
b,k,t,D,ad.FocusManager.instance(),Wa.App.ya.Fq,Fa.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager"),Object(A.a)(w.AFrameworkApplication.ta.tP,w.AFrameworkApplication.ta.tP.lb,"registerHandler"))}static WUl(b,k,t,D){return hm.XUl(b,k,t,D)}}hm.wDa=5E3;Object(n.a)(hm,"FindReplaceActor",null,[]);var pn=c(896),Ep=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.iC},set:function(k){this.iC=k},enumerable:!1,configurable:!0});
Object.defineProperty(b.prototype,"last",{get:function(){return this.xWa},enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(k){return this._map.get(k)};b.prototype.insert=function(k,t){this.removeItem(k);t={key:k,Cpa:this.xWa,next:void 0,data:t};this.first||(this.first=t);this.xWa&&(this.xWa.next=t);this.xWa=t;this._map.set(k,t)};b.prototype.insertAfter=function(k,t,D){k=this._map.get(k);if(!k)return!1;D={key:t,Cpa:k,next:k.next,data:D};
var P=k.next;P&&(P.Cpa=D);k.next=D;this._map.set(t,D);return!0};b.prototype.insertBefore=function(k,t,D){k=this._map.get(k);if(!k)return!1;D={key:t,Cpa:k.Cpa,next:k,data:D};var P=k.Cpa;P&&(P.next=D);k.Cpa=D;this._map.set(t,D);return!0};b.prototype.removeItem=function(k){var t=this._map.get(k);t&&(this.first===t&&(this.first=t.next),this.xWa===t&&(this.xWa=t.Cpa),t.Cpa&&(t.Cpa.next=t.next),t.next&&(t.next.Cpa=t.Cpa),this._map.delete(k))};return b}();class Fl{constructor(){this.type="heading"}}Object(n.a)(Fl,
"NavPaneHeadingItem",null,[]);class Sk{constructor(){this.type="bookmark"}}Object(n.a)(Sk,"NavPaneBookmarkItem",null,[]);class il{constructor(b,k,t,D,P,ca,ta){var Na,qb;this.eb=b;this.ib=k;this.Ub=t;this.nn=D;this.Fxa=P;this.LF=ca;this.E4j=ta;this.wXa=0;this.rpd=new Map;this.LXg=!1;this.Iza=new Map;this.DKg=null===(Na=w.AFrameworkApplication.K)||void 0===Na?void 0:Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneADHToggleDefaultOff",!1);this.fbk=null===(qb=w.AFrameworkApplication.K)||
void 0===qb?void 0:qb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneShowNumberListedHeadings",!1)}get headingsReady(){return this.LXg}set headingsReady(b){this.LXg=b}get LLb(){return this.wXa}get i9(){this.yXb&&0!=this.yXb.length()||(this.yXb=this.gEn());return this.yXb}set i9(b){this.yXb=b}get aic(){return this.khk}set aic(b){this.aic&&(this.aic.isSelected=!1);b.isSelected=!0;this.khk=b}Mrf(b,k){return"bookmark"===b.type?b.text:k.id.toString()}gEn(){const b=new Ep;if(!this.Fxa)return b;
this.rpd=new Map;let k;const t=[];for(const D of this.Fxa.paragraphs()){const P=this.gbi(D,t);null===P||void 0===P?void 0:P.forEach(ca=>{(k=this.$ci(ca,t))&&"heading"===k.type&&k.indentLevel<ca.indentLevel&&(1>=k.indentLevel?(k.isCollapsed=!1,ca.isHidden=!1):(k.isCollapsed=!0,ca.isHidden=!0));b.insert(this.Mrf(ca,D),ca)})}return b}$ci(b,k){return"heading"===b.type?1<k.length?k[k.length-2]:void 0:0<k.length?k[k.length-1]:void 0}vmg(b){var k;let t=pe.ParagraphReader.vna(b),D=!1;9===t&&this.Iza.has(b.id.toString())&&
(t=this.Iza.get(b.id.toString()),D=!0);const P=null===(k=this.i9.get(b.id.toString()))||void 0===k?void 0:k.data;if(P){if(P.indentLevel===t){k=Un.AParagraphNode.OU(b.characterData.trim());b=this.nn.value.NXf(b);if(k!==P.text||P.hasBookmark!==b)return P.text=k,P.hasBookmark=b,!0;!D&&P.isPurelyADH&&(P.isPurelyADH=!1,--this.wXa);return!1}this.z1c();return!0}if(9===t)return this.bEm(b)?(this.z1c(),!0):!1;this.z1c();return!0}bEm(b){var k;const t=this.nn.value.j4h(b);b=null!==(k=this.rpd.get(b.id.toString()))&&
void 0!==k?k:0;if(b!==t.length)return!0;for(k=0;k<b;++k)if(!this.i9.get(t[k].HOa()))return!0;return!1}yil(b){if(this.i9.get(b.id.toString())||this.nn.value.NXf(b))return this.z1c(),!0;this.Iza.has(b.id.toString())&&(this.Iza.delete(b.id.toString()),--this.wXa);return!1}z1c(){const b=new Ep;this.wXa=0;if(this.Fxa){this.rpd=new Map;var k=[],t,D;for(const P of this.Fxa.paragraphs()){const ca=this.gbi(P,k);null===ca||void 0===ca?void 0:ca.forEach(ta=>{var Na=this.Mrf(ta,P);D=this.$ci(ta,k);this.D5n(Na,
ta,D);b.insert(Na,ta);"heading"===(null===t||void 0===t?void 0:t.type)&&(Na=t,Na.indentLevel>=ta.indentLevel&&(Na.isCollapsed=void 0));t=ta})}}this.i9=b}D5n(b,k,t){var D,P;if(b=null===(D=this.yXb.get(b))||void 0===D?void 0:D.data)b.isSelected&&(k.isSelected=!0,this.aic=k),k.isHidden=b.isHidden;if(t){if(D=null===(P=this.yXb.get(this.Mrf(t,t.paragraphNode)))||void 0===P?void 0:P.data)t.isCollapsed=D.isCollapsed;t.isCollapsed?k.isHidden=!0:t.isHidden?(t.isCollapsed=!0,k.isHidden=!0):(t.isCollapsed=!1,
k.isHidden=!1)}}gbi(b,k){var t=pe.ParagraphReader.vna(b),D=!this.yDf(b);const P=this.PJm(t)&&D?!0:!1;D=this.Iza.has(b.id.toString())&&D;const ca=[];if(P)ca.push(this.aLh(b,t,!1,k));else if(D)this.wXa+=1,this.bLc&&(t=this.Iza.get(b.id.toString()),ca.push(this.aLh(b,t,!0,k)));else{let ta=0;this.nn.value.j4h(b).forEach(Na=>{const qb=new Sk;qb.text=Na.HOa();qb.isSelected=!1;qb.bookmarkManager=this.nn;qb.indentLevel=0<k.length?k[k.length-1].indentLevel+1:0;ta+=1;ca.push(qb)});this.rpd.set(b.id.toString(),
ta)}return ca}aLh(b,k,t,D){var P,ca;const ta=new Fl;ta.text=Un.AParagraphNode.OU(b.characterData.trim());ta.indentLevel=k;ta.paragraphNode=b;ta.isSelected=!1;ta.isPurelyADH=t;this.fbk&&(ta.listMarker=this.dsf(b));ta.hasBookmark=this.nn.value.NXf(b);for(b=null===(P=D[D.length-1])||void 0===P?void 0:P.indentLevel;b&&b>=k;)D.pop(),b=null===(ca=D[D.length-1])||void 0===ca?void 0:ca.indentLevel;(!b||b<k)&&D.push(ta);return ta}yDf(b){return this.eb.Wb(b)&&0===this.eb.textLength(b,9)}Lwl(b){(b=this.i9.get(b))&&
(1==b.data.isCollapsed?this.Irj(b):this.Uqm(b))}onClickHeading(b){var k;this.aic=b=null===(k=this.i9.get(b))||void 0===k?void 0:k.data;k=Gf.SelectionFactory.te(b.paragraphNode,0);this.ib.setSelection(k);this.Ub.mg(ef.AFrame.Pn)}onClickBookmark(b){var k;this.aic=b=null===(k=this.i9.get(b))||void 0===k?void 0:k.data;this.nn.value.Hji(b.text);this.Ub.mg(ef.AFrame.Pn)}onShareHeadingClick(b){var k;w.AFrameworkApplication.ue("NavPaneShareHeadingLink-tf;NavPaneShareHeadingLink-cf");bf.a("CreateHeadingLinkThroughNavPane",
!0,void 0);if(b=null===(k=this.i9.get(b))||void 0===k?void 0:k.data)k=b.paragraphNode.getValue(Cc.a.Lc),this.E4j.value.bLh(k)}Flg(b,k){const t=b.id.toString(),D=this.Iza.has(t);if(!D||this.Iza.get(t)!==k){this.Iza.set(t,k);if(this.bLc)return this.vmg(b);!this.DKg||D||this.i9.get(t)||(this.wXa+=1)}return!1}Rhl(b){const k=b.id.toString(),t=this.Iza.has(k);if(t){this.Iza.delete(k);if(this.bLc)return this.vmg(b);this.DKg&&t&&!this.i9.get(k)&&--this.wXa}return!1}oIo(b){this.bLc=b;this.z1c()}emg(b){var k;
const t=null===(k=this.i9.get(b.id.toString()))||void 0===k?void 0:k.data;if(!t)return!1;b=this.dsf(b);if(t.listMarker===b)return!1;this.IQo();return!0}kdf(b){var k;b=null===(k=this.i9.get(b.id.toString()))||void 0===k?void 0:k.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;return!0}Irj(b){var k=b.data;1==k.isCollapsed&&(k.isCollapsed=!1);k=k.indentLevel;b=b.next;let t;for(;b&&b.data.indentLevel>k;)t=b,b=t.next,t.data.isHidden=!1,"heading"==t.data.type&&(b=t.data.isCollapsed?this.Rwo(t):
this.Irj(t));return b}Uqm(b){var k=b.data;k.isCollapsed=!0;k=k.indentLevel;b=b.next;let t;for(;b&&b.data.indentLevel>k;)t=b,b=t.next,t.data.isHidden=!0}Rwo(b){const k=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>k;)b=b.next;return b}PJm(b){return 0<=b&&8>=b}IQo(){let b=this.i9.first;for(;b;){if("heading"===b.data.type){const k=b.data;k.listMarker=this.dsf(k.paragraphNode)}b=b.next}}dsf(b){var k;if(b.CK instanceof pn.a)return this.Cgm(null===(k=this.LF.Rkb(b.CK))||void 0===k?void 0:k.K8)}Cgm(b){for(let k=
0;k<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(k)?void 0:b}}Object(n.a)(il,"NavPaneHeadingsManager",null,[]);var ok=c(1565);class ij{constructor(){this.Pwb=this.WA=this.Rsc=this.Kid=this.W=null}get name(){return"WordEditor.FindReplace"}xc(b){this.W=b;const k=new il(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.ISelectionManager"),ad.FocusManager.instance(),b.Ue("WordEditor.Bookmark.IBookmarkManager"),b.resolve("Box4.IParagraphCollection"),b.resolve("Box4.IListMarkerUtility"),
b.Ue("WordEditor.Actors.HeadingsActor"));this.W.ha("WordEditor.FindReplace.NavPaneHeadingsManager",()=>k).as("WordEditor.FindReplace.NavPaneHeadingsManager").singleInstance()}init(){ij.Xb.Mp.continueWith(()=>{this.fn()})}fn(){if(Wa.App.$og){const b=Wa.App.Uoe;this.Rsc=hj.FindReplaceUIManager.getInstance(b);this.WA=ud.FindManager.createInstance(this.Rsc,dd.a.instance,ok.a.instance,!0);this.Pwb=this.WA.NMb;this.Kid=hm.WUl(this.Rsc,this.WA,this.Pwb,b);this.Kid.Tb();this.Kid.R4();this.Kid.U3f();Wa.App.ya.updateCommandUI()}}dispose(){this.Rsc&&
this.Rsc.dispose()}static get Xb(){return null!=ij.qyg?ij.qyg:ij.qyg=Fa.a.instance.resolve("Box4.IFeatureHelper")}}Object(n.a)(ij,"FindReplacePackageManager",null,[1,2]);class nj{constructor(){}hmf(){return"_@_"+lb.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}vTo(b,k,t,D){k.Vdo(b,D);k.Wl(b,sf.a.T9,!0);k.Wl(b,Cc.a.tQa,!0);k.Wl(b,Cc.a.fieldInstruction,nj.JYh(t));k.Wl(b,Cc.a.Ys,15)}Kyk(b,k,t,D){const P=b.mGd(D);k.Wl(P,sf.a.T9,!0);k.Wl(P,Cc.a.Ys,47);k.Wl(P,Cc.a.fieldInstruction,
nj.JYh(t));b=b.mGd(D);k.Wl(b,sf.a.T9,!0);k.Wl(b,Cc.a.Ys,16);return[P.Fj,b.Fj]}aIl(b,k,t){b=b.mGd(t);k.Wl(b,sf.a.T9,!0);k.Wl(b,Cc.a.NHb,!0);return b.Fj}static JYh(b){return String.format(' HYPERLINK "{0}"',b)}}Object(n.a)(nj,"AtMentionHyperlinkConfigurator",null,[386]);class Xn{constructor(b,k,t){this.gLa=b;this.ib=k;this.zli=this.Mti=this.mFe=!1;this.pKb=this.pKb.bind(this);this.qKb=this.qKb.bind(this);this.zKb=this.zKb.bind(this);t&&t.execute(D=>{this.eVa=D});yp.a.eBd.Sof.then(D=>{this.zli=!0;this.Mti=
D.isSuccess})}wce(){this.gLa.g4f(this.pKb);this.gLa.h4f(this.qKb);this.gLa.q4f(this.zKb)}FZd(){return!1}pKb(b,k,t){var D,P;k=Date.now();if(this.eVa)if(this.zli&&!this.Mti)v.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");else{var ca=null===(P=null===(D=this.ib.hb)||void 0===D?void 0:D.kb)||void 0===P?void 0:P.Qc;ca?(D=ca.node,pe.ParagraphReader.Wb(D)?(P=pe.ParagraphReader.text(D),0>t||t>P.length?v.ULS.sendTraceTag(540340298,3034,50,
"ContextIQUserInitHandler::onInputCallback - Position of the @ was not within the bounds of the paragraph."):1<b.length&&"@"===b.trimEnd()?(bf.c(Nc.a.w4k,!0,void 0,void 0,void 0,void 0),this.gLa.reset()):(this.mFe?this.eVa.YTo():(this.mFe=!0,this.eVa.Wvo(ca)),this.eVa.Olg(t,t+b.length),b=P.substring(0,t)+b,this.eVa.umf(D,b,t,k))):v.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):v.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else v.ULS.sendTraceTag(537776153,
3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}qKb(b){if(this.eVa)this.eVa.onKeyDown(b)}zKb(){this.mFe=!1;this.eVa&&this.eVa.FEh()}}Object(n.a)(Xn,"ContextIQUserInitHandler",null,[385]);var Tp=c(1641);class ts{constructor(){this.Iz=null}get name(){return"WordEditor.AtMentions"}xc(b){this.W=b;b.ha("Box4.IAtMentionHyperlinkConfigurator",()=>new nj(b.resolve("Box4.IFeatureHelper"))).singleInstance();const k={crewAlias:ts.RLj,featureName:ts.wNj,topLevelKpiName:ts.uRj,
vetoPillar:7};b.ha("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new Rt.a(xa.Health.instance,new Vs.a,k)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>{this.fn()})}dispose(){}fn(){this.W.Sa("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(k=>{w.AFrameworkApplication.K.$("ConsumerMentionsHostIsEnabled")&&(k=k&&w.AFrameworkApplication.K.$("WordEditorConsumerCanvasMentionsIsEnabled"));
(k||Tp.a.Bcd())&&this.UYm()})});this.W.resolve("Box4.IAtMentionHyperlinkConfigurator")}UYm(){(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.W.resolve("Common.IDynamicScriptLoaderProvider").Kz.loadScript("canvasAtMentions")).then(()=>{w.AFrameworkApplication.K.No(()=>{this.FSn()})})}FSn(){const b={peopleAPI:this.W.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:w.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},
useLPP:!0,isTestEnv:this.URm()};this.Iz=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(k=>{k.isFeatureEnabled("MsoContextIq",!1).then(t=>{t&&Tp.a.Ccd()||!t&&Tp.a.Bcd()?(Tp.a.UBf=!t,this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new Xn(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.W.resolve("Box4.ISelectionManager"),this.W.Sa("WordEditor.CanvasContextual.ContextIQIntentProvider"))).singleInstance()):
this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new hz(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.Iz,this.W.resolve("Box4.ITextMetricsAdapter"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.ISelectionManager"),Lb.InteractiveViewManager.instance,this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.W.resolve("Common.Utils.IAriaNotifier"),
this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).singleInstance();this.W.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").wce()})})}URm(){var b,k;const t=null!==(b=w.AFrameworkApplication.sessionStartInfoSettings.Ring)&&void 0!==b?b:"-1";b=null!==(k=w.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==k?k:"";return t===ts.ELj&&b===ts.DLj}}ts.ELj="-4";ts.DLj="DC2";ts.RLj="webasynccollabeng";ts.wNj="AtMentions";ts.uRj="AtMentionsFeatureUsage";
Object(n.a)(ts,"PackageManager",null,[1,2]);var Ko=c(1673),Yn=c(1380);class vy{constructor(b,k,t,D){this.ga=b;this.Te=k;this._augLoopRuntimeManager=t;this.Pnk=D;this.ita=0;this.dyd=this.WYb=!1;this.wNg=this.wch=this.IJe=this.xch=0;this.Vrb=null;this.z0j=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],["ChangePicture",!0]]);this.k_j=[{id:`${Cu.hgc}_${1}`},{id:`${Cu.hgc}_${2}`},{id:`${Cu.hgc}_${3}`},{id:Yn.a.AHd},{id:Yn.a.VFd},
{id:Yn.a.F9d},{id:Yn.a.C9d}];this.wUj=[{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"Draw"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"ReviewDesignerSuggestion"}];this.ufd=new Map;this.G6j=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",!1);this.P$j=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",
8);this.GXj=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.Te.lb(this,Ko.SearchSuggestionAnnotation.getTypeName());(w.AFrameworkApplication.K.$("IsO365CommercialHost")||w.AFrameworkApplication.K.$("IsO365ConsumerHost"))&&this.ufd.set("InsertLink","InsertLinkFlyout");this.ufd.set("GraphicsEditor","");this.zDj();this.Tb(this.ga)}rGn(b,k){const t=Date.now();this.IJe&&1250>t-this.IJe||this.Qvb||(this.IJe=t,this.Vrb=b,this.Qud=this.Cbm(k),this.t4n(),
this.K2n())}UD(b,k){if(b.annotationType===Ko.SearchSuggestionAnnotation.getTypeName()&&b.content&&k===Ws.a.getTypeName()&&(k=Date.now(),b=b.content,this.Qvb&&this.Qvb===b.correlationId)){window.clearTimeout(this.ita);this.Qvb=void 0;var t=this.WYb,D=this.h1l(b),P=D&&0<D.length;P&&(this.KUo(D),this.dyd&&(t=!1));t&&this.dbj();k={["description"]:"[Zero term context menu] augloop response latency",["correlationId"]:b.correlationId,["requestPreparationTime"]:this.wch,["canvasContextRetrievalTime"]:this.wNg,
["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-k,["latencyMs"]:k-this.xch,["containsZTM"]:P,["shouldFallBack"]:this.WYb,["fallBack"]:t};v.ULS.sendTraceTag(572057625,1303,50,JSON.stringify(k))}}h1l(b){const k=this.getSuggestions(b.intentSuggestions,Ko.IntentIds.ZeroTermMenu,Ko.ObjectSemantic.GenericSuggestions,Ko.ObjectSchemaType.RankedSuggestion);return 1===k.length?k[0]:b.menuSuggestions}getSuggestions(b,k,t,D){return Array.isArray(b)?b.filter(P=>P.intent===
k&&P.result.semantic===t&&P.result.type===D).map(P=>P.result.value):[]}Tb(b){b.fb($a.a.nIi,lc.a.application,this.L2n.bind(this),96)}Cbm(b){const k=[],t=new Map,D=Date.now();for(const P of b){if(!P)continue;b=[];const ca={itemsMetadata:new cb.a};for(let ta=0;ta<P.ControlList.length;ta++){const Na=P.ControlList[ta];if(Na&&!Na.ExternalId)continue;b.push(Na.ExternalId);const qb={timeStamp:D,source:"FallbackZeroTermMenu",confidenceScore:-1};ca.itemsMetadata[Na.ExternalId]=qb;t.set(Na.ExternalId,qb)}k.push(appChrome.api.menuSection(b,
P.Title,P.Lang,P.Id,ca))}return{sections:k,commands:t}}Xzj(b){return this.ufd.has(b)?this.ufd.get(b):b}EIa(b){const k={};for(const t of b)b=this.Xzj(t.suggestion),appChrome.selectors.isControlDefined(b)&&(k[b]=appChrome.selectors.getModelType(b));Wa.App.ya.aNd(k)}HFm(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?!1:this.z0j.has(b)?this.Qud.commands.has(b):!0}dNh(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,null,null,{menuTargetType:this.Vrb})}Vgb(b=
!1){b=b?Km.a.instance.Osc:Km.a.instance.Vgb();const k=[],t=Date.now();for(const D of b)D.commandId&&k.push({Id:D.commandId,TimeElapsedSinceClick:(t-D.timeStamp)/1E3,ContentType:D.contentType,CommandSurface:D.commandSurface,InputMethod:D.Gx});return k}oNc(){const b=Km.a.instance.oNc(),k=[],t=Date.now();for(const D of b)D.controlId&&k.push({Id:D.controlId,TimeElapsedSinceClick:(t-D.timeStamp)/1E3,ContentType:D.contentType,CommandSurface:D.commandSurface,InputMethod:D.Gx});return k}Pnf(){const b={semantic:Ko.ObjectSemantic.CanvasContext,
type:Ko.ObjectSchemaType.WordCanvasContext,value:{contentType:this.Vrb}};if(this.GXj){const k=Date.now(),t=this.Pnk.Pnf(af.a.instance.hb.kb);t&&t.value.contentType&&(b.value=t.value);this.wNg=Date.now()-k}return b}o6h(){const b=this.oNc(),k=this.Vgb(),t=this.Vgb(!0),D=[];D.push({semantic:Ko.ObjectSemantic.ControlIdHistory,type:Ko.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Ko.SequenceType.ControlId,Sequence:b}});D.push({semantic:Ko.ObjectSemantic.CommandIdHistory,type:Ko.ObjectSchemaType.CommandExecutionSequence,
value:{SequenceType:Ko.SequenceType.CommandId,Sequence:k}});D.push({semantic:Ko.ObjectSemantic.FilteredCommandIdHistory,type:Ko.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Ko.SequenceType.CommandId,Sequence:t}});D.push(this.Pnf());return D}zDj(){this._augLoopRuntimeManager.getSession().then(b=>this.sed=b).catch(()=>{this.sed=void 0})}K2n(){const b=Date.now(),k=this.o6h(),t=[Ko.IntentIds.ZeroTermMenu,Ko.IntentIds.Logging];this.wch=Date.now()-b;this.zvj(t,k,"ContextualMenu")}L2n(b,
k,t){2===t&&(b=this.o6h(),this.zvj([Ko.IntentIds.Logging],b,"Floatie"));return 32}zvj(b,k,t){if(0===b.length||0===k.length)v.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated");else{var D=new Ko.SearchSuggestionSignal({correlationId:this.LQl(),intents:b,contextObjects:k,entryPoint:t});this.WYb=0<=b.indexOf(Ko.IntentIds.ZeroTermMenu);this.xch=Date.now();this.Qvb=D.correlationId;this.ita=window.setTimeout(()=>{this.Zqn(D.correlationId)},750);k=new Ws.l({parentPath:["Signal",
Ko.SearchSuggestionSignal.getTypeName()],items:[{id:lb.a.create().toString(),body:D}]});this.sed&&!this.sed.isClosed?this.sed.submitOperation(k):(this._augLoopRuntimeManager.submitOperation({operation:k}),this.zDj());v.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",["correlationId"]:D.correlationId,["shouldFallBack"]:this.WYb,["intents"]:b}))}}LQl(){const b=lb.a.create().toString();appChrome.api.setOfeCorrelationId("ACM",
b);return b}Zqn(b){this.Qvb&&this.Qvb===b&&(this.Qvb=void 0,this.WYb&&this.dbj(),v.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,["shouldFallBack"]:this.WYb})))}dbj(){const b=this.dNh(this.Qud.sections);appChrome.api.dispatch(b);this.tGh()}tGh(){this.dyd=!0}JXn(b){var k,t;const D=[],P=new Map;if(!b||0===b.length)return D;for(const ca of b){if(!ca||!ca.controlIds||0===ca.controlIds.length)continue;b={controlIds:[],
id:ca.id,title:ca.title,lang:ca.lang,data:{itemsMetadata:new cb.a}};const ta="CommandsZTM"===ca.id;for(const Na of ca.controlIds){if(P.has(Na))continue;if(ta&&b.controlIds.length>=this.P$j)break;const qb=null===(t=null===(k=ca.data)||void 0===k?void 0:k.itemsMetadata)||void 0===t?void 0:t[Na];P.set(Na,qb);b.controlIds.push(Na);qb&&(b.data.itemsMetadata[Na]=qb)}0<b.controlIds.length&&D.push(b)}return D}t4n(){this.dyd=!1;if(this.G6j){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",
!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}KUo(b){this.dyd||(b=this.XIl(b),0<b.length&&appChrome.api.dispatch(b))}XIl(b){const k=[];let t=[];var D=this.p6l();D&&0<D.length&&t.push(...D);(D=this.SHl())&&t.push(D);Array.isArray(b)&&0<b.length&&(b=this.vua(b))&&(b.id="CommandsZTM",t.push(b));(b=this.IHl())&&t.push(b);t=this.JXn(t);if(0===t.length)return[];k.push(this.dNh(t));this.tGh();return k}p6l(){var b,k;const t=null===(b=this.Qud)||
void 0===b?void 0:b.sections.filter(D=>{var P;return null===(P=D.id)||void 0===P?void 0:P.startsWith(Cu.eUh)});for(const D of t)if(null===(k=D.data)||void 0===k?0:k.itemsMetadata)for(const P in D.data.itemsMetadata)D.data.itemsMetadata[P].source="PassThroughZeroTermMenu";return t}SHl(){const b=this.o2h(this.k_j,"DefaultZeroTermMenu");return this.vua(b)}IHl(){const b=this.o2h(this.wUj,"AdvertizedZeroTermMenu");return this.vua(b)}o2h(b,k){const t=[];for(const D of b)D&&this.vro(D)&&this.Qud.commands.has(D.id)&&
t.push({suggestion:D.id,rankingScore:-1,suggestionSource:k});return t}vro(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;if(0===b.count)return!1;b.count--;return!0}vua(b){const k=[],t={itemsMetadata:new cb.a},D=Date.now();this.EIa(b);for(const P of b)b=this.Xzj(P.suggestion),this.HFm(b)&&(k.push(b),t.itemsMetadata[b]={timeStamp:D,source:P.suggestionSource,confidenceScore:P.rankingScore});return 0<k.length?appChrome.api.menuSection(k,null,null,null,t):null}}Object(n.a)(vy,"AugLoopSearchSuggestionManager",
null,[251,252]);class Jw{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}xc(b){this.W=b;this.W.ha("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new vy(w.AFrameworkApplication.va,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>
{yp.a.kl().then(()=>{this.start()})})}start(){this.W.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){N.a.instance.Fc(new Jw)}}Object(n.a)(Jw,"PackageManager",null,[1,2]);var Kw=c(433),Lw=c(946);class mt extends Lw.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(n.a)(mt,"BootMessage",Lw.a,[]);var CC=c(1049);class $C{constructor(){this.YL=null;this.Bon=b=>{if(b.target===this.YL)if(void 0===b.data||null===b.data)v.ULS.sendTraceTag(50739143,
3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const k=G.a(b.data);this.Zje(k.api)?this.bed.J(k.api).Z3d(k.method,k):v.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(k){v.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",k)}};this.bed=new Cj.a}iHf(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",
!1)}create(b,k){let t=!1;try{this.YL=new Worker(b);this.YL.onmessage=this.Bon;const D=Object.assign(new mt,{api:0,method:0,scripts:k,documentUrl:document.URL});this.postMessage(D);this.iHf()&&CC.a.fTj(this.YL);t=!0}catch(D){v.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",D)}return t}postMessage(b){try{const k=G.c(b);this.YL.postMessage(k)}catch(k){v.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",k)}}Zje(b){return this.bed.nb(b)}rpk(b,
k){this.Zje(b)&&v.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",b);this.bed.Z(b,k)}kLl(b){return this.Zje(b)?this.bed.J(b):null}}Object(n.a)($C,"WebWorker",null,[68]);class VB{constructor(){this.wpg=[]}Qdl(b,k){if(k){var t=w.AFrameworkApplication.yz(b.ngj,7),D=[];for(let P=0;P<b.iPb.length;P++){let ca;switch(b.iPb[P].format){case 5:case 6:ca=Kw.a.REb(b.iPb[P].name);break;default:ca=b.iPb[P].name}D.push(w.AFrameworkApplication.yz(ca,
b.iPb[P].format))}try{const P=URL.createObjectURL(new Blob(["importScripts('"+t+"');"],{type:"application/javascript"})),ca=new $C;if(ca.create(P,D))for(this.wpg.push(ca),t=0;t<b.Yje.length;t++){const ta=k.z7k(ca,b.Yje[t]);ta&&ca.rpk(b.Yje[t],ta)}}catch(P){v.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",P.message)}}else v.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(n.a)(VB,"WebWorkerCollection",null,
[]);class WA{constructor(b,k){this.qXe=new VB;if(b){b=b.create();for(let t=0;t<b.length;t++)this.qXe.Qdl(b[t],k)}else v.ULS.sendTraceTag(50442779,3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,k,...t){let D=!1;for(let ca=0;ca<this.qXe.wpg.length;ca++){var P=this.qXe.wpg[ca];P.Zje(b)&&((P=P.kLl(b))?D=P.callMethod(k,t)||D:v.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}D||v.ULS.sendTraceTag(50442781,
3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,k)}}Object(n.a)(WA,"WebWorkerRouter",null,[25]);class DC extends Lw.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(n.a)(DC,"SettingsMessage",
Lw.a,[]);class Zv{constructor(b){this.YL=b}}Object(n.a)(Zv,"WebWorkerApiMain",null,[]);class EC extends Zv{constructor(b){super(b)}iHf(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}callMethod(b,k){if(!k)return v.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.BQk(k);v.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",
b);return!1}Z3d(b,k){switch(b){case 14:this.Dlm(k);break;default:v.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}BQk(b){if(2!==b.length)return v.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return v.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}",
"object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new DC,{api:0,method:1,appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:w.AFrameworkApplication.userSessionId,LocalCobaltSessionId:uh.a.instance.bP,LocalCobaltMachineId:uh.a.instance.Skb,LocalCobaltClusterId:uh.a.instance.OIb,LocalCobaltSessionHasBackup:uh.a.instance.Qoa,WaciiEnabledRequests:uh.a.instance.Cja,SettingsRoutedToServer:uh.a.instance.icg,WacClusterId:w.AFrameworkApplication.Ne.SY});this.YL.postMessage(b);return!0}Dlm(b){this.iHf()&&
b&&b.result&&(v.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.QYo())}async QYo(){try{const b=await new CC.a.gTj.WorkerUtilsTestClass(10);await b.Gh(5);15==await b.counter?v.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):v.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){v.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",b.message)}}}Object(n.a)(EC,"InitializeWorkerApiMain",Zv,[]);class Cx extends Lw.a{constructor(){super();
this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=0;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(n.a)(Cx,"CatchUpNetworkRequestWorkerRequestMessage",Lw.a,[]);class $v extends Zv{constructor(b,k){super(b);this.EFc=k}callMethod(b,k){if(4===b)return b=Object.assign(new Cx,{rootQuerySignature:k[0],requestEndpoint:k[1],appMode:k[2],activityFeedIsEnabled:k[3]}),this.YL.postMessage(b),!0;v.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",
b);return!1}Z3d(b,k){switch(b){case 5:v.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.EFc.neo(k);break;default:v.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}Object(n.a)($v,"CatchUpNetworkRequestWorkerExternalApi",Zv,[]);class Gm extends Lw.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=
null}}Object(n.a)(Gm,"LocalInferenceMessage",Lw.a,[]);class aD{constructor(){this.prediction=this.context=null}}Object(n.a)(aD,"LocalInferenceOutput",null,[]);class FC{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=null}}Object(n.a)(FC,"TextPredictionConfig",null,[]);class GC{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(n.a)(GC,"TextPredictionSettings",null,[]);class wD{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(n.a)(wD,
"TextPredictionDynamicPayload",null,[]);class HC extends Zv{constructor(b,k){super(b);this.Wnk=k}callMethod(b,k){if(!k)return v.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),!1;switch(b){case 8:return this.HQk(k);case 7:return this.CQk(k);case 9:return this.GQk(k);case 10:return this.DQk(k);case 13:return this.EQk(k);case 14:return this.FQk(k);default:return v.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",
b),!1}}Z3d(b,k){switch(b){case 9:this.Gmm(k);break;default:v.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}Gmm(b){b&&b.prediction&&(b=Object.assign(new aD,{prediction:b.prediction,context:b.context}),this.Wnk.qvh().BGn(b))}CQk(b){if(1>b.length)return v.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Gm,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.YL.postMessage(b);return!0}HQk(b){if(1>b.length)return v.ULS.sendTraceTag(575959824,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Gm,{api:4,method:8,paragraphContent:b});this.YL.postMessage(b);
return!0}GQk(b){if(2>b.length)return v.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;var k=b[0];b=b[1];k=Object.assign(new Gm,{api:4,method:9,paragraphContent:b,context:k});this.YL.postMessage(k);return!0}DQk(b){if(1>b.length)return v.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Gm,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.YL.postMessage(b);return!0}EQk(b){if(1>b.length)return v.ULS.sendTraceTag(556827920,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Gm,{api:4,method:13,textPredictionConfig:this.w7h(b)});this.YL.postMessage(b);return!0}FQk(b){if(1>
b.length)return v.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(ob.a)(Object,b[0])),!1;b=b[0];b=Object.assign(new Gm,{api:4,method:14,textPredictionConfig:this.w7h(b)});this.YL.postMessage(b);return!0}getConfig(b=null){return Object.assign(new FC,{scriptDirectory:w.AFrameworkApplication.o5+"/intelligence/",settings:Object.assign(new GC,{extendedRankLimit:0}),modelFilesUrl:b})}w7h(b=
null){return Object.assign(new FC,{scriptDirectory:w.AFrameworkApplication.o5+"/intelligence/",settings:Object.assign(new GC,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}Object(n.a)(HC,"LocalInferenceWorkerApiMain",Zv,[]);class bD extends Zv{constructor(b){super(b);w.AFrameworkApplication.$H(()=>{this.ZJb()})}callMethod(b){v.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}Z3d(b){v.ULS.sendTraceTag(591689870,
3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}ZJb(){const b=Object.assign(new Lw.a,{api:3,method:6});this.YL.postMessage(b)}}Object(n.a)(bD,"ShutdownWorkerApiMain",Zv,[]);class IC{constructor(b){this.container=b}z7k(b,k){let t=null;switch(k){case 0:t=new EC(b);break;case 2:t=new $v(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));break;case 3:t=new bD(b);break;case 4:t=new HC(b,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));
break;default:v.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",k)}return t}}Object(n.a)(IC,"WordWebWorkerApiFactory",null,[526]);var xD=c(320);class XA{constructor(b,k){this.name=b;this.format=k}}Object(n.a)(XA,"ImportedScript",null,[]);class Ls{constructor(){this.Yje=this.iPb=this.ngj=null}}Object(n.a)(Ls,"WebWorkerConfig",null,[]);var cD=c(1435);class dD{constructor(b){this.ohh=[];this.K7j=b;if(w.AFrameworkApplication.K){b=w.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||
w.AFrameworkApplication.K.$("IsCombinedBundleEnabled");const t=w.AFrameworkApplication.K.jb("ContentBaseUrl")?6:5;var k=w.AFrameworkApplication.K.jb("AppScriptBaseName");const D=b?"":".";if(k){const P=b?"":"{0}";k+=`${D}${P}worker.js`;this.ohh.push(new XA(`MicrosoftAjax${b?"":"DS"}.${P}js`,t),new XA(k,t))}else v.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else v.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=
[],k=Object.assign(new Ls,{ngj:"workerboot",iPb:this.ohh,Yje:[0,2,3,4]});this.K7j&&this.LHm()&&k.iPb.push(new XA("intelligence/edge-inference-web.js",5));b.push(k);return b}LHm(){return(new xD.a("arrowFunction",()=>{try{Object(cD.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}}Object(n.a)(dD,"WordWebWorkerConfigFactory",null,[250]);class $q{constructor(){this.Ma=this.W=null}get name(){return"WordEditor.Workers"}init(){const b=this.W.resolve("Box4.Workers.IWebWorkerRouter");
b.sendMessage.apply(b,[0,1].concat([this.Ma.appSettings,w.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}xc(b){this.W=b;this.Ma=this.W.resolve("Common.IAppSettingsManager");const k=this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ha("Box4.Workers.WebWorkerRouter",()=>new WA(new dD(k),new IC(b))).as("Box4.Workers.IWebWorkerRouter").singleInstance()}static main(){N.a.instance.Fc(new $q)}}Object(n.a)($q,"WordEditorWorkersPackage",null,[1,2]);var iq=c(1168);
class wy{constructor(){this.Nsd=[]}Mei(b,k){let t=-1,D=null;D=P=>{P?k(this.Nsd[t]):(++t,t<this.Nsd.length?this.Nsd[t].U1b(b,D):k(null))};D(!1)}U1b(b,k){this.Mei(b,t=>{k(!!t)})}lhc(b,k,t){this.Mei(b,D=>{if(!D)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");D.lhc(b,k,t)})}zoh(b){this.Nsd.push(b)}}Object(n.a)(wy,"CompositeExternalContentURLResolver",null,[530,227]);var nu=c(1429);class Zn extends nu.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=
null;this.Height=this.Width=0;this.ProviderName=this.IFrameHtml=null}}Object(n.a)(Zn,"ExternalContentEmbedResponse",nu.a,[]);var eD=c(1445),fD=c(1828),gD=c(1827),hD=c(1348),iD=c(706),az=c(495),Ms=c(170),Mw=c(855),jq;(function(b){b[b.autoCorrect=0]="autoCorrect";b[b.externalComponentPaste=1]="externalComponentPaste";b[b.externalHyperlinkPaste=2]="externalHyperlinkPaste";b[b.adp=3]="externalContentFloatieConversion"})(jq||(jq={}));Object(n.b)("ExternalContentConversionContext",jq);class oh{constructor(){this.pIb=
this.oIb=null;this.Sif=new hD.ExternalContentEmbedRetriever;this.JAc=!0;this.Bsc=this.ko=this.boi=this.aoi=this.Nl=this.Fp=null;this.picturePasteRequestSucceeded=()=>{v.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.Gfc=()=>{v.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=oh.Wma&&oh.Wma.q6h()}get sOb(){return this.JAc}set sOb(b){this.JAc=b}s5e(b,k){let t=!1;if(b){switch(b.contextId){case lc.a.Tc:t=!k;
break;case lc.a.Hd:t=!0}t&&!Mw.a(b.node)&&(t=!1)}return t}iTm(b){const k=b.startsWith(re.HyperlinkReader.jgc),t=b.startsWith(re.HyperlinkReader.c2c),D=b.startsWith(re.HyperlinkReader.uae);return(k||t||D)&&re.HyperlinkReader.n3a(b)}L5i(){this.ko=X.a.create();oh.uf.eBb(this.ko,4);oh.uf.P4(this.ko,0,oh.uf.xn());this.qGb(this.oIb,3,this.pIb,!0)}GPa(b,k,t){this.ko=X.a.create();oh.uf.eBb(this.ko,t?0:2);oh.uf.P4(this.ko,0,oh.uf.xn());this.Bsc();this.qGb(b,t?0:2,k)}E9d(b,k){this.ko=X.a.create();oh.uf.eBb(this.ko,
1);oh.uf.P4(this.ko,0,oh.uf.xn());this.qGb(b,1,k)}tWd(b,k,t,D){if(!b||!b.isConnected||!Be.ImageReader.gv(b))return null;const P=new iD.a;P.setValue(zi.a.B9b,t);P.setValue(zi.a.APa,k);P.ZZa=this.aoi;P.Pw=this.boi;P.providerName=D;P.p3a=1===t;ze.GraphIterator.$a(b).Hf(P,2);this.oYc(P);return P}J7i(b){this.Bsc=b}Mqe(b,k){const t=oh.W0.x4b(k)||0;k=oh.W0.F_a(k)||0;const D=b.Width/b.Height;1<=D?(b.Width=t,b.Height=t/D):(b.Height=k,b.Width=k/D)}xrg(b,k,t){if(null!=b&&null!=k&&!F.a.jf(t)){var D=oh.NZc.U7b(t);
w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",!1)?D.nqa=!1:D.nqa=!0;D.hideFloatie=!0;this.Mqe(b,k.node);this.b$b(b,k,!1,!1,D,t)}}Phb(b){return b?b.Qe:0}Qng(b,k,t){let D=null;const P=b.node;if(!pe.ParagraphReader.Wb(P)||!P.isConnected)return{returnValue:!1,Uqa:D};if(t)return{returnValue:!0,Uqa:b};t=b.cpBegin;const ca=b.cpEnd,ta=pe.ParagraphReader.text(P);if(0<=t&&ca<=ta.length&&ta.substring(t,ca)===
k)return{returnValue:!0,Uqa:b};const Na=ta.indexOf(k);return 0<=Na?(D=Of.a.createTextRange(P,Na,Na+k.length),{returnValue:!0,Uqa:D}):0<=t&&ca<=ta.length&&this.g9b(b)?{returnValue:!0,Uqa:b}:{returnValue:!1,Uqa:D}}g9b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var k=Of.a.createTextRange(b.node,b.cpBegin,b.cpEnd);k=re.HyperlinkReader.MD(k,!1);if(1===k.length){k=k[0];const t=pe.ParagraphReader.text(b.node).substring(k.cpBegin,k.cpEnd).trim();if(b.cpEnd===k.cpEnd&&k.hyperlink.url!==t)return!0}return!1}YGf(b){return null==
b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}y7a(b,k){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$(k)&&window.setTimeout(()=>{const t=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");t&&t.execute(D=>{D.logActivity(b,k)})},oh.wDa)}Cpf(b,k){const t=!F.a.x7(k);switch(b){case 1:b=t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,k):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;
break;default:b=t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,k):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}qGb(b,k,t,D=!1){if(this.iTm(t)){var P=oh.NZc.U7b(t);if(P)if(this.YGf(P)){v.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(Ka.a)(Of.a,b);var ca=!k;this.s5e(b,ca)?this.TTc(t)?(k=1===k,D=this.KVl(b),P.hideFloatie=!0,this.b$b(D,
b,ca,k,P,t)):this.f_f(b,k,P,t,D):oh.uf.DQ(this.ko,2,"URL inserted in Non-Embedable context",oh.uf.xn())}else v.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),oh.uf.DQ(this.ko,2,"Size provided is not valid for OEmbed",oh.uf.xn())}else v.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),oh.uf.DQ(this.ko,2,"URL inserted is not valid for ExternalContent",oh.uf.xn())}KVl(b){const k=new Zn;k.Width=
oh.W0.x4b(b.node)||0;k.Height=oh.W0.F_a(b.node)||0;k.Title="Fluid Component";k.MediaType="fluid";return k}TTc(b){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=oh.O8&&oh.O8.mBi(b)}f_f(b,k,t,D,P){const ca=!k,ta=1===k,Na=oh.W0.x4b(b.node)||0,qb=oh.W0.F_a(b.node)||0,Jb=eD.a.b9e(t.jng,!0,Na,qb);this.SXc(b,D,k,!0);this.Sif.iCh(Jb,Vb=>{oh.uf.P4(this.ko,4,oh.uf.xn());oh.uf.J6c(this.ko,this.Phb(Vb.data));if(Vb=this.l_f(Vb)){v.ULS.sendTraceTag(592307859,
324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var ac=Ms.q(Vb.MediaType);oh.uf.jce(this.ko,7,ac);ac=b;({Uqa:ac}=this.Qng(b,D,ta)).returnValue?(this.SXc(ac,D,k,!1),null==t.width?0<Na&&Vb.Width>Na&&(v.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Vb.Width=Na):(v.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),
Vb.Width=this.xbd(t.width,Vb.Width,Na)),null==t.height?0<qb&&Vb.Height>qb&&(v.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Vb.Height=qb):(v.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Vb.Height=this.xbd(t.height,Vb.Height,qb)),oh.Wma.E9a||P?this.b$b(Vb,ac,ca,ta,t,D):(this.oIb=b,this.pIb=D,this.RHc(D))):(v.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),
oh.uf.DQ(this.ko,2,"No conversion as the context is no longer valid for the external content conversion",oh.uf.xn()));ta&&this.JZa(ac.node)}else ta&&this.JZa(b.node),oh.uf.DQ(this.ko,1,"URL not oEmbedable",oh.uf.xn())},Vb=>{oh.uf.P4(this.ko,4,oh.uf.xn());oh.uf.J6c(this.ko,this.Phb(Vb.data));ta&&this.JZa(b.node);v.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Vb.data.xe);oh.uf.DQ(this.ko,2,"ExternalContentEmbedRequest failed",oh.uf.xn())},Vb=>{ta&&this.JZa(b.node);
v.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Vb)},this.ko)}xbd(b,k,t){!b&&0<t&&k>t||b>t?(v.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),k=t):b>t?k=t:b&&b<t&&(k=b);return k}b$b(b,k,t,D,P,ca){this.Nl=lb.a.create();b.Width=b.Width/b.Height*(b.Height-(az.a.PQc+az.a.j3))+2*az.a.j3;const ta=new Xd.GraphTransaction(15);ta.Cb(k.node);ta.fk=Nc.a.GPa;const Na=this.g9b(k);null!=P.nqa&&!P.nqa||
D||Na||(b.Title=""===P.title||P.title?P.title:b.Title,!b.Title&&""!==b.Title)||(k=this.CAf(k,ta,b.Title,ca,t));if(k){D&&(k=this.idf(k));var qb=this.DGd(k,D);if(qb){t=Ms.q(b.MediaType);var Jb=this.wRd(b,t);this.aoi=b.IFrameHtml;this.boi=b.Title;if(qb=this.kAf(qb,Jb,ta,D,ca,t,b.ProviderName))ta.VFa(this.Nl,1),ta.dispose(),this.oIb=k,this.pIb=ca,this.bXf(P,b,qb),this.UZf(ca,D||P.hideFloatie,Na,t,b.Title)}else ta.dispose(),v.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),
oh.uf.DQ(this.ko,2,"Could not create IP context on splitting the paragraph",oh.uf.xn())}else oh.uf.DQ(this.ko,2,"GraphNodeContext is null",oh.uf.xn())}wRd(b,k){const t=new th.DictionaryPropertySet;oh.NO.J$d(t,b.Width,b.Height);b=this.Bpf(k,b.Title);t.setValue(sf.a.imageAltText,b);t.setValue(Cc.a.kU,Ne.a.vF());t.setValue(Cc.a.imageType,0);return t}kAf(b,k,t,D,P,ca,ta){if(!b)return null;b=oh.NO.xWd(b,k);if(!b)return t.dispose(),v.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),
oh.uf.DQ(this.ko,2,"The anchored image could not be inserted",oh.uf.xn()),null;t=b.node;P=this.tWd(t,P,ca,ta);oh.uf.lmg(this.ko,P.id);D||this.eag(t);return t}bXf(b,k,t){F.a.x7(b.thumbnailUrl)||(k.Thumbnail=b.thumbnailUrl);k.Thumbnail&&k.Thumbnail.length&&(oh.uf.P4(this.ko,8,oh.uf.xn()),v.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.VId(t,k.Thumbnail))}UZf(b,k,t,D,P){k||this.RHc(b);this.y7a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");
this.I8d("IsHyperlinkWithNonURLDisplayText",t);this.ariaNotify(D,P);oh.uf.P4(this.ko,5,oh.uf.xn())}I8d(b,k){v.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");ea.a.sendTelemetryEvent(Object.assign(new pa.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new na.a,{name:b,bool:k})]}))}ariaNotify(b,k){this.sOb&&oh.su&&(b=this.Cpf(b,k),oh.su.sendNotification(b,!0))}CAf(b,k,t,D,P){if(P){if((P=re.HyperlinkReader.MD(b,
!1))&&1!==P.length)return k.dispose(),v.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;oh.hyperlinkEditor.CR(P[0].paragraph,P[0].hyperlink)}return this.x6f(b,t,D)}idf(b){const k=b.node,t=pe.ParagraphReader.text(k);return 0<t.length&&!t.trim().length?(b=Of.a.createTextRange(k,0,t.length),oh.characterPropertiesEditor.replaceTextRange(b,""),Of.a.Rc(k,0)):b}DGd(b,k){return k?b:this.Aqf(b)}Aqf(b){const k=pe.ParagraphReader.text(b.node),
t=ze.GraphIterator.$a(b.node);if(t.yd()){b=Of.a.Rc(b.node,b.cpEnd);ag.OutlineElementNavigator.Vd(t);const D=oh.lg.aoa(t);oh.nh.N9(t,D,b,!0,!0,!0,!0);""!=k&&oh.nh.yB(t,!1,!0);t.Qd();return Of.a.Rc(t.currentNode,0)}return null}l_f(b){if(!({group:b}=sn.a.l1(b.data.xe)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}x6f(b,k,t){const D=b.cpBegin+k.length;oh.characterPropertiesEditor.replaceTextRange(b,k);b=Of.a.createTextRange(b.node,b.cpBegin,D);oh.hyperlinkEditor.hG(b,t,!1);return b}Bpf(b,
k){const t=!F.a.x7(k);switch(b){case 1:return t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,k):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,k):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}VId(b,k){b.Bi().contentReplicator.forceOutbound(()=>{this.j_f(k,b)},()=>{v.ULS.sendTraceTag(592996173,
324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}oYc(b){b=ze.GraphIterator.$a(b);b.zb(12);b.hd(12);b.Nn.rQ=!0}JZa(b){b.Bfc=null}eag(b){b=ze.GraphIterator.$a(b);b.zb(11)&&(b.hd(11),b.yd()&&b.Rj()&&b.Qd()&&pe.ParagraphReader.Wb(b.currentNode)&&(b=Gf.SelectionFactory.te(b.currentNode,0),af.a.instance.setSelection(b)))}SXc(b,k,t,D){const P=b.cpBegin,ca=b.cpEnd;b=pe.ParagraphReader.text(b.node).trim();P||b!==k&&""!==b?P?ca===b.length?v.ULS.sendTraceTag(590958601,324,
50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",jq[t],D):0<P&&ca<b.length&&v.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",jq[t],D):v.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
jq[t],D):v.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",jq[t],D)}RHc(b){this.E4b();const k=new vt.a(1,w.AFrameworkApplication.isRtl);k.$0c=b;oh.qgb.$2c(k)}E4b(){const b=new Ds.a(!0);oh.j9.SGa(b)}j_f(b,k){if(b=this.Hsf(b,k))k=Array(1),k[0]=b,b=fD.a.construct(k,!1,w.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Fp.rr:null),k=this.nbf(),
this.Ynb(k,b)}Hsf(b,k){if(!k)return v.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Fp=k.Bi();(new ze.GraphIterator).set(k);if(!k.anchor||!k.anchor.aq||!k.anchor.aq.xr)return v.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var t=k.anchor.aq.xr.node;if(!t)return v.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),
null;t=t.ia(ke.a.uJ,Wh.a.yt);const D=k.getValue(sf.a.FK),P=Re.a.xf(Be.ImageReader.ND(k.properties),0),ca=Re.a.xf(Be.ImageReader.dJ(k.properties),1);return gD.a.construct(k.id.toString(),b,k.ia(sf.a.imageAltText,""),P,ca,k.ia(Cc.a.NX,""),t,k.ia(Cc.a.kU,0),k.ia(Cc.a.gha,!1),k.ia(ke.a.Wfa,-1),k.ia(Cc.a.Tkb,Box4Intl.Box4Strings.l_Picture),k.ia(sf.a.Ewa,!1),D,k.ia(Cc.a.runId,1),k.ia(Cc.a.Lc,0))}Ynb(b,k){w.AFrameworkApplication.Ne.sj(b,2,G.c(k),{},!1,2,this.picturePasteRequestSucceeded,this.Gfc,null,void 0,
void 0,void 0,void 0,"26");v.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}nbf(){let b=ia.a.FMc("PicturePaste.ashx");w.AFrameworkApplication.K&&!w.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=ia.a.eo(b,Bi.a.fileId,this.Fp.rr));b=ia.a.eo(b,Bi.a.cellId,this.Fp.wm.toString());this.Nl||(this.Nl=lb.a.create(),v.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=ia.a.eo(b,Bi.a.xT,this.Nl.toString());
b=ia.a.eo(b,Bi.a.classId,(393233).toString());this.Fp.CH&&(b=ia.a.eo(b,Bi.a.CH,this.Fp.CH));b=ia.a.eo(b,Bi.a.vqb,"1");b=ia.a.eo(b,Rh.a.imageType,"0");b=uh.a.instance.zZe(b);this.Fp.contentReplicator&&this.Fp.contentReplicator.XHb&&(b=ia.a.eo(b,Bi.a.h3e,"1"));b=ia.a.eo(b,Bi.a.Qta,this.Fp.contentReplicator.wt.toString());b=ia.a.eo(b,Bi.a.zfc,"0");return b=ia.a.eo(b,Bi.a.PQb,"1")}static get qgb(){return null!=oh.$xg?oh.$xg:oh.$xg=Fa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get Wma(){oh.rAa||
(oh.rAa=Fa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return oh.rAa}static get j9(){return null!=oh.mFg?oh.mFg:oh.mFg=Fa.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get su(){return null!=oh.Tvg?oh.Tvg:oh.Tvg=Fa.a.instance.resolve("Common.Utils.IAriaNotifier")}static get W0(){return null!=oh.nGg?oh.nGg:oh.nGg=Fa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get NO(){return null!=oh.LAg?oh.LAg:oh.LAg=Fa.a.instance.resolve("WordEditor.IImageEditor")}static get lg(){return oh.nh||
(oh.nh=Fa.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hyperlinkEditor(){return null!=oh.DAg?oh.DAg:oh.DAg=Fa.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=oh.zwg?oh.zwg:oh.zwg=Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get uf(){return null!=oh.iyg?oh.iyg:oh.iyg=Fa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get NZc(){return null!=oh.ZDg?oh.ZDg:oh.ZDg=Fa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get O8(){return null!=
oh.RDg?oh.RDg:oh.RDg=Fa.a.instance.resolve("Fluid.Host.LoopComponentManager")}}oh.nh=null;oh.wDa=5E3;oh.rAa=null;Object(n.a)(oh,"ExternalContentEditor",null,[212]);var JC=c(259),VE=c(1202);class yD{constructor(b,k){this.E9a=!0;this.C4a=t=>{if(null!=t.result)return t.result.Value;v.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");return this.E9a};this.oGa=t=>{t.zo||t.Ci?v.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):
(this.Zyh(t.result),v.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.E9a};this.xv=b;this.rK=k}q6h(){const b=new Cg.a;this.nAi()&&this.rK?this.rK.v5a(JC.a.rHc).CWRCo(this.C4a,0).CWRCo(this.oGa,8):b.Ag(this.E9a)}r1(b){this.rK&&this.rK.r1(JC.a.rHc,new VE.a(JC.a.rHc,b))}S8n(b){this.nAi()&&(this.xv.Via("saveConvertExternalContentIsEnabled",b.toString()),v.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),
this.Zyh(b),this.r1(b))}nAi(){const b=w.AFrameworkApplication.K.$("IsAnonymousUser");if(w.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)v.ULS.sendTraceTag(559437387,324,50,"User is anonymous ");else return!0;return!1}Zyh(b){this.E9a=b}}Object(n.a)(yD,"ExternalContentSettingInfo",null,[533]);var WE=c(1139);class fE{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(n.a)(fE,"FluidComponentProperties",
null,[]);class KF{constructor(){this.loopType=this.Pw=this.ZZa=this.url=null;this.mediaType=0;this.iKi=null}}Object(n.a)(KF,"IFrameProps",null,[]);class Gl{static get W0(){return null!=Gl.lGg?Gl.lGg:Gl.lGg=Fa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get NO(){return Gl.Oj||(Gl.Oj=Fa.a.instance.resolve("WordEditor.IImageEditor"))}static get su(){return null!=Gl.Svg?Gl.Svg:Gl.Svg=Fa.a.instance.resolve("Common.Utils.IAriaNotifier")}static get hyperlinkEditor(){return null!=
Gl.xAg?Gl.xAg:Gl.xAg=Fa.a.instance.resolve("Box4.IHyperlinkEditor")}static get lg(){return null!=Gl.sEg?Gl.sEg:Gl.sEg=Fa.a.instance.resolve("Box4.IOutlineElementEditor")}static get characterPropertiesEditor(){return null!=Gl.xwg?Gl.xwg:Gl.xwg=Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static n3a(b){const k=b.startsWith(re.HyperlinkReader.jgc),t=b.startsWith(re.HyperlinkReader.c2c),D=b.startsWith(re.HyperlinkReader.uae);return(k||t||D)&&re.HyperlinkReader.n3a(b)}static s5e(b,k){let t=
!1;if(b){switch(b.contextId){case lc.a.Tc:t=!k;break;case lc.a.Hd:t=!0}t&&!Mw.a(b.node)&&(t=!1)}return t}static g9b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var k=Of.a.createTextRange(b.node,b.cpBegin,b.cpEnd);k=re.HyperlinkReader.MD(k,!1);if(1===k.length){k=k[0];const t=pe.ParagraphReader.text(b.node).substring(k.cpBegin,k.cpEnd).trim();if(b.cpEnd===k.cpEnd&&k.hyperlink.url!==t)return!0}return!1}static Bpf(b,k){const t=!F.a.x7(k);switch(b){case 1:return t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,
k):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,k):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static oYc(b){b=ze.GraphIterator.$a(b);b.zb(12);b.hd(12);b.Nn.rQ=!0}static wRd(b,k,t,D){const P=new th.DictionaryPropertySet;Gl.NO.J$d(P,k,b);b=Gl.Bpf(D,t);P.setValue(sf.a.imageAltText,b);P.setValue(Cc.a.kU,Ne.a.vF());P.setValue(Cc.a.imageType,
0);return P}static tWd(b,k,t){if(!b||!b.isConnected||!Be.ImageReader.gv(b))return null;const D=new iD.a;D.setValue(zi.a.B9b,k.mediaType);D.setValue(zi.a.APa,k.url);D.setValue(vd.a.loopComponentType,k.loopType);D.ZZa=k.ZZa;D.Pw=k.Pw;D.providerName=t;D.p3a=1===k.mediaType;D.createMode=k.iKi;ze.GraphIterator.$a(b).Hf(D,2);Gl.oYc(D);return D}static DGd(b,k){return k?b:Gl.Aqf(b)}static Aqf(b){const k=pe.ParagraphReader.text(b.node),t=ze.GraphIterator.$a(b.node);if(t.yd()){b=Of.a.Rc(b.node,b.cpEnd);ag.OutlineElementNavigator.Vd(t);
const D=Gl.lg.aoa(t);Gl.lg.N9(t,D,b,!0,!0,!0,!0);""!=k&&Gl.lg.yB(t,!1,!0);t.Qd();return Of.a.Rc(t.currentNode,0)}return null}static eag(b){b=ze.GraphIterator.$a(b);b.zb(11)&&(b.hd(11),b.yd()&&b.Rj()&&b.Qd()&&pe.ParagraphReader.Wb(b.currentNode)&&(b=Gf.SelectionFactory.te(b.currentNode,0),af.a.instance.setSelection(b)))}static Cpf(b,k){const t=!F.a.x7(k);switch(b){case 1:b=t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,k):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;
break;default:b=t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,k):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,k){Gl.su&&(b=Gl.Cpf(b,k),Gl.su.sendNotification(b,!0))}static I8d(b,k,t){v.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");ea.a.sendTelemetryEvent(Object.assign(new pa.a,{name:t,dataFields:[Object.assign(new na.a,
{name:b,bool:k})]}))}}Object(n.a)(Gl,"ExternalContentHelper",null,[]);var Nw=c(727);class bz{constructor(){this.Nl=this.Fp=null}VId(b,k,t){b.Bi().contentReplicator.forceOutbound(()=>{this.j_f(k,b,t)},()=>{v.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}j_f(b,k,t){if(b=this.Hsf(b,k))k=Array(1),k[0]=b,t=fD.a.construct(k,t,w.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Fp.rr:null),b=this.nbf(),this.Ynb(b,
t)}Hsf(b,k){if(!k)return v.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Fp=k.Bi();(new ze.GraphIterator).set(k);if(!k.anchor||!k.anchor.aq||!k.anchor.aq.xr)return v.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var t=k.anchor.aq.xr.node;if(!t)return v.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),
null;t=t.ia(ke.a.uJ,Wh.a.yt);const D=k.getValue(sf.a.FK),P=Re.a.xf(Be.ImageReader.ND(k.properties),0),ca=Re.a.xf(Be.ImageReader.dJ(k.properties),1);return gD.a.construct(k.id.toString(),b,k.ia(sf.a.imageAltText,""),P,ca,k.ia(Cc.a.NX,""),t,k.ia(Cc.a.kU,0),k.ia(Cc.a.gha,!1),k.ia(ke.a.Wfa,-1),k.ia(Cc.a.Tkb,Box4Intl.Box4Strings.l_Picture),k.ia(sf.a.Ewa,!1),D,k.ia(Cc.a.runId,1),k.ia(Cc.a.Lc,0))}Ynb(b,k){w.AFrameworkApplication.Ne.sj(b,2,G.c(k),{},!1,2,this.picturePasteRequestSucceeded.bind(this),this.Gfc.bind(this),
null,void 0,void 0,void 0,void 0,"26");v.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}picturePasteRequestSucceeded(){v.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}Gfc(){v.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")}nbf(){let b=ia.a.FMc("PicturePaste.ashx");w.AFrameworkApplication.K&&!w.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=ia.a.eo(b,
Bi.a.fileId,this.Fp.rr));b=ia.a.eo(b,Bi.a.cellId,this.Fp.wm.toString());this.Nl||(this.Nl=lb.a.create(),v.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=ia.a.eo(b,Bi.a.xT,this.Nl.toString());b=ia.a.eo(b,Bi.a.classId,(393233).toString());this.Fp.CH&&(b=ia.a.eo(b,Bi.a.CH,this.Fp.CH));b=ia.a.eo(b,Bi.a.vqb,"1");b=ia.a.eo(b,Rh.a.imageType,"0");b=uh.a.instance.zZe(b);this.Fp.contentReplicator&&this.Fp.contentReplicator.XHb&&(b=ia.a.eo(b,Bi.a.h3e,"1"));
b=ia.a.eo(b,Bi.a.Qta,this.Fp.contentReplicator.wt.toString());b=ia.a.eo(b,Bi.a.zfc,"0");return b=ia.a.eo(b,Bi.a.PQb,"1")}}Object(n.a)(bz,"ExternalContentThumbnailHelper",null,[]);class ar extends bz{constructor(){super(...arguments);this.ko=null}static get uf(){return null!=ar.hyg?ar.hyg:ar.hyg=Fa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}EIj(b,k,t){return Gl.n3a(k)?Gl.s5e(b,t)?!0:(ar.uf.DQ(this.ko,2,"URL inserted in Non-Embedable context",ar.uf.xn()),!1):(v.ULS.sendTraceTag(591267584,
324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),ar.uf.DQ(this.ko,2,"URL inserted is not valid for ExternalContent",ar.uf.xn()),!1)}}Object(n.a)(ar,"AbstractExternalContentEditor",bz,[212]);var WB=c(1166),zD=c(1169);class Pq extends ar{constructor(b){super();Pq.KWa=b;this.IJf()}IJf(){this.zng&&zD.a.IJf(Pq.KWa.X6h())}static get paragraphEditor(){return null!=Pq.REg?Pq.REg:Pq.REg=Fa.a.instance.resolve("Box4.IParagraphEditor")}s9k(b,k){k=this.Iai(b,k);this.bri(k,b,5)}GPa(b,
k,t){if(this.EIj(b,k,t)){var D=this.Iai(b,null);D.url=k;this.bri(D,b,t?0:2)}}E9d(b,k){this.GPa(b,k,!1)}bri(b,k,t){this.Nl=lb.a.create();const D=new Xd.GraphTransaction(15);D.Cb(k.node);D.fk=Nc.a.Lzm;const P=Gl.g9b(k),ca=Ms.q(b.mediaType),ta=Gl.wRd(b.height,b.width,b.title,ca);k=this.mTo(k,1==t);(k=Gl.Oj.xWd(k,ta))?(k=k.node,Gl.tWd(k,{url:b.url,mediaType:ca,Pw:b.title,loopType:b.type,iKi:t},void 0)||v.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),D.VFa(this.Nl,
1),D.dispose(),this.VId(k,b.thumbnail,!1),this.dDn(P,ca,b.type)):v.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}mTo(b,k){Gl.characterPropertiesEditor.replaceTextRange(b,"");return Gl.DGd(b,k)}dDn(b,k,t){Gl.I8d("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");Gl.ariaNotify(k,this.ALl(t))}ALl(b){switch(b){case Nw.a.CheckList:return"Checklist Component";case Nw.a.TaskAssignment:return"Task List Component";case Nw.a.Poll:return"Poll Component";
default:return"Fluid Component"}}Iai(b,k){const t=new fE;t.width=Gl.W0.x4b(b.node)||0;Ms.j()?t.height=null!=Pq.KWa&&Pq.KWa.V6h(k)||Gl.W0.F_a(b.node)||0:t.height=null!=Pq.KWa&&Pq.KWa.V6h(k)+2*az.a.j3||Gl.W0.F_a(b.node)||0;t.title="Fluid Component";t.mediaType="fluid";t.type=k;t.thumbnail=this.LVl();t.url=null!=Pq.KWa&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2210.23001/en-us_web/assets/fallback.jpg";return t}LVl(){return Pq.KWa.X6h()}get zng(){return null!=
this.NIg?this.NIg:this.NIg=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.useUpdatedFluidThumbailEnabledV3",!1)}static TTc(b){w.AFrameworkApplication.ue("2cejb611;b0jjh576");return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=Pq.KWa&&Pq.KWa.mBi(b)&&WB.a.yVk(b)}}Object(n.a)(Pq,"FluidComponentEditor",ar,[]);class XB{get nxl(){return null!=this.Zxg?this.Zxg:this.Zxg=Fa.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get vMd(){return null!=
this.qzg?this.qzg:this.qzg=Fa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}YCn(b,k){b&&(Pq.TTc(k)?this.vMd.GPa(b,k,!0):this.nxl.GPa(b,k,!0))}}Object(n.a)(XB,"PostHyperlinkAutoCorrectStrategy",null,[532]);class oj{U1b(b,k){k(oj.iDn.test(b))}lhc(b,k){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",
960,960,b);b=Object.assign(new Zn,{OperationId:0,StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:oj.thumbnailUrl,Title:"Power BI",IFrameHtml:b});k(b)}}oj.iDn=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$","i");oj.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(n.a)(oj,"PowerBIURLResolver",null,[530,227]);class KC{constructor(b){this.Vjh=b}U1b(b,k){let t=!1;try{if(KC.nRm(b)){const D=this.Vjh.U7b(b);t=null!=D.width&&null!=D.height&&
!!D.thumbnailUrl&&!!D.title&&null!=D.nqa}}catch(D){}k(t)}lhc(b,k){var t=this.Vjh.U7b(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",
t.width,t.height,b);t=Object.assign(new Zn,{Height:t.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:t.thumbnailUrl,Title:t.title,Width:t.width});k(t)}static nRm(b){for(const k of KC.LCo)if(b.startsWith(k))return!0;return!1}static G7(){return new KC(Fa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}KC.LCo=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(n.a)(KC,"WedgeComponentExperimentsURLResolver",null,[530,
227]);var XE=c(871);class Qu{static mrj(b){Qu.Uxi||Qu.addEventListener();const k=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");k&&k.execute(t=>{t.logActivity(b,null)})}static addEventListener(){window.addEventListener(Qu.sDo,Qu.rDo,!0);Qu.Uxi=!0}static WXk(){const b=window.document.getElementById("LoopComponent");null===b||void 0===b?void 0:b.click()}}Qu.BFo="LoopsTeachingCalloutOnInsertTabActivity";Qu.R6m="LoopHomeTabFlightActivity";Qu.sDo="switchToInsertTabAndClickLoopButtonEvent";Qu.Uxi=
!1;Qu.rDo=()=>{var b,k;appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"));const t=null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.mc("WordLoopsTUIButtonDropdownDelayInMs",50);b=new Df.a(0,1,t,()=>{Qu.WXk()});null===(k=w.AFrameworkApplication.nc)||void 0===k?void 0:k.Vb(b)};Object(n.a)(Qu,"FluidComponentsTUIHelper",null,[]);class gE{constructor(b,k,t){this.ga=b;this.p2j=k;this.Ik=t;this.$0g=!1;this.r5g=1E3;this.s5g=15E3;this.XRe=this.NRe=!0;this.XRe=!!w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowLoopComponentSurveyEnabled",!1);this.r5g=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.LoopComponentDropdownFocusTime",1E3);this.s5g=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NotUseLoopComponentSurveyTriggerTime",15E3)}Tb(){this.ga.fb(Nc.a.hri,lc.a.Tc,this.hAm.bind(this),1028);this.ga.fb(Nc.a.r$d,lc.a.Tc,
this.r$d.bind(this),1028);this.ga.fb(Nc.a.FSc,lc.a.Tc,this.oAf.bind(this),1028);this.ga.fb(Nc.a.sSc,lc.a.Tc,this.oAf.bind(this),1028);this.ga.fb(Nc.a.xAf,lc.a.Tc,this.oAf.bind(this),1028);this.ga.fb(Nc.a.LEi,lc.a.Tc,this.DOj.bind(this),1028)}hAm(){return 32}r$d(b,k,t){if(2!==t)return 32;this.XRe&&(this.y$i(),this.UKo());return 32}oAf(b,k,t){var D,P,ca;if(1===t){if(!this.sYd(b)||!XE.a.zwi())return v.ULS.sendTraceTag(508937180,324,50,"Loops feature is disabled as it is not supported"),2;(null===(D=
w.AFrameworkApplication.K)||void 0===D?0:D.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsTUIEnabled",!1))&&Qu.mrj(Qu.BFo);if(!k.al||!hf.SelectionEditor.gf(k)||(null===(P=this.Ik)||void 0===P?0:P.i_(k))||(null===(ca=this.Ik)||void 0===ca?0:ca.iha(k)))return 2;if(k&&k.node&&Mw.a(k.node))return 32}else if(2===t)return this.p2j.s9k(k,gE.JVl(b)),this.y$i(),32;return 2}UKo(){null!=bb.a.instance.getItem("LoopComponentSurveyShowed")&&(this.NRe=!1);if(this.NRe){let b=this.Hai();window.setTimeout(()=>
{b&&"hidden"!==b.visibility&&(this.$0g=!0)},this.r5g);this.Gfk=window.setTimeout(()=>{const k=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");this.$0g&&k&&k.execute(t=>{(b=this.Hai())&&"hidden"===b.visibility&&(v.ULS.sendTraceTag(508941015,324,50,"Triggering not use loop component survey"),t.lTa("WordLoopFeedbackSurvey",null),this.NRe=!1,bb.a.instance.setItem("LoopComponentSurveyShowed","true"))})},this.s5g)}}Hai(){var b,k;let t=null;try{const D=document.getElementById("Ribbon-LoopComponentDropdown");
D&&(t=Co.a.sB(null===(k=null===(b=D.parentNode)||void 0===b?void 0:b.parentNode)||void 0===k?void 0:k.parentNode))}catch(D){v.ULS.sendTraceTag(508941014,324,10,"Loop component dropdown get parent and parent get exception "+(null!=D?D.toString():""))}return t}y$i(){this.XRe&&window.clearTimeout(this.Gfk)}sYd(b){return b===Nc.a.sSc||b===Nc.a.FSc?WB.a.sYd():!0}DOj(b,k,t){2===t&&F.a.uU("https://go.microsoft.com/fwlink/?linkid=2194838")&&Wa.App.L8f.Ulc("https://go.microsoft.com/fwlink/?linkid=2194838");
return 32}static JVl(b){switch(b){case Nc.a.FSc:return Nw.a.TaskAssignment;case Nc.a.sSc:return Nw.a.CheckList;case Nc.a.xAf:return Nw.a.Poll;default:return null}}}Object(n.a)(gE,"FluidComponentsActor",null,[]);class xj extends ar{constructor(){super();this.pIb=this.oIb=null;this.Sif=new hD.ExternalContentEmbedRetriever;this.Bsc=null;null!=xj.Wma&&xj.Wma.q6h()}L5i(){this.ko=X.a.create();xj.uf.eBb(this.ko,4);xj.uf.P4(this.ko,0,xj.uf.xn());this.qGb(this.oIb,3,this.pIb,!0)}GPa(b,k,t){this.ko=X.a.create();
xj.uf.eBb(this.ko,t?0:2);xj.uf.P4(this.ko,0,xj.uf.xn());this.Bsc();this.qGb(b,t?0:2,k)}E9d(b,k){this.ko=X.a.create();xj.uf.eBb(this.ko,1);xj.uf.P4(this.ko,0,xj.uf.xn());this.qGb(b,1,k)}J7i(b){this.Bsc=b}Mqe(b,k){const t=xj.W0.x4b(k)||0;k=xj.W0.F_a(k)||0;const D=b.Width/b.Height;1<=D?(b.Width=t,b.Height=t/D):(b.Height=k,b.Width=k/D)}xrg(b,k,t){if(null!=b&&null!=k&&!F.a.jf(t)){var D=xj.NZc.U7b(t);w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",
!1)?D.nqa=!1:D.nqa=!0;D.hideFloatie=!0;this.Mqe(b,k.node);this.b$b(b,k,!1,!1,D,t)}}Phb(b){return b?b.Qe:0}Qng(b,k,t){let D=null;const P=b.node;if(!pe.ParagraphReader.Wb(P)||!P.isConnected)return{returnValue:!1,Uqa:D};if(t)return{returnValue:!0,Uqa:b};t=b.cpBegin;const ca=b.cpEnd,ta=pe.ParagraphReader.text(P);if(0<=t&&ca<=ta.length&&ta.substring(t,ca)===k)return{returnValue:!0,Uqa:b};const Na=ta.indexOf(k);return 0<=Na?(D=Of.a.createTextRange(P,Na,Na+k.length),{returnValue:!0,Uqa:D}):0<=t&&ca<=ta.length&&
Gl.g9b(b)?{returnValue:!0,Uqa:b}:{returnValue:!1,Uqa:D}}YGf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}y7a(b,k){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$(k)&&window.setTimeout(()=>{const t=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");t&&t.execute(D=>{D.logActivity(b,k)})},xj.wDa)}qGb(b,k,t,D=!1){if(this.EIj(b,t,!k)){var P=xj.NZc.U7b(t);P&&(this.YGf(P)?(v.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),
this.f_f(b,k,P,t,D)):(v.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),xj.uf.DQ(this.ko,2,"Size provided is not valid for OEmbed",xj.uf.xn())))}}f_f(b,k,t,D,P){const ca=!k,ta=1===k,Na=xj.W0.x4b(b.node)||0,qb=xj.W0.F_a(b.node)||0,Jb=eD.a.b9e(t.jng,!0,Na,qb);this.SXc(b,D,k,!0);this.Sif.iCh(Jb,Vb=>{xj.uf.P4(this.ko,4,xj.uf.xn());xj.uf.J6c(this.ko,this.Phb(Vb.data));if(Vb=this.l_f(Vb)){v.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");
var ac=Ms.q(Vb.MediaType);xj.uf.jce(this.ko,7,ac);ac=b;({Uqa:ac}=this.Qng(b,D,ta)).returnValue?(this.SXc(ac,D,k,!1),null==t.width?0<Na&&Vb.Width>Na&&(v.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Vb.Width=Na):(v.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Vb.Width=this.xbd(t.width,Vb.Width,Na)),null==t.height?0<qb&&Vb.Height>qb&&(v.ULS.sendTraceTag(591681427,
324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Vb.Height=qb):(v.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Vb.Height=this.xbd(t.height,Vb.Height,qb)),xj.Wma.E9a||P?this.b$b(Vb,ac,ca,ta,t,D):(this.oIb=b,this.pIb=D,this.RHc(D))):(v.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),
xj.uf.DQ(this.ko,2,"No conversion as the context is no longer valid for the external content conversion",xj.uf.xn()));ta&&this.JZa(ac.node)}else ta&&this.JZa(b.node),xj.uf.DQ(this.ko,1,"URL not oEmbedable",xj.uf.xn())},Vb=>{xj.uf.P4(this.ko,4,xj.uf.xn());xj.uf.J6c(this.ko,this.Phb(Vb.data));ta&&this.JZa(b.node);v.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Vb.data.xe);xj.uf.DQ(this.ko,2,"ExternalContentEmbedRequest failed",xj.uf.xn())},Vb=>{ta&&this.JZa(b.node);
v.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Vb)},this.ko)}xbd(b,k,t){!b&&0<t&&k>t||b>t?(v.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),k=t):b>t?k=t:b&&b<t&&(k=b);return k}b$b(b,k,t,D,P,ca){this.Nl=lb.a.create();b.Width=b.Width/b.Height*(b.Height-(az.a.PQc+az.a.j3))+2*az.a.j3;const ta=new Xd.GraphTransaction(15);ta.Cb(k.node);ta.fk=Nc.a.GPa;const Na=Gl.g9b(k);null!=P.nqa&&!P.nqa||
D||Na||(b.Title=""===P.title||P.title?P.title:b.Title,!b.Title&&""!==b.Title)||(k=this.CAf(k,ta,b.Title,ca,t));if(k){D&&(k=this.idf(k));var qb=Gl.DGd(k,D);if(qb){t=Ms.q(b.MediaType);var Jb=Gl.wRd(b.Height,b.Width,b.Title,t);(qb=this.kAf(qb,Jb,D,{url:ca,ZZa:b.IFrameHtml,Pw:b.Title,mediaType:t},b.ProviderName))?(ta.VFa(this.Nl,1),ta.dispose(),this.oIb=k,this.pIb=ca,this.bXf(P,b,qb),this.UZf(ca,D||P.hideFloatie,Na,t,b.Title)):ta.dispose()}else ta.dispose(),v.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),
xj.uf.DQ(this.ko,2,"Could not create IP context on splitting the paragraph",xj.uf.xn())}else xj.uf.DQ(this.ko,2,"GraphNodeContext is null",xj.uf.xn())}kAf(b,k,t,D,P){if(!b)return null;b=xj.NO.xWd(b,k);if(!b)return v.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),xj.uf.DQ(this.ko,2,"The anchored image could not be inserted",xj.uf.xn()),null;b=b.node;D=Gl.tWd(b,D,P);xj.uf.lmg(this.ko,D.id);t||Gl.eag(b);return b}bXf(b,k,t){F.a.x7(b.thumbnailUrl)||
(k.Thumbnail=b.thumbnailUrl);k.Thumbnail&&k.Thumbnail.length&&(xj.uf.P4(this.ko,8,xj.uf.xn()),v.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.VId(t,k.Thumbnail,!1))}UZf(b,k,t,D,P){k||this.RHc(b);this.y7a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");Gl.I8d("IsHyperlinkWithNonURLDisplayText",t,"Office.Word.Online.ExternalContent.OEmbedInsertions");Gl.ariaNotify(D,P);xj.uf.P4(this.ko,5,xj.uf.xn())}CAf(b,k,t,
D,P){if(P){if((P=re.HyperlinkReader.MD(b,!1))&&1!==P.length)return k.dispose(),v.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Gl.hyperlinkEditor.CR(P[0].paragraph,P[0].hyperlink)}return this.x6f(b,t,D)}idf(b){const k=b.node,t=pe.ParagraphReader.text(k);return 0<t.length&&!t.trim().length?(b=Of.a.createTextRange(k,0,t.length),Gl.characterPropertiesEditor.replaceTextRange(b,""),Of.a.Rc(k,0)):b}l_f(b){if(!({group:b}=
sn.a.l1(b.data.xe)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}x6f(b,k,t){const D=b.cpBegin+k.length;Gl.characterPropertiesEditor.replaceTextRange(b,k);b=Of.a.createTextRange(b.node,b.cpBegin,D);Gl.hyperlinkEditor.hG(b,t,!1);return b}JZa(b){b.Bfc=null}SXc(b,k,t,D){const P=b.cpBegin,ca=b.cpEnd;b=pe.ParagraphReader.text(b.node).trim();P||b!==k&&""!==b?P?ca===b.length?v.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
jq[t],D):0<P&&ca<b.length&&v.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",jq[t],D):v.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",jq[t],D):v.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
jq[t],D)}RHc(b){this.E4b();const k=new vt.a(1,w.AFrameworkApplication.isRtl);k.$0c=b;xj.qgb.$2c(k)}E4b(){const b=new Ds.a(!0);xj.j9.SGa(b)}static get qgb(){return null!=xj.ayg?xj.ayg:xj.ayg=Fa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get Wma(){xj.rAa||(xj.rAa=Fa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return xj.rAa}static get j9(){return null!=xj.nFg?xj.nFg:xj.nFg=Fa.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get W0(){return null!=
xj.mGg?xj.mGg:xj.mGg=Fa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get NO(){return null!=xj.KAg?xj.KAg:xj.KAg=Fa.a.instance.resolve("WordEditor.IImageEditor")}static get NZc(){return null!=xj.YDg?xj.YDg:xj.YDg=Fa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}xj.wDa=5E3;xj.rAa=null;Object(n.a)(xj,"ExternalContentEditorV2",ar,[]);class hE{constructor(){this.ld=this.W=null}get name(){return"WordEditor.ExternalContent"}get Xb(){return this.ld?
this.ld:this.ld=this.W.resolve("Box4.IFeatureHelper")}xc(b){var k;this.W=b;b.ha("WordEditor.ExternalContent.ExternalContentSizeBehavior",()=>new iq.a(xn.a.instance,Vr.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").singleInstance();b.ha("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new XB).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").singleInstance();b.ha("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new yD(b.resolve("Box4.IRoamingServiceRequestManager"),
b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").singleInstance();w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ha("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new xj).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance(),b.ha("WordEditor.ExternalContent.FluidComponentEditor",()=>new Pq(b.resolve("Fluid.Host.LoopComponentManager"))).singleInstance(),
b.ha("WordEditor.ExternalContent.FluidComponentsActor",()=>new gE(w.AFrameworkApplication.va,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),Yj.a.instance)).singleInstance(),(null===(k=w.AFrameworkApplication.K)||void 0===k?0:k.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsHomeTUIEnabled",!1))&&Qu.mrj(Qu.R6m)):b.ha("WordEditor.ExternalContent.ExternalContentEditor",()=>new oh).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance()}init(){this.Xb.Mp.continueWith(()=>
{this.fn()});w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&this.W.resolve("WordEditor.ExternalContent.FluidComponentsActor").Tb()}dispose(){}k9k(){const b=new wy;this.ZUh()&&b.zoh(KC.G7());b.zoh(new oj);return b}fn(){null==w.AFrameworkApplication.K||w.AFrameworkApplication.K.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ha("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new WE.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").singleInstance();
this.ZUh()&&(this.W.ha("WordEditor.ExternalContent.IWordExternalContentURLResolver",()=>this.k9k()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").singleInstance(),this.W.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}ZUh(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",!1)}static main(){N.a.instance.Fc(new hE)}}Object(n.a)(hE,"ExternalContentPackage",null,[1,2]);var YA;
(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.decimal=6]="decimal";b[b.vap=7]="bar";b[b.qRa=8]="num"})(YA||(YA={}));Object(n.b)("TabStopValues",YA);class mp{}mp.dPh=8;mp.fhl=1;mp.W7="wwaengidc";mp.kpiName="WordRuler";mp.precision=.0625;mp.xEo=1;mp.hZo="ShowHideRuler";Object(n.a)(mp,"Constants",null,[]);var AD=c(752);class bs{static m8b(b,k){if(!bs.tVc)return null;switch(b){case "Left":return t=>
{const D=t.rulerCanvasProps;t=t.indents;return{zIb:0,hNb:D.scale-(D.margins[1].value+t[2].value+Math.max(t[0].value,t[1].value)+8*D.precision)}};case "Right":return t=>{const D=t.rulerCanvasProps;t=t.indents;return{zIb:0,hNb:D.scale-(t[2].value+(D.margins[0].value+Math.max(t[0].value,t[1].value))+8*D.precision)}};case "MoveTableColumn":return()=>{let t=0,D=0;if(0===k){var P={};32===bs.pc.Qb(Pb.a.xgc,2,P)&&(t=Ef.a.Ez(P.MinIndent),D=Ef.a.Ez(P.MaxIndent))}else P={wo:k-1},32===bs.pc.Qb(Pb.a.wgc,2,P)&&
(t=Ef.a.Ez(P.MinResize),D=Ef.a.Ez(P.MaxResize));return{zIb:t,hNb:D}};case "Top":return t=>{t=t.rulerCanvasProps;return{zIb:0,hNb:t.scale-(t.margins[1].value+8*t.precision)}};case "Bottom":return t=>{t=t.rulerCanvasProps;return{zIb:0,hNb:t.scale-(t.margins[0].value+8*t.precision)}}}return null}static KRd(b){if(!bs.tVc)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return k=>{var t=k.rulerCanvasProps,D=k.indents,P=k.ipContextIndex;k=t.margins;var ca=t.scale;t=t.precision;
if("MoveTableColumn"!==k[0].type){P=k[0].value;k=k[1].value+D[2].value;var ta=P;"LeftIndent"===b&&(ta+=Math.max(D[0].value,D[1].value));D=-1*P;t=ca-(ta+k+8*t)}else{ca=0;for(ta=0;ta<=P;ta++)ca+=k[ta].value;ta=0;if("LeftIndent"===b){ta=D[0].value;const Na=D[1].value;ca+=Math.max(ta,Na);ta=Math.max(ta,Na)}k=k[P+1].value;ta+=D[2].value;D=-1*ca;t=k-ta-t}return{zIb:D,hNb:t}};case "RightIndent":return k=>{var t=k.rulerCanvasProps,D=k.indents,P=k.ipContextIndex,ca=t.margins;k=t.scale;t=t.precision;if("MoveTableColumn"!==
ca[0].type){var ta=ca[0].value;ca=ca[1].value;P=D[0].value;var Na=D[1].value;D=-1*ca;k-=ta+ca+Math.max(P,Na)+8*t}else{ta=0;for(Na=0;Na<=P;Na++)ta+=ca[Na].value;ca=ca[P+1].value;P=D[0].value;Na=D[1].value;D=-1*(k-ta-ca);k=ca-Math.max(P,Na)-t}return{zIb:D,hNb:k}}}return null}static l$l(){return b=>{var k=b.rulerCanvasProps,t=b.indents,D=b.ipContextIndex,P=k.margins;b=k.precision;k=k.scale;"MoveTableColumn"!==P[0].type?(D=P[0].value,P=P[1].value+t[2].value,t=Math.min(t[0].value,t[1].value)+b,b=k-(D+
P+b)):(k=t[2].value,P=P[D+1].value,t=Math.min(t[0].value,t[1].value)+b,b=P-(k+b));return{zIb:t,hNb:b}}}static get pc(){return null!=bs.Jvg?bs.Jvg:bs.Jvg=w.AFrameworkApplication.va}static get tVc(){null==this.Eab&&(w.AFrameworkApplication.Aha("WoRul910;WoRul910cf"),this.Eab=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.Eab}}bs.Eab=null;Object(n.a)(bs,"RulerPropertyBoundaryHelper",null,[]);var LF=
c(920),MF=c(1462),BD=c(1048),YE=c(1231),NF=c(1232);class Ru{constructor(b,k,t,D,P,ca){this.Svn="OutlineContainer";this.ymk="UpdateCustomTabFailed";this.Hwb="ReadRulerPropertiesFailed";this.Cmk="UpdateIndentFailed";this.Kjh="UpdateMarginFailed";this.E7d=ta=>{ta.button===Sys.UI.MouseButton.rightButton&&this.lQe.show(new Sys.UI.Point(ta.clientX,ta.clientY),2)};this.sGj=()=>{this.eUa()};this.Vm=b;this.$Wb=k;this.ga=t;this.lQe=D;this.Ry=P;this.FS=ca;this.iUb=null;this.Fw=!!w.AFrameworkApplication.ta&&
w.AFrameworkApplication.ta.Nb.pJ;this.UUi=this.o7d.bind(this);this.EXi=this.Us.bind(this);this.rGj=this.eUa.bind(this)}wF(){this.lZe();this.Eoh();this.$Wb.Bl.Ze(10).Fo(this.UUi);vf.a.addHandler(this.RWe,Rc.a.scroll,this.sGj);this.Vm.execute(k=>{k.I0(this.EXi)});const b=[this.usf(),document.getElementById(wg.AppFrame.Hbd),document.getElementById("PageContentContainer")];this.iUb?this.iUb.register(b,this.rGj):BD.a(MF.a.appChromeLazyReady,()=>{appChrome.getResizeObserver().then(k=>{this.iUb=k.createResizeObserver();
this.iUb.register(b,this.rGj);return null})});Wa.App.ya.DI.registerBoundingWindowRectsChanged("documentPanel",(k,t)=>{"undefined"!==t&&this.R7a([1,0])})}usf(){return 1===this.FS.Uu?this.ydk:this.Xck}get RWe(){return document.getElementById(wg.AppFrame.rUa)}get Xck(){const b=document.getElementsByClassName(this.Svn);return b&&0<b.length?b[0]:null}get ydk(){var b=this.Ry.h6b;if(!b)return null;b=this.z$n(pe.ParagraphReader.LQ(b));return LF.a.Bci(b)}z$n(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+
b+"']"):null}get uN(){return this.Vm&&this.Vm.instance?this.Vm.instance.ij:mp.fhl}E7b(){const b={};return 32!==this.ga.Qb(Pb.a.NGa,2,b)?(v.ULS.sendTraceTag(529065947,YE.a.msoulscat_Wac_WordRuler,NF.a.warning,"Unable to read page properties for Ruler"),vm.recordQosError(this.Hwb,[vm.Bea],"Unable to read page properties for Ruler"),null):b}dispose(){this.Ymi();this.$Wb.Bl.Ze(10).QU(this.UUi);vf.a.removeHandler(this.RWe,Rc.a.scroll,this.sGj);this.Vm.execute(b=>{b.E5a(this.EXi)});this.iUb&&this.iUb.dispose();
Wa.App.ya.DI.unregisterBoundingWindowRectsChanged("documentPanel",(b,k)=>{"undefined"!==k&&this.R7a([1,0])})}get syi(){null==Ru.AFe&&(Ru.AFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&w.AFrameworkApplication.K.$("RulerThemingIsEnabled"):!1);return Ru.AFe}}Ru.AFe=null;Object(n.a)(Ru,"ARuler",null,[441]);var Su=c(290);class Ai extends Ru{constructor(b,k,t,
D,P,ca,ta){super(b,k,t,P,ca,ta);this.aP="HorizontalRuler";this.CMj="CustomTabModificationFromRuler";this.eOj="IndentModificationFromRuler";this.bqe="MarginModificationFromRuler";this.gYg=this.fYg=this._tabStops=null;this.dln=(Na,qb,Jb)=>{if(!(Na>=this._tabStops.length)){Na=this._tabStops[Na];var Vb="Modify"===Jb?this.ga.Qb(Nc.a.Edc,2,{["tabStop"]:Na,["value"]:Ef.a.Dv(qb)}):this.ga.Qb(Nc.a.y5a,2,Na);if(32===Vb){qb=1;var ac=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",
Jb,YA[Na.gda]);v.ULS.sendTraceTag(591213271,3014,50,ac)}else qb=0,ac=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",Jb,YA[Na.gda]),v.ULS.sendTraceTag(591213272,3014,15,ac),vm.recordQosError(this.ymk,[vm.Bea],"Unable to modify custom tab using ruler");bf.a(this.CMj,32===Vb,void 0,[Object.assign(new na.a,{name:"Operation",string:Jb}),Object.assign(new na.a,{name:"TabType",int64:YA[Na.gda]})]);Jb=new Map;Jb.set("Command","OnCustomTabChange");Jb.set("Source",this.aP);
Jb.set("Response",ac);xa.Health.instance.recordKpiUsage(mp.kpiName,qb,mp.W7,Jb)}};this.snn=(Na,qb)=>{var Jb=new AD.a;Jb.unit=1;Jb.value=Ef.a.Dv(qb);qb=8;switch(Na){case "FirstLineIndent":qb=this.ga.Qb(Pb.a.e7c,2,Jb);break;case "HangingIndent":qb=this.ga.Qb(Pb.a.f7c,2,Jb);break;case "LeftIndent":qb=this.ga.Qb(Pb.a.d2a,2,Jb);break;case "RightIndent":qb=this.ga.Qb(Pb.a.c2a,2,Jb)}let Vb;32===qb?(Jb=1,Vb=String.format("Indents set using Ruler. Indent: {0}",Na),v.ULS.sendTraceTag(592517017,3014,50,Vb)):
(Jb=0,Vb=String.format("Unable to set indent using Ruler. Indent: {0}",Na),v.ULS.sendTraceTag(592496523,3014,15,Vb,Na),vm.recordQosError(this.Cmk,[vm.Bea],"Unable to set indent using Ruler."));bf.a(this.eOj,32===qb,void 0,[Object.assign(new na.a,{name:"Type",string:Na})]);Na=new Map;Na.set("Command","OnIndentChange");Na.set("Source",this.aP);Na.set("Response",Vb);xa.Health.instance.recordKpiUsage(mp.kpiName,Jb,mp.W7,Na)};this.DUf=(Na,qb,Jb)=>{let Vb;Vb="Left"===Na?this.ga.Qb(Pb.a.Oia,2,Ef.a.Dv(qb)):
"Right"===Na?this.ga.Qb(Pb.a.s6a,2,Ef.a.Dv(qb)):Jb?this.ga.Qb(Pb.a.zke,2,{["columnIndex"]:Jb-1,["width"]:Ef.a.Dv(qb)}):this.ga.Qb(Pb.a.Xic,2,Ef.a.Dv(qb));32===Vb?(qb=1,Jb=String.format("Margins set using Ruler. Margin: {0}",Na),v.ULS.sendTraceTag(592517018,3014,50,Jb)):(qb=0,Jb=String.format("Unable to set margins using Ruler. Margin: {0}",Na),v.ULS.sendTraceTag(592496524,3014,15,Jb),vm.recordQosError(this.Kjh,[vm.Bea],"Unable to set margins using Ruler."));bf.a(this.bqe,32===Vb,void 0,[Object.assign(new na.a,
{name:"Type",string:Na})]);Na=new Map;Na.set("Command","OnMarginChange");Na.set("Source",this.aP);Na.set("Response",Jb);xa.Health.instance.recordKpiUsage(mp.kpiName,qb,mp.W7,Na)};this.dMa=D;this.lr={}}get iU(){return this.fYg}get KEa(){return this.gYg}renderRuler(){this.iU.classList.remove("HideWACHorizontalRulerContainer");this.iU.classList.add("ShowWACHorizontalRulerContainer");var b=this.E7b();if(b){var k=this.DUf,t=this.snn,D=this.dln,P=this.U$c(),ca=this.WAj(),ta=this.VAj();P&&ca&&ta||(this.lr.disabled=
!0);this.lr.onIndentChange=t;this.lr.onMarginChange=k;this.lr.onTabChange=D;this.eUa();b=Re.a.Ni(b.Ao,0);this.KEa.style.width=(b*this.uN).toString()+"px";return this.dMa().then(Na=>{Na.renderRuler(this.KEa,this.lr)})}}VAj(){const b=[];var k={};if(32!==this.ga.Qb(Nc.a.PLb,2,k))return v.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),vm.recordQosError(this.Hwb,[vm.Bea],"Unable to read paragraph tabs for Ruler"),!1;var t=k.customTabs;if(!t||0>=t.length)return this.lr.tabs=
b,!0;this._tabStops=t;k="";for(const D of t){switch(D.gda){case 1:k="LeftTab";break;case 4:k="RightTab";break;case 3:k="CenterTab";break;case 6:k="DecimalTab";break;case 7:k="BarTab"}t=Re.a.W4a(D.UHa,0);b.push({["type"]:k,["value"]:t,["getRulerPropertyBoundary"]:bs.l$l()})}this.lr.tabs=b;return!0}R7a(b){var k;if(this.iU){this.iU.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.lr&&delete this.lr.disabled;for(const t of b)switch(t){case 0:b=this.WAj();const D=this.VAj();b&&D||(this.lr.disabled=
!0);break;case 1:this.U$c()||(this.lr.disabled=!0)}if(null===(k=this.Ry.kb)||void 0===k?0:k.STc)this.lr.disabled=!0;this.dMa().then(t=>{t.renderRuler(this.KEa,this.lr);return null})}}U$c(){const b={};var k=this.E7b();if(!k)return!1;b.scale=Ef.a.Ez(k.Ao);b.precision=mp.precision;b.rulerType="Horizontal";if(!this.lun())return this.lr.ipContextIndex=0,this.lr.permittedUnits=mp.dPh,k=[{["type"]:"Left",["value"]:Ef.a.Ez(k.marginLeft),["getRulerPropertyBoundary"]:bs.m8b("Left",0)},{["type"]:"Right",["value"]:Ef.a.Ez(k.marginRight),
["getRulerPropertyBoundary"]:bs.m8b("Right",1)}],b.margins=k,this.lr.rulerCanvasProps=b,!0;var t={};k={};var D=this.ga.Qb(Pb.a.L2c,2,t);const P=this.ga.Qb(Pb.a.bMb,2,k);if(32!==D||32!==P)return v.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),vm.recordQosError(this.Hwb,[vm.Bea],"Unable to read table properties for Ruler"),!1;t=t.ColumnWidths;D=k.TablePosition;if(!D||!t||0>=t.length)return v.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),
vm.recordQosError(this.Hwb,[vm.Bea],"Cannot show table properties on the ruler as they are null"),!1;k=Array(t.length+1);k[0]={["type"]:"MoveTableColumn",["value"]:Ef.a.Ez(D.x/this.uN),["getRulerPropertyBoundary"]:bs.m8b("MoveTableColumn",0)};for(D=0;D<t.length;D+=1)k[D+1]={["type"]:"MoveTableColumn",["value"]:Ef.a.Ez(t[D]),["getRulerPropertyBoundary"]:bs.m8b("MoveTableColumn",D+1)};this.lr.ipContextIndex=this.$cm();this.lr.permittedUnits=mp.xEo;b.margins=k;this.lr.rulerCanvasProps=b;return!0}WAj(){var b=
{};if(32!==this.ga.Qb(Pb.a.j5a,2,b))return v.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),vm.recordQosError(this.Hwb,[vm.Bea],"Unable to read paragraph indentation for Ruler"),!1;const k={type:"FirstLineIndent"};k.getRulerPropertyBoundary=bs.KRd("FirstLineIndent");const t={type:"HangingIndent"};t.getRulerPropertyBoundary=bs.KRd("HangingIndent");const D={type:"RightIndent"};D.getRulerPropertyBoundary=bs.KRd("RightIndent");const P={type:"LeftIndent"};P.getRulerPropertyBoundary=
bs.KRd("LeftIndent");this.lr.rtl=b.isRtl;b=b.tt;k.value=1===b.specialIndentType?Ef.a.Ez(b.bda+b.xB):2===b.specialIndentType?Ef.a.Ez(b.xB-b.bda):Ef.a.Ez(b.xB);t.value=Ef.a.Ez(b.xB);P.value=Ef.a.Ez(b.xB);D.value=Ef.a.Ez(b.Xna);this.lr.indents=[k,t,D,P];return!0}Eoh(){vf.a.addHandler(this.iU,Rc.a.Kx,this.E7d)}Ymi(){this.iU&&(this.iU.classList.remove("ShowWACHorizontalRulerContainer"),this.iU.classList.add("HideWACHorizontalRulerContainer"),vf.a.removeHandler(this.iU,Rc.a.Kx,this.E7d));this.dMa().then(b=>
{b.dispose(this.KEa);return null})}Us(){this.uGj();this.eUa();this.R7a([1,0])}o7d(b,k){b=k.property;if(b===Cc.a.Ao||b===Cc.a.marginLeft||b===Cc.a.marginRight)this.uGj(),this.eUa(),this.R7a([1])}uGj(){var b=this.E7b();b&&(b=Re.a.Ni(b.Ao,0),this.KEa.style.width=Math.round(b*this.uN).toString()+"px")}eUa(){window.requestAnimationFrame(()=>{var b=this.usf();b&&(b=$d.a.getElementBounds(b),w.AFrameworkApplication.isRtl?this.KEa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+
"px":this.KEa.style.marginLeft=b.x.toString()+"px")})}$cm(){const b=ze.GraphIterator.$a(this.Ry.h6b);if(b.zb(14))return b.hd(16),Xt.a(b,!0);v.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");vm.recordQosError(this.Hwb,[vm.Bea],"Unable to read table column index for Ruler");return 0}lun(){let b=!0;const k=this.Ry.kb.kO();if(null===k)return v.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),vm.recordQosError(this.Hwb,[vm.Bea],"Unable to get Context Iterator for the Ruler"),
!1;for(;k.moveNext()&&b;){const t=ze.GraphIterator.$a(k.current.node);t.yd();b=b&&Ih.TableReader.Yw(t)}return b}lZe(){if(!this.KEa&&!this.iU){this.fYg=document.createElement("div");this.iU.id=Ai.Q4j;this.iU.className=Ai.P4j;this.iU.setAttribute(df.a.dfa,WordEditorIntl.WordEditorStrings.L_Ruler);this.iU.setAttribute(df.a.qh,df.a.Iuh);this.iU.classList.add("HideWACHorizontalRulerContainer");if(this.syi){var b=w.AFrameworkApplication.K.jb("ModernUxExperimentPreferenceCookieName");const k=w.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");
Mb.a.lba(b,!k)&&this.iU.classList.add(Ai.hak)}this.gYg=document.createElement("div");this.KEa.className=Ai.O4j;this.KEa.id=Ai.R4j;this.iU.appendChild(this.KEa);b=null;this.Fw&&((b=Object(Su.a)("EditorBars"))&&b.appendChild(this.iU),this.iU.classList.add("regionComposer"));b||(b=document.getElementById(wg.AppFrame.Hbd),b.insertBefore(this.iU,b.firstChild))}}static YE(){return new Ai(Fa.a.instance.Sa("Common.IZoomManager"),Wa.App.Lj,w.AFrameworkApplication.va,bk.UISurfaces.ifi,Fa.a.instance.resolve("WordEditor.IRulerContextMenu"),
Dt.a.instance,Fa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=Ai.eCg?Ai.eCg:Ai.eCg=Ai.YE()}}Ai.Q4j="WACHorizontalRulerContainer";Ai.P4j="WACHorizontalRulerContainer";Ai.R4j="WACHorizontalRuler";Ai.O4j="WACHorizontalRuler";Ai.hak="ModernUxWACHorizontalRulerContainer";Object(n.a)(Ai,"HorizontalRuler",Ru,[]);var iE=c(947);class Jt extends Ru{constructor(b,k,t,D,P,ca,ta){super(b,k,t,P,ca,ta);this.aP="VerticalRuler";this.bqe="MarginModificationFromRuler";this.zkh=
this.ykh=null;this.DUf=(Na,qb)=>{let Jb=8;"Top"===Na?Jb=this.ga.Qb(Pb.a.t6a,2,Ef.a.Dv(qb)):"Bottom"===Na&&(Jb=this.ga.Qb(Pb.a.r6a,2,Ef.a.Dv(qb)));let Vb;32===Jb?(qb=1,Vb=String.format("Margins set using Ruler. Margin: {0}",Na),v.ULS.sendTraceTag(529065945,3014,50,Vb)):(qb=0,Vb=String.format("Unable to set margins using Ruler. Margin: {0}",Na),v.ULS.sendTraceTag(529065946,3014,15,Vb),vm.recordQosError(this.Kjh,[vm.Bea],"Unable to set margins using Ruler."));bf.a(this.bqe,32===Jb,void 0,[Object.assign(new na.a,
{name:"Type",string:Na})]);Na=new Map;Na.set("Command","OnMarginChange");Na.set("Source",this.aP);Na.set("Response",Vb);xa.Health.instance.recordKpiUsage(mp.kpiName,qb,mp.W7,Na)};this.dMa=D;this.lr={}}get A1(){return this.ykh}get QIa(){return this.zkh}renderRuler(){this.A1.classList.remove("HideWACVerticalRulerContainer");this.A1.classList.add("ShowWACVerticalRulerContainer");var b=this.E7b();if(b){var k=this.DUf;this.U$c()||(this.lr.disabled=!0);this.lr.onMarginChange=k;this.eUa();b=Re.a.Ni(b.lv,
1);this.QIa.style.height=(b*this.uN).toString()+"px";this.dMa().then(t=>{t.renderRuler(this.QIa,this.lr);return null})}}R7a(b){var k;if(this.A1){this.A1.classList.add("ShowWACVerticalRulerContainer");"disabled"in this.lr&&delete this.lr.disabled;for(const t of b)switch(t){case 1:this.U$c()?this.eUa():this.lr.disabled=!0}if(null===(k=this.Ry.kb)||void 0===k?0:k.STc)this.lr.disabled=!0;this.dMa().then(t=>{t.renderRuler(this.QIa,this.lr);return null})}}U$c(){const b={},k=this.E7b();if(!k)return!1;b.scale=
Ef.a.Ez(k.lv);b.precision=mp.precision;b.rulerType="Vertical";this.lr.ipContextIndex=0;this.lr.permittedUnits=mp.dPh;b.margins=[{["type"]:"Top",["value"]:Ef.a.Ez(k.marginTop),["getRulerPropertyBoundary"]:bs.m8b("Top",0)},{["type"]:"Bottom",["value"]:Ef.a.Ez(k.marginBottom),["getRulerPropertyBoundary"]:bs.m8b("Bottom",1)}];this.lr.rulerCanvasProps=b;return!0}Eoh(){this.lZe();vf.a.addHandler(this.A1,Rc.a.Kx,this.E7d)}Ymi(){this.A1&&(this.A1.classList.remove("ShowWACVerticalRulerContainer"),this.A1.classList.add("HideWACVerticalRulerContainer"),
vf.a.removeHandler(this.A1,Rc.a.Kx,this.E7d));this.dMa().then(b=>{b.dispose(this.QIa);return null})}Us(){this.qGj();this.eUa();this.R7a([1])}o7d(b,k){b=k.property;if(b===Cc.a.lv||b===Cc.a.marginTop||b===Cc.a.marginBottom)this.qGj(),this.eUa(),this.R7a([1])}qGj(){var b=this.E7b();b&&(b=Re.a.Ni(b.lv,1),this.QIa.style.height=Math.round(b*this.uN).toString()+"px")}eUa(){window.requestAnimationFrame(()=>{var b=this.usf();if(b){const k=$d.a.getElementBounds(b);this.QIa.style.height=k.height.toString()+
"px";b=this.Nem(b);this.QIa.style.marginTop=b+"px"}})}Nem(b){b=b.getBoundingClientRect().y;const k=this.RWe.getBoundingClientRect().y;return b-k}lZe(){if(!this.QIa&&!this.A1){this.ykh=document.createElement("div");this.A1.id=Jt.qnk;this.A1.className=Jt.pnk;this.A1.setAttribute(df.a.dfa,WordEditorIntl.WordEditorStrings.L_Ruler);this.A1.setAttribute(df.a.qh,df.a.Iuh);this.A1.classList.add("HideWACVerticalRulerContainer");if(this.syi){var b=w.AFrameworkApplication.K.jb("ModernUxExperimentPreferenceCookieName");
const k=w.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Mb.a.lba(b,!k)&&Sys.UI.DomElement.addCssClass(this.A1,Jt.iak)}this.zkh=document.createElement("div");this.QIa.className=Jt.onk;this.QIa.id=Jt.rnk;this.A1.appendChild(this.QIa);b=document.getElementById(wg.AppFrame.Hbd);b.insertBefore(this.A1,b.firstChild)}}static YE(){return new Jt(Fa.a.instance.Sa("Common.IZoomManager"),Wa.App.Lj,w.AFrameworkApplication.va,bk.UISurfaces.ifi,Fa.a.instance.resolve("WordEditor.IRulerContextMenu"),
Dt.a.instance,Fa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=Jt.dCg?Jt.dCg:Jt.dCg=Jt.YE()}}Jt.qnk="WACVerticalRulerContainer";Jt.pnk="WACVerticalRulerContainer";Jt.rnk="WACVerticalRuler";Jt.onk="WACVerticalRuler";Jt.iak="ModernUxWACVerticalRulerContainer";Object(n.a)(Jt,"VerticalRuler",Ru,[]);class vm{constructor(b,k,t,D,P,ca,ta,Na,qb){this.FCe=this.dFe=!1;this.aP="RulerActor";this.Edh=null;this.xoa=!1;this.XXj="ClearAllTabStopsFailed";this.Sfh="ShowHideRulerFailed";
this.OGe=null;this.yDd=(Jb,Vb,ac)=>{if(1===ac)return 32;Jb=this.ga.processAction(Nc.a.BMb,2,null);32===Jb?(ac=1,Vb=String.format("Clear all tab stops from ruler"),v.ULS.sendTraceTag(591213266,3014,50,Vb)):(ac=0,Vb=String.format("Unable to clear all tab stop from ruler"),v.ULS.sendTraceTag(591213267,3014,15,Vb),vm.recordQosError(this.XXj,[vm.Bea],Vb));const yc=new Map;yc.set("Command","ClearAllTabStops");yc.set("Source",this.aP);yc.set("Response",Vb);xa.Health.instance.recordKpiUsage(mp.kpiName,ac,
mp.W7,yc);return Jb};this.vSc=(Jb,Vb,ac)=>{if(1===ac)switch(Jb){case Nc.a.H2e:case Nc.a.Fcf:return 2;default:return 32}Vb=this.lQe.X8l();switch(Jb){case Nc.a.fJf:var yc=1;break;case Nc.a.p8f:yc=4;break;case Nc.a.b6e:yc=3;break;default:return v.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}Jb=new Cw.a(Vb,yc,0,1);Jb=this.ga.Qb(Nc.a.B6c,2,Jb);32===Jb?(ac=1,Vb=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",YA[yc],Vb.toString()),v.ULS.sendTraceTag(591213269,
3014,50,Vb)):(ac=0,Vb=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",YA[yc],Vb.toString()),v.ULS.sendTraceTag(591213270,3014,15,Vb));yc=new Map;yc.set("Command","InsertCustomTabStopRuler");yc.set("Source",this.aP);yc.set("Response",Vb);xa.Health.instance.recordKpiUsage(mp.kpiName,ac,mp.W7,yc);return Jb};this.QOb=(Jb,Vb,ac,yc,Kc)=>this.dFe||1===ac&&Pk.a.fha(Vb.$j)?8:this.xoa?this.TQc(Jb,Vb,ac,yc,Kc):this.nvo(Vb,ac);this.I7n=()=>{this.xoa?v.ULS.sendTraceTag(574128526,
3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.processAction(Pb.a.QOb,2)?(v.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),vm.recordQosError(this.Sfh,[vm.Bea],"Ruler could not be enabled")):v.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.TQc=(Jb,Vb,ac)=>{if(1===ac||!this.xoa)return 32;this.xoa=!1;this.mQe.Cfj(!1);this.aab.dispose();this.R_d()&&this.gff();this.tGj();v.ULS.sendTraceTag(593351623,
3014,50,"Ruler is disabled");Jb=new Map;Jb.set("Command","HideRuler");Jb.set("Source",this.aP);Jb.set("Response","");xa.Health.instance.recordKpiUsage(mp.kpiName,1,mp.W7,Jb);return 32};this.ibe=(Jb,Vb,ac,yc,Kc)=>{if(1===ac)return 32;Kc&&(Kc[kg.a.On]=this.xoa);return 32};this.Wvm=Jb=>{this.xoa=Jb.result};this.DFb=()=>{this.dFe=!1};this.Nmi=()=>{this.dFe=!0};this.ga=b;this.aab=k;this.EWe=t;this.ORb=D;this.lQe=P;this.mQe=ca;vm.Qk=Na;this.GKa=ta;this.FS=qb;this.GKa.gqh(this.Nmi);this.GKa.zzd(this.DFb)}initialize(){this.Tb();
this.Edh=this.I7n;window.addEventListener("TurnRulerOnAction",this.Edh,!0);return this.mQe.k$l().continueWith(this.Wvm,8)}Tb(){this.ga.qa(Pb.a.QOb,lc.a.view,this.QOb);this.ga.fb(Pb.a.ibe,lc.a.view,this.ibe,96);this.ga.qa(Nc.a.H2e,lc.a.view,this.vSc);this.ga.qa(Nc.a.b6e,lc.a.view,this.vSc);this.ga.qa(Nc.a.yDd,lc.a.view,this.yDd);this.ga.qa(Nc.a.Fcf,lc.a.view,this.vSc);this.ga.qa(Nc.a.TQc,lc.a.view,this.TQc);this.ga.qa(Nc.a.fJf,lc.a.view,this.vSc);this.ga.qa(Nc.a.p8f,lc.a.view,this.vSc);iE.a.kd.addHandler(iE.a.g7d,
this.U_c.bind(this));this.FS.$yb(this.rWf)}sqi(){this.xoa&&(this.aab.wF(),this.aab.renderRuler(),this.R_d()&&this.bbj())}bbj(){this.EWe.wF();this.EWe.renderRuler()}gff(){this.EWe.dispose()}R_d(){return this.OCi()&&this.isPaginatedView()}OCi(){null==this.OGe&&null!=w.AFrameworkApplication.K&&(this.OGe=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.OGe}XTa(){this.xoa||Fa.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(b=>
{b.logActivity("TurnRulerOnActivity",null)})}WW(){this.GKa.s_n(this.Nmi);this.GKa.faj(this.DFb);this.xoa&&(this.aab.dispose(),this.R_d()&&this.gff())}tGj(){if(this.ORb){const b={};b[mp.hZo]="ToggleButtonModel";this.ORb.VG(b)}}nvo(b,k){if(!vm.Qk.j8(b.$j))return v.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),vm.recordQosError(this.Sfh,[vm.Bea],"Cannot show ruler. Word Section Node not found."),8;if(1===k)return 32;this.xoa=!0;this.mQe.Cfj(!0);this.sqi();this.tGj();
v.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;b.set("Command","ShowRuler");b.set("Source",this.aP);b.set("Response","");xa.Health.instance.recordKpiUsage(mp.kpiName,1,mp.W7,b);return 32}isPaginatedView(){return 1===this.FS.Uu}U_c(b,k){switch(k.documentMode){case "View":this.xoa&&(this.ga.processAction(Pb.a.QOb,2),this.FCe=!0);break;case "Edit":this.FCe&&(this.ga.processAction(Pb.a.QOb,2),this.FCe=!1)}}rWf(b,k){if(vm.instance.xoa&&vm.instance.OCi())switch(k.vlb){case 1:vm.instance.bbj();
break;case 0:vm.instance.gff()}}static recordQosError(b,k,t){const D=Object.assign(new Db.a,{extendedProperties:new Map});t&&D.extendedProperties.set("exception",t);xa.Health.instance.recordQosError(b,k,!1,!0,!1,!1,D)}static YE(){return new vm(w.AFrameworkApplication.va,Ai.instance,Jt.instance,Wa.App.ya,Fa.a.instance.resolve("WordEditor.IRulerContextMenu"),Fa.a.instance.Na("WordEditor.Ruler.IRulerSettingInfo"),Fa.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),xn.a.instance,
Fa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=vm.gBg?vm.gBg:vm.gBg=vm.YE()}}vm.Qk=null;vm.Bea="RulerInteractionFailed";Object(n.a)(vm,"RulerActor",null,[]);class ZE{constructor(b,k){this.Zzc=null;this.C4a=t=>t.result?t.result.Value.toString():"";this.oGa=t=>{t.zo||t.Ci?(v.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.Zzc=!1):(t=t.result,""===t&&w.AFrameworkApplication.K&&(t=w.AFrameworkApplication.K.jb("RulerDefaultOn")),
this.Zzc="true"===t.toLowerCase(),v.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully."));return this.Zzc};this.xv=b;this.rK=k}k$l(){const b=new Cg.a;if(null==this.Zzc){if(this.rAi())return this.rK.v5a(JC.a.B5c).CWRCo(this.C4a,0).CWRCo(this.oGa,8);b.Ag(!1)}else b.Ag(this.Zzc);return b.task}r1(b){this.rK.r1(JC.a.B5c,new VE.a(JC.a.B5c,b))}Cfj(b){this.rAi()&&(this.xv.Via("saveRulerIsEnabled",b.toString()),v.ULS.sendTraceTag(591541276,
3014,50,"Try to save ruler settings value to Roaming Service."));this.r1(b)}rAi(){const b=w.AFrameworkApplication.K.$("IsAnonymousUser");if(w.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)v.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}}Object(n.a)(ZE,"RulerSettingInfo",null,[280]);class $E{constructor(){this.AZg=this.W=null}get name(){return"WordEditor.Ruler"}xc(b){this.W=b;v.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.W.ha("WordEditor.Ruler.RulerSettingInfo",
()=>new ZE(this.W.resolve("Box4.IRoamingServiceRequestManager"),this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").singleInstance();this.W.resolve("Box4.IFeatureHelper").Mp.continueWith(()=>{this.fn()});this.AZg=vm.instance.initialize();v.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}fn(){this.AZg.continueWith(()=>{vm.instance.sqi();vm.instance.XTa()});v.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){vm.instance.WW();
v.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(n.a)($E,"PackageManager",null,[1,2]);class jD{constructor(){this.P9b=this.A0b=null}}Object(n.a)(jD,"CreatePickerCustomizationDictionaryOptions",null,[924]);class jE{}jE.Xg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(n.a)(jE,"InsertMediaM365DialogHtml",
null,[]);class kD{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed,sd,oe){this.w3=oe;this.H9a=null;this.YCf=this.Smd=!1;this.srj=Ld=>{if(Ld.rawEvent&&(Ld=Ld.rawEvent.data))try{const Od=Sys.Serialization.JavaScriptSerializer.deserialize(Ld,!0),ie=Od.MessageId?Od.MessageId.toString():null;Od&&ie&&(ie===K.a.insertImage||ie===K.a.gAf)&&this.Txc.start(ie===K.a.insertImage?this.qab:this.LZg)}catch(Od){}};this.JSo=(Ld,Od,ie,Ce,hg)=>{if(1===ie)return 32;this.t1g?Ld=CommonUIStrings.l_OneDriveName:""!==
this.hkd?Ld=this.hkd:(Ld=CommonUIStrings.l_HostGeneric,v.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));hg[tn.a.LabelText]=Ld;return 32};this.MSo=(Ld,Od,ie,Ce,hg)=>{if(1===ie)return 32;if(!w.AFrameworkApplication.LDf())return hg[tn.a.Visible]=!1,32;this.t1g?Ld=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.hkd?Ld=String.format(CommonUIStrings.l_ChangePictureFromHost,this.hkd):
(Ld=CommonUIStrings.l_ChangePictureFromHostGeneric,v.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));hg[tn.a.LabelText]=Ld;return 32};this.KSo=(Ld,Od,ie,Ce,hg)=>{if(1===ie)return 32;w.AFrameworkApplication.K.$("InsertOnlinePictureEnabled")||(hg[tn.a.Visible]=!1);return 32};this.LSo=(Ld,Od,ie,Ce,hg)=>{if(1===ie)return 32;w.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled")||(hg[tn.a.Visible]=
!1);return 32};this.pie=(Ld,Od,ie)=>{var Ce;Od=this.nuc.value.ofa(Od);if(1===ie)return Od&&this.pab.OKm?32:8;if(2!==ie||!Od)return 8;(null===(Ce=w.AFrameworkApplication.K)||void 0===Ce?0:Ce.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&tw.a.instance.A5a("PictureBing");this.H9a=lb.a.create();v.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");Ld=this.jZl(Ld,this.H9a);Ld=this.wYe(Ld);Ld=this.ald.nOc(Ld);Ld.correlationId=
this.H9a;Ld.e$b=this.MZg;Ld.Iha=1;return this.nie(Ld,CommonUIStrings.L_PictureInsertTitle,this.qab)};this.tuo=(Ld,Od,ie)=>{Ld=32===this.ga.Nf(Od,Pb.a.insertHyperlink,1,!1,null,null);if(1===ie)return Ld&&this.pab.nxi?32:8;if(2!==ie||!Ld)return 8;v.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.nie(this.KZg.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.LZg)};this.drj=(Ld,Od,ie)=>{Ld=this.nuc.value.ofa(Od);
if(1===ie)return Ld&&this.pab.KDf?32:8;if(2!==ie||!Ld)return 8;v.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.nie(this.KZg.getInstance(),CommonUIStrings.L_PictureInsertTitle,this.qab)};this.lie=(Ld,Od,ie)=>{var Ce;Od=this.nuc.value.ofa(Od);if(1===ie)return Od&&this.pab.QKm?32:8;if(2!==ie||!Od)return 8;v.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");(null===
(Ce=w.AFrameworkApplication.K)||void 0===Ce?0:Ce.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&tw.a.instance.A5a("PictureStock");this.H9a=lb.a.create();ie=w.AFrameworkApplication.K.$("StockImagesFreemiumExperienceIsEnabled")&&this.VJ.isFreemiumUpsellEnabled();ie=this.Smd?1:ie?0:-1;Ld=this.S0l(Ld,this.H9a,ie);Ld=this.ald.nOc(Ld);Ld.Xg=jE.Xg;Ld.correlationId=this.H9a;Ld.Iha=2;Ld.e$b=this.MZg;Ld.bfa=this.VJ;Ld.QHj=ie;return this.nie(Ld,CommonUIStrings.L_PictureInsertTitle,
this.qab)};this.qie=(Ld,Od,ie)=>{var Ce;Od=this.nuc.value.ofa(Od);Ld=Fa.a.instance.Na("Common.App.SharedFilePicker.ISharedFilePicker");if(1===ie)return Od&&!this.pab.KDf&&Ld&&Ld.UFf()?32:8;if(2!==ie||!Od||!Ld)return 8;v.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");(null===(Ce=w.AFrameworkApplication.K)||void 0===Ce?0:Ce.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&tw.a.instance.A5a("PictureOneDrive");this.H9a=
lb.a.create();ie=kD.ukh;Ce=!1;w.AFrameworkApplication.MDf()&&(Ce=this.mJl());Od=new jD;Od.A0b=Ce;Od.P9b=!0;ie=Ld.haf(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,!0,ie,"Insert Media",1,Od);Ld.bPd(ie).then(hg=>{if(null!=hg&&0<hg.length){const Kg=[];for(let Hl=0;Hl<hg.length;Hl++){const wm=hg[Hl][I.a.x0i],bp=hg[Hl][I.a.w0i],qv={};qv.Extension=wm;qv.OriginalUrl=bp;qv.caption=wm;Kg.push(qv)}this.qab.IPa=Pb.a.b_;this.qab.m2a(Kg)}});return 32};this.oie=(Ld,Od,ie)=>{var Ce;const hg=this.nuc.value.ofa(Od);
Od=Fa.a.instance.Na("Common.App.SharedFilePicker.ISharedFilePicker");if(1===ie)return hg&&Od&&Od.UFf()?32:8;if(2!==ie||!hg||!Od)return 8;ie=Fa.a.instance.Na("Common.App.PhoneLink.IPhoneLinkManager");null!=ie&&ie.dzl(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));v.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");(null===(Ce=w.AFrameworkApplication.K)||void 0===Ce?
0:Ce.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&tw.a.instance.A5a("PictureMobile");this.H9a=lb.a.create();Ce=kD.ukh;ie=new jD;ie.A0b=!0;ie.P9b=!0;Ce=Od.haf(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,!0,!1,!0,Ce,"InsertPictureFromMobile",3,ie);Od.bPd(Ce).then(Kg=>{if(null!=Kg&&0<Kg.length){var Hl=[];const wm=Ld===Pb.a.yWd;let bp=!1;const qv=w.AFrameworkApplication.K.jb("PhoneLinkServiceEndpoint");for(let eB=0;eB<Kg.length;eB++){const fB=
Kg[eB][I.a.x0i],PD=Kg[eB][I.a.w0i],dz={};dz.Extension=fB;dz.OriginalUrl=PD;dz.caption=fB;Hl.push(dz);bp||(bp=-1!==dz.OriginalUrl.indexOf(qv))}this.qab.IPa=Pb.a.b_;this.qab.m2a(Hl);Hl={};Hl.InsertImageCount=Kg.length;bp&&bf.c(wm?Pb.a.iAm:Pb.a.mTk,void 0,void 0,void 0,void 0,void 0,Hl)}});return 32};this.Txc=D;this.bqd=P;this.ald=ta;this.KZg=Na;this.s2=qb;this.ga=b;this.nuc=ca;this.t1g=yc;this.hkd=ed;this.pab=t;this.qab=Jb;this.LZg=Vb;this.MZg=sd;(this.VJ=ac)&&this.VJ.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(Ld=>v.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",Ld)).then(Ld=>{(this.Smd=Ld)||this.VJ.cya("MsoPremiumStockImages",()=>{this.Smd=!0;v.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}Tb(){(this.pab.KDf||this.pab.nxi)&&this.pab.PKm&&this.kEn();this.jUn();this.iUn();this.ga.fb(Pb.a.QBh,lc.a.view,this.drj,1284);this.ga.fb(Pb.a.$3i,
lc.a.view,this.MSo,1124);this.ga.fb(Pb.a.rAf,lc.a.view,this.drj,1284);this.ga.fb(Pb.a.E1f,lc.a.view,this.JSo,1124);this.ga.fb(Pb.a.qAm,lc.a.view,this.tuo,1284)}jUn(){this.ga.fb(Pb.a.insertOnlinePicture,lc.a.view,this.pie,1284);this.ga.fb(Pb.a.vWd,lc.a.view,this.lie,1284);this.ga.xia("word_insertOnlinePictures",Pb.a.insertOnlinePicture,lc.a.view,this.pie,b=>{Wa.App.ya.mmc(b,Object(A.a)(new Yn.a,(new Yn.a).BDb,"getCommandById"))});this.ga.xia("word_insertOnlinePictures",Pb.a.vWd,lc.a.view,this.lie,
b=>{Wa.App.ya.mmc(b,Object(A.a)(new Yn.a,(new Yn.a).BDb,"getCommandById"))});this.ga.fb(Pb.a.k6e,lc.a.view,this.pie,1284);this.ga.fb(Pb.a.m6e,lc.a.view,this.qie,1284);this.ga.xia("word_insertOnlinePictures",Pb.a.m6e,lc.a.view,this.qie);this.ga.fb(Pb.a.n6e,lc.a.view,this.lie,1284);this.ga.fb(Pb.a.Y3i,lc.a.view,this.KSo,1284);this.ga.fb(Pb.a.Z3i,lc.a.view,this.LSo,1284);this.ga.xia("word_insertOnlinePictures",Pb.a.k6e,lc.a.view,this.pie);this.ga.xia("word_insertOnlinePictures",Pb.a.n6e,lc.a.view,this.lie);
this.ga.fb(Pb.a.tAf,lc.a.view,this.qie,1284);this.ga.xia("word_insertOnlinePictures",Pb.a.tAf,lc.a.view,this.qie,b=>{Wa.App.ya.mmc(b,Object(A.a)(new Yn.a,(new Yn.a).BDb,"getCommandById"))})}iUn(){w.AFrameworkApplication.MDf()&&(this.ga.fb(Pb.a.yWd,lc.a.view,this.oie,1284),this.ga.fb(Pb.a.l6e,lc.a.view,this.oie,1284),this.ga.xia("mso_insertMobileDevicePictures",Pb.a.yWd,lc.a.view,this.oie,b=>{Wa.App.ya.mmc(b,Object(A.a)(new Yn.a,(new Yn.a).BDb,"getCommandById"))}),this.ga.xia("mso_insertMobileDevicePictures",
Pb.a.l6e,lc.a.view,this.oie,b=>{Wa.App.ya.mmc(b,Object(A.a)(new Yn.a,(new Yn.a).BDb,"getCommandById"))}))}kEn(){w.AFrameworkApplication.ta.get_element().appendChild(this.bqd.i0a);vf.a.addHandler(this.bqd.i0a.contentWindow,"message",this.srj);this.YCf=!0}jZl(b,k){let t=0;w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb&&5===w.AFrameworkApplication.ta.Nb.Sl&&(t=12);const D=Xj.a.og(w.AFrameworkApplication.lcid);return String.format(w.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,
b===Pb.a.insertOnlinePicture?1:0,w.AFrameworkApplication.lcid,D?D.name:"en-us",w.AFrameworkApplication.buildVersion,k,t,w.AFrameworkApplication.K.jb("UserId"))}nie(b,k,t){try{return b.mie(k,t,void 0),v.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(D){return v.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",D.toString()),this.yp(zk.a.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,
Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}S0l(b,k,t){if(Pb.a.vWd===b)return b=this.s2.$xh(w.AFrameworkApplication.K.jb("InsertOnlineM365PictureEndpoint"),k.toString(),1,t),this.wYe(b);b=this.s2.$xh(w.AFrameworkApplication.K.jb("InsertOnlineM365PictureEndpoint"),k.toString(),0,t);return this.wYe(b)}yp(b,k,t){const D=new Uc.StandardDialog(!0);D.rt=w.AFrameworkApplication.Oba;D.Ad=0;D.Ee(1,CommonUIStrings.l_DialogClose);D.ix(b,k,t,()=>{})}mJl(){const b=Fa.a.instance.Na("Common.App.PhoneLink.IPhoneLinkManager");
return null!=b?b.mNl():!1}dispose(){this.YCf&&this.bqd.i0a.contentWindow&&(vf.a.removeHandler(this.bqd.i0a.contentWindow,"message",this.srj),this.YCf=!1)}wYe(b){return this.w3&&this.w3.VI?(b=new eb.QueryStringBuilder(b),b.Ce("theme","4"),b.toString()):b}}kD.ukh=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(n.a)(kD,"InsertMediaActor",null,[9]);var LC=c(957);class aF extends LC.a{constructor(b,k){super(b,ia.a.getOrigin(k))}er(b,k){this.isEnabled()&&this.taa(this.g7a)&&(this.yv(b),this.NB(b,
k))}}Object(n.a)(aF,"InsertMediaCrossDocumentMessenger",LC.a,[420,65,9]);class bF{getInstance(b,k){return new aF(b,k)}}Object(n.a)(bF,"InsertMediaCrossDocumentMessengerFactory",null,[395]);var kE=c(758);class lD{}lD.Xg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(n.a)(lD,"InsertMediaDialogHtml",null,[]);var MC;(function(b){b[b.OK=
0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(MC||(MC={}));Object(n.b)("HubbleAction",MC);var ZA;(function(b){b[b.unknown=0]="unknown";b[b.bing=1]="bing";b[b.M365=2]="M365";b[b.icons=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.hubble=5]="hubble"})(ZA||(ZA={}));Object(n.b)("InsertMediaProviders",ZA);class NC extends Wf.a{constructor(b,k,t,D=null,P=!1){super(!1,!1,P);this.Py=null;this.Dsc=!1;this.gYc=this.j0=null;this.V4e="KeepFocusDiv";this.fCd="KeepFocusStartDiv";this.correlationId=
null;this.Iha=0;this.bfa=this.e$b=null;this.QHj=0;this.vIe=null;this.Enn=()=>{this.j0&&(this.j0.style.visibility="visible",window.setTimeout(()=>{if(this.ej){const ca=this.ej.getElementById(this.fCd);ca&&ca.focus()}},0))};this.bca=ca=>{ca.keyCode===Sys.UI.Key.tab&&(ca.target.id!==this.V4e||ca.shiftKey?ca.target.id===this.fCd&&ca.shiftKey&&(ca.preventDefault(),this.ej.getElementById(this.V4e).focus()):(ca.preventDefault(),this.ej.getElementById(this.fCd).focus()))};this.pSi=()=>{v.ULS.sendTraceTag(17662422,
352,100,"OnCancelDialog : Got message.");this.ACb(this.qZa);this.Znb(1)};this.OTf=()=>{this.Py&&(v.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.Py.sendMessage(K.a.Ijj,{["CustomHeaders"]:""}))};this.FTi=()=>{this.Py&&(v.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.Py.sendMessage(K.a.blo,{["SessionId"]:w.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};this.CTi=()=>{this.Py&&(v.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),
this.Py.sendMessage(K.a.meo,{["CID"]:""}))};this.Znn=()=>{this.bfa&&(v.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.bfa.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.cld=b;this.NTb="";this.s2=t;this.Dea=[];this.prd=k;this.Xg=D||lD.Xg;this.vg="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}async mie(b,k){this.NTb=
b;this.Dsc=!1;this.showDialog(this.NTb,null);this.j0=this.j7b(this.kj("insertmediaframe"));if(!this.j0)throw this.ACb(this.qZa),Error.invalidOperation("Couldn't get InsertMediaIframe.");b=document.createElement("div");b.setAttribute("Id",this.fCd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.j0.parentNode.insertBefore(b,this.j0.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",this.V4e);
b.setAttribute("tabindex","0");this.j0.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.Vdf,"keydown",this.bca);this.j0.src=this.cld;this.j0.style.width="100%";this.j0.style.height="100%";this.j0.frameBorder="0";w.AFrameworkApplication.K.$("ShowInsertMediaIframeWhenIframeIsReady")&&aa.a.jj?(this.j0.style.visibility="hidden",this.gYc=this.Enn,vf.a.addHandler(this.j0,"load",this.gYc)):this.j0.style.visibility=
"visible";this.j7b(this.kj("WACDialogButtonPanel")).style.display="none";this.j7b(this.kj("WACDialogTitleText")).style.display="none";2===this.Iha&&(this.j7b(this.kj("WACDialogTitlePanel")).style.display="none",this.j7b(this.kj("WACDialogBodyPanel")).style.padding="0");ad.FocusManager.instance().Ps().scope.OH=!0;this.Py=this.prd.getInstance(this.j0.contentWindow,this.cld);this.Py.taa("https://osiziwuspersimmon002.blob.core.windows.net");this.Py.taa("https://osizewuspersimmon001.blob.core.windows.net");
this.Py.taa("https://osizpscuspersimmon000.blob.core.windows.net");this.Py.taa("https://cdn.hubblecontent.msit.osi.office.net");this.Py.taa("https://cdn.hubblecontent.osi.office.net");this.Py.er(K.a.Pnh,t=>{this.GRi(t,Object(A.a)(k,k.m2a,"insertMediaCallback"))});this.Py.er(K.a.insert,t=>{this.S6d(t,Object(A.a)(k,k.m2a,"insertMediaCallback"))});this.Py.er(K.a.Fsk,t=>{this.fpn(t)});this.Py.er(K.a.P6h,this.OTf);this.Py.er(K.a.getSessionId,this.FTi);this.Py.er(K.a.x4h,this.CTi);this.Py.er(K.a.yCd,this.pSi);
2!==this.Iha||this.QHj||(this.Py.er(K.a.CWm,this.Znn),this.vIe=this.bfa.cya("MsoPremiumStockImages",t=>{v.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");this.Py.sendMessage(K.a.MXo,{["LicenseTier"]:t.toString()})}));this.Znb(3)}dispose(){this.bfa&&this.vIe&&this.bfa.Tgc("MsoPremiumStockImages",this.vIe);this.Py&&(this.Py.dispose(),this.Py=null);this.gYc&&(vf.a.removeHandler(this.j0,"load",this.gYc),this.gYc=null);super.dispose()}GRi(b,k){v.ULS.sendTraceTag(7135752,
352,100,"OnAddItem : Got message.");if(b=this.s2.Ryn(b))this.Dea.push(b),this.Dsc&&(k(this.Dea),this.Dsc=!1)}yp(){const b=new Uc.StandardDialog(!0);b.rt=w.AFrameworkApplication.Oba;b.Ad=0;b.Ee(1,CommonUIStrings.l_DialogOk);b.Gu(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}Znb(b){var k=RegExp("hubble","gi");if(this.e$b&&0<this.e$b.search(k)&&this.correlationId){k=w.AFrameworkApplication.sessionStartInfoSettings;var t={};t.InsertedFiles=this.Dea.length;
t.MediaDetails=this.Dea;t.DialogResult=MC[b];t.DialogMode=this.Arf();t.CorrelationId="{"+this.correlationId.toString()+"}";t.Platform="Wac";t.Provider=ZA[this.Iha]||"Unknown";t.AudienceGroup=k&&"AudienceGroup"in k?k.AudienceGroup.toString():"Unknown";t.Ring=k&&"Ring"in k?k.Ring.toString():"Unknown";t.AppId=2;t.Build=w.AFrameworkApplication.buildVersion;t.Locale=Xj.a.og(w.AFrameworkApplication.lcid).name;this.pEn().send(JSON.stringify(t))}2===this.Iha&&(t=w.AFrameworkApplication.K.jb("InsertMediaDialogAriaTenantNameSpace"))&&
""!==t&&(k=[],k.push(Object.assign(new na.a,{name:"InsertedFiles",int64:this.Dea.length})),k.push(Object.assign(new na.a,{name:"MediaDetails",string:JSON.stringify(this.Dea)})),k.push(Object.assign(new na.a,{name:"DialogResult",string:MC[b]})),k.push(Object.assign(new na.a,{name:"DialogMode",string:this.Arf()})),k.push(Object.assign(new na.a,{name:"CorrelationId",string:this.correlationId.toString()})),k.push(Object.assign(new na.a,{name:"Provider",string:ZA[this.Iha]||"Unknown"})),ea.a.sendTelemetryEvent(Object.assign(new pa.a,
{name:String.format("{0}.{1}",t,this.telemetryEventName),dataFields:k})))}Arf(){return 3===this.Iha?"Icons":5===this.Iha?"ExternalContent":"Images"}j7b(b){const k=document.getElementById(b);if(!k)throw Error.invalidOperation(String.format("Couldn't get {0}.",b));return k}pEn(){const b=new XMLHttpRequest;b.open("POST",this.e$b,!0);b.setRequestHeader("Content-Type","");return b}S6d(b,k){v.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.ACb(this.qZa);k?this.Dea&&50<this.Dea.length?(this.yp(),
this.Znb(0),v.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.Dea.length,ZA[this.Iha])):this.Dea&&0<this.Dea.length?(k(this.Dea),this.Znb(0),v.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.Dea.length,ZA[this.Iha])):(v.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.Dsc=!0,k(this.Dea),this.Znb(2)):this.Znb(2)}fpn(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,
v.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),ea.a.sendOtelEvent(Object.assign(new kE.a,{otelEvent:b})))}}Object(n.a)(NC,"InsertMediaDialog",Wf.a,[394,9]);class cF{constructor(b,k){this.$De=b;this.s2=k}nOc(b,k=!1){return new NC(b,this.$De,this.s2,lD.Xg,k)}getInstance(){throw Error.notImplemented();}}Object(n.a)(cF,"InsertMediaDialogFactory",null,[393]);class YB{constructor(b,k,t){this.eui=!1;this.correlationId=null;this.Iha=0;this.e$b=null;this.V4j=b;this.mCc=[];this.ikd=
k;this.nhh=t.split(";")}async mie(b,k){Array.clear(this.mCc);b=this.V4j.value;b.taa(this.ikd);b.yv(k.dRc);this.eui||(b.NB(k.dRc,t=>{this.S6d(t,k)}),this.eui=!0);v.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(k.mNh,{["FileExtensionFilterList"]:this.nhh})}Kuk(b){Array.contains(this.mCc,b)||this.mCc.push(b)}S6d(b,k){v.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=k.k_i(b);const t=
[];for(let D=0;D<b.length;D++){const P=b[D];k.lYd(P,this.nhh)?t.push(P):this.Kuk(k.Nei(P))}t&&t.length?k.m2a(t):v.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.mCc.length&&(k=this.mCc.join(", "),v.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",k),this.Tvo(k))}Tvo(b){const k=new Uc.StandardDialog;k.Ad=0;k.$U(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,
b),null)}dispose(){}}Object(n.a)(YB,"InsertMediaFromHostManager",null,[394,9]);class mD{constructor(b){this.d6j=b}nOc(){throw Error.notImplemented();}getInstance(){return this.d6j}}Object(n.a)(mD,"InsertMediaFromHostManagerFactory",null,[392,393]);class ZB{constructor(){this.i0a=document.createElement("iframe");this.i0a.src="about:blank";this.i0a.style.visibility="hidden";this.i0a.style.position="absolute";this.i0a.style.zIndex="-100"}}Object(n.a)(ZB,"InsertMediaFromHostOneDriveHostFrame",null,[391]);
class Qz extends LC.a{constructor(b,k){super(b,"*"===k?k:ia.a.getOrigin(k));this.Smh(K.a.insertImage);this.Smh(K.a.gAf)}Cde(){}}Object(n.a)(Qz,"InsertMediaFromOneDriveCrossDocumentMessenger",LC.a,[390,65,9]);class Rz{}Object(n.a)(Rz,"OnlineMediaSearchResult",null,[]);class xy{$xh(b,k,t,D){const P=Xj.a.og(w.AFrameworkApplication.lcid).name,ca=w.AFrameworkApplication.buildVersion,ta=F.a.SW(w.AFrameworkApplication.K.jb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Na=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",
!1)?1:0;w.AFrameworkApplication.ue("ShIns226;ShIns226cf");return String.format(b,w.AFrameworkApplication.lcid,P,ca,k,xy.Xqe,ta,D,t,Na)}return String.format(b,w.AFrameworkApplication.lcid,P,ca,k,xy.Xqe,ta,D,t)}Ryn(b){if(!b||!b.Values)return null;b=b.Values;if(!b)return null;let k="";"sourceProvider"in b&&(k=b.sourceProvider||"");return Object.assign(new Rz,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",
ContentProvider:k,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||"",ProviderName:b.providerName||""})}Syn(b){const k=[];if(!b||!b.Values||!b.Values.Items)return k;b=b.Values.Items;for(let D=0;D<b.length;D++){var t=b[D];t&&(t=Object.assign(new Rz,{Type:t.Extension||"",OriginalUrl:t.SourceUrl||"",Caption:t.caption,Height:t.Height||0,Width:t.Width||0}),k.push(t))}return k}kYf(b){const k=
[];for(let D=0;D<b.data.files.length;D++){var t=b.data.files[D];t&&(t=Object.assign(new Rz,{ContentType:t.itemType||"",Type:t.extension||"",OriginalUrl:t.urls&&t.urls.open?t.urls.open:"",Height:t.photo?t.photo.height:0,Width:t.photo?t.photo.width:0}),k.push(t))}return k}lYd(b,k){if(!b)return!1;for(let t=0;t<k.length;t++)if(0<=b.toLowerCase().indexOf(k[t]))return!0;return!1}fEn(b){let k="";if(b)for(let t=0;t<b.length;t++){const D=b[t];D&&(k+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',
D.OriginalUrl,D.Width,D.Height))}return k}}xy.Xqe=0;Object(n.a)(xy,"InsertMediaHelper",null,[389]);class Sz{constructor(b,k,t,D,P){this.OKm=b;this.KDf=k;this.nxi=t;this.PKm=D;this.QKm=P}}Object(n.a)(Sz,"InsertMediaSettingsManager",null,[]);class lE{constructor(b){this.xuc=Pb.a.insertHyperlink;this.ga=b}get IPa(){return this.xuc}set IPa(b){this.xuc=b}m2a(b){try{v.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let k=0;k<b.length;k++)this.ga.Qb(this.IPa,
2,b[k]);v.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length)}catch(k){v.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",k.toString())}}}Object(n.a)(lE,"InsertOneDriveFileHandler",null,[388]);class $A extends lE{constructor(b){super(b)}get mNh(){return K.a.gAf}get dRc(){return K.a.Jzm}k_i(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}Nei(){Jc.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");
return""}lYd(){return!0}j3i(b,k,t){b=t(b);b.length&&(t={},t.Items=b,k.sendMessage(this.dRc,t))}m_i(b){const k=[];for(let t=0;t<b.data.files.length;t++){const D=b.data.files[t];if(D){const P={};P.DisplayText=String.format("{0}{1}",D.name,D.extension);P.Url=this.dDl([D.urls.viewInBrowser,D.urls.open,D.urls.download]);k.push(P)}}return k}dDl(b){for(let k=0;k<b.length;k++)if(b[k]&&""!==b[k])return b[k];v.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(n.a)($A,
"InsertOneDriveFileHelper",lE,[387,388]);class Ns{constructor(b,k,t){this.xuc=Pb.a.b_;this.Rp=null;this.ga=b;this.s2=k;this.Jea=t}get pc(){return this.ga}get su(){return this.Rp||(this.Rp=Fa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get IPa(){return this.xuc}set IPa(b){this.xuc=b}m2a(b){try{v.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",b.length);const k=this.s2.fEn(b);let t=2;if(k&&0<k.length){const D=new th.DictionaryPropertySet;
D.setValue(vd.a.gP,k);D.setValue(vd.a.b4,!0);if(this.Jea){const P=this.Jea.W8c();P.P0b("insertOnlineImage");D.setValue(vd.a.bua,P)}t=this.ga.Qb(this.IPa,2,D)}v.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===t,""===k)}catch(k){v.ULS.fE(21612225,352,10,k,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}Object(n.a)(Ns,"InsertOnlineImageHandler",null,[388]);class xk extends Ns{constructor(b,
k,t=null){super(b,k,t)}get mNh(){return K.a.insertImage}get dRc(){return K.a.Xzm}k_i(b){return this.s2.Syn(b)}Nei(b){return b.Type}lYd(b,k){return this.s2.lYd(b.Type,k)}m_i(b){return this.s2.kYf(b)}j3i(b,k,t){t=t(b);if(t.length){b=[];for(let D=0;D<t.length;D++){const P=t[D],ca={};ca.Extension=P.Type;ca.SourceUrl=P.OriginalUrl;ca.caption=P.Type;ca.SourceUrl=P.OriginalUrl;ca.Width=P.Width;ca.Height=P.Height;b.push(ca)}t={};t.Items=b;k.sendMessage(this.dRc,t)}}}Object(n.a)(xk,"InsertOnlineImageHelper",
Ns,[387,388]);class mE{constructor(b,k){this.ctb=b;this.prd=k}start(b){this.ctb.start({mode:"open",select:"multi",lightbox:"white"},(k,t)=>{this.processResponse(k,t,b)})}processResponse(b,k,t){v.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&k&&k.data&&k.data.files&&0<k.data.files.length?(b=this.prd.getInstance(window.frames[0].parent,window.document.URL),t.j3i(k,b,D=>t.m_i(D))):v.ULS.sendTraceTag(22090010,
352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(n.a)(mE,"OneDriveFilePickerHelperV5",null,[279]);class nE{constructor(){this.$kd=this.W=null}get name(){return"Box4.Media"}xc(b){this.W=b;b.ha("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new ZB).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").singleInstance();const k=new Sz(Boolean.parse(w.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||"false"),w.AFrameworkApplication.LDf(),
!1,w.AFrameworkApplication.Ddg(),w.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled"));b.ha("Box4.Media.OneDriveFilePickerHelperV5",()=>new mE(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").singleInstance();b.ha("Box4.Media.InsertMediaActor",()=>new kD(w.AFrameworkApplication.va,w.AFrameworkApplication.K,k,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),
b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new Rg.a(()=>Fa.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),w.AFrameworkApplication.IHb,w.AFrameworkApplication.Noa,
w.AFrameworkApplication.Prm,w.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint,b.resolve("Box4.IDarkModeState"))).singleInstance();b.ha("Box4.Media.InsertMediaDialogFactory",()=>new cF(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").singleInstance();b.ha("Box4.Media.InsertMediaFromHostManagerFactory",()=>new mD(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").singleInstance();
b.ha("Box4.Media.InsertMediaFromHostManager",()=>new YB(new Rg.a(()=>{if(w.AFrameworkApplication.Ddg()){var t=Fa.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").i0a;t=new Qz(t.contentWindow,"*")}else t=w.AFrameworkApplication.KX;return t}),w.AFrameworkApplication.Ddg()?ia.a.getOrigin(window.document.URL):ia.a.getOrigin(w.AFrameworkApplication.sLb),w.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).singleInstance();b.register(bF,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").singleInstance();
b.register(xy,"Box4.Media.InsertMediaHelper").singleInstance();b.ha("Box4.Media.InsertOnlineImageHelper",()=>new xk(w.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Media.InsertOneDriveFileHelper",()=>new $A(w.AFrameworkApplication.va)).singleInstance()}init(){this.$kd=this.W.resolve("Box4.Media.InsertMediaActor");this.$kd.Tb()}dispose(){this.$kd&&this.$kd.dispose()}}Object(n.a)(nE,"MediaPackage",null,
[1,2]);var dF=c(344);class cz{constructor(){this.b7n="getAddinShortcutsPreference";this.c7n="saveAddinShortcutsPreference";this.d7n="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.PJl=6E4;this.e5d=this.zma=this.L9=null}Vei(b){return String.format(this.d7n,w.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",b,w.AFrameworkApplication.hm)}executeRequest(b,k,t,D,P=null){return cz.nQ.c0b(b,k,P,null,t,D,!1,null,this.PJl)}saveSetting(b,k,t,D,P){return this.Dfj(b,k,t,null,D,
P)}startBatchUpdateScope(){this.e5d=[]}saveShortcutInfoArrayBatch(b,k,t){this.g9n(t,b,k)}g9n(b,k,t){const D={action:"",addinId:"",ownerType:0};D.timestamp=(new Date).toUTCString();const P=this.getShortcutInfoArray(k.toString(),t.toString());b?(D.shortcutInfoArray=b,this.vYe(k,t,b)):P&&(D.shortcutInfoArray=P);b={};b[k.toString()]=D;k=new dF.a(t.toString(),b);this.e5d.push(k)}commitBatchUpdateScope(){return this.X7c()?this.i9n().then(()=>{this.F1b();return Promise.resolve(!0)}):this.k9n().then(()=>
{this.F1b();return Promise.resolve(!0)})}i9n(){return this.getSetting().then(b=>{let k=null;if(b&&!({Wu:k}=G.d(b)).returnValue)return v.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);k||(k={});for(const t of this.e5d){(b=k[t.key])||(b={});const D=t.value;for(const P of ib.a.EO(D))b[P]=D[P];k[t.key]=b}this.L9=k;try{return localStorage.setItem("AddinShortcutPreferenceData",G.c(k)),Promise.resolve(!0)}catch(t){return v.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",t),Promise.resolve(!1)}})}k9n(){return this.$co().then(b=>this.Pee(b))}$co(){return this.Ltf().then(b=>{let k=null;b&&(({Wu:k}=G.d(b)).returnValue||v.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));k||(k={});for(const t of this.e5d){(b=k[t.key])||(b={});const D=t.value;for(const P of ib.a.EO(D))b[P]=D[P];k[t.key]=b}this.L9=k;return G.c(k)})}saveShortcutInfoArray(b,k,t){return this.Dfj(0,
"","",t,b,k)}Dfj(b,k,t,D,P,ca){const ta=this.X7c(),Na={};Na.action=t;Na.addinId=k;Na.ownerType=b;Na.timestamp=(new Date).toUTCString();k=this.getShortcutInfoArray(P.toString(),ca.toString());0===b&&D?(Na.shortcutInfoArray=D,this.vYe(P,ca,D)):k&&(Na.shortcutInfoArray=k);b={};b[P.toString()]=Na;P=new dF.a(ca.toString(),b);return ta?this.h9n(P):this.j9n(P)}h9n(b){return this.getSetting().then(k=>{let t=null;if(k&&!({Wu:t}=G.d(k)).returnValue)return v.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),
Promise.resolve(!1);t||(t={});t[b.key]=b.value;this.L9=t;try{return localStorage.setItem("AddinShortcutPreferenceData",G.c(t)),Promise.resolve(!0)}catch(D){return v.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",D),Promise.resolve(!1)}})}j9n(b){return this.Zco(b).then(k=>this.Pee(k))}Zco(b){return this.Ltf().then(k=>{let t=null;k&&(({Wu:t}=G.d(k)).returnValue||v.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
t||(t={});t[b.key]=b.value;this.L9=t;return G.c(t)})}saveSettings(b){this.L9=G.a(b);this.F1b();return this.X7c()?this.Gfj(b):this.Pee(b)}Gfj(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(k){return v.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",k),Promise.resolve(!1)}}Pee(b){const k={};k.Wac=b;const t=G.c(k);return new Promise(D=>{try{if(void 0===t||null===t||!t.length||1E6<=t.length)D(!1);else{var P=this.executeRequest(this.Vei(this.c7n),
2,"SaveAddinShortcutsPreferenceRequest","38",t);P.continueWith(()=>{if(P.zo||P.Ci)v.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),D(!1);else{var ca=P.result;void 0!==ca.args&&null!==ca.args&&void 0!==ca.args.data&&null!==ca.args.data&&ca.args.data.Qe===ha.a.Hy?D(!0):D(!1)}})}}catch(ca){v.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",ca.toString()),D(!1)}})}getSetting(){const b=this.X7c();return this.L9?Promise.resolve(G.c(this.L9)):
b?this.Iam():this.Ltf()}X7c(){const b=w.AFrameworkApplication.K.$("IsAnonymousUser"),k=w.AFrameworkApplication.K.$("IsRoamingServiceEnabled");return b||!k}Iam(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return v.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",b),Promise.resolve("")}}Ltf(){return new Promise((b,k)=>{try{const t=this.executeRequest(this.Vei(this.b7n),1,"GetSettingRequest","37");t.continueWith(()=>{if(t.zo||
t.Ci)v.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let P="";var D=t.result;D&&D.args&&D.args.data?D.args.data.Qe!==ha.a.Hy?v.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",D.args.data.Qe):D.args.data.xe?(D=G.a(D.args.data.xe),D.Wac&&(P=D.Wac)):v.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):v.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(P)}})}catch(t){v.ULS.sendTraceTag(522739866,
0,10,"GetSettingFromRoaming Exception handling request {0}",t.toString()),k("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const k=this.X7c(),t=this;return this.getSetting().then(D=>{let P=null;D&&(P=G.a(D));if(!P)return v.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const ca of ib.a.EO(P)){D=P[ca.toString()];for(const ta of ib.a.EO(D)){const Na=D[ta];if(Na.addinId===b)delete D[ta.toString()];else if(0===Na.ownerType&&
Na.shortcutInfoArray){const qb=Na.shortcutInfoArray,Jb=new Eb.a;for(let Vb=0;Vb<qb.length;++Vb)qb[Vb].addinId!==b&&Jb.add(qb[Vb]);Na.shortcutInfoArray=Jb.toArray()}}ib.a.count(D)||delete D[ca]}t.L9=P;t.xXn(b);return k?t.Gfj(G.c(P)):t.Pee(G.c(P))})}F1b(){if(this.L9){this.zma=null;const t=this.L9;for(let D in t){var b=D;const P=t[D];for(let ca in P){var k=ca;const ta=P[ca];ta.shortcutInfoArray&&this.vYe(parseInt(k),parseInt(b),ta.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>
{let k=null;if(b&&!({Wu:k}=G.d(b)).returnValue)return v.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.L9=k;this.F1b();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,k,t){return this.L9&&(t=this.L9[t])&&(k=t[k])&&k.addinId===b?k:null}getShortcutInfoArray(b,k){return this.L9&&(k=this.L9[k])&&(b=k[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,
k,t){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(k),t)}setShortcutInfoArray(b,k,t){return this.saveShortcutInfoArray(parseInt(b),parseInt(k),t).then(()=>{this.F1b();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,k){if(!this.zma)return Promise.resolve(!0);var t=this.zma[b];if(!t)return Promise.resolve(!0);var D=t[k];t=D.modifiers;D=D.keyCode;const P=this.getShortcutInfoArray(t.toString(),D.toString());if(!P||!P.length)return Promise.resolve(!0);let ca=0;for(const ta of P){if(ta.addinId===
b&&ta.action===k)break;++ca}if(ca>=P.length)return Promise.resolve(!0);P.splice(ca,1);return this.saveShortcutInfoArray(t,D,P).then(()=>{this.F1b();return Promise.resolve(!0)})}vYe(b,k,t){this.zma||(this.zma={});for(const D of t){t=D.addinId;const P=D.action;let ca=this.zma[t];ca||(ca={});const ta={};ta.modifiers=b;ta.keyCode=k;ca[P]=ta;this.zma[t]=ca}}xXn(b){b in this.zma&&delete this.zma[b]}isActionCustomized(b,k){return this.zma&&(b=this.zma[b])&&b[k]?!!b[k]:!1}getShortcutByCustomizedAction(b,
k){return this.zma&&(b=this.zma[b])?b[k]:null}getShortcutsPreferenceMappingTable(){return this.L9}static instance(){cz.A_e||(v.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),cz.A_e=new cz,cz.nQ=w.AFrameworkApplication.Ne);return cz.A_e}}cz.A_e=null;cz.nQ=null;Object(n.a)(cz,"AddinShortcutsPreferenceSettingHelper",null,[]);class eF{constructor(b,k){this.pgd=null;new Eb.a;this.C0g=!0;this.Cjd=b;this.OWg=k}LZe(b){this.OWg.addHandler("GoalChangedEvent",b)}ugn(){this.OWg.raiseEvent("GoalChangedEvent")}iCf(b,
k){return this.pgd&&this.C0g?b in this.pgd?this.pgd[b]:"Formality"===k&&this.Cjd.Btf().formality?!1:!0:!0}Teo(b,k){k===this.Cjd.Btf().formality&&(this.pgd=b,this.ugn())}kTo(b){this.C0g=b}}Object(n.a)(eF,"GoalChangeSource",null,[425,426,427]);var CD=c(980),oE=c(917),pE=c(695);class DD{constructor(b,k,t,D,P,ca){this.AKa=k;this.yAa=t;this.Te=b;this.Zz=D;this.Cg=P;this.e4j=ca;this.yAa.XGb()&&this.initialize()}initialize(){return this.Zz.kl().then(()=>{this.Te.lb(this,CD.a.getTypeName());this.Te.addHandler(this,
oE.a.getTypeName())}).catch(b=>{this.Cg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}UD(b,k){if(k===Ga.a.getTypeName()||k===pE.a.getTypeName())if(!b||!b.content)this.Cg.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");else if(hc.a.getTypeNameFor(b.content)===CD.a.getTypeName()||hc.a.getTypeNameFor(b.content)===oE.a.getTypeName())if(hc.a.getTypeNameFor(b.content)===CD.a.getTypeName()){var t=b.content;this.Cg.sendTraceTag(528274565,
2252,50,"Goal annotation received with formality goal: {0}",t.critiqueConfiguration.formalityGoal);this.AKa.Teo(t.critiqueConfiguration.mapping,t.critiqueConfiguration.formalityGoal)}else if(hc.a.getTypeNameFor(b.content)===oE.a.getTypeName())if(b=b.content,b.features){for(t of b.features)if("Goals"===t.featureName){this.e4j.kTo(!!t.supportType);return}this.Cg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.Cg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}
Object(n.a)(DD,"GoalsAnnotationHandler",null,[251]);class fF{constructor(b){this.Ma=b}XGb(){return this.Ma.$("EditorGoalsEnabled")}}Object(n.a)(fF,"GoalsGate",null,[424]);var OF=c(1172),PF=c(1173),$B=c(867);class hn{}hn.KHd=0;hn.QHd="1.0";hn.settingType="Goals";Object(n.a)(hn,"GoalsConstants",null,[]);var ED=c(1062);class gF{constructor(b,k,t,D,P){this.EXb=null;this.Owi=!1;this.cah=b;this.Ejd=k;this.Cg=t;this.yAa=D;this.IBe=P;this.yAa.XGb()?this.KNn():this.yAa.XGb()&&this.h$f(hn.KHd,hn.QHd)}KNn(){new Promise(b=>
{this.cah.gdi(hn.settingType,k=>{this.LNn(k)?(this.h$f(this.EXb.formality,this.EXb.version),b(this.EXb)):(this.h$f(hn.KHd,hn.QHd),b(null))})})}LNn(b){this.Owi=!0;if(!b||!b.Aob)return this.Cg.sendTraceTag(528274529,2252,50,"No persisted goal is registered."),!1;b=b.Aob.properties;var k=b.getValue(Cc.a.Qri);k=parseInt(k);b=b.getValue(Cc.a.Rri);if(!this.Ejd.Zng(b))return this.Cg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.EXb=
b=Object.assign(new ED.a,{formality:k,version:b});this.Cg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}h$f(b,k){b=Object.assign(new $B.a,{formality:b,version:k});this.IBe.gij(b)}f5o(b){if(this.Ejd.Zng(b.version)){var k=OF.a.M9k(b.version,b.formality.toString());this.cah.ooh(Object.assign(new PF.a,{Aob:k,settingType:hn.settingType}))?this.EXb=b:this.Cg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.Cg.sendTraceTag(528274560,
2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}V$h(){this.Owi||this.Cg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");return this.EXb}}Object(n.a)(gF,"GoalsPersistenceHandler",null,[421]);class hF{constructor(b,k,t,D){this.Cg=b;this.JBe=k;this.Ejd=t;this.yAa=D;this.Djd=Object.assign(new ED.a,{formality:hn.KHd,version:hn.QHd});this.HRe=this.yAa.XGb()}Btf(){this.HRe&&(this.HRe=!1,this.JBe.V$h()&&(this.Djd=this.JBe.V$h()));
return this.Djd}Iko(b){this.HRe=!1;this.Ejd.Zng(b.version)?(this.yAa.XGb()&&this.JBe.f5o(b),this.Djd=b):(this.Cg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",b.version),this.Djd=Object.assign(new ED.a,{formality:hn.KHd,version:hn.QHd}))}}Object(n.a)(hF,"GoalsProvider",null,[422,423]);class FD{constructor(b,k,t,D){this.Te=b;this.Zz=k;this.rV=t;this.Cg=D}gij(b){b=Object.assign(new Ga.a,{parentPath:["Signal",$B.a.getTypeName()],items:[Object.assign(new Fb.a,{body:b})]});
this.ZJd(b)}ZJd(b){this.Zz.kl().then(()=>{this.SXe(b)}).catch(k=>{this.Cg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",k)})}SXe(b){this.Te.activateAnnotation(CD.a.getTypeName(),FD.F0b).then(()=>{this.rV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ec.a,{operation:b}))}).catch(k=>{this.Cg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",k)})}}FD.F0b="GoalSelected";Object(n.a)(FD,"GoalsSignalSender",null,[265]);class Ow{constructor(){Ow.DWe=
new RegExp(Ow.lnk)}Zng(b){return!!b.match(Ow.DWe)&&1===b.match(Ow.DWe).length}}Ow.lnk="[0-9]+[.]?[0-9]*";Ow.DWe=null;Object(n.a)(Ow,"GoalsValidator",null,[262]);class Qq{constructor(){this.W=null}get name(){return"WordEditor.Goals"}init(){this.W.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}xc(b){this.W=b;this.W.ha("WordEditor.Goals.GoalsValidator",()=>new Ow).as("WordEditor.Goals.IGoalsValidator").singleInstance();this.W.ha("WordEditor.Goals.IGoalsGate",()=>new fF(this.W.resolve("Common.IAppSettingsManager"))).singleInstance();
this.W.ha("WordEditor.Goals.GoalsProvider",()=>new hF(this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").singleInstance();this.W.ha("WordEditor.Goals.GoalChangeSource",()=>new eF(this.W.resolve("WordEditor.Goals.IGoalReader"),new Ue.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").singleInstance();
this.W.ha("WordEditor.Goals.GoalsPersistenceHandler",()=>new gF(this.W.resolve("Box4.PersistenceSettingsManager"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsAnnotationHandler",()=>new DD(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),
this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsSignalSender",()=>new FD(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").singleInstance()}static main(){N.a.instance.Fc(new Qq)}}
Object(n.a)(Qq,"WordEditorGoalsPackage",null,[1,2]);var GD=c(743),HD=c(408);class qE{constructor(){this.annotation=null;this.languages=new Ji.a(Ja.a.ei())}}Object(n.a)(qE,"CritiqueCountWrapper",null,[]);class Tz{constructor(){this.Bra=new cb.a}uOd(){return this.Bra}opi(b,k,t,D){if(this.Bra.nb(t)){this.Bra.J(t).annotation.count+=k;t=this.Bra.J(t).languages;for(var P of D)t.add(P)}else P=X.a.create().toString(),b=Object.assign(new HD.a,{id:P,categoryName:b,count:k}),this.Bra.add(t,Object.assign(new qE,
{annotation:b,languages:D}))}}Tz.Ei=389;Object(n.a)(Tz,"BaseCritiquesByTypeCounter",null,[248]);class aC extends Tz{constructor(b){super();this.Mwb=new Ca.a;this.qwe=new Ca.a;this.Nxd=b}gkm(b){const k=b.annotation;if(k&&GD.a(hc.a.getTypeNameFor(k.content))){const t=k.content;if(b.opType===Ga.a.getTypeName()){this.Nxd.CZn(k.parentPath,t);b=t.M_.state;if(60!==b&&70!==b)return this.Mwb.contains(k.id)&&this.Mwb.remove(k.id),this.Ium(k.id,t),!0;this.Mwb.add(k.id)}else if(b.opType===$l.a.getTypeName())if(this.Mwb.contains(k.id))this.Mwb.remove(k.id);
else return this.vOh(t.typeId,k.id)}return!1}fkm(b){if((b=b.annotation)&&GD.a(hc.a.getTypeNameFor(b.content))){const k=b.content,t=k.M_.state;if((60===t||70===t)&&!this.Mwb.contains(b.id))return this.Mwb.add(b.id),this.vOh(k.typeId,b.id)}return!1}Ium(b,k){this.qwe.add(b);b=new Ji.a(Ja.a.ei());k.language&&b.add(k.language);this.opi(k.categoryName,1,k.typeId,b)}vOh(b,k){if(!this.qwe.contains(k))return!1;if(!this.Bra.nb(b))return v.ULS.sendTraceTag(589866503,Tz.Ei,15,"Unable to decrement the count for critique category {0}. Reason : {1}",
b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.Bra.J(b).annotation.count)return v.ULS.sendTraceTag(589866504,Tz.Ei,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.qwe.remove(k);this.Bra.J(b).annotation.count--;return!0}}Object(n.a)(aC,"AlCritiquesByTypeCounter",Tz,[527,248]);var nD=c(999);class aw extends Iu.a{constructor(b,k,t,D,P,ca,ta,Na,qb){var Jb;super();this.Te=b;this.Nxd=k;this.ese=
t;this.ORg=D;this.AKa=P;this.Isa=ca;this.ri=ta;this.J$=this.gQg=!1;this.dLe=new cb.a;this.Xln=(Vb,ac)=>{this.Nxd.glm(ac)&&(this.J$=!0,this.pY())};this.Vin=(Vb,ac)=>{this.ese.gkm(ac)&&this.FNb()};this.WSi=()=>{this.FNb()};this.qSf=(Vb,ac)=>{this.ese.fkm(ac)&&this.FNb()};this.Rlb=()=>{this.FNb()};this.FNb=()=>{let Vb=!1;this.ri.ie(()=>{var ac=this.aRl();const yc=new Eb.a;for(const Kc of ac)ac=Object.assign(new nD.a,{id:Kc.id,parentPath:yp.a.ZBb,content:Kc,annotationType:hc.a.getTypeNameFor(Kc)}),yc.add(ac),
Vb||(Vb=0<Kc.count);this.Te.Seo(yc)},"CC:SATH");!this.gQg&&Vb&&(ea.a.sendTelemetryEvent({...(new pa.a),name:"Office.Word.Online.Editor.CritiquesAvailable"}),this.gQg=!0)};this.BGm=(Vb,ac,yc)=>{const Kc=!this.AKa||this.AKa.iCf(Vb,yc);Vb=this.Isa&&this.Isa.instance?this.Isa.instance.XXd(Vb,yc,ac.substr(1,ac.length-2)):!0;return Kc&&Vb};null===Na||void 0===Na?void 0:Na.LZe(this.Rlb);qb.aqa(this,7);null===(Jb=this.Isa)||void 0===Jb?void 0:Jb.execute(Vb=>{Vb.m_e(this.FNb)})}get index(){return 3}run(){this.J$&&
(this.FNb(),this.J$=!1)}xVi(){this.FNb()}O6k(b){let k=0;if(({value:k}=this.dLe.Dc(b.categoryName,0)).returnValue)if(k!==b.count)this.dLe.Z(b.categoryName,b.count);else return!1;else this.dLe.add(b.categoryName,b.count);return!0}aRl(){const b=new cb.a;var k=this.Nxd.uOd();const t=this.ese.uOd();this.Plg(b,k);this.Plg(b,t);this.ORg&&(k=this.ORg.uOd(),this.Plg(b,k));k=new Eb.a;for(const D of b.values)this.O6k(D)&&k.add(D);return k}Plg(b,k){for(const P of k){k=P.value.annotation;const ca=P.key;var t=
this.Yco(P.value.languages);if(!b.nb(k.categoryName)){var D=X.a.create().toString();D=Object.assign(new HD.a,{id:D,categoryName:k.categoryName,count:0,countsByTypeId:{}});b.add(k.categoryName,D)}this.BGm(ca,t,k.categoryName)&&(t=b.J(k.categoryName),t.count+=k.count,t.countsByTypeId[ca]=(t.countsByTypeId[ca]?t.countsByTypeId[ca]:0)+k.count)}}Yco(b){const k=[];let t=0;for(const D of b)k[t++]=D;return G.c(k)}}Object(n.a)(aw,"CritiquesCounter",Iu.a,[528,529]);class ou{constructor(b){this.W1=b}uOd(){const b=
new cb.a,k=new Ji.a(Ja.a.ei()),t=Object.assign(new HD.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.W1.pqc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new qE,{annotation:t,languages:k}));return b}}Object(n.a)(ou,"DictationCritiquesByTypeCounter",null,[249,248]);class rE extends Tz{constructor(b){super();this.n9a=new cb.a;this.Te=b}glm(b){const k=yp.a.aRd(b.nodeId);if(!yp.a.jf(k)){if(b.igb&&b.igb.length){let t=null;for(const D of b.igb)D.errorDetails.S2a()||
(b=this.B6h(D),yp.a.jf(b)||(t||(t=new cb.a),t.nb(b)||t.add(b,new Eb.a),t.J(b).add(D)));this.wOh(k);t?this.Lio(k,t):this.n9a.remove(k)}else{if(!this.n9a.nb(k))return!1;this.wOh(k);this.n9a.remove(k)}return!0}return!1}CZn(b,k){var t;if(({value:t}=this.n9a.Dc(b,t)).returnValue)for(const P of t)if(b=P.value,0<b.count&&this.Jof(b.J(0))===k.categoryName)for(t=b.count-1;0<=t;t--){var D=b.J(t).end-b.J(t).begin;b.J(t).begin===k.range.start&&D===k.range.length&&(D=this.B6h(b.J(t)),this.Bra.nb(D)&&(D=this.Bra.J(D).annotation,
D.count=Math.max(0,D.count-1)),b.removeAt(t))}}wOh(b){if(this.n9a.nb(b))for(const t of this.n9a.J(b)){var k=t.key;b=t.value;this.Bra.nb(k)&&(k=this.Bra.J(k).annotation,k.count=Math.max(0,k.count-b.count))}}Lio(b,k){const t=new cb.a,D=new cb.a;for(const P of k){k=P.key;D.add(k,new Ji.a(Ja.a.ei()));for(const ca of P.value){const ta=ca.end-ca.begin,Na=this.Jof(ca);this.lUk(b,Na,ca.begin,ta)?v.ULS.sendTraceTag(589866513,Tz.Ei,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",
k,b,ca.begin,ta):(t.nb(k)||t.add(k,new Eb.a),t.J(k).add(ca),D.J(k).add(this.cRl(ca)))}}this.n9a.Z(b,t);for(const P of this.n9a.J(b))0<P.value.count&&(b=this.Jof(P.value.J(0)),this.opi(b,P.value.count,P.key,D.J(P.key)))}B6h(b){let k=null;b&&(b=Object(Ka.a)(246,b.errorDetails))&&b.nt&&(k=b.nt.TypeId);return k}Jof(b){let k=null;b&&(b=Object(Ka.a)(246,b.errorDetails))&&b.nt&&(k=b.nt.CategoryTitle);return k}cRl(b){let k="";b&&b.errorDetails&&(k=Xj.a.og(b.errorDetails.lcid).name);return k}lUk(b,k,t,D){if((b=
this.Te.y3h(b))&&0<b.count)for(const P of b)if(b=hc.a.getTypeNameFor(P.content),P&&GD.a(b)&&(b=P.content,b.categoryName===k&&b.range.start===t&&b.range.length===D))return!0;return!1}}Object(n.a)(rE,"WacCritiquesByTypeCounter",Tz,[247,248]);class cs{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}xc(b){this.W=b}init(){var b=this.W.resolve("Common.IAppSettingsManager");if(b.$("AugLoopOperationsAreEnabled")){this.W.ha("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>
new rE(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).singleInstance();this.W.ha("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>new aC(this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("Common.IAppSettingsManager"))).singleInstance();var k=b.$("DictationCorrectionsInEditorPaneIsEnabled");k&&this.W.ha("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new ou(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).singleInstance();
this.W.ha("WordEditor.CritiqueCounts.ICritiquesCounter",()=>new aw(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.W.Na("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.W.Na("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.Sa("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),pr.a.instance,this.W.Na("WordEditor.Goals.IGoalChangeSource"),
this.W.resolve("Box4.Graph.IGraphTransactionManager"))).singleInstance();b=this.W.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.W.resolve("Box4.Proofing.IErrorRangeEditor").Tph(b.Xln);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").Xvk(b.Vin);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").Fph(b.qSf);k&&(k=this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),k.nph(b.WSi),k.oph(b.WSi))}}dispose(){}static main(){N.a.instance.Fc(new cs)}}Object(n.a)(cs,
"WordEditorCritiqueCountsPackage",null,[1,2]);class aB{get name(){return"WordEditor.GraphicsEditor"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new aB)}}Object(n.a)(aB,"PackageManager",null,[1,2]);var ID=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},
children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",
Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",
Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",
LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class OC{constructor(b){this.S0j={};this.Ub=b;this.Wwb=new bc.a}kOa(b,k){const t=this.Ub.cgc,D=parseInt(b);return b&&D!==Xc.ActionManager.Rgf?this.Wwb.nb(t)?(b=this.Wwb.J(t).U8b(D,k,2),
32===b||1===b):!1:!1}AFa(b){const k=parseInt(b),t=this.Ub.cgc;return b&&k!==Xc.ActionManager.Rgf?this.Wwb.nb(t)?32===this.Wwb.J(t).U8b(k,this.S0j,1):!1:!0}u8i(b,k){this.Wwb.Z(b,k)}Yoj(b){b=parseInt(b);const k=this.Ub.cgc;return!!k&&!!this.Wwb.J(k)&&this.Wwb.J(k).GFm(b)}}Object(n.a)(OC,"NonCanvasCuiUser",null,[887,555]);var Dx=c(1197),bw=c(49),PC;(function(b){b[b.UnspecifiedGallery=0]="UnspecifiedGallery";b[b.CharacterCodeGallery=1]="CharacterCodeGallery";b[b.FontStyleGallery=2]="FontStyleGallery";
b[b.InkThicknessGallery=3]="InkThicknessGallery";b[b.IconGallery=4]="IconGallery";b[b.ListGallery=5]="ListGallery";b[b.TableStyleGallery=6]="TableStyleGallery";b[b.PageNumberGallery=7]="PageNumberGallery";b[b.ChangeColorsGallery=8]="ChangeColorsGallery"})(PC||(PC={}));Object(n.b)("GalleryType",PC);class wq{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(n.a)(wq,"CommonGalleryButtonProps",null,[]);class bB extends wq{constructor(){super();this.tableStyles=this.tableCellStyles=
null;this.columns=0}}Object(n.a)(bB,"AdditionalTableStyleGalleryButtonProps",wq,[]);class cw extends bB{constructor(){super()}}Object(n.a)(cw,"AdditionalChangeColorsGalleryButtonProps",bB,[]);class Uz extends wq{constructor(){super();this.character=null}}Object(n.a)(Uz,"AdditionalCharacterCodeGalleryButtonProps",wq,[]);class JD extends wq{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(n.a)(JD,"AdditionalFontStyleGalleryButtonProps",wq,[]);class vr{constructor(){this.selectedId=
this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(n.a)(vr,"AdditionalGalleryProperties",null,[]);class KD extends wq{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(n.a)(KD,"AdditionalIconButtonProperties",wq,[]);class sE extends wq{constructor(){super();this.styleDisplayName=null}}Object(n.a)(sE,"AdditionalInkThicknessGalleryButtonProps",
wq,[]);class bC extends wq{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(n.a)(bC,"AdditionalListGallerButtonProps",wq,[]);class QC extends wq{constructor(){super();this.text=null}}Object(n.a)(QC,"AdditionalPageNumberGalleryButtonProps",wq,[]);var Sf=c(1128);const tE=(b,k)=>{var t=appChrome.selectors.getActiveControlStates();if(t=Object(Ka.a)(Object,t[b])){if((b=Object(Ka.a)(String,t.value))&&b===k)return!1;b=Object(Ka.a)(String,t.selectedKey);if(!k&&!b)return!1;if(b){t=Array.isArray(t.options)?
t.options:null;let D=null;for(let P=0;P<t.length;P++){const ca=Object(Ka.a)(Object,t[P]);if(Object(Ka.a)(String,ca.key)===b){D=ca;break}}if(D&&Object(Ka.a)(String,D.text)===k)return!1}}return!0},cC=(b,k,t,D)=>{if(0<(D&2)){D=[];switch(k){case "ToggleButtonModel":case "InkButtonModel":D.push(RC(b,t[kg.a.On]));break;case "CheckboxModel":D.push(appChrome.actions.toggleCheckbox(b,t[kg.a.On]));break;case "ComboBoxModel":if(w.AFrameworkApplication.K&&(w.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!tE(b,t[Vl.a.Value]))break;(k=t[Vl.a.Key])?D.push(appChrome.actions.updateComboBoxKey(b,k,t[Vl.a.Value])):D.push(appChrome.actions.updateComboBoxValue(b,t[Vl.a.Value]));break;case "FontPickerModel":D.push(appChrome.actions.updateFontPickerSelectedFont(b,t[Sf.a.SelectedFont]));break;case "SplitButtonModel":D.push(RC(b,t[Gn.a.On]));break;case "SpinButtonModel":D.push(appChrome.actions.updateSpinButton(b,
t[Dh.a.Number],Ef.a.d_a(t[Dh.a.UnitType]),t[Dh.a.Text],t[Dh.a.MaxValue],t[Dh.a.Alt]));break;case "ColorPickerModel":D.push(appChrome.actions.updateColorPickerSelectedColor(b,t[Hd.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":D.push(appChrome.actions.updatePageNumberGalleryButtonText(b,t[Mi.a.Text]));break;case "CompoundButtonModel":t[kg.a.Description]&&D.push(appChrome.actions.updateCompoundButtonDescription(b,t[kg.a.Description]));kg.a.On in t&&D.push(RC(b,t[kg.a.On]));break;case "SliderModel":t.snapToStep?
D.push(appChrome.actions.updateSliderSelectedValue(b,t[Nj.Value])):D.push(appChrome.actions.updateSliderValue(b,t[Nj.Value],t[Nj.MinValue]||0,t[Nj.MaxValue],t[Nj.Text]));break;case "FlyoutAnchorModel":jk.a.ImageIsVisible in t&&D.push(appChrome.actions.hideFlyoutAnchorIcon(b,!t[jk.a.ImageIsVisible]));kg.a.On in t&&D.push(RC(b,t[kg.a.On]));break;case "InputBoxModel":D.push(appChrome.actions.updateInputBoxValue(b,t[Mk.a.Text]))}k=D;var P=Object(Ka.a)(String,t[ka.a.iconColor]);void 0!==P&&null!==P&&k.push(appChrome.actions.updateIconColor(b,
P));dB(b,t,D);k=D;(P=Object(Ka.a)(Object,t[ka.a.IconSet]))&&k.push(appChrome.actions.setControlIconSet(b,P));k=D;P=Object(Ka.a)(String,t[ka.a.customTooltip]);void 0!==P&&null!==P&&k.push(appChrome.actions.setControlCustomTooltip(b,P));b=D;(t=Array.isArray(t[ka.a.D3f])?t[ka.a.D3f]:null)&&b.push.apply(b,t);return D}return null},cB=(b,k)=>appChrome.actions.updateControlEnabledDisabledState(b,k),RC=(b,k)=>appChrome.actions.toggleButton(b,k),dB=(b,k,t)=>{k=Object(Ka.a)(String,k[ka.a.Icon]);void 0!==k&&
null!==k&&t.push(appChrome.actions.setControlIcon(b,k))};class LD{constructor(b,k,t,D){this.Pl=D;this.Qsa=b;this.Uz=k;this.pYb=t;this.wvc={}}hCn(b,k,t,D,P=null){const ca=b.ExternalGalleryId||b.ExternalId;var ta=b.ExternalId;D.push(ca);if(appChrome.selectors.isControlDefined(ca))b.GalleryStyle&&Qg.d("setGalleryStyles")&&k.push(appChrome.actions.setGalleryStyles(ca,b.GalleryStyle));else{if(4!==b.Type)return;t.push(appChrome.api.createGalleryModel(ca,Object.assign(new vr,{columns:b.Width,sections:[appChrome.api.gallerySection([],
ta)],styles:b.GalleryStyle,galleryType:"IconGallery"})))}t=0;D=!!w.AFrameworkApplication.K&&(w.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(Qg.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){ta=[];const qb=[],Jb=[],Vb={};for(var Na of b.GallerySections){ta.push(appChrome.api.gallerySection([],Na.SectionId,Na.Title));0===t&&Na.GalleryButtons&&
0<Na.GalleryButtons.length&&(t=Na.GalleryButtons[0].Type);D&&this.xdi(Na.GalleryButtons,P,Vb);const ac=this.FYe(qb,Na.GalleryButtons,Vb);qb.push.apply(qb,this.Nsf(ac,ca,Na.SectionId,!1,t,P,!0,Vb));Jb.push.apply(Jb,ac)}k.push(appChrome.actions.setGallerySections(ca,ta));k.push.apply(k,qb);k.push.apply(k,this.iqf(ca,PC[t],Jb,null,5===b.Type,!0,null,Vb))}else b.GalleryItems&&0<b.GalleryItems.length&&(t=b.GalleryItems[0].Type),Na=D?this.xdi(b.GalleryItems,P,null):null,k.push.apply(k,this.Nsf(this.FYe(k,
b.GalleryItems,Na),ca,ta,!1,t,P,!1,Na))}u7l(b,k){const t=[];let D=null,P=!1;if(!b)return null;const ca=this.Qsa.k1c(this.Uz,b.commandId,k);t.push(cB(b.externalUxCommand,!ca));if(b.previewControlIds){const qb=[];for(let Jb=0;Jb<b.previewControlIds.length;Jb++){var ta={},Na=b.previewControlIds[Jb];ta.SourceControlId=Na;const Vb=this.Pl.getCommandByExternalUxId(Na);this.nRd(Vb||b,ta);ta[Mi.a.On]&&(D=ta.SourceControlId,ta[Mi.a.HighlightOn]&&(P=!0));dB(Na,ta,t);if(ta=Object(Ka.a)(my.a,ta[Mi.a.GalleryButtonProps]))qb.push(ta),
ca&&(Na=this.Qsa.k1c(this.Uz,ta.Command,k),ta.IsDisabled=!Na)}0<qb.length&&t.push.apply(t,this.Nsf(this.FYe(t,qb),b.externalUxCommand,b.externalUxCommand,!0,qb[0].Type));t.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,D));P&&(v.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",D),t.push(appChrome.actions.highlightSelectedFontStyle(D)))}return t}FYe(b,k,t=null){const D=[],P=[];for(let ta=0;ta<k.length;ta++){const Na=k[ta],qb=Hf.b(Na.ExternalId)?
Na.Id:Na.ExternalId;D.push(qb);const Jb=t&&t[qb]?t[qb].result:-1;switch(Na.Type){case 1:var ca=Na;P.push(appChrome.api.createCharacterCodeGalleryButtonModel(qb,Object.assign(new Uz,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,character:ca.Character,style:ca.Style,title:ca.Alt})));break;case 2:ca=Na;P.push(appChrome.api.createFontStylesGalleryButtonModel(qb,Object.assign(new JD,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,styleDisplayName:ca.LabelText,style:ca.Style,title:ca.Alt,previewStyleLabel:ca.PreviewStyleLabel})));
break;case 3:ca=Na;P.push(appChrome.api.createInkThicknessGalleryButtonModel(qb,Object.assign(new sE,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,styleDisplayName:ca.LabelText,style:ca.Style,title:ca.Alt})));break;case 4:ca=Na;P.push(appChrome.api.createIconGalleryButtonModel(qb,Object.assign(new KD,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,icon:[ca.Icon],fullIconStyle:ca.FullIconStyle,previewIconStyle:ca.PreviewIconStyle,largePreviewIconStyle:ca.LargePreviewIconStyle,label:ca.LabelText,title:ca.Alt})));
break;case 5:ca=Na;P.push(appChrome.api.createListGalleryButtonModel(qb,Object.assign(new bC,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,infoAtLevel:ca.LevelInfo,ariaLabel:ca.Alt})));break;case 6:ca=Na;P.push(appChrome.api.createTableStyleGalleryButtonModel(qb,Object.assign(new bB,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,tableCellStyles:ca.TableCellStyles,tableStyles:ca.TableStyles,title:ca.Alt,columns:ca.columns})));break;case 8:ca=Na;P.push(appChrome.api.createChangeColorsGalleryButtonModel(qb,Object.assign(new cw,
{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,tableCellStyles:ca.TableCellStyles,tableStyles:ca.TableStyles,title:ca.Alt})));break;case 7:ca=Na,P.push(appChrome.api.createPageNumberGalleryButtonModel(qb,Object.assign(new QC,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,text:ca.Text,title:ca.Alt})))}this.Pl.addCommandToMaps(Object.assign(new bw.a(qb,Na.Command),{queryCommandId:Na.QueryCommand,menuItemId:Na.MenuItemId}))}b.push(appChrome.actions.addControls(P));return D}Nsf(b,k,t,D,P,ca=null,ta=!1,Na=null){const qb=
[];D?qb.push(appChrome.actions.populateGalleryItems(k,b)):(this.wvc[k]=!1,ta||(D=!0,appChrome.selectors.isControlDefined(k)&&(D=appChrome.selectors.getGalleryState(k),D=D.disableIndividualButtons?D.disableIndividualButtons:!0),qb.push.apply(qb,this.iqf(k,PC[P],b,null,5===P,D,ca,Na))),qb.push(appChrome.actions.updateGallerySectionItems(k,t,b)));return qb}AWl(b){return this.iqf(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}iqf(b,
k,t,D,P,ca=!0,ta=null,Na=null){const qb=[];if(b in this.wvc){if(this.wvc[b])return delete this.wvc[b],qb;this.wvc[b]=!0}let Jb=null,Vb=-1;if(t)({W1h:Vb,returnValue:Jb}=this.Hnh(k,t,qb,ca,ta,Na));else if(D)for(const ac of D)(t=({W1h:Vb}=this.Hnh(k,ac.galleryButtons,qb,ca,null,Na)).returnValue)&&(Jb=t);qb.push(appChrome.actions.updateGallerySelectedId(b,Jb));ca&&qb.push(cB(b,!1));P&&0<Vb&&qb.push(appChrome.actions.updateListGalleryTextDirection(b,2===Vb));return qb}wdi(b,k=null){const t={},D={};D.SourceControlId=
b;D.Location=k;b=this.Pl.getCommandByExternalUxId(b);if(!b)return t.result=-1,t.props=D,t;b=this.nRd(b,D);t.result=b;t.props=D;return t}xdi(b,k=null,t=null){t||(t={});for(const D of b)b=Hf.b(D.ExternalId)?D.Id:D.ExternalId,t[b]=this.wdi(b,k);return t}Hnh(b,k,t,D,P=null,ca=null){let ta,Na=null;ta=-1;let qb=!1;for(const Vb of k){var Jb=this.xWl(b);k=ca&&ca[Vb]&&-1!==ca[Vb].result?ca[Vb]:this.wdi(Vb,P);const ac=k.result;k=k.props;D&&t.push(cB(Vb,1>(ac&1)));(Jb=cC(Vb,Jb,k,ac))&&t.push.apply(t,Jb);k[Mi.a.On]&&
(Na=Vb,k[Mi.a.HighlightOn]&&k[Mi.a.HighlightOn]&&(qb=!0));void 0!==k[ka.a.labelText]&&null!==k[ka.a.labelText]&&(Jb=this.Pl.getCommandByExternalUxId(Vb),t.push(appChrome.actions.setControlLabel(Jb.externalUxCommand,k[ka.a.labelText])));k[Mi.a.IsRtl]&&0>ta&&(ta=k[Mi.a.IsRtl])}qb&&(v.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Na),t.push(appChrome.actions.highlightSelectedFontStyle(Na)));return{returnValue:Na,W1h:ta}}xWl(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}nRd(b,k){k.MenuItemId=b.menuItemId;return this.Qsa.xpa(this.Uz,this.pYb,
b.commandId,b.queryCommandId,k)}}Object(n.a)(LD,"ReactGalleryPoller",null,[]);var uE=c(690),Yh=c(657),vE=c(1682),iF=c(754),Oj=c(1683);class jF{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(n.a)(jF,"PopulateFontPickerDataProps",null,[]);var wE=c(283),dw=c(1845);class pv{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;
this.shouldTakeFocus=!1}}Object(n.a)(pv,"CommonOptionalButtonProperties",null,[]);class MD extends pv{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(n.a)(MD,"OptionalButtonProperties",pv,[]);class kF extends pv{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(n.a)(kF,"OptionalCompoundButtonProperties",pv,[]);class lF extends pv{constructor(){super();
this.onRetryCommandId=this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(n.a)(lF,"OptionalErrorViewProperties",pv,[]);class xE extends pv{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(n.a)(xE,"OptionalFlyoutAnchorProperties",pv,[]);class mF extends pv{constructor(){super();this.isBanner=null}}Object(n.a)(mF,"OptionalLabelProperties",
pv,[]);class nF extends pv{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(n.a)(nF,"OptionalMultipActionButtonProperties",pv,[]);class oF extends MD{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(n.a)(oF,"OptionalPersonaButtonProperties",MD,[]);class oD extends pv{constructor(){super();this.toggled=!1;
this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(n.a)(oD,"OptionalToggleButtonProperties",pv,[]);var yE=c(1685),pD=c(1684),zE=c(472);class SC{constructor(){this.xFh=this.actions=null;this.rJj=!1}}Object(n.a)(SC,"PopulateActions",null,[]);class AE{ogi(b,k){switch(k){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.m8l(b);case "InkButtonModel":return this.l8l(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);
case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}m8l(b){const k={};k[kg.a.On]=appChrome.selectors.getButtonToggleState(b);return k}l8l(b){const k={};k[kg.a.On]=Qg.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return k}}Object(n.a)(AE,"ReactStatePropsSelector",null,[]);class ND{constructor(b,k,t,D,P){this.Qsa=b;this.Uz=k;this.pYb=t;this.Pl=D;this.mTe={};this.rfk=new AE;this.Gwb=P}Bsj(b){const k=b.populationProps.populateQueryCommandId;
return b.populationProps.populateOnlyOnce&&k in this.mTe}L8l(b,k,t=null){const D=[],P={};if(!this.Bsj(b)){const ca=b.populationProps.populateQueryCommandId,ta={};ta.MenuId=b.externalUxCommand;ta.IsShadowMenuOpen=this.isShadowMenuOpen(t);if(0<(this.Qsa.xpa(this.Uz,this.pYb,ca,ca,ta,this.hZl(t))&1))if("FontPickerModel"===k)this.mTe[ca]=!0,D.push(ND.Z6l(b,ta)),P[b.externalUxCommand]="FontPickerModel";else if(ta.MenuItems)switch(this.mTe[ca]=!0,k){case "ComboBoxModel":D.push(ND.X6l(b,ta));P[b.externalUxCommand]=
"ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":D.push.apply(D,this.uii(b.externalUxCommand,k,ta.MenuItems,P,t&&"location"in t?t.location:null))}}return Object.assign(new SC,{actions:D,xFh:P,rJj:this.isShadowMenuOpen(t)})}Sai(b,k,t,D,P,ca,ta,Na,qb=null){let Jb=null;const Vb=[];Hf.c(b.Title)||(Jb=b.Title);for(let ac=0;ac<b.ControlList.length;ac++){const yc=Object(Ka.a)(ep.a,b.ControlList[ac]);
if(!yc||yc.ExternalId)ca&&this.cPl(yc,ca),k.push.apply(k,this.Y6l(yc,ta,Vb,P,t,D,qb))}return Na?appChrome.api.menuSection(Vb,Jb,b.Lang):null}uii(b,k,t,D,P=null){const ca=[],ta=[],Na=[],qb=[];for(var Jb=0;Jb<t.MenuSectionList.length;Jb++){var Vb=Object(Ka.a)(fh.a,t.MenuSectionList[Jb]);Vb&&(Vb=this.Sai(Vb,ca,b,k,qb,D,ta,t.UpdateDynamically,P),t.UpdateDynamically&&Na.push(Vb))}Jb=null;t.MenuFooterSection&&(Jb=this.Sai(t.MenuFooterSection,ca,b,k,qb,D,ta,t.UpdateDynamically,P));t.UpdateDynamically&&ca.push(appChrome.actions.updateMenu(b,
Na,t.Title,t.AriaLabel,t.ShouldAutoOpen,t.AriaRoleDescription,t.MenuTargetDescriptor,Jb));0<ta.length&&ca.splice(0,0,appChrome.actions.addControls(ta));0<qb.length&&Qg.d("setStatefulSplitButtonMruBypassControls")&&ca.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,qb));return ca}cPl(b,k){switch(b.ControlType){case 1:case 3:k[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:k[b.ExternalId]="ToggleButtonModel";break;case 6:k[b.ExternalId]="CheckboxModel";
break;case 7:k[b.ExternalId]="ColorPickerModel";b=Object(Ka.a)(Pv.a,b);b.McuLayout&&(k[b.McuExternalId]="ColorPickerModel");break;case 9:k[b.ExternalId]="FlyoutAnchorModel"}}Y6l(b,k,t,D,P,ca,ta=null){const Na=[];switch(b.ControlType){case 14:w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&this.kCn(Object(Ka.a)(iF.a,b),Na,k,t);break;case 1:case 3:D=Object(Ka.a)(zg.a,b);this.SBn(D,Na,k,t);D.MenuItemsStatefulData&&Qg.d("setStatefulSplitButtonMenuItemsStatefulData")&&
Na.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(P,D.MenuItemsStatefulData));break;case 2:this.DCn(Object(Ka.a)(zE.a,b),Na,k,t);break;case 6:this.TBn(Object(Ka.a)(zx.a,b),Na,k,t);break;case 4:this.wCn(Object(Ka.a)(em,b),Na,k,t);break;case 7:this.VBn(Object(Ka.a)(Pv.a,b),Na,k,t);break;case 12:this.bCn(Object(Ka.a)(vE.a,b),Na,k,t);break;case 13:this.tCn(Object(Ka.a)(Oj.a,b),Na,k,t);break;case 9:P=Object(Ka.a)(jj.a,b);this.dCn(P,Na,k,t);"StatefulSplitButtonModel"===ca&&D.push(P.ExternalId);
break;case 8:this.Gwb.hCn(Object(Ka.a)(Jj.a,b),Na,k,t,ta)}return Na}kCn(b,k,t,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&k.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.IconName&&0<b.IconName.length&&k.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(k=null,b.IconName&&0<b.IconName.length&&(k=new dw.a(b.IconName)),t.push(appChrome.api.createLabelModel(b.ExternalId,b.LabelText,b.Id,Object.assign(new mF,{isBanner:b.IsBanner,
iconSet:k?k.iconSet:null}))))}SBn(b,k,t,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&k.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&k.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&k.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),this.aAd()&&((t=this.WOa(b))&&0<t.length&&k.push(appChrome.actions.setControlIconSet(b.ExternalId,(new dw.a(t)).iconSet)),
b.LabelText!==b.Alt&&k.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||Object(ob.a)(dv,b)?t.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new kF,{iconSet:(new dw.a(this.WOa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):(D=b.DismissHostingSurfaceOnExecute,t.push(appChrome.api.createButtonModel(b.ExternalId,b.LabelText,Object.assign(new MD,
{iconSet:(new dw.a(this.WOa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==D&&null!==D?D:!0})))),this.Pl.addCommandToMaps(Object.assign(new bw.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));b.Lang&&Qg.d("setControlLanguage")&&
k.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}TBn(b,k,t,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&k.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.aAd()&&((t=this.WOa(b))&&0<t.length&&k.push(appChrome.actions.setControlIconSet(b.ExternalId,(new dw.a(t)).iconSet)),b.IsChecked&&k.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&k.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(t.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new oD,{iconSet:(new dw.a(this.WOa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.Pl.addCommandToMaps(Object.assign(new bw.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}bCn(b,k,t,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(b.Label&&k.push(appChrome.actions.setControlLabel(b.ExternalId,b.Label)),b.IconName&&0<b.IconName.length&&k.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(k=null,b.IconName&&0<b.IconName.length&&(k=new dw.a(b.IconName)),t.push(appChrome.api.createErrorViewModel(b.ExternalId,Object.assign(new lF,{label:b.Label,retryButtonTitle:b.RetryButtonTitle,onRetryCommandId:b.OnRetryCommandId,ariaDescription:b.AriaDescription,iconSet:k?k.iconSet:null}))))}tCn(b,k,t,D){D.push(b.ExternalId);
appChrome.selectors.isControlDefined(b.ExternalId)?(t={},b.Label&&(t.label=b.Label),b.SecondaryLabel&&(t.secondaryLabel=b.SecondaryLabel),b.Description&&(t.description=b.Description),b.iconSet&&(t.iconSet=b.iconSet),b.Links&&(t.links=b.Links),b.CommandValueId&&(t.commandValueId=b.CommandValueId),b.ActionCommandValueId&&(t.actionCommandValueId=b.ActionCommandValueId),b.ActionCommandId&&(t.actionCommandId=b.ActionCommandId),b.CommandId&&(t.commandId=b.CommandId),k.push(appChrome.actions.updateMultiActionButton(b.ExternalId,
t))):t.push(appChrome.api.createMultiActionButtonModel(b.Id,Object.assign(new nF,{label:b.Label,secondaryLabel:b.SecondaryLabel,actionText:b.ActionText,description:b.Description,iconSet:b.iconSet,links:b.Links,actionId:b.ActionId,commandId:b.CommandId,actionCommandId:b.ActionCommandId||b.ActionId,commandValueId:b.CommandValueId,actionCommandValueId:b.ActionCommandValueId||b.CommandValueId})))}DCn(b,k,t,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&k.push(appChrome.actions.setControlLabel(b.ExternalId,
b.LabelText)),this.aAd()&&((t=this.WOa(b))&&0<t.length&&k.push(appChrome.actions.setControlIconSet(b.ExternalId,(new dw.a(t)).iconSet)),w.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&k.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(w.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?t.push(appChrome.api.createToggleButtonModel(b.ExternalId,
b.LabelText,Object.assign(new oD,{iconSet:(new dw.a(this.WOa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):t.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new oD,{iconSet:(new dw.a(this.WOa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel}))),this.Pl.addCommandToMaps(Object.assign(new bw.a(b.ExternalId,
b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}wCn(b,k,t,D){D.push(b.ExternalId);D=this.B6l(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&k.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,D,b.LabelText)):Qg.a("createPersonaButtonModel")&&t.push(appChrome.api.createPersonaButtonModel(b.ExternalId,D,b.LabelText,Object.assign(new oF,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}dCn(b,
k,t,D){D.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&k.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.aAd()&&((t=this.WOa(b))&&0<t.length&&k.push(appChrome.actions.setControlIconSet(b.ExternalId,(new dw.a(t)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&k.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&k.push(appChrome.actions.toggleButton(b.ExternalId,
b.Toggled)));else{D=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const P=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;t.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new xE,{iconSet:(new dw.a(this.WOa(b))).iconSet,keytip:b.KeyTip,hideIcon:D,toggled:P,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));this.Pl.addCommandToMaps(Object.assign(new bw.a(b.ExternalId,b.Command),{queryCommandId:b.QueryCommand,populationProps:new uE.a(b.PopulateQueryCommand,
b.PopulateOnlyOnce)}))}b.Menu&&k.push.apply(k,this.uii(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&k.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}VBn(b,k,t,D){b.McuLayout&&D.push(b.McuExternalId);D.push(b.ExternalId);D=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(D=this.rfk.ogi(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(t.push(appChrome.api.createColorPickerModel(b.McuExternalId,b.Width)),this.Pl.addCommandToMaps(Object.assign(new bw.a(b.McuExternalId,
b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),D=b.Width),t.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.Pl.addCommandToMaps(Object.assign(new bw.a(b.ExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));t=[];const P=[];for(let ca=0;ca<b.Colors.length;ca++){const ta=b.Colors[ca];ca<D?t.push(appChrome.api.colorPickerCell(ta.Color,ta.DisplayColor,ta.Alt)):P.push(appChrome.api.colorPickerCell(ta.Color,
ta.DisplayColor,ta.Alt))}0<t.length&&k.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,t));k.push(appChrome.actions.populateColorPickerCells(b.ExternalId,P));b.SelectedColorId&&(0<t.length&&k.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),k.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,b.SelectedColorId)))}WOa(b){return b.Image32by32Class?this.Pl.U7h(b.Image32by32Class):b.Image16by16Class?this.Pl.U7h(b.Image16by16Class):
b.ExternalImageId}B6l(b){return b?Object.assign(new pD.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new yE.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}hZl(b){let k=2;b&&"inputMethod"in b&&b.inputMethod&&(k=b.inputMethod);return k}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}aAd(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",!1)}static Z6l(b,
k){return appChrome.actions.populateFontPickerDataAsync(new Promise((t,D)=>{Fa.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(P=>{P.isFeatureEnabled(wE.a.BIb,!1).then(ca=>{let ta=k.fonts;ca||P.isFreemiumUpsellEnabled()||(ta=Qm.a.Pog(ta,Na=>Na.fontType!==wE.a.c_f));ca=Object.assign(new jF,{commandId:b.externalUxCommand,fonts:ta,isSubscriber:ca,mruList:k.mruList,initialPinnedFontKeys:k.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});t(ca)}).catch(D)})}))}static X6l(b,
k){const t=[];for(let D=0;D<k.MenuItems.MenuSectionList.length;D++){const P=k.MenuItems.MenuSectionList[D];P.Title&&t.push(appChrome.api.comboBoxHeader("Header-"+D.toString(),P.Title));for(let ca=0;ca<P.ControlList.length;ca++){const ta=Object(Ka.a)(Yh.a,P.ControlList[ca]);ta&&t.push(appChrome.api.comboBoxItem(ta.MenuItemId,ta.LabelText,ta.Styles,ta.CommandValueId,ta.AriaLabel,ta.Data,ta.Disabled))}D<k.MenuItems.MenuSectionList.length-1&&t.push(appChrome.api.comboBoxDivider("Divider-"+D.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,
t)}}Object(n.a)(ND,"ReactPopulateQueryCommandPoller",null,[]);class pF{constructor(b,k,t,D,P){this.Pl=t;this.Qsa=b;this.Uz=k;this.pYb=D;this.Gwb=P}K8l(b,k,t){const D=[];if(this.WFm(k))b=this.Ibm(b,k,t),void 0!==b&&null!==b&&D.push.apply(D,b);else if(b){var P=this.nRd(b,t);ka.a.visible in t&&D.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!t[ka.a.visible]));D.push(cB(b.externalUxCommand,1>(P&1)));void 0!==t[ka.a.labelText]&&null!==t[ka.a.labelText]&&D.push(appChrome.actions.setControlLabel(b.externalUxCommand,
t[ka.a.labelText]));void 0!==k&&null!==k&&(P=cC(b.externalUxCommand,k,t,P),void 0!==P&&null!==P&&D.push.apply(D,P),"PeopleWell"===k&&this.Rsk(b.externalUxCommand,t,D))}return D}RTl(b,k,t){const D=[];switch(k){case "FlyoutAnchorModel":var P=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var ca=appChrome.selectors.getSplitButtonState(b);if(ca=this.Pl.getCommandByExternalUxId(ca.command))t=this.Qsa.k1c(this.Uz,ca.commandId,t),D.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,
!t)),D.push(cB(b,!1));return D;default:return null}k=!1;for(ca in P)if(P=this.Pl.getCommandByExternalUxId(ca),Hf.c(P))k=!0;else if(t.SourceControlId=P.externalUxCommand,this.Qsa.k1c(this.Uz,P.commandId,t))return D.push(cB(b,!1)),D;D.push(cB(b,!k));return D}Ibm(b,k,t){switch(k){case "PreviewGalleryModel":return this.Gwb.u7l(b,t);case "GalleryModel":return this.Gwb.AWl(t)}return null}WFm(b){return"GalleryModel"===b||"PreviewGalleryModel"===b}nRd(b,k){k.MenuItemId=b.menuItemId;return this.Qsa.xpa(this.Uz,
this.pYb,b.commandId,b.queryCommandId,k)}Rsk(b,k,t){const D=k[jk.a.LabelTextUserGeneratedPlaceholderReplacements];k=k[jk.a.LabelText];D&&0<D.length&&(k=String.format.apply(null,[k].concat(D)));t.push(this.Xfm(b,k))}Xfm(b,k){return appChrome.actions.updatePeopleWell(this.KOl(b),k)}KOl(b){const k=[];var t={};b=this.Pl.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.Qsa.xpa(this.Uz,this.pYb,"1285265560",b,t);t=t.MenuItems;if(!t)return k;t=t.MenuSectionList[0];for(b=0;b<t.ControlList.length;b++){const D=
t.ControlList[b],P={};P.name=D.Alt;P.id=D.MenuItemId;P.description=D.Description;P.color=D.ImageBackColor;P.joinTime=D.JoinTimeInMS;P.imageUrl=D.ImageUrl;P.activeStatus=D.ActiveStatus;P.isAnonymous=D.IsAnonymous;P.canJump=D.CanJump;P.upn=D.Upn;k.push(P)}return k}}Object(n.a)(pF,"ReactQueryCommandPoller",null,[]);var qF=c(1115);class dC{constructor(b,k,t){this.Pl=b;this.Uz=k;b=new qF.a;this.Ijk=new AE;this.Gwb=new LD(b,this.Uz,t,this.Pl);this.zbh=new ND(b,this.Uz,t,this.Pl,this.Gwb);this.obh=new pF(b,
this.Uz,this.Pl,t,this.Gwb)}wEa(){const b=[];if(!Qg.c())return b;b.push.apply(b,this.Vfm());var k=this.TSl();if(0<k.length)b.push.apply(b,k);else if(k=appChrome.selectors.getActiveControlIds(),Object.keys(k).length){const t=this.USl();for(const D of t)b.push(appChrome.actions.updateControlEnabledDisabledState(D,!0)),delete k[D];b.push.apply(b,this.HSd(k))}return b}l1c(b,k){Qg.c()&&(b=this.HSd(b,k),appChrome.api.dispatch(b))}zZf(b,k,t=null){if(!Hf.c(b)&&b.populationProps&&!this.zbh.Bsj(b)){b=this.zbh.L8l(b,
k,t);if(!b.rJj){let D;(D=b.actions).push.apply(D,this.HSd(b.xFh,Qg.g(t)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}HSd(b,k=0){const t=[],D={};if(Qg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var P of appChrome.selectors.getActiveGroupIds())for(var ca of appChrome.selectors.getVisibleControlsInGroup(P))D[ca]=!0;for(let ta in b)P=ta,ca=b[ta],
0===k&&D[P]&&(k=2),t.push.apply(t,this.Ufm(P,ca,k));return t}Ufm(b,k,t=0){const D=[],P=this.Pl.getCommandByExternalUxId(b);let ca={};appChrome.selectors.isControlDefined(b)&&(ca=this.Ijk.ogi(b,k));ca[Dx.a.D7a]=t;Hf.c(P)?(ca.ExternalUxId=b,(b=this.obh.RTl(b,k,ca))&&0<b.length&&D.push.apply(D,b)):(ca.MenuItemId=P.menuItemId,ca.SourceControlId=b);D.push.apply(D,this.obh.K8l(P,k,ca));return D}Vfm(){const b=[],k=!!w.AFrameworkApplication.K&&(w.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),t=appChrome.selectors.getContextualTabIds();let D=[];k&&(D=appChrome.selectors.getActiveContextualTabIds());for(let ca=0;ca<t.length;ca++){var P=this.Pl.luf(t[ca]);if(P){P=this.Uz.AFa(P);let ta=!0;k&&(ta=0<=Array.indexOf(D,t[ca]));k&&ta===P||b.push(appChrome.actions.activateDeactivateContextualTab(t[ca],P))}}return b}TSl(){var b=appChrome.selectors.getSelectedTabId();const k=[],t=this.Pl.luf(b);
t&&(this.Uz.AFa(t)||k.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return k}USl(){var b=appChrome.selectors.getActiveGroupIds();const k=[];for(const t of b)if(b=this.Pl.SWl(t))for(const D of b)this.Uz.AFa(D.commandId)||((b=D.externalUxCommandIds)||(b=appChrome.selectors.getVisibleControlsInGroup(D.externalUxGroupId)),k.push.apply(k,b));return k}}Object(n.a)(dC,"ReactRibbonRootPoller",null,[877]);class OD{constructor(b,k,t=null){this.Uz=this.NAa=this.Sbb=null;this.WXb=
k;b.MMa(this);this.zF=t}get Koa(){this.NAa||(this.NAa=new Date,this.NAa.setTime(0));return this.NAa}set Koa(b){this.NAa=b}get y9(){return 2}get zF(){return this.Uz}set zF(b){this.Uz=b}get Ggc(){this.Sbb||(this.Sbb=new dC(this.WXb,this.zF,this.y9));return this.Sbb}Ieb(){const b=document.activeElement;fc.a.isEditable(b)&&b.blur()}executeCommand(b,k,t,D,P,ca,ta,Na=2){Hf.c(this.zF)||(P=new xs.a,P.CommandLocation=Na,P.InvocationMethod=D,P.CommandTabName=t,k[Dx.a.D7a]=Na,this.zF.kOa(b,k,P,ca,ta),this.a0m(b,
k))}wEa(){return Hf.c(this.zF)?[]:this.Ggc.wEa()}xm(){const b=this.wEa();0<b.length&&(this.Koa=new Date,appChrome.api.dispatch(b))}Jad(){Qg.c()&&this.Ggc.l1c({PeopleWell:"PeopleWell"},18)}Aad(){}a0m(b,k){try{const t=Fa.a.instance.Na("Common.ISystemInitiatedFeedback");if(t&&k){const D=k.SourceControlId||k.launcherId||k.LegacyId||k.NewContextId;let P=(D?"_"+D:"")+(k.SqmControlId?"_"+k.SqmControlId:"");P=P.length?P:"_"+b;t.ZJf("Ribbon"+P)}}catch(t){v.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+
(t?t.toString():""))}}}Object(n.a)(OD,"ReactRibbonRoot",null,[708,876]);var qD=c(1610);class rF{constructor(b){this.SWe=this.hCe=!1;this.C9a=null;this.qNg=!1;this.EP=null;this.lsa=!1;this.COe=b;Kf.a.instance.lb(Rc.a.Kx,this.vNc(),Object(A.a)(this,this.Rkn,"onContextualUIMouseDown"));(b=Fa.a.instance.Sa("Common.IActionContextProvider"))&&b.execute(k=>{this.EP=k});w.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&w.AFrameworkApplication.ta.Nb.oJ?Tj.a.get_instance().Dk(16,
()=>{this.m4?this.initializeContextualUI(this.vNc()):Tj.a.get_instance().Dk(7,()=>{this.initializeContextualUI(this.vNc())})}):Tj.a.get_instance().Dk(7,()=>{this.initializeContextualUI(this.vNc())})}get W_(){return this.lsa}get m4(){return w.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&w.AFrameworkApplication.ta.Nb.oJ?Tj.a.get_instance().isCompleted(16)&&Tj.a.get_instance().isCompleted(7):Tj.a.get_instance().isCompleted(7)}pRk(){if(this.qNg)return!0;try{return Promise.resolve(null),
this.qNg=!0}catch(b){return!1}}elg(b){if(!this.m4||this.SWe)return this.WKf("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.pRk())return this.WKf("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(w.AFrameworkApplication.HD)return this.WKf("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.SWe=!0;let k=$a.a.Hg;switch(b){case 1:k=$a.a.showContextMenu;break;case 0:k=$a.a.showFloatie;break;case 2:k=
$a.a.xjc}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.SWe=!1;bf.c(k)},0)});return!1}Pii(b){return bk.UISurfaces.L0a().then(k=>{if(appChrome.api.isSmallDevice()&&k.getBlockedSmallScreenFloatieGroupList){k=k.getBlockedSmallScreenFloatieGroupList();const t=[];for(const D of b)Array.contains(k,D)||t.push(D);return t}return b})}showFloatie(b,k,t,D=null){this.elg(0)||this.Pii(k).then(P=>{if(0>=P.length)return null;this.lcg(P).then(()=>{const ca={};ca.target=b;bk.UISurfaces.L0a().then(ta=>
{appChrome.api.dispatch(ta.showFloatie(ca,t,void 0,this.Brf(),D));this.lsa=!0;w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&w.AFrameworkApplication.va&&w.AFrameworkApplication.va.processAction($a.a.nIi,2);return null})});return null})}showContextMenu(b,k,t=null,D=null){this.elg(1)||this.zqj(b,k,t,D)}zqj(b,k,t=null,D=null){this.lcg(null).then(()=>{const P={};P.target=b;D&&(P.directionalHint=D);bk.UISurfaces.L0a().then(ca=>{appChrome.api.dispatch(ca.showContextMenu(P,
k,t,void 0,this.Brf()));return null})})}wjc(b,k,t,D=null){this.elg(2)||this.Pii(k).then(P=>{0>=P.length?this.zqj(b,t,D):this.lcg(P).then(()=>{const ca={};ca.target=b;const ta={};ta.target=b;bk.UISurfaces.L0a().then(Na=>{appChrome.api.dispatch(Na.showContextualUI(ca,ta,t,void 0,D,this.Brf()));this.lsa=!0;return null})});return null})}WKf(b){v.ULS.sendTraceTag(561394519,340,15,b)}vJc(){this.m4&&bk.UISurfaces.isLoaded()&&bk.UISurfaces.L0a().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}Tw(){this.m4&&
bk.UISurfaces.isLoaded()&&bk.UISurfaces.L0a().then(b=>{this.lsa=!1;appChrome.api.dispatch(b.hideFloatie());return null})}D4b(){this.m4&&bk.UISurfaces.isLoaded()&&bk.UISurfaces.L0a().then(b=>{appChrome.api.dispatch(b.hideContextualUI());this.lsa=!1;return null})}initializeContextualUI(b){return bk.UISurfaces.L0a().then(k=>{this.hCe||(k.initializeContextualUI(b),this.hCe=!0);return null})}lcg(b){if(!this.hCe)return this.initializeContextualUI(this.vNc()).then(()=>{this.setActiveFloatieGroups(b);return null});
this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var k=[];k.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(k);var t=[];bk.UISurfaces.L0a().then(D=>{t.push.apply(t,this.COe.Ggc.HSd(D.selectors.getFloatieOnlyControlsMap(),9));0<t.length&&appChrome.api.dispatch(t);return null})}}vNc(){if(this.C9a)return this.C9a;this.C9a=qD.a("div");this.C9a.id="ReactContextualUIDiv";this.C9a.style.position="absolute";this.C9a.style.zIndex=
"1001";document.body.insertBefore(this.C9a,document.body.firstChild);return this.C9a}Rkn(b){b.Gb&&b.Gb.target&&"input"===b.Gb.target.tagName.toLowerCase()&&ad.FocusManager.instance().cD("ribbon");return!1}Brf(){return this.EP?this.EP.contentType:"Unknown"}}Object(n.a)(rF,"ReactContextualUILauncher",null,[878]);class BE extends Ht.a{constructor(){super()}}Object(n.a)(BE,"FloatieBuildOptions",Ht.a,[]);class Yv extends oy.a{constructor(){super()}}Object(n.a)(Yv,"FloatieBuildContext",oy.a,[]);var Iw=
c(646);class PH extends og.Builder{constructor(b,k,t){super(b,k,t,null);if(Hf.c(k))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get floatie(){return this.root}Umo(b){this.root=b}aMk(){const b=new Yv,k=new LB.a;k.P2c=1;k.handler=Object(A.a)(this,this.drn,"onReturnFloatieData");k.data=b;this.Hua.Hee(k)}drn(b){this.bMk(b.k2c,b.mHc);this.floatie.Q_h=this;this.floatie.ym();this.floatie.Oc.style.display="none";this.placeholder.appendChild(this.floatie.Oc);this.Tta.continueWith(()=>
{this.Tta.result.bKb(this.floatie)},11);Sh.a.instance.lb(Rc.a.pointerDown,this.floatie.Oc,Object(A.a)(this.floatie,this.floatie.ZC,"onPointerDown"))}bMk(b,k){b=Zi.a.Aga(b,Zi.a.yNj);if(Hf.c(b))throw Error.create("No floatie element was present in the data");b=new Zi.a(b);this.Umo(new rq(b.attributes[Zi.a.id],b.attributes));b=Zi.a.Aga(b.node,Zi.a.Ope);this.o4e(b,k)}o4e(b,k){b=Zi.a.iw(b);for(let t=0;t<b.length;t++){if(this.iQa(b[t]))continue;const D=this.t4e(b[t],k);this.floatie.Hf(D)}}t4e(b,k){var t=
new Zi.a(b);b=new Iw.Group(this.floatie,t.attributes[Zi.a.id],t.attributes[Zi.a.FUa],t.attributes[Zi.a.rnc],t.attributes[Zi.a.AUa],!1,t.name===Zi.a.vRj,!1,t.attributes);t=Zi.a.iw(t.node);for(let D=0;D<t.length;D++)b.Hf(this.XBd(t[D],k));return b}XBd(b,k){b=new Zi.a(b);var t=b.attributes[Zi.a.id];b=Zi.a.iw(b.node);var D=2;2===b.length&&(D=3);t=new cn.a(this.floatie,t,D,2,1);for(D=0;D<b.length;D++){const ca=new Zi.a(b[D]);var P=Zi.a.Aga(ca.node,Zi.a.Hqb);P=Zi.a.iw(P);this.z4e(t.HRd(D+1),P,ca.attributes[Zi.a.id],
k)}return t}z4e(b,k,t,D){for(t=0;t<k.length;t++){if(this.iQa(k[t]))continue;const P=new Zi.a(k[t]),ca=this.mfa(k[t],D);ca&&b.Hf(ca.uQ(P.attributes[Zi.a.snc]))}}}Object(n.a)(PH,"FloatieBuilder",og.Builder,[]);class sF{constructor(b,k){this.rv=null;this.F_k=b;this.zwe=k;this.lmn=this.B6d.bind(this)}get floatie(){return this.rv}Keb(b,k,t){k=new ln.CuiHelper(Nh.a.oZa,Box4Intl.Box4Strings,null,null,k);const D=new BE;D.TG=t||{};D.TG.floatieshadingColor=!1;const P=new PH(D,document.body,this.F_k.sej);P.Hua=
new Fw.a(b,k);P.aMk();this.zwe.execute(ca=>{P.floatie.zF=ca});P.floatie.HUn(this.lmn);P.floatie.VTn(()=>[]);this.rv=P.floatie;return this.floatie}}Object(n.a)(sF,"AFloatieInitializer",null,[]);class QH extends sF{constructor(b,k,t,D){super(k,t);this.sZf=()=>{this.floatie.xm()};this.Jh=b;this.qI=D}Keb(b,k,t){if(b=super.Keb(b,k,t))b.agc=!0,b.O$d=!0,b.preventDismissOnScroll=!0;this.Jh.UYa(this.sZf);return b}eSc(b,k,t=null){this.qI.bwh(()=>this.Keb(b,k,t))}B6d(){this.floatie.agc=!0}}Object(n.a)(QH,"PasteFloatieInitializer",
sF,[]);var RH=c(806);class Vz{Eya(b,k){this.RRk&&this.qto(b,k,Vz.FMf,Vz.kb)}qto(b,k,t,D){switch(t){case 1:case 6:case 2:case 3:case 4:Vz.pgf.show(D,b,k)}}OMi(){switch(Vz.FMf){case 5:case 1:return!0;default:return!1}}Zel(){return Vz.FMf}get RRk(){return 1!==Wa.App.ya.state}static get pgf(){return null!=Vz.Qxg?Vz.Qxg:Vz.Qxg=Fa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static i1l(b){if(!b)return 0;if(2===Wa.App.ya.mode){const k=b.Qa.node,t=ze.GraphIterator.$a(k);t.Dp();return om.e(t.currentNode)?
2:w.AFrameworkApplication.zmc||!Zx.isEmbeddedFileNode(k)||Zx.isInvalid(k)?Pk.a.fKm(b.Qa)||Pk.a.fDf(b.Qa)?6:1:3}return 4}static get kb(){return af.a.instance.hb.kb}static get FMf(){return Vz.i1l(Vz.kb)}}Object(n.a)(Vz,"SelectionContextMenuProvider",null,[1191]);var QF=c(1824);class RF{constructor(b,k){this.O$d=this.agc=!1;this.FQc=!0;this.EL=b;this.Pl=k}get isVisible(){return this.EL.W_}get controls(){return null}Tw(){this.EL.Tw();return!0}zhf(){}H6a(b,k,t,D,P=null){this.EL.showFloatie(Object.assign(new QF.a,
{x:b.x,y:b.y}),this.Imf(t),t,P)}WDb(){return new Sys.UI.Bounds(0,0,0,0)}x3(){return this.Tw()}Imf(){return[]}}Object(n.a)(RF,"ReactFloatie",null,[401,402]);class SH{constructor(b){this.wgd=null;this.EL=b}dispose(){}x3(){this.EL.D4b();return!0}showContextMenu(b,k){this.Job(b,k.clientPoint,k.jg)}Job(b,k,t){this.F6a(b,new Sys.UI.Bounds(k.x,k.y,0,0),t);v.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",b)}F6a(b,k,t,D=null){this.wgd?this.EL.wjc(Object.assign(new QF.a,{x:k.x,y:k.y}),
this.wgd.Imf(t),t,b):this.EL.showContextMenu(Object.assign(new QF.a,{x:k.x,y:k.y}),t,b,D);this.wgd=null}xjc(b,k,t,D){this.wgd=Object(Ka.a)(RF,t);D.Eya(b,k);return!0}q3b(){}}Object(n.a)(SH,"ReactContextMenuController",null,[471,9]);var ZL=c(459);class TH{constructor(){this.Eia=this.text=this.foa=null}}Object(n.a)(TH,"BusinessBarButtonData",null,[]);class HG{constructor(){this.text=this.foa=null}}Object(n.a)(HG,"BusinessBarLinkData",null,[]);var UH=c(195);class IG{constructor(b,k,t,D){this.yUg=this.PRg=
this.e$a=this.RPg=null;this.gt=b;this.Mza=k;this.ga=t;this.Ma=D}TYf(){this.n2b();this.NFc();this.o2b()}NFc(){}n2b(){const b=Wa.App.ya.gb.Uc;b&&(this.RPg=this.T7a(this.RPg,1,2===Wa.App.ya.mode&&b.eCf,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}lTm(){return w.AFrameworkApplication.ta&&1===w.AFrameworkApplication.ta.mode}o2b(){let b=null;const k=Wa.App.ya.gb.activeSection;if(k){const t=k.g0c;UH.a.wXd(t)?22===t?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===t||20===t?b=aa.a.ti?
Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===t?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===t?b=aa.a.ti?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===t&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):UH.a.Ami(k.HYa)||Wa.App.um||this.lTm()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.yUg=this.T7a(this.yUg,5,!!b,b)}Sqj(b,k,t,D){b=this.Mza.create(null,
b,null);b.closeable=!0;b.id=23;b.image=3;b.azd(k,()=>{$d.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+t)});D&&(b.fma=D);this.gt.aA(b,!0)}duo(b,k,t){this.Sqj(b,k,t,null)}puo(b){b=this.Mza.create(null,b,null);b.closeable=!0;b.id=20;this.gt.aA(b)}Ato(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,k=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.e$a||(this.e$a=this.Mza.create(b,k,null),this.e$a.closeable=!0,this.e$a.id=27,this.gt.aA(this.e$a))}Dqm(){this.e$a&&
(this.e$a=this.T7a(this.e$a,27,!1,""))}Udg(b){this.PRg=this.T7a(this.PRg,30,!0,b)}T7a(b,k,t,D,P=!1,ca="",ta=null,Na=null,qb=null){t?b?b.message=D:(b=this.Mza.create(ca,D,null),b.id=k,b.closeable=P,ta&&b.addButton(ta.text,ta.foa,ta.Eia),Na&&b.azd(Na.text,Na.foa),qb&&(b.fma=qb),this.gt.aA(b,!1)):b&&(this.gt.removeEntry(b),b=null);return b}oYe(b){this.gt.aA(b,void 0)}}Object(n.a)(IG,"BusinessBarController",null,[226]);class QD extends IG{constructor(b,k,t,D){super(b,k,t,D);this.rsa=null}Vqf(b,k,t=null,
D=null,P=null,ca=2){if(this.rsa)return null;this.rsa=this.Mza.create(k,t||"",null);this.rsa.id=6;this.rsa.image=ca;this.rsa.oZd=!1;b&&(this.rsa.errorCode=b);this.rsa.closeable=!1;k=w.AFrameworkApplication.CF&&this.Ma.$("ShowFeedbackButtonOnKickoutBusinessBar");D?(this.rsa.addButton(D,P,""),k&&this.rsa.Ioh(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.zji(b)})):k&&this.rsa.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.zji(b)},"");this.gt.aA(this.rsa,void 0,null,null,null);return this.rsa}zji(b){v.ULS.sendTraceTag(36471966,
338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Qb($a.a.giveFeedback,2,{["ErrorCode"]:b})}static get lf(){return Yg.PageReader.instance}}Object(n.a)(QD,"BusinessBarController",IG,[225,226]);class JG{static get cRi(){const b=F.a.Nj(Xj.a.og(w.AFrameworkApplication.lcid).name);return String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}}Object(n.a)(JG,"OdtUtils",null,[]);class VH extends QD{constructor(b,k,t,D){super(b,k,t,D);this.Erb=this.wtc=
this.B5g=this.EMa=this.H5g=this.cgh=null;this.N9j="https://go.microsoft.com/fwlink/?linkid=2134357"}TYf(){super.TYf();this.bVk()}NFc(){const b=Wa.App.ya.gb.Uc;if(b){var k=Wa.App.$_;if(Wa.App.es||Wa.App.um||k&&w.AFrameworkApplication.jv)this.cgh=this.T7a(this.cgh,4,QD.lf.DVc(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.H5g=this.T7a(this.H5g,3,QD.lf.Jac(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,!0),this.B5g=this.T7a(this.B5g,8,QD.lf.A3k(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,
!0),QD.lf.rWc(b)?this.EMa||(this.EMa=this.Mza.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.EMa.id=14,this.EMa.closeable=!0,this.EMa.image=3,this.EMa.addButton(Box4Intl.Box4Strings.L_LearnMore,wg.AppFrame.iXm,""),this.gt.aA(this.EMa,!1)):this.EMa&&(this.gt.removeEntry(this.EMa),this.EMa=null)}}bVk(){if(Yl.App.LUc){const b=JG.cRi,k=this.Mza.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,
null);k.id=9;k.closeable=!0;k.Zrk(b);this.gt.aA(k,!0)}}euo(b,k){if(Wa.App.ya.gb.Uc){const t=new TH;t.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;t.foa=()=>{b()};const D=new HG;D.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;D.foa=()=>{$d.a.openWindow(4,w.AFrameworkApplication.privacyUrl)};this.wtc=this.T7a(this.wtc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,
t,D,()=>{k()})}}Lqm(){this.wtc&&(this.wtc=this.T7a(this.wtc,25,!1,""))}ito(){if(Wa.App.ya.gb.Uc){const b=new HG;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.foa=()=>{$d.a.openWindow(4,this.N9j)};this.Erb||(this.Erb=this.Mza.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.Erb.id=32,this.Erb.closeable=!0,this.Erb.image=3,this.Erb.azd(b.text,b.foa),this.gt.aA(this.Erb,!1))}}ZX(b){return this.gt.ZX(b)}aA(b,
k){this.gt.aA(b,k)}}Object(n.a)(VH,"BusinessBarController",QD,[564,225,226]);class WH{constructor(){this.menuTargetType=null}}Object(n.a)(WH,"MenuTargetDescriptor",null,[]);var Wz=c(569);class ek extends Wz.a{constructor(b,k,t,D=!1,P,ca=null,ta){super();this.l$d=(Na,qb,Jb,Vb,ac)=>{if(1===Jb)return 32;Na=ac.Gx;ac=ac.vd;qb=Object.assign(new be.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.eal(qb,Na,ac.IsShadowMenuOpen);ac.MenuItems=qb;return 32};this.WHn=k;this.qn=t;this.tcb=
ca;this.JFe=D;this.Tb(b);this.Z8a=ta;ek.VXa[1]=Pb.a.ije;ek.VXa[2]=Pb.a.aTd;ek.VXa[3]=Pb.a.Mje}get Tql(){return Yn.a.AHd}get Sql(){return Yn.a.VFd}get Uql(){return Yn.a.F9d}get ngf(){return Yn.a.t_i}Tb(b){b.fb(Pb.a.CZf,lc.a.application,this.l$d,96);b.fb(Pb.a.V0i,lc.a.application,this.l$d,96)}show(b,k,t){let D=null,P=new Sys.UI.Bounds(0,0,0,0);const ca=this.Z7l(b);if(ca&&(b=b.Qa.node)&&(b=b.De(Lb.InteractiveViewManager.instance.Bd.ic))){P=Wx.a.Pq(b,ca.end);if(w.AFrameworkApplication.isRtl&&P.x>k.x||
!w.AFrameworkApplication.isRtl&&P.x+P.width<k.x||P.y+P.height<k.y)P=Wx.a.Pq(b,ca.end-1);k.x=P.x+(w.AFrameworkApplication.isRtl?0:P.width);k.y=P.y+P.height;D=6}Wz.a.F6a("ContextMenu",new Sys.UI.Bounds(k.x,k.y,P.width,P.height),t,D)}I_(b,k){return this.p8c(b)||ek.MFc(Pb.a.mergeCells)||ek.MFc(Pb.a.OHa)||this.Feg(b)||this.uqj(b,k)||ek.irj()||ek.Xqj(b).returnValue}p8c(b){return 2===Wa.App.ya.mode&&this.CUc(b)}jIc(b,k,t=null){if(an.zB()&&2===Wa.App.ya.mode){k=this.Z8a.BIh(b.Qa);if(!k||!this.vPm()&&!this.PQm(k.errorDetails))return;
k=k.errorDetails}else{if(!this.p8c(b))return;k=this.Zdi(b)}var D=Xj.a.og(k.lcid);const P=D?D.name:"UNKNOWN";D=Object(ob.a)(Fo.a,k)?k.typeId:"";v.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",k.errorType,k.proofingType,D,P);if(b=this.WHn.H3b(b,k))t.push.apply(t,b),this.w5m(k,D)}PQm(b){return b&&(1===b.proofingType||2===b.proofingType)}vPm(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",
!1)}w5m(b,k){const t=ek.VXa[b.proofingType];t&&(w.AFrameworkApplication.va.processAction(t,2),v.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",t,k,b.proofingType,an.zB()))}Zdi(b){return this.qn.ona(b.Qa).errorDetails}CUc(b){return this.qn.lfe(b)}k7b(){return null}uGd(){}Z7l(b){return this.CUc(b)?this.qn.ona(b.Qa):(b=this.k7b(b))?new cc.a(b.Jp,b.cpEnd):null}Feg(b){if(2!==Wa.App.ya.mode||!b)return!1;b=Ry.a.iDa(b.toArray());
return!!ek.Wg.jT(b,14)}Lrj(b,k){return 2===k||3===k&&!this.CUc(b)}uqj(b,k){return 3!==k||this.CUc(b)}W7k(){const b=[];b.push(Object.assign(new zg.a,{ExternalId:this.Tql}));b.push(Object.assign(new zg.a,{ExternalId:this.Sql}));b.push(Object.assign(new zg.a,{ExternalId:this.Uql}));return b}kbl(){const b=[];this.JFe&&b.push(Object.assign(new zg.a,{ExternalId:this.ngf}));return b}static get Gd(){return null!=ek.DDg?ek.DDg:ek.DDg=Fa.a.instance.resolve("Box4.List.IListReader")}static get Wg(){return li.ContextSetEditor.instance}static get eKm(){null==
ek.fFe&&(ek.fFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return ek.fFe}static get eZc(){null==ek.Rqb&&(ek.Rqb=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return ek.Rqb}static get yta(){null==ek.b$&&(ek.b$=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return ek.b$}static MFc(b){return 32===w.AFrameworkApplication.va.processAction(b,
1)}static irj(){return 2===Wa.App.ya.mode&&!!Wa.App.Zv.KI&&Wa.App.Zv.KI.sVc(Pb.a.u8d.toString())}static krj(b){if(1!==b.length||!b.Qa.al)return!1;b=ze.GraphIterator.$a(b.Qa.node);b.zb(11);b.uc();return b.Nr(4)&&!ek.Gd.hw(b).listType?!0:!1}static Xqj(b){let k=!1,t=!1;if(!b)return{returnValue:!1,mib:k,nRc:t};if(ek.eZc)return ek.ouo(b,t);if(!(b.hy||ek.eKm&&2===b.length&&b.Qc.contextId===lc.a.endOfParagraph))return{returnValue:!1,mib:k,nRc:t};b=b.Qa.clone();k=32===w.AFrameworkApplication.va.Nf(b,Pb.a.F4a,
1,!0,null,null);t=32===w.AFrameworkApplication.va.Nf(b,Pb.a.insertHyperlink,1,!0,null,null);return{returnValue:k||t,mib:k,nRc:t}}static ouo(b,k){let t;k=b.Qa.clone();t=ek.yta&&Oi.l(k);let D=!t&&32===w.AFrameworkApplication.va.Nf(k,Pb.a.F4a,1,!0,null,null);if(b.hy||2===b.length&&b.Qc.contextId===lc.a.endOfParagraph)k=!t&&32===w.AFrameworkApplication.va.Nf(k,Pb.a.insertHyperlink,1,!0,null,null);else{k=!0;const P=b.length;for(let ca=0;ca<P;ca++){const ta=b.J(ca).clone();if(ta.contextId===lc.a.paragraph||
ta.contextId===lc.a.Hd)(t=ek.yta&&Oi.l(ta))||(k=32===w.AFrameworkApplication.va.Nf(ta,Pb.a.insertHyperlink,1,!0,null,null)&&k);else if(ta.contextId!==lc.a.endOfParagraph)return k=D=!1,{returnValue:!1,mib:D,nRc:k}}}return{returnValue:D||k,mib:D,nRc:k}}static wQd(b){const k=Object.assign(new fh.a,{ControlList:[]});for(const t of b)k.ControlList.push(Object.assign(new zg.a,{ExternalId:t}));return k}static sG(b){const k=[];for(const t of b)k.push(Object.assign(new zg.a,{ExternalId:t}));return k}}ek.fFe=
null;ek.Rqb=null;ek.b$=null;ek.VXa=[];Object(n.a)(ek,"AEditSurfaceContextMenu",Wz.a,[]);var $L=c(592),aM=c(854),bM=c(1750);class SF{static g7l(b,k,t){k=[];t.BEn.H3b(t.AKl(b),k);return k}static MSl(b,k,t){const D=[];if(t.p8c(b))return D;t.K.$("WordEditorIdeasCardsIsEnabled")&&!aa.a.ut||t.aef.uGd(b,null,k,D);return D}static qbm(b,k,t){const D=[];t.jIc(b,k,D);return D}}Object(n.a)(SF,"ContextMenuSectionHelper",null,[]);class Rq{static zSl(b,k,t){k=[];t.vkl(b)&&k.push(Object.assign(new zg.a,{ExternalId:"ReviewDesignerSuggestion",
LabelText:t.t9l(b)}));return k}static r1l(){return ek.MFc(Pb.a.mergeCells)?ek.sG(["MergeCells"]):ek.MFc(Pb.a.nje)?ek.sG(["SplitCells"]):[]}static Yem(b,k,t){k=[];if(!t.Ch.sHh(b))return k;b=t.Ch.dii(b);k.push(Object.assign(new zg.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));k.push(Object.assign(new zg.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,
WordEditorIntl.WordEditorStrings.L_RejectChange,b)}));return k}static zNl(b,k,t){return w.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&b&&b.Qa&&b.Qa.node&&t.Ic&&t.Ic.eQi(b.Qa.node)?ek.sG(["ShowCatchUpActivitiesForParagraph"]):[]}static sTl(b){return Wo.Eto(b)?ek.sG(["Draw"]):Wo.arj(b)?ek.sG(["EditIllustration"]):[]}static Thm(b){return Wo.awo(b)?[Object.assign(new jj.a,{ExternalId:"WrapTextMenu"})]:[]}static xRd(b,k,t){return t.Mkl(b)?ek.sG(["CreatePullQuote"]):[]}static getContentControls(b,
k,t){return t.ukl()?ek.sG(["RemoveContentControl"]):[]}static iPl(){return ek.sG(["NewComment"])}static TNl(b){const k=[];!Wo.Eeg(b)&&Wo.geg(b)&&$b.SessionStatusManager.instance.KH&&b.JH&&k.push(Object.assign(new jj.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return k}static nZl(b,k,t){k=[];!Wo.Eeg(b)&&Wo.geg(b)&&$b.SessionStatusManager.instance.KH&&(v.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.JH&&!w.AFrameworkApplication.K.$("ChangePicturesIsEnabled")?
k.push(...ek.sG(["ChangePicture"])):k.push(...t.l$k().ControlList),(b=Wo.q$h())&&0<b.length&&(t=t.Ucl(b),null!=t&&k.push(...t.ControlList)));return k}static W7l(){return ek.irj()?ek.sG(["SetProofingLanguage"]):[]}static D9l(b,k,t){return t.uPm&&t.lvo(b)?ek.sG(["Rewrite"]):[]}static T_l(b){return ek.krj(b)?ek.sG(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static L5l(){return Wo.xrj()?ek.sG(["ParagraphOptions"]):[]}static gYl(b){return Wo.arj(b)?ek.sG(["EditIllustration"]):[]}static ibm(b){return Wo.Eeg(b)?
ek.sG(["ShowSmartLookupPane"]):[]}static ifm(b){return Wo.orj(b)?ek.sG(["ModernTranslatorSplitButton"]):[]}static qXl(b,k,t){k=[];if(b.hy){const D=b.Qa;if(D.contextId===lc.a.paragraph||D.contextId===lc.a.Tc||D.contextId===lc.a.Hd){b=b.Qa.node;if(!t.Gk.Wb(b)||b.vr||""===b.characterData)return k;t.zff.wPd(b)&&k.push(...ek.sG(["CreateHeadingLink"]))}}return k}static getBookmark(b,k,t){k=[];if(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.hy){const D=
b.Qa;(hf.SelectionEditor.gf(D)||hf.SelectionEditor.x2a(D))&&t.ZJk.ROd(b.Qa.node,b.Qa.cpBegin)&&(k.push(...ek.sG(["DeleteBookmarkContextMenu"])),w.AFrameworkApplication.ue("bookmarks-edit-ex;bookmarks-edit-ex-cf"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)&&k.push(...ek.sG(["EditBookmarkNameContextMenu"])))}return k}static Dga(b){let k=!1,t=!1;const D=[];({mib:k,nRc:t}=ek.Xqj(b)).returnValue&&(k?t?D.push(...ek.sG(["EditHyperlink","SelectHyperlink",
"OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):D.push(...ek.sG(["OpenHyperlink"])):t&&(w.AFrameworkApplication.K.$("IsO365CommercialHost")||w.AFrameworkApplication.K.$("IsO365ConsumerHost")?D.push(...ek.sG(["InsertLinkFlyout"])):D.push(...ek.sG(["InsertLink"]))));return D}static EOl(b,k,t){const D=[];if(!t.uqj(b,k))return D;2===Wa.App.ya.mode?(D.push(...t.W7k()),D.push(...t.kbl()),3===k&&t.CUc(b)&&D.push(Object.assign(new zg.a,{ExternalId:"Delete"}))):(!w.AFrameworkApplication.protectFile&&
!w.AFrameworkApplication.JG||w.AFrameworkApplication.qCb)&&D.push(Object.assign(new zg.a,{ExternalId:"Copy"}));return D}static Vmf(b,k,t){return t.Feg(b)&&t.Lrj(b,k)?ek.sG(["EditTableAltText"]):[]}static u$h(b,k,t){return t.Fkl(b)?ek.sG(["ShowIntentSuggestion"]):[]}static edm(b,k,t){const D=[];t.Feg(b)&&!t.Lrj(b,k)&&(D.push(Object.assign(new jj.a,{ExternalId:"InsertTableMenu"})),D.push(Object.assign(new jj.a,{ExternalId:"DeleteTableMenu"})),D.push(Object.assign(new jj.a,{ExternalId:"SelectTableMenu"})));
return D}static kdm(b,k,t){return Wo.Xb.isFeatureEnabled(110)&&t.Cvo(b)?ek.sG(["UpdateTableOfContents"]):[]}static cUl(b){return Wo.Kto(b)?ek.sG(["ShowHideEquationToolsPane"]):[]}}Object(n.a)(Rq,"ContextMenuSectionItemHelper",null,[]);class Wo extends ek{get Gk(){return this.eb}get zff(){return this.FVa}constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed,sd,oe,Ld,Od=!1,ie=null,Ce=null,hg,Kg,Hl,wm){super(b,k,t,Od,void 0,ie,hg);this.sId=wm;this.KNe=this.EP=null;this.GXg=!1;this.Zee=new Map;this.eE=
{};this.dlb={};this.ga=b;this.K=D;this.Ch=P;this.gW=Na;this.uI=qb;this.Fm=Jb;this.Rmk=!!ie;this.aef=Vb;this.BEn=ac;this.yRg=sd;this.Zja=oe;this.ZJk=Ld;this.FVa=Hl;this.eb=Kg;ed&&ed.execute(bp=>{this.Xdh=bp});yc&&yc.execute(bp=>{this.KNe=bp});this.Ic=ta;this.Gz=Kc;Ce&&Ce.execute(bp=>{this.EP=bp});this.Nvm();this.ACn();this.gzl();this.zCn()}get ngf(){return this.Rmk?Yn.a.C9d:super.ngf}Hro(){const b=Yl.App.Ln.gb.wc.mb.hb.kb;return this.p8c(b)&&2!==this.Zdi(b).errorType}I_(b,k){return super.I_(b,k)||
Wo.xrj()||ek.krj(b)||Wo.geg(b)||Wo.orj(b)}eal(b,k,t){const D=[];let P=null;try{P=Yl.App.Ln.gb.wc.mb.hb.kb}catch(ca){v.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");return}this.oCn(P,k,D,this.tQl(P));b.MenuSectionList.push(...D);this.xio(b);!t&&this.Xdh&&this.Xdh.rGn(b.MenuTargetDescriptor.menuTargetType,D)}tQl(b){return ek.MFc(Pb.a.mergeCells)?Pw.pug:b.STc?Pw.Tqg:b.JH?Pw.$sg:b.qbc()?Pw.Fqg:Wo.DCf&&b.F2a?Pw.yqg:Pw.arg}m$k(b){b=Wo.A$k(b);return Object.assign(new zg.a,
{ExternalId:"SmartLookupContextMenu",LabelText:b})}Vcl(b){return(b=Wo.xMj(b))?Object.assign(new zg.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}l$k(){const b=Object.assign(new fh.a,{ControlList:[]}),k=Wo.q$h();b.ControlList.push(this.m$k(k));return b}Ucl(b){const k=Object.assign(new fh.a,{ControlList:[]});if(b&&0<b.length){b=this.Vcl(b);if(null==b)return null;k.ControlList.push(b)}return k}Kbc(b){return b.JH||2<b.length||!b.length||2===b.length&&!hf.SelectionEditor.Fk(b.Qc)||1===b.length&&
hf.SelectionEditor.Fk(b.Qc)?!1:this.XGf(b.Qa)}XGf(b){return pe.ParagraphReader.Wb(b.node)?""!==pe.ParagraphReader.text(b.node).trim():!1}Cvo(b){var k=ze.GraphIterator.$a(b.Qa.node);k=Object(Ka.a)($L.a,k.currentNode);return b.JH?!1:!!k&&k.vr}gzl(){w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.Gz.execute(b=>{b.isFeatureEnabled(aM.a.pPi,
!1).then(k=>{k||v.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.GXg=k;return null})}):v.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}get uPm(){w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");return this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.GXg:!1}lvo(b){if(!this.Kbc(b)||
b.F2a||b.qbc())return!1;b=b.Qa;if(pe.ParagraphReader.lm(b)||hf.SelectionEditor.gf(b)||hf.SelectionEditor.ml(b)){b=this.uI.$Oa(b);b||(b=w.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}Fkl(b){if(1!==b.length||aa.a.ut)return!1;const k=w.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled");if(k&&this.Hro()||an.zB()&&!this.Z8a.BIh(b.Qa))return!1;const t=Wo.Xb.isFeatureEnabled(63);
return b.J(0).contextId===lc.a.Tc&&(k||t)&&0<this.Fm.oOc(b.J(0),0).count||k&&this.k7b(b)?!0:!1}vkl(b){return 1===b.length&&this.yRg.pA(b.Qa.node).hha}t9l(b){var k,t;const D=null===(k=this.sId)||void 0===k?void 0:k.dU(null===(t=null===b||void 0===b?void 0:b.Qa)||void 0===t?void 0:t.node);return bM.a.Yhi(D)}get Sw(){return null!=this.Bxg?this.Bxg:this.Bxg=Fa.a.instance.Na("WordEditor.Designer.IDesignerTaskPane")}Mkl(b){if(!this.Zja.nvi()||!this.Sw||this.Sw.isVisible||!(1===b.length||2===b.length&&hf.SelectionEditor.Fk(b.Qc))||
b.lkb||!hf.SelectionEditor.ml(b.Qa)&&b.Qa.contextId!==lc.a.paragraph||b.DAi()||this.yRg.pA(b.Qa.node).hha)return!1;const k=pe.ParagraphReader.text(b.Qa.node),t=b.Qa.contextId===lc.a.paragraph?0:b.Qa.cpBegin,D=b.Qa.contextId===lc.a.paragraph?k.length:b.Qa.cpEnd-t;return 1>D||1500<D||F.a.jf(F.a.gya(k.substr(t,D)))||1!=Aq.a.jhb(b.Qa.node)?!1:!0}ukl(){return 32==this.ga.processAction(Pb.a.N3c,1)}k7b(b){return this.aef.k7b(b)}uGd(b,k,t,D=null){this.p8c(b)||this.aef.uGd(b,k,t,D)}AKl(b){return this.KNe?
this.KNe.BKl(b):[]}xio(b){const k=this.EP?this.EP.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new WH,{menuTargetType:k})}static get Xb(){return null!=Wo.Oyg?Wo.Oyg:Wo.Oyg=Fa.a.instance.resolve("Box4.IFeatureHelper")}static get DCf(){if(null!=Wo.KCg)var b=Wo.KCg;else{var k;b=null===(k=w.AFrameworkApplication.K)||void 0===k?void 0:k.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1);b=Wo.KCg=b}return b}static geg(b){return w.AFrameworkApplication.Q_&&
!b.F2a&&Fa.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").RSm()}static yRd(b){b=b?b.trim():null;let k=20;b&&0<b.length&&(b.length>k&&(k=F.a.mz(b,k)?k-1:k),b=b.length>k?b.substr(0,k).trim()+"...":b);return b}static A$k(b){let k=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(b=Wo.yRd(b))&&0<b.length&&(k=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,b));return k}static xMj(b){b=Wo.yRd(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,
b):null}static q$h(){const b=(new fp.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static arj(b){const k=Wo.Xb.isFeatureEnabled(49);return!b.fHc&&k&&!aa.a.ut&&(b.F2a||k&&!Wo.DCf&&b.JH)}static Eto(b){const k=Wo.Xb.isFeatureEnabled(49);return!b.fHc&&k&&!aa.a.ut&&Wo.DCf&&b.JH}static Eeg(b){return w.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")&&!b.qbc()}static orj(b){return w.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&!b.F2a&&!b.qbc()}static Kto(b){return b.EAi()&&
w.AFrameworkApplication.ta.Nb.kVc}static xrj(){return 2===Yl.App.Ln.mode}static awo(b){return b.JH}oCn(b,k,t,D){this.dlb[D].forEach(P=>{const ca=Object.assign(new fh.a,{ControlList:[]}),ta=ca.ControlList;P.forEach(Na=>{Na instanceof pu?t.push(...this.Zee.get(Na)(b,k,this)):ta.push(...this.eE[Na](b,k,this))});(null===ta||void 0===ta?0:ta.length)&&t.push(ca)})}zCn(){this.Zee.set(pu.sRb,SF.g7l);this.Zee.set(pu.Ipe,SF.MSl);this.Zee.set(pu.vqe,SF.qbm)}ACn(){this.eE[Lh.Iqb]=Rq.EOl;this.eE[Lh.zqe]=Rq.edm;
this.eE[Lh.Aqe]=Rq.kdm;this.eE[Lh.Hpe]=Rq.zSl;this.eE[Lh.aqe]=Rq.r1l;this.eE[Lh.upe]=Rq.Vmf;this.eE[Lh.Upe]=Rq.nZl;this.eE[Lh.Lcd]=Rq.u$h;this.eE[Lh.Tpe]=Rq.gYl;this.eE[Lh.uqe]=Rq.ibm;this.eE[Lh.Cqe]=Rq.ifm;this.eE[Lh.hqe]=Rq.W7l;this.eE[Lh.kqe]=Rq.D9l;this.eE[Lh.Ncd]=Rq.T_l;this.eE[Lh.Qcd]=Rq.L5l;this.eE[Lh.iqe]=Rq.xRd;this.eE[Lh.xcd]=Rq.getContentControls;this.eE[Lh.Wqe]=Rq.Thm;this.eE[Lh.Jpe]=Rq.sTl;this.eE[Lh.Bpe]=Rq.TNl;this.eE[Lh.Bqe]=Rq.Yem;this.eE[Lh.Ape]=Rq.zNl;this.eE[Lh.vcd]=Rq.getBookmark;
this.eE[Lh.Ppe]=Rq.qXl;this.eE[Lh.Rpe]=Rq.Dga;this.eE[Lh.Gqb]=Rq.iPl;this.eE[Lh.Lcd]=Rq.u$h;this.eE[Lh.Kpe]=Rq.cUl}Nvm(){const b=[Lh.aqe,Lh.upe,Lh.zqe];this.dlb[Pw.pug]=[[Lh.Iqb],b,[Lh.Gqb],[pu.sRb],[Lh.xcd]];this.dlb[Pw.$sg]=[[Lh.Iqb],[Lh.Bpe,Lh.Jpe,Lh.Wqe],b,[Lh.Gqb],[pu.sRb]];this.dlb[Pw.Fqg]=[[Lh.Kpe],[Lh.Ncd,Lh.Qcd],[Lh.vcd,Lh.Gqb],[pu.sRb]];this.dlb[Pw.arg]=[[Lh.Lcd],[Lh.Hpe],[pu.vqe],[pu.Ipe],[Lh.Iqb],[Lh.Upe,Lh.Tpe,Lh.uqe,Lh.Cqe],[Lh.hqe,Lh.kqe,Lh.Qcd],[Lh.Ncd],b,[Lh.xcd],[Lh.Rpe,Lh.vcd,Lh.Ppe,
Lh.Gqb],[Lh.iqe],[Lh.Bqe],[Lh.Ape],[Lh.Aqe],[pu.sRb]];this.dlb[Pw.Tqg]=[[Lh.Iqb],[Lh.Gqb]];this.dlb[Pw.yqg]=[[Lh.Iqb],[Lh.Tpe]];this.dlb[Pw.BOj]=[[Lh.Lcd],[Lh.Hpe],[pu.vqe],[pu.Ipe],[Lh.Iqb],[Lh.Bpe],[Lh.Jpe],[Lh.Wqe],[Lh.Upe],[Lh.uqe],[Lh.Cqe],[Lh.hqe],[Lh.kqe],[Lh.Kpe],[Lh.Ncd],[Lh.Qcd],[Lh.Rpe],[Lh.aqe],[Lh.upe],[Lh.zqe],[Lh.vcd],[Lh.Ppe],[Lh.Gqb],[Lh.iqe],[Lh.xcd],[Lh.Bqe],[Lh.Ape],[Lh.Aqe],[pu.sRb]]}}Object(n.a)(Wo,"EditSurfaceContextMenu",ek,[]);var Pw;(function(b){b[b.pug=1]="TABLE_MULTI_CELL";
b[b.arg=2]="GENERIC";b[b.$sg=3]="PICTURE";b[b.Fqg=4]="EQUATION";b[b.BOj=5]="LEGACY";b[b.Tqg=6]="FLUID";b[b.yqg=7]="DRAWING"})(Pw||(Pw={}));Object(n.b)("Scenarios",Pw);class pu{}pu.sRb=new pu;pu.Ipe=new pu;pu.vqe=new pu;Object(n.a)(pu,"Sections",null,[]);var Lh;(function(b){b[b.Lcd=1]="INTENT_SUGGESTION";b[b.Iqb=2]="ESSENTIALS";b[b.Upe=3]="INSIGHT";b[b.Tpe=4]="ILLUSTRATION";b[b.uqe=5]="SMART_LOOKUP";b[b.Cqe=6]="TRANSLATE";b[b.hqe=7]="PROOFING";b[b.kqe=8]="REWRITE_SUGGESTIONS";b[b.Ncd=9]="LISTS";b[b.Qcd=
10]="PARAGRAPH_OPTIONS";b[b.aqe=11]="MERGE_SPLIT_CELLS";b[b.upe=12]="ALT_TEXT";b[b.Rpe=13]="HYPERLINK";b[b.vcd=14]="BOOKMARK";b[b.Ppe=15]="HEADING_LINK";b[b.Gqb=16]="COMMENT";b[b.iqe=17]="PULL_QUOTE";b[b.Wqe=18]="WRAP_TEXT";b[b.Jpe=19]="DRAW";b[b.Bqe=20]="TRACK_CHANGE";b[b.Ape=21]="CATCHUP_ACTIVITIES";b[b.Aqe=22]="TABLE_OF_CONTENTS";b[b.Hpe=23]="DESIGNER_REVIEW";b[b.zqe=24]="TABLE_ITEMS";b[b.Bpe=25]="CHANGE_PICTURE";b[b.Kpe=26]="EQUATION_TOOLS";b[b.xcd=27]="CONTENT_CONTROL"})(Lh||(Lh={}));Object(n.b)("SectionItem",
Lh);class TC extends Wz.a{constructor(b,k,t){super();this.vl=null;this.u$d=(D,P,ca,ta,Na)=>{if(1===ca)return 32;D=[];P=[];this.Iro()&&P.push("InsertTabStopMenuSplitButton");this.sro()&&P.push("ClearAllTabStops");P.push("HideRuler");D.push(TC.wQd(P));P=Object.assign(new be.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});P.MenuSectionList.push(...D);Na.MenuItems=P;return 32};this.ga=b;this.Vm=k;this.Ry=t;this.Tb()}get aab(){return document.getElementById("WACHorizontalRuler")}get uN(){return this.Vm&&
this.Vm.instance?this.Vm.instance.ij:1}get target(){return this.vl}show(b,k){this.vl=b;Wz.a.Job("RulerContextMenu",b,k);v.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",TC.aP);b.set("Response","Ruler Context menu invoked.");xa.Health.instance.recordKpiUsage(TC.kpiName,1,TC.W7,b)}X8l(){var b=0,k=(this.target.x-$d.a.Bnf(this.aab))/this.uN;k=Re.a.Ay(k,0);var t={},D=this.Ry.h6b,P=ze.GraphIterator.$a(D);P.yd();if(!Ih.TableReader.Yw(P))return 32===
this.ga.Qb(Pb.a.NGa,2,t)&&(b=t.marginLeft),k-b;b={};P={};t=this.ga.Qb(Pb.a.L2c,2,b);var ca=this.ga.Qb(Pb.a.bMb,2,P);if(32!==t||32!==ca)return v.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),k;b=b.ColumnWidths;ca=P.TablePosition;if(!ca||!b||0>=b.length)return v.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),k;t=0;P=ze.GraphIterator.$a(D);P.zb(14)&&(P.hd(16),t=Xt.a(P,!0));D=ca.x/this.uN;for(P=0;P<t;P++)D+=b[P];return k-
D}Tb(){this.ga.fb(Nc.a.u$d,lc.a.application,this.u$d,96)}Iro(){var b={},k={},t=this.ga.Qb(Pb.a.NGa,2,b),D=this.ga.Qb(Pb.a.j5a,2,k);if(32===t&&32===D){D=k.tt;t=Re.a.Ni(D.Xna,0);D=1===D.specialIndentType?Re.a.Ni(D.xB,0):Re.a.Ni(D.xB-D.bda,0);const P=Re.a.Ni(b.marginLeft,0);b=Re.a.Ni(b.marginRight,0);const ca=$d.a.Bnf(this.aab),ta=$d.a.n4h(this.aab);k.isRtl?(k=ca+this.uN*Math.max(b,b+t),t=ta-this.uN*Math.max(P,P+D)):(k=ca+this.uN*Math.max(P,P+D),t=ta-this.uN*Math.max(b,b+t));if(this.target.x>=k&&this.target.x<=
t)return!0}return!1}sro(){var b={};if(32!==this.ga.Qb(Nc.a.PLb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static wQd(b){const k=Object.assign(new fh.a,{ControlList:[]});for(const t of b)k.ControlList.push(Object.assign(new zg.a,{ExternalId:t}));return k}}TC.W7="wwaengidc";TC.kpiName="WordRuler";TC.aP="RulerContextMenu";Object(n.a)(TC,"RulerContextMenu",Wz.a,[568]);let gB;class xq{static get sc(){return null!=xq.iJg?xq.iJg:xq.iJg=Fa.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get XG(){return null!=
xq.aJg?xq.aJg:xq.aJg=Fa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get pj(){return null!=xq.TAg?xq.TAg:xq.TAg=Fa.a.instance.resolve("Box4.IInsertionPointFormatting")}static B3i(b,k,t){if(1===k)return(b?xq.HRk(t):xq.gRk(t))?32:8;(b=xq.gcm(b,t))&&xq.SDk(b,t);return 32}static SDk(b,k){const t=new Xd.GraphTransaction(15);t.Cb(k);xq.pj.K5a();xq.XG.HJ(b,k,!1);t.dispose()}static HRk(b){b=xq.sc.Lo(b);return!!b&&xq.sc.kg(b)!==kk.StyleReader.wordStyleIdHeading1}static gRk(b){b=xq.sc.Lo(b);return!!b&&
xq.sc.kg(b)!==kk.StyleReader.l8a}static gcm(b,k){const t=xq.sc.Lo(k);return t?xq.sc.JC(k).Fi(xq.ecm(b,xq.sc.kg(t))):null}static ecm(b,k){k=xq.headingsList.indexOf(k);b=b?k-1:k+1;return 0<=b&&b<xq.headingsList.count?xq.headingsList.J(b):null}}xq.headingsList=(gB=new Eb.a,gB.add(kk.StyleReader.wordStyleIdHeading1),gB.add(kk.StyleReader.wordStyleIdHeading2),gB.add(kk.StyleReader.wordStyleIdHeading3),gB.add(kk.StyleReader.i8a),gB.add(kk.StyleReader.j8a),gB.add(kk.StyleReader.k8a),gB.add(kk.StyleReader.xqb),
gB.add(kk.StyleReader.yqb),gB.add(kk.StyleReader.l8a),gB);Object(n.a)(xq,"NavigationPaneEditor",null,[]);class tF extends Wz.a{constructor(){super();this.s3=null;this.l$d=(b,k,t,D,P)=>{if(1===t)return 32;b=new Sys.StringBuilder;b.append(String.format('<Menu Id="{0}">',"mnuNavPaneWordEditor"));b.append('<MenuSection Id="msWordEditorHeadings" DisplayMode="Menu16"><Controls>');b.append(Wz.a.f2h("promoteHeading",Nc.a.hae,"LeftArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_PromoteHeadingText));b.append(Wz.a.f2h("demoteHeading",
Nc.a.nId,"RightArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_DemoteHeadingText));b.append("</Controls></MenuSection></Menu>");P.PopulationXML=b.toString();return 32};this.hae=(b,k,t)=>xq.B3i(!0,t,this.s3.Bb);this.nId=(b,k,t)=>xq.B3i(!1,t,this.s3.Bb)}show(b){tF.Ah||(this.q3b(),tF.Ah=!0);Wz.a.showContextMenu("mnuNavPaneWordEditor",b)}q3b(){const b={PopulateDynamically:"true",PopulateOnlyOnce:"false"};b.PopulateQueryCommand=""+Nc.a.c1i;b.Command=""+$a.a.Kla;Wz.a.r8k(b);w.AFrameworkApplication.va.qa(Nc.a.c1i,
lc.a.application,this.l$d);w.AFrameworkApplication.va.qa(Nc.a.hae,lc.a.view,this.hae);w.AFrameworkApplication.va.qa(Nc.a.nId,lc.a.view,this.nId)}}tF.Ah=!1;Object(n.a)(tF,"WordEditorNavigationPaneContextMenu",Wz.a,[567]);var Ex=c(279),eC=c(1456),cM=c(448),dM=c(740),TF=c(1184),KG=c(1681),LG=c(995);class UF{constructor(){this.u8=this.gxi=!1;this.LPb=2;this.lw=0;this.q8a=1}}Object(n.a)(UF,"WrapTextPropertiesData",null,[]);class Ql extends TF.a{constructor(b=null){super(b);this.ceh=new KG.a;this.ulh=new UF;
this.Dhh=new LG.a;this.eCe=!1;this.qoi=k=>{const t=new Ex.a;t.QDa=!0;t.ZL=k;return t};this.O0=()=>{const k=new Ex.a;k.BFb=!1;k.ZL=Pb.a.NGa;k.vd=this.ceh;k.dbc=!0;k.lha=!0;return k};this.A4i=()=>{const k=new Ex.a;k.BFb=this.eCe;this.eCe=!0;k.ZL=Pb.a.k5a;k.vd=this.Dhh;k.dbc=!0;k.lha=!0;return k};this.bcd=()=>{const k=new Ex.a;k.BFb=!1;k.ZL=Nc.a.Bgc;k.vd=this.ulh;k.dbc=!0;k.lha=!0;return k};this.CVd=(k,t)=>{const D=new Ex.a;D.vd=new th.DictionaryPropertySet;switch(k){case Nc.a.ERc:D.vd.setValue(vd.a.Hib,
t[Dh.a.Number]);break;case Nc.a.xRc:D.vd.setValue(vd.a.Eib,t[Dh.a.Number]);break;case Nc.a.yRc:D.vd.setValue(vd.a.Fib,t[Dh.a.Number]);break;case Nc.a.zRc:D.vd.setValue(vd.a.Gib,t[Dh.a.Number])}return D};this.tJn=()=>{const k=new Ex.a;k.vd=new th.DictionaryPropertySet;k.lha=!0;return k}}initialize(){super.initialize();this.jd.Z(Nc.a.wIf,eC.a.Rib);this.jd.Z(Nc.a.BIf,eC.a.Rib);this.jd.Z(Nc.a.DIf,eC.a.Rib);this.jd.Z(Nc.a.D1f,Ql.YRa);this.jd.Z(Nc.a.E2c,Ql.YRa);this.jd.Z(Nc.a.w1f,Ql.YRa);this.jd.Z($a.a.eMb,
Ql.YRa);this.jd.Z(Pb.a.Rae,this.O0);this.jd.Z(Pb.a.Qae,this.O0);this.jd.Z(Pb.a.Pae,this.O0);this.jd.Z(Pb.a.Tae,this.O0);this.jd.Z(Pb.a.Sae,this.O0);this.jd.Z(Pb.a.Oae,this.O0);this.jd.Z(Pb.a.$ae,this.O0);this.jd.Z(Pb.a.Zae,this.O0);this.jd.Z(Pb.a.Yae,this.O0);this.jd.Z(Pb.a.Vae,this.O0);this.jd.Z(Pb.a.Wae,this.O0);this.jd.Z(Pb.a.Xae,this.O0);this.jd.Z(Pb.a.Q1f,this.O0);this.jd.Z(Pb.a.P1f,this.O0);this.jd.Z(Pb.a.f1f,this.O0);this.jd.Z(Pb.a.h1f,this.O0);this.jd.Z(Pb.a.g1f,this.O0);this.jd.Z(Pb.a.e1f,
this.O0);this.jd.Z(Pb.a.u6a,Ql.D8m);this.jd.Z(Pb.a.ZSa,Ql.bxn);this.jd.Z(Pb.a.cob,Ql.n_k);this.jd.Z(Pb.a.Rla,Ql.YRa);this.jd.Z(Pb.a.nLb,Ql.YRa);this.jd.Z(Pb.a.bSa,Ql.YRa);this.jd.Z(Pb.a.Hta,Ql.YRa);this.jd.Z(Pb.a.Wxa,Ql.YRa);this.jd.Z(Nc.a.s1c,Ql.YRa);this.jd.Z(Nc.a.MMd,eC.a.clf);this.jd.Z(Nc.a.NMd,this.O2h);this.Nm.Z(Nc.a.q1c,eC.a.TNa);this.Nm.Z(Nc.a.r1c,eC.a.TNa);this.jd.Z(Pb.a.gOb,eC.a.h0a);this.jd.Z(Pb.a.fOb,eC.a.h0a);this.jd.Z(Pb.a.qob,eC.a.h0a);this.jd.Z(Pb.a.b2f,this.uF);this.jd.Z(Pb.a.$1f,
this.uF);this.jd.Z(Pb.a.a2f,this.uF);this.jd.Z(Pb.a.oL,Ql.MHn);this.Nm.Z(Nc.a.Abe,Ql.I3c);this.Nm.Z(Nc.a.Bbe,Ql.I3c);this.Nm.Z(Nc.a.Cbe,Ql.I3c);this.Nm.Z(Nc.a.ybe,Ql.I3c);this.Nm.Z(Nc.a.zbe,Ql.I3c);this.jd.Z(Nc.a.Abe,this.bcd);this.jd.Z(Nc.a.Bbe,this.bcd);this.jd.Z(Nc.a.Cbe,this.bcd);this.jd.Z(Nc.a.ybe,this.bcd);this.jd.Z(Nc.a.zbe,this.bcd);this.jd.Z(Nc.a.gpe,Ql.fnc);this.jd.Z(Nc.a.hpe,Ql.fnc);this.jd.Z(Nc.a.ipe,Ql.fnc);this.jd.Z(Nc.a.jpe,Ql.fnc);this.jd.Z(Nc.a.kpe,Ql.fnc);this.jd.Z(Nc.a.lpe,Ql.fnc);
this.jd.Z(Nc.a.GHa,Ql.y6b);this.jd.Z(Nc.a.Qqj,Ql.y6b);this.jd.Z(Nc.a.Rqj,Ql.y6b);this.jd.Z(Nc.a.iie,Ql.y6b);this.jd.Z(Nc.a.jie,Ql.y6b);this.jd.Z(Nc.a.d8c,Ql.y6b);this.jd.Z(Nc.a.enb,this.tJn);this.jd.Z(Nc.a.p2c,Ql.sNd);this.jd.Z(Nc.a.Hae,Ql.sNd);this.jd.Z(Nc.a.Iae,Ql.sNd);this.jd.Z(Nc.a.Jae,Ql.sNd);this.jd.Z(Nc.a.ERc,this.CVd);this.jd.Z(Nc.a.xRc,this.CVd);this.jd.Z(Nc.a.yRc,this.CVd);this.jd.Z(Nc.a.zRc,this.CVd);this.jd.Z(Pb.a.Pna,this.qoi);this.jd.Z(Pb.a.XBb,this.qoi);this.jd.Z(Nc.a.cnb,Ql.cnb);this.jd.Z(Nc.a.rie,
eC.a.h0a);this.jd.Z(Pb.a.f2f,this.A4i);this.jd.Z(Pb.a.g2f,this.A4i)}clearCache(){super.clearCache();this.eCe=!1;this.ceh=new KG.a;this.ulh=new UF;this.Dhh=new LG.a}Pof(){const b=super.Pof();b.mCa=Ql.mCa;b.eZa=Ql.eZa;return b}static get Cwn(){return null!=Ql.CEg?Ql.CEg:Ql.CEg=Fa.a.instance.Na("WordEditor.IPageCommandStringBuilder")}static get Az(){Ql.cta||(Ql.cta=Fa.a.instance.Na("WordEditor.ITableBorderManager"));return Ql.cta}static YRa(b,k){b=new Ex.a;b.vd=k;return b}static P6c(b,k,t){k[kg.a.Description]=
b?b.A8m(t):null}static mCa(b,k){const t=Object(Ka.a)(KG.a,b.vd),D=Object(Ka.a)(cM.a,b.vd),P=Object(Ka.a)(UF,b.vd),ca=Object(Ka.a)(LG.a,b.vd);let ta=!0;const Na=Ql.Cwn;switch(b.omb){default:ta=TF.a.mCa(b,k);break;case Pb.a.Rae:k[ka.a.Icon]=t.Cwa?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";k[kg.a.On]=!t.jJb;Ql.P6c(Na,k,0);break;case Pb.a.Qae:k[ka.a.Icon]=t.Cwa?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";k[kg.a.On]=1===t.jJb;Ql.P6c(Na,k,1);break;case Pb.a.Pae:k[ka.a.Icon]=
t.Cwa?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";k[kg.a.On]=2===t.jJb;Ql.P6c(Na,k,2);break;case Pb.a.Tae:k[ka.a.Icon]=t.Cwa?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";k[kg.a.On]=3===t.jJb;Ql.P6c(Na,k,3);break;case Pb.a.Sae:k[ka.a.Icon]=t.Cwa?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";k[kg.a.On]=4===t.jJb;Ql.P6c(Na,k,4);break;case Pb.a.Oae:k[ka.a.Icon]=t.Cwa?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";k[kg.a.On]=
5===t.jJb;break;case Pb.a.$ae:k[kg.a.On]=!t.NKb;k[kg.a.Description]=Na?Na.w0c(0):null;break;case Pb.a.Zae:k[kg.a.On]=1===t.NKb;k[kg.a.Description]=Na?Na.w0c(1):null;break;case Pb.a.Yae:k[kg.a.On]=2===t.NKb;k[kg.a.Description]=Na?Na.w0c(2):null;break;case Pb.a.Vae:k[kg.a.On]=3===t.NKb;k[kg.a.Description]=Na?Na.w0c(3):null;break;case Pb.a.Wae:k[kg.a.On]=4===t.NKb;k[kg.a.Description]=Na?Na.w0c(4):null;break;case Pb.a.Xae:k[kg.a.On]=5===t.NKb;break;case Pb.a.Q1f:k[kg.a.On]=!t.Cwa;break;case Pb.a.P1f:k[kg.a.On]=
t.Cwa;break;case Pb.a.f1f:k[kg.a.On]=1===t.BGc;break;case Pb.a.h1f:k[kg.a.On]=2===t.BGc;break;case Pb.a.g1f:k[kg.a.On]=3===t.BGc;break;case Pb.a.e1f:k[kg.a.On]=0===t.BGc;break;case Pb.a.b2f:k[kg.a.On]=D.tt?!D.tt.specialIndentType:!1;break;case Pb.a.$1f:k[kg.a.On]=D.tt?1===D.tt.specialIndentType:!1;k[tn.a.Image16by16Class]=D.isRtl?od.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):od.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case Pb.a.a2f:k[kg.a.On]=D.tt?2===D.tt.specialIndentType:
!1;k[tn.a.Image16by16Class]=D.isRtl?od.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):od.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case Nc.a.Abe:k[kg.a.On]=1===P.q8a;break;case Nc.a.Bbe:k[kg.a.On]=8===P.q8a;break;case Nc.a.Cbe:k[kg.a.On]=9===P.q8a;break;case Nc.a.ybe:k[kg.a.On]=3===P.q8a;break;case Nc.a.zbe:k[kg.a.On]=4===P.q8a;break;case Nc.a.enb:k[kg.a.On]=b.vd.ia(vd.a.ywa,!1);break;case Nc.a.cnb:k[Vl.a.IsFreeForm]=!0;k[Vl.a.Value]=b.vd[Zp.a.Value];break;case Pb.a.f2f:k[Mi.a.On]=
Ql.Az.l4h(k.MenuItemId)===ca.lineStyle;break;case Pb.a.g2f:k[Mi.a.On]=Ql.Az.m4h(k.MenuItemId)===ca.qXc}return ta}static D8m(b,k){b=5;switch(k.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}k=new Ex.a;k.vd=b;return k}static bxn(b,k){b=5;switch(k.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=
2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}k=new Ex.a;k.vd=b;return k}static n_k(b,k){b=0;switch(k.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=3}k=new Ex.a;k.vd=b;return k}static cnb(){const b=new Ex.a;b.ZL=Nc.a.cnb;b.vd={};b.lha=!0;b.dbc=!0;return b}static fnc(b,k){const t=new Ex.a;t.vd=new th.DictionaryPropertySet;let D=1;switch(b){case Nc.a.jpe:D=1;break;case Nc.a.kpe:D=8;break;case Nc.a.lpe:D=9;break;case Nc.a.hpe:D=
3;break;case Nc.a.ipe:D=4}t.vd.setValue(vd.a.q8a,D);t.vd.setValue(vd.a.MHa,k[kg.a.SourceControlId]);return t}static y6b(b,k,t){b=new Ex.a;b.vd=t.InvocationMethod;return b}static MHn(b,k){b=new Ex.a;b.vd=k;return b}static I3c(){const b=new dM.a;b.ZL=Nc.a.Bgc;return b}static sNd(){const b=new Ex.a;b.vd=new th.DictionaryPropertySet;b.iVc=!0;return b}static eZa(b,k){let t=!0;switch(b.omb){case Nc.a.p2c:b=b.vd.ia(vd.a.Hib,0);k[Dh.a.Number]=b;k[Dh.a.UnitType]=7;break;case Nc.a.Hae:b=b.vd.ia(vd.a.Eib,0);
k[Dh.a.Number]=b;k[Dh.a.UnitType]=7;break;case Nc.a.Iae:b=b.vd.ia(vd.a.Fib,0);k[Dh.a.Number]=b;k[Dh.a.UnitType]=7;break;case Nc.a.Jae:b=b.vd.ia(vd.a.Gib,0);k[Dh.a.Number]=b;k[Dh.a.UnitType]=7;break;default:t=TF.a.eZa(b,k)}return t}}Ql.cta=null;Object(n.a)(Ql,"CuiActionBridge",TF.a,[]);class MG extends Wf.a{constructor(b){super();this.I_k=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.uoo=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.vId=this.exb=this.e6=this.PWa=this.xRe=null;this.Ub=
b;this.Xg="<div id='AccessibilityHelpDialogBody'></div>";this.vg="AAccessibilityHelpDialog";this.Ad=6;this.Ee(0,CommonUIStrings.l_DialogClose)}get $df(){return null}get uhe(){this.xRe||(this.xRe=this.$wm());return this.xRe}get nEo(){return 300}get $Ni(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get ZNi(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get u_a(){return this.Ub.Ps()}SSa(b){super.SSa(b);this.ZBn()}iTa(){this.showDialog(this.dialogTitle,Object(A.a)(this,this.tok,
"accHelpDialogResultHandler"));this.UGa();this.setFocus()}setFocus(){this.e6?(this.exb=this.e6.tBodies[0].firstChild,this.R0(this.exb)):this.ZG&&"none"!==this.ZG.style.display?this.R0(this.ZG):this.R0(this.Hz)}Tla(){this.ae.lb(Rc.a.hi,this.vId,Object(A.a)(this,this.Olh,"accHelpDialogKeydownHandler"));if(this.e6){this.ae.lb(Rc.a.vh,this.e6,Object(A.a)(this,this.Owj,"tableOnKeyUpHandler"));const b=this.e6.tBodies[0].children;for(let k=0;k<b.length;k++)if(vf.a.addHandler(b[k],Rc.a.focus,Object(A.a)(this,
this.Hej,"rowOnFocusHandler")),vf.a.addHandler(b[k],Rc.a.blur,Object(A.a)(this,this.Gej,"rowOnBlurHandler")),aa.a.ut){const t=b[k].children;for(let D=0;D<t.length;D++)vf.a.addHandler(t[D],Rc.a.focus,Object(A.a)(this,this.BBh,"cellOnFocusHandler"))}}super.Tla()}Cfb(){this.ae&&(this.ae.rc(Rc.a.hi,this.vId,Object(A.a)(this,this.Olh,"accHelpDialogKeydownHandler")),this.e6&&this.ae.rc(Rc.a.vh,this.e6,Object(A.a)(this,this.Owj,"tableOnKeyUpHandler")));if(this.e6){const b=this.e6.tBodies[0].children;for(let k=
0;k<b.length;k++)if(vf.a.removeHandler(b[k],Rc.a.focus,Object(A.a)(this,this.Hej,"rowOnFocusHandler")),vf.a.removeHandler(b[k],Rc.a.blur,Object(A.a)(this,this.Gej,"rowOnBlurHandler")),aa.a.ut){const t=b[k].children;for(let D=0;D<t.length;D++)vf.a.removeHandler(t[D],Rc.a.focus,Object(A.a)(this,this.BBh,"cellOnFocusHandler"))}}super.Cfb()}UGa(){this.u_a.scope.ir(this.Ub.nW);this.u_a.scope.ir(this.Ub.oW);this.u_a.scope.bindAction(this.Ub.nW,$a.a.XCc);this.u_a.scope.bindAction(this.Ub.oW,$a.a.WCc)}fnm(b){if(!this.u_a.Zj||
!this.u_a.Zj.s3)return 2;var k=this.u_a.Zj.s3;if(this.e6&&(k===this.Hz&&b===$a.a.XCc||k===this.PWa&&b===$a.a.WCc))this.R0(this.exb);else if(k.id.startsWith("SelectableTableRow"))k=null,b===$a.a.XCc?k=this.PWa:b===$a.a.WCc&&(k=this.Hz),k&&this.R0(k);else if(b===$a.a.XCc)this.u_a.Hdc();else if(b===$a.a.WCc)this.u_a.Fdc();else return 2;return 32}Hej(b){b.target.setAttribute(df.a.Gdb,df.a.jp);Sys.UI.DomElement.removeCssClass(this.exb,"inactiveRowSelection");this.exb=b.target}Gej(b){b.target.removeAttribute(df.a.Gdb);
Sys.UI.DomElement.addCssClass(b.target,"inactiveRowSelection")}BBh(b){(b=b.target.parentNode)&&b!==this.exb&&this.R0(b)}Owj(b){return b.Gb.keyCode===pc.a.zs?(b.Gb.stopPropagation(),!0):!1}Olh(b){if(!b.Gb)return!1;const k=b.Gb.keyCode;if(b.eventName===Rc.a.hi){b=this.RYl(this.exb);let t=-1;const D=ib.a.count(this.uhe)-1;k===Sys.UI.Key.down?t=b<D?b+1:0:k===Sys.UI.Key.up?t=0<b?b-1:D:k===Sys.UI.Key.home?t=0:k===Sys.UI.Key.end&&(t=D);-1!==t&&this.R0(this.e6.tBodies[0].children[t])}return!0}tok(){}ZBn(){this.vId=
document.getElementById("AccessibilityHelpDialogBody")||this.Sp;this.Rcl();this.wcl();this.lal()}Rcl(){if(this.$df){var b=document.createElement("div");b.className="WACDialogSubtitle";var k=document.createElement("span");k.innerText=this.$df;b.appendChild(k);this.cka.appendChild(b)}}wcl(){if(this.uhe&&!ib.a.isEmpty(this.uhe)){this.e6=document.createElement("table");this.e6.className="SelectableDialogTable";var b=document.createElement("thead"),k=document.createElement("tr");k.setAttribute(df.a.qh,
df.a.vEc);b.appendChild(k);var t=fc.a.PHc(14,this.I_k);k.appendChild(t);t=fc.a.PHc(14,this.uoo);k.appendChild(t);this.e6.appendChild(b);b=document.createElement("tbody");k=0;t=this.uhe;for(let ca in t){var D=ca,P=t[ca];const ta=document.createElement("tr");ta.tabIndex=0;ta.setAttribute(df.a.qh,df.a.vEc);ta.id="SelectableTableRow"+k++;D=fc.a.PHc(15,D);ta.appendChild(D);P=fc.a.PHc(15,P);ta.appendChild(P);b.appendChild(ta)}b.style.maxHeight=this.nEo+"px";this.e6.appendChild(b);this.vId.appendChild(this.e6)}}lal(){if(this.ZNi&&
this.$Ni){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.PWa=document.createElement("a");this.PWa.innerText=this.ZNi;this.PWa.href=this.$Ni;this.PWa.target="_blank";this.PWa.id=this.kj("AccessibilityHelpDialogLink");this.PWa.className=ef.AFrame.g0e;b.appendChild(this.PWa);this.Jc.insertBefore(b,this.Jc.lastChild)}}RYl(b){return Number.parseInvariant(b.id.substr(18))}RZ(b,k,t,D=null){b&&k&&t&&(t=D?String.format(t,D):t,b[k]=t)}fgi(b,k){return aa.a.el?k:b}}Object(n.a)(MG,
"AAccessibilityHelpDialog",Wf.a,[971]);class RD extends MG{constructor(b){super(b)}get dialogTitle(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get $df(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}$wm(){const b=this.fgi(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),k=this.fgi(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),t={};this.RZ(t,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);
this.RZ(t,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.RZ(t,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.RZ(t,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,k);this.RZ(t,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.RZ(t,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,b);this.RZ(t,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,b);this.RZ(t,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);this.RZ(t,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,
b);this.RZ(t,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,b);this.RZ(t,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,b);this.RZ(t,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,b);this.RZ(t,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,b);this.RZ(t,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,b);this.RZ(t,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstShortcut,b);w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&this.RZ(t,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,
CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);w.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&this.RZ(t,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(RD.Xb&&RD.Xb.isFeatureEnabled(63)||w.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled"))&&this.RZ(t,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);
return t}static get Xb(){return null!=RD.Iyg?RD.Iyg:RD.Iyg=Fa.a.instance.Na("Box4.IFeatureHelper")}}Object(n.a)(RD,"AccessibilityHelpDialog",MG,[]);var XH=c(327);class VF{static get Xg(){return Wf.a.lA(VF.Lm,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}VF.Lm="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(n.a)(VF,"ApplyStylesDialogHtml",null,[]);class CE extends Wf.a{constructor(b,k){super();this.lH=null;this.tBc=!1;this.pyb=this.$8a=this.Oxc=this.Rxc=this.IBc=null;this.xEk=(t,D)=>{if(this.mh.fv){if(t){t=D.styleList;D=D.styleText;if(-1===t||F.a.Tg(D)!==F.a.Tg(this.lH[t]))t=this.xgi(D);D=this.lH[t];t=this.sc.Mr();D=this.sc.kg(t.Ova(D));w.AFrameworkApplication.va.Nf(this._context,Pb.a.applyStyle,2,!1,new XH.a,D)}this.mh.s5()}};this.Psn=t=>{this.tBc?(this.tBc=!1,this.validate()):"value"===t.rawEvent.propertyName&&
(this.tBc=!0,this.LZ.value!==this.IBc&&(this.IBc=this.LZ.value,this.Bvh()))};this.fon=()=>{-1!==this.ola.selectedIndex&&(aa.a.i4&&(this.tBc=!0),this.IBc=this.lH[this.ola.selectedIndex],this.LZ.value=this.lH[this.ola.selectedIndex],this.validate())};this.onKeyDown=t=>{aa.a.KJ?t.keyCode!==pc.a.aC&&t.keyCode!==pc.a.s1||this.$8a||this.pyb||(this.pyb=new Df.a(0,1,1,this.a_o),w.AFrameworkApplication.nc.Vb(this.pyb)):aa.a.i4&&t.keyCode===pc.a.aC&&(this.tBc=!0)};this.FG=()=>{this.$8a||(this.$8a=new Df.a(0,
1,1,this.aHk),w.AFrameworkApplication.nc.Vb(this.$8a));this.pyb&&(w.AFrameworkApplication.nc.Ve(this.pyb),this.pyb=null)};this.aHk=()=>{this.$8a=null;this.Bvh()};this.a_o=()=>{this.pyb=null;this.validate()};this._context=b;this.ld=k;this.vg="ApplyStylesDialog";this.mh=this._context.view;this.auf();b=this.ZBo();k="";this.lH.length>b&&(k=this.lH[b]);k={["styleText"]:k,["styleList"]:b};this.Xg=VF.Xg;this.Wh(WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.xEk,k);this.ola=document.getElementById("styleList");
this.OZf();this.ola.selectedIndex=b;this.LZ=document.getElementById("styleText");this.LZ.focus();this.LZ.select();this.Qpd=this.fon;vf.a.addHandler(this.ola,"change",this.Qpd);this.Ppd=this.onKeyDown;vf.a.addHandler(this.LZ,"keydown",this.Ppd);aa.a.i4?(this.Rxc=this.Psn,vf.a.addHandler(this.LZ,"propertychange",this.Rxc),this.IBc=this.lH[b]):(this.Oxc=this.FG,vf.a.addHandler(this.LZ,"keypress",this.Oxc))}get sc(){return null!=this.jJg?this.jJg:this.jJg=Fa.a.instance.resolve("Box4.Styles.IWACStyleReader")}ZBo(){var b=
this.mh.mb;if(!b||!b.hb)return Jc.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.hb.kb;if(!b)return Jc.b(579216409,3018,15,"CurrentSelection is null"),0;pe.ParagraphReader.lm(b.Qa)&&(b=hf.SelectionEditor.Cj(b,!0,!1));b=b.Qa;if(!b||!hf.SelectionEditor.hv(b))return Jc.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!b),0;var k=Je.FormattingReader.Kr(b);(k=Je.FormattingReader.Fna(k))||(k=this.sc.Lo(b.node));if(!k)return 0;b=this.sc.YK(k);b=Array.indexOf(this.lH,
b);0>b&&(b=0);return b}OZf(){const b=this.lH.length;for(let k=0;k<b;k++){const t=document.createElement("OPTION");t.value=k.toString();t.text=this.lH[k];this.ola.add(t,null)}}auf(){var b=dl.a.Lr();if(b){b=(new hv.WACStyleSet).LO(b);var k=b.hO,t=this.ld.isFeatureEnabled(112)&&!!this.sc.Fg;this.lH=[];for(let D=0;D<k;D++){const P=b.AEa(D);if(this.sc.isHidden(P))continue;const ca=this.sc.RD(P);if(!t){if(3===ca)continue}else if(3===ca&&this.sc.kg(P)===Dw.a.rpg)continue;Array.add(this.lH,this.sc.YK(P))}this.lH.sort(CE.q1k)}else Jc.b(577644352,
3018,15,"Couldn't find PageContentNode")}dispose(){this.Rxc&&vf.a.removeHandler(this.LZ,"propertychange",this.Rxc);this.Ppd&&vf.a.removeHandler(this.LZ,"keydown",this.Ppd);this.Qpd&&vf.a.removeHandler(this.ola,"change",this.Qpd);this.Oxc&&vf.a.removeHandler(this.LZ,"keypress",this.Oxc);this.$8a&&w.AFrameworkApplication.nc.Ve(this.$8a);this.$8a=this.Oxc=this.ola=this.LZ=this.Ppd=this.Rxc=this.Qpd=null;super.dispose()}Bvh(){var b=this.LZ.value,k=this.Uum(b);const t=-1===k?b:this.lH[k];b=b.length;const D=
t.length;this.IBc=t;this.LZ.value=t;this.ola.selectedIndex=k;D>b&&(aa.a.KJ?this.LZ.setSelectionRange(b,D):aa.a.i4&&(k=this.LZ.createTextRange(),k.collapse(!0),k.moveStart("character",b),k.moveEnd("character",D-b),k.select()));this.validate();this.LZ.focus()}Uum(b){let k=0,t=this.lH.length,D=-1;for(b=F.a.Tg(b);k<t;){const P=Math.floor((k+t)/2),ca=CE.C8e(b,this.lH[P]);if(!ca){D=P;break}0<ca?k=P+1:t=P}if(D>k)for(;!CE.C8e(b,this.lH[D-1])&&(D--,D!==k););return D}validate(){const b=-1===this.xgi(this.LZ.value),
k=document.getElementById("badStyleError");b?(k.style.display="inline-block",k.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(k.style.display="none",k.innerText="");return!b}xgi(b){b=F.a.Tg(b);const k=this.lH.length;for(let t=0;t<k;t++)if(b===F.a.Tg(this.lH[t]))return t;return-1}static C8e(b,k){const t=Math.min(b.length,k.length);b=F.a.Tg(b);k=F.a.Tg(k);for(let D=0;D<t;D++){const P=F.a.charCodeAt(b,D),ca=F.a.charCodeAt(k,D);if(P!==ca)return P-ca}return b.length<=k.length?0:1}static q1k(b,
k){return CE.C8e(b,k)}}Object(n.a)(CE,"ApplyStylesDialog",Wf.a,[]);var DE=c(317);class YH extends Uc.StandardDialog{constructor(b){super();this.xv=b;this.wto()}wto(){this.Ad=1;this.XU(1);this.Ee(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);this.Gu(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.tdf.bind(this))}tdf(b){1===b&&this.xv.Via("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(k=>{k.Ci?Jc.b(524834400,
3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",k.exception,k.exception.stack):(this.q4n(),Jc.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}q4n(){DE.a.mqb="{}"}}Object(n.a)(YH,"DeleteSavedStylesConfirmationDialog",Uc.StandardDialog,[]);class ZH extends Uc.StandardDialog{constructor(b,k){super();this.tdf=P=>{if(1===P){P=new Map;P.set("Source","DeleteStyleConfirmationDialog");P.set("Action","DeleteStyle");xa.Health.instance.recordKpiUsage(Pi.a.vza,0,Pi.a.qB,P);var ca=
dl.a.Lr();P=new Xd.GraphTransaction(15);P.Cb(ca);P.fk=Pb.a.NBb;this.XG.OPh(this.Xgh)?Jc.b(578359694,3018,50,"User deleted a style via UI."):(ca=new Map,ca.set("Source","DeleteStyleConfirmationDialog"),ca.set("Action","DeleteStyle"),ca=Object.assign(new Db.a,{extendedProperties:ca}),xa.Health.instance.recordKpiFailure(Pi.a.vza,"DeleteStyleFailed",!1,!0,ca),Jc.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));P.dispose()}};k||Jc.b(590128417,3018,10,"styleId is null");
let t=null,D=null;if(this.mh=b.view)D=this.mh.mb;D&&(t=D.hb.kb.Qa);t?(b=t.node)?(this.nK=this.fh.Ts(b))?(this.Xgh=new Eb.a,this.Xgh.add(k),this.xto(k)):Jc.b(590128448,3018,10,"_pageContenNode is null."):Jc.b(590128419,3018,10,"node is null."):Jc.b(590128418,3018,10,"nodeContext is null.")}get XG(){return null!=this.ZIg?this.ZIg:this.ZIg=Fa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get sc(){return null!=this.qJg?this.qJg:this.qJg=Fa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get fh(){return null!=
this.QEg?this.QEg:this.QEg=Wk.PageNavigator.instance}xto(b){const k=(new hv.WACStyleSet).LO(this.nK);k?((b=k.Fi(b))||Jc.b(590128450,3018,10,"Style set doesn't contain style with given ID"),b=this.sc.YK(b),this.Ad=4,this.XU(2),this.Gu(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,b),0,this.tdf)):Jc.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(n.a)(ZH,"DeleteStyleConfirmationDialog",Uc.StandardDialog,
[]);class WF{static get Xg(){return Wf.a.lA(WF.Lm)}}WF.Lm="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(n.a)(WF,"DeleteStyleDialogHtml",null,[]);class $H extends Wf.a{constructor(b){super();this.nK=this.lH=null;this.Til=(k,t)=>{this.mh.fv&&(k?(k=t.styleList,-1!==k&&(k=this.lH[k],t=this.sc.Mr(),k=this.sc.kg(t.Ova(k)),this.hJc.Sil(this._context,k),this.mh.s5())):this.mh.s5())};this._context=b;this.vg="DeleteStyleDialog";this.Ad=
1;this.Ee(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.mh=this._context.view;this.auf();this.Xg=WF.Xg;this.Wh(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.Til,{["styleList"]:0});this.ola=document.getElementById("styleList");this.OZf();this.ola.selectedIndex=0;this.ola.focus()}get sc(){return null!=this.lJg?this.lJg:this.lJg=Fa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get hJc(){return null!=this.Dxg?this.Dxg:this.Dxg=Fa.a.instance.resolve("WordEditor.UI.IDialogFactory")}OZf(){const b=
this.lH.length;for(let k=0;k<b;k++){const t=document.createElement("OPTION");t.value=k.toString();t.text=this.lH[k];this.ola.add(t,null)}}auf(){if(this.nK=dl.a.Lr()){var b=(new hv.WACStyleSet).LO(this.nK),k=b.hO;this.lH=[];for(let D=0;D<k;D++){const P=b.AEa(D);if(!this.sc.isHidden(P)&&this.sc.ke(P,b)){var t=this.sc.RD(P);if(2===t||1===t)P.hasProperty(Cc.a.linkedStyle)&&2!==t||(t=P.ia(Cc.a.yK,null))&&0<t.length||this.lH.push(this.sc.YK(P))}}this.lH.sort()}else Jc.b(578650370,3018,15,"PageContentNode is null")}}
Object(n.a)($H,"DeleteStyleDialog",Wf.a,[]);var eM=c(763);class aI{constructor(b){this.customData=null;this.vO=b}}Object(n.a)(aI,"PropertySetChangedState",null,[]);class bI{static eGn(b,k,t){if(b&&k){var D=new aI(k),P=(ca,ta,Na)=>{t.dGn(ca,ta,Na,D)};b=new eM.a(k,b);b.Hzd=P;b.$Cd=P;b.ide=P;b.dgc()}}}Object(n.a)(bI,"PropertySetChangedManager",null,[]);class cI{constructor(b){this.SLa=b}dGn(b,k,t,D){const P=this.SLa[b.id.toString()];P&&P(b,k,t,D)}}Object(n.a)(cI,"PropertyChangedProcessor",null,[]);const XF=
(b,k,t)=>{const D=Dt.a.instance.h6b;if(D){const P=new Xd.GraphTransaction(15);P.Cb(D);bI.eGn(b,k,new cI(t));P.dispose()}};class YF{static get Xg(){return Wf.a.lA(YF.Lm,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}YF.Lm="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(n.a)(YF,"MarginsDialogHtml",null,[]);class br{static get J4(){return null!=br.DEg?br.DEg:br.DEg=Fa.a.instance.Na("WordEditor.IPageCommands")}static z8m(b,k,t){br.J4&&null!==t&&br.J4.Fge(0,t)}static v8m(b,k,t){br.J4&&null!==t&&br.J4.Fge(3,t)}static x8m(b,k,t){br.J4&&null!==t&&br.J4.Fge(1,t)}static y8m(b,k,t){br.J4&&null!==t&&br.J4.Fge(2,t)}static mxn(b,k,t){br.J4&&null!==t&&br.J4.ZSa(0,t)}static Mwn(b,k,t){br.J4&&null!==t&&br.J4.ZSa(1,t)}static o_k(b,k,t){br.J4&&null!==t&&(b==qe.a.RE?br.J4.Ofe(0,
t):b==qe.a.eG?br.J4.Ofe(1,t):b==qe.a.hma?br.J4.Ofe(2,t):b==qe.a.separator&&br.J4.Ofe(3,t))}}Object(n.a)(br,"PageLevelPropertyChangedHandlers",null,[]);const dI=[Nc.a.X_c,Nc.a.W_c,Nc.a.v8d,Nc.a.w8d,Nc.a.Nae,Nc.a.Kae,Nc.a.Lae,Nc.a.Mae];class Xz extends Wf.a{constructor(b,k,t,D,P){super();this.MMc=(ca,ta)=>{var Na=Xz.$1c(ca);ca=Wa.App.yha;this.Ep.hasProperty(Na)?(Na=this.Ep.getValue(Na),ta[Dh.a.Number]=Ef.a.b8a(Na,ca)):ta[Dh.a.Number]=0;ta[Dh.a.UnitType]=ca};this.v6c=(ca,ta)=>{this.Ep.setValue(Xz.$1c(ca),
Ef.a.xIa(ta[Dh.a.Number],ta[Dh.a.UnitType]));this.pu.xm()};this.B8m=ca=>{let ta=!1;1===ca&&(Math.abs(this.Ep.getValue(Cc.a.marginTop))+Math.abs(this.Ep.getValue(Cc.a.marginBottom))+Wa.App.uza<=this.ota.getValue(Cc.a.lv)&&this.Ep.getValue(Cc.a.marginLeft)+this.Ep.getValue(Cc.a.marginRight)+Wa.App.uza<=this.ota.getValue(Cc.a.Ao)?XF(this.GAa,this.Ep,Xz.f8b()):ta=!0);this.dispose();ta&&this.vHa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.w8m)};this.w8m=()=>{Fa.a.instance.resolve("WordEditor.UI.IDialogFactory").uLh(this.GAa,
this.ota,this.x6)};this.vg="MarginsDialog";this.ota=k.clone();this.GAa=b.clone();this.Ep=b.clone();this.x6=t;this.IV=!1;this.pu=P;this.Xg=YF.Xg;t&&(this.Pqc=Kj.a.XPb);this.Wh(WordEditorIntl.WordEditorStrings.L_PageMargins,this.B8m,null);this.jSc();this.RSe=document.getElementById("DialogMarginTopSpinner");this.R0(this.RSe)}W8(){this.VBd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",Nc.a.X_c,Nc.a.Nae,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.VBd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",Nc.a.W_c,Nc.a.Kae,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.VBd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",Nc.a.v8d,Nc.a.Lae,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.VBd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",Nc.a.w8d,Nc.a.Mae,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}jSc(){for(const b of dI)Object(am.a)(b,this.v6c,this.MMc);this.pu.ypa("DialogMarginTopSpinner");
this.pu.ypa("DialogMarginBottomSpinner");this.pu.ypa("DialogMarginLeftSpinner");this.pu.ypa("DialogMarginRightSpinner")}dispose(){for(const b of dI)Object(am.b)(b);this.pu.BY("DialogMarginTopSpinner");this.pu.BY("DialogMarginBottomSpinner");this.pu.BY("DialogMarginLeftSpinner");this.pu.BY("DialogMarginRightSpinner");super.dispose()}VBd(b,k,t,D,P){t=Xz.BMk(k,t,D,P);this.szb(t,b,k)}szb(b,k,t){k=document.getElementById(k);this.pu.OYa(t,b);b=this.pu.ODb(t,"Medium");k.appendChild(b)}static f8b(){return Xz.SLa||
(Xz.SLa=Xz.G3b())}static G3b(){const b={};b[Cc.a.marginTop.id.toString()]=br.z8m;b[Cc.a.marginBottom.id.toString()]=br.v8m;b[Cc.a.marginLeft.id.toString()]=br.x8m;b[Cc.a.marginRight.id.toString()]=br.y8m;return b}static BMk(b,k,t,D){let P=!0;if(k===Nc.a.X_c||k===Nc.a.W_c)P=!1;return gl.j(b,k,t,D,[Xz.DMk(P),Xz.CMk(P)])}static DMk(b){return gl.l("inch",b?"0":"-22","22",".1")}static CMk(b){return gl.l("centimeter",b?"0":"-55.8","55.8","1")}static $1c(b){let k=null;switch(b){case Nc.a.X_c:case Nc.a.Nae:k=
Cc.a.marginTop;break;case Nc.a.W_c:case Nc.a.Kae:k=Cc.a.marginBottom;break;case Nc.a.v8d:case Nc.a.Lae:k=Cc.a.marginLeft;break;case Nc.a.w8d:case Nc.a.Mae:k=Cc.a.marginRight}return k}}Xz.SLa=null;Object(n.a)(Xz,"MarginsDialog",Wf.a,[]);class ZF{static get Xg(){return Wf.a.lA(ZF.Lm,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}ZF.Lm="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(n.a)(ZF,"PaperSizeDialogHtml",null,[]);const eI=[Nc.a.z8d,Nc.a.y8d,Nc.a.bbe,Nc.a.abe];class Kt extends Wf.a{constructor(b,k,t,D,P){super();this.MMc=(ca,ta)=>{var Na=this.$1c(ca);ca=Wa.App.yha;this.Ep.hasProperty(Na)?(Na=this.Ep.getValue(Na),ta[Dh.a.Number]=Ef.a.b8a(Na,ca)):ta[Dh.a.Number]=0;ta[Dh.a.UnitType]=ca};this.v6c=(ca,ta)=>{this.Ep.setValue(this.$1c(ca),Ef.a.xIa(ta[Dh.a.Number],ta[Dh.a.UnitType]));this.pu.xm()};this.yxn=ca=>{let ta=!1;1===ca&&(this.Ep.getValue(Cc.a.lv)>=Wa.App.uza+this.ota.getValue(Cc.a.marginTop)+
this.ota.getValue(Cc.a.marginBottom)&&this.Ep.getValue(Cc.a.Ao)>=Wa.App.uza+this.ota.getValue(Cc.a.marginLeft)+this.ota.getValue(Cc.a.marginRight)?XF(this.GAa,this.Ep,Kt.f8b()):ta=!0);this.dispose();ta&&this.vHa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.xxn)};this.xxn=()=>{Fa.a.instance.resolve("WordEditor.UI.IDialogFactory").YLh(this.GAa,this.ota,this.x6)};this.vg="PaperSizeDialog";this.ota=k.clone();this.GAa=b.clone();this.Ep=b.clone();this.x6=t;this.IV=!1;this.pu=P;this.Xg=ZF.Xg;
t&&(this.Pqc=Kj.a.XPb);this.Wh(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,this.yxn,null);this.jSc();this.RSe=document.getElementById("DialogWidthSpinner");this.R0(this.RSe)}W8(){this.gyh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",Nc.a.z8d,Nc.a.bbe,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.gyh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",Nc.a.y8d,Nc.a.abe,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}jSc(){for(const b of eI)Object(am.a)(b,
this.v6c,this.MMc);this.pu.ypa("DialogWidthSpinner");this.pu.ypa("DialogHeightSpinner")}dispose(){for(const b of eI)Object(am.b)(b);this.pu.BY("DialogWidthSpinner");this.pu.BY("DialogHeightSpinner");super.dispose()}gyh(b,k,t,D,P){t=Kt.SMk(k,t,D,P);this.szb(t,b,k)}szb(b,k,t){k=document.getElementById(k);this.pu.OYa(t,b);b=this.pu.ODb(t,"Medium");k.appendChild(b)}$1c(b){let k=null;switch(b){case Nc.a.y8d:case Nc.a.abe:k=Cc.a.lv;break;case Nc.a.z8d:case Nc.a.bbe:k=Cc.a.Ao}return k}static f8b(){return Kt.SLa||
(Kt.SLa=Kt.G3b())}static G3b(){const b={};b[Cc.a.Ao.id.toString()]=br.mxn;b[Cc.a.lv.id.toString()]=br.Mwn;return b}static SMk(b,k,t,D){return gl.j(b,k,t,D,[Kt.UMk(),Kt.TMk()])}static UMk(){return gl.l("inch",Kt.Lsj,Kt.zVm,Kt.lxo)}static TMk(){return gl.l("centimeter",Kt.Lsj,Kt.yVm,Kt.kxo)}}Kt.Lsj="0";Kt.zVm="22";Kt.lxo=".1";Kt.kxo="1";Kt.yVm="55.8";Kt.SLa=null;Object(n.a)(Kt,"PaperSizeDialog",Wf.a,[]);const fM=RegExp("[{|}|;|\\\\]"),fI=b=>{if(!b)return"";const k=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,
t=b.hO;let D;for(D=1;D<=t;D++){const P=k+D;if(!(b.Fi(P)||b.oPc(P)||b.Fi(P+"Char")||b.oPc(P+"Char")))break}return k+D};class gI extends Wf.a{constructor(b,k,t,D,P){var ca,ta,Na,qb;super(!1,!1,!0);this.context=b;this.pc=k;this.b8=t;this.sc=D;this.fh=P;this.EKd=null;this.P5i=(Jb,Vb)=>{if(this.je.fv){if(0!==Jb){Jb="string"===typeof Vb.styleText?Vb.styleText:null;Vb=this.$R;var ac=Jb;const yc=F.a.gya(ac);let Kc=null;if(0===yc.length)Kc=WordEditorIntl.WordEditorStrings.l_StyleNameEmpty;else if(253<ac.length)Kc=
WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength;else if(fM.test(ac))Kc=WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters;else if(Vb.Ova(ac)||Vb.oPc(yc))Kc=WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;(Vb=Kc)?(this.EKd=Vb,Vb=fI(this.$R),Jb=this.MDb(Jb,Vb),this.EKd=null,this.IV=!1,this.hide(),this.Wh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.P5i,Jb),this.IV=!0):(this.hide(),Vb=new Map,Vb.set("Source","ReactCreateNewStyleDialog"),Vb.set("Action","CreateStyle"),
xa.Health.instance.recordKpiUsage(Pi.a.vza,0,Pi.a.qB,Vb),this.bzd(Jb)||(Jb=new Map,Jb.set("Source","ReactCreateNewStyleDialog"),Jb.set("Action","CreateStyle"),Jb=Object.assign(new Db.a,{extendedProperties:Jb}),xa.Health.instance.recordKpiFailure(Pi.a.vza,"CreateStyleFailed",!1,!0,Jb)))}else this.hide();this.je.s5()}};this.vg="CreateNewStyleDialog";this.je=b.view;(b=null===(qb=null===(Na=null===(ta=null===(ca=this.je)||void 0===ca?void 0:ca.mb)||void 0===ta?void 0:ta.hb)||void 0===Na?void 0:Na.kb)||
void 0===qb?void 0:qb.Qa)?(ca=b.node)?(this.pageContentNode=this.fh.Ts(ca))?(this.$R=(new hv.WACStyleSet).LO(this.pageContentNode),(this.JJb=this.b8.zLd(b))?(ca=this.JJb.ia(sf.a.fontSize,22),16>ca?Jc.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=ca?Jc.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):90>=ca?Jc.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Jc.b(593078047,3018,
50,"Font size more than 45pt in create new style dialog preview"),this.z5f(this.JJb),this.pageContentNode&&this.JJb&&(this.A$=!1,ca=fI(this.$R),ca=this.MDb(ca,ca),this.Wh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.P5i,ca))):Jc.b(592737758,3018,10,"_newStyleProperties is null.")):Jc.b(592737757,3018,10,"_pageContenNode is null."):Jc.b(592725466,3018,10,"node is null."):Jc.b(556917206,3018,10,"nodeContext is null.")}z5f(b){b.Eg(zi.a.paragraphStyle,zi.a.aw,...Pi.a.yba())}MDb(b,k){const t=
52<=this.JJb.ia(sf.a.fontSize,bd.a.lM),D=cr.a.Oof(this.JJb,"97%",26,!1,!0,t);D["padding-left"]="5px";t||(D["line-height"]="40px");b={["styleNameLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,["previewWindowLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,["styleName"]:b,["previewContainerText"]:k,["getPreviewStyle"]:()=>D};this.EKd&&(b.errorMessage=this.EKd);return{["id"]:this.vg,["bodyControls"]:b}}bzd(b){const k=new Xd.GraphTransaction(15);k.Cb(this.pageContentNode);
k.fk=Pb.a.fBb;const t=dl.a.bzd(b,dl.a.cei(this.JJb),null,this.pageContentNode);t&&(Jc.b(593078046,3018,50,"User created linked style"),this.$R=(new hv.WACStyleSet).LO(this.pageContentNode),b=F.a.gya(F.a.MX(b)),b=this.$R.oPc(b),this.pc.Nf(this.context,Pb.a.applyStyle,2,!1,new XH.a,this.sc.kg(b)));k.dispose();return t}}Object(n.a)(gI,"ReactCreateNewStyleDialog",Wf.a,[]);class rD extends Wf.a{constructor(b,k=!1,t){super(!1,!1,k);let D=k=this.eK=null;this.vg=rD.id;this.mh=b.view;this.nn=t;this.mh&&(D=
this.mh.mb);D&&D.hb&&D.hb.kb&&(k=D.hb.kb.Qa);k?(b=k.node)?(this.nK=rD.fh.Ts(b))||v.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):v.ULS.sendTraceTag(539762889,3029,10,"node is null"):v.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}MZo(b){var k=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),t=this.gKl();const D=""===F.a.gya(b),P=b.length>rD.I9m;t=t.includes(b);k=k.test(b);b=b.startsWith("_");let ca=null;if(D||P||t||b||!k)ca=D?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:
P?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:k?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return ca}NEm(b,k){return b?b===k:!1}static get fh(){return Wk.PageNavigator.instance}gKl(){const b=this.nn.ANd(!1),k=[];for(let t=0;t<b.count;t++){const D=b.J(t).ia(Cc.a.jt,"");k.push(D)}return k}}rD.id="BookmarkEditDialog";rD.I9m=40;Object(n.a)(rD,
"AEditBookmarkDialog",Wf.a,[]);class hI extends rD{constructor(b,k,t){super(b,!0,t);this.Cze=null;this.SVa="wwaengidc";this.Avc="ReactCreateEditBookmarkNameDialog";this.M2g="EditBookmarkName";this.ssa="EditBookmarkNameDialog";this.zte=k;this.nn=t;this.nK&&(this.A$=!1,b=this.MDb(k.properties.ia(Cc.a.jt,null)),this.Wh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.R5i.bind(this),b))}R5i(b,k){if(this.mh.fv){if(b){b="string"===typeof k.BookmarkText?k.BookmarkText:null;var t;this.zte.hasProperty(Cc.a.jt)?
t=this.zte.getValue(Cc.a.jt):v.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");k=this.MZo(b);this.NEm(b,t)?(v.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):k?(this.Cze=k,t=this.MDb(b),this.Cze=null,this.IV=!1,this.hide(),this.Wh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.R5i.bind(this),t),this.IV=!0):(this.hide(),t=new Map,t.set("Source",this.Avc),t.set("Action",this.M2g),xa.Health.instance.recordKpiUsage(this.ssa,
0,this.SVa,t),this.dTk(b)||(t=new Map,t.set("Source",this.Avc),t.set("Action",this.M2g),t=Object.assign(new Db.a,{extendedProperties:t}),xa.Health.instance.recordKpiFailure(this.ssa,"Unable to edit bookmark",!1,!0,t)))}else this.hide();this.mh.s5()}}dTk(b){b=F.a.gya(F.a.MX(b));try{const k=this.nn.$Qo(this.zte,b);if(k)v.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");else return v.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),
k}catch(k){return v.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",k.Message),!1}}MDb(b){const k={};k.bookmarkValue=b;k.errorMessage=this.Cze;k.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.vg,["bodyControls"]:k}}}Object(n.a)(hI,"ReactEditBookmarkNameDialog",rD,[]);const $F=(b,k,t)=>{const D=[];if(b.length!==k.length||t&&t.length!==k.length)return D;for(let P=0;P<b.length;P++){const ca={};ca.key=k[P];
ca.text=b[P];ca.type="AppComboBoxItem";t&&(ca.ariaLabel=t[P]);D[P]=ca}return D},fC=(b,k,t,D,P)=>({["unitType"]:b,["unitPlaceholder"]:F.a.X9d(k),["minValue"]:t,["maxValue"]:D,["step"]:P}),NG=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),iI=(b,k,t)=>{let D=!1;b.hasProperty(k)&&b.hasProperty(t)?(t=b.getValue(t),1===t?(b=Number.NaN,k=5,D=!0):(b=b.getValue(k),k=2===t?4:5)):(b=Number.NaN,
k=Wa.App.sFa?4:5);return{Ujc:b,G7a:k,B$b:D}};class jI{constructor(){this.dtj=this.HZi=this.FZi=this.Exn=this.JXf=!1}}Object(n.a)(jI,"Box4PropertySetChangedState",null,[]);class Hm{static get U9b(){return null!=Hm.OAg?Hm.OAg:Hm.OAg=Fa.a.instance.Na("Box4.IIndentationCommands")}static get oDi(){return null!=Hm.bDg?Hm.bDg:Hm.bDg=Fa.a.instance.Na("Box4.IJustificationCommands")}static get k5(){return null!=Hm.rGg?Hm.rGg:Hm.rGg=Fa.a.instance.Na("Box4.ISpacingCommands")}static AUm(b,k,t){Hm.oDi&&t&&(null===
k||11!==t||10!==k&&9!==k)&&Hm.oDi.gE(t)}static OXm(b,k,t){Hm.k5&&t&&Hm.k5.dD(t)}static C4k(b,k,t){k!=t&&Hm.k5.Eic(t)}static LUm(b,k,t){k!=t&&Hm.k5.O6c(t)}static n1o(b,k,t){k!=t&&Hm.k5.q7c(t)}static JUm(b,k,t){k!=t&&Hm.k5.N6c(t)}static MZi(b,k,t,D){Hm.k5&&void 0!==t&&null!==t&&(b=Hm.bNc(D),!b.JXf&&D.vO.hasProperty(vd.a.ofc)&&D.vO.hasProperty(vd.a.pfc)&&(k=D.vO.getValue(vd.a.pfc),D=D.vO.getValue(vd.a.ofc),b.JXf=!0,Hm.k5.Wca(1,k,D)))}static LZi(b,k,t,D){Hm.k5&&void 0!==t&&null!==t&&(b=Hm.bNc(D),!b.Exn&&
D.vO.hasProperty(vd.a.mfc)&&D.vO.hasProperty(vd.a.nfc)&&(k=D.vO.getValue(vd.a.nfc),D=D.vO.getValue(vd.a.mfc),b.JXf=!0,Hm.k5.Wca(0,k,D)))}static EZi(b,k,t,D){Hm.U9b&&void 0!==t&&null!==t&&(b=Hm.bNc(D),!b.FZi&&D.vO.hasProperty(vd.a.CGa)&&D.vO.hasProperty(vd.a.DGa)&&(k=D.vO.getValue(vd.a.DGa),D=D.vO.getValue(vd.a.CGa),b.FZi=!0,Hm.U9b.ulj(1,k,D)))}static GZi(b,k,t,D){Hm.U9b&&void 0!==t&&null!==t&&(b=Hm.bNc(D),!b.HZi&&D.vO.hasProperty(vd.a.Amb)&&D.vO.hasProperty(vd.a.Bmb)&&(k=D.vO.getValue(vd.a.Bmb),D=
D.vO.getValue(vd.a.Amb),b.HZi=!0,Hm.U9b.ulj(0,k,D)))}static pfg(b,k,t,D){Hm.U9b&&void 0!==t&&null!==t&&(b=Hm.bNc(D),!b.dtj&&D.vO.hasProperty(vd.a.oTa)&&D.vO.hasProperty(vd.a.pTa)&&(k=0,D.vO.hasProperty(vd.a.l5)&&(k=D.vO.getValue(vd.a.l5)),t=D.vO.getValue(vd.a.pTa),D=D.vO.getValue(vd.a.oTa),b.dtj=!0,Hm.U9b.Vge(k,t,D)))}static bNc(b){b.customData||(b.customData=new jI);return b.customData}}Object(n.a)(Hm,"ParagraphLevelPropertyChangedHandlers",null,[]);class sD{constructor(){this.SLa=null}w5l(b){const k=
{};k.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var t=fC("Point",5,0,1584,1),D=fC("Line",4,0,327,1),P=[t,D];D=NG();var ca=[Box4Intl.Box4Strings.L_SpinnerAuto];t=[""];({Ujc:Na,G7a:ta,B$b:qb}=iI(b,vd.a.pfc,vd.a.ofc));var ta={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,
["unitType"]:Ef.a.d_a(ta),["validUnits"]:P,["numberFormatInfo"]:D,["validReservedValues"]:ca};qb?ta.reservedValue=ca[0]:ta.value=isNaN(Na)?"":Na;k.beforeSpacingSpinButtonProps=ta;({Ujc:Na,G7a:ta,B$b:qb}=iI(b,vd.a.nfc,vd.a.mfc));P={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Ef.a.d_a(ta),["validUnits"]:P,["numberFormatInfo"]:D,["validReservedValues"]:ca};
qb?P.reservedValue=ca[0]:P.value=isNaN(Na)?"":Na;k.afterSpacingSpinButtonProps=P;if(ca=P=b.hasProperty(vd.a.ua))ca=sD.NFa.pEb(b),ca=b.hasProperty(vd.a.ua)&&b.hasProperty(vd.a.F3a)&&2===b.getValue(vd.a.F3a)?!Ne.a.vwa(ca,1)&&!Ne.a.vwa(ca,1.5)&&!Ne.a.vwa(ca,2):!1;if(P){var Na=sD.NFa.pEb(b);P=0;var qb=!1;b.hasProperty(vd.a.ua)&&b.hasProperty(vd.a.F3a)||(qb=!0);qb||(2!==b.getValue(vd.a.F3a)&&(qb=!0),P=Na,1>P&&(qb=!0));qb?P="":(Na="multiple",ca||(Ne.a.vwa(P,1)?Na="1.00":Ne.a.vwa(P,1.5)?Na="1.50":Ne.a.vwa(P,
2)&&(Na="2.00")),P=Na)}else P=null;Na={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:$F([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50",
"2.00","multiple"]),["allowFreeForm"]:!1};P?Na.selectedKey=P:Na.defaultSelectedKey="";k.lineSpacingComboBoxProps=Na;P=0;Na=!1;b.hasProperty(vd.a.ua)&&b.hasProperty(vd.a.F3a)&&2===b.getValue(vd.a.F3a)&&ca&&(P=sD.NFa.pEb(b),Na=!0,1>P&&(P=Number.NaN));b=[fC("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,
["numberFormatInfo"]:D,["validReservedValues"]:t};Na?b.value=P:b.reservedValue=t[0];k.atSpinButtonProps=b;return k}f8b(){return this.SLa||(this.SLa=this.G3b())}G3b(){const b={};b[vd.a.ua.id.toString()]=Hm.OXm;b[vd.a.nfc.id.toString()]=Hm.LZi;b[vd.a.mfc.id.toString()]=Hm.LZi;b[vd.a.pfc.id.toString()]=Hm.MZi;b[vd.a.ofc.id.toString()]=Hm.MZi;return b}static get NFa(){return null!=sD.jDg?sD.jDg:sD.jDg=Fa.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(n.a)(sD,"ReactParagraphDialog",null,[]);const kI=
b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,OG=(b,k,t,D)=>{let P=Wa.App.yha;b.hasProperty(k)&&b.hasProperty(t)&&!D?(k=b.getValue(k),b=b.getValue(t),k?2===b?P=2:k=Ef.a.b8a(k,P):Wa.App.sFa&&(P=2)):(k=Number.NaN,Wa.App.sFa&&(P=2));return{Ujc:k,G7a:P}},gM=b=>{let k="0";b.hasProperty(vd.a.l5)&&(b=b.getValue(vd.a.l5),(1===b||2===b||!b)&&(1===b?k="1":2===b?k="2":b||(k="0")));return k},lI=(b,k)=>{if(k.hasProperty(vd.a.l5)&&2===k.getValue(vd.a.l5)&&k.hasProperty(vd.a.pTa)&&k.hasProperty(vd.a.oTa)&&
b.hasProperty(vd.a.DGa)&&b.hasProperty(vd.a.CGa)){var t=b.getValue(vd.a.DGa),D=b.getValue(vd.a.CGa);t=(new Iq.a(D,t)).Ft;D=k.getValue(vd.a.pTa);k=k.getValue(vd.a.oTa);k=(new Iq.a(k,D)).Ft;b.setValue(vd.a.DGa,t+k);b.setValue(vd.a.CGa,1)}},mI=b=>{const k=b.getValue(vd.a.DGa);b=b.getValue(vd.a.CGa);return(new Iq.a(b,k)).Ft},nI=b=>{const k=b.getValue(vd.a.Bmb);b=b.getValue(vd.a.Amb);return(new Iq.a(b,k)).Ft},oI=(b,k)=>k.hasProperty(vd.a.DGa)&&k.hasProperty(vd.a.CGa)&&k.hasProperty(vd.a.Bmb)&&k.hasProperty(vd.a.Amb)&&
b.hasProperty(Cc.a.marginLeft)&&b.hasProperty(Cc.a.marginRight)&&b.hasProperty(Cc.a.Ao),hM=b=>b.hasProperty(vd.a.G0c)?b.getValue(vd.a.G0c):!1,iM=b=>b.hasProperty(qe.a.keepWithNext)?b.getValue(qe.a.keepWithNext):!1,jM=b=>b.hasProperty(qe.a.widowControl)?b.getValue(qe.a.widowControl):!1,kM=b=>b.hasProperty(qe.a.keepTogether)?b.getValue(qe.a.keepTogether):!1;class pI extends Wf.a{constructor(b,k,t,D,P){super(!1,!1,!0);this.tlh=null;this.Mxn=()=>{Fa.a.instance.resolve("Box4.UI.IBox4DialogFactory").MGd(this.GAa,
this.ota,this.x6,this.UA)};this.Oxn=(qb,Jb)=>{var Vb,ac,yc;if(Jb&&(1===qb||2===qb)){if(Jb.alignmentComboBoxProps){var Kc=parseInt(Jb.alignmentComboBoxProps.selectedKey);isNaN(Kc)||kI(Kc)&&this.Ep.setValue(vd.a.lw,Kc)}var ed=Jb.bySpinButtonProps;Kc=!!ed&&""!==ed.value;var sd=Jb.didChangeSpecialIndentationComboBoxValue;if(Jb.specialIndentationComboBoxProps){var oe=parseInt(Jb.specialIndentationComboBoxProps.selectedKey);1!==oe&&2!==oe&&oe||!(oe||sd||Kc)||this.Ep.setValue(vd.a.l5,oe)}if(ed){oe=ed.value;
ed=Ef.a.ENa(ed.unitType.toLowerCase());let Ld;0<=oe||(oe=0);2===ed?Ld=2:(Ld=1,oe=Ef.a.xIa(oe,ed));if(Kc||sd)this.Ep.setValue(vd.a.pTa,oe),this.Ep.setValue(vd.a.oTa,Ld)}Jb.beforeTextSpinButtonProps&&(sd=Jb.beforeTextSpinButtonProps,Kc=Ef.a.ENa(sd.unitType.toLowerCase()),sd=""===sd.value?Number.NaN:sd.value,isNaN(sd)||(oe=sd,2===Kc?ed=2:(ed=1,oe=Ef.a.xIa(sd,Kc)),this.Ep.setValue(vd.a.DGa,oe),this.Ep.setValue(vd.a.CGa,ed)));Jb.afterTextSpinButtonProps&&(sd=Jb.afterTextSpinButtonProps,Kc=Ef.a.ENa(sd.unitType.toLowerCase()),
sd=""===sd.value?Number.NaN:sd.value,isNaN(sd)||(oe=sd,2===Kc?ed=2:(ed=1,oe=Ef.a.xIa(sd,Kc)),this.Ep.setValue(vd.a.Bmb,oe),this.Ep.setValue(vd.a.Amb,ed)));Jb.beforeSpacingSpinButtonProps&&(Kc=Jb.beforeSpacingSpinButtonProps,sd=Ef.a.ENa(Kc.unitType.toLowerCase()),oe=Kc.reservedValue,""!==Kc.value&&(oe===Box4Intl.Box4Strings.L_SpinnerAuto?(sd=1,Kc=0):(sd=4===sd?2:4,Kc=Kc.value),this.Ep.setValue(vd.a.pfc,Kc),this.Ep.setValue(vd.a.ofc,sd)));Jb.afterSpacingSpinButtonProps&&(Kc=Jb.afterSpacingSpinButtonProps,
sd=Ef.a.ENa(Kc.unitType.toLowerCase()),oe=Kc.reservedValue,""!==Kc.value&&(oe===Box4Intl.Box4Strings.L_SpinnerAuto?(sd=1,Kc=0):(sd=4===sd?2:4,Kc=Kc.value),this.Ep.setValue(vd.a.nfc,Kc),this.Ep.setValue(vd.a.mfc,sd)));if(Jb.atSpinButtonProps||Jb.lineSpacingComboBoxProps)if(Kc=Jb.atSpinButtonProps.value,1<Kc)this.Ep.setValue(vd.a.ua,Kc),this.Ep.setValue(vd.a.F3a,2);else if(Kc=Jb.lineSpacingComboBoxProps.selectedKey)Kc="1.00"===Kc?1:"1.50"===Kc?1.5:"2.00"===Kc?2:0,Kc=1<=Kc?Kc:1,this.Ep.setValue(vd.a.ua,
Kc),this.Ep.setValue(vd.a.F3a,2);Jb.contextualSpacingCheckboxProps&&this.Ep.setValue(vd.a.G0c,Jb.contextualSpacingCheckboxProps.checked);(null===(Vb=this.UA)||void 0===Vb?0:Vb.JFa)&&Jb.keepWithNextCheckboxProps&&this.Ep.setValue(qe.a.keepWithNext,Jb.keepWithNextCheckboxProps.checked);(null===(ac=this.UA)||void 0===ac?0:ac.XIa)&&Jb.widowOrphanCheckboxProps&&this.Ep.setValue(qe.a.widowControl,Jb.widowOrphanCheckboxProps.checked);(null===(yc=this.UA)||void 0===yc?0:yc.pha)&&Jb.keepTogetherCheckboxProps&&
this.Ep.setValue(qe.a.keepTogether,Jb.keepTogetherCheckboxProps.checked);lI(this.GAa,this.GAa);lI(this.Ep,this.GAa);Jb="";Vb=this.ota;ac=this.Ep;if(yc=oI(Vb,ac))yc=ac.hasProperty(vd.a.pTa)&&ac.hasProperty(vd.a.oTa);yc?(yc=ac.getValue(vd.a.pTa),Kc=ac.getValue(vd.a.oTa),yc=(new Iq.a(Kc,yc)).Ft,Vb=mI(ac)+nI(ac)+Vb.getValue(Cc.a.marginRight)+Vb.getValue(Cc.a.marginLeft)+yc+Wa.App.uza<=Vb.getValue(Cc.a.Ao)):Vb=oI(Vb,ac)?mI(ac)+nI(ac)+Vb.getValue(Cc.a.marginRight)+Vb.getValue(Cc.a.marginLeft)+Wa.App.uza<=
Vb.getValue(Cc.a.Ao):!0;Vb?XF(this.GAa,this.Ep,this.Mhm(this.tRe?this.tRe.G3b():{})):Jb=""!==Jb?Jb:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==Jb?this.vHa(Jb,this.Mxn):2===qb&&(bf.c(Nc.a.yjc,!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Qb(Nc.a.yjc,2,null))}};this.GAa=b.clone();this.Ep=b.clone();this.ota=k.clone();this.x6=t;this.ga=D;this.tRe=new sD;this.UA=P;b=this.tRe.w5l(this.Ep);k=fC("Inch",3,-11,22,.1);t=fC("Inch",3,0,22,.1);var ca=fC("Centimeter",
1,-27.94,55.88,1);D=fC("Centimeter",1,0,55.88,1);var ta=fC("Character",2,-316.8,316.8,.5);P=fC("Character",2,0,316.8,.5);k=[k,ca,ta];D=[t,D,P];t=NG();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};ca=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,
Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];ta=["1","2","3","6","7"];let Na=5;P=this.Ep.hasProperty(vd.a.lw)?this.Ep.getValue(vd.a.lw):0;if(10===P||9===P)P=11;if(w.AFrameworkApplication.lcid===Xj.a.og("AR-SA").LCID||11===P)b.isKashidaSupported=!0,ca[Na]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,ta[Na]="11",Na=6;if(w.AFrameworkApplication.lcid===Xj.a.og("TH-TH").LCID||13===P)b.isThaiSupported=!0,ca[Na]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,ta[Na]="13";ca={["type"]:"AppComboBoxProps",
["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:$F(ca,ta),["allowFreeForm"]:!1};kI(P)?ca.selectedKey=P.toString():ca.defaultSelectedKey="";b.alignmentComboBoxProps=ca;if(this.UA.JFa||this.UA.XIa||this.UA.pha)b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"};
this.UA.JFa&&(P={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:iM(this.Ep)},b.keepWithNextCheckboxProps=P);this.UA.XIa&&(P={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:jM(this.Ep)},b.widowOrphanCheckboxProps=P);this.UA.pha&&(P={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,
["checked"]:kM(this.Ep)},b.keepTogetherCheckboxProps=P);b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};ca=gM(this.Ep);P="0"===ca;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:$F([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,
Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:ca,["allowFreeForm"]:!1};ta=Wa.App.yha;ca=0;({Ujc:ca,G7a:ta}=OG(this.Ep,vd.a.pTa,vd.a.oTa,P));D={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Ef.a.d_a(ta),["validUnits"]:D,["numberFormatInfo"]:t};
D=this.nOb(ca,D);b.bySpinButtonProps=D;P=Wa.App.yha;D=0;({Ujc:D,G7a:P}=OG(this.Ep,vd.a.DGa,vd.a.CGa,!1));P={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Ef.a.d_a(P),["validUnits"]:k,["numberFormatInfo"]:t};P=this.nOb(D,P);b.beforeTextSpinButtonProps=P;P=Wa.App.yha;D=0;({Ujc:D,G7a:P}=OG(this.Ep,vd.a.Bmb,vd.a.Amb,!1));k={["type"]:"AppSpinButtonProps",
["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:Ef.a.d_a(P),["validUnits"]:k,["numberFormatInfo"]:t};k=this.nOb(D,k);b.afterTextSpinButtonProps=k;k={["id"]:"ParagraphDialog",["bodyControls"]:b};t={["type"]:"AppCheckboxInternalProps",["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:hM(this.Ep)};b.contextualSpacingCheckboxProps=
t;k.dialogButtonsOption=9;k.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions};k.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:"left",["margin-left"]:"0"}}};this.Wh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.Oxn,k)}Mhm(b){return this.tlh||(this.tlh=this.qbf(b))}qbf(b){var k,t,D;b[vd.a.lw.id.toString()]=Hm.AUm;b[vd.a.CGa.id.toString()]=Hm.EZi;b[vd.a.DGa.id.toString()]=Hm.EZi;b[vd.a.Amb.id.toString()]=
Hm.GZi;b[vd.a.Bmb.id.toString()]=Hm.GZi;b[vd.a.l5.id.toString()]=Hm.pfg;b[vd.a.oTa.id.toString()]=Hm.pfg;b[vd.a.pTa.id.toString()]=Hm.pfg;b[vd.a.G0c.id.toString()]=Hm.C4k;if(null===(k=this.UA)||void 0===k?0:k.JFa)b[qe.a.keepWithNext.id.toString()]=Hm.LUm;if(null===(t=this.UA)||void 0===t?0:t.XIa)b[qe.a.widowControl.id.toString()]=Hm.n1o;if(null===(D=this.UA)||void 0===D?0:D.pha)b[qe.a.keepTogether.id.toString()]=Hm.JUm;return b}nOb(b,k){k.value=isNaN(b)?"":b;return k}}Object(n.a)(pI,"WordReactParagraphDialog",
Wf.a,[]);class Qw extends Wf.a{constructor(b,k,t,D){super(!1,!1,!0);this.l_k=()=>{this.hJc.jKh(this.Xpi,this.ooe,this.YVc)};this.m_k=(P,ca)=>{ca&&1===P&&(ca.columnsCountSpinButtonProps&&this.iY.setValue(qe.a.RE,ca.columnsCountSpinButtonProps.value),ca.columnsWidthSpinButtonProps&&(P=ca.columnsWidthSpinButtonProps,this.iY.setValue(qe.a.eG,[Ef.a.xIa(P.value,Ef.a.ENa(P.unitType.toLowerCase()))])),ca.columnsSpacingSpinButtonProps&&(P=ca.columnsSpacingSpinButtonProps,this.iY.setValue(qe.a.hma,Ef.a.xIa(P.value,
Ef.a.ENa(P.unitType.toLowerCase())))),ca.columnsLineBetweenCheckboxProps&&this.iY.setValue(qe.a.separator,ca.columnsLineBetweenCheckboxProps.checked),this.p_k()&&(ca=Qw.zBd,this.wFk()?XF(this.Xpi,this.iY,this.f8b):ca=ca!==Qw.zBd?ca:Box4Intl.Box4Strings.l_ColumnsDialogFailMessage,this.dispose(),ca!==Qw.zBd&&this.vHa(ca,this.l_k)))};this.p_k=()=>this.iY.hasProperty(qe.a.RE)&&this.iY.hasProperty(qe.a.eG)&&this.iY.hasProperty(qe.a.hma)&&this.iY.hasProperty(qe.a.separator);this.NNd=(P,ca,ta)=>Math.floor((P-
(ca-1)*ta)/ca);this.Mnf=(P,ca,ta)=>1==ca?0:Math.floor((P-ca*ta)/(ca-1));this.pzk=(P,ca,ta,Na)=>{const qb=P/ca;ta<Qw.Tjc?(ta=Qw.Tjc,Na=this.Mnf(P,ca,ta)):ta>qb&&(ta=qb,Na=this.Mnf(P,ca,ta));return[ta,Na]};this.mzk=(P,ca,ta,Na)=>{const qb=(P-Qw.Tjc*ca)/(ca-1);0>Na?(Na=0,ta=this.NNd(P,ca,Na)):Na>qb&&(Na=qb,ta=this.NNd(P,ca,Na));return[ta,Na]};this.xIa=(P,ca)=>Ef.a.xIa(P,Ef.a.ENa(ca));this.mIc=(P,ca,ta,Na,qb)=>({["unitType"]:P,["unitPlaceholder"]:F.a.X9d(ca),["minValue"]:ta,["maxValue"]:Na,["step"]:qb});
this.Xpi=b.clone();this.iY=b.clone();this.ooe=k.clone();this.vmb=this.ooe.getValue(Cc.a.Ao)-this.ooe.getValue(Cc.a.marginLeft)-this.ooe.getValue(Cc.a.marginRight);this.pJb=Math.floor(this.vmb/Qw.Tjc);this.YVc=t;this.hJc=D;this.vg=Qw.id;b={};b.getUnitValue=3==Wa.App.yha?Ef.a.Ez:Ef.a.YTa;b.getCalculatedWidthValue=this.NNd;b.getCalculatedSpacingValue=this.Mnf;b.twipsFromValueAndUnits=this.xIa;b.adjustWidthForLimits=this.pzk;b.adjustSpacingForLimits=this.mzk;b.pageContentWidth=this.vmb;b.maxColumnCount=
this.pJb;b.columnsLabelProps={["type"]:"AppLabelProps",["id"]:"ColumnsSection",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogTitle,["forId"]:"ColumnsGroup"};b.columnsCountSpinButtonProps=this.UOl();b.columnsWidthSpinButtonProps=this.YOl();b.columnsSpacingSpinButtonProps=this.WOl();b.columnsLineBetweenCheckboxProps=this.VOl();b={["id"]:"ColumnsDialog",["bodyControls"]:b};this.Wh(Box4Intl.Box4Strings.l_ColumnsDialogTitle,this.m_k.bind(this),b)}UOl(){var b=[this.mIc("None",0,1,this.pJb,1)];const k=this.Stf(qe.a.RE);
b={["type"]:"AppSpinButtonProps",["id"]:"columnsCountSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogCount,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogCountAlt,["unitType"]:Ef.a.d_a(0),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.nOb(k,b)}YOl(){var b=[this.mIc("Inch",3,.5,Ef.a.Ez(this.vmb),.1),this.mIc("Centimeter",
1,1.27,Ef.a.YTa(this.vmb),1)];const k=Wa.App.yha,t=this.Stf(qe.a.eG);b={["type"]:"AppSpinButtonProps",["id"]:"columnsWidthSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogWidth,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogWidthAlt,["unitType"]:Ef.a.d_a(k),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.nOb(t,b)}WOl(){var b=
[this.mIc("Inch",3,0,Ef.a.Ez(this.vmb-2*Qw.Tjc),.1),this.mIc("Centimeter",1,0,Ef.a.YTa(this.vmb-2*Qw.Tjc),1)];const k=Wa.App.yha,t=this.Stf(qe.a.hma);b={["type"]:"AppSpinButtonProps",["id"]:"columnsSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacingAlt,["unitType"]:Ef.a.d_a(k),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,
["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.nOb(t,b)}VOl(){const b=this.iY.getValue(qe.a.separator);return{["type"]:"AppCheckboxInternalProps",["id"]:"columnsLineBetweenCheckbox",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetween,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetweenAlt,["checked"]:b}}get f8b(){return null!=this.iAg?this.iAg:this.iAg=(()=>this.qbf())()}qbf(){const b={};b[qe.a.RE.id.toString()]=b[qe.a.eG.id.toString()]=b[qe.a.hma.id.toString()]=
b[qe.a.separator.id.toString()]=br.o_k;return b}wFk(){const b=this.iY.getValue(qe.a.eG),k=this.iY.getValue(qe.a.RE),t=this.iY.getValue(qe.a.hma);let D=0;for(let P=0;P<k;P++)D+=b[0];if(k<=this.pJb&&(k-1)*t+D<=this.vmb)return!0;v.ULS.sendTraceTag(509723422,336,15,"Invalid inputs for Columns Dialog - does not fit in page content space.  Count: {0}, Width: {1}, Spacing: {2}",k,b[0],t);return!1}Stf(b){if(this.iY.hasProperty(b)){if(b==qe.a.RE)return this.iY.getValue(b);if(b==qe.a.eG){var k=Wa.App.yha;b=
this.iY.getValue(qe.a.hma);const t=this.iY.getValue(qe.a.RE);return Ef.a.b8a(this.NNd(this.vmb,t,b),k)}if(b==qe.a.hma){if(1==this.iY.getValue(qe.a.RE))return 0;k=Wa.App.yha;b=this.iY.getValue(b);return Ef.a.b8a(b,k)}}return 0}nOb(b,k){k.value=isNaN(b)?Qw.zBd:b;return k}}Qw.id="ColumnsDialog";Qw.zBd="";Qw.Tjc=720;Object(n.a)(Qw,"WordReactColumnsDialog",Wf.a,[]);class qI{E7k(b){new CE(b,Fa.a.instance.resolve("Box4.IFeatureHelper"))}yal(b,k){new gI(b,k,Fa.a.instance.resolve("Box4.IFormattingReader"),
Fa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Wk.PageNavigator.instance)}Nql(b,k,t){new hI(b,k,t)}uLh(b,k,t){new Xz(b,k,t,Fa.a.instance.resolve("WordEditor.IPageCommands"),Fa.a.instance.resolve("Common.IStandaloneRootController").Zca)}YLh(b,k,t){new Kt(b,k,t,Fa.a.instance.resolve("WordEditor.IPageCommands"),Fa.a.instance.resolve("Common.IStandaloneRootController").Zca)}jKh(b,k,t){new Qw(b,k,t,Fa.a.instance.resolve("WordEditor.UI.IDialogFactory"))}b7k(b){return new RD(b)}MGd(b,k,t,D){new pI(b,
k,t,w.AFrameworkApplication.va,D)}Oil(){const b=Fa.a.instance.Na("Box4.IRoamingServiceRequestManager");null==b?Jc.b(524834398,3018,10,"Roaming service not resolved."):new YH(b)}Sil(b,k){new ZH(b,k)}udf(b){return new $H(b)}}Object(n.a)(qI,"DialogFactory",null,[562,563]);class uF extends Wf.a{constructor(b,k){super(!1,!1,!0);this.zSh="DoNotCheckSpellingCheckbox";this.OSh="DocumentChoiceGroup";this.ygd=0;this.EDi="LanguageList";this.documentContext="DocumentContext";this.dr="RangeContext";this.Eho=(t,
D)=>{const P=Hi.a.instance.zp(Pb.a.Pkj);if(1!==t)P.properties.Z("canceled","true");else{t=D[this.EDi].replace(uF.ztg,"");var ca=parseInt(t),ta=Boolean.parse(D[this.zSh]);D=D[this.OSh];D===this.documentContext?this.fnd.wfo(ca,ta):this.fnd.Hko(ca,ta);P.properties.Z("PreviousLCID",this.ygd.toString());P.properties.Z("ChangedLCID",ca.toString());P.properties.Z("NoProof",ta.toString());this.Q2g.Dho(ca,this.ygd);bf.d(Pb.a.Pkj,!0,void 0,void 0,void 0,void 0,[Object.assign(new na.a,{name:"SelectedLcid",string:t}),
Object.assign(new na.a,{name:"NoProof",string:ta.toString()}),Object.assign(new na.a,{name:"Context",string:D})]);Wa.App.ya.updateCommandUI(!0)}P.end()};this.Q2g=k;this.fnd=b}ieg(){const b=Array(2);b[0]={["key"]:this.dr,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const k={showDocumentChoiceGroup:!0};k.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;k.documentChoiceGroupProps={["id"]:this.OSh,
["defaultSelectedKey"]:this.mSl(),["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.ygd=({$Hn:this.WZj}=this.fnd.L$l()).returnValue;k.languageListPropsProvider=this.XZl();k.spellingCheckboxProps={["id"]:this.zSh,["checked"]:!this.WZj,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};this.Wh(Box4Intl.Box4Strings.l_Language,this.Eho,{["id"]:"LanguageDialog",["bodyControls"]:k})}mSl(){return this.fnd.gf()?this.documentContext:this.dr}XZl(){return()=>
{let b,k;const t=({selectedIndex:b,ztj:k}=this.Q2g.WZl(this.ygd)).returnValue;for(let D=0;D<t.length&&D<k;D++)t[D].value=uF.ztg+t[D].value;return{["id"]:this.EDi,["items"]:t,["selectedLanguageIndex"]:b,["applyBorderIndex"]:k}}}}uF.ztg="recent-";Object(n.a)(uF,"ReactLanguageDialog",Wf.a,[561]);class rI extends sF{constructor(b,k,t,D){super(k,t);this.sZf=()=>{this.floatie.xm()};this.Jh=b;this.qI=D}Keb(b,k,t){if(b=super.Keb(b,k,t))b.agc=!0,b.O$d=!0,b.preventDismissOnScroll=!0;this.Jh.UYa(this.sZf);return b}eSc(b,
k,t=null){this.qI.bwh(()=>this.Keb(b,k,t))}B6d(){this.floatie.agc=!0}}Object(n.a)(rI,"ExternalContentFloatieInitializer",sF,[]);class sI{iLb(){vm.instance.xoa&&(Ai.instance.R7a([1,0]),vm.instance.R_d()&&Jt.instance.R7a([1]))}}Object(n.a)(sI,"RulerUser",null,[559]);class tI{constructor(){this.whitelistedControlIds=null}}Object(n.a)(tI,"StatusBarProps",null,[]);class vF{constructor(b,k,t=!0){this.bsd=!1;this.EOe=null;this.Nea=k.VG;this.USe=k.xuj;t?Tj.a.get_instance().Dk(7,()=>{this.kyh(b,k)}):this.kyh(b,
k)}kyh(b,k){window.setTimeout(()=>{pr.a.instance.ie(()=>{bk.UISurfaces.Lbm().then(t=>{const D=Object.assign(new tI,{whitelistedControlIds:k.whitelistedControlIds});t.initializeNewStatusBar(b,D,this.USe);this.EOe=t;this.bsd=!0;window.setTimeout(()=>{pr.a.instance.ie(()=>{const P=[];if(k.TG){const ca=k.TG;for(let ta in ca)P.push(appChrome.actions.updateControlHiddenState(ta,ca[ta]));appChrome.api.dispatch(P)}this.iLb()},"RSB:I2")},0);return null}).catch(()=>{v.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");
return null})},"RSB:I1");if(k.uqa&&b){vF.tXg||(w.AFrameworkApplication.va.qa($a.a.zuj,Ud.a.frame,Object(A.a)(this,this.Auj,"statusBarTabAction")),w.AFrameworkApplication.va.qa($a.a.yuj,Ud.a.frame,Object(A.a)(this,this.Auj,"statusBarTabAction")),vF.tXg=!0);const t=Kj.a.gWd(k.uqa,k.dkj,b,!1);t.OH=!0;this.Jgc(t,$a.a.zuj,$a.a.yuj)}},0)}iLb(){this.bsd&&this.Nea&&window.setTimeout(()=>{this.Nea(this.EOe.selectors.getStatusBarControlsMap(this.USe),7)},0)}dob(b,k){this.bsd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,
k))},0)}KU(b){this.bsd&&this.Nea&&window.setTimeout(()=>{const k=this.EOe.selectors.getStatusBarControlsMap(this.USe);if(k[b]){const t={};t[b]=k[b];this.Nea(t,7)}},0)}Jgc(b,k,t){const D=Zb.KeyInputManager.kc(pc.a.ww,0),P=Zb.KeyInputManager.kc(pc.a.ww,4);b.ir(D);b.ir(P);b.bindAction(D,k);b.bindAction(P,t)}Auj(){return 4}}vF.tXg=!1;Object(n.a)(vF,"ReactStatusBar",null,[]);class uI{constructor(){this.whitelistedControlIds=this.TG=this.VG=null;this.kTm=!1;this.dkj=this.uqa=this.xuj=null}}Object(n.a)(uI,
"ReactStatusBarInitOptions",null,[]);var SD=c(440);class vI{constructor(b,k,t,D,P){this.WXb=this.TLa=this.Ma=null;this.RAo=()=>{const ca=Wa.App.ya.Bp.getRegion(wg.AppFrame.uqa);ca&&ca.CNf()};this.Fnm=(ca,ta,Na,qb,Jb)=>{if(!Jb)return v.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),8;if(1===Na)return 32;Jb&&2===Jb.length&&this.TLa&&this.TLa.dob(Jb[0],Jb[0]);return 32};this.Sad=ca=>{Wa.App.ya.VG(ca)};this.ga=D;pr.a.instance.ie(()=>{this.Ma=P;this.WXb=
this.TLa=null;const ca={};w.AFrameworkApplication.Erj||(ca[SD.a.B7n]=!0);ca.GiveFeedback=!w.AFrameworkApplication.CF;this.Ma.$("OfficeOnlineInGallatinTextVisible")||(ca.CenterStatusLabel=!0);ca[SD.a.$Yi]=!0;this.Ma.$("WPMPackageIsEnabled")&&this.Ma.$("WPMStatusBarLabelIsEnabled")||(ca[SD.a.zpg]=!0);this.Ma.$("AddInCommandsIsEnabled")||(ca[SD.a.Prk]=!0);this.Ma.$("WordEditorShowOcsConnectionStatus")||(ca[SD.a.QRf]=!0);ca[SD.a.T1o]=!0;this.Ma.$("ReadingTimeIsEnabled")||(ca[SD.a.e6i]=!0);window.setTimeout(()=>
{this.dym(b,ca)},0)},"SBU:I")}Tb(){this.ga.fb(Pb.a.Dje,lc.a.application,this.Fnm,96)}dym(b,k){this.WXb=Fa.a.instance.Na("WordEditor.WordEditorReactCommandDefinitionMapping");const t={};for(const P in k){var D=k[P];t[this.Zsf(P)]=D}this.TLa=new vF(b,Object.assign(new uI,{TG:t,VG:this.Sad,kTm:!1,xuj:"WordEditorStatusBar",uqa:wg.AppFrame.uqa,dkj:this.RAo}))}Zsf(b){let k="";if(this.WXb){const t=this.WXb.Dpf(b);t&&0<t.count&&(k=t.J(0))}return k&&""!==k?k:b}iLb(){this.TLa&&this.TLa.iLb()}dob(b,k){this.TLa&&
this.TLa.dob(this.Zsf(b),k)}KU(b){this.TLa&&this.TLa.KU(this.Zsf(b))}dispose(){}}Object(n.a)(vI,"StatusBarUser",null,[557,9]);var wI=c(1058);class PG{constructor(b){this.ga=b;this.ga.qa($a.a.C4c,Ud.a.frame,Object(A.a)(this,this.C4c,"reportFileMenuPageSwitch"));this.ga.qa($a.a.Ebj,Ud.a.frame,Xc.ActionManager.Of)}C4c(b,k,t,D,P){this.ga.processAction(this.NUl(P[wI.a.Y8d]),2);return 32}}Object(n.a)(PG,"FileMenuSQMInformation",null,[915]);class xI extends PG{constructor(b){super(b);this.gTn()}gTn(){this.ga.qa($a.a.K6f,
Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.ybj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.L6f,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.zbj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.Abj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.M6f,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.Bbj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.Cbj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.Dbj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.dcj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.ecj,
Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.Hbj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.Ibj,Ud.a.frame,Xc.ActionManager.Of)}NUl(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return $a.a.K6f;case "tabHome":case "FileHomePage":return $a.a.ybj;case "menuJewelInfo":case "FileInfoPage":return $a.a.L6f;case "menuJewelNew":case "FileNewPage":return $a.a.zbj;case "menuJewelOpen":case "FileOpenPage":return $a.a.Abj;case "menuJewelPrint":case "FilePrintPage":return $a.a.M6f;case "menuJewelSaveAs":case "FileSaveAsPage":return $a.a.Bbj;
case "menuJewelShare":case "FileSharePage":return $a.a.Cbj;case "menuJewelTransform":case "FileTransformPage":return $a.a.Dbj}return $a.a.Ebj}}Object(n.a)(xI,"WordEditorFileMenuSQMInformation",PG,[]);var yI=c(1056);class QG{constructor(b){this.ga=b;this.ga.qa($a.a.D4c,Ud.a.frame,Object(A.a)(this,this.D4c,"reportTabSwitch"));this.ga.qa($a.a.Zbj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.acj,Ud.a.frame,Xc.ActionManager.Of)}D4c(b,k,t,D,P){this.ga.processAction(this.G9l(P[yI.a.phg]),2);return 32}}
Object(n.a)(QG,"RibbonSQMInformation",null,[873]);class zI extends QG{constructor(b){super(b);this.yVn()}yVn(){this.ga.qa($a.a.Qbj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.Sbj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa(Nc.a.O6f,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.Tbj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.Ubj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa(Nc.a.Vbj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa(Nc.a.Wbj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa(Nc.a.Xbj,Ud.a.frame,
Xc.ActionManager.Of);this.ga.qa(Nc.a.Ybj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa(Nc.a.P6f,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa(Nc.a.$bj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa($a.a.bcj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa(Nc.a.ccj,Ud.a.frame,Xc.ActionManager.Of);this.ga.qa(Nc.a.Rbj,Ud.a.frame,Xc.ActionManager.Of)}G9l(b){switch(b){case "tabAddins":case "Addins":return $a.a.Qbj;case "tabHome":case "Home":return $a.a.Tbj;case "tabInsert":case "Insert":return $a.a.Ubj;case "tabDeveloper":case "Developer":return $a.a.Sbj;
case "tabPageLayout":case "Layout":return Nc.a.Vbj;case "tabReferences":case "References":return Nc.a.Ybj;case "tabReview":case "Review":return Nc.a.P6f;case "tabView":case "View":return $a.a.bcj;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return Nc.a.$bj;case "tabMailings":case "Mailings":return Nc.a.Wbj;case "tabWordDesign":case "Design":return Nc.a.ccj;case "tabHelp":case "Help":return Nc.a.O6f;case "ctabPictureTools":case "Picture":return Nc.a.Xbj;
case "Copilot":return Nc.a.Rbj}return $a.a.acj}}Object(n.a)(zI,"WordEditorRibbonSQMInformation",QG,[]);class AI{constructor(b=null,k=null,t=null){this.TG=b||{};this.MAj=k||[];this.QAj=t||{}}}Object(n.a)(AI,"RibbonTrimmingProperties",null,[]);class BI{constructor(b,k,t){this.Hua=b;this.TG=k;this.oHf=t}}Object(n.a)(BI,"ReactRibbonJewelProperties",null,[]);class CI{constructor(){w.AFrameworkApplication.va.qa($a.a.HQa,Ud.a.frame,Object(A.a)(this,this.mNn,"reactFileMenuOpenFromTellMe"))}mNn(b,k,t,D,P){if(1===
t)return 32;w.AFrameworkApplication.Aha("54hi9858;4f638686");if(!P)return 32;b=P.SourceControlId;17!==P.UILocation||"New"!==b&&"Open"!==b||(P=[],Qg.d("setFileMenuSelectedPage")&&("New"===b&&w.AFrameworkApplication.ta?2===w.AFrameworkApplication.ta.Nb.Sl?P.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):P.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&w.AFrameworkApplication.ta&&(2===w.AFrameworkApplication.ta.Nb.Sl?P.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):
P.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),P.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(P));return 32}sEi(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}iSa(){return!1}L0i(){}iSh(){}}Object(n.a)(CI,"ReactFileMenu",null,[604]);class DI{$$e(){const b=new CI,k=[];k.push(appChrome.actions.updateFileMenuExpandedValue(!1));k.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(k);return b}}
Object(n.a)(DI,"ReactFileMenuFactory",null,[576]);class EE{constructor(b,k,t,D=!1){this.clc=b;this.z0g=this.clc.N2a;this.K5d=Fa.a.instance.Na("Common.IOfficeTrialExperience");this.hJb=Fa.a.instance.Na("Common.IMacOfficeOffer");EE.jue=!1;this.QNm=D;this.ga=k;this.Ub=t}get pc(){return this.ga}get xg(){return this.Ub}F1e(){return this.z0g&&!!this.K5d&&!!this.hJb}sUa(b,k){this.clc.No(()=>{v.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.z0g=!0;this.vif(b,k)});Fa.a.instance.Sa("Common.IOfficeTrialExperience").execute(t=>
{v.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.K5d=t;this.vif(b,k)});Fa.a.instance.Sa("Common.IMacOfficeOffer").execute(t=>{v.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.hJb=t;this.vif(b,k)})}vif(b,k){EE.jue||(this.F1e()?(v.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),b(this,k),EE.jue=!0):v.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}EE.jue=!1;Object(n.a)(EE,"RibbonDependencies",
null,[785]);class RG{constructor(b,k,t){this.rtb=b;this.ga=k;this.Ub=t}}Object(n.a)(RG,"WoncaRibbonUserFactory",null,[115]);class EI{constructor(b,k){this.wve=b;this.D_b=k}wob(b){this.wve.wob(b);this.D_b&&this.D_b.wob(b)}M6c(b){this.wve.M6c(b);this.D_b&&this.D_b.M6c(b)}Vad(b){this.wve.Vad(b);this.D_b&&this.D_b.Vad(b)}}Object(n.a)(EI,"RibbonCommandTrimmer",null,[114]);var lM=c(1230),mM=c(1146);class FI{constructor(b,k){this.Ma=b;this.kYb=k}wob(b){aa.a.ti&&6>aa.a.W1a&&(b.fseaInsertPicture=!0);this.Ma.$("InsertSymbolIsEnabled")||
(b.grpInsertSymbols=!0);this.Ma.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Ma.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=!0);XE.a.Kyi()||(b.InsertLoopComponentsForConsumers=!0);const k=this.Ma.$("InsertOnlinePictureEnabled"),t=w.AFrameworkApplication.LDf();k||(b.fseaInsertOnlinePicture=!0,b.fseaFlyInsertOnlinePictureFromSearch=!0);t?b.fseaInsertPictureFromOneDrive=!0:(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);t&&k?(b.fseaInsertOnlinePicture=
!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;w.AFrameworkApplication.MDf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=!0);w.AFrameworkApplication.Jlc&&(b.btnOpenInClient=!0);w.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&w.AFrameworkApplication.K.$("DisablePrint")&&this.Klc(b)}M6c(b){b.menuJewel=!0;w.AFrameworkApplication.CF||(b.jbtnGiveFeedback=!0)}Klc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=
!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}Vad(b){delete b.menuJewel;w.AFrameworkApplication.privacyUrl||(b.jbtnPrivacy=!0);w.AFrameworkApplication.A4c||(b.jbtnReportAbuse=!0);w.AFrameworkApplication.ale||(b.jbtnTermsOfUse=!0);w.AFrameworkApplication.GLd||(b.jbtnFileSharing=!0);w.AFrameworkApplication.vnb||(b.jbtnShareRWC=!0);w.AFrameworkApplication.Bjf||w.AFrameworkApplication.rng||(b.jbtnVersion=!0);this.kYb.K5d&&this.kYb.K5d.Chn||(b.btnjTryOffice=
!0,b.btnjTryOfficeForWordEditor=!0);this.kYb.hJb&&this.kYb.hJb.tqo||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);w.AFrameworkApplication.Jlc?(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[Wa.App.es?"btnjOpenInClient":"btnjEditInClient"]=!0;w.AFrameworkApplication.mLo&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=!0,b.jbtnDownloadAsOdt=!0);w.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&w.AFrameworkApplication.K.$("DisablePrint")?this.Klc(b):w.AFrameworkApplication.K.$("DirectPrintIsEnabled")?
b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;w.AFrameworkApplication.JG&&(this.Klc(b),b.faShare=!0);if(w.AFrameworkApplication.protectFile||aa.a.uQa||!w.AFrameworkApplication.eRc&&!w.AFrameworkApplication.sjf&&!w.AFrameworkApplication.png)b.jbtnFileEmbed=!0;lM.a.vum()||(b.btnjClose=!0);w.AFrameworkApplication.IHb?(b.jbtnVersion=!0,v.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):w.AFrameworkApplication.Q_d()||(b.btnjVersionHistory=!0);b.jbtnVersion&&
b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);w.AFrameworkApplication.P2f||(b.faOpen=!0);b.jbtnFileSharing&&b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Ma.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=
!0);const k=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Tzi;if(b.faOpen&&b.faNew||!k)b.faHome=!0;if(w.AFrameworkApplication.JK||".ODT"===Wa.App.xLc.toUpperCase()||!w.AFrameworkApplication.K.$("WordEditorAppsForOfficeRibbonIsEnabled")||!mM.a.bAd||w.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled"))b.faGetAddinsFromBackstage=!0}}Object(n.a)(FI,"WoncaCommandTrimmer",null,[114]);var nM=c(998);c(435);var oM=c(1057),pM=c(1145);class GI{constructor(b,k){this.e2=this.fK=null;
this._clientId=b;this.daa=k}Vul(){if(!Hf.c(this.e2))return this.e2;this.Ihf();this.e2.style.display="block";this.daa&&this.daa.VZ(Object(A.a)(this,this.onResize,"onResize"));return this.e2}onResize(){this.rya()}rya(){this.phf()?(document.getElementById("application").style.minWidth="0px",(new pM.a(this.e2,null,w.AFrameworkApplication.isRtl)).A9n(this.e2)):w.AFrameworkApplication.ta.Nb.oJ||oM.a.B9n(this.e2,w.AFrameworkApplication.isRtl)}phf(){return w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("EnhancedMobileViewIsEnabled"):
!1}Ihf(){if(Hf.c(this.fK)){var b;({MQc:b}=Kj.a.V$c(!w.AFrameworkApplication.IX)).returnValue?(this.fK=qD.a("div"),this.fK.className=Kj.a.pxl,this.fK.id=ln.CuiHelper.cLd,b.appendChild(this.fK),this.Bhf(),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.E8&&!w.AFrameworkApplication.IX&&this.Chf(),this.Uul()):w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("ReactHeaderCrashLogs")&&v.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}Uul(){Hf.c(this.e2)&&
(this.e2=qD.a("div"),this.e2.className=Kj.a.Kjg,this.e2.style.display="none",this.fK.appendChild(this.e2))}Bhf(){Sys.UI.DomElement.addCssClass(this.fK,Kj.a.qxl);w.AFrameworkApplication.isRtl&&qD.b(this.fK,"cui-rtl")}Chf(){Sys.UI.DomElement.addCssClass(this.fK,"FlexBoxLayout")}}Object(n.a)(GI,"HeaderSkeleton",null,[]);var FE=c(619);class SG{constructor(){this.Wnc=null}iNo(){this.Wnc||(this.Wnc=Fa.a.instance.Na("Common.App.AccountSwitching.IAccountSwitching"))||v.ULS.sendTraceTag(589050651,1300,10,
"Unable to resolve IAccountSwitching")}nJl(){this.iNo();return this.Wnc?this.Wnc.getCustomAuthConfig():null}static JGm(){return w.AFrameworkApplication.K.$("UiHostSupportsCustomAuthConfig")}}Object(n.a)(SG,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class TG{constructor(){this.iIb=this.cultureName=null}}Object(n.a)(TG,"HeaderCultureInfo",null,[]);var aG=c(1611);class HI{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(n.a)(HI,"SearchInitializationSettings",
null,[]);var GE=c(291);class II{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(n.a)(II,"DocumentTitleAppProps",null,[]);class JI{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=
this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(n.a)(JI,"DocumentTitleCalloutAppProps",null,[]);class KI{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=
this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=
this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(n.a)(KI,"HeaderAppProps",null,[]);class LI{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(n.a)(LI,"HeaderControls",null,[]);class MI{constructor(){this.command=this.label=null}}Object(n.a)(MI,"WorkflowButtonAppProps",null,[]);var bG;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.insufficientPermission=2]="insufficientPermission";
b[b.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";b[b.editorsPresent=4]="editorsPresent";b[b.notSupported=5]="notSupported"})(bG||(bG={}));Object(n.b)("RenameDisableReason",bG);class NI{constructor(b=""){this.r9f=this.documentTitleAppProps=this.xpg=null;this.Jjk=""!==b?b:Ye.a.n5}D8l(b){const k=Fa.a.instance.Na("Common.IExternalUICommandDefinitionMapping").BDb(b);if(k&&0<k.length)return k[0].externalUxCommand;v.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",
b));return null}Bvf(){if(!this.xpg){const b=FE.a();if(b){const k=this.D8l(b.command);k&&(this.xpg=Object.assign(new MI,{command:k,label:b.label}))}}return this.xpg}CQl(){return Object.assign(new LI,{workflowButton:this.Bvf()})}Hln(){Tj.a.get_instance().XH(17)}onMove(){const b={};b.MoveButtonClickedTime=new Date;w.AFrameworkApplication.va.Qb($a.a.yJb,2,b)}a9l(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;
case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}cTl(){let b=null,k=null;var t=Fa.a.instance.Na("Common.IRenameProps");t?(t=t.Dei(),0!==t&&(b=this.a9l(t),k=bG[t])):v.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new JI,{breadcrumbBrandName:w.AFrameworkApplication.ps.breadcrumbBrandName,breadcrumbBrandUrl:w.AFrameworkApplication.ps.breadcrumbBrandUrl,breadcrumbFolderName:w.AFrameworkApplication.ps.breadcrumbFolderName,breadcrumbFolderUrl:w.AFrameworkApplication.ps.breadcrumbFolderUrl,
hideDocumentTitleInput:w.AFrameworkApplication.ta.Nb.Hqm,isVersionHistoryEnabled:this.Kro(),documentExtension:F.a.zga(w.AFrameworkApplication.fileName),isMoveEnabled:32===w.AFrameworkApplication.va.processAction($a.a.yJb,1),onMove:Object(A.a)(this,this.onMove,"onMove"),message:b,renameDisableReason:k,openBreadcrumbsInNewTab:w.AFrameworkApplication.K.$("OpenLinksInNewWindow")})}r7h(){if(!this.documentTitleAppProps){const b=w.AFrameworkApplication.ps.Zy;this.documentTitleAppProps=Object.assign(new II,
{documentTitle:w.AFrameworkApplication.ZId?b:F.a.cJ(b),onFirstRender:Object(A.a)(this,this.Hln,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(A.a)(this,this.cTl,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}Kro(){return!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.SAi}rpo(){return!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.RAi}rro(){const b=!FE.b()&&!w.AFrameworkApplication.hideHeader&&!w.AFrameworkApplication.Cxf&&(w.AFrameworkApplication.K.$("SkypeWebControlIsEnabled")||
w.AFrameworkApplication.K.$("TeamsChatIsEnabled"));v.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}J4k(b){appChrome.getHeaderApi().then(k=>{k.setNavBarData(b.result);return null});v.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}tSn(b=!1){appChrome.getHeaderApi().then(k=>{const t=Fa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");k.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});k.setHeaderCommandHandler("OnFullyLoaded",
()=>{this.onFullyLoaded()});k.setHeaderCommandHandler("OnFlexPaneOpen",D=>{t.onFlexPaneOpen(D)});k.setHeaderCommandHandler("OnFlexPaneClose",D=>{t.onFlexPaneClose(D)});k.setHeaderCommandHandler("SetCookie",D=>Mb.a.set(D.cookieName,D.value));k.setHeaderCommandHandler("GetCookie",D=>this.EQl(D));k.setHeaderCommandHandler("QueryWorkflowButtonSettings",Object(A.a)(this,this.Bvf,"getWorkflowButtonAppProps"));b||(k.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(A.a)(this,this.r7h,"getDocumentTitleAppProps")),
k.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.Iln();return null}));aG.a.$Zd()&&k.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(A.a)(this,this.nfi,"getSearchInitializationSettings"))})}Iln(){Fa.a.instance.Sa("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>{b.iqb(!1,w.AFrameworkApplication.va.mode)})}EQl(b){b=Mb.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}vcm(){return GE.AppChromeOverrideUtilities.isEnabled?GE.AppChromeOverrideUtilities.cRd("suiteux-shell",
!1):this.Jjk+w.AFrameworkApplication.Fia+"suiteux-shell"}onFirstRender(){Fa.a.instance.Sa("Common.App.O365Shell.IO365ShellActor").execute(b=>{b.noo.continueWith(Object(A.a)(this,this.J4k,"continueShellServiceDataAsync"),3)});Tj.a.get_instance().XH(15)}onFullyLoaded(){Tj.a.get_instance().XH(16)}xna(b=!1){a:{try{var k=Xj.a.og(w.AFrameworkApplication.lcid);if(k){var t=Object.assign(new TG,{cultureName:k.name,iIb:k.iIb});break a}}catch(D){v.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+
w.AFrameworkApplication.lcid.toString())}t=Object.assign(new TG,{cultureName:"en-us",iIb:"en"})}k=Fa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");t=Object.assign(new KI,{appName:CommonUIStrings.l_AppNameShort,culture:t.cultureName,language:t.iIb,isConsumer:!w.AFrameworkApplication.ung,showAppLauncher:FE.h(),showMeControl:FE.g(),hideUserName:w.AFrameworkApplication.aVd,defaultDocumentTitleToLeft:w.AFrameworkApplication.OOh,assetsContainerOverride:this.vcm(),controls:this.CQl(),
documentTitleAppProps:b?null:this.r7h(),showDocumentTitleControl:!b,showWorkflowButton:!!this.Bvf(),showChatControl:this.rro(),showGoPremiumControl:FE.i(),showDiscoverPremiumButton:FE.f(),enableSearchControl:aG.a.RPm(),onFlexPaneOpen:Object(A.a)(k,k.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(A.a)(k,k.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.rpo(),testTraffic:w.AFrameworkApplication.K.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(A.a)(this,this.onFirstRender,
"onFirstRender"),onFullyLoaded:Object(A.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:w.AFrameworkApplication.spo()});!w.AFrameworkApplication.zmc||w.AFrameworkApplication.Peg?(t.userDisplayName=w.AFrameworkApplication.userName,t.emailAddress=w.AFrameworkApplication.K.jb("UserPrincipalName"),t.userID=w.AFrameworkApplication.K.jb("Puid")||"",t.signOutLink=w.AFrameworkApplication.Peg):w.AFrameworkApplication.signInUrl&&(t.signInLink=w.AFrameworkApplication.signInUrl);aG.a.$Zd()&&
(k=this.nfi(),t.loadTellMeResources=k.loadTellMeResources,t.getTokenRequestDictionary=k.getTokenRequestDictionary,t.enableVanillaSearchBox=w.AFrameworkApplication.K.$("VanillaSearchUxInHeaderIsEnabled"),t.userRing=k.userRing);SG.JGm()&&(k=new SG,t.shellAuthProviderConfigPromise=Object(A.a)(k,k.nJl,"getAccountSwitchingConfig"));this.tSn(b);return t}nfi(){if(!this.r9f){const b=new aG.a;let k=w.AFrameworkApplication.K.jb("Microsoft365Ring");k&&k.length||(k="generalAudience");this.r9f=Object.assign(new HI,
{loadTellMeResources:b.NZm(),getTokenRequestDictionary:Object(A.a)(b,b.Fem,"getTokenRequestDict"),userRing:k})}return this.r9f}}Object(n.a)(NI,"ReactSharedHeaderPropsHelper",null,[1094]);class UG{constructor(){this.label=this.value=null}}Object(n.a)(UG,"TextInfoSectionField",null,[]);var wF=c(934),qM=c(1205);class VG{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(n.a)(VG,"CommandDefinition",null,[]);class OI{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=
this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(n.a)(OI,"CommandDefinitionMapping",null,[]);const rM=b=>Object.assign(new OI,{getCommandByExternalUxId:k=>{const t=b.getCommandByExternalUxId(k);return t?Object.assign(new VG,{commandId:parseInt(t.commandId),externalUxCommand:t.externalUxCommand}):Object.assign(new VG,{externalUxCommand:k})},getDoNothingCommand:()=>parseInt($a.a.Hg),addCommandToMaps:Object(A.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(A.a)(b,b.addIconToMap,
"addIconToMap"),addTabToMap:Object(A.a)(b,b.addTabToMap,"addTabToMap")});var sM=c(1374);class PI{}Object(n.a)(PI,"RibbonInitState",null,[]);var QI=c(411),tM=c(1317);class RI{constructor(){}flatten(b){const k=[];for(const t of b)k.push.apply(k,t);return k}}Object(n.a)(RI,"ReactAsyncDispatcher",null,[]);var uM=c(1652);class SI{constructor(b,k){this.djk=b;this.vYj=k}}Object(n.a)(SI,"ReactExecuteCommandContext",null,[]);class yy{}yy.Trigger="FontTrigger";yy.Name="FontName";yy.Action="FontAction";yy.Level=
"FontLevel";yy.IsPinned="FontIsPinned";Object(n.a)(yy,"FontPickerLogProperties",null,[]);class TI{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb=null,Vb=null){this.zZ=null;this.pfh=!1;this.tze=[];this.ugd=-1;this.Xvd=!1;this.okk=0;this.Tpc=null;this.Zah=!1;this.Yfd=null;this.zea=b;this.Sbb=k;this.ZPe=Object(Ka.a)(876,b);this.Pl=t;this.Ub=D;P&&(this.zZ=new uM.a(P,D));this.Fgk=ca;this.L1j=ta;this.Hp=Jb;this.ga=Na;this.Iub={};this.Ma=qb;this.zvg=Vb;qb&&(qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",
!1)||qb.$("EnqueueTasksWhenTaskMgrIsYielding"))&&Tk.a.instance.mAd.CWR(()=>this.pfh=!0);qb&&(b=this.Ma.jb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({Wu:this.Tpc}=G.d(b));this.Tpc||(this.Tpc={})}get ofe(){return!!window.appChrome&&!!appChrome.selectors}hgj(){-1!==this.ugd&&window.clearTimeout(this.ugd);this.ugd=window.setTimeout(()=>{for(this.ugd=-1;0<this.tze.length;){if(wb.a.instance.Fv){this.hgj();break}const b=this.tze.shift();b&&this.executeCommand(b.djk,b.vYj)}},0)}executeCommand(b,
k){if(wb.a.instance.Fv){if(this.pfh){this.tze.push(new SI(b,k));this.hgj();return}v.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",b,k.modelType,ib.a.toJSON(k.payload));if(this.Ma.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(k){const t=this.Pl.getCommandByExternalUxId(b),D=k.modelType;this.zvg&&this.zvg.c0m(b,k);t?this.ewl(b,
t,D,k):this.fwl(b,D,k);this.hUk(k);this.h8m(b,k)}}fwl(b,k,t){switch(k){case "GalleryModel":case "PreviewGalleryModel":this.hXh(t,b);break;case "ButtonModel":this.$vl(t,b)}}sVo(b,k,t,D,P){if(t.payload)switch(t.payload.type){case "CoauthorMenuPayload":b.MenuItemId=t.payload.coauthorId;break;case "ButtonPayload":b.MenuItemId=k.menuItemId;b.CommandValueId=t.payload.commandValueId;b.TerminalParentControlId=t.payload.terminalParentControlId;this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",
!1)?(k=!0,Hf.c(t.payload.dismissHostingSurfaceOnExecute)||(k=t.payload.dismissHostingSurfaceOnExecute),k&&this.l3()):this.l3();break;case "ButtonPreviewPayload":b.MenuItemId=k.menuItemId;b.CommandValueId=t.payload.commandValueId;P=k.commandPreviewId;break;case "ButtonRevertPreviewPayload":b.MenuItemId=k.menuItemId;b.CommandValueId=t.payload.commandValueId;P=k.commandRevertId;break;default:b.MenuItemId=k.menuItemId}else b.MenuItemId=k.menuItemId;b.SourceControlId=D;return P}tVo(b,k,t){if(k.payload)switch(k.payload.type){case "MenuOpenPayload":b=
this.Pl.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.Pl.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":t.CommandId=k.payload.executedControl;t.ControlId=k.payload.executedControl;t.ParentControlId=k.payload.parentControl;t.CloseAllMenus=!0;this.l3();break;case "TellMeSearchResultChangePayload":t.Value=k.payload.searchText;break;case "SmartLookupPayload":t.CommandValueId=k.payload.selectionContextJson}return b}ewl(b,
k,t,D){var P=this.YBn(D,t),ca=k.commandId;const ta={},Na={};switch(t){case "SplitButtonModel":if(this.lQc(D.payload,Object(A.a)(this,this.vWo,"updateSplitButtonMenuState"),P))return;ta.MenuItemId=k.menuItemId;this.Kbg(D,ta);break;case "StatefulSplitButtonModel":if(this.lQc(D.payload,Object(A.a)(this,this.BWo,"updateStatefulSplitButtonMenuState"),P))return;t=D.payload.statefulData;P=D.payload.statefulMode;"color"===P?ta.Color=t:"icon"===P&&(t=this.Pl.getCommandByExternalUxId(t))&&(ta.MenuItemId=t.menuItemId);
break;case "FileMenu":ta.MenuItemId=k.menuItemId;ta.SourceControlId=b;D.payload&&"FileMenuPageSwitchPayload"===D.payload.type&&this.plm(ca,D.payload,b);break;case "TellMe":ca=this.tVo(ca,D,ta);ta.SourceControlId=b;ta.Location=D.payload.location;break;case "ButtonModel":D.payload&&"TabSwitchPayload"===D.payload.type?this.inm(ta,D):ca=this.sVo(ta,k,D,b,ca);break;case "CompoundButtonModel":ta.MenuItemId=k.menuItemId;ta.CommandValueId=D.payload.commandValueId;ta.SourceControlId=b;this.Kbg(D,ta);this.l3();
break;case "ToggleButtonModel":case "InkButtonModel":ta.MenuItemId=k.menuItemId;ta.SourceControlId=b;this.Kbg(D,ta);this.l3();break;case "FontPickerModel":switch(D.payload.type){case "MenuOpenPayload":ca=this.Pl.getCommandByExternalUxId("FontPickerMenuOpen").commandId;ta[Sf.a.FontPickerId]=D.payload.launcherId;break;case "MenuClosePayload":ca=this.Pl.getCommandByExternalUxId("FontPickerMenuClose").commandId;ta[Sf.a.FontPickerId]=D.payload.launcherId;break;case "FontPickerFontSelectedPayload":t=D.payload.font;
P=null;"string"===typeof t?(P=uq.FontUtils.oRa(t),ta.CommandValueId=P,P=uq.FontUtils.JGd(P)):(t.data?(ta.CommandValueId=t.data.fontToApply,ta.MenuItemId=t.data.themeIndex,ta[Sf.a.Formatting]=t.data):ta.CommandValueId=t.name,P=t);ta.SourceControlId=b;ta[Sf.a.RequestUpdateMru]=P;Na[yy.Name]=D.payload.nameToLog?D.payload.nameToLog:"string"===typeof t?uq.FontUtils.LXd(t)?"*"+t:uq.FontUtils.LCf(t)?"[EF]":"[MF]":"";Na[yy.IsPinned]=D.payload.isPinned;Na[yy.Level]=D.payload.level;this.oKf();break;case "FontPickerFontInfoRequestedPayload":ta.CommandValueId=
D.payload.font.name;ta[Sf.a.Trigger]=D.payload.trigger;Na[yy.Trigger]=D.payload.trigger;Na[yy.Name]=D.payload.nameToLog;this.oKf();break;case "FontPickerFontPinningPayload":t=D.payload.isPinned;ta.CommandValueId=D.payload.fontKey;ta[Sf.a.IsPinned]=t;Na[yy.Name]=D.payload.nameToLog;Na[yy.Action]=t?"pin":"unpin";Na[yy.Level]=D.payload.level;this.oKf();break;default:return}break;case "ComboBoxModel":var qb=D.payload.type;switch(qb){case "MenuOpenPayload":case "MenuPopulatePayload":this.mjc(D.payload.launcherId,
P)&&(ca={},ca[D.payload.launcherId]=t,this.Sbb.l1c(ca,Qg.g(D.payload)),this.Iub[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":t=D.payload.newValue;if(!t)return;t.value?(ta[Vl.a.Value]=t.value,ta[Vl.a.IsFreeForm]=!0):(ta[Vl.a.Value]=t.text,ta.MenuItemId=t.key,ta.CommandValueId=t.commandValueId);"ComboBoxPreviewPayload"===qb&&(ca=k.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":ca=k.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(D.payload.type){case "ZeroTermContextMenuClosePayload":t=
ib.a.EO(D.payload);for(qb of t)ta[qb]=D.payload[qb];break;default:this.lQc(D.payload,Object(A.a)(this,this.WSo,"updateFlyoutAnchorMenuState"),P),ta.launcherId=D.payload.launcherId}break;case "InkFlyoutAnchorModel":this.lQc(D.payload,Object(A.a)(this,this.UTo,"updateInkFlyoutAnchorMenuState"),P);ta.launcherId=D.payload.launcherId;break;case "ColorPickerModel":switch(D.payload.type){case "ColorPickerPayload":ta[Hd.Color]=D.payload.selectedColorId;ta.colorRGB=D.payload.color;break;case "ColorPickerPreviewPayload":ca=
k.commandPreviewId;ta[Hd.Color]=D.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":ca=k.commandRevertId;break;default:return}break;case "SpinButtonModel":ta[Dh.a.Number]=D.payload.value;ta[Dh.a.UnitType]=Ef.a.ENa(D.payload.unitType.toLowerCase());ta[Dh.a.Text]=D.payload.reservedValue;break;case "SliderModel":ta[Nj.Value]=D.payload.value;break;case "InsertTableModel":ta[Bl.a.Rows]=D.payload.rows;ta[Bl.a.Columns]=D.payload.columns;break;case "CheckboxModel":ta[kg.a.On]=D.payload.checked;
ta.MenuItemId=k.menuItemId;ta.TerminalParentControlId=D.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.lQc(D.payload,Object(A.a)(this,this.FVo,"updatePreviewGalleryMenuState"),P)){ta.launcherId=D.payload.launcherId;break}this.hXh(D,b);return;case "DocumentTitleModel":switch(D.payload.type){case "DocumentTitleRenamePayload":ta.getNewDocumentTitle=D.payload.getNewDocumentTitle;break;case "MenuOpenPayload":ca={};ca[D.payload.launcherId]=t;this.Sbb.l1c(ca,Qg.g(D.payload));this.Iub[b]=
new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":ta.MenuItemId=D.payload.url;this.e1m(D.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":ta.MenuItemId=D.payload.assetId;ta.SourceControlId=b;w.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&(ta.IsPremium=D.payload.isPremium||!1);this.f1m(D.payload.pageId);break;case "CoauthorGallery":ta.RenderTime=D.triggerTime;break;case "PeopleWell":ta.RenderTime=
D.triggerTime;break;case "SyncStatus":ta.SourceControlId=b;break;case "InputBoxModel":ta.Text=D.payload.newValue;break;case "PersonaButtonModel":ta.CommandValueId=D.payload.commandValueId;this.qmm(D.payload);break;case "MultiActionButtonModel":ta.CommandValueId=D.payload.commandValueId;ta.Href=D.payload.href;ta.Type=D.payload.type;ta.TerminalParentControlId=D.payload.terminalParentControlId;this.l3();break;default:return}ca&&!this.isShadowMenuOpen(D.payload)&&(ta.CommandValueId||(ta.CommandValueId=
ta.MenuItemId),k.legacyControlId&&(ta.LegacyId=k.legacyControlId),ta.SourceControlId||(ta.SqmControlId=b),this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&ta.launcherId&&(k=this.Pl.getCommandByExternalUxId(ta.launcherId))&&(ta.launcherCommandId=parseInt(k.commandId)),D.payload&&!Hf.c(D.payload.PRIReadinessCheck)&&(ta.PRIReadinessCheck=D.payload.PRIReadinessCheck,this.Zah=!0),D.payload&&!Hf.c(D.payload.shouldTakeFocus)&&(ta[Dx.a.fTa]=D.payload.shouldTakeFocus),
k=this.NYe(D,ta),Hf.c(D.triggerTime)||(Na.TriggerTime=D.triggerTime),D.payload&&!Hf.c(D.payload.userActionKey)&&(Na.userActionKey=D.payload.userActionKey),this.aag(Na,D,b,ca),this.ZPe.executeCommand(ca,ta,this.getSelectedTabId(),k,!0,()=>{this.zNf(ta,b)},Na,Qg.g(D.payload)))}aag(b,k,t,D){if(this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&t&&D&&k.payload){const P=!Hf.c(k.payload.launcherId);t=this.ofj(this.w3l(P?k.payload.launcherId:t,
D),D,!1);b.ControlId=t;const ca=k.payload.inputMethod;Hf.c(ca)||this.k0m(1===ca,2===ca||3===ca||4===ca,P||"TabSwitchPayload"===k.payload.type,t)}this.Ma&&this.Ma.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&k.payload&&"terminalParentControlId"in k.payload&&(b.TerminalParentControlId=this.ofj(k.payload.terminalParentControlId,D,!0))}k0m(b,k,t,D){this.Yfd||(this.Yfd={});this.Yfd[D]||(this.Yfd[D]=1,k?t?bf.b("DistinctUserInitiatedNavigationalCommand",null,0,!0,0):bf.b("DistinctUserInitiatedTerminalCommand",
null,0,!0,0):b&&bf.b("DistinctUserInitiatedKeyboardCommand",null,0,!0,0));k?t?bf.b("UserInitiatedNavigationalCommand",null,0,!0,0):bf.b("UserInitiatedTerminalCommand",null,0,!0,0):b&&bf.b("UserInitiatedKeyboardCommand",null,0,!0,0)}ofj(b,k,t){if(RegExp("^[a-zA-Z0-9_]*$").test(b))return b;v.ULS.sendTraceTag(510247689,207,15,t?"CommandId: "+k+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+k+" has a controlId that is non-alphanumeric and may need to be changed");
return"MalformedId"}w3l(b,k){k=parseInt(k);k=Xc.ActionManager.c8e(k)||Xc.ActionManager.raa(k)||"";return!Hf.c(k)&&k in this.Tpc?this.Tpc[k]:100<b.length?"":b}oKf(){this.Hp&&this.Hp.execute(b=>{b.ZJf("ModernFontPickerExperience")})}NYe(b,k){let t=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(t=b.payload.inputMethod,k[Dx.a.Gx]=t);return t}zNf(b,k){const t=Object(Ka.a)(ef.AFrame,w.AFrameworkApplication.ta);if(this.Ub&&this.opj(b)){if(!this.Ub.currentScope&&t){let D="null";if(b){const P=
b.Value;delete b.Value;D=ib.a.toJSON(b);Hf.c(P)||(b.Value=P)}v.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",k,D,t.T5a)}this.Ub.Wkf()}(this.Ub&&this.Ub.currentScope&&this.Ub.currentScope.name!==ef.AFrame.Ipa&&t&&this.Ub.currentScope.name!==t.T5a||this.opj(b))&&this.AZk(b)}opj(b){return!!b&&!Hf.c(b[Dx.a.fTa])&&b[Dx.a.fTa]}AZk(b){Dx.a.Gx in b&&1===b[Dx.a.Gx]&&wF.ShyRibbon.qeb(1,
0)}inm(b,k){Qg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.l3();this.zea.xm();if(this.Fgk&&this.ga){const t={};t[yI.a.phg]=k.payload.tabId;this.ga.Qb($a.a.D4c,2,t,this.BX(k));Hf.c(k.payload.inputMethod)||(this.ga.processAction($a.a.Zbj,2),this.Xvd||this.Fvo(k.payload.tabId))}k=k.payload.tabId;b.NewContextId=k;b.NewContextCommand=this.Pl.luf(k);v.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+k);if(this.Hp&&k){const t=
k+"TabSwitchActivity";this.Hp.execute(D=>{D.ZJf(t)})}}lQc(b,k,t){const D=b.type;return"MenuClosePayload"===D?!0:"MenuOpenPayload"===D?(k(b,t),!0):!1}qmm(b){b=b.type;"MenuOpenPayload"===b?w.AFrameworkApplication.u9c=!0:"MenuClosePayload"===b&&(w.AFrameworkApplication.u9c=!1)}YBn(b,k){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const t=b.payload.launcherId,D=this.Pl.getCommandByExternalUxId(t);return D&&D.populationProps?
((b=this.Sbb.zZf(D,k,b.payload))&&t in this.Iub&&delete this.Iub[t],b):!1}WSo(b,k){const t=b.launcherId;this.mjc(t,k)&&(k=appChrome.selectors.getFlyoutAnchorMenuItems(t),this.lmc(k,t,Qg.g(b)))}UTo(b,k){const t=b.launcherId;this.mjc(t,k)&&(k=Qg.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(t):appChrome.selectors.getFlyoutAnchorMenuItems(t),this.lmc(k,t,Qg.g(b)))}FVo(b,k){const t=b.launcherId;this.mjc(t,k)&&(k=appChrome.selectors.getPreviewGalleryMenuItems(t),this.lmc(k,
t,Qg.g(b)))}vWo(b,k){const t=b.launcherId;this.mjc(t,k)&&(k=appChrome.selectors.getSplitButtonMenuItems(t),this.lmc(k,t,Qg.g(b)))}BWo(b,k){const t=b.launcherId;this.mjc(t,k)&&(k=appChrome.selectors.getStatefulSplitButtonMenuItems(t),this.lmc(k,t,Qg.g(b)))}getSelectedTabId(){return this.ofe?appChrome.selectors.getSelectedTabId():null}lmc(b,k,t){this.Sbb.l1c(b,t);this.Iub[k]=new Date}mjc(b,k){let t=!0;b in this.Iub&&(t=this.Iub[b].getTime()<this.zea.Koa.getTime());return t&&!k&&this.ofe}hXh(b,k){const t=
{};var D=b.payload.selectedGalleryId;const P=this.Pl.getCommandByExternalUxId(D);if(P){t.SourceControlId=D;t.MenuItemId=P.menuItemId;t.SqmControlId=k;P.legacyControlId&&(t.LegacyId=P.legacyControlId);b.payload&&!Hf.c(b.payload.shouldTakeFocus)&&(t[Dx.a.fTa]=b.payload.shouldTakeFocus);this.Y5l(b.payload,t);(D=this.BX(b))||(D={});this.aag(D,b,k,P.commandId);const ca=this.NYe(b,t);this.ZPe.executeCommand(P.commandId,t,this.getSelectedTabId(),ca,!0,()=>{this.zNf(t,k)},D,Qg.g(b.payload))}}$vl(b,k){const t=
this.Pl.getCommandByExternalUxId(k);if(t){const D={};D.SourceControlId=k;D.MenuItemId=k;D.SqmControlId=k;b.payload&&!Hf.c(b.payload.shouldTakeFocus)&&(D[Dx.a.fTa]=b.payload.shouldTakeFocus);let P=this.BX(b);P||(P={});this.aag(P,b,k,t.commandId);const ca=this.NYe(b,D);this.ZPe.executeCommand(t.commandId,D,this.getSelectedTabId(),ca,!1,()=>{this.zNf(D,k)},P,Qg.g(b.payload))}}Y5l(b,k){"CharacterGalleryPayload"===b.type&&(k.MenuItemId=b.character)}Kbg(b,k){b.payload&&"toggled"in b.payload&&(k[kg.a.On]=
b.payload.toggled)}h8m(b,k){if("MenuOpen"===b){if(this.zZ&&!("isShadowRendering"in k.payload&&k.payload.isShadowRendering))this.zZ.onMenuOpen()}else if("MenuClose"===b&&this.zZ)this.zZ.onMenuClose()}l3(){this.zZ&&this.zZ.XSf()}BX(b){let k=null;Hf.c(b.triggerTime)||(k={},k.TriggerTime=b.triggerTime);return k}plm(b,k,t){if(this.L1j&&this.ga){const D={};D[wI.a.Y8d]=t;this.ga.Qb($a.a.C4c,2,D)}this.lmc(k.pageControlIdMap,b,Qg.g(k))}f1m(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction($a.a.dcj,
2);break;case "FileNewPage":this.ga.processAction($a.a.ecj,2)}}e1m(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction($a.a.Hbj,2);break;case "FileOpenPage":this.ga.processAction($a.a.Ibj,2)}}isShadowMenuOpen(b){return!!b&&"MenuOpenPayload"===b.type&&b.isShadowRendering}Fvo(b){if(w.AFrameworkApplication.K.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.Hp.execute(k=>{k.logActivity("TellMeHelpCoachMarkActivity",null)}),this.Xvd=!0;else{if(w.AFrameworkApplication.K.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&
(this.Hp.execute(k=>{k.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.okk)){this.Xvd=!0;return}w.AFrameworkApplication.K.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.processAction($a.a.TOb,2)&&(this.Xvd=!0)}}hUk(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.Zah&&appChrome.PRIToastManager.dismissToast()}}Object(n.a)(TI,"ReactExecuteCommandHandler",null,[]);class UI{constructor(){this.fileMenu=null}get jqb(){return 0}get S3a(){return 0}get bGa(){return!1}rya(){}Oyj(){}p_(){return!1}fkj(){}x3(){return!1}HIa(b){return this.fileMenu&&
this.fileMenu.iSa(b)?!0:!1}get fja(){return!1}dob(){}VXd(){return!1}get FFd(){return null}set FFd(b){}ifa(){}cba(){}nvf(){return null}eOa(){}refresh(){}get controls(){return null}Lgc(){return!1}Ieb(){}xm(){}get zF(){return null}set zF(b){}Aad(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}Object(n.a)(UI,"ReactRibbonExternal",null,[707,644,708]);class VI{constructor(b,k,t,D){this.Ub=b;this.ga=k;this.Nkh=t;this.lYb=D}initialize(){this.ga.qa($a.a.l5c,Ud.a.frame,Object(A.a)(this,
this.cej,"ribbonMoveForwardAction"));this.ga.qa($a.a.k5c,Ud.a.frame,Object(A.a)(this,this.bej,"ribbonMoveBackwardAction"));this.ga.qa($a.a.kee,Ud.a.frame,Object(A.a)(this,this.Zdj,"ribbonEscAction"));var b=Kj.a.gWd(this.lYb,null,this.Nkh,!1);b.OH=!0;this.Jgc(b,$a.a.l5c,$a.a.k5c);b.bindAction(Zb.KeyInputManager.kc(pc.a.KIa,0),$a.a.kee);b=this.Ub.ge(ef.AFrame.Ipa);b.OH=!0;this.Jgc(b,$a.a.P_a,$a.a.P_a);Kf.a.instance.lb(Rc.a.Kx,this.Nkh,Object(A.a)(this,this.jrn,"onRibbonMouseDown"));b=tl.a.instance;
Qg.a("enterKeytipMode")&&b.$io(this.lYb,()=>{appChrome.api.enterKeytipMode(!1)});Qg.a("exitKeytipMode")&&b.Wio(this.lYb,()=>{appChrome.api.exitKeytipMode();wF.ShyRibbon.qeb(1,0)});w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.zoa&&(b=Object(Ka.a)(ad.FocusManager,this.Ub))&&b.uwk(Object(A.a)(this,this.pmn,"onFocusScopeChanged"))}pmn(b,k){if((b=Object(Ka.a)(ef.AFrame,w.AFrameworkApplication.ta))&&k.NPi&&w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.zoa){const t=appChrome.selectors.getShyState();
t.isActive&&k.NPi.name===b.T5a&&wF.ShyRibbon.qeb(t.state,1)}}cej(){return 4}bej(){return 4}Zdj(){Qg.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.zoa&&appChrome.selectors.getShyState().isActive&&wF.ShyRibbon.qeb(1,0),this.Ub.mg(ef.AFrame.Pn));return 4}Jgc(b,k,t){const D=Zb.KeyInputManager.kc(pc.a.ww,0),P=Zb.KeyInputManager.kc(pc.a.ww,4);b.ir(D);b.ir(P);b.bindAction(D,k);b.bindAction(P,t)}jrn(b){b.Gb&&b.Gb.target&&"input"!==b.Gb.target.tagName.toLowerCase()&&
b.Gb.preventDefault();return!1}dispose(){this.ga.Lv($a.a.l5c,Ud.a.frame,Object(A.a)(this,this.cej,"ribbonMoveForwardAction"));this.ga.Lv($a.a.k5c,Ud.a.frame,Object(A.a)(this,this.bej,"ribbonMoveBackwardAction"));this.ga.Lv($a.a.kee,Ud.a.frame,Object(A.a)(this,this.Zdj,"ribbonEscAction"))}}Object(n.a)(VI,"ReactRibbonFocusManager",null,[9]);class gC{constructor(b,k,t,D,P,ca,ta,Na=null,qb=!0,Jb=null,Vb=null){this.D$a=this.Zwd=this.tve=this.zea=null;this.Reh=[];this.Zsd=null;this.ZLa=b;this.VJe=k;this.lYb=
t;this.Ub=D;this.ga=P;this.Pl=ca;this.zea=Jb?Jb:new OD(os.instance,this.Pl);this.uvc=ta;this.fdh=new UI;this.$La=Na;this.IRe=qb;new RI;this.DUg=Vb;Tj.a.get_instance().Dk(7,Object(A.a)(this,this.nko,"setRibbonPostInteractiveReady"));Tj.a.get_instance().Dk(7,Object(A.a)(this,this.T4m,"logRibbonLoadedActivity"));Tj.a.get_instance().Dk(19,Object(A.a)(this,this.I_m,"logAppLoadedActivity"));w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&
Tj.a.get_instance().Dk(7,Object(A.a)(this,this.MVn,"registerSubComponentReporting"));Tj.a.get_instance().Dk(7,Object(A.a)(this,this.WKn,"queueSettingsDependentActions"))}initialize(b,k,t=null){this.IRe||this.XH(5);t?t.then(()=>{this.Waj()}).catch(()=>v.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):QI.a.$9c(QI.a.$9c(Rj.Task.WAA(this.UFi(b),this.TFi(gC.MYj)),()=>this.TFi(gC.dVj)),()=>this.UFi(k)).continueWith(()=>{this.Waj()},11)}dispose(){this.pOo();this.D$a&&this.D$a.iSh();
this.Zsd&&this.Zsd.dispose();for(const b of this.Reh)Tj.a.get_instance().wWk(b);w.AFrameworkApplication.va.Lv($a.a.w2n,Ud.a.frame,Xc.ActionManager.Of)}TFi(b){return Fa.a.instance.resolve("Common.ISharedDependencyLoader").Mcc(w.AFrameworkApplication.yz(b,2))}UFi(b){return""===b?Rj.Task.J3(!0):Fa.a.instance.resolve("Common.ISharedDependencyLoader").Mcc(w.AFrameworkApplication.yz(b,3))}gym(){(this.$La||this.uvc)&&appChrome.api.dispatch(this.oii());this.mmo();Qg.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(w.AFrameworkApplication.o5);
this.zea.xm()}Waj(){this.gym();this.IRe&&(appChrome.renderAppChrome(this.ZLa,Qg.e()),this.XH(10));this.Wmh();this.p4e();this.IRe&&this.XH(5);this.lqi()}lqi(){this.Ub&&this.ga&&this.lYb&&(this.Zsd=new VI(this.Ub,this.ga,this.ZLa,this.lYb),this.Zsd.initialize())}get i5c(){return this.fdh}setCommandDefinitionMapping(){if(Qg.a("setCommandDefinitionMapping")){const b=rM(this.Pl);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.zoa&&
Qg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,k)=>{0===k&&this.Pfc()})}Wmh(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(Ka.a)(OD,this.zea);this.tve=new TI(this.zea,b.Ggc,this.Pl,this.Ub,this.VJe,Fa.a.instance.Na("Common.IRibbonSQMInformation"),Fa.a.instance.Na("Common.IFileMenuSQMInformation"),w.AFrameworkApplication.va,w.AFrameworkApplication.K,Fa.a.instance.Sa("Common.ISystemInitiatedFeedback"),null);this.YIk();
this.nkm()}YIk(){this.Zwd=appChrome.api.bindCommandHandler((b,k)=>{this.tve.executeCommand(b,k)})}pOo(){this.Zwd&&(this.Zwd(),this.Zwd=null)}mmo(){appChrome.api.initializeLogger(new vk.a)}wEa(){return this.zea?this.zea.wEa():[]}Pfc(){pr.a.instance.ie(()=>{let b=null;pr.a.instance.ie(()=>{b=this.wEa()},"RB:GA");b&&0<b.length&&(this.zea.Koa=new Date,pr.a.instance.ie(()=>{appChrome.api.dispatch(b)},"RB:DA"));this.D$a&&pr.a.instance.ie(()=>{this.D$a.L0i()},"RB:J")},"RB:PFSU")}Jad(){this.zea.Jad()}bKb(){}bpk(b){b=
[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}oii(){var b=w.AFrameworkApplication.K;const k=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Fa.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>{t.isFeatureEnabled("ConnectedServices",!0).then(D=>{D&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",
!1));return null})}):k.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));k.push.apply(k,this.f8h());b=new sM.a(this.Pl);this.$La.TG&&(tM.a.pLo(this.$La.TG),k.push.apply(k,b.vNd(this.$La.TG)));if(this.$La.MAj)for(const t of this.$La.MAj)k.push(appChrome.actions.updateGallerySectionHiddenState(t.V1h,t.Ljp,t.Olp));k.push.apply(k,b.W2h(this.$La.QAj));return k}f8h(){const b=[];if(this.uvc&&this.uvc.TG){const t=this.uvc.TG;for(let D in t){var k=t[D];const P=this.Pl.Dpf(D);if(P)for(let ca of P)b.push(appChrome.actions.updateControlHiddenState(ca,
k))}}return b}EIa(b){b&&this.zea.Ggc.l1c(b,0)}zZf(b){this.zea.Ggc.zZf(this.Pl.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}nnl(){const b=w.AFrameworkApplication.K.$("ShareMenuIsEnabled")?"ShareMenu":"Share",k=w.AFrameworkApplication.K.appSettings;k&&appChrome.api.dispatch(this.qWo(b,"Shared"===(k.SharingStatus||"")))}WKn(){w.AFrameworkApplication.K.No(()=>{this.nnl()})}qWo(b,k){return appChrome.actions.updateSharingStatusIndicator(b,k)}XH(b){Tj.a.get_instance().XH(b);
this.Reh.push(b)}nko(){Qg.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new PI,{postRibbonInteractiveReady:!0})))}p4e(){this.uvc&&this.DUg&&(this.D$a=this.DUg.$$e(),this.fdh.fileMenu=this.D$a)}AWm(b,k){this.D$a&&this.D$a.sEi(b,k)}l8f(b,k,t){if(1===t)return 32;this.Nlj(!0);this.Pfc();w.AFrameworkApplication.ta.updateCommandUI();return 32}m8f(b,k,t){if(1===t)return 32;this.Nlj(!1);this.zko();this.Pfc();w.AFrameworkApplication.ta.updateCommandUI();
return 32}nkg(b,k,t){if(1===t)return 32;(b=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback"))&&b.execute(D=>{D.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}zko(){Mb.a.dTa(w.AFrameworkApplication.K.jb("IsSimplifiedRibbonOnCookieName"),"true",Mb.a.cRa)}Nlj(b){Mb.a.dTa(w.AFrameworkApplication.K.jb("ReactRibbonMLRPreferenceCookieName"),b.toString(),Mb.a.cRa)}T4m(){if(w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Yq){const b=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");
"SingleLine"===appChrome.selectors.getRibbonMode()?(b.execute(k=>{k.logActivity("SingleRibbonModeActivity",null)}),w.AFrameworkApplication.Roa("d79fg304;61jba833;h856e313;f5i2f477;d613b829;da9b1202")):"Multiline"===appChrome.selectors.getRibbonMode()&&(b.execute(k=>{k.logActivity("MultiRibbonModeActivity",null)}),w.AFrameworkApplication.Roa("69a7h198;dfd7j584"));w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultToMLR",!1)&&Fa.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(k=>
{k.isFreemiumUpsellEnabled()&&w.AFrameworkApplication.Roa("5fjej882;e0jjh200")})}}I_m(){this.ga.qa($a.a.nkg,Ud.a.frame,Object(A.a)(this,this.nkg,"triggerModeSwitcherTUI"));const b=Mb.a.lba(w.AFrameworkApplication.K.jb("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const k=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");k&&(w.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")?(k.execute(t=>{t.logActivity("VNextStylesOn",null)}),k.execute(t=>{t.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):
w.AFrameworkApplication.K.$("Fluent2StyleFGOnlyIsEnabled")&&b&&k.execute(t=>{t.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}MVn(){Tj.a.get_instance().Dk(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const b=appChrome.api.getRibbonSubComponentMappings();for(let t in b){var k=t;const D=b[t];if(D)for(const P of D)w.AFrameworkApplication.va.v_(P)?appChrome.api.reportRibbonSubComponentBehaviorMapped(k):w.AFrameworkApplication.va.Tio(P,this.Mal(k));
else appChrome.api.reportRibbonSubComponentBehaviorMapped(k)}}Mal(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}nkm(){if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Qg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&w.AFrameworkApplication.Cfc.VXe){const b=w.AFrameworkApplication.Cfc.VXe,k=w.AFrameworkApplication.Cfc.umh;
k.payload||(k.payload={});const t=k.payload.launcherId?k.payload.launcherId:b;gC.eej.nb(t)?gC.eej.J(t)():"StatefulSplitButtonModel"===k.modelType?appChrome.PRIToastManager.dismissToast():(k.payload.PRIReadinessCheck=!0,this.tve.executeCommand(b,k))}}}gC.MYj="common";gC.dVj="appChrome";gC.eej=new qM.a(Ja.a.OPc());Object(n.a)(gC,"ReactRibbonUser",null,[208,145,9]);class WG extends gC{constructor(b,k,t,D,P,ca,ta,Na,qb=null,Jb=!0,Vb=null,ac=null){super(b,k,D,P,ca,ta,Na,qb,Jb,Vb,ac);this.sjd=null;this.rtb=
t;this.rtb.execute(yc=>{this.sjd=yc});this.rtb.execute(yc=>{this.zea.zF=yc})}wEa(){return this.sjd?(this.sjd.clearCache(),super.wEa()):[]}bKb(b){if(!b)throw Error.argumentNull();this.rtb.execute(k=>{b.zF=k})}}Object(n.a)(WG,"ReactRibbonUser",gC,[]);var vM=c(992);class xF extends WG{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb=!0,Vb=null,ac=null){super(k,b.Ufa,D,wg.AppFrame.Upa,P.xg,P.pc,ta,Na,qb,Jb,Vb,ac);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.SCe=b;this.daa=ca;P.sUa(()=>
{this.$Vo();w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?Tj.a.get_instance().Dk(7,()=>{this.cqi()}):this.cqi()},null)}get qCf(){return!!w.AFrameworkApplication.K.appSettings.BootActivityNavigationId}cqi(){this.Q9k();this.$$e();this.vSn()}$Vo(){this.ZLa.classList.add("FlexBoxLayout");this.SCe.lna().classList.add("cui-exth");this.SCe.lna().classList.add("FlexBoxLayout");this.SCe.lna().classList.add("ScrollableRibbon")}Q9k(){w.AFrameworkApplication.IX||
this.Tcl()}Tcl(){if(!w.AFrameworkApplication.IX){var b=(new GI(xF.Dgk,this.daa)).Vul(),k=Kj.a.gWd(wg.AppFrame.uPa,null,b,!0);k.OH=!0;this.Jgc(k,$a.a.l5c,$a.a.k5c);k.bindAction(Zb.KeyInputManager.kc(pc.a.KIa,0),$a.a.kee);BD.a(1,()=>{this.L0n(b)})}}L0n(b){const k=new NI;appChrome.renderSharedHeader(b,k.xna()).then(this.Oef.bind(this))}F9i(){w.AFrameworkApplication.ta.Nb.QAi?appChrome.getHeaderApi().then(b=>{document.getElementById(w.AFrameworkApplication.tgb).classList.remove("Placeholder");return b.dismissPlaceholder()}):
(new vM.a).Oef()}Oef(){this.qCf&&w.AFrameworkApplication.Roa("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings");this.qCf&&w.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?(Tj.a.get_instance().Dk(12,this.F9i.bind(this),11),v.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.F9i()}Jgc(b,k,t){const D=Zb.KeyInputManager.kc(pc.a.ww,0),P=Zb.KeyInputManager.kc(pc.a.ww,4);b.ir(D);b.ir(P);b.bindAction(D,
k);b.bindAction(P,t)}$$e(){const b=!!this.$La&&"FileMenu"in this.$La.QAj;w.AFrameworkApplication.ta.Nb.nQa&&!b&&BD.a(1,this.k0n.bind(this))}k0n(){const b=[];if(w.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var k=[Object.assign(new UG,{label:CommonUIStrings.L_DiagnosticsSessionId,value:w.AFrameworkApplication.userSessionId}),Object.assign(new UG,{label:CommonUIStrings.L_DiagnosticsBuild,value:w.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",
k))}b.push.apply(b,this.f8h());k=document.createElement("div");document.body.appendChild(k);appChrome.renderFileMenu(k,b)}vSn(){this.ga.qa($a.a.FTa,lc.a.view,this.FTa.bind(this));this.ga.qa($a.a.l8f,lc.a.view,this.l8f.bind(this));this.ga.qa($a.a.m8f,lc.a.view,this.m8f.bind(this))}activateRibbonTab(b){this.bpk(b)}Pfc(){Tj.a.get_instance().isCompleted(7)&&this.sjd&&(Hj.a.mark(4893),cr.a.EVo(),super.Pfc(),Hj.a.mark(4894))}FTa(b,k,t,D,P){if(2===P[Dx.a.Gx]){if(t=Object(Ka.a)(Ky.a,k))D=Object(Ka.a)(vC.a,
t.view);else return v.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(k),b,ib.a.join(P," ",":")),8;if(D&&""!==D.$I)Pk.a.fha(k)&&Pk.a.hac()||(this.Ub.mg(D.$I),appChrome.selectors.getShyState().isActive&&wF.ShyRibbon.qeb(0,1));else return v.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(t.view),
b,ib.a.join(P," ",":"),this.vZl(t.view)),8}return 32}vZl(b){return b?"is ContentEditableView: "+b.Sj+" is Editing View: "+b.uwa+" is HtmlView: "+b.Q2a+" is InteractiveView: "+b.qe+" is NavigationPaneView: "+b.uMm+" is PageView: "+b.Vi+" is WordNavigationPaneHeadingsView "+b.W_d:"null view"}}xF.Dgk="WACRibbon";Object(n.a)(xF,"ReactRibbonUser",WG,[207,208,145,9]);class WI extends xF{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc=null,ed,sd){super(b,k,t,D,P,ca,ta,Na,qb,!1,Jb,Kc);this.KAk=()=>{this.Hp&&
this.Hp.execute(oe=>{oe.logActivity("WordShyRibbon",null)});return 32};this.uxm=()=>{Zg.a.instance.rf(ai.a.Hym,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(oe=>{var Ld;this.$La&&oe.push.apply(oe,this.oii());(this.Ffh||this.Gfh)&&this.tcb&&oe.push.apply(oe,this.CNl());oe.push(appChrome.actions.setControlCustomTooltip(Yn.a.hXm,CommonUIStrings.l_LoopsLearnMoreTooltip));w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.zoa&&this.Hno();var Od=null===(Ld=w.AFrameworkApplication.K)||
void 0===Ld?void 0:Ld.jb("ReactShyRibbonPreferenceCookieName");Ld=Mb.a.get(Od);w.AFrameworkApplication.K.$("IsO365ConsumerHost")&&appChrome.api.isSmallDevice()&&!appChrome.api.isVerySmallDevice()&&w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.oJ&&""===Ld&&w.AFrameworkApplication.ue("66h8i182;1ha8c781");oe.push.apply(oe,this.wEa());oe.push(appChrome.actions.setControlBehaviorAttached(!0));const ie=Fa.a.instance.resolve("WordEditor.IModeSwitcherControl");Ld=ie.ZYl();w.AFrameworkApplication.ue("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(Od=appChrome.selectors.getModeSwitcherMode())&&Od!==Ld.activeMode&&v.ULS.sendTraceTag(527778651,306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${Ld.activeMode}, Actual: ${Od}`);w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&(Od=Kj.a.gWd(rs.a.psj,null,document.getElementById("WACToolbarContainer"),
!1),Od.OH=!0,this.eOn(Od,$a.a.l5c,$a.a.k5c));"Suggest"===Ld.activeMode||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===Ld.activeMode?appChrome.getUpdateAppModeAndTabsActions(Ld,!0).then(Ce=>{appChrome.api.dispatch(oe.concat(Ce));ie.xMi();this.qqi()}):(oe.push(appChrome.actions.updateModeSwitcher(Ld)),appChrome.api.dispatch(oe),ie.xMi(),this.qqi())})};this.tcb=Vb;this.Ffh=ac;this.Gfh=yc;this.Hp=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");
this.Hb=ed;this.eBe=sd}Gym(){v.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");Tj.a.get_instance().XH(5);const b=this.qCf&&w.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?12:10;Tj.a.get_instance().Dk(b,this.uxm,11);w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",!1)&&this.Psk()}Psk(){this.Hb.Vb(new Df.a(5,1,0,()=>{this.eBe.execute(b=>{b.xjo()})}))}CNl(){const b=[];this.Ffh&&(b.push(appChrome.actions.setButtonSecondaryText(Yn.a.AHd,
this.tcb.rrm)),b.push(appChrome.actions.setButtonSecondaryText(Yn.a.VFd,this.tcb.qrm)),b.push(appChrome.actions.setButtonSecondaryText(Yn.a.F9d,this.tcb.srm)));this.Gfh&&b.push(appChrome.actions.setButtonSecondaryText(Yn.a.C9d,this.tcb.trm));return b}Hno(){this.Hp&&appChrome.api.isSmallDevice()?this.Hp.execute(b=>{b.logActivity("ShyRibbonSmallScreenActivity",null)}):this.Hp.execute(b=>{b.logActivity("ShyRibbonNormalScreenActivity",null)});w.AFrameworkApplication.va.fb($a.a.Brh,Ud.a.frame,this.KAk,
96)}eOn(b,k,t){const D=Zb.KeyInputManager.kc(pc.a.ww,0),P=Zb.KeyInputManager.kc(pc.a.ww,4);b.ir(D);b.ir(P);b.bindAction(D,k);b.bindAction(P,t)}qqi(){w.AFrameworkApplication.Cfc.oOo();this.Wmh();this.p4e();this.lqi();Tj.a.get_instance().XH(7);Zg.a.instance.Tea(ai.a.ZDc,ai.a.Q6n,(new Date).getTime())}EIa(b){if(b){const k=this.i9h();try{super.EIa(b)}finally{null===k||void 0===k?void 0:k.dispose()}}}wEa(){const b=this.i9h();try{return super.wEa()}finally{null===b||void 0===b?void 0:b.dispose()}}i9h(){var b;
let k=void 0;const t=null===(b=Wa.App.Lj)||void 0===b?void 0:b.Bl;t&&(k=new Xd.GraphTransaction(Wa.App.Qvi()&&Wa.App.DDf?0:2),k.set(t));return k}}Object(n.a)(WI,"ReactRibbonUser",xF,[]);class XI extends RG{constructor(b,k,t,D,P,ca,ta,Na){super(b,k,t);this.JFe=w.AFrameworkApplication.K.$("PasteWithOptionsFromRibbon")&&aa.a.f4;this.Pl=P;this.COe=ca;this.Hb=ta;this.eBe=Na}dcl(b,k){const t=new EE(w.AFrameworkApplication.K,this.ga,this.Ub,this.JFe),D=new nM.a(t);return this.Acl(b,k,D,t)}Acl(b,k,t,D){var P=
new EI(new FI(w.AFrameworkApplication.K,D),t);t=this.cym(P);const ca={};P.wob(ca);P=!aa.a.f4;const ta=aa.a.zq||aa.a.jj;var Na=aa.a.el;w.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(Na=aa.a.ti||Na);Na=new RH.a(Na);b=new WI(b,k,WordEditorIntl.WordEditorStrings,this.rtb,D,b,this.Pl,t,new AI(ca),this.COe,Na,P,ta,new DI,this.Hb,this.eBe);b.Gym();return b}cym(b){const k={};b.M6c(k);b.Vad(k);return new BI(null,k,"jewelWordEditor")}}Object(n.a)(XI,"WordEditorRibbonUserFactory",RG,[]);
class XG{constructor(b,k){this.Uz=b;this.kpd=k}kOa(b,k,t,D=null,P=null){return this.kpd.Yoj(b)?this.kpd.kOa(b,k,t,D,P):this.Uz.kOa(b,k,t,D,P)}AFa(b,k=null){return this.kpd.Yoj(b)?this.kpd.AFa(b):this.Uz.AFa(b,k)}}Object(n.a)(XG,"RootCuiUser",null,[555]);class YI extends XG{constructor(b,k){super(b,k)}clearCache(){this.Uz.clearCache()}}Object(n.a)(YI,"WordGeneralCuiUser",XG,[554,555]);var wM=c(1447);class cG{static getSelectedText(){const b=(new fp.a).Ctf();return b.neighborhood.substr(b.mentionStart,
b.mentionLength)}static yRd(b){b=b?b.trim():null;let k=20;b&&0<b.length&&(b.length>k&&(k=F.a.mz(b,k)?k-1:k),b=b.length>k?b.substr(0,k).trim()+"...":b);return b}}Object(n.a)(cG,"SearchUtils",null,[]);class zy extends RF{constructor(b,k,t){super(b,t);this.iI=k}Imf(b){const k=[],t=af.a.instance.hb.kb,D=!!this.iI&&this.iI.sVc(Pb.a.e6e.toString()),P=!!this.iI&&this.iI.sVc(Pb.a.cMb.toString()),ca=!D&&!t.F2a&&zy.g6a.OMi(),ta=!!this.iI&&this.iI.sVc($a.a.newComment.toString())||!!si.a.instance&&(3===si.a.instance.mode||
2===si.a.instance.mode),Na=t.EAi()&&w.AFrameworkApplication.ta.Nb.kVc;var qb=!1;if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1)){qb=!!t&&(t.hy||2===t.length&&hf.SelectionEditor.Fk(t.Qc));var Jb=cG.getSelectedText();qb=qb&&0<Jb.length&&60>Jb.length}b=(Jb=3===b||aa.a.ti||w.AFrameworkApplication.zlf)&&zy.pgf.I_(t,b);Jb&&k.push(this.Pl.kEa("ClipboardGroup")[0].externalUxGroupId);ca&&(k.push(this.Pl.kEa("TextFormattingGroup")[0].externalUxGroupId),
k.push(this.Pl.kEa("StylesGroup")[0].externalUxGroupId));qb&&k.push(this.Pl.kEa("DefineGroup")[0].externalUxGroupId);D&&k.push(this.Pl.kEa("PictureToolsGroup")[0].externalUxGroupId);P&&k.push(this.Pl.kEa("TableToolsGroup")[0].externalUxGroupId);Na&&k.push(this.Pl.kEa("EquationToolsGroup")[0].externalUxGroupId);ta&&k.push(this.Pl.kEa("CommentGroup")[0].externalUxGroupId);b&&k.push(this.Pl.kEa("ContextMenuGroup")[0].externalUxGroupId);wM.a.Cui&&zy.iHm&&k.push(this.Pl.kEa("DesignerGroup")[0].externalUxGroupId);
return k}static get pgf(){return null!=zy.Pxg?zy.Pxg:zy.Pxg=Fa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get g6a(){return null!=zy.WFg?zy.WFg:zy.WFg=Fa.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static eSc(b,k,t,D){b.UIk(()=>zy.Keb(k,t,D))}static Keb(b,k,t){return new zy(b,k,t)}static get iHm(){null===this.HEe&&(w.AFrameworkApplication.ue("DesignerInContextMenuConsumerExp;DesignerInContextMenuConsumerExpCf"),this.HEe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerInContextMenuConsumerExpIsEnabled",
!1):!1);return this.HEe}}zy.HEe=null;Object(n.a)(zy,"WordReactFloatie",RF,[]);class YG{constructor(){this.Mda=this.kBc=this.W=null}get name(){return"WordEditor.UI"}init(){var b;this.W.resolve("WordEditor.UI.BusinessBarController").TYf();const k=Wa.App.Zv.KI,t=Wa.App.ya;zy.eSc(t,this.W.resolve("Common.IReactContextualUILauncher"),k,this.W.resolve("Common.IExternalUICommandDefinitionMapping"));this.Mda=this.W.Na("Box4.IContextMenuController");const D=new QH(t,k,this.W.Sa("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.PasteFloatieManager")),
P={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:P["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:P["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:P["floatie.gbUseSmartPasteButton"]=!1}D.eSc("PasteFloatieData",null,P);this.W.resolve("WordEditor.UI.CuiActionBridge").initialize();
(new rI(t,k,this.W.Sa("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.ExternalContentFloatieManager"))).eSc("ExternalContentFloatieData",[WordEditorIntl.WordEditorStrings],{});this.W.resolve("Box4.IGeneralCuiUser");Tj.a.get_instance().Dk(7,()=>{this.kBc=this.W.resolve("WordEditor.UI.StatusBarUser");this.kBc.Tb()})}dispose(){this.kBc&&(this.kBc.dispose(),this.kBc=null);this.Mda&&(this.Mda.dispose(),this.Mda=null)}xc(b){this.W=b;b.ha("WordEditor.UI.BusinessBarController",()=>new VH(b.resolve("CommonUI.IBusinessBar"),
b.resolve("CommonUI.IBusinessBarEntryFactory"),w.AFrameworkApplication.va,w.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").singleInstance();let k=aa.a.el;w.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(k=aa.a.ti||k);b.ha("Box4.UI.ShortcutHintMapping",()=>new RH.a(k));const t=aa.a.zq||aa.a.jj,D=w.AFrameworkApplication.K.$("PasteWithOptionsFromContextMenu")&&(aa.a.f4||t),P=w.AFrameworkApplication.K.$("CatchUpActivityIsEnabled");
b.ha("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new an(Fa.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Fa.a.instance.resolve("Box4.Intent.IIntentRangeEditor"),new Ue.a)).singleInstance();b.ha("WordEditor.UI.EditSurfaceContextMenu",()=>new Wo(w.AFrameworkApplication.va,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),b.resolve("Box4.Proofing.IErrorRangeEditor"),w.AFrameworkApplication.K,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
P?b.Sa("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),b.Na("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),b.Sa("Box4.IPresenceDataManager"),b.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Sa("WordEditor.ContextualSearch.ISearchSuggestionManager"),
b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),D,t?b.resolve("Box4.UI.ShortcutHintMapping"):null,Fa.a.instance.Sa("Common.IActionContextProvider"),Fa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),b.Na("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").singleInstance();
b.ha("Box4.ISelectionContextMenuProvider",()=>new Vz).singleInstance();b.ha("WordEditor.UI.CuiActionBridge",()=>new Ql(w.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").singleInstance();b.ha("WordEditor.UI.DialogFactory",()=>new qI).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").singleInstance();b.ha("Common.NonCanvasCuiUser",()=>new OC(ad.FocusManager.instance())).as("Common.INonCanvasCuiUser").singleInstance();b.ha("WordEditor.UI.WordGeneralCuiUser",()=>new YI(b.resolve("Box4.IGeneralCuiUser"),
b.resolve("Common.INonCanvasCuiUser"))).singleInstance();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.StatusBarUser",()=>new vI(Wa.App.ya.egg,b.Sa("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),w.AFrameworkApplication.va,w.AFrameworkApplication.K,Wa.App.ya)).as("WordEditor.IStatusBarUser").singleInstance();b.ha("WordEditor.IWordEditorNavigationPaneContextMenu",()=>new tF).singleInstance();const ca=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("CommandUI.ReactRibbonRoot",
()=>new OD(os.instance,b.resolve("Common.IExternalUICommandDefinitionMapping"),ca)).singleInstance();const ta=b.Sa("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.WordEditorRibbonUserFactory",()=>new XI(ta,w.AFrameworkApplication.va,ad.FocusManager.instance(),b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),w.AFrameworkApplication.nc,b.Sa("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").singleInstance();
b.ha("WordEditor.UI.ReactLanguageDialog",()=>new uF(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");b.ha("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new zI(w.AFrameworkApplication.va)).as("Common.IRibbonSQMInformation").singleInstance();b.ha("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new xI(w.AFrameworkApplication.va)).as("Common.IFileMenuSQMInformation").singleInstance();b.ha("WordEditor.UI.RulerUser",()=>new sI).as("WordEditor.IRulerUser");
b.ha("WordEditor.UI.RulerContextMenu",()=>new TC(w.AFrameworkApplication.va,Fa.a.instance.Sa("Common.IZoomManager"),Dt.a.instance)).as("WordEditor.IRulerContextMenu").singleInstance();b.ha("Common.IReactContextualUILauncher",()=>new rF(b.resolve("CommandUI.ReactRibbonRoot"),b.resolve("Common.IExternalUICommandDefinitionMapping"))).singleInstance();b.ha("Box4.IContextMenuController",()=>new SH(b.resolve("Common.IReactContextualUILauncher"))).singleInstance()}static main(){w.AFrameworkApplication.ue("5b6i5792;30d4f535");
$i.instance.$Uh();$i.instance.Zgf();N.a.instance.Fc(new YG,6)}}Object(n.a)(YG,"WordEditorUIPackage",null,[1,2]);var xM=window.ExternalContentFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",
attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},
children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},
tD={};tD.nnc=function(){function b(){return ta()&&(ed()||3<=(ac()?sd("version/"):0))}function k(){return 0<=window.navigator.userAgent.indexOf("Windows")}function t(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function D(Mf){Mf=(new RegExp(Mf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var yi=-1;null!=Mf&&2<=Mf.length&&(yi=parseFloat(Mf[1]),isNaN(yi)&&(yi=-1));return yi}function P(){ZI||(ZI=!0,$I=D("Windows Phone"));return 8<=$I}function ca(){return"function"==typeof navigator.msLaunchUri&&
!t()&&!Kc()&&!Na()}function ta(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Na(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function qb(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Jb(){return qb()?8==window.document.documentMode:!1}function Vb(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function ac(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function yc(){return 0<=
window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Kc(){var Mf=window.navigator.userAgent.toLowerCase();return 0<=Mf.indexOf("android")&&0<=Mf.indexOf("chrome")}function ed(){return 3<=(Vb()?sd("firefox/"):0)}function sd(Mf){var yi=window.navigator.userAgent.toLowerCase(),Gj=yi.indexOf(Mf);return 0<=Gj?parseInt(yi.substring(Gj+Mf.length,yi.length)):0}function oe(Mf,yi,Gj,Jk,Lo){if(Jk&&null!=yi)yi();else if(ca())navigator.msLaunchUri(Mf,yi,Gj);else if(!(yc()||0<=window.navigator.userAgent.indexOf("iPhone")||
0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&ta())||Na())Od(Mf,yi,Gj);else if(yc()&&Lo)a:{try{window.open(Mf,"_self")}catch(us){null!=Gj&&Gj();break a}null!=yi&&yi()}else Ld(Mf,yi,Gj)}function Ld(Mf,yi,Gj){var Jk=document.getElementById("OICLinkTag");null==Jk&&(Jk=document.createElement("a"),Jk.id="OICLinkTag",Jk.style.visibility="hidden",Jk.href="",0==(yq.Options&Ay.SupportsTopTargetNavigation)||yq.NoBrowserModalDialogs?Jk.target="_blank":Jk.target="_top",document.body.appendChild(Jk),
null!=Jk.addEventListener&&Jk.addEventListener("click",function(Lo){null!=Lo.stopPropagation&&Lo.stopPropagation()},!1));try{Jk.href=Mf,Jk.dispatchEvent(new MouseEvent("click"))}catch(Lo){null!=Gj&&Gj();return}null!=yi&&yi()}function Od(Mf,yi,Gj){var Jk=document.getElementById("OICFrame");null==Jk&&(Jk=document.createElement("iframe"),Jk.className="ObjectInDialog",Jk.style.visibility="hidden",Jk.src="about:blank",document.body.appendChild(Jk),Jk.id="OICFrame");try{Jk.contentWindow.location.href=Mf}catch(Lo){null!=
Gj&&Gj();return}null!=yi&&yi()}function ie(Mf){return 0!=(Mf.Options&Ay.SkipProtocolHandler)||Jb()}function Ce(Mf){return Mf===uD.ReadOnly||Mf===uD.ReadWrite}function hg(Mf,yi,Gj,Jk){var Lo;try{var us=new ActiveXObject("SharePoint.OpenDocuments.4");return(Lo=us.ViewDocument3(window.self,Mf,yi,Jk))?(HE(hC.O14ActiveX),Fp.None):Fp.Failed}catch(Jr){}if(Ay.O14Only===(Gj&Ay.O14Only))return yq.DescriptiveUnattemptedEnums?Fp.O14AttemptFailure:Fp.Unattempted;try{return us=new ActiveXObject("SharePoint.OpenDocuments.3"),
(Lo=us.ViewDocument3(window.self,Mf,yi,Jk))?(HE(hC.O12ActiveX),Fp.None):Fp.Failed}catch(Jr){}if(Ay.O12UpOnly===(Gj&Ay.O12UpOnly))return yq.DescriptiveUnattemptedEnums?Fp.O12UpOnlyFail:Fp.Unattempted;try{return us=new ActiveXObject("SharePoint.OpenDocuments.2"),(Lo=Ce(yi)?us.ViewDocument2(window.self,Mf,Jk):us.EditDocument2(window.self,Mf,Jk))?(HE(hC.O11ActiveX),Fp.None):Fp.Failed}catch(Jr){}return yq.DescriptiveUnattemptedEnums?Fp.ActiveXUnattempted:Fp.Unattempted}function Kg(Mf,yi,Gj,Jk,Lo){Mf==
wr.Visio&&Gj==uD.ReadWrite&&(Gj=uD.WriteOnly);Jk=Jk||t()&&!P();if(!Jk){Jk="";if(Mf==wr.PowerPoint){Mf=Jk;Jk=yq.DocumentExtension;Gj=Ce(Gj);var us=new Set([".pot",".potm",".potx"]),Jr=new Set([".pps",".ppsm",".ppsx"]);Gj=Gj&&us.has(Jk)?"nft|ofc|":Gj&&Jr.has(Jk)?"ofv|ofs|t|":!Gj&&Jr.has(Jk)?"ofe|ofs|t|":Gj?"ofv|ofc|":"ofe|";Gj=Mf+Gj}else Gj=Ce(Gj)?Jk+"ofv|ofc|":Jk+"ofe|";Jk=Gj;yq.NewTelemetryDataIsEnabled&&(Gj=yq.SessionOrigin?"or|"+yq.SessionOrigin:"",Gj+=yq.ClickTime?"ct|"+yq.ClickTime:"",Gj+=yq.CorrelationId?
"cid|"+yq.CorrelationId:"",Lo+=wm(Gj));Lo+=wm(Jk+"u|")}Lo+=wm(yi);yi=window.location.href;Gj=yi.toLowerCase().indexOf("&wdlor=");-1!=Gj?(Gj+=7,Mf=yi.indexOf("&",Gj),yi=-1==Mf?yi.substr(Gj):yi.substring(Gj,Mf)):yi=void 0;if(null!=yi&&"undefined"!=typeof yi){Gj="";try{Gj=decodeURIComponent(yi)}catch(IE){}0<Gj.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Gj)&&(Lo=Lo+"|f|"+Gj)}return Lo}function Hl(Mf,yi,Gj,Jk,Lo,us){var Jr=aJ(Mf);if(null==Jr)return TD(yq.DescriptiveUnattemptedEnums?
Fp.ProtocolHandlerIsNull:Fp.Unattempted,yq.Application),!1;Mf=Kg(Mf,yi,Gj,Jk,Jr);oe(Mf,bp,qv,Lo,us);return!0}function wm(Mf){if(ta()&&yc()){var yi="";try{yi=decodeURI(Mf)}catch(Gj){}if(yi==Mf)return encodeURI(Mf)}return Mf}function bp(){HE(hC.ProtocolHandler)}function qv(){yq.Options|=Ay.SkipProtocolHandler;bJ(yq,JE,KE)}function eB(){null!=ZG&&ZG(hC.RoamingProtocolHandler)}function fB(){null!=$G&&$G(Fp.ControlNeeded)}function PD(){var Mf=document.getElementById("npSharePointPlugin");if(null==Mf){Mf=
"application/x-sharepoint";ta()&&3<=(ac()?sd("version/"):0)&&dz("application/x-sharepoint-webkit",!0)&&(Mf="application/x-sharepoint-webkit");if(!dz(Mf,!0))if(ta()&&dz("application/officelive",!0))Mf="application/officelive";else return null;var yi=document.createElement("object");yi.id="npSharePointPlugin";yi.type=Mf;yi.style.width="0px";yi.style.height="0px";yi.style.setProperty("visibility","hidden","");document.body.appendChild(yi);Mf=document.getElementById("npSharePointPlugin")}return Mf}function dz(Mf,
yi){var Gj=window.navigator.mimeTypes;if(null==Gj)return!1;Mf=Gj[Mf];return!Mf||yi&&!Mf.enabledPlugin?!1:!0}function dG(Mf){try{if(null!=new ActiveXObject(Mf))return!0}catch(yi){}return!1}function aH(Mf){switch(Mf){case wr.OneNote:return"OneNote.Notebook";default:return""}}function aJ(Mf){if(Mf!=wr.OneNote&&t()&&!P())return"office:";switch(Mf){case wr.Excel:return"ms-excel:";case wr.OneNote:return"onenote:";case wr.PowerPoint:return"ms-powerpoint:";case wr.Visio:return"ms-visio:";case wr.Word:return"ms-word:";
case wr.Project:return"ms-project:";case wr.Publisher:return"ms-publisher:";case wr.Infopath:return"ms-infopath:";case wr.Access:return"ms-access:";default:return""}}function yM(Mf){switch(Mf){case wr.Excel:return"root\\office15\\excel.exe";case wr.PowerPoint:return"root\\office15\\powerpnt.exe";case wr.Visio:return"root\\office15\\visio.exe";case wr.Word:return"root\\office15\\winword.exe";case wr.Project:return"root\\office15\\winproj.exe";case wr.Publisher:return"root\\office15\\mspub.exe";case wr.Infopath:return"root\\office15\\infopath.exe";
case wr.Access:return"root\\office15\\msaccess.exe";default:return null}}function bJ(Mf,yi,Gj){yq=Mf;JE=yi;KE=Gj;if(Mf.DocumentUrl){var Jk=Gj=yi=Mf.DocumentUrl;try{Jk=decodeURIComponent(Mf.DocumentUrl)}catch(LE){}try{Gj=encodeURI(Mf.DocumentUrl)}catch(LE){}yi=yi+""+Mf.CorrelationIdForWinClient;Jk+=Mf.CorrelationIdForWinClient;Gj+=Mf.CorrelationIdForWinClient;Mf.Mode===uD.ReadWrite&&Ay.CheckoutRequired===(Mf.Options&Ay.CheckoutRequired)&&(Mf.Mode=uD.ForceCheckout);Ay.HostIsEditOnly===(Mf.Options&Ay.HostIsEditOnly)&&
(Mf.Mode=uD.WriteOnly);if(ie(Mf)?0:ta()&&(Mf.Application==wr.OneNote||dz("application/x-sharepoint-protocolhandler",!1)||dz("application/x-sharepoint-webkit-protocolhandler",!1))||ca()||Kc()||!(b()||ed()||"ActiveXObject"in window&&!t()||yc())||15<=eG())Hl(Mf.Application,Mf.EncodeUrl?Gj:yi,Mf.Mode,Mf.Application==wr.OneNote,Mf.SilentExternalHandler,Mf.NavigateUsingWindowOpen);else{var Lo;if(Lo=Jb())a:{var us=Mf.EncodeUrl?yi:Jk,Jr=Mf.Mode,IE=aH(Mf.Application);try{Lo=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,
us,Jr,IE);break a}catch(LE){}Lo=!1}if(Lo)HE(hC.O15ActiveX);else{if(b()||ed()){var Lt=Mf.EncodeUrl?yi:Jk;Jk=Mf.Mode;Lo=aH(Mf.Application);us=PD();if(null==us)Lt=yq.DescriptiveUnattemptedEnums?Fp.PluginIsNull:Fp.Unattempted;else{Jr=!1;try{Jr=us.ViewDocument3(window.self,Lt,Jk,Lo)}catch(LE){}if(!Jr)try{Jr=Ce(Jk)?us.ViewDocument2(window.self,Lt,Lo):us.EditDocument2(window.self,Lt,Lo)}catch(LE){}Jr?(HE(hC.NpapiPlugin),Lt=Fp.None):Lt=Fp.Failed}}else{try{Lt=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Lt&&
Lt.SaveSSOCreds()}catch(LE){}Lt=hg(Mf.EncodeUrl?yi:Jk,Mf.Mode,Mf.Options,aH(Mf.Application))}if(Lt!=Fp.None){if(Jk=Mf.CouldUseRoamingApps)cJ||(cJ=!0,dJ=D("Windows NT")),Jk=6.1<=dJ&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(qb()||ed()||yc());if(Jk&&Mf.Application!=wr.OneNote){if(!tD.nnc.r6o()){TD(Fp.ControlNeeded,yq.Application);return}if(Mf.RoamingAppsLauncher){"undefined"==typeof Mf.RoamingAppsLauncher||null==Mf.RoamingAppsLauncher?TD(yq.DescriptiveUnattemptedEnums?Fp.RoamingLauncherIsNull:
Fp.Unattempted,yq.Application):"undefined"==typeof Mf.RoamingBitsUrl||null==Mf.RoamingBitsUrl?tD.nnc.R7o(Mf.DocumentUrl,Mf.RoamingAppsLauncher,Mf.Application,Mf.ApplicationParameters,JE,KE):tD.nnc.COj(Mf.DocumentUrl,Mf.RoamingAppsLauncher,Mf.RoamingApplicationExe,Mf.ApplicationParameters,Mf.RoamingPlatform,Mf.RoamingBitsUrl,JE,KE);return}if(!Mf.ContinueIfLauncherIsNull){TD(Fp.LauncherNeeded,yq.Application);return}}Ay.NoProtocolHandlerFallback==(Mf.Options&Ay.NoProtocolHandlerFallback)||ie(Mf)||qb()||
ta()&&!(yq.DescriptiveUnattemptedEnums?Lt>=Fp.O14Unattempted&&Lt<=Fp.DocumentUrlIsNull:Lt==Fp.Unattempted)?TD(Lt,yq.Application):Hl(Mf.Application,Mf.EncodeUrl?Gj:yi,Mf.Mode,Mf.Application==wr.OneNote,Mf.SilentExternalHandler,Mf.NavigateUsingWindowOpen)}}}}else TD(yq.DescriptiveUnattemptedEnums?Fp.DocumentUrlIsNull:Fp.Unattempted,yq.Application)}function HE(Mf){null!=JE&&JE(Mf)}function TD(Mf,yi){"undefined"==typeof yi&&(yi=null);null!=KE&&KE(Mf,yi)}function eG(){var Mf=0;if(b()||ed()||yc()){var yi=
PD();try{null!=yi&&(Mf=yi.GetOfficeVersion())}catch(Gj){}}else dG("SharePoint.OpenDocuments.5")?Mf=15:dG("SharePoint.OpenDocuments.4")?Mf=14:dG("SharePoint.OpenDocuments.3")?Mf=12:dG("SharePoint.OpenDocuments.2")&&(Mf=11);return Mf}function eJ(){return ta()&&(dz("application/x-sharepoint",!0)||dz("application/x-sharepoint-webkit",!0))}var fJ="",gJ="",hJ="",JE,KE,ZG,$G,yq,cJ,dJ,ZI,$I,uD={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Ay={None:0,CheckoutRequired:1,
O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Fp={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},hC={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,
RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},wr={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:uD,OpenDocumentOptions:Ay,OpenDocumentFailureType:Fp,OpenDocumentControl:hC,OfficeApplication:wr,EditDocumentInClient:bJ,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=wr.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=
!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:eG,IsO14MacPluginInstalled:eJ,OfferOfficeInDialog:function(){return k()&&11>=eG()},OfferOfficeNoIntrusive:function(){return k()&&
15>eG()},OfferMacOffice:function(){return ta()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!eJ()},InstallRoamingControl:function(){Vb()?window.InstallTrigger.install({Office:{URL:gJ}}):Od(hJ,null,null)},CanUseRoamingControl:function(){if(ca())return!0;if(yc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Vb()){var Mf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Mf);
var yi=document.createEvent("Events");yi.initEvent("RoamingOfficeInstalled",!0,!1);Mf.dispatchEvent(yi);return!!Mf.getAttribute("installed")}if(qb())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Gj){}return!1},InitUrls:function(Mf,yi,Gj){fJ=Mf;gJ=Gj;hJ=yi},LaunchRoamingApps:function(Mf,yi,Gj,Jk,Lo,us){tD.nnc.COj(Mf,yi,yM(Gj),Jk,"x86",fJ,Lo,us)},LaunchRoamingApps2:function(Mf,yi,Gj,Jk,Lo,us,Jr,IE){var Lt="";null!=Jk&&(Lt+=" "+Jk);null!=Mf&&(Lt+=' "'+Mf+'"');if(ca()||
yc())ZG=Jr,$G=IE,Jr='office: "'+(us+'" "')+(Gj+'" "ROAMING"'),Jr+=' "'+yi+'"',Jr+=' "'+Lo+'"',Jr+=" "+Lt,oe(Jr,eB,fB,!1,!1);else if(Vb())Mf=document.createElement("RoamingExtensionElement"),Mf.setAttribute("cabUrl",us),Mf.setAttribute("app",Gj),Mf.setAttribute("licensingEntitlements",yi),Mf.setAttribute("platform",Lo),Mf.setAttribute("args",Lt),document.documentElement.appendChild(Mf),yi=document.createEvent("Events"),yi.initEvent("RoamingOfficeLaunch",!0,!1),Mf.dispatchEvent(yi),null!=Jr&&Jr(hC.RoamingFFExtension);
else if(qb()){if(Mf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Mf)try{Mf.HrConfigureSingle(us,Gj,yi,Lo,Lt),null!=Jr&&Jr(hC.RoamingActiveX)}catch(LE){}}else null!=IE&&IE(Fp.Failed)},ShouldShowDialog:function(){return!t()},NavigateToUrlUsingClickingOnATag:Ld,OpenDocumentWithProtocolHandler:Hl,OpenDocumentWithProtocolHandlerNoCallBack:function(Mf,yi,Gj,Jk){var Lo=aJ(Mf);if(null==Lo)return TD(yq.DescriptiveUnattemptedEnums?Fp.ProtocolHandlerNoCallbackIsNull:Fp.Unattempted,yq.Application),
!1;Mf=Kg(Mf,yi,Gj,Jk,Lo);oe(Mf,null,null,!1,!1);return!0}}}();tD.ClientUtils=tD.nnc;var zM=c(1466);class fG{constructor(b,k,t){this.ga=b;this.N7j=k;this.z6=t}Tb(){this.ga.qa($a.a.tryMacOffice,Ud.a.frame,Object(A.a)(this,this.utn,"onTryMacOffice"));this.ga.qa($a.a.GBj,Ud.a.frame,Object(A.a)(this,this.qXi,"onTryMacOfficeFromViewer"));this.ga.qa($a.a.FBj,Ud.a.frame,Object(A.a)(this,this.qXi,"onTryMacOfficeFromViewer"))}utn(b,k,t,D,P){if(1===t)return 32;P?(b=P.SourceControlId,"btnjTryMacOfficeForWordEditor"===
b?$d.a.nm(ia.a.Y0a(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===b&&$d.a.nm(ia.a.Y0a(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.vEi();return 32}qXi(b,k,t){if(1===t)return 32;switch(b){case $a.a.GBj:$d.a.nm(ia.a.Y0a(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case $a.a.FBj:$d.a.nm(ia.a.Y0a(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}vEi(){$d.a.nm(fG.B7m,"_blank",void 0,"LaunchMacTrialWindow")}get M7c(){return this.N7j&&
aa.a.el&&!aa.a.cFf&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get tqo(){const b=this.M7c;b||w.AFrameworkApplication.Qm.geo();return b}get sqo(){return this.M7c}static get B7m(){return ia.a.h8("522401")}}Object(n.a)(fG,"MacOfficeOffer",null,[989]);class gG{constructor(b,k,t){this.ga=b;this.S7j=k;this.VJ=null;(this.qxd=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Fa.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(D=>
{this.VJ=D});this.z6=t}Tb(){this.ga.qa($a.a.tryOffice,Ud.a.frame,Object(A.a)(this,this.vtn,"onTryOffice"));this.ga.qa($a.a.Mkg,Ud.a.frame,Object(A.a)(this,this.Mkg,"tryOfficeThroughTellMe"));this.ga.qa($a.a.LBj,Ud.a.frame,Object(A.a)(this,this.MBj,"tryOfficeThroughViewer"));this.ga.qa($a.a.KBj,Ud.a.frame,Object(A.a)(this,this.MBj,"tryOfficeThroughViewer"))}vtn(b,k,t,D,P){if(this.qxd&&1===t)return this.isFreemiumUpsellEnabled&&this.N7c?32:8;2===t&&(P?(b=P.SourceControlId,"btnjTryOfficeForWordEditor"===
b?$d.a.nm(ia.a.Y0a(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===b?$d.a.nm(ia.a.Y0a(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.CIf()):this.CIf());return 32}Mkg(b,k,t,D,P){if(this.qxd&&1===t)return this.isFreemiumUpsellEnabled&&this.N7c?32:8;2===t&&(P?(b=P.SourceControlId,$d.a.nm(ia.a.h8("862405")+this.W5l(b),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):$d.a.nm(ia.a.h8("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));
return 32}MBj(b,k,t){if(this.qxd&&1===t)return this.isFreemiumUpsellEnabled&&this.N7c?32:8;if(2===t)switch(b){case $a.a.LBj:$d.a.nm(ia.a.Y0a(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case $a.a.KBj:$d.a.nm(ia.a.Y0a(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get Chn(){return this.N7c}get Bhn(){return this.N7c&&MSOJS.ClientUtils.OfferOfficeInDialog()}get N7c(){return this.S7j&&!aa.a.el}get isFreemiumUpsellEnabled(){let b=!1;this.VJ&&(b=this.VJ.isFreemiumUpsellEnabled());
return b}CIf(b=null){let k=0;b&&(k=b);$d.a.nm(gG.G_l(k),"_blank",void 0,"LaunchOfficeOffer")}W5l(b){let k=0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":k=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":k=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":k=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":k=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":k=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":k=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":k=
7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":k=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":k=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":k=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":k=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":k=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":k=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":k=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":k=20;break;
case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":k=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":k=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":k=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":k=29}return 0===k?"":String.format("&pc={0:D}",k)}static G_l(b){if(aa.a.ti)switch(b){case 1:return ia.a.h8("393806");case 2:return ia.a.h8("393810");case 3:return ia.a.h8("393809");case 5:return ia.a.h8("393805")}else if(aa.a.yM)switch(b){case 1:return ia.a.h8("521979");
case 3:return ia.a.h8("521980");case 5:return ia.a.h8("521978");case 2:return ia.a.h8("522490")}else{if(2===b)return ia.a.h8("517778");if(1===b)return ia.a.Y0a(30)}return ia.a.h8("522402")}}Object(n.a)(gG,"OfficeTrialExperience",null,[988]);class iJ{xc(b){b.register(gG,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").singleInstance().Rd(()=>new gG(w.AFrameworkApplication.va,w.AFrameworkApplication.HEf,w.AFrameworkApplication.lcid));b.register(fG,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").singleInstance().Rd(()=>
new fG(w.AFrameworkApplication.va,w.AFrameworkApplication.hyi,w.AFrameworkApplication.lcid))}}Object(n.a)(iJ,"OpenInClientConfiguration",null,[2]);class hB{constructor(b,k,t,D,P,ca,ta){this.Vf=b;this.characterPropertiesEditor=k;this.MW=t;this.Xif=D;this.lj=P;this.Ld=ca;this.F_=ta}cAm(b,k){var t;b=k.view;k=k.$j;if(!k||!this.Vf.Yvi(k,!0)||this.Xif&&this.Xif.instance&&this.Xif.instance.qU(k))return 2;var D=hB.R6a?!hB.L_.Bwa(k):!0;this.MW&&D&&this.MW.Xlc(k.node,pc.a.zs,k.cpBegin);D=k.node;(null===(t=
this.F_)||void 0===t?0:t.replaceText)&&this.F_.uHb(D)?(t=D.pa.R_a(k.cpBegin),this.F_.replaceText(D,t,t,at.a.lXc)):this.characterPropertiesEditor.Uga(k,P=>new at.a(P));if(this.Ld.qg){t=new Xd.GraphTransaction(15);try{t.Cb(k.node),this.lj.jqa(k.node,k.cpBegin,k.cpBegin+1,1)}finally{t&&t.dispose()}}D=k.node;t=k.cpEnd+1;" "===pe.ParagraphReader.text(D).charAt(t)&&(D=Of.a.createTextRange(D,t,t+1),this.characterPropertiesEditor.replaceTextRange(D,"\u00a0"));k=Of.a.Rc(k.node,t);b.mb.setSelection(Gf.SelectionFactory.ho(k));
return 32}static get L_(){return null!=hB.EAg?hB.EAg:hB.EAg=Fa.a.instance.resolve("Box4.IHyperlinkStrategy")}static get R6a(){null==hB.ila&&(hB.ila=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return hB.ila}}hB.ila=null;Object(n.a)(hB,"InsertLineBreakStrategy",null,[]);class ew{static get lg(){return null!=ew.kEg?ew.kEg:ew.kEg=Fa.a.instance.resolve("Box4.IOutlineElementEditor")}static get Wg(){return li.ContextSetEditor.instance}static get lj(){return null!=
ew.HHg?ew.HHg:ew.HHg=Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ld(){return null!=ew.lIg?ew.lIg:ew.lIg=Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static AAm(b,k,t,D,P){if(P&&P.hasProperty(vd.a.targetObject)){var ca=k.view.ed.Kc.Db(P.getValue(vd.a.targetObject));ca=Of.a.create(ca)}else ca=ew.Wg.jT(k.$j,11);if(!ca)return 8;b=w.AFrameworkApplication.va.Nf(ca,b,t,!0,D,P);if(32===b&&2===t){if(!k.view.qe)return 2;k=k.view;D=
k.mb.sg;if(D=ew.Wg.jT(D,11)){t=new Vk.a;t.set(D.node);t.yd();if(P&&P.hasProperty(vd.a.targetObject))for(P=P.Lf(vd.a.targetObject);!t.currentNode.id.equals(P)&&t.uc()&&(ag.OutlineElementNavigator.Vd(t),11===t.We););ag.OutlineElementNavigator.p0(t,!1,!1);P=hf.SelectionEditor.SDa(t,!0);P=pe.ParagraphReader.Qt(P)?Gf.SelectionFactory.te(P,0):Gf.SelectionFactory.uq(P);k.mb.setSelection(P)}}return b}static wWd(b,k,t,D,P){b=b===Pb.a.CSc;k=k.node;if(P&&P.hasProperty(vd.a.targetObject)&&!k.id.equals(P.Lf(vd.a.targetObject)))return 2;
if(1===t)return 32;t=new ze.GraphIterator;t.set(k);t.zb(10);ew.lg.yB(t,b,!0);ew.Ld.qg&&(t=ag.OutlineElementNavigator.Ge(t),ew.lj.lOb(t,1));return 32}}Object(n.a)(ew,"InsertOutlineElementStrategy",null,[]);class hG{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb){this.ori=(Vb,ac,yc)=>{var Kc;const ed=!ac.cpBegin;yc=ac.cpBegin===pe.ParagraphReader.textLength(yc);const sd=!(null===(Kc=Wa.App.rd)||void 0===Kc||!Kc.Yo);let oe=!0;sd&&ed&&!yc?(oe=!1,Kc=new ze.GraphIterator,Kc.Yc(Vb),Kc.yd(),this.nh.yB(Kc,!0,!1)):Kc=
this.nh.aoa(Vb);this.nh.N9(Vb,Kc,ac,!1,!0,oe,!1,!0);!sd||ed||yc||(Vb=li.ContextSetEditor.instance.mof(ac),Wa.App.rd.kq.rH(Vb));return Kc};this.YY=k;this.c1j=b;this.Nz=ca;this.V9j=P;this.nh=t;this.XZj=D;this.Ik=ta;this.ib=Na;this.zE=qb;this.mqc=Jb}Fen(b,k,t,D,P){if(!k.view.qe)return 2;k=k.view;let ca=null;k.Vi&&(ca=k);const ta=k.mb.sg;var Na=!0;let qb=!1,Jb=null;if(!ta)return 2;const Vb=new Xd.GraphTransaction(15);Vb.Cb(k.ed);let ac=null;2===t&&(ac=new Vk.a,ac.set(ta.node),ac.yd(),Jb=new pB.a(ac),
ag.OutlineElementNavigator.Vd(ac),Na=va.OutlineElementReader.isEmpty(ac,!1),{mpj:Na,JJj:qb}=this.XZj.npj(ac,Na,ks.a.BEb,-1,ta));b=w.AFrameworkApplication.va.Nf(ta,b,t,!1,D,P);Na&&32===b&&2===t&&(qb||ag.OutlineElementNavigator.cGa(ac,!1,!hf.SelectionEditor.gf(ta),!1),qb&&Jb&&Jb.restore(ac),this.Nz.freeze(),(t=Gf.SelectionFactory.fo(ac.currentNode,!0))||v.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),k.mb.setSelection(t),this.Nz.cIa(),this.c1j.Ug.kF());ca&&(Na||ca.W4(),
ca.editingView&&ca.rU&&(ca.editingView.ZH=!0));iz.GrippersManager.instance.GQb(1);Vb.dispose();return b}newLine(b,k,t){b=!1;if(Be.ImageReader.d4(k)||Be.ImageReader.u2a(k))k=this.w5k(k),b=!0;const D=k;if((k=hf.SelectionEditor.gf(k))&&this.Ik.kh&&!this.Ik.AMm(D))return 2;if(1===t)return 32;const P=D.node,ca=new ze.GraphIterator;ca.set(P);ca.yd();ag.OutlineElementNavigator.Vd(ca);t=new Xd.GraphTransaction(15);t.hu(ca);k?(this.mqc.instance&&this.mqc.instance.uIa(D),pe.ParagraphReader.Wb(P)&&D.cpBegin===
pe.ParagraphReader.textLength(P)&&Oi.m(D)&&9===pe.ParagraphReader.vna(P)&&this.Nz.s6k(D),dg.ListItemReader.sh(ca)?this.V9j.execute(ca,D,P,this.ori):this.ori(ca,D,P),this.YY&&this.YY.Xlc(P,pc.a.zs,D.cpBegin),b&&(ag.OutlineElementNavigator.Ur(ca,!1,!1),b=ca.Rb(2),(b=this.zE.te(b,0))&&this.ib.setSelection(b))):this.nh.yB(ca,!0,!0);t.dispose();Wa.App.ya&&Wa.App.ya.updateCommandUI();return 32}w5k(b){if(Be.ImageReader.d4(b))var k=Of.a.Rc(b.node,b.cpBegin);else{k=pe.ParagraphReader.qQ(b.node);var t=k.properties.Lf(Cc.a.iq);
b=b.node.properties.getValue(Cc.a.runId);t=hG.Hof(b,t,k.pa);k=Of.a.Rc(k,t)}return k}static ckf(b,k){let t=0;for(;t<k.length&&!(b<k[t]);)t++;return t}static Hof(b,k,t){let D=0;b=hG.ckf(b,k);let P=0;if(b===k.length)P=t.length-1;else for(;P<t.length;){k=t.J(P);if(k.formatting&&k.formatting.re===b)break;P++}P<t.length&&(D=t.J(P).cp);return D}}Object(n.a)(hG,"NewLineStrategy",null,[]);class UD{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed,sd){this.Jm=null;this.yla=b;this.$hd=ta;this.cpd=new hG(this,
k,t,D,P,ca,Na,Vb,ac,ed);this.JZg=new hB(Na,qb,k,Jb,yc,Kc,sd)}get Ug(){return this.Jm||(this.Jm=this.yla())}Tb(){const b=w.AFrameworkApplication.va,k=Object(A.a)(this.cpd,this.cpd.newLine,"newLine");b.fb(Pb.a.enter,lc.a.view,Object(A.a)(this.$hd.value,this.$hd.value.gvl,"enterView"),1124);b.fb(Pb.a.soj,lc.a.view,Object(A.a)(this.$hd.value,this.$hd.value.roo,"shiftEnterView"),1124);b.qa(Pb.a.newLine,lc.a.view,Object(A.a)(this.cpd,this.cpd.Fen,"newLineView"));b.qa(Pb.a.newLine,lc.a.Tc,k);b.qa(Pb.a.newLine,
lc.a.image,k);b.qa(Pb.a.newLine,lc.a.Hd,k);b.qa(Pb.a.newLine,lc.a.anchoredObject,k);b.qa(Pb.a.newLine,lc.a.embeddedFile,k);b.qa(Pb.a.newLine,lc.a.ink,k);b.qa(Pb.a.newLine,lc.a.paragraph,k);b.qa(Pb.a.newLine,lc.a.iFrame,k);b.qa(Pb.a.newLine,lc.a.unsupportedObject,k);b.Vc(Pb.a.newLine,1124);b.fb(Pb.a.ySc,lc.a.view,Object(A.a)(this.JZg,this.JZg.cAm,"insertLineBreakView"),1028);b.qa(Pb.a.CSc,lc.a.view,ew.AAm);b.qa(Pb.a.CSc,lc.a.outlineElement,ew.wWd);b.Vc(Pb.a.CSc,1092)}static get instance(){return null!=
UD.HBg?UD.HBg:UD.HBg=UD.Rl()}static Rl(){return new UD(()=>Fa.a.instance.resolve("Box4.IUndoManager"),Fa.a.instance.Na("Box4.IAutoCorrectScheduler"),Fa.a.instance.resolve("Box4.IOutlineElementEditor"),Fa.a.instance.resolve("Box4.List.ICursorMovementValidator"),Fa.a.instance.resolve("Box4.List.ListNewLineStrategy"),Fa.a.instance.resolve("Box4.IInsertionPointFormatting"),Fa.a.instance.Ue("Box4.Actors.IEnterViewStrategy"),Yj.a.instance,Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Fa.a.instance.Sa("Box4.IExternalSelectionManager"),
af.a.instance,Fa.a.instance.resolve("Box4.ISelectionFactory"),Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Fa.a.instance.Sa("Box4.IContentControlConverter"),Fa.a.instance.resolve("Box4.IBox4GraphWriter"))}}Object(n.a)(UD,"EnterActor",null,[]);var bH=c(1377),cH=c(875);class fk{static get paragraphEditor(){return null!=fk.SEg?fk.SEg:fk.SEg=Fa.a.instance.resolve("Box4.IParagraphEditor")}static get k5(){return null!=
fk.qGg?fk.qGg:fk.qGg=Fa.a.instance.Na("Box4.ISpacingCommands")}static get yTa(){return null!=fk.BGg?fk.BGg:fk.BGg=Fa.a.instance.Na("Box4.Styles.IWACStyleReader")}static get NFa(){return null!=fk.lDg?fk.lDg:fk.lDg=Fa.a.instance.Na("Box4.ILineSpacingHelper")}static get lj(){return null!=fk.QHg?fk.QHg:fk.QHg=Fa.a.instance.Na("Box4.TrackChange.ITrackChangeEditor")}static get Ld(){return null!=fk.rIg?fk.rIg:fk.rIg=Fa.a.instance.Na("Box4.TrackChange.ITrackChangeManager")}static get Mh(){return Fa.a.instance.Na("WordEditor.ClientPagination.IClientPaginationSettings")}static Tb(){var b,
k,t;const D=w.AFrameworkApplication.va;D.qa(Pb.a.nJf,lc.a.view,gn.a.Wv);D.Vc(Pb.a.nJf,1028);D.qa(Pb.a.dD,lc.a.view,gn.a.Wv);D.qa(Pb.a.dD,lc.a.paragraph,fk.LAd);D.Vc(Pb.a.dD,1036);D.qa(Pb.a.Eic,lc.a.paragraph,fk.YCk);D.qa(Pb.a.Eic,lc.a.view,gn.a.Wv);D.Vc(Pb.a.Eic,1036);if(null===(b=fk.Mh)||void 0===b?0:b.JFa)D.qa(Pb.a.O6c,lc.a.paragraph,fk.d1e),D.qa(Pb.a.O6c,lc.a.view,gn.a.Wv);if(null===(k=fk.Mh)||void 0===k?0:k.XIa)D.qa(Pb.a.q7c,lc.a.paragraph,fk.y1e),D.qa(Pb.a.q7c,lc.a.view,gn.a.Wv);if(null===(t=
fk.Mh)||void 0===t?0:t.pha)D.qa(Pb.a.N6c,lc.a.paragraph,fk.c1e),D.qa(Pb.a.N6c,lc.a.view,gn.a.Wv);D.qa(Pb.a.qZe,lc.a.view,fk.Fyk);D.Vc(Pb.a.qZe,1036);D.qa(Pb.a.u5f,lc.a.view,fk.U_n);D.Vc(Pb.a.u5f,1036);D.qa(Pb.a.pZe,lc.a.view,fk.Eyk);D.Vc(Pb.a.pZe,1036);D.qa(Pb.a.t5f,lc.a.view,fk.T_n);D.Vc(Pb.a.t5f,1036);D.qa(Pb.a.bTa,lc.a.view,gn.a.Wv);D.qa(Pb.a.bTa,lc.a.paragraph,fk.LAd);D.Vc(Pb.a.bTa,1036);D.qa(Pb.a.aTa,lc.a.view,gn.a.Wv);D.qa(Pb.a.aTa,lc.a.paragraph,fk.LAd);D.Vc(Pb.a.aTa,1036);D.qa(Pb.a.mje,lc.a.view,
fk.lje);D.qa(Pb.a.mje,lc.a.paragraph,fk.lje);D.Vc(Pb.a.mje,1028);D.qa(Pb.a.zfg,lc.a.view,fk.lje);D.qa(Pb.a.zfg,lc.a.paragraph,fk.lje);D.Vc(Pb.a.zfg,1028);D.qa(Pb.a.dje,lc.a.view,gn.a.Wv);D.qa(Pb.a.dje,lc.a.paragraph,fk.Oth);D.Vc(Pb.a.dje,1028);D.qa(Pb.a.cje,lc.a.view,gn.a.Wv);D.qa(Pb.a.cje,lc.a.paragraph,fk.Oth);D.Vc(Pb.a.cje,1028)}static Oth(b,k,t,D,P){if(1===t)return 32;b===Pb.a.dje?b=Pb.a.bTa:b===Pb.a.cje&&(b=Pb.a.aTa);return fk.LAd(b,k,t,D,fk.Zyn(P))}static Zyn(b){var k=b.indexOf(",");const t=
b.substring(0,k);b=b.substring(k+1,b.length);k=new bH.a;k.value=parseFloat(t);k.unit=parseInt(b);return k}static lje(b,k,t,D,P){if(2===t){k=P[Dh.a.Text];t=P[Dh.a.Number];P=P.Increment;D=new bH.a;let ca=!1;""===k||P&&k===Box4Intl.Box4Strings.L_SpinnerAuto?(D.value=0,D.unit=Wa.App.sFa?2:4,ca=!0):t||P||(D.value=0,D.unit=1,ca=!0);ca&&(w.AFrameworkApplication.va.Qb(b===Pb.a.mje?Pb.a.bTa:Pb.a.aTa,2,D),Wa.App.ya.updateCommandUI())}return 32}static LAd(b,k,t,D,P){if(!({fy:t}=gn.a.Scg(t,k)).returnValue)return t;
k=k.node;switch(b){case Pb.a.dD:fk.paragraphEditor.dD(k,new cH.a(2,P));break;case Pb.a.bTa:b=new cH.a(P.unit,P.value);fk.paragraphEditor.bob(k,b);break;case Pb.a.aTa:b=new cH.a(P.unit,P.value),fk.paragraphEditor.aob(k,b)}D&&Aq.a.zpb&&(D.ks|=Aq.a.jhb(k));return 32}static Fyk(b,k,t){if(1===t)return 32;v.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=fk.ugi(k);if(!b)return v.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),8;b=(b=b.ia(Cc.a.Ki,
240)/20)?b:fk.Ygl;fk.k5.Wca(1,b,4);return 32}static U_n(b,k,t){if(1===t)return 32;v.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");fk.k5.Wca(1,0,4);return 32}static Eyk(b,k,t){if(1===t)return 32;v.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=fk.ugi(k);if(!b)return v.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ia(Cc.a.sa,240)/20;fk.k5.Wca(0,b?b:12,4);return 32}static T_n(b,k,t){if(1===t)return 32;
v.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");fk.k5.Wca(0,0,4);return 32}static d1e(b,k,t,D,P){if(2==t){if("boolean"!==typeof P)return 16;b=k.node;k=null;sq.a.instance.J(1)&&(k=b.LD());fk.paragraphEditor.d1e(b,P);k&&fk.lj.YU(b,k,fk.Ld.qg)}return 32}static y1e(b,k,t,D,P){if(2==t){if("boolean"!==typeof P)return 16;b=k.node;k=null;sq.a.instance.J(1)&&(k=b.LD());fk.paragraphEditor.y1e(b,P);k&&fk.lj.YU(b,k,fk.Ld.qg)}return 32}static c1e(b,k,t,D,P){if(2==t){if("boolean"!==
typeof P)return 16;b=k.node;k=null;sq.a.instance.J(1)&&(k=b.LD());fk.paragraphEditor.c1e(b,P);k&&fk.lj.YU(b,k,fk.Ld.qg)}return 32}static YCk(b,k,t,D,P){if(2==t){if("boolean"!==typeof P)return 16;b=new Map;b.set("Value",P.toString());xa.Health.instance.recordKpiUsage(Wg.a.qkb.sIo,0,Wg.a.qB,b);k=k.node;b=null;sq.a.instance.J(1)&&(b=k.LD());k.hasProperty(Cc.a.ew)&&k.removeProperty(Cc.a.ew);fk.NFa.sOd(k)!==P&&k.setValue(Cc.a.ew,P);(P=fk.NFa.J7b(k,!0))&&P.Tk(4,!0);(P=fk.NFa.J7b(k,!1))&&P.Tk(4,!0);b&&fk.lj.YU(k,
b,fk.Ld.qg)}return 32}static ugi(b){b=b.view;return b.qe&&(b=b.mb)&&b.hb.kb?fk.yTa.Lo(b.hb.kb.Qa.node):null}}fk.Ygl=12;Object(n.a)(fk,"SpacingActor",null,[]);class jJ{process(){}}Object(n.a)(jJ,"NoOpFormattingViewOperationFinishedStageProcessor",null,[45]);class kJ{constructor(b){this.ve=b}Fgo(b,k){this.ve.Mia(b,k.cache.rG);this.ve.LA(b,k.cache.fontSize)}pEb(){return null}sEa(){return null}u8b(){return null}ZT(){return null}}Object(n.a)(kJ,"FormattingStewardBridge",null,[50]);class lJ{xc(b){b.ha("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",
()=>new jJ).singleInstance();b.ha("Box4.Actors.IFormattingStewardBridge",()=>new kJ(b.resolve("Box4.IFormattingEditor"))).singleInstance()}}Object(n.a)(lJ,"WoncaActorsConfiguration",null,[2]);class mJ{constructor(b,k,t,D,P,ca,ta,Na){this.ga=b;this.$Wj=k;this.ZWj=t;this.IMg=D;this.Mdk=P;this.Qqd=ca;this.Rdk=ta;this.Sdk=Na}get pc(){return this.ga}VKk(b){this.pc.Dpa(b,this.$Wj,null,null)}TKk(b){this.pc.Dpa(b,this.ZWj,null,null)}b_(b,k,t){t?this.pc.Dpa(b,this.IMg,k,null):this.pc.Qb(this.IMg,2,k)}Czn(b,
k){this.pc.Dpa(b,this.Qqd,k,null)}k9(b,k){this.pc.Dpa(b,this.Rdk,k,null)}Mmb(b,k){this.pc.Dpa(b,this.Sdk,k,null)}oYf(b,k=!1){const t=new th.DictionaryPropertySet;t.setValue(vd.a.gP,b);t.setValue(vd.a.L_i,!0);t.setValue(vd.a.I2a,k);this.pc.Qb(this.Mdk,2,t)}}Object(n.a)(mJ,"ClipboardCommands",null,[1373]);class nJ{}Object(n.a)(nJ,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1274]);class oJ{constructor(b){this.ga=b}get pc(){return this.ga}ulj(b,k,t){let D=0;b?1===b&&(D=Pb.a.d2a):D=Pb.a.c2a;
b=new AD.a;b.unit=t;b.value=k;this.pc.Qb(D,2,b)}Vge(b,k,t){let D=0;1===b?D=Pb.a.fOb:2===b?D=Pb.a.qob:b||(D=Pb.a.gOb);b=new AD.a;b.unit=t;b.value=k;this.pc.Qb(D,2,b)}}Object(n.a)(oJ,"IndentationCommands",null,[1308]);var iG;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.inner=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.distribute=7]="distribute";b[b.margin=8]="margin";b[b.highKashida=9]="highKashida";b[b.lowKashida=
10]="lowKashida";b[b.mediumKashida=11]="mediumKashida";b[b.numTab=12]="numTab";b[b.thaiDistribute=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(iG||(iG={}));Object(n.b)("Justification",iG);class pJ{constructor(b){this.YKa={};this.ga=b;this.Ivm()}get pc(){return this.ga}gE(b){b=this.YKa[iG[b]];void 0!==b&&null!==b&&this.pc.processAction(b,2)}Ivm(){this.YKa.left=Pb.a.leftJustify;this.YKa.center=Pb.a.centerJustify;this.YKa.right=Pb.a.rightJustify;this.YKa.both=Pb.a.fullJustify;this.YKa.lowKashida=
Pb.a.gIb;this.YKa.mediumKashida=Pb.a.gIb;this.YKa.highKashida=Pb.a.gIb;this.YKa.distribute=Pb.a.BJc;this.YKa.thaiDistribute=Pb.a.k7c}}Object(n.a)(pJ,"JustificationCommands",null,[1304]);class qJ{constructor(b){this.ga=b}dD(b){this.ga.Qb(Pb.a.dD,2,b)}Eic(b){this.ga.Qb(Pb.a.Eic,2,b)}O6c(b){this.ga.Qb(Pb.a.O6c,2,b)}q7c(b){this.ga.Qb(Pb.a.q7c,2,b)}N6c(b){this.ga.Qb(Pb.a.N6c,2,b)}Wca(b,k,t){this.ga.Qb(b?Pb.a.bTa:Pb.a.aTa,2,Object.assign(new bH.a,{value:k,unit:t}))}}Object(n.a)(qJ,"SpacingCommands",null,
[1186]);class rJ{constructor(b,k,t){this.pc=b;this.eKc=k;this.prl=t;this.Cun=(D,P,ca)=>{if(1===ca)return this.eKc.LW?32:8;this.eKc.CZm();this.prl().Fto(this.eKc.ATl());return 32}}Tb(){this.pc.fb(Pb.a.mmb,lc.a.application,this.Cun,1028)}}Object(n.a)(rJ,"EditorSettingsUIActor",null,[]);class sJ extends Wf.a{constructor(b,k){super(!1,!1,!0);this.rrl=b;this.IQa=k;this.qrl=t=>{1!==t?v.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):(this.rrl.MQo(),v.ULS.sendTraceTag(578869131,
340,50,"Editor Settings updated"))}}async Fto(b){const k=await this.IQa.CIb;b={["id"]:"SettingsDialog",["uiLanguage"]:w.AFrameworkApplication.uiCulture,["selectedLanguage"]:Xj.a.og(w.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:k.jWc,["editorSettings"]:b};this.Wh(Box4Intl.Box4Strings.l_EditorSettings,this.qrl,b);v.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")}}Object(n.a)(sJ,"EditorSettingsDialog",Wf.a,[]);class tJ{constructor(b,k,t,D,P,ca,ta,Na,
qb,Jb,Vb,ac,yc,Kc,ed){this.bwb=this.wyc=this.Bpc=null;this.pSe=0;this.tEe=!1;this.ra=new Ue.a;this.yYd=!1;this.Qu=b;this.Nz=k;this.ve=t;this.Is=D;this.eb=P;this.Gf=ta;this.Kd=Na;this.Ik=qb;this.ld=Jb;this.Ud=Vb;this.qq=ac;this.pW=yc;this.Sy=Kc;this.Co=ed}get Tsl(){return this.ld?this.ld.isFeatureEnabled(42):!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled")}get Elf(){return null!=this.Ezg?this.Ezg:this.Ezg=Fa.a.instance.resolve("Box4.IFormatPainterStrategy")}get XQ(){return this.tEe}set XQ(b){this.tEe!==
b&&(this.tEe=this.yYd=b,this.ra.raiseEvent("FormatPainterBrushActiveStatusChanged"))}xvk(b){this.ra.addHandler("FormatPainterBrushActiveStatusChanged",b)}v0i(b){const k=b.Qa;v.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",k.contextId);this.reset();var t=k.node;b=this.wyi(b);if(this.Elf.zqo(k.contextId,b))try{this.bwb=this.eb.l1a(t)}catch(D){throw v.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",D.message),D;}this.wyc=this.Sy.Lo(t);t=Je.FormattingReader.Kr(k);
t.wn&&(this.Bpc=Object(Ka.a)(px.a,t.wn.clone()));this.pSe=b?lc.a.paragraph:k.contextId}ith(b){if(b){const t=this.wyi(b);for(let D=0;D<b.length;D++){const P=b.J(D);if(null===P||void 0===P?0:P.al)this.kzb(P,t);else if(0==(null===P||void 0===P?void 0:P.length))v.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",P);else if(P)for(let ca=0;ca<P.length;ca++){var k=P.getContext(ca);if(null===k||void 0===k?0:k.Ww){if(k)for(let ta=0;ta<k.length;ta++)P.addContext(k.getContext(ta))}else(null===
k||void 0===k?0:k.al)?this.kzb(k,t):v.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",k.contextId)}}}}lth(b,k){if(k){var t=b.node,D=t.pa.last,P=this.Kd.c0a(t),ca=P.Ef(P.Ib);this.mth(P,k,null);sq.a.instance.J(1)&&this.qq.QNb(t,D,b.cpBegin,b.cpEnd,ca,P,this.Ud.qg)}}lDk(b,k,t){if(k||t)0<Oi.g(b).length&&v.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.pW.XZ(b,D=>{this.mth(D,k,t)})}mth(b,k,t){this.ve.pfa(b);b.wn&&b.wn.removeProperty(sf.a.highlight);
this.ve.W6e(b);t&&(t=t.yl().clone(),t.Eg(...Pi.a.yba()),this.Qw(b,t));this.Qw(b,k)}Qw(b,k){if(k){var t=b.paragraph.Kc;if(t){var D=b.wn;D=D?Object(Ka.a)(Yx.a,D.clone()):px.a.YCa(1179725);for(const ca of k.Jl())if(ca!==Cc.a.Xv&&ca!==Cc.a.fieldInstruction&&ca!==sf.a.BB&&ca!==sf.a.g4&&ca!==Cc.a.B2a&&ca!==sf.a.bL&&ca!==Cc.a.x3a&&ca!==Cc.a.noProof){if(ca===zi.a.aw){var P=k.ia(zi.a.aw,X.a.nil);if(P!==X.a.nil)if(P=t.Db(P)){if(P=new CA.a(P),P=this.Sy.YK(P),P===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(P=
this.Sy.JC(b.paragraph).Ova(P)){D.GNa(P.yl(),...Pi.a.yba());continue}else v.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else v.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}D.setValue(ca,k.Lf(ca))}D.DFa?k=t.BR(D,!0):(t.Ju(D),k=D);b.Fj=k.id}}}wyi(b){return!b.hy&&b.Qc.contextId!==lc.a.endOfParagraph}reset(){this.bwb=this.wyc=this.Bpc=null;this.pSe=lc.a.none}kzb(b,k){if(b.contextId===
lc.a.Tc||b.contextId===lc.a.Hd)var t=this.Ik.A8(b);else if(b.contextId===lc.a.paragraph)t=this.Ik.DZd(b);else if(b.contextId===lc.a.endOfParagraph)t=this.Ik.iYd(b);else{v.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}v.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(t)v.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{t=Object(Ka.a)(Un.AParagraphNode,b.node);var D=!1;t&&(D=
b.contextId===lc.a.Hd&&!!t&&!b.cpBegin&&b.cpEnd===this.eb.textLength(t));if(k=this.Elf.Doo(this.pSe,b.contextId,k,D))try{pe.ParagraphReader.Wb(t)?(this.wyc&&this.Qu.HJ(this.wyc,t,!0),this.Is.Gth(t,this.bwb)):v.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(P){throw v.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",P.message),P;}D=b;b.contextId===lc.a.paragraph?D=Of.a.createTextRange(t,0,pe.ParagraphReader.textLength(t)):
b.contextId===lc.a.Tc&&(D=this.Nz.Gtf(b),D=af.a.cBb(D));if(D&&D.contextId===lc.a.Hd){if(hi.a.vFd){const P=this.Co.gRd(D);P&&(D=P)}try{this.lDk(D,this.Bpc,k?null:this.wyc)}catch(P){throw v.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",P.message),P;}}if(b.contextId===lc.a.paragraph||b.contextId===lc.a.endOfParagraph)k=new ze.GraphIterator,k.set(t),k.yd(),k.hd(11),D=dg.ListItemReader.sh(k),t=!pe.ParagraphReader.textLength(t),v.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",
D,t),D?(this.Gf.nR(k),this.Gf.Tba(k.currentNode)&&this.lth(b,this.Bpc)):this.Tsl&&this.lth(b,this.Bpc)}}}Object(n.a)(tJ,"FormatPainter",null,[1340]);var AM=c(108);class VD{constructor(b,k,t,D,P,ca,ta,Na=!1,qb,Jb,Vb){this.Amd=!1;this.SAe=new uv.a;this.tlm=()=>{this.uS.XQ=!1;return 32};this.ulm=(ac,yc,Kc)=>{ac=!1;if(yc=this.Ry.E3){switch(yc.contextId){case lc.a.Hd:case lc.a.paragraph:case lc.a.endOfParagraph:case lc.a.Tc:ac=!0}ac&&hf.SelectionEditor.ml(yc)&&Oi.b(yc)&&(this.qd.Yb(Pe.a.en,{["Reason"]:He.a.dHc}),
ac=!1);ac&&pe.ParagraphReader.mU(yc)&&(this.qd.Yb(Pe.a.en,{["Reason"]:He.a.dO}),ac=!1)}if(1===Kc||!ac)return ac?32:8;6!==this.ga.zD?(this.uS.XQ?v.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(v.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.uS.v0i(this.Ry.kb),this.Amd||(this.Jh.TYa(this.oEj),(Kc=this.Jh.gb.ru)&&Kc.Vi&&Kc.rph(this.nEj),this.Amd=!0)),this.uS.XQ=!this.uS.XQ):(v.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),
this.uS.v0i(this.Ry.kb),this.uS.XQ=!1);return 32};this.slm=(ac,yc,Kc,ed,sd)=>{if(6===this.ga.zD||this.uS.XQ){v.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.zD);ac=this.Jh.Fq.Zf("UserAction","FormatPainterApply");if(VD.Xb&&VD.Xb.vA(117)){sd=sd?sd.KeepBrushActive:!1;Kc=null;this.Ry.kb&&2===this.Ry.kb.trigger&&(sd=sd||this.uS.yYd,this.uS.yYd&&hf.SelectionEditor.km(this.Ry.kb)&&(Kc=hf.SelectionEditor.C3(this.Ry.kb.Qa,!1)))&&(Kc.trigger=2);this.uS.yYd=
!1;if(sd||2!==this.Ry.kb.trigger)yc=new Xd.GraphTransaction(15),Kc&&Kc.Qa?(yc.set(Kc.Qa.node.hj),this.ib.setSelection(Kc)):yc.set(this.Ry.h6b.hj),Kc=Gf.SelectionFactory.ho(this.ib.sg),this.uS.ith(Kc),yc.dispose();this.uS.XQ=sd}else sd=new Xd.GraphTransaction(15),sd.set(this.Ry.h6b.hj),yc=Gf.SelectionFactory.ho(this.ib.sg),this.uS.ith(yc),this.uS.XQ=!1,sd.dispose();ac.stop()}return 32};this.oEj=()=>{this.j8d(this.uS.XQ)};this.nEj=()=>{this.j8d(this.uS.XQ)};this.Jh=b;this.Ub=k;this.ga=t;this.qd=D;this.Ry=
P;this.uS=ca;this.ib=ta;this.h7j=Na;this.Tx=qb;this.ox=Jb;this.d_j=Vb}get EVg(){return aa.a.Xt||aa.a.WZd?"url("+this.N8h()+"), pointer":'url("'+this.N8h()+'"), pointer'}N8h(){return this.ox?this.Tx.Ava(Nh.a.ug("FormatPainterText.cur"),Nh.a.ug("FormatPainterTextDarkMode.cur"),new AM.a(Ym.a.MK())):Nh.a.ug("FormatPainterText.cur")}Tb(){const b=this.Ub.ge(wg.AppFrame.$E);b.bindAction(Zb.KeyInputManager.kc(pc.a.KIa,0),Pb.a.Dlf);b.bindAction(Zb.KeyInputManager.kc(pc.a.Nqb,6),Pb.a.cNd);this.h7j||b.bindAction(Zb.KeyInputManager.kc(pc.a.Qqb,
6),Pb.a.x0a);this.ga.fb(Pb.a.cNd,lc.a.view,this.ulm,1028);this.ga.fb(Pb.a.x0a,lc.a.view,this.slm,1028);this.ga.fb(Pb.a.Dlf,lc.a.view,this.tlm,1028);this.uS.xvk(()=>{this.Ymg(this.uS.XQ)});this.ox&&this.d_j.yzd(()=>{this.j8d(this.uS.XQ)})}Ymg(b){const k=this.Jh.Fq.Zf("UserAction","FormatPainterUpdateCursor");this.j8d(b);this.Jh.updateCommandUI();k.stop()}mEj(b,k){for(let t=0;t<b.length;t++)this.lEj(b[t],k);(b=this.Jh.gb.ru)&&b.qe&&this.lEj(b.rh.editingElement,k)}lEj(b,k){b.style.cursor=k?this.EVg:
""}j8d(b){const k=document.querySelectorAll(".OutlineElement");if(1<k.length){const t=k[k.length-2].style.cursor===this.EVg;if(this.Jh.gb.isEditingAllowed||this.Jh.gb.qy){if(b&&!t||!b&&t)this.mEj(k,b),this.JEj(b);b||!this.Amd||this.SAe.count||(this.Jh.W$i(this.oEj),(b=this.Jh.gb.ru)&&b.Vi&&b.OZn(this.nEj),this.Amd=!1)}else t&&(this.mEj(k,!1),this.JEj(!1))}}JEj(b){const k=this.Jh.gb.ru;k&&(b?this.SAe.add(k.ed.Cl):this.SAe.remove(k.ed.Cl))}static get Xb(){return null!=VD.Ayg?VD.Ayg:VD.Ayg=Fa.a.instance.Na("Box4.IFeatureHelper")}}
Object(n.a)(VD,"FormatPainterActor",null,[]);class Yz{constructor(b,k,t){this.Sm=t}gvl(b,k,t,D,P){var ca;if(!({je:t,selected:ca,fy:qb,uUc:Na}=this.wpj(k,t,!1)).returnValue)return qb;Hj.a.mark(5013);var ta=Yz.Wg.$N(ca);for(let Jb=0;Jb<ta.length;++Jb){if(!ta[Jb].isValid)continue;const Vb=ta[Jb].iterator;Vb.Dp();if(Xh.OutlineReader.Zw(Vb))return this.wWh(t,Vb)}var Na=hi.a.wFd&&Na?Pb.a.ySc:this.YTl();if(ca.Ww||hf.SelectionEditor.ml(ca)||pe.ParagraphReader.lm(ca)&&!hf.SelectionEditor.w8(ca)){if(Yz.Xb&&
Yz.Xb.isFeatureEnabled(24)&&li.ContextSetEditor.instance.Jeg(ca).returnValue)return 8;var qb=this.xWh(k,t,b,D,P,Na)}else if(hf.SelectionEditor.Fk(ca))qb=this.vWh(k,t,b,D,P,Na);else if(hf.SelectionEditor.gf(ca)){qb=new ze.GraphIterator;qb.set(ca.node);qb.zb(10);ta=re.HyperlinkReader.MD(ca,!1);if(0<ta.length){if(!ta[0].hyperlink)return v.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",ta[0].cpBegin,ta[0].cpEnd),8;Wa.App.Igb(ta[0].hyperlink.url);return 32}yh.TableCellReader.Y_(qb)&&
(mh.returnToContainingCell(qb),yh.TableCellReader.eha(qb)&&(ta=new ze.GraphIterator,ta.Yc(qb),mh.returnToContainingRow(ta),Xh.OutlineReader.wA(qb,ca,!1)&&fn.a.twi(ta)&&0>=ca.Eb&&(Na=Pb.a.CSc,mh.returnToContainingTable(qb),ag.OutlineElementNavigator.Vd(qb),P||(P=new th.DictionaryPropertySet),P.Zg(vd.a.targetObject,qb.currentNode.id))));qb=this.yWh(k,t,b,D,P,Na)}else hf.SelectionEditor.w8(ca)&&(qb=w.AFrameworkApplication.va.Nf(k,Pb.a.newLine,2,!1,D,P));Hj.a.mark(5014);return qb}wpj(b,k,t){let D=null,
P=null,ca=!1;if(1===k)return{returnValue:!1,je:D,selected:P,fy:32,uUc:ca};if(!b.view.qe)return{returnValue:!1,je:D,selected:P,fy:2,uUc:ca};D=b.view;P=D.mb.sg;return!P||!Yz.Vf.Yvi(P,t)||hi.a.wFd&&Yz.Vf.iha(P,ta=>ca=ta)&&!ca?{returnValue:!1,je:D,selected:P,fy:2,uUc:ca}:this.Sm&&this.Sm.instance&&this.Sm.instance.qU(P)?{returnValue:!1,je:D,selected:P,fy:4,uUc:ca}:{returnValue:!0,je:D,selected:P,fy:2,uUc:ca}}roo(b,k,t,D,P){let ca,ta;if(!({je:t,selected:ca,fy:ta}=this.wpj(k,t,!0)).returnValue)return ta;
const Na=Yz.Wg.$N(ca);for(let qb=0;qb<Na.length;++qb){if(!Na[qb].isValid)continue;const Jb=Na[qb].iterator;Jb.Dp();if(Xh.OutlineReader.Zw(Jb))return this.wWh(t,Jb)}ca.Ww||hf.SelectionEditor.ml(ca)?ta=this.xWh(k,t,b,D,P,Pb.a.ySc):hf.SelectionEditor.Fk(ca)?ta=this.vWh(k,t,b,D,P,Pb.a.ySc):hf.SelectionEditor.gf(ca)?ta=this.yWh(k,t,b,D,P,Pb.a.ySc):hf.SelectionEditor.w8(ca)&&(ta=w.AFrameworkApplication.va.Nf(k,Pb.a.newLine,2,!1,D,P));return ta}wWh(b,k){b.mb.setSelection(Gf.SelectionFactory.fo(k.currentNode,
!1));return 32}xWh(b,k,t,D,P,ca){const ta=new Xd.GraphTransaction(15);ta.fk=t;ta.Cb(k.ed);k=new th.DictionaryPropertySet;k.setValue(vd.a.GJc,!0);k=w.AFrameworkApplication.va.Nf(b,Pb.a.zH,2,!0,D,k);32===k&&(k=w.AFrameworkApplication.va.Nf(b,ca,2,!1,D,P));ta.dispose();return k}vWh(b,k,t,D,P,ca){const ta=new Xd.GraphTransaction(15);ta.fk=t;ta.Cb(k.ed);k.mb.setSelection(hf.SelectionEditor.Cj(k.mb.hb.J(0),!1,!1));b=w.AFrameworkApplication.va.Nf(b,ca,2,!1,D,P);ta.dispose();return b}yWh(b,k,t,D,P,ca){const ta=
new Xd.GraphTransaction(15,t);ta.fk=t;ta.Cb(k.ed);b=w.AFrameworkApplication.va.Nf(b,ca,2,!1,D,P);ta.dispose();return b}static get Wg(){return li.ContextSetEditor.instance}static get Vf(){return Yj.a.instance}static get Xb(){return null!=Yz.wyg?Yz.wyg:Yz.wyg=Fa.a.instance.Na("Box4.IFeatureHelper")}}Object(n.a)(Yz,"AEnterViewStrategy",null,[1374]);class uJ extends Yz{constructor(b,k,t){super(b,k,t)}YTl(){return Pb.a.newLine}}Object(n.a)(uJ,"EnterViewStrategy",Yz,[]);class dH{constructor(b){this.nl=
this.transaction=null;this.je=b;this.oHc=this.qo=0}}Object(n.a)(dH,"SelectAllArguments",null,[]);class UC{constructor(b,k,t){this.Iwn=b;this.bXm=k;this.ur=t;this.Swl=(D,P,ca)=>P.view.Vi?this.ngb(P,ca,this.buj):this.Q$n(P,ca);this.R1c=(D,P)=>P.qo?1===P.qo?(P.je.mb.c7c(P.nl,D),P.qo=2,!0):2===P.qo?(P.je.mb.hb.t_a=P.nl.t_a,this.Ug.kF(),P.transaction.tHa(D),P.qo=3,P.transaction.dispose(),Hj.a.mark(5799),!0):!1:(P.transaction=this.ur.Mc(2),P.transaction.Cb(P.je.ed),P.qo=1,!0);this.Q$n=(D,P)=>{if(1===P)return 32;
if(!D.view.qe)return 2;D=D.view;return D.mb&&D.mb.hb&&D.mb.hb.kb?this.buj(D).inProgress?1:32:8};this.buj=D=>{w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");D.Vi&&v.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");D=new vs.a(null,this.dHn,new dH(D));D.Al("SelectAllInOutline");D.run();return D};this.dHn=(D,P)=>{if(!P.qo)return P.nl=Gf.SelectionFactory.R$n(P.je.mb.hb.kb),P.transaction=this.ur.Mc(2),P.transaction.Cb(P.je.ed),P.qo=1,!0;
if(1===P.qo){if(!P.oHc)return P.je.mb.setSelection(P.nl.J(0),D),++P.oHc,!0;if(P.oHc<P.nl.length)return P.je.mb.Ktk(P.nl.J(P.oHc),D),++P.oHc,!0;P.qo=2}return 2===P.qo?(P.je.mb.hb.t_a=P.nl.t_a,this.Ug.kF(),P.transaction.tHa(D),P.qo=3,P.transaction.dispose(),!0):!1}}get Ug(){return this.bXm.value}Tb(){const b=w.AFrameworkApplication.va;b.qa(Pb.a.Eya,Ud.a.frame,UC.yqj);b.qa(Pb.a.xcg,Ud.a.frame,UC.yqj);b.fb(Pb.a.ngb,lc.a.view,this.Swl,2);b.fb(Pb.a.hCa,lc.a.view,ef.AFrame.Hg,100);b.fb(Pb.a.ENf,lc.a.view,
UC.ENf,4)}ngb(b,k,t){if(1===k)return 32;if(!b.view.qe)return 2;k=b.view;if(!k.mb)return 8;const D=k.mb.hb;if(!D||!D.length)return 8;Hj.a.mark(5798);Wa.App.ya.gb.isEditingAllowed||Wa.App.ya.gb.qy||k.Vi?b=hf.SelectionEditor.Xrf(D):(ad.FocusManager.instance().cD(ef.AFrame.Pn),b=Gf.SelectionFactory.Ogj(k.ed));if(!b)return 8;D.t_a||v.ULS.sendTraceTag(39098305,324,50,"Progress selection start");t&&this.Iwn.oHb(hf.SelectionEditor.M6h(b))?t=t(k):(t=new dH(k),t.nl=b,t=new vs.a(null,this.R1c,t),t.Al("ExpandSelection"),
t.run());return t.inProgress?1:32}static get g6a(){return null!=UC.VFg?UC.VFg:UC.VFg=Fa.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static ENf(b,k,t){if(1===t)return 32;if(!k.view.qe)return 8;b=k.view;k=Gf.SelectionFactory.fo(b.root.graphNode,!0);if(!k)return 8;b.mb.setSelection(k);return 32}static yqj(){var b=Wa.App.ya.gb.ru;if(!b.qe)return 2;if(b.qe&&1!==Wa.App.ya.state){Hj.a.mark(4668);var k=b.mb.hb.kb;if(!k&&w.AFrameworkApplication.K.$("ContextMenuOnSelectionFixIsEnabled"))return 2;
k=hf.SelectionEditor.q7(k);let t=k.x,D=k.y+k.height;if(!b.container)return 8;b=Sys.UI.DomElement.getBounds(b.container);if(k.y<b.y||k.y>b.y+b.height||k.x<b.x||k.x>b.x+b.width)t=b.x,D=b.y;UC.g6a.Eya(new Sys.UI.Point(t,D),1);Hj.a.mark(4669)}return 32}}Object(n.a)(UC,"SelectAllHandlers",null,[1192]);class vJ{ege(){}}Object(n.a)(vJ,"FontNameFormattingStrategyNoop",null,[1341]);var BM=c(861);class jG{constructor(b,k,t,D,P,ca){this.Dwh=this.Gwh=null;this.ar=b;this.Cwh=k;this.KJk=t;this.UJk=D;this.Gwh=P;
this.Dwh=ca}}Object(n.a)(jG,"BookmarkHighlightContext",null,[]);class wJ extends rc.a{constructor(){super()}get Cba(){return!0}get wib(){return 5}get V1a(){if(null!=this.o2)return this.o2;this.o2=[];this.o2.push(new Sc.a(qn.a.CBd,qn.a.CBd));this.o2.push(new Sc.a(qn.a.s3e,qn.a.s3e));this.o2.push(new Sc.a(qn.a.SEc,qn.a.SEc));return this.o2}uGa(b,k){this.Cba&&pr.a.instance.ie(()=>{const t=this.Au.kDa;var D=this.Au.MWc;if(t)if(5===t.type){D=t.sA;if(t.BJ&&t.BJ.ar.includes(b))for(const P of k.OGa("*"))this.Au.nSa(P);
D&&D.ar.includes(b)&&this.kob(k,t.action,D,b)}else D&&5===D.type&&3===t.action&&D.sA.ar.includes(b)&&this.kob(k,0,D.sA,b)},"BHA:OPHC")}wQa(b){return Object(ob.a)(jG,b)}m1a(b,k){if(b)for(const t of b.ar)k.add(t)}kob(b,k,t,D){0===k&&b.htmlElement&&pr.a.instance.ie(()=>{const P=b.OGa("*"),ca=P.length,ta=qn.a.CBd;var Na=D.id===t.Gwh,qb=D.id===t.Dwh;let Jb=!1;var Vb=0,ac=[];const yc=Array(ca);for(let sd=0;sd<ca;sd++){var Kc=P[sd];const oe=Pd.a(Kc);yc[sd]=oe;const Ld=Kc.classList;if(0!=yc[sd]){const Od=
!Ld.contains(qn.a.pG),ie=jd.a.Db(Kc,qn.a.Ezb);ie&&ac.push(...ie);if(Na){let Ce;if((Ce=jd.a.Db(Kc,qn.a.EBd))&&ie&&1===Ce.length&&1===ie.length&&Ce[0].equals(ie[0]))continue;Ce&&(Vb+=Ce.length,1===oe?Ld.add(qn.a.s3e):Ld.add(ta));if(ie)for(const hg of ie)this.yXd(t,hg)&&(Vb--,Jb&&Ld.add(qn.a.SEc));0!==Vb&&Od&&Ld.add(ta)}if(!Na&&!qb&&t.UJk.has(D.id))if((Kc=jd.a.Db(Kc,qn.a.Ezb))&&Jb){Ld.add(ta);for(const Ce of Kc)if(this.yXd(t,Ce)){Ld.add(qn.a.SEc);break}}else Od&&Ld.add(ta)}Jb=!Ld.contains(qn.a.agb)}if(qb&&
!Na){Na=new Set;for(var ed of ac)this.yXd(t,ed)&&Na.add(ed);Jb=!1;for(ac=0;0!==Na.size&&ac<ca;ac++){Vb=P[ac];ed=Vb.classList;if(0!=yc[ac])if(qb=!1,Vb=jd.a.Db(Vb,qn.a.Ezb)){for(const sd of Vb)this.yXd(t,sd)&&(Na.delete(sd),qb=!0);0!==Na.size&&ed.add(ta);Jb&&qb&&ed.add(qn.a.SEc)}else ed.contains(qn.a.pG)||ed.add(ta);Jb=!ed.contains(qn.a.agb)}}},"BHA:SPH")}yXd(b,k){for(const t of b.KJk)if(k.equals(t))return!0;return!1}}Object(n.a)(wJ,"BookmarkHighlightActor",rc.a,[550]);var kG=c(1848),xJ=c(1636);class lG{constructor(b,
k,t,D,P,ca,ta,Na,qb,Jb){var Vb;this.mui=!1;this.Wf=b;this.Tz=k;this.eb=P;this.vV=ca;this.Oj=ta;this.he=Na;this.ld=Jb;this.Ma=qb;this.mui=null!==(Vb=null===qb||void 0===qb?void 0:qb.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckMultiRangeContextForTheme",!1))&&void 0!==Vb?Vb:!1}$9f(b,k,t,D){const P=b.gmh(k);if(P){var ca=Object(ob.a)(xJ.a,b),ta=this.he.Zf("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",ca,t)),Na=k.$j.node,qb=()=>
{t||this.removeImage(k.$j,P.getId())};ca=lG.Xxh();D=this.uyh(P.getId().toString(),Na,D,t);try{b.ssh(D,k)}catch(Jb){v.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+Jb.message);this.yp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);return}this.Wf.sj(ca,2,D.toString(),{},!0,0,Jb=>{v.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");
b.Jec(Jb,P,()=>{this.yp(b.CRd())},qb,Na,k,ta)},Jb=>{const Vb=415===Jb.data.Qe;let ac="";Jb&&Jb.data&&Jb.data.vj&&"X-CorrelationId"in Jb.data.vj&&Jb.data.vj["X-CorrelationId"]&&(ac=Jb.data.vj["X-CorrelationId"]);b.hpa(`Graphics editor request failed. HttpStatus [${Jb.data.Qe}], ResponseData [${Jb.data.xe}], CorrelationId [${ac}]`,P,Na,qb,()=>{this.yp(Vb?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.CRd())},ta,Vb)},null)}else this.yp(b.CRd())}zbo(b,k,t){return new Promise((D,
P)=>{var ca=b.$j,ta=null;ta=this.mui&&ci.a.vEf(ca)?ca.getContext(0).node:ca.node;ca=lG.Xxh();ta=this.uyh(k.toString(),ta,t,!1);ta.Ce(kG.a.S9e,"2");this.Wf.sj(ca,2,ta.toString(),{},!0,0,Na=>{v.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");D(Na.data.xe)},Na=>{v.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Na.data.Qe}, ResponseData ${Na.data.xe}`);
this.yp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);P(null)},null)})}uyh(b,k,t,D){const P=k.Bi(),ca=new eb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");w.AFrameworkApplication.Sea(ca);ca.Ce(kG.a.strict,this.CKm(k)?"true":"false");ca.Ce(Bi.a.nodeId,b);ca.Ce(Bi.a.cellId,P.wm.toString());ca.Ce(Bi.a.fileId,P.rr);ca.Ce(Bi.a.xT,t.toString());ca.Ce(kG.a.Fwl,D?"true":"false");if(b=!!this.ld&&this.ld.isFeatureEnabled(49)){ca.Ce(Rh.a.z0i,b.toString());if(b=this.ld.isFeatureEnabled(90))ca.Ce(Rh.a.SAn,
b.toString()),ca.Ce(Rh.a.ignoreMalformedColors,this.ld.isFeatureEnabled(56).toString());this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",!1)&&ca.Ce(Rh.a.aBn,"true")}ca.Ce(Rh.a.Nvh,"true");uh.a.instance.Wyb(ca);return ca}CKm(b){if(!this.Tz)return!1;b=this.Tz.Ts(b);return!!b&&b.Lf(Cc.a.gGf)}removeImage(b,k){b.cpBegin===b.cpEnd-1&&this.Oj.Vgc(b.node,k,this.eb,this.vV)}yp(b){const k=new Uc.StandardDialog;k.Ad=0;k.ix(zk.a.agf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,
b,null,b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);Wa.App.ya.updateCommandUI()}static Xxh(){const b=new eb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");w.AFrameworkApplication.Sea(b);return b.toString()}}Object(n.a)(lG,"GraphicsEditorRequestManager",null,[549]);class yJ extends xk{constructor(b,k){super(b,k);this.IPa=Pb.a.insertHyperlink}m2a(b){null!=b&&0<b.length&&this.pc.Qb(this.IPa,2,b[0])}KLj(b,k,t){const D=Xj.a.og(w.AFrameworkApplication.lcid).name;b=
String.format(b,w.AFrameworkApplication.lcid,D,w.AFrameworkApplication.buildVersion,k,xy.Xqe,t);b+="&flipgrid=1&ted=1";w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2Videos",!1)&&(b=new eb.QueryStringBuilder(b),b.FI("stream2","1"),w.AFrameworkApplication.K.$("GetCustomHeaderEnabled")&&b.FI("enablegetcustomheader","1"),b=b.toString());return b}}Object(n.a)(yJ,"InsertHubbleMediaHelper",xk,[]);class zJ{constructor(b,k,t,D,P,ca,ta){this.ga=
b;this.Ma=k;this.ald=t;this.s2=D;this.lid=P;this.Ik=ca;this.YVj=ta}Tb(){this.ga.fb(Nc.a.bYi,lc.a.Tc,this.avn.bind(this),1028);this.ga.fb(Nc.a.mri,lc.a.Tc,this.sAm.bind(this),1028)}sAm(b,k,t,D,P){if(1!==t){if(null==P)return 16;if(!k.al||!hf.SelectionEditor.gf(k))return 2;b=this.MTl(P);P=P.OriginalUrl;w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.lid.xrg(b,k,P)}return 32}LRj(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("OnlineVideoFloodgateIsEnabled")&&
window.setTimeout(()=>{const b=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(k=>{k.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}MTl(b){const k=new Zn;k.MediaType=b.ContentType;k.Height=b.Height;k.Width=b.Width;k.IFrameHtml=b.Html;k.Title=b.Caption;k.Thumbnail=b.ThumbnailUrl;k.ProviderName=b.ProviderName;return k}avn(b,k,t){var D,P;if(1!==t)k=F.a.SW(this.Ma.jb("UserId")).toString(),k=this.s2.KLj(this.Ma.appSettings.InsertVideoHubbleEndpoint,lb.a.create().toString(),
k),this.s2.IPa=Nc.a.mri,k=this.ald.nOc(k,!0),k.correlationId=lb.a.create(),k.Iha=5,k.mie(null,this.s2,this.YVj),ea.a.sendTelemetryEvent(Object.assign(new pa.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new na.a,{name:"ActionId",int64:b})]})),this.LRj();else if(!(k&&k.node&&Mw.a(k.node))||(null===(D=this.Ik)||void 0===D?0:D.i_(k))||(null===(P=this.Ik)||void 0===P?0:P.iha(k)))return 2;return 32}}Object(n.a)(zJ,"OnlineMediaActor",null,[]);const CM={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net",
"https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net","https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};class AJ extends NC{constructor(b,k,t,D=null,P=!1){super(b,k,t,D,P);this.Itc=null;this.OTf=()=>{this.Py&&(v.ULS.sendTraceTag(509092503,
352,50,`onGetCustomHeaders : Token available: ${!!this.IBa} time: ${(new Date).getTime()-this.ji}`),this.Py.sendMessage(K.a.Ijj,{["CustomHeaders"]:this.IBa||""}))}}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}vDb(){const b={};b.insertMediaServiceEndpoint=this.cld;b.iFrameId="mediaiframe";return b}async mie(b,k,t){t&&await this.refreshToken(t);this.NTb=b;this.Itc=k;this.Dsc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.vDb(),["componentIsVisibleCallback"]:this.KPj.bind(this)};
this.Wh(this.NTb,null,b)}KPj(){this.j0=this.j7b(this.kj("mediaiframe"));let b=this.cld;if(w.AFrameworkApplication.K.$("NewInsertMediaServiceEndpoint")){const k=new URL(b),t=CM[k.protocol+"//"+k.host];t?b=t:v.ULS.sendTraceTag(508937025,352,10,`Target URL: ${k.host} not found`)}this.Py=this.prd.getInstance(this.j0.contentWindow,b);this.Py.er(K.a.Pnh,k=>{this.GRi(k,this.Itc.m2a.bind(this.Itc))});this.Py.er(K.a.insert,k=>{this.S6d(k,this.Itc.m2a.bind(this.Itc))});this.Py.er(K.a.P6h,this.OTf.bind(this));
this.Py.er(K.a.getSessionId,this.FTi.bind(this));this.Py.er(K.a.x4h,this.CTi.bind(this));this.Py.er(K.a.yCd,this.pSi.bind(this));this.Znb(3)}Znb(b){const k=[];k.push(Object.assign(new na.a,{name:"DialogResult",string:MC[b]}));k.push(Object.assign(new na.a,{name:"DialogMode",string:this.Arf()}));k.push(Object.assign(new na.a,{name:"CorrelationId",string:this.correlationId.toString()}));k.push(Object.assign(new na.a,{name:"Provider",string:ZA[this.Iha]||"Unknown"}));ea.a.sendTelemetryEvent(Object.assign(new pa.a,
{name:this.telemetryEventName,dataFields:k}))}async refreshToken(b){this.ji=(new Date).getTime();try{const k=await b.PY("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");k.IsSuccess&&(this.IBa=k.Token);v.ULS.sendTraceTag(509092504,352,50,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: ${!!this.IBa} time: ${(new Date).getTime()-this.ji}`)}catch(k){v.ULS.sendTraceTag(508954306,352,10,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: false time: ${(new Date).getTime()-
this.ji} error: ${k} `)}}}Object(n.a)(AJ,"OnlineMediaDialog",NC,[]);class BJ{constructor(b,k){this.$De=b;this.s2=k}nOc(b,k=!1){return new AJ(b,this.$De,this.s2,null,k)}getInstance(){throw Error.notImplemented();}}Object(n.a)(BJ,"OnlineMediaDialogFactory",null,[556]);class CJ extends xv{constructor(){super(1,3);this.EL=Fa.a.instance.resolve("Common.IReactContextualUILauncher");this.uxj=!1}H6a(){w.AFrameworkApplication.va.processAction(Nc.a.Ajc,2)}kKd(){this.S_h&&!this.rv&&(this.rv=this.qKa())}$Kd(){if(this.rv&&
this.rv.isVisible){var b=Object(Ka.a)(Ui.Control,this.rv.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.Uw(b.phb(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)v.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var k=b.getBoundingClientRect();0<k.top&&k.bottom<window.innerHeight&&(k=b.getAttribute(df.a.SAd)||"",df.a.dM===k&&b.click())}}W_(){return this.EL.W_}}Object(n.a)(CJ,
"ExternalContentFloatieManager",xv,[]);class ds{constructor(){ds.Txm()}get sc(){return null!=this.pJg?this.pJg:this.pJg=Fa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get Pw(){return null}Rlc(b){var k=null;if(!pe.ParagraphReader.uh(b))return{returnValue:!1,nma:k};if((b=this.sc.Lo(b.currentNode))&&2===this.sc.RD(b)){const t=this.sc.kg(b);ds.iQ.contains(t)&&(k=this.sc.YK(b),k=Object.assign(new nr.a,{KG:this.key,contentId:b.id,contentObject:k}))}return{returnValue:!!k,
nma:k}}KDb(b,k){let t=null;k&&b.contentId.equals(k.contentId)||(t=b.contentObject);return t}static Txm(){ds.iQ=new Ij.a;ds.iQ.add(kk.StyleReader.styleIdHeading1);ds.iQ.add(kk.StyleReader.styleIdHeading2);ds.iQ.add(kk.StyleReader.styleIdHeading3);ds.iQ.add(kk.StyleReader.Y6a);ds.iQ.add(kk.StyleReader.ePb);ds.iQ.add(kk.StyleReader.fPb);ds.iQ.add(kk.StyleReader.mkc);ds.iQ.add(kk.StyleReader.lkc);ds.iQ.add(kk.StyleReader.wordStyleIdHeading1);ds.iQ.add(kk.StyleReader.wordStyleIdHeading2);ds.iQ.add(kk.StyleReader.wordStyleIdHeading3);
ds.iQ.add(kk.StyleReader.i8a);ds.iQ.add(kk.StyleReader.j8a);ds.iQ.add(kk.StyleReader.k8a);ds.iQ.add(kk.StyleReader.xqb);ds.iQ.add(kk.StyleReader.yqb);ds.iQ.add(kk.StyleReader.l8a);ds.iQ.add(kk.StyleReader.p8a);ds.iQ.add(kk.StyleReader.anc)}}ds.iQ=null;Object(n.a)(ds,"ParagraphStyleDetailsProvider",null,[481,417]);class DJ{constructor(b,k,t,D){this.vKa=b;this.A9j=k;this.I9j=t;this.J9j=D}V3f(){this.vKa.execute(b=>{b.Pgc(this.A9j.value);b.Pgc(new ds);b.Pgc(this.J9j.value);b.Q4(this.I9j.value)})}}Object(n.a)(DJ,
"AccessibilityActor",null,[]);class EJ{constructor(b,k,t){this.fi=null;this.Z7c=(D,P,ca)=>{if(1===ca)return 32;this.fi=this.qrc.value.b7k(this.Ub);if(!this.fi)return v.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.fi.iTa();return 32};this.Plh=D=>this.fi?this.fi.fnm(D):2;this.ga=b;this.qrc=k;this.Ub=t}Tb(){if(w.AFrameworkApplication.K.$("UIDiscoverabilityEnabled")){var b=Zb.KeyInputManager.kc(pc.a.Mqb,5);this.Ub.ge(ef.AFrame.Pn).ir(b);this.Ub.ge(ef.AFrame.rp).bindAction(b,
$a.a.Z7c);this.ga.qa($a.a.Z7c,Ud.a.frame,this.Z7c);this.ga.qa($a.a.XCc,Ud.a.frame,this.Plh);this.ga.qa($a.a.WCc,Ud.a.frame,this.Plh)}}}Object(n.a)(EJ,"AccessibilityHelpDialogActor",null,[]);var DM=c(1036),EM=c(1389);class FJ{constructor(b,k){this.s4j=b.mc("WordHangForActionManagerThresholdTime",750);this.ga=k;this.STj=DM.a.eF(26,5,new EM.a)}AY(){this.ga.AY(this)}C4(){}A4(b){const k=+b.endTime-+b.startTime;if(k>this.s4j){let t="";switch(b.behavior){case 1:t="E";break;case 2:t="X";break;case 3:t="A"}(b=
Xc.ActionManager.raa(b.actionId))&&b.length||(b="UnknownAction");this.STj.track(k,b+"_"+t)}}}Object(n.a)(FJ,"ActionHangDetector",null,[36]);var GJ=c(1469);class HJ extends yf{constructor(b){super(b,void 0,w.AFrameworkApplication.G_a,new Mg(b,!1))}get f4a(){return this.WXd?CommonUIStrings.l_DownloadACopyDialog_CopyALinkText:this.hYd?CommonUIStrings.l_DownloadACopyDialog_EmailALinkText:CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get Ecc(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get tXc(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get qIc(){return w.AFrameworkApplication.G_a?
"UIFontDialogTextLarge":null}get WXd(){return 1===w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",0)}get hYd(){return 2===w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",0)}iKf(){v.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed");w.AFrameworkApplication.Aha("t1shrdnl;t2shrdnl;c-shrdnl")}jKf(){v.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}NXc(){v.ULS.sendTraceTag(19462214,
324,50,"Download a copy dialog button clicked");w.AFrameworkApplication.va.processAction($a.a.wTh,2)}m$e(){this.Z7({SourceControlId:"CopyLink"},{ControlId:"CopyLink"})}FUh(){this.Z7({SourceControlId:"Share"},{ControlId:"Share"})}Z7(b,k){const t=w.AFrameworkApplication.va;t.zD=8;t.Qb($a.a.Z7,2,b,k)}}Object(n.a)(HJ,"DownloadACopyDialog",yf,[]);var mG;(function(b){b[b.Unknown=0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";
b[b.Project=6]="Project";b[b.Publisher=7]="Publisher";b[b.Infopath=8]="Infopath";b[b.Access=9]="Access"})(mG||(mG={}));Object(n.b)("OfficeApplication",mG);var yF;(function(b){b[b.ReadWrite=0]="ReadWrite";b[b.ReadOnly=1]="ReadOnly";b[b.WriteOnly=2]="WriteOnly";b[b.ForceCheckout=3]="ForceCheckout";b[b.WriteLocalCopy=4]="WriteLocalCopy";b[b.OpenInBrowser=5]="OpenInBrowser"})(yF||(yF={}));Object(n.b)("OpenDocumentMode",yF);class IJ extends Wf.a{constructor(){super(!1,!1,!0)}s8d(){var b={["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",
["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const k=Array(5);k[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};k[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};k[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};k[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};k[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",
["options"]:k};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.Wh("Send feedback to Microsoft",this.bjo.bind(this),b);return new Promise(t=>{this.zbk=t})}bjo(b,k){1===b&&this.JR(k.selectedReason)}dispose(){super.dispose();this.zbk()}JR(b){const k={},t={},D={},P={},ca={};k.appId=2155;k.manifestType="Fps";k.submitTime=(new Date).toISOString();k.source="Client";k.type="Survey";k.clientFeedbackId=lb.a.create().toString();ca.reason=b;const ta={},Na={numberOfOptions:5};Na.selectedRating=
b;ta.rating=[Na];P.surveySpecificData=JSON.stringify(ta);D.extendedManifestData=JSON.stringify(P);k.application=D;ca.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";k.survey=ca;k.telemetry=this.Nzb();k.web=this.bFc();t["Content-Type"]="application/json";this.RGa(JSON.stringify(k),t)}vaa(b,k,t,D){k&&b&&D&&t&&D in k&&(b[t]=k[D])}Nzb(){const b=w.AFrameworkApplication.sessionStartInfoSettings,k={};k.officeBuild=w.AFrameworkApplication.buildVersion;k.featureArea="Open In Desktop App";this.vaa(k,b,"audienceGroup",
"AudienceGroup");this.vaa(k,b,"osBuild","OsVersion");this.vaa(k,b,"platform","Platform");this.vaa(k,b,"processSessionId","WACSessionID");return k}bFc(){const b=w.AFrameworkApplication.sessionStartInfoSettings,k={};this.vaa(k,b,"browser","Browser");this.vaa(k,b,"browserVersion","BrowserVersion");this.vaa(k,b,"dataCenter","WACDatacenter");return k}RGa(b,k,t=0){let D=0;3<t||(1===t?D=200:1<t&&(D=200+500*(t-1)),w.AFrameworkApplication.nc.Vb(new Df.a(2,1,D,()=>{w.AFrameworkApplication.Ne.sj("https://petrol.office.microsoft.com/v1/feedback",
2,b,k,!1,2,()=>{v.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},()=>{this.RGa(b,k,t+1);v.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",t)},null)})))}}Object(n.a)(IJ,"WordOpenInClientFeedbackDialog",Wf.a,[]);var JJ=c(1745);const ME=b=>{for(let k=0;k<b.children.length;k++){const t=b.children[k];t.style.position="relative";t.style.top=(t.parentNode.offsetHeight-t.offsetHeight)/2+"px"}},nG=b=>b.Gb.keyCode===pc.a.zs||
b.Gb.keyCode===pc.a.LIa?(b.zf.click(),!0):!1,zF=(b,k,t,D,P,ca,ta)=>{const Na=document.createElement("a");Na.className="ProtocolLaunchingDialogButtonAnchor";Na.className+=" OICDialog";Na.id=b;Na.setAttribute(df.a.qh,df.a.e3);Na.style.padding="0";Na.style.margin="0";D&&KJ(P,k,t,D,Na);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=P;Na.appendChild(b);Na.tabIndex=0;ca&&Zh.a.instance.lb(Rc.a.click,Na,ca);ta&&Zb.KeyInputManager.instance.lb(Rc.a.vh,Na,ta);return Na},
KJ=(b,k,t,D,P)=>{var ca=document.createElement("img");ca.alt=b;ca.className=od.getImageClassWithCluster(t,D);ca.src=k;ca.setAttribute(df.a.qh,df.a.Yy);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(ca);ca=document.createElement("span");ca.className="ProtocolLaunchingDialogIconContainer";ca.appendChild(b);P.appendChild(ca)};class oG{static get Xg(){return Wf.a.lA(oG.Lm,CommonUIStrings.l_OICLaunchDialogTitle)}}oG.Lm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(n.a)(oG,"OICLaunchDialogHtml",null,[]);class LJ extends Wf.a{constructor(b){super();this.vSb=this.urb=null;this.pS=!1;this.nq=b;this.Xg=oG.Xg;this.Ad=5;this.vg="OICLaunchDialog";this.showDialog("",Object(A.a)(this,this.Shn,"oicLaunchDialogResultHandler"));this.Nkj();this.Z4("ProtocolLaunchingDialogTitle");4!==w.AFrameworkApplication.ta.Nb.XNa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.R0(this.urb);v.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}W8(){this.urb=zF("BtnRichClient",this.nq.DJc,this.nq.PRc,this.nq.Ryf,CommonUIStrings.l_OICLaunchRichClient,Object(A.a)(this,this.eWi,"onRichClientButtonClick"),nG);document.getElementById("OICLaunchRichClient").appendChild(this.urb);ME(this.urb);this.vSb=zF("BtnReturn",this.nq.DJc,this.nq.PRc,this.nq.Toi,CommonUIStrings.l_OICReturnToOnlineClient,Object(A.a)(this,this.ZVi,"onReturnButtonClick"),
nG);document.getElementById("OICReturnToApp").appendChild(this.vSb);ME(this.vSb)}ZVi(){this.hide();this.nq.mhc();return!0}eWi(){v.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();w.AFrameworkApplication.va.processAction($a.a.cNb,2);return!0}Shn(){this.nq.mhc()}dispose(){this.pS||(this.urb&&(Zh.a.instance.rc(Rc.a.click,this.urb,Object(A.a)(this,this.eWi,"onRichClientButtonClick")),Zb.KeyInputManager.instance.rc(Rc.a.vh,this.urb,nG)),this.vSb&&(Zh.a.instance.rc(Rc.a.click,
this.vSb,Object(A.a)(this,this.ZVi,"onReturnButtonClick")),Zb.KeyInputManager.instance.rc(Rc.a.vh,this.vSb,nG)),super.dispose(),this.pS=!0)}}Object(n.a)(LJ,"OICLaunchDialog",Wf.a,[]);class pG{static get Xg(){return Wf.a.lA(pG.Lm,CommonUIStrings.l_OICDialogTitle)}}pG.Lm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(n.a)(pG,"ProtocolLaunchingDialogV2Html",null,[]);class MJ extends Wf.a{constructor(b){super();this.uSb=this.NUa=null;this.pS=!1;this.i9a=null;this.nq=b;this.Xg=pG.Xg;this.Ad=5;this.vg="ProtocolLaunchingDialog";this.Pqc="OICRetryDialog";w.AFrameworkApplication.nc.zFb&&w.AFrameworkApplication.nc.restart();w.AFrameworkApplication.nc.Vb(new Df.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(A.a)(this,this.S0f,"protocolLaunchingDialogResultHandler"));this.Nkj();this.Z4("Issues");
this.j0h();v.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}W8(){const b=document.getElementById("Issues");if(b){KJ("",this.nq.DJc,this.nq.PRc,this.nq.Ryf,b);const k=document.createElement("span");k.className="WACDialogSectionTitle";k.innerText=5===this.nq.PXi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(k);ME(b);b.style.display="none"}w.AFrameworkApplication.ta.Nb.Bji?
(this.uSb=zF("GiveFeedback",this.nq.DJc,this.nq.PRc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(A.a)(this,this.E6d,"onGiveFeedbackClick"),Object(A.a)(this,this.HTi,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.uSb),ME(this.uSb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===w.AFrameworkApplication.ta.Nb.XNa||w.AFrameworkApplication.aml?document.getElementById("ButtonEdit").style.display="none":(this.NUa=
zF("Edit",this.nq.DJc,this.nq.PRc,"",2===w.AFrameworkApplication.ta.Nb.Sl?4===w.AFrameworkApplication.ta.Nb.XNa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===w.AFrameworkApplication.ta.Nb.XNa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(A.a)(this,this.iTi,"onEditClick"),Object(A.a)(this,this.lTi,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.NUa),ME(this.NUa));0===w.AFrameworkApplication.ta.Nb.XNa&&
!w.AFrameworkApplication.HEf&&b&&(b.style.display="none")}k0h(){return this.i9a?(this.R0(this.i9a),!0):!1}j0h(){return this.NUa?(this.R0(this.NUa),!0):!1}lTi(b){return this.OSf(b,0)}HTi(b){return this.OSf(b,2)}YVi(b){return this.OSf(b,1)}OSf(b,k){let t=!1;if(b.Gb.keyCode===pc.a.zs||b.Gb.keyCode===pc.a.LIa)b.zf.click(),t=!0;else if(b.Gb.keyCode===Sys.UI.Key.down||b.Gb.keyCode===Sys.UI.Key.up)switch(k){case 1:t=this.j0h();break;case 0:t=this.k0h()}return t}iTi(){this.hide();4===w.AFrameworkApplication.ta.Nb.XNa?
(v.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.nq.mhc()):(v.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.nq.gQc());return!0}E6d(){v.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}wUf(){ZL.Redirect.showHelp("OICFailure");return!0}C7d(){v.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";w.AFrameworkApplication.va.processAction($a.a.cNb,2);return!0}S0f(){this.nq.mhc()}switchToBackupMode(){var b=
document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!b.children.length&&(this.i9a=zF("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(A.a)(this,this.C7d,"onRetryOICClick"),Object(A.a)(this,this.YVi,"onRetryOICKeyUp")),b.appendChild(this.i9a),ME(this.i9a),this.NUa||this.k0h())}}dispose(){this.pS||(this.NUa&&
(Zh.a.instance.rc(Rc.a.click,this.NUa,Object(A.a)(this,this.iTi,"onEditClick")),Zb.KeyInputManager.instance.rc(Rc.a.vh,this.NUa,Object(A.a)(this,this.lTi,"onEditKeyUp"))),this.uSb&&(Zh.a.instance.rc(Rc.a.click,this.uSb,Object(A.a)(this,this.E6d,"onGiveFeedbackClick")),Zb.KeyInputManager.instance.rc(Rc.a.vh,this.uSb,Object(A.a)(this,this.HTi,"onGiveFeedbackKeyUp"))),this.i9a&&(Zh.a.instance.rc(Rc.a.click,this.i9a,Object(A.a)(this,this.C7d,"onRetryOICClick")),Zb.KeyInputManager.instance.rc(Rc.a.vh,
this.i9a,Object(A.a)(this,this.YVi,"onRetryOICKeyUp"))),super.dispose(),this.pS=!0)}}Object(n.a)(MJ,"ProtocolLaunchingDialog",Wf.a,[]);class qG extends Uc.StandardDialog{constructor(b){super();this.nq=b;this.vg="ProtocolLaunchingDialog";w.AFrameworkApplication.nc.zFb&&w.AFrameworkApplication.nc.restart();w.AFrameworkApplication.ta.Nb.Bji&&this.ork(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(A.a)(this,this.E6d,"onGiveFeedbackClick"));qG.Cli?(this.Ad=12,this.Ee(1,CommonUIStrings.l_CloseFile),
this.Ee(2,CommonUIStrings.l_OICDialogContinueHere),this.Ee(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Ad=4,this.Ee(1,CommonUIStrings.l_OICDialogContinueHere),this.Ee(2,CommonUIStrings.l_OICDialogLaunchAgain));this.glb(CommonUIStrings.l_OICDialog2ndTitle,5===this.nq.PXi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(A.a)(this,this.S0f,"protocolLaunchingDialogResultHandler"),null)}E6d(b){v.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.rTi(b)}C7d(){v.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");w.AFrameworkApplication.va.processAction($a.a.cNb,2)}S0f(b){qG.Cli?3===b?this.Ddj():2===b||0===b?this.continueEditing():1===b&&this.closeDocument():2===b?this.Ddj():(1===b||0===b)&&this.continueEditing()}closeDocument(){v.ULS.sendTraceTag(577783557,211,50,"Closing the document");w.AFrameworkApplication.va.Qb($a.a.close,2,$g.a)}Ddj(){v.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(A.a)(this,this.C7d,
"onRetryOICClick"),0)}continueEditing(){4===w.AFrameworkApplication.ta.Nb.XNa||w.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===w.AFrameworkApplication.ta.mode?(v.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.nq.mhc()):(v.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.nq.gQc())}static get Cli(){return w.AFrameworkApplication.K.$("OICDialogThreeActions")&&32===w.AFrameworkApplication.va.processAction($a.a.close,
1)}}Object(n.a)(qG,"StandardProtocolLaunchingDialog",Uc.StandardDialog,[]);class NJ{}Object(n.a)(NJ,"EditDocumentInClientParams",null,[]);class eH{static WTh(b,k,t,D,P,ca,ta=!1,Na=!1,qb="",Jb=!1,Vb=!1,ac=!1,yc="",Kc="",ed="",sd=!1,oe=""){const Ld=new NJ;Ld.DocumentUrl=b;Ld.DocumentExtension=oe;Ld.Mode=k;Ld.Options=t;Ld.Application=D;Ld.SilentExternalHandler=ta;Ld.EncodeUrl=Na;Ld.CorrelationIdForWinClient=qb;Ld.NavigateUsingWindowOpen=Jb;Ld.DescriptiveUnattemptedEnums=Vb;Ld.NoBrowserModalDialogs=ac;
Ld.SessionOrigin=yc;Ld.CorrelationId=Kc;Ld.ClickTime=ed;Ld.NewTelemetryDataIsEnabled=sd;MSOJS.ClientUtils.EditDocumentInClient(Ld,P,ca)}}Object(n.a)(eH,"ClientUtils",null,[]);var FM=c(537),OJ=c(941);class WD{constructor(b){this.mXa=this.Prc=this.Kpc=null;this.ctc=!1;this.pye=this.hJe=this.j8g=null;this.dfd=this.Ky=this.Ytd="";this.application=this.Oy=0;this.$Co=this.chg=!1;this.yYo=b&&w.AFrameworkApplication.K.$("OICLaunchDialogIsEnabled");w.AFrameworkApplication.va.v_($a.a.cNb)||w.AFrameworkApplication.va.qa($a.a.cNb,
Ud.a.frame,Object(A.a)(this,this.e6n,"retryOpenInClientAction"));this.fsj=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("SilentExternalHandler")}get PXi(){return this.Oy}Plo(b,k="",t=""){this.Ky=t||lb.a.create().toString();this.Ytd=k||FM.a.Jbi();this.dfd=b}e6n(b,k,t){return k.contextId!==Ud.a.frame?2:1===t?32:this.cNb()}get options(){let b=0;w.AFrameworkApplication.d3n&&(b|=1);w.AFrameworkApplication.VXi&&(b|=4);this.TCo()&&(b|=64);return b}TCo(){return!(2===this.application&&w.AFrameworkApplication.K.$("IsEmbeddedScenario"))}get DJc(){return w.AFrameworkApplication.Rs}get PRc(){return w.AFrameworkApplication.Dba}get Toi(){return""}get Ryf(){return""}get ZCo(){return w.AFrameworkApplication.K.$("OneNoteMobileViewerIsEnabled")}get IGo(){return this.j8g||
(this.j8g=Fa.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.chg||this.bwl()}mhc(){this.$Co||this.sXh()}g6i(b){return this.yYo&&aa.a.ti?(new LJ(this),32):this.rGh(b)}rGh(b){const k=({Spb:b}=this.hWm(b)).returnValue;v.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===k,b);return k}begin(b,k,t,D,P,ca,ta=""){this.Kpc=b;this.pye=ta;this.Prc=k;this.mXa=ca;this.application=t;this.Oy=D;return w.AFrameworkApplication.DTh?(this.pEi(),32):w.AFrameworkApplication.Noa&&
!w.AFrameworkApplication.yni?(w.AFrameworkApplication.yeg(),8):this.Tvh(P)}get Rhn(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}cNb(){this.Rhn&&this.K_m();return this.rGh(this.ctc)}Xhj(){const b=new OJ.a(K.a.openInClient);b.Values["ui-language"]=w.AFrameworkApplication.lcid.toString();b.Values[LC.a.LNh]=w.AFrameworkApplication.userSessionId;return this.mXa.value.send(b)?32:8}K_m(){xa.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Db.a,{inStaging:!0}))}pco(b){const k=new OJ.a(K.a.t0o);k.Values["ui-language"]=w.AFrameworkApplication.lcid.toString();k.Values[LC.a.LNh]=w.AFrameworkApplication.userSessionId;k.Values[I.a.s0o]=b;this.mXa.value.send(k)}hWm(b){this.ctc=b;this.pco(5===this.Oy?WD.Jun:WD.Pun);return 5===this.Oy?this.gWm():this.kWm()}gWm(){this.zEi();return{returnValue:32,Spb:"HostEditUrl,"}}kWm(){let b;var k=b="";w.AFrameworkApplication.Koh&&(k="|f|"+w.AFrameworkApplication.userSessionId);
const t=w.AFrameworkApplication.K.$("IsAssignmentMode")&&w.AFrameworkApplication.K.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||w.AFrameworkApplication.dWc||aa.a.uQa,D=w.AFrameworkApplication.K.$("UnattemptedEnumIsEnabled"),P=w.AFrameworkApplication.K.$("NoBrowserModalDialogs");if(w.AFrameworkApplication.va.d5d){var ca=w.AFrameworkApplication.va.BX(3588168074);ca&&this.Plo(ca.epochClickTime,ca.sessionOrigin,ca.correlationId);this.nJi()}if(w.AFrameworkApplication.F1i){b+="NewOrder,";
ca=8;this.mXa&&this.mXa.value&&this.mXa.value.isEnabled()&&w.AFrameworkApplication.NQb&&(b+="Post,",ca=this.Xhj());if(32===ca)return{returnValue:ca,Spb:b};v.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return w.AFrameworkApplication.ps.c9?(v.ULS.shipAssertTag(5566816,211,!!w.AFrameworkApplication.ps.c9),b+="HostUrl,",{returnValue:w.AFrameworkApplication.ta.CU(!0,w.AFrameworkApplication.ps.c9),Spb:b}):this.Kpc?(v.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
w.AFrameworkApplication.userSessionId),b+="DocUrl,",eH.WTh(this.Kpc,this.Oy,this.options,this.application,Object(A.a)(this,this.kTi,"onEditInClientSuccess"),Object(A.a)(this,this.jTi,"onEditInClientFailure"),this.fsj,w.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),k,t,D,P,this.Ytd,this.Ky,this.dfd,w.AFrameworkApplication.va.d5d,this.pye),{returnValue:32,Spb:b}):{returnValue:8,Spb:b}}b+="OldOrder,";if(!this.Kpc&&w.AFrameworkApplication.ps.c9)return this.mXa&&this.mXa.value&&this.mXa.value.isEnabled()&&
w.AFrameworkApplication.NQb?(b+="Post,",k=this.Xhj()):(v.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),k=8),32!==k?(v.ULS.shipAssertTag(22595484,211,!!w.AFrameworkApplication.ps.c9),b+="HostUrl,",{returnValue:w.AFrameworkApplication.ta.CU(!0,w.AFrameworkApplication.ps.c9),Spb:b}):{returnValue:k,Spb:b};v.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",w.AFrameworkApplication.userSessionId);b+="DocUrl,";eH.WTh(this.Kpc,
this.Oy,this.options,this.application,Object(A.a)(this,this.kTi,"onEditInClientSuccess"),Object(A.a)(this,this.jTi,"onEditInClientFailure"),this.fsj,w.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),k,t,D,P,this.Ytd,this.Ky,this.dfd,w.AFrameworkApplication.va.d5d,this.pye);return{returnValue:32,Spb:b}}i2n(b){w.AFrameworkApplication.Qm.setDw(8981,b)}kTi(b){this.i2n(b);v.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?(this.ZCo||this.zEi(),
this.nJi()):this.chg||this.closeApplication()}jTi(b,k=0){v.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,k);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const t=!!this.Prc&&!this.ctc;let D=0;1===b&&(D=2);6<=b&&13>=b&&(D=1,1===k&&(this.chg=!0));this.IGo.Bhn?(v.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",D),JJ.a.instance.Lal(this.ctc?Object(A.a)(this,this.rRi,"oicErrorDialogHandlerCloseForced"):
Object(A.a)(this,this.sRi,"oicErrorDialogHandlerNoCloseForced"),t?Object(A.a)(this,this.jUi,"onLaunchDownload"):null,this.tRh(!1)?Object(A.a)(this,this.Fsm,"iHaveOfficeButtonHandler"):null,D,k)):(v.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",D),JJ.a.instance.Jal(this.ctc?Object(A.a)(this,this.rRi,"oicErrorDialogHandlerCloseForced"):Object(A.a)(this,this.sRi,"oicErrorDialogHandlerNoCloseForced"),t?Object(A.a)(this,this.jUi,"onLaunchDownload"):null,D))}}nJi(){try{const b=
[Object.assign(new na.a,{name:"CorrelationId",string:this.Ky}),Object.assign(new na.a,{name:"SessionOrigin",string:this.Ytd}),Object.assign(new na.a,{name:"ClickTime",string:this.dfd}),Object.assign(new na.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];bf.a("OpenInClientCompleted",!0,0,b)}catch(b){v.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}zEi(){w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nF&&w.AFrameworkApplication.K.$("StandardProtocolDialogIsEnabled")?
new qG(this):new MJ(this)}rRi(){this.closeApplication()}sRi(){this.mhc()}jUi(){this.pEi()}Fsm(){return this.tRh(!0)}tRh(b){const k=(aa.a.pUc||aa.a.Xt)&&!!w.AFrameworkApplication.CId;k&&b&&($d.a.nm(w.AFrameworkApplication.CId,"_blank",void 0,"OpenInClient"),this.closeApplication());return k}}WD.Pun="OpenInDesktop";WD.Jun="OpenInBrowser";Object(n.a)(WD,"AOpenInClientOperation",null,[]);class fH extends WD{constructor(b,k,t=!1){super(t);this.F5j=b;this.E5j=k}get Toi(){return this.E5j}get Ryf(){return this.F5j}bwl(){w.AFrameworkApplication.va.Qb($a.a.close,
2,$g.a)}sXh(){}Tvh(b){return this.g6i(b)}pEi(){v.ULS.shipAssertTag(5566817,211,!!this.Prc);w.AFrameworkApplication.Oba?w.AFrameworkApplication.ta.CU(!0,this.Prc):$d.a.nm(this.Prc,void 0,void 0,"LaunchDownload")}gQc(){w.AFrameworkApplication.ta.Nb.gQc()}}Object(n.a)(fH,"OpenInClientOperation",WD,[]);class PJ extends fH{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0);this.EWn=b=>{v.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");Wa.App.fV.forceOutbound(this.fYi,
this.h_m,b)};this.h_m=b=>{v.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const k=new Uc.StandardDialog;k.Ad=0;k.ix(zk.a.UOo,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.f_m:this.g_m)};this.f_m=()=>{w.AFrameworkApplication.va.Qb($a.a.close,2,$g.c)};this.g_m=()=>{Wa.App.ya.refreshDocument(null)};this.fYi=b=>{w.AFrameworkApplication.u9c=!0;v.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);
this.g6i(b)}}KIk(b){Wa.App.Lj.fGa.$Fb||Wa.App.rd.OA.jo?(v.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.fYi(b)):Nv.a.FQ(4,!0,this.EWn,null,b)}Tvh(b){this.KIk(b);return 32}sXh(){Wa.App.ya.refreshDocument(null)}}Object(n.a)(PJ,"OpenInWordOperation",fH,[]);const QJ=(b,k)=>{v.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");b[kg.a.On]=Yg.PageReader.instance.jv(k);Yg.PageReader.instance.jv(k)?b[kg.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:
b[kg.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},GM=(b,k,t,D,P)=>{if(!Wa.App.ya||!Wa.App.ya.gb||!w.AFrameworkApplication.un.Zgb)return 8;k=Wa.App.ya.gb.Uc;if(!k)return 8;if(b===Pb.a.tae&&2===t){b=new Xd.GraphTransaction(15);try{b.Cb(k),Yg.PageReader.instance.zIo(k)}finally{b&&b.dispose()}QJ(P,k)}return 32},HM=(b,k,t,D,P)=>{if(!Wa.App.ya||!Wa.App.ya.gb)return 8;b=Wa.App.ya.gb.Uc;if(!b)return 8;P[kg.a.Alt]=w.AFrameworkApplication.un.Zgb?"":CommonUIStrings.l_ProtectDocumentToolTip;
QJ(P,b);return 32};class RJ extends GJ.a{constructor(b,k){super(b,k);this.r1g=!1;this.QUi=(t,D,P,ca,ta)=>{var Na;if(D.contextId!==Ud.a.frame)return 2;if(!(Wa.App.lGc||w.AFrameworkApplication.ps.c9||w.AFrameworkApplication.NQb||this.r1g))return v.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.r1g=!0,8;if(1===P)return $b.SessionStatusManager.instance.wj?8:32;let qb=!1;void 0!==ta&&null!==ta&&(qb=ta);if(null===(Na=w.AFrameworkApplication.K)||void 0===Na?0:Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",
!1))(new IJ).s8d().then(()=>this.IKb(t,qb));else return this.IKb(t,qb);return 32};this.tmc=(t,D,P)=>{2==P&&(bf.a("OpenFileFromPC"),Wa.App.Igb(w.AFrameworkApplication.breadcrumbBrandUrl));return 32};this.eol=t=>{this.z0m();if(!w.AFrameworkApplication.dWc&&w.AFrameworkApplication.ta.Nb.Kcg($a.a.downloadACopy.toString()))this.wya(!0,K.a.download,!0,{});else if(w.AFrameworkApplication.K.$("WordEditorDownloadACopyUiIsEnabled")){let D=w.AFrameworkApplication.eCb;t&&t.FileDownloadUrl&&(D=t.FileDownloadUrl.toString());
new HJ(D)}else super.downloadACopy(0,null,2,null,null)};this.UQk=t=>{super.workflow(0,null,2,null,t)};this.BI=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback")}Tb(){super.Tb();this.ga.qa(Pb.a.openInClient,Ud.a.frame,this.QUi);w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.Vc(Pb.a.openInClient,12288);var b=this.ga;b.fb(Pb.a.tae,lc.a.application,GM,4);b.fb(Pb.a.V1f,lc.a.application,HM,96);this.ga.qa($a.a.HWf,
Ud.a.frame,this.QUi);this.ga.qa(Pb.a.tmc,lc.a.view,this.tmc)}IKb(b,k){v.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new PJ).begin(Wa.App.lGc,w.AFrameworkApplication.eCb,mG.Word,b===$a.a.HWf?yF.OpenInBrowser:yF.WriteOnly,k,new Rg.a(()=>this.KX))}qBd(b){return cj.a.instance.KCa()?!0:Wa.App.ya.sfj(1,wg.AppFrame.SYk,b)}downloadACopy(b,k,t,D,P){if(2===t){if(!w.AFrameworkApplication.eCb&&!w.AFrameworkApplication.ta.Nb.Kcg($a.a.downloadACopy.toString()))return 8;
Nv.a.FQ(2,!0,this.eol,null,P);this.Zpe();return 32}return super.downloadACopy(b,k,t,D,P)}Zpe(){w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.BI&&(v.ULS.sendTraceTag(509145740,306,50,"DownloadCopyIntercept logged for: DownloadACopy"),this.BI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}z0m(){w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=
this.BI&&this.BI.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,k,t,D,P){return 2===t?(Nv.a.FQ(13,!0,this.UQk,null,P),32):super.workflow(b,k,t,D,P)}}Object(n.a)(RJ,"AppFrameCommandUIActor",GJ.a,[]);class SJ extends Uc.StandardDialog{constructor(){super();this.Ad=0;this.glb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,
null,null)}}Object(n.a)(SJ,"WheresTheSaveButtonDialog",Uc.StandardDialog,[]);const IM=(b,k,t)=>{if(1===t)return 32;new SJ;return 32};var gH=c(539),TJ=c(1357);class Os extends bh.a{constructor(b,k,t,D,P,ca,ta=null){var Na,qb;super();this.zcc=ta;this.JWj=50;this.KWj=56;this.Oyc="px";this.Nse="aria-label";this.mJa="BookmarkIndicator";this.$Xg="HighlightBookmarkedContent";this.M4j="HighlightBookmark";this.SVa="wwaengidc";this.WJk="Bookmark_24";this.eb=b;this.hg=t;this.rk=k;this.RV=D;this.Oz=P;this.OWj=
null===(Na=w.AFrameworkApplication.K)||void 0===Na?void 0:Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1);this.FWj=null===(qb=w.AFrameworkApplication.K)||void 0===qb?void 0:qb.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkHighlightIsEnabled",!1);this.Oz&&this.Oz.vzd(this.KB.bind(this));this.tI=ca}Too(b){if(b.yj){for(const k of b.Pg.Ri)if(this.Goj(k))return!0;return!1}return this.Goj(b.htmlElement)}Dob(b){let k=!1;w.AFrameworkApplication.ue("bookmarks-core-ex;bookmarks-core-ex-cf");
this.OWj&&pr.a.instance.ie(()=>{k=this.Too(b)},"BIA:SCIVE");return k}Goj(b){return Os.QRe?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<b.length?!0:!1:!1}cfb(b){const k=[];pr.a.instance.ie(()=>{const t=b.geb(0,this.tI?this.KWj:this.JWj,this.zoom);k.push(this.hDa(b.I4,t,b.Pmc[0].y-b.Jba[0].y))},"BIA:CIs");return k}hDa(b,k,t){const D=b.eh.ownerDocument,P=eh.a.createElement(D,Eh.a.div);P.className=this.tI?Os.NWj:Os.Bte;Os.Bte;P.style.left=k+this.Oyc;
P.style.top=t+this.Oyc;this.tI?(k=eh.a.createElement(D,Eh.a.div),Qg.a("renderIcon")&&appChrome.api.renderIcon(this.WJk,k),k.setAttribute("role","img"),k.setAttribute("alt","Bookmark")):(k=eh.a.createElement(D,Eh.a.$1a),k.src=Nh.a.ug(Os.Bed),k.alt="Bookmark");k.title="Bookmark";k.setAttribute(this.Nse,"Bookmark");P.appendChild(k);b={context:new jG([],P,new Set,new Set,null,null),SRf:b,container:P};this.tI||(this.rk.lb(Rc.a.mR,k,this.onMouseEnter),this.rk.lb(Rc.a.eL,k,this.fpa));this.hg.dE(Rc.a.click,
P,this.kGa.bind(this),b);return P}FDd(){const b=Object.assign(new qg.a,{action:1,type:5,sA:null,BJ:this.Jda});this.Jda=null;this.RV.BF(b)}KB(b,k){this.Jda&&(k.e0a.zf.classList.contains("BookmarkHighlightSelected")||this.FDd())}onMouseEnter(b){if(null==b)return!1;b=b.zf;b.parentElement.classList.add(Os.tMg);b.src=Nh.a.ug(Os.HWj);return!0}fpa(b){if(null==b)return!1;b=b.zf;b.parentElement.classList.remove(Os.tMg);b.src=Nh.a.ug(Os.Bed);return!0}kGa(b){this.q5a(this.$Xg,this.M4j);if(null==b){var k=new Map;
k.set("Source",this.mJa);k=Object.assign(new Db.a,{additionalValues:k});xa.Health.instance.recordKpiFailure(this.$Xg,"Unable to highlight bookmarked content",!1,!0,k);return!1}w.AFrameworkApplication.ue("bookmarks-highlight-ex;bookmarks-highlight-ex-cf");if(this.FWj){k=b.Oo.context;if(Os.h3a(k,this.Jda))return!0;k=this.rqf(b.Oo.SRf,k,b.Oo.container);b=Object.assign(new qg.a,{action:0,type:5,sA:k,BJ:this.Jda});this.Jda=k;this.RV.BF(b);return!0}return!1}rqf(b,k,t){k={Ewh:new Set,PKb:new Set,Hwh:null,
q3e:null};const D=this.eb.jw(b.Bb,!0,!1),P=[];if(D)for(const ca of D)P.push(ca);this.Ksk(b,k,P);k=new jG(P,t,k.Ewh,k.PKb,k.Hwh,k.q3e);this.Jda&&this.Jda.ar===P&&(t.className+=String.format(" {0}",Os.IWj),this.Jda=k);return k}Ksk(b,k,t){if(b.yj){const P=new Set;for(const ca of b.Pg.Ri)ca.querySelectorAll("*").forEach(P.add,P);b=Array.from(P.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),0);let D=[];k.PKb.add(t[0].id);k.Hwh=t[0].id;k.q3e=t[0].id;b.forEach(P=>{const ca=
jd.a.Db(P,qn.a.EBd);if(ca)for(const ta of ca)D.push(ta),k.Ewh.add(ta);if(!D.length)return!0;P=jd.a.Db(P,qn.a.Ezb);if(!P)return!0;D=TJ.a.Sgc(D,P)});for(b=this.eb.ig(t[t.length-1],!1,!0);D.length&&b;)k.PKb.add(b.id),k.q3e=b.id,t.push(b),this.zcc.value.Qj(b).htmlElement.querySelectorAll("."+qn.a.p3e).forEach(P=>{(P=jd.a.Db(P,qn.a.Ezb))&&(D=TJ.a.Sgc(D,P))}),b=this.eb.ig(b,!1,!0)}q5a(b,k){const t=new Map;t.set("Source",this.mJa);t.set("Action",k);xa.Health.instance.recordKpiUsage(b,0,this.SVa,t)}static h3a(b,
k){return!!k&&!!b&&b.Cwh===k.Cwh}}Os.tMg="WordBookmarkIndicatorContainerHovered";Os.IWj="WordBookmarkIndicatorContainerSelected";Os.Bed="BookmarkDefault.png";Os.HWj="BookmarkHover.png";Os.QRe=!0;Os.Bte="WordBookmarkIndicatorContainer";Os.NWj="WordBookmarkSvgIndicatorContainer";Object(n.a)(Os,"BookmarkIndicatorActor",bh.a,[548]);class UJ{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb=null,Vb=null,ac=null,yc=null,Kc=null,ed=null,sd=null){this.n2="_";this.dte="Bookmark";this.fWj=/^BOOKMARK\d+$/i;this.mJa="BookmarkRibbonOptions";
this.DWj="BookmarkFloatieOptions";this.$Pg="CreateBookmarkOnRange";this.aQg="CreateBookmarkOnView";this.ZPg="CreateBookmarkOnIP";this.vwe="CreateBookmark";this.SVa="wwaengidc";this.Rfh="ShowHideBookmarksOnDocument";this.kRg="DeleteBookmark";this.D_j="DeleteBookmarkAction";this.Nik="ShowHideBookmarks";this.Qfh="ShowBookmarksFloatie";this.Kik="ShowBookmarksFloatieAction";this.QSg="EditBookmark";this.C0j="EditBookmarkAction";this.u3e="BookmarksUsage";this.$Jk="InsertTabSwitchActivity";this.aBm="Insert";
this.ORb=b;this.ga=k;this.ib=t;this.nn=D;this.qx=P;this.u6=ca;this.Hc=ta;this.EL=Na;this.Hp=Vb;this.sMg=qb;this.Ie=Jb;this.d6=Kc;this.Jn=ac;this.fd=yc;this.dS=ed;this.Ik=sd}get ax(){return this.qx.value}Tb(){this.CBf()&&(this.ga.qa(Nc.a.HNa,lc.a.view,this.HNa.bind(this)),this.ga.fb($a.a.FTa,lc.a.application,this.aLo.bind(this),96),this.ga.qa(Nc.a.HNa,lc.a.Hd,this.Q7k.bind(this)),this.ga.qa(Nc.a.HNa,lc.a.Tc,this.P7k.bind(this)),this.ga.qa(Nc.a.deleteBookmark,lc.a.view,this.deleteBookmark.bind(this)),
this.ga.qa(Nc.a.jgf,lc.a.view,this.Mql.bind(this)),this.ga.fb(Nc.a.oqj,lc.a.view,this.juo.bind(this),1028),this.ga.fb(Nc.a.zae,lc.a.application,this.zae.bind(this),96),this.ga.fb(Nc.a.Zhe,lc.a.Tc,this.Zhe.bind(this),1028),this.ga.fb(Pb.a.P0d,lc.a.view,this.P0d.bind(this),1028),this.ga.fb(Nc.a.fVd,lc.a.view,this.fVd.bind(this),1028),this.ga.Vc(Nc.a.HNa,1028))}aLo(b,k,t,D,P){return P&&P.NewContextId===this.aBm?(this.i2d(this.$Jk),32):2}HNa(b,k,t,D,P){var ca,ta;b=this.ib.sg;if(!b||b.contextId===lc.a.anchoredObject)return 2;
if(1===t)return Pk.a.fha(k)||(null===(ca=this.Ik)||void 0===ca?0:ca.i_(b))||(null===(ta=this.Ik)||void 0===ta?0:ta.iha(b))?8:32;k=this.ib.hb.kb;if(!k||this.Ie.km(k))return 2;this.VXc(P,"User is trying to create bookmark from UILocation : {0}");this.q5a(this.aQg,this.vwe);if(k&&this.nn.mYe(this.HOa(),k))return this.i2d(this.u3e),32;P=new Map;P.set("Source",this.mJa);P=Object.assign(new Db.a,{additionalValues:P});xa.Health.instance.recordKpiFailure(this.aQg,"Unable to create bookmark",!1,!0,P);return 8}Q7k(b,
k,t,D,P){if(1===t)return 32;if(lc.a.Hd!==k.contextId)return 8;this.VXc(P,"User is trying to create bookmark from UILocation : {0}");b=this.ib.hb.kb;if(!b)return 2;this.q5a(this.$Pg,this.vwe);if(this.nn.mYe(this.HOa(),b))return this.i2d(this.u3e),32;b=new Map;b.set("Source",this.mJa);b=Object.assign(new Db.a,{additionalValues:b});xa.Health.instance.recordKpiFailure(this.$Pg,"Unable to create bookmark for range",!1,!0,b);return 8}P7k(b,k,t,D,P){if(1===t)return 32;if(lc.a.Tc!==k.contextId)return 8;this.VXc(P,
"User is trying to create bookmark from UILocation : {0}");b=this.ib.hb.kb;if(!b)return 2;this.Ie.km(b)&&(k=b.Qa,this.Ie.$jb(k)?(b=this.Ie.C3(k,!1),b||(v.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.Ie.C3(k,!0))):v.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.q5a(this.ZPg,this.vwe);if(this.nn.mYe(this.HOa(),b))return this.i2d(this.u3e),32;b=new Map;b.set("Source",this.mJa);b=Object.assign(new Db.a,
{additionalValues:b});xa.Health.instance.recordKpiFailure(this.ZPg,"Unable to create bookmark for IP",!1,!0,b);return 8}zae(b,k,t,D,P){1===t&&32;P[kg.a.On]=Os.QRe;return 32}juo(b,k,t,D,P){if(1===t)return 32;this.q5a(this.Rfh,this.Nik);(b=P[kg.a.On])||v.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");Os.QRe=b;b=Wk.PageNavigator.instance.IO(this.ax);if(null!==b)return this.d3c(b),this.ORb.VG({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",this.mJa);b=
Object.assign(new Db.a,{additionalValues:b});xa.Health.instance.recordKpiFailure(this.Rfh,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,k,t,D,P){if(this.CBf()){b=this.ib.hb.kb;if(!b)return 2;b=b.Qa;b=this.nn.ROd(b.node,b.cpBegin);if(1===t)return b?32:8;this.VXc(P,"User is trying to delete bookmark from UILocation : {0}");this.EL.W_&&(v.ULS.sendTraceTag(545118155,3029,50,"Dismissing the bookmarks floatie"),this.EL.Tw());this.q5a(this.kRg,this.D_j);b||v.ULS.sendTraceTag(545118156,
3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.nn.a9i(b.id))return this.sMg&&this.sMg.FDd(),32;t=new Map;t.set("Source",this.mJa);t=Object.assign(new Db.a,{additionalValues:t});xa.Health.instance.recordKpiFailure(this.kRg,"Unable to delete bookmark",!1,!0,t);return 8}return 2}Mql(b,k,t,D,P){if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)){b=this.ib.hb.kb;if(!b)return 2;
b=b.Qa;b=this.nn.ROd(b.node,b.cpBegin);if(1===t)return b?32:8;this.VXc(P,"User is trying to edit bookmark from UILocation : {0}");this.EL.W_&&(v.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.EL.Tw());this.q5a(this.QSg,this.C0j);b||v.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.d6.value.Nql(k,b,this.nn),32;k=new Map;k.set("Source",this.mJa);k=Object.assign(new Db.a,{additionalValues:k});xa.Health.instance.recordKpiFailure(this.QSg,
"Unable to edit bookmark",!1,!0,k);return 8}return 2}VXc(b,k){b&&b.UILocation&&v.ULS.sendTraceTag(540386525,3029,50,k,b.UILocation)}Zhe(b,k,t,D,P){if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloatie",!1)){1===t&&32;this.q5a(this.Qfh,this.Kik);if(k.contextId===lc.a.Tc)return b=Array(1),b.push("Bookmarks"),this.EL.showFloatie(P.location,b,1),32;P=new Map;P.set("Source",this.DWj);P=Object.assign(new Db.a,{additionalValues:P});xa.Health.instance.recordKpiFailure(this.Qfh,
"Unable to show bookmark floatie",!1,!0,P);return 8}return 2}P0d(b,k,t,D,P){let ca;return 1===t?(pr.a.instance.ie(()=>{ca=this.ga.Nf(k,Pb.a.insertHyperlink,t,!0,D,P);32!==ca&&(ca=this.ga.Nf(k,Nc.a.HNa,t,!0,D,P))},"BA:LFE"),ca):8}fVd(b,k,t){var D;if(1===t)return 32;if(b=this.ib.hb.kb){b=b.Qa.node;if(k=this.QXh(b))return k.click(),32;v.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.nn.ROd(b,0)){b=this.dS.Vdb.get(null===(D=b.id)||void 0===D?void 0:D.toString());
D=Wk.PageNavigator.instance.IO(this.ax).Kc.Db(b);if(D=this.QXh(D))return D.click(),32;v.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else v.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 2}QXh(b){let k;b=this.Jn.Il(b).Qj(this.fd.Bd.ic);b.zjb&&(b=b.htmlElement.querySelectorAll("div."+Os.Bte),0<b.length&&(k=b[0]));return k}d3c(b){const k=gH.b(b);if(k){var t=this.Hc.Mc(2);try{for(t.Cb(b);k.moveNext();){if(!pe.ParagraphReader.uh(k.iterator))continue;
const D=k.currentNode;this.Lpl(D)&&this.u6.m$b(D,!0)}}finally{t&&t.dispose()}}}Lpl(b){for(let t=0;t<b.pa.length;t++){const D=b.pa.J(t);if(null!=D.Eh)for(let P=0;P<D.Eh.length;P++){var k=D.Eh.J(P);if(null!=k&&(k=b.Kc.Db(k.hn).ia(Cc.a.jt,""),!F.a.jf(k)&&!k.startsWith(this.n2)))return!0}}}HOa(){var b=this.nn.ANd(!1);const k=[];for(let t=0;t<b.count;t++){const D=b.J(t).ia(Cc.a.jt,"");this.fWj.test(D)&&k.push(D)}return 0<k.length?(k.sort((t,D)=>t.localeCompare(D,void 0,{numeric:!0})),b=parseInt(k[k.length-
1].substring(this.dte.length)),this.dte+(b+1)):this.dte+1}q5a(b,k){const t=new Map;t.set("Source",this.mJa);t.set("Action",k);xa.Health.instance.recordKpiUsage(b,0,this.SVa,t)}i2d(b){this.CBf()&&this.Hp&&this.Hp.execute(k=>{k.logActivity(b,null)})}CBf(){w.AFrameworkApplication.ue("bookmarks-core-ex;bookmarks-core-ex-cf");return w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)}}Object(n.a)(UJ,"BookmarkActor",null,[]);class VJ{constructor(b,
k,t){this.pc=b;this.cll=k;this.Sf=t;this.a8e=this.a8e.bind(this)}Tb(){this.pc.qa(Nc.a.wIf,lc.a.view,this.a8e)}a8e(b,k,t,D,P){return 1===t?32:(b=this.Sf.j8(k.$j))?(P=3===P.Gx,this.cll.value.jKh(this.$7l(b),this.Jgm(b),P),32):2}$7l(b){const k=new th.DictionaryPropertySet;k.setValue(qe.a.RE,this.Sf.Yg(b));k.setValue(qe.a.eG,this.Sf.tga(b));k.setValue(qe.a.hma,this.Sf.ihb(b));k.setValue(qe.a.separator,this.Sf.RRd(b));return k}Jgm(b){const k=new th.DictionaryPropertySet;k.setValue(Cc.a.marginLeft,this.Sf.gJ(b));
k.setValue(Cc.a.marginRight,this.Sf.VK(b));k.setValue(Cc.a.Ao,this.Sf.Vt(b));return k}}Object(n.a)(VJ,"ColumnsDialogActor",null,[]);class WJ{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){this.So=b;this.y$=k;this.ve=t;this.jr=D;this.Zl=P;this.Kd=ca;this.Hc=ta;this.we=Na;this.ga=qb;this.i7j=Jb;this.kZj=Vb}get oCf(){return this.i7j}Tb(){this.ga.fb(Pb.a.a8c,lc.a.view,this.yzm.bind(this),96);this.ga.fb(Pb.a.N3c,lc.a.view,this.N3c.bind(this),4);this.ga.fb(Pb.a.DAd,lc.a.view,this.DAd.bind(this),1028)}DAd(b,k,
t,D,P){if(!hi.a.y9e)return 8;b=P.FormattingActionId;P=P.FormattingActionData;if(!k.view||!k.view.qe)return 2;k=k.view;if(!(b&&P&&k.mb&&k.mb.hb.kb))return 8;k=this.Zl.f6h(k.mb.hb.kb.toArray());for(const ca of k){k=ca.ia(Cc.a.Ow,0);t=this.So.getById(k);if(!t)return v.ULS.sendTraceTag(509136987,368,10,"Content control not found by id '"+k+"'."),8;if(!this.kZj.aSo(t,b,P))return v.ULS.sendTraceTag(509136986,368,10,"Content control with id '"+k+"' failed to update formatting."),8}return 32}yzm(b,k,t,D,
P){k=this.So.getById(P);if(!k)return 8;t=k.contentControlNode;if(!t)return 8;if(t.ia(Cc.a.C7,!1))return 2;D=this.So.cQl(k);if(!D)return 8;P=this.Hc.Mc(7);P.Cb(D.node);if(!this.oCf)return(b=k.placeholderText)||(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Kd.replaceTextRange(D,b),hi.a.akb?this.Zl.T0b(k,!0):this.T0b(k),t.setValue(Cc.a.C7,!0),P.dispose(),32;const ca=new th.DictionaryPropertySet;ca.setValue(vd.a.Fji,D);var ta=t.ia(Cc.a.YZa,"");ta=this.y$.Oii(ta);if(!ta)return this.jr.replaceTextRange(D,
WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,hi.a.pr?b:void 0),hi.a.akb?this.Zl.T0b(k,!0):this.T0b(k),t.setValue(Cc.a.C7,!0),P.dispose(),32;ca.setValue(vd.a.Gvf,ta);if(1<ta.length&&!k.Mf)return P.dispose(),8;this.q6k(ca);t.setValue(Cc.a.C7,!0);P.dispose();return 32}N3c(b,k,t){b=k.view.qe?k.view:null;if(!b||!b.mb)return 8;const [D,P]=this.eam(b.mb.hb);if(0===D.length)return 8;if(1===t){for(var ca of D){var ta=P.get(ca.parentId);if(this.Jui(ca,ta))return 32}return 8}if(2===t){t=this.txo(D,
P);ca=this.Hc.Mc(15);ca.Cb(b.ed);for(ta of t)t=P.get(ta.parentId),this.Jui(ta,t)&&this.So.AMb(ta.id);ca.dispose();return 32}return 2}eam(b){var k,t,D=[];for(const ca of b)D.push(...(null!==(k=this.Zl.jna(ca.Qa,ca.Qc,1))&&void 0!==k?k:[]));if(0===D.length)return[D,new Map];k=[];for(const ca of b)k.push(...(null!==(t=this.Zl.jna(ca.Qa,ca.Qc,3))&&void 0!==t?t:[]));b=new Map(D.map(ca=>[ca.id,ca]));if(0===k.length)return[D,b];const P=new Map(k.map(ca=>[ca.id,ca]));D=D.filter(ca=>!P.has(ca.id));b=new Map([...b,
...P]);return 0==D.length?[[k[0]],b]:[D,b]}T0b(b){const k=this.jr.JOc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(k){if(b=this.we.JC(b.start.node).Fi(lt.a.iZf))this.ve.pfa(k.formatting),this.ve.A6a(k.formatting,b)}else v.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}q6k(b){this.ga.Qb(Pb.a.showPlaceholderGlossary,2,b)}Jui(b,k){return b.aha&&b.$Om&&(!k||k.isEditable)}txo(b,k){const t=(D,P)=>null==D||null==P||D.id===P.id?!1:D.id===P.parentId||t(k.get(D.parentId),
P);return b.slice().sort((D,P)=>t(D,P)?1:t(P,D)?-1:0)}}Object(n.a)(WJ,"ContentControlActor",null,[]);class AF{constructor(b){this.ga=b;this.primaryButtonText="Count me in";this.secondaryButtonText="Cancel";this.Lyk=["We are gauging interest in a feature that would let you","customize your ribbon in Word on the web. Click below","to vote or comment on this idea, as well as follow it","status updates. Thank you."];this.PHo="Interested in this feature?"}Tb(){this.ga.qa(Nc.a.lcf,lc.a.view,this.RCm.bind(this))}RCm(b,
k,t){2===t&&(Object(bf.c)(Nc.a.lcf),b=new Uc.StandardDialog,b.Ad=4,b.Ee(1,this.primaryButtonText),b.Ee(2,this.secondaryButtonText),b.hDc(this.Lyk,null),b.Gu(this.PHo,null,0,this.Zaa));return 32}Zaa(b){1===b&&(Object(bf.a)("CountMeIn_CustomizeRibbon",!0),F.a.uU(AF.nHj)&&$d.a.nm(AF.nHj))}}AF.nHj="https://feedbackportal.microsoft.com/feedback/idea/974fe330-6613-ed11-b83e-000d3a4d92e4";Object(n.a)(AF,"CustomizeRibbonActor",null,[]);var iB=c(1068);class hH extends Wf.a{constructor(b,k,t){super(!1,!1,!0);
this.r4g=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,iB.a.c0e,iB.a.b0e,iB.a.d0e];this.tVj=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,iB.a.bAk,iB.a.aAk,iB.a.dAk];this.MKg=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.yjc=()=>{new hH(this.ga,this.MTe,this.brc)};this.WYl=()=>{const D=[];for(const P of this.MTe)D.push(this.v5(P));return D};this.zWo=D=>{const P=new Set;this.Pra="";for(const ca of D)if(""!==
ca.position){const ta=this.Nbi(ca.position);if(0>ta||22<ta){this.Pra=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(P.has(ta)){this.Pra=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.dIo(ca)),P.add(ta)}else{this.Pra=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.Pra&&(this._tabStops=[],this.MTe=D)};this.qfl=(D,P)=>{try{if(1===D){if(""!==this.Pra)throw Error.create(this.Pra);P.DefaultTabStop&&(this.brc=
iB.a.z8f(P.DefaultTabStop),this.RZo(this.brc));if(32!==this.ga.Qb(Nc.a.uQb,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Ef.a.Dv(this.brc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(ca){this.vHa(ca.message,this.yjc)}};this.ga=b;this.MTe=k;this._tabStops=[];this.brc=t;this.Pra="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.vDb()};this.Wh(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.qfl,b)}v5(b){return{["position"]:b.position,["alignment"]:b.alignment,
["leader"]:b.leader}}Nbi(b){return Math.floor(100*parseFloat(b))/100}dIo(b){return new Cw.a(Ef.a.Dv(this.Nbi(b.position)),iB.a.Scm(b.alignment),iB.a.Qcm(b.leader),1)}RZo(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var k={};if(32===this.ga.Qb(Pb.a.NGa,2,k)){var t=k.marginLeft;const D=Re.a.Ni(k.marginRight,0);t=Re.a.Ni(t,0);k=Re.a.Ni(k.Ao,0);if(Re.a.Gba(b,0,!1)>=k-D-t)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);
}}vDb(){return{["getInitState"]:this.WYl,["updateState"]:this.zWo,["validPositions"]:this.ggi(-Infinity,Infinity,"Position"),["validAlignments"]:this.B5h(this.MKg,this.MKg,null,"Alignment"),["validLeaders"]:this.B5h(this.r4g,this.r4g,this.tVj,"Leader"),["defaultTabStopSpinButtonProps"]:this.ggi(.01,22,"DefaultTabStops"),["defaultTabStopLength"]:this.brc,["DefaultTabStop"]:"DefaultTabStop",["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,
["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}ggi(b,
k,t){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:t,["unitType"]:"Inch",["validUnits"]:[fC("Inch",3,b,k,.1)],["numberFormatInfo"]:NG()}}B5h(b,k,t,D){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:D,["options"]:$F(b,k,t)}}}Object(n.a)(hH,"CustomTabDialog",Wf.a,[]);class XJ{constructor(b,k,t){this.Edc=(D,P,ca,ta,Na)=>{if(2!==ca)return 8;if(!Na)return 16;D=Na.tabStop;Na=Na.value;if(!D)return 16;bf.c(Nc.a.Edc);Na=new Cw.a(Na,
D.gda,D.Moa,D.qhg);P=P.node;this.eAa.y5a(P,D);this.eAa.oWd(P,Na);return 32};this.B6c=(D,P,ca,ta,Na)=>{if(2===ca){if(!Na)return 16;this.eAa.oWd(P.node,Na);return 32}return 8};this.PLb=(D,P,ca,ta,Na)=>{D=this.eAa.a6i(P.node);if(!("customTabs"in Na))return Na.customTabs=D,32;P=Na.customTabs;if(!P||0>=P.length||!D||0>=D.length)return Na.customTabs=null,32;ca=[];for(const qb of P)for(const Jb of D)if(Jb.UHa===qb.UHa&&Jb.qhg===qb.qhg&&Jb.gda===qb.gda){ca.push(qb);break}Na.customTabs=ca;return 32};this.y5a=
(D,P,ca,ta,Na)=>{if(2===ca){if(!Na)return 16;bf.c(Nc.a.y5a);this.eAa.y5a(P.node,Na);return 32}return 8};this.BMb=(D,P)=>{this.eAa.BMb(P.node);return 32};this.uQb=(D,P,ca,ta,Na)=>{if(2===ca){if(!Na)return 16;D=Na.tabStops;ca=Na.defaultTabStopLength;P=P.node;ta=!1;const qb=this.eAa.o1n(P,D);Na.defaultTabStopLengthSaved||(ta=this.lK.ofo(P,ca),Na.defaultTabStopLengthSaved=!0);qb&&bf.d(Nc.a.uQb,!0,void 0,void 0,void 0,void 0,[Object.assign(new na.a,{name:"Custom Tab Stops Count",string:D.length.toString()})]);
if(null==ta)return v.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;ta&&(this.n4c&&this.n4c.Usi(),this.Ld.Js(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),bf.d(Nc.a.uQb,!0,void 0,void 0,void 0,void 0,[Object.assign(new na.a,{name:"Default Tab Stop Length",string:ca.toString()})]));return 32}return 8};this.Aqj=(D,P,ca)=>{if(2!==ca)return 8;D={};if(32!==this.ga.Qb(Nc.a.rX,2,D))return v.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),
16;P={};if(32!==this.ga.Qb(Pb.a.NGa,2,P))return v.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;D=iB.a.z8f(Ef.a.Ez(D.defaultTabStop));ca={};ca.defaultTabStopLength=D;ca.sectionPropertiesData=P;if(32!==this.ga.Qb(Nc.a.Wng,2,ca))return v.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),16;if(!ca.isParagraphValid)return v.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),
this.eAa.vHa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;P={};if(32!==this.ga.Qb(Nc.a.PLb,2,P))return v.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(P=P.customTabs)||(P=[]);P=iB.a.Rcm(P);new hH(this.ga,P,D);bf.c(Nc.a.yjc,!0);return 32};this.LNm=(D,P,ca,ta,Na)=>{if(2!==ca)return 8;if(!Na)return 16;if(Na.isParagraphValid)return 32;ca={};if(32!==this.ga.Nf(P,Pb.a.j5a,2,!1,null,ca))return 16;D=Na.sectionPropertiesData;P=Na.defaultTabStopLength;var qb=ca.tt;ta=qb.Xna;
qb=1===qb.specialIndentType?qb.xB:qb.xB-qb.bda;const Jb=D.marginLeft,Vb=D.marginRight;ca.isRtl?(ca=Re.a.Ni(Math.max(Vb,Vb+ta),0),ta=Re.a.Ni(Math.max(Jb,Jb+qb),0)):(ca=Re.a.Ni(Math.max(Jb,Jb+qb),0),ta=Re.a.Ni(Math.max(Vb,Vb+ta),0));D=Re.a.Ni(D.Ao,0);P=Re.a.Gba(P,0,!1);Na.isParagraphValid=P<D-ca-ta;return 32};this.ga=b;this.eAa=k;this.lK=t}get Ld(){return null!=this.VHg?this.VHg:this.VHg=Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get n4c(){return null!=this.FFg?this.FFg:
this.FFg=Fa.a.instance.Na("WordEditor.Actors.RenderParagraphsContainingTabs")}Tb(){const b=t=>$t.OutlineElementGeneralizer.gna(t.hb,!0),k=Wa.App.NTa.OHc(b,!0);this.ga.qa(Nc.a.PLb,lc.a.view,Wa.App.NTa.OHc(b,!1));this.ga.fb(Nc.a.PLb,lc.a.paragraph,this.PLb,96);this.ga.qa(Nc.a.y5a,lc.a.view,k);this.ga.fb(Nc.a.y5a,lc.a.paragraph,this.y5a,96);this.ga.qa(Nc.a.BMb,lc.a.view,k);this.ga.fb(Nc.a.BMb,lc.a.paragraph,this.BMb,96);this.ga.qa(Nc.a.B6c,lc.a.view,k);this.ga.fb(Nc.a.B6c,lc.a.paragraph,this.B6c,96);
this.ga.qa(Nc.a.Edc,lc.a.view,k);this.ga.fb(Nc.a.Edc,lc.a.paragraph,this.Edc,96);this.ga.qa(Nc.a.uQb,lc.a.view,k);this.ga.fb(Nc.a.uQb,lc.a.paragraph,this.uQb,96);this.ga.qa(Nc.a.Wng,lc.a.view,k);this.ga.fb(Nc.a.Wng,lc.a.paragraph,this.LNm,96);this.ga.qa(Nc.a.yjc,lc.a.view,this.Aqj);this.ga.qa(Nc.a.Dri,lc.a.view,this.Aqj)}}Object(n.a)(XJ,"CustomTabActor",null,[]);var JM=c(118),rG=c(621);class YJ{constructor(b,k,t,D,P,ca,ta,Na,qb){this.ga=b;this.Exd=t;this.qJa=(this.UYb=P)&&D;this.pn=ca;this.XS=ta;
this.e_j=Na;this.ox=qb;this.qLg=k;this.qLg.getBooleanFeatureGate("Microsoft.Office.WordOnline.DoNotSetDarkModeStateInDarkModeActor",!1)?(this.PKf(!0),this.fKf(!0)):(this.UYb&&Qg.a("isSharedUXDarkModeOn")?(this.pn.VI=appChrome.api.isSharedUXDarkModeOn(),this.PKf(!0)):this.pn.VI=!1,this.qJa?this.fKf(!0):this.pn.DTa=!1);w.AFrameworkApplication.$H(()=>{this.ZJb()});this.qJa&&Qg.a("dispatch")&&appChrome.api.dispatch(this.dwj([]))}Tb(){this.qJa&&(this.ga.qa(Nc.a.tIo,lc.a.view,this.Efl.bind(this)),this.ga.qa(Nc.a.A7c,
lc.a.view,this.A7c.bind(this)),this.ga.fb(Nc.a.H2c,lc.a.view,this.H2c.bind(this),96));this.UYb&&(this.ga.qa(Nc.a.B7c,lc.a.view,this.B7c.bind(this)),this.ga.fb(Nc.a.lbe,lc.a.view,this.lbe.bind(this),96))}GCm(b){if(!this.dqo(b))return!1;const k=tk.a.instance.Mc(2);try{k.Cb(b.root);const t=ze.GraphIterator.$a(b.root.graphNode),D=mr.a.Kp(t);for(;D.moveNext();){const P=Object(Ka.a)(JM.a,D.currentNode);P&&P.kJ(b.ic,20,!0)}}finally{k&&k.dispose()}return!0}dqo(b){return b&&b.root&&b.fv?b.Vi||b.xDf||b.Ewi||
b.Sj:!1}g3n(){let b=!1;this.Exd.forEach(k=>{this.GCm(k)&&(b=!0)});return b}uIo(){v.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.pn.VI?"dark":"light");return this.pn.VI?rG.a.oDc(1):rG.a.m9i(1)}vjg(){const b=this.pn.Gaa;v.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.g3n()||(b?!rG.a.oDc(0):!rG.a.m9i(0)))return!1;this.e_j.bMn(b);return!0}dwj(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.pn.VI));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.Igi(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.pn.DTa?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):v.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(k){v.ULS.sendTraceTag(527282835,3023,10,k)}return b}Efl(){return this.vjg()?
32:8}B7c(b,k,t){if(1===t)return 32;b=this.XS.Zf("UserAction","sharedUXDarkModeToggle");if(Qg.a("toggleSharedUXDarkMode"))v.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),Qg.a("isSharedUXDarkModeOn")?this.pn.VI=appChrome.api.isSharedUXDarkModeOn():this.pn.VI=!this.pn.VI,v.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.pn.VI);else return 8;appChrome.getHeaderApi().then(D=>{D.hasOwnProperty("refreshThemeOverride")&&
D.refreshThemeOverride()});this.uIo()||v.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.qJa&&!this.pn.DTa&&(this.vjg()||v.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));k={};k.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");Wa.App.ya.VG(k);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.pn.VI));this.qJa&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.pn.VI));b.stop();v.ULS.sendTraceTag(555885377,3023,50,"{0}",b.si);bf.b(this.pn.VI?"DarkModeOn":"DarkModeOff");return 32}A7c(b,k,t){if(1===t)return 32;b=this.XS.Zf("UserAction","sharedUXDarkModeSwitchBackground");v.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.pn.DTa=!this.pn.DTa;if(!this.vjg())return 8;k={};k.DarkModeSwitchBackground=this.ox?"ButtonModel":"ToggleButtonModel";Wa.App.ya.VG(k);b.stop();v.ULS.sendTraceTag(555885378,3023,
50,"{0}",b.si);v.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.pn.DTa);bf.b(this.pn.DTa?"DarkCanvasOff":"DarkCanvasOn");return 32}lbe(b,k,t,D,P){if(1===t)return 32;if(!P)return 2;Qg.a("isSharedUXDarkModeOn")&&(this.pn.VI=appChrome.api.isSharedUXDarkModeOn());P&&(P[kg.a.On]=this.pn.VI);return 32}H2c(b,k,t,D,P){if(1===t)return 32;if(!P)return 2;!this.ox&&P&&(P[kg.a.On]=this.pn.DTa);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.pn.VI));
this.qJa&&this.dwj(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.Igi(!1)));appChrome.api.dispatch(b);return 32}Igi(b){const k={};this.pn.DTa?b?k["default"]="MoonMonochromatic_16":(k["default"]="MoonMonochromatic_20",k.icon32="MoonMonochromatic_32"):b?k["default"]="SunMonochromatic_16":(k["default"]="SunMonochromatic_20",k.icon32="SunMonochromatic_32");return k}ZJb(){this.UYb&&this.PKf(!1);this.qJa&&this.fKf(!1)}PKf(b){var k;v.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",
b,this.pn.VI?"dark":"light",this.pn.vDa);b&&this.pn.VI!=(null===(k=this.qLg)||void 0===k?void 0:k.$("DarkModeIsOn"))&&v.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.pn.VI?"dark":"light",this.pn.vDa)}fKf(b){v.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.pn.Gaa?"dark":"light",this.pn.Dfl)}}Object(n.a)(YJ,"DarkModeActor",null,[]);var ZJ=c(1576);
class sG{constructor(){this.Height=this.Width=0}static construct(b,k){const t=new sG;t.Width=b;t.Height=k;return t}}Object(n.a)(sG,"ViewportInfo",null,[]);class iH extends Vt.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}$k(){return 85}static construct(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){const ac=new iH;ac.ContractVersion=b;
ac.DocumentContent=k;ac.EnhancementId=t;ac.World=D;ac.ScalingFactor=P;ac.DesktopViewportInfo=sG.construct(ca,ta);ac.MobileViewportInfo=sG.construct(Na,qb);ac.MinParagraphCount=Jb;ac.ContentCulture=Vb;return ac}}Object(n.a)(iH,"SwayPreviewRequest",Vt.a,[]);var KM=c(590);class vD{static get Xg(){return Wf.a.lA(Wa.App.instance&&Wa.App.instance.eHf?vD.fll:vD.Lm,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,
vD.q8n,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}vD.q8n=Nh.a.ug("progress.gif");vD.Lm="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
vD.fll="<div class='WACDialogRow digitalPrintDialogWrapper digitalPrintDialogWrapperResize UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper swayGalleryWrapperResize' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper swayPreviewWrapperResize' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(n.a)(vD,"DigitalPrintDialogHtml",null,[]);class Fx{constructor(b,k,t,D){this.fontFamily=b;this.T4c=k;this.fontWeight=t;this.fontStyle=D}}Object(n.a)(Fx,"FontInfo",null,[]);class Ps{constructor(b,k,t,D){this.styleName=b;this.title=k;this.OHo=t;this.kqm=D}}Object(n.a)(Ps,"StyleVisualInfo",null,[]);class XD extends Wf.a{constructor(b,k,t,D,P=!0){super();this.o6=this.Nq=this.Cka=this.v2=this.ekd=this.uhh=this.Avd=this.DTe=this.ETe=this.WSe=this.qZb=this.jMa=this.N2=this.HYb=null;this.sWe=this.XOe=
!1;this.$id=null;this.kpl=()=>{this.Ofj(0)};this.jpl=(ca,ta)=>{this.Ofj(ta)};this.jXi=ca=>{this.M$h(ca)===Sys.UI.Key.enter&&(this.PVf(ca),ca.preventDefault(),ca.stopPropagation())};this.ATi=ca=>{((ca=ca.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===ca.id||ca.id===ll.a.wdd)||aa.a.ut)&&this.jMa&&this.UNb(this.jMa)};this.BTi=ca=>{const ta=this.M$h(ca);ta!==Sys.UI.Key.tab&&ta!==Sys.UI.Key.left&&ta!==Sys.UI.Key.right&&ta!==Sys.UI.Key.up&&ta!==Sys.UI.Key.down||this.enm(ta)||(ca.preventDefault(),
ca.stopPropagation(),this.zmn(ta))};this.NTf=()=>{this.sWe||(this.sWe=!0,v.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),vf.a.removeHandler(this.N2,Rc.a.scroll,this.NTf))};this.wUf=()=>{v.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.PVf=ca=>{ca.preventDefault();ca.stopPropagation();w.AFrameworkApplication.va.processAction(Pb.a.rRh,2);ca.target?(ca="button"===ca.target.tagName.toLowerCase()?ca.target:ca.target.parentNode)&&ca.id!==this.HYb&&(v.ULS.sendTraceTag(25231813,
382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.HYb,ca.id),this.RBh(ca),this.eMh()):v.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.Lll=ca=>{const ta=(new Date).getTime()-this.HRg;Zg.a.instance.rf(ai.a.Nll,ta);ca?this.aco():(v.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),w.AFrameworkApplication.va.processAction(Pb.a.qRh,2))};
this.Zbo=()=>{this.vvo();try{const ca=XD.TSh.Ixl(),ta=iH.construct(2,ca,this.HYb,"VerticalWorld",.3,1366,600,330,280,20,XD.TSh.hTb.name);w.AFrameworkApplication.Ne.sj(String.format("{0}/we/GetSwayPreview.ashx?{1}",Wa.App.webServiceBase,w.AFrameworkApplication.rootQuerySignature),2,KM.b(ta),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.gFn,this.h2i,ta)}catch(ca){v.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",ca.message)}};
this.gFn=ca=>{var ta=null;({group:ta}=sn.a.l1(ca.data.xe)).returnValue?(ta=ta.Responses[0],ta.Succeeded?(this.H2d(ca.data,ai.a.mDo),this.xeb(),this.Clj(this.DTe,ta.PreviewHtml),this.Clj(this.Avd,ta.PreviewHtmlMobile)):this.h2i(null)):v.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.h2i=()=>{this.wvo();this.ETe.style.background="#E6E6E6";this.uhh.style.background="#E6E6E6"};this.Xg=vD.Xg;this.vg="DigitalPrintDialog";v.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.afk=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.NTb=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.ikk=t;this.Msc=D;this.Ee(1,this.afk);this.Wh(this.NTb,this.Lll,null);this.exm();this.VBo();this.HRg=(new Date).getTime();P&&Nv.a.FQ(14,!1,this.kpl,this.jpl,null);this.pym();this.Gvm();this.mZm();this.MJf();this.dZm();this.eMh()}get ova(){return this.$id}Ofj(b){if(!this.XOe){const k=
(new Date).getTime()-this.HRg;Zg.a.instance.rf(ai.a.Mll,k);b?v.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",ni.a[b])):v.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.qZa.disabled=!1}}exm(){this.qZb=document.getElementById("digitalPrintStatusMessageDiv");this.WSe=document.getElementById("digitalPrintStatusMessageIconDiv");this.ETe=document.getElementById("swayDesktopPreviewWrapperDiv");
this.DTe=document.getElementById("swayDesktopPreviewHtmlHolder");this.Avd=document.getElementById("swayMobilePreviewHtmlHolder");this.uhh=document.getElementById("swayMobilePreviewWrapperDiv");this.N2=document.getElementById("swayGallery");this.N2.setAttribute("tabindex","0");vf.a.addHandler(this.N2,Rc.a.scroll,this.NTf);this.N2.setAttribute(df.a.qh,df.a.Buh);this.v2=document.getElementById("digitalPrintLearnMoreLink");this.v2.href="https://go.microsoft.com/fwlink/?linkid=871972";vf.a.addHandler(this.v2,
Rc.a.click,this.wUf);this.Cka=new Eb.a;this.ekd=document.getElementById("homeWrapper");this.Z4("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.Msc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}pym(){this.Nq=new Eb.a;this.Nq.add(new Ps("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));
this.Nq.add(new Ps("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.Nq.add(new Ps("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.Nq.add(new Ps("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));
this.Nq.add(new Ps("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.Nq.add(new Ps("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.Nq.add(new Ps("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.Nq.add(new Ps("CelestialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.Nq.add(new Ps("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.Nq.add(new Ps("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.Nq.add(new Ps("Lucent",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.Nq.add(new Ps("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.Nq.add(new Ps("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.Nq.add(new Ps("Muse",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.Nq.add(new Ps("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.Nq.add(new Ps("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.Nq.add(new Ps("ConvergenceV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.Nq.add(new Ps("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.Nq.add(new Ps("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.Nq.add(new Ps("Aurora",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.Nq.add(new Ps("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.Nq.add(new Ps("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}Gvm(){this.o6=
new Eb.a;this.o6.add(new Fx("universc","universc","normal","normal"));this.o6.add(new Fx("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.o6.add(new Fx("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.o6.add(new Fx("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.o6.add(new Fx("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.o6.add(new Fx("Posterama-Regular","Posterama-Regular",
"normal","normal"));this.o6.add(new Fx("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.o6.add(new Fx("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.o6.add(new Fx("ArialNova","ArialNova","normal","normal"));this.o6.add(new Fx("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.o6.add(new Fx("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.o6.add(new Fx("RockwellNova","RockwellNova","normal","normal"));
this.o6.add(new Fx("SabonNRegLT","SabonNRegLT","normal","normal"));this.o6.add(new Fx("DaytonaThin","DaytonaThin","100","normal"))}mZm(){const b=document.createElement("style");b.setAttribute("type","text/css");let k="";for(const t of this.o6)k+=String.format(this.ikk,t.fontFamily,t.T4c,t.fontWeight,t.fontStyle);b.innerText=k;this.ekd.appendChild(b)}dZm(){const b=document.createElement("style");b.setAttribute("type","text/css");const k=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",
Nh.a.ug("SwayPreviewFrame.svg")),t=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",Nh.a.ug("SwayPreviewFrameHC.svg"));b.innerText=k+t;aa.a.zq&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.ekd.appendChild(b)}M$h(b){return b?b.keyCode:window.event.keyCode}hide(){this.A4f();super.hide()}A4f(){if(this.N2&&!this.XOe){for(let b=0;b<this.Cka.count;b++)vf.a.removeHandler(this.Cka.J(b),
Rc.a.click,this.PVf),vf.a.removeHandler(this.Cka.J(b),Rc.a.hi,this.jXi);vf.a.removeHandler(this.N2,Rc.a.hi,this.BTi);vf.a.removeHandler(this.N2,Rc.a.focus,this.ATi);vf.a.removeHandler(this.v2,Rc.a.click,this.wUf);this.sWe||vf.a.removeHandler(this.N2,Rc.a.scroll,this.NTf);this.XOe=!0}}MJf(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",Nh.a.IKk());this.ekd.appendChild(b);for(const k of this.Nq)this.FGd(this.N2,k);this.R0(this.N2);
this.RBh(this.N2.firstChild);this.N2.firstChild.focus();vf.a.addHandler(this.N2,Rc.a.hi,this.BTi);vf.a.addHandler(this.N2,Rc.a.focus,this.ATi)}FGd(b,k){const t=document.createElement("button");t.className="swayGalleryItem swayClip136x90 swayImageBorderButton";t.setAttribute(df.a.Gdb,df.a.dM);t.setAttribute("title",k.title);t.setAttribute(df.a.qh,df.a.Euh);t.id=k.styleName;b.appendChild(t);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",k.styleName);
b.src=Nh.a.ug("swayPublish.png");b.setAttribute(df.a.qh,df.a.Yy);b.setAttribute("unselectable","on");b.setAttribute(df.a.bA,df.a.jp);b.id=k.styleName+"img";t.appendChild(b);b=document.createElement("label");b.innerText=k.title;b.className=k.OHo;b.setAttribute(df.a.bA,df.a.jp);b.setAttribute("unselectable","on");b.setAttribute(df.a.qh,df.a.Yy);t.appendChild(b);const D=document.createElement("label");D.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;D.className=k.kqm;D.setAttribute(df.a.bA,
df.a.jp);b.setAttribute("unselectable","on");D.setAttribute(df.a.qh,df.a.Yy);t.appendChild(D);vf.a.addHandler(t,Rc.a.click,this.PVf);vf.a.addHandler(t,Rc.a.hi,this.jXi);this.Cka.add(t)}zmn(b){const k=this.ova;this.LEl(b,k,!w.AFrameworkApplication.isRtl)||this.NEl(b,k,!w.AFrameworkApplication.isRtl)||this.IEl(b,k)||this.JEl(b,k)}enm(b){return b===Sys.UI.Key.tab?(this.ova&&this.ova!==this.jMa&&(this.ova.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.$id=this.jMa),!0):!1}LEl(b,
k,t){return b===Sys.UI.Key.right&&t||b===Sys.UI.Key.left&&!t?(b=(b=k.nextSibling)||this.N2.firstChild,this.UNb(b),!0):!1}NEl(b,k,t){return b===Sys.UI.Key.left&&t||b===Sys.UI.Key.right&&!t?(b=(b=k.previousSibling)||this.N2.lastChild,this.UNb(b),!0):!1}IEl(b,k){return b===Sys.UI.Key.down?(b=this.Cka.indexOf(k),k=b+2,k<this.Cka.count?(b=this.Cka.J(k))&&this.UNb(b):(k=b%2+1,k=2<=k?0:k,(b=this.Cka.J(k))&&this.UNb(b)),!0):!1}JEl(b,k){b===Sys.UI.Key.up&&(b=this.Cka.indexOf(k),k=b-2,0<=k?(b=this.Cka.J(k))&&
this.UNb(b):(k=b?20+b-1:this.Cka.count-1,(b=this.Cka.J(k))&&this.UNb(b)))}UNb(b){this.ova&&this.ova.id!==this.jMa.id&&(this.ova.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.$id=b;this.ova.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.ova.focus()}VBo(){this.qZa.className="WACDialogButtonNormal swayPrintToWebButton";this.qZa.setAttribute("tabindex","0");this.Hz.className="WACDialogButtonNormal swayCancelButton";
this.Hz.setAttribute("tabindex","0");this.qZa.disabled=!0}RBh(b){this.ova&&(this.ova.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.jMa&&(this.jMa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.jMa.setAttribute(df.a.Gdb,df.a.dM));this.HYb=b.id;this.jMa=b;this.jMa.setAttribute(df.a.Gdb,df.a.jp);this.$id=b;this.ova.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}eMh(){wb.a.instance.Vb(new Df.a(2,
1,50,this.Zbo))}Clj(b,k){b.innerHTML=k}aco(){v.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.HYb));w.AFrameworkApplication.va.processAction(Pb.a.sRh,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",Wa.App.webServiceBase,w.AFrameworkApplication.rootQuerySignature,w.AFrameworkApplication.userSessionId,this.HYb);$d.a.openWindow(4,b)}H2d(b,k){Zg.a.instance.rf(k,+b.oT-+b.IH)}wvo(){var b=
WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.xeb();this.qZb.innerText=b;this.qZb.style.display="block"}vvo(){this.xeb();this.WSe.style.display="block";this.qZb.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.qZb.style.display="block"}xeb(){this.ETe.style.background="";this.Avd.style.background="";fc.a.e_(this.DTe);fc.a.e_(this.Avd);this.qZb.style.display="none";this.WSe.style.display="none"}static get TSh(){return null!=XD.Jxg?XD.Jxg:XD.Jxg=
Fa.a.instance.Na("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}Object(n.a)(XD,"DigitalPrintDialog",Wf.a,[]);class jH{constructor(b,k){this._context=this.zk=null;this.Kue=0;this.afd=!1;this.pgh=null;this.digitalPrint=(t,D,P,ca,ta)=>{if(1===P)return w.AFrameworkApplication.JG?8:32;this.pgh=ta.SourceControlId;if(w.AFrameworkApplication.K.$("IsAnonymousUser"))return v.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),
this.Mob(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=D;if(jH.iMm())return v.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.Y$e(),32;switch(this.Kue){case 1:v.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.Y$e();break;case 2:v.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");
this.Mob(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.afd=!1,this.zk=(new pp.a).create(),this.zk.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.zk.oL(CommonUIStrings.l_DefaultDialogTitle,this.oVk,null),w.AFrameworkApplication.Ne.sj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",Wa.App.webServiceBase,w.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.qVk,this.pVk,null)}return 32};this.oVk=()=>{this.afd=!0;v.ULS.sendTraceTag(34373831,
382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};this.qVk=t=>{if(!this.afd){this.zk.close();var D=null;this.H2d(t.data,ai.a.lDo);({group:D}=sn.a.l1(t.data.xe)).returnValue?(t=D.Responses[0],v.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",t.HasLicense,t.Succeeded),t.Succeeded?(this.Kue=t.HasLicense?1:2,2===this.Kue?this.Mob(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):
this.Y$e()):this.Mob(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(v.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.Mob(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.pVk=t=>{this.afd||(this.zk.close(),v.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.H2d(t.data,ai.a.kDo),this.Mob(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};
this.ga=b;this.d6=k}Tb(){w.AFrameworkApplication.protectFile?v.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):w.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&w.AFrameworkApplication.K.$("DisablePrint")?v.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.fb(Pb.a.digitalPrintToSway,lc.a.view,this.digitalPrint,4),this.ga.fb(Pb.a.rRh,lc.a.view,Xc.ActionManager.AQ,4),this.ga.fb(Pb.a.sRh,
lc.a.view,Xc.ActionManager.AQ,4),this.ga.fb(Pb.a.qRh,lc.a.view,Xc.ActionManager.AQ,4),this.ga.fb($a.a.BId,lc.a.view,Xc.ActionManager.AQ,4))}Y$e(){v.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.pgh);new XD(this._context,this.ga,w.AFrameworkApplication.K.jb("SwayFontDownloadUrlTemplate"),w.AFrameworkApplication.K.jb("FileSource"))}Mob(b){const k=new Uc.StandardDialog;k.Ad=0;k.Yia(CommonUIStrings.l_DefaultDialogTitle,
b,null)}H2d(b,k){Zg.a.instance.rf(k,+b.oT-+b.IH)}static iMm(){return"OneDriveWOPI"===w.AFrameworkApplication.K.jb("FileSource")}}Object(n.a)(jH,"DigitalPrintActor",null,[]);class $J{constructor(){this.jjh=null}HJi(){v.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}YBj(b){if(!b)return v.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.DCi(b.errorDetails))return!1;this.jjh=Object(Ka.a)(Fo.a,b.errorDetails).typeId;return!0}Fhe(b){return this.DCi(b)?
Object(Ka.a)(Fo.a,b).typeId===this.jjh:!1}DCi(b){if(!b)return v.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;b=Object(Ka.a)(Fo.a,b);return b?b.token&&b.typeId?!0:(v.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(v.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(n.a)($J,"DoNotCheckThisCritiqueTypeStrategy",null,[544]);class aK extends Wf.a{constructor(b,k,t){super(!1,!1,!0);this.pc=b;this.Wma=t;this.q0j="DocumentChoiceGroup";this.fTg="EmbededContent";
this.EYg="HyperLink";this.GHe=t.E9a;b={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.vDb()};this.UWj=this.lxl.bind(this);this.Ee(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Wh(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.UWj,b)}vDb(){const b=Array(2);b[0]={["key"]:this.fTg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.EYg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};
const k={};k.documentChoiceGroupProps={["id"]:this.q0j,["defaultSelectedKey"]:this.GHe?this.fTg:this.EYg,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};k.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;k.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;k.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;
return k}lxl(b,k){1===b?(this.GHe!==k.isExternalContentSelected&&(b=k.isExternalContentSelected?Nc.a.oOa:Nc.a.sgb,this.pc.processAction(b,2),this.GHe=k.isExternalContentSelected,ea.a.sendTelemetryEvent(Object.assign(new pa.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new na.a,{name:"ActionId",int64:b})]}))),this.Wma.S8n(k.isExternalContentSelected)):0===b&&v.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}
Object(n.a)(aK,"ExternalContentDefaultSettingsDialog",Wf.a,[]);class Qs{constructor(b,k,t,D,P){this.EL=Fa.a.instance.resolve("Common.IReactContextualUILauncher");this.vrb=kg.a.On;this.Ajc=()=>{const ca=Array(1);ca.push("ExternalContent");var ta=Fa.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").UOa();ta=Object.assign(new QF.a,{x:ta.x,y:ta.y});this.EL.showFloatie(ta,ca,1);return 32};this.GFb=()=>{this.EL.W_&&this.EL.Tw();return 32};this.e4i=(ca,ta,Na,qb,Jb)=>{if(ta="object"===
typeof Jb?Jb:null)ca===Nc.a.s1f?(ca=Qs.zWa!==Nc.a.oOa&&Qs.zWa!==Nc.a.sgb,ta[this.vrb]=Qs.zWa===Nc.a.oOa||ca):ca===Nc.a.t1f&&(ta[this.vrb]=Qs.zWa===Nc.a.sgb);return 32};this.HXh=(ca,ta,Na)=>{1!==Na&&(ca===Nc.a.sgb&&Qs.zWa!==Nc.a.sgb?(v.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.Jm.undo()&&(ta=new vt.a(1,w.AFrameworkApplication.isRtl),ta.$0c="ExternalContent",Qs.qgb.$2c(ta))):ca===Nc.a.oOa&&Qs.zWa!==Nc.a.oOa&&(v.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.YTg.L5i()),Qs.zWa=ca);ea.a.sendTelemetryEvent(Object.assign(new pa.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new na.a,{name:"behavior",string:Na.toString()}),Object.assign(new na.a,{name:"ActionId",int64:ca})]}));return 32};this.ga=b;this.Jm=k;this.YTg=D;this.F6j=P;this.TWj=this.mxl.bind(this);w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.YTg.J7i(()=>{this.reset()})}Tb(){this.ga.fb(Nc.a.s1f,lc.a.view,this.e4i,97);this.ga.fb(Nc.a.t1f,lc.a.view,this.e4i,97);this.ga.fb(Nc.a.GXh,lc.a.view,this.TWj,1028);this.ga.fb(Nc.a.oOa,lc.a.view,this.HXh,1028);this.ga.fb(Nc.a.sgb,lc.a.view,this.HXh,1028);this.F6j||(this.ga.fb(Nc.a.Ajc,lc.a.view,this.Ajc,96),this.ga.fb(Nc.a.GFb,lc.a.view,this.GFb,96))}Pto(b){new aK(this.ga,b,Qs.Wma)}mxl(b,k,t){1!==t&&this.Pto(Qs.zWa);return 32}static get qgb(){return null!=Qs.byg?Qs.byg:Qs.byg=Fa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get Wma(){Qs.rAa||
(Qs.rAa=Fa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Qs.rAa}reset(){Qs.zWa=null!=Qs.Wma?Qs.Wma.E9a?Nc.a.oOa:Nc.a.sgb:Nc.a.oOa}}Qs.zWa=Nc.a.oOa;Qs.rAa=null;Object(n.a)(Qs,"ExternalContentActor",null,[]);class YD extends mz{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc){super(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac);this.bTc=yc;this.PKd=!1;this.ZZg=null}v3c(){this.PKd||(super.v3c(),this.PKd=!0)}Xme(){this.PKd&&(super.Xme(),YD.aUh&&this.ZZg&&YD.aUh.removeHandler(bA.a.Bta,
this.ZZg),this.PKd=!1)}vQb(){if(this.bTc){this.oua.W_&&this.oua.Tw();const b=new vt.a(0,w.AFrameworkApplication.isRtl);b.location=this.S4a.UOa();this.showFloatie(null,b)}else this.oua.W_&&w.AFrameworkApplication.va.processAction(Nc.a.GFb,2),w.AFrameworkApplication.va.processAction(Nc.a.Ajc,2);this.Gbc=!1}Tw(b){!this.tFe&&(b&&(this.S4a.OAf(),this.XCj()),this.oua.W_||this.UKa)&&(this.UKa=!b,this.Xme(),this.bTc?this.oua.Tw():w.AFrameworkApplication.va.processAction(Nc.a.GFb,2))}showFloatie(b,k){k||(k=
new vt.a(0,w.AFrameworkApplication.isRtl));k.location||(k.location=this.S4a.UOa());if(!k.location)return!1;this.UKa&&(this.UKa=!1,this.v3c());this.bTc?(b=Array(1),b.push("ExternalContent"),this.oua.showFloatie(this.S4a.UOa(),b,1)):w.AFrameworkApplication.va.processAction(Nc.a.Ajc,2);return!0}HIc(){if(!this.Gbc){const b=new Df.a(3,1,this.qOh,()=>{this.vQb()},196);wb.a.instance.Vb(b);this.Gbc=!0}}zia(){this.bTc?this.oua.W_&&this.oua.Tw():w.AFrameworkApplication.va.processAction(Nc.a.GFb,2);this.HIc()}xNb(){this.bTc?
this.oua.W_&&this.oua.Tw():w.AFrameworkApplication.va.processAction(Nc.a.GFb,2);this.HIc()}static get aUh(){return null!=YD.Oxg?YD.Oxg:YD.Oxg=Fa.a.instance.resolve("Box4.IEditStateEventManager")}}Object(n.a)(YD,"ExternalContentFloatieEventManager",mz,[]);class ZD extends kx{constructor(b,k,t,D,P){super(b,k,t,D,P)}Jzh(){if(!this.ib||!this.ib.hb||!this.ib.hb.kb)return v.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var b=this.ib.hb.kb.Qa,
k=!b.cpBegin&&!b.cpEnd;let t=b.node;if(t&&k&&!t.mJ){do t=this.Jdi(t);while(t&&!t.mJ&&Object(ob.a)(Un.AParagraphNode,t)&&!t.characterData.trim().length)}let D="";const P=Object(Ka.a)(Un.AParagraphNode,t);P&&(D=P.characterData.length===b.cpBegin||k?P.characterData.trimEnd():P.characterData.substring(0,b.cpBegin).trimEnd());k=P?D.length:b.cpBegin;b=Object.assign(new uB,{Kxa:Object(Ka.a)(70,(P?Object(Ka.a)(70,P):Object(Ka.a)(70,t))||b.node),Afc:k});return this.Upf(b)}G9h(b,k){let t=null;const D=Object(Ka.a)(191,
b.Kxa.Qj(k.ic));if(!D)return null;if(Object(ob.a)(Un.AParagraphNode,b.Kxa)){const P=Object(Ka.a)(Un.AParagraphNode,b.Kxa);if(P.rQ){if(b=Object(Ka.a)(Pj.a,pe.ParagraphReader.VOa(P)))(b=Object(Ka.a)(191,b.Qj(k.ic)))&&(t=b.getBounds()),t&&(t.height+=ZD.T_h,t.width-=ZD.dEl);return t}k=Object(Ka.a)(100,D);if(!k)return null;try{if(t=this.eta.a_(b.Afc,k,0<b.Afc,!1,!1,!1))t.height+=ZD.T_h}catch(ca){v.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",
ca),t=null}}t||(t=D.getBounds());return t}}ZD.T_h=65;ZD.dEl=100;Object(n.a)(ZD,"ExternalContentFloatiePositionProvider",kx,[]);class bK{constructor(b,k,t,D,P,ca){this.T6f=(ta,Na,qb)=>{if(1===qb)return w.AFrameworkApplication.protectFile||w.AFrameworkApplication.JG||w.AFrameworkApplication.poa||$b.SessionStatusManager.instance.wj?8:32;if(ta===Pb.a.print)ta=1;else if(ta===Nc.a.SJc)ta=0;else if(ta===Nc.a.mJd)ta=2;else return 8;return this.C8n(ta)};this.ga=b;this.d6=k;this.DUb=t;this.Z_j=D;this.VRg=P;
this.iXj=ca;this.BI=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback")}Tb(){w.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&this.Z_j||w.AFrameworkApplication.JG?(document.body.classList.add("WACStopPrinting"),""!==this.VRg&&this.iXj.puo(this.VRg)):(this.ga.qa(Pb.a.print,lc.a.application,this.T6f),this.ga.qa(Nc.a.SJc,lc.a.application,this.T6f),this.ga.qa(Nc.a.mJd,lc.a.application,this.T6f))}C8n(b){const k=w.AFrameworkApplication.rootQuerySignature;if(!k||""===k||Wa.App.rd&&Wa.App.rd.OA.jo)return 8;
this.DUb.AXd=!1;this.DUb.sJj.start();Nv.a.FQ(5,!0,Object(A.a)(this.DUb,this.DUb.M2n,"requestFileDownload"),Object(A.a)(this.DUb,this.DUb.mKb,"onForceSaveFailed"),b);this.Zpe();return 32}Zpe(){w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.BI&&(v.ULS.sendTraceTag(509145741,306,50,"DownloadCopyIntercept logged for: DownloadAsPDF"),this.BI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}}Object(n.a)(bK,"FileDownloadActor",
null,[]);class cK extends ng{constructor(b,k=null){super(b,!0,k,!1)}get qyf(){return null}get f4a(){return w.AFrameworkApplication.G_a?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get Ecc(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get Nzd(){return null}}Object(n.a)(cK,"DownloadAsPdfDialog",ng,[]);class fw{constructor(){this._url=this.nv=null;this.NXa=this.MXa=0;this.Zcb=!1;this.makeRequest=
()=>{w.AFrameworkApplication.Ne.sj(this._url,1,null,null,!0,2,this.yKb,this.hpa,null)};this.yKb=b=>{fw.L4c();const k=b.data.Aia;let t=null;if(k)try{t=k.selectSingleNode("/docdata/status")}catch(D){}t&&("InProgress"===t.text&&22>this.MXa++||"ServiceBusy"===t.text&&3>this.NXa++)?this.gHa(1E3*(this.MXa+this.NXa)):this.nv(!0,t?t.text:null,b.data)};this.hpa=b=>{this.Zcb?(fw.pBa||(fw.Mab=new Date,fw.pBa=!0,fw.NS=1),18E4>(new Date).getTime()-fw.Mab.getTime()?this.retryOnFailure(4<=fw.NS?2E4:1E3):this.B1a(b.data)):
4>fw.NS?this.retryOnFailure(2E3):this.B1a(b.data)}}send(b,k,t){this._url=b;this.nv=k;this.Zcb=t;this.makeRequest(null)}gHa(b){b=new Df.a(2,1,b,this.makeRequest);w.AFrameworkApplication.nc.Vb(b)}retryOnFailure(b){this.gHa(b);fw.NS++}B1a(b){this.nv(!1,null,b)}static bba(b,k){(new fw).send(b,k,!1)}static L4c(){fw.pBa=!1;fw.NS=0}}fw.Mab=null;fw.pBa=!1;fw.NS=0;Object(n.a)(fw,"ClientRequestWithRetry",null,[]);class dK extends yf{constructor(b){super(b,void 0,w.AFrameworkApplication.G_a)}get f4a(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}get Ecc(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get tXc(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get qIc(){return w.AFrameworkApplication.G_a?
"UIFontDialogTextLarge":null}iKf(){v.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}jKf(){v.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}NXc(){v.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get $Wc(){return JG.cRi}get Ekb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get mNi(){return!w.AFrameworkApplication.G_a}}Object(n.a)(dK,"DownloadAsOdtDialog",yf,[]);class eK{constructor(b,k){this.C$a=this.EYa=
null;this.L6a=t=>{1===Wa.App.ya.state||this.EYa||(this.EYa=(new pp.a).create(),t=t.customData,this.L_m(t),1===t?this.EYa.message=this.ysb.zQ.isEnabled?w.AFrameworkApplication.G_a?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:t?2===t&&(this.EYa.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.EYa.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,this.EYa.oL(CommonUIStrings.l_DefaultDialogTitle,
this.cancelButton,null))};this.cancelButton=()=>{this.AXd=!0};this.u0=(t,D,P)=>{this.jgg("Success. Save and Conversion Complete.");P=new eb.QueryStringBuilder(P.request.get_url());w.AFrameworkApplication.Sea(P);P=P.toString();const ca=this.$2n(P);this.Gma(ca);2!==ca&&this.ysb.PFn();!t||D?this.h5(ca):this.AXd?(this.AXd=!1,this.C$a=null):(this.C$a&&w.AFrameworkApplication.nc.Ve(this.C$a),this.C$a=null,this.snl(P,ca))};this.AXd=!1;this.ysb=b;this.sJj=k.YQa("UserAction","WordEditorForceSaveAndPrint")}Gma(b){this.EYa&&
(this.W_m(b),this.EYa.close(),this.EYa=null)}h5(b){if(1!==Wa.App.ya.state){this.Y0m(b);const k=new Uc.StandardDialog;k.Ad=0;k.Ee(1,CommonUIStrings.l_DialogClose);k.ix(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}ktf(b){switch(b){case 0:return"downloadpdf";case 1:return"printpdf";case 2:return"odt";default:return v.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),"printpdf"}}M2n(b){var k=w.AFrameworkApplication.rootQuerySignature;
k&&""!==k?(k="WordViewer/request."+this.Rif(b)+"?"+k+"&type="+this.ktf(b)+"&rndm="+lb.a.create(),1===b&&this.ysb.Jso()&&(k+="&useNamedAction=1"),w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("CustomFontReadModePDFIsEnabled")&&uq.FontUtils.vhe()&&(1===b||!b)&&(0<uq.FontUtils.aOh&&(k+="&cfcVer="+uq.FontUtils.aOh),uq.FontUtils.$Nh&&(k+="&cfcUrl="+uq.FontUtils.$Nh),uq.FontUtils.bOh&&(k+="&cfcEncData="+uq.FontUtils.bOh)),fw.bba(k,this.u0),this.C$a||(this.C$a=new Df.a(2,1,500,this.L6a),this.C$a.customData=
b,w.AFrameworkApplication.nc.Vb(this.C$a))):(this.jgg("failed. QuerySignature is empty."),this.h5(b))}Rif(b){return 2===b?"odt":"pdf"}mKb(){this.jgg("Failed. force save failed.")}$2n(b){if(0<b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;v.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}jgg(b){v.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",
b);this.sJj.stop()}snl(b,k){const t=new Eb.a;t.add("access_token");t.add("access_token_ttl");1!==Wa.App.ya.state&&(1===k?this.ysb.$uo(b,t):k?2===k&&new dK(b):new cK(b))}dispose(){}L_m(b){switch(b){case 0:v.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");break;case 2:v.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:v.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;default:v.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}W_m(b){switch(b){case 0:v.ULS.sendTraceTag(38114786,
203,50,"Download Cancelled: Pdf");break;case 2:v.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:v.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:v.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}Y0m(b){switch(b){case 0:v.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:v.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:v.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;
default:v.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}}Object(n.a)(eK,"FileDownloadManager",null,[]);class $D{get key(){return"LIST"}get Pw(){return Box4Intl.Box4Strings.l_ListContentTitle}Rlc(b){let k=null;const t=$D.Gd.hw(b);if(!t)return{returnValue:!1,nma:k};b=this.R_l(b,t);k=Object.assign(new nr.a,{KG:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,nma:k}}KDb(b,k){b=b.contentObject;const t=this.CZl(b.Hx),D=new Ph.a;k?(k=k.contentObject,k.level!==b.level?(D.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),D.add(t)):k.id.equals(b.id)&&k.Hx.listType===b.Hx.listType||D.add(t)):(D.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),D.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),D.add(t));return D.toArray().join(" ")}CZl(b){let k="";const t=b.listStyle;if(!b.listType)k=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.Cu);else if(1===b.listType)switch(t){case 1:k=this.zyh;break;case 2:k=this.cOk;break;case 3:k=this.dOk;break;default:k=
this.zyh}return k}static get Gd(){return null!=$D.yDg?$D.yDg:$D.yDg=Fa.a.instance.resolve("Box4.List.IListReader")}}Object(n.a)($D,"ListDetailsProvider",null,[481,417]);class fK{constructor(){this.Hx=this.listId=this.id=null;this.level=0}}Object(n.a)(fK,"ListItemInfo",null,[]);class gK extends $D{constructor(b){super();this.l6=b}get zyh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get cOk(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get dOk(){return WoncaIntl.WoncaStrings.L_BulletStyle3}R_l(b,
k){const t=this.l6.tB(b);return Object.assign(new fK,{id:b.currentNode.id,listId:new X.a(lb.a.nil,t.listID),Hx:k,level:t.level+1})}}Object(n.a)(gK,"FlatListDetailsProvider",$D,[]);class hK{constructor(b,k){this.ga=b;this.Gf=k}get sc(){return null!=this.mJg?this.mJg:this.mJg=Fa.a.instance.Na("Box4.Styles.IWACStyleReader")}Tb(){}}Object(n.a)(hK,"FormattingActor",null,[]);var LM=c(1154),NE=c(1284),MM=c(1689);class iK{constructor(b,k,t,D,P,ca,ta,Na){this.Fb=b;this.Hhk=k;this.Hc=t;this.Gtb=D;this.Do=P;
this.Ma=ca;this.ld=ta;this.E7j=Na}Jec(b,k,t,D,P,ca,ta){v.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ta.si});this.Gtb.then(()=>{this.Hhk(b.data.xe);v.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ta.si});ta.stop()})}hpa(b,k,t,D,P,ca,ta){ca.stop();P();ta?(this.uAn(k,t),v.ULS.sendTraceTag(574377989,
3001,15,"{0}",{["message"]:b,["id"]:Be.ImageReader.YOa(k.Fb)})):v.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:Be.ImageReader.YOa(k.Fb)})}ssh(b,k){b.Ce(kG.a.S9e,"1");if(this.ld&&this.ld.isFeatureEnabled(49)){var t=this.Do.Ym(k.$j);t=this.Do.mk(t);b.Ce(Rh.a.Ys,NE.a[t]);5===t&&this.qCk(b,k)}this.E7j&&b.Ce(Rh.a.LVd,"true")}gmh(){return new MM.a(this.Fb.id,this.Fb)}CRd(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}uAn(b,k){const t=this.Hc.Mc(7,Pb.a.tjm);t.Cb(k);
b.Fb.setValue(Cc.a.zHh,!0);t.dispose()}qCk(b,k){var t=k.$j;k=this.Do.Ym(t);var D=t.node;const P=(t=this.Do.vEa(k,D.Kc,!1))?this.Do.nEa(t):"";if(""===P)throw v.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),Error.argumentNull("OriginalObjectDataBlobId");D=(D=this.Do.vEa(k,D.Kc,!0))?this.Do.nEa(D):"";b.Ce(Rh.a.bfc,P);b.Ce(Rh.a.wJj,D);t=t.ia(zi.a.NYh,"");""!==t&&b.Ce(Rh.a.extension,t);b.Ce(Rh.a.width,this.Do.fF(k).toString());b.Ce(Rh.a.height,this.Do.wG(k).toString());
b.Ce(Rh.a.h1c,this.Do.Nhb(k).toString());t=this.Ma.$("WordEditorImageCropIsEnabled");b.Ce(Rh.a.lNh,t.toString());t&&(t=this.Do.pba(k),b.Ce(Rh.a.top,t.top.toString()),b.Ce(Rh.a.bottom,t.bottom.toString()),b.Ce(Rh.a.left,t.left.toString()),b.Ce(Rh.a.right,t.right.toString()));t=this.Ma.$("WordEditorImageRotateIsEnabled");b.Ce(Rh.a.Bej,t.toString());t&&(b.Ce(Rh.a.angle,this.Do.z_(k).toString()),b.Ce(Rh.a.flipH,this.Do.A5(k,Cc.a.yQc,!1)?"true":"false"),b.Ce(Rh.a.flipV,this.Do.A5(k,Cc.a.KQc,!1)?"true":
"false"));b.Ce(Rh.a.HUh,"true")}}Object(n.a)(iK,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[569]);class jK{constructor(){this.xKa=null}WIk(b){this.xKa=b}teardown(){null!=this.xKa&&(this.xKa.teardown(),this.xKa=null);this.XNe=null}getGraphicData(){return this.xKa?this.xKa.getGraphicData():null}GWn(){null!=this.XNe&&this.setGraphicData(this.XNe)}setGraphicData(b){this.XNe=b;if(this.xKa)try{this.xKa.setGraphicData(b)}catch(k){v.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",
k.toString())}else v.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.xKa?this.xKa.hasEdits():!1}}Object(n.a)(jK,"GraphicsEditorGC2HostUser",null,[571]);var NM=c(1690),OM=c(1074),PM=c(1358),QM=c(782),RM=c(1451),SM=c(1073);class kK{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=k=>b.loadScript(k);this.preloadScript=k=>{b.preloadScript(k)}}}Object(n.a)(kK,"GC2ScriptLoader",null,[]);class kH{constructor(b,
k,t){this.kve=b;this._context=k;this.XLa=t}closeEditor(){this.kve&&(this.kve(),this.kve=null)}logActivity(b,k,t,D){bf.a(b,k,t,D)}logTrace(b,k,t,D){v.ULS.sendTraceTag(575522531,3001,kH.F6m(k),D)}isEnabled(b){const k=w.AFrameworkApplication.K;switch(b){case "EqualSizingGuide":return k.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return k.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return k.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",
!1);case "SpaceFirstLastPara":return k.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return k.$("ModernFontPickerIsEnabled");case "ShapeLocksSchema":return k.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShapeLocks",!1);default:return k.getBooleanFeatureGate(`Microsoft.Office.WordOnline.GC2.${b}`,!1)}}getFontPickerFonts(b){const k=`${Fa.a.instance.resolve("Box4.IFontServiceParser").t0a}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",
k);b=uq.FontUtils.mmf(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(t=>"premium"!==t.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getHealth(){return xa.Health.instance}getFonts(b){const k=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),t=k?"msofp_hier":"msofp",D=`${Fa.a.instance.resolve("Box4.IFontServiceParser").t0a}/${k?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(t,D);uq.FontUtils.Qmh();
uq.FontUtils.rnh({});b=uq.FontUtils.lmf(()=>!1,(P,ca)=>ca).MenuSectionList;k&&0<b.length&&(b.pop(),b.push(this.S2k()));return b}S2k(){const b=uq.FontUtils.mmf(()=>!1,()=>"").fonts.map((k,t)=>{const D=k.name;k=k.displayName;const P=uq.FontUtils.Coa(D);return Object.assign(new Yh.a,{MenuItemId:uq.FontUtils.Kgj+t,CommandValueId:D,LabelText:k||D,Styles:{["optionText"]:{["fontFamily"]:k&&!P?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:D})});return Object.assign(new fh.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,
Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const k=this._context.$j;var t=Be.ImageReader.Ym(k);if(this.hKm(t,k,b)&&(t=Be.ImageReader.A5(t,vd.a.lpa,""),t.length))return Promise.resolve(t);t=new eb.QueryStringBuilder("/we/GetImage.ashx?");t.T_b(k.node.Bi().rr);t.Ce(Rh.a.CHd,b);w.AFrameworkApplication.Sea(t);t.Ce(Bi.a.vqb,"1");uh.a.instance.Wyb(t);t.Ce(Rh.a.oOh,"true");const D=t.toString();return new Promise((P,ca)=>{this.XLa.sj(D,1,null,null,!1,2,ta=>{P(ta.data.xe)},ta=>{ca(ta.data.Qe.toString())},
null)})}getPlaceholders(){const b={};b.PictureDownloading=Nh.a.ug("progress.gif");b.PictureInvalid=Nh.a.ug("CancelRequest.32x32x32.png");return b}getTheme(){const b=Wk.PageNavigator.instance.Ts(this._context.view.ed).properties.ia(Cc.a.mle,"");return 0===b.length?[]:b.split(" ").map(k=>Wa.App.xAb[k])}static F6m(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}hKm(b,k,t){const D=k.node.Kc;k=Be.ImageReader.HQd(b,D,!1);b=Be.ImageReader.HQd(b,
D,!0);return t===k||t===b}}Object(n.a)(kH,"GraphicsEditorApp",null,[592]);class lK extends Wf.a{constructor(b,k,t,D,P){super(!1,!1,!0);this.closeEditor=()=>{this.aIh();this.dispose()};this.Zaa=ca=>{this.aIh(2===ca)};this.T$a=b;this.m4j=k;this.WYg=t;this._context=D;this.XLa=P}fuo(b){return new Promise((k,t)=>{this.Wh(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.Zaa,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(D,P)=>this.eKk(P,b),["onload"]:D=>{this.onLoad(D,k,t)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,
["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.T$a.GWn()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,k,t){b?(this.T$a.WIk(b),k(b)):(v.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),t(null))}eKk(b,k){const t=w.AFrameworkApplication.K,D=SM.a();D.loadScriptWithRetryHandler=b;const P=new kH(this.closeEditor,this._context,this.XLa),ca={["bootConfig"]:Object.assign(new PM.a,
{scriptBaseUrl:GE.AppChromeOverrideUtilities.isEnabled?GE.AppChromeOverrideUtilities.rQd(w.AFrameworkApplication.lcid):w.AFrameworkApplication.o5+w.AFrameworkApplication.lcid+"/",isMLRRibbonMode:w.AFrameworkApplication.ta.Nb.ojc,isCombinedBundleEnabled:w.AFrameworkApplication.K.$("IsCombinedBundleEnabled")}),["scriptLoader"]:new kK(new OM.DynamicScriptLoader(D)),["publicPath"]:w.AFrameworkApplication.o5,["appSettings"]:t.appSettings,["logger"]:new vk.a,["featureGateManager"]:Object.assign(new QM.a,
{getBooleanFeatureGate:Object(A.a)(t,t.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(A.a)(t,t.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(A.a)(t,t.getStringFeatureGate,"getStringFeatureGate")}),["app"]:P,["resolveScript"]:(ta,Na)=>RM.a.resolveScript(ta,Na),["initialTabId"]:k};t.$("DynamicBundlesIsEnabled")&&(k=w.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||w.AFrameworkApplication.K.$("IsCombinedBundleEnabled")?"":"exp/",ca.dynamicBundlesPath=
GE.AppChromeOverrideUtilities.isEnabled?GE.AppChromeOverrideUtilities.Thc+k:t.jb("StaticContentUrl")+k);return new Promise((ta,Na)=>{b("gc2",w.AFrameworkApplication.yz("gc2.js",5),"anonymous",5,!1).then(()=>{ta(ca)}).catch(()=>{v.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");Na(null)})})}aIh(b){b=this.T$a.hasEdits()&&!b;this.m4j(b?this.T$a.getGraphicData():null,!!this.WYg,this.WYg,b)}}Object(n.a)(lK,"ReactGraphicsEditorDialog",Wf.a,[]);class mK{constructor(b,
k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc,ed=!1){this.$1h=ed;this.Gtb=this._context=null;this.guo=(sd,oe,Ld,Od,ie)=>{var Ce,hg,Kg;const Hl=!!ie&&Object(ob.a)(X.a,ie);try{if(1===Ld){const bp=oe.view;return this.Oj.ofa(oe)&&bp.features.dke?32:8}this.Y7j=4===(null===ie||void 0===ie?void 0:ie.InputMethod)?!0:!1;Wa.App.instance&&Wa.App.instance.bHb&&(this.$1h||LM.a.mgb(()=>{this.$1h=!0}));v.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${Hl}`);performance.mark("LaunchStart");this._context=
oe;const wm=new lK(this.T$a,this.YSf,Hl?ie:null,oe,this.Wf);sd=null;if(Hl&&(null===(Ce=w.AFrameworkApplication.K)||void 0===Ce?0:Ce.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectDrawInDrawingCanvasForPictures",!1))){const bp=null===(Kg=null===(hg=oe.view.mb)||void 0===hg?void 0:hg.hb)||void 0===Kg?void 0:Kg.kb;if(null===bp||void 0===bp?0:bp.JH)sd="Draw"}this.Gtb=wm.fuo(sd).then(()=>{v.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${Hl}`)}).catch(()=>
{this.$Rh()});if(!Hl){const bp=fB=>{this.Gtb.then(()=>{this.wWi(fB,!1)})};if(w.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===w.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return bp(JSON.stringify({elements:[]})),32;let qv=null;qv=Wk.PageNavigator.instance.Ts(oe.view.ed);const eB=qv.properties.ia(Cc.a.a2h,"");if(0<eB.length)return bp(eB),32;this.PBe.zbo(oe,X.a.create(),lb.a.create()).then(fB=>{const PD=this.Hc.Mc(0,Pb.a.aQc);PD.Cb(qv);qv.setValue(Cc.a.a2h,fB);PD.dispose();
bp(fB);return null}).catch(fB=>{v.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",fB.toString(),Hl);this.$Rh()})}return 32}catch(wm){return v.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",wm.toString(),Hl),8}};this.$km=(sd,oe,Ld,Od,ie)=>{if(!oe.view.features.dke)return 32;v.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.XTh(ie,oe);return 32};
this.Zkm=(sd,oe,Ld,Od,ie)=>{var Ce,hg,Kg;const Hl=oe.view;if(null===(Ce=w.AFrameworkApplication.K)||void 0===Ce?0:Ce.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))if(Ce=null===(Kg=null===(hg=null===Hl||void 0===Hl?void 0:Hl.mb)||void 0===hg?void 0:hg.hb)||void 0===Kg?void 0:Kg.kb,null===Ce||void 0===Ce||!Ce.F2a)return 8;return this.Dki(sd,oe,Ld,Od,ie)};this.Dki=(sd,oe,Ld)=>{if(1===Ld)return oe.view.features.dke?32:8;if(2===Ld){sd=Be.ImageReader.Ym(oe.$j);if(!sd)return 2;
v.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.XTh(sd,oe);return 32}return 2};this.wWi=(sd,oe=!0)=>{this.T$a.setGraphicData(sd);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");sd=performance.getEntriesByName("EditorLaunch");v.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${oe} Duration: ${sd[sd.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");
performance.clearMeasures("EditorLaunch")};this.YSf=(sd,oe,Ld,Od)=>{var ie;this.T$a.teardown();if(oe&&this._context){var Ce=this._context.view.mb.sg,hg=Ce.node;Ce.al&&pe.ParagraphReader.Wb(hg)&&(Ce=null===(ie=this.dQ)||void 0===ie?void 0:ie.pA(hg),27==(null===Ce||void 0===Ce?void 0:Ce.role)&&v.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",Od,Od?" Everything deleted: "+(0==(null===sd||void 0===sd?void 0:sd.json.length)):""))}if(Od)if(v.ULS.sendTraceTag(541714E3,
3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(sd)if(Od=sd.json,ie=sd.width,hg=sd.height,Od.length||oe)if(!Od.length&&oe)if(oe=this._context.$j){oe=oe.node;if(Be.ImageReader.t8(oe)){if(!this.Oj.ZWn(oe,new ze.GraphIterator,Yj.a.instance,ZJ.DeleteActor.G_b)){v.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.Oj.Vgc(oe,Ld,this.eb,this.vV)){v.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}v.ULS.sendTraceTag(572363226,
3001,50,"Graphic removed thru dialog.")}else v.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else Ce=new NM.a(this._context,w.AFrameworkApplication.ta.IEa,!0,this.Oj,this.Ma,Wk.PageNavigator.instance),sd=lb.a.create(),Ld=new xJ.a(Ce,Od,this.WJ,this.Jm,sd,tk.a.instance,oe,Ld,this.Oj,this.Do,ie,hg,this.Ma,this.vV,this.ld,Wa.App.instance.bHb,Wa.App.instance.Tyf),this.PBe.$9f(Ld,this._context,oe,sd),this.Kqa(),this.Y7j&&this.YKo();else v.ULS.sendTraceTag(541714001,
3001,50,"Empty Json on new content creation when close dialog");else v.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else v.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Ma=k;this.PBe=t;this.Oj=D;this.WJ=P;this.Jm=ca;this.T$a=new jK;this.Hc=Na;this.eb=qb;this.vV=Jb;this.Do=Vb;this.ld=yc;this.Wf=ac;this.dQ=Kc}Tb(){var b;let k=!0;this.Ma.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(k=this.ld&&this.ld.isFeatureEnabled(49));
k&&!aa.a.ut&&(this.ga.fb(Nc.a.graphicsEditor,lc.a.view,this.guo,4),this.ga.fb(Pb.a.lgf,lc.a.view,this.$km,4),this.ga.fb(Nc.a.ZTh,lc.a.view,this.Zkm,4),(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))&&this.ga.fb(Nc.a.U4b,lc.a.view,this.Dki,4))}$Rh(){const b=new Uc.StandardDialog;b.Ad=0;b.ix(zk.a.agf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,
null);Wa.App.ya.updateCommandUI()}XTh(b,k){var t=b.ia(ke.a.T4,1);const D=b.ia(zi.a.O_,0);t&&1!==D?b.ia(Cc.a.zHh,!1)?(k=new Uc.StandardDialog,k.Ad=0,k.ix(zk.a.agf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),Wa.App.ya.updateCommandUI(),v.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",["id"]:Be.ImageReader.YOa(b)})):(this.ga.Qb(Nc.a.graphicsEditor,2,b.id),
this.Gtb||(v.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.Gtb=new Promise(P=>{P(null)})),t=lb.a.create(),b=new iK(b,this.wWi,tk.a.instance,this.Gtb,this.Do,this.Ma,this.ld,Wa.App.instance.c4(this.Do.mk(b))),this.PBe.$9f(b,k,!0,t)):v.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}Kqa(){const b=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");b?b.execute(k=>{k.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):
v.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}YKo(){const b=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");b?b.execute(k=>{k.logActivity("WordPenNsatSurvey","WordPenNsatSurveyIsEnabled")}):v.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(n.a)(mK,"GraphicsEditorActor",null,[]);var TM=c(513);class nK{constructor(b,k,t){this.SVa="wwaengidc";this.lgd="CreateLinkForHeading";this.LZj="CreateLinkForHeadingAction";this.T0j="\ufffc";this.FVa=
b;this.ga=k;this.eb=t}Tb(){this.ga.qa(Nc.a.VHc,lc.a.paragraph,this.abf.bind(this));this.ga.qa(Nc.a.VHc,lc.a.Hd,this.abf.bind(this));this.ga.qa(Nc.a.VHc,lc.a.Tc,this.abf.bind(this));this.ga.Vc(Nc.a.VHc,1028)}abf(b,k,t){b=k.node;if(1===t)return this.Qxi(b)?32:8;this.SPn(this.lgd,this.LZj);if(!this.Qxi(b))return v.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;t=b.getValue(Cc.a.Lc);if(!t)return v.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),
t=new Map,t.set("Source",this.lgd),t=Object.assign(new Db.a,{additionalValues:t}),xa.Health.instance.recordKpiFailure(this.lgd,"Unable to create sharable link as paragraph id is missing",!1,!0,t),8;this.bLh(t);return 32}bLh(b){b=String.format('{{"{0}":"{1}"}}',TM.a.heading,b);this.ga.Qb($a.a.Z7,2,{["nav"]:btoa(b),["mode"]:"copy"},{["ControlId"]:"CopyLinkToHeading"})}Qxi(b){return!this.eb.Wb(b)||this.eb.$Tc(b)||this.eb.nac(b)||b.vr||""===b.characterData||b.characterData===this.T0j||!this.FVa.wPd(b)?
!1:!0}SPn(b,k){const t=new Map;t.set("Source",this.lgd);t.set("Action",k);xa.Health.instance.recordKpiUsage(b,0,this.SVa,t)}}Object(n.a)(nK,"HeadingsActor",null,[]);class oK{iro(b){return pe.ParagraphReader.lua(this.e9h(b))}G6c(b,k,t){if(b=pe.ParagraphReader.VOa(this.e9h(b)))k=b.De(k),Object(ob.a)(545,k)&&(Ms.m(b)?k.Alo(t):k.G6c())}e9h(b){return b&&b.al&&b?b.node:null}}Object(n.a)(oK,"IFrameFocusStrategy",null,[546]);class pK{constructor(b){this.IBa=null;this.zkd=b}HJi(){v.ULS.sendTraceTag(25007835,
375,50,"Ignore all spelling error triggered")}YBj(b){if(!b)return v.ULS.sendTraceTag(25007836,375,15,"Error range is null"),!1;if(!b.errorDetails)return v.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return v.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.IBa=F.a.zle(b.errorDetails.token,b.errorDetails.lcid);this.zkd.add(this.IBa,b.errorDetails.lcid);return!0}Fhe(b){return b?
b.token?F.a.zle(b.token,b.lcid)===this.IBa:(v.ULS.sendTraceTag(25007840,375,15,"ErrorDetails Token is null"),!1):(v.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(n.a)(pK,"IgnoreAllProofingErrorStrategy",null,[544]);var UM=c(1368),VM=c(566),qK=c(529);class rK{constructor(b,k){this.filename=b;this.blob=k}}Object(n.a)(rK,"UploadBlobParameters",null,[]);class sK extends ml{constructor(b,k,t,D,P,ca,ta,Na=null){super(b,k,t,null,P,ca,!1);this.d9j="DragAndDrop";
this.BUg="FileName";this.EUg=0;this.Pjh=null;this.Yne=this.y4b=!1;this.KSg=D;this.zah=Na}get aP(){return this.d9j}get fileExtension(){return this.BUg}get fileSize(){return this.EUg}get lHj(){return this.Pjh}l9c(b){const k=new rK(this.KSg.name,this.KSg);b.xvj(k);this.Pjh=b.Wcb}tOa(b,k){this.zah&&this.zah();super.tOa(b,k)}XZo(b){const k=!!b&&this.oza(b.name,null)&&this.Ung(b,null);b&&(this.BUg=b.name,this.EUg=b.size);k||this.t2d();return k}}Object(n.a)(sK,"DragDropInsertImageUploader",ml,[]);class Rs{constructor(b,
k,t,D,P,ca,ta){this.HRc=ca;this.HR=ta;this.E3d=this.F3d=this.b4d=this.c4d=0;this.ga=null;this.Sff=(Na,qb,Jb)=>{if(Wa.App.FId)return 8;Na=qb.node;return 1===Jb?Na?32:2:2===Jb?(Jb=Be.ImageReader.Ym(qb),qb=Be.ImageReader.KOc(Jb,qb.node.Bi().od,w.AFrameworkApplication.K,w.AFrameworkApplication.ta.IEa),AB(qb),32):2};this.LAm=(Na,qb,Jb)=>{var Vb;const ac=this.Oj.ofa(qb);if(2===Jb&&ac){if(Pb.a.WQ===Na||Pb.a.YCd===Na)w.AFrameworkApplication.Noa?w.AFrameworkApplication.yeg():((null===(Vb=w.AFrameworkApplication.K)||
void 0===Vb?0:Vb.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&tw.a.instance.A5a("PictureLocal"),this.tbl(qb));return 32}return 1!==Jb||Pb.a.WQ!==Na&&Pb.a.YCd!==Na?2:ac?32:2};this.rGb=(Na,qb,Jb,Vb,ac)=>this.Oj.ofa(qb)?1===Jb?32:this.Oj.wAf(qb,ac)?32:2:2;this.Uko=()=>{if(this.ib&&this.ib.hb&&this.ib.hb.kb){const Na=this.ib.hb.kb.Qa;Na&&this.ib.setSelection(Gf.SelectionFactory.te(Na.node,Na.cpBegin))}};this.tql=(Na,qb,Jb,Vb,ac)=>{v.ULS.sendTraceTag(42530333,307,50,
"Drag and drop local content");if((Na=ac.DataTransfer)&&Na.files&&0<Na.files.length){v.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",Na.files.length));for(Jb=0;Jb<Na.files.length;Jb++)Vb=Na.files[Jb],0<=F.a.Tg(Vb.type).indexOf("image")&&this.Yzm(Vb,qb)&&(Vb=this.ib.hb.kb.Qa,this.ib.setSelection(Gf.SelectionFactory.te(Vb.node,Vb.cpBegin+1)));this.ZIa();return 32}v.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.ZAn=(Na,qb,Jb,Vb,ac)=>
{if(2===Jb)return w.AFrameworkApplication.va.Nf(qb.$j,Na,Jb,!0,Vb,ac);if(!qb.view.qe)return 8;Na=qb.view;if(!Na.mb)return 8;Na=Rs.Wg.$N(Na.mb.sg);return 1===Na.length&&this.ZN(Na[0])?(this.d4m(),this.gWc||Rs.aZf(!0),32):8};this.Rjm=(Na,qb,Jb)=>{if(!this.ZN(qb))return 8;const Vb=Be.ImageReader.Ym(qb),ac=Be.ImageReader.fF(Vb),yc=Be.ImageReader.wG(Vb);Na=Na===Pb.a.gUd;v.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:Na});if(1===Jb)return this.lf.Y3||Be.ImageReader.U2a(Vb)?2:Na&&
ac<this.F3d&&yc<this.E3d||!Na&&ac>this.c4d&&yc>this.b4d?32:2;Jb=Na?1.1:.9;this.setSize(Vb,qb,ac*Jb,yc*Jb,!0);return 32};this.ngc=(Na,qb,Jb,Vb,ac)=>{if(!this.pCa(qb))return 8;Na=Be.ImageReader.Ym(qb);qb=Be.ImageReader.rEa(Na);Jb=Be.ImageReader.qEa(Na);if(0>=qb||0>=Jb)return 2;Na=Be.ImageReader.fF(Na)/qb*100;ac.setValue(vd.a.ORc,Na);return 32};this.J9b=(Na,qb,Jb,Vb,ac)=>{if(!this.pCa(qb))return 8;Na=Be.ImageReader.Ym(qb);if(1===Jb)return this.lf.Y3||Be.ImageReader.U2a(Na)?2:32;v.ULS.sendTraceTag(20459937,
322,50,"Change image scale.");Jb=ac.ia(vd.a.ORc,-1)/100;Vb=ac.ia(vd.a.Noi,!1);const yc=ac.ia(vd.a.Nyf,!0);ac=ac.ia(vd.a.Oyf,!0);if(0>=Jb)return Rs.Ic.Yb(Pe.a.en,{["Reason"]:He.a.CGb}),2;const Kc=Be.ImageReader.rEa(Na),ed=Be.ImageReader.qEa(Na),sd=Be.ImageReader.fF(Na),oe=Be.ImageReader.wG(Na);if(0>=Kc||0>=ed)return Rs.Ic.Yb(Pe.a.n1,{["Reason"]:He.a.CGb}),2;Vb?(Vb=yc?Jb*sd:sd,Jb=ac?Jb*oe:oe):(Vb=yc?Jb*Kc:sd,Jb=ac?Jb*ed:oe);this.setSize(Na,qb,Vb,Jb);Wa.App.rd.Yo&&Wa.App.rd.kq.rH(qb.node);this.ZIa();
return 32};this.ULb=(Na,qb,Jb,Vb,ac)=>{if(!this.ZN(qb))return 8;Na=Be.ImageReader.Ym(qb);Na=Be.ImageReader.wG(Na);if(0>=Na)return 2;ac.setValue(vd.a.OEa,Na);return 32};this.OEa=(Na,qb,Jb,Vb,ac)=>{if(!this.pCa(qb))return 8;Na=Be.ImageReader.Ym(qb);if(1===Jb)return this.lf.Y3||Be.ImageReader.U2a(Na)?2:32;v.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Jb=ac.ia(vd.a.OEa,0);ac=Be.ImageReader.T2a(Na);if(0>=Jb)return Rs.Ic.Yb(Pe.a.en,{["Reason"]:He.a.CGb}),2;Vb=Be.ImageReader.rEa(Na);
const yc=Be.ImageReader.qEa(Na),Kc=Be.ImageReader.fF(Na);var ed=Be.ImageReader.wG(Na);ed=Kc/ed;if(0>=Vb||0>=yc)if(Rs.Ic.Yb(Pe.a.n1,{["Reason"]:He.a.CGb}),this.vpj(Na))return 2;this.setSize(Na,qb,ac?Jb*ed:Kc,Jb);Wa.App.rd.Yo&&Wa.App.rd.kq.rH(qb.node);Wa.App.ya.updateCommandUI();return 32};this.VLb=(Na,qb,Jb,Vb,ac)=>{if(!this.ZN(qb))return 8;Na=Be.ImageReader.Ym(qb);Na=Be.ImageReader.fF(Na);if(0>=Na)return 2;ac.setValue(vd.a.PEa,Na);return 32};this.PEa=(Na,qb,Jb,Vb,ac)=>{if(!this.pCa(qb))return 8;Na=
Be.ImageReader.Ym(qb);if(1===Jb)return this.lf.Y3||Be.ImageReader.U2a(Na)?2:32;v.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");Jb=ac.ia(vd.a.PEa,0);ac=Be.ImageReader.T2a(Na);if(0>=Jb)return Rs.Ic.Yb(Pe.a.en,{["Reason"]:He.a.CGb}),2;Vb=Be.ImageReader.rEa(Na);const yc=Be.ImageReader.qEa(Na);var Kc=Be.ImageReader.fF(Na);const ed=Be.ImageReader.wG(Na);Kc=ed/Kc;if(0>=Vb||0>=yc)if(Rs.Ic.Yb(Pe.a.n1,{["Reason"]:He.a.CGb}),this.vpj(Na))return 2;this.setSize(Na,qb,Jb,ac?Jb*Kc:ed);Wa.App.rd.Yo&&
Wa.App.rd.kq.rH(qb.node);Wa.App.ya.updateCommandUI();return 32};this.XLb=(Na,qb,Jb,Vb,ac)=>{if(!this.ZN(qb))return 8;Na=Be.ImageReader.Ym(qb);Na=Be.ImageReader.T2a(Na);ac.setValue(vd.a.OX,Na);return 32};this.OX=(Na,qb,Jb,Vb,ac)=>{if(!this.ZN(qb))return 8;Na=Be.ImageReader.Ym(qb);if(1===Jb&&this.lf.Y3)return 2;Wa.App.rd.Yo&&Wa.App.rd.kq.rH(qb.node);ac&&(qb=ac.ia(vd.a.OX,!0),v.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.Oj.Akj(Na,qb),Wa.App.ya.updateCommandUI());return 32};
this.i5a=(Na,qb,Jb,Vb,ac)=>{if(!this.ZN(qb))return 8;Na=Be.ImageReader.Ym(qb);Na=Be.ImageReader.uX(Na);ac.setValue(vd.a.Cib,Na);return 32};this.Cib=(Na,qb,Jb,Vb,ac)=>{if(!this.ZN(qb))return 8;if(1===Jb)return this.lf.Y3?2:32;if(Wa.App.rd.Yo&&(Na=qb.node.ia(ke.a.uJ,Wh.a.yt),Na!==Wh.a.yt&&(Na=Wa.App.rd.kq.Dhb(Na),qK.CoauthLockEditor.getInstance().D6a(Na))))return Rs.Ic.Yb(Pe.a.en,{["Reason"]:He.a.VE}),2;Na=Be.ImageReader.Ym(qb);ac=ac.ia(vd.a.Cib,null);this.Oj.fho(Na,qb,ac);v.ULS.sendTraceTag(21297027,
322,50,"Change image alt text.");this.Ld.Js(13);return 32};this.h5a=(Na,qb,Jb,Vb,ac)=>{if(!this.ZN(qb))return 8;Na=Be.ImageReader.Ym(qb);Na=Be.ImageReader.XOa(Na);ac.setValue(vd.a.NX,Na);return 32};this.NX=(Na,qb,Jb,Vb,ac)=>{if(!this.ZN(qb))return 8;if(1===Jb)return this.lf.Y3?2:32;if(Wa.App.rd.Yo&&(Na=qb.node.ia(ke.a.uJ,Wh.a.yt),Na!==Wh.a.yt&&(Na=Wa.App.rd.kq.Dhb(Na),qK.CoauthLockEditor.getInstance().D6a(Na))))return Rs.Ic.Yb(Pe.a.en,{["Reason"]:He.a.VE}),2;Na=Be.ImageReader.Ym(qb);ac=ac.ia(vd.a.NX,
null);this.Oj.eho(Na,qb,ac);v.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.Ld.Js(13);return 32};this.c6a=(Na,qb,Jb)=>{var Vb,ac;if(1===Jb)return 32;if(!qb.view.qe)return v.ULS.sendTraceTag(512267791,322,15,"No interactive view. Action: {0}",Na),8;qb=qb.view;Jb=null===(ac=null===(Vb=qb.mb)||void 0===Vb?void 0:Vb.hb)||void 0===ac?void 0:ac.J(0);if(!Jb)return v.ULS.sendTraceTag(512267790,322,15,"No selection view. Action: {0}",Na),8;ac=Jb.Qa;Vb=this.HR.Zf("UserAction",
Na.toString());let yc;Na==Pb.a.y9f?yc=this.HRc.c6a(ac,2):Na==Pb.a.B9f?(yc=this.HRc.c6a(ac,0),5==yc&&(yc=this.HRc.c6a(ac,2))):Na==Pb.a.C9f&&(yc=this.HRc.c6a(ac,1),5==yc&&(yc=this.HRc.c6a(ac,3)));switch(yc){case 4:ac=32;qb.W4();break;case 5:ac=2;break;default:ac=8}Vb.stop();v.ULS.sendTraceTag(512267789,322,50,"Select image: {0}. Duration: {1}. Action: {2}",yc,Vb.si,Na);return ac};this.Oj=b;this.Sm=k;this.Ld=t;this.Ug=D;this.ib=P;this.$h=Ag.a.getInstance(Ul.a)}get lf(){return Yg.PageReader.instance}get eba(){return this.Sm.instance}get pc(){return this.ga}oym(){this.c4d=
Re.a.Tl(1,0);this.b4d=Re.a.Tl(1,1);this.F3d=Re.a.Tl(1920,0);this.E3d=Re.a.Tl(1280,1)}Tb(b){this.ga=b;const k=this.ZAn,t=this.LAm,D=this.rGb,P=this.Rjm;b.fb(Pb.a.WQ,lc.a.view,t,1284);b.qa(Pb.a.rGb,lc.a.Tc,D);b.qa(Pb.a.y9f,lc.a.view,this.c6a);b.qa(Pb.a.B9f,lc.a.view,this.c6a);b.qa(Pb.a.C9f,lc.a.view,this.c6a);b.qa(Pb.a.rGb,lc.a.image,D);b.Vc(Pb.a.rGb,1284);b.fb(Pb.a.YCd,lc.a.view,t,1284);b.fb(Pb.a.e6e,lc.a.view,k,1028);this.nr(b,Pb.a.gUd,P);this.nr(b,Pb.a.Leg,P);this.nr(b,Pb.a.ngc,this.ngc);this.nr(b,
Pb.a.ULb,this.ULb);this.nr(b,Pb.a.VLb,this.VLb);this.nr(b,Pb.a.i5a,this.i5a);this.nr(b,Pb.a.h5a,this.h5a);this.nr(b,Pb.a.J9b,this.J9b);this.nr(b,Pb.a.lge,this.OEa);this.nr(b,Pb.a.mge,this.PEa);this.nr(b,Pb.a.K6c,this.Cib);this.nr(b,Pb.a.SNb,this.NX);this.nr(b,Pb.a.XLb,this.XLb);this.nr(b,Pb.a.OX,this.OX);this.nr(b,Pb.a.Sff,this.Sff);b.fb(Pb.a.KTh,lc.a.view,this.tql,4);b.Vc(Pb.a.gUd,4);b.Vc(Pb.a.Leg,4);b.Vc(Pb.a.ngc,69);b.Vc(Pb.a.ULb,69);b.Vc(Pb.a.VLb,69);b.Vc(Pb.a.XLb,69);b.Vc(Pb.a.i5a,69);b.Vc(Pb.a.h5a,
69);b.Vc(Pb.a.OX,4);b.Vc(Pb.a.J9b,4);b.Vc(Pb.a.lge,4);b.Vc(Pb.a.mge,4);b.Vc(Pb.a.K6c,4);b.Vc(Pb.a.SNb,4);this.oym();this.gWc&&af.a.instance.Lw(this.MQk)}nr(b,k,t){b.qa(k,lc.a.image,t);b.qa(k,lc.a.YCb,t);b.qa(k,lc.a.Hd,t);b.qa(k,lc.a.anchoredObject,t)}tbl(b){new ml(b,wb.a.instance,w.AFrameworkApplication.K,null,this.Ug,this.ga)}f_o(b){return this.lf.Y3?(Rs.Ic.Yb(Pe.a.en,{["Reason"]:He.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(Rs.Ic.Yb(Pe.a.en,{["Reason"]:He.a.pyl}),!1):Rs.Vf.i_(b)?(Rs.Ic.Yb(Pe.a.en,
{["Reason"]:He.a.VE}),!1):this.eba&&this.eba.qU(b)?(Rs.Ic.Yb(Pe.a.en,{["Reason"]:He.a.externalSelection}),!1):!0}lKm(b){const k=Be.ImageReader.Ym(b);return k&&5===Be.ImageReader.mk(k)&&this.Ovi(b,k)}Ovi(b,k){(k=!Be.ImageReader.B7b(k)&&!Be.ImageReader.WYd(k))||Rs.Ic.Yb(Pe.a.en,{["Reason"]:He.a.GHh});return k&&this.f_o(b)}Yzm(b,k){var t,D;k=new sK(k,wb.a.instance,w.AFrameworkApplication.K,b,this.Ug,this.ga,this.ib,this.Uko);if(k.XZo(b))(null===(D=w.AFrameworkApplication.K)||void 0===D?0:D.$("ShouldLogPicturesExtendedHealthKpis"))&&
this.$h.logKpiUsage({kpiName:Ul.c.QEa,kpiType:0});else return(null===(t=w.AFrameworkApplication.K)||void 0===t?0:t.$("ShouldLogPicturesExtendedHealthKpis"))?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new Db.a,{extendedProperties:b}),this.$h.logKpiFailure({kpiName:Ul.c.QEa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:{name:Ul.c.H9b,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,
additionalValues:null}})):xa.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),v.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new mj.a(document.body,Object(A.a)(k,k.Tec,"onUploadFrameInitialized"),Object(A.a)(k,k.gza,"uploadResponseReceived"),w.AFrameworkApplication.K,!1,void 0,$n.a(w.AFrameworkApplication.K));return!0}ZN(b){return this.lKm(b)}pCa(b){const k=Be.ImageReader.Ym(b);if(!k)return!1;const t=Fa.a.instance.Na("Box4.IFeatureHelper"),
D=Be.ImageReader.mk(k);return 5===D||10===D||48===D||11===D||t&&t.isFeatureEnabled(49)&&4===D?this.Ovi(b,k):!1}get gWc(){var b;return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdatedTabUpdateEnabled",!1)}MQk(){Rs.aZf(!0)}setSize(b,k,t,D,P=!1){Wa.App.rd.Yo&&Wa.App.rd.kq.rH(k.node);const ca=Be.ImageReader.T2a(b);let ta=1;t>this.F3d?ta=this.F3d/t:t<this.c4d&&(ta=this.c4d/t);let Na=1;D>this.E3d?Na=this.E3d/D:D<this.b4d&&(Na=this.b4d/
D);if(ca||P)ta=Math.min(ta,Na),Na=Math.min(ta,Na);1!==ta&&(t*=ta);1!==Na&&(D*=Na);this.rff(b,k,t,D)}rff(b,k,t,D){this.Oj.flo(b,k,t,D)}d4m(){v.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}ZIa(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(k=>{k.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}vpj(b){const k=
Be.ImageReader.rEa(b);b=Be.ImageReader.qEa(b);return 0>=k||0>=b}static get Wg(){return li.ContextSetEditor.instance}static get Vf(){return Yj.a.instance}static get Ic(){return Hi.a.instance}}Rs.aZf=null;Object(n.a)(Rs,"ImageActor",null,[]);var lH=c(1152),mH=c(1153),WM=c(1088);class tG{constructor(b,k,t,D,P){this.imagePropertySet=b;this.graphNode=k;this.mgf=t;this.xjm=D;this.xMc=P;if(this.t2a=Wa.App.instance&&Wa.App.instance.t2a())this.jBe=new WM.a(this.Lr(),tG.onc)}rotate(b){this.Cha("rotate");if(null===
this.imagePropertySet||void 0===this.mgf||void 0===this.xMc)return this.kY("rotate","Argument(s) invalid"),!1;const k=this.getGraphicData("rotate");if(void 0===k)return!1;b-=this.imagePropertySet.PEb();if(0!==b){const t=this.xMc.Nhm();t.rotation=b;try{if(!this.Zth(t,k))return this.kY("rotate","Failed to apply and update"),!1}catch(D){return this.kY("rotate",D.stack?D.stack:D.message?D.message:D.toString()),!1}}return!0}resize(b,k){this.Cha("resize");if(null===this.imagePropertySet||void 0===this.mgf||
void 0===this.xMc)return this.kY("resize","Argument(s) invalid"),!1;const t=this.getGraphicData("resize");if(void 0===t)return!1;let D=0;var P=0;({width:D,height:P}=Be.ImageReader.yhb(this.imagePropertySet));b/=D;k/=P;P=this.xMc.Ohm();P.scale=this.xMc.dbm();P.scale.width=b;P.scale.height=k;try{if(!this.Zth(P,t))return this.kY("resize","Failed to apply and update"),!1}catch(ca){return this.kY("resize",ca.stack?ca.stack:ca.message?ca.message:ca.toString()),!1}return!0}static get onc(){return Fa.a.instance.Na("Box4.ICssColorProvider")}getGraphicData(b){try{if(this.t2a){const k=
this.jBe.Lhi();return this.imagePropertySet.getGraphicData(k)}return this.imagePropertySet.getGraphicData()}catch(k){this.kY(b,k.stack?k.stack:k.message?k.message:k.toString())}}Zth(b,k){this.mgf.apply(b,k);b=this.imagePropertySet.yDb(k);if(void 0===b)return!1;this.cRo(b);return!0}cRo(b){const k=new Xd.GraphTransaction(15);k.Cb(this.graphNode);this.imagePropertySet.setValue(qe.a.eU,b.eU);this.xjm.Y8n(b.LXh,b.Rwa,this.imagePropertySet);k.dispose()}Lr(){return Wk.PageNavigator.instance.Ts(this.graphNode)}Cha(b){const k=
this.vrg;k.edit=b;v.ULS.sendTraceTag(509657553,322,50,"{0}",k)}kY(b,k){const t=this.vrg;t.message=k;t.edit=b;v.ULS.sendTraceTag(509666444,322,15,"{0}",t)}get vrg(){return{["id"]:Be.ImageReader.YOa(this.imagePropertySet),["type"]:Be.ImageReader.mk(this.imagePropertySet)}}}Object(n.a)(tG,"EditWithGC2Command",null,[]);class nH{Y8n(b,k,t){this.oZm(b,k);this.a9n(t)}oZm(b,k){this.BH=Array(4);this.BH[0]=Math.round(b.Agf);this.BH[2]=Math.round(b.Cgf);this.BH[1]=Math.round(b.Bgf);this.BH[3]=Math.round(b.zgf);
this.mOa=Math.round(b.mOa);this.nOa=Math.round(b.nOa);(this.Rwa=k)&&this.p5k()}a9n(b){b.setValue(qe.a.Sva,this.mOa.toString());b.setValue(qe.a.Tva,this.nOa.toString());const k=Array(4);this.BH.forEach((t,D)=>{k[D]=t.toString()});b.setValue(qe.a.lPa,k);b.setValue(qe.a.E2a,this.Rwa)}p5k(){this.jDo();const b=this.mOa/2,k=this.nOa/2;this.mOa%2&&0===this.nOa%2?(--this.BH[0],++this.BH[2]):this.nOa%2&&0===this.mOa%2&&(++this.BH[0],--this.BH[2]);this.BH[0]+=b-k;this.BH[1]-=b-k;this.BH[2]+=k-b;this.BH[3]-=
k-b}jDo(){const b=this.mOa;this.mOa=this.nOa;this.nOa=b}}Object(n.a)(nH,"GraphicsExtents",null,[]);var uG=c(688),tK=c(515),XM=c(514),YM=c(1453);class Sq extends Rs{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb){super(b,k,D,ca,ta,Na,qb);this.m5g=!1;this.LAa=this.X$=null;this.uw=(Vb,ac,yc,Kc,ed)=>{if(!this.ZN(ac))return 8;if(1===yc)return this.lf.Y3?2:32;Vb=parseInt(ed);v.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+Vb);this.utd.ZKn(ac,Be.ImageReader.Ym(ac),Vb);this.JXc(ac);this.ZIa();return 32};this.Ode=
(Vb,ac,yc)=>{if(!this.ZN(ac))return 8;v.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");Vb=Be.ImageReader.Ym(ac);if(1===yc)return this.lf.Y3?2:32;yc=Be.ImageReader.zhb(Vb);1===yc?(yc=new Xd.GraphTransaction(15),yc.Cb(ac.node),Be.ImageReader.J$b()?Vb.setValue(Cc.a.cLb,""):this.gK.LXn(Vb),yc.dispose(),this.Bzc.create(Vb,ac).uw(Lf.a.Mcj),this.JXc(ac)):2===yc&&this.Bzc.create(Vb,ac).uw(Lf.a.Mcj);return 32};this.zlm=(Vb,ac,yc,Kc,ed)=>{if(!this.ZN(ac))return 8;Vb=Be.ImageReader.Ym(ac);if(1===
yc)return this.lf.Y3||Be.ImageReader.uac(Vb)?2:32;ed&&(this.gK.m$c(Vb,ac),v.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),Wa.App.ya.updateCommandUI());this.ZIa();return 32};this.Alm=(Vb,ac,yc,Kc,ed)=>{if(!this.ZN(ac))return 8;if(1===yc)return this.lf.Y3?2:32;Vb=Be.ImageReader.Ym(ac);if(ed){yc=Be.ImageReader.CXd(Be.ImageReader.Ym(ac));v.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+yc);Kc=ed.ia(vd.a.Hib,0);const sd=ed.ia(vd.a.Eib,0),oe=ed.ia(vd.a.Fib,0);ed=
ed.ia(vd.a.Gib,0);const Ld=Be.ImageReader.pba(Vb),Od=Ld.bottom,ie=Ld.left,Ce=Ld.right;if(Kc===Ld.top&&sd===Od&&oe===ie&&ed===Ce)return v.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;yc?(new lH.a(Vb,new mH.a)).Yeo(Kc,sd,oe,ed,this.cln,ac):this.utd.PKn(ac,Be.ImageReader.Ym(ac),Kc,sd,oe,ed);this.JXc(ac);Wa.App.ya.updateCommandUI()}return 32};this.oUd=(Vb,ac,yc,Kc,ed)=>{if(!this.ZN(ac))return 8;Kc=Be.ImageReader.Ym(ac);if(1===yc)return this.lf.Y3||
Be.ImageReader.uac(Kc)?2:32;if(ed){v.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");this.gK.ywa()||this.gK.m$c(Kc,ac);switch(Vb){case Nc.a.ERc:Vb=ed.ia(vd.a.Hib,-1);yc=0;break;case Nc.a.xRc:Vb=ed.ia(vd.a.Eib,-1);yc=1;break;case Nc.a.yRc:Vb=ed.ia(vd.a.Fib,-1);yc=2;break;case Nc.a.zRc:Vb=ed.ia(vd.a.Gib,-1);yc=3;break;default:return 8}this.gK.KTo(Vb,yc);this.JXc(ac);Wa.App.ya.updateCommandUI()}return 32};this.enb=(Vb,ac,yc,Kc,ed)=>{if(!this.ZN(ac))return 8;
Be.ImageReader.Ym(ac);ed&&(Vb=this.gK.ywa(),ed.setValue(vd.a.ywa,Vb));return 32};this.mgc=(Vb,ac,yc,Kc,ed)=>{if(!this.ZN(ac))return 8;Vb=Be.ImageReader.Ym(ac);if(ed){if(this.gK.ywa())({top:sd,bottom:yc,left:Vb,right:ac}=this.gK.rRl());else{Kc=Re.a.xf(Be.ImageReader.fF(Vb),0);var sd=Re.a.xf(Be.ImageReader.wG(Vb),1);ac=Be.ImageReader.pba(Vb);const oe=Math.max(ac.top,0);yc=Math.max(ac.bottom,0);Vb=Math.max(ac.left,0);ac=Math.max(ac.right,0);Kc=1E5*Kc/(1E5-(Vb+ac));const Ld=1E5*sd/(1E5-(oe+yc));sd=Math.floor(oe*
Ld/1E5);yc=Math.floor(yc*Ld/1E5);Vb=Math.floor(Vb*Kc/1E5);ac=Math.floor(ac*Kc/1E5)}ed.setValue(vd.a.Hib,sd);ed.setValue(vd.a.Eib,yc);ed.setValue(vd.a.Fib,Vb);ed.setValue(vd.a.Gib,ac)}return 32};this.V8b=(Vb,ac,yc,Kc,ed)=>{if(!this.ZN(ac))return 8;if(1===yc){if(this.lf.Y3)return 2;this.A6m();return 32}Vb=Be.ImageReader.Ym(ac);this.gK.ywa()&&this.gK.m$c(Vb,ac);Vb=ed.ia(vd.a.MHa,"");ed=ed.ia(vd.a.q8a,0);v.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:ed,["SourceControlId"]:Vb});
switch(ed){case 1:this.gK.Ylo(ac);break;case 8:this.gK.ghe(ac,1,1);break;case 9:this.gK.ghe(ac,1,3);break;case 3:this.gK.ghe(ac,2,void 0,!0);break;case 4:this.gK.ghe(ac,2,void 0,!1)}this.ZIa();Wa.App.ya.updateCommandUI();return 32};this.Bgc=(Vb,ac,yc,Kc,ed)=>{if(!this.ZN(ac))return 8;Vb=Be.ImageReader.Ym(ac);ac=Be.ImageReader.d4(ac);yc=Be.ImageReader.u8(Vb);Kc=Be.ImageReader.yPc(Vb);Vb=Be.ImageReader.Cx(Vb);return this.NKn(ac,yc,Kc,Vb,ed)?32:8};this.Clm=(Vb,ac,yc,Kc,ed)=>{var sd;if(!this.pCa(ac))return 8;
Kc=Be.ImageReader.Ym(ac);if(1===yc)return $b.SessionStatusManager.instance.wj?8:this.lf.Y3||Be.ImageReader.vac(Kc)?2:32;this.gK.ywa()&&this.gK.m$c(Kc,ac);if(this.Lwi(Kc)&&(yc=null===(sd=y())||void 0===sd?void 0:sd.A3b(),sd=new tG(Kc,ac.node,yc,new nH,z()),yc=ed.ia(vd.a.jJ,0),sd.rotate(yc)))return 32;if(ed){yc=ed.ia(vd.a.LRc,0);const oe=Be.ImageReader.CXd(Kc);v.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",yc,oe);sd=Be.ImageReader.z_(Kc);let Ld=Be.ImageReader.DPd(Kc),
Od=Be.ImageReader.ZDb(Kc);switch(yc){case 0:sd=ed.ia(vd.a.jJ,0);break;case 2:sd-=90;sd=fj.c(sd);break;case 1:sd+=90;sd=fj.c(sd);break;case 4:Ld=!Ld;break;case 3:Od=!Od;break;case 5:sd+=ed.ia(vd.a.jJ,0),sd=fj.c(sd)}oe?(new lH.a(Kc,new mH.a)).tko(sd,Ld,Od,this.orn,ac):yc?this.Bzc.create(Kc,ac).Cjo(sd,Ld,Od):(ed=lb.a.create(),yc=new Xd.GraphTransaction(15,Pb.a.imageRotate),yc.Cb(ac.node),this.gK.oho(Kc,sd),this.utd.VKn(ac,Be.ImageReader.Ym(ac),sd,ed),yc.VFa(ed,1),yc.fk=Vb,yc.dispose());this.ZIa();this.JXc(ac);
Wa.App.ya.updateCommandUI()}return 32};this.WLb=(Vb,ac,yc,Kc,ed)=>{if(!this.ZN(ac))return 8;Vb=Be.ImageReader.Ym(ac);Vb=Be.ImageReader.z_(Vb);if(0>Vb)return 2;ed.setValue(vd.a.jJ,Vb);return 32};this.orn=(Vb,ac,yc,Kc)=>{if(Vb){const ed=new Xd.GraphTransaction(15,Pb.a.imageRotate);ed.Cb(Kc.node);ac.setValue(vd.a.fAb,JSON.stringify(yc));ac.setValue(vd.a.Wt,Vb);this.gK.pge(ac,yc.rotationAngle,yc.t9b,yc.Nmc);this.oDb(ac);ed.dispose()}};this.$qn=(Vb,ac,yc,Kc)=>{if(Vb){const ed=new Xd.GraphTransaction(15);
ed.Cb(Kc.node);ac.setValue(vd.a.fAb,JSON.stringify(yc));ac.setValue(vd.a.Wt,Vb);this.gK.Xfe(ac,yc.Lme,yc.pad);this.oDb(ac);ed.dispose()}};this.cln=(Vb,ac,yc,Kc)=>{if(Vb){const ed=new Xd.GraphTransaction(15);ed.Cb(Kc.node);ac.setValue(vd.a.fAb,JSON.stringify(yc));ac.setValue(vd.a.Wt,Vb);this.gK.iho(ac,Math.round(yc.Dua*uG.a.jfb),Math.round(yc.Aua*uG.a.jfb),Math.round(yc.Bua*uG.a.jfb),Math.round(yc.Cua*uG.a.jfb));this.oDb(ac);ed.dispose()}};this.t1c=(Vb,ac,yc,Kc,ed)=>{if(!this.pCa(ac))return 8;if(1===
yc)return 32;Vb=ac.contextId===lc.a.view?Yg.PageReader.instance.NQd(ac):Wk.PageNavigator.instance.Ts(ac.node);if(!Vb)return 8;yc=Be.ImageReader.Ym(ac);ac=this.Go.jdi(Ym.a.YT(ac),yc);Sq.y0i.DNb=ac;this.nVc&&this.recentColors.Omg(ac);ac=Sq.y0i.yMc(Vb,Wa.App.xAb);if(!ac)return 8;ed.MenuItems=ac;return 32};this.I9=(Vb,ac,yc,Kc,ed)=>{if(!this.pCa(ac))return 8;if((Kc=Be.ImageReader.Ym(ac))&&Be.ImageReader.py(Kc))return 2;if(1===yc)return 32;if(2!==yc)return 2;if(!ed)return v.ULS.sendTraceTag(571287758,
322,10,"SetPictureBorderColor: actionData null"),8;yc=new Xd.GraphTransaction(15);yc.Cb(ac.node);const sd=Sq.Dpb.RCa(ac.node,ed);this.Go.I9(Kc,ed,ac,sd);this.oDb(Kc);yc.dispose();Vb==Pb.a.U6c&&this.recentColors.odb(ed);this.cdd();this.ZIa();return 32};this.Xha=(Vb,ac,yc)=>{if(!this.pCa(ac))return 8;if(1===yc)return 32;Wa.App.ya.Tw();Sq.t9a=new nA.a("PictureBorder",Pb.a.U6c);Sq.t9a.vjc(0);return 32};this.Pia=(Vb,ac,yc,Kc,ed)=>{if(!this.pCa(ac))return 8;if(1===yc)return 32;if((Vb=Be.ImageReader.Ym(ac))&&
Be.ImageReader.py(Vb))return 2;if(!ed)return v.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;yc=new Xd.GraphTransaction(15);yc.Cb(ac.node);this.Go.Pia(Vb,ed,ac);this.oDb(Vb);yc.dispose();this.cdd();this.ZIa();return 32};this.w6a=(Vb,ac,yc,Kc,ed)=>{if(!this.pCa(ac))return 8;if(1===yc)return 32;if((Vb=Be.ImageReader.Ym(ac))&&Be.ImageReader.py(Vb))return 2;if(!ed)return v.ULS.sendTraceTag(571287760,322,10,"SetPictureBorderStyle: actionData null"),8;yc=new Xd.GraphTransaction(15);
yc.Cb(ac.node);this.Go.w6a(Vb,ed,ac);this.oDb(Vb);yc.dispose();this.cdd();this.ZIa();return 32};this.Wce=(Vb,ac,yc)=>{if(!this.pCa(ac))return 8;if(1===yc)return 32;Vb=Be.ImageReader.Ym(ac);yc=new Xd.GraphTransaction(15);yc.Cb(ac.node);Be.ImageReader.f9b(Vb)&&(this.Go.Wce(Vb),this.oDb(Vb));yc.dispose();this.cdd();this.ZIa();return 32};this.gK=b;this.Bzc=t;this.utd=P;Sq.Jh=Jb;Rs.aZf=Sq.$An}get recentColors(){return null!=this.BFg?this.BFg:this.BFg=Fa.a.instance.Na("Box4.UI.RecentColorsSectionHandler")}get Go(){this.X$||
(this.X$=new tK.a);return this.X$}Tb(b){super.Tb(b);this.nr(b,Pb.a.uw,this.uw);b.Vc(Pb.a.uw,4);this.nr(b,Pb.a.Ode,this.Ode);this.nr(b,Nc.a.gpe,this.V8b);b.Vc(Nc.a.gpe,4);this.nr(b,Nc.a.hpe,this.V8b);this.nr(b,Nc.a.ipe,this.V8b);this.nr(b,Nc.a.jpe,this.V8b);this.nr(b,Nc.a.kpe,this.V8b);this.nr(b,Nc.a.lpe,this.V8b);this.nr(b,Nc.a.Bgc,this.Bgc);b.Vc(Nc.a.Bgc,101);this.nr(b,Nc.a.imageCrop,this.zlm);b.Vc(Nc.a.imageCrop,4);this.nr(b,Nc.a.enb,this.enb);b.Vc(Nc.a.enb,101);this.nr(b,Nc.a.zoi,this.Alm);this.nr(b,
Nc.a.ERc,this.oUd);this.nr(b,Nc.a.xRc,this.oUd);this.nr(b,Nc.a.yRc,this.oUd);this.nr(b,Nc.a.zRc,this.oUd);this.nr(b,Nc.a.p2c,this.mgc);b.Vc(Nc.a.p2c,101);this.nr(b,Nc.a.Hae,this.mgc);b.Vc(Nc.a.Hae,101);this.nr(b,Nc.a.Iae,this.mgc);b.Vc(Nc.a.Iae,101);this.nr(b,Nc.a.Jae,this.mgc);b.Vc(Nc.a.Jae,101);this.nr(b,Pb.a.imageRotate,this.Clm);b.Vc(Pb.a.imageRotate,4);this.nr(b,Pb.a.WLb,this.WLb);b.Vc(Pb.a.WLb,101);this.nr(b,Pb.a.t1c,this.t1c);b.Vc(Pb.a.t1c,4);this.nr(b,Pb.a.I9,this.I9);b.Vc(Pb.a.I9,4);this.nr(b,
Pb.a.U6c,this.I9);b.Vc(Pb.a.U6c,4);this.nr(b,Pb.a.KWf,this.Xha);b.Vc(Pb.a.KWf,4);this.nr(b,Pb.a.Vxa,this.Vxa.bind(this));b.Vc(Pb.a.Vxa,4);this.nr(b,Pb.a.Pia,this.Pia);b.Vc(Pb.a.Pia,4);this.nr(b,Pb.a.YLb,this.YLb.bind(this));b.Vc(Pb.a.YLb,4);this.nr(b,Pb.a.w6a,this.w6a);b.Vc(Pb.a.w6a,4);this.nr(b,Pb.a.UQf,this.Wce);b.Vc(Pb.a.UQf,4)}rff(b,k,t,D){var P;v.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+Be.ImageReader.CXd(b));this.gK.ywa()&&this.gK.m$c(b,k);if(this.Lwi(b)){const ca=
null===(P=y())||void 0===P?void 0:P.A3b();if((new tG(b,k.node,ca,new nH,z())).resize(t,D))return}Be.ImageReader.py(b)?(b=lb.a.create(),P=new Xd.GraphTransaction(15),P.Cb(k.node),this.utd.UKn(k,Be.ImageReader.Ym(k),t,D,b),P.VFa(b,1),P.dispose()):Be.ImageReader.sjc(b)?(new lH.a(b,new mH.a)).dko(t,D,this.$qn,k):(super.rff(b,k,t,D),this.Ld.Js(13))}ZN(b){if(!b.al)return!1;var k=b.node;return(k=Wa.App.instance&&Wa.App.instance.bHb?k instanceof qi.a||k instanceof YM.a?k:null:Object(Ka.a)(qi.a,k))&&Ms.n(k)?
(Rs.Ic.Yb(UM.a.en,{["Reason"]:VM.a.dO}),!1):super.ZN(b)}static $An(b){b&&!Sq.Kvb&&(Sq.Jh.UYa(Sq.Nlb),Sq.Kvb=!0)}NKn(b,k,t,D,P){return P?(P.gxi=b,P.u8=k,P.LPb=t,P.lw=D,P.q8a=Sq.Uhm(P),!0):!1}Lwi(b){b=Be.ImageReader.mk(b);const k=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditsWithGC2",!1);return Wa.App.instance&&Wa.App.instance.c4(b)?(w.AFrameworkApplication.ue("editswithgc2;editswithgc2cf"),k):!1}JXc(b){Wa.App.rd.Yo&&Wa.App.rd.kq.rH(b.node)}A6m(){this.m5g||(v.ULS.sendTraceTag(20459971,
322,50,"Wrap Text UI enabled."),this.m5g=!0)}oDb(b){const k=XM.a.instance.iif(b);this.gK.nge(b,k[0],k[1],k[2],k[3])}Vxa(b,k,t,D,P){2===t&&(b=Be.ImageReader.Ym(k),this.Go.HRj(P,b));return 32}YLb(b,k,t,D,P){2===t&&(b=Be.ImageReader.Ym(k),this.Go.GRj(P,b));return 32}cdd(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("PictureBorderFloodgateSurveyIsEnabled")&&window.setTimeout(()=>{const b=Fa.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(k=>{k.logActivity("PictureBorderApplied",
"PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get Dpb(){return null!=Sq.zHg?Sq.zHg:Sq.zHg=Xk.a.instance}static get y0i(){Sq.yV||(Sq.yV=new oA.a("PictureBorder"),Sq.VEa(Sq.yV));return Sq.yV}static Uhm(b){if(b.gxi)b=1;else switch(b.LPb){case 2:b=b.u8?3:4;break;case 1:b=1===b.lw?8:3===b.lw?9:2;break;case 0:b=5;break;case 3:b=6;break;case 4:b=7;break;default:b=0}return b}static VEa(b){b.GW(3,Pb.a.I9);b.GW(4,Pb.a.I9);b.GW(5,Pb.a.U6c);b.GW(6,Pb.a.I9);b.Vyb(cv.a.instance,1)}get nVc(){null==this.LAa&&
(w.AFrameworkApplication.ue("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.LAa=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.LAa}}Sq.Kvb=!1;Sq.yV=null;Sq.t9a=null;Sq.Nlb=()=>{Sq.Jh.Zgc(Sq.Nlb);Sq.Kvb=!1;if(Qg.c()){var b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}else v.ULS.sendTraceTag(509445760,
322,50,"appChrome is undefined")};Object(n.a)(Sq,"ImageActor",Rs,[]);class $m{static get paragraphEditor(){return null!=$m.VEg?$m.VEg:$m.VEg=Fa.a.instance.resolve("Box4.IParagraphEditor")}static get HA(){return null!=$m.fFg?$m.fFg:$m.fFg=Fa.a.instance.resolve("Box4.IParagraphIndentationReader")}static get B0(){return $m.paragraphEditor.fq}static get Ug(){return null!=$m.BIg?$m.BIg:$m.BIg=Fa.a.instance.resolve("Box4.IUndoManager")}static Tb(){const b=w.AFrameworkApplication.va;b.qa(Pb.a.ILb,lc.a.view,
gn.a.Wv);b.qa(Pb.a.ILb,lc.a.paragraph,$m.Pla);b.Vc(Pb.a.ILb,1036);b.qa(Pb.a.OBb,lc.a.view,gn.a.Wv);b.qa(Pb.a.OBb,lc.a.paragraph,$m.Pla);b.Vc(Pb.a.OBb,1036);b.qa(Pb.a.zfb,lc.a.view,gn.a.Wv);b.qa(Pb.a.zfb,lc.a.paragraph,$m.Pla);b.Vc(Pb.a.zfb,1036);b.qa(Pb.a.Ugc,lc.a.view,gn.a.Wv);b.qa(Pb.a.Ugc,lc.a.paragraph,$m.Pla);b.Vc(Pb.a.Ugc,1036);b.qa(Pb.a.S3c,lc.a.view,gn.a.Wv);b.qa(Pb.a.S3c,lc.a.paragraph,$m.Pla);b.Vc(Pb.a.S3c,1036);b.qa(Pb.a.d2a,lc.a.view,gn.a.Wv);b.qa(Pb.a.d2a,lc.a.paragraph,$m.Pla);b.Vc(Pb.a.d2a,
1036);b.qa(Pb.a.Lib,lc.a.view,gn.a.Wv);b.qa(Pb.a.Lib,lc.a.paragraph,$m.Pla);b.Vc(Pb.a.Lib,1036);b.qa(Pb.a.c2a,lc.a.view,gn.a.Wv);b.qa(Pb.a.c2a,lc.a.paragraph,$m.Pla);b.Vc(Pb.a.c2a,1036);b.qa(Pb.a.rge,lc.a.view,$m.kje);b.qa(Pb.a.rge,lc.a.paragraph,$m.kje);b.Vc(Pb.a.rge,1028);b.qa(Pb.a.Hag,lc.a.view,$m.kje);b.qa(Pb.a.Hag,lc.a.paragraph,$m.kje);b.Vc(Pb.a.Hag,1028);b.qa(Pb.a.fOb,lc.a.view,gn.a.Wv);b.qa(Pb.a.fOb,lc.a.paragraph,$m.Pla);b.Vc(Pb.a.fOb,1036);b.qa(Pb.a.qob,lc.a.view,gn.a.Wv);b.qa(Pb.a.qob,
lc.a.paragraph,$m.Pla);b.Vc(Pb.a.qob,1036);b.qa(Pb.a.gOb,lc.a.view,gn.a.Wv);b.qa(Pb.a.gOb,lc.a.paragraph,$m.Pla);b.Vc(Pb.a.gOb,1036);b.qa(Pb.a.qfg,lc.a.view,gn.a.Wv);b.Vc(Pb.a.qfg,1028);b.qa(Pb.a.e7c,lc.a.view,gn.a.Wv);b.qa(Pb.a.e7c,lc.a.paragraph,$m.Pla);b.Vc(Pb.a.e7c,1036);b.qa(Pb.a.f7c,lc.a.view,gn.a.Wv);b.qa(Pb.a.f7c,lc.a.paragraph,$m.Pla);b.Vc(Pb.a.f7c,1036)}static kje(b,k,t,D,P){2===t&&""===P[Dh.a.Text]&&(b=b===Pb.a.rge?Pb.a.d2a:Pb.a.c2a,k=new AD.a,k.value=0,k.unit=Wa.App.sFa?2:1,w.AFrameworkApplication.va.Qb(b,
2,k),Wa.App.ya.updateCommandUI());return 32}static Pla(b,k,t,D,P){if(!({fy:t}=gn.a.Scg(t,k)).returnValue)return t;k=k.node;switch(b){case Pb.a.ILb:$m.B0.L0f(k,!0);break;case Pb.a.OBb:$m.B0.L0f(k,!1);break;case Pb.a.zfb:$m.B0.zfb(k);break;case Pb.a.Ugc:$m.B0.Tca(k,0);break;case Pb.a.S3c:$m.B0.gob(k,0);break;case Pb.a.Lib:case Pb.a.d2a:t=new ze.GraphIterator;t.set(k);t.zb(11);let ca=P.value;P=P.unit;b===Pb.a.Lib&&(ca=(new Iq.a(P,ca)).Ft+$m.HA.vG(k).Ft,P=1);$m.B0.Bya(t,P,ca);break;case Pb.a.c2a:$m.B0.TNb(k,
P.unit,P.value);break;case Pb.a.fOb:P?(b=(new Iq.a(P.unit,P.value)).Ft,$m.B0.Tca(k,b)):$m.HA.iPd(k).Ft||$m.B0.Tca(k,Xh.OutlineReader.rX(k));break;case Pb.a.qob:P?(b=(new Iq.a(P.unit,P.value)).Ft,$m.B0.gob(k,b)):$m.HA.vG(k).Ft||$m.B0.gob(k,Xh.OutlineReader.rX(k));break;case Pb.a.gOb:$m.B0.Tca(k,0);break;case Pb.a.e7c:b=P;b=(new Iq.a(b.unit,b.value)).Ft;$m.B0.xbg(k,1,b);break;case Pb.a.f7c:b=P,b=(new Iq.a(b.unit,b.value)).Ft,$m.B0.xbg(k,2,b)}$m.Ug.kF();D&&Aq.a.zpb&&(D.ks|=Aq.a.jhb(k));return 32}}Object(n.a)($m,
"IndentationActor",null,[]);var uK=c(380),ZM=c(64),vG=c(416),$M=c(1195);class xr{constructor(b){this.fXa=this.TBa=this.Exc=null;this.blh=!1;this.S$d=k=>{if(this.TBa)if(k===$a.a.R$d)ad.FocusManager.instance().getRegion(ef.AFrame.$4a).Hdc();else if(k===$a.a.Q$d)ad.FocusManager.instance().getRegion(ef.AFrame.$4a).Fdc();else return 2;else return 2;return 32};this._frame=b}hAo(){if(this.blh)this.yEi();else{const b=Sa.a.create(w.AFrameworkApplication.K.jb("WopiBootstrapUrl"));b.UZ((k,t)=>{t.succeeded?(this.blh=
!0,this.yEi()):v.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});Gb.a.lX(b)}}yEi(){if(this.Exc)v.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.Xqa;this.TBa=document.createElement("div");b.parentNode.insertBefore(this.TBa,b);this.fXa=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:w.AFrameworkApplication.K.jb("FileName"),reactRoot:this.TBa});this.fXa.setWebpackPublicPath(w.AFrameworkApplication.o5);
this.fXa.renderDocumentPanel()}}FZl(b){const k={};k.Container=b;k.BootstrapperUrl=w.AFrameworkApplication.K.jb("WopiBootstrapUrl");k.ApplicationUrl=this._frame.sqb;b={};b.HostName=w.AFrameworkApplication.K.jb("FileSource");b.HostSessionId=w.AFrameworkApplication.K.jb("HostSessionId");b.UserId=w.AFrameworkApplication.K.jb("UserId");b.DocumentClickTime=new Date(this._frame.hlb);b.SessionContext="";b.WdParams={};k.SessionInformation=b;b={};b.FileName=w.AFrameworkApplication.K.jb("FileName");b.FileGetUrl=
"";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};k.WopiPrecheckInfo=b;k.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.hlb;k.Diagnostics=b;b={};b.WopiSrc=w.AFrameworkApplication.K.jb("WopiSrc");b.AccessToken=w.AFrameworkApplication.K.jb("AccessToken");b.AccessTokenTtl=w.AFrameworkApplication.K.jb("AccessTokenTtl");k.WopiInfo=b;k.FnOnInitializeSuccess=
t=>{xr.BW=t;this.fXa.setMaxPage(xr.BW.GetPageCount());this.fXa.setCurrentPage(xr.BW.GetCurrentPage());this.fXa.setPageControlVisible(!0);xr.BW.RegisterEventHandler("PageChanged",D=>{this.fXa.setCurrentPage(D.newPage)});xr.BW.RegisterEventHandler("BrowserEvent",D=>{27===D.keyCode?this.closeViewer():D.button&&1!==D.button||this.TBa.click()});t=this._frame.hlb-(new Date).getTime();v.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",t);this.Tb();ad.FocusManager.instance().kL(ef.AFrame.$4a,
!0);this.buildFocusRegion();this.UGa(ad.FocusManager.instance().ge(ef.AFrame.$4a));this.TBa.click()};k.FnOnInitializeFailure=(t,D)=>{v.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",t.toString(),D.toString());this.closeViewer()};return k}buildFocusRegion(){const b=ad.FocusManager.instance();var k=b.getRegion(ef.AFrame.$4a);k=[2,3];const t=b.ge(ef.AFrame.$4a),D=new Se.DOMFocusListing(()=>this.TBa);D.Mpa=!0;for(const P of k)D.Wm(P);k=b.Yla(()=>this.TBa,t,D);k.mSa();k.jR=!0;k.UZa=!0;D.Gy(D.kga)}Tb(){w.AFrameworkApplication.va.qa($a.a.R$d,
Ud.a.frame,this.S$d);w.AFrameworkApplication.va.qa($a.a.Q$d,Ud.a.frame,this.S$d)}UGa(b){b.ir(ad.FocusManager.instance().nW);b.ir(ad.FocusManager.instance().oW);b.bindAction(ad.FocusManager.instance().nW,$a.a.R$d);b.bindAction(ad.FocusManager.instance().oW,$a.a.Q$d)}loadViewer(b){b=this.FZl(b);this.Exc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);this.Exc.Complete(b.WopiInfo)}closeViewer(){ad.FocusManager.instance().yR(ef.AFrame.$4a);xr.BW&&(xr.BW.Dispose(),xr.BW=null,w.AFrameworkApplication.va.Lv($a.a.R$d,
Ud.a.frame,this.S$d),w.AFrameworkApplication.va.Lv($a.a.Q$d,Ud.a.frame,this.S$d));this.Exc&&(this.TBa.parentNode.removeChild(this.TBa),this.TBa=this.Exc=null)}printAction(){v.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");w.AFrameworkApplication.va.processAction(Pb.a.print,2)}downloadPdfAction(){v.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");w.AFrameworkApplication.va.processAction(Nc.a.SJc,2)}downloadCopyAction(){v.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");
w.AFrameworkApplication.va.processAction($a.a.downloadACopy,2)}zoomInAction(){if(xr.BW){let b=xr.BW.GetZoomLevel();b+=.2;xr.BW.SetZoomLevel(b)}}zoomOutAction(){if(xr.BW){let b=xr.BW.GetZoomLevel();b-=.2;xr.BW.SetZoomLevel(b)}}setPage(b){if(xr.BW){const k=xr.BW.GetPageCount();1>b?(xr.BW.SetCurrentPage(1),this.fXa.setCurrentPage(1)):1<=b&&b<=k?xr.BW.SetCurrentPage(b):(xr.BW.SetCurrentPage(k),this.fXa.setCurrentPage(k))}}static getInstance(b){xr.VNe||(xr.VNe=new xr(b));return xr.VNe}}xr.BW=null;xr.VNe=
null;Object(n.a)(xr,"PreviewPanelActor",null,[]);class zq{static get VIj(){return null!=zq.WIg?zq.WIg:zq.WIg=w.AFrameworkApplication.K.jb("ClassicViewModePreferenceCookieName")}static Tb(b,k){b.fb(Pb.a.readingMode,Ud.a.frame,zq.pKj,128);b.qa(Pb.a.oke,Ud.a.frame,zq.pKj);zq.FN=k;b.qa(Nc.a.GWm,Ud.a.frame,zq.rcc);b.qa(Nc.a.rcc,Ud.a.frame,zq.rcc);b.qa(Nc.a.VWc,Ud.a.frame,zq.VWc);b.fb(Nc.a.JJn,Ud.a.frame,zq.sgc,96);b.fb(Nc.a.sgc,Ud.a.frame,zq.sgc,96);b.fb(Nc.a.Q2c,Ud.a.frame,zq.Q2c,96)}static pKj(b,k,t){if(k.contextId!==
Ud.a.frame)return 2;k=Yl.App.Ln;switch(b){case Pb.a.readingMode:if(!k.sqb)return 8;if(1===t)return $b.SessionStatusManager.instance.wj?8:32;b=(new Date).getTime();Tk.a.instance.jRn(b);k.hlb=b;w.AFrameworkApplication.K.$("InAppDocumentPreviewIsEnabled")?Nv.a.FQ(3,!0,zq.HEn,null,k):Nv.a.FQ(3,!0,zq.gPi,null,k);return 32;case Pb.a.oke:return 32;default:return 2}}static gPi(b){vG.a()?zq.ygm(b):zq.fwj(b)}static ygm(b){const k={};k[I.a.Zxf]=zq.VIj;w.AFrameworkApplication.MO().execute(t=>{t.yv(K.a.$xf);t.iPo(K.a.$xf);
t.NB(K.a.$xf,D=>{zq.STk(D,b)});t.sendMessage(K.a.NXl,k)})}static STk(b,k){b.Values[I.a.Zxf]===zq.VIj&&("true"===b.Values[I.a.Lni]?zq.fwj(k):(zq.ySo(),zq.vDo()))}static ySo(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};w.AFrameworkApplication.ue("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):
appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static vDo(){w.AFrameworkApplication.jv=!0;Wa.App.ya.R9(1);Wa.App.ya.gb.ru&&Wa.App.ya.gb.ru.Vi&&Wa.App.ya.gb.ru.Ozf();w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&Wa.App.ya.updateCommandUI();$M.PageView.iAj(w.AFrameworkApplication.K)}static fwj(b){try{const k=new cb.a;let t,D;w.AFrameworkApplication.oJj?(t=Wa.App.hostUrl,D=3):(t=b.sqb,D=1);b.hlb&&k.add(w.AFrameworkApplication.oNf,
b.hlb.toString());w.AFrameworkApplication.cCf&&k.add(w.AFrameworkApplication.R9e,"1");w.AFrameworkApplication.A5e&&k.add(w.AFrameworkApplication.j3k,"1");k.add(uK.a.Jng,uK.a.userSessionData);k.add(w.AFrameworkApplication.V$d,w.AFrameworkApplication.userSessionId);const P=w.AFrameworkApplication.K.jb(w.AFrameworkApplication.qja);P&&k.add(w.AFrameworkApplication.vCj,P);v.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");vG.b(w.AFrameworkApplication.K)?vG.d("view",k,vG.c):(t=ia.a.hoh(t,k),
w.AFrameworkApplication.oJj?$d.a.nm(t,$d.a.Zqa(D),void 0,"AuthenticationLostDuringSession"):$d.a.openWindow(D,t,!1,void 0,ZM.a.Caj))}catch(k){}}static HEn(b){v.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Fa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Kz.loadScript("previewPanel")).catch(()=>{v.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");zq.gPi(b)}).then(()=>
{xr.getInstance(b).hAo()})}static rcc(b,k,t){if(1===t)return 32;zq.FN.Fjj(1);Wa.App.ya.updateCommandUI();return 32}static VWc(b,k,t){if(1===t)return 32;zq.FN.Fjj(0);Wa.App.ya.updateCommandUI();return 32}static sgc(b,k,t,D,P){if(1===t)return 32;P[kg.a.On]=1===zq.FN.Uu;return 32}static Q2c(b,k,t,D,P){if(1===t)return 32;P[kg.a.On]=!zq.FN.Uu;return 32}}zq.FN=null;Object(n.a)(zq,"MainViewModeActor",null,[]);class vK{constructor(b,k,t){this.C8m=(D,P,ca,ta,Na)=>1===ca?32:(D=this.Qk.j8(P.$j))?(Na=3===Na.Gx,
this.d6.value.uLh(this.a8l(D),this.aFb(D),Na),32):2;this.ga=b;this.d6=k;this.Qk=t}Tb(){this.ga.qa(Nc.a.BIf,lc.a.view,this.C8m);this.ga.fb(Nc.a.Nae,lc.a.view,am.d,96);this.ga.fb(Nc.a.Kae,lc.a.view,am.d,96);this.ga.fb(Nc.a.Lae,lc.a.view,am.d,96);this.ga.fb(Nc.a.Mae,lc.a.view,am.d,96);this.ga.qa(Nc.a.X_c,lc.a.view,am.c);this.ga.qa(Nc.a.W_c,lc.a.view,am.c);this.ga.qa(Nc.a.v8d,lc.a.view,am.c);this.ga.qa(Nc.a.w8d,lc.a.view,am.c)}a8l(b){const k=new th.DictionaryPropertySet;k.setValue(Cc.a.marginTop,this.Qk.tna(b));
k.setValue(Cc.a.marginBottom,this.Qk.Iva(b));k.setValue(Cc.a.marginLeft,this.Qk.gJ(b));k.setValue(Cc.a.marginRight,this.Qk.VK(b));return k}aFb(b){const k=new th.DictionaryPropertySet;k.setValue(Cc.a.Ao,this.Qk.Vt(b));k.setValue(Cc.a.lv,this.Qk.uB(b));return k}}Object(n.a)(vK,"MarginsDialogActor",null,[]);class wK{constructor(b,k,t){this.ga=b;this.Zc=k;this.GLa=t;this.Zvd={Resume:["Contact","Objective","Experience","Skills and Abilities","Education"],zPj:["Summary","Updates","Challenges","Opportunities",
"What's Next"],MRj:["Highlights","Itinerary","Food","Activities"],RNj:["Introduction","Step 1","Step 2","Step 3"]}}Tb(){this.ga.fb(Nc.a.JNi,lc.a.Tc,this.ODk.bind(this),1028);this.ga.fb(Nc.a.lNf,lc.a.Tc,this.hEc.bind(this),1028);this.ga.fb(Nc.a.kNf,lc.a.Tc,this.hEc.bind(this),1028);this.ga.fb(Nc.a.jNf,lc.a.Tc,this.hEc.bind(this),1028);this.ga.fb(Nc.a.mNf,lc.a.Tc,this.hEc.bind(this),1028);this.ga.fb(Nc.a.KNi,lc.a.Tc,this.hEc.bind(this),1028)}ODk(){return null===this.Zc.instance?2:32}hEc(b,k,t){var D;
if(1===t){if(null===(D=w.AFrameworkApplication.K)||void 0===D?0:D.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1))return 32}else if(2===t){switch(b){case Nc.a.lNf:this.sWd(this.Zvd.Resume);break;case Nc.a.kNf:this.sWd(this.Zvd.zPj);break;case Nc.a.mNf:this.sWd(this.Zvd.MRj);break;case Nc.a.jNf:this.sWd(this.Zvd.RNj)}return 32}return 2}sWd(b){const k=new Xd.GraphTransaction(15);try{const t=Wa.App.ya.gb.wc.ed;let D=t,P;for(P=wc.a.Vo(t);P.moveNext();){const ta=P.currentNode;
if(pe.ParagraphReader.aUc(ta)&&pe.ParagraphReader.Wb(ta)){D=ta;break}}k.Cb(D);const ca=this.Zc.instance.uDc(b,D,!0).toArray();this.kGl(ca)}finally{k.dispose()}}kGl(b){for(const k of b)this.GLa.instance.yaa(k.node,4)}}Object(n.a)(wK,"MiniTemplateActor",null,[]);class oH{constructor(b){this.n$c=(k,t,D)=>{if(1===D)return 32;k=w.AFrameworkApplication.ta;if(!k)return 32;k.sBd();oH.T8n(k);return 32};this.ga=b}Tb(){this.ga.qa(Nc.a.n$c,lc.a.view,this.n$c)}static T8n(b){const k=w.AFrameworkApplication.K.jb("ModernUxExperimentPreferenceCookieName");
var t=w.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");t=Mb.a.lba(k,!t);Mb.a.dTa(k,(!t).toString(),Mb.a.cRa);t?v.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):v.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");bf.d(Nc.a.n$c,!0,void 0,void 0,void 0,void 0,[Object.assign(new na.a,{name:"ModernUxExperimentPreference",string:(!t).toString()})]);b.refreshDocument(null)}}Object(n.a)(oH,"ModernUxActor",null,[]);var aN=
c(1061),Ss=c(1686);class xK{constructor(b,k,t){this.Yie=Ef.a.Dv(1)/6;this.Kjo=(D,P,ca,ta,Na)=>{if(1===ca)return 32;if(ca=this.Sf.j8(P.$j)){if(0<=Na&&Na<Ss.a.F0.length){P=new Xd.GraphTransaction(15);P.Cb(ca);P.fk=D;D=Ss.a.F0[Na].fvb;ta=Ss.a.F0[Na].dvb;const qb=Ss.a.F0[Na]._marginLeft;Na=Ss.a.F0[Na].evb;this.$8d(D,ta,this.Sf.uB(ca))&&this.$8d(qb,Na,this.Sf.Vt(ca))?(this.DE.t6a(ca,D),this.DE.r6a(ca,ta),this.DE.Oia(ca,qb),this.DE.s6a(ca,Na),this.Ud.Js(11)):this.vHa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);
P.dispose()}else return 2;return 32}v.ULS.sendTraceTag(520618525,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.$j);return 2};this.Ljo=(D,P,ca,ta,Na)=>{if(1===ca)return 32;if(ca=this.Sf.j8(P.$j)){if(0<=Na&&Na<Ss.a.Bpa.length)P=new Xd.GraphTransaction(15),P.Cb(ca),P.fk=D,D=(ta=this.Sf.sUc(ca))?Ss.a.Bpa[Na].Fsa:Ss.a.Bpa[Na].FLa,Na=ta?Ss.a.Bpa[Na].FLa:Ss.a.Bpa[Na].Fsa,this.$8d(this.Sf.Iva(ca),this.Sf.tna(ca),Na)&&this.$8d(this.Sf.gJ(ca),this.Sf.VK(ca),D)?(this.DE.dbg(ca,D),this.DE.cbg(ca,
Na),this.Ud.Js(11)):this.vHa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),P.dispose();else return 2;return 32}v.ULS.sendTraceTag(520618524,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.$j);return 2};this.ejo=(D,P,ca,ta,Na)=>{if(1===ca)return 32;if(ca=this.Sf.j8(P.$j)){P=this.Sf.sUc(ca);ta=new Xd.GraphTransaction(15);ta.Cb(ca);ta.fk=D;this.DE.Okj(ca,Na);if(Na&&!P||!Na&&P){D=this.Sf.Vt(ca);Na=this.Sf.uB(ca);this.DE.dbg(ca,Na);this.DE.cbg(ca,D);D=this.Sf.tna(ca);Na=this.Sf.Iva(ca);
const qb=this.Sf.gJ(ca),Jb=this.Sf.VK(ca);P?(this.DE.t6a(ca,w.AFrameworkApplication.isRtl?qb:Jb),this.DE.r6a(ca,w.AFrameworkApplication.isRtl?Jb:qb),this.DE.Oia(ca,w.AFrameworkApplication.isRtl?Na:D),this.DE.s6a(ca,w.AFrameworkApplication.isRtl?D:Na)):(this.DE.t6a(ca,w.AFrameworkApplication.isRtl?Jb:qb),this.DE.r6a(ca,w.AFrameworkApplication.isRtl?qb:Jb),this.DE.Oia(ca,w.AFrameworkApplication.isRtl?Math.abs(D):Na),this.DE.s6a(ca,w.AFrameworkApplication.isRtl?Na:D));this.Ud.Js(11)}ta.dispose();return 32}v.ULS.sendTraceTag(520618523,
3009,50,"wordSectionNode is null; context.nextContext = {0}",P.$j);return 2};this.IXd=(D,P,ca)=>{if(1===ca)return 1===this.FS.Uu?32:8};this.cob=(D,P,ca,ta,Na)=>{if(1===ca)return 32;ca=this.Sf.j8(P.$j);if(!ca)return v.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.$j),2;P=new Xd.GraphTransaction(15);P.Cb(ca);P.fk=D;D=Math.floor(this.Sf.Vt(ca)/720);if(0>Na||Na>D)return 2;this.DE.NNb(ca,Na);P.dispose();return 32};this.Rfe=(D,P,ca,ta,Na)=>{if(1===ca)return 32;
ca=this.Sf.j8(P.$j);if(!ca)return v.ULS.sendTraceTag(520618521,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.$j),2;P=new Xd.GraphTransaction(15);P.Cb(ca);P.fk=D;D=Na[0];ta=this.Sf.Vt(ca);if(720>D||D>ta)return 2;this.DE.Cic(ca,Na);P.dispose();return 32};this.Qfe=(D,P,ca,ta,Na)=>{if(1===ca)return 32;ca=this.Sf.j8(P.$j);if(!ca)return v.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.$j),2;P=new Xd.GraphTransaction(15);P.Cb(ca);P.fk=D;D=this.Sf.Vt(ca);
ta=this.Sf.Yg(ca);if(0>Na||Na>(D-720*ta)/(ta-1))return 2;this.DE.Eeo(ca,Na);P.dispose();return 32};this.Pfe=(D,P,ca,ta,Na)=>{if(1===ca)return 32;ca=this.Sf.j8(P.$j);if(!ca)return v.ULS.sendTraceTag(512370310,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.$j),2;P=new Xd.GraphTransaction(15);P.Cb(ca);P.fk=D;if(null==Na)return 2;this.DE.Zko(ca,Na);P.dispose();return 32};this.NGa=(D,P,ca,ta,Na)=>{if(D=this.Sf.j8(P.$j))return Na.marginTop=this.Sf.tna(D),Na.marginBottom=this.Sf.Iva(D),Na.marginLeft=
this.Sf.gJ(D),Na.marginRight=this.Sf.VK(D),Na.Ao=this.Sf.Vt(D),Na.lv=this.Sf.uB(D),Na.Cwa=this.Sf.sUc(D),Na.RE=this.Sf.Yg(D),Na.hma=this.Sf.ihb(D),Na.i_k=this.Sf.RRd(D),Na.jJb=this.Y0l(Na),Na.NKb=this.d5l(Na),Na.BGc=this.XOl(Na),32;v.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.$j);return 2};this.Gge=(D,P,ca,ta,Na)=>{if(1===ca)return 32;if(ca=this.Sf.j8(P.$j)){P=new Xd.GraphTransaction(15);P.Cb(ca);switch(D){case Pb.a.t6a:this.DE.t6a(ca,Na);break;case Pb.a.r6a:this.DE.r6a(ca,
Na);break;case Pb.a.Oia:this.DE.Oia(ca,Na);break;case Pb.a.s6a:this.DE.s6a(ca,Na)}this.Ud.Js(11);P.dispose();return 32}v.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.$j);return 2};this.tlj=(D,P,ca,ta,Na)=>{if(1===ca)return 32;if(ca=this.Sf.j8(P.$j)){P=new Xd.GraphTransaction(15);P.Cb(ca);let qb=ta=0;switch(D){case Pb.a.fbg:qb=Na;this.DE.dbg(ca,qb);ta=this.Sf.uB(ca);break;case Pb.a.ebg:ta=Na,this.DE.cbg(ca,ta),qb=this.Sf.Vt(ca)}this.DE.Okj(ca,ta<qb);this.Ud.Js(11);
P.dispose();return 32}v.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.$j);return 2};this.DE=b;this.Ud=k;this.FS=t}get Sf(){return xn.a.instance}Z0l(b){var k=Wa.App.qEf,t=k?1:3,D=w.AFrameworkApplication.numberFormat;let P=Ss.a.F0[b].fvb;var ca=Ss.a.F0[b].dvb;var ta=Ss.a.F0[b]._marginLeft;b=Ss.a.F0[b].evb;P=k?Ef.a.YTa(P):Ef.a.Ez(P);ca=k?Ef.a.YTa(ca):Ef.a.Ez(ca);ta=k?Ef.a.YTa(ta):Ef.a.Ez(ta);b=k?Ef.a.YTa(b):Ef.a.Ez(b);k=F.a.$Da(P,t,D);ca=F.a.$Da(ca,t,D);ta=
F.a.$Da(ta,t,D);t=F.a.$Da(b,t,D);D={};D.top=k;D.bottom=ca;D.left=ta;D.right=t;return D}A8m(b){const k=WordRibbonStrings.PageMarginsTop,t=WordRibbonStrings.PageMarginsBottom,D=WordRibbonStrings.PageMarginsLeft,P=WordRibbonStrings.PageMarginsRight;b=this.Z0l(b);return[[k,b.top,t,b.bottom],[D,b.left,P,b.right]]}w0c(b){var k=Wa.App.qEf,t=k?1:3;const D=w.AFrameworkApplication.numberFormat;let P=Ss.a.Bpa[b].Fsa;b=Ss.a.Bpa[b].FLa;P=k?Ef.a.YTa(P):Ef.a.Ez(P);b=k?Ef.a.YTa(b):Ef.a.Ez(b);k=F.a.$Da(b,t,D);t=F.a.$Da(P,
t,D);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,k,t)}Tb(){const b=w.AFrameworkApplication.va;b.fb(Pb.a.u6a,lc.a.view,this.Kjo,4);b.fb(Pb.a.ZSa,lc.a.view,this.Ljo,4);b.fb(Pb.a.setOrientation,lc.a.view,this.ejo,4);b.fb(Pb.a.NGa,lc.a.view,this.NGa,96);b.qa(Pb.a.t6a,lc.a.view,this.Gge);b.qa(Pb.a.r6a,lc.a.view,this.Gge);b.qa(Pb.a.Oia,lc.a.view,this.Gge);b.qa(Pb.a.s6a,lc.a.view,this.Gge);b.qa(Pb.a.fbg,lc.a.view,this.tlj);b.qa(Pb.a.ebg,lc.a.view,this.tlj);b.fb(Pb.a.IXd,lc.a.view,this.IXd,
4);b.qa(Pb.a.cob,lc.a.view,this.cob);b.qa(Pb.a.Rfe,lc.a.view,this.Rfe);b.qa(Pb.a.Qfe,lc.a.view,this.Qfe);b.qa(Pb.a.Pfe,lc.a.view,this.Pfe)}$8d(b,k,t){return t>=b+k+Wa.App.uza}Y0l(b){let k=5;for(let t=0;t<Ss.a.F0.length;t++)if(Ss.a.F0[t].fvb===b.marginTop&&Ss.a.F0[t].dvb===b.marginBottom&&Ss.a.F0[t]._marginLeft===b.marginLeft&&Ss.a.F0[t].evb===b.marginRight){k=t;break}return k}d5l(b){let k=5;b=new aN.a(Math.min(b.Ao,b.lv),Math.max(b.Ao,b.lv));for(let t=0;t<Ss.a.Bpa.length;t++)if(this.axn(b,Ss.a.Bpa[t])){k=
t;break}return k}XOl(b){let k=0;switch(b.RE){case 1:k=1;break;case 2:k=2;break;case 3:k=3}return k}axn(b,k){return Ne.a.Tti(b.FLa,Math.max(k.FLa-this.Yie,0),k.FLa+this.Yie)&&Ne.a.Tti(b.Fsa,Math.max(k.Fsa-this.Yie,0),k.Fsa+this.Yie)}vHa(b){if(!ll.a.jM){const k=new Uc.StandardDialog;k.Ad=0;k.$U(CommonUIStrings.l_DefaultDialogTitle,b,null)}}}Object(n.a)(xK,"PageActor",null,[543]);class yK{constructor(b){this.ga=b}get pc(){return this.ga}Fge(b,k){let t=0;b?1===b?t=Pb.a.Oia:2===b?t=Pb.a.s6a:3===b&&(t=
Pb.a.r6a):t=Pb.a.t6a;this.pc.Qb(t,2,k)}ZSa(b,k){let t=0;1===b?t=Pb.a.ebg:b||(t=Pb.a.fbg);this.pc.Qb(t,2,k)}Ofe(b,k){let t=0;switch(b){case 0:t=Pb.a.cob;break;case 1:t=Pb.a.Rfe;break;case 2:t=Pb.a.Qfe;break;case 3:t=Pb.a.Pfe}this.pc.Qb(t,2,k)}}Object(n.a)(yK,"PageCommands",null,[542]);class zK{constructor(b,k,t){this.$wn=(D,P,ca,ta,Na)=>1===ca?32:(D=this.Qk.j8(P.$j))?(Na=3===Na.Gx,this.d6.value.YLh(this.b8l(D),this.aFb(D),Na),32):2;this.ga=b;this.d6=k;this.Qk=t}Tb(){this.ga.qa(Nc.a.DIf,lc.a.view,this.$wn);
this.ga.fb(Nc.a.bbe,lc.a.view,am.d,96);this.ga.fb(Nc.a.abe,lc.a.view,am.d,96);this.ga.qa(Nc.a.z8d,lc.a.view,am.c);this.ga.qa(Nc.a.y8d,lc.a.view,am.c)}b8l(b){const k=new th.DictionaryPropertySet;k.setValue(Cc.a.Ao,this.Qk.Vt(b));k.setValue(Cc.a.lv,this.Qk.uB(b));return k}aFb(b){const k=new th.DictionaryPropertySet;k.setValue(Cc.a.marginTop,Math.abs(this.Qk.tna(b)));k.setValue(Cc.a.marginBottom,Math.abs(this.Qk.Iva(b)));k.setValue(Cc.a.marginLeft,this.Qk.gJ(b));k.setValue(Cc.a.marginRight,this.Qk.VK(b));
return k}}Object(n.a)(zK,"PaperSizeDialogActor",null,[]);class OE{constructor(b,k,t,D){this.ga=b;this.d6=k;this.UV=t;this.UA=D}Tb(){this.ga.fb(Pb.a.scc,lc.a.view,this.Pxn.bind(this),1028);this.ga.qa(Pb.a.scc,lc.a.paragraph,this.Nxn.bind(this));this.ga.fb(Pb.a.tKn,lc.a.view,am.d,96);this.ga.fb(Pb.a.uKn,lc.a.view,am.d,96);this.ga.fb(Pb.a.AJn,lc.a.view,am.d,96);this.ga.fb(Pb.a.BJn,lc.a.view,am.d,96);this.ga.fb(Pb.a.wyo,lc.a.view,am.c,96);this.ga.fb(Pb.a.vyo,lc.a.view,am.c,96);this.ga.fb(Pb.a.ivn,lc.a.view,
am.c,96);this.ga.fb(Pb.a.jvn,lc.a.view,am.c,96);this.ga.fb(Pb.a.Vun,lc.a.view,am.c,96);this.ga.fb(Pb.a.uyo,lc.a.view,am.c,96);this.ga.fb(Pb.a.Wun,lc.a.view,am.c,96)}Nxn(b,k,t,D,P){if(1===t)return 3===this.ga.mode||2===this.ga.mode?32:8;b=k.node;k=this.tBj(k);P=3===P.Gx;this.d6.value.MGd(this.$Oc(b),this.aFb(k),P,this.UA);return 32}Pxn(b,k,t,D,P){b=k.view.mb;if(!b||OE.Vf.S$b(b.sg))return 8;if(OE.Wg.pza(pe.ParagraphReader.mU,b.sg))return OE.Ic.Yb(Pe.a.kf,{["Reason"]:He.a.dO}),8;if(1===t)return 3===
this.ga.mode||2===this.ga.mode?32:8;t=b.hb.kb;k=this.tBj(k);P=3===P.Gx;if(1===t.length&&hf.SelectionEditor.gf(t.J(0)))return t=t.J(0).node,this.d6.value.MGd(this.$Oc(t),this.aFb(k),P,this.UA),32;b=[];for(D=0;D<t.length;D++){const ca=t.J(D);(!D&&hf.SelectionEditor.Fk(ca)||pe.ParagraphReader.lm(ca)||hf.SelectionEditor.ml(ca))&&b.push(ca.node)}if(!b.length)return 8;t=Array(b.length);for(D=0;D<b.length;D++)t[D]=this.$Oc(b[D]);t=Tx.APropertySet.z$h(t);this.d6.value.MGd(t,this.aFb(k),P,this.UA);return 32}$Oc(b){var k,
t,D;const P=new th.DictionaryPropertySet;P.setValue(vd.a.lw,pe.ParagraphReader.Cx(b));const ca=this.UV.sEa(b);var ta=ca.lineSpacing;P.setValue(vd.a.F3a,ta.unit);P.setValue(vd.a.ua,ta.value);ta=ca.beforeSpacing;P.setValue(vd.a.ofc,ta.unit);P.setValue(vd.a.pfc,ta.value);ta=ca.afterSpacing;P.setValue(vd.a.mfc,ta.unit);P.setValue(vd.a.nfc,ta.value);P.setValue(vd.a.G0c,ca.ew);(null===(k=this.UA)||void 0===k?0:k.JFa)&&P.setValue(qe.a.keepWithNext,pe.ParagraphReader.keepWithNext(b));(null===(t=this.UA)||
void 0===t?0:t.XIa)&&P.setValue(qe.a.widowControl,pe.ParagraphReader.Xmc(b));(null===(D=this.UA)||void 0===D?0:D.pha)&&P.setValue(qe.a.keepTogether,pe.ParagraphReader.keepTogether(b));return P}static get Vf(){return Yj.a.instance}static get Wg(){return li.ContextSetEditor.instance}static get Ic(){return Hi.a.instance}}Object(n.a)(OE,"AParagraphDialogActor",null,[]);class AK extends OE{constructor(b,k,t,D,P,ca){super(b,k,t,ca);this.Qk=D;this.Uo=P}Tb(){super.Tb();this.ga.fb(Pb.a.m4i,lc.a.view,am.d,
96);this.ga.fb(Pb.a.n4i,lc.a.view,am.d,96);this.ga.fb(Pb.a.GJn,lc.a.view,am.d,96);this.ga.fb(Pb.a.Num,lc.a.view,am.c,96);this.ga.fb(Pb.a.Pum,lc.a.view,am.c,96);this.ga.fb(Pb.a.syo,lc.a.view,am.c,96);this.ga.fb(Pb.a.tyo,lc.a.view,am.c,96);this.ga.fb(Pb.a.cvn,lc.a.view,am.c,96);this.ga.fb(Pb.a.lvn,lc.a.view,am.c,96);this.ga.fb(Pb.a.kvn,lc.a.view,am.c,96);this.ga.fb(Pb.a.xyo,lc.a.view,am.c,96);this.ga.fb(Pb.a.vKn,lc.a.view,am.d,96);this.ga.fb(Pb.a.wKn,lc.a.view,am.d,96)}tBj(b){return this.Qk.j8(b.$j)}$Oc(b){const k=
super.$Oc(b);var t=this.Uo.ZT(b);const D=this.Uo.vG(b);k.setValue(vd.a.CGa,1);k.setValue(vd.a.DGa,t.Ft-D.Ft);t=this.Uo.q1a(b);k.setValue(vd.a.Amb,t.unit);k.setValue(vd.a.Bmb,t.value);b=this.Uo.u8b(b);b.specialIndentType&&(k.setValue(vd.a.l5,b.specialIndentType),k.setValue(vd.a.oTa,b.unit),k.setValue(vd.a.pTa,b.value));return k}aFb(b){const k=new th.DictionaryPropertySet;k.setValue(Cc.a.Ao,this.Qk.Vt(b));k.setValue(Cc.a.lv,this.Qk.uB(b));k.setValue(Cc.a.marginTop,Math.abs(this.Qk.tna(b)));k.setValue(Cc.a.marginBottom,
Math.abs(this.Qk.Iva(b)));k.setValue(Cc.a.marginLeft,this.Qk.gJ(b));k.setValue(Cc.a.marginRight,this.Qk.VK(b));return k}}Object(n.a)(AK,"ParagraphDialogActor",OE,[]);class BK extends Sys.EventArgs{constructor(b,k){super();this.node=b;this.bZd=k}}Object(n.a)(BK,"AfterPasteEventArgs",Sys.EventArgs,[]);class CK{constructor(b){this.BEe=this.GEe=null;this.lid=b}get vMd(){return null!=this.pzg?this.pzg:this.pzg=Fa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get bHm(){this.GEe||
(this.GEe=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate(pq.a.nQh,!1));return this.GEe}get UXd(){this.BEe||(this.BEe=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$(pq.a.sQh));return this.BEe}TGn(b){if(b&&va.OutlineElementReader.Bh(b.mva)&&va.OutlineElementReader.Bh(b.xkb)){this.nHn(b);var k=new Vk.a;for(k.Yc(b.mva);k&&k.currentNode;){const t=this.bRd(k),D=pe.ParagraphReader.Wb(t);D&&pe.ParagraphReader.Oeb(t)&&this.RGn(t);const P=k.currentNode.id===b.xkb.currentNode.id;
D&&(this.bHm||this.UXd)&&t.hj.yga(t.type).Hbe(new BK(t,P));if(P)break;ag.OutlineElementNavigator.Ur(k,!1,!1)}}}RGn(b){v.ULS.sendTraceTag(590435214,307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const k=b.Bfc;b=Of.a.Rc(b,0);Pq.TTc(k)?this.vMd.E9d(b,k):this.lid.E9d(b,k)}nHn(b){if(b.mva.currentNode&&b.xkb.currentNode&&b.mva.currentNode.id===b.xkb.currentNode.id){const k=this.bRd(b.mva);pe.ParagraphReader.Wb(k)?this.VGn(k,
b.Ezn,b.Dzn):v.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}VGn(b,k,t){v.ULS.shipAssertTag(590956771,307,0<=k);v.ULS.shipAssertTag(590958592,307,0<=t);var D=pe.ParagraphReader.text(b);if(""!==D){var P=Of.a.createTextRange(b,k,t);P=re.HyperlinkReader.MD(P,!1);if(1===P.length){const ca=P[0];P=D.substring(k,t).trim();D=D.substring(ca.cpBegin,ca.cpEnd).trim();k=P===D;P=Of.a.createTextRange(b,ca.cpBegin,ca.cpEnd);if(ca.hyperlink&&k&&!re.HyperlinkReader.n3a(D))b=
ca.hyperlink.url;else if(k)b=D;else{v.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");return}Pq.TTc(b)?this.vMd.GPa(P,b,!1):this.lid.GPa(P,b,!1)}else v.ULS.sendTraceTag(590958597,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",P.length)}}bRd(b){const k=ag.OutlineElementNavigator.Ge(b);
ag.OutlineElementNavigator.Vd(b);return k}}Object(n.a)(CK,"PastedContentsProcessorPostMergeAfterPaste",null,[541]);class pH extends av{constructor(b,k,t,D,P,ca,ta,Na){super(D);this.BQe=7;this.Iw=this.qsc=null;this.jDe=0;this.gDe=b;this.Ik=k;this.qn=t;this.he=P;this.WTj=ta;this.vXa=Na;this.M2=this.he.YQa("UserAction","WordIgnoreAll")}kcg(b){this.gDe.HJi();this.qsc=this.qn.ona(b);this.vXa.roi(this.qsc,null,!1);return this.gDe.YBj(this.qsc)?(this.M2.start(),this.Iw=new Xd.GraphTransaction(15),this.Iw.Cb(b.node),
!0):!1}Z$d(b){this.DLb(b.node);return!0}N1c(b){this.DLb(b);return!0}$$d(b){this.DLb(b.node)}eig(b){this.Iw.dispose();this.qsc.errorDetails.Opb(b.actionId);this.M2.stop();v.ULS.sendTraceTag(19779652,324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",this.jDe,this.M2.si,this.qsc.errorDetails.proofingType));return!0}Vjc(b,k){if(super.Vjc(b,k))return!0;b=b.role;return 9===b||10===b||13===b||7===b||8===b}aei(b){if(b&&b.type!==this.BQe){const k=
ze.GraphIterator.$a(b);return k.zb(this.BQe)?k.hd(this.BQe):b}return b}jKm(b,k){return this.gDe.Fhe(k.errorDetails)&&!this.Ik.A8(Of.a.createTextRange(b,k.begin,k.end))}DLb(b){if(b){var k=this.qn.N3(b,t=>this.jKm(b,t));this.WTj?this.qn.tnb(b,k,!0):0<k.length&&(b.Tk(4,!0),this.qn.NJb(b));this.jDe+=k.length}}}Object(n.a)(pH,"IgnoreAllCallbackSteps",av,[]);class DK{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc){this.z2c=(Kc,ed,sd,oe,Ld)=>{if(1===sd)return 32;Kc=this.uI.$Oa(ed.view.mb.sg);if(Kc=Xj.a.og(Kc))Ld[tn.a.LabelText]=
Kc.displayName;return 32};this.Pna=(Kc,ed,sd,oe,Ld,Od)=>{const ie=new pH(this.r5j,this.Ik,this.qn,this.Ie,this.he,this.gW,0,this.vXa);return new sw(Kc,ed,sd,oe,Ld,Od,ie,this.ga,this.ib,this.Ie,"IgnoreAllOperation")};this.XBb=(Kc,ed,sd,oe,Ld,Od)=>{const ie=new pH(this.m0j,this.Ik,this.qn,this.Ie,this.he,this.gW,1,this.vXa);return new sw(Kc,ed,sd,oe,Ld,Od,ie,this.ga,this.ib,this.Ie,"DoNotCheckThisCritiqueType")};this.ga=b;this.Ik=k;this.ib=t;this.Ie=D;this.qn=P;this.uI=ca;this.he=ta;this.r5j=Na;this.m0j=
qb;this.QVb=Jb.fVc;this.gW=Jb;this.vXa=Vb;this.jFe=ac;this.Z8a=yc}Tb(){this.jFe&&(an.zB()?this.ga.fb(Pb.a.Pna,lc.a.Tc,this.atm.bind(this),1028):this.ga.cT(Pb.a.Pna,lc.a.view,this.Pna,1028));this.QVb&&this.ga.cT(Pb.a.XBb,lc.a.view,this.XBb,1028);this.ga.fb(Nc.a.z2c,lc.a.view,this.z2c,96)}atm(b,k,t,D,P){if(1===t)return 32;v.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.Z8a.iwf(P?P:k,null,np.b.IgnoreAll);return 32}}Object(n.a)(DK,"ProofingActor",null,[]);var VC=c(1180),
bN=c(1688);class WC{constructor(b,k,t,D,P,ca,ta,Na,qb){this.nq=this.eMa=this.bvd=this.cvd=null;this.mE=this.Es=this.sq=0;this.K$a=this.J$a=!1;this.kaa=this.O9a=this.N9a=this.L9a=this.P9a=0;this.fud=null;this.Fda=this.hW=this.Oq=this.YP=0;this.Nl=null;this.Ttb=0;this.xVf=Jb=>{var Vb;if(5===this.Ttb){const ac=Object.assign(new Db.a,{extendedProperties:new Map});ac.extendedProperties.set("status",Jb.data.status.toString());ac.extendedProperties.set("httpStatus",Jb.data.Qe.toString());(null===(Vb=w.AFrameworkApplication.K)||
void 0===Vb?0:Vb.$("ShouldLogPicturesExtendedHealthKpis"))?(Vb={name:Ul.c.EVd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:ac},ac.extendedProperties.set("ErrorLevel","warning"),this.$h.logKpiFailure({kpiName:Ul.c.F9b,errorName:"PictureSwordRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:ac},optionalVeto:Vb})):xa.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,
!1,!1,ac)}v.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",{["Status"]:Jb.data.status,["HttpStatus"]:Jb.data.Qe,["Id"]:Jb.data.id,["ResponseData"]:Jb.data.xe},NE.a[this.Ttb]);this.fee()};this.Oj=t;this._image=b;this._context=k;this.Lmd=!1;(b=WC.fh.Ts(k.node))&&b.Lf(Cc.a.gGf)&&(this.Lmd=!0);this.luc=D.$("ImageDataURLPresentationIsEnabled");this.pek=D.$("WordOartPostRequestIsEnabled");this.Ma=D;this.kr=P;this.he=ca;this.Ud=ta;this.Jm=Na;this.WJ=qb;this.$h=Ag.a.getInstance(Ul.a);
this.Bxm();this.B7d=this.Jec.bind(this)}Bxm(){this.nq="";this.sq=Be.ImageReader.fF(this._image);this.Es=Be.ImageReader.wG(this._image);this.kaa=Be.ImageReader.Nhb(this._image);this.mE=Be.ImageReader.z_(this._image);this.J$a=Be.ImageReader.DPd(this._image);this.K$a=Be.ImageReader.ZDb(this._image);const b=Be.ImageReader.pba(this._image);this.P9a=Math.max(b.top,0);this.L9a=Math.max(b.bottom,0);this.N9a=Math.max(b.left,0);this.O9a=Math.max(b.right,0);this.Nl=lb.a.nil;this.eMa=null;this.Ttb=Be.ImageReader.mk(this._image)}WBd(b,
k){return(new bN.a(this.kr,this.Ttb,this.Ma,this.sq,this.Es,this.mE,this.kaa,this.P9a,this.L9a,this.N9a,this.O9a,this.J$a,this.K$a,this.Lmd)).build(this._context.node,this._image,b,k)}resize(b,k){this.nq="Resize";this.xje();Hj.a.mark(this.$7b());this.sq=b;this.Es=k;this.sendMessage(!1,this.B7d)}uw(b){this.nq="Styles";this.xje();Hj.a.mark(this.$7b());this.kaa=b;this.sendMessage(!1,this.B7d)}Cjo(b,k,t){this.nq="Rotation";this.xje();this.mE=b;this.J$a=k;this.K$a=t;this.sendMessage(!1,this.B7d)}Bjo(b,
k){this.nq="SwordRequestManager";this.xje();this.eMa=b;this.mE=k.angle;this.sq=k.width;this.Es=k.height;this.kaa=k.styleId;this.P9a=k.top;this.L9a=k.bottom;this.N9a=k.left;this.O9a=k.right;this.Nl=k.xT;this.sendMessage(!1,this.B7d)}sendMessage(b,k){if(this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var t=this.bfb(t);const D=Be.ImageReader.zna(this._image,this.Ma,this.kr);D?VC.a.oob(this._image,D,4):this._image.setValue(ke.a.yOa,!0);t.dispose()}this.muj(b);Hj.a.mark(this.$7b());b=new eb.QueryStringBuilder(this.WBd(b,
!0));this.luc&&b.Ce(Rh.a.oOh,"true");this.pek?(t=new eb.QueryStringBuilder("WordOart.ashx"),w.AFrameworkApplication.Ne.sj(t.toString(),2,b.toString(),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,k,this.xVf,null)):w.AFrameworkApplication.Ne.sj(b.toString(),1,"",null,!0,0,k,this.xVf,null)}bfb(b){b=this.Nl&&this.Nl!==lb.a.nil?new Xd.GraphTransaction(7,Pb.a.imageRotate):new Xd.GraphTransaction(15);b.Cb(this._context.node);return b}get MNj(){const b=new Xd.GraphTransaction(3);
b.Cb(this._context.node);return b}fee(){this.zKc();this.WJd();const b=this.MNj;var k=Be.ImageReader.sva(this._image,this._context.node.Kc,this.Ma,this.kr);this._image.setValue(ke.a.yOa,!1);this._image.setValue(vd.a.FRc,k);this._image.setValue(vd.a.jJ,-1);this._image.setValue(ke.a.T4,1);k=Be.ImageReader.zna(this._image,this.Ma,this.kr);this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty(vd.a.$9d),this._image.removeProperty(vd.a.Y9d),k&&VC.a.oob(this._image,k,3));
b.dispose();WC.yp();this.eMa&&this.eMa()}muj(b){this.he&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.cvd=this.he.Zf("WebServiceCall",b))}zKc(){this.cvd&&(this.cvd.stop(),this.cvd=null)}xje(){if(this.he){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.nq,NE.a[this.Ttb]);this.bvd=this.he.Zf("WebServiceCall",b)}}WJd(){this.bvd&&(this.bvd.stop(),this.bvd=null)}static get fh(){return Wk.PageNavigator.instance}static yp(){const b=new Uc.StandardDialog;
b.Ad=0;b.ix(zk.a.XAn,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);Wa.App.ya&&Wa.App.ya.updateCommandUI()}}Object(n.a)(WC,"RenderedImageEditOperation",null,[591]);var qH=c(298),BF=c(503);class EK extends WC{constructor(b,k,t,D,P,ca,ta,Na,qb){super(b,k,t,D,P,ca,ta,Na,qb)}sendMessage(b,k){Object(qH.a)(()=>{let t;t=this.bfb(t);this._image.setValue(ke.a.T4,0);t.dispose()});this.muj(b);Hj.a.mark(this.$7b());b=new eb.QueryStringBuilder("WordOart.ashx");this.XYg=
this.Thb(!0,!1);b=new BF.a(b.toString(),2,this.Thb(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,null,null,null,null,null,null,null,null,null,null,null,["Content-Type"],null,"text");w.AFrameworkApplication.Ne.send(b).bya(k,t=>{this.xVf(t)})}Jec(b){try{const k=JSON.parse(b.data.DSa);this.l4j=k[Rh.a.$Pc];this.Mnk=k[Rh.a.width];this.F4j=k[Rh.a.height];this.VKg=k[Rh.a.QDc];this.Zrc=Array(4);this.Zrc[0]=k[Rh.a.Rfb];this.Zrc[1]=k[Rh.a.Sfb];this.Zrc[2]=k[Rh.a.Tfb];
this.Zrc[3]=k[Rh.a.Qfb];this.r2g=void 0!==k[Rh.a.Rwa]?"true"===k[Rh.a.Rwa].toLowerCase():null;Object(qH.a)(()=>{this.Lad();this._context.node.Bi().contentReplicator.forceOutbound(()=>{this.BCl()},null,null)})}catch(k){v.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",k.message,this.nq,Be.ImageReader.mk(this._image)),this.fee()}}P6d(){v.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}Lad(){let b;
b=this.bfb(b);this._image.setValue(qe.a.eU,this.l4j);this.VKg&&this._image.setValue(qe.a.fAd,this.VKg);this._image.setValue(qe.a.Sva,this.Mnk);this._image.setValue(qe.a.Tva,this.F4j);this._image.setValue(qe.a.lPa,this.Zrc);this.y5j&&this._image.setValue(vd.a.WFb,this.y5j);VC.a.oob(this._image,this.XYg,3);this._image.setValue(Cc.a.Ofb,this.XYg);this.r2g?this._image.setValue(qe.a.E2a,this.r2g):this._image.removeProperty(qe.a.E2a);this.lWk();b.dispose()}lWk(){this._image.removeProperty(vd.a.Wt);this._image.removeProperty(vd.a.jJ);
this._image.removeProperty(vd.a.$9d);this._image.removeProperty(vd.a.Y9d)}BCl(){this.WJ.uHa(this._context);if(this.Nl&&this.Nl!==lb.a.nil){const b=this._context.node.Bi(),k=new X.a(this.Nl,1);this.Jm.O2b(b,k)}this.Ud.Js(13);this.zKc();this.WJd();Hj.a.mark(this.Z7b());Object(qH.a)(()=>{let b;b=this.bfb(b);this._image.setValue(ke.a.T4,1);b.dispose()});this.eMa&&this.eMa()}Thb(b,k){b=new eb.QueryStringBuilder(this.WBd(b,k));b.Ce(Rh.a.LVd,"true");return b.toString()}$7b(){return 51511}Z7b(){return 51512}}
Object(n.a)(EK,"RenderedGraphicEditOperation",WC,[]);class FK extends WC{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb){super(b,k,t,D,P,ca,ta,Na,qb);this.WTg=null;this.P6d=Vb=>{const ac=this.WBd(!0,!1);let yc;yc=this.bfb(yc);this._image.setValue(Cc.a.gAd,this.fud);var Kc=Fa.a.instance.Na("Box4.IFeatureHelper");Kc&&Kc.isFeatureEnabled(49)&&this._image.setValue(Cc.a.dLd,this.WTg);this.Ma.$("WordEditorImageRotateIsEnabled")&&this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Oj.pge(this._image,
this.mE,this.J$a,this.K$a);const ed=Be.ImageReader.zna(this._image,this.Ma,this.kr),sd=()=>{ed&&VC.a.oob(this._image,ed,3);VC.a.oob(this._image,ac,3);this.Oj.nge(this._image,Ef.a.oG(this.YP),Ef.a.oG(this.hW),Ef.a.oG(this.Oq),Ef.a.oG(this.Fda));this._image.setValue(Cc.a.Ofb,ac);Be.ImageReader.py(this._image)||this._image.setValue(Cc.a.REa,1);this.Oj.Xfe(this._image,this.sq,this.Es);this.Ma.$("WordEditorImageRotateIsEnabled")&&!this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Oj.pge(this._image,
this.mE,this.J$a,this.K$a);2===Vb.data.status&&Be.ImageReader.X_(Vb.data.xe)&&(this._image.setValue(vd.a.Wt,Vb.data.xe),Vb.data.request&&this._image.setValue(vd.a.WFb,VC.a.lLc("POST"===Vb.data.request.get_httpVerb()?Vb.data.request.get_body():Vb.data.request.get_url())));this.eMa&&this.eMa();this.WJ.uHa(this._context);if(this.Nl&&this.Nl!==lb.a.nil){const oe=this._context.node.Bi(),Ld=new X.a(this.Nl,1);this.Jm.O2b(oe,Ld)}this.Ud.Js(13);this.zKc();this.WJd();Hj.a.mark(this.Z7b())};if(this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&
this.Nl&&this.Nl!==lb.a.nil&&(Kc=this._context.node.Bi())&&Kc.contentReplicator){yc.dispose();Kc.contentReplicator.forceOutbound(()=>{let oe;oe=this.bfb(oe);sd();oe.dispose()},null,null);return}sd();yc.dispose()};this.cPe=Jb}$7b(){return 51511}Z7b(){return 51512}Jec(b){try{var k=JSON.parse(b.data.xe);const P=Sys.Net.XMLDOM("string"===typeof k[Rh.a.Arh]?k[Rh.a.Arh]:null);this.fud="string"===typeof k[Rh.a.hAd]?k[Rh.a.hAd]:null;const ca=Fa.a.instance.Na("Box4.IFeatureHelper");ca&&ca.isFeatureEnabled(49)&&
(this.WTg="string"===typeof k[Rh.a.N5b]?k[Rh.a.N5b]:null);aa.a.ut&&P.setProperty("SelectionNamespaces","xmlns:mc='"+Lf.a.HAk+"'");const ta=P.selectSingleNode("/mc:AlternateContent");if(!ta)throw jr.a.argument("Alternate content element could not be retrieved!");const Na=ta.firstChild;if(!Na)throw jr.a.argument("Alternate content choice element could not be retrieved!");const qb=Na.firstChild;if(!qb)throw jr.a.argument("Drawing element could not be retrieved!");var t=qb.firstChild;if(!t)throw jr.a.argument("Inline element could not be retrieved!");
k=b=null;const Jb=RegExp("effectExtent"),Vb=RegExp("extent");for(const yc of t.childNodes)-1!==yc.nodeName.search(Jb)&&(b=yc),-1!==yc.nodeName.search(Vb)&&(k=yc);if(!b||!k)throw jr.a.argument("Effect extent or extent could not be retrieved!");this.YP=parseInt(b.selectSingleNode("@l").text);this.hW=parseInt(b.selectSingleNode("@r").text);this.Oq=parseInt(b.selectSingleNode("@t").text);this.Fda=parseInt(b.selectSingleNode("@b").text);const ac=fj.c(this.mE);if(45<=ac&&135>=ac||225<=ac&&315>=ac){const yc=
parseInt(k.selectSingleNode("@cx").text);var D=parseInt(k.selectSingleNode("@cy").text);t=yc/2;D/=2;this.YP-=t-D;this.hW+=t-D;this.Oq-=D-t;this.Fda+=D-t}}catch(P){v.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",P.message,this.nq,NE.a[this.cPe]);this.fee();return}this.sendMessage(!0,this.P6d)}}Object(n.a)(FK,"RenderedDrawingEditOperation",WC,[]);class GK extends WC{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){super(b,k,t,D,P,ca,
ta,Na,qb);this.X$=null;this.P6d=ac=>{var yc;const Kc=this.WBd(!0,!1);let ed;ed=this.bfb(ed);this._image.setValue(Cc.a.cLb,this.fud);const sd=Be.ImageReader.zna(this._image,this.Ma,this.kr);(null===(yc=w.AFrameworkApplication.K)||void 0===yc?0:yc.$("ShouldLogPicturesExtendedHealthKpis"))&&this.$h.logKpiSuccess({kpiName:Ul.c.F9b});const oe=()=>{sd&&VC.a.oob(this._image,sd,3);VC.a.oob(this._image,Kc,3);this.Oj.nge(this._image,Ef.a.oG(this.YP),Ef.a.oG(this.hW),Ef.a.oG(this.Oq),Ef.a.oG(this.Fda));this._image.setValue(Cc.a.Ofb,
Kc);Be.ImageReader.py(this._image)||this._image.setValue(Cc.a.REa,1);this._image.setValue(Cc.a.h1c,this.kaa);this._image.setValue(vd.a.Stm,-1);this.ld.isFeatureEnabled(90)&&Be.ImageReader.f9b(this._image)&&this.Go.Wce(this._image);this._image.setValue(ke.a.yOa,!1);this.Oj.Xfe(this._image,this.sq,this.Es);this.Ma.$("WordEditorImageRotateIsEnabled")&&this.Oj.pge(this._image,this.mE,this.J$a,this.K$a);this.Ma.$("WordEditorImageCropIsEnabled")&&this.Oj.Dag(this._image,this.P9a,this.L9a,this.N9a,this.O9a);
2===ac.data.status&&Be.ImageReader.X_(ac.data.xe)&&(this._image.setValue(vd.a.Wt,ac.data.xe),ac.data.request&&this._image.setValue(vd.a.WFb,VC.a.lLc("POST"===ac.data.request.get_httpVerb()?ac.data.request.get_body():ac.data.request.get_url())));this.eMa&&this.eMa();this.WJ.uHa(this._context);if(this.Nl&&this.Nl!==lb.a.nil){const Ld=this._context.node.Bi(),Od=new X.a(this.Nl,1);this.Jm.O2b(Ld,Od)}this.Ud.Js(13);this.zKc();this.WJd();Hj.a.mark(this.Z7b())};if(this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&
this.Nl&&this.Nl!==lb.a.nil&&(yc=this._context.node.Bi())&&yc.contentReplicator){ed.dispose();yc.contentReplicator.forceOutbound(()=>{let Ld;Ld=this.bfb(Ld);oe();Ld.dispose()},null,null);return}oe();ed.dispose()};this.cPe=Jb;this.ld=Vb}$7b(){return 7988}Z7b(){return 7989}get Go(){this.X$||(this.X$=new tK.a);return this.X$}Jec(b){var k;try{const t=b.data.Aia;this.fud=b.data.xe;aa.a.ut&&t.setProperty("SelectionNamespaces","xmlns:pic='"+Lf.a.VAn+"'");const D=t.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;
this.YP=parseInt(D.selectSingleNode("@l").text);this.hW=parseInt(D.selectSingleNode("@r").text);this.Oq=parseInt(D.selectSingleNode("@t").text);this.Fda=parseInt(D.selectSingleNode("@b").text)}catch(t){b=Object.assign(new Db.a,{extendedProperties:new Map});b.extendedProperties.set("exception",t.message);b.extendedProperties.set("operation",this.nq);(null===(k=w.AFrameworkApplication.K)||void 0===k?0:k.$("ShouldLogPicturesExtendedHealthKpis"))?(k={name:Ul.c.EVd,errorNameOverride:null,isIntentional:!1,
isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.$h.logKpiFailure({kpiName:Ul.c.F9b,errorName:"PictureSwordResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:k})):xa.Health.instance.recordQosError("PictureSwordResponseInvalid",["ImageEditFailed"],!1,!0,!1,!1,b);v.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",
t.message,this.nq,NE.a[this.cPe]);this.fee();return}this.zKc();Hj.a.mark(this.Z7b());this.sendMessage(!0,this.P6d)}}Object(n.a)(GK,"RenderedPictureEditOperation",WC,[]);class HK{constructor(b,k,t,D,P,ca,ta,Na){this.Oj=b;this.Ma=k;this.kr=t;this.he=D;this.Ud=P;this.Jm=ca;this.WJ=ta;this.ld=Na}create(b,k){const t=Be.ImageReader.mk(b);return Yl.App.instance.c4(t)?new EK(b,k,this.Oj,this.Ma,this.kr,this.he,this.Ud,this.Jm,this.WJ):10===t||11===t||48===t||4===t?new FK(b,k,this.Oj,this.Ma,this.kr,this.he,
this.Ud,this.Jm,this.WJ,t):5===t?new GK(b,k,this.Oj,this.Ma,this.kr,this.he,this.Ud,this.Jm,this.WJ,t,this.ld):null}}Object(n.a)(HK,"Factory",null,[540]);class IK{constructor(){this.HJc=b=>{const k=window.performance.now(),t=dl.a.Lr();if(t){b=gH.a(b.customData,t);b=wc.a.mt(b,t);var D=0,P=new Xd.GraphTransaction(3);try{for(P.Cb(t);b.moveNext();){if(!pe.ParagraphReader.uh(b.iterator))continue;const ca=b.currentNode;this.jTh(ca)&&(D++,ca.Tk(4,!0));const ta=window.performance.now()-k;if(2500<D||100<ta){this.Rwb=
null;this.S2c(ca);break}}}finally{P&&P.dispose()}}else Jc.b(570450380,3018,10,"PageContentNode not found")};this.Rwb=null}Usi(){const b=dl.a.Lr();this.d3c(b);this.S2c(null)}S2c(b){this.Rwb&&(w.AFrameworkApplication.nc.Ve(this.Rwb),this.Rwb=null);this.Rwb=new Df.a(1,1,1,this.HJc,198);this.Rwb.customData=b;w.AFrameworkApplication.nc.Vb(this.Rwb)}d3c(b){const k=gH.b(b);if(k){var t=new Xd.GraphTransaction(3);try{for(t.Cb(b);k.moveNext();){if(!pe.ParagraphReader.uh(k.iterator))continue;const D=k.currentNode;
this.jTh(D)&&D.Tk(4,!0)}}finally{t&&t.dispose()}}}jTh(b){b=b.WG;for(const k of b)if(k.zjb)return 0<k.mPb;return!1}}Object(n.a)(IK,"RenderParagraphsContainingTabs",null,[]);class JK{constructor(b,k){this.Xxe=!0;this.Lqc=null;this.Nol=()=>{this.Lqc=null;this.Xxe=!0;this.fMa&&this.fMa.fUa(!Wa.App.QQ())};this.S7a=(t,D,P)=>{if(1===P)return 32;2===P&&(t=!1,Wa.App.QQ()?this.Xxe=!1:this.Xxe?t=!0:this.hXo(),this.fMa&&this.fMa.fUa(t));return 32};this.ga=b;this.fMa=k}Tb(){this.ga.fb($a.a.S7a,lc.a.application,
this.S7a,1124)}hXo(){this.Lqc?w.AFrameworkApplication.nc.Ve(this.Lqc):this.Lqc=new Df.a(4,1,5E3,this.Nol);w.AFrameworkApplication.nc.Vb(this.Lqc)}}Object(n.a)(JK,"SaveStatusActor",null,[]);class KK{get X8f(){return null!=this.PFg?this.PFg:this.PFg=Fa.a.instance.Na("Box4.ISaveStyleManager")}get p3n(){return this.o3n||(this.o3n=Fa.a.instance.Na("Box4.IResetAndDeleteStyleManager"))}get Fn(){return null!=this.LGg?this.LGg:this.LGg=Fa.a.instance.Na("Box4.Styles.StyleSettings")}constructor(b,k){this.applyStyles=
(t,D,P)=>{t=dl.a.MHb(D);if(1===P||t)return t?8:32;this.d6.value.E7k(D);return 32};this.fBb=(t,D,P)=>{t=dl.a.MHb(D);if(1===P||t)return t?8:32;this.d6.value.yal(D,this.ga);return 32};this.udf=(t,D,P)=>{t=dl.a.MHb(D)||this.cpo();if(1===P||t)return t?8:32;this.d6.value.udf(D);return 32};this.ga=b;this.d6=k}get sc(){return null!=this.AJg?this.AJg:this.AJg=Fa.a.instance.resolve("Box4.Styles.IWACStyleReader")}Tb(){this.ga.fb(Pb.a.applyStyles,lc.a.view,this.applyStyles,1028);this.ga.fb(Pb.a.fBb,lc.a.view,
this.fBb,4);this.ga.fb(Pb.a.NBb,lc.a.view,this.udf,4);this.ga.fb(Pb.a.W8f,lc.a.view,this.o9n.bind(this),4);this.ga.fb(Pb.a.r7f,lc.a.view,this.s7f.bind(this),4);this.ga.fb(Pb.a.pdf,lc.a.view,this.Pil.bind(this),4)}o9n(b,k,t){b=dl.a.MHb(k)||this.hpo();if(1===t||b)return b?8:32;this.X8f.n9n();return 32}s7f(b,k,t){b=dl.a.MHb(k)||this.fpo();if(1===t||b)return b?8:32;this.p3n.s7f();return 32}Pil(b,k,t){b=dl.a.MHb(k)||this.bpo();if(1===t||b)return b?8:32;this.d6.value.Oil();return 32}bpo(){return"{}"===
DE.a.mqb?!0:!1}fpo(){if(0==DE.a.u4.size)return!0;var b=DE.a.u4;const k=this.sc.Mr();let t=0;for(const D of b.values())b=k.Fi(D),this.sc.ke(b,k)||t++;return 0==t?!0:!1}hpo(){var b=DE.a.mqb,k=DE.a.u4;const t=this.sc.Mr();if(0==k.size)return!0;if(!({Wu:b}=G.d(b)).returnValue)return v.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=k.size)return!1;for(const P of k.values()){k=t.Fi(P);var D=b[P];if(null==D)return!1;if(D=dl.a.aSd(D)){if(k=
dl.a.INc(k,t),dl.a.FUc(k,D))return!1}else v.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}cpo(){var b=dl.a.Lr();if(!b)return Jc.b(577368330,3018,15,"PageContentNode is null"),!0;b=(new hv.WACStyleSet).LO(b);const k=b.hO;for(let D=0;D<k;D++){var t=b.AEa(D);if(this.sc.isHidden(t)||!this.sc.ke(t,b))continue;const P=this.sc.RD(t);if(2===P||1===P)if(!t.hasProperty(Cc.a.linkedStyle)||2===P)if(t=t.ia(Cc.a.yK,null),!(t&&0<t.length))return!1}return!0}}
Object(n.a)(KK,"StylesActor",null,[]);class wG{constructor(b){this.nke=(k,t,D)=>{k=w.AFrameworkApplication.ta;if(1===D)return 1!==k.mode||$b.SessionStatusManager.instance.wj?2:32;xa.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,wG.qB,null);const P={};P[I.a.Zxf]=w.AFrameworkApplication.K.jb("ClassicViewModePreferenceCookieName");P[I.a.Lni]="true";w.AFrameworkApplication.MO().execute(ca=>{ca.sendMessage(K.a.tBo,P)});return w.AFrameworkApplication.va.processAction(Pb.a.readingMode,2)};this.ga=
b}Tb(){this.ga.qa(Nc.a.nke,lc.a.view,this.nke)}}wG.qB="wwaengidc";Object(n.a)(wG,"SwitchToClassicViewModeActor",null,[]);class LK{constructor(b,k,t,D,P,ca,ta,Na,qb){this.angle=t;this.styleId=D;this.width=b;this.height=k;this.top=P;this.bottom=ca;this.left=ta;this.right=Na;this.xT=qb}}Object(n.a)(LK,"SWordData",null,[]);class MK{constructor(b,k){this.yk=this.r2=this.mq=null;this.rPe=this.YWb=!1;this.YP=this.hW=this.Fda=this.Oq=this.kaa=this.Es=this.sq=this.mE=0;this.Nl=null;this.u0=()=>{this.rPe=!1;
this.YWb&&this.DKc()};this.Do=b;this.Bzc=k;this.kqi()}kqi(){this.hW=this.YP=this.Fda=this.Oq=this.kaa=this.Es=this.sq=this.mE=-1;this.Nl=lb.a.nil}DKc(){this.rPe||(this.p_o(),this.Nbl(),this.YWb=!1)}Nbl(){this.yk=new LK(this.sq,this.Es,this.mE,this.kaa,this.Oq,this.Fda,this.YP,this.hW,this.Nl);this.Bzc.create(this.r2,this.mq).Bjo(this.u0,this.yk);this.rPe=!0;let b;Object(ob.a)(3,this.r2)?b=NE.a[Be.ImageReader.mk(this.r2)]:(v.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),
b="generic");v.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",this.sq,this.Es,this.mE,this.kaa,this.Oq,this.Fda,this.YP,this.hW,b);this.kqi()}p_o(){this.sq=-1!==this.sq?this.sq:this.r2.ia(vd.a.PEa,-1);this.Es=-1!==this.Es?this.Es:this.r2.ia(vd.a.OEa,-1);this.sq=-1!==this.sq?this.sq:this.Do.fF(this.r2);this.Es=-1!==this.Es?this.Es:this.Do.wG(this.r2);this.mE=-1!==this.mE?
this.mE:this.Do.z_(this.r2);this.kaa=-1!==this.kaa?this.kaa:this.Do.Nhb(this.r2);const b=this.Do.pba(this.r2);this.Oq=-1!==this.Oq?this.Oq:b.top;this.Fda=-1!==this.Fda?this.Fda:b.bottom;this.YP=-1!==this.YP?this.YP:b.left;this.hW=-1!==this.hW?this.hW:b.right}VKn(b,k,t,D){this.mq=b;this.mE=t;this.YWb=!0;this.r2=k;this.Nl=D;this.DKc()}UKn(b,k,t,D,P){this.mq=b;this.YWb=!0;this.r2=k;this.Nl=P;this.r2.setValue(vd.a.PEa,t);this.r2.setValue(vd.a.OEa,D);this.DKc()}ZKn(b,k,t){this.mq=b;this.YWb=!0;this.r2=
k;this.kaa=t;this.DKc()}PKn(b,k,t,D,P,ca){this.mq=b;this.Oq=t;this.Fda=D;this.YP=P;this.hW=ca;this.YWb=!0;this.r2=k;k=b=0;({width:b,height:k}=this.Do.yhb(this.r2));this.sq=b-(P+ca)/1E5*b;this.Es=k-(t+D)/1E5*k;this.DKc()}}Object(n.a)(MK,"SWordRequestManager",null,[539]);class CF{constructor(b,k,t,D=null,P=null,ca=null,ta=null,Na=null,qb=null,Jb=null){this.Jm=null;this.okh=!1;this.VDo=(Vb,ac,yc,Kc,ed)=>{if(1===yc)return 32;const sd=Vb===Pb.a.ycg;if(!ac.view.qe)return 2;const oe=ac.view,Ld=oe.mb,Od=
Ld.sg;if(!Od||CF.Vf.i_(Od))return 2;if(this.Sm&&this.Sm.instance&&this.Sm.instance.qU(Od))return 4;Vb=null;var ie=Xc.ActionManager.kxa;let Ce=!1;var hg=hf.SelectionEditor.gf(Od);if(Od.Ww){if(Ld.hb.nJ&&(ie=Od.getContext(0),Vb=new ze.GraphIterator,Vb.set(ie.node),Vb.Dp(),ie=sd?Pb.a.D9f:Pb.a.dfe),ie=this.ITe.wFn(ie),ie===Xc.ActionManager.kxa){var Kg=CF.Wg.jT(Od,16);Kg?(sd&&(ie=Pb.a.R4d),Vb=new ze.GraphIterator,Vb.set(Kg.node),Vb.yd()):ie=sd?Pb.a.IG:Pb.a.mO}}else if(Od.al)if(Vb=new ze.GraphIterator,Vb.set(Od.node),
hf.SelectionEditor.ku(Vb),Xh.OutlineReader.kQa(Od))ie=sd?Pb.a.D9f:Pb.a.dfe;else{if(this.eDe&&this.eDe.iro(Od))return this.eDe.G6c(Od,oe.ic,sd),32;Be.ImageReader.v2a(Od)?ie=sd?Pb.a.C9f:Pb.a.B9f:(ie=sd?this.ITe.kjm(Vb,Od,ie,ac):this.ITe.jjm(Vb,Od,ie,ac),va.OutlineElementReader.Bh(Vb)&&Od.contextId===lc.a.Tc&&(Ce=va.OutlineElementReader.wA(Vb,Od,!1)),Kg=dg.ListItemReader.sh(Vb)&&Ce,ie!==Xc.ActionManager.kxa||yh.TableCellReader.Doa(Vb)||Kg||(this.okh||(v.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),
this.okh=!0),w.AFrameworkApplication.va.processAction(Pb.a.Hqi,2),this.eri(ac)))}else return 2;if(!sd&&ie===Xc.ActionManager.kxa&&yh.TableCellReader.Doa(Vb))if(mh.returnToCell(Vb),yh.TableCellReader.eQa(Vb)||Ih.TableReader.exi(Vb)&&yh.TableCellReader.$Df(Vb)){if(ie=this.apk(),!ie)return 2}else ie=Pb.a.aPi;if(ie===Xc.ActionManager.kxa)return 2;switch(ie){case Pb.a.aPi:case Pb.a.R4d:Kc=ie===Pb.a.R4d;hg&&this.I1&&this.YY&&(hg=this.I1.Njf(Od,-1,!0,pc.a.ww))&&this.YY.bgj(hg);yc=32;mh.returnToCell(Vb);
mh.moveToNextOrPreviousCell(Vb,Kc)&&(hg=!0,Kc=!1,Xh.OutlineReader.exf(Vb)||(vi.OutlineNavigator.KNf(Vb,!1),ag.OutlineElementNavigator.Ge(Vb),pe.ParagraphReader.Qt(Vb.currentNode)&&(hg=!1,pe.ParagraphReader.textLength(Vb.currentNode)||(Kc=!0)),Kc||mh.returnToCell(Vb)),Kc?Vb=Gf.SelectionFactory.te(Vb.currentNode,0):(Vb=Gf.SelectionFactory.uq(Vb.currentNode),!hg&&hf.SelectionEditor.Fk(Vb.Qc)&&(hg=Vb.toArray(),Array.removeAt(hg,hg.length-1),Vb=new Eg.Selection(hg,Vb.Pf))),Ld.setSelection(Vb));break;case Pb.a.D9f:case Pb.a.dfe:ie===
Pb.a.dfe?vi.OutlineNavigator.BOi(Vb,!1):vi.OutlineNavigator.BOi(Vb,!0);Ld.setSelection(Gf.SelectionFactory.uq(Vb.currentNode));yc=32;break;case Pb.a.N8c:yc=w.AFrameworkApplication.va.Nf(ac,ie,yc,!0,Kc,ed);break;default:if(yc=w.AFrameworkApplication.va.Nf(ac,ie,yc,!0,Kc,ed),!Ce&&hg&&(ie===Pb.a.IG||ie===Pb.a.mO)){const Hl=hf.SelectionEditor.q7(Ld.hb.kb).y;Wa.App.Ngc(()=>{this.cdn(Ld,oe,Hl)})}}32===yc&&ac.view.qe&&this.Ug.kF();return yc};this.yla=b;this.ITe=k;this.Sm=t;this.I1=D;this.YY=P;this.LTe=ca;
this.jJa=ta;this.ld=Na;this.Hc=qb;this.eDe=Jb}get Ug(){return this.Jm||(this.Jm=this.yla())}Tb(){const b=w.AFrameworkApplication.va,k=this.VDo;b.fb(Pb.a.tab,lc.a.view,k,1124);b.fb(Pb.a.ycg,lc.a.view,k,1124);b.qa(Pb.a.Hqi,lc.a.view,Xc.ActionManager.Of)}cdn(b,k,t){if(b&&k){var D=b.hb.kb;hf.SelectionEditor.q7(D).y<t?(k=hf.SelectionEditor.HLc(k,D,!1),k=hf.SelectionEditor.lva(k,{JA:!1,us:!1,BC:!1,jE:!0})):k=hf.SelectionEditor.ILc(k,D,!1);b.setSelection(k)}}apk(){return Pb.a.p2a}eri(){}ZYc(b,k,t){if(b&&
k){var D=b.hb.kb;hf.SelectionEditor.q7(D).y<t?(k=hf.SelectionEditor.HLc(k,D,!1),k=hf.SelectionEditor.lva(k,{JA:!1,us:!1,BC:!1,jE:!0})):k=hf.SelectionEditor.lva(D,{JA:!1,us:!1,BC:!1,jE:!0});b.setSelection(k)}}static get Vf(){return Yj.a.instance}static get Wg(){return li.ContextSetEditor.instance}}Object(n.a)(CF,"TabActor",null,[]);class rH{constructor(b){this.quc=b}get fq(){return this.quc}wFn(b){return b}kjm(b,k,t,D){const P=D.view,ca=P.mb.hb.kb;if(yh.TableCellReader.Doa(b))return this.$wi(b,D)?
Pb.a.IG:Pb.a.R4d;ag.OutlineElementNavigator.Vd(b);if(hf.SelectionEditor.gf(k))va.OutlineElementReader.wA(b,k,!1)&&this.ypj(b)?t=Pb.a.ILb:hf.SelectionEditor.xVc(P,ca)&&this.fq.bAb(b)?t=Pb.a.IG:hf.SelectionEditor.xVc(P,ca)&&(t=Pb.a.IG);else if(hf.SelectionEditor.ml(k)){if(!this.fq.bAb(b))return t;hf.SelectionEditor.ujb(k)?t=Pb.a.IG:hf.SelectionEditor.TBi(k)&&(t=this.ypj(b)?Pb.a.ILb:Pb.a.IG)}else this.fq.bAb(b)&&(t=Pb.a.IG);return t}jjm(b,k,t,D){if(yh.TableCellReader.Y_(b))return this.$wi(b,D)?Pb.a.mO:
t;ag.OutlineElementNavigator.Vd(b);if(hf.SelectionEditor.gf(k))va.OutlineElementReader.wA(b,k,!1)&&(!dg.ListItemReader.sh(b)&&va.OutlineElementReader.isEmpty(b,!1)?t=Xc.ActionManager.kxa:this.apo(b)?t=Pb.a.zfb:this.Ioj(b)?t=Pb.a.OBb:this.fq.S1b(b)&&(t=Pb.a.mO));else if(hf.SelectionEditor.ml(k)){if(!this.fq.S1b(b))return t;hf.SelectionEditor.ujb(k)?t=Pb.a.mO:hf.SelectionEditor.TBi(k)&&(t=this.Ioj(b)?Pb.a.OBb:Pb.a.mO)}else this.fq.S1b(b)&&(t=Pb.a.mO);return t}ypj(b){return dg.ListItemReader.sh(b)?!1:
0<va.OutlineElementReader.O3(b)?!0:!1}Ioj(b){if(dg.ListItemReader.sh(b))return!1;const k=va.OutlineElementReader.O3(b);b=Xh.OutlineReader.rX(b.currentNode);return k<b?!0:!1}apo(b){return dg.ListItemReader.sh(b)?!1:0<va.OutlineElementReader.vG(b)?!0:!1}static Jr(){return new rH(ks.a.BEb)}$wi(b,k){if(this.GOm){k=k.view;const t=k.mb.hb.kb,D=new ze.GraphIterator;D.Yc(b);ag.OutlineElementNavigator.Vd(D);if(dg.ListItemReader.sh(D)&&hf.SelectionEditor.xVc(k,t))return!0}return!1}get GOm(){var b;w.AFrameworkApplication.ue("egdi3422;7g6fa693");
return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}Object(n.a)(rH,"TabActorPromoteDemoteStrategy",null,[560]);class aE extends CF{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc){super(b,k,t,D,P,ca,ta,Na,qb,Jb);this.o7d=(Kc,ed)=>{Kc=ed.property;!this.n4c||Kc!==Cc.a.Ao&&Kc!==Cc.a.marginLeft&&Kc!==Cc.a.marginRight||this.n4c.Usi()};this.rX=(Kc,ed,sd,oe,Ld)=>{Kc=Xh.OutlineReader.rX(this.H5l(ed));Ld.defaultTabStop=
Kc;return 32};this.$Wb=Vb;this.ga=yc;this.wF();this.ga.qa(Nc.a.rX,lc.a.view,this.rX)}get n4c(){return null!=this.EFg?this.EFg:this.EFg=Fa.a.instance.Na("WordEditor.Actors.RenderParagraphsContainingTabs")}wF(){this.$Wb.Bl.Ze(10).Fo(this.o7d)}eri(b){const k=b.view,t=k.mb;b=t.sg;if(this.jJa&&this.Hc){var D=this.Hc.Mc(15);D.Cb(b.node);b.contextId===lc.a.Hd&&w.AFrameworkApplication.va.processAction(Pb.a.zH,2);this.jJa.BWd(t.sg);D.dispose();var P=hf.SelectionEditor.q7(t.hb.kb).y;Wa.App.Ngc(()=>{this.ZYc(t,
k,P)})}}H5l(b){return b.view.mb.hb.kb.Qa.node}static get instance(){return null!=aE.rCg?aE.rCg:aE.rCg=aE.Rl()}static Rl(){return new aE(()=>Fa.a.instance.resolve("Box4.IUndoManager"),rH.Jr(),Fa.a.instance.Sa("Box4.IExternalSelectionManager"),Fa.a.instance.resolve("Box4.IAutoCorrectRules"),Fa.a.instance.resolve("Box4.IAutoCorrectScheduler"),Fa.a.instance.Na("Box4.ITabPresenterFactory"),Fa.a.instance.Na("Box4.IBlobEditor"),Fa.a.instance.Na("Box4.IFeatureHelper"),Fa.a.instance.Na("Box4.Graph.GraphTransactionFactory"),
Fa.a.instance.Na("Box4.Actors.IIFrameFocusStrategy"),Wa.App.Lj,Fa.a.instance.Na("Box4.ITabRenderer"),w.AFrameworkApplication.va)}}Object(n.a)(aE,"TabActor",CF,[]);class Gx{static get it(){return null!=Gx.Kvg?Gx.Kvg:Gx.Kvg=Fa.a.instance.resolve("Box4.IAppFrame")}static initialize(){qr.a.kbc=Gx.DPm;qr.a.Ike=Gx.l2o}static DPm(b){return!Ih.TableReader.zKm(b)}static Nlb(){Gx.it.Zgc(Gx.Nlb);Gx.Kvb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&
0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static l2o(b){var k,t,D;b&&((null===(k=Dt.a.instance.kb)||void 0===k?0:k.FFa)||(null===(t=Dt.a.instance.kb)||void 0===t?0:t.kw)||(null===(D=Dt.a.instance.kb)||void 0===D?0:D.SHb))&&!Gx.Kvb&&(Gx.it.UYa(Gx.Nlb),Gx.Kvb=!0)}}Gx.Kvb=!1;Object(n.a)(Gx,"TableActor",null,[]);var cN=c(910);class sH{tCl(b,k,t,D){return b?this.UAl(k,t,D):this.uCl(k,t,D)}PZh(b,k,t,D,P){return b?this.XBl(k,t,D,P):this.KBl(k,t,D,P)}HBl(b){let k=
!1;var t=b.Pf?b.Me.Qc:b.Me.Qa;b=new ze.GraphIterator;b.set(t.node);b.zb(14);t=null;yh.TableCellReader.Sba(b)?yh.TableCellReader.fHb(b)||(k=!0,t=mh.moveToNextRow(b)):t=mh.moveToNextColumn(b);return{returnValue:t,udn:k}}SBl(b){var k=b.Pf?b.Me.Qc:b.Me.Qa;const t=new ze.GraphIterator;t.set(k.node);t.zb(14);k=null;yh.TableCellReader.eha(t)?yh.TableCellReader.dha(t)||(k=new ze.GraphIterator,k.set(b.ACa.node),k.zb(14),b=fn.a.rs(k),fn.a.rs(t)>b?(mh.moveToPreviousRow(t),mh.moveToLastColumn(t),k=t.currentNode):
k=mh.moveToPreviousRow(t)):k=mh.moveToPreviousColumn(t);return k}c_h(b,k){var t=b.Pf?b.Me.Qc:b.Me.Qa;b=new ze.GraphIterator;b.set(t.node);b.zb(14);t=null;k?yh.TableCellReader.dha(b)||(t=mh.moveToPreviousRow(b)):yh.TableCellReader.fHb(b)||(t=mh.moveToNextRow(b));return t}fIb(b,k,t){for(;yh.TableCellReader.gg(b);)if(k){if(t&&b.wwa(1)||!t&&b.Dwa(1))return null;t?mh.moveToPreviousColumn(b):mh.moveToNextColumn(b)}else{if(yh.TableCellReader.n4(b.currentNode)){const D=new ze.GraphIterator;D.Yc(b);if(this.fIb(D,
!0,!0)||this.fIb(D,!0,!1)){b.Yc(D);break}}else{if(!t&&mh.moveToControllingCell(b,2))break;if(t&&mh.moveToControllingCell(b))break}if(t&&yh.TableCellReader.dha(b)||!t&&yh.TableCellReader.fHb(b))return null;t?mh.moveToPreviousRow(b):mh.moveToNextRow(b)}return b.currentNode}e6b(b,k){if(!fn.a.isTableRow(b))return null;b=ze.GraphIterator.$a(b.currentNode);b.zb(14);let t;const D=Ih.TableReader.AB(b.origin);do t=k?mh.moveToPreviousRow(b):mh.moveToNextRow(b);while(D&&t&&fn.a.YPa(b));return t}nlb(b,k,t,D,
P){let ca=null;ag.OutlineElementNavigator.Vd(b);const ta=va.OutlineElementReader.isRtl(b.currentNode);if(t)if(mh.returnToCell(b),k=yh.TableCellReader.Sba(b),t=yh.TableCellReader.eha(b),P||!ta&&t||ta&&D&&k)mh.returnToContainingRow(b),(D=this.e6b(b,!0))?ca=Gf.SelectionFactory.fo(D,!k):P&&(ag.OutlineElementNavigator.Vd(b),P=new Vk.a,P.Yc(b),(b=ag.OutlineElementNavigator.p0(P,!1,!1))&&(ca=Gf.SelectionFactory.fo(b,!1)));else{do ta?mh.moveToNextColumn(b):mh.moveToPreviousColumn(b);while(yh.TableCellReader.gg(b)&&
!yh.TableCellReader.dha(b));yh.TableCellReader.gg(b)||(ca=Gf.SelectionFactory.fo(b.currentNode,!ta))}else va.OutlineElementReader.wA(b,k,ta)||hf.SelectionEditor.gf(k)||mh.returnToCell(b),ca=Gf.SelectionFactory.fo(b.currentNode,!ta);return ca}mlb(b,k,t,D,P){let ca=null;ag.OutlineElementNavigator.Vd(b);const ta=va.OutlineElementReader.isRtl(b.currentNode);if(t)if(mh.returnToCell(b),t=yh.TableCellReader.Sba(b),k=yh.TableCellReader.eha(b),P||!ta&&D&&t||ta&&!D&&k)mh.returnToContainingRow(b),(D=this.e6b(b,
!1))?ca=Gf.SelectionFactory.fo(D,k):(ag.OutlineElementNavigator.Vd(b),D=new Vk.a,D.Yc(b),(b=ag.OutlineElementNavigator.Ur(D,!1,!1))&&(ca=Gf.SelectionFactory.fo(b,!0)));else{do ta?mh.moveToPreviousColumn(b):mh.moveToNextColumn(b);while(yh.TableCellReader.gg(b)&&!yh.TableCellReader.Sba(b));yh.TableCellReader.gg(b)||(ca=Gf.SelectionFactory.fo(b.currentNode,ta))}else va.OutlineElementReader.wA(b,k,!ta)||hf.SelectionEditor.gf(k)||mh.returnToCell(b),ca=Gf.SelectionFactory.fo(b.currentNode,ta);return ca}}
Object(n.a)(sH,"ATableCellSelectionStrategy",null,[1382]);class NK extends sH{constructor(){super()}KBl(b,k,t,D){let P=b.kb,ca=null;if(b.kw)if(k)if(2===P.Me.Lha&&!P.Pf&&P.Me.Qc.equals(P.ACa))P=Gf.SelectionFactory.rMh(P.ACa.node,!1);else{var ta=({udn:b}=this.HBl(P)).returnValue;ta&&(yh.TableCellReader.Qr(ta)&&(ta=ze.GraphIterator.$a(ta),ta.zb(14),ta=!b&&this.fIb(ta,!0,!1)?ta.currentNode:b||mh.moveToNextRow(ta)?this.fIb(ta,!1,!1):null),ta&&(ca=Gf.SelectionFactory.ho(u.TableNodeContext.create(ta),P.Pf)))}else P=
b.ida,b=ze.GraphIterator.$a(P.Me.Qc.node),b.zb(14),yh.TableCellReader.pFa(b.currentNode)&&mh.moveToLastGhostCell(b,2),(ta=mh.moveToNextColumn(b))?(b=yh.TableCellReader.n4(ta),yh.TableCellReader.Qr(ta)&&!b&&(ta=ze.GraphIterator.$a(ta),ta.zb(14),ta=mh.moveToControllingCell(ta)),b?P=Gf.SelectionFactory.fo(P.Me.Qc.node,!1):ca=Gf.SelectionFactory.fo(ta,!0)):(ta=P.Me.Qc.node,ca=Gf.SelectionFactory.fo(ta,!1));else b=k&&P.Pf||!k&&!P.Qwa?P.Me.Qc:P.Me.Qa,fn.a.Eoa(b.node)&&(b=ze.GraphIterator.$a(b.node),(ta=
this.e6b(b,!1))?ca=k?Gf.SelectionFactory.ho(u.TableNodeContext.create(ta),P.Pf):Gf.SelectionFactory.fo(ta,!0):P=hf.SelectionEditor.Cj(Gf.SelectionFactory.uq(b.currentNode),!1,!0));return ca?ca:D?hf.SelectionEditor.d6b(P,!1,k,!0):hf.SelectionEditor.lva(P,{JA:!k,us:k,BC:t,jE:!0})}XBl(b,k,t,D){let P=b.kb;var ca=null;if(b.kw)k?1===P.Me.Lha&&P.Pf&&P.Me.Qa.equals(P.ACa)||(ca=this.SBl(P),(ca=this.NZh(P,ca))||P.Pf&&(P=P.aMc())):(P=b.ida,ca=Gf.SelectionFactory.fo(P.Me.Qa.node,!0));else if(k){var ta=(P.Pf?
P.Me.Qc:P.Me.Qa).node;b=ze.GraphIterator.$a(ta);hf.SelectionEditor.ku(b);fn.a.Eoa(ta)&&(P.Pf&&1===P.Me.Lha&&P.Qwa?(ca=fn.a.rB(ta).toArray(),(ca=this.NZh(P,0<=ca.length-2?ca[ca.length-2]:null))||P.Pf&&(P=P.aMc())):(ta=this.e6b(b,!0))?ca=Gf.SelectionFactory.ho(u.TableNodeContext.create(ta),P.Pf):P=Gf.SelectionFactory.fo(b.currentNode,!0))}else ca=hf.SelectionEditor.Cj(P,!0,!1);return ca?ca:D?hf.SelectionEditor.d6b(P,!0,k,!0):hf.SelectionEditor.VDa(P,{JA:!k,us:k,BC:t,jE:!0})}NZh(b,k){if(!k)return null;
var t=k;yh.TableCellReader.Qr(k)&&(t=ze.GraphIterator.$a(k),t.zb(14),t=this.fIb(t,!0,!0)?t.currentNode:yh.TableCellReader.iga(k));return t?Gf.SelectionFactory.ho(u.TableNodeContext.create(t),b.Pf):null}uCl(b,k,t){let D=k.kb,P=null;if(k.kw){var ca=k.dX>k.WHa;if(t)if(2===k.length&&1===k.ida.Me.Lha&&ca)D=hf.SelectionEditor.Cj(D,!0,!1);else{if(k=this.c_h(D,!0))yh.TableCellReader.Qr(k)&&(k=ze.GraphIterator.$a(k),k.zb(14),k=this.fIb(k,!1,!0)),k&&(P=Gf.SelectionFactory.ho(u.TableNodeContext.create(k),D.Pf));
P||D.Pf&&(D=D.aMc())}else ca&&(D=k.ida)}else k=t&&D.Pf?D.Me.Qc:D.Me.Qa,fn.a.Eoa(k.node)&&(k=ze.GraphIterator.$a(k.node),(ca=this.e6b(k,!0))?P=t?Gf.SelectionFactory.ho(u.TableNodeContext.create(ca),D.Pf):Gf.SelectionFactory.fo(ca,!0):t&&(D=Gf.SelectionFactory.fo(k.currentNode,!0)));return P?P:hf.SelectionEditor.dfb(b,D,!1,t,t)}UAl(b,k,t){let D=k.kb,P=null;if(k.kw){const ca=k.dX<k.WHa;if(t)if(2===k.length&&1===k.ida.Me.Lha&&ca)D=hf.SelectionEditor.Cj(D,!1,!1);else{if(k=this.c_h(D,!1))yh.TableCellReader.Qr(k)&&
(k=ze.GraphIterator.$a(k),k.zb(14),k=this.fIb(k,!1,!1)),k&&(P=Gf.SelectionFactory.ho(u.TableNodeContext.create(k),D.Pf))}else ca&&(D=k.ida)}else k=!t||D.Pf?D.Me.Qc:D.Me.Qa,fn.a.Eoa(k.node)&&(k=ze.GraphIterator.$a(k.node),(k=this.e6b(k,!1))&&(P=t?Gf.SelectionFactory.ho(u.TableNodeContext.create(k),D.Pf):Gf.SelectionFactory.fo(k,D.Qwa)));return P?P:hf.SelectionEditor.dfb(b,D,!0,t,t)}}Object(n.a)(NK,"TableCellSelectionStrategy",sH,[]);class OK{constructor(b){this.oL=(k,t,D,P,ca)=>{if(1===D)return 32;
k=(new pp.a).create();t="";switch(ca.DialogType){case "DirectPrintPreparingPDF":t=CommonUIStrings.l_DirectPrintPreparingPDF;ca=CommonUIStrings.l_DefaultDialogTitle;break;default:ca=CommonUIStrings.l_DefaultDialogTitle}k.message=t;k.oL(ca,null,null);return 32};this.ga=b}Tb(){this.ga.fb(Pb.a.oL,lc.a.view,this.oL,1028)}}Object(n.a)(OK,"UIAutomationActor",null,[]);class PK{constructor(b,k,t,D){this.eb=b;this.jJa=k;this.Yoc=t;this.p6=D}Dkg(b,k,t){return this.Yoc.vNm(k)?t?!0:b&&this.eb.uh(b)?(b=this.fw(b.currentNode),
this.jJa.qri(b),!0):!1:!1}xwf(b,k){return this.Yoc.Bvl(b,k)}Ewf(b){b&&this.eb.uh(b)&&(b=this.fw(b.currentNode),this.jJa.BWd(b))}fw(b){return Of.a.fw(b)}zHa(b,k,t){this.p6.A_i&&this.Yoc.Ivi(t)&&(this.p6.zHa(b,k),b.setValue(vd.a.Zvi,!0))}Cge(){}wYd(b){return this.Yoc.wYd(b)}get EZd(){return this.Yoc.EZd}dD(){}Wca(){}Vge(){}get Wpj(){return!1}}Object(n.a)(PK,"WordEditorPasteStewardBridge",null,[515]);class QK{constructor(b){this.ra=new Ue.a;this.qfj="WordFileSaveAsButtonClicked";this.n2o=()=>{this.ra.raiseEvent(this.qfj,
null);return 32};this.ga=b}Tb(){w.AFrameworkApplication.K.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.qa(Nc.a.nKj,Ud.a.frame,this.n2o)}vxk(b){this.ra.addHandler(this.qfj,b)}}Object(n.a)(QK,"WordFileSaveAsActor",null,[]);class RK extends pz{constructor(){super()}iEc(b,k,t,D,P,ca,ta){return Er.a.Dfc(k,t,D,P,ca,ta)}}Object(n.a)(RK,"WordIndentationActorExtension",pz,[]);class tH{constructor(){this.smd=null}get name(){return"WordEditor.Actors"}init(){var b;Lb.InteractiveViewManager.instance.editingView.p4b=
!0;w.AFrameworkApplication.va.qa(Nc.a.k1o,Ud.a.frame,IM);this.W.resolve("WordEditor.Actors.DeleteActor").Tb(w.AFrameworkApplication.va);UD.instance.Tb();$m.Tb();zq.Tb(w.AFrameworkApplication.va,this.W.resolve("WordEditor.IMainViewModeManager"));fk.Tb();aE.instance.Tb();cN.a.Tb();this.W.resolve("WordEditor.Actors.ModeSwitcherControlActor").Tb(w.AFrameworkApplication.va);this.W.resolve("WordEditor.Actors.ExternalContentActor").Tb();this.W.resolve("WordEditor.OnlineMedia.OnlineMediaActor").Tb();w.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&
this.W.resolve("Box4.Actors.FormatPainterActor").Tb();w.AFrameworkApplication.K.$("WordEditorAutoSaveImprovementIsEnabled")&&this.W.resolve("WordEditor.Actors.SaveStatusActor").Tb();w.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&w.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&(this.gW.OZd=!0);w.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.W.resolve("WordEditor.Actors.ModernUxActor").Tb();
w.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").Tb();this.W.resolve("WordEditor.Actors.AppFrameCommandUIActor").Tb();this.W.resolve("Common.IOfficeTrialExperience").Tb();this.W.resolve("Common.IMacOfficeOffer").Tb();this.W.resolve("WordEditor.Actors.MarginsDialogActor").Tb();this.W.resolve("WordEditor.Actors.PaperSizeDialogActor").Tb();this.W.resolve("WordEditor.Actors.ColumnsDialogActor").Tb();this.W.resolve("WordEditor.Actors.FileDownloadActor").Tb();
this.W.resolve("WordEditor.Actors.StylesActor").Tb();(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&this.W.resolve("WordEditor.Actors.CustomizeRibbonActor").Tb();this.W.resolve("WordEditor.Actors.ParagraphDialogActor").Tb();this.W.resolve("WordEditor.Actors.ProofingActor").Tb();this.W.resolve("WordEditor.Actors.PageActor").Tb();this.W.resolve("WordEditor.Actors.DarkModeActor").Tb();this.W.resolve("WordEditor.Actors.ImageActor").Tb(w.AFrameworkApplication.va);
this.W.resolve("WordEditor.Actors.FormattingActor").Tb();this.W.resolve("WordEditor.Actors.UIAutomationActor").Tb();this.W.resolve("WordEditor.Actors.ContentControlActor").Tb();this.W.resolve("WordEditor.Actors.CustomTabActor").Tb();this.W.resolve("WordEditor.Actors.BookmarkActor").Tb();this.W.resolve("WordEditor.Actors.HeadingsActor").Tb();this.W.resolve("Box4.Indicator.IIndicatorManager").u5a(this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"));this.W.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").Tb();
this.W.resolve("WordEditor.Actors.AccessibilityActor").V3f();this.W.resolve("WordEditor.Actors.ISWordRequestManager");this.W.resolve("Box4.Actors.AutoCorrectActor").Tb();this.W.resolve("WordEditor.Actors.DigitalPrintActor").Tb();this.W.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");this.W.resolve("Box4.Actors.VisiMarkersActor").Tb();this.W.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.W.resolve("WordEditor.Actors.ActionHangDetector").AY();this.W.resolve("WordEditor.Actors.WordFileSaveAsActor").Tb();
w.AFrameworkApplication.K.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?this.fSn():this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb();this.RV.t5a(this.EWj);b=this.W.resolve("WordEditor.Bookmark.FullBookmarkManager");w.AFrameworkApplication.ue("bookmarks-core-ex;bookmarks-core-ex-cf");w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.bom()&&Wa.App.ya.gb.CVh();w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",
!1)&&this.W.resolve("WordEditor.Actors.MiniTemplateActor").Tb();Wa.App.ya.updateCommandUI();Gx.initialize()}dispose(){}fSn(){this.ld.Mp.isCompleted?this.ld&&this.ld.isFeatureEnabled(49)&&this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb():this.ld.Mp.continueWith(()=>{this.ld&&this.ld.isFeatureEnabled(49)&&(this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb(),Wa.App.ya.updateCommandUI())})}get PNm(){if(null==this.smd)if(this.ld)if(this.ld.Mp.isCompleted)this.smd=this.ld.isFeatureEnabled(3);
else return!1;else this.smd=!1;return this.smd}xc(b){var k,t;this.W=b;this.ld=b.Na("Box4.IFeatureHelper");this.gW=this.W.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.gW.fVc=w.AFrameworkApplication.K.$("WordProofingSecondaryContextualMenuIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new lJ).xc(b);b.ha("Box4.IClipboardCommands",()=>new mJ(w.AFrameworkApplication.va,Pb.a.g4e,Pb.a.YEc,Pb.a.b_,Pb.a.nYf,
Pb.a.paste,Pb.a.k9,Pb.a.Mmb)).singleInstance();b.ha("HtmlImport.IHtmlNormalizerSettings",()=>{const D=b.resolve("Common.IAppSettingsManager");return new hA(!0,D.$("SplitHyperlinkFixWithEnterIsEnabled"))}).singleInstance();b.ha("HtmlImport.IHtmlTranslatorSettings",()=>{const D=b.resolve("Common.IAppSettingsManager"),P=ca=>!ca.T$b;return new fz(D.$("ExternalPasteImprovementsEnabled"),D.$("PasteComplexTablesIsEnabled"),!0,!0,!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,D.$("SupportCloudFontInExternalPasteIsEnabled"),
!0,!0,!0,!0,!0,ca=>ca.T$b,()=>!1,P,P,P,P,void 0,()=>this.PNm,ca=>!ca.T$b)}).singleInstance();b.ha("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new PK(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),b.resolve("Box4.Actors.IBox4PasteStewardUtils"),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").singleInstance();b.ha("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new CK(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),
b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").singleInstance();b.ha("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new nJ).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").singleInstance();b.ha("Box4.IIndentationCommands",()=>new oJ(w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.IJustificationCommands",()=>new pJ(w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.ISpacingCommands",()=>new qJ(w.AFrameworkApplication.va)).singleInstance();
b.ha("WordEditor.IPageCommands",()=>new yK(w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.Actors.StylesActor",()=>new KK(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"))).singleInstance();(null===(k=w.AFrameworkApplication.K)||void 0===k?0:k.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&b.ha("WordEditor.Actors.CustomizeRibbonActor",()=>new AF(w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.Actors.DigitalPrintActor",
()=>new jH(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"))).singleInstance();b.ha("WordEditor.Actors.FileDownloadManager",()=>new eK(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),new zM.a)).singleInstance();b.ha("WordEditor.Actors.FileDownloadActor",()=>new bK(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),w.AFrameworkApplication.K.$("DisablePrint"),w.AFrameworkApplication.K.jb("IrmPolicyDescription"),b.resolve("WordEditor.IBusinessBarController"))).singleInstance();
b.ha("WordEditor.Actors.ParagraphDialogActor",()=>new AK(w.AFrameworkApplication.va,b.Ue("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),xn.a.instance,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ClientPagination.IClientPaginationSettings"))).singleInstance();b.ha("WordEditor.Actors.MarginsDialogActor",()=>new vK(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),xn.a.instance)).singleInstance();b.ha("WordEditor.Actors.ColumnsDialogActor",
()=>new VJ(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),xn.a.instance)).singleInstance();b.ha("WordEditor.Actors.ModeSwitcherControlActor",()=>new iE.a(b.Sa("Common.ISystemInitiatedFeedback"),BM.a.FNc())).as("WordEditor.IModeSwitcherControl").singleInstance();b.ha("WordEditor.Actors.PaperSizeDialogActor",()=>new zK(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),xn.a.instance)).singleInstance();b.ha("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new pK(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).singleInstance();
b.register($J,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").singleInstance();b.ha("WordEditor.Actors.ProofingActor",()=>new DK(w.AFrameworkApplication.va,Yj.a.instance,Fa.a.instance.resolve("Box4.ISelectionManager"),Xr.a.instance,Fa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),Fa.a.instance.resolve("Box4.ILanguageReader"),Fa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Fa.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),Fa.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),
this.gW,Fa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),w.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),Fa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").Kz.loadScript("EditorSettingsManager")).then(()=>{const D=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");D.zvm();
D.init();b.ha("Box4.Proofing.EditorSettingsUIActor",()=>new rJ(w.AFrameworkApplication.va,b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new sJ(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).singleInstance();w.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&w.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Proofing.EditorSettingsUIActor").Tb()});b.ha("WordEditor.Actors.PageActor",
()=>new xK(Fa.a.instance.resolve("Box4.IWordSectionEditor"),Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Fa.a.instance.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.IPageCommandStringBuilder").singleInstance();b.ha("WordEditor.Actors.DarkModeActor",()=>new YJ(w.AFrameworkApplication.va,w.AFrameworkApplication.K,Wa.App.oda,!!Wa.App.instance&&Wa.App.instance.oFa,!!Wa.App.instance&&Wa.App.instance.BVc,Fa.a.instance.resolve("Box4.IDarkModeState"),Fa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
Fa.a.instance.resolve("Box4.DarkModeEventsManager"),!!Wa.App.instance&&Wa.App.instance.uoa)).singleInstance();b.ha("WordEditor.FlatListDetailsProvider",()=>new gK(b.resolve("WordEditor.IFlatListEditor")));b.ha("WordEditor.Actors.AccessibilityActor",()=>new DJ(b.Sa("Box4.Accessibility.IAccessibilityContextManager"),b.Ue("WordEditor.FlatListDetailsProvider"),b.Ue("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),b.Ue("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).singleInstance();
b.ha("WordEditor.Actors.AppFrameCommandUIActor",()=>new RJ(w.AFrameworkApplication.va,b.Sa("Postmessage.IHostPostmessenger"))).singleInstance();b.ha("WordEditor.Actors.ImageActor",()=>new Sq(b.resolve("WordEditor.IImageEditor"),b.Sa("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),
b.resolve("Box4.Images.ImageNavigator"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.IAppFrame"),w.AFrameworkApplication.K)).as("Box4.Actors.ImageActor").singleInstance();b.ha("WordEditor.Actors.WordFileSaveAsActor",()=>new QK(w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new HK(b.resolve("WordEditor.IImageEditor"),w.AFrameworkApplication.K,w.AFrameworkApplication.ta.IEa,Fa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.Actors.DeleteActor",()=>new ZJ.DeleteActor(Fa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Fa.a.instance.Sa("Box4.ContentControlConfigSettings"),Fa.a.instance.Sa("Box4.IContentControlEditor"),Fa.a.instance.resolve("Box4.IDynamicRangeEditor"),Fa.a.instance.Sa("WordEditor.Bookmark.IBookmarkManager"),
Fa.a.instance.resolve("Box4.IHyperlinkEditor"),Fa.a.instance.resolve("Box4.IHyperlinkStrategy"),Fa.a.instance.resolve("Box4.IParagraphReader"),Fa.a.instance.resolve("Box4.IParagraphIndentationReader"),Fa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Fa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Fa.a.instance.resolve("Box4.ContentControl.ContentControlViewElementManager"))).singleInstance();this.W.ha("WordEditor.Actors.SWordRequestManager",()=>new MK(b.resolve("Box4.Images.IImageReader"),
b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),w.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").singleInstance();b.ha("WordEditor.Actors.TableCellSelectionStrategy",()=>new NK).as("Box4.ITableCellSelectionStrategy").singleInstance();w.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&b.ha("Box4.Actors.FormatPainter",()=>new tJ(b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.IInsertionPointFormatting"),b.resolve("Box4.IFormattingEditor"),
b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.ICharacterPropertiesEditor"),Yj.a.instance,b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.IContentControlChpHelper"))).as("Box4.IFormatPainter").singleInstance();
b.ha("Box4.Actors.FormatPainterActor",()=>new VD(Wa.App.ya,ad.FocusManager.instance(),w.AFrameworkApplication.va,Hi.a.instance,Dt.a.instance,b.resolve("Box4.IFormatPainter"),b.resolve("Box4.ISelectionManager"),!0,b.resolve("Box4.ICssColorProvider"),!!Wa.App.instance&&Wa.App.instance.uoa,b.resolve("Box4.DarkModeEventsManager"))).singleInstance();b.ha("WordEditor.Actors.FormattingActor",()=>new hK(w.AFrameworkApplication.va,b.resolve("Box4.List.IListReader"))).singleInstance();b.ha("WordEditor.Actors.UIAutomationActor",
()=>new OK(w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.Actors.SaveStatusActor",()=>new JK(w.AFrameworkApplication.va,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).singleInstance();b.ha("Box4.Actors.IEnterViewStrategy",()=>new uJ(b.Na("Box4.IAutoCorrectScheduler"),b.Ue("Box4.IUndoManager"),b.Sa("Box4.IExternalSelectionManager"))).singleInstance();b.ha("Box4.ISelectAllHandlers",()=>new UC(Yg.PageReader.instance,b.Ue("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance();
b.ha("WordEditor.Actors.ContentControlActor",()=>new WJ(b.resolve("WordEditor.ContentControl.IContentControlManager"),b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Styles.IWACStyleReader"),w.AFrameworkApplication.va,
w.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),b.resolve("WordEditor.ContentControl.IContentControlFormattingManager"))).singleInstance();b.ha("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new EJ(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),ad.FocusManager.instance())).singleInstance();b.ha("Box4.Actors.FontNameFormattingStrategyNoop",()=>new vJ).as("Box4.Actors.IFontNameFormattingStrategy").singleInstance();b.ha("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",
()=>new lG(w.AFrameworkApplication.Ne,Wk.PageNavigator.instance,b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("WordEditor.IImageEditor"),Fa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),w.AFrameworkApplication.K,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").singleInstance();b.ha("WordEditor.Actors.GraphicsEditorActor",
()=>new mK(w.AFrameworkApplication.va,w.AFrameworkApplication.K,b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),b.resolve("WordEditor.IImageEditor"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),w.AFrameworkApplication.Ne,this.ld,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();
b.ha("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new IK).singleInstance();b.ha("WordEditor.Actors.CustomTabActor",()=>new XJ(w.AFrameworkApplication.va,b.resolve("WordEditor.ICustomTabStopUtility"),b.resolve("Box4.IOutlineEditor"))).singleInstance();b.ha("WordEditor.Actors.HeadingsActor",()=>new nK(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),w.AFrameworkApplication.va,b.resolve("Box4.IParagraphReader"))).singleInstance();b.ha("WordEditor.Actors.BookmarkActor",()=>
new UJ(Wa.App.ya,w.AFrameworkApplication.va,af.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),new Rg.a(()=>Wa.App.ya.gb.Uc),this.W.resolve("Box4.Indicator.IIndicatorManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),this.W.resolve("Common.IReactContextualUILauncher"),this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"),Xr.a.instance,this.W.Sa("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IOutlineElementNavigator"),Lb.InteractiveViewManager.instance,this.W.Ue("WordEditor.UI.IDialogFactory"),
this.W.resolve("Box4.BookmarkParagraphMapping"),Yj.a.instance)).singleInstance();b.ha("WordEditor.Actors.BookmarkIndicatorActor",()=>{var D,P;return new Os(b.resolve("Box4.IParagraphReader"),Kf.a.instance,Zh.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),b.resolve("Box4.IInteractiveEventHandler"),null!==(P=null===(D=Wa.App.instance)||void 0===D?void 0:D.RC)&&void 0!==P?P:!1,new Rg.a(()=>Wa.App.ya.gb.wc))}).singleInstance();b.ha("Box4.Actors.IIFrameFocusStrategy",()=>new oK).singleInstance();
b.ha("WordEditor.Actors.ExternalContentFloatiePositionProvider",()=>new ZD(af.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Lb.InteractiveViewManager.instance,$d.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).singleInstance();b.ha("WordEditor.Actors.ExternalContentActor",()=>new Qs(w.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),w.AFrameworkApplication.K,b.resolve("Wonca.ExternalContent.IExternalContentEditor"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).as("WordEditor.Actors.ExternalContentActor").singleInstance();b.ha("Box4.UI.ExternalContentFloatieManager",()=>new CJ).as("Box4.UI.IFloatieManager").singleInstance();b.ha("WordEditor.Actors.ActionHangDetector",()=>new FJ(w.AFrameworkApplication.K,w.AFrameworkApplication.va)).as("WordEditor.Actors.ActionHangDetector").singleInstance();b.ha("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new YD(b.resolve("Box4.UI.ExternalContentFloatieManager"),b.resolve("Box4.IExternalContentFloatieEventSource"),
Lb.InteractiveViewManager.instance,jw.a.instance(),w.AFrameworkApplication.ta,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Wa.App.Lj.Bl.Ze(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).singleInstance();b.ha("Box4.Actors.WordIndentationActorExtension",()=>new RK).as("Box4.Actors.IIndentationActorExtension").singleInstance();w.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&(w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordModernUxExperimentOneSettings"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&b.ha("WordEditor.Actors.ModernUxActor",()=>new oH(w.AFrameworkApplication.va)).singleInstance());
w.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ha("WordEditor.Actors.SwitchToClassicViewModeActor",()=>new wG(w.AFrameworkApplication.va)).singleInstance();(new iJ).xc(b);b.ha("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new BJ(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").singleInstance();b.ha("WordEditor.OnlineMedia.InsertHubbleMediaHelper",
()=>new yJ(w.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"))).singleInstance();b.ha("WordEditor.OnlineMedia.OnlineMediaActor",()=>new zJ(w.AFrameworkApplication.va,w.AFrameworkApplication.K,b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),b.resolve("Wonca.ExternalContent.IExternalContentEditor"),Yj.a.instance,w.AFrameworkApplication.K.$("GetCustomHeaderEnabled")?Fa.a.instance.resolve("Common.App.OAuth.IOAuthManager"):
void 0)).singleInstance();(null===(t=w.AFrameworkApplication.K)||void 0===t?0:t.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1))&&b.ha("WordEditor.Actors.MiniTemplateActor",()=>new wK(w.AFrameworkApplication.va,b.Sa("WordEditor.Extension.IInsertApiOperations"),b.Sa("WordEditor.Designer.Style.IParagraphDesigner"))).singleInstance();this.EWj=new wJ;this.RV=this.W.resolve("Box4.Highlight.IHighlightManager")}static main(){N.a.instance.Fc(new tH)}}Object(n.a)(tH,"WordEditorActorsPackage",
null,[1,2]);class SK{constructor(b){this.Uuc=!1;this.ITi=()=>{this.Uuc=!0;this.$r.hde(this.ITi)};this.$r=b;this.$r.bzb(this.ITi)}}Object(n.a)(SK,"GraphFullyConnectedGetter",null,[552]);class cg{constructor(){this.p4g=Object.assign(new up.a,{})}Iqk(b,k){let t;const D=b&1023;({value:t}=this.p4g.Dc(D,0)).returnValue||cg.yim().contains(D)||v.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,D);t+=k;this.p4g.Z(D,t);return t}static yim(){cg.qvd||(cg.qvd=new Ca.a,cg.qc(0),
cg.qc(1),cg.qc(2),cg.qc(3),cg.qc(4),cg.qc(5),cg.qc(6),cg.qc(7),cg.qc(8),cg.qc(9),cg.qc(10),cg.qc(11),cg.qc(12),cg.qc(13),cg.qc(14),cg.qc(15),cg.qc(16),cg.qc(17),cg.qc(18),cg.qc(19),cg.qc(20),cg.qc(21),cg.qc(22),cg.qc(23),cg.qc(24),cg.qc(25),cg.qc(26),cg.qc(27),cg.qc(28),cg.qc(29),cg.qc(30),cg.qc(31),cg.qc(32),cg.qc(33),cg.qc(34),cg.qc(35),cg.qc(36),cg.qc(37),cg.qc(38),cg.qc(39),cg.qc(40),cg.qc(41),cg.qc(42),cg.qc(43),cg.qc(44),cg.qc(45),cg.qc(46),cg.qc(47),cg.qc(48),cg.qc(49),cg.qc(50),cg.qc(51),
cg.qc(52),cg.qc(53),cg.qc(54),cg.qc(55),cg.qc(56),cg.qc(57),cg.qc(58),cg.qc(59),cg.qc(60),cg.qc(61),cg.qc(62),cg.qc(63),cg.qc(64),cg.qc(65),cg.qc(66),cg.qc(67),cg.qc(68),cg.qc(69),cg.qc(70),cg.qc(71),cg.qc(72),cg.qc(73),cg.qc(74),cg.qc(75),cg.qc(76),cg.qc(77),cg.qc(78),cg.qc(79),cg.qc(80),cg.qc(81),cg.qc(82),cg.qc(83),cg.qc(84),cg.qc(85),cg.qc(86),cg.qc(87),cg.qc(88),cg.qc(89),cg.qc(90),cg.qc(91),cg.qc(92),cg.qc(93),cg.qc(94),cg.qc(95),cg.qc(96),cg.qc(97),cg.qc(98),cg.qc(99),cg.qc(100),cg.qc(101),
cg.qc(102),cg.qc(103),cg.qc(104),cg.qc(105),cg.qc(106),cg.qc(107),cg.qc(108),cg.qc(109),cg.qc(110),cg.qc(111),cg.qc(112),cg.qc(113),cg.qc(114),cg.qc(115),cg.qc(116),cg.qc(117),cg.qc(118),cg.qc(119),cg.qc(120),cg.qc(121),cg.qc(122),cg.qc(124),cg.qc(126),cg.qc(127),cg.qc(128),cg.qc(129),cg.qc(130),cg.qc(131),cg.qc(132),cg.qc(133),cg.qc(134),cg.qc(135),cg.qc(136),cg.qc(140),cg.qc(145),cg.qc(146),cg.qc(147));return cg.qvd}static qc(b){cg.qvd.add(b&1023)}}cg.qvd=null;Object(n.a)(cg,"LanguagePerParagraphModel",
null,[]);class TK{constructor(){this.Idg=!1;this.dDd=this.cDd=this.jRb=0;this.uCi=!0;this.O4o=0}}Object(n.a)(TK,"UpdateWordCountStateResult",null,[]);class UK extends Sys.EventArgs{constructor(b){super();this.isEnabled=b}}Object(n.a)(UK,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class VK{constructor(){this.UBh=this.TBh=this.wordCount=-1;this.jCb=this.xxh=0;this.iCb=1;this.TZi=1033}}Object(n.a)(VK,"WordCountCache",null,[]);class WK extends Sys.EventArgs{constructor(b){super();this.state=
b}}Object(n.a)(WK,"WordCountChangedEventArg",Sys.EventArgs,[]);class XK{constructor(){this.Wmc=this.JCa=0}}Object(n.a)(XK,"CharsCountResult",null,[]);class YK{constructor(){this.cp=0;this.Ymc=null;this.v7=this.w7=0}}Object(n.a)(YK,"TextChunkResult",null,[]);class ZK{constructor(){this.bKj=this.w7=this.v7=this.wordCount=0}}Object(n.a)(ZK,"WordCountStateForParagraph",null,[]);class uH{constructor(){this.Bqa=this.UQ=this.w7=this.v7=this.A0=this.wordCount=0;this.currentNode=null;this.dX=-1;this.cp=0;
this.FYf=[];this.iCb=this.jCb=this.pZa=this.AYf=this.BYf=0;this.fI=this.Gwi=!1;this.Cqb=new Eb.a;this.y3a=new Eb.a}}Object(n.a)(uH,"WordCountState",null,[]);class Tq{constructor(b,k,t,D,P,ca){this.Hzo=1E3;this.ra=new Ue.a;this.Ayb=null;this.Bre=0;this.A2j="\ue000";this.Krc=!1;this.Swe=this.Hwe=this.Kgd=0;this.sQg=this.AQg=null;this.Dwe=this.Cwe=this.Mwe=0;this.Pol=ta=>{this.Ayb=null;this.tff(ta.customData)};this.LF=k;this.Q0j=new RegExp(Un.AParagraphNode.yC,"g");this.Gd=b;this.taskManager=D;this.An=
t;this.GYa=ca;this.gWa=P.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.nhk=P.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.Ccj()}get HTm(){return!!this.Ayb}get VNa(){return this.Krc}set VNa(b){this.Krc=b}get zyd(){return this.Bre}set zyd(b){this.Bre=b}get zQa(){return!this.Bre}get iy(){return this.Kgd}get sBb(){return this.Hwe}get wBb(){return this.Swe}get hfl(){return this.AQg}get Pbf(){return this.sQg}get wIc(){return this.Mwe}get uIc(){return this.Cwe}get T3b(){return this.Dwe}bzb(b){this.ra.addHandler(Tq.Ooe,
b)}hde(b){this.ra.removeHandler(Tq.Ooe,b)}r_e(b){this.ra.addHandler(Tq.Wog,b)}O_n(b){this.ra.removeHandler(Tq.Wog,b)}hId(){this.gId();this.Ccj()}Ccj(){this.Mwe=this.Dwe=this.Cwe=this.Swe=this.Hwe=this.Kgd=-1}Ycf(){this.Bje(this.Hzo)}a9c(){const b=new uH;b.Gwi=!0;this.gId();this.tff(b)}Bje(b,k=null){this.zQa&&(this.HTm&&(k=null,this.gId()),k||(k=new uH),b=new Df.a(3,1,b,this.Pol,this.Ywj),b.customData=k,this.bvk(b))}gId(){this.Ayb&&(this.taskManager.Ve(this.Ayb),this.Ayb=null)}eHj(b,k,t,D,P,ca=!0,
ta=-1,Na=-1,qb=-1,Jb=1033){const Vb=new TK;Vb.jRb=t;Vb.cDd=P;Vb.dDd=D;if(!b.cp&&k.Tbd&&ca&&!this.yei(k))return Tq.BXo(b,k.Tbd),Vb.uCi=!0,Vb;D=0<=Na&&0<=qb?{xd:Na,endCp:qb}:void 0;t=this.WJl(k,D);D&&(Na=D.xd,qb=D.endCp);t=0<=qb?t.substring(0,qb):t;qb=0<=Na&&0<=qb?t.substring(Na,qb):t;D=b.cp>=Na?b.cp:Na;P=b.FYf||[];ca=0<b.BYf?b.BYf:0;let ac=0<b.AYf?b.AYf:0,yc=[];b.fI=!1;do{this.GYa.update();if(!b.Gwi&&(Vb.jRb+yc.length/2>Tq.S1o||this.GYa.qlb())){let sd;P=(sd=P).concat.apply(sd,yc);b.cp=D;b.FYf=P;b.AYf=
ac;b.BYf=ca;b.dX=ta;b.currentNode=k;this.Bje(Tq.o5o,b);Vb.Idg=!0;b.fI=!0;return Vb}if((!D||D===Na)&&0<t.length&&D<t.length){P.push(xl.a.instance.Juf(t,D));var Kc=this.yei(k);if(0<=ta&&!D&&Kc){b.wordCount+=1;Vb.jRb+=1;const sd=this.Gd.wX(Kc);Kc=this.LF.KZc(sd,Kc);Kc=Tq.gGd(Kc);b.w7+=Kc.JCa+1;b.v7+=Kc.JCa-Kc.Wmc}}Kc=this.Wii(t,D,Tq.TVk);D=Kc.cp;let ed;yc=(ed=yc).concat.apply(ed,Kc.Ymc);ca+=Kc.w7;ac+=Kc.v7}while(-1!==D);b=this.Nok(b,P,yc,t,qb,Vb.jRb,Vb.cDd,Vb.dDd,k,-1===ta,Jb);Vb.jRb=b.wordCount;Vb.cDd=
b.v7;Vb.dDd=b.w7;Vb.O4o=b.bKj;return Vb}CSh(b,k){const t=pe.ParagraphReader.textLength(k,9);if(t){k=Oi.e(k);var D=0;for(let P=0;P<k.length;P++)if(this.Dib&&5===k[P].Dh&&b.UQ++,Tq.Hoo(k[P])){D++;break}k.length!==t?b.A0++:b.A0+=D}}Hoj(b){this.zyd=this.epo(b.pZa,b.wordCount)?1:0;return!!this.zyd}CXi(b){this.Kgd=b.wordCount;this.Hwe=b.UQ;this.Swe=b.Bqa;this.Dwe=b.w7;this.Cwe=b.v7;this.Mwe=b.A0;this.AQg=b.Cqb;this.sQg=b.y3a;this.E5i(b)}E5i(b){this.ra.raiseEvent(Tq.Ooe,new WK(b))}D5i(){this.ra.raiseEvent(Tq.Wog,
new UK(!1))}epo(b,k){if(aa.a.ut||aa.a.Xt||aa.a.LH)return!1;(k/=2)||(k=1);return(k?b/k:0)>Tq.K9m?!0:!1}get Dib(){const b=!this.WLf||1===this.WLf&&this.nhk;return this.gWa&&b}cbi(b,k){let t=1033,D=0;b=k.Yqf(b);k=new cg;for(let P=0;P<b.length;P++){const ca=k.Iqk(b[P].lcid,b[P].end-b[P].begin);D<ca&&(D=ca,t=b[P].lcid)}return t}Nok(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){var ac;k=(ac=k).concat.apply(ac,t);t=xl.a.instance.Xii(k,D);b.wordCount+=t.wordCount;P=Tq.gGd(P);ac=P.JCa-P.Wmc;const yc=P.JCa;b.v7+=ac;b.w7+=yc;
ca+=t.wordCount;ta+=P.JCa-P.Wmc;Na+=P.JCa;b.pZa+=t.pZa;const {Lql:Kc,bJo:ed}=Tq.Mok(k,D);b.jCb+=Kc;b.iCb+=ed;b.y3a.add(Vb);b.Cqb.add(t.wordCount);Jb&&Tq.TOk(yc,ac,qb,t,Kc,ed,Vb);b.cp=0;b.FYf=[];b=new ZK;b.v7=ta;b.w7=Na;b.wordCount=ca;b.bKj=t.wordCount;return b}WJl(b,k){let t=this.s1n(b);t=pe.ParagraphReader.Agb(b,9,t,k);return this.NXn(t)}s1n(b){var k=pe.ParagraphReader.text(b);b=Oi.e(b);if(0<b.length){k=k.split("");for(let D=0;D<b.length;++D){let P=!0;var t=!0;const ca=b[D];if(1===ca.Dh)t=ca,t=22!==
t.kind&&2!==t.kind;else if(5===ca.Dh)P=!1;else if(7===ca.Dh||10===ca.Dh)k[ca.Ib.cp]=this.A2j,P=!1;if(P){if(ca.Ib.cp>=k.length)return"";k[ca.Ib.cp]=t?" ":"C"}}k=k.join("")}return k}NXn(b){return b.replace(this.Q0j,"")}Wii(b,k,t){const D=b.length-k<=t;var P=D?b.length:k+t;const ca=new YK;if(P<k)return ca.cp=-1,ca;ca.Ymc=xl.a.instance.Cnf(b,k,P);P=Tq.gGd(b.substr(k,P));ca.w7=P.JCa;ca.v7=P.JCa-P.Wmc;if(!ca.Ymc.length&&!D)return t===b.length-k?ca:this.Wii(b,k,b.length-k);ca.cp=D||!ca.Ymc.length?-1:ca.Ymc[ca.Ymc.length-
1].cp;return ca}bvk(b){this.Ayb=b;this.taskManager.Vb(this.Ayb)}yei(b){if(b=b.CK){const k=this.Gd.wX(b);if(k&&k.nz)return b}return null}static Hoo(b){return 11===b.Dh}static BXo(b,k){b.wordCount+=k.wordCount;b.v7+=k.TBh;b.w7+=k.UBh;b.pZa+=k.xxh;b.jCb+=k.jCb;b.iCb+=k.iCb;b.y3a.add(k.TZi);b.Cqb.add(k.wordCount)}static TOk(b,k,t,D,P,ca,ta){const Na=new VK;Na.wordCount=D.wordCount;Na.UBh=b;Na.TBh=k;Na.xxh=D.pZa;Na.jCb=P;Na.iCb=ca;Na.TZi=ta;t.Tbd=Na}static gGd(b){const k=b.length,t=new XK;for(let P=0;P<
k;P++){var D=b.charCodeAt(P);t.JCa++;if(55296<=D&&56319>=D&&(D=P+1<k?b.charCodeAt(P+1):0,56320<=D&&57343>=D)){P++;continue}F.a.$ba(b.charAt(P))&&t.Wmc++}return t}static Mok(b,k){let t=0,D=0;for(let P=0;P<b.length;++P){const ca=b[P],ta=ca.xL;(3===ta||2===ta)&&ca.cp<k.length&&(++t,F.a.aac(k.charCodeAt(ca.cp))&&++D)}return{Lql:D,bJo:t}}}Tq.Ooe="wctek";Tq.Wog="wcac";Tq.o5o=1;Tq.TVk=400;Tq.S1o=90;Tq.K9m=.1;Object(n.a)(Tq,"WordCountManagerBase",null,[573]);class $K extends Tq{constructor(b,k,t,D,P,ca,ta,
Na,qb,Jb,Vb){super(b,k,t,P,qb,Jb);this.Q0h=this.Gvd=this.dla=null;this.gpa=()=>{this.Ycf()};this.ib=D;this.qd=ta;this.Hhh=Na;this.uI=Vb;this.ib.Lw(this.gpa);this.XFe=qb.$("ReadingTimeIsEnabled")}get Ywj(){return 66}jym(){if(this.dla)return!0;if(!this.ib||!this.ib.hb)return this.qd&&(Wa.App.GXd||w.AFrameworkApplication.Lk?this.qd.Yb("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.qd.Yb("SelectionWordCountSelectionNullWhenAppAlive")),
!1;const b=this.ib.hb.clone();this.dla=b.kO(!0);if(!this.dla||!this.dla.IA())return this.gId(),!1;this.Hhh&&(this.Gvd=this.Hhh.create(k=>b.kO(k),this.An));this.dla.moveNext();return!0}get WLf(){return 1}y4k(b){return b===lc.a.Hd||b===lc.a.paragraph?!0:this.Dib&&(b===lc.a.YCb||b===lc.a.image||b===lc.a.anchoredObject)}tff(b){this.GYa.reset();if(this.jym()){for(this.Dib&&this.Gvd&&(this.Gvd.Kol(b,this.GYa)||this.Bje(1,b));this.dla.current;){const D=-1===b.dX?0:b.dX;let P=0;var k=this.dla.current;if(!this.y4k(k.contextId)){this.dla.moveNext();
continue}if(this.Dib&&Be.ImageReader.v2a(k)){b.UQ++;this.dla.moveNext();continue}if(!pe.ParagraphReader.Wb(k.node)){this.dla.moveNext();continue}const ca=k.node;if(this.VNa&&this.Q0h&&this.Q0h.W0a(ca))this.dla.moveNext();else{if(this.Dib&&k.isValid){var t=ze.GraphIterator.$a(ca);for(t.Rb(6);!t.Pr;)Be.ImageReader.gv(t.currentNode)&&b.UQ++,t.xi(6)}t=this.XFe?this.cbi(ca,this.uI):1033;k=this.eHj(b,ca,0,0,0,this.BYd(k),D,k.cpBegin,k.cpEnd,t);if(k.uCi&&(P+=1,100<P)){b.dX=D+1;this.Bje(1,b);return}if(k.Idg)return;
this.CSh(b,ca);this.dla.moveNext()}}this.Gvd=this.dla=null;this.Hoj(b)?(this.Kgd=-1,this.D5i()):this.CXi(b)}}BYd(b){let k=!1;b.contextId===lc.a.paragraph?k=!0:b.contextId===lc.a.Hd&&(k=b.cpEnd-b.cpBegin===b.node.characterData.length);return k}}Object(n.a)($K,"SelectionWordCountManager",Tq,[]);class xG{constructor(b,k){this.IVb=!1;this.Nxb=null;b&&k&&(this.CZb=b(!1),this.Wc=k,this.CZb.moveNext())}Kol(b,k){if(!b||!this.CZb||!this.CZb.current)return!0;do{const t=this.CZb.current;if(t.contextId===lc.a.tableRow||
t.contextId===lc.a.tableCell){for(this.Nxb||this.tym(t.node);this.Nxb.moveNext();)if(14===this.Nxb.currentNode.type&&b.Bqa++,k.update(),k.qlb())return!1;this.U6k(t,b);this.Nxb=null}this.CZb.moveNext()}while(this.CZb.current);return!0}U6k(b,k){const t=this.Wc.Uf(b.node);t.zb(14);b.contextId===lc.a.tableRow&&(fn.a.twi(t)&&(this.IVb=!0),fn.a.cZd(t)&&this.IVb&&(this.IVb=!1,k.Bqa++));b.contextId===lc.a.tableCell&&(yh.TableCellReader.OTc(t)&&(this.IVb=!0),yh.TableCellReader.eQa(t)&&this.IVb&&(this.IVb=
!1,k.Bqa++))}tym(b){this.Nxb=wc.a.Vo(b);14===b.type?this.Nxb.oo(xG.ALc,b):this.Nxb.oo(xG.ALc,null)}static ALc(b){return b.parentNode?!0:!1}}Object(n.a)(xG,"TableCountSelectionTraverser",null,[574]);class aL{constructor(b){this.gWa=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,k){return this.gWa?new xG(b,k):null}}Object(n.a)(aL,"TableCountSelectionTraverserFactory",null,[551]);class bL extends Tq{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb){super(b,k,t,P,qb,Jb);this.U1o=ac=>{if(ac.Pr)return!0;
ac=ac.role;return 1===ac||2===ac||this.Dib&&6===ac||3===ac||4===ac||5===ac||!this.VNa&&(7===ac||8===ac)};this.ga=D;this.ldk=ca;this.Xlk=ta;this.bQg=Na;this.uI=Vb;this.ga.fb(Nc.a.$Jj,lc.a.application,Xc.ActionManager.Of,64);this.ga.fb(Nc.a.aKj,lc.a.application,Xc.ActionManager.Of,64);this.XFe=qb.$("ReadingTimeIsEnabled")}get Ywj(){return 63}get WLf(){return 0}tff(b){this.GYa.reset();b.fI=!1;var k=this.ldk();Yg.PageReader.instance.oHb(k)||(this.hId(),this.D5i());k=this.An.jEa(k,7,7).currentNode;var t=
this.v$k(b.currentNode,k);k=this.Xlk(t,k);k.oo(this.U1o,null);let D=t=0;for(var P=0;k.moveNext();)if(k.currentNode&&this.Gd.Tba(k.currentNode)){var ca=this.Gd.wX(k.currentNode);if(ca.nz){var ta=this.Gd.rEb(k.currentNode);if(ta&&(ta=ta.pa.last,(null===ta||void 0===ta?0:ta.Sh)&&(Yl.App.oP&&ta.ii||ta.bR)))continue;b.wordCount+=1;if(ca=this.LF.KZc(ca,k.currentNode))ca=Tq.gGd(ca),b.w7+=ca.JCa+1,b.v7+=ca.JCa-ca.Wmc;t+=1;D+=b.w7;P+=b.v7}}else if(this.Dib&&k.currentNode&&Be.ImageReader.gv(k.currentNode))b.UQ++;
else if(this.Dib&&k.currentNode&&Ih.TableReader.eY(k.currentNode))b.Bqa++;else if(k.currentNode&&pe.ParagraphReader.Wb(k.currentNode)){ca=k.currentNode;ta=this.XFe?this.cbi(ca,this.uI):1033;P=this.eHj(b,ca,t,D,P,!0,-1,-1,-1,ta);if(P.Idg){b.fI=!0;w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorWordCountPackageImageAndTableCountSettings");return}this.CSh(b,ca);t=P.jRb;D=P.dDd;P=P.cDd}this.Hoj(b)?(this.hId(),this.j2n(),this.E5i(b)):this.CXi(b)}v$k(b,k){b?(b=this.bQg(b),
b.zb(7)):b=this.bQg(k);return b}j2n(){switch(this.zyd){case 1:this.ga.processAction(Nc.a.$Jj,2);break;case 2:this.ga.processAction(Nc.a.aKj,2)}}}Object(n.a)(bL,"TotalWordCountManager",Tq,[]);class cL{constructor(){this.Ahj=this.zhj=this.R9f=this.Bhj=this.jzj=this.kzj=this.hzj=this.izj=0}get VQi(){return this.G7b(this.Bhj,this.kzj,"WC")}get Ogn(){return this.G7b(this.zhj,this.hzj,"NumCharsNoSp")}get Pgn(){return this.G7b(this.R9f,this.izj,"NumCharsWithSp")}get Ugn(){return this.G7b(this.Ahj,this.jzj,
"NumParagraphs")}G7b(b,k,t){const D=this.Abd(k,t).toLocaleString();return 0<this.R9f?(b=this.Xng(b,k,t),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),D)):D}Xng(b,k,t){b=this.Abd(b,t);return b>k?(v.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",t),k):b}Abd(b,k){0>b&&v.ULS.sendTraceTag(22397768,338,15,"{0}<0",k);return Math.max(b,0)}}Object(n.a)(cL,"DocumentStats",null,[]);class yG{static W$e(b){return Wf.a.lA(yG.Lm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,
b.VQi,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,b.Ogn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.Pgn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.Ugn)}}yG.Lm="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(n.a)(yG,"DocumentStatsDialogHtml",null,[]);class dL extends Wf.a{constructor(b){super();this.pS=!1;this.rpl=()=>{};this.OF=b}Dto(){this.vg="DocumentStatsDialog";this.Xg=yG.W$e(this.OF);this.Ad=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.rpl);this.Z4("DocumentStatsTable")}W8(){}dispose(){this.pS||(super.dispose(),this.pS=!0)}}Object(n.a)(dL,"DocumentStatsDialog",Wf.a,[]);class eL{constructor(b,k,t,D,P,ca,ta,Na,qb){this.Mgh=this.Ctc=this.Krc=this.HVb=this.WGe=
!1;this.Wec=()=>{this.Pne()};this.jpa=()=>{this.Pne()};this.rlo=()=>{this.Mgh=!0;return 32};this.j2f=()=>this.$r.zQa?32:8;this.R2c=(Jb,Vb,ac,yc,Kc)=>{if(1===ac)return this.$r.zQa?32:8;Kc[kg.a.On]=this.gHf;return 32};this.Ale=(Jb,Vb,ac)=>{if(1===ac)return this.$r.zQa?32:8;this.gHf?this.rml():this.Isl();Wa.App.ya.VG({ShowWordCount:"CheckboxModel"});return 32};this.Ljc=(Jb,Vb,ac)=>{if(1===ac)return Pk.a.fha(Vb)?8:this.$r.zQa?32:8;if(this.Mgh)return w.AFrameworkApplication.va.processAction(Nc.a.r8d,2),
32;Jb=this.he.Zf("UserAction","Show Word Count Dialog");Jb.start();this.$r.a9c();this.hQ.a9c();this.$r.iy!==this.hQ.iy?v.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):v.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");Vb=this.S8k();(new dL(Vb)).Dto();Jb.stop();return 32};this.g2c=(Jb,Vb,ac,yc,Kc)=>{Kc||v.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===ac)return 32;if(!this.$r.zQa)return Kc[tn.a.Visible]=
!1,32;Kc[tn.a.Visible]=!0;this.gHf?(Jb=this.$r.iy,0>Jb?Jb=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:Jb?(Vb=this.hQ?this.hQ.iy:-1,Jb=0<Vb?this.ram(Jb,Vb):String.format(1===Jb?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.Mee(Jb))):Jb=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.Mee(Jb))):Jb=WordEditorIntl.WordEditorStrings.l_WordCountHidden;Kc[tn.a.LabelText]=Jb;return 32};
this.kwe=ta;this.lwe=ca;this.$r=b;this.hQ=k;this.lBc=t;this.Njk=P;this.hQ.r_e(this.Wec);this.$r.r_e(this.Wec);this.hQ.bzb(this.jpa);this.$r.bzb(this.jpa);this.he=Na;this.VNa=D;this.gWa=qb.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get Ncf(){return!aa.a.h4}Tb(){const b=w.AFrameworkApplication.va;b.qa(Nc.a.Ale,lc.a.application,this.Ale);b.qa(Nc.a.Ljc,lc.a.view,this.Ljc);b.fb(Nc.a.R2c,lc.a.application,this.R2c,96);b.fb(Nc.a.g2c,lc.a.application,this.g2c,96);b.fb(Nc.a.j2f,lc.a.application,
this.j2f,96);b.qa(Nc.a.YUh,lc.a.application,this.rlo)}get VNa(){return this.Krc}set VNa(b){this.Krc=b;this.$r.VNa=b;this.hQ.VNa=b}Isl(){this.$r.zQa&&(this.snj(!0),this.Pne(),this.$r.a9c())}S8k(){const b=new cL;b.kzj=this.$r.iy;b.izj=this.$r.T3b;b.hzj=this.$r.uIc;b.jzj=this.$r.wIc;b.Bhj=this.hQ.iy;b.zhj=this.hQ.uIc;b.R9f=this.hQ.T3b;b.Ahj=this.hQ.wIc;return b}STl(){return this.kwe("WACWordCountEnabled",this.Ncf)}bge(b){this.lwe("WACWordCountEnabled",b?"true":"false",Mb.a.cRa)}get gHf(){this.HVb||(this.WGe=
this.STl(),this.HVb=!0);return this.WGe}snj(b){this.bge(b);this.WGe=b;this.HVb=!0}rml(){this.$r.hId();this.hQ.hId();this.snj(!1);this.Pne()}get JJ(){return null!=this.uGg?this.uGg:this.uGg=(()=>this.lBc())()}Pne(){this.Ctc||(v.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.Sdl()),this.Ctc=!0);this.JJ&&this.JJ.KU(this.Njk)}Sdl(){const b={["words"]:this.$r.iy,["charsWithSpaces"]:this.$r.T3b,["charsWithNoSpaces"]:this.$r.uIc,["paragraphs"]:this.$r.wIc};this.gWa&&(b.images=this.$r.sBb,
b.tables=this.$r.wBb);return b}Mee(b){try{return b.toLocaleString()}catch(k){v.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",k.toString(),k.stack))}return b.toString()}ram(b,k){k>b&&(v.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),k=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.Mee(k),this.Mee(b))}}Object(n.a)(eL,"WordCountActor",
null,[]);class fL extends Iu.a{constructor(b,k,t,D){super();this.sY=(P,ca)=>{if(ca.property===sf.a.mo||ca.property===sf.a.Gn)P=ca.node,ca=Yl.App.Ln.gb.wc,ca.fv&&ca.ed&&ca.ed.Kc&&P.Kc&&P.Kc.id===ca.ed.Kc.id&&this.hWh(P)};this.aVi=(P,ca)=>{this.hWh(ca.node)};this.Zon=(P,ca)=>{ca.property!==vd.a.yA&&ca.property!==Cc.a.au||this.pY()};this.v6d=()=>{this.pY()};this.k2=b;this.$r=k;this.lq=t;this.gWa=D.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}wz(){var b=this.lq.Ze(12);b.Fo(this.sY);b.Ot(this.aVi);
b.Kw(this.aVi);b=this.lq.Ze(22);b.Fo(this.Zon);b.Ot(this.v6d);b.Kw(this.v6d);this.gWa&&this.AUn();this.k2.aqa(this,7)}AUn(){var b=[19,14];for(const k of b)b=this.lq.Ze(k),b.Ot(this.v6d),b.Kw(this.v6d)}get index(){return 1}run(){this.$r.Ycf()}hWh(b){b.Tbd=null;this.pY()}}Object(n.a)(fL,"WordCountAppEventCoordinator",Iu.a,[]);class vH{}vH.Ook="AccurateWordCountButton";Object(n.a)(vH,"WordCountConstants",null,[]);class gL{constructor(b,k){this.$r=b;this.hQ=k}getInstance(b){switch(b){case 1:return this.hQ;
case 0:return this.$r;default:return this.$r}}}Object(n.a)(gL,"WordCountManagerFactory",null,[245]);class wH{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}xc(b){this.W=b;const k=this.W.resolve("Common.IAppSettingsManager");this.W.ha("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new aL(k)).singleInstance();this.W.ha("WordEditor.WordCount.IWordCountManagerFactory",()=>{var t=new jo.a(10,$d.a.$e);const D=new bL(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),
new mk.a,w.AFrameworkApplication.va,w.AFrameworkApplication.nc,()=>Yl.App.Ln.gb.wc.ed,wc.a.mt,ze.GraphIterator.$a,k,t,Fa.a.instance.resolve("Box4.ILanguageReader"));t=new $K(Fa.a.instance.resolve("Box4.List.IListReader"),Fa.a.instance.resolve("Box4.IListMarkerUtility"),new mk.a,af.a.instance,w.AFrameworkApplication.nc,pi.a.instance,Hi.a.instance,Fa.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),k,t,Fa.a.instance.resolve("Box4.ILanguageReader"));return new gL(D,t)}).singleInstance();
this.W.ha("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new SK(this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").singleInstance()}init(){const b=Wa.App.ya.gb;b.swa?this.$ia():b.Xea(()=>{this.$ia()})}$ia(){if(Wa.App.Lj){var b=Wa.App.Lj.Bl;if(b){this.W.resolve("WordEditor.IGraphFullyConnectedGetter");var k=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),t=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),
D=Fa.a.instance.resolve("Common.IAppSettingsManager");(new eL(k,t,()=>Fa.a.instance.Na("WordEditor.IStatusBarUser"),this.WSl(),vH.Ook,Mb.a.dTa,Mb.a.lba,Fa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),D)).Tb();(new fL(Eq.GraphTransactionManager.instance,k,b,D)).wz();k.Ycf()}else v.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else v.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}WSl(){var b=
Yl.App.Ln.gb;if(!b)return v.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.wc;if(!b)return v.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.ed;return b?b.ia(Cc.a.VNa,!1):(v.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){N.a.instance.Fc(new wH)}}Object(n.a)(wH,"PackageManager",null,[1,2]);var hL=c(2007);class iL{constructor(b){this.IQe=null;b.Sa("Common.App.SearchCommon.SearchHostRuntime").execute(k=>{this.IQe=k})}Pjj(b){this.IQe&&this.IQe.wqf().handleDocumentContentAugloopAnnotation(b)}}
Object(n.a)(iL,"DocumentContentExtractionManager",null,[397]);class Fh{}Fh.pxo="mso_smartLookup";Fh.channelId="SmartLookup";Fh.oxo="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";Fh.Nsj="https://uci.edog.cdn.office.net/mirrored/smartlookup/";Fh.Osj="https://uci.cdn.office.net/mirrored/smartlookup/";Fh.nxo="https://hedwigtestserver.blob.core.windows.net/builds/";Fh.mxo="http://localhost:8080/";Fh.C8c="current";Fh.Msj="next";Fh.vxn=2;Fh.kfc=1;Fh.lfc=CommonUIStrings.L_SmartLookupPaneTitle;
Fh.WB="InsightsTaskPane";Fh.Yhg="InsightsTaskPaneData";Fh.oyf="InsightsContentFrame";Fh.width=400;Fh.nbn="ApplicationPropertiesRequest";Fh.ybn="SelectionRequest";Fh.tbn="PageRendered";Fh.mbn="ApplicationProperties";Fh.xbn="Selection";Fh.Abn="Telemetry";Fh.zbn="TakeFocus";Fh.sbn="LostFocus";Fh.pbn="Keyboard";Fh.qbn="LegalAgreed";Fh.M4o="WordWac";Fh.iun="OneNoteWAC";Fh.eYf="yes";Fh.ixj="appCorrelationId";Fh.MFo="clientCorrelationId";Fh.jxj="message";Fh.VEi="Microsoft::Office::Insights::LegalAgreed";
Object(n.a)(Fh,"InsightsConstants",null,[]);var DF=c(1599);class PE{}Object(n.a)(PE,"ActivityContractInfo",null,[]);class Mt{}Object(n.a)(Mt,"BrowserPaneDataField",null,[]);class QE{}Object(n.a)(QE,"BrowserPaneTelemetryEvent",null,[]);class Rl{static zz(b,k){const t=new QE;t.eventName="Diagnostics";t.isActivity=!1;t.activityContract=Object.assign(new PE,{success:!0});const D=[],P=new Mt;P.name="Message";P.dataType=0;P.value=b;b=new Mt;b.name="Level";b.dataType=0;b.value=Rl.getLevelString(k);Array.add(D,
P);Array.add(D,b);t.dataFields=D;Rl.sendTelemetryEvent(t)}static Rhj(b,k){const t=new QE;t.eventName=b;t.isActivity=!1;t.activityContract=Object.assign(new PE,{success:!0});b=[];const D=new Mt;D.name="AppCorrelationId";D.dataType=0;D.value=k;Array.add(b,D);t.dataFields=b;Rl.sendTelemetryEvent(t)}static Fbo(b,k,t,D,P,ca){const ta=new QE;ta.eventName="LaunchPaneWithError";ta.isActivity=!1;ta.activityContract=Object.assign(new PE,{success:!0});const Na=[],qb=new Mt;qb.name="IsNetworkConnected";qb.dataType=
0;qb.value=b?"true":"false";b=new Mt;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=k?"true":"false";k=new Mt;k.name="EntryPoint";k.dataType=0;k.value=t;t=new Mt;t.name="RuntimeVersion";t.dataType=0;t.value=D;D=new Mt;D.name="IsFirstRelease";D.dataType=1;D.value=P?"true":"false";P=new Mt;P.name="IsZeroTerm";P.dataType=1;P.value=ca?"true":"false";ca=new Mt;ca.name="IsClientSideRendering";ca.dataType=1;ca.value="false";Array.add(Na,qb);Array.add(Na,k);Array.add(Na,b);Array.add(Na,t);Array.add(Na,
D);Array.add(Na,P);Array.add(Na,ca);ta.dataFields=Na;Rl.sendTelemetryEvent(ta)}static U9f(b,k,t){const D=new QE;D.eventName="CDNDownloadLatency";D.isActivity=!0;D.activityContract=Object.assign(new PE,{duration:t,success:!0});t=[];const P=new Mt;P.name="CDNHostname";P.dataType=0;P.value=b;b=new Mt;b.name="Filename";b.dataType=0;b.value=k;Array.add(t,P);Array.add(t,b);D.dataFields=t;Rl.sendTelemetryEvent(D,1)}static fic(b,k,t,D,P,ca,ta,Na){const qb=new QE;qb.eventName="LaunchPane";qb.isActivity=!0;
qb.activityContract=Object.assign(new PE,{duration:k,success:!0});k=[];const Jb=new Mt;Jb.name="AppCorrelationId";Jb.dataType=0;Jb.value=b;b=new Mt;b.name="EntryPoint";b.dataType=0;b.value=t;t=new Mt;t.name="IsServerSideRendering";t.dataType=1;t.value="true";const Vb=new Mt;Vb.name="UxVersion";Vb.dataType=0;Vb.value=D;D=new Mt;D.name="FeatureGates";D.dataType=0;D.value=P;P=new Mt;P.name="IsFirstRelease";P.dataType=1;P.value=ca?"true":"false";ca=new Mt;ca.name="IsZeroTerm";ca.dataType=1;ca.value=ta?
"true":"false";ta=new Mt;ta.name="IsClientSideRendering";ta.dataType=1;ta.value=Na?"true":"false";Array.add(k,Jb);Array.add(k,b);Array.add(k,t);Array.add(k,Vb);Array.add(k,D);Array.add(k,P);Array.add(k,ca);Array.add(k,ta);qb.dataFields=k;Rl.sendTelemetryEvent(qb)}static sendTelemetryEvent(b,k=2){if(b.isFeedbackActivity)Rl.b1m(b.eventName);else{var t=-1<b.eventName.indexOf(Rl.hxj)?b.eventName:Rl.hxj+b.eventName,D=Rl.WRl(b.dataFields);b.isActivity?(b=Object.assign(new ph.a,{name:t,samplingPolicy:k,
dataFields:D,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),ea.a.sendActivityEvent(b)):(b=Object.assign(new pa.a,{name:t,samplingPolicy:k,dataFields:D}),ea.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static WRl(b){const k=[];if(b&&0<b.length)for(const t of b)(b=al.a.vga(t.name,t.value,Rl.V5k(t.dataType)))&&Array.add(k,b);return k}static V5k(b){switch(b){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static b1m(b){const k=Fa.a.instance.Na("Common.ISystemInitiatedFeedback");k?k.logActivity(b,null):v.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}Rl.hxj="Office.Insights.SmartLookup.";Object(n.a)(Rl,"TelemetryUtils",null,[]);var RE;(function(b){b[b.other=0]="other";b[b.searchBoxSearch=1]="searchBoxSearch";b[b.searchBoxDictionary=2]="searchBoxDictionary";b[b.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";b[b.smartLookupRibbon=
4]="smartLookupRibbon";b[b.smartLookupContextMenu=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.dictionary=7]="dictionary";b[b.web=8]="web";b[b.pictures=9]="pictures";b[b.files=10]="files";b[b.bookmarks=11]="bookmarks";b[b.help=12]="help";b[b.chartRecommendation=13]="chartRecommendation";b[b.linkSkill=14]="linkSkill";b[b.searchBoxFindInDocument=15]="searchBoxFindInDocument";b[b.searchBoxEntity=16]="searchBoxEntity";b[b.searchSkill=17]="searchSkill";b[b.controlF=18]="controlF";b[b.ribbonFindButton=
19]="ribbonFindButton";b[b.reuseSlides=20]="reuseSlides";b[b.data=21]="data";b[b.contextMenuDictionary=22]="contextMenuDictionary";b[b.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";b[b.contextMenuSynonyms=24]="contextMenuSynonyms";b[b.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";b[b.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";b[b.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";b[b.note=28]="note";b[b.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";
b[b.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";b[b.dataDisambiguate=31]="dataDisambiguate";b[b.linkFiles=32]="linkFiles";b[b.searchBoxNoteL2=33]="searchBoxNoteL2";b[b.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";b[b.actionAI=35]="actionAI";b[b.pasteAsNewSlide=36]="pasteAsNewSlide";b[b.slidesCompression=37]="slidesCompression";b[b.searchBoxGenerateDeck=38]="searchBoxGenerateDeck";b[b.powerPointCopilot=39]="powerPointCopilot";b[b.tellMeService=40]="tellMeService";
b[b.prefetch=99]="prefetch"})(RE||(RE={}));Object(n.b)("EntryPoint",RE);var Nt=c(1528),Hx=c(1541);class rv{static RX(b,k,t,D,P,ca){if(1===t)return $b.SessionStatusManager.instance.KH?32:8;if(P.value.eso())return Rl.zz("Skipping Serplet launch",10),32;k=ca;if(!k)return 8;b=rv.tDb();if(t=k.CommandValueId)try{k=G.a(t)}catch(ta){return v.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",t),8}t=k;k.selection||(k.neighborhood?t=Object.assign(new Nt.a,{selection:k}):
(k=P.value.eEb(),t.selection=Object.assign(new Hx.a,{neighborhood:k.neighborhood,mentionStart:k.mentionStart,mentionLength:k.mentionLength})));t.selection.clientDetectedLanguage=P.value.p$h();return rv.J5b(ca,null,t,b,0,P)}static J5b(b,k,t,D,P,ca){const ta={};ta.controlId=b?b.SourceControlId:"shortcut";t&&(ta.entryPoint=RE[t.entryPoint]);v.ULS.sendTraceTag(594044172,1303,50,rv.QT("Show insights",D,ta));k?ca.value.wuo(k,D,P):t&&(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",
!1)?ca.value.Tso(t,D):ca.value.xuo(t,D,P));return 32}static QT(b,k,t=null){b={["appCorrelationId"]:k,["message"]:b};if(t)for(let D in t)b[D]=t[D];return G.c(b)}static tDb(){return lb.a.create().toString()}}Object(n.a)(rv,"InvokingPaneUtils",null,[]);class jL{}Object(n.a)(jL,"LaunchDataInDoc",null,[]);class kL{}Object(n.a)(kL,"LaunchDataPasteAsSlide",null,[]);class lL{}Object(n.a)(lL,"LaunchDataSlidesCompression",null,[]);var qu=c(1517);class xH{constructor(b,k,t,D,P,ca,ta,Na,qb){this.Mrc=this.kkd=
this.Aw=null;this.jC=b;this.ga=k||w.AFrameworkApplication.va;this.$o=t;this.Ub=D;this.O1g=Na;this.zxc=P;this.Ma=ca;this.Hb=ta;this.oxm();this.aWa=new Rg.a(()=>new Pm.a(qb.value,Object(A.a)(this,this.tEb,"getMoreInfoEventReceived")))}Tb(){this.ga.qa($a.a.tBm,Ud.a.frame,Object(A.a)(this,this.uuo,"showInsights"));this.ga.qa($a.a.uBm,Ud.a.frame,Object(A.a)(this,this.vuo,"showInsightsForTellMe"));this.ga.qa($a.a.definitions,Ud.a.frame,Object(A.a)(this,this.tto,"showDefinitions"));this.ga.qa($a.a.Vcf,Ud.a.frame,
Object(A.a)(this,this.uto,"showDefinitionsForTellMe"));this.ga.qa($a.a.feg,Ud.a.frame,Object(A.a)(this,this.feg,"showInsightsForSuggestion"));this.O1g&&(this.ga.qa($a.a.s8,Ud.a.frame,Object(A.a)(this,this.RX,"invokeSmartLookupPane")),this.ga.qa($a.a.ZSc,Ud.a.frame,Object(A.a)(this,this.ZSc,"invokeInDocSerplet")),this.ga.qa($a.a.aTc,Ud.a.frame,Object(A.a)(this,this.aTc,"invokeSerpletRibbon")),this.ga.qa($a.a.$Sc,Ud.a.frame,Object(A.a)(this,this.$Sc,"invokeSerpletContextMenu")),this.ga.qa($a.a.mBf,
Ud.a.frame,Object(A.a)(this,this.mBf,"invokeSerpletTellMeZeroTerm")),this.ga.qa($a.a.lBf,Ud.a.frame,Object(A.a)(this,this.lBf,"invokeSerpletTellMeNotes")),this.ga.qa($a.a.aXd,Ud.a.frame,Object(A.a)(this,this.aXd,"invokeImageSerpletContextMenu")),this.ga.qa($a.a.eXd,Ud.a.frame,Object(A.a)(this,this.eXd,"invokeSynonymsSerpletContextMenu")),this.ga.qa($a.a.$Wd,Ud.a.frame,Object(A.a)(this,this.$Wd,"invokeDictionarySerpletContextMenu")),this.ga.qa($a.a.gXd,Ud.a.frame,Object(A.a)(this,this.gXd,"invokeZeroTermSerpletContextMenu")),
this.ga.qa($a.a.ZWd,Ud.a.frame,Object(A.a)(this,this.ZWd,"invokeDefinitionSearchFromFloatie")),this.ga.qa($a.a.dXd,Ud.a.frame,Object(A.a)(this,this.dXd,"invokeSerpletBrowseFiles")),this.ga.qa($a.a.bXd,Ud.a.frame,Object(A.a)(this,this.bXd,"invokeInDocSerpletWithLaunchData")),this.ga.qa($a.a.vbe,Ud.a.frame,Object(A.a)(this,this.vbe,"queryToggleSerplet")),this.ga.qa($a.a.qge,Ud.a.frame,Object(A.a)(this,this.qge,"setInDocSearchParameter")),this.ga.qa($a.a.kBf,Ud.a.frame,Object(A.a)(this,this.kBf,"invokeSerpletSlidesCompression")),
this.ga.qa($a.a.jBf,Ud.a.frame,Object(A.a)(this,this.jBf,"invokeSerpletPasteAsNewSlide")),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.qa($a.a.gti,Ud.a.frame,Object(A.a)(this,this.fDm,"invokeSmartLookupPaneConversations")),this.ga.qa($a.a.XWd,Ud.a.frame,Object(A.a)(this,this.XWd,"invokeAutoLaunchSearchRequest"))),this.hTn().continueWith(()=>{w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.updateCommandUI(!0)}))}Anh(){this.ga.fb($a.a.kFa,
Ud.a.frame,Object(A.a)(this,this.kFa,"invokeFilesSerplet"),4);this.ga.fb($a.a.dBf,Ud.a.frame,Object(A.a)(this,this.kFa,"invokeFilesSerplet"),4);this.ga.fb($a.a.bti,Ud.a.frame,Object(A.a)(this,this.VCm,"invokeLinkFilesSerplet"),4);if(this.Ma.$("IsTellMeUpSellEnterpriseEnabled")&&this.Ma.$("SmartLookupTokenPrefetchIsEnabled")){const b=Df.a.K7(0,Object(A.a)(this,this.G1i,"prefetchToken"),0,177);this.Hb.Vb(b)}}AZe(){Qg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&
(this.ga.qa($a.a.kFa,Ud.a.frame,Object(A.a)(this,this.eBf,"invokeFilesSerpletUnavailable")),this.ga.qa($a.a.dBf,Ud.a.frame,Object(A.a)(this,this.eBf,"invokeFilesSerpletUnavailable")),this.ga.qa($a.a.bti,Ud.a.frame,Object(A.a)(this,this.eBf,"invokeFilesSerpletUnavailable")))}G1i(b){v.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.Slc().then(k=>{let t=1;if(k)v.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),
this.m$f("SmartLookupFiles: Token prefetch succeeded",!0),k=6E4*this.Ma.mc("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{v.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.m$f("SmartLookupFiles: Token prefetch failed",!1);t=parseInt(b.data||"1");if(t>this.Ma.mc("SmartLookupTokenRenewalRetryThreshold",5)){v.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.m$f("SmartLookupFiles: Token prefetch max retry count reached",
!1);return}k=6E4*this.Ma.mc("SmartLookupTokenRetryWaitDurationInMinutes",10);t++}k=new Df.a(3,1,k,Object(A.a)(this,this.G1i,"prefetchToken"),177);k.data=t.toString();this.Hb.Vb(k)})}m$f(b="",k=!1){this.zxc.execute(t=>{t&&t.Xnb("PrefetchToken",k,0,"SmartLookup",b)})}Slc(){return this.zxc?new Promise(b=>{this.zxc.execute(k=>{if(k){var t=Date.now();k.getToken("SmartLookup",this.Ma.jb("SmartLookupShredderServiceEndpoint")).then(D=>{b(!!D&&0<D.length);k.Xnb("TryGetTokenInternal",!!D&&0<D.length,Date.now()-
t,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}hTn(){const b=new Cg.a;if(this.Ma.$("BrowserSupportsInsightsPaneSSO"))this.Anh(),b.Ag(!0);else{if(!this.zxc)return v.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.Ag(!1),this.AZe(),b.task;this.zxc.execute(k=>{k?k.getToken("SmartLookup",this.Ma.jb("SmartLookupShredderServiceEndpoint")).then(t=>{v.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!t&&0<t.length);t&&0<t.length?(this.Anh(),b.Ag(!0)):this.AZe()}):(v.ULS.sendTraceTag(587534912,
1303,10,"Unable to resolve oAuthManager"),b.Ag(!1),this.AZe())})}return b.task}uuo(b,k,t,D,P){if(1===t)return w.AFrameworkApplication.ta&&w.AFrameworkApplication.K.$("OneNoteDelayLoadContextActivationManager")&&!w.AFrameworkApplication.pHc?8:this.jC.value.rxi()?32:8;b=rv.tDb();k=this.jC.value.eEb();return this.O1g?(k=Object.assign(new Hx.a,{neighborhood:k.neighborhood,mentionStart:k.mentionStart,mentionLength:k.mentionLength}),k=Object.assign(new Nt.a,{selection:k,userIntent:null,entryPoint:0,launchData:Object.assign(new qu.a,
{landingTab:"All"})}),rv.J5b(P,null,k,b,0,this.jC)):rv.J5b(P,k,null,b,0,this.jC)}tto(b,k,t,D,P){if(1===t)return this.jC.value.rxi()?32:8;b=rv.tDb();k=this.jC.value.eEb();return rv.J5b(P,k,null,b,1,this.jC)}vuo(b,k,t,D,P){return 1===t?32:this.tXh(P,0)}uto(b,k,t,D,P){return 1===t?32:this.tXh(P,1)}tXh(b,k){const t=rv.tDb(),D=b.CommandValueId;let P;try{P=G.a(D)}catch(ca){return v.ULS.sendTraceTag(6295941,1303,15,rv.QT(String.format("Insights parameters [{0}] is not in proper format.",D),t)),8}return rv.J5b(b,
P,null,t,k,this.jC)}feg(b,k,t,D,P){if(1===t)return 32;if(!P)return 8;b=P.query?P.query:"";k=rv.tDb();t=new DF.a;t.neighborhood=b;t.mentionStart=0;t.mentionLength=b.length;return rv.J5b(P,t,null,k,0,this.jC)}VCm(b,k,t,D){if(1===t)return $b.SessionStatusManager.instance.KH?32:8;const P=w.AFrameworkApplication.K.$("InsertFileLinkSerpletIsEnabled"),ca=this.jC.value.b1a();return this.RX(b,k,t,D,Object.assign(new Nt.a,{selection:Object.assign(new Hx.a,{neighborhood:ca.neighborhood,mentionStart:0,mentionLength:0}),
launchData:Object.assign(new qu.a,{landingTab:"File"}),entryPoint:P?32:10}))}kFa(b,k,t,D){if(1===t)return $b.SessionStatusManager.instance.KH?32:8;const P=w.AFrameworkApplication.K.$("InvokeReuseSlidesSerpletIsEnabled"),ca=this.jC.value.b1a();return this.RX(b,k,t,D,Object.assign(new Nt.a,{selection:Object.assign(new Hx.a,{neighborhood:ca.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new qu.a,{landingTab:P?"Slide":"File"}),entryPoint:P?20:10}))}eBf(){return 2}ZSc(b,k,t,D,P){if(1===
t)return $b.SessionStatusManager.instance.wj?8:32;const ca=this.jC.value.b1a();P=void 0===P||null===P?18:19;return this.RX(b,k,t,D,Object.assign(new Nt.a,{selection:Object.assign(new Hx.a,{neighborhood:ca.neighborhood,mentionStart:ca.mentionStart,mentionLength:ca.mentionLength}),launchData:Object.assign(new qu.a,{landingTab:"Indoc"}),entryPoint:P}))}bXd(b,k,t,D,P){P=P.CommandValueId;if(!P||P&&this.Mrc&&P.query===this.Mrc.query&&P.matchCase===this.Mrc.matchCase&&P.matchWholeWordOnly===this.Mrc.matchWholeWordOnly)return 32;
const ca=this.jC.value.b1a();return this.RX(b,k,t,D,Object.assign(new Nt.a,{selection:Object.assign(new Hx.a,{neighborhood:ca.neighborhood,mentionStart:ca.mentionStart,mentionLength:ca.mentionLength}),launchData:Object.assign(new qu.a,{landingTab:"Indoc",data:Object.assign(new jL,{type:4,query:P.query,matchCase:P.matchCase,matchWholeWord:P.matchWholeWordOnly})}),entryPoint:18}))}vbe(b,k,t,D,P){P&&(P[kg.a.On]=this.jC.value.pHb);return 32}qge(b,k,t,D,P){if(b=P.CommandValueId)this.Mrc=b;return 32}fDm(b,
k,t){if(1===t)return $b.SessionStatusManager.instance.KH?32:8;b=this.jC.value.b1a();b=Object.assign(new Nt.a,{selection:Object.assign(new Hx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new qu.a,{landingTab:"All"})});this.jC.value.x0d(b);return 32}XWd(b,k,t){if(1===t)return $b.SessionStatusManager.instance.KH?32:8;b=this.jC.value.b1a();b=Object.assign(new Nt.a,{selection:Object.assign(new Hx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,
mentionLength:0}),entryPoint:29,launchData:Object.assign(new qu.a,{landingTab:"All",data:w.AFrameworkApplication.eCb})});k=rv.tDb();this.jC.value.GNb(b,k);return 32}aTc(b,k,t,D){if(1===t)return $b.SessionStatusManager.instance.KH?32:8;const P=this.jC.value.r$h();return this.RX(b,k,t,D,Object.assign(new Nt.a,{selection:Object.assign(new Hx.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:P.mentionLength}),entryPoint:4,launchData:Object.assign(new qu.a,{landingTab:"All"})}))}$Sc(b,
k,t,D){return this.RX(b,k,t,D,Object.assign(new Nt.a,{entryPoint:5,launchData:Object.assign(new qu.a,{landingTab:"All"})}))}mBf(b,k,t,D){if(1===t)return $b.SessionStatusManager.instance.KH?32:8;const P=this.jC.value.b1a();return this.RX(b,k,t,D,Object.assign(new Nt.a,{selection:Object.assign(new Hx.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:0}),launchData:Object.assign(new qu.a,{landingTab:"All"}),entryPoint:26}))}$Wd(b,k,t,D){return 1===t?(b=this.jC.value.eEb())&&0<
b.mentionLength?32:8:this.RX(b,k,t,D,Object.assign(new Nt.a,{entryPoint:22,launchData:Object.assign(new qu.a,{landingTab:"All"})}))}ZWd(b,k,t,D){return 1===t?(b=this.jC.value.eEb())&&0<b.mentionLength?32:8:this.RX(b,k,t,D,Object.assign(new Nt.a,{entryPoint:7,launchData:Object.assign(new qu.a,{landingTab:"All"})}))}aXd(b,k,t,D){return this.RX(b,k,t,D,Object.assign(new Nt.a,{launchData:Object.assign(new qu.a,{landingTab:"Image"}),entryPoint:9}))}eXd(b,k,t,D){return this.RX(b,k,t,D,Object.assign(new Nt.a,
{launchData:Object.assign(new qu.a,{landingTab:"All"}),entryPoint:24}))}lBf(b,k,t,D){return this.RX(b,k,t,D,Object.assign(new Nt.a,{launchData:Object.assign(new qu.a,{landingTab:"Notes"}),entryPoint:33}))}gXd(b,k,t,D){if(1===t)return $b.SessionStatusManager.instance.KH?32:8;const P=this.jC.value.b1a();return this.RX(b,k,t,D,Object.assign(new Nt.a,{selection:Object.assign(new Hx.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:0}),launchData:Object.assign(new qu.a,{landingTab:"All"}),
entryPoint:27}))}kBf(b,k,t,D,P){if(!P)return 8;const ca=P.url;P=P.selectedSlideIDs;return this.RX(b,k,t,D,Object.assign(new Nt.a,{launchData:Object.assign(new qu.a,{landingTab:"All",data:Object.assign(new lL,{type:6,url:ca,selectedSlideIDs:P})}),entryPoint:37}))}jBf(b,k,t,D,P){if(!P)return 8;const ca=P.Selection;P=P.CurrentDocTitle;return this.RX(b,k,t,D,Object.assign(new Nt.a,{launchData:Object.assign(new qu.a,{landingTab:"All",data:Object.assign(new kL,{type:5,selection:ca,currentDocTitle:P})}),
entryPoint:36}))}RX(b,k,t,D,P){return rv.RX(b,k,t,D,this.jC,P)}dXd(b,k,t){if(1===t)return 32;this.Aw||this.aWa.value.Yj("Browse File from Search pane",!0);if(!this.kkd||""===this.kkd)return v.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;$d.a.nm(this.kkd,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}tEb(b){this.Aw||3!==b.state||(this.Aw=b,this.kkd=this.Aw.Aca)}oxm(){const b=this.Ub.ge(Fh.WB);b.parent=ef.AFrame.rp;b.Uea(Object(A.a)(this,this.eic,
"sendIFrameTakeFocusMessage"));this.$o.dT(Fh.WB)}eic(){document.activeElement.blur();w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Sjb||(this.jC.value.kgo(),this.jC.value.Dbo())}dispose(){this.jC.value&&this.jC.value.dispose()}}Object(n.a)(xH,"InsightsActor",null,[9]);const yH=b=>{b=b.split("-");return b[b.length-1]},eN=()=>{var b=zG();if(b)return Promise.resolve(b);b=EF().replace("SearchWeb","searchweb");b=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Fh.Msj+"/":b+Fh.C8c+"/";b+="version.json";if(aa.a.moa)return dN(b);try{const k=new Sys.Net.WebRequest;k.set_httpVerb("GET");k.set_url(b);b={};b.method=k.get_httpVerb();return"function"!==typeof window.fetch?(Rl.zz("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(k.getResolvedUrl(),b).then(t=>t.json()).catch(()=>{Rl.zz("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(t=>{t=G.b(JSON.stringify(t));
return t.version?t.version:""},t=>{Rl.zz("InsightsUtils - Failed to deserialize version: "+t.toString(),10);v.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+t.toString());return""}).then(t=>t)}catch(k){return Rl.zz("InsightsUtils - Failed to download version.json: "+k.toString(),10),v.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+k.toString()),Promise.resolve("")}},dN=b=>{const k=w.AFrameworkApplication.Ne;return new Promise(t=>{const D=
new BF.a(b,1,null,null,!0,2,null);k.send(D).bya(P=>{P&&P.data?P.data.xe||(Rl.zz("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+P.data.Qe,10),t("")):(Rl.zz("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),t(""));try{const ca=G.b(P.data.xe);ca.version&&t(ca.version)}catch(ca){Rl.zz("InsightsUtils - Failed to deserialize version: "+ca.toString(),10),t("")}},P=>{P&&P.data?Rl.zz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+
P.data.Qe,10):Rl.zz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);t("")})})},AG=()=>w.AFrameworkApplication.K.$("SmartLookupEnableLocalOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),BG=()=>{const b=EF();return AG()||w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion")?b+zG()+"/":w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Fh.Msj:b+Fh.C8c},zG=()=>AG()?"dev":w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion")?w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion").split("/")[1]:w.AFrameworkApplication.K.jb("SmartLookupClientVersion"),zH=b=>{var k=3===w.AFrameworkApplication.ta.Nb.Sl?"wordwac":2===w.AFrameworkApplication.ta.Nb.Sl?"pptwac":"excelwac";var t=Xj.a.og(w.AFrameworkApplication.lcid);const D=t?t.name:"en-us";t=EF();const P=XC();k="main_ssr_wac.html?appName="+k+"&culture="+D;return"LOCAL"===P?
t+k:t+((""!==b?b:Fh.C8c)+"/")+k},fN=b=>EF()+(""!==b?b:Fh.C8c)+"/scripts/microsoft.office.smartlookup.host.runtime.js",EF=()=>{switch(XC()){case "LOCAL":return Fh.mxo;case "PR":const b=w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion").split("/");return Fh.nxo+b[0]+"/";case "INT":return Fh.oxo;case "EDOG":return Fh.Nsj;default:return Fh.Osj}},gN=()=>{if(!w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(XC()){case "EDOG":return Fh.Nsj;
case "PROD":return Fh.Osj;default:return""}},XC=()=>{if(w.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(w.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(w.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion")&&w.AFrameworkApplication.K.jb("SmartLookupPRIntentSvc"))return"PR";if(AG())return"LOCAL";switch(Object(Ka.a)(String,w.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",
!1)){let b=w.AFrameworkApplication.K.jb("UserPrincipalName");b=F.a.Tg(b);const k=w.AFrameworkApplication.K.Nw("SmartLookupINTEnabledForSKITeam")?w.AFrameworkApplication.K.GC("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(k,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},mL=()=>{let b;b=w.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",
!1)?"EDOG":w.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":w.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":XC();const k=w.AFrameworkApplication.K.jb("IntentServiceEndpoint"),t=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===b&&""!==k)return k+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return w.AFrameworkApplication.K.jb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(t?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(t?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},hN=()=>{const b=XC(),k=w.AFrameworkApplication.K.jb("IntentServiceEndpoint");switch(b){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===b&&""!==k?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class nL{sendTelemetryEvent(b){Rl.sendTelemetryEvent(b)}}
Object(n.a)(nL,"OtelTelemetrySink",null,[429]);class oL{}Object(n.a)(oL,"ApplicationProperties",null,[]);class pL{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(n.a)(pL,"CurrentDocumentProperties",null,[]);class qL{}Object(n.a)(qL,"EnterpriseUserInfo",null,[]);class rL{}Object(n.a)(rL,"FeatureGates",null,[]);class AH{constructor(b,k){this.kv=this.Hi=null;this.$Ki=!0;this.qyb=k;this.Gz=b;this.Gz.execute(t=>{t.isFeatureEnabled("mso_sendASmile",!0).then(D=>{this.$Ki=
D}).catch(D=>{Rl.zz("SearchHelper - Failed to check if Feedback feature is enabled: "+D.toString(),15)})});b=mL();k=w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(w.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")){this.kv={};const t=this.Cam();if(t&&0<t.length)for(let D=0;D<t.length;D++){const P=t[D],ca=this.Pam(P);switch(ca.toLowerCase()){case "true":this.kv[P]=
!0;break;case "false":this.kv[P]=!1;break;default:this.kv[P]=ca}}this.kv.EnableInDocumentSearch=k;this.kv.EnableInDocumentSearchReplace=!0;this.kv.EnableInDocumentParamLocalSearch=!0;this.kv.EnableInDocumentQuerySuggest=k&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.kv.EnableInDocumentQuestionGeneration=k&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.kv.EnableInDocumentExperiment1=k&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.kv.EnableInDocumentExperiment2=k&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",
!1);this.kv.EnableInDocumentExperiment3=k&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.kv.EnableZeroTermAutoRefresh=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.kv.EnableTap3SZeroTerm=w.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.kv.EnableLocalSearch=!0;this.kv.EnableInDocumentStickyFilters=!0;this.kv.IntentServiceEndpoint=b;this.kv.EnablePDFShredding=w.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.kv.FilterNonPPTFilesForReuseSlides=w.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.kv.UXBundleVersion=zG();this.kv.SmartLookupServicePath=BG();this.kv.EnableAcronymSearch=
!0;this.kv.UseAltAnswerEndpoint1=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.kv.UseAltAnswerEndpoint2=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.kv.UseAltAnswerEndpoint3=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.kv.UseNextUXVersion=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.kv.IgnoreNeighborhoodContext=w.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.kv.ShowDebugInfo="INT"===XC();this.kv.DebugCommands=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.kv.ChangeGates=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.kv.QnaInMixSection=!0;this.kv.EnableNoteSearch=w.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.kv.EnableWikiL2=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.kv.EnableFilteringOutRedundantKPE=
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.kv.EnableZeroTermEntitySuggestion=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.kv.RankingModels=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.kv.EnableClientSideRendering=!0}else this.Hi=new rL,this.Hi.EnableInDocumentSearch=k,this.Hi.EnableInDocumentSearchReplace=
!0,this.Hi.EnableInDocumentParamLocalSearch=!0,this.Hi.EnableInDocumentQuerySuggest=k&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Hi.EnableInDocumentQuestionGeneration=k&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.Hi.EnableInDocumentExperiment1=k&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Hi.EnableInDocumentExperiment2=k&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.Hi.EnableInDocumentExperiment3=
k&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Hi.EnableZeroTermAutoRefresh=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Hi.EnableTap3SZeroTerm=w.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.Hi.EnableLocalSearch=!0,this.Hi.EnableInDocumentStickyFilters=!0,this.Hi.IntentServiceEndpoint=b,this.Hi.EnablePDFShredding=w.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Hi.FilterNonPPTFilesForReuseSlides=w.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Hi.UXBundleVersion=zG(),this.Hi.SmartLookupServicePath=BG(),this.Hi.EnableAcronymSearch=
!0,this.Hi.UseAltAnswerEndpoint1=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Hi.UseAltAnswerEndpoint2=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Hi.UseAltAnswerEndpoint3=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Hi.UseNextUXVersion=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Hi.IgnoreNeighborhoodContext=w.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Hi.ShowDebugInfo="INT"===XC(),this.Hi.DebugCommands=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.Hi.ChangeGates=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Hi.QnaInMixSection=!0,this.Hi.EnableNoteSearch=w.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Hi.EnableWikiL2=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Hi.EnableFilteringOutRedundantKPE=
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Hi.EnableZeroTermEntitySuggestion=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.Hi.RankingModels=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Hi.EnableClientSideRendering=!0,this.Hi.SharedSerpletFeatureGate1=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.Hi.SharedSerpletFeatureGate2=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Hi.SharedSerpletFeatureGate3=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.Hi.SharedSerpletFeatureGate4=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Hi.SharedSerpletFeatureGate5=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.Hi.SharedSerpletFeatureGate6=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Hi.SharedSerpletFeatureGate7=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.Hi.SharedSerpletFeatureGate8=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Hi.SharedSerpletFeatureGate9=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.Hi.SharedSerpletFeatureGate10=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Hi.SharedSerpletFeatureGate11=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.Hi.SharedSerpletFeatureGate12=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Hi.SharedSerpletFeatureGate13=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.Hi.SharedSerpletFeatureGate14=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Hi.SharedSerpletFeatureGate15=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.Hi.SharedSerpletFeatureGate16=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Hi.SharedSerpletFeatureGate17=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.Hi.SharedSerpletFeatureGate18=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Hi.SharedSerpletFeatureGate19=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.Hi.SharedSerpletFeatureGate20=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Hi.SharedSerpletFeatureGate21=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.Hi.SharedSerpletFeatureGate22=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Hi.SharedSerpletFeatureGate23=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.Hi.SharedSerpletFeatureGate24=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Hi.SharedSerpletFeatureGate25=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.Hi.SharedSerpletFeatureGate26=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Hi.SharedSerpletFeatureGate27=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.Hi.SharedSerpletFeatureGate28=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Hi.SharedSerpletFeatureGate29=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.Hi.SharedSerpletFeatureGate30=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Hi.SharedSerpletFeatureGate31=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.Hi.SharedSerpletFeatureGate32=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Hi.SharedSerpletFeatureGate33=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.Hi.SharedSerpletFeatureGate34=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Hi.SharedSerpletFeatureGate35=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.Hi.SharedSerpletFeatureGate36=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Hi.SharedSerpletFeatureGate37=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.Hi.SharedSerpletFeatureGate38=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Hi.SharedSerpletFeatureGate39=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.Hi.SharedSerpletFeatureGate40=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.Bwc=Fa.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.fJb=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableOAuthManager",!1);this.Xkb=AH.isEnterpriseUser();this.TQa=w.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint");this.LLf=ia.a.y_(w.AFrameworkApplication.K.jb("AppCatalogUrl")||"");this.y7m=w.AFrameworkApplication.K.jb("UserPrincipalName");(this.Xkb||this.fJb)&&this.Tfi()}Pam(b){return w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+
b,"")}Cam(){const b=w.AFrameworkApplication.K.r0a,k=w.AFrameworkApplication.K.GC("SmartLookupFlightKeywordList"),t=[];if(b&&k&&0<k.length)for(let P in b){var D={key:P,value:b[P]};D=D&&D.key?D.key:"";for(let ca=0;ca<k.length;ca++)if(-1<D.toLowerCase().indexOf(k[ca].toLowerCase())){const ta=D.split(".");ta&&4===ta.length&&Array.add(t,ta[ta.length-1])}}return t}Ptf(b,k,t,D){return new Promise(P=>{this.JQm().then(ca=>{const ta=new oL;ta.anid="";ta.applicationName=3===w.AFrameworkApplication.ta.Nb.Sl?
"WORD":"POWERPNT";ta.applicationVersion=w.AFrameworkApplication.buildVersion;ta.appCorrelationId=b?b:rv.tDb();ta.themePlatform="web";ta.lcid=w.AFrameworkApplication.lcid;ta.launchUtcTime=(new Date).toUTCString();w.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?ta.featureGates=G.c(this.kv):ta.featureGates=G.c(this.Hi);var Na=Xj.a.og(w.AFrameworkApplication.lcid);Na=Na?Na.name:null;ta.market=yH(Na);ta.uiLanguage=Na;ta.sessionId=w.AFrameworkApplication.userSessionId;ta.themeId=t;ta.parentalControl=
"yes";ta.processorOnlyMode=ca;ta.isEditingAllowed=k.isEditingAllowed();ta.isFeedbackEnabled=this.$Ki;ta.isClientSideRendering=18===D||19===D||15===D;ta.disableClipboard=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&w.AFrameworkApplication.JG&&!w.AFrameworkApplication.qCb;ta.accessToken=this.Xkb||this.fJb?this.Tfi():"";ca=new qL;ca.CountryCode=yH(Na);ca.ServiceEndpoint=this.TQa;ca.IsGoLocal=w.AFrameworkApplication.K.$("IsGoLocalEnvironment");
ca.IsEnabled=this.Xkb;ca.IsEnterpriseEnabled=this.Xkb;ca.TenantRoot=this.LLf;ca.Upn=this.y7m;Na=XC();ca.IsEUDB="PROD"===Na&&""!==w.AFrameworkApplication.K.jb("IntentServiceEndpoint");ta.enterpriseUserInfo=ca;ca=new pL;ca.filePath=w.AFrameworkApplication.K.jb("EditDocInClientUrl");ca.docName=w.AFrameworkApplication.K.jb("FileName");ca.author=99!==D?k.author():null;ca.createdDate=99!==D?k.createdDate():null;ta.currentDocument=ca;P(ta)})})}JQm(){return new Promise(b=>{this.Gz?this.Gz.execute(k=>{k.isFeatureEnabled(Fh.pxo,
!0).then(t=>{b(!t)}).catch(t=>{Rl.zz("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+t.toString(),10);b(!0)})}):b(!0)})}eAn(b){this.Bwc&&(this.Xkb||this.fJb)&&this.Quf(this.TQa).then(k=>{b(k)})}Tfi(){if("Dev Box"===w.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return window.SearchPaneShredderTokenOverride;const b=this.fJb?"Search":"SmartLookup";return this.Bwc?
this.Bwc.Dem(b,this.TQa,this.fJb):""}Quf(b){if("Dev Box"===w.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return new Promise(t=>{t(window.SearchPaneShredderTokenOverride)});const k=this.fJb?"Search":"SmartLookup";return this.Bwc?this.Bwc.getToken(k,b,this.fJb):Promise.resolve("")}mPc(){return this.qyb?this.qyb.getVersion():""}CUl(){return w.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?
G.c(this.kv):G.c(this.Hi)}static isEnterpriseUser(){const b=w.AFrameworkApplication.K.jb("SovereignEnvironmentName"),k=w.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&k}}Object(n.a)(AH,"SearchHelper",null,[398]);class bE{constructor(){bE._instance=""}getVersion(){return bE._instance}Bmo(b){bE._instance=b}}bE._instance=null;Object(n.a)(bE,"SmartLookupVersion",null,[]);class sL{}Object(n.a)(sL,"ConfigurationProvider",null,[]);class SE{constructor(b){SE._instance=
b}wqf(){return SE._instance}}SE._instance=null;Object(n.a)(SE,"SearchHostRuntime",null,[]);class BH{constructor(){this.cea=this.URb=this.W=null}get name(){return"Common.App.Insights"}xc(b){this.W=b;const k=Tb.a.Ap(Fa.a.instance.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>")),t=w.AFrameworkApplication.K.$("SmartLookupEnableNativePane")||w.AFrameworkApplication.K.$("SmartLookupIsEnabled");b.register(xH,"Common.App.Insights.InsightsActor").singleInstance().Rd(()=>new xH(b.Ue("Common.App.Insights.IInsightsManager"),
w.AFrameworkApplication.va,tl.a.instance,ad.FocusManager.instance(),b.Sa("Common.App.SearchCommon.ISearchOAuthManager"),w.AFrameworkApplication.K,wb.a.instance,t,new Rg.a(()=>k.result)));b.register(397,"Common.App.Insights.IDocumentContentExtractionManager").singleInstance().Rd(()=>new iL(b));t&&(b.register(bE,"Common.App.Insights.SmartLookupVersion").singleInstance().Rd(()=>new bE),b.register(398,"Common.App.SearchCommon.ISearchHelper").singleInstance().Rd(()=>new AH(Fa.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
b.Na("Common.App.Insights.SmartLookupVersion"))))}init(){w.AFrameworkApplication.Q_&&(this.URb=this.W.Na("Common.App.Insights.InsightsActor"),this.URb.Tb())}TRn(){if(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",!1)){var b=w.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint");this.W.resolve("Common.App.SearchCommon.ISearchHelper").Quf(b).then(k=>{var t={};t.Authorization="Bearer "+k;k=hN();const D=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",
!0);t=new BF.a(k+("?isTelemetryOnly="+D),1,null,t,!0,2,null);w.AFrameworkApplication.Ne.send(t).bya(()=>{Rl.zz("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+D,50)},P=>{Rl.zz("InsightsPackage - Failed to send refreshmemory API request. Error: "+P.toString(),10)})})}}eql(){this.PBm();this.TRn()}PBm(){eN().then(b=>{if(""!==b){const k=this.W.Na("Common.App.Insights.SmartLookupVersion");k&&k.Bmo(b)}this.nJd();this.URb=this.W.resolve("Common.App.Insights.InsightsActor");
b=fN(b);b=Sa.a.create(b);b.UZ((k,t)=>{t.succeeded?this.yno()&&this.prefetchZeroTerm():Rl.zz("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+t.yF,10);this.URb.Tb()});Gb.a.lX(b)})}yno(){const b=Object.assign(new sL,{channelId:Fh.channelId,approvedOriginPattern:AG()?"^(http)?://(localhost:8080)$":w.AFrameworkApplication.K.jb("SmartLookupApprovedOriginPattern")});var k=this.W.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const t=this.W.resolve("Common.App.SearchCommon.ISerpletExecutor"),
D=this.W.resolve("Common.App.SearchCommon.IInsertContentExecutor"),P=new Eb.a;k&&P.add(k);t&&P.add(t);D&&P.add(D);k=mL();try{const ca=new nL,ta=SmartLookupHostRuntime.setup(b,P.toArray(),!0,k,ca);this.W.register(SE,"Common.App.SearchCommon.SearchHostRuntime").singleInstance().Rd(()=>new SE(ta));return!0}catch(ca){return Rl.zz("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+ca,10),!1}}prefetchZeroTerm(){if(w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=Fa.a.instance.Na("Common.App.SearchCommon.SearchHostRuntime");if(b){const k=this.W.resolve("Common.App.SearchCommon.ISearchHelper"),t=this.W.resolve("Common.App.SearchCommon.IDocumentHelper");k.Ptf(null,t,0,99).then(D=>{b.wqf().prefetchZeroTerm(D,w.AFrameworkApplication.userSessionId,BG(),!0,"Indoc",null)})}else Rl.zz("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",
15)}}nJd(){var b=this.W.resolve("Common.App.SearchCommon.ISearchHelper");const k=zH(b.mPc());b=b.mPc();b=EF()+(""!==b?b:Fh.C8c)+"/scripts/microsoft.office.smartlookup.ssr.js";const t=gN();aa.a.moa?this.dql(k,b):(this.bql(k,t),this.cql(b,t))}bql(b,k){const t=new Sys.Net.WebRequest;t.set_httpVerb("GET");const D={};D.method=t.get_httpVerb();t.set_url(b);const P=(new Date).getTime();try{window.fetch(t.getResolvedUrl(),D).then(()=>{""!==k&&Rl.U9f(k,b,(new Date).getTime()-P);this.W.Na("Common.App.Insights.SmartLookupVersion")})}catch(ca){Rl.zz("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+
ca.toString(),10)}}cql(b,k){var t=new Sys.Net.WebRequest;t.set_httpVerb("GET");const D={};D.method=t.get_httpVerb();t.set_url(b);let P=-1;if(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))t=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),wb.a.instance.Vb(new Df.a(5,1,t,()=>{const ca=Sa.a.create(b);ca.OZe(()=>{P=Date.now()});ca.UZ((ta,Na)=>{Na.succeeded?""!==k&&Rl.U9f(k,b,Date.now()-
P):Rl.zz("InsightsPackage - Failed to prefetch JS file.",10)});Gb.a.lX(ca)}));else{P=Date.now();try{window.fetch(t.getResolvedUrl(),D).then(()=>{""!==k&&Rl.U9f(k,b,Date.now()-P)})}catch(ca){Rl.zz("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+ca.toString(),10)}}}dql(b,k){if(aa.a.moa){var t=w.AFrameworkApplication.Ne;b=new BF.a(b,1,null,null,!0,2,null);t.send(b).bya(D=>{D&&D.data?D.data.xe?this.W.Na("Common.App.Insights.SmartLookupVersion"):Rl.zz("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
D.data.Qe,10):Rl.zz("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},D=>{D&&D.data?Rl.zz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+D.data.Qe,10):Rl.zz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});w.AFrameworkApplication.K.$("SmartLookupPrefetchJSIsEnabled")&&(k=new BF.a(k,1,null,null,!0,2,null),t.send(k).bya(D=>{D&&D.data?D.data.xe||Rl.zz("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
D.data.Qe,10):Rl.zz("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},D=>{D&&D.data?Rl.zz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+D.data.Qe,10):Rl.zz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.URb&&this.URb.dispose()}}Object(n.a)(BH,"InsightsPackage",null,[1,2]);var tL=c(1580);class uL{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(n.a)(uL,"DocumentContentParams",null,[]);var CG=c(1849),CH=c(1852),DH=c(402),TE=c(718),vL=c(1432),Kr;(function(b){b.EUa="SearchProvider";b.C8a="TextSummarization";b.pRb="ExtractiveTextSummarization"})(Kr||(Kr={}));Object(n.b)("WorkflowType",Kr);var ru;(function(b){b.Success="Success";b.Crg="Invoked";b.Error="Error"})(ru||(ru={}));Object(n.b)("LogType",ru);var Rw;(function(b){b.ALj="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck=
"BlockedByQualityCheck";b.BlockedByClassifier="BlockedByClassifier";b.yrg="InvalidAnnotation";b.eRj="StaleAnnotation";b.Timeout="Timeout";b.Other="Other"})(Rw||(Rw={}));Object(n.b)("ErrorReason",Rw);class cE{constructor(b,k,t,D,P){this.SSh=b;this.BBl=k;this.xCl=t;this.x4i=D;this.ur=P;this.vTf=this.vTf.bind(this);this.hmb=this.hmb.bind(this);this.ATf=this.ATf.bind(this);this.P4a=[];this.CGo=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3);
this.Yxl=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.ExtractiveTextSummarizationRequestTimeout",5E3)}NWk(){if(this.P4a&&!(0>=this.P4a.length))for(const b of this.P4a)this.KDh(b.paragraphNode)}async tUl(b,k,t){try{if(!cE.hwi)return{success:!1,resultCount:0};if(this.revisionId===t&&this.P4a&&0<this.P4a.length)return this.irm(),{success:!0,resultCount:this.P4a.length};this.Zxl=Date.now();this.revisionId=t;this.ar=b;this.P4a=[];await this.activateAnnotation();const D={content:k.join(". ")},
P=new Ws.a({parentPath:["Signal",vL.b.getTypeName()],items:[{id:"ExtractiveSummaries",body:new vL.b(D)}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:P});this.XXh=window.setTimeout(()=>{this.onError(Kr.pRb,ru.Error,Rw.Timeout)},this.Yxl);return new Promise(ca=>{this.P5b=ca})}catch(D){window.clearTimeout(this.XXh),this.onError(Kr.pRb,ru.Error,Rw.Other,this.zpf(D))}}async submitDocumentContentExtractionSignal(){try{this.A$n=Date.now();this.Qnb=lb.a.create().toString();
this.log({eI:Kr.EUa,logType:ru.Crg,success:!0,correlationId:this.Qnb});var b=XC().toLowerCase();b="int"===b||"local"===b;await this.activateAnnotation();const k=new Ws.l({parentPath:["Signal",CG.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new CG.SearchProviderSignal({correlationId:this.Qnb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:k});this.Fgj=window.setTimeout(()=>{this.onError(Kr.EUa,ru.Error,Rw.Timeout)},
1500)}catch(k){window.clearTimeout(this.Fgj),this.onError(Kr.EUa,ru.Error,Rw.Other,this.zpf(k))}}async generateDocumentSummaryDetails(){try{if(!cE.OVc)return null;this.BGo=Date.now();this.log({eI:Kr.C8a,logType:ru.Crg,success:!0});await this.activateAnnotation();const b=new Ws.l({parentPath:["Signal",TE.GenerateTextSummarySignal.getTypeName()],items:[{id:"TextSummarization",body:new TE.GenerateTextSummarySignal}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});
this.Fxj=window.setTimeout(()=>{this.onError(Kr.C8a,ru.Error,Rw.Timeout)},this.CGo);return new Promise(k=>{this.skc=k})}catch(b){window.clearTimeout(this.Fxj),this.onError(Kr.C8a,ru.Error,Rw.Other,this.zpf(b))}}async generateDocumentSummary(){var b;return null===(b=await this.generateDocumentSummaryDetails())||void 0===b?void 0:b.summary}static get OVc(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableDocumentSummarization",!1)}static get NQm(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableVoiceSummarization",
!1)}static get hwi(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableExtractiveTextSummarization",!1)}async activateAnnotation(){if(!this.x$b){await yp.a.kl();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,k=[b(Object.assign(new DH.a,{annotationType:CG.SearchProviderAnnotation.getTypeName(),handler:this.vTf}))];cE.hwi&&k.push(b(Object.assign(new DH.a,{annotationType:CH.TextExtractiveSummaryAnnotation.getTypeName(),
handler:this.ATf})));cE.OVc&&k.push(b(Object.assign(new DH.a,{annotationType:TE.TextSummaryAnnotation.getTypeName(),handler:this.hmb})));await Promise.all(k);this.x$b=!0}}hmb(b){var k,t,D;if(this.skc)if(this.MEf(b)){if(b=b.items[0],TE.TextSummaryAnnotation.typeGuard(b.body))if(window.clearTimeout(this.Fxj),b=b.body,b.status!==TE.Result.Success)this.onError(Kr.C8a,ru.Error,this.O7h(b),`[TextSummary] workflow failed with status: ${b.status}`);else{this.log({eI:Kr.C8a,logType:ru.Success,success:!0});
var P=null!==b.summary&&""!==b.summary,ca=cE.NQm&&(null===(k=b.tts)||void 0===k?void 0:k.requestStatus)===TE.TTSStatus.Success&&null!==(null===(t=b.tts)||void 0===t?void 0:t.base64Audio)&&""!==(null===(D=b.tts)||void 0===D?void 0:D.base64Audio);this.skc({succeeded:P,summary:P?b.summary:null,audioSucceeded:ca,audioBase64:ca?b.tts.base64Audio:null});this.skc=null}}else this.log({eI:Kr.C8a,logType:ru.Error,success:!1,DKd:Rw.yrg})}vTf(b){if(this.MEf(b)&&(b=b.items[0],CG.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.Fgj),
(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.Qnb)this.log({eI:Kr.EUa,logType:ru.Error,DKd:Rw.ALj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});else if(this.Qnb!==b.correlationId)this.log({eI:Kr.EUa,logType:ru.Error,DKd:Rw.eRj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",
workflowExecutionTime:b.workflowExecutionTime});else{var k=this.CKh(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.log({eI:Kr.EUa,logType:ru.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.Qnb=void 0;this.SSh.Pjj(k)}else this.onError(Kr.EUa,ru.Error,Rw.yrg)}ATf(b){if(this.P5b&&this.MEf(b)&&(b=b.items[0],CH.TextExtractiveSummaryAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.XXh),b=b.body,b.status!==CH.Result.Success)this.onError(Kr.pRb,
ru.Error,this.O7h(b),`[ExtractiveTextSummarization] workflow failed with status: ${b.status}`);else{var k=b.extractiveSummarizationArrays;b=[];for(var t of k){k=t.extractiveSummarizations;for(const D of k)b.push(D.summary.slice(0,-1))}t=b.length;if(0<t)for(const D of this.ar)this.KDh(D),b=b.filter(P=>(P=this.rna(P,D))&&0<P.length?(this.Nia(D,P),this.P4a.push({paragraphNode:D,vrm:P}),!1):!0);this.log({eI:Kr.pRb,logType:ru.Success,success:!0});this.P5b({success:!0,resultCount:t});this.P5b=null}}O7h(b){switch(b.status){case "BlockedByPrefilter":return Rw.BlockedByPrefilter;
case "BlockedByQualityCheck":case "BlockedByPostfilter":return Rw.BlockedByQualityCheck;default:return Rw.Other}}rna(b,k){var t=this.x4i.Hmb(this.x4i.Yfc(b));b=Fe.a.createQuery(b,$e.a.matchCase);t=this.xCl.LEb(t.join("|"),b);return this.BBl.E1a(k.Bva(),t)}Nia(b,k){const t=this.ur.Mc(3);t.Cb(b);const D=b.rna();if(D&&0<D.length)for(const P of D)if(P.begin<k[0].end&&P.end>k[0].begin)return;b.Nia(k);t&&t.dispose()}KDh(b){const k=this.ur.Mc(3);k.Cb(b);b.rfa();k&&k.dispose()}irm(){for(const b of this.P4a)this.Nia(b.paragraphNode,
b.vrm)}MEf(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){switch(b.eI){case Kr.EUa:var k=this.A$n;break;case Kr.C8a:k=this.BGo;break;case Kr.pRb:k=this.Zxl;break;default:k=-1}const t=Date.now(),D=k?t-k:-1;k=[Object.assign(new na.a,{name:"WorkflowType",string:b.eI}),Object.assign(new na.a,{name:"LogType",string:b.logType}),Object.assign(new na.a,{name:"ErrorReason",string:b.DKd}),Object.assign(new na.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new na.a,{name:"Message",
string:b.message}),Object.assign(new na.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new na.a,{name:"StartTime",int64:k}),Object.assign(new na.a,{name:"EndTime",int64:t}),Object.assign(new na.a,{name:"Duration",int64:D})];Object(bf.a)("AugloopSearchProviderData",b.success,D,k)}zpf(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}CKh(b="",k="",t=""){return Object.assign(new uL,{documentContentKey:b,dataCenterEndpoint:k,documentContentTableName:t})}onError(b,
k,t,D){k={eI:b,logType:k,success:!1,message:D,DKd:t};switch(b){case Kr.EUa:if(!this.Qnb)break;k.correlationId=this.Qnb;this.log(k);this.Qnb=void 0;this.qyl();break;case Kr.C8a:if(!this.skc)break;this.log(k);this.skc(null);this.skc=null;break;case Kr.pRb:if(!this.P5b)break;this.log(k);this.P5b({success:!1,resultCount:0});this.P5b=null;break;default:return null}}qyl(){this.SSh.Pjj(this.CKh())}}Object(n.a)(cE,"AugloopSearchProviderManager",null,[]);class DG{constructor(){this.results=null;this.totalResultCount=
0;this.hasTooManyResults=!1}}Object(n.a)(DG,"DocumentContentSearchResults",null,[]);class EH{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,k,t,D,P){this.selectRange(k,t,D,P)}selectRangeV3(){}search(){}searchV2(b,k){this.search(b,t=>{k(Object.assign(new DG,{results:t,totalResultCount:t.length,hasTooManyResults:100<t.length}))})}searchWithParam(b,k){this.search(b.query,k)}searchWithParamV2(b,k){this.searchWithParam(b,t=>{k(Object.assign(new DG,{results:t,totalResultCount:t.length,
hasTooManyResults:t.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}highlightDocumentKeySentences(){return Promise.resolve(null)}getDocumentKeySentences(){return Promise.resolve(null)}clearDocumentKeySentencesHighlights(){}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(n.a)(EH,"BaseDocumentContentExecutor",null,[931,278]);var FH=c(2041),wL=c(1448);class EG{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(n.a)(EG,"DocumentContentSearchParams",null,[]);class GH{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(n.a)(GH,"DocumentSelection",null,[]);class xL{constructor(){this.authorID=this.authorColor=this.authorImageURL=
null}}Object(n.a)(xL,"IAuthorProperties",null,[]);var dE=c(679);class HH{constructor(){this.PLc=this.l8e=0}}Object(n.a)(HH,"CommentFindResultIndexInfo",null,[]);const IH=b=>{b.setSelection(hf.SelectionEditor.Cj(b.hb.kb,!0,!1))},yL=b=>{b=FH.a.hRd(b.text[0]).split("\n");return 1===b.length?b[0]:b.join(" ")};class zL{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=
0;this.authorName=this.authorEmail=null}}Object(n.a)(zL,"DocumentContentSearchResult",null,[]);var iN=c(1805);class AL{constructor(){this.authorEmail=this.authorName=this.SCb=this.q8e=null}}Object(n.a)(AL,"CommentFindResults",null,[]);class BL{constructor(){this.end=this.begin=0}}Object(n.a)(BL,"FindResultOffset",null,[]);class gw{constructor(b,k,t,D,P,ca,ta,Na,qb,Jb){this.lue=this.nv=this.nAe=this.WA=null;this.Mih=0;this.UL=null;this.Xpc=new Eb.a;this.WOg=null;this.uv=b;this.eb=k;this.lcb=t;this.xea=
P;this.HUb=ca;this.dtb=ta;this.Zh=Na;this.ga=qb;this.ib=Jb}IXl(b,k){var t;const D=[];if(12!=b.type)return D;const P=Je.FormattingReader.f3h(b);let ca=null,ta=-1;var Na=ch.a.auto;for(let Jb=0;Jb<=P.length;Jb++){let Vb=-1;var qb=ch.a.auto;Jb<P.length&&(qb=P[Jb],Vb=qb.cp,qb=null===(t=qb.formatting)||void 0===t?void 0:t.cache,qb=(null===qb||void 0===qb?0:qb.wFb)?qb.highlight:(null===qb||void 0===qb?0:qb.sPa)?qb.Nv:ch.a.auto);if(Na!=qb){if(Na!=ch.a.auto){ca||(ca=this.dtb.Bva(b.id));-1==Vb&&(Vb=ca.length);
Na=this.lcb.TGd(ca,ta,Vb,"");const ac={};ac.context=Na.EFd;ac.startOffsetInContext=Na.Yde;ac.endOffsetInContext=Na.Wde-1;D.push({data:ac,startParagraphIndex:k,endParagraphIndex:k,startOffsetInParagraph:ta,endOffsetInParagraph:Vb-1})}ta=Vb;Na=qb}}return D}get Naa(){return this.WOg}initialize(){this.WA=ud.FindManager.createInstance(this,this.xea,ok.a.instance,!1,!0)}search(b,k){this.WA.yZa();this.nFf(b)?(this.nv=k,this.UL=new Eb.a,b=this.Raf(b),this.WA.find(b)):k(null)}searchV2(b,k){w.AFrameworkApplication.Cn("Microsoft.Office.Web.SessionSettings.IWacWordCommentsInFindPaneSettings");
this.WA.yZa();if(this.nFf(b)){this.fxi()&&this.ga.Qb($a.a.qge,2,{CommandValueId:b});this.lue=k;this.Mih=b.totalResultLimit;this.UL=new Eb.a;b=this.Raf(b);this.WOg=new up.a;this.WA.find(b);k=this.xea.Yfc(b.text);k=this.xea.Hmb(k);b=this.HUb.LEb(k.join("|"),b);k=this.Zh.xO();for(let D=0;D<k.length;D++){const P=k[D],ca=yL(P);var t=this.dtb.E1a(ca,b);const ta=this.dtb.E1a(P.author,b);if(!t&&!ta){v.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!ca,!b);continue}t=ta?ta:
t;let Na="",qb="";ta&&(Na=P.author,qb=P.authorId);for(const Jb of t)t=iN.a.createInstance(Jb.begin,Jb.end,X.a.If(P.objectId),D,32,!1),this.Xpc.add(t),this.Naa.nb(D)||this.Naa.add(D,Object.assign(new AL,{q8e:ca,SCb:[],authorName:Na,authorEmail:qb}))}}else k(null)}get HZh(){null==this.nAe&&(this.nAe=ud.FindManager.createInstance(this,this.xea,ok.a.instance));return this.nAe}fxi(){var b;return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",
!1)}wac(){var b;return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}highlight(b){var k=this.nFf(b);b=k?this.Raf(b):null;var t={};this.fxi()&&this.ga.Qb(Nc.a.i2f,2,t);if(t[kg.a.On]){if(k){k={};t={};var D={};this.ga.Qb(Nc.a.Eae,2,k);this.ga.Qb($a.a.Dae,2,t);this.ga.Qb($a.a.Fae,2,D);if(b.text!=k.CommandValueId||b.matchCase!=t[kg.a.On]||b.matchWholeWord!=D[kg.a.On])IH(this.ib),this.ga.Qb($a.a.findInDocument,
2,{CommandValueId:b.text,MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else t=this.HZh,t.yZa(),k&&t.find(b)}selectNextPrevHighlight(b){const k=this.HZh;return 0<k.Jj.lja?(b?k.XSd():k.YSd(),k.Jj.$Xe-1):-1}Raf(b){let k=$e.a.none;b.matchCase&&(k|=$e.a.matchCase);b.matchWholeWordOnly&&(k|=$e.a.wholeWordOnly);return Fe.a.createQuery(b.query,k)}nFf(b){return b&&!!b.query&&0<b.query.length}jhe(){}Ffe(){}reset(){}ekf(){}a6b(){if(this.nv){var b=this.DKh(this.UL);this.nv(b)}if(this.lue){b=new DG;
const k=this.UL.count+this.Xpc.count>this.Mih;b.totalResultCount=this.UL.count+this.Xpc.count;b.hasTooManyResults=k;k||(this.UL.PC(this.UL.count,this.Xpc),b.results=this.DKh(this.UL));this.lue(b);this.Xpc.clear()}}DKh(b){var k;const t=[];var D=Object.assign(new dE.a,{QO:!1,Hba:!0,Vna:this.wac(),TO:!0});D=this.eb.iEa(this.uv.value,D);for(const ta of b){var P=ta.begin;let Na=ta.end;var ca=void 0;b=-1;let qb=null,Jb=0;if(32===ta.type){qb=gw.p8e;Jb=3;b=D.count+ta.vPa;const Vb=({begin:P,end:Na}=tL.a.v9i(this.Naa.J(ta.vPa).q8e,
P,Na)).returnValue;ca=this.lcb.TGd(Vb,P,Na,Rk.a(ta.type));this.Naa.J(ta.vPa).q8e=Vb;this.Naa.J(ta.vPa).SCb.push(Object.assign(new BL,{begin:P,end:Na}))}else{if(2===ta.type||4===ta.type)Jb=2===ta.type?1:2,qb=gw.txf;if(8===ta.type||16===ta.type)Jb=8===ta.type?6:5,qb=gw.fRf;for(ca=0;ca<D.count;ca++)if(D.J(ca).id===ta.nodeId){b=ca;break}ca=this.lcb.UGd(ta)}P=(null===(k=this.Naa)||void 0===k?0:k.nb(ta.vPa))?this.Naa.J(ta.vPa):null;if(0<=b||(null===P||void 0===P?0:P.authorName))b=Object.assign(new zL,{snippet:ca.EFd,
subdocumentId:qb,subdocumentType:Jb,startOffsetInSnippet:ca.Yde,endOffsetInSnippet:ca.Wde-1,paragraphIndex:b,startOffsetInParagraph:ta.begin-ca.Yde,endOffsetInParagraph:ta.end-ca.Wde-1,authorName:P?P.authorName:"",authorEmail:P?P.authorEmail:""}),t.push(b)}t.sort((ta,Na)=>ta.paragraphIndex===Na.paragraphIndex?ta.startOffsetInParagraph-Na.startOffsetInParagraph:ta.paragraphIndex-Na.paragraphIndex);return t}update(){}uOa(b,k){switch(b){case 0:k&&0<k.length&&!this.UL&&(v.ULS.sendTraceTag(570975814,313,
15,"Results container list is null"),this.UL=new Eb.a);for(const t of k)this.UL.add(t)}}pob(){}dispose(){}}gw.p8e="Comment";gw.txf="HeaderFooter";gw.fRf="Note";gw.Ooi="Image";Object(n.a)(gw,"WordDocumentSearchProcessor",null,[275,9,276]);class CL extends EH{get GR(){return!this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",!1)}wac(){var b;return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",
!1)}constructor(b,k,t,D,P,ca,ta,Na,qb,Jb,Vb,ac,yc,Kc){super();this.Ma=Jb;this.iMa=null;this.sY=(ed,sd)=>{ed=sd.node;sd=sd.property;this.Wcg(ed)&&sd===sf.a.mo&&this.oFb(ed,3)};this.Tha=(ed,sd)=>{ed=sd.node;!sd.rCf&&this.Wcg(ed)&&this.oFb(ed,1)};this.amb=(ed,sd)=>{ed=sd.node;this.Wcg(ed)&&this.oFb(ed,2)};this.uv=b;this.eb=k;this.fd=t;this.ib=D;this.zE=P;this.tl=Na;this.Ub=qb;this.Y6=ca;this.lC=ta;this.Zh=Vb;this.i6j=ac;this.cdh=X.a.create();this.yce(this.sY,this.Tha,this.amb);Kc&&Kc.execute(ed=>this.Pka=
ed);yc.execute(ed=>{this.cla=ed})}submitDocumentContentExtractionSignal(){this.cla&&this.cla.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.cla?this.cla.generateDocumentSummary():Promise.resolve(null)}generateDocumentSummaryDetails(){return this.cla?this.cla.generateDocumentSummaryDetails():Promise.resolve(null)}highlightDocumentKeySentences(){if(this.cla){const b=this.Oci();return this.cla.tUl(b,this.yX(b).toArray(),this.getRevision())}return Promise.resolve({success:!1,
resultCount:0})}clearDocumentKeySentencesHighlights(){this.cla&&this.cla.NWk()}getAllParagraphsInDocument(){const b=this.yX(this.Oci());for(const t of this.Zh.xO()){var k=FH.a.hRd(t.text[0]).split("\n");k=1===k.length?k[0]:k.join(" ");b.add(k)}return b.toArray()}extractDocumentObjects(b){var k=Object.assign(new dE.a,{QO:!1,Hba:!1,TO:!0}),t=this.eb.iEa(this.uv.value,k);k=[];const D=[];for(var P=0;P<t.count;++P){var ca=t.J(P);k.push(...this.EYl(ca,P));D.push(...this.Y6.IXl(ca,P))}t=[];P=this.Zh.xO();
for(ca=0;ca<P.length;ca++)t.push(this.jPl(P[ca]));P={};P.images=k;P.comments=t;P.highlights=D;b(P)}selectRange(b,k,t,D,P){const ca=Date.now(),ta={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.$Sa();if(0>b||0>k||0>t||0>D||b>t||b===t&&k>D)throw Error("Provided select range offsets incorrect");const Kc=Object.assign(new dE.a,{QO:!1,Hba:!0,Vna:this.wac(),TO:!0}),ed=this.eb.iEa(this.uv.value,Kc);if(t>=ed.count){const sd=Fa.a.instance.resolve("Common.Comments.ICommentModel").xO(),
oe=t-ed.count;if(oe<sd.length){P=-1;if(this.Y6.Naa.nb(oe)){const Od=this.Y6.Naa.J(oe).SCb;for(var Na=0;Na<Od.length;Na++)if(Od[Na].begin===k){P=Na;break}}this.iMa=-1!==P?Object.assign(new HH,{l8e:oe,PLc:P}):null;const Ld=sd[oe];w.AFrameworkApplication.va.processAction(Nc.a.zT,2);w.AFrameworkApplication.va.Qb(Nc.a.y3,2,null);w.AFrameworkApplication.va.Qb(Nc.a.selectComment,2,Object.assign(new wL.a,{commentId:Ld.id,C9:2,GR:this.GR}))}}else{this.iMa=null;var qb=ed.J(b),Jb=ed.J(t);if(!this.N_d(qb,k)||
!this.N_d(Jb,D))throw Error("Provided select range offsets incorrect");w.AFrameworkApplication.va.processAction(Nc.a.zT,2);this.yIo(qb);var Vb=this.zE.te(qb,k);Na=this.zE.jA(Vb,Of.a.Rc(Jb,D+1));if(P){const sd=Na.toArray();k=[];for(const oe of sd)k.push(this.WQd(oe.node));k.join(" ").includes(P)||(ta.success=!1,ta.message="The text in clicked passage does not match the selected hit")}var ac=this.tl.value.ru,yc=this.ib.hb.kb;yc&&yc.equals(Na)&&this.fd.Yca(ac,null);this.fd.Yca(ac,Na);ta.duration=Date.now()-
ca;this.logMessage(ta)}}catch(Kc){ta.success=!1,ta.message=Kc.stack,ta.duration=Date.now()-ca,this.logMessage(ta)}}search(b,k){this.$Sa();this.Y6.search(Object.assign(new EG,{query:b}),k)}searchV2(b,k){this.$Sa();this.Y6.searchV2(Object.assign(new EG,{query:b}),k)}selectNextPrevHighlight(b){this.$Sa();return this.Y6.selectNextPrevHighlight(b)}searchWithParam(b,k){this.$Sa();this.Y6.search(b,k)}searchWithParamV2(b,k){this.$Sa();this.Y6.searchV2(b,k)}highlight(b){this.$Sa();this.Y6.highlight(Object.assign(new EG,
{query:b}))}highlightWithParam(b){this.$Sa();this.Y6.highlight(b)}getRevision(){return this.cdh.toString()}getSelectedText(){const b=this.i6j.getSelectedText();return Object.assign(new Hx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new dE.a,{QO:!1,Hba:!0,Vna:this.wac(),TO:!0}),k=({ar:ca}=this.mam(b)).returnValue;if(k)return k;var t=this.ib.hb.kb;if(!t||!t.length)return null;k=t.Qa;t=t.Qc;let D=-1,P=-1;var ca=
ca||this.eb.iEa(this.uv.value,b);b=null;for(let ta=0;ta<ca.count;ta++){const Na=ca.J(ta);-1===D&&k.node.id===Na.id&&(D=ta,b=Na);-1===P&&t.node.id===Na.id&&(P=ta)}ca=null;5===(null===b||void 0===b?void 0:b.Kma)&&(ca=gw.txf);if(1===(null===b||void 0===b?void 0:b.Kma)||2===(null===b||void 0===b?void 0:b.Kma))ca=gw.fRf;return Object.assign(new GH,{subdocumentId:ca,startParagraphIndex:D,startParagraphOffset:k.Aj,endParagraphIndex:P,endParagraphOffset:t.Ip})}clearDocumentSelection(){IH(this.ib)}selectRangeV2(b,
k,t,D,P,ca){const ta=Date.now(),Na={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.$Sa();if(0>k||0>t||0>D||0>P||k>D||k===D&&t>P)throw Error("Provided select range offsets incorrect");var qb=Object.assign(new dE.a,{QO:!1,Hba:!0,Vna:this.wac(),TO:!0});const yc=this.eb.iEa(this.uv.value,qb);if(b==gw.p8e)this.Tgj(t,D,yc.count);else{qb=this.iMa=null;var Jb={};Jb.subdocumentId=b;Jb.startParagraphIndex=k;Jb.startParagraphOffset=t;Jb.endParagraphIndex=
D;Jb.endParagraphOffset=P;qb=b==gw.Ooi?this.V9h(yc.J(k),{isFloatingImage:!1,imageId:"",...Jb}):this.Chi(yc.J(k),yc.J(D),{clickedPassage:ca,...Jb},Na);var Vb=this.tl.value.ru,ac=this.ib.hb.kb;(null===ac||void 0===ac?0:ac.equals(qb))&&this.fd.Yca(Vb,null);this.fd.Yca(Vb,qb)}Na.duration=Date.now()-ta;this.logMessage(Na)}catch(yc){Na.success=!1,Na.message=yc.stack,Na.duration=Date.now()-ta,this.logMessage(Na)}}selectRangeV3(b){const k=Date.now(),t={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",
duration:0};try{this.$Sa();if(0>b.startParagraphIndex||0>b.startParagraphOffset||0>b.endParagraphIndex||0>b.endParagraphOffset||b.startParagraphIndex>b.endParagraphIndex||b.startParagraphIndex===b.endParagraphIndex&&b.startParagraphOffset>b.endParagraphOffset)throw Error("Provided select range offsets incorrect");var D=Object.assign(new dE.a,{QO:!1,Hba:!0,Vna:this.wac(),TO:!0});const ta=this.eb.iEa(this.uv.value,D);if(b.subdocumentId==gw.p8e)this.Tgj(b.startParagraphOffset,b.endParagraphIndex,ta.count);
else{D=this.iMa=null;D=b.subdocumentId==gw.Ooi?this.V9h(ta.J(b.startParagraphIndex),b):this.Chi(ta.J(b.startParagraphIndex),ta.J(b.endParagraphIndex),b,t);var P=this.tl.value.ru,ca=this.ib.hb.kb;(null===ca||void 0===ca?0:ca.equals(D))&&this.fd.Yca(P,null);this.fd.Yca(P,D)}t.duration=Date.now()-k;this.logMessage(t)}catch(ta){t.success=!1,t.message=ta.stack,t.duration=Date.now()-k,this.logMessage(t)}}Oci(){const b=Date.now(),k={activityName:"GetParagraphNodes",success:!0,message:"",duration:0},t=Object.assign(new dE.a,
{QO:!1,Hba:!1,TO:!0});k.duration=Date.now()-b;this.logMessage(k);return this.eb.iEa(this.uv.value,t)}yX(b){const k=Date.now(),t={activityName:"GetParagraphContent",success:!0,message:"",duration:0},D=new Eb.a;for(const P of b)D.add(this.WQd(P));t.duration=Date.now()-k;this.logMessage(t);return D}V9h(b,k){if(k.isFloatingImage)return k=X.a.If(k.imageId),b=b.Kc.Db(k),b=Gf.SelectionFactory.uq(b);const t=this.zE.te(b,k.startParagraphOffset);return b=this.zE.jA(t,Of.a.Rc(b,k.startParagraphOffset+1))}async getAuthorImageUrlFromClient(b,
k){b=new xg.a(b,"O365",k,b);if(!this.Pka||!this.Pka.getPersonaIconPropertiesArray)return null;b=await this.Pka.getPersonaIconPropertiesArray([b]);return 0<b.length&&b[0].authorImageURL?Object.assign(new xL,{authorImageURL:b[0].authorImageURL,authorColor:b[0].authorColor,authorID:b[0].authorID}):null}Chi(b,k,t,D){if(!this.N_d(b,t.startParagraphOffset)||!this.N_d(k,t.endParagraphOffset))throw Error("Provided select range offsets incorrect");t.subdocumentId==gw.txf?w.AFrameworkApplication.va.Qb(Nc.a.Bkb,
2,new Yk.a(b)):w.AFrameworkApplication.va.processAction(Nc.a.zT,2);t.subdocumentId==gw.fRf?32===w.AFrameworkApplication.va.Qb(Nc.a.E4a,2,new Yk.a(b))&&w.AFrameworkApplication.va.processAction(Nc.a.OMd,2):w.AFrameworkApplication.va.Qb(Nc.a.y3,2,null);b=this.zE.te(b,t.startParagraphOffset);k=this.zE.jA(b,Of.a.Rc(k,t.endParagraphOffset+1));if(t.clickedPassage){b=k.toArray();const P=[];for(const ca of b)P.push(this.WQd(ca.node));P.join(" ").includes(t.clickedPassage)||(D.success=!1,D.message="The text in clicked passage does not match the selected hit")}return k}Tgj(b,
k,t){const D=Fa.a.instance.resolve("Common.Comments.ICommentModel").xO();k-=t;if(k<D.length){t=-1;if(this.Y6.Naa.nb(k)){const P=this.Y6.Naa.J(k).SCb;for(let ca=0;ca<P.length;ca++)if(P[ca].begin===b){t=ca;break}}this.iMa=-1!==t?Object.assign(new HH,{l8e:k,PLc:t}):null;b=D[k];w.AFrameworkApplication.va.processAction(Nc.a.zT,2);w.AFrameworkApplication.va.Qb(Nc.a.y3,2,null);w.AFrameworkApplication.va.Qb(Nc.a.selectComment,2,Object.assign(new wL.a,{commentId:b.id,C9:2,GR:this.GR}))}}$Sa(){this.Ub&&(this.Ub.currentScope&&
this.Ub.currentScope.name===Fh.WB||this.Ub.mg(Fh.WB))}YVo(){this.cdh=X.a.create()}WQd(b){if(b.NGb)return"";b=this.eb.text(b);return Un.AParagraphNode.OU(b," ")}N_d(b,k){b=this.WQd(b);return k<b.length}oFb(b,k){switch(k){case 1:case 2:case 3:this.YVo()}}logMessage(b){const k=[Object.assign(new na.a,{name:"Message",string:b.message})];Object(bf.a)(b.activityName,b.success,b.duration,k)}Wcg(b){return!b.NGb&&this.JUc(b)}JUc(b){const k=this.uv.value;return!!k&&!!k.od&&!!b.Kc&&b.Kc.id.equals(k.od.id)}yIo(b){this.eb.$Tc(b)?
32===w.AFrameworkApplication.va.Qb(Nc.a.E4a,2,new Yk.a(b))&&w.AFrameworkApplication.va.processAction(Nc.a.OMd,2):w.AFrameworkApplication.va.Qb(Nc.a.y3,2,null)}yce(b,k,t){this.lC&&(this.lC.Fo(b),this.lC.Ot(k),this.lC.Kw(t))}mam(b){let k=null;var t=this.Ub?this.Ub.currentScope.name:"";if(!this.Zh.$s||t!==ef.AFrame.Gr&&t!==ef.AFrame.qM)return{returnValue:null,ar:k};t=Array.indexOf(this.Zh.xO(),this.Zh.$s);if(0>t)return{returnValue:null,ar:k};k=this.eb.iEa(this.uv.value,b);var D=FH.a.hRd(this.Zh.$s.text[0]).split("\n");
b=0;D=(1===D.length?D[0]:D.join(" ")).length-1;this.iMa&&t===this.iMa.l8e&&this.Y6.Naa.nb(t)&&this.Y6.Naa.J(t).SCb.length>this.iMa.PLc&&(b=this.Y6.Naa.J(t).SCb[this.iMa.PLc].begin,D=this.Y6.Naa.J(t).SCb[this.iMa.PLc].end);return{returnValue:Object.assign(new GH,{startParagraphIndex:k.count+t,startParagraphOffset:b,endParagraphIndex:k.count+t,endParagraphOffset:D,subdocumentId:"Comment"}),ar:k}}EYl(b,k){const t=[];if(12!=b.type)return t;t.push(...this.dZl(b,k));t.push(...this.IVl(b,k));return t}IVl(b,
k){const t=[],D=ze.GraphIterator.$a(b);if(!D.rA())return t;let P=D.Qd();for(;P;){if(!this.XPa(P)){P=D.qt();continue}const ca=P.properties;ca&&Be.ImageReader.iUc(ca)&&t.push(this.Uzj(ca,k,0,b.Kc,!0,P.id.toString()));P=D.qt()}return t}XPa(b){if(19!==b.type)return!1;b=ze.GraphIterator.$a(b);if(!b.rA())return!0;let k=b.Qd();for(;k;){if(59===k.type)return!1;k=b.qt()}return!0}dZl(b,k){const t=[],D=b.Kc;if(D){if(!b.hasProperty(sf.a.Gn))return t;var P=b.ia(sf.a.Gn,null);if(!P)return t;b=b.ia(sf.a.zm,null);
for(let ta=0;ta<P.length;++ta){var ca=P[ta];if(!ca)continue;ca=D.Db(ca);if(!ca||!Be.ImageReader.iUc(ca))continue;let Na=0;0!=ta&&b&&ta-1<b.length&&(Na=b[ta-1]);t.push(this.Uzj(ca,k,Na,D,!1,""))}return t}}Uzj(b,k,t,D,P,ca){D=(new Sys.Net.WebRequest).getResolvedUrl()+Be.ImageReader.sva(b,D,this.Ma,w.AFrameworkApplication.ta.IEa);const ta=b.ia(vd.a.Wt,""),Na={};Na.base64Encoding=ta;Na.url=D;Na.width=Be.ImageReader.ND(b);Na.height=Be.ImageReader.dJ(b);Na.altText=Be.ImageReader.uX(b);Na.description=Be.ImageReader.XOa(b);
Na.imageId=ca;Na.isFloatingImage=P;return{data:Na,startParagraphIndex:k,endParagraphIndex:k,startOffsetInParagraph:t,endOffsetInParagraph:t+1}}jPl(b){return{data:{comment:yL(b),authorName:b.author,authorEmail:b.authorId,objectId:b.objectId,authorImageURL:""},startParagraphIndex:-1,endParagraphIndex:-1,startOffsetInParagraph:-1,endOffsetInParagraph:-1}}}Object(n.a)(CL,"WordDocumentContentExecutor",EH,[]);class FG{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(n.a)(FG,
"BaseDocumentHelper",null,[336]);class DL extends FG{constructor(b){super();this.wHl=b}get O4b(){const b=this.wHl.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return Wa.App.ya.gb.isEditingAllowed}author(){var b;return null===(b=this.O4b)||void 0===b?void 0:b.author}createdDate(){var b;return null===(b=this.O4b)||void 0===b?void 0:b.creationDate}}Object(n.a)(DL,"WordDocumentHelper",FG,[]);class EL{constructor(b){this.xKi=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.hAf(b.htmlText)}getId(){return"InsertContentExecutor"}hAf(b){return this.executeCommand(Pb.a.nCa,
b)}executeCommand(b,k){const t=new th.DictionaryPropertySet;t.setValue(vd.a.gP,k);t.setValue(vd.a.Iia,!1);k=this.xKi.processAction(b,1);32===k&&(k=this.xKi.Qb(b,2,t));return k}}Object(n.a)(EL,"WordInsertContentExecutor",null,[277,278]);var jN=c(1691),kN=c(1692);class FL{constructor(b,k,t,D){this.Mqc="undefined";this.pcg="Something went wrong with retrieving a summary. Please try again.";this.gDm=(P,ca,ta,Na,qb)=>rv.RX(P,ca,ta,Na,this.jC,qb);this.cie=(P,ca,ta,Na,qb)=>{if(1===ta)return this.j7j?32:
8;P=cG.getSelectedText();P=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuDictionarySmartLookupWithQuery,cG.yRd(P));qb[tn.a.LabelText]=P;return 32};this.vmf=(P,ca,ta)=>{if(1===ta)return 32;const Na={};this.cla?this.cla.generateDocumentSummary().then(qb=>{qb||(qb=this.pcg,v.ULS.sendTraceTag(509723399,1303,15,"Share with summary: Generated document summary is empty."));Na.additionalData=this.y$e(qb);this.ga.Qb($a.a.Z7,2,Na)}).catch(()=>{v.ULS.sendTraceTag(509723398,1303,15,"Share with summary: Error in generating document summary.");
Na.additionalData=this.y$e(this.pcg);this.ga.Qb($a.a.Z7,2,Na)}):(v.ULS.sendTraceTag(509723397,1303,15,"Share with summary: Search provider manager is unavailable."),Na.additionalData=this.y$e(this.pcg),this.ga.Qb($a.a.Z7,2,Na));return 32};this.jKo=(P,ca,ta)=>{if(1===ta)return this.mSm()?32:2;2===ta&&(P={token:w.AFrameworkApplication.accessToken,files:G.c(this.MUl()),type:"MultiFilesDeckGeneration"},P=Object.assign(new jN.a,{selection:Object.assign(new Hx.a,{neighborhood:"",mentionStart:0,mentionLength:0}),
launchData:Object.assign(new qu.a,{landingTab:"All",data:P}),entryPoint:38}),this.ga.Qb($a.a.s8,2,P));return 32};this.jC=b;this.ga=k||w.AFrameworkApplication.va;this.Ma=t;this.T6j=(this.Fw=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.pJ)&&!!this.Ma&&this.Ma.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");this.j7j=!!this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1);D&&D.execute(P=>{this.cla=P})}Tb(){this.ga.fb(Nc.a.Hvh,Ud.a.frame,
this.gDm,1028);this.ga.fb(Nc.a.cie,Ud.a.frame,this.cie,1028);this.ga.fb(Nc.a.m2h,Ud.a.frame,this.vmf,1028);this.ga.fb(Nc.a.Vzj,Ud.a.frame,this.jKo,1028);this.T6j&&(this.Mqc=Wa.App.ya.DI.getWindowMode(),this.HVh(this.Mqc),Wa.App.ya.DI.registerBoundingWindowRectsChanged("SearchPane",(b,k)=>{k!==this.Mqc&&(this.Mqc=k,this.HVh(this.Mqc))}))}mSm(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableTransformToSlidesInRibbon",!1)&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableContentTransformInL2",
!1)}HVh(b){"DP"===b&&bk.UISurfaces.zu().then(k=>{k.selectors.getTabbedTaskPaneCount()||this.ga.Qb(Nc.a.Hvh,2,{SourceControlId:"smartlookupAuto"});return null})}y$e(b){return{["documentSummary"]:b}}MUl(){const b=new kN.a("Word",w.AFrameworkApplication.K.jb("EditDocInClientUrl"),w.AFrameworkApplication.K.jb("BreadcrumbBrandUrl"),"",w.AFrameworkApplication.sessionStartInfoSettings.FileSizeBytes,(new Date).toLocaleString()),k=[];Array.add(k,b);return k}}Object(n.a)(FL,"WordInsightsActor",null,[]);class UE{constructor(){this.hgd=
this.XP=null}b1a(){return this.eEb()}r$h(){return this.eEb()}p$h(){return null}wuo(b,k,t){this.XP||(this.XP=this.CGd());this.XP.nP(b,k,t)}xuo(b,k,t){this.XP||(this.XP=this.CGd());this.XP.peg(b,k,t)}Tso(b,k){this.hgd||(this.hgd=null);this.hgd&&this.hgd.peg(b,k)}GNb(b,k){this.XP||(this.XP=this.CGd());this.XP.GNb(b,k)}x0d(b){this.XP||(this.XP=this.CGd());this.XP.x0d(b)}Dbo(){this.XP&&this.XP.eic()}kgo(){this.XP&&this.XP.dge()}eso(){var b=w.AFrameworkApplication.K.mc("SmartLookupLaunchThrottleThresholdInMilliseconds",
1500);b=window.performance.now()-UE.dEi<=b;b||(UE.dEi=window.performance.now());return b}dispose(){this.XP&&(this.XP.dispose(),this.XP=null)}get pHb(){return this.XP?this.XP.isVisible:!1}}UE.dEi=0;Object(n.a)(UE,"InsightsManager",null,[960,9]);class FF{constructor(b,k,t,D,P,ca=!0,ta=null,Na=null){this.M5=this.yE=this.RKa=null;this.svc=!1;this.cea=null;this.Ub=k;this.XVb=ca;this.jSg=Na?Na:new FG;this.Gz=ta;this.$o=b;this.XVb&&(Fa.a.instance.Na("Common.App.SearchCommon.SearchHostRuntime")&&(this.cea=
Fa.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").wqf()),this.mcb=Fa.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.qyb=this.mcb.mPc())}Wlb(b){if(this.XVb){b=b.rawEvent;try{var k=G.a(b.data)}catch(t){v.ULS.sendTraceTag(595161728,1303,15,this.QT("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(k.actionType){case 101:b=0;this.yE&&(b=this.yE.entryPoint);this.mcb.Ptf(this.M5,this.jSg,this.I8b(),b).then(t=>{k.data=t;this.Smb(k)});break;
case 118:k.data=this.yE?this.yE:Object.assign(new Nt.a,{selection:Object.assign(new Hx.a,{neighborhood:this.RKa.neighborhood,mentionStart:this.RKa.mentionStart,mentionLength:this.RKa.mentionLength})});this.Smb(k);break;case 103:b=G.a(Object(Ka.a)(String,k.data));Rl.sendTelemetryEvent(b);break;case 206:this.mcb.Quf(k.data).then(t=>{k.data=t;this.Smb(k)});break;case 112:k.data.shiftPressed?(aa.a.jj&&document.activeElement.blur(),this.$o.mUd(0,null,2,null,null),v.ULS.sendTraceTag(592545156,1303,50,this.QT("Serplet UX lost focus through Ctrl + Shift + F6"))):
(this.$o.hQc(0,null,2,null,null),v.ULS.sendTraceTag(592545155,1303,50,this.QT("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Nna()}}}O5c(b){if(this.cea){var k=0;this.yE&&(k=this.yE.entryPoint);this.mcb.Ptf(this.M5,this.jSg,this.I8b(),k).then(t=>{Rl.Rhj("SearchFromHost",this.M5);this.yE.launchData||(this.yE.launchData=new qu.a);const D=BG();try{this.cea.search(this.yE,t,w.AFrameworkApplication.userSessionId,D,b),this.mcb.eAn(P=>{Rl.Rhj("SearchFromHostWithToken",this.M5);this.cea.searchAuthenticatedProviders(this.yE,
t,w.AFrameworkApplication.userSessionId,D,null,P)})}catch(P){Rl.zz("BaseSmartLookupPane - Fail to search from host. Error: "+P,10)}}).catch(t=>{Rl.zz("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+t.toString(),10)})}}fic(b){if(this.XVb){var k=Rl,t=k.fic,D=this.M5;b=Math.round(window.performance.now()-b);var P=this.yE?RE[this.yE.entryPoint]:"",ca=this.mcb.mPc(),ta=this.mcb.CUl(),Na=this.yE?this.yE.entryPoint:0;t.call(k,D,b,P,ca,ta,w.AFrameworkApplication.j0e,this.svc,
18===Na||19===Na||15===Na)}}}Object(n.a)(FF,"BaseSmartLookupPane",null,[330,9]);class GF{constructor(b){this.messageType=null;this.messageType=b}}Object(n.a)(GF,"InsightsMessage",null,[]);class HF extends GF{constructor(b,k){super(b);this.messageContent=null;this.messageContent=k}}Object(n.a)(HF,"InsightsMessageWithContent",GF,[]);class GL extends HF{constructor(b){super(Fh.mbn,b)}}Object(n.a)(GL,"InsightsMessageAppProperties",HF,[]);class HL extends HF{constructor(b){super(Fh.xbn,b)}}Object(n.a)(HL,
"InsightsMessageSelection",HF,[]);class IL extends GF{constructor(){super(Fh.zbn)}}Object(n.a)(IL,"InsightsMessageTakeFocus",GF,[]);class IF extends FF{constructor(b,k,t,D,P=null,ca=null,ta=null,Na=!0,qb=null,Jb=null){super(k,t,P,ca,ta,Na,qb,Jb);this.ffd=this.ZA=this.gj=null;this.yqd=!1;this.dld=b;this.$tc=this.XVb?zH(this.qyb):w.AFrameworkApplication.vBm;this.c_();this.e4f();this.Rp=D;this.YQg=0}get isVisible(){return!1}c_(){this.gj=this.dld.lIc();w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Sjb&&
this.gj.MUn(b=>{b===this.gj&&(this.dge(),this.eic())});this.Mzf(this.gj.uTa.pwh);this.gj.xm()}Mzf(b){b.style.overflow="hidden";const k=Va.a.createElement("iframe");Sys.UI.DomElement.addCssClass(k,"InsightsPaneIFrame");k.setAttribute("Unselectable","off");this.ZA=k;b.appendChild(this.ZA);this.ZA.id=Fh.oyf}e4f(){vf.a.addHandler(this.ZA,"load",Object(A.a)(this,this.Vlb,"onIFrameLoad"));vf.a.addHandler(this.ZA,"error",Object(A.a)(this,this.Ulb,"onIFrameError"));$addHandler(window,"message",Object(A.a)(this,
this.Wlb,"onIFrameMessage"))}qlg(){vf.a.removeHandler(this.ZA,"load",Object(A.a)(this,this.Vlb,"onIFrameLoad"));vf.a.removeHandler(this.ZA,"error",Object(A.a)(this,this.Ulb,"onIFrameError"));$removeHandler(window,"message",Object(A.a)(this,this.Wlb,"onIFrameMessage"))}dispose(){this.ZA&&(this.qlg(),this.ZA.parentNode.removeChild(this.ZA),this.ZA=null);this.gj&&(this.dld.I4b(this.gj),this.gj=null)}nP(b,k,t){this.M5=k;this.ffd=null;this.YQg=t;this.svc=!b.mentionLength;this.yqd=!1;v.ULS.sendTraceTag(6295947,
1303,50,this.QT("Start to show Insights"));this.RKa=b;this.$tc&&this.$tc.length?this.ZA.src=this.$tc:(this.ZA.src=IF.PQi,v.ULS.sendTraceTag(6295948,1303,15,this.QT("The Insights URL config setting is null or empty")));this.Rp.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0);this.gj.fY||this.gj.m4f(Object(A.a)(this,this.Fnn,"onInsightsTaskPaneHidden"));this.XVb&&this.O5c(!1);b=window.performance.now();this.dld.showTaskPane(this.gj);this.gj.xm();this.fic(b)}peg(b,k,t){this.yE=b;this.nP(Object.assign(new DF.a,
{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),k,t)}GNb(){}x0d(){}eic(){this.ZA.src===this.$tc&&this.yqd&&(this.Ub.mg(Fh.WB),this.Smb(new IL))}dge(){this.ZA&&ad.FocusManager.OJ(this.ZA.contentWindow)}Ecf(){this.ZA.src=IF.PQi;this.gj.ym()}Nna(){this.dld.hideTaskPane(this.gj);this.Ecf()}Fnn(b){b===this.gj&&this.Nna()}Vlb(){v.ULS.sendTraceTag(6295951,1303,50,this.QT("The iframe is successfully loaded in Insights task pane"))}Ulb(){v.ULS.sendTraceTag(6295952,
1303,15,this.QT("The iframe failed to load in Insights task pane"))}Wlb(b){const k=b.rawEvent;if(k.source===this.ZA.contentWindow)if(this.XVb)super.Wlb(b);else{let t;try{t=G.a(k.data)}catch(D){v.ULS.sendTraceTag(6295953,1303,15,this.QT("Message data [{0}] failed to deserialize.",k.data));return}if(Hf.c(t.messageType))v.ULS.sendTraceTag(6295954,1303,15,this.QT("Message data [{0}] is in wrong format.",k.data));else switch(t.messageType){case Fh.nbn:this.Smb(new GL(this.mZl()));break;case Fh.ybn:this.Smb(new HL(this.RKa));
break;case Fh.tbn:this.yqd=!0;this.dge();this.eic();v.ULS.sendTraceTag(6295955,1303,50,this.QT("Insights pane rendering is completed"));break;case Fh.Abn:b=t.messageContent;this.ffd=b.clientCorrelationId;this.M5!==b.appCorrelationId&&v.ULS.sendTraceTag(6403778,1303,15,this.QT("App correlation ID on client {0} does not match one on server {1}",this.M5,b.appCorrelationId));break;case Fh.sbn:t.messageContent?(aa.a.jj&&document.activeElement.blur(),this.$o.mUd(0,null,2,null,null),v.ULS.sendTraceTag(6604741,
1303,50,this.QT("Insights UX lost focus through Ctrl + Shift + F6"))):(this.$o.hQc(0,null,2,null,null),v.ULS.sendTraceTag(6604742,1303,50,this.QT("Insights UX lost focus through Ctrl + F6")));break;case Fh.pbn:t.messageContent.keyCode===pc.a.KIa&&this.Nna();break;case Fh.qbn:try{this.yqd=!1,localStorage.setItem(Fh.VEi,"true")}catch(D){v.ULS.sendTraceTag(17961859,1303,10,this.QT("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}mZl(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=
this.M5;3===w.AFrameworkApplication.ta.Nb.Sl?b.applicationName=Fh.M4o:4===w.AFrameworkApplication.ta.Nb.Sl&&(b.applicationName=Fh.iun);b.applicationVersion=w.AFrameworkApplication.buildVersion;var k=Xj.a.og(w.AFrameworkApplication.lcid);k=k?k.name:null;b.market=yH(k);b.uiLanguage=k;b.sessionId=w.AFrameworkApplication.userSessionId;b.parentalControl=Fh.eYf;b.clientType="user";b.legalAgreed=this.u_l();b.defaultDefineTab=1===this.YQg?"true":null;return b}QT(b,...k){const t={};this.M5&&(t[Fh.ixj]=this.M5);
this.ffd&&(t[Fh.MFo]=this.ffd);t[Fh.jxj]=String.format.apply(null,[b].concat(k));return G.c(t)}I8b(){return 5}u_l(){try{const b=localStorage.getItem(Fh.VEi);return!!b&&"true"===b}catch(b){return v.ULS.sendTraceTag(17961860,1303,10,this.QT("Failed to GetItem in LocalStorage for LegalAgreed")),!1}}Smb(b){b=G.c(b);this.ZA.contentWindow.postMessage(b,ia.a.getOrigin(this.$tc))}}IF.PQi="about:blank";Object(n.a)(IF,"InsightsPane",FF,[]);class JL{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(n.a)(JL,
"SmartLookupTaskPaneProps",null,[]);class KL{}Object(n.a)(KL,"ActionDescriptor",null,[]);class LL extends FF{constructor(b,k,t,D=null,P=null,ca=null,ta=!0,Na=null,qb=null){super(k,t,D,P,ca,ta,Na,qb);this.aUe=!!w.AFrameworkApplication.ta&&!!w.AFrameworkApplication.ta.Nb&&w.AFrameworkApplication.ta.Nb.AGf;this.Gs=this.SOe=!1;this.Q$j=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.O$j=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",
844);this.T$j=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.S$j=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);ta||Rl.zz("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.eBa=b;this.JYg=zH(this.qyb)}get isVisible(){return this.Gs}GNb(b,k){this.yE=b;this.RKa=b=Object.assign(new DF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,
mentionLength:b.selection.mentionLength});this.svc=!b.mentionLength;this.M5=k;this.O5c(!1)}x0d(b){this.yE=b;this.Gjc(Object.assign(new DF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),!1)}nP(b,k){this.M5=k;this.Gjc(b,!0)}peg(b,k,t){this.yE=b;this.nP(Object.assign(new DF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),k,t)}Nna(){this.Uca();this.eBa.hideTaskPane()}Gjc(b,
k){$b.SessionStatusManager.instance.KH&&this.cea?(this.RKa=b,this.svc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?w.AFrameworkApplication.K.$("SmartLookupDisableRefreshPaneIsEnabled")?(this.eBa.updateTaskPane(null),k&&this.jco()):(k&&this.O5c(!1),this.SOe=!this.SOe,this.eBa.updateTaskPane(this.eA())):(k&&this.O5c(this.isVisible),this.eBa.showTaskPane(this.eA())),this.fic(b)):(this.eBa.showTaskPane(this.eA()),Rl.Fbo($b.SessionStatusManager.instance.KH,!!this.cea,this.yE?
RE[this.yE.entryPoint]:"",this.mcb.mPc(),w.AFrameworkApplication.j0e,this.svc))}jco(){if(!this.yE){const b=Object.assign(new Hx.a,{neighborhood:this.RKa.neighborhood,mentionStart:this.RKa.mentionStart,mentionLength:this.RKa.mentionLength});this.yE=Object.assign(new Nt.a,{selection:b,userIntent:null,entryPoint:0,launchData:null})}this.O5c(this.isVisible)}Obo(){const b=new KL;b.transactionId=this.M5;b.actionType=15;b.channelId=Fh.channelId;this.Smb(b)}Wlb(b){const k=b.rawEvent;document.getElementById(Fh.WB)&&
k.source!==document.getElementById(Fh.WB).contentWindow||this.uNn(b)}uNn(b){const k=b.rawEvent;let t;try{t=G.b(k.data)}catch(D){v.ULS.sendTraceTag(545604257,1303,15,this.QT("Message data from Serplet [{0}] failed to deserialize.",k.data));return}switch(t.actionType){case 32:w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(fc.a.dFb()>=this.Q$j?this.eBa.updateTaskPane(this.kbf(this.O$j)):fc.a.dFb()>=this.T$j&&this.eBa.updateTaskPane(this.kbf(this.S$j)));
break;case 33:w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.eBa.updateTaskPane(this.kbf(t.data));break;case 42:this.eBa.updateTaskPane(this.edl(t.data));break;case 43:this.eBa.updateTaskPane(this.eA());break;default:super.Wlb(b)}}dispose(){}initialize(){this.c_();this.Wia()}c_(){this.eBa.lIc()}Wia(){const b=this.Ub.ge(Fh.WB);b.parent=ef.AFrame.rp;b.OH=!0}rgo(){this.Ub.mg(Fh.WB)}Uca(){this.l3a()&&this.Ub.mg(this.Ub.wT)}e4f(){$addHandler(window,
"message",Object(A.a)(this,this.Wlb,"onIFrameMessage"))}qlg(){$removeHandler(window,"message",Object(A.a)(this,this.Wlb,"onIFrameMessage"))}l3a(){return!!this.Ub.currentScope&&this.Ub.currentScope.name===Fh.WB}Smb(b){b=G.c(b);document.getElementById(Fh.WB)&&document.getElementById(Fh.WB).contentWindow.postMessage(b,ia.a.getOrigin(this.JYg))}QT(b,...k){const t={};this.M5&&(t[Fh.ixj]=this.M5);t[Fh.jxj]=String.format.apply(null,[b].concat(k));return G.c(t)}I8b(){return Qg.a("isSharedUXDarkModeOn")&&
appChrome.api.isSharedUXDarkModeOn()?3:0}iXi(){if(this.cea)this.cea.onPaneThemeChanged(this.I8b());return Qg.a("getTheme")?appChrome.api.getTheme():null}eic(){}dge(){document.getElementById(Fh.WB)&&ad.FocusManager.OJ(document.getElementById(Fh.WB).contentWindow)}Ulb(){Rl.zz("ReactSmartLookupPane - Iframe component failed to load.",10)}Vlb(){w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||Rl.zz("ReactSmartLookupPane - Onload detected no network.",
50)}wTl(){return this.yE?10===this.yE.entryPoint?2===w.AFrameworkApplication.ta.Nb.Sl?CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.yE.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.yE.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.yE.entryPoint||38===this.yE.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}eA(){var b=CommonUIStrings.L_SmartLookupPaneTitle;w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",
!1)&&(b=this.wTl());const k=new JL;k.src=this.JYg;k.id=Fh.WB;k.refreshPane=this.SOe;k.onError=Object(A.a)(this,this.Ulb,"onIFrameError");k.onLoad=Object(A.a)(this,this.Vlb,"onIFrameLoad");k.title=b;$b.SessionStatusManager.instance.KH?this.cea||(k.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,k.errorType=1):(k.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,k.errorType=0);b=Object.assign(new Dq.a,{title:b,hideHeader:!1,width:Fh.width,location:Fh.vxn,contentProps:k,
isModernPane:!0,onOpen:()=>{this.rgo();this.Gs=!0;this.e4f();Qg.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(A.a)(this,this.iXi,"onThemeIdChanged"));w.AFrameworkApplication.ta.updateCommandUI();if(this.cea)this.cea.onPaneStateChanged(!0)},onClose:()=>{this.Obo();this.Uca();this.Gs=!1;this.qlg();Qg.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(A.a)(this,this.iXi,"onThemeIdChanged"));w.AFrameworkApplication.ta.updateCommandUI();
if(this.cea)this.cea.onPaneStateChanged(!1)}});this.aUe&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}edl(b){const k=this.eA();k.title=b;k.contentProps.title=b;return k}kbf(b){const k=this.eA();k.resizeWidth=b;return k}}Object(n.a)(LL,"ReactSmartLookupPane",FF,[]);class ML{lIc(){const b=new ln.CuiHelper(Nh.a.oZa,WordEditorIntl.WordEditorStrings);return gs.a.instance.LMh(Fh.WB,Fh.kfc,Fh.width,Fh.Yhg,b)}showTaskPane(b){gs.a.instance.showTaskPane(b)}hideTaskPane(b){gs.a.instance.hideTaskPane(b)}I4b(b){gs.a.instance.I4b(Fh.WB,
b)}}Object(n.a)(ML,"WordInsightsPaneHandler",null,[317]);class NL{lIc(){gs.a.instance.KNa()}showTaskPane(b){bk.UISurfaces.zu().then(k=>{k.showTaskPane(Fh.WB,b);return null})}updateTaskPane(b=null){bk.UISurfaces.zu().then(k=>{k.setSelectedTaskPane(Fh.WB);b&&k.updateTaskPane(Fh.WB,b);return null})}hideTaskPane(){bk.UISurfaces.zu().then(b=>{b.hideTaskPane(Fh.WB,2);return null})}}Object(n.a)(NL,"WordReactSmartLookupPaneHandler",null,[307]);class OL extends UE{constructor(b,k){super();this.rx=b;this.ib=
k}CGd(){const b=!!w.AFrameworkApplication.ta&&!!w.AFrameworkApplication.ta.Nb&&w.AFrameworkApplication.K.$("SmartLookupEnableNativePane");return w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb&&w.AFrameworkApplication.ta.Nb.tFf?new LL(new NL,tl.a.instance,ad.FocusManager.instance(),Fa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Fa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Fa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),
b,Fa.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Fa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new IF(new ML,tl.a.instance,ad.FocusManager.instance(),Fa.a.instance.resolve("Common.Utils.IAriaNotifier"),Fa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Fa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Fa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Fa.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
Fa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}eEb(){return this.rx.getSelectedText()}p$h(){if(!this.ib||!this.ib.hb||1>this.ib.hb.length)return null;var b=this.ib.hb.kb.Qa;b=null==b?null:Je.FormattingReader.Kr(b);return(b=null==b?null:Xj.a.og(Je.FormattingReader.language(b)))?b.name:""}b1a(){return this.rx.Ctf()}r$h(){return this.rx.Ctf()}rxi(){return this.rx.HGm()}}Object(n.a)(OL,"WordInsightsManager",UE,[]);var lN=c(212);class PL{}Object(n.a)(PL,"CommandMetadataResponse",null,
[]);class eE{constructor(){this.ryf=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){lN.PrivacyDialogManager.$he()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const k=new PL;b.iconNames&&(k.svgData=this.getCommandIconSvg(b.iconNames));
if(!b.commandId||""===b.commandId)return k.isVisible=!1,k;try{k.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),b.commandId);k.isDisabled=appChrome.selectors.isControlDisabled(b.commandId);k.label=appChrome.selectors.getControlLabel(b.commandId);if(k.svgData&&""!==k.svgData)return k;const t=appChrome.selectors.getControlIconSet(b.commandId),D=Array(2);D[0]=t["default"];D[1]=t.icon32;k.svgData=this.getCommandIconSvg(D)}catch(t){return null}return k}getCommandIconSvg(b){if(!this.ryf)return"";
for(let k=0;k<b.length;k++){const t=b[k];if(t in this.ryf)return this.ryf[t]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const k={SourceControlId:"GiveFeedback"};k.feedbackType="true"===b.IsPosFeedback?0:1;const t={};t.featureArea=eE.Iyl;k.telemetryGroup=t;k.appData=b;return k}}eE.Tmi="FA000000012";eE.queryPrefix="AssetID=";eE.Iyl="SearchPane";Object(n.a)(eE,"BaseSerpletExecutor",null,[318,278]);
class QL extends eE{constructor(b,k){super();this.ga=b;this.ib=k}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Qb(Pb.a.tIb,2,null);break;case 1:this.ga.Qb(Nc.a.ROb,2,null);break;case 2:this.ga.Qb(Pb.a.digitalPrintToSway,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Qb($a.a.dXd,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Qb($a.a.yNb,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const k=
{};k.CommandValueId=b;k.SourceControlId="Insights";this.ga.Qb($a.a.akf,2,k)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};IH(this.ib);this.ga.Qb($a.a.akf,2,b)}openFindTaskPane(b){const k={};k.CommandValueId=b;k.SourceControlId="Insights";this.ga.Qb($a.a.findInDocument,2,k)}openNavigationPane(){this.ga.Qb(Nc.a.Cjc,2,null)}openSerpletTaskPane(){this.ga.Qb($a.a.gti,2,null)}sendAutoLaunchSearchRequest(){this.ga.Qb($a.a.XWd,2,null)}getAllIcons(){const b=
{};for(const t of Object.keys(window))if(t.startsWith("word")){var k=window[t];k&&(k=k.icons,null!==k&&void 0!==k&&k.length&&k.forEach(D=>b[D.id]=JSON.stringify(D)))}return b}}Object(n.a)(QL,"WordSerpletExecutor",eE,[]);class RL extends BH{constructor(){super();this.qMe=null;this.Lx=()=>{w.AFrameworkApplication.Q_&&(this.eql(),yp.a.kl().then(()=>this.qMe.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){w.AFrameworkApplication.Q_&&(this.qMe.Na("WordEditor.Insights.WordInsightsActor").Tb(),
w.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&w.AFrameworkApplication.K.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?w.AFrameworkApplication.K.No(this.Lx):super.init())}xc(b){super.xc(b);this.qMe=b;b.ha("Box4.Insights.Box4InsightsSelection",()=>new fp.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance();b.ha("WordEditor.Insights.WordInsertContentExecutor",()=>new EL(w.AFrameworkApplication.va)).as("Common.App.SearchCommon.IInsertContentExecutor").singleInstance();
b.ha("WordEditor.Insights.WordSerpletExecutor",()=>new QL(w.AFrameworkApplication.va,af.a.instance)).as("Common.App.SearchCommon.ISerpletExecutor").singleInstance();b.ha("WordEditor.Insights.AugloopSearchProviderManager",()=>new cE(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"),b.resolve("Box4.Search.IFindManagerHelper"),hL.a.instance,dd.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"))).as("WordEditor.Insights.IAugloopSearchProviderManager").singleInstance();b.ha("WordEditor.Insights.WordDocumentContentExecutor",
()=>{const k=new gw(new Rg.a(()=>Wa.App.ya?Wa.App.ya.gb.Uc:null),b.resolve("Box4.IParagraphReader"),tL.a.instance,w.AFrameworkApplication.K,dd.a.instance,hL.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),w.AFrameworkApplication.va,af.a.instance,b.resolve("Box4.ISelectionFactory"));k.initialize();return new CL(new Rg.a(()=>Wa.App.ya?Wa.App.ya.gb.Uc:null),b.resolve("Box4.IParagraphReader"),Lb.InteractiveViewManager.instance,af.a.instance,b.resolve("Box4.ISelectionFactory"),
k,Wa.App.Lj.Bl.Ze(12),new Rg.a(()=>Wa.App.ya.gb),ad.FocusManager.instance(),w.AFrameworkApplication.K,b.resolve("Common.Comments.ICommentModel"),b.resolve("Common.App.Insights.IInsightsSelection"),b.Sa("WordEditor.Insights.IAugloopSearchProviderManager"),b.Sa("Common.App.People.IExternalPeopleAPI"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").singleInstance();b.ha("WordEditor.Insights.WordInsightsManager",()=>new OL(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").singleInstance();
b.ha("WordEditor.Insights.WordInsightsActor",()=>new FL(b.Ue("Common.App.Insights.IInsightsManager"),w.AFrameworkApplication.va,w.AFrameworkApplication.K,b.Sa("WordEditor.Insights.IAugloopSearchProviderManager"))).singleInstance();b.ha("Common.App.SearchCommon.IDocumentHelper",()=>new DL(b.Sa("WordEditor.Extension.DocumentProperties"))).singleInstance()}}Object(n.a)(RL,"WordInsightsPackage",BH,[]);class mN{}Object(n.a)(mN,"ScalingStep",null,[]);class SL{constructor(b,k,t){this.Euc=!1;this.EP=null;
this.yBc=this.JVb=!1;this.cYa=[];this.Lde=D=>{this.s$&&this.s$!==D&&appChrome.api.dispatch(this.jfi(!1))};k.execute(D=>{this.EP=D});b.Lw(Object(A.a)(this,this.Rrn,"onProcessSetSelectionFinished"));this.Hp=t}n8b(b,k,t){const D=[];for(const P of b)D.push(appChrome.actions.addScalingStepInTab("Home",{type:k,controlId:P},t));return D}Edi(b){const k=[];for(let t=0;4>t;t++)k.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>t?0:void 0));k.push(appChrome.actions.addScalingStepInTab("Home",
{type:"GalleryToFlyout",controlId:b},void 0));return k}jfi(b){const k=[];if(b)switch(this.s$){case "Image":k.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));k.push(...this.Edi("PictureStyles"));k.push(...this.n8b("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),"DropLabel"));b=this.cYa.slice().reverse();b.push("TextAlignmentAnchor");k.push(...this.n8b(b,"MoveToOverflow"));break;case "Table":this.yBc||
k.push(...this.Edi("TableStyles"));k.push(...this.n8b(this.cYa,"DropLabel",this.yBc?0:void 0));b=this.cYa.slice().reverse();k.push(...this.n8b(b,"MoveToOverflow"));break;case "Hyperlink":k.push(...this.n8b(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.cYa.slice().reverse(),k.push(...this.n8b(b,"MoveToOverflow"))}else for(const t of this.cYa)k.push(appChrome.actions.removeControlScalingStepsFromTab(t,"Home"));return k}xad(b){const k={};for(const t of b)try{k[t]=appChrome.selectors.getModelType(t)}catch(D){this.DG("Error",
"GetModelType failed for "+t)}Wa.App.ya.aNd(k)}DQo(b){if(0!==b.length){var k=[],t={},D=!1;for(const P of b)try{if(appChrome.selectors.isControlDefined(P))t[P]=appChrome.selectors.getModelType(P);else{D=!0;break}}catch(ca){this.DG("Error","GetModelType failed for "+P);D=!0;break}if(D)this.s$=void 0,this.ene(!1);else{if("Image"===this.s$&&!this.JVb)k.push(appChrome.actions.updateGroupHiddenState("Font",!0)),this.JVb=!0;else if(this.JVb){k.push(appChrome.actions.updateGroupHiddenState("Font",!1));D=
appChrome.selectors.getVisibleControlsInGroup("Font");for(const P of D)t[P]=appChrome.selectors.getModelType(P);this.JVb=!1}Wa.App.ya.aNd(t);this.cYa=b;t=[];for(const P of b)appChrome.selectors.isControlDisabled(P)&&t.push(P);0<t.length&&this.DG("Disabled",t.join(","));0<this.cYa.length&&(k.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),k.push(appChrome.actions.updateControlsInGroup("Adaptive",this.cYa)),k.push(...this.jfi(!0)),this.Euc=!0);appChrome.api.dispatch(k)}}}ene(b){if(b||
this.Euc){var k=[];k.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.Euc=b;if("Image"===this.s$||this.JVb){b=!b;k.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const t=appChrome.selectors.getVisibleControlsInGroup("Font");this.xad(t)}this.JVb=!b}appChrome.api.dispatch(k)}}XTa(){this.Euc&&this.Hp&&this.Hp.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}Rrn(b,k){!w.AFrameworkApplication.ta.Nb.ojc&&"Home"===appChrome.selectors.getSelectedTabId()&&
this.EP&&k.nl&&k.nl.kb&&0!==k.nl.length?(b=()=>{let t=[],D=!1;var P=this.EP.contentType,ca=appChrome.selectors.getActiveContextualTabIds();P.includes("Image")?(this.Lde("Image"),this.s$&&"Image"===this.s$?D=!0:(t="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),this.s$="Image")):P.includes("Table")&&0<=ca.indexOf("Table")?(P=!(Dt.a.instance.kb.FFa||Dt.a.instance.kb.kw||
Dt.a.instance.kb.SHb),(ca="Table"===this.s$&&P!==this.yBc)?this.Lde("TableCellEdit"):this.Lde("Table"),!this.s$||"Table"!==this.s$||ca?(P?(t=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.yBc=!0):(t="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),this.yBc=!1),this.s$="Table"):D=!0):
P.includes("Hyperlink")&&(this.Lde("Hyperlink"),this.s$&&"Hyperlink"===this.s$?D=!0:(t=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.s$="Hyperlink"));D?this.Euc||(this.xad(this.cYa),this.ene(!0),this.XTa()):0<t.length?(this.DQo(t),this.XTa()):this.ene(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.ene(!1)}DG(b,k){b={Time:(new Date).getTime(),Event:b,Message:k,Scenario:"AdaptiveTabGroup"};k=new ph.a;k.name="Events";
k.dataFields=al.a.wC(b);k.durationMs=window.performance.now();ea.a.rHa(k,"TellMeWAC.")}}Object(n.a)(SL,"AdaptiveTabGroupUpdater",null,[]);class TL{constructor(){this.W=null;this.Xin=()=>{w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.W.ha("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new SL(this.W.resolve("Box4.ISelectionManager"),this.W.Sa("Common.IActionContextProvider"),this.W.Sa("Common.ISystemInitiatedFeedback"))).singleInstance(),
this.W.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}xc(b){this.W=b}init(){BD.a(1,this.Xin)}dispose(){}}Object(n.a)(TL,"PackageManager",null,[1,2]);const nN=(b,k,t)=>1===t?32:2===t?(c.e(4).then(c.bind(null,2027)).then(D=>{D.createAndShowDevToolsMenu()}),32):2;class JH{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))w.AFrameworkApplication.va.qa(Nc.a.Rdg,Ud.a.frame,nN),null!==sessionStorage.getItem("devToolsRefresh")&&c.e(4).then(c.bind(null,2027))}dispose(){}xc(){}static main(){N.a.instance.Fc(new JH)}}Object(n.a)(JH,"WordDevToolsPackage",null,[1,2]);c(575);class KH{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(n.a)(KH,"FormattingData",null,[]);class UL extends KH{constructor(){super();this.hyperlinkData=null}}Object(n.a)(UL,"RichContentCommandData",
KH,[]);class Gi{constructor(){Gi.Yi.add(Nc.a.d7a);Gi.Yi.add(Nc.a.lPb);Gi.Yi.add(Nc.a.xkc);Gi.Yi.add(Nc.a.NY);Gi.Yi.add(Nc.a.MQf);Gi.Yi.add(Nc.a.x_f);Gi.Yi.add(Nc.a.deleteComment);Gi.Yi.add(Nc.a.TIc);Gi.Yi.add(Nc.a.edf);Gi.Yi.add(Nc.a.tie);Gi.Yi.add(Nc.a.n7a);Gi.Yi.add(Nc.a.Rdg);Gi.Yi.add(Nc.a.ROb);Gi.Yi.add(Nc.a.Ydg);Gi.Yi.add(Nc.a.SJc);Gi.Yi.add(Nc.a.mJd);Gi.Yi.add(Pb.a.digitalPrintToSway);Gi.Yi.add(Pb.a.openInClient);Gi.Yi.add(Pb.a.print);Gi.Yi.add(Pb.a.tae);Gi.Yi.add(Pb.a.V1f);Gi.Yi.add(Pb.a.readingMode);
Gi.Yi.add(Pb.a.tIb);Gi.Yi.add($a.a.Iyj);Gi.Yi.add($a.a.tellMe);Gi.Yi.add($a.a.Q9c);Gi.Yi.add($a.a.yNb);Gi.Yi.add($a.a.giveFeedback);Gi.Yi.add($a.a.Z7c);Gi.Yi.add($a.a.Kdg);Gi.Yi.add($a.a.Oog);Gi.Yi.add($a.a.Z7);Gi.Yi.add($a.a.newComment);Gi.Yi.add($a.a.P7e);Gi.Yi.add($a.a.HQa);Gi.Yi.add($a.a.L6f);Gi.Yi.add($a.a.K6f);Gi.Yi.add($a.a.M6f);Gi.Yi.add($a.a.BId);Gi.Yi.add($a.a.Kla);Gi.Yi.add($a.a.Hie);Gi.Yi.add($a.a.Jqj);Gi.Yi.add($a.a.close);Gi.Yi.add($a.a.kbe);Gi.Yi.add($a.a.Aae);Gi.Yi.add($a.a.A8d);Gi.Yi.add($a.a.Cie);
Gi.Yi.add($a.a.Gie);Gi.Yi.add($a.a.zLb);Gi.Yi.add($a.a.renameFile);Gi.Yi.add($a.a.$9b);Gi.Yi.add($a.a.xeg);Gi.Yi.add($a.a.Jjc);Gi.Yi.add($a.a.downloadACopy);Gi.Yi.add($a.a.Qhc);Gi.Yi.add($a.a.s$d);Gi.Yi.add($a.a.eMb);Gi.Yi.add($a.a.C4i);Gi.Yi.add($a.a.WEh);Gi.Yi.add($a.a.bEd);Gi.Yi.add($a.a.O7e);Gi.Yi.add($a.a.YEh);Gi.Yi.add($a.a.XEh);Gi.Yi.add($a.a.P7e);Gi.Yi.add($a.a.cEd);Gi.Yi.add(Nc.a.ppe);Gi.Yi.add(Nc.a.Kpg);Gi.Yi.add(Nc.a.zoomToPageWidth);Gi.Yi.add(Nc.a.H9f);Gi.Yi.add(Nc.a.cnb);Gi.Yi.add(Nc.a.Dbe);
Gi.Yi.add(Nc.a.yja);Gi.Yi.add($a.a.Kib);Gi.Yi.add($a.a.tfb);Gi.Yi.add($a.a.Mjc);Gi.Yi.add($a.a.XKj);Gi.Yi.add($a.a.J4i);Gi.Yi.add(Pb.a.lLb);Gi.Yi.add(Pb.a.Xha)}}Gi.Yi=new Set;Object(n.a)(Gi,"CommentRibbonCommands",null,[]);class VL{constructor(b,k,t,D,P){this.kQi=b;this.ai=k;this.lp=t;this.mf=D;this.cHo=P;this.mYb=null;this.Kza=new bc.a(0);this.rrb=new bc.a(0);this.Hte=new bc.a(0);this.ZVe=!1;this.Dwm();this.xVn()}GFm(b){return this.mYb&&this.lp.ny?!Gi.Yi.has(b):!1}U8b(b,k,t){if(b===$a.a.Hg)return 32;
if(!this.Kza.nb(b)&&!this.rrb.nb(b)||!this.mYb)return 2;const D=this.rrb.nb(b);var P=D?this.rrb.J(b):this.Kza.J(b);const ca=D?2:this.Hte.J(t);D||1!==ca||(this.cJm(Wa.App.ya.Bp.currentScope.name)||Wa.App.ya.Bp.mg(this.ai.Zm?ef.AFrame.Gr:ef.AFrame.qM),Wa.App.ya.updateCommandUI(!0));t=new UL;switch(P){case 1:t.highlight={color:this.iei(k.Color)};break;case 6:t.fontColor={color:this.iei(k.Color)}}P=this.mYb.executeCommand(P,ca,t);2===P&&D&&(b===Pb.a.kgc?k[kg.a.On]=!!t.bold:b===Pb.a.qgc?k[kg.a.On]=!!t.italic:
b===Pb.a.Agc?k[kg.a.On]=!!t.underline:b===Pb.a.ugc?k[kg.a.On]=!!t.strikethrough:b===Pb.a.GY?k[kg.a.On]=!!t.highlight:b===Pb.a.Mv&&(k[kg.a.On]=!!t.fontColor));return 2===P?32:1===P?2:8}ASn(b){this.mYb=b;this.mYb.registerSelectionChangeHandler(()=>{this.ZVe||(this.ZVe=!0,Wa.App.ya.updateCommandUI(!0),this.ZVe=!1)});this.mYb.registerKeypressHandler(k=>{if(k.shortKey)switch(k.key){case pc.a.BRb:case pc.a.FRb:case pc.a.Tqe:case pc.a.HUa:Wa.App.ya.updateCommandUI(!0)}k.key!==pc.a.aC&&k.key!==pc.a.s1||Wa.App.ya.updateCommandUI(!0)})}xVn(){this.kQi.u8i(ef.AFrame.Gr,
this);this.kQi.u8i(ef.AFrame.qM,this)}Dwm(){this.Kza.Z(Pb.a.bold,0);this.Kza.Z(Pb.a.setItalic,3);this.Kza.Z(Pb.a.strikethrough,4);this.Kza.Z(Pb.a.underline,5);this.Kza.Z(Pb.a.GY,1);this.Kza.Z(Pb.a.Yta,1);this.Kza.Z(Pb.a.Mv,6);this.Kza.Z(Pb.a.qfa,6);this.Kza.Z(Pb.a.fqa,6);this.rrb.Z(Pb.a.kgc,0);this.rrb.Z(Pb.a.qgc,3);this.rrb.Z(Pb.a.ugc,4);this.rrb.Z(Pb.a.Agc,5);this.Hte.Z(1,0);this.Hte.Z(2,1)}cJm(b){return b===ef.AFrame.Gr||b===ef.AFrame.qM}iei(b){return b?ch.a.XE(this.cHo.RCa(this.mf.ed,b)):""}}
Object(n.a)(VL,"CommentRibbonCommandHandler",null,[565,566]);class LH{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.W.resolve("WordEditor.Comments.CommentsState").E2f?this.W.resolve("WordEditor.Comments.CommentRibbonCommands"):this.W.resolve("WordEditor.Comments.WordCommentEventsActor").u9("OnCommentRenderedOnce",()=>{this.W.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}xc(b){this.W=
b;this.W.ha("WordEditor.Comments.CommentRibbonCommandHandler",()=>new VL(this.W.Na("Common.INonCanvasCuiUser"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("Common.Comments.ICommentModel"),Yl.App.Ln.gb.wc,Xk.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").singleInstance();this.W.ha("WordEditor.Comments.CommentRibbonCommands",()=>new Gi).singleInstance()}static main(){N.a.instance.Fc(new LH)}}Object(n.a)(LH,"PackageManager",null,[1,2]);var oN=c(1926);class JF{constructor(b,
k){this.Hgl=2E3;this.jmh=null;this.SXf=b.UZi;this.maxLength=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.Hgl);k&&k.execute(t=>{this.jmh=t})}Pnf(b){b=this.tNl(b,this.maxLength);return{semantic:Ko.ObjectSemantic.CanvasContext,type:Ko.ObjectSchemaType.WordCanvasContext,value:b}}tNl(b,k){try{return this.sNl(b,k)}catch(t){return v.ULS.sendTraceTag(522725067,1303,15,"Error processing selection for Canvas Context: {0}",t),null}}sam(b,k){const t={Z_a:[],
lxa:0,selection:{start:null,end:null},cursor:null,tiles:[]},D=b.length;for(let ca=0;ca<D;ca++){const ta=b.J(ca);var P=ta.node;if(!pe.ParagraphReader.Wb(P)||Array.contains(t.Z_a,P.Cl))continue;t.Z_a.push(P.Cl);const Na=pe.ParagraphReader.textLength(P);if(t.lxa+Na>k)break;P=this.SXf.RAb(P);t.tiles.push(P);t.lxa+=Na;1!==D||t.cursor||(t.cursor=JF.HRl(ta,t.tiles.length-1));null===t.selection.start&&0===ca&&(t.selection.start=this.Ghi(ta,!0,t.tiles.length-1));null===t.selection.end&&ca===D-1&&(t.selection.end=
this.Ghi(ta,!1,t.tiles.length-1))}return t}s2l(b,k,t){const D={c$c:[],dyj:[],lxa:0};var P=b.J(0).node;let ca=b.J(b.length-1).node;for(b=k;0<b&&(P||ca);){var ta=JF.g3i(P,!0,b,t);if(P=ta.node)P=this.SXf.RAb(P),D.c$c.push(P),b-=ta.lxa,P=ta.node,t=ta.Z_a;ta=JF.g3i(ca,!1,b,t);if(ca=ta.node)t=this.SXf.RAb(ca),D.dyj.push(t),b-=ta.lxa,ca=ta.node,t=ta.Z_a}D.lxa=k-b;return D}uNl(b,k){let t=0;var D=this.sam(b,k);const P={tiles:D.tiles,selection:D.selection,cursor:D.cursor};t+=D.lxa;D=D.Z_a;t<k&&(b=this.s2l(b,
k-t,D),P.tiles.unshift.apply(P.tiles,b.c$c),P.tiles.push.apply(P.tiles,b.dyj),P.selection.start&&(P.selection.start.index+=b.c$c.length),P.selection.end&&(P.selection.end.index+=b.c$c.length),P.cursor&&(P.cursor.index+=b.c$c.length));return P}sNl(b,k){var t;if(!b)return null;b=this.uNl(b,k);return{contentType:null===(t=this.jmh)||void 0===t?void 0:t.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}Ghi(b,k,t){if(b.contextId===lc.a.Hd||b.contextId===lc.a.paragraph||b.contextId===
lc.a.Tc){if(k&&-1!==b.Aj)return{index:t,offset:b.Aj};if(!k&&-1!==b.Ip)return{index:t,offset:b.Ip}}return null}static HRl(b,k){return b.contextId===lc.a.Tc?{index:k,offset:b.Aj}:null}static g3i(b,k,t,D){D={node:null,lxa:0,Z_a:D};if(!b||0>=t||!D.Z_a)return D;do D.node=pe.ParagraphReader.ig(b,k,!1,!1),D.lxa=D.node?pe.ParagraphReader.textLength(D.node):0,b=D.node;while(D.node&&(Array.contains(D.Z_a,D.node.Cl)||!pe.ParagraphReader.Wb(D.node)||!D.lxa));D.node&&(D.lxa>t?D.node=null:D.Z_a.push(D.node.Cl));
return D}}Object(n.a)(JF,"Box4CanvasContextProvider",null,[240]);class MH{get name(){return"Box4.CanvasContext"}init(){}dispose(){}xc(b){b.ha("Box4.CanvasContext.Box4CanvasContextProvider",()=>new JF(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.Sa("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").singleInstance()}static main(){N.a.instance.Fc(new MH)}}Object(n.a)(MH,"Box4CanvasContextPackage",null,[1,2]);class XL{constructor(b,k){this.Rv={};this.y_b=
this.wtd=0;this.OHd=3E4;this.start=()=>{0!=this.wyb.size&&0===this.y_b&&(this.y_b=window.setInterval(this.h8n,this.OHd),v.ULS.sendTraceTag(509215365,306,50,"Starting watchdog task"))};this.h8n=()=>{if(0!=this.wyb.size)if(this.af.jo)v.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop();else{var t=50;this.Rv.ScanTime=Date.now();this.Rv.NumWatchDogs=this.wyb.size;this.Rv.WatchDogManagerScanNumber=++this.wtd;this.wyb.forEach(async(D,P)=>{this.Rv[P]=await D.xcn();D.uTm()||(t=15)});
v.ULS.sendTraceTag(520974674,306,t,JSON.stringify(this.Rv))}};this.af=b;this.$We=new Map;this.wyb=new Map;k.execute(t=>{this.il=t;this.il.RMa((D,P)=>{this.DX(P)})})}DX(b){2!==b.oldState&&3!==b.oldState||1!==b.newState&&0!==b.newState?2!==b.newState&&3!==b.newState||0===this.y_b||(v.ULS.sendTraceTag(509215698,306,50,"WatchDogManager stopping for {0}",b.newState),this.stop()):(this.stop(),this.start(),this.r4n(),v.ULS.sendTraceTag(509219479,306,50,"WatchDogManager returning from {0} to {1}",b.oldState,
b.newState))}stop(){0!==this.y_b&&(window.clearInterval(this.y_b),this.y_b=0);v.ULS.sendTraceTag(509215696,306,50,"Stopping watchdog task")}$tk(b,k){this.$We.set(b,k)}U4n(){this.PDn(this.$We)}get kAk(){return this.$We.size===this.wyb.size}PDn(b){b.forEach((k,t)=>{k.execute(D=>{D?(this.wyb.set(t,D),this.start()):v.ULS.sendTraceTag(512550848,306,10,"WatchDog {0} resolved to null",t)})})}r4n(){this.wyb.forEach(b=>{b&&b.L5a()});v.ULS.sendTraceTag(509138259,306,50,"WatchDogs reset")}}Object(n.a)(XL,"WatchDogManager",
null,[239]);class NH{constructor(){this.W=this.vyb=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.vyb=this.W.resolve(this.name);this.Eym()}dispose(){this.vyb&&this.vyb.stop()}xc(b){this.W=b;b.ha(this.name,this.Odl.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").singleInstance()}static main(){N.a.instance.Fc(new NH)}KIj(){if(!this.vyb.kAk){const b=[];let k=0;this.rtd.forEach((t,D)=>{t&&(this.W.Na(D)||(b[k++]=D))});if(0<b.length)if(this.hqo){const t=!this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager").aR;
v.ULS.sendTraceTag(508965916,306,10,"{0} did not resolve. HasDataLoss: {1}",b,t)}else v.ULS.sendTraceTag(512550819,306,10,"{0} did not resolve",b)}}Odl(){return new XL(this.W.resolve("Common.ISessionStatus")||$b.SessionStatusManager.instance,this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"))}Suk(){if(this.bso)window.setTimeout(this.KIj.bind(this),this.X0o);else{const b=new Df.a(1,1,12E4,this.KIj.bind(this),216);w.AFrameworkApplication.nc.Vb(b)}}Zuk(){this.rtd=new Map;this.rtd.set("WordEditor.RunawayDataLossMonitorWatchDog",
Wa.App.um||Wa.App.es);this.rtd.set("WordEditor.LastSavedToHostDetailsManagerWatchDog",!0)}Eym(){this.Zuk();this.Yuk(this.rtd,this.vyb.$tk.bind(this.vyb));this.vyb.U4n();this.Suk()}Yuk(b,k){b.forEach((t,D)=>{t&&k(D,this.W.Sa(D))})}get bso(){return null!=this.fGg?this.fGg:this.fGg=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchToJSSchedulingForWatchdogEnabled",!1)}get X0o(){return null!=this.VJg?this.VJg:this.VJg=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.WatchdogResolveIntervalMs",
3E5)}get hqo(){return null!=this.dGg?this.dGg:this.dGg=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LogDataLossForWatchDogEnabled",!1)}}Object(n.a)(NH,"WatchDogManagerPackage",null,[1,2]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");
Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");
Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");
Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");
Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");
Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");
Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");
Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");R.main();Type.registerNamespace("Common.App.WopiIdentity");ma.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");xb.main();Object(oN.a)(!1);pb.main();Ra.main();yb.main();JH.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");cd.main();Type.registerNamespace("Common.App.AltTextDialog");
Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");hh.main();Type.registerNamespace("Common.App.WildFire");yd.main();Type.registerNamespace("Common.App.BrowserInfoLogger");ve.main();Type.registerNamespace("Common.App.HostNotification");Wc.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");rh.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");
Type.registerNamespace("Common.App.LivePersonaUtils");md.main();Type.registerNamespace("CNT");cm.main();Type.registerNamespace("Common.App.NewAndOpen.Core");N.a.instance.Fc(new dm);Type.registerNamespace("Common.App.NewAndOpen.UX");N.a.instance.Fc(new ge);Type.registerNamespace("Common.App.OneDriveFilePickerApi");gi.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");fe.main();Type.registerNamespace("Common.Search");
Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");rl.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");ic.main();Type.registerNamespace("CADWLTR");Lc.main();Type.registerNamespace("Common.App.DirectPrint");N.a.instance.Fc(new dj);Type.registerNamespace("Common.App.SearchOAuthManager");lj.main();Cf.main();No.main();Xo.main();op.main();uf.main();N.a.instance.Fc(new ld);ej.main();bl.main();km.main();
N.a.instance.Fc(new oo);Type.registerNamespace("Common.App.SaveStatus");N.a.instance.Fc(new Do);Type.registerNamespace("Common.App.EventsCacheManager");Aj.main();Type.registerNamespace("CUIB");Nr.main();Type.registerNamespace("CommandUI.TaskPane");try{N.a.instance.Fc(new Tt(Wa.App.ya.gb))}catch(b){v.ULS.shipAssertTag(575930383,3016,!1,b.message)}sm.main();Type.registerNamespace("Common.App.Insights");Dl;N.a.instance.Fc(new Uj);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");
Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");uk("Begin");N.a.instance.Fc(new Sr);try{N.a.instance.Fc(new fb(Tj.a.get_instance(),Wa.App.ya.gb,Wa.App.ya.Nb))}catch(b){v.ULS.shipAssertTag(575930384,3016,!1,b.message)}Ba.main();N.a.instance.Fc(new we);is.main();Zs.main();Io.main();iw.main();$s.main();eq.main();Fs.main();tz.main();N.a.instance.Fc(new Ev);Gu.main();vz.main();Sp.main();
Zr.main();MH.main();LH.main();N.a.instance.Fc(new AA);N.a.instance.Fc(new $r);Dz.main();Oy.main();ur.main();N.a.instance.Fc(new ux);N.a.instance.Fc(new HA);Lu;QB.main();Gc.main();Jg.main();mc.main();Hc;N.a.instance.Fc(new ij);N.a.instance.Fc(new ts);Jw.main();$q.main();hE.main();N.a.instance.Fc(new $E);N.a.instance.Fc(new nE);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=cz;Type.registerNamespace("Common.App.AppsForOfficeCommon");
Type.registerNamespace("Common.App.AppsForOfficeCommon");Qq.main();cs.main();aB.main();ID;YG.main();xM;window.MSOJS=tD;tH.main();wH.main();N.a.instance.Fc(new RL);N.a.instance.Fc(new TL);(async()=>{w.AFrameworkApplication.K.$("WPMPackageIsEnabled")&&await c.e(25).then(c.bind(null,2034)).then(b=>{b.initializeOnDemandPackage()})})();NH.main();gf.main()},2041:function(E,M,c){E=c(0);var m=c(7),e=c(1595);class a{static get k$m(){return 50}static hRd(y){if(""===y)return"";let z=0,n="";try{const v=e.a.QDb(y);
for(const A of v.ops)if(a.BG(A))z||(n+=a.nVl(A.attributes.atmention.fullName)),z+=1;else{const w=A.insert?A.insert:"";" "!==w&&0<w.length&&(z=0,n+=w)}}catch(v){m.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return n}static sPl(y){y=a.hRd(y);return 0<y.length&&y.split(" ").length<=a.k$m?y:null}static nVl(y){let z="";y&&(y=y.split(" "),0<y.length&&(z=y[0]));return z}static BG(y){return!!y.attributes&&!!y.attributes.atmention}}
Object(E.a)(a,"BaseCommentSmartReplyHelpers",null,[]);c.d(M,"a",function(){return l});class l extends a{constructor(){super()}static FDb(y,z,n=!1){if(!y)return null;y=y.text&&0<y.text.length?y.text[0]:"";z=!z||!z.Df||""===z.Df;return 0<y.length&&z&&!n?a.sPl(y):null}}Object(E.a)(l,"CommentSmartReplyHelpers",a,[])},946:function(E,M,c){c.d(M,"a",function(){return m});E=c(0);class m{constructor(){this.method=this.api=0}}Object(E.a)(m,"Message",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19580616/wdjs/WordEditorDS.box4.dll1.js.map